<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üàµ üôáüèª üó°Ô∏è N'ouvrez pas les ports au monde - ils vous briseront (risques) üèÇüèº üòò üê≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Encore et encore, apr√®s l'audit, sur mes recommandations de cacher les ports derri√®re la liste blanche, je rencontre un mur d'incompr√©hension. M√™me le...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>N'ouvrez pas les ports au monde - ils vous briseront (risques)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446772/"><p><img src="https://habrastorage.org/webt/an/nt/sv/anntsvhkknayqt3ewhpeum57bj4.jpeg" alt="image"></p><br><p>  Encore et encore, apr√®s l'audit, sur mes recommandations de cacher les ports derri√®re la liste blanche, je rencontre un mur d'incompr√©hension.  M√™me les admins tr√®s cool / DevOps demandent: "Pourquoi?!?" </p><br><p>  Je propose de consid√©rer les risques par ordre d√©croissant de probabilit√© d'occurrence et de dommage. </p><br><ol><li>  Erreur de configuration </li><li>  DDoS sur IP </li><li>  Bruteforce </li><li>  Vuln√©rabilit√©s du service </li><li>  Vuln√©rabilit√©s de la pile du noyau </li><li>  Renforcer les attaques DDoS <a name="habracut"></a></li></ol><br><h2 id="oshibka-konfiguracii">  Erreur de configuration </h2><br><p> La situation la plus typique et dangereuse.  Comment √ßa se passe.  Le d√©veloppeur doit tester rapidement l'hypoth√®se, il l√®ve un serveur temporaire avec mysql / redis / mongodb / √©lastique.  Le mot de passe, bien s√ªr, est compliqu√©, il l'utilise partout.  Il ouvre le service au monde - il est pratique pour lui de se connecter depuis votre PC sans ceux de vos VPN.  Et la syntaxe iptables est trop paresseuse pour √™tre rappel√©e, de toute fa√ßon le serveur est temporaire.  Juste quelques jours de d√©veloppement - cela s'est bien pass√©, vous pouvez le montrer au client.  Le client aime √ßa, on n'a pas le temps de le refaire, on le lance dans le PROD! </p><br><p>  Exemple d√©lib√©r√©ment exag√©r√© afin de marcher sur tous les r√¢teaux: </p><br><ol><li>  Rien n'est plus permanent que temporaire - je n'aime pas cette phrase, mais subjectivement, 20 √† 40% de ces serveurs temporaires restent longtemps. </li><li>  Le mot de passe universel complexe utilis√© dans de nombreux services est mauvais.  Parce que l'un des services o√π ce mot de passe a √©t√© utilis√© pourrait √™tre pirat√©.  D'une mani√®re ou d'une autre, les bases de donn√©es des services pirat√©s affluent vers une base utilis√©e pour [la force brute] *. <br>  Il convient d'ajouter que redis, mongodb et elastic apr√®s l'installation sont g√©n√©ralement disponibles sans authentification et remplissent souvent la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">collection de bases de donn√©es ouvertes</a> . </li><li>  Il peut sembler que dans quelques jours, personne n'analysera votre port 3306.  C'est une erreur!  Masscan est un excellent scanner et peut num√©riser √† 10 millions de ports par seconde.  Et sur Internet, il n'y a que 4 milliards d'IPv4.  En cons√©quence, tous les 3306e ports sur Internet sont en 7 minutes.  Karl !!!  Sept minutes! <br>  "Qui s'en soucie?"  - vous objectez.  Je suis donc surpris de voir les statistiques des paquets abandonn√©s.  O√π un jour √† partir de 40 000 tentatives de num√©risation √† partir de 3 000 adresses IP uniques?  Maintenant, tout le monde sera scann√© pour n'importe qui, des pirates de la m√®re aux gouvernements.  La v√©rification est tr√®s simple - prenez n'importe quel VPS pour 3 √† 5 $ aupr√®s de n'importe quel ** low-coster, activez la journalisation des paquets d√©pos√©s et consultez le journal en une journ√©e. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Activation de la journalisation</b> <div class="spoiler_text"><p>  Dans /etc/iptables/rules.v4 ajoutez √† la fin: <br>  -A INPUT -j LOG --log-prefix "[FW - ALL]" --log-level 4 </p><br><p>  Et dans /etc/rsyslog.d/10-iptables.conf <br>  : msg, contient, "[FW -" /var/log/iptables.log <br>  &amp; arr√™ter </p></div></div><br><h2 id="ddos-po-ip">  DDoS sur IP </h2><br><p>  Si un attaquant conna√Æt votre adresse IP, il peut √©trangler votre serveur pendant plusieurs heures ou jours.  Tous les h√©bergements √† bas prix n'ont pas de protection DDoS et votre serveur sera simplement d√©connect√© du r√©seau.  Si vous avez cach√© le serveur derri√®re un CDN, n'oubliez pas de changer l'IP, sinon le pirate va le chercher sur Google et DDoS votre serveur en contournant le CDN (une erreur tr√®s populaire). </p><br><h2 id="uyazvimosti-servisov">  Vuln√©rabilit√©s du service </h2><br><p>  T√¥t ou tard, des erreurs se retrouvent dans tous les logiciels populaires, m√™me dans les plus test√©s et les plus critiques.  Parmi les ing√©nieurs du SI, il y a une telle demi-blague - la s√©curit√© de l'infrastructure peut √™tre facilement estim√©e au moment de la derni√®re mise √† jour.  Si votre infrastructure est riche en ports qui sortent du monde et que vous ne l'avez pas mise √† jour depuis un an, aucun agent de s√©curit√© ne vous dira que vous √™tes plein de trous et que vous avez probablement d√©j√† √©t√© pirat√©. <br>  Il convient √©galement de mentionner que toutes les vuln√©rabilit√©s connues √©taient autrefois inconnues.  Imaginez un pirate informatique qui a trouv√© une telle vuln√©rabilit√© et a scann√© tout Internet en 7 minutes pour sa pr√©sence ... Voici une nouvelle √©pid√©mie de virus) Elle doit √™tre mise √† jour, mais elle peut endommager le produit, dites-vous.  Et vous aurez raison si les packages ne sont pas install√©s √† partir des r√©f√©rentiels officiels du syst√®me d'exploitation.  Par exp√©rience, les mises √† jour du r√©f√©rentiel officiel cassent rarement la prod. </p><br><h2 id="brutfors">  Bruteforce </h2><br><p>  Comme d√©crit ci-dessus, il existe une base de donn√©es avec un demi-milliard de mots de passe faciles √† taper √† partir du clavier.  En d'autres termes, si vous n'avez pas g√©n√©r√© de mot de passe, mais tap√© des caract√®res √† proximit√© sur le clavier, assurez-vous * - ils vous supprimeront. </p><br><h2 id="uyazvimosti-steka-yadra">  Vuln√©rabilit√©s de la pile du noyau. </h2><br><p>  Il arrive **** que peu importe le service qui ouvre le port lorsque la pile du noyau r√©seau elle-m√™me est vuln√©rable.  Autrement dit, absolument n'importe quel socket tcp / udp sur un syst√®me il y a deux ans est vuln√©rable √† une vuln√©rabilit√© DDoS. </p><br><h2 id="usilenie-ddos-atak">  Renforcement des attaques DDoS </h2><br><p>  Cela n'endommagera pas directement, mais cela peut obstruer votre cha√Æne, augmenter la charge sur le syst√®me, votre adresse IP ira √† une liste noire *****, et vous obtiendrez un abus de l'h√¥te. </p><br><p>  Avez-vous vraiment besoin de tous ces risques?  Ajoutez votre IP personnelle et professionnelle √† la liste blanche.  M√™me s'il est dynamique, connectez-vous via le panneau d'administration de l'h√¥te, via la console Web, et ajoutez-en simplement un autre. </p><br><p>  Je construis et prot√®ge une infrastructure informatique depuis 15 ans.  J'ai d√©velopp√© une r√®gle que je recommande fortement √† tout le monde - <strong>aucun port ne devrait sortir du monde sans liste blanche</strong> . </p><br><p>  Par exemple, le serveur Web le plus s√©curis√© *** est celui avec 80 et 443 ouverts pour CDN / WAF uniquement.  Et les ports de service (ssh, netdata, bacula, phpmyadmin) devraient √™tre au moins derri√®re la liste blanche, et encore mieux pour VPN.  Sinon, vous risquez d'√™tre compromis. </p><br><p>  J'ai tout.  Gardez vos ports ferm√©s! </p><br><hr><br><ul><li>  (1) <strong>UPD1</strong> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ici,</a> vous pouvez v√©rifier votre mot de passe universel cool ( <strong>ne faites pas cela sans remplacer ce mot de passe par des mots al√©atoires dans tous les services</strong> ), s'il est apparu dans la base de donn√©es fusionn√©e.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Et ici,</a> vous pouvez voir combien de services ont √©t√© pirat√©s, o√π votre e-mail a √©t√© pr√©sent√© et, en cons√©quence, savoir si votre mot de passe universel cool a √©t√© compromis. </li><li>  (2) Au cr√©dit d'Amazon, il y a au moins des scans sur LightSail.  Apparemment, en quelque sorte filtr√©. </li><li>  (3) Un serveur Web encore plus s√©curis√© est celui derri√®re le pare-feu d√©di√©, son WAF, mais nous parlons de VPS public / d√©di√©. </li><li>  (4) Segmentsmak. </li><li>  (5) Firehol. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr446772/">https://habr.com/ru/post/fr446772/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr446760/index.html">Sujets √† 3D Expo 2019: 3D Metal Printing, Anton Sotov, Samara University</a></li>
<li><a href="../fr446762/index.html">6. Check Point Getting Started R80.20. Premiers pas avec SmartConsole</a></li>
<li><a href="../fr446764/index.html">Norme WASI: Lancez WebAssembly au-del√† du Web</a></li>
<li><a href="../fr446768/index.html">Saisie nominale dans TypeScript ou comment prot√©ger votre interface contre les identifiants √©trangers</a></li>
<li><a href="../fr446770/index.html">12 astuces JavaScript introuvables dans la plupart des didacticiels</a></li>
<li><a href="../fr446774/index.html">Conception de caract√®re Low Poly</a></li>
<li><a href="../fr446776/index.html">Preuve de travail efficace</a></li>
<li><a href="../fr446780/index.html">Comment cr√©er un th√®me sombre et ne pas nuire. Exp√©rience de l'√©quipe Yandex.Mail</a></li>
<li><a href="../fr446782/index.html">Yo-ho-ho et une bouteille de rhum</a></li>
<li><a href="../fr446786/index.html">Pourquoi ai-je refus√© Disqus et tu devrais y aller aussi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>