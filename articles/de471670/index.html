<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§£ üëµ üê≠ Versuchen Sie Jetpack Compose im Kampf? üí¨ üë®‚Äç‚öñÔ∏è ü§æüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Endlich ist der Moment gekommen, in dem Sie Android Studio nicht selbst erstellen m√ºssen, um das neue deklarative UI-Framework f√ºr Android zu testen. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Versuchen Sie Jetpack Compose im Kampf?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471670/"><p>  Endlich ist der Moment gekommen, in dem Sie Android Studio nicht selbst erstellen m√ºssen, um das neue deklarative UI-Framework f√ºr Android zu testen.  Jetpack Compose ist jetzt als erste Dev Preview im Maven Repository von Google verf√ºgbar.  Mit diesen Neuigkeiten begann mein Montagmorgen.  Und sofort bestand der Wunsch zu sehen, auf welche Werkzeuge sie gewartet hatten. </p><br><p><img src="https://habrastorage.org/webt/f6/rx/jt/f6rxjtulw6xjtuy4ydf2wo_wvcy.png"></p><a name="habracut"></a><br><p> Ich beschloss, meine Bekanntschaft sofort mit dem Versuch zu beginnen, sie in das auf Google Play ver√∂ffentlichte Haustierprojekt einzuf√ºhren.  Au√üerdem wollte ich lange Zeit eine Seite ‚Äû√úber die Anwendung‚Äú erstellen.  In diesem Artikel werde ich √ºber die Hauptkomponenten und Verbindungsschritte von Compose sprechen: </p><br><ol><li>  Abh√§ngigkeitsverbindung </li><li>  Themen und Stile.  Integration mit vorhandenen im Projekt. </li><li>  Zug√§nglichkeits- und UI-Tests. </li><li>  Die Hauptkomponenten und Analoga der View-Erben. </li><li>  Arbeite mit dem Staat. </li></ol><br><h2 id="podklyuchenie-zavisimostey">  Abh√§ngigkeitsverbindung </h2><br><p>  Zu Beginn habe ich das Studio von 3.5 auf 3.5.1 aktualisiert (vergebens) und grundlegende Abh√§ngigkeiten hinzugef√ºgt.  Eine vollst√§ndige Liste finden Sie in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Artikel von Cyril</a> . </p><br><pre><code class="plaintext hljs">// build.gradle ext.compose_version= '0.1.0-dev01' //build.gradle  dependencies{ ... implementation "androidx.compose:compose-runtime:$compose_version" kapt "androidx.compose:compose-compiler:$compose_version" implementation "androidx.ui:ui-layout:$compose_version" implementation "androidx.ui:ui-android-text:$compose_version" implementation "androidx.ui:ui-text:$compose_version" implementation "androidx.ui:ui-material:$compose_version" }</code> </pre> <br><p>  Und dann habe ich versucht, all dies wegen der verstreuten Versionen von Firebase zu sammeln.  Danach bin ich auf Compose-Hindernisse gesto√üen: </p><br><pre> <code class="plaintext hljs">app/src/main/AndroidManifest.xml Error: uses-sdk:minSdkVersion 16 cannot be smaller than version 21 declared in library [androidx.ui:ui-layout:0.1.0-dev01] .../ui-layout-0.1.0-dev01/AndroidManifest.xml as the library might be using APIs not available in 16 Suggestion: use a compatible library with a minSdk of at most 16, or increase this project's minSdk version to at least 21, or use tools:overrideLibrary="androidx.ui.layout" to force usage (may lead to runtime failures)</code> </pre> <br><p>  Ja, Compose war nur mit minSdk 21 (Lolipop) verf√ºgbar.  Vielleicht ist dies eine vor√ºbergehende Ma√ünahme, aber es wurde erwartet, dass fr√ºhere Versionen des Betriebssystems unterst√ºtzt werden. </p><br><p>  Das ist aber noch nicht alles.  Compose arbeitet mit Reflection anstelle des Kotlin Compiler Plugins, wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">hier bereits erw√§hnt</a> .  Damit alles beginnen kann, m√ºssen Sie den Kotlin Reflect auch hinzuf√ºgen, abh√§ngig von: </p><br><pre> <code class="plaintext hljs">implementation "org.jetbrains.kotlin:kotlin-reflect"</code> </pre> <br><p>  Zum Nachtisch.  Compose dp implementiert Erweiterungsfunktionen f√ºr Int, Long, Float, die mit dem Schl√ºsselwort inline gekennzeichnet sind.  Dies kann einen neuen Kompilierungsfehler verursachen: </p><br><pre> <code class="plaintext hljs">Cannot inline bytecode built with JVM target 1.8 into bytecode that is being built with JVM target 1.6. Please specify proper '-jvm-target' option * https://stackoverflow.com/questions/48988778/cannot-inline-bytecode-built-with-jvm-target-1-8-into-bytecode-that-is-being-bui</code> </pre> <br><p>  Um dies zu l√∂sen, m√ºssen Sie die JVM-Version f√ºr Kotlin explizit registrieren: </p><br><pre> <code class="plaintext hljs">android { ‚Ä¶ kotlinOptions { jvmTarget = "1.8" } }</code> </pre> <br><p>  Das scheint alles zu sein.  Viel einfacher als ein eigenes Studio zu bauen </p><br><p>  Lassen Sie uns versuchen, Hello World auszuf√ºhren (ebenfalls aus Cyrils Artikel, aber im Gegensatz zu ihm Compose inside Fragment hinzuf√ºgen).  Das Layout f√ºr das Fragment ist ein leeres FrameLayout. </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inflater: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">LayoutInflater</span></span></span></span><span class="hljs-function"><span class="hljs-params">, container: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">?, savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span>: View? { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> fragmentView = inflater.inflate(R.layout.fragment_about, container, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) (fragmentView <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ViewGroup).setContent { Hello(<span class="hljs-string"><span class="hljs-string">"Jetpack Compose"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fragmentView } <span class="hljs-meta"><span class="hljs-meta">@Composable</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = MaterialTheme { FlexColumn { inflexible { <span class="hljs-comment"><span class="hljs-comment">// Item height will be equal content height TopAppBar&lt;MenuItem&gt;( // App Bar with title title = { Text("Jetpack Compose Sample") } ) } expanded(1F) { // occupy whole empty space in the Column Center { // Center content Text("Hello $name!") // Text label } } } }</span></span></code> </pre> <br><p>  Wir starten, der folgende Bildschirm stellt sich heraus: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sg/a2/rz/sga2rzwcg7bxeymvbmllijqxerg.jpeg" alt="Bild" width="300"></div><br><p>  Aufgrund der Tatsache, dass Composable das Standardmaterial-Design verwendet, haben wir eine lila AppBar erhalten.  Nun, und wie erwartet stimmt es √ºberhaupt nicht mit dem dunklen Thema der Anwendung √ºberein: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kb/mb/2u/kbmb2u-8rl7v3snwlcz6gwwtjjk.jpeg" alt="Bild" width="300"></div><br><p>  Versuchen wir es zu l√∂sen. </p><br><h2 id="temy-i-stili-integraciya-s-suschestvuyuschimi-v-proekte">  Themen und Stile.  Integration mit vorhandenen im Projekt. </h2><br><p>  Um vorhandene Stile in Composable zu verwenden, √ºbergeben wir sie im MaterialTheme-Konstruktor: </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Composable</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = MaterialTheme(colors = MaterialColors( primary = resolveColor(context, R.attr.colorPrimary, MaterialColors().primary), secondary = resolveColor(context, R.attr.colorSecondary, MaterialColors().secondary), onBackground = resolveColor(context, R.attr.textColor, MaterialColors().onBackground) )){...}</code> </pre> <br><p>  MaterialTheme selbst besteht aus zwei Teilen: MaterialColors und MaterialTypography. <br>  Um die Farben aufzul√∂sen, habe ich einen Wrapper √ºber die Stile verwendet: </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolveColor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Context</span></span></span></span><span class="hljs-function"><span class="hljs-params">?, </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@AttrRes</span></span></span></span><span class="hljs-function"><span class="hljs-params"> attrRes: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, colorDefault: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Color</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = context?.let { Color(resolveThemeAttr(it, attrRes).<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.toLong()) } ?: colorDefault <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolveThemeAttr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Context</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@AttrRes</span></span></span></span><span class="hljs-function"><span class="hljs-params"> attrRes: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: TypedValue { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> theme = context.theme <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> typedValue = TypedValue() theme.resolveAttribute(attrRes, typedValue, <span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> typedValue }</code> </pre> <br><p>  In diesem Stadium wird die AppBar gr√ºn.  Zum Neulackieren des Textes m√ºssen Sie jedoch noch eine Aktion ausf√ºhren: </p><br><pre> <code class="kotlin hljs">Text(<span class="hljs-string"><span class="hljs-string">"Hello </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$name</span></span></span><span class="hljs-string">!"</span></span>, style = TextStyle(color = +themeColor { onBackground }))</code> </pre> <br><p>  Das Thema wird mit der un√§ren Plus-Operation auf das Widget angewendet.  Wir werden es immer noch sehen, wenn wir mit State arbeiten. </p><br><p>  Jetzt sieht der neue Bildschirm in beiden Varianten des Themas mit dem Rest der Anwendung einheitlich aus: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4q/jy/en/4qjyenwrurz2agzupn9nfvlunmu.jpeg" alt="Bild" width="300"></div><br><p>  Compose hat auch die Datei DarkTheme.kt in den Quellen gefunden, deren Funktionen verwendet werden k√∂nnen, um verschiedene Ausl√∂ser f√ºr das Einschalten eines dunklen Themas unter Android P und 10 zu bestimmen. </p><br><h2 id="accessibility-i-ui-testy">  Zug√§nglichkeits- und UI-Tests. </h2><br><p>  Bis der Bildschirm mit neuen Elementen zu wachsen beginnt, sehen wir uns an, wie er im Layout-Inspektor und bei aktivierter Anzeige der Rahmen von Elementen im Entwicklungsmodus aussieht: </p><br><p><img src="https://habrastorage.org/webt/x8/ss/x-/x8ssx-qi79amnzbygwwakvfqno0.jpeg"></p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ik/l2/qv/ikl2qvufik8cwohrlat5oagyspq.jpeg" alt="Bild" width="300"></div><br><p>  Hier sehen wir FrameLayout, in dem sich nur AndroidComposeView befindet.  Bestehende Tools f√ºr Accebility- und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">UI-Tests</a> sind nicht mehr anwendbar?  Vielleicht gibt es stattdessen eine neue Bibliothek: <code>androidx.ui:ui-test</code> . </p><br><h2 id="osnovnye-komponenty-i-analogi-naslednikov-view">  Die Hauptkomponenten und Analoga der View-Erben. </h2><br><p>  Versuchen wir nun, den Bildschirm etwas informativer zu gestalten.  √Ñndern Sie zun√§chst den Text, f√ºgen Sie eine Schaltfl√§che zur Anwendungsseite bei Google Play und ein Bild mit einem Logo hinzu.  Ich zeige Ihnen sofort den Code und was passiert ist: </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Composable</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AboutScreen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = MaterialTheme(...) { FlexColumn { inflexible { TopAppBar&lt;MenuItem&gt;(title = { Text(getString(R.string.about)) }) } expanded(<span class="hljs-number"><span class="hljs-number">1F</span></span>) { VerticalScroller { Column { Image() Title() MyButton() } } } } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Image</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Center { Padding(<span class="hljs-number"><span class="hljs-number">16</span></span>.dp) { Container( constraints = DpConstraints( minWidth = <span class="hljs-number"><span class="hljs-number">96</span></span>.dp, minHeight = <span class="hljs-number"><span class="hljs-number">96</span></span>.dp ) ) { imageFromResource(resources, R.drawable.ic_launcher) } } } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Title</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Center { Padding(<span class="hljs-number"><span class="hljs-number">16</span></span>.dp) { Text(getString(R.string.app_name) + <span class="hljs-string"><span class="hljs-string">" "</span></span> + BuildConfig.VERSION_NAME, style = TextStyle(color = +themeColor { onBackground })) } } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Center { Padding(<span class="hljs-number"><span class="hljs-number">16</span></span>.dp) { Button(getString(R.string.about_button), onClick = { openAppInPlayStore() }) } } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xx/1o/so/xx1oso944katkc-q5li8ymbylz8.jpeg" alt="Bild" width="300"></div><br><p>  Die Grundprinzipien der Widget-Komposition haben sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">seit dem ersten Erscheinen von Compose-Quellen</a> nicht ge√§ndert. </p><br><p>  Aus dem Interessanten: </p><br><ul><li>  Funktionen zum Anzeigen einzelner Elemente m√ºssen nicht mit @Composable kommentiert werden. </li><li>  Fast alle Eigenschaften f√ºr Widgets wurden in separate Widgets umgewandelt (Mitte anstelle von Android: Schwerkraft, Auff√ºllen anstelle von Android: Rand, ...) </li><li>  Ich konnte das Bild von Drawables nicht anzeigen. </li><li>  Der onClick-Parameter der Schaltfl√§che ist nicht der letzte, weshalb es unm√∂glich ist, ihn als Lambda ohne expliziten Namen zu √ºbergeben, was logischer erscheint: <br><pre> <code class="kotlin hljs">Button(‚ÄúText<span class="hljs-string"><span class="hljs-string">"){ openAppInPlayStore() }</span></span></code> </pre> </li></ul><br><p>  Lassen Sie uns nun die vorhandene Hauptansicht-Gruppe durchgehen und versuchen, Analoga in Compose zu finden. </p><br><p>  Anstelle von FrameLayout k√∂nnen Sie Stack verwenden.  Hier ist alles einfach: Die untergeordneten Widgets √ºberlappen sich und werden abh√§ngig von der f√ºr den Anhang verwendeten Funktion positioniert: ausgerichtet, positioniert oder erweitert. </p><br><p>  LinearLayout wird sofort durch zwei Widgets ersetzt: Column und Row, anstatt den Parameter android: Orientierung zu verwenden.  Sie enthalten wiederum FlexColumn und FlexRow mit einer Ebene unflexibler Funktionen √ºber einem verschachtelten Teilbaum.  Nun, FlexColumn und FlexRow selbst basieren auf Flex mit dem Parameter <code>orientation = LayoutOrientation.Vertical</code> oder <code>Horizontal</code> . </p><br><p>  Eine √§hnliche Hierarchie f√ºr FlowColumn-, FlowRow- und Flow-Widgets.  Ihr Hauptunterschied: Wenn der Inhalt nicht in eine Spalte oder Zeile passt, wird der n√§chste als n√§chstes gezeichnet und die eingebetteten Widgets ‚Äûflie√üen‚Äú dorthin.  Es f√§llt mir schwer, mir den eigentlichen Zweck dieser Widgets vorzustellen. </p><br><p>  Der ScrollView-Effekt wird erzielt, indem eine Spalte oder Zeile in einem VerticalScroller oder HorizontalScroller platziert wird.  Beide komponieren im Scroller und √ºbergeben den Parameter <code>isVertical = true</code> oder <code>false</code> . </p><br><p>  Auf der Suche nach einem Analogon f√ºr ConstraintLayout oder zumindest RelativeLayout stie√ü man auf ein neues Tabellen-Widget.  Ich habe versucht, den Beispielcode in meiner Anwendung auszuf√ºhren: <a href="" rel="nofollow">DataTableSamples.kt</a> .  Da ich jedoch nicht versucht habe, das Beispiel zu vereinfachen, hat es nicht funktioniert, damit es funktioniert. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wg/2u/md/wg2umdhpscl3xm3ejubkgcqor-i.jpeg" alt="Bild" width="300"></div><br><h2 id="rabota-so-state">  Arbeite mit dem Staat </h2><br><p>  Eine der am meisten erwarteten Neuerungen des Frameworks ist seine sofort einsatzbereite Bereitschaft zur Verwendung in unidirektionalen Architekturen, die auf der Grundlage eines einzelnen Zustands erstellt wurden.  Und dies sollte die Annotation @Model f√ºr Tag-Klassen einf√ºhren, die den Status f√ºr das Rendern der Benutzeroberfl√§che bereitstellen. <br>  Betrachten Sie ein Beispiel: </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DialogVisibleModel</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">val</span></span> visible: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> dismissPushed: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> = <span class="hljs-literal"><span class="hljs-literal">false</span></span>) ... <span class="hljs-meta"><span class="hljs-meta">@Composable</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SideBySideAlertDialogSample</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openDialog = +state { DialogVisibleModel(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) } Button(text = <span class="hljs-string"><span class="hljs-string">"Ok"</span></span>, onClick = { openDialog.value = DialogVisibleModel(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) }) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (openDialog.value.visible) { AlertDialog( onCloseRequest = { <span class="hljs-comment"><span class="hljs-comment">// Because we are not setting openDialog.value to false here, // the user can close this dialog only via one of the buttons we provide. }, title = { Text(text = "Title") }, text = { Text("This area typically contains the supportive text" + " which presents the details regarding the Dialog's purpose.") }, confirmButton = { Button("Confirm", onClick = { openDialog.value = DialogVisibleModel(false) }) }, dismissButton = { if (!openDialog.value.dismissPushed) Button("Dismiss", onClick = { openDialog.value = DialogVisibleModel(true, true) }) else { //hidden } }, buttonLayout = AlertDialogButtonLayout.SideBySide ) } }</span></span></code> </pre> <br><p>  Dadurch wird eine Datenklasse f√ºr das Statusmodell erstellt, die nicht mit der Annotation @Model gekennzeichnet werden muss. <br>  Der Anfangszustand selbst wird in der Funktion @Composable mit dem Zustand + erstellt. <br>  Die Sichtbarkeit des Dialogfelds wird durch die sichtbare Eigenschaft des Modells bestimmt, die durch Aufrufen der value-Eigenschaft erhalten wird. <br>  Diese Eigenschaft kann auch auf ein neues unver√§nderliches Objekt festgelegt werden, wie dies beim onClick beider Schaltfl√§chen der Fall ist.  Der erste versteckt sich, der zweite - schlie√üt den Dialog.  Der Dialog kann wieder ge√∂ffnet werden, indem Sie auf die Schaltfl√§che OK klicken, die in derselben @ Composable-Funktion definiert ist. <br>  Beim Versuch, einen Status au√üerhalb dieser Funktion zu erstellen, tritt ein Fehler auf: <br> <code>java.lang.IllegalStateException: Composition requires an active composition context.</code> <br>  Der Kontext kann durch Zuweisen des Werts der Funktion setContent {} in onCreateView abgerufen werden. Wie Sie ihn beispielsweise in Presenter oder einer anderen Klasse als Fragment oder Activity zum √Ñndern des Status verwenden k√∂nnen, ist jedoch noch unklar. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w2/b_/__/w2b___zoyd6ypgp5ji78dpppsqg.jpeg" alt="Bild" width="300"></div><br><p>  Damit ist unsere √úberpr√ºfung der neuen Jetpack Compose-Bibliothek abgeschlossen.  Das Framework begr√ºndet seinen Namen architektonisch und ersetzt alle Vererbungen, die in der Ansichtshierarchie so unpraktisch waren, durch Komposition.  Es gibt immer noch zu viele Fragen dar√ºber, wie Analoga komplexerer ViewGroups implementiert werden, wie z. B. ConstraintLayout und RecyclerView.  nicht genug Dokumentation und Vorschau. </p><br><p>  Es ist absolut klar, dass Compose auch in kleinen Kampfanwendungen nicht einsatzbereit ist. </p><br><p>  Dies ist jedoch nur die erste Version von Dev Preview.  Es wird interessant sein, die Entwicklung des Konzepts der Zusammenarbeit mit Staat und Bibliotheken aus der auf Compose basierenden Community zu beobachten. </p><br><p>  Wenn Sie erfolgreichere Beispiele f√ºr Code oder Dokumentation f√ºr F√§lle finden, die ich nicht erhalten konnte, schreiben Sie bitte in die Kommentare. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de471670/">https://habr.com/ru/post/de471670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de471660/index.html">Vorlesung √ºber Spielerpsychologie</a></li>
<li><a href="../de471662/index.html">Web - Javascript - Authentifizierung, Verschleierung und nativer Code. Probleml√∂sung mit r0ot-mi Web - Client. Teil 1</a></li>
<li><a href="../de471664/index.html">Praktikum bei ABBYY: ein Unternehmen, mit dem Sie ‚ÄûSie‚Äú sein k√∂nnen</a></li>
<li><a href="../de471666/index.html">Erleben Sie, wie iOS Developer mit einem Arbeitsvisum nach Deutschland zieht</a></li>
<li><a href="../de471668/index.html">Technische Analyse des checkm8-Exploits</a></li>
<li><a href="../de471676/index.html">Telefonbetr√ºger. Die zweite Aktion, bei der ich zusammenbreche und zum n√§chsten Geldautomaten renne</a></li>
<li><a href="../de471678/index.html">Tragen Sie Dienstleistungen auf Anfrage</a></li>
<li><a href="../de471684/index.html">Warum m√ºssen Sie Module f√ºr Nginx erstellen?</a></li>
<li><a href="../de471686/index.html">Wie AWS seine belastbaren Services zusammenstellt. Server- und Datenbankskalierung</a></li>
<li><a href="../de471688/index.html">Wie AWS seine belastbaren Services zusammenstellt. Netzwerkskalierung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>