<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äçüé§ üè≥Ô∏è ‚öõÔ∏è Construyendo VirtualBox para Windows ü§üüèª üë≤üèº üöñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introducci√≥n 
 Es un hecho bien conocido para muchos usuarios de la versi√≥n de Windows de VirtualBox (de ahora en adelante, VB ; no debe confundirse c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Construyendo VirtualBox para Windows</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447300/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2f6/4c2/1ba/2f64c21bac5d7f0c050e7442bd08960e.png"></div><br><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Introducci√≥n </h4><br>  Es un hecho bien conocido para muchos usuarios de la versi√≥n de Windows de VirtualBox (de ahora en adelante, <em>VB</em> ; no debe confundirse con Visual Basic) que a partir de 4.3.14 los desarrolladores agregaron el llamado "endurecimiento" dise√±ado para prevenir inyecciones maliciosas en VB.  Aunque las intenciones fueron buenas, la implementaci√≥n caus√≥ numerosos conflictos con productos totalmente leg√≠timos, como antivirus, m√≥dulos criptogr√°ficos e incluso algunas actualizaciones de Windows, y cuando se produce dicho conflicto, VB simplemente deja de funcionar.  Los usuarios tienen que esperar al menos un mes hasta que se lance la nueva versi√≥n VB con las exclusiones adecuadas agregadas.  El peor de los casos es que la aplicaci√≥n o actualizaci√≥n en conflicto tiene que ser desinstalada, o VB en s√≠ debe ser degradado a la versi√≥n 4.3.12, que fue la √∫ltima sin endurecerse.  Numerosas solicitudes para agregar una lista de exclusi√≥n controlada por el usuario, o una opci√≥n para deshabilitar el endurecimiento, quedan sin respuesta.  La √∫nica respuesta de los desarrolladores suena como "si no quiere que lo construya usted mismo a partir del c√≥digo fuente".  Bueno, parece que tendremos que hacerlo. <br><br>  Aunque las instrucciones de compilaci√≥n se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">describen</a> en el Wiki oficial del proyecto, est√°n incompletas y algo desactualizadas, mientras que el procedimiento de compilaci√≥n a menudo falla con mensajes de error vagos.  Entonces, cuando, al final, lo puse a trabajar, pens√© que val√≠a la pena documentarlo en detalle en un art√≠culo separado.  Esta instrucci√≥n se actualiza peri√≥dicamente y, por el momento, est√° adaptada para compilar la versi√≥n 6.0.4 de VB.  Sin embargo, si necesita informaci√≥n sobre la creaci√≥n de versiones anteriores de VB o bibliotecas auxiliares, siempre puede obtenerla del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">historial de cambios</a> . <br><br><a name="habracut"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Tabla de contenidos </h4><blockquote>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Declaraci√≥n del problema</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Una palabra de advertencia</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Preparaci√≥n del entorno de construcci√≥n</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Aplicaciones Quirks de instalaci√≥n</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Toques finales</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Construyendo VirtualBox</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ep√≠logo</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enmiendas</a> <br></blockquote><br><a name="task"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Declaraci√≥n del problema </h4><br>  Al principio, quer√≠a simplificarlo simplemente reconstruyendo los componentes binarios y copi√°ndolos encima de la versi√≥n instalada desde la distribuci√≥n oficial.  Sin embargo, eso estuvo lejos de ser simple porque la instalaci√≥n se basa en una API oscura del sistema y requiere la instalaci√≥n de controladores y el registro de componentes COM.  Me preguntaba si era viable aprender c√≥mo funcionaba todo esto y escribir un gui√≥n para automatizar estas tareas, pero despu√©s de considerarlo decid√≠ ir a lo grande y construir una distribuci√≥n completa que fuera lo m√°s cercana posible a la oficial, solo sin endurecimiento <br><br>  Tengo que decir que esta tarea result√≥ ser muy dif√≠cil y no pude cumplirla al 100%.  Me he topado con las adiciones de invitados que se proporcionan para Windows (32 y 64 bits), OS / 2, Linux y algunos otros sistemas * NIX.  Los comentarios en el Makefile correspondiente mencionan que todos est√°n construidos en diferentes m√°quinas remotas, y definitivamente no estaba ansioso por administrar una f√°brica de este tipo.  Entonces, mi soluci√≥n final fue construir todo a partir de c√≥digos fuente, excepto las Adiciones, pero tomar la imagen ISO oficial con ellos y simplemente ponerlo en mi distribuci√≥n tal como est√°.  No he comprobado si las Adiciones tienen el mismo mecanismo de endurecimiento, pero incluso si lo tienen, nunca he escuchado ninguna queja al respecto. <br><br><a name="warnings"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Una palabra de advertencia </h4><br><h5>  ‚Ä¢ Consideraciones de seguridad </h5><br>  El endurecimiento no se agreg√≥ por capricho, fue una soluci√≥n para cerrar una vulnerabilidad en VB.  Desafortunadamente, Oracle se niega a proporcionar la descripci√≥n detallada del problema, a pesar de que se solucion√≥ hace muchos a√±os.  En general, tiene algo que ver con el mecanismo de inyecci√≥n de DLL en Windows que, en el caso de VB, puede conducir a una elevaci√≥n de privilegios no autorizada en la computadora host, y hay vulnerabilidades de trabajo para esta vulnerabilidad.  As√≠ que ten cuidado si decides usar una versi√≥n sin endurecimiento de todos modos. <br><br><h5>  ‚Ä¢ Firma de conductores </h5><br>  Comenzando con Vista, en las versiones de Windows de 64 bits, los usuarios ya no pueden cargar controladores arbitrarios.  Los controladores deben estar firmados por un certificado con una cadena de certificados cruzados que llegue a la CA ra√≠z de Microsoft (y en Windows 10 con Secure Boot habilitado, los controladores deben estar firmados por Microsoft).  Antes de emprender el viaje de construcci√≥n de VB, debe decidir c√≥mo resolver este problema.  Puede gastar algo de dinero y comprar su propio certificado, o intentar ponerse en contacto con algunas compa√±√≠as externas que brindan servicios de firma para proyectos de c√≥digo abierto (si aceptan firmar controladores vulnerables), o configurar su Windows en el modo de prueba que permite cargar controladores firmado con un certificado de prueba generado localmente. <br><br>  En el art√≠culo implicar√© principalmente el √∫ltimo escenario, pero mencionar√© c√≥mo cambia el procedimiento si tiene un certificado comercial "completo". <br><br><a name="environment"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Preparaci√≥n del entorno de construcci√≥n </h4><br>  La gu√≠a oficial recomienda usar Windows 7 a 10 como sistema de compilaci√≥n.  Hice todo el trabajo en Windows 7 SP1 x64, y no creo que la versi√≥n del sistema operativo afecte mucho al procedimiento.  Por favor, tenga en cuenta que la m√°quina (real o virtual) que utilizar√° para construir VB debe tener conexi√≥n a Internet. <br><br>  El entorno de construcci√≥n requiere bastantes herramientas.  Si alg√∫n programa tiene una versi√≥n port√°til, prefiero tomarla en lugar de usar el instalador. <br><br>  Ahora, los siguientes programas solo se pueden obtener como distribuciones instalables (al menos, oficialmente).  Para Visual Studio y SDK / WDK, es importante seguir el orden de instalaci√≥n como se especifica a continuaci√≥n.  Una vez que haya terminado con ellos, le recomiendo ejecutar Windows Update y obtener las √∫ltimas actualizaciones para todos los productos de Microsoft. <br><ul><li>  <b>Visual Studio 2010 Professional</b> <br>  Necesita exactamente la versi√≥n 2010, y debe ser Professional o superior.  La versi√≥n 2010 Express carece de ATL que se requiere para construir API COM, utilizada por todas las interfaces para comunicarse.  Trat√© de cambiar a VS 2013 o 2015 Community Edition para que no fuera un requisito tener un programa pago (que incluso ya no se vende), pero fall√© hasta ahora. </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Windows SDK v7.1</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Visual Studio 2010 SP1</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Actualizaci√≥n del compilador de Visual C ++ 2010 SP1 para SDK 7.1</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Kit de desarrollo de controladores de Windows (WDK) v7.1</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Windows SDK v8.1</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Activeperl</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ActivePython 2.7</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cygwin</a></b> </li></ul><br>  Los otros programas se descargan como archivos port√°tiles o c√≥digos fuente: <br><ul><li>  <b><a href="">Qt 5.6.3</a></b> (c√≥digo fuente) </li><li>  <b>MinGW-w64 4.5.4</b> : <ul><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Versi√≥n de 32 bits</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Versi√≥n de 64 bits</a></b> </li></ul></li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SDL v1.2.x</a></b> (biblioteca de desarrollo para Visual C ++) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cURL</a></b> (c√≥digo fuente) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OpenSSL 1.1.1</a></b> (c√≥digo fuente) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gSOAP 2.8.x</a></b> (se recomienda la versi√≥n 2.8.41 o superior) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">libvpx 1.7.0</a></b> (c√≥digo fuente; las versiones m√°s nuevas no son compatibles con VS 2010) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">libopus 1.3</a></b> (c√≥digo fuente) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MiKTeX Portable</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">NASM</a></b> <br>  Recomiendo usar la versi√≥n port√°til de 64 bits. </li><li> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WiX</a></b> <br>  Recomiendo usar un archivo port√°til (llamado como <code>wix311-binaries.zip</code> ). </li></ul><br>  Tambi√©n necesitar√° los siguientes archivos: <br><ul><li>  <b><a href="">DocBook XML DTD 4.5</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DocBook XSL Stylesheets 1.69.1</a></b> </li></ul><br><div class="spoiler">  <b class="spoiler_title">¬øPara qu√© deber√≠as querer todo esto?</b> <div class="spoiler_text">  Si no desea crear exactamente el mismo paquete que yo, es posible que pueda deshacerse de algunas de las herramientas mencionadas anteriormente.  As√≠ que aqu√≠ dar√© algunos detalles para su prop√≥sito en el proceso de compilaci√≥n. <br><br><ul><li>  <b>SDK 8.1</b> <br>  La compilaci√≥n real se realiza usando SDK 7.1, pero necesitar√° el programa SignTool de 8.1, porque el de 7.1 no puede realizar la firma dual SHA-1 / SHA-256.  Si tiene SDK 8.1 instalado en otro lugar, simplemente puede copiar <code>signtool.exe</code> con todas sus dependencias desde all√≠ y especificar la ruta en el archivo <code>LocalConfig.kmk</code> (ver m√°s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">abajo</a> ). </li><li>  <b>WiX</b> <br>  Este es el marco para crear paquetes MSI.  Aunque la distribuci√≥n final de VB es un EXE, contiene dos archivos MSI en su interior, por lo que necesita WiX para construirlos.  Sin embargo, si solo tiene la intenci√≥n de construir los archivos binarios VB sin empaquetarlos, puede hacerlo sin WiX. </li><li>  <b>Sdl</b> <br>  Esta biblioteca se usa para un <code>VBoxSDL.exe</code> frontal simplista adicional que se puede usar en lugar de <code>VirtualBox.exe</code> .  En teor√≠a, si no necesita ese componente, deber√≠a poder ejecutar la compilaci√≥n sin tener SDL, pero no lo he intentado. </li><li>  <b>gSOAP</b> <br>  Esta biblioteca se utiliza para crear <code>VBoxWebSrv.exe</code> , servicio de administraci√≥n remota de VB.  Si no tiene gSOAP, este componente se omitir√° silenciosamente durante la compilaci√≥n. </li><li>  <b>libvpx</b> , <b>libopus</b> <br>  Estos son los c√≥decs de video y audio utilizados para grabar la pantalla de VM.  Si no los tiene, la construcci√≥n a√∫n finalizar√° con √©xito, y VB todav√≠a tendr√° todas las opciones para la captura de video, pero estas opciones ser√°n ignoradas (a pesar de que se reproducir√° la animaci√≥n de captura, no se guardar√° ninguna grabaci√≥n real) . </li><li>  <b>Cygwin</b> <br>  Necesario para construir libvpx. </li><li>  <b>MiKTeX</b> <br>  MiKTeX se utiliza para compilar la documentaci√≥n en PDF ( <code>doc\UserManual.pdf</code> ).  Sin este programa, el PDF se omitir√° silenciosamente de la construcci√≥n y el embalaje. </li><li>  <b>NASM</b> <br>  El ensamblador utilizado durante la construcci√≥n de OpenSSL.  Tambi√©n puede compilarlo sin usar el ensamblador, pero a√∫n as√≠ recomiendo usarlo para generar un c√≥digo m√°s optimizado. </li></ul></div></div><br>  Aqu√≠ est√° el resumen de todas las herramientas y bibliotecas que estoy usando, incluidas sus versiones exactas (cuando sea posible) y las rutas de instalaci√≥n que eleg√≠ en mi sistema de compilaci√≥n.  La designaci√≥n " <code>{x32|x64}</code> " se utiliza para ubicaciones separadas de instalaci√≥n de versiones de 32 y 64 bits. <table><tbody><tr><th>  Programa / herramienta </th><th>  Versi√≥n </th><th>  Ruta de instalaci√≥n </th></tr><tr><td>  Estudio visual </td><td>  Profesional 2010 </td><td> <code>C:\Program Files (x86)\Microsoft Visual Studio 10.0\</code> </td> </tr><tr><td>  SDK </td><td>  7.1 </td><td> <code>C:\Program Files\Microsoft SDKs\Windows\v7.1\</code> </td> </tr><tr><td>  SDK </td><td>  8.1 </td><td> <code>C:\Programs\DevKits\8.1\</code> </td> </tr><tr><td>  Wdk </td><td>  7.1.0 </td><td> <code>C:\WinDDK\7600.16385.1\</code> </td> </tr><tr><td>  Activeperl </td><td>  5.26.1 Build 2601 x64 </td><td> <code>C:\Programs\Perl\</code> </td> </tr><tr><td>  ActivePython </td><td>  2.7.14.2717 x64 </td><td> <code>C:\Programs\Python\</code> </td> </tr><tr><td>  WiX </td><td>  3.11.1.2318 </td><td> <code>C:\Programs\WiX\</code> </td> </tr><tr><td>  Qt </td><td>  5.6.3 </td><td> <code>C:\Programs\Qt\5.6.3-{x32|x64}\</code> </td> </tr><tr><td>  MinGW-32 </td><td>  4.5.4 </td><td> <code>C:\Programs\mingw32\</code> </td> </tr><tr><td>  MinGW-64 </td><td>  4.5.4 </td><td> <code>C:\Programs\mingw64\</code> </td> </tr><tr><td>  Cygwin </td><td>  - </td><td> <code>C:\Programs\cygwin64\</code> </td> </tr><tr><td>  Sdl </td><td>  1.2.15 </td><td> <code>C:\Programs\SDL\{x32|x64}\</code> </td> </tr><tr><td>  rizo </td><td>  7.64.1 </td><td> <code>C:\Programs\curl\{x32|x64}\</code> </td> </tr><tr><td>  Openssl </td><td>  1.1.1b </td><td> <code>C:\Programs\OpenSSL\{x32|x64}\</code> </td> </tr><tr><td>  gSOAP </td><td>  2.8.82 </td><td> <code>C:\Programs\gSOAP\</code> </td> </tr><tr><td>  libvpx </td><td>  1.7.0 </td><td> <code>C:\Programs\libvpx\</code> </td> </tr><tr><td>  libopus </td><td>  1.3 </td><td> <code>C:\Programs\libopus\</code> </td> </tr><tr><td>  MiKTeX Portable </td><td>  2.9.6942 </td><td> <code>C:\Programs\MiKTeX\</code> </td> </tr><tr><td>  NASM </td><td>  2.14.02 x64 </td><td> <code>C:\Programs\nasm\</code> </td> </tr><tr><td>  DocBook XML DTD </td><td>  4.5 4.5 </td><td> <code>C:\Programs\DocBook\xml\</code> </td> </tr><tr><td>  Hojas de estilo DocBook XSL </td><td>  1.69.1 </td><td> <code>C:\Programs\DocBook\xsl\</code> </td> </tr></tbody></table><a name="environment-inst"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Aplicaciones Instalaci√≥n Quirks </h4><br>  Aqu√≠ proporciono algunas instrucciones sobre la instalaci√≥n de algunas de las herramientas antes mencionadas donde el procedimiento no es obvio o requiere acciones adicionales. <br><br><h5>  ‚Ä¢ Windows SDK v7.1 </h5>  La instalaci√≥n de este SDK probablemente fallar√° porque incluye las versiones obsoletas del compilador y las bibliotecas de tiempo de ejecuci√≥n.  Despu√©s de instalar VS 2010, hay versiones m√°s nuevas de las presentes en el sistema, por lo que las m√°s antiguas no se instalan y el instalador principal lo considera un error cr√≠tico.  Para solucionar este problema, debe desmarcar las casillas de verificaci√≥n correspondientes o, antes de instalar el SDK, desinstalar los paquetes nombrados como <i>"Microsoft Visual C ++ 2010 &lt;arch&gt; Redistributable"</i> , <i>"Microsoft Visual C ++ 2010 &lt;arch&gt; Runtime"</i> , <i>"Microsoft Compiladores de Visual C ++ ... "</i>  Deje que el SDK instale las versiones anteriores de esos y luego ejecute Windows Update para obtener las √∫ltimas versiones disponibles. <br><br>  Cuando instale el SDK, aseg√∫rese de verificar los ejemplos del programa (Windows Native Code Development -&gt; Samples): contienen algunos scripts utilizados por las reglas de compilaci√≥n de VB.  Sin ellos, no podr√° compilar los paquetes de MSI. <br><br><h5>  ‚Ä¢ Windows SDK v8.1 </h5>  Solo necesita instalar el componente "Kit de desarrollo de software de Windows". <br><br><h5>  ‚Ä¢ WDK v7.1 </h5>  Solo necesita instalar el componente "Construir entornos". <br><br><h5>  ‚Ä¢ Qt 5.6.3 </h5>  Comenzando con Qt 5.7.0, para compilarlo necesita Visual Studio 2012 o posterior, por lo que estamos atascados con 5.6.x. <br>  Como no hay compilaciones oficiales para Visual Studio 2010, tendremos que compilar Qt a partir del c√≥digo fuente nosotros mismos. <br><br><ol><li>  Descomprima el archivo de c√≥digo fuente Qt en <code>C:\Programs\Qt\</code> y cambie el nombre del directorio <code>qt-everywhere-opensource-src-5.6.3</code> a <code>5.6.3-src</code> . </li><li>  Al lado, cree un directorio <code>build-x32</code> donde tendr√° lugar la compilaci√≥n. </li><li>  Abra la consola y ejecute los siguientes comandos para preparar el entorno: <pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\Qt\build-x32 <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QTVER=<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span> "C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x86 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QTDIR=C:\Programs\Qt\<span class="hljs-variable"><span class="hljs-variable">%QTVER%</span></span>-x32 <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> <span class="hljs-built_in"><span class="hljs-built_in">PATH</span></span>=<span class="hljs-variable"><span class="hljs-variable">%QTDIR%</span></span>\bin;<span class="hljs-variable"><span class="hljs-variable">%PATH%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QMAKESPEC=win32-msvc2010</code> </pre>  El comando de <code>color</code> es opcional, elimina el color verde establecido por el script <code>SetEnv.Cmd</code> . </li><li>  Ahora necesitamos ejecutar el script <code>configure.bat</code> desde <code>5.6.3-src</code> .  VB no utiliza la mayor parte de lo que Qt incluye, por lo que podemos reducir significativamente el tiempo de compilaci√≥n al deshabilitar varios componentes, pero tenga en cuenta que algunas opciones son cruciales para VB.  Particularmente, he descubierto que: <ul><li>  OpenGL ES 2 no es compatible (al compilar VB, el compilador no puede encontrar algunos archivos de encabezado). </li><li>  El soporte de FreeType debe estar habilitado (de lo contrario, el complemento <code>qoffscreen</code> no se <code>qoffscreen</code> y es necesario para VB). </li></ul>  Esta es la l√≠nea de comando completa con la que termin√©: <pre> <code class="dos hljs">..\<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>-src\configure.bat -prefix c:\Programs\Qt\<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>-x32 -mp -opensource -confirm-license -nomake tests -nomake examples -no-compile-examples -release -shared -pch -no-ltcg -accessibility -no-sql-sqlite -opengl desktop -no-openvg -no-nis -no-iconv -no-evdev -no-mtdev -no-inotify -no-eventfd -largefile -no-system-proxies -qt-zlib -qt-pcre -no-icu -qt-libpng -qt-libjpeg -qt-freetype -no-fontconfig -qt-harfbuzz -no-angle -incredibuild-xge -no-plugin-manifests -qmake -qreal double -rtti -strip -no-ssl -no-openssl -no-libproxy -no-dbus -no-audio-backend -no-wmf-backend -no-qml-debug -no-direct2d -directwrite -no-style-fusion -native-gestures -skip qt3d -skip qtactiveqt -skip qtandroidextras -skip qtcanvas3d -skip qtconnectivity -skip qtdeclarative -skip qtdoc -skip qtenginio -skip qtgraphicaleffects -skip qtlocation -skip qtmacextras -skip qtmultimedia -skip qtquickcontrols -skip qtquickcontrols2 -skip qtscript -skip qtsensors -skip qtserialbus -skip qtserialport -skip qtwayland -skip qtwebchannel -skip qtwebengine -skip qtwebsockets -skip qtwebview -skip qtx11extras -skip qtxmlpatterns</code> </pre> </li><li>  La ruta de instalaci√≥n de Qt especificada aqu√≠ (en la opci√≥n <code>-prefix</code> ) est√° codificada en los archivos de c√≥digo fuente intermedio por el script de configuraci√≥n, por lo que los archivos binarios tambi√©n lo recordar√°n.  Cualquier aplicaci√≥n basada en Qt creada con esta biblioteca buscar√° primero los complementos necesarios en esa ruta, y solo si no se pueden encontrar, usar√° su propia ubicaci√≥n actual.  En la mayor√≠a de los casos esto est√° bien, pero supongamos que en la computadora donde est√° instalado nuestro VB, hay otra compilaci√≥n de Qt ubicada en <code>c:\Programs\Qt\5.6.3-x32</code> , pero compilada con diferentes opciones o por un compilador diferente.  Entonces VB intentar√° cargar esos complementos (incompatibles) y bloquearse. <br>  Hay dos formas posibles de evitar este problema.  Primero se agrega a la instalaci√≥n un archivo adicional llamado <code>qt.conf</code> con el siguiente texto: <pre> <code class="plaintext hljs">[Paths] Plugins=.</code> </pre>  La otra es arreglar esa ruta de instalaci√≥n guardada antes de construir Qt, de modo que apunte al directorio de la aplicaci√≥n.  Decid√≠ seguir el √∫ltimo camino, no me gustaba la idea de tener archivos adicionales a los que ten√≠a la distribuci√≥n Oracle VB.  <code>C:\Programs\Qt\build-x32\qtbase\src\corelib\global\qconfig.cpp</code> abrir el archivo <code>C:\Programs\Qt\build-x32\qtbase\src\corelib\global\qconfig.cpp</code> creado por el script de configuraci√≥n, busque la siguiente l√≠nea: <pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> qt_configure_prefix_path_str [<span class="hljs-number"><span class="hljs-number">512</span></span> + <span class="hljs-number"><span class="hljs-number">12</span></span>] = <span class="hljs-string"><span class="hljs-string">"qt_prfxpath=c:/Programs/Qt/5.6.3-x32"</span></span>;</code> </pre>  y reemplace la ruta con un solo punto, para que esta l√≠nea se vea as√≠: <pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> qt_configure_prefix_path_str [<span class="hljs-number"><span class="hljs-number">512</span></span> + <span class="hljs-number"><span class="hljs-number">12</span></span>] = <span class="hljs-string"><span class="hljs-string">"qt_prfxpath=."</span></span>;</code> </pre>  Este cambio solo afectar√° el comportamiento de tiempo de ejecuci√≥n de VB.  El paso de instalaci√≥n de Qt usar√° la ruta original, porque ahora est√° almacenada en los Makefiles que no modificamos. </li><li>  A continuaci√≥n, ejecute la compilaci√≥n con el comando <code>nmake</code> </li><li>  E instale la biblioteca construida usando <code>nmake install</code> </li></ol><br>  Ahora abra una nueva ventana de consola y haga lo mismo para la versi√≥n de 64 bits.  Deber√° reemplazar ‚Äúx32‚Äù con ‚Äúx64‚Äù en todas las rutas, y los comandos de preparaci√≥n del entorno se ver√°n as√≠: <pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">md</span></span> C:\Programs\Qt\build-x64 <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\Qt\build-x64 <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QTVER=<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span> "C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QTDIR=C:\Programs\Qt\<span class="hljs-variable"><span class="hljs-variable">%QTVER%</span></span>-x64 <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> <span class="hljs-built_in"><span class="hljs-built_in">PATH</span></span>=<span class="hljs-variable"><span class="hljs-variable">%QTDIR%</span></span>\bin;<span class="hljs-variable"><span class="hljs-variable">%PATH%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QMAKESPEC=win32-msvc2010</code> </pre> <br>  Una vez que haya terminado con la instalaci√≥n, se pueden eliminar los directorios <code>build-x32</code> , <code>build-x64</code> y <code>5.6.3-src</code> . <br><br><h5>  ‚Ä¢ MinGW </h5>  Simplemente descomprima los archivos de 32 y 64 bits en sus respectivos directorios de instalaci√≥n. <br><br><h5>  ‚Ä¢ Cygwin </h5>  Durante la instalaci√≥n, debe elegir los paquetes <code>make</code> y <code>yasm</code> . <br><br><h5>  ‚Ä¢ SDL </h5><ol><li>  Descomprima el archivo SDL dos veces en rutas separadas: <code>C:\Programs\SDL\x32\</code> y <code>C:\Programs\SDL\x64\</code> . </li><li>  Mueva todos los contenidos del subdirectorio <code>C:\Programs\SDL\x64\lib\x64\</code> a su directorio padre (es decir, a <code>C:\Programs\SDL\x64\lib\</code> ), luego elimine los subdirectorios <code>C:\Programs\SDL\x64\lib\x86</code> y <code>x64</code> . </li><li>  Haga lo mismo para la versi√≥n de 32 bits: mueva el contenido de <code>C:\Programs\SDL\x32\lib\x86\</code> a <code>C:\Programs\SDL\x32\lib\</code> , luego elimine <code>C:\Programs\SDL\x64\lib\x86</code> y <code>x64</code> . </li></ol><br><h5>  ‚Ä¢ NASM </h5>  Descomprima el archivo <code>nasm-2.14.02-win64.zip</code> en <code>C:\Programs\</code> , luego cambie el nombre del directorio resultante <code>nasm-2.14.02</code> como <code>nasm</code> . <br><br><h5>  ‚Ä¢ OpenSSL </h5><ol><li>  Descomprima el archivo OpenSSL en <code>C:\Programs\OpenSSL\</code> dos veces, renombrando las copias del directorio <code>openssl-1.1.1b</code> como <code>openssl-1.1.1b-x32</code> y <code>openssl-1.1.1b-x64</code> . </li><li>  Abra la consola, compile e instale la versi√≥n de 32 bits ejecutando: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x86 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-built_in"><span class="hljs-built_in">PATH</span></span>=<span class="hljs-variable"><span class="hljs-variable">%PATH%</span></span>;C:\Programs\nasm <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\OpenSSL\openssl-<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>b-x32\ perl Configure VC-WIN32 no-shared --prefix=C:\Programs\OpenSSL\x32 --openssldir=C:\Programs\OpenSSL\x32\ssl nmake nmake test nmake install</code> </pre>  Si el paso de configuraci√≥n genera una advertencia aterradora sobre un compilador faltante, por favor, ignore este mensaje, est√° mintiendo escandalosamente. <br>  Si no desea utilizar NASM, simplemente omita el comando con la modificaci√≥n <code>PATH</code> y, para el script <code>Configure</code> especifique el par√°metro adicional <code>no-asm</code> . </li><li>  Ahora abra una nueva ventana de consola y haga lo mismo para la versi√≥n de 64 bits: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-built_in"><span class="hljs-built_in">PATH</span></span>=<span class="hljs-variable"><span class="hljs-variable">%PATH%</span></span>;C:\Programs\nasm <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\OpenSSL\openssl-<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>b-x64\ perl Configure VC-WIN64A no-shared --prefix=C:\Programs\OpenSSL\x64 --openssldir=C:\Programs\OpenSSL\x64\ssl nmake nmake test nmake install</code> </pre>  Deshabilitar NASM es lo mismo que en 32 bits. </li><li>  Ahora puede eliminar los directorios <code>C:\Programs\OpenSSL\openssl-1.1.1b-x32</code> y <code>openssl-1.1.1b-x64</code> . </li></ol><br><h5>  ‚Ä¢ cURL </h5><ol><li>  Desempaquete el archivo cURL en <code>C:\Programs\curl\</code> y cambie el nombre del subdirectorio resultante <code>curl-7.64.1</code> a <code>curl-7.64.1-x32</code> . </li><li>  Abra el archivo <code>C:\Programs\curl\curl-7.64.1-x32\winbuild\MakefileBuild.vc</code> en un editor de texto y busque el siguiente bloque de c√≥digo (alrededor de las l√≠neas No.61‚Äì69): <pre> <code class="plaintext hljs">!IF "$(VC)"=="6" CC_NODEBUG = $(CC) /O2 /DNDEBUG CC_DEBUG = $(CC) /Od /Gm /Zi /D_DEBUG /GZ CFLAGS = /I. /I../lib /I../include /nologo /W4 /wd4127 /GX /DWIN32 /YX /FD /c /DBUILDING_LIBCURL !ELSE CC_NODEBUG = $(CC) /O2 /DNDEBUG CC_DEBUG = $(CC) /Od /D_DEBUG /RTC1 /Z7 /LDd CFLAGS = /I. /I ../lib /I../include /nologo /W4 /wd4127 /EHsc /DWIN32 /FD /c /DBUILDING_LIBCURL !ENDIF</code> </pre>  Despu√©s de estas l√≠neas agregue la nueva directiva: <pre> <code class="plaintext hljs">CFLAGS = $(CFLAGS) /DCURL_DISABLE_LDAP</code> </pre>  Si no lo hace, la compilaci√≥n de VB fallar√° con errores de enlace. </li><li>  Ahora abra el archivo <code>C:\Programs\curl\curl-7.64.1-x32\winbuild\gen_resp_file.bat</code> , y despu√©s de la primera l√≠nea ( <code>@echo OFF</code> ) inserte este comando: <pre> <code class="plaintext hljs">cd .</code> </pre>  No hace nada, excepto restablecer el c√≥digo <code>ERRORLEVEL</code> .  El script es tan simple que es posible que se complete sin ejecutar ning√∫n comando que cambie el c√≥digo de error.  Entonces, si ese c√≥digo no es cero antes de comenzar el script, mantendr√° su valor en la salida del script, y <code>nmake</code> pensar√≠a que fue el script el que devolvi√≥ este c√≥digo de error y finalizar√° la compilaci√≥n con un error.  Agregar ese <code>cd</code> falso soluciona el problema. </li><li>  Ahora haga una copia completa de <code>curl-7.64.1-x32</code> bajo el nombre <code>curl-7.64.1-x64</code> . </li><li>  Abra la consola, cree la versi√≥n de 32 bits y copie los archivos que necesitamos: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x86 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\curl\curl-<span class="hljs-number"><span class="hljs-number">7</span></span>.<span class="hljs-number"><span class="hljs-number">64</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>-x32\winbuild <span class="hljs-built_in"><span class="hljs-built_in">md</span></span> C:\Programs\curl\x32 nmake /f Makefile.vc <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span>=static WITH_SSL=static DEBUG=no MACHINE=x86 SSL_PATH=C:\Programs\OpenSSL\x32 ENABLE_SSPI=no ENABLE_WINSSL=no ENABLE_IDN=no <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> ..\builds\libcurl-vc-x86-release-static-ssl-static-ipv6\lib\libcurl_a.lib ..\..\x32\libcurl.lib <span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> /E ..\builds\libcurl-vc-x86-release-static-ssl-static-ipv6\include\curl ..\..\x32\include\curl\</code> </pre> </li><li>  Abra otra ventana de consola y cree la versi√≥n de 64 bits: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\curl\curl-<span class="hljs-number"><span class="hljs-number">7</span></span>.<span class="hljs-number"><span class="hljs-number">64</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>-x64\winbuild <span class="hljs-built_in"><span class="hljs-built_in">md</span></span> C:\Programs\curl\x64 nmake /f Makefile.vc <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span>=static WITH_SSL=static DEBUG=no MACHINE=x64 SSL_PATH=C:\Programs\OpenSSL\x64 ENABLE_SSPI=no ENABLE_WINSSL=no ENABLE_IDN=no <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> ..\builds\libcurl-vc-x64-release-static-ssl-static-ipv6\lib\libcurl_a.lib ..\..\x64\libcurl.lib <span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> /E ..\builds\libcurl-vc-x64-release-static-ssl-static-ipv6\include\curl ..\..\x64\include\curl\ <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> ..\builds\libcurl-vc-x64-release-static-ssl-static-ipv6\bin\curl.exe ..\..\x64\curl.exe</code> </pre>  Tenga en cuenta que, adem√°s de lo que hicimos para la versi√≥n de 32 bits, aqu√≠ tambi√©n copiamos el archivo <code>curl.exe</code> .  Lo usaremos m√°s tarde, para descargar la imagen de adiciones de invitados. </li><li>  Los directorios <code>C:\Programs\curl\curl-7.64.1-x32</code> y <code>curl-7.64.1-x64</code> ya no son necesarios y pueden eliminarse. </li></ol><br><h5>  ‚Ä¢ libvpx </h5><ol><li>  Descomprima el archivo libvpx en <code>C:\Programs\libvpx-build\</code> . </li><li>  Inicie el terminal Cygwin, la construcci√≥n se realizar√° all√≠.  Nuestra plataforma objetivo es Visual Studio 2010;  el sistema de compilaci√≥n lo admite solo parcialmente: intentar√° ejecutar la compilaci√≥n real usando <code>msbuild.exe</code> pero no funciona por alguna raz√≥n;  No pude averiguar por qu√©.  En cambio, simplemente podemos ejecutar Visual Studio y usarlo para construir el proyecto.  Afortunadamente, puede usarse desde la l√≠nea de comandos, por lo que no es necesario iniciar el IDE real (aunque puede hacerlo si lo desea, en cuyo caso deber√° modificar la variable <code>PATH</code> y agregar la ruta <code>C:\Programs\cygwin64\bin</code> a √©l, o de cualquier otra manera, permita que VS encuentre <code>yasm.exe</code> ubicado all√≠ y requerido para la compilaci√≥n).  Entonces, para realizar la construcci√≥n de ambas arquitecturas, ejecute los siguientes comandos en el terminal Cygwin: <pre> <code class="bash hljs">mkdir -p /cygdrive/c/Programs/libvpx-build/build32 <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /cygdrive/c/Programs/libvpx-build/build32 ../libvpx-1.7.0/configure --target=x86-win32-vs10 --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-install-bins --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-examples --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-tools --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-docs --prefix=../../libvpx make <span class="hljs-string"><span class="hljs-string">"/cygdrive/c/Program Files (x86)/Microsoft Visual Studio 10.0/Common7/IDE/devenv.com"</span></span> vpx.sln /Project vpx.vcxproj /Rebuild <span class="hljs-string"><span class="hljs-string">"Release|Win32"</span></span> make install mkdir -p /cygdrive/c/Programs/libvpx-build/build64 <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /cygdrive/c/Programs/libvpx-build/build64 ../libvpx-1.7.0/configure --target=x86_64-win64-vs10 --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-install-bins --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-examples --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-tools --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-docs --prefix=../../libvpx make <span class="hljs-string"><span class="hljs-string">"/cygdrive/c/Program Files (x86)/Microsoft Visual Studio 10.0/Common7/IDE/devenv.com"</span></span> vpx.sln /Project vpx.vcxproj /Rebuild <span class="hljs-string"><span class="hljs-string">"Release|x64"</span></span> make install</code> </pre> </li><li>  Cierra Cygwin, ya no la necesitaremos.  El directorio <code>C:\Programs\libvpx-build</code> se puede eliminar. </li></ol><br><h5>  ‚Ä¢ libopus </h5><ol><li>  Descomprima el archivo opus en <code>C:\Programs\libopus-build\</code> , vaya al subdirectorio <code>opus-1.3\win32\VS2015</code> . </li><li>  Este proyecto est√° dise√±ado para la versi√≥n m√°s nueva de Visual Studio, por lo que debemos modificarlo para que se compile en nuestra versi√≥n 2010. Puede hacerlo utilizando el IDE o un editor de texto sin formato.  Eleg√≠ el √∫ltimo.  Abra el archivo <code>opus.vcxproj</code> y haga lo siguiente: <ol><li>  Encuentra todas las l√≠neas que contienen el texto <pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PlatformToolset</span></span></span><span class="hljs-tag">&gt;</span></span>v140<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PlatformToolset</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>  y reemplazar <code>v140</code> con <code>v100</code> .  Si est√° utilizando IDE, esta es la opci√≥n de configuraci√≥n "Platrofm Toolset" ubicada en la p√°gina Propiedades de configuraci√≥n -&gt; General.  No se olvide de los selectores de Configuraci√≥n y Plataforma en la parte superior del cuadro de di√°logo. </li><li>  A continuaci√≥n, busque este bloque de c√≥digo: <pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemDefinitionGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ClCompile</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>  y agregue una nueva etiqueta dentro de ella: <pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DebugInformationFormat</span></span></span><span class="hljs-tag">&gt;</span></span>ProgramDatabase<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DebugInformationFormat</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>  En el IDE puede hacerlo abriendo la p√°gina Propiedades de configuraci√≥n -&gt; C / C ++ -&gt; General y configurando "Formato de informaci√≥n de depuraci√≥n" en "ProgramDatabase (/ Zi)".  En realidad, puede establecerlo en cualquier otro valor v√°lido, no necesitamos la base de datos de depuraci√≥n en absoluto, pero con un valor no v√°lido, el proyecto no se podr√° construir. </li></ol></li><li>  Ahora construyamos la versi√≥n Release para ambas plataformas (usando VS IDE o la l√≠nea de comando) y <code>opus.lib</code> la biblioteca <code>opus.lib</code> y el subdirectorio <code>include\</code> en nuestra ruta de destino: <pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\libopus-build\opus-<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>\win32\VS2015 <span class="hljs-built_in"><span class="hljs-built_in">md</span></span> C:\Programs\libopus\lib\x64 <span class="hljs-built_in"><span class="hljs-built_in">md</span></span> C:\Programs\libopus\lib\Win32 <span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> /EC:\Programs\libopus-build\opus-<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>\include C:\Programs\libopus\include\ "C:\Program Files (x86)\Microsoft Visual Studio <span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>\Common7\IDE\devenv.com" opus.sln /Project opus.vcxproj /Rebuild "Release|x64" <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> x64\Release\opus.lib C:\Programs\libopus\lib\x64\ "C:\Program Files (x86)\Microsoft Visual Studio <span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>\Common7\IDE\devenv.com" opus.sln /Project opus.vcxproj /Rebuild "Release|Win32" <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> Win32\Release\opus.lib C:\Programs\libopus\lib\Win32\</code> </pre> </li><li>  El directorio <code>C:\Programs\libopus-build</code> se puede eliminar. </li></ol><br><h5>  ‚Ä¢ gSOAP </h5>  Abra el archivo, vaya al subdirectorio <code>gsoap-2.8\gsoap</code> y descomprima su contenido en <code>C:\Programs\gSOAP\</code> .  OpenSSL 1.1.x requiere gSOAP versi√≥n 2.8.41 o superior.  Si por alguna raz√≥n desea utilizar una versi√≥n anterior, deber√° aplicar el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">parche</a> creado por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mattias Ellert</a> .  La aplicaci√≥n de un parche se puede hacer manualmente (el formato es f√°cil: abra los archivos mencionados, elimine las l√≠neas marcadas con menos, agregue l√≠neas marcadas con m√°s; el resto es contexto) u obtenga la herramienta de <code>patch</code> portada para Windows y √∫sela. <br><br><h5>  ‚Ä¢ MiKTeX </h5><ol><li>  Descomprima el archivo en <code>C:\Programs\MiKTeX\</code> . </li><li>  Abra la consola e instale m√≥dulos adicionales: <pre> <code class="dos hljs">"C:\Programs\MiKTeX\texmfs\install\miktex\bin\mpm.exe" --verbose --install=koma-script --install=ucs --install=tabulary --install=url --install=fancybox --install=fancyvrb --install=bera --install=charter --install=mptopdf</code> </pre> </li></ol><br><h5>  ‚Ä¢ DocBook </h5>  Para XML DTD, debe crear un directorio y descomprimir el contenido del archivo all√≠.  Para las hojas de estilo XSL, todo el contenido ya est√° en un solo directorio, por lo que debe extraerlo y cambiarle el nombre despu√©s. <br><br><a name="final-touches"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Toques finales </h4><br>  El entorno de construcci√≥n est√° casi listo, solo se necesitan unos pocos pasos m√°s.  Descargue el archivo de c√≥digo fuente de VirtualBox (si a√∫n no lo ha hecho) y descompr√≠malo donde desee trabajar.  Eleg√≠ <code>C:\Devel\</code> para ese prop√≥sito, puse all√≠ los c√≥digos fuente desempaquetados y renombr√© el subdirectorio a <code>VirtualBox-src</code> . <br><br><h5>  ‚Ä¢ Agregar certificados </h5><br>  Si no tiene un certificado pagado, le recomiendo que cree al menos uno personal autofirmado: es m√°s f√°cil hacer que Windows cargue controladores autofirmados que los no firmados.  Para hacerlo, abra la consola con privilegios elevados y ejecute los siguientes comandos que agregar√°n dos certificados (SHA-1 y SHA-256) e imp√≥rtelos a su almacenamiento personal: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> makecert.exe -a sha1 -r -pe -ss my -n "CN=Roga and Kopyta Ltd" C:\Devel\testcert_1.cer makecert.exe -a sha256 -r -pe -ss my -n "CN=Roga and Kopyta Ltd" C:\Devel\testcert_256.cer certmgr.exe -add C:\Devel\testcert_1.cer -s -r localMachine root certmgr.exe -add C:\Devel\testcert_256.cer -s -r localMachine root</code> </pre>  Por supuesto, puede elegir su propio nombre para los certificados en lugar de "Roga and Kopyta Ltd", y la ruta para almacenar los archivos.  Ahora necesitamos obtener las huellas digitales de los certificados generados.  Abra la consola de administraci√≥n de Certificados (ejecutando <code>certmgr.msc</code> ) y navegue al Almacenamiento personal.  Ver√° los dos nuevos certificados llamados "Roga y Kopyta Ltd" all√≠.  Haga doble clic en el primero;  en el cuadro de di√°logo que aparece, vaya a la pesta√±a <i>Detalles</i> .  El campo "Algoritmo de firma" contiene el nombre del algoritmo: sha256RSA o sha1RSA.  Despl√°cese hacia abajo para el campo "Huella digital" que contiene la secuencia de n√∫meros hexadecimales.  Copie este valor completo y escr√≠balo en alguna parte.  Haga lo mismo para el segundo certificado;  no olvide marcar qu√© huella digital fue para SHA-1 y cu√°l para SHA-256. <br><br><h5>  ‚Ä¢ Construyendo xmllint </h5><br>  Uno de los pasos de compilaci√≥n necesitar√° el programa <code>xmllint</code> .  No lo puse en la lista de requisitos de compilaci√≥n porque sus fuentes est√°n incluidas en el archivo de VirtualBox.  Pero a√∫n tendr√° que construirlo usted mismo, porque las reglas de compilaci√≥n de VB no lo hacen.  Eleg√≠ <code>C:\Programs\xmllint</code> como directorio de destino. <ol><li>  Copie el directorio <code>C:\Devel\VirtualBox-src\src\libs\libxml2-2.9.4</code> en <code>C:\Programs\</code> para asegurarse de que su compilaci√≥n no afecte a VB de ninguna manera. </li><li>  Abra la consola y ejecute los siguientes comandos: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\libxml2-<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">9</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span>\win32 cscript.exe configure.js cruntime=/MT prefix=C:\Programs\xmllint iconv=no nmake /f Makefile.msvc nmake /f Makefile.msvc install</code> </pre> </li><li>  Elimine el directorio <code>C:\Programs\libxml2-2.9.4</code> . </li></ol><br><h5>  ‚Ä¢ Modificaciones de archivos VB </h5><br>  Antes de comenzar la compilaci√≥n, tambi√©n debemos introducir algunos cambios en el c√≥digo fuente de VB.  El conjunto completo de ellos se presenta aqu√≠ como un archivo de parche descargable que se puede aplicar de forma manual o mediante la herramienta de <code>patch</code> (que debe descargar por separado): <br><br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b>Vbox_build.patch</b></a> <br><br>  Si no hubo problemas al aplicar el parche, puede saltar al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">siguiente paso</a> .  Sin embargo, si tuvo algunos problemas y necesita m√°s informaci√≥n sobre cambios particulares, o si simplemente quiere entender qu√© se est√° cambiando y por qu√©, puede continuar y leer los detalles que se proporcionan a continuaci√≥n.  Tenga en cuenta que los cambios vienen aqu√≠ en un orden diferente en comparaci√≥n con el archivo de revisi√≥n.  Las rutas a los archivos se especifican en relaci√≥n con el directorio de c√≥digo fuente de VB <code>C:\Devel\VirtualBox-src</code> . <ol><li>  Archivo <code>configure.vbs</code> : <ul><li>  La l√≠nea de c√≥digo: <pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Shell(DosSlashes(strPathVC &amp; <span class="hljs-string"><span class="hljs-string">"/bin/cl.exe"</span></span>), <span class="hljs-literal"><span class="hljs-literal">True</span></span>) &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span></code> </pre>  se reemplaza por: <pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Shell(DosSlashes(strPathVC &amp; <span class="hljs-string"><span class="hljs-string">"/bin/cl.exe"</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">" /?"</span></span>, <span class="hljs-literal"><span class="hljs-literal">True</span></span>) &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span></code> </pre>  Esta l√≠nea realiza la comprobaci√≥n del compilador, pero olvida que <code>cl.exe</code> sin ning√∫n argumento devuelve un error y, por lo tanto, se considera un compilador no v√°lido.  Agregar el " <code>/?</code>  "El argumento hace que env√≠e la ayuda y salga con el c√≥digo 0 sin error. </li><li>  Ahora pasemos a la funci√≥n <code>CheckForMinGW32Sub</code> .  Como su nombre lo indica, verifica la validez del MinGW de 32 bits.  Sin embargo, est√° dise√±ado para la versi√≥n 3.3.3, mientras estoy usando 4.5.4 que tiene una estructura de archivo / directorio diferente, por lo que he reemplazado toda la funci√≥n con el siguiente c√≥digo (que es b√°sicamente una copia de <code>CheckForMinGWw64Sub</code> adaptado para el Variante de 32 bits): <pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> CheckForMinGW32Sub(strPathMingW32, strPathW32API) g_strSubOutput = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> strPathW32API = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> strPathW32API = strPathMingW32 LogPrint <span class="hljs-string"><span class="hljs-string">"trying: strPathMingW32="</span></span> &amp;strPathMingW32 &amp; <span class="hljs-string"><span class="hljs-string">" strPathW32API="</span></span> &amp; strPathW32API <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/gcc.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/ld.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/objdump.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/dllwrap.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/dlltool.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/as.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"include/bfd.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"lib32/libgcc_s.a"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/lib/dllcrt1.o"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/lib/dllcrt2.o"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/lib/libmsvcrt.a"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/lib/libmsvcr100.a"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/include/_mingw.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/include/stdint.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/include/windows.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Shell(DosSlashes(strPathMingW32 &amp; <span class="hljs-string"><span class="hljs-string">"/bin/gcc.exe"</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">" -dumpversion"</span></span>, <span class="hljs-literal"><span class="hljs-literal">True</span></span>) = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> offVer, iMajor, iMinor, iPatch, strVer <span class="hljs-comment"><span class="hljs-comment">' extract the version. strVer = Trim(Replace(Replace(g_strShellOutput, vbCr, ""), vbLf, "")) if (Mid(strVer, 2, 1) = ".") _ And (Mid(strVer, 4, 1) = ".") then iMajor = Int(Left(strVer, 1)) ' Is Int() the right thing here? I want atoi()!!! iMinor = Int(Mid(strVer, 3, 1)) iPatch = Int(Mid(strVer, 5)) else LogPrint "Malformed version: '" &amp; strVer &amp; "'" strVer = "" end if if strVer &lt;&gt; "" then if (iMajor = 4) And (iMinor &gt;= 4) then CheckForMinGW32Sub = True g_strSubOutput = strVer else LogPrint "MinGW32 version '" &amp; iMajor &amp; "." &amp; iMinor &amp; "." &amp; iPatch &amp; "' is not supported (or configure.vbs failed to parse it correctly)." end if else LogPrint "Couldn't locate the GCC version in the output!" end if else LogPrint "Failed to run gcc.exe!" end if end if end function</span></span></code> </pre> </li><li>  Nuestra siguiente funci√≥n es <code>CheckForCurlSub</code> , y el bloque de c√≥digo a editar es: <pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> LogFileExists(strPathCurl, <span class="hljs-string"><span class="hljs-string">"include/curl/curl.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFindFile(strPathCurl, <span class="hljs-string"><span class="hljs-string">"libcurl.dll"</span></span>) &lt;&gt; <span class="hljs-string"><span class="hljs-string">""</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFindFile(strPathCurl, <span class="hljs-string"><span class="hljs-string">"libcurl.lib"</span></span>) &lt;&gt; <span class="hljs-string"><span class="hljs-string">""</span></span> _</code> </pre>  Comprueba la validez de libcurl, pero requiere una versi√≥n vinculada din√°micamente y falla si no se puede encontrar un archivo DLL.  Estamos utilizando una versi√≥n vinculada est√°ticamente, por lo que la comprobaci√≥n de la DLL lamentablemente tiene que irse y dejarnos con: <pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> LogFileExists(strPathCurl, <span class="hljs-string"><span class="hljs-string">"include/curl/curl.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFindFile(strPathCurl, <span class="hljs-string"><span class="hljs-string">"libcurl.lib"</span></span>) &lt;&gt; <span class="hljs-string"><span class="hljs-string">""</span></span> _</code> </pre> </li><li>  Ahora ingrese a la funci√≥n <code>CheckForPython</code> donde se genera la variable <code>VBOX_BLD_PYTHON</code> : <pre> <code class="vbscript hljs"> CfgPrint <span class="hljs-string"><span class="hljs-string">"VBOX_BLD_PYTHON := "</span></span> &amp; strPathPython &amp; <span class="hljs-string"><span class="hljs-string">"\python.exe"</span></span></code> </pre>  La barra diagonal inversa frente a <code>python.exe</code> debe reemplazarse por la siguiente: <code>"/python.exe"</code> (sin esta soluci√≥n, algunas comprobaciones durante el proceso de compilaci√≥n fallar√°n; no he notado ning√∫n otro efecto negativo, pero es m√°s bonito sin mensajes de error, y en cualquier caso m√°s vale prevenir que curar). </li><li>  La versi√≥n de Windows del script de configuraci√≥n no es compatible con libvpx y libopus, as√≠ que los agregu√© yo mismo.  Por supuesto, la forma m√°s simple era simplemente codificar rutas de acceso a las bibliotecas, pero prefer√≠ implementarlo al igual que el resto de los componentes, pasando la ruta en la l√≠nea de comando y comprobaciones de validez adecuadas.  El c√≥digo principal para esto consiste en las dos funciones de verificaci√≥n: <pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">'' ' Checks for libvpx sub CheckForVpx(strOptVpx) dim strPathVpx, str strVpx = "libvpx" PrintHdr strVpx if strOptVpx = "" then MsgError "Invalid path specified!" exit sub end if if g_strTargetArch = "amd64" then strVsBuildArch = "x64" else strVsBuildArch = "Win32" end if strLibPathVpx = "lib/" &amp; strVsBuildArch &amp; "/vpxmd.lib" strPathVpx = "" if LogFileExists(strOptVpx, "include/vpx/vpx_encoder.h") _ And LogFileExists(strOptVpx, strLibPathVpx) _ then strPathVpx = UnixSlashes(PathAbs(strOptVpx)) CfgPrint "SDK_VBOX_VPX_INCS := " &amp; strPathVpx &amp; "/include" CfgPrint "SDK_VBOX_VPX_LIBS := " &amp; strPathVpx &amp; "/" &amp; strLibPathVpx else MsgError "Can't locate " &amp; strVpx &amp; ". " _ &amp; "Please consult the configure.log and the build requirements." exit sub end if PrintResult strVpx, strPathVpx end sub '' ' Checks for libopus sub CheckForOpus(strOptOpus) dim strPathOpus, str strOpus = "libopus" PrintHdr strOpus if strOptOpus = "" then MsgError "Invalid path specified!" exit sub end if if g_strTargetArch = "amd64" then strVsBuildArch = "x64" else strVsBuildArch = "Win32" end if strLibPathOpus = "lib/" &amp; strVsBuildArch &amp; "/opus.lib" strPathOpus = "" if LogFileExists(strOptOpus, "include/opus.h") _ And LogFileExists(strOptOpus, strLibPathOpus) _ then strPathOpus = UnixSlashes(PathAbs(strOptOpus)) CfgPrint "SDK_VBOX_OPUS_INCS := " &amp; strPathOpus &amp; "/include" CfgPrint "SDK_VBOX_OPUS_LIBS := " &amp; strPathOpus &amp; "/" &amp; strLibPathOpus else MsgError "Can't locate " &amp; strOpus &amp; ". " _ &amp; "Please consult the configure.log and the build requirements." exit sub end if PrintResult strOpus, strPathOpus end sub</span></span></code> </pre>  El <code>usage</code> funci√≥n se utiliza para imprimir la lista de argumentos de la l√≠nea de comandos;  agregue nuestros dos nuevos argumentos all√≠: <pre> <code class="vbscript hljs"> Print <span class="hljs-string"><span class="hljs-string">" --with-libvpx=PATH "</span></span> Print <span class="hljs-string"><span class="hljs-string">" --with-libopus=PATH "</span></span></code> </pre>  Al comienzo de la funci√≥n <code>Main</code> muchas variables se definen para almacenar rutas a los componentes, necesitamos agregar dos nuevas all√≠: <pre> <code class="vbscript hljs"> strOptVpx = <span class="hljs-string"><span class="hljs-string">""</span></span> strOptOpus = <span class="hljs-string"><span class="hljs-string">""</span></span></code> </pre>  Un poco m√°s abajo va el bloque de <code>select-case</code> que procesa los argumentos y completa las variables;  agregando nuestra contribuci√≥n: <pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"--with-libvpx"</span></span> strOptVpx = strPath <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"--with-libopus"</span></span> strOptOpus = strPath</code> </pre>  Y, finalmente, casi al final del archivo est√° la cadena de todas esas llamadas de funci√≥n de verificaci√≥n, aqu√≠ es donde agregamos la llamada de nuestras dos nuevas funciones: <pre> <code class="vbscript hljs"> CheckForVpx strOptVpx CheckForOpus strOptOpus</code> </pre> </li></ul></li><li>  El siguiente archivo es <code>src\VBox\Runtime\Makefile.kmk</code> .  Necesitamos encontrar las definiciones de las variables <code>VBoxRT_LIBS.win</code> y <code>VBoxRT-x86_LIBS.win</code> , y agregarles dos nuevas bibliotecas, <code>crypt32.lib</code> y <code>bcrypt.lib</code> .  Entonces el siguiente c√≥digo: <pre> <code class="plaintext hljs">VBoxRT_LIBS.win = \ $(PATH_SDK_$(VBOX_WINDDK)_LIB)/vccomsup.lib \ $(PATH_SDK_$(VBOX_WINDDK)_LIB)/wbemuuid.lib \ $(PATH_TOOL_$(VBOX_VCC_TOOL)_LIB)/delayimp.lib</code> </pre>  se convierte en: <pre> <code class="plaintext hljs">VBoxRT_LIBS.win = \ $(PATH_SDK_$(VBOX_WINDDK)_LIB)/vccomsup.lib \ $(PATH_SDK_$(VBOX_WINDDK)_LIB)/wbemuuid.lib \ $(PATH_TOOL_$(VBOX_VCC_TOOL)_LIB)/delayimp.lib \ $(PATH_SDK_$(VBOX_WINPSDK)_LIB)/crypt32.lib \ $(PATH_SDK_$(VBOX_WINPSDK)_LIB)/bcrypt.lib</code> </pre>  (¬°no te pierdas la barra diagonal inversa posterior despu√©s de <code>delayimp.lib</code> !);  y, respectivamente, este bloque: <pre> <code class="plaintext hljs">VBoxRT-x86_LIBS.win = \ $(PATH_SDK_$(VBOX_WINDDK)_LIB.x86)/vccomsup.lib \ $(PATH_SDK_$(VBOX_WINDDK)_LIB.x86)/wbemuuid.lib \ $(PATH_TOOL_$(VBOX_VCC_TOOL_STEM)X86_LIB)/delayimp.lib</code> </pre>  se convierte en: <pre> <code class="plaintext hljs">VBoxRT-x86_LIBS.win = \ $(PATH_SDK_$(VBOX_WINDDK)_LIB.x86)/vccomsup.lib \ $(PATH_SDK_$(VBOX_WINDDK)_LIB.x86)/wbemuuid.lib \ $(PATH_TOOL_$(VBOX_VCC_TOOL_STEM)X86_LIB)/delayimp.lib \ $(PATH_SDK_$(VBOX_WINPSDK)_LIB.x86)/crypt32.lib \ $(PATH_SDK_$(VBOX_WINPSDK)_LIB.x86)/bcrypt.lib</code> </pre>  Este cambio es necesario para un enlace exitoso de <code>VBoxRT.dll</code> .  No estoy 100% seguro de por qu√© es as√≠, la versi√≥n de Oracle no tiene la dependencia del tiempo de carga en <code>crypt32.dll</code> , se carga en tiempo de ejecuci√≥n, por lo que el archivo LIB no deber√≠a ser necesario.  Sin embargo, sin √©l, el enlazador no puede encontrar algunas funciones y falla.  Sospecho que podr√≠a estar relacionado con las opciones de compilaci√≥n de OpenSSL, pero no lo he comprobado, agregar la dependencia es m√°s f√°cil.  Y la segunda dependencia, <code>bcrypt.dll</code> , es un requisito para el nuevo OpenSSL 1.1.1. </li><li>  Si tiene gSOAP de la versi√≥n 2.8.79 o superior, tendr√° que editar el archivo <code>src\VBox\Runtime\r3\win\VBoxRT-openssl-1.1plus.def</code> y agregar las siguientes l√≠neas a la lista de exportaciones: <pre> <code class="plaintext hljs"> OpenSSL_version_num DH_generate_parameters_ex DH_new ASN1_STRING_get0_data</code> </pre>  Esta lista define qu√© funciones exporta la biblioteca <code>VBoxRT.dll</code> (que contiene OpenSSL en su interior).  Cuando se <code>VBoxWebSrv.exe</code> herramienta <code>VBoxWebSrv.exe</code> , dependiendo de la versi√≥n de gSOAP, puede requerir funciones adicionales de OpenSSL.  Dado que faltan en la lista de exportaciones, el vinculador agrega OpenSSL e inmediatamente se queja de toneladas de conflictos entre este OpenSSL externo y su propia copia ya integrada en <code>VBoxRT</code> .  Agregar las exportaciones antes mencionadas soluciona el problema. </li><li>  Como mencion√© al principio, no construyo las adiciones de invitados, pero necesito tener su imagen ISO como parte de la distribuci√≥n.  Las reglas de compilaci√≥n est√°n dise√±adas para este escenario, pero esperan que la imagen ISO lista aparezca m√°gicamente en el lugar correcto en el momento correcto.  He agregado esta magia en el archivo <code>src\VBox\Makefile.kmk</code> .  Busque el siguiente c√≥digo: <pre> <code class="plaintext hljs"> ifdef VBOX_WITH_ADDITIONS include $(PATH_SUB_CURRENT)/Additions/Makefile.kmk endif</code> </pre>  y justo debajo va la regla para la descarga autom√°tica del archivo de imagen: <pre> <code class="plaintext hljs"> ifndef VBOX_WITHOUT_ADDITIONS_ISO $(VBOX_PATH_ADDITIONS_ISO)/VBoxGuestAdditions.iso: $(QUIET)$(MKDIR) -p $(@D) $(VBOX_RETRY) $(TOOL_CURL_FETCH) http://download.virtualbox.org/virtualbox/$(VBOX_VERSION_STRING_RAW)/VBoxGuestAdditions_$(VBOX_VERSION_STRING_RAW).iso -o $@ endif</code> </pre>  Si edita los archivos manualmente en lugar de aplicar el parche, tenga en cuenta que los comandos de la regla deben comenzar con el car√°cter de tabulaci√≥n. </li><li>  Antes de la versi√≥n 6.0, la documentaci√≥n era uno de los subsistemas que se construy√≥ con √©xito sin ning√∫n cambio.  No s√© qu√© estaba mal con eso, pero fue significativamente redise√±ado de tal manera que ya no funciona en mi sistema de compilaci√≥n.  No tengo idea de c√≥mo los propios Oracle compilan la documentaci√≥n (tal vez en un sistema * NIX), pero para m√≠ las reglas de compilaci√≥n segu√≠an perdiendo barras en las rutas o agregando un exceso de ellas, y como resultado no pudieron encontrar los archivos de destino debido a desajustes en los archivos de cat√°logo.  Finalmente logr√© combinar algunos cambios que permitieron construir la documentaci√≥n sin errores.  En primer lugar, faltaba uno de los directorios de destino, por lo que no se pudieron crear algunos de los archivos intermedios.  Este problema se soluciona en el archivo <code>doc\manual\Makefile.kmk</code> , dentro del siguiente bloque de c√≥digo: <pre> <code class="plaintext hljs">define def_vbox_refentry_to_user_sect1 $$(VBOX_PATH_MANUAL_OUTBASE)/$(1)/user_$(2): $(3) \ $$(VBOX_PATH_MANUAL_SRC)/docbook-refentry-to-manual-sect1.xsl \ $$(VBOX_XML_CATALOG) $$(VBOX_XML_CATALOG_DOCBOOK) $$(VBOX_XML_CATALOG_MANUAL) \ $$(VBOX_VERSION_STAMP) | $$(dir $$@) $$(call MSG_TOOL,xsltproc $$(notdir $$(filter %.xsl,$$^)),,$$(filter %.xml,$$^),$$@) $$(QUIET)$$(RM) -f "$$@" $$(QUIET)$$(call VBOX_XSLTPROC_WITH_CAT) --output $$@ $$(VBOX_PATH_MANUAL_SRC)/docbook-refentry-to-manual-sect1.xsl $$&lt; endef</code> </pre>  Justo despu√©s del <code>$$(RM)</code> he agregado un comando para crear el directorio que falta: <pre> <code class="plaintext hljs"> $$(QUIET)$$(MKDIR) -p "$$(@D)"</code> </pre> <br>  En cuanto a las barras, las correcciones se encuentran en el archivo <code>doc\manual\Config.kmk</code> .  No pude encontrar una soluci√≥n "normal" para eso, pero hay una soluci√≥n lo suficientemente buena para fines pr√°cticos, lo que implica duplicar las reglas de sustituci√≥n de ruta para las rutas incorrectas.  Primero, debajo de la l√≠nea: <pre> <code class="plaintext hljs"> VBOX_FILE_URL_MAYBE_SLASH = $(if $(eq $(KBUILD_HOST),win),/,)</code> </pre> I've created two new variables which basically contain the same paths as their origins, but with triple slash after the disk letter instead of a single slash: <pre> <code class="plaintext hljs"> VBOX_PATH_MANUAL_SRC_SLASHED = $(subst :/,:///,$(VBOX_PATH_MANUAL_SRC)) VBOX_PATH_MANUAL_OUTBASE_SLASHED = $(subst :/,:///,$(VBOX_PATH_MANUAL_OUTBASE))</code> </pre> A little bit below that, there is a rule for creating the catalog file: <pre> <code class="plaintext hljs"> $(VBOX_XML_CATALOG): $(MAKEFILE_CURRENT) | $$(dir $$@) $(call MSG_L1,Creating catalog $@) $(QUIET)$(APPEND) -tn "$@" \ '&lt;?xml version="1.0"?&gt;' \ '&lt;!DOCTYPE catalog PUBLIC "-//OASIS//DTD Entity Resolution XML Catalog V1.0//EN" "http://www.oasis-open.org/committees/entity/release/1.0/catalog.dtd"&gt;' \ '&lt;catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog"&gt;' \ ' &lt;delegatePublic publicIdStartString="-//OASIS/ENTITIES DocBook XML" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegatePublic publicIdStartString="-//OASIS/DTD DocBook XML" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateSystem systemIdStartString="http://www.oasis-open.org/docbook/" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateURI uriStartString="http://www.oasis-open.org/docbook/" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateSystem systemIdStartString="$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_OUTBASE)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ '&lt;/catalog&gt;'</code> </pre> For each line which contains the variable <code>VBOX_PATH_MANUAL_SRC</code> or <code>VBOX_PATH_MANUAL_OUTBASE</code> (except for the line with the <code>file://</code> prefix), I've appended the copy of the whole line, but with the variable replaced with its triple-slash counterpart. The result looks like this: <pre> <code class="plaintext hljs"> $(VBOX_XML_CATALOG): $(MAKEFILE_CURRENT) | $$(dir $$@) $(call MSG_L1,Creating catalog $@) $(QUIET)$(APPEND) -tn "$@" \ '&lt;?xml version="1.0"?&gt;' \ '&lt;!DOCTYPE catalog PUBLIC "-//OASIS//DTD Entity Resolution XML Catalog V1.0//EN" "http://www.oasis-open.org/committees/entity/release/1.0/catalog.dtd"&gt;' \ '&lt;catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog"&gt;' \ ' &lt;delegatePublic publicIdStartString="-//OASIS/ENTITIES DocBook XML" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegatePublic publicIdStartString="-//OASIS/DTD DocBook XML" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateSystem systemIdStartString="http://www.oasis-open.org/docbook/" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateURI uriStartString="http://www.oasis-open.org/docbook/" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateSystem systemIdStartString="$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateSystem systemIdStartString="$(VBOX_PATH_MANUAL_SRC_SLASHED)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_SRC_SLASHED)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_OUTBASE)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_OUTBASE_SLASHED)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ '&lt;/catalog&gt;'</code> </pre> Even further down, there is another rule for creating an auxiliary catalog file; the starting line is: <pre> <code class="plaintext hljs"> $(VBOX_XML_CATALOG_MANUAL): $(MAKEFILE_CURRENT) | $$(dir $$@)</code> </pre> Here I'm doing the same operation as above. In addition, in the beginning of the generated file there are several lines defining the entries in the <code>common/</code> subdirectory: <pre> <code class="plaintext hljs"> ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC)/common/oracle-accessibility-en.xml" uri="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-accessibility-en.xml"/&gt;' \ ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC)/common/oracle-support-en.xml" uri="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-support-en.xml"/&gt;' \</code> </pre> With these we have the opposite problem: triple slash after the <code>file</code> is replaced with a single slash. I worked this around by getting rid of the <code>file</code> protocol altogether and replacing those URIs with direct file system paths in the target address (the <code>uri</code> attribute). The result for these lines looks like this (including the aforementioned fix): <pre> <code class="plaintext hljs"> ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC)/common/oracle-accessibility-en.xml" uri="$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-accessibility-en.xml"/&gt;' \ ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC_SLASHED)/common/oracle-accessibility-en.xml" uri="$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-accessibility-en.xml"/&gt;' \ ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC)/common/oracle-support-en.xml" uri="$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-support-en.xml"/&gt;' \ ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC_SLASHED)/common/oracle-support-en.xml" uri="$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-support-en.xml"/&gt;' \</code> </pre> </li><li> When VB is built with signing, most of its binaries receive the integrity check flag (the linker option <code>/IntegrityCheck</code> ) which forces Windows to check digital signatures and forbids launching applications which are signed incorrectly. If you have a valid paid certificate that's not a problem; however with a self-signed certificate VB will refuse to start, even if Windows is booted in the test mode. I've modified the file <code>Config.kmk</code> in such a way that this flag is only added when you have a full-grown certificate (the criterion of that is presence of a cross-certificate in <code>LocalConfig.kmk</code> ; see <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">below</a> ). The changes look like this: <ul><li> A new variable <code>VBOX_INTEGRITY_CHECK</code> is added, which contains the desired value of the option: <pre> <code class="plaintext hljs">if defined(VBOX_SIGNING_MODE) &amp;&amp; defined(VBOX_CROSS_CERTIFICATE_FILE) VBOX_INTEGRITY_CHECK := /IntegrityCheck else VBOX_INTEGRITY_CHECK := /IntegrityCheck:NO endif</code> </pre> </li><li> Below that there is the <code>editbin</code> call: <pre> <code class="plaintext hljs"> $(VBOX_VCC_EDITBIN) /LargeAddressAware /DynamicBase /NxCompat /Release /IntegrityCheck \ /Version:$(VBOX_VERSION_MAJOR)0$(VBOX_VERSION_MINOR).$(VBOX_VERSION_BUILD) \ "$@"</code> </pre> Here I've replaced the unconditional <code>/IntegrityCheck</code> with the new variable <code>$(VBOX_INTEGRITY_CHECK)</code> . </li><li> Next, look for the blocks of the following kinds: <pre> <code class="plaintext hljs">ifdef VBOX_SIGNING_MODE TEMPLATE_XXXXXX_LDFLAGS += -IntegrityCheck endif</code> </pre>  o <pre> <code class="plaintext hljs">if defined(VBOX_SIGNING_MODE) &amp;&amp; defined(VBOX_WITH_HARDENING) TEMPLATE_XXXXXX_LDFLAGS += -IntegrityCheck endif</code> </pre> where ¬´ <code>XXXXXX</code> ¬ª stands for various component names. There are 6 such blocks in total, 3 of each kind. Here I've modified the condition by adding a check for cross-certificate. The first line then turns into, respectively: <pre> <code class="plaintext hljs">if defined(VBOX_SIGNING_MODE) &amp;&amp; defined(VBOX_CROSS_CERTIFICATE_FILE)</code> </pre>  o <pre> <code class="plaintext hljs">if defined(VBOX_SIGNING_MODE) &amp;&amp; defined(VBOX_CROSS_CERTIFICATE_FILE) &amp;&amp; defined(VBOX_WITH_HARDENING)</code> </pre> </li></ul></li><li> Two more files modified by me do not take immediate part in building of VB: <code>src\VBox\Installer\win\Scripts\PackDriversForSubmission.cmd</code> and <code>UnpackBlessedDrivers.cmd</code> . These auxiliary scripts can be used if you intend to send the drivers into Microsoft for Windows 10 signing. The first script prepares a CAB archive for sending; the second one unpacks the resultant ZIP archive with the signed drivers and verifies the signatures. In the packing script all I did was just fixing several typos. In the unpacking script I added ability to specify path to the <code>signtool</code> program, and got rid of the <code>unzip</code> tool by replacing it with a small Perl script. The signing procedure is described below. If you don't plan to get the Microsoft signature you can simply ignore all these changes in the scripts. </li></ol><br><a name="final-touches-localconfig"></a><h5> ‚Ä¢ VB build configuration file </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora necesitamos crear el archivo </font></font><code>LocalConfig.kmk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en el directorio de fuentes de VB y escribir all√≠ todas las rutas y par√°metros de compilaci√≥n. </font><font style="vertical-align: inherit;">Puede usar el siguiente texto como plantilla:</font></font><pre> <code class="plaintext hljs">VBOX_WITH_HARDENING := VBOX_PATH_WIX := C:\Programs\WiX VBOX_GSOAP_INSTALLED := 1 VBOX_PATH_GSOAP := C:\Programs\gSOAP VBOX_WITH_COMBINED_PACKAGE := 1 VBOX_WITH_QT_PAYLOAD := 1 VBOX_WITH_QTGUI_V5 := 1 VBOX_SIGNING_MODE := release VBOX_CERTIFICATE_SUBJECT_NAME := Roga and Kopyta Ltd VBOX_CERTIFICATE_FINGERPRINT := XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX VBOX_CERTIFICATE_SHA2_SUBJECT_NAME := Roga and Kopyta Ltd VBOX_CERTIFICATE_SHA2_FINGERPRINT := XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX VBOX_TSA_URL := http://timestamp.digicert.com VBOX_TSA_SHA2_URL := http://timestamp.digicert.com VBOX_TSA_URL_ARGS := /t "$(VBOX_TSA_URL)" VBOX_TSA_SHA2_URL_ARGS := /tr "$(VBOX_TSA_SHA2_URL)" /td sha256 VBOX_CROSS_CERTIFICATE_FILE := VBOX_CROSS_CERTIFICATE_FILE_ARGS := VBOX_CROSS_CERTIFICATE_SHA2_FILE := VBOX_CROSS_CERTIFICATE_SHA2_FILE_ARGS := VBOX_PATH_SIGN_TOOLS := C:\Programs\DevKits\8.1\bin\x64 VBOX_PATH_SELFSIGN := C:\WinDDK\7600.16385.1\bin\selfsign VBOX_PATH_WISUMINFO := "C:\Program Files\Microsoft SDKs\Windows\v7.1\Samples\sysmgmt\msi\scripts\WiSumInf.vbs" VBOX_PATH_WISUBSTG := "C:\Program Files\Microsoft SDKs\Windows\v7.1\Samples\sysmgmt\msi\scripts\WiSubStg.vbs" VBOX_WITH_DOCS := 1 VBOX_WITH_DOCS_CHM := 1 VBOX_WITH_DOCS_PACKING := 1 VBOX_WITH_ADDITIONS := VBOX_WITH_ADDITIONS_PACKING := 1 VBOX_HAVE_XMLLINT := 1 VBOX_XMLLINT := C:\Programs\xmllint\bin\xmllint.exe VBOX_PATH_DOCBOOK := C:/Programs/DocBook/xsl VBOX_PATH_DOCBOOK_DTD := C:/Programs/DocBook/xml VBOX_PATH_HTML_HELP_WORKSHOP := "C:\Program Files (x86)\HTML Help Workshop" VBOX_PDFLATEX := C:\Programs\MiKTeX\texmfs\install\miktex\bin\pdflatex.exe VBOX_PDFLATEX_CMD := $(VBOX_PDFLATEX) -halt-on-error -interaction batchmode TOOL_CURL_FETCH := C:\Programs\curl\x64\curl.exe PATH_TOOL_NASM := C:/Programs/nasm VBOX_INSTALLER_LANGUAGES := en_US VBOX_WITH_TESTCASES := VBOX_WITH_VALIDATIONKIT := VBOX_WITH_VBOX_IMG := 1 VBOX_WITH_RECORDING := 1 VBOX_WITH_AUDIO_RECORDING := 1 SDK_VBOX_VPX := 1 VBOX_WITH_LIBVPX := 1 SDK_VBOX_OPUS := 1 VBOX_WITH_LIBOPUS := 1 VBOX_BUILD_PUBLISHER := _OSE</code> </pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Deber√° editar esta plantilla: </font></font><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las variables </font></font><code>VBOX_CERTIFICATE_SUBJECT_NAME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>VBOX_CERTIFICATE_SHA2_SUBJECT_NAME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deben contener los nombres de los certificados SHA-1 y SHA-256, respectivamente.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las variables </font></font><code>VBOX_CERTIFICATE_FINGERPRINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>VBOX_CERTIFICATE_SHA2_FINGERPRINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deben contener las huellas digitales de esos certificados; </font><font style="vertical-align: inherit;">los ha copiado anteriormente desde la consola de administraci√≥n de Certificados.</font></font></li><li> If you have a paid certificate you should delete the lines defining the variables <code>VBOX_CROSS_CERTIFICATE_FILE_ARGS</code> and <code>VBOX_CROSS_CERTIFICATE_SHA2_FILE_ARGS</code> , then in the variables <code>VBOX_CROSS_CERTIFICATE_FILE</code> and <code>VBOX_CROSS_CERTIFICATE_SHA2_FILE</code> (without ¬´ <code>_ARGS</code> ¬ª) put the full path to the cross-certificate (without it the drivers will not be accepted). You can download it from the web site of the company that issued the certificate, or <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">from Microsoft</a> . </li><li> You can fine-tune the signing process using various additional variables and macros to redefine the certificate storage, timestamp server, or even construct a full command line for the <code>signtool</code> program. You can take a look into the file <code>Config.kmk</code> below the comment ¬´Code Signing¬ª, there you'll find which variables are defined and how they are used. </li><li> If you've installed some of the programs into paths different from mine, you need to fix those paths in the template. It's strongly recommended to keep the path style for each variable (forward/backward slashes), sometimes it's critical for successful build. </li><li> Fox WiX you need to specify the path to its binaries. With the portable version, it is just the directory where you unpacked it; if you used the installer, the binaries will be located in the subdirectory <code>bin</code> . Please, note, that the path must not contain spaces! If it does you have to convert it into the 8.3 format (you can use <code>dir /x</code> for that). Unfortunately, enclosing the path in quotes does not work with this variable. </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La variable </font></font><code>VBOX_BUILD_PUBLISHER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especifica el sufijo de marca en el n√∫mero de versi√≥n. </font><font style="vertical-align: inherit;">Por defecto es "_OSE" (es decir, la versi√≥n completa del producto es "6.0.4_OSE"). </font><font style="vertical-align: inherit;">Puede especificar cualquier otro sufijo aqu√≠, o configurarlo como vac√≠o para deshacerse de √©l por completo. </font><font style="vertical-align: inherit;">Pero si elimina la variable por completo, usar√° el predeterminado "_OSE".</font></font></li></ul><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El resto de las variables se utilizan principalmente para declarar qu√© componentes se construir√°n. </font><font style="vertical-align: inherit;">Y, por supuesto, la declaraci√≥n principal llega a la cima: apaga el endurecimiento.</font></font><br><br><a name="build-vb"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Construyendo virtualbox </font></font></h4><br> Finally, we can now start building VirtualBox itself. If you normally prefer to build for different platforms in parallel you will have to do without it for now, or use two separate source tree copies, because VB has a common configuration file which is generated before the build and contains platform-dependent data. It would not be nice to the compiler to suddenly throw it from the 64-bit build environment into the 32-bit one in the middle of the build process. <br> If you need Windows 10 compatible driver signatures, please, refer to the information provided after the main procedure description. <br><ol><li> Let's start with the 64-bit version. Open the console and run the following commands: <pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Devel\VirtualBox-src "C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> BUILD_TARGET_ARCH=amd64 cscript configure.vbs --with-DDK=C:\WinDDK\<span class="hljs-number"><span class="hljs-number">7600</span></span>.<span class="hljs-number"><span class="hljs-number">16385</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> --with-MinGW-w64=C:\Programs\mingw64 --with-MinGW32=C:\Programs\mingw32 --with-libSDL=C:\Programs\SDL\x64 --with-openssl=C:\Programs\OpenSSL\x64 --with-openssl32=C:\Programs\OpenSSL\x32 --with-libcurl=C:\Programs\curl\x64 --with-libcurl32=C:\Programs\curl\x32 --with-Qt5=C:\Programs\Qt\<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>-x64 --with-libvpx=C:\Programs\libvpx --with-libopus=C:\Programs\libopus --with-python=C:/Programs/Python env.bat kmk kmk C:/Devel/VirtualBox-src/out/win.x86/release/obj/Installer/VirtualBox-<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span>_OSE-r128164-MultiArch_amd64.msi</code> </pre> The <code>configure.vbs</code> script verifies the environment and generates configuration files ( <code>AutoConfig.kmk</code> and <code>env.bat</code> ). The first <code>kmk</code> command builds the binaries and collect them into <code>out\win.amd64\bin\</code> . And the last command packs them all into the intermediate MSI package. Important notes: <ul><li> You must use forward slashes in the last command. With backslashes, <code>kmk</code> would fail to find the build rules. </li><li> Even though we are building the 64-bit version, the target package is located in <code>out\win.x86\‚Ä¶</code> , because the final stage of the build will be performed from the 32-bit build environment. </li><li> If you've changed the branding suffix you need to change the name of the target package by replacing the ¬´_OSE¬ª with what you specified in the variable <code>VBOX_BUILD_PUBLISHER</code> . </li><li> The revision number in the MSI package name (128164) can be found in the file <code>Config.kmk</code> inside the <code>VBOX_SVN_REV_FALLBACK</code> variable definition. Please, note, that this value may be different from revisions of the official distribution (for instance, the version 6.0.4 has release number 128413). Unfortunately, I have no idea why. </li></ul></li><li> Now we need to build the 32-bit version and pack everything together. For that, open a new console window, and run the following commands: <pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Devel\VirtualBox-src "C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x86 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> BUILD_TARGET_ARCH=x86 cscript configure.vbs --with-DDK=C:\WinDDK\<span class="hljs-number"><span class="hljs-number">7600</span></span>.<span class="hljs-number"><span class="hljs-number">16385</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> --with-MinGW-w64=C:\Programs\mingw64 --with-MinGW32=C:\Programs\mingw32 --with-libSDL=C:\Programs\SDL\x32 --with-openssl=C:\Programs\OpenSSL\x32 --with-libcurl=C:\Programs\curl\x32 --with-Qt5=C:\Programs\Qt\<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>-x32 --with-libvpx=C:\Programs\libvpx --with-libopus=C:\Programs\libopus --with-python=C:/Programs/Python env.bat kmk kmk C:/Devel/VirtualBox-src/out/win.x86/release/bin/VirtualBox-<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span>_OSE-r128164-MultiArch.exe</code> </pre> Same as with the 64-bit, you need to replace the ¬´_OSE¬ª suffix with what you have. <br> Notice how in the last command we are building an <code>EXE</code> , and not an <code>MSI</code> . This is the final installer which will cause the 32-bit package to be built automatically, from dependencies. </li><li> Even if you have a paid certificate you will find that you cannot install this distribution into Windows 10 booted with Secure Boot enabled. This OS has stricter requirements, and the drivers must be signed by none other than Microsoft themselves. The procedure is explained in details on various Internet resources and is unrelated to this article, so I'm not going to go deep into this topic. Instead I'll outline the main steps you need to take for integrating this task with the VB build procedure. <ul><li> The main requirement here is that you must have not just a normal code signing certificate, but an EV one (Extended Validation). Also you need to register an account at <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Hardware Dev Center</a> and add your certificate there. </li><li> Now, during building the 64-bit version of VB, just after you've got all binary components (that is, after the first <code>kmk</code> run which was without arguments), you need to create a CAB archive with the drivers. There is a batch script template for that; the build system modifies it according to the current task and puts it into <code>out\win.amd64\release\repack\</code> . Go into this path and run the following command: <pre> <code class="dos hljs">PackDriversForSubmission.<span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span> -x</code> </pre> When the script finishes, the file <code>VBoxDrivers-6.0.4r128164-amd64.cab</code> will appear in the same directory. </li><li> You need to sign this CAB archive with your EV certificate. Then go to the Microsoft Hardware Dev Center, create a new submission, upload your signed archive, select the desired target OS version (make sure it's 64-bit) and send the submission. </li><li> It will take several minutes to process, after which you will have a ZIP archive where all the drivers have been signed by Microsoft in addition to your signature, and all the CAT files generated anew. Download this archive and place it somewhere so that the build system had access to it. </li><li> Unpack the archive and put all the files from the subdirectories directly into <code>out\win.amd64\release\bin\</code> overwriting the existing files. You can do it either manually or using another script from the same path <code>out\win.amd64\release\repack\</code> by running the following commands: <pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _MY_SIGNTOOL=C:\Programs\DevKits\<span class="hljs-number"><span class="hljs-number">8</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>\bin\x64\signtool.exe UnpackBlessedDrivers.<span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span> -n -i <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>\to\signed.zip</code> </pre> Of course, you need to put here the correct paths to <code>signtool.exe</code> and the ZIP archive. </li><li> Now you can run the second <code>kmk</code> command which packs all the components into an MSI installer. If you were doing all this in the same console window, don't forget to switch back to the base directory of the VB project. </li><li> Finally, proceed with building of the 32-bit version of VB, and perform all the same additional steps: after the first <code>kmk</code> switch to <code>out\win.x86\release\repack\</code> , create the CAB archive, sign it, send to Microsoft (now choosing the 32-bit OS version), replace the drivers with their counter-signed versions, and run the final <code>kmk</code> for building the complete VB distribution. </li></ul></li></ol><br> If neither of us has messed anything up, all this long chain should bring you a shiny new VirtualBox installer which differs from the Oracle one only by its icon, the About picture, and, of course, the profound lack of hardening. It's not hard to replace also the icon and the picture, but I won't go into this topic here. <br><br> For convenience I've created a <a href="">single batch file</a> which automates the full build of VB. You can use it if you need to build the complete installer regularly. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solo unas pocas palabras m√°s sobre la instalaci√≥n de la distribuci√≥n resultante si est√° utilizando un certificado autofirmado. </font><font style="vertical-align: inherit;">Como se descubri√≥ repentinamente, en Windows 8/10 no es suficiente arrancar en modo de prueba, la instalaci√≥n a√∫n falla alegando que las firmas del controlador no son v√°lidas. </font><font style="vertical-align: inherit;">Puede solucionar este problema agregando los certificados al almacenamiento ra√≠z de CA:</font></font><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abra el cuadro de di√°logo Propiedades del instalador de VB haciendo clic con el bot√≥n derecho y seleccionando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Propiedades</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , luego cambie a la </font><font style="vertical-align: inherit;">pesta√±a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmas digitales</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Encontrar√° dos firmas all√≠, ambas llamadas "Roga y Kopyta Ltd", una es sha1, la otra sha256. </font><font style="vertical-align: inherit;">Seleccione el primero, haga clic en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detalles</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aparece otro cuadro de di√°logo en el que debe hacer clic en el bot√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ver certificado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li> One more dialog, click <i>Install Certificate</i> . </li><li> In the Import wizard, select the location ¬´Local Machine¬ª, click <i>Next</i> . After UAC confirmation (if needed), there's the certificate store selection. Select ¬´Place all certificates in the following store¬ª, then click <i>Browse</i> and choose the store named ¬´Trusted Root Certification Authorities¬ª. Then <i>Next</i> , <i>Finish</i> . You're done, the certificate is installed. </li><li> Close all the dialogs but the very first one, select the second signature (sha256) and repeat the steps 2 to 4 for it too. </li><li> Close all the dialogs, run the installer. Now it should work fine. </li></ol><br><a name="afterword"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png"> Epilogue </h4><br> When I finished writing the article I was myself surprized by its volume. At first I was planning to go into many details on reasons for choosing this or that way of solving each problem, explain what the problem is, exactly, and what alternative solutions might be applicable. But very soon it became clear that, if loaded with all these particulars, the text would be monstrously huge. I have to apologize, then, for the recipes looking like ¬´just do this and ask no questions¬ª. I have a strong dislike for those myself, but I just couldn't find any other way. Occasionally I still tried to outline what was going on, to soften the impression. <br><br> A vast amount of details about VB build system had to remain behind the scene; for I have both felt reluctant to bloat the text, and, sometimes, was too lazy to go look for a different, more efficient approach of solving a problem. After all, my main aim, initially, was to get myself a working build of the current VirtualBox version. 4.3.12 had already been way outdated by that time, but I could not risk updating one of my most actively used tool to the hardened version which might simply stop working at any moment. Although, from time to time I do get back and, having found something new, add it to this article. <br><br> I do hope this article will find its audience. If you are interested to see and analyze the final result but don't want to set up all the pile of programs, you can get my version of the distribution from here: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi√≥n 6.0.4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Todos los controladores (y otros archivos) est√°n firmados con un certificado autofirmado no confiable, por lo que para instalarlo en la versi√≥n de Windows de 64 bits tendr√° que reiniciar en el modo de prueba. </font><font style="vertical-align: inherit;">Si tiene alguna pregunta, sugerencia, recomendaci√≥n, por favor, si√©ntase libre de escribirme aqu√≠, ya sea en comentarios o mediante mensajes personales. </font><font style="vertical-align: inherit;">¬°Que el c√≥digo abierto te acompa√±e!</font></font><br><br><a name="history"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Enmiendas </font></font></h4><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archivo</font></font></b> <div class="spoiler_text"><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Ä¢ Art√≠culo ruso publicado el 21/01/2016 </font></font></h5><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> VirtualBox 5.0.12. </font></font></li></ol><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Ä¢ Actualizaci√≥n del 24/05/2016 </font></font></h5><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El art√≠culo se actualiza para VB 5.0.20, uno de los principales cambios es la firma dual SHA-1 / SHA-256. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se inhabilit√≥ la comprobaci√≥n de firmas forzadas si se utilizan certificados autofirmados. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se agreg√≥ informaci√≥n sobre la soluci√≥n alternativa para la falla de instalaci√≥n de la distribuci√≥n autofirmada. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se actualizaron las versiones de la biblioteca. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Deshabilit√≥ algunos componentes no utilizados para acelerar el proceso de compilaci√≥n. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Peque√±as correcciones y mejoras. </font></font></li></ol><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Ä¢ Actualizaci√≥n del 29/07/2016 </font></font></h5><ol><li> The article is updated for VB 5.1.2; the most important change is upgrading to Qt5. The differences from VB 5.0.x procedure are specified where applicable. </li><li> Library versions were updated. </li><li> The full build batch was updated to check error codes after each operation. </li><li> Minor fixes and improvements. </li></ol><br><h5> ‚Ä¢ Update of 15.09.2016 </h5><ol><li> The article is updated for VB 5.1.6. </li><li> Library versions were updated. </li><li> Added NASM for building OpenSSL. </li><li> Added OpenSSL into cURL; this fixes the broken function of checking for updates and downloading the Extension Pack. </li><li> The full build batch now reads the VB version automatically. </li><li> Various minor fixes and improvements. </li></ol><br><h5> ‚Ä¢ Update of 30.11.2016 </h5><ol><li> The article is updated for VB 5.1.10. </li><li> Library versions were updated; particularly OpenSSL was upgraded to version 1.1.x. </li><li> Fixed some installation errors: <ul><li> path to the Qt plugins now points to the installation directory; </li><li> added forgotten OpenSSL libraries to the 32-bit components of the 64-bit VB version. </li></ul></li><li> The article no longer contains information about building older VB versions. If needed, the previous versions of it are available in the <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitHub project</a> . </li></ol><br><h5> ‚Ä¢ Update of 2.12.2016 </h5><ol><li> Switched to using statically linked OpenSSL. </li></ol><br><h5> ‚Ä¢ Update of 20.06.2017 </h5><ol><li> The article is updated for VB 5.1.22. </li><li> cURL, OpenSSL, and gSOAP were updated; adapted the build instructions for cURL, gSOAP and VB. </li></ol><br><h5> ‚Ä¢ Update of 1.12.2017 </h5><ol><li> The article is updated for VB 5.2.2. </li><li> Switched from MinGW-32 3.3.3 to 4.5.4. </li><li> Qt, cURL, OpenSSL, gSOAP, and some build tools were updated; adapted the build instructions for cURL, gSOAP and VB. </li><li> Switched to using local archives of DocBook XML/XSL instead of online versions. </li><li> Using cURL program instead of wget for downloading the Guest Additions ISO image. </li><li> Various minor fixes and improvements. </li></ol><br><h5> ‚Ä¢ Update of 4.12.2017 </h5><ol><li> The libxml version was fixed in the build instructions. </li></ol><br><h5> ‚Ä¢ Update of 4.09.2018 </h5><ol><li> The article is updated for VB 5.2.18. </li><li> cURL, OpenSSL, gSOAP and some build tools were updated; adapted the build instructions for cURL. </li></ol><br><h5> ‚Ä¢ Update of 12.12.2018 </h5><ol><li> The article is updated for VB 5.2.22. </li><li> Enabled screen recording functionality which is disabled in OSE version by default; added libraries libopus and libvpx for encoding. </li><li> cURL, OpenSSL, and gSOAP were updated. </li><li> The full set of VirtualBox source code changes is now published as a single patch file for easier application. </li></ol></div></div><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Ä¢ Actualizaci√≥n del 25/01/2019 </font></font></h5><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El art√≠culo est√° actualizado para VB 6.0.2. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mejora deshabilitando la construcci√≥n de Adiciones de invitados. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cURL y gSOAP fueron actualizados; </font><font style="vertical-align: inherit;">Las hojas de estilo DocBook XSL se degradaron a la versi√≥n 1.69.1 (la documentaci√≥n se adapta mejor a esa versi√≥n).</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El lote de compilaci√≥n completo se dividi√≥ del texto del art√≠culo en un archivo descargable. </font></font></li></ol><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Ä¢ Actualizaci√≥n del 08/04/2019 </font></font></h5><ol><li> The article has been translated into English for the first time. Also numerous minor changes were introduced into the Russian version. </li><li> Added information about drivers signing for Windows 10. </li><li> The article is updated for VB 6.0.4. </li><li> cURL, OpenSSL, gSOAP, and some tools were updated. </li><li> The full build batch no longer has to be placed at the specific path. Also, it now contains the basic template for automated Windows 10 drivers signing. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/447300/">https://habr.com/ru/post/447300/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447288/index.html">Top 5 monedas estables. Todo lo que necesitas saber</a></li>
<li><a href="../447290/index.html">Doctor paseos, paseos</a></li>
<li><a href="../447292/index.html">14 nuevos productos en Visual Studio 2019</a></li>
<li><a href="../447294/index.html">Live Share ahora incluido con Visual Studio 2019</a></li>
<li><a href="../447298/index.html">Gesti√≥n del conocimiento a trav√©s de modelos de competencia.</a></li>
<li><a href="../447302/index.html">Sistema operativo de fin de semana</a></li>
<li><a href="../447304/index.html">Avaricious no paga dos veces: configuramos la memoria en la plataforma AMD B450 y recibimos productividad gratuita</a></li>
<li><a href="../447306/index.html">Transformador Tesla en una placa de una pulgada cuadrada</a></li>
<li><a href="../447308/index.html">Dise√±o instant√°neo</a></li>
<li><a href="../447310/index.html">C√≥mo pasamos del desarrollo web al desarrollo de juegos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>