<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¦„ ğŸ¤› ğŸ¤½ğŸ½ ä½¿Git for Windowsåœ¨ReactOSä¸­å·¥ä½œ ğŸ¦‡ ğŸš› ğŸ‘¨ğŸ½â€ğŸ«</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç¥æ‚¨æœ‰ç¾å¥½çš„ä¸€å¤©ï¼ 


 æˆ‘å«Stanislavï¼Œæˆ‘å–œæ¬¢å†™ä»£ç ã€‚ è¿™æ˜¯æˆ‘åœ¨Habrä¸Šå‘è¡¨çš„ç¬¬ä¸€ç¯‡è‹±æ–‡æ–‡ç« ï¼ŒåŸºäºä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š 


- Habrç°åœ¨æ˜¯è‹±è¯­ 
- ReactOSä¸­å¿ƒç¼ºä¹æŠ€æœ¯æ–‡ç«  
- Geektimesæœ€è¿‘è¿”å›å“ˆä¼¯ 
- åœ¨ReactOSä¸­æ„å»ºReactOSçš„å¯èƒ½æ€§ 
- æˆ‘ç›´æ¥å‚...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿Git for Windowsåœ¨ReactOSä¸­å·¥ä½œ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/reactos/blog/439580/"><p> ç¥æ‚¨æœ‰ç¾å¥½çš„ä¸€å¤©ï¼ <img src="https://habrastorage.org/getpro/habr/post_images/557/a3f/dcf/557a3fdcfb649e6bb0e97231ccf30af2.png" alt="å›¾ç‰‡" align="right"></p><br><p> æˆ‘å«Stanislavï¼Œæˆ‘å–œæ¬¢å†™ä»£ç ã€‚ è¿™æ˜¯æˆ‘åœ¨Habrä¸Šå‘è¡¨çš„ç¬¬ä¸€ç¯‡è‹±æ–‡æ–‡ç« ï¼ŒåŸºäºä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Habrç°åœ¨æ˜¯è‹±è¯­</a> </li><li>  ReactOSä¸­å¿ƒç¼ºä¹æŠ€æœ¯æ–‡ç«  </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Geektimes</a>æœ€è¿‘<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿”å›å“ˆä¼¯</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨ReactOS</a>ä¸­<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ„å»ºReactOSçš„</a>å¯èƒ½æ€§ </li><li> æˆ‘ç›´æ¥å‚ä¸äº†åœ¨ReactOSä¸­è§£å†³é—®é¢˜çš„éå¸¸æœ‰è¶£çš„æ¡ˆä¾‹ </li></ul><br><p> æœ¬æ–‡æ˜¯æˆ‘<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬ä¸€</a>ç¯‡å…³äºä¿„è¯­çš„æ–‡ç« çš„è‹±æ–‡ç‰ˆã€‚ </p><br><p>è®©æˆ‘ä»‹ç»è¿™ä¸ªæ•…äº‹ä¸­çš„ä¸»è¦äººç‰©ï¼Œä»–ä»¬å®é™…ä¸Šä¿®å¤äº†é˜»æ­¢Gitåœ¨ReactOSä¸Šè¿è¡Œçš„é”™è¯¯-æ³•å›½å¼€å‘äººå‘˜HermÃ¨sBÃ©lusca-MaÃ¯toï¼ˆæˆ–è€…åªæ˜¯å…·æœ‰<code>hbelusca</code>æ˜µç§°çš„Hermesï¼‰ï¼Œå½“ç„¶è¿˜æœ‰æˆ‘ï¼ˆå…·æœ‰<code>x86corez</code>æ˜µç§°ï¼‰ã€‚ </p><br><p> æ•…äº‹ä»ReactOSå¼€å‘IRCé¢‘é“çš„ä»¥ä¸‹æ¶ˆæ¯å¼€å§‹ï¼š </p><br><pre> <code class="html hljs xml">Jun 03 18:52:56 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> Anybody want to work on some small problem? If so, can someone figure out why this problem https://jira.reactos.org/browse/CORE-12931 happens on ReactOS? :D Jun 03 18:53:13 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> That would help having a good ROS self-hosting system with git support. Jun 03 18:53:34 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> (the git assertion part only).</code> </pre> <a name="habracut"></a><br><h2 id="debriefing"> æ±‡æŠ¥ </h2><br><p> ç”±äºReactOSçš„ç›®æ ‡å¹³å°æ˜¯Windows Server 2003ï¼Œå› æ­¤é€‰æ‹©äº†Gitç‰ˆæœ¬2.10.0è¿›è¡Œè°ƒæŸ¥-è¿™æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ€åä¸€ä¸ª</a>æ”¯æŒWindows XPå’Œ2003çš„ç‰ˆæœ¬ã€‚ </p><br><p> æµ‹è¯•æ˜¯åœ¨ReactOSå‘½ä»¤æç¤ºç¬¦ä¸­å®Œæˆçš„ï¼Œé—®é¢˜çš„å¤–éƒ¨ç—‡çŠ¶ç›¸å½“æ¨¡ç³Šã€‚ ä¾‹å¦‚ï¼Œå½“æ‚¨è¿è¡Œä¸å¸¦é™„åŠ å‚æ•°çš„gitæ—¶ï¼Œå®ƒå°†åœ¨æ§åˆ¶å°ä¸­æ˜¾ç¤ºå¸®åŠ©æ¶ˆæ¯ï¼Œè€Œæ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ ä½†æ˜¯ä¸€æ—¦æ‚¨å°è¯•äº†<code>git clone</code>æˆ–ä»€è‡³æ˜¯<code>git --version</code>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ§åˆ¶å°å°†ä¿æŒä¸ºç©ºã€‚ æœ‰æ—¶å®ƒä¼šæ˜¾ç¤ºæ–­è¨€å¹¶å¸¦æœ‰ä¸€ä¸ªæ–­è¨€ï¼š </p><br><pre> <code class="html hljs xml">git.exe clone -v "https://github.com/minoca/os.git" "C:\Documents and Settings\Administrator\Bureau\minocaos" A ssertionfailed ! P rogram : C : \ P rogram F iles \ G it \ mingw 3 2 \ bin \ git . exe F ile : exec _ cmd . c , L ine 2 3 E xpression : argv 0 _ path This application has requested the Runtime to terminate in an unusual way. Please contact the application's support team for more information.</code> </pre> <br><p> å¹¸è¿çš„æ˜¯ï¼Œgitæ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå®ƒå¯¹æˆ‘ä»¬çš„è°ƒæŸ¥å¾ˆæœ‰å¸®åŠ©ã€‚ å®šä½å‘ç”Ÿæœªå¤„ç†å¼‚å¸¸çš„å®é™…ä»£ç å—å¹¶ä¸éš¾ï¼š <a href="">https</a> : <a href="">//github.com/git-for-windows/git/blob/4cde6287b84b8f4c5ccb4062617851a2f3d7fc78/exec_cmd.c#L23</a> </p><br><pre> <code class="plaintext hljs">char *system_path(const char *path) { /* snip */ #ifdef RUNTIME_PREFIX assert(argv0_path); // it asserts here assert(is_absolute_path(argv0_path)); /* snip */ #endif strbuf_addf(&amp;d, "%s/%s", prefix, path); return strbuf_detach(&amp;d, NULL); }</code> </pre> <br><p> å¹¶ä¸”<code>argv0_path</code>å˜é‡å€¼ç”±ä»¥ä¸‹ä»£ç åˆ†é…ï¼š </p><br><pre> <code class="plaintext hljs">const char *git_extract_argv0_path(const char *argv0) { const char *slash; if (!argv0 || !*argv0) return NULL; slash = find_last_dir_sep(argv0); if (slash) { argv0_path = xstrndup(argv0, slash - argv0); return slash + 1; } return argv0; }</code> </pre> <br><p> ä¸€æ—¦è·å¾—æ‰€æœ‰è¿™äº›ä¿¡æ¯ï¼Œæˆ‘å°±å‘IRCé¢‘é“å‘é€äº†ä¸€äº›æ¶ˆæ¯ï¼š </p><br><pre> <code class="html hljs xml">Jun 03 19:04:36 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> hbelusca: https://github.com/git-for-windows/git/blob/4cde6287b84b8f4c5ccb4062617851a2f3d7fc78/exec_cmd.c#L23 Jun 03 19:04:41 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> assertion is here Jun 03 19:04:57 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> yes I know, I've seen the code yesterday. The question is why it's FALSE on ROS but TRUE on Windows. Jun 03 19:06:02 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> argv0_path = xstrndup(argv0, slash - argv0); Jun 03 19:06:22 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> xstrndup returns NULL %-) Jun 03 19:06:44 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> ok, so what's the values of argv0 and slash on windows vs. on ROS? :P Jun 03 19:08:48 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> good question!</code> </pre> <br><p> å˜é‡åè¡¨æ˜å®é™…å€¼æ˜¯ä»<code>argv[0]</code>æ´¾ç”Ÿçš„-é€šå¸¸å®ƒåŒ…å«é›¶ç´¢å¼•ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶åã€‚ ä½†æ˜¯åæ¥ä¸€åˆ‡éƒ½ä¸é‚£ä¹ˆæ˜æ˜¾... </p><br><pre> <code class="html hljs xml">Jun 03 20:15:21 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> hbelusca: surprise... git uses its own xstrndup implementation Jun 03 20:15:35 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> so I can't simply hook it xD Jun 03 20:15:56 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> well, with such a name "xstrndup" it's not surprising it's its own implementation Jun 03 20:16:04 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> probably I would need an user-mode debugger... like OllyDbg Jun 03 20:16:09 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> that's everything but standardized function. Jun 03 20:16:24 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> x86corez: ollydbg should work on ROS. Jun 03 20:16:30 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mjansen</span></span></span><span class="hljs-tag">&gt;</span></span> what are you breaking today? Jun 03 20:16:44 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> mjansen: https://jira.reactos.org/browse/CORE-12931 Jun 03 20:16:51 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> (of course if you also are able to compile that git with symbols and all the stuff, it would be very nice)</code> </pre> <br><h2 id="action"> åŠ¨ä½œç‰‡ </h2><br><p> ä¹‹åï¼Œæˆ‘å†³å®šç›´æ¥ä»æºä»£ç ç¼–è¯‘gitï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥â€œå³æ—¶â€å°†æ„Ÿå…´è¶£çš„å˜é‡ç›´æ¥æ‰“å°åˆ°æ§åˆ¶å°ã€‚ æˆ‘éµå¾ªäº†æ­¤<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ†æ­¥æ•™ç¨‹ï¼Œ</a>å¹¶ä¸”ä¸ºäº†ç¼–è¯‘å…¼å®¹çš„gitç‰ˆæœ¬ï¼Œæˆ‘é€‰æ‹©äº†æ­¤åˆ†æ”¯ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">//github.com/git-for-windows/git/tree/v2.10.0-rc2</a> </p><br><p> è®¾ç½®mingw32å·¥å…·é“¾å¾ˆé¡ºåˆ©ï¼Œæˆ‘æ‰å¼€å§‹æ„å»ºã€‚ ä½†æ˜¯ï¼Œåœ¨è¿™äº›åˆ†æ­¥æ•™ç¨‹ä¸­ï¼Œå‡ ä¹æ€»æ˜¯å­˜åœ¨æœªè®°å½•çš„é™·é˜±ï¼Œæˆ‘ç«‹å³é‡åˆ°äº†å…¶ä¸­ä¹‹ä¸€ï¼š </p><br><p><img src="https://habrastorage.org/webt/st/xy/yz/stxyyzihtz6c7qlzohax-u7nofc.png" alt="å›¾ç‰‡"></p><br><p> é€šè¿‡åå¤è¯•éªŒï¼Œä»¥åŠä½¿ç”¨æ¥è‡ªå¤§å…ï¼ˆIRCé€šé“ï¼‰çš„æç¤ºï¼Œä¿®å¤äº†æ‰€æœ‰ç¼–è¯‘æ—¶é”™è¯¯ã€‚ å¦‚æœæœ‰äººæƒ³æŒ‰ç…§æˆ‘çš„æ­¥éª¤è¿›è¡Œæ“ä½œï¼Œä»¥ä¸‹æ˜¯ä½¿ç¼–è¯‘å™¨æ»¡æ„çš„åŒºåˆ«ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">//pastebin.com/ZiA9MaKt</a> </p><br><p> ä¸ºäº†é¿å…åœ¨åˆå§‹åŒ–æœŸé—´è°ƒç”¨å¤šä¸ªå‡½æ•°å¹¶è½»æ¾é‡ç°è¯¥é”™è¯¯ï¼Œæˆ‘å†³å®šåœ¨<code>main()</code>å‡½æ•°çš„å¼€å¤´æ”¾ç½®å‡ å¼ è°ƒè¯•æ‰“å°ä¿¡æ¯ï¼Œå¯¹äºgitï¼Œè¯¥å‡½æ•°ä½äº<code>common-main.c</code>ä¸­ï¼š </p><br><pre> <code class="plaintext hljs">int main(int argc, const char **argv) { /* * Always open file descriptors 0/1/2 to avoid clobbering files * in die(). It also avoids messing up when the pipes are dup'ed * onto stdin/stdout/stderr in the child processes we spawn. */ //DebugBreak(); printf("sanitize_stdfds(); 1\n"); sanitize_stdfds(); printf("git_setup_gettext(); 1\n"); git_setup_gettext(); /* * Always open file descriptors 0/1/2 to avoid clobbering files * in die(). It also avoids messing up when the pipes are dup'ed * onto stdin/stdout/stderr in the child processes we spawn. */ printf("sanitize_stdfds(); 2\n"); sanitize_stdfds(); printf("git_setup_gettext(); 2\n"); git_setup_gettext(); printf("before argv[0] = %s\n", argv[0]); argv[0] = git_extract_argv0_path(argv[0]); printf("after argv[0] = %s\n", argv[0]); restore_sigpipe_to_default(); printf("restore_sigpipe_to_default(); done\n"); return cmd_main(argc, argv); }</code> </pre> <br><p> æˆ‘å¾—åˆ°ä»¥ä¸‹è¾“å‡ºï¼š </p><br><pre> <code class="html hljs xml">C:\&gt;git --version sanitize_stdfds(); 1 git_setup_gettext(); 1 sanitize_stdfds(); 2 git_setup_gettext(); 2 before argv[0] = git after argv[0] = git restore_sigpipe_to_default(); done A ssertionfailed ! (cutted a part of error message which is the same as the one above)</code> </pre> <br><p> å¯ä»¥å‡è®¾è¿™é‡Œä¸€åˆ‡éƒ½å¾ˆå¥½ï¼Œ <code>argv[0]</code>å€¼æ­£ç¡®ã€‚ æˆ‘æœ‰ä¸€ä¸ªæƒ³æ³•å¯ä»¥åœ¨è°ƒè¯•å™¨ä¸­è¿è¡Œgitï¼Œä¾‹å¦‚OllyDbgï¼Œä½†æ˜¯å‡ºäº†ç‚¹é—®é¢˜... </p><br><pre> <code class="html hljs xml">Jun 04 01:54:46 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sanchaez</span></span></span><span class="hljs-tag">&gt;</span></span> now please try gdb/ollydbg in ROS Jun 04 01:58:11 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sanchaez</span></span></span><span class="hljs-tag">&gt;</span></span> you have gdb in RosBE Jun 04 01:58:20 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sanchaez</span></span></span><span class="hljs-tag">&gt;</span></span> just in case :p Jun 04 01:59:45 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> ollydbg says "nope" with MEMORY_MANAGEMENT bsod Jun 04 02:00:07 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> !bc 0x0000001A Jun 04 02:00:08 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hTechBot</span></span></span><span class="hljs-tag">&gt;</span></span> KeBugCheck( MEMORY_MANAGEMENT ); Jun 04 02:00:13 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> :/ Jun 04 02:00:49 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sanchaez</span></span></span><span class="hljs-tag">&gt;</span></span> welp Jun 04 02:00:56 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sanchaez</span></span></span><span class="hljs-tag">&gt;</span></span> you only have one option now :D</code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">æ¡‘æ°å…¹ï¼ˆSanchaezï¼‰</a>åœ¨è¿™é‡Œæå‡ºäº†ä¸€ä¸ªå¾ˆå¥½çš„ä¸»æ„ï¼Œå¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">å¯å‘</a>å¾ˆå¤šäº‹æƒ…ï¼ </p><br><p><img src="https://habrastorage.org/webt/ox/hf/wq/oxhfwqsbyw35bsylutipsffvaao.png" alt="å›¾ç‰‡"></p><br><p> æ–­è¨€ä¸å†å‘ç”Ÿï¼Œå¹¶ä¸”gitæˆåŠŸæ‰“å°äº†å®ƒçš„ç‰ˆæœ¬ã€‚ </p><br><pre> <code class="html hljs xml">Jun 04 02:23:40 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> it prints! Jun 04 02:23:44 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> but only in gdb Jun 04 02:23:53 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> oh Jun 04 02:24:00 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> C:\git/git.exe Jun 04 02:24:13 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> I wonder whether it's the same in windows, or not.</code> </pre> <br><p> ç®±å­ä»æ­»è§’ç§»å¼€äº†ï¼Œæˆ‘å°è¯•äº†å¤šç§æ–¹æ³•åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹è¿è¡Œgitï¼Œå¹¶æ‰¾åˆ°äº†æ­£ç¡®çš„æ–¹æ³•ï¼ </p><br><p><img src="https://habrastorage.org/webt/es/bq/a4/esbqa41d5zj__3yoapc4yfbshhc.png" alt="å›¾ç‰‡"></p><br><p> é—®é¢˜å¾ˆæ˜æ˜¾æ˜¯gitæœŸæœ›å‘½ä»¤è¡Œä¸Šçš„å®Œæ•´è·¯å¾„ã€‚ å› æ­¤ï¼Œæˆ‘æ¯”è¾ƒäº†Windowsä¸Šçš„è°ƒè¯•è¾“å‡ºã€‚ ç»“æœè®©æˆ‘æœ‰äº›æƒŠè®¶ã€‚ </p><br><p><img src="https://habrastorage.org/webt/ke/iv/9s/keiv9szbiznf4nsahh8fwkg3m2e.png" alt="å›¾ç‰‡"></p><br><p> ç”±äºæŸäº›åŸå› ï¼Œ <code>argv[0]</code>å€¼åŒ…å«git.exeäºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚ </p><br><pre> <code class="html hljs xml">Jun 05 23:01:44 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> x86corez: can you try to run git also by not using cmd.exe? Jun 05 23:02:05 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> (to exclude the possibility it's cmd that doesn't call Createprocess with a complete path) Jun 05 23:02:09 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> while I think it should... Jun 05 23:02:30 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> not using cmd... moment Jun 05 23:02:55 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> x86corez: alternatively, on windows, try starting git using our own cmd.exe :)</code> </pre> <br><p> çˆ±é©¬ä»•å»ºè®®åœ¨æ­¤å¤„æ£€æŸ¥Râ€‹â€‹eactOS cmd.exeæ˜¯å¦æœ‰ç½ª... </p><br><p><img src="https://habrastorage.org/webt/_l/nd/od/_lndodcrwgvabcw9ho1r-g0ns5m.png" alt="å›¾ç‰‡"></p><br><p> ä½†æ˜¯æ­¤å±å¹•æˆªå›¾ç¡®è®¤å®é™…é—®é¢˜å‡ºåœ¨å…¶ä»–åœ°æ–¹ã€‚ </p><br><pre> <code class="html hljs xml">Jun 05 23:04:38 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> ROS cmd is not guilty Jun 05 23:07:57 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> If there was a possibility to consult the received path, before looking at the contents of argvs... ? Jun 05 23:08:30 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> dump contents of actual command line? Jun 05 23:08:39 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> yeah Jun 05 23:09:39 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> The thing you retrieve using GetCommandLineW Jun 05 23:10:03 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> (which is, after simplifications, basically : NtCurrentPeb()-&gt;ProcessParameters-&gt;CommandLine ) Jun 05 23:10:59 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> Also I was thinking it could be a side-effect of having (or not having) git path into the env-vars.... Jun 05 23:12:17 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> hbelusca, command line is "git --version" Jun 05 23:12:34 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> Always? Jun 05 23:12:39 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> Yes, even on Windows Jun 05 23:15:13 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> ok but then it would be nice if these different results are at least the same on Windows and on ROS, so that we can 100% exclude problems outside of msvcrt.</code> </pre> <br><p> æœ€åä¸€ä¸ªé€‰æ‹©æ˜¯åœ¨Windowsä¸­æµ‹è¯•ReactOS msvcrt.dllã€‚ æˆ‘è¯•å›¾å°†æ–‡ä»¶æ”¾ç½®åœ¨git.exeæ‰€åœ¨çš„ç›®å½•ä¸­ï¼Œä½†æ²¡æœ‰å¸®åŠ©ã€‚ é©¬å…‹å»ºè®®æ·»åŠ ä¸€ä¸ª.localæ–‡ä»¶ï¼š </p><br><pre> <code class="html hljs xml">Jun 05 22:59:01 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mjansen</span></span></span><span class="hljs-tag">&gt;</span></span> x86corez: add .local file next to msvcrt.dll ;) Jun 05 22:59:47 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mjansen</span></span></span><span class="hljs-tag">&gt;</span></span> exename.exe.local Jun 05 23:00:17 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> just an empty file? Jun 05 23:00:21 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mjansen</span></span></span><span class="hljs-tag">&gt;</span></span> yea Jun 05 23:00:49 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> mjansen: do we support these .local files? Jun 05 23:00:52 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mjansen</span></span></span><span class="hljs-tag">&gt;</span></span> we dont Jun 05 23:00:54 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mjansen</span></span></span><span class="hljs-tag">&gt;</span></span> windows does Jun 05 23:15:48 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> moment... I'll try with .local Jun 05 23:18:43 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> mjansen: I've created git.exe.local but it still doesn't load msvcrt.dll in this directory</code> </pre> <br><p> ä½†æ˜¯ç”±äºæŸç§åŸå› ï¼Œè¯¥æ–¹æ³•ä¹Ÿä¸èµ·ä½œç”¨ã€‚ ä¹Ÿè®¸æˆ‘åœ¨Windowsï¼ˆ2008 R2ï¼‰æœåŠ¡å™¨ç‰ˆæœ¬ä¸Šè¿›è¡Œäº†æ‰€æœ‰å®éªŒçš„äº‹å®ã€‚ </p><br><p> çˆ±é©¬ä»•æå‡ºäº†æœ€åä¸€ä¸ªæƒ³æ³•ï¼š </p><br><pre> <code class="html hljs xml">Jun 05 23:19:28 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> last solution: patch "msvcrt" name within git and perhaps other mingwe dlls ^^ Jun 05 23:20:12 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> good idea about patching!</code> </pre> <br><p> å› æ­¤ï¼Œæˆ‘ä½¿ç”¨WinHexå°†<code>msvcrt</code>ä¸­æ‰€æœ‰å‡ºç°çš„<code>msvcrt</code>æ›¿æ¢ä¸º<code>msvcrt</code> ï¼Œå¹¶ç›¸åº”åœ°é‡å‘½åäº†ReactOS msvcrt.dllï¼Œè¿™æ˜¯ï¼š </p><br><p><img src="https://habrastorage.org/webt/9l/8z/si/9l8zsinphrucuzluxoqbuz67ar8.png" alt="å›¾ç‰‡"></p><br><pre> <code class="html hljs xml">Jun 05 23:23:29 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> Yes! guilty is msvcrt :) Jun 05 23:25:37 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> ah, so as soon as git uses our msvcrt we get the problem on windows. Jun 05 23:25:38 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> hbelusca, mjansen, https://image.prntscr.com/image/FoOWnrQ4SOGMD-66DLW16Q.png Jun 05 23:25:58 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> aha and it asserts <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">3</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Jun</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">05</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">23:26:03</span></span></span><span class="hljs-tag"> &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> (it shows the assertion now)</code> </pre> <br><p> ç°åœ¨ï¼Œæˆ‘ä»¬æ‰“äº†åŒæ ·çš„æ–­è¨€ï¼Œä½†æ˜¯åœ¨Windowsä¸­ï¼ è¿™æ„å‘³ç€æˆ‘ä»¬é—®é¢˜çš„æ ¹æºåœ¨äºReactOSçš„msvcrtå‡½æ•°ä¹‹ä¸€ã€‚ </p><br><p> è¿˜åº”æ³¨æ„ï¼Œæ–­è¨€æ¶ˆæ¯åœ¨Windowsä¸­æ­£ç¡®æ˜¾ç¤ºã€‚ </p><br><pre> <code class="html hljs xml">Jun 05 23:26:13 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> but it prints text and correctly. Jun 05 23:26:20 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> oh Jun 05 23:26:33 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> and on ROS it doesn't print in most cases xD Jun 05 23:26:38 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> so also it excludes another hypothesis, namely that it could have been a bug in our msvcrt/crt Jun 05 23:26:56 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> So possibly a strange bug in our console</code> </pre> <br><p> å› æ­¤ï¼Œè¦è§£å†³å®é™…é—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨msvcrtä¸­æ‰¾åˆ°æä¾›å½“å‰åº”ç”¨ç¨‹åºå®Œæ•´è·¯å¾„çš„APIå‡½æ•°ã€‚ æˆ‘ç”¨<code>_pgmptr</code>æœç´¢äº†ä¸€ä¸‹ï¼Œå¹¶å‡è®¾é—®é¢˜å‡ºåœ¨<code>_pgmptr</code>å‡½æ•°ä¸Šã€‚ </p><br><pre> <code class="html hljs xml">Jun 06 00:07:43 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> https://msdn.microsoft.com/en-us/library/tza1y5f7.aspx Jun 06 00:07:57 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> When a program is run from the command interpreter (Cmd.exe), _pgmptr is automatically initialized to the full path of the executable file. Jun 06 00:08:01 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> this ^^) Jun 06 00:08:50 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> That's what GetModuleFileName does. Jun 06 00:09:04 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> yeah Jun 06 00:10:30 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> Of course in ROS msvcrt we don't do this, but instead we initialize pgmptr to what argv[0] could be. Jun 06 00:11:08 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> That's one thing. Jun 06 00:11:34 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> The other thing is that nowhere it appears (in MS CRT from VS, or in wine) that argv is initialized using pgmptr. Jun 06 00:13:33 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> hbelusca, I've checked argv[0] in some ROS command line tools, running them in Windows Jun 06 00:13:56 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> they all interpret argv[0] as command line, not full path Jun 06 00:14:04 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> so... I think it's git specific behaviour Jun 06 00:14:16 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> or specific mingw compiler settings Jun 06 00:28:12 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> x86corez: I'm making a patch for our msvcrt, would be nice if you could test it :) Jun 06 00:28:21 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> I'll test it</code> </pre> <br><p>  Hermeså‘é€äº†æŒ‡å‘è¡¥ä¸çš„é“¾æ¥ï¼Œæˆ‘æ‰‹åŠ¨åº”ç”¨äº†å®ƒå¹¶é‡å»ºäº†ç³»ç»Ÿï¼Œç„¶åè¿™äº›åŠ¨ä½œå°†åŸæ¥çš„é—®é¢˜ç¥å¥‡åœ°æ¶ˆå¤±äº†ï¼ </p><br><p><img src="https://habrastorage.org/webt/jp/yy/5p/jpyy5pmeuypncrl9ahuf4szvnxe.png" alt="å›¾ç‰‡"></p><br><pre> <code class="html hljs xml">Jun 06 00:34:26 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> hbelusca, IT WORKS! Jun 06 00:35:10 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> LOL Jun 06 00:35:18 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> So it seems that something uses pgmptr to rebuild an argv. Jun 06 00:35:52 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> I've even able to clone :) Jun 06 00:36:19 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> \o/ Jun 06 00:36:21 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gigaherz</span></span></span><span class="hljs-tag">&gt;</span></span> 2.10.0-rc2? not the release? Jun 06 00:36:24 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> ok I'm gonna commit that stuff. Jun 06 00:36:43 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hbelusca</span></span></span><span class="hljs-tag">&gt;</span></span> x86corez: gonna have ROS self-hosting <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">33</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Jun</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">06</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">00:36:48</span></span></span><span class="hljs-tag"> &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> yeah! Jun 06 00:37:01 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> gigaherz: I've built that from sources Jun 06 00:37:37 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gigaherz</span></span></span><span class="hljs-tag">&gt;</span></span> oh, for testing this bug? o_O Jun 06 00:37:50 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sanchaez</span></span></span><span class="hljs-tag">&gt;</span></span> yes, you missed the fun :p Jun 06 00:39:46 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x86corez</span></span></span><span class="hljs-tag">&gt;</span></span> git 2.10.0-windows.1 (release) works too! Jun 06 00:39:54 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">encoded</span></span></span><span class="hljs-tag">&gt;</span></span> commit!!!</code> </pre> <br><h2 id="afterword"> åè®° </h2><br><p> ä¹Ÿå°±æ˜¯è¯´ï¼Œç”±äºé›†ä½“çš„åŠªåŠ›ï¼Œå¦ä¸€ä¸ªé—´æ¥é˜»æ­¢ReactOSæ„å»ºè‡ªèº«çš„é”™è¯¯å·²å¾—åˆ°ä¿®å¤ã€‚ æœ‰è¶£çš„å·§åˆæ˜¯ï¼Œä¸ä¹…å‰ï¼Œå¦ä¸€ä¸ªé”™è¯¯è¢«ä¿®å¤åœ¨åŒä¸€ä¸ªmsvcrtåŠ¨æ€åº“ï¼ˆå³<code>qsort</code>å‡½æ•°ï¼‰ä¸­ï¼Œè¯¥åº“ä¸å…è®¸åœ¨ReactOSä¸­ç¼–è¯‘USBé©±åŠ¨ç¨‹åºã€‚ </p><br><p> æˆ‘å‚ä¸äº†è®¸å¤šä½¿ç”¨ä¸åŒç¼–ç¨‹è¯­è¨€ç¼–å†™çš„é¡¹ç›®çš„å¼€å‘ï¼ŒåŒ…æ‹¬å°é—­å’Œå¼€æ”¾æºä»£ç ã€‚ è‡ª2014å¹´ä»¥æ¥ï¼Œæˆ‘ä¸€ç›´åœ¨ä¸ºReactOSé¡¹ç›®åšè´¡çŒ®ï¼Œä½†æ˜¯ç›´åˆ°2017å¹´ï¼Œæˆ‘æ‰å¼€å§‹ç§¯ææä¾›å¸®åŠ©å’Œå®é™…ç¼–å†™ä»£ç ã€‚ä»äº‹è¿™ä¸€é¢†åŸŸçš„å·¥ä½œç‰¹åˆ«æœ‰è¶£ï¼Œå› ä¸ºå®ƒæ˜¯æ•´ä¸ªæ“ä½œç³»ç»Ÿï¼ æ‚¨å°†ä»˜å‡ºå·¨å¤§çš„åŠªåŠ›æˆæœï¼Œå¹¶æ„Ÿåˆ°å‡å°‘äº†ä¸€ä¸ªé”™è¯¯ï¼Œè¿™æ˜¯ä»¤äººæ„‰å¿«çš„æ„Ÿè§‰ï¼  :) </p><br><p> æœ‰äººå¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä¸ºReactOSè€Œä¸æ˜¯Linuxåšè´¡çŒ®ã€‚ å› æ­¤ï¼Œä»å†å²ä¸Šçœ‹ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘éƒ½æ˜¯ä¸ºWindowsç¼–å†™ç¨‹åºï¼Œè€Œæˆ‘æœ€å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€æ˜¯Delphiã€‚ ä¹Ÿè®¸è¿™å°±æ˜¯ä¸ºä»€ä¹ˆWindows NTå’ŒWin32 APIçš„ä½“ç³»ç»“æ„ä»¤æˆ‘éå¸¸æ„Ÿå…´è¶£çš„åŸå› ï¼Œè€Œå…è´¹çš„Windowsæ›¿ä»£å“çš„ReactOSé¡¹ç›®ä½¿å¤è€çš„æ¢¦æƒ³æˆçœŸ-å®ƒä½¿æ‚¨å¯ä»¥äº†è§£å®é™…æƒ…å†µä¸‹æ‰€æœ‰å·¥ä½œåŸç†ã€‚ </p><br><p> å¸Œæœ›æ‚¨å–œæ¬¢æˆ‘çš„ç¬¬ä¸€ç¯‡è‹±æ–‡æ–‡ç« ã€‚ æœŸå¾…æ‚¨çš„è¯„è®ºï¼ </p><br><h3 id="links"> å‹æƒ…é“¾æ¥ </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JIRAé”™è¯¯è·Ÿè¸ªå™¨ä¸­çš„ç¥¨è¯</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MSDNä¸Šçš„<code>_pgmptr</code> APIæè¿°</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¿®å¤é”™è¯¯çš„æäº¤</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ¬æ–‡çš„ä¿„è¯­ç‰ˆæœ¬</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN439580/">https://habr.com/ru/post/zh-CN439580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN439570/index.html">IPythoné­”æœ¯æ¥ç¼–è¾‘Jupyterç»†èƒæ ‡è®°</a></li>
<li><a href="../zh-CN439572/index.html">ç”µå­è®¾å¤‡çš„è®¡ç®—æœºè¾…åŠ©è®¾è®¡</a></li>
<li><a href="../zh-CN439574/index.html">SmartCard I2Cåè®®ã€‚ é€šè¿‡I2Cæ¥å£äº¤æ¢APDUå‘½ä»¤</a></li>
<li><a href="../zh-CN439576/index.html">Pythoné‡‡è®¿çš„å¹¿æ³›æ¦‚è¿°ã€‚ æç¤ºä¸æŠ€å·§</a></li>
<li><a href="../zh-CN439578/index.html">å…³äºè½¬æ¢å’Œå…¶ä»–æ“ä½œçš„é—®é¢˜</a></li>
<li><a href="../zh-CN439584/index.html">Lenergyé¡¹ç›®æ˜¯å¯¹ä¾¿æºå¼ç”µæºçš„é‡æ–°æ€è€ƒ</a></li>
<li><a href="../zh-CN439586/index.html">SPBmåè®®æ˜¯æç«¯è‡ªåŠ¨åŒ–æ ¡å›­çš„åŸºç¡€</a></li>
<li><a href="../zh-CN439588/index.html">ESETå‘ç°äº†DanaBotæœ¨é©¬çš„æ–°ç‰ˆæœ¬</a></li>
<li><a href="../zh-CN439590/index.html">è´¨é‡ï¼šæ²™ç‰¹å’Œé˜¿æ›¼å›½å®¶ç½‘ç»œå®‰å…¨CTF2019ã€‚WriteUp</a></li>
<li><a href="../zh-CN439592/index.html">é“å¾·æ´»åŠ¨è‡ªåŠ¨åŒ–</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>