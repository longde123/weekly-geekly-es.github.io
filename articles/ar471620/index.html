<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💉 💍 📛 استراتيجيات النشر في Kubernetes: المتداول ، إعادة ، الأزرق / الأخضر ، الكناري ، الظلام (A / B اختبار) 🛌🏽 🤠 🧘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="تقريبا. perev.: تقدم مادة المراجعة هذه من Weaveworks استراتيجيات بدء التطبيق الأكثر شيوعًا وتتحدث عن إمكانية تنفيذ أكثرها تقدمًا باستخدام مشغل Kuberne...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>استراتيجيات النشر في Kubernetes: المتداول ، إعادة ، الأزرق / الأخضر ، الكناري ، الظلام (A / B اختبار)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/471620/" style=";text-align:right;direction:rtl">  <i><b>تقريبا.</b></i>  <i><b>perev.: تقدم</b> مادة المراجعة هذه من Weaveworks استراتيجيات بدء التطبيق الأكثر شيوعًا وتتحدث عن إمكانية تنفيذ أكثرها تقدمًا باستخدام مشغل Kubernetes Flagger.</i>  <i>إنه مكتوب بلغة بسيطة ويحتوي على مخططات بصرية تجعل من الممكن حتى للمهندسين المبتدئين فهم المشكلة.</i> <br><br><img src="https://habrastorage.org/webt/fh/bq/eq/fhbqeq1e_cjmxhj_-d15uvfna-a.png"><br>  <i>الرسم مأخوذ من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مراجعة أخرى</a> لاستراتيجيات التنفيذ التي تم إجراؤها في Container Solutions.</i> <br><br>  واحدة من أكبر المشاكل في تطوير التطبيقات السحابية المحلية اليوم هي نشر النشر.  من خلال منهج microservice ، يعمل المطورون بالفعل مع تطبيقات كاملة الوحدات وتصميمها ، مما يتيح للفرق المختلفة كتابة التعليمات البرمجية وإجراء تغييرات على التطبيق في نفس الوقت. <br><br>  عمليات النشر الأقصر والأكثر تكرارًا لها المزايا التالية: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  يتم تقليل الوقت إلى السوق. </li><li style=";text-align:right;direction:rtl">  تصل الميزات الجديدة إلى المستخدمين بشكل أسرع. </li><li style=";text-align:right;direction:rtl">  تصل ملاحظات المستخدم إلى فريق التطوير بشكل أسرع.  هذا يعني أنه يمكن للفريق استكمال المهام وحل المشكلات بسرعة أكبر. </li><li style=";text-align:right;direction:rtl">  تزداد معنويات المطورين: من الممتع العمل مع عدد كبير من الوظائف في التطوير. </li></ul><a name="habracut"></a><br>  ولكن مع زيادة ترددات الإصدار ، تزداد أيضًا فرص التأثير السلبي على موثوقية التطبيق أو تجربة المستخدم.  هذا هو السبب في أنه من المهم لفرق العمليات و DevOps بناء العمليات وإدارة استراتيجيات النشر بطريقة تقلل من المخاطر التي يتعرض لها المنتج والمستخدمون.  (تعرف على المزيد حول أتمتة خطوط أنابيب CI / CD <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هنا</a> .) <br><br>  في هذا المنشور ، سنناقش استراتيجيات النشر المختلفة في Kubernetes ، بما في ذلك عمليات النشر المتجددة والأساليب الأكثر تقدماً مثل نشرات الكناري وأشكالها المختلفة. <br><br><h2 style=";text-align:right;direction:rtl">  استراتيجيات النشر </h2><br>  هناك عدة أنواع مختلفة من استراتيجيات النشر التي يمكنك استخدامها بناءً على هدفك.  على سبيل المثال ، قد تحتاج إلى إجراء تغييرات على بيئة معينة لإجراء مزيد من الاختبارات ، أو لمجموعة فرعية من المستخدمين / العملاء ، أو قد تحتاج إلى إجراء اختبارات محدودة على المستخدمين قبل إتاحة بعض الوظائف <i>للجمهور</i> . <br><br><h3 style=";text-align:right;direction:rtl">  المتداول (التدريجي ، نشر "المتداول") </h3><br>  هذه استراتيجية نشر قياسية في Kubernetes.  تدريجيا ، واحدا تلو الآخر ، يستبدل قرون مع الإصدار القديم من التطبيق مع القرون مع الإصدار الجديد - دون توقف الكتلة. <br><br><img src="https://habrastorage.org/webt/zk/gb/4n/zkgb4n3ppub2pjxw5qobxhi3y6e.png"><br><br>  تنتظر Kubernetes حتى تصبح القرون الجديدة جاهزة للعمل (فحصها <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">باختبارات الاستعداد</a> ) قبل البدء في انهيار القديمة.  في حالة حدوث مشكلة ، يمكن مقاطعة هذا التحديث المتداول دون إيقاف المجموعة بالكامل.  في ملف نوع YAML للنشر ، تحل الصورة الجديدة محل الصورة القديمة: <br><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">apiVersion: apps/v1beta1 kind: Deployment metadata: name: awesomeapp spec: replicas: 3 template: metadata: labels: app: awesomeapp spec: containers: - name: awesomeapp image: imagerepo-user/awesomeapp:new ports: - containerPort: 8080</code> </pre> <br>  يمكن تحديد معلمات التحديث المتداول في ملف البيان: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">spec: replicas: 3 strategy: type: RollingUpdate rollingUpdate: maxSurge: 25% maxUnavailable: 25% template: ...</code> </pre><br><h3 style=";text-align:right;direction:rtl">  إعادة (إعادة الإنشاء) </h3><br>  في هذا النوع الأبسط من النشر ، يتم قتل القرون القديمة دفعة واحدة واستبدالها بأخرى جديدة: <br><br><img src="https://habrastorage.org/webt/s8/cc/f4/s8ccf4olujogufddg0vav3jhens.png"><br><br>  يبدو البيان المقابل شيئًا مثل هذا: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">spec: replicas: 3 strategy: type: Recreate template: ...</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  الأزرق / الأخضر (نشر الأزرق والأخضر) </h3><br>  تتضمن استراتيجية النشر باللون الأزرق والأخضر (تسمى أحيانًا باللون الأحمر / الأسود ، أي باللون الأحمر والأسود) النشر المتزامن للإصدارات القديمة (الخضراء) والجديدة (الزرقاء) من التطبيق.  بعد وضع كلا الإصدارين ، يمكن للمستخدمين العاديين الوصول إلى الإصدار الأخضر ، بينما يتوفر الإصدار الأزرق لفريق ضمان الجودة لأتمتة الاختبارات من خلال خدمة منفصلة أو إعادة توجيه المنفذ المباشر: <br><br><img src="https://habrastorage.org/webt/th/zp/ee/thzpeewsyc4kfooyoffzlq7wsbg.png"><br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: apps/v1beta1 kind: Deployment metadata: name: awesomeapp-02 spec: template: metadata: labels: app: awesomeapp version: "02"</code> </pre> <br>  بعد أن تم اختبار الإصدار الأزرق (الجديد) وتمت الموافقة على إصداره ، تنتقل الخدمة إليه ، ويتم تقليل اللون الأخضر (القديم) إلى الحد الأدنى: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: v1 kind: Service metadata: name: awesomeapp spec: selector: app: awesomeapp version: "02" ...</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  الكناري (نشر الكناري) </h3><br>  تبدو لفائف الكناري باللون الأزرق والأخضر ، ولكن تتم إدارتها بشكل أفضل وتستخدم نهجًا متدرجًا متدرجًا.  يتضمن هذا النوع العديد من الاستراتيجيات المختلفة ، بما في ذلك عمليات الإطلاق "الخفية" واختبار A / B. <br><br>  يتم استخدام هذه الاستراتيجية عندما يكون من الضروري تجربة بعض الوظائف الجديدة ، كقاعدة عامة ، في الواجهة الخلفية للتطبيق.  يتمثل جوهر النهج في إنشاء خادمين متطابقين تقريبًا: أحدهما يخدم جميع المستخدمين تقريبًا ، والآخر ، بميزات جديدة ، يخدم فقط مجموعة فرعية صغيرة من المستخدمين ، وبعد ذلك تتم مقارنة نتائجهم.  إذا سارت الأمور على نحو سلس ، فإن الإصدار الجديد بدأ يتدرج تدريجياً إلى البنية التحتية بأكملها. <br><br>  على الرغم من أنه لا يمكن تنفيذ هذه الاستراتيجية إلا باستخدام أدوات Kubernetes ، واستبدال القرون القديمة بأخرى جديدة ، إلا أنها أكثر سهولة وأسهل في استخدام شبكة الخدمة مثل Istio. <br><br>  على سبيل المثال ، يمكن أن يكون لديك بيانان مختلفان في Git: الإصدار العادي مع علامة 0.1.0 والأخرى "canary" مع علامة 0.2.0.  من خلال تغيير الأوزان في بيان عبّارة Istio الافتراضية ، يمكنك التحكم في توزيع حركة المرور بين هاتين النشرتين: <br><br><img src="https://habrastorage.org/webt/gi/sc/0j/gisc0jek9mx_ayulquedmg_fapi.png"><br><br>  للحصول على معلومات حول تنفيذ عمليات نشر الكناري باستخدام Istio ، راجع <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GitOps Workflows باستخدام Istio</a> .  <i>( <b>ملاحظة الترجمة</b> : لقد ترجمنا أيضًا مواد حول لفائف الكناري في Istio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هنا</a> .)</i> <br><br><h4 style=";text-align:right;direction:rtl">  نشرات الكناري مع Weaveworks Flag </h4><br>  يجعل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Weaveworks Flagger</a> من السهل والكفاءة إدارة النشرات الكنارية. <br><br>  Flagger بأتمتة العمل معهم.  يستخدم Istio أو AWS App Mesh لتوجيه حركة المرور وتبديلها ، وكذلك مقاييس Prometheus لتحليل النتائج.  بالإضافة إلى ذلك ، يمكن استكمال تحليل عمليات نشر الكناري بسهول الويب لاختبارات القبول واختبارات الإجهاد وأي أنواع أخرى من الفحوصات. <br><br>  استنادًا إلى نشر Kubernetes ، وإذا لزم الأمر ، التوسع الأفقي للقرون (HPA) ، تنشئ Flagger مجموعات من الكائنات (نشر Kubernetes وخدمات ClusterIP والخدمات الافتراضية Istio أو App Mesh) لتحليل وتنفيذ عمليات نشر الكناري: <br><br><img src="https://habrastorage.org/webt/-u/vo/wj/-uvowj-rfdu9kwnslkjfmxj1_p4.png"><br><br>  عند تنفيذ <i>حلقة تحكم</i> ، يقوم Flagger بتحويل حركة المرور تدريجياً إلى خادم الكناري ، مع قياس مؤشرات الأداء الرئيسية في وقت واحد ، مثل النسبة المئوية لطلبات HTTP الناجحة ، ومتوسط ​​مدة الطلب ، وصحة الجهاز.  بناءً على تحليل KPI (مؤشرات الأداء الرئيسية) ، ينمو جزء الكناري أو ينهار ، ويتم نشر نتائج التحليل في سلاك.  يمكن العثور على وصف وعرض لهذه العملية في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">التسليم التدريجي لشبكة التطبيقات</a> . <br><br><img src="https://habrastorage.org/webt/gt/vc/o2/gtvco2gxt0zgw2iqy00bs892phe.png"><br><br><h3 style=";text-align:right;direction:rtl">  نشر داكن (مخفي) أو A / B </h3><br>  النشر السري هو تباين آخر في إستراتيجية الكناري (يمكن للفلجر أيضًا أن يعمل معها ، بالمناسبة).  الفرق بين عمليات النشر السرية والكنارية هو أن عمليات النشر السرية تتعامل مع الواجهة الأمامية وليس الواجهة الخلفية ، مثل النشرات الكنارية. <br><br>  اسم آخر لعمليات النشر هذه هو اختبار A / B.  بدلاً من فتح الوصول إلى الوظيفة الجديدة لجميع المستخدمين ، يتم تقديمها فقط لجزء محدود منهم.  عادةً ، لا يعرف هؤلاء المستخدمون أنهم اختبار رائد (ومن ثم مصطلح "النشر السري"). <br><br>  باستخدام <i>تبديل</i> الوظائف والأدوات الأخرى ، يمكنك مراقبة كيفية تفاعل المستخدمين مع الميزة الجديدة ، سواء كان ذلك يأسرهم ، أو ما إذا وجدوا واجهة المستخدم الجديدة مربكة ، وأنواع أخرى من المقاييس. <br><br><img src="https://habrastorage.org/webt/hs/gw/jo/hsgwjoo8bij97zvuhrv9evmix-s.png"><br><br><h4 style=";text-align:right;direction:rtl">  نشرات Flagger و A / B </h4><br>  بالإضافة إلى التوجيه الموزون ، يمكن لـ Flagger أيضًا توجيه حركة المرور إلى خادم الكناري ، اعتمادًا على إعدادات HTTP.  لاختبار A / B ، يمكنك استخدام رؤوس HTTP أو ملفات تعريف الارتباط لإعادة توجيه شريحة معينة من المستخدمين.  هذا فعال بشكل خاص لتطبيقات الواجهة الأمامية التي تتطلب <i>تقارب الجلسة</i> للخادم.  لمزيد من المعلومات ، راجع وثائق Flagger. <br><br>  <i>يشكر المؤلف <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ستيفان برودان</a> ، مهندس Weaveworks (ومؤسس برنامج Flagger) ، على كل هذه النشرات الرائعة.</i> <br><br><h2 style=";text-align:right;direction:rtl">  PS من المترجم </h2><br>  اقرأ أيضًا في مدونتنا: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">نظرة عامة ومقارنة وحدات التحكم في الدخول لـ Kubernetes</a> " ؛ </li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Werf هو أداة CI / CD الخاصة بنا في Kubernetes (تقرير المراجعة والفيديو)</a> " ؛ </li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تجميع ونشر نفس النوع من الخدمات المصغرة مع werf و GitLab CI</a> " ؛ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ما هو GitOps؟</a>  ". </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar471620/">https://habr.com/ru/post/ar471620/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar471604/index.html">لا تنسى فتح الرسم البياني</a></li>
<li><a href="../ar471608/index.html">نظام تجنب الاصطدام: الجزء 1. التشريع كما المعارف التقليدية للمطور</a></li>
<li><a href="../ar471610/index.html">خادم REST على Prolog ، كيف يبدو؟</a></li>
<li><a href="../ar471614/index.html">صدأ 1.20.0 الإصدار: دعم لمحات ، والتحسينات في التحديث وأوامر الوثيقة</a></li>
<li><a href="../ar471618/index.html">C / C ++ من بيثون (دفعة)</a></li>
<li><a href="../ar471622/index.html">Xamarin.Forms - مثال بسيط على مضاهاة البطاقة المستندة إلى المضيف</a></li>
<li><a href="../ar471624/index.html">تقديم عرض تقديمي مع تصميم UI / UX مثالي</a></li>
<li><a href="../ar471626/index.html">الذكاء الاصطناعى للناس: كلمات بسيطة عن التكنولوجيا</a></li>
<li><a href="../ar471628/index.html">أنا بمفرده إعادة تشكيلها 15 ألف خطوط إرث. كان أسوأ أسبوعين في حياتي</a></li>
<li><a href="../ar471630/index.html">المتعة المحرمة: في أي دول يتم حظر PornHub ولماذا</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>