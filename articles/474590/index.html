<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üà∑Ô∏è üèØ üíá Conferencia 27 de DEFCON. Beneficios de los productos hacker para macOS. Parte 2 üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø üè∫ üï∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Conferencia 27 de DEFCON. Beneficios de los productos hacker para macOS. Parte 1 

 Habiendo recibido un archivo con c√≥digo malicioso de un servidor C...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conferencia 27 de DEFCON. Beneficios de los productos hacker para macOS. Parte 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/474590/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Conferencia 27 de DEFCON. Beneficios de los productos hacker para macOS.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> <br><br>  Habiendo recibido un archivo con c√≥digo malicioso de un servidor C&amp;C de hackers remotos, el exploit procede a ejecutarlo.  Utiliza el mismo m√©todo SDF cuando el archivo de malware se desempaqueta usando el comando √≠dem incorporado y luego se ejecuta a trav√©s de la API NS.  Por lo tanto, Windtall utiliza un gestor de arranque incorporado est√°ndar. <br><br><img src="https://habrastorage.org/webt/s5/ah/23/s5ah23zhuchevz5cvkvhqsnpqcs.jpeg"><br><br>  Adem√°s, la puerta trasera est√° equipada con una l√≥gica de autoliquidaci√≥n, por lo que cada vez que se inicia el malware, se pone en contacto con el servidor hacker y le pregunta si debe desinstalarse.  Si el servidor C&amp;C responde con el c√≥digo "1", el programa se elimina a s√≠ mismo, deteniendo as√≠ la actividad de spyware. <a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/hb/b0/nv/hbb0nv9sjwt182m_llrlfnucgxm.jpeg"><br><br>  Esta es una caracter√≠stica muy √∫til que permite a un atacante "desinfectar" remotamente un objetivo sin dejar rastros de su intervenci√≥n.  Ahora mostrar√© c√≥mo rehacemos este virus para nuestras propias necesidades. <br><br><img src="https://habrastorage.org/webt/yr/zs/vb/yrzsvbpwib8b9jenyer3zks92ki.jpeg"><br><br>  Primero, hablemos de reprobar un exploit.  Crear una p√°gina web de hackers que descargue autom√°ticamente un archivo ZIP que contenga una aplicaci√≥n maliciosa es bastante simple.  Como mencion√©, Safari descomprimir√° autom√°ticamente los archivos ZIP de manera predeterminada, por lo que si colocamos una aplicaci√≥n maliciosa en este archivo que implemente algunos controladores de URL, Mac OS lo registrar√° autom√°ticamente antes de que el usuario inicie la aplicaci√≥n. <br><br>  Una p√°gina web maliciosa puede solicitar esta URL de usuario ya registrada, lo que conducir√° al lanzamiento de la aplicaci√≥n.  Por lo general, aparece una ventana de advertencia, pero el usuario hace clic en el bot√≥n sin prestarle atenci√≥n. <br><br>  Entonces, ¬øves una demostraci√≥n del exploit redise√±ado y una ventana de advertencia de que "Final_Presentation" es una aplicaci√≥n descargada de Internet, preguntando si el usuario est√° seguro de querer abrirla en la computadora? <br><br>  Hacer clic en el bot√≥n "Abrir" es la segunda solicitud que causa una ventana emergente, y si el usuario hace clic en el icono de la aplicaci√≥n que se muestra en √©l, veremos que el malware se instal√≥ autom√°ticamente en el sistema. <br><br><img src="https://habrastorage.org/webt/da/cz/w0/daczw0yu3d4vlyaa2ma79fx5tq8.jpeg"><br><br>  Hay una falla l√≥gica en Apple donde no es necesario parchear el sistema operativo para infectar el sistema, y ‚Äã‚Äãesto todav√≠a funciona en la √∫ltima versi√≥n de macOS.  Ahora que hemos rehecho el exploit, hablemos de rehacer malware. <br><br><img src="https://habrastorage.org/webt/k8/q2/wh/k8q2whc8srob_t065-xvvldbgy4.jpeg"><br><br>  Nuestro primer paso es reemplazar la direcci√≥n integrada del servidor C&amp;C para que el exploit se ponga en contacto con nuestro servidor y descargue el malware convertido.  Lamentablemente, la direcci√≥n estaba encriptada, pero esto no nos molest√≥.  Decidimos hacer que el malware siempre cargara la biblioteca din√°mica.  Luego, tan pronto como nuestra biblioteca se lanz√≥ en el espacio de direcciones del proceso malicioso, podr√≠amos, en principio, modificar el malware para que intercepte las direcciones descifradas del servidor C&amp;C durante la operaci√≥n, incluso antes de usar este servidor para la conexi√≥n.  Echemos un vistazo m√°s de cerca a este proceso. <br><br>  Perm√≠tame recordarle nuevamente: nuestro objetivo era volver a perfilar el malware especificando nuestro propio servidor de C&amp;C para que el malware se conectara nuevamente a nuestra infraestructura. <br><br><img src="https://habrastorage.org/webt/3h/qj/33/3hqj33qe_pjauk4ynkd_bgpy8q0.jpeg"><br><br>  Entonces, la biblioteca din√°mica se carg√≥ en el espacio de direcciones del malware y reemplazamos el procedimiento de descifrado o aplicamos Swizzle.  Este eficiente y poderoso m√©todo de reemplazo de API se llama Yoop. <br><br>  La diapositiva muestra que reemplazamos la funci√≥n de descifrado de tal manera que cada vez que el malware lo llama, en realidad llama a nuestro m√©todo de descifrado en nuestra biblioteca.  No tengo idea de qu√© es el algoritmo de descifrado y c√≥mo funciona, y, francamente, no me importa, pero despu√©s de la sustituci√≥n puedo ver el resultado de este cifrado.  Entonces, si el m√©todo de cifrado original me devuelve las direcciones descifradas del servidor C&amp;C, simplemente puedo incrustar mi propio servidor C&amp;C en la l√≥gica del malware.  Esto nos permite reemplazar de manera transparente el servidor C&amp;C descifrado con nuestro servidor. <br><br>  Ahora estoy agregando algunos mensajes de depuraci√≥n a la biblioteca para que cuando ejecutemos el malware convertido, podamos ver c√≥mo se reemplazan las direcciones del servidor C&amp;C durante su ejecuci√≥n.  En la ventana de terminal de la l√≠nea de comandos, puede ver c√≥mo nuestra biblioteca, que sigue el m√©todo de descifrado original, detecta que esta respuesta proviene del servidor C&amp;C, cuya direcci√≥n ahora est√° descifrada. <br><br><img src="https://habrastorage.org/webt/jy/vq/pp/jyvqppeptj5tsynsrub5ao7qzb8.jpeg"><br><br>  Como no queremos que nuestro programa haga referencia a la l√≥gica del malware original, simplemente descartamos esta funci√≥n y volvemos a nuestro propio programa.  Por supuesto, siempre debemos estar seguros de que la puerta trasera est√° accediendo a nuestro servidor de C&amp;C, y no al servidor del grupo APT original. <br><br>  Necesit√°bamos escribir nuestro servidor C&amp;C, porque ahora el malware se conectar√° a √©l, y necesitamos proporcionar una "conversaci√≥n" con el protocolo para confundir correctamente el malware. <br><br><img src="https://habrastorage.org/webt/9a/dg/uj/9adgujslps8-egi02h548dxeplo.jpeg"><br><br>  La funci√≥n principal de la puerta trasera Windtall es recopilar y extraer archivos de usuario, por lo que antes que nada necesit√°bamos agregar esta funci√≥n a nuestro servidor de C&amp;C.  Los archivos se recuperan a trav√©s de una solicitud POST, por lo que acabamos de escribir algunas l√≠neas de c√≥digo Python para permitirnos guardar los archivos recuperados y enviados desde el host infectado. <br><br>  Ver√° en la pantalla c√≥mo nuestro servidor C&amp;C recibe archivos extra√≠dos de la computadora atacada. <br><br><img src="https://habrastorage.org/webt/5z/tu/ey/5ztueycxug4uq7-8_mvofucvowe.jpeg"><br><br>  A la izquierda, puede ver c√≥mo entran las solicitudes de red, y a la derecha, c√≥mo nuestro servidor las escribe en el sistema de archivos.  Esto significa que ahora admitimos la capacidad del malware para extraer archivos de todo tipo de un host infectado. <br><br>  Tambi√©n hemos adaptado nuestro servidor C&amp;C para admitir las capacidades de descarga y ejecuci√≥n de Windtall.  Notamos que para este malware se realizan 2 solicitudes. <br><br><img src="https://habrastorage.org/webt/ap/y3/6h/apy36hocalariebs3edovjvgfas.jpeg"><br><br>  La primera solicitud se refiere a obtener el nombre del archivo para descargar, y la segunda solicitud debemos responder con bytes espec√≠ficos del archivo que queremos descargar.  El malware guarda todo esto en el archivo que especificamos, luego lo descomprime y lo ejecuta.  Repito una vez m√°s: nos tom√≥ solo un par de l√≠neas en Python, es simple, ya que utiliza muchas bibliotecas integradas. <br><br>  Tan pronto como hicimos esto, tuvimos la oportunidad de "descifrar" el implante.  Miremos en acci√≥n.  Vemos c√≥mo el malware se conecta a nuestro servidor de C&amp;C, porque cambiamos con √©xito la direcci√≥n del servidor original y realizamos la tarea que se le asigna: descarga la aplicaci√≥n Calculadora. <br><br><img src="https://habrastorage.org/webt/gg/au/3d/ggau3dqd27ai3u5dk115bylndnw.jpeg"><br><br>  La capacidad de descargar y ejecutar aplicaciones de forma remota significa que podemos instalar otras herramientas u otras muestras de malware en la computadora del usuario.  Esto expande infinitamente el potencial para usar software hacker reutilizado. <br><br>  Finalmente, demos a nuestro servidor la capacidad de eliminar el malware de forma remota.  La funci√≥n de autodestrucci√≥n es muy √∫til si los chicos del FBI entran por la puerta.  Un clic en la tecla y el virus se eliminar√° de todos los sistemas infectados. <br><br><img src="https://habrastorage.org/webt/yp/ru/dy/yprudyqitu1zcbxqi3ahyfvsixs.jpeg"><br><br>  El software esp√≠a nos contacta peri√≥dicamente con una solicitud sobre si es necesario eliminarse y, si es necesario, simplemente respondemos con el c√≥digo "1", despu√©s de lo cual se desinstala por completo del sistema. <br><br>  Otra demostraci√≥n mostrar√° esto en acci√≥n.  Puede ver que nuestro malware tiene su propio logotipo naranja que imita un documento de Power Point, pero en realidad es un directorio oculto del sistema. <br><br><img src="https://habrastorage.org/webt/ar/pd/ak/arpdakjxkom1af3v9jxmttspha0.jpeg"><br><br>  Despu√©s de que una vez m√°s envi√≥ una solicitud de destrucci√≥n al servidor de C&amp;C y respondimos en uno, el √≠cono naranja desapareci√≥ del directorio del programa, y ‚Äã‚Äãla aplicaci√≥n en s√≠ misma dej√≥ de ‚Äúhablarnos‚Äù porque se autodestruy√≥. <br><br><img src="https://habrastorage.org/webt/p5/6u/ln/p56ulnb7cf18kh9qd_hmudrhuse.jpeg"><br><br>  Entonces, hemos mostrado c√≥mo algunas muestras de malware para macOS se vuelven a crear, y ahora analicemos c√≥mo permanecer sin ser detectados.  Dado que estamos rehaciendo los programas maliciosos conocidos que la protecci√≥n incorporada de macOS y el software antivirus de terceros detectan y bloquean, debemos resolver este problema de alguna manera. <br><br><h3>  C√≥mo no ser detectado </h3><br>  Primero, hablemos sobre los programas de detecci√≥n y control de virus que est√°n integrados en macOS, como XProtect, la herramienta de eliminaci√≥n de virus MRT y la verificaci√≥n de revocaci√≥n de certificados. <br><br><img src="https://habrastorage.org/webt/ky/_a/di/ky_adibiddjzdqx6zhbhmlfxnb4.jpeg"><br><br>  A primera vista, esto parece problem√°tico, ya que estos programas pueden bloquear nuestro spyware convertido en cualquier Mac.  Por lo tanto, debe pensar en c√≥mo evitar la protecci√≥n, porque si quedamos atrapados con nuestro malware cuidadosamente redise√±ado y Apple lo bloquea, ser√° un completo fracaso. <br><br>  Echemos un vistazo a XProtect primero.  Este es un esc√°ner antivirus simple basado en bases de datos de firmas de virus e integrado en las √∫ltimas versiones de macOS. <br><br><img src="https://habrastorage.org/webt/io/_h/gy/io_hgyg0wdmy6rt34vr_gdlui1a.jpeg"><br><br>  Escanea los archivos descargados por el usuario en la computadora antes de su primer lanzamiento, guiado por las reglas de detecci√≥n de virus.  En la pantalla vemos un escaneo de la firma del virus OSX.KeRanger.A, cuyo nuevo perfil acabamos de examinar. <br><br>  Escribimos una utilidad simple llamada UXProtect, que le permite examinar estas firmas a trav√©s de la interfaz de usuario de la interfaz de usuario, as√≠ como escanear archivos en cualquier momento en busca de firmas de virus.  Debido a que XProtect usa solo el motor de detecci√≥n de firmas, es extremadamente f√°cil moverse.  Echemos un vistazo m√°s de cerca a la firma del virus KeRanger. <br><br><img src="https://habrastorage.org/webt/sw/5h/mw/sw5hmwzwllc0p3bkn3pyd6r1dsy.jpeg"><br><br>  Vemos una indicaci√≥n de un grupo de firmas de malware que solo necesita reordenar o modificar cualquiera de estas instrucciones para omitirlas.  Cambiar algunos bytes de una instrucci√≥n hace que la firma ya no coincida con los par√°metros de detecci√≥n.  Por ejemplo, cambiamos el n√∫mero de bytes a leer del b√∫fer de 0x400 a 0x300.  Esto no afect√≥ la funcionalidad del virus, pero tan pronto como cambiamos la cantidad de bytes que el esc√°ner verifica para que coincida con la firma, excluimos por completo la posibilidad de que XProtect reaccione a esta amenaza. <br><br>  Es hora de otra demostraci√≥n, donde ver√° dos ejemplos de KeRanger.  Nuevamente estamos usando el cliente BitTorrent infectado.  A la izquierda en la pantalla se encuentra la copia original del hacker del virus, y a la derecha est√° su versi√≥n reutilizada, que, para obtener la clave de cifrado, se comunica con nuestro servidor de C&amp;C.  Adem√°s, se modifica para eludir la protecci√≥n XProtect. <br><br><img src="https://habrastorage.org/webt/ag/mw/gs/agmwgscqk2ajoq1ef2shu2lm9yq.jpeg"><br><br>  Ver√° que el sistema bloquea una instancia del virus original sin la posibilidad de iniciarla, y la √∫nica operaci√≥n permitida con ella es la eliminaci√≥n. <br><br><img src="https://habrastorage.org/webt/kv/mb/y4/kvmby4yeqnevt_msi9viidiyhxg.jpeg"><br><br>  Si lanzamos una versi√≥n redise√±ada de KeRanger, el sistema simplemente informa que se ha descargado de Internet y pregunta si realmente queremos lanzarla. <br><br><img src="https://habrastorage.org/webt/va/wn/4j/vawn4ja6artoxgxuure3xnzutt8.jpeg"><br><br>  Si hacemos clic en "Abrir", el ransomware se instala silenciosamente en el sistema e inmediatamente comienza a cifrar todos los archivos del usuario. <br><br><img src="https://habrastorage.org/webt/oo/uj/ex/ooujexbhzffuj8wg6klvihde_gg.jpeg"><br><br>  La siguiente forma de proteger su Mac es verificar las firmas de los certificados.  La mayor√≠a de los binarios macOS firmados no est√°n bloqueados por la funci√≥n de seguridad GateKeeper, por lo que los piratas inform√°ticos proporcionan firmas para la mayor√≠a del malware Mac moderno.  Por otro lado, una vez que se detecta un virus firmado, Apple simplemente revoca su certificado de firma.  Esto significa que este malware no se puede ejecutar en ninguna Mac. <br><br>  Por ejemplo, tenemos un binario del virus Windtall cuyo certificado de firma ha sido revocado por Apple.  Esto significa que incluso si modificamos el perfil y lo aplicamos en el nuevo sistema, a√∫n no podremos comenzar.  Por lo tanto, solo intentamos omitir el procedimiento de revocaci√≥n de certificados eliminando el certificado de firma en s√≠. <br><br><img src="https://habrastorage.org/webt/0f/9g/dy/0f9gdymdaskct9prhp2exlstml4.jpeg"><br><br>  Luego, usamos una copia sin firmar del malware convertido o le proporcionamos un certificado de firma legal diferente, que es bastante f√°cil de obtener. <br><br>  Para eliminar realmente el certificado, Apple proporciona una utilidad llamada Code Sign que contiene el indicador de eliminaci√≥n de firma indocumentado o "eliminar firma".  Si realiza esta operaci√≥n con su malware, Apple simplemente no prestar√° atenci√≥n al certificado de firma revocado. <br><br>  Tambi√©n podemos volver a firmar nuestra aplicaci√≥n usando la misma utilidad usando el comando codeign -s "Developer ID Applikation:".  Esto har√° que macOS ya no bloquee el Windtall re-firmado. <br><br>  Finalmente, pasamos a MRT, la herramienta de eliminaci√≥n de virus incorporada disponible en las √∫ltimas versiones del sistema operativo Mac.  Es similar a XProtect, pero analiza el malware que ya est√° instalado en el sistema y lo detecta autom√°ticamente al detectarlo.  A diferencia de XProtect, sus firmas est√°n incrustadas en su propio archivo binario.  Apple a menudo usa esta herramienta para eliminar aplicaciones leg√≠timas que considera inseguras para su computadora.  Suelen ser aplicaciones que contienen vulnerabilidades conocidas. <br><br><img src="https://habrastorage.org/webt/tq/za/iu/tqzaiuk9rktufxpfwcf8ozwwoae.jpeg"><br><br>  Dado que MRT, como XProtect, funciona con firmas, tambi√©n se puede evitar.  Usamos el volcado MRT, una vez m√°s, porque las firmas est√°n integradas en el binario en s√≠ y pudimos verlas todas, incluida la firma del virus Fruitfly.  Nos preguntamos si MRT podr√≠a detectar nuestra copia convertida de este malware. <br><br><img src="https://habrastorage.org/webt/eg/wa/te/egwatesmsl0ez1ccvzlhw_s0-2y.jpeg"><br><br>  Comenzamos a investigar la firma incorporada de Fruitfly y descubrimos que su detecci√≥n se basa en dos cosas: la ruta para instalar el virus y el archivo .plist descargado.  Esto significa que si cambiamos la ruta o el nombre del malware, MRT no podr√° detectarlo.  Como dije, como resultado, evitar esta protecci√≥n result√≥ ser bastante simple. <br><br>  Descubrimos que moverse por un software antivirus de terceros tampoco es dif√≠cil, ya que puede ejecutar un virus convertido incluso en un sistema en el que el usuario ya ha instalado un antivirus. <br><br><img src="https://habrastorage.org/webt/bm/8o/k0/bm8ok05gky6s453v91lxix-mh2s.jpeg"><br><br>  Se habl√≥ mucho sobre este tema, no quiero entrar en detalles, pero en general, los productos antivirus tradicionales se basan en la verificaci√≥n de firmas, como el software antivirus de Apple, lo que significa que pueden eludirse con los mismos m√©todos. <br><br>  Por ejemplo, tom√© el mismo Fruitfly, record√© que tambi√©n era un script de Perl y lo pas√© a trav√©s de la utilidad en l√≠nea gratuita Perl Obfuscator, que fue dise√±ada para hacer que el script de Perl sea dif√≠cil de leer y reducir la probabilidad de su detecci√≥n a cero.  Naturalmente, funcion√≥.  Pero puede ir de una manera m√°s ingeniosa, especialmente si usa malware basado en binarios.  Puede empaquetarlo en un archivo, usar un encriptador o incluso la ejecuci√≥n en memoria, es decir, la descarga sin archivos y la ejecuci√≥n de virus en la RAM. <br><br>  Hace unos a√±os, estas tecnolog√≠as se discutieron en la conferencia BlackHat y se concluy√≥ que incluso si un usuario de Mac instal√≥ un software antivirus de terceros en el sistema, todav√≠a no era capaz de detectar malware reprogramado.  Estas son malas noticias para los usuarios de macOS, ya que sabemos que los hackers experimentados usan malware convertido.  A menudo, toda la alteraci√≥n se reduce a cambiar algunos bytes de c√≥digo o argumentos de l√≠nea de comando, y esto hace posible tomar el control de una computadora para usarla para sus propios fines.  Adem√°s, la mayor√≠a de las herramientas antivirus integradas de macOS y el software antivirus de terceros no pueden detectar amenazas convertidas. <br><br>  Dado que este software reutilizado es solo un spyware original ligeramente conocido y rehecho, me pondr√© un "sombrero blanco" y le dir√© c√≥mo a√∫n puede encontrarlos. <br><br><h3>  Detecci√≥n de software de reconfiguraci√≥n </h3><br>  Es bien sabido que el software antivirus basado en firmas no hace frente al malware convertido.  Por lo tanto, debemos prestar atenci√≥n al comportamiento inusual, anormal y malicioso de dicho malware. <br><br>  Debemos intentar detectarlo, no gracias a la conocida firma de virus, sino observando sus acciones en el sistema.  Nos aseguramos de que cuando rehaces un spyware conocido, sus funciones b√°sicas y su prop√≥sito no cambien. <br><br>  Si rehacemos el troyano Ransomware ransomware, a√∫n cifrar√° sus archivos, y la puerta trasera redise√±ada continuar√° recolectando archivos y envi√°ndolos al servidor esp√≠a. <br>  En la diapositiva anterior, mostr√© las funciones o capacidades del sistema, que deber√≠an ser monitoreadas y monitoreadas por su actividad.  Estos incluyen la "persistencia" de aplicaciones, actividad inusual de micr√≥fono o c√°mara, descarga o transferencia de archivos, captura de pantalla no autorizada, s√≠ntomas de interceptaci√≥n de teclado, clickers sint√©ticos y cifrado de archivos.  Esto detectar√° incluso malware reutilizado. <br><br>  Hablemos de perseverancia.  Cuando digo "perseverancia", quiero decir que tan pronto como el spyware est√© instalado en la computadora, se iniciar√° autom√°ticamente cada vez que reinicie el sistema.  Esta es una caracter√≠stica de cualquier malware para macOS o Windows: esforzarse por lograr un objetivo malicioso. <br><br>  Simplemente podemos controlar el sistema de archivos observando el comportamiento de la aplicaci√≥n "persistente", y si algo cambia en √©l, notifique al usuario o al administrador del sistema. <br><br>  Ahora quiero demostrar c√≥mo puede detectar la actividad del virus Windtall original o remodelado, que se manifiesta en el acceso no autorizado a un micr√≥fono o c√°mara web Mac. <br><br><img src="https://habrastorage.org/webt/9g/lg/rb/9glgrbybold1rwxqx_xhklasvn4.jpeg"><br><br>  Muchos programas maliciosos de Mac acceden a una c√°mara web o un micr√≥fono para espiar a un usuario de un sistema infectado.  Para detectar esta actividad de virus, podemos registrar cada vez que se enciende la c√°mara y el micr√≥fono en el sistema macOS para que el usuario reciba autom√°ticamente una notificaci√≥n sobre este evento.        ,    FruitFly,   ,  Zoom,           . <br><br>    .       ,         . <br><br><img src="https://habrastorage.org/webt/l8/1s/p3/l81sp3q6f1-3x6pjtwr6z0cehpk.jpeg"><br><br>        macOS ‚Äì      Event Taps.            ,      .        . <br><br>     FruitFly,      ,           ,        ‚Äì ¬´¬ª . <br><br><img src="https://habrastorage.org/webt/bi/ce/d4/biced48qutbyjlpsfiywsgwvk0m.jpeg"><br><br>     ,       macOS,    .          .       ,  macOS  ,      .     ,     . <br><br>        Objective-See,    -  macOS.       ,              .      ,     ,        . <br><br><img src="https://habrastorage.org/webt/fg/lz/ea/fglzeamo6vlyrjgnj1sa6hp5vvw.jpeg"><br><br>     ,     ‚Äì    ,     ,        ¬´  ¬ª. <br><br><img src="https://habrastorage.org/webt/bk/c6/po/bkc6poi2uugp2kmcff2q77h0v98.jpeg"><br><br> ,      Digita Security,        .      :           .               Apple,        ,             . <br><br>        ,     .    ,  ,         ,       ,    macOS. <br><br>   ,          . ,    Windtall,   ,  Safari ,     . <br><br><img src="https://habrastorage.org/webt/ek/iq/wo/ekiqwo4mwk-hqxnyijkrxd9n3l4.jpeg"><br><br>     ,      URL     ,     -    URL.            Windtall,       ,      . <br><br>    FruitFly        ,      ,     -   . ,  ,    ,   Apple,      -  . <br><br>  ,  FruitFly      ,            .      ,     .                template       . ,       . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo tanto, si se producen varios eventos sospechosos conectados entre s√≠ en el sistema, debemos observarlos de cerca. </font><font style="vertical-align: inherit;">En los ejemplos anteriores, demostr√© c√≥mo la heur√≠stica del comportamiento puede detectar incluso amenazas de seguridad macOS complejas y reutilizadas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antes de concluir, quiero anunciar la Conferencia anual de seguridad de Mac en febrero de 2020 en Hawai e invitarlos a asistir.</font></font><br><br><img src="https://habrastorage.org/webt/bv/ix/tg/bvixtgp1tqcst1xbg6jbdvrlq4k.jpeg"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/InL3YA_6P6s" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Un poco de publicidad :) </h3><br>  Gracias por quedarte con nosotros.  ¬øTe gustan nuestros art√≠culos?  ¬øQuieres ver m√°s materiales interesantes?  Ap√≥yenos haciendo un pedido o recomendando a sus amigos, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">VPS en la nube para desarrolladores desde $ 4.99</a> , un <b>descuento del 30% para usuarios de Habr en un an√°logo √∫nico de servidores de nivel b√°sico que inventamos para usted:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">toda la verdad sobre VPS (KVM) E5-2650 v4 (6 N√∫cleos) 10GB DDR4 240GB SSD 1Gbps desde $ 20 o ¬øc√≥mo compartir un servidor?</a>  (las opciones est√°n disponibles con RAID1 y RAID10, hasta 24 n√∫cleos y hasta 40GB DDR4). <br><br>  <b>Dell R730xd 2 veces m√°s barato?</b>  ¬°Solo tenemos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV desde $ 199</a> en los Pa√≠ses Bajos!</b>  <b><b>Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - ¬°desde $ 99!</b></b>  Lea sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo construir un edificio de infraestructura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">clase utilizando servidores Dell R730xd E5-2650 v4 que cuestan 9,000 euros por un centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/474590/">https://habr.com/ru/post/474590/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../474576/index.html">Visi√≥n sonora VOZ Visi√≥n. Mira desde la oscuridad</a></li>
<li><a href="../474578/index.html">¬øPor qu√© el servicio de marketing por correo electr√≥nico realmente combate el spam y c√≥mo funciona?</a></li>
<li><a href="../474580/index.html">Hacer que la aplicaci√≥n sea accesible utilizando la Biblioteca de pruebas de disponibilidad de ax</a></li>
<li><a href="../474584/index.html">Instale Kali Linux con una interfaz gr√°fica en un servidor virtual</a></li>
<li><a href="../474588/index.html">Los 9 mejores hallazgos de c√≥digo abierto para octubre de 2019</a></li>
<li><a href="../474592/index.html">C√≥mo trabajar fuera de la oficina y no volverse loco</a></li>
<li><a href="../474594/index.html">C√≥mo dividir un negocio entre fundadores: la opini√≥n de un abogado</a></li>
<li><a href="../474596/index.html">Aplicaci√≥n en TSD y comunicaci√≥n con 1C: Enterprise 8.3 a trav√©s del servicio HTTP. Parte 5 (Men√∫, objeto complementario)</a></li>
<li><a href="../474598/index.html">C√≥mo obtener una entrevista con un ingeniero de control de calidad sin experiencia laboral</a></li>
<li><a href="../474602/index.html">Resolver la ecuaci√≥n de regresi√≥n lineal simple.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>