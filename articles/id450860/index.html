<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóæ ‚õàÔ∏è üë®üèΩ‚ÄçüöÄ Smart socket REDMOND SkyPort 100S üê† üî≠ üõÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ini adalah kelanjutan dari artikel pertama saya tentang Redmond Smart Cap . Pada artikel ini, kita akan berbicara tentang perangkat Redmond lain - Sma...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Smart socket REDMOND SkyPort 100S</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450860/"><p>  Ini adalah kelanjutan dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel pertama saya tentang Redmond Smart Cap</a> .  Pada artikel ini, kita akan berbicara tentang perangkat Redmond lain - Smart socket REDMOND SkyPort 100S.  Perangkat ini juga didasarkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pada chip nRF51822,</a> dan seperti yang mereka katakan di sini, Tuhan sendiri memerintahkan untuk mencoba.  Jadi, soket ini dibeli.  Kasing dibongkar semudah pangkalan, akses ke port pemrograman bahkan lebih nyaman. <a name="habracut"></a>  Tetapi melihat ke depan, saya akan mengatakan bahwa semuanya sedikit lebih rumit daripada yang tampak pada saya pada awalnya.  Saya tidak membunyikan rangkaian outlet ini, karena  Sudah ada banyak <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ulasan tentang peningkatan</a> dan modifikasi outlet ini. </p><br><img src="https://habrastorage.org/webt/lz/us/-9/lzus-9vti8hlegui-1vdbl6gkp0.jpeg"><br><p> Dalam salah satu ulasan saya menemukan sebuah sirkuit, dan ini terbatas.  Dari diagram jelas bahwa hanya 4 pin pada modul nRF51822 yang terlibat dengan cara yang sama seperti pada smart base.  Perangkat ini memiliki tombol jam yang terhubung ke pin p0.00, dua LED, merah terhubung ke pin p0.01, hijau terhubung ke pin p0.02.  Relai elektromagnetik pada 10A terhubung ke pin p0.03.  Jadi, mulai Arduino IDE dan mulailah melempar instance: </p><br><pre><code class="plaintext hljs">#define BUTTON_PIN 0 #define RED_LED_PIN 1 #define GREEN_LED_PIN 2 #define RELAY_PIN 3 boolean iswitch = 0; boolean flag_button = 0; static uint32_t previousMillis; //#define MY_DEBUG #define MY_DISABLED_SERIAL #define MY_RADIO_NRF5_ESB //#define MY_NRF5_ESB_PA_LEVEL (NRF5_PA_LOW) #define MY_NRF5_ESB_PA_LEVEL (NRF5_PA_MAX) //#define MY_PASSIVE_NODE #define MY_NODE_ID 201 #define MY_PARENT_NODE_ID 0 #define MY_PARENT_NODE_IS_STATIC #define MY_TRANSPORT_UPLINK_CHECK_DISABLED #define RELAY_ID 1 #include &lt;MySensors.h&gt; MyMessage lMsg(RELAY_ID, V_STATUS); void preHwInit() { pinMode(BUTTON_PIN, INPUT_PULLUP); pinMode(RED_LED_PIN, OUTPUT); pinMode(GREEN_LED_PIN, OUTPUT); pinMode(RELAY_PIN, OUTPUT); } void before() { digitalWrite(RED_LED_PIN, HIGH); } void presentation() { sendSketchInfo("REDMOND R nRF51", "1.0"); wait(300); present(RELAY_ID, S_BINARY, "RELAY SWITCH"); wait(300); } void setup() { digitalWrite(RED_LED_PIN, LOW); wait(300); digitalWrite(GREEN_LED_PIN, HIGH); wait(200); digitalWrite(GREEN_LED_PIN, LOW); wait(200); digitalWrite(GREEN_LED_PIN, HIGH); wait(200); digitalWrite(GREEN_LED_PIN, LOW); wait(200); digitalWrite(GREEN_LED_PIN, HIGH); wait(200); digitalWrite(GREEN_LED_PIN, LOW); wait(500); send(lMsg.set(iswitch)); wait(500); } void loop() { if (digitalRead(BUTTON_PIN) == LOW &amp;&amp; flag_button == 0) { flag_button = 1; previousMillis = millis(); wait(20); } if (digitalRead(BUTTON_PIN) == LOW &amp;&amp; flag_button == 1) { //   ,   } if (digitalRead(BUTTON_PIN) == HIGH &amp;&amp; flag_button == 1) { if ((millis() - previousMillis &gt; 0) &amp;&amp; (millis() - previousMillis &lt;= 3000)) { if (iswitch == 0) { digitalWrite(GREEN_LED_PIN, HIGH); wait(10); } else if (iswitch == 1) { digitalWrite(GREEN_LED_PIN, LOW); wait(10); } flag_button = 0; iswitch = !iswitch; digitalWrite(RELAY_PIN, iswitch); wait(1500); send(lMsg.set(iswitch)); } if (millis() - previousMillis &gt; 3000) { flag_button = 0; } } } void receive(const MyMessage &amp; message) { if (message.type == V_STATUS) { if (message.sensor == RELAY_ID) { if (mGetCommand(message) == 1) { if (message.isAck()) { //AckG = 1; } else { wait(50); if (iswitch == 0) { digitalWrite(GREEN_LED_PIN, HIGH); }else if (iswitch == 1) { digitalWrite(GREEN_LED_PIN, LOW); } iswitch = !iswitch; wait(10); digitalWrite(RELAY_PIN, iswitch); wait(1500); send(lMsg.set(iswitch)); } } if (mGetCommand(message) == 2) { } } } }</code> </pre> <br><p>  Seperti yang Anda lihat, kode ini kecil dan cukup sederhana, terima kasih untuk itu kepada komunitas Mysensors. </p><br><p>  Ketika kode selesai, saya menghubungkan programmer ke perangkat dan mem-flashnya.  Menghubungkan programmer ke outlet sangat sederhana, dalam kasus saya, saya mengambil dua resistor output biasa, menggigit kawat dengan pemotong kawat, membuat kait dari kawat, membengkokkannya, memasukkan kait ini ke kabel programmer dan "terhubung" ke outlet, video menunjukkan bagaimana saya melakukannya Sudah waktunya untuk menguji apa yang terjadi.  Saya memasukkan smart outlet ke outlet :), membuka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Majordomo</a> , semuanya baik-baik saja, outlet sudah ada di jaringan Maysensors.  Saya mengirim perintah pertama untuk menghidupkan dan ... reboot :) ... giliran tak terduga.  Hal pertama yang terlintas dalam pikiran adalah power drawdown saat relay menyala.  Dia mengubah program, menghapus masuknya LED ketika relay dihidupkan, untuk mengurangi konsumsi.  Dan itu berhasil, soket berhenti me-reboot ketika relay dimatikan ... Tapi tidak lama :).  Dan menjadi jelas bahwa modul tersebut tidak memiliki daya.  Rangkaian catu daya transformer dirancang agar cukup hanya untuk bekerja dalam mode BLE.  Mysensor juga menggunakan mode berbeda dari modul radio 2,4 GHz (kompatibilitas dengan RF24 - ANT).  Jadi kami memiliki defisit sekitar 10mA.  Setelah membahas masalah ini dalam obrolan kami, para Mysensor memutuskan untuk menambahkan kapasitor ballast, karena ini adalah manipulasi yang sangat sederhana, apa yang perlu Anda ulangi.  Inilah yang terjadi: </p><br><p><img src="https://habrastorage.org/webt/1h/ds/ik/1hdsikihai95br_gfrun-35avrg.jpeg" alt="gambar"></p><br><p><img src="https://habrastorage.org/webt/9x/ut/qs/9xutqseeqejkhxeuoaxebutcxg0.jpeg" alt="gambar"></p><br><p>  Sambil memasang kembali stopkontak, ia mulai menguji dengan sedikit bersemangat.  Perkembangannya sekarang luar biasa.  Saya menulis ulang logika program kembali, menambahkan #define MY_NRF5_ESB_PA_LEVEL (NRF5_PA_MAX) lain, yaitu, saya "memotong" radio dengan kekuatan penuh (ya, sangat sederhana dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mysensors</a> ) ... Ini berfungsi.  Tidak ada kesalahan  Tidak ada reboot.  Ini kemenangan :) </p><br><p><img src="https://habrastorage.org/webt/gc/ae/gg/gcaeggbdts0omxqeiva8u7giuka.jpeg" alt="gambar"></p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/C5W_3nAF-2A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Tetapi pabrikan ini juga memiliki perangkat lain pada nRF51822 - sensor asap, sensor gerak, sensor gas, konverter termal, kipas, pelembap, pembersih, ketel ...;) </p><br><p>  Obrolan telegram komunitas kami, tempat mereka akan selalu membantu memasang perpustakaan, mendukung papan, menjelaskan bagaimana dalam setengah jam untuk merakit jaringan sensor pada arduins tanpa sakit kepala - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://t.me/mysensors_rus</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id450860/">https://habr.com/ru/post/id450860/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id450846/index.html">Keajaiban kemasan dari Microsoft: kernel Linux di Windows 10 dan mesin IE di dalam Chromium Edge</a></li>
<li><a href="../id450848/index.html">Tentang fosfor kuning dan sifat panik manusia</a></li>
<li><a href="../id450850/index.html">Menuju masa depan yang lebih cerah untuk kompiler pintar</a></li>
<li><a href="../id450854/index.html">Pengalaman dalam mengembangkan aset Persatuan untuk menemukan jalur di ruang 3D</a></li>
<li><a href="../id450858/index.html">Pertemuan Open Source Networking - sekarang di Yandex.Cloud # 3.2019</a></li>
<li><a href="../id450862/index.html">@Pythonetc April 2019</a></li>
<li><a href="../id450864/index.html">Kiat dan trik dari saluran Telegram saya @pythonetc, April 2019</a></li>
<li><a href="../id450868/index.html">Laporan video dari pertemuan otomasi FunTech QA</a></li>
<li><a href="../id450870/index.html">Bagaimana Netflix Menggunakan Python</a></li>
<li><a href="../id450872/index.html">Panduan Anotasi TestNG untuk Selenium WebDriver</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>