<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📠 🏂🏼 👤 الرموز والوحدات الاصطناعية (WinDbg / DbgEng) 🗑️ 🐛 👧🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="سوف يركز هذا المنشور على الوحدات النمطية الاصطناعية ورموز محرك تصحيح الأخطاء لـ Windows (مشغل مصحح الأخطاء). بمعنى ، حول الكيانات التي يمكن إضافتها بش...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>الرموز والوحدات الاصطناعية (WinDbg / DbgEng)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436644/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  سوف يركز هذا المنشور على الوحدات النمطية الاصطناعية ورموز محرك تصحيح الأخطاء لـ Windows (مشغل مصحح الأخطاء).  بمعنى ، حول الكيانات التي يمكن إضافتها بشكل مصطنع إلى مصحح الأخطاء <em>لتلوين</em> عناوين الذاكرة. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/it/zq/x2/itzqx23xm_48b5cu4ues9blvojk.png"></p><a name="habracut"></a><br><h2 id="sinteticheskie-moduli" style=";text-align:right;direction:rtl">  وحدات الاصطناعية </h2><br><p style=";text-align:right;direction:rtl">  بشكل عام ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الوحدة النمطية</a> كجزء من مشغل مصحح الأخطاء هي منطقة معينة متصلة من الذاكرة الظاهرية: العنوان الأساسي للوحدة النمطية (عنوان البايت الأول من الملف المسقط) وحجمها.  لكل نوع من أنواع تصحيح الأخطاء (تحليل الأخطاء / التفريغ المباشر ، وضع المستخدم / وضع kernel ، وما إلى ذلك) ، لدى المصحح آليته الخاصة لقراءة وتحديث قائمة الوحدات النمطية المحملة.  أسهل طريقة لفرض قائمة الوحدات النمطية المحملة التي يتم تحديثها هي <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">أمر .reload مع الخيار / s</a> . </p><br><p style=";text-align:right;direction:rtl"> إذا تحدثنا ، على سبيل المثال ، عن التصحيح المباشر لعملية وضع المستخدم ، يتم بناء قائمة الوحدات النمطية المحمّلة وفقًا <a href="">لثلاثة قوائم رئيسية من المُحمل</a> : قائمة بترتيب تحميل الوحدة النمطية (InLoadOrderModuleList) ، وقائمة بالوحدات النمطية في الذاكرة (InMemoryOrderModuleList) وقائمة أولويات التهيئة.  من ناحية ، لا شيء ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تقريبا</a> ) يمنعنا من أخذ بيانات تعسفية (من ملف <abbr title="قابل للتنفيذ المحمولة">PE</abbr> على القرص ، على سبيل المثال) ووضع علامة عليها في الذاكرة للتنفيذ بأيدينا.  من ناحية أخرى ، منذ فترة طويلة تقنيات إزالة <abbr title="مكتبة الارتباط الديناميكي">DLL</abbr> محملة بالوسائل العادية من قوائم محمل الثلاثة المذكورة أعلاه (إخفاء الوحدة النمطية) معروفة. </p><br><p style=";text-align:right;direction:rtl">  في كلتا الحالتين ، عند تصحيح هذا الموقف ، سيكون من المفيد وضع علامة على مساحة الوحدة النمطية المخفية.  لهذا ، وحدات الاصطناعية هي مناسبة.  كتجربة عملية ، يمكنك ببساطة جعل WinDbg يسقط الوحدة المحملة من قائمته الداخلية بنفس الأمر <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">.reload ، ولكن مع خيار / u</a> . </p><br><p style=";text-align:right;direction:rtl">  علاوة على ذلك ، في جودة القوائم المدرجة ، سأستخدم التصحيح المعتاد لعملية وضع المستخدم (notepad.exe).  أولاً ، تذكر العنوان الأساسي لوحدة ntdll (0x07ffa8a160000) وحساب حجمها (0x01e1000): </p><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">0:007&gt; lm m ntdll Browse full module list start end module name 00007ffa`8a160000 00007ffa`8a341000 ntdll 0:007&gt; ? 00007ffa`8a341000-00007ffa`8a160000 Evaluate expression: 1970176 = 00000000`001e1000</code> </pre> <br><p style=";text-align:right;direction:rtl">  ضع في اعتبارك <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">قائمة</a> بوظيفة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RtlFreeSid</a> البسيطة من الوحدة النمطية ntdll ، والتي تستدعي وظيفة RtlFreeHeap من هذه الوحدة ، مع تذكر عناوين الأحرف RtlFreeSid و RtlFreeHeap (0x7ffa8a1cbc20 و 0x7ffa8a176df0) في نفس الوقت: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; uf ntdll!RtlFreeSid ntdll!RtlFreeSid: 00007ffa`8a1cbc20 4053 push rbx 00007ffa`8a1cbc22 4883ec20 sub rsp,20h 00007ffa`8a1cbc26 488bd9 mov rbx,rcx 00007ffa`8a1cbc29 33d2 xor edx,edx 00007ffa`8a1cbc2b 65488b0c2560000000 mov rcx,qword ptr gs:[60h] 00007ffa`8a1cbc34 4c8bc3 mov r8,rbx 00007ffa`8a1cbc37 488b4930 mov rcx,qword ptr [rcx+30h] 00007ffa`8a1cbc3b e8b0b1faff call ntdll!RtlFreeHeap (00007ffa`8a176df0) 00007ffa`8a1cbc40 33c9 xor ecx,ecx 00007ffa`8a1cbc42 85c0 test eax,eax 00007ffa`8a1cbc44 480f45d9 cmovne rbx,rcx 00007ffa`8a1cbc48 488bc3 mov rax,rbx 00007ffa`8a1cbc4b 4883c420 add rsp,20h 00007ffa`8a1cbc4f 5b pop rbx 00007ffa`8a1cbc50 c3 ret</code> </pre> <br><p style=";text-align:right;direction:rtl">  أيضًا ، وفقًا لقائمة البيانات ، من السهل حساب حجم الدالة ntdll! RtlFreeSid: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; ? 00007ffa`8a1cbc51 - 0x07ffa8a1cbc20 Evaluate expression: 49 = 00000000`00000031</code> </pre> <br><p style=";text-align:right;direction:rtl">  وحجم ntdll! وظيفة RtlFreeHeap ليست مهمة لتجربتنا ، لذلك من أجل البساطة يمكنك أن تأخذها على قدم المساواة مع بايت واحد. </p><br><p style=";text-align:right;direction:rtl">  الآن محاكاة إخفاء وحدة ntdll: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; .reload /u ntdll Unloaded ntdll</code> </pre> <br><p style=";text-align:right;direction:rtl">  حقل هذا العمل بعنوان ntdll! RtlFreeSid في مصحح الأخطاء ليس غني بالمعلومات (ويمكنك بالفعل الوصول إلى بداية الدالة فقط بواسطة العنوان الظاهري): </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; uf 00007ffa`8a1cbc20 00007ffa`8a1cbc20 4053 push rbx 00007ffa`8a1cbc22 4883ec20 sub rsp,20h 00007ffa`8a1cbc26 488bd9 mov rbx,rcx 00007ffa`8a1cbc29 33d2 xor edx,edx 00007ffa`8a1cbc2b 65488b0c2560000000 mov rcx,qword ptr gs:[60h] 00007ffa`8a1cbc34 4c8bc3 mov r8,rbx 00007ffa`8a1cbc37 488b4930 mov rcx,qword ptr [rcx+30h] 00007ffa`8a1cbc3b e8b0b1faff call 00007ffa`8a176df0 00007ffa`8a1cbc40 33c9 xor ecx,ecx 00007ffa`8a1cbc42 85c0 test eax,eax 00007ffa`8a1cbc44 480f45d9 cmovne rbx,rcx 00007ffa`8a1cbc48 488bc3 mov rax,rbx 00007ffa`8a1cbc4b 4883c420 add rsp,20h 00007ffa`8a1cbc4f 5b pop rbx 00007ffa`8a1cbc50 c3 ret</code> </pre> <br><p style=";text-align:right;direction:rtl">  لإضافة وحدة تركيبية ، تحتاج إلى استدعاء واجهة البرنامج <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">IDebugSymbols3 :: AddSyntheticModule</a> . <del>  لا توجد ببساطة أوامر مدمجة لإجراء هذه المكالمة (حسب علمي). </del>  اقترح <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Mikhail I. Izmestev</a> أن هناك آلية مماثلة - نفس <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">التحميل</a> . ولكن مع الاسم والعنوان ومعلمات الحجم: "الوحدة النمطية = العنوان والحجم" (وربما يتم تنفيذها على وحدات تركيبية). </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">.reload ntdll = 00007ff8`470e1000،001e1000</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; .reload ntdll=00007ff8`470e1000,001e1000 *** WARNING: Unable to verify timestamp for ntdll *** ERROR: Module load completed but symbols could not be loaded for ntdll 0:007&gt; uf 00007ff8`4714bc20 ntdll+0x6ac20: 00007ff8`4714bc20 4053 push rbx 00007ff8`4714bc22 4883ec20 sub rsp,20h 00007ff8`4714bc26 488bd9 mov rbx,rcx 00007ff8`4714bc29 33d2 xor edx,edx 00007ff8`4714bc2b 65488b0c2560000000 mov rcx,qword ptr gs:[60h] 00007ff8`4714bc34 4c8bc3 mov r8,rbx 00007ff8`4714bc37 488b4930 mov rcx,qword ptr [rcx+30h] 00007ff8`4714bc3b e8b0b1faff call ntdll+0x15df0 (00007ff8`470f6df0) 00007ff8`4714bc40 33c9 xor ecx,ecx 00007ff8`4714bc42 85c0 test eax,eax 00007ff8`4714bc44 480f45d9 cmovne rbx,rcx 00007ff8`4714bc48 488bc3 mov rax,rbx 00007ff8`4714bc4b 4883c420 add rsp,20h 00007ff8`4714bc4f 5b pop rbx 00007ff8`4714bc50 c3 ret</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  حسنًا ، سوف نستخدم ملحق مصحح الأخطاء ، وهنا <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">pykd</a> سيأتي إلى <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الإنقاذ</a> <img src="https://habrastorage.org/webt/kz/-m/2t/kz-m2tie3aamd7obq0j1pmczjn8.png">  .  في الإصدار الأخير (في وقت الكتابة) <a href="">0.3.4.3</a> ، تمت إضافة وظائف لإدارة الوحدات الاصطناعية: <strong>addSyntheticModule</strong> (...) (وهو أمر ضروري في حالتنا) و <strong>removeSyntheticModule</strong> (...). </p><br><p style=";text-align:right;direction:rtl">  باستخدام العنوان الأساسي وحجم الوحدة النمطية التي تم حفظها مسبقًا ، نضيف معلومات حول وحدة ntdll <em>المخفية</em> إلى مصحح الأخطاء (في حالة حدوث خطأ ، سيتم طرح استثناء ، لذلك يعد التنفيذ الصامت علامة على النجاح ، ويمكن تجاهل تحذيرات الطباعة): </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; !py Python 2.7.15 (v2.7.15:ca079a3ea3, Apr 30 2018, 16:30:26) [MSC v.1500 64 bit (AMD64)] on win32 Type "help", "copyright", "credits" or "license" for more information. (InteractiveConsole) &gt;&gt;&gt; addSyntheticModule(0x07ffa8a160000, 0x01e1000, 'ntdll') *** WARNING: Unable to verify timestamp for ntdll &gt;&gt;&gt; exit()</code> </pre> <br><p style=";text-align:right;direction:rtl">  الآن أصبحت قائمة المفكك أكثر إفادة: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; uf 00007ffa`8a1cbc20 ntdll+0x6bc20: 00007ffa`8a1cbc20 4053 push rbx 00007ffa`8a1cbc22 4883ec20 sub rsp,20h 00007ffa`8a1cbc26 488bd9 mov rbx,rcx 00007ffa`8a1cbc29 33d2 xor edx,edx 00007ffa`8a1cbc2b 65488b0c2560000000 mov rcx,qword ptr gs:[60h] 00007ffa`8a1cbc34 4c8bc3 mov r8,rbx 00007ffa`8a1cbc37 488b4930 mov rcx,qword ptr [rcx+30h] 00007ffa`8a1cbc3b e8b0b1faff call ntdll+0x16df0 (00007ffa`8a176df0) 00007ffa`8a1cbc40 33c9 xor ecx,ecx 00007ffa`8a1cbc42 85c0 test eax,eax 00007ffa`8a1cbc44 480f45d9 cmovne rbx,rcx 00007ffa`8a1cbc48 488bc3 mov rax,rbx 00007ffa`8a1cbc4b 4883c420 add rsp,20h 00007ffa`8a1cbc4f 5b pop rbx 00007ffa`8a1cbc50 c3 ret</code> </pre> <br><p style=";text-align:right;direction:rtl">  بتعبير أدق ، نرى أن الوظيفة داخل الوحدة النمطية ntdll تستدعي وظيفة أخرى داخل الوحدة النمطية نفسها. </p><br><h2 id="sinteticheskie-simvoly" style=";text-align:right;direction:rtl">  الرموز الاصطناعية </h2><br><p style=";text-align:right;direction:rtl">  أصبحت القائمة ، بعد إضافة وحدة تركيبية ، أكثر إفادة ، ولكنها لا تزال غير بليغة مثل الأصل الأصلي.  يفتقر إلى <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الأحرف</a> (في حالتنا ، أسماء الدالتين RtlFreeSid و RtlFreeHeap).  لإصلاح ذلك ، يلزم إجراء مكالمة مرة أخرى ، ولكن من أجل واجهة برنامج مختلفة - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">IDebugSymbols3 :: AddSyntheticSymbol</a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Pykd</a> مرة أخرى <img src="https://habrastorage.org/webt/kz/-m/2t/kz-m2tie3aamd7obq0j1pmczjn8.png">  على استعداد لمساعدتنا في هذا: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; !py Python 2.7.15 (v2.7.15:ca079a3ea3, Apr 30 2018, 16:30:26) [MSC v.1500 64 bit (AMD64)] on win32 Type "help", "copyright", "credits" or "license" for more information. (InteractiveConsole) &gt;&gt;&gt; addSyntheticSymbol(0x07ffa8a1cbc20, 0x31, 'RtlFreeSid') &lt;pykd.syntheticSymbol object at 0x0000014D47699518&gt; &gt;&gt;&gt; addSyntheticSymbol(0x07ffa8a176df0, 1, 'RtlFreeHeap') &lt;pykd.syntheticSymbol object at 0x0000014D476994A8&gt; &gt;&gt;&gt; exit()</code> </pre> <br><p style=";text-align:right;direction:rtl">  تشبه النتيجة إلى حد كبير النتيجة عند استخدام الرموز من ملف pdb ntdll: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; uf 00007ffa`8a1cbc20 ntdll!RtlFreeSid: 00007ffa`8a1cbc20 4053 push rbx 00007ffa`8a1cbc22 4883ec20 sub rsp,20h 00007ffa`8a1cbc26 488bd9 mov rbx,rcx 00007ffa`8a1cbc29 33d2 xor edx,edx 00007ffa`8a1cbc2b 65488b0c2560000000 mov rcx,qword ptr gs:[60h] 00007ffa`8a1cbc34 4c8bc3 mov r8,rbx 00007ffa`8a1cbc37 488b4930 mov rcx,qword ptr [rcx+30h] 00007ffa`8a1cbc3b e8b0b1faff call ntdll!RtlFreeHeap (00007ffa`8a176df0) 00007ffa`8a1cbc40 33c9 xor ecx,ecx 00007ffa`8a1cbc42 85c0 test eax,eax 00007ffa`8a1cbc44 480f45d9 cmovne rbx,rcx 00007ffa`8a1cbc48 488bc3 mov rax,rbx 00007ffa`8a1cbc4b 4883c420 add rsp,20h 00007ffa`8a1cbc4f 5b pop rbx 00007ffa`8a1cbc50 c3 ret</code> </pre> <br><h2 id="osobennosti-sinteticheskih-suschnostey" style=";text-align:right;direction:rtl">  ملامح الكيانات الاصطناعية </h2><br><p style=";text-align:right;direction:rtl">  تجدر الإشارة إلى أن إنشاء الرموز الاصطناعية مسموح به في أي وحدات موجودة ، وليس فقط في تلك الاصطناعية.  وهذا يعني أنه يمكنك إضافة رموز إلى الوحدات النمطية التي <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">بها ملفات pdb يمكن الوصول إليها</a> ، وإلى الوحدات النمطية التي ليس لدينا ملفات بها معلومات تصحيح الأخطاء.  ولكن لا يمكنك إنشاء أحرف خارج الوحدات النمطية.  وهذا يعني أنه من أجل تحديد عنوان ذاكرة تعسفي خارج حدود الوحدات النمطية الحالية ، يجب أولاً إنشاء وحدة تركيبية مغلفة ، ثم (إذا لزم الأمر ، لأن اسم الوحدة قد يكون كافيًا جدًا <em>للتلوين</em> ) ، قم بإنشاء رمز اصطناعي فيه. </p><br><p style=";text-align:right;direction:rtl">  تجدر الإشارة أيضًا إلى أنه يمكن إزالة الوحدات والرموز الاصطناعية بحركة <em>غير مبهمة</em> لليد: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  إعادة تحميل رموز تصحيح الوحدة النمطية يحذف كافة الرموز الاصطناعية لهذه الوحدة النمطية ؛ </li><li style=";text-align:right;direction:rtl">  إعادة تحميل جميع الوحدات سوف يزيل جميع الوحدات الاصطناعية. </li></ul><br><h2 id="synextshttpsgithubcomkiteresynexts" style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">النصوص</a> </h2><br><p style=";text-align:right;direction:rtl">  على الرغم من أن استخدام <strong>pykd</strong> مناسب في الغالبية العظمى من الحالات (خاصة بالنظر إلى وجود <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">bootstarpper</a> لها) ، في بعض الأحيان يمكنك الدخول في موقف حيث سيكون عليك بذل جهد كبير لاستخدام pykd.  على سبيل المثال ، كنت بحاجة إلى تصحيح الأخطاء من جهاز host'ovy الذي يعمل عليه نظام Windows XP.  كما اتضح فيما بعد ، لم يدعم pykd نظام التشغيل XP لبعض الوقت ، وكنت بحاجة إلى أحرف ووحدات تركيبية.  يبدو لي أنه بالنسبة لهذه المهمة ، من السهل تجميع ملحق صغير منفصل سيؤدي إلى حل نطاق ضيق من المهام الضرورية بدلاً من استعادة دعم XP الكامل ل pykd.  نتيجة لذلك ، تم إنشاء مشروع منفصل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">!</a> </p><br><p style=";text-align:right;direction:rtl">  هذا امتداد بسيط يحتوي على تصديرين متاحين للمستخدم: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ! synexts.addsymbol - ينشئ رمزًا اصطناعيًا في أي وحدة نمطية موجودة ؛ </li><li style=";text-align:right;direction:rtl">  ! synexts.addmodule - تنشئ وحدة تركيبية في القائمة الداخلية لمحرك تصحيح الأخطاء. </li></ul><br><p style=";text-align:right;direction:rtl">  للتوضيح ، نقوم بمحاكاة إخفاء وحدة ntdll مرة أخرى: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; .reload /u ntdll Unloaded ntdll 0:007&gt; uf 00007ffa`8a1cbc20 00007ffa`8a1cbc20 4053 push rbx 00007ffa`8a1cbc22 4883ec20 sub rsp,20h 00007ffa`8a1cbc26 488bd9 mov rbx,rcx 00007ffa`8a1cbc29 33d2 xor edx,edx 00007ffa`8a1cbc2b 65488b0c2560000000 mov rcx,qword ptr gs:[60h] 00007ffa`8a1cbc34 4c8bc3 mov r8,rbx 00007ffa`8a1cbc37 488b4930 mov rcx,qword ptr [rcx+30h] 00007ffa`8a1cbc3b e8b0b1faff call 00007ffa`8a176df0 00007ffa`8a1cbc40 33c9 xor ecx,ecx 00007ffa`8a1cbc42 85c0 test eax,eax 00007ffa`8a1cbc44 480f45d9 cmovne rbx,rcx 00007ffa`8a1cbc48 488bc3 mov rax,rbx 00007ffa`8a1cbc4b 4883c420 add rsp,20h 00007ffa`8a1cbc4f 5b pop rbx 00007ffa`8a1cbc50 c3 ret</code> </pre> <br><p style=";text-align:right;direction:rtl">  مرة أخرى ، نستعيد معرفة الوحدة والرموز في شكل كيانات اصطناعية ، ولكن باستخدام امتداد! Synexts بالفعل: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; !synexts.addmodule ntdll C:\Windows\System32\ntdll.dll 00007ffa`8a160000 0x01e1000 *** WARNING: Unable to verify timestamp for C:\Windows\System32\ntdll.dll Synthetic module successfully added 0:007&gt; !synexts.addsymbol RtlFreeSid 00007ffa`8a1cbc20 31 Synthetic symbol successfully added 0:007&gt; !synexts.addsymbol RtlFreeHeap 00007ffa`8a176df0 1 Synthetic symbol successfully added</code> </pre> <br><p style=";text-align:right;direction:rtl">  من المفترض أنك قمت بالفعل بنسخ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مكتبة synexts.dll المترجمة</a> (المطابقة لعمق البت المستخدم بواسطة WinDbg) إلى دليل winext الخاص بالمصحح: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; .chain Extension DLL search Path: C:\Program Files (x86)\Windows Kits\10\Debuggers\x64\WINXP;C:\Program Files (x86)\Windows Kits\10\Debuggers\x64\winext;C:\Program Files (x86)\Windows Kits\10\Debuggers\x64\winext\arcade;C:\Program Files (x86)\Windows Kits\10\Debuggers\x64\pri;C:\Program Files (x86)\Windows Kits\10\Debuggers\x64;&lt;…&gt; Extension DLL chain: pykd.pyd: image 0.3.4.3, API 1.0.0, built Thu Jan 10 19:56:25 2019 [path: C:\Program Files (x86)\Windows Kits\10\Debuggers\x64\winext\pykd.pyd] synexts: API 1.0.0, built Fri Jan 18 17:38:17 2019 [path: C:\Program Files (x86)\Windows Kits\10\Debuggers\x64\winext\synexts.dll] &lt;…&gt;</code> </pre> <br><p style=";text-align:right;direction:rtl">  ومرة أخرى نرى نتيجة إضافة أحرف تركيبية إلى الوحدة الاصطناعية: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0:007&gt; uf 00007ffa`8a1cbc20 ntdll!RtlFreeSid: 00007ffa`8a1cbc20 4053 push rbx 00007ffa`8a1cbc22 4883ec20 sub rsp,20h 00007ffa`8a1cbc26 488bd9 mov rbx,rcx 00007ffa`8a1cbc29 33d2 xor edx,edx 00007ffa`8a1cbc2b 65488b0c2560000000 mov rcx,qword ptr gs:[60h] 00007ffa`8a1cbc34 4c8bc3 mov r8,rbx 00007ffa`8a1cbc37 488b4930 mov rcx,qword ptr [rcx+30h] 00007ffa`8a1cbc3b e8b0b1faff call ntdll!RtlFreeHeap (00007ffa`8a176df0) 00007ffa`8a1cbc40 33c9 xor ecx,ecx 00007ffa`8a1cbc42 85c0 test eax,eax 00007ffa`8a1cbc44 480f45d9 cmovne rbx,rcx 00007ffa`8a1cbc48 488bc3 mov rax,rbx 00007ffa`8a1cbc4b 4883c420 add rsp,20h 00007ffa`8a1cbc4f 5b pop rbx 00007ffa`8a1cbc50 c3 ret</code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar436644/">https://habr.com/ru/post/ar436644/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar436634/index.html">فقط حول الإعدادات الداخلية والخارجية للتطبيق في Unity3D</a></li>
<li><a href="../ar436636/index.html">كيف أقوم بإنشاء خدمة توصية مجتمع VKontakte</a></li>
<li><a href="../ar436638/index.html">إعادة توزيع النوافذ بين الشاشات بعد الاستيقاظ من وضع السكون</a></li>
<li><a href="../ar436640/index.html">تجربتي في الإعلان وتطوير تطبيق Android و iOS</a></li>
<li><a href="../ar436642/index.html">تذكرة إلى Ride.Europe - خطوات متواضعة في حساب اللعبة</a></li>
<li><a href="../ar436646/index.html">شفافة على android و adjustResize</a></li>
<li><a href="../ar436648/index.html">الجمع بين المشاريع في مراكز البيانات المختلفة</a></li>
<li><a href="../ar436650/index.html">3 ربح استراتيجيات تسييل التطبيق في عام 2019</a></li>
<li><a href="../ar436652/index.html">MPS 2018.3: خطط التوليد والتحسينات في لغة التجميع والتعبئة ولغة المحرر ، واجهة محدثة</a></li>
<li><a href="../ar436654/index.html">تطوير فريق للاستعلام عن البيانات من قاعدة البيانات - الجزء 4 ، خاتمة</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>