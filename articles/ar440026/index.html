<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐จ๐ฝโ๐ผ ๐ค๐ป ูุงุฌู: ูุง ุฃุณุชุทูุน ุงููุดู - ููุง ุจูุง ๐ฆ ๐ โ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุง ูุฏู ุชุนููุฏ ููุถูุน ุงูุชุนูู ุงูุขููุ ุฅุฐุง ููุช ุฌูุฏูุง ูู ุงูุฑูุงุถูุงุช ุ ููู ููุฏุงุฑ ุงููุนุฑูุฉ ุจุงูุชุนูู ุงูุขูู ูููู ุฅูู ุงูุตูุฑ ุ ุฅูู ุฃู ูุฏู ููููู ุงูุฐูุงุจ ูู ููุงูุณุฉ ุฌุงุฏุฉ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุงุฌู: ูุง ุฃุณุชุทูุน ุงููุดู - ููุง ุจูุง</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/singularis/blog/440026/" style=";text-align:right;direction:rtl">  ูุง ูุฏู ุชุนููุฏ ููุถูุน ุงูุชุนูู ุงูุขููุ  ุฅุฐุง ููุช ุฌูุฏูุง ูู ุงูุฑูุงุถูุงุช ุ ููู ููุฏุงุฑ ุงููุนุฑูุฉ ุจุงูุชุนูู ุงูุขูู ูููู ุฅูู ุงูุตูุฑ ุ ุฅูู ุฃู ูุฏู ููููู ุงูุฐูุงุจ ูู ููุงูุณุฉ ุฌุงุฏุฉ ุนูู ููุตุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Kaggle</a> ุ <br><br><img src="https://habrastorage.org/webt/3y/zi/_f/3yzi_f6ybvxg_uq9392v4rqoml0.png"><br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ุนู ุงููููุน ูุงููุณุงุจูุฉ </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Kaggle</a> ูู ูุฌููุนุฉ ูู ุงูุฃุดุฎุงุต ุงูููุชููู ุจู ML (ูู ุงููุจุชุฏุฆูู ุฅูู ุงููุญุชุฑููู ุงูุจุงุฑุนูู) ูููุงููุง ูููุณุงุจูุงุช (ุบุงูุจูุง ูุน ูุฌููุนุฉ ุฌูุงุฆุฒ ุฑุงุฆุนุฉ). <br><br>  ููุงูุบูุงุณ ุนูู ุงูููุฑ ูู ูู ุณุญุฑ ML ุ ูุฑุฑุช ุงุฎุชูุงุฑ ููุงูุณุฉ ุฌุฏูุฉ ุนูู ุงูููุฑ.  ูุงู ูุฐุง ูุชุงุญูุง ููุชู: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงุซูุงู ูู ุณูุฌูุง: ุงุณุชุฎุฏุงู ุงูุฃุฎุจุงุฑ ููุชูุจุค ุจุญุฑูุงุช ุงูุฃุณูู</a> .  ูุชูุซู ุฌููุฑ ุงููุณุงุจูุฉ ุจุงุฎุชุตุงุฑ ูู ุงูุชูุจุค ุจุณุนุฑ ุฃุณูู ูุฎุชูู ุงูุดุฑูุงุช ุจูุงุกู ุนูู ุญุงูุฉ ุงูุฃุตู ูุงูุฃุฎุจุงุฑ ุงููุชุนููุฉ ุจูุฐุง ุงูุฃุตู.  ุชุจูุบ ูููุฉ ุฌุงุฆุฒุฉ ุงููุณุงุจูุฉ 100000 ุฏููุงุฑ ุ ูุณูุชู ุชูุฒูุนูุง ุนูู ุงููุดุงุฑููู ุงูุฐูู ูุงุฒูุง ุจุงููุฑุงูุฒ ุงูุณุจุนุฉ ุงูุฃููู. <br><br>  ุงููุณุงุจูุฉ ุฎุงุตุฉ ูุณุจุจูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฐู ูุณุงุจูุฉ Kernels ููุท: ููููู ุชุฏุฑูุจ ุงูููุฏููุงุช ููุท ูู ุณุญุงุจุฉ Kaggle Kernels ุ <br></li><li style=";text-align:right;direction:rtl">  ุณููุนุฑู ุงูุชูุฒูุน ุงูููุงุฆู ููููุงุนุฏ ุจุนุฏ ุณุชุฉ ุฃุดูุฑ ููุท ูู ุงูุงูุชูุงุก ูู ุตูุน ุงููุฑุงุฑ ุ  ุฎูุงู ูุฐุง ุงูููุช ุ ุณุชุชููุน ุงููุฑุงุฑุงุช ุงูุฃุณุนุงุฑ ูู ุงูุชุงุฑูุฎ ุงูุญุงูู. <br></li></ul><br><h2 style=";text-align:right;direction:rtl">  ุนู ุงููููุฉ </h2><br>  ุจุดุฑุท ุ ูุฌุจ ุฃู ูุชููุน ุงูุซูุฉ <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>i</mi></mrow></msub><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x60C;</mo></mrow><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.342ex" height="2.66ex" viewBox="0 -832 6605.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-68" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-61" x="826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="1356" y="0"></use><g transform="translate(1717,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-79" x="0" y="0"></use><g transform="translate(490,-242)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-69" x="361" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-69" x="3057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-6E" x="3403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMAIN-5B" x="4003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMAIN-2212" x="4282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMAIN-31" x="5060" y="0"></use><g transform="translate(5561,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ุ</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMAIN-31" x="5826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMAIN-5D" x="6326" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi><msub><mrow class="MJX-TeXAtom-ORD"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฐ</font></font></mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง</font></font></mi></mrow></msub><mtext>&nbsp;</mtext><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></mi><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[</font></font></mo><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></mo><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></mn><mrow class="MJX-TeXAtom-ORD"><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ</font></font></mo></mrow><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></mn><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></mo></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ hat {y} _ {ti} \ in [-1ุ1] </script>  ูู ุฃู ุงูุนุงุฆุฏ ุนูู ุงูุฃุตูู ุณูู ุชุฒูุฏ.  ูุนุชุจุฑ ุงูุนุงุฆุฏ ุนูู ุงูุฃุตู ูุชุนูููุง ุจุนุงุฆุฏ ุงูุณูู ููู.  ุงูููุงุณ ุงููุณุชูุฏู ูุฎุตุต - ููู ููุณ <abbr title="ุฎุทุฃ ุงูุฌุฐุฑ ุงูุชุฑุจูุนู">RMSE</abbr> ุฃู <abbr title="ูุนูู ุงูุฎุทุฃ ุงููุทูู">MAE</abbr> ุงูุฃูุซุฑ ุฏุฑุงูุฉ ุ ูููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณุจุฉ Sharpe</a> ุ ูุงูุชู ุชุนุชุจุฑ ูู ูุฐู ุงูุญุงูุฉ ุนูู ุงููุญู ุงูุชุงูู: <br><p style=";text-align:right;direction:rtl"></p><p style=";text-align:right;direction:rtl"><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi></mrow><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>a</mi><mi>r</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi></mrow><mi>t</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x60C;</mo></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.726ex" height="2.66ex" viewBox="0 -832 15381.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-63" x="469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-6F" x="903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-72" x="1388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-65" x="1840" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMAIN-3D" x="4596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-66" x="5902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-72" x="6453" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-61" x="6904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-63" x="7434" y="0"></use><g transform="translate(7867,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-61" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-72" x="1209" y="0"></use><g transform="translate(1660,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="809" y="-213"></use></g></g><g transform="translate(10456,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-61" x="2424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMAIN-28" x="2953" y="0"></use><g transform="translate(3343,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMAIN-29" x="4271" y="0"></use></g><g transform="translate(15116,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ุ</text></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi><mrow class="MJX-TeXAtom-ORD"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุต</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></mi></mrow><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></mo><mtext>&nbsp;</mtext><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุต</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌ</font></font></mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุต</font></font></mi><msub><mrow class="MJX-TeXAtom-ORD"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></mi></mrow><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฒ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></mi><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></mo><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi></msub><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ</font></font></mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> \ text {score} = \ frac {\ bar {x} _t} {\ sigma (x_t)}ุ </script></p>  ุงูู <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>i</mi></msub><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>i</mi></mrow></msub><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>i</mi></mrow></msub><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.782ex" height="2.539ex" viewBox="0 -780.1 9808.8 1093.4" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMAIN-3D" x="1205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-73" x="2512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-75" x="2981" y="0"></use><g transform="translate(3554,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-69" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-68" x="5026" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-61" x="5603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="6132" y="0"></use><g transform="translate(6494,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-79" x="0" y="0"></use><g transform="translate(490,-242)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-69" x="361" y="0"></use></g></g><g transform="translate(7584,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-69" x="361" y="0"></use></g></g><g transform="translate(8636,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-69" x="361" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi></msub><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></mo><mtext>&nbsp;</mtext><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุช</font></font></mi><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง</font></font></mi></msub><mtext>&nbsp;</mtext><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi><msub><mrow class="MJX-TeXAtom-ORD"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฐ</font></font></mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง</font></font></mi></mrow></msub><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุต</font></font></mi><mrow class="MJX-TeXAtom-ORD"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง</font></font></mi></mrow></msub><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุช</font></font></mi><mrow class="MJX-TeXAtom-ORD"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง</font></font></mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-3"> x_t = \ sum_i \ hat {y} _ {ti} r_ {ti} u_ {ti} </script>  ุ <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="1.817ex" viewBox="0 -520.7 1051.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-69" x="361" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุต</font></font></mi><mrow class="MJX-TeXAtom-ORD"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง</font></font></mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-4"> r_ {ti} </script>  - ุงูุนุงุฆุฏ ุนูู ุงูุฃุตูู ุจุงููุณุจุฉ ุฅูู ุงูุณูู ููููู t ูู ุฃูู 10 ุฃูุงู ุ <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.723ex" height="1.817ex" viewBox="0 -520.7 1172.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-69" x="361" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุช</font></font></mi><mrow class="MJX-TeXAtom-ORD"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง</font></font></mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-5"> u_ {ti} </script>  - ูุชุบูุฑ ููุทูู ูุดูุฑ ุฅูู ูุง ุฅุฐุง ูุงู ูุฏ ุชู ุชุถููู ุงูุฃุตู ith ูู ุงูุชูููู ููููู t ุ <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>a</mi><mi>r</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi></mrow><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.012ex" height="2.419ex" viewBox="0 -780.1 2588.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-61" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-72" x="1209" y="0"></use><g transform="translate(1660,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุต</font></font></mi><msub><mrow class="MJX-TeXAtom-ORD"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></mi></mrow><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-6"> \ bar {x} _t </script>  - ูุชูุณุท โโุงููููุฉ <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.156ex" height="1.817ex" viewBox="0 -520.7 928.1 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="809" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-7"> x_t </script>  ุ <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x633;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x64A;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x62C;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x645;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x627;</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.672ex" height="2.66ex" viewBox="0 -832 4164.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(250,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ุณ</text></g><g transform="translate(976,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ู</text></g><g transform="translate(1506,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ุฌ</text></g><g transform="translate(1973,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ู</text></g><g transform="translate(2285,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ุง</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMAIN-28" x="2457" y="0"></use><g transform="translate(2846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMAIN-29" x="3774" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌ</font></font></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุง</font></font></mo></mrow><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></mo><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi></msub><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></mo></math></span></span><script type="math/tex" id="MathJax-Element-8"> \ ุณูุฌูุง (x_t) </script>  - ุงูุงูุญุฑุงู ุงููุนูุงุฑู <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.156ex" height="1.817ex" viewBox="0 -520.7 928.1 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/singularis/blog/440026/&amp;usg=ALkJrhgnN5mGsRXSbFWipXrwBOcdqRhghw#MJMATHI-74" x="809" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑ</font></font></mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-9"> x_t </script>  . <br><br>  ูุณุจุฉ ุดุงุฑุจ ูู ุงูุนุงุฆุฏ ุงููุนุฏู ุญุณุจ ุงููุฎุงุทุฑ ุ ูููู ุงููุนุงูู ุชุธูุฑ ูุนุงููุฉ ุงููุชุฏุงูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃูู ูู 1: ุถุนู ุงูุฃุฏุงุก <br></li><li style=";text-align:right;direction:rtl">  1-2: ูุชูุณุทุฉ ุ ููุงุกุฉ ุทุจูุนูุฉ ุ <br></li><li style=";text-align:right;direction:rtl">  2 - 3: ุงูุฃุฏุงุก ุงูููุชุงุฒ ุ <br></li><li style=";text-align:right;direction:rtl">  ููู 3: ุงูููุงู. <br></li></ul><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุญุฑูุฉ ุงูุณูู ุงูุจูุงูุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>ุงูููุช</b> (datetime64 [nsุ UTC]) - ุงูููุช ุงูุญุงูู (ูู ุจูุงูุงุช ุญุฑูุฉ ุงูุณูู ูู ุฌููุน ุงูุฎุทูุท ูู ุงูุณุงุนุฉ 22:00 ุจุงูุชูููุช ุงูุนุงููู ุงูููุณู) <br></li><li style=";text-align:right;direction:rtl">  <b>ูุงุฏุฉ ุงูุนุฑุถ</b> (ุงููุงุฆู) - ูุนุฑู ุงูุฃุตูู <br></li><li style=";text-align:right;direction:rtl">  (ุงุณู ุงููุฆุฉ) - ูุนุฑู ูุฌููุนุฉ ุฃุตูู ููุชูุงุตู ูุน ุจูุงูุงุช ุงูุฃุฎุจุงุฑ <br></li><li style=";text-align:right;direction:rtl">  <b>ุงูููู</b> (float64) - ูููุฉ ููุทููุฉ ุชุดูุฑ ุฅูู ูุง ุฅุฐุง ูุงูุช ูุฐู ุงููุงุฏุฉ ุณุชุคุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุนูุฏ ุญุณุงุจ ุงููุชูุฌุฉ <br></li><li style=";text-align:right;direction:rtl">  <b>ุญุฌู ุงูุชุฏุงูู</b> (float64) - ุญุฌู ุงูุชุฏุงูู ุงููููู <br></li><li style=";text-align:right;direction:rtl">  <b>ุฅุบูุงู</b> (float64) - ุณุนุฑ ุงูุฅุบูุงู ููุฐุง ุงูููู <br></li><li style=";text-align:right;direction:rtl">  <b>ููุชูุญ</b> (float64) - ุณุนุฑ ููุชูุญ ููุฐุง ุงูููู <br></li><li style=";text-align:right;direction:rtl">  <b>ReturnClosePrevRaw1</b> (float64) - ุงูุนุงุฆุฏ ูู ุงูุฅุบูุงู ุฅูู ุงูุฅุบูุงู ููููู ุงูุณุงุจู <br></li><li style=";text-align:right;direction:rtl">  <b>ReturnOpenPrevRaw1</b> (float64) - ุงูุฑุจุญูุฉ ูู ุงูุงูุชุชุงุญ ุฅูู ุงูุงูุชุชุงุญ ููููู ุงูุณุงุจู <br></li><li style=";text-align:right;direction:rtl">  <b>ReturnClosePrevMktres1</b> (float64) - ุงูุฑุจุญูุฉ ูู ุงูุฅุบูุงู ุฅูู ุงูุฅุบูุงู ููููู ุงูุณุงุจู ุ ุจุนุฏ ุชุนุฏูููุง ููููุง ูุญุฑูุฉ ุงูุณูู ููู <br></li><li style=";text-align:right;direction:rtl">  <b>ReturnOpenPrevMktres1</b> (float64) - ุงูุฑุจุญูุฉ ูู ุงูุงูุชุชุงุญ ุฅูู ุงูุงูุชุชุงุญ ููููู ุงูุณุงุจู ุ ุจุนุฏ ุชุนุฏูููุง ููููุง ูุญุฑูุฉ ุงูุณูู ููู <br></li><li style=";text-align:right;direction:rtl">  <b>ReturnClosePrevRaw10</b> (float64) - ุงูุนุงุฆุฏ ูู ุงูุฅุบูุงู ุนูู ูุฏุงุฑ ุงูุฃูุงู ุงูุนุดุฑุฉ ุงููุงุถูุฉ <br></li><li style=";text-align:right;direction:rtl">  <b>ReturnOpenPrevRaw10</b> (float64) - ุงูุฑุจุญูุฉ ูู ุงูุงูุชุชุงุญ ุฅูู ุงูุงูุชุชุงุญ ููุฃูุงู ุงูุนุดุฑุฉ ุงูุณุงุจูุฉ <br></li><li style=";text-align:right;direction:rtl">  <b>ReturnClosePrevMktres10</b> (float64) - ุงูุนุงุฆุฏ ูู ุงูุฅุบูุงู ุนูู ููุฑุจุฉ ููุฃูุงู ุงูุนุดุฑุฉ ุงููุงุถูุฉ ุ ุจุนุฏ ุชุนุฏููู ููููุง ูุญุฑูุฉ ุงูุณูู ููู <br></li><li style=";text-align:right;direction:rtl">  <b>ReturnOpenPrevMktres10</b> (float64) - ุงูุนุงุฆุฏ ูู ุงูุงูุชุชุงุญ ุฅูู ุงูุงูุชุชุงุญ ููุฃูุงู ุงูุนุดุฑุฉ ุงูุณุงุจูุฉ ุ ุจุนุฏ ุชุนุฏููู ููููุง ูุญุฑูุฉ ุงูุณูู ููู <br></li><li style=";text-align:right;direction:rtl">  <b>ReturnOpenNextMktres10</b> (float64) - ุญูู ุงูุนุงุฆุฏ ูู ุงููุชุญ ููุชุญ ุฎูุงู ุงูุฃูุงู ุงูุนุดุฑุฉ ุงูุชุงููุฉ ุ ุจุนุฏ ุชุนุฏููู ูุญุฑูุฉ ุงูุณูู ููู.  ุณูู ูุชููุน ูุฐู ุงููููุฉ. <br></li></ul><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุจูุงูุงุช ุงูุฃุฎุจุงุฑ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>ุงูููุช</b> (datetime64 [nsุ UTC]) - ุงูููุช ูู ุชููุฑ ุจูุงูุงุช UTC <br></li><li style=";text-align:right;direction:rtl">  <b>sourceTimestamp</b> (datetime64 [nsุ UTC]) - ุงูููุช ูู ูุดุฑ ุฃุฎุจุงุฑ UTC <br></li><li style=";text-align:right;direction:rtl">  <b>firstCreated</b> (datetime64 [nsุ UTC]) - ุงูููุช ุจุงูุชูููุช ุงูุนุงููู ุงูููุณู (UTC) ููุฅุตุฏุงุฑ ุงูุฃูู ูู ุงูุจูุงูุงุช <br></li><li style=";text-align:right;direction:rtl">  <b>sourceId</b> (ูุงุฆู) - ูุนุฑู ุงูุณุฌู <br></li><li style=";text-align:right;direction:rtl">  <b>ุงูุนููุงู</b> (ุงููุงุฆู) - ุงูุนููุงู <br></li><li style=";text-align:right;direction:rtl">  <b>ุฅูุญุงุญ</b> (int8) - ุฃููุงุน ุงูุฃุฎุจุงุฑ (1: ุชูุจูู ุ 3: ููุงู) <br></li><li style=";text-align:right;direction:rtl">  <b>takeSequence</b> (int16) - ูุนููุฉ ุบูุฑ ูุงุถุญุฉ ุชูุงููุง ุ ุงูุฑูู ูู ุจุนุถ ุงูุชุณูุณู <br></li><li style=";text-align:right;direction:rtl">  <b>ุงููุฒูุฏ</b> (ุงููุฆุฉ) - ูุนุฑู ูุฒูุฏ ุงูุฃุฎุจุงุฑ <br></li><li style=";text-align:right;direction:rtl">  <b>ุงูููุถูุนุงุช</b> (ุงููุฆุฉ) - ูุงุฆูุฉ ุจุฑููุฒ ููุถูุน ุงูุฃุฎุจุงุฑ (ูุฏ ุชููู ุนูุงูุฉ ุฌุบุฑุงููุฉ ุฃู ุญุฏุซูุง ุฃู ูุทุงุนูุง ุตูุงุนููุง ุ ุฅูุฎ.) <br></li><li style=";text-align:right;direction:rtl">  <b>ุดุฑุงุฆุญ ุงูุฌูููุฑ</b> (ุงููุฆุฉ) - ูุงุฆูุฉ ุฃุฎุจุงุฑ ุฑููุฒ ุงูุฌูููุฑ <br></li><li style=";text-align:right;direction:rtl">  <b>bodySize</b> ( <b>int32</b> ) - ุนุฏุฏ ุงูุดุฎุตูุงุช ูู ูุต ุงูุฃุฎุจุงุฑ <br></li><li style=";text-align:right;direction:rtl">  companyCount (int8) - ุนุฏุฏ ุงูุดุฑูุงุช ุงููุฐููุฑุฉ ุตุฑุงุญุฉ ูู ุงูุฃุฎุจุงุฑ <br></li><li style=";text-align:right;direction:rtl">  <b>headlineTag</b> (ูุงุฆู) - ุนูุงูุฉ ุนููุงู ูุนููุฉ ูู ุทููุณูู ุฑููุชุฑุฒ <br></li><li style=";text-align:right;direction:rtl">  <b>marketCommentary</b> (ููุทูู) - ุฅุดุงุฑุฉ ุฅูู ุฃู ุงูุฃุฎุจุงุฑ ุชุชุนูู ุจุธุฑูู ุงูุณูู ุงูุนุงูุฉ <br></li><li style=";text-align:right;direction:rtl">  ุงูุฌููุฉุงูุนุฏุฏ (int16) - ุนุฏุฏ ุงูุนุฑูุถ ูู ุงูุฃุฎุจุงุฑ <br></li><li style=";text-align:right;direction:rtl">  <b>wordCount</b> ( <b>int32</b> ) - ุนุฏุฏ ุงููููุงุช ูุนูุงูุงุช ุงูุชุฑููู ูู ุงูุฃุฎุจุงุฑ <br></li><li style=";text-align:right;direction:rtl">  <b>ุฑูุฒ ุงูุฃุตูู</b> (ูุฆุฉ) - ูุงุฆูุฉ ุงูุฃุตูู ุงููุฐููุฑุฉ ูู ุงูุฃุฎุจุงุฑ <br></li><li style=";text-align:right;direction:rtl">  <b>ุงุณู ุงูุฃุตูู</b> (ุงููุฆุฉ) - ุฑูุฒ ูุฌููุนุฉ ุงูุฃุตูู <br></li><li style=";text-align:right;direction:rtl">  <b>firstMentionSentence</b> (int16) - ุฌููุฉ ุชุฐูุฑ ุฃููุงู ุฃุญุฏ ุงูุฃุตูู: <br></li><li style=";text-align:right;direction:rtl">  <b>ุงูุตูุฉ</b> (float32) - ุฑูู ูู 0 ุฅูู 1 ุ ููุธูุฑ ุฃูููุฉ ุงูุฃุฎุจุงุฑ ุงููุชุนููุฉ ุจุงูุฃุตู <br></li><li style=";text-align:right;direction:rtl">  <b>sentimentClass</b> (int8) - ูุฆุฉ ุงูุฏุฑุฌุฉ ุงูููููุฉ ููุฃุฎุจุงุฑ <br></li><li style=";text-align:right;direction:rtl">  <b>sentimentNegative</b> (float32) - ุงุญุชูุงู ุฃู ุชููู ุงูุฏุฑุฌุฉ ุงูููููุฉ ุณูุจูุฉ <br></li><li style=";text-align:right;direction:rtl">  <b>sentimentNeutral</b> (float32) - ุงุญุชูุงู ุฃู ุชููู ุงููุบูุฉ ูุญุงูุฏุฉ <br></li><li style=";text-align:right;direction:rtl">  <b>sentimentPositive</b> (float32) - ุงุญุชูุงู ุฃู ูููู ุงูููุชุงุญ ุฅูุฌุงุจููุง <br></li><li style=";text-align:right;direction:rtl">  <b>sentimentWordCount</b> (int32) - ุนุฏุฏ ุงููููุงุช ูู ุงููุต ุงููุชุนููุฉ ุจุงูุฃุตู <br></li><li style=";text-align:right;direction:rtl">  <b>noveltyCount12H</b> (int16) - ุฃุฎุจุงุฑ "ุงูุฌุฏุฉ" ูู 12 ุณุงุนุฉ ุ ูุญุณูุจุฉ ุจุงููุณุจุฉ ุฅูู ุงูุฃุฎุจุงุฑ ุงูุณุงุจูุฉ ุญูู ูุฐุง ุงูุฃุตู <br></li><li style=";text-align:right;direction:rtl">  <b>newtycount24h</b> (int16) - ููุณู ุ ูู ุบุถูู 24 ุณุงุนุฉ <br></li><li style=";text-align:right;direction:rtl">  <b>noveltyCount3D</b> (int16) - ููุณู ุ ูู 3 ุฃูุงู <br></li><li style=";text-align:right;direction:rtl">  <b>noveltyCount5D</b> (int16) - ููุณู ุ ูู 5 ุฃูุงู <br></li><li style=";text-align:right;direction:rtl">  <b>noveltyCount7D</b> (int16) - ููุณู ุ ูู 7 ุฃูุงู <br></li><li style=";text-align:right;direction:rtl">  <b>volumeCounts12H</b> (int16) - ููุฏุงุฑ ุงูุฃุฎุจุงุฑ ุญูู ูุฐุง ุงูุฃุตู ูู 12 ุณุงุนุฉ <br></li><li style=";text-align:right;direction:rtl">  <b>volumeCounts24H</b> (int16) - ููุณู ุ ูู 24 ุณุงุนุฉ <br></li><li style=";text-align:right;direction:rtl">  <b>volumeCounts3D</b> (int16) - ููุณู ุ ูู 3 ุฃูุงู <br></li><li style=";text-align:right;direction:rtl">  <b>volumeCounts5D</b> (int16) - ููุณู ุ ููุฏุฉ 5 ุฃูุงู <br></li><li style=";text-align:right;direction:rtl">  <b>volumeCounts7D</b> (int16) - ููุณู ุ ูู 7 ุฃูุงู <br></li></ul><br></div></div><br>  ุงููููุฉ ูู ูู ุงูุฃุณุงุณ ูููุฉ ุงูุชุตููู ุงูุซูุงุฆู ุ ุฃู ุฃููุง ูุชููุน ุนูุงูุฉ ุซูุงุฆูุฉ ุ ุณุชุคุฏู ุฅูู ุฒูุงุฏุฉ (ูุฆุฉ ูุงุญุฏุฉ) ุฃู ููุตุงู (ูุฆุฉ 0). <br><br><h2 style=";text-align:right;direction:rtl">  ุญูู ุงูุฃุฏูุงุช </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Kaggle Kernels</a> ูู ุนุจุงุฑุฉ ุนู ููุตุฉ ุงูุญูุณุจุฉ ุงูุณุญุงุจูุฉ ุงูุชู ุชุฏุนู ุงูุชุนุงูู.  ุงูุฃููุงุน ุงูุชุงููุฉ ูู ุงูููู ูุฏุนููุฉ: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุจูุซูู ุงููุตู <br></li><li style=";text-align:right;direction:rtl">  ุงููุตู R <br></li><li style=";text-align:right;direction:rtl">  ุฏูุชุฑ Jupyter <br></li><li style=";text-align:right;direction:rtl">  RMarkdown <br></li></ul><br>  ูู ููุงุฉ ุชุนูู ูู ุญุงููุฉ ุงูุฅุฑุณุงุก.  ูุชู ุชุซุจูุช ุนุฏุฏ ูุจูุฑ ูู ุงูุญุฒู ูู ุงูุญุงููุฉ ุ ููููู ุงูุงุทูุงุน ุนูู ูุงุฆูุฉ ุจูุซูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> .  ุงูููุงุตูุงุช ุงููููุฉ ูู ููุง ููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ: 4 ุงูููู ุ </li><li style=";text-align:right;direction:rtl">  ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู: 17 ุฌูุฌุงุจุงูุช ุ </li><li style=";text-align:right;direction:rtl">  ูุญุฑู ุงูุฃูุฑุงุต: 5 ุฌูุฌุงุจุงูุช ุฏุงุฆู ู 16 ุฌูุฌุงุจุงูุช ูุคูุช ุ </li><li style=";text-align:right;direction:rtl">  ุงูุญุฏ ุงูุฃูุตู ูููุช ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู: 9 ุณุงุนุงุช (ูู ููุช ุจุฏุก ุงููุณุงุจูุฉ ูุงู 6 ุณุงุนุงุช). </li></ul><br>  ุชุชููุฑ ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช ุฃูุถูุง ูู Kernels ุ ููุน ุฐูู ุ ุชู ุญุธุฑ GPU ูู ูุฐู ุงููุณุงุจูุฉ. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Keras</a> ูู ุฅุทุงุฑ ุดุจูู ุนุตุจู ุนุงูู ุงููุณุชูู ูุนูู ุฃุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">TensorFlow</a> ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CNTK</a> ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Theano</a> .  ุฅููุง ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ูุฑูุญุฉ ููุบุงูุฉ ููููู ููููุง ุ ููู ุงููููู ุฅุถุงูุฉ ุทุจูููุฌูุง ุงูุดุจูุฉ ููุธุงุฆู ุงูุฎุณุงุฑุฉ ูุงููุฒูุฏ ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุงููุงุฌูุฉ ุงูุฎูููุฉ. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Scikit-learn</a> ูู ููุชุจุฉ ูุจูุฑุฉ ูู ุฎูุงุฑุฒููุงุช ุงูุชุนูู ุงูุขูู.  ูุตุฏุฑ ูููุฏ ูุฎูุงุฑุฒููุงุช ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูุชุญููู ุงูุจูุงูุงุช ูุงุณุชุฎุฏุงููุง ูุน ุฃุทุฑ ุนูู ุฃูุซุฑ ุชุฎุตุตูุง. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุชุญูู ูู ุตุญุฉ ุงููููุฐุฌ </h2><br>  ูุจู ุฅุฑุณุงู ุงููููุฐุฌ ููุชูููู ุ ุชุญุชุงุฌ ุฅูู ุงูุชุญูู ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ูุญูููุง ูู ุญุณู ุณูุฑู - ุฃู ุงูุชูุตู ุฅูู ุทุฑููุฉ ููุชุญูู ุงููุญูู.  ุฌุฑุจุช ุงูุทุฑู ุงูุชุงููุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุชุญูู ูู ุงูุตุญุฉ <i>ููุงุจู</i> ุงูุชูุณูู ุงููุณุจู ุงูุจุณูุท ุฅูู ูุฌููุนุงุช ุชุฏุฑูุจ / ุงุฎุชุจุงุฑ ุ </li><li style=";text-align:right;direction:rtl">  ุงูุญุณุงุจ ุงููุญูู ููุณุจุฉ ุดุงุฑุจ <i>ููุงุจู</i> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><abbr title="ุงุณุชูุจุงู ุงูุชุดุบูู ุงููููุฒุฉ">ROC</abbr> <abbr title="ููุทูุฉ ุชุญุช ุงูููุญูู">AUC</abbr></a> . </li></ol><br>  ูุชูุฌุฉู ูุฐูู ุ ุฃุธูุฑุช ุงููุชุงุฆุฌ ุงูุฃูุฑุจ ุฅูู ุงูุชูููู ุงูุชูุงูุณู ุ ุจุดูู ุบุฑูุจ ุจูุง ููู ุงูููุงูุฉ ุ ูุฒูุฌูุง ูู ุงููุณู ุงูุชูุงุณุจู (ุชู ุชุญุฏูุฏ ุงููุณู ุชุฌุฑูุจููุง 0.85 / 0.15) ู AUC.  ุฑุจูุง ูุง ูููู ุงูุชุญูู ูู ุงูุตุญุฉ ููุงุณุจูุง ุฌุฏูุง ุ ูุฃู ุณููู ุงูุณูู ูุฎุชูู ุชูุงููุง ูู ุงููุฑุงุญู ุงูุฃููู ูู ุจูุงูุงุช ุงูุชุฏุฑูุจ ููู ูุชุฑุฉ ุงูุชูููู.  ููุงุฐุง ุนููุช AUC ุฃูุถู ูู ูุณุจุฉ ุดุงุฑุจ - ูุง ุฃุณุชุทูุน ุฃู ุฃููู ุนูู ุงูุฅุทูุงู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงููุญุงููุงุช ุงูุฃููู </h2><br>  ูุธุฑูุง ูุฃู ุงููููุฉ ุชุชูุซู ูู ุงูุชูุจุค ุจุงูุณูุงุณู ุงูุฒูููุฉ ุ ููุฏ ุชู ุงุฎุชุจุงุฑ ุงูุญู ุงูุฃูู - ููู ุนุจุงุฑุฉ ุนู ุดุจูุฉ ุนุตุจูุฉ ูุชูุฑุฑุฉ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RNN</a> ) ุฃู ุจุงูุฃุญุฑู ูุชุบูุฑุงุชูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><abbr title="ุฐุงูุฑุฉ ุทูููุฉ ุงููุฏู">LSTM</abbr></a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><abbr title="ุจูุงุจุงุช ูุญุฏุฉ ุงููุชูุฑุฑุฉ">GRU</abbr></a> . <br><br>  ุงููุจุฏุฃ ุงูุฑุฆูุณู ููุดุจูุงุช ุงููุชูุฑุฑุฉ ูู ุฃูู ุจุงููุณุจุฉ ููู ูููุฉ ุฅุฎุฑุงุฌ ุ ููุณุช ููุงู ุนููุฉ ูุงุญุฏุฉ ูู ุงููุฏุฎูุงุช ุ ูููู ุชุณูุณู ูุงูู.  ููุชุฑุชุจ ุนูู ุฐูู ูุง ููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญู ุจุญุงุฌุฉ ุฅูู ุจุนุถ ุงููุนุงูุฌุฉ ุงููุณุจูุฉ ููุจูุงูุงุช ุงูุฃูููุฉ - ุฅูุดุงุก ูุฐู ุงูุชุณูุณูุงุช ุฐุงุชูุง ูู ุงูุทูู ุฑ ุฃูุงู ููู ุงูุฃุตูู ุ <br></li><li style=";text-align:right;direction:rtl">  ูุง ูููู ูููููุฐุฌ ุงููุงุฆู ุนูู ุดุจูุฉ ูุชูุฑุฑุฉ ุฃู ูุชูุจุฃ ุจูููุฉ ุงููุฎุฑุฌุงุช ุฅุฐุง ูู ุชูู ููุงู ุจูุงูุงุช ูุฃูุงู t ุงูุณุงุจูุฉ. <br></li></ul><br>  ููุฏ ููุช ุจุฅูุดุงุก ุชุณูุณูุงุช ูู ููู ุ ุจุฏุกูุง ูู t ุ ูุฐูู ูู ุชุนุฏ ุงููุฌููุนุฉ ุงููุงููุฉ ูุนููุงุช ุงูุชุฏุฑูุจ ููุงุณุจุฉ ููุฐุงูุฑุฉ ูู ุญุงูุฉ t ุงููุจูุฑุฉ ุฅูู ุญุฏ ูุง (ูู 20).  ุชู ุญู ุงููุดููุฉ ุจุงุณุชุฎุฏุงู ุงููููุฏุงุช ุ ุญูุซ ูููู ูู Keras ุงุณุชุฎุฏุงู ุงููููุฏุงุช ููุฌููุนุงุช ุจูุงูุงุช ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช ููู ูู ุงูุชุฏุฑูุจ ูุงูุชูุจุค. <br><br>  ูุงู ุงูุฅุนุฏุงุฏ ุงูุฃููู ููุจูุงูุงุช ุณุงุฐุฌูุง ูุฏุฑ ุงูุฅููุงู: ูุญู ูุฃุฎุฐ ุจูุงูุงุช ุงูุณูู ุจุฃููููุง ุจุงูุฅุถุงูุฉ ุฅูู ุฅุถุงูุฉ ุงุซููู ูู ุงูููุฒุงุช (ููู ุงูุฃุณุจูุน ูุงูุดูุฑ ูุฑูู ุงูุฃุณุจูุน ูู ุงูุณูุฉ) ุ ููุญู ูุง ูููุณ ุจูุงูุงุช ุงูุฃุฎุจุงุฑ ุนูู ุงูุฅุทูุงู. <br><br>  ุงุณุชุฎุฏู ุงููููุฐุฌ ุงูุฃูู t = 10 ูุจุฏุง ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"><code class="python hljs">model = Sequential() model.add(LSTM(<span class="hljs-number"><span class="hljs-number">256</span></span>, activation=act.tanh, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, input_shape=(data.timesteps, data.features))) model.add(LSTM(<span class="hljs-number"><span class="hljs-number">256</span></span>, activation=act.relu)) model.add(Dense(data.assets, activation=act.relu)) model.add(Dense(data.assets))</code> </pre> <br>  ูู ูุชู ุถุบุท ุฃู ุดูุก ููุงุณุจ ูู ูุฐุง ุงููููุฐุฌ ุ ููุงูุช ุงููุชูุฌุฉ ูุฑูุจุฉ ูู ุงูุตูุฑ (ุญุชู ูุงูุตูุง ูููููุง). <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุดุจูุงุช ุงูุชูุงููููุฉ ุงูุฒูููุฉ </h2><br>  ุญู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงูุฃูุซุฑ ุญุฏุงุซุฉ ููุชูุจุค ุจุงูุณูุณูุฉ ุงูุฒูููุฉ ูู TCN.  ุฌููุฑ ูุฐู ุงูุทูุจูููุฌูุง ุจุณูุท ููุบุงูุฉ: ูุฃุฎุฐ ุดุจูุฉ ุชูุงููููุฉ ุฃุญุงุฏูุฉ ุงูุจุนุฏ ููุทุจููุง ุนูู ุชุณูุณู ุงูุทูู t.  ุชุณุชุฎุฏู ุฎูุงุฑุงุช ุฃูุซุฑ ุชูุฏููุง ุงูุนุฏูุฏ ูู ุงูุทุจูุงุช ุงูุชูุงููููุฉ ุฐุงุช ุงูุงูุชุฏุงุฏ ุงููุฎุชูู.  ุชู ูุณุฎ ุชุทุจูู TCN ุฌุฒุฆููุง (ุฃุญูุงููุง ุนูู ูุณุชูู ุงูููุฑุฉ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ููุง</a> (ุชุตููุฑ ููุฏุณ TCN ูุฃุฎูุฐ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงูุฉ Wavenet</a> ). <br><br><img src="https://habrastorage.org/webt/rf/sb/-4/rfsb-4f0bydwgmhhkwvbrenuxu0.png"><br><br>  ูุงู ุงูุญู ุงูุฃูู ุงููุงุฌุญ ูุณุจููุง ูู ูุฐุง ุงููููุฐุฌ ุ ูุงูุฐู ูุชุถูู ุทุจูุฉ GRU ุฃุนูู TCN: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = Sequential() model.add(Conv1D(<span class="hljs-number"><span class="hljs-number">512</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>, activation=act.relu, padding=<span class="hljs-string"><span class="hljs-string">'causal'</span></span>, input_shape=(data.timesteps, data.features))) model.add(Conv1D(<span class="hljs-number"><span class="hljs-number">100</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>, activation=act.relu, padding=<span class="hljs-string"><span class="hljs-string">'causal'</span></span>, dilation_rate=<span class="hljs-number"><span class="hljs-number">2</span></span>)) model.add(Conv1D(<span class="hljs-number"><span class="hljs-number">100</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>, activation=act.relu, padding=<span class="hljs-string"><span class="hljs-string">'causal'</span></span>, dilation_rate=<span class="hljs-number"><span class="hljs-number">4</span></span>)) model.add(GRU(<span class="hljs-number"><span class="hljs-number">256</span></span>)) model.add(Dense(data.assets, activation=act.relu))</code> </pre><br>  ููุชุฌ ูุฐุง ุงููููุฐุฌ ุงูุฏุฑุฌุงุช = 0.27668.  ูุน ุงููููู ูู ุงูุถุจุท (ุนุฏุฏ ููุงุชุฑ TCN ุ ุญุฌู ุงูุฏููุนุฉ) ูุฒูุงุฏุฉ ูู t ุฅูู 100 ุ ุญุตููุง ุนูู 0.41092 ุจุงููุนู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">batch_size = <span class="hljs-number"><span class="hljs-number">512</span></span> model = Sequential() model.add(Conv1D(<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>, activation=act.relu, padding=<span class="hljs-string"><span class="hljs-string">'causal'</span></span>, input_shape=(data.timesteps, data.features))) model.add(Conv1D(<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>, activation=act.relu, padding=<span class="hljs-string"><span class="hljs-string">'causal'</span></span>, dilation_rate=<span class="hljs-number"><span class="hljs-number">2</span></span>)) model.add(Conv1D(<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>, activation=act.relu, padding=<span class="hljs-string"><span class="hljs-string">'causal'</span></span>, dilation_rate=<span class="hljs-number"><span class="hljs-number">4</span></span>)) model.add(GRU(<span class="hljs-number"><span class="hljs-number">16</span></span>)) model.add(Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=act.sigmoid))</code> </pre><br>  ุจุนุฏ ุฐูู ูุถูู ุงูุชุทุจูุน ูุงูุชุณุฑุจ: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs">batch_size = <span class="hljs-number"><span class="hljs-number">512</span></span> dropout_rate = <span class="hljs-number"><span class="hljs-number">0.05</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">channel_normalization</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> max_values = K.max(K.abs(x), <span class="hljs-number"><span class="hljs-number">2</span></span>, keepdims=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) + <span class="hljs-number"><span class="hljs-number">1e-5</span></span> out = x / max_values <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> out model = Sequential() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(data.timesteps &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>): model.add(Conv1D(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>, activation=act.relu, padding=<span class="hljs-string"><span class="hljs-string">'valid'</span></span>, input_shape=(data.timesteps, data.features))) model.add(Lambda(channel_normalization)) model.add(SpatialDropout1D(dropout_rate)) model.add(Conv1D(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'valid'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>): model.add(Conv1D(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>, activation=act.relu, padding=<span class="hljs-string"><span class="hljs-string">'valid'</span></span>, dilation_rate=<span class="hljs-number"><span class="hljs-number">2</span></span>**i)) model.add(Lambda(channel_normalization)) model.add(SpatialDropout1D(dropout_rate)) model.add(Conv1D(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'valid'</span></span>)) model.add(Flatten()) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: model.add(Flatten(input_shape=(data.timesteps, data.features))) model.add(Dense(<span class="hljs-number"><span class="hljs-number">256</span></span>, activation=act.relu)) model.add(Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=act.sigmoid))</code> </pre><br></div></div><br>  ุจุชุทุจูู ูุฐุง ุงููููุฐุฌ ุ ุจูุง ูู ุฐูู ูู ุงูุฎุทูุงุช ุงููุจูุฑุฉ (ูุน t = 1) ุ ูุญุตู ุนูู ุงููุชูุฌุฉ = 0.53578. <br><br><h2 style=";text-align:right;direction:rtl">  ุขูุงุช ุชุนุฒูุฒ ุงูุชุฏุฑุฌ </h2><br>  ูู ูุฐู ุงููุฑุญูุฉ ุ ุงูุชูุช ุงูุฃููุงุฑ ุ ููุฑุฑุช ุฃู ุฃูุนู ูุง ูุฌุจ ุงูููุงู ุจู ูู ุงูุจุฏุงูุฉ: ุฑุคูุฉ ุงููุฑุงุฑุงุช ุงูุนุงูุฉ ูููุดุงุฑููู ุงูุขุฎุฑูู.  ูุนุธู ุงูุญููู ุงูุฌูุฏุฉ ูู ุชุณุชุฎุฏู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุนูู ุงูุฅุทูุงู ุ ููุถูุฉ GBM. <br><br>  Gradient Boosting ูู ุทุฑููุฉ ML ุ ุญูุซ ูุชู ุงูุญุตูู ุนูู ูุฌููุนุฉ ูู ุงูููุงุฐุฌ ุงูุจุณูุทุฉ (ุบุงูุจูุง ุฃุดุฌุงุฑ ุงููุฑุงุฑ).  ูุธุฑูุง ููุนุฏุฏ ุงููุจูุฑ ูู ูุฐู ุงูููุงุฐุฌ ุงูุจุณูุทุฉ ุ ุชู ุชุญุณูู ูุธููุฉ ุงูุฎุณุงุฑุฉ.  ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุญูู Gradient Boosting ุ ุนูู ุณุจูู ุงููุซุงู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> . <br><br>  ููุง ุงุณุชุฎุฏู ุชุทุจูู GBM <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">lightgbm</a> - ุฅุทุงุฑ ุนูู ูุดููุฑ ุฅูู ุญุฏ ูุง ูู Microsoft. <br><br>  ูุนุทู ุงููููุฐุฌ ูุงููุนุงูุฌุฉ ุงููุณุจูุฉ ููุจูุงูุงุช ุงููุฃุฎูุฐุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ููุง ุนูู</a> ุงูููุฑ ุฏุฑุฌุฉ 0.64: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prepare_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(marketdf, newsdf)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># a bit of feature engineering marketdf['time'] = marketdf.time.dt.strftime("%Y%m%d").astype(int) marketdf['bartrend'] = marketdf['close'] / marketdf['open'] marketdf['average'] = (marketdf['close'] + marketdf['open'])/2 marketdf['pricevolume'] = marketdf['volume'] * marketdf['close'] newsdf['time'] = newsdf.time.dt.strftime("%Y%m%d").astype(int) newsdf['assetCode'] = newsdf['assetCodes'].map(lambda x: list(eval(x))[0]) newsdf['position'] = newsdf['firstMentionSentence'] / newsdf['sentenceCount'] newsdf['coverage'] = newsdf['sentimentWordCount'] / newsdf['wordCount'] # filter pre-2012 data, no particular reason marketdf = marketdf.loc[marketdf['time'] &gt; 20120000] # get rid of extra junk from news data droplist = ['sourceTimestamp','firstCreated','sourceId','headline','takeSequence','provider','firstMentionSentence', 'sentenceCount','bodySize','headlineTag','marketCommentary','subjects','audiences','sentimentClass', 'assetName', 'assetCodes','urgency','wordCount','sentimentWordCount'] newsdf.drop(droplist, axis=1, inplace=True) marketdf.drop(['assetName', 'volume'], axis=1, inplace=True) # combine multiple news reports for same assets on same day newsgp = newsdf.groupby(['time','assetCode'], sort=False).aggregate(np.mean).reset_index() # join news reports to market data, note many assets will have many days without news data return pd.merge(marketdf, newsgp, how='left', on=['time', 'assetCode'], copy=False) import lightgbm as lgb print ('Training lightgbm') # money params = { "objective" : "binary", "metric" : "binary_logloss", "num_leaves" : 60, "max_depth": -1, "learning_rate" : 0.01, "bagging_fraction" : 0.9, # subsample "feature_fraction" : 0.9, # colsample_bytree "bagging_freq" : 5, # subsample_freq "bagging_seed" : 2018, "verbosity" : -1 } lgtrain, lgval = lgb.Dataset(Xt, Yt[:,0]), lgb.Dataset(Xv, Yv[:,0]) lgbmodel = lgb.train(params, lgtrain, 2000, valid_sets=[lgtrain, lgval], early_stopping_rounds=100, verbose_eval=200)</span></span></code> </pre><br></div></div><br>  ุชุดุชูู ุงููุนุงูุฌุฉ ุงููุณุจูุฉ ููุง ุจุงููุนู ุนูู ุจูุงูุงุช ุงูุฃุฎุจุงุฑ ุ ูุงูุฌูุน ุจูููุง ูุจูู ุจูุงูุงุช ุงูุณูู (ููุน ุฐูู ุ ูุฅูู ูู ุงูุณุฐุงุฌุฉ ุฅูู ุญุฏ ูุง ุ ูุชู ุฃุฎุฐ ุดูุฑุฉ ุฃุตูู ูุงุญุฏุฉ ููุท ูู ูู ูุง ุฐูุฑ ูู ุงูุฃุฎุจุงุฑ ูู ุงูุงุนุชุจุงุฑ).  ุฃุฎุฐุช ูุฐุง ุงูุฎูุงุฑ ูุจู ุงููุนุงูุฌุฉ ูุฃุณุงุณ ูุฌููุน ุงููุฑุงุฑุงุช ุงููุงุญูุฉ. <br><br>  ุจุฅุถุงูุฉ ููุฒุฉ ุตุบูุฑุฉ (firstMentionSentence ู marketCommentary ู sentimentClass) ุ ููุฐูู ุงุณุชุจุฏุงู ุงููููุงุณ ุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ROC AUC</a> ุ ูุญุตู ุนูู 0.65389. <br><br><h2 style=";text-align:right;direction:rtl">  ูุฑูุฉ </h2><br>  ูุงู ุงููุฑุงุฑ ุงููุงุฌุญ ุงูุชุงูู ูู ุงุณุชุฎุฏุงู ูุฌููุนุฉ ุชุชููู ูู ูููุฐุฌ ุดุจูุฉ ุนุตุจูุฉ ู GBM (ุนูู ุงูุฑุบู ูู ุฃู "ุงููุฑูุฉ" ุงุณู ูุจูุฑ ููููุฐุฌูู).  ูุชู ุงูุญุตูู ุนูู ุงูุชูุจุค ุงููุงุชุฌ ุนู ุทุฑูู ุญุณุงุจ ูุชูุณุท โโุชูุจุคุงุช ุงููููุฐุฌูู ุ ูุจุงูุชุงูู ุชุทุจูู ุขููุฉ ุงูุชุตููุช ุงูููู.  ุณูุญ ูุฐุง ุงููุฑุงุฑ ููุญุตูู ุนูู ุฏุฑุฌุฉ 0.66879. <br><br><h2 style=";text-align:right;direction:rtl">  ุชุญููู ุงูุจูุงูุงุช ุงูุงุณุชูุดุงููุฉ ูููุฏุณุฉ ุงููุนุงูู </h2><br>  ุดูุก ุขุฎุฑ ูุชุจุฏุฃ ูุงู EDA.  ุจุนุฏ ุฃู ูุฑุฃุช ุฃูู ูู ุงูููู ููู ุงูุนูุงูุฉ ุจูู ุงูููุฒุงุช ุ ูุฅููุง ูุจูู ูุซู ูุฐู ุงูุตูุฑุฉ (ุงูุตูุฑ ูู ูุฐุง ุงููุณู ูุงุจูุฉ ููููุฑ): <br><br> <a href=""><img src="https://habrastorage.org/webt/hw/xl/b2/hwxlb2agjx113qtsyciwbeuulvk.png"></a> <br><br>  ูู ุงููุงุถุญ ููุง ุฃู ุงูุงุฑุชุจุงุท ุจุดูู ูููุตู ุฏุงุฎู ุงูุณูู ูุจูุงูุงุช ุงูุฃุฎุจุงุฑ ูุฑุชูุน ุฌุฏูุง ุ ููุน ุฐูู ุ ูุฅู ููู ุงูุนุงุฆุฏุงุช ููุท ุชุฑุชุจุท ุจุงููููุฉ ุงููุณุชูุฏูุฉ ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ุนูู ุงูุฃูู.  ูุธุฑูุง ูุฃู ุงูุจูุงูุงุช ุชูุซู ุณูุณูุฉ ุฒูููุฉ ุ ููู ุงูููุทูู ุฃูุถูุง ุฃู ููุธุฑ ุฅูู ุงูุงุฑุชุจุงุท ุงูุชููุงุฆู ูููููุฉ ุงููุฏู: <br><br> <a href=""><img src="https://habrastorage.org/webt/gg/t_/ft/ggt_ftesggo-ro3hnbohztculz0.png"></a> <br><br>  ูููู ููุงุญุธุฉ ุฃูู ุจุนุฏ ูุชุฑุฉ 10 ุฃูุงู ุ ููุฎูุถ โโุงูุงุนุชูุงุฏ ุจุดูู ูุจูุฑ.  ุฑุจูุง ูุฐุง ูู ุงูุณุจุจ ุงูุฐู ูุฌุนู GBM ูุนูู ุจุดูู ุฌูุฏ ุ ูุน ูุฑุงุนุงุฉ ุงูููุฒุงุช ููุท ูุน ุชุฃุฎูุฑ ููุฏุฉ 10 ุฃูุงู (ุงูููุฌูุฏุฉ ุจุงููุนู ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฃุตููุฉ). <br><br>  ุงุฎุชูุงุฑ ุงูููุฒุฉ ูุงููุนุงูุฌุฉ ุงููุณุจูุฉ ุฃูุฑ ุจุงูุบ ุงูุฃูููุฉ ูุฌููุน ุฎูุงุฑุฒููุงุช ML.  ุฏุนููุง ูุญุงูู ุงุณุชุฎุฏุงู ุทุฑู ุชููุงุฆูุฉ ูุงุณุชุฎุฑุงุฌ ุงูููุฒุงุช ุ ููู <abbr title="ุชุญููู ุงููููู ุงูุฑุฆูุณู">ุชุญููู</abbr> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููููู ุงูุฑุฆูุณู</a> ( <abbr title="ุชุญููู ุงููููู ุงูุฑุฆูุณู">PCA</abbr> ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.decomposition <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PCA <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.preprocessing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StandardScaler market_x = market_data.loc[:,features] scaler = StandardScaler() scaler.fit(market_x) market_x = scaler.transform(market_x) pca = PCA(<span class="hljs-number"><span class="hljs-number">.95</span></span>) pca.fit(market_x) market_pca = pca.transform(market_x)</code> </pre><br>  ุฏุนููุง ูุฑู ูุง ูู ุงูููุฒุงุช ุงูุชู ูููุฏูุง PCA: <br><br> <a href=""><img src="https://habrastorage.org/webt/oh/1e/a1/oh1ea1byez3dcgjpklh-6gbzvic.png"></a> <br><br>  ูุฑู ุฃู ุงูุทุฑููุฉ ูุง ุชุนูู ุฌูุฏูุง ุนูู ุจูุงูุงุชูุง ุ ูุฃู ุงูุงุฑุชุจุงุท ุงูููุงุฆู ููููุฒุงุช ุงูุฌุฏูุฏุฉ ุจุงููููุฉ ุงููุณุชูุฏูุฉ ุตุบูุฑ. <br><br><h2 style=";text-align:right;direction:rtl">  ุถุจุท ุฏููู ููุง ุฅุฐุง ูุงูุช ููุงู ุญุงุฌุฉ ูุฐูู </h2><br>  ุชุญุชูู ุงูุนุฏูุฏ ูู ุทุฑุฒ ML ุนูู ุนุฏุฏ ูุจูุฑ ุฌุฏูุง ูู ุงูุจุงุฑุงูุชุฑุงุช ุ ุฃู "ุฅุนุฏุงุฏุงุช" ุงูุฎูุงุฑุฒููุฉ ููุณูุง.  ูููู ุงุฎุชูุงุฑูุง ูุฏูููุง ุ ูููู ููุงู ุฃูุถูุง ุขููุงุช ุงุฎุชูุงุฑ ุชููุงุฆูุฉ.  ุจุงููุณุจุฉ ุฅูู ุงูุฃุฎูุฑ ุ ุชูุฌุฏ ููุชุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">hyperopt</a> ุชููู ุจุชูููุฐ ุฎูุงุฑุฒููุชูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชุทุงุจูุชูู</a> - ุงูุจุญุซ ุงูุนุดูุงุฆู ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Parzen Estimator (TPE) ููุธู ุงูุดุฌุฑุฉ</a> .  ุญุงููุช ุชุญุณูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุนููุงุช lightgbm (ููุน ุงูุฎูุงุฑุฒููุฉ ุ ุนุฏุฏ ุงูุฃูุฑุงู ุ ูุนุฏู ุงูุชุนูู ูุบูุฑูุง) ุ <br></li><li style=";text-align:right;direction:rtl">  ูุนููุงุช ููุงุฐุฌ ุงูุดุจูุฉ ุงูุนุตุจูุฉ (ุนุฏุฏ ููุงุชุฑ <abbr title="ุงูุดุจูุงุช ุงูุชูุงููููุฉ ุงูุฒูููุฉ">TCN</abbr> ุ ุนุฏุฏ <abbr title="ุจูุงุจุงุช ูุญุฏุฉ ุงููุชูุฑุฑุฉ">ูุชู</abbr> ุงูุฐุงูุฑุฉ <abbr title="ุจูุงุจุงุช ูุญุฏุฉ ุงููุชูุฑุฑุฉ">GRU</abbr> ุ ูุนุฏู ุงูุชุณุฑุจ ุ ูุนุฏู ุงูุชุนูู ุ ููุน ุญูุงู). <br></li></ul><br>  ูุชูุฌุฉ ูุฐูู ุ ุฃุนุทุช ุฌููุน ุงูุญููู ุงูุชู ุชู ุงูุนุซูุฑ ุนูููุง ุจุงุณุชุฎุฏุงู ูุฐุง ุงูุชุญุณูู ุฏุฑุฌุฉ ุฃูู ุ ุนูู ุงูุฑุบู ูู ุฃููุง ุนููุช ุจุดูู ุฃูุถู ุนูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ.  ุนูู ุงูุฃุฑุฌุญ ุ ูููู ุงูุณุจุจ ูู ุญูููุฉ ุฃู ุงูุจูุงูุงุช ุงูุชู ูุชู ุงุนุชุจุงุฑ ุงููุชูุฌุฉ ูุง ุชุดุจู ุฅูู ุญุฏ ูุจูุฑ ุจูุงูุงุช ุงูุชุญูู ูู ุงูุตุญุฉ ุงูุชู ุชู ุงุฎุชูุงุฑูุง ูู ุงูุชุฏุฑูุจ.  ูุจุงูุชุงูู ุ ููุฐู ุงููููุฉ ุ ูุฅู ุงูุถุจุท ุงูุฏููู ุบูุฑ ููุงุณุจ ููุบุงูุฉ ุ ูุฃูู ูุคุฏู ุฅูู ุฅุนุงุฏุฉ ุชุฏุฑูุจ ุงููููุฐุฌ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงููุฑุงุฑ ุงูููุงุฆู </h2><br>  ููููุง ูููุงุนุฏ ุงููุณุงุจูุฉ ุ ูููู ูููุดุงุฑููู ุงุฎุชูุงุฑ ุญููู ูููุฑุญูุฉ ุงูููุงุฆูุฉ.  ูุฑุงุฑุงุชู ุงูููุงุฆูุฉ ูู ููุณูุง ุชูุฑูุจุง ูุชุญุชูู ุนูู ูุฌููุนุฉ ูู ูููุฐุฌูู - <abbr title="ุขูุฉ ุชุนุฒูุฒ ุงูุชุฏุฑุฌ">GBM</abbr> ู <abbr title="ุจูุงุจุงุช ูุญุฏุฉ ุงููุชูุฑุฑุฉ">GRU</abbr> ูุชุนุฏุฏ ุงูุทุจูุงุช.  ุงููุฑู ุงููุญูุฏ ูู ุฃู ุฃุญุฏ ุงูุญููู ูุง ูุณุชุฎุฏู ุจูุงูุงุช ุงูุฃุฎุจุงุฑ ุนูู ุงูุฅุทูุงู ุ ูุงูุขุฎุฑ ูุณุชุฎุฏูู ุ ูููู ููุท ููููุฐุฌ ุงูุดุจูุฉ ุงูุนุตุจูุฉ. <br><br>  ุญู ุจูุงูุงุช ุงูุฃุฎุจุงุฑ: <br><br><img src="https://habrastorage.org/webt/lq/ql/g7/lqqlg7lzgqnkhjuvlakbvtwcmks.png"><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุงุฑุฏุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> itertools <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> functools <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kaggle.competitions <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> twosigmanews <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.preprocessing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StandardScaler, LabelEncoder <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Sequential, Model <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.layers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Dense, GRU, LSTM, Conv1D, Reshape, Flatten, SpatialDropout1D, Lambda, Input, Average <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.optimizers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Adam, SGD, RMSprop <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> losses <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ls <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> activations <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> act <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> keras.backend <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> K <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lightgbm <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> lgb</code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูุณุจูุง</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># fix random from numpy.random import seed seed(42) from tensorflow import set_random_seed set_random_seed(42) env = twosigmanews.make_env() (market_train_df, news_train_df) = env.get_training_data() def cleanData(market_data, news_data):   market_data = market_data[(market_data['returnsOpenNextMktres10'] &lt;= 1) &amp; (market_data['returnsOpenNextMktres10'] &gt;= -1)]   return market_data, news_data def prepareData(marketdf, newsdf, scaler=None):   print('Preparing data...')     print('...preparing features...')   marketdf = marketdf.copy()   newsdf = newsdf.copy()   # a bit of feature engineering   marketdf['time'] = marketdf.time.dt.strftime("%Y%m%d").astype(int)   marketdf['bartrend'] = marketdf['close'] / marketdf['open']   marketdf['average'] = (marketdf['close'] + marketdf['open'])/2   marketdf['pricevolume'] = marketdf['volume'] * marketdf['close']     newsdf['time'] = newsdf.time.dt.strftime("%Y%m%d").astype(int)   newsdf['position'] = newsdf['firstMentionSentence'] / newsdf['sentenceCount']   newsdf['coverage'] = newsdf['sentimentWordCount'] / newsdf['wordCount']   # filter pre-2012 data, no particular reason   marketdf = marketdf.loc[marketdf['time'] &gt; 20120000]     # get rid of extra junk from news data   droplist = ['sourceTimestamp','firstCreated','sourceId','headline','takeSequence','provider',               'sentenceCount','bodySize','headlineTag', 'subjects','audiences',               'assetName', 'wordCount','sentimentWordCount', 'companyCount',                'coverage']   newsdf.drop(droplist, axis=1, inplace=True)   marketdf.drop(['assetName', 'volume'], axis=1, inplace=True)     # unstack news   newsdf['assetCodes'] = newsdf['assetCodes'].apply(lambda x: x[1:-1].replace("'", ""))   codes = []   indices = []   for i, values in newsdf['assetCodes'].iteritems():       explode = values.split(", ")       codes.extend(explode)       repeat_index = [int(i)]*len(explode)       indices.extend(repeat_index)   index_df = p.DataFrame({'news_index': indices, 'assetCode': codes})   newsdf['news_index'] = newsdf.index.copy()   # Merge news on unstacked assets   news_unstack = index_df.merge(newsdf, how='left', on='news_index')   news_unstack.drop(['news_index', 'assetCodes'], axis=1, inplace=True)     # combine multiple news reports for same assets on same day   newsgp = news_unstack.groupby(['time','assetCode'], sort=False).aggregate(np.mean).reset_index()     # join news reports to market data, note many assets will have many days without news data   res = p.merge(marketdf, newsgp, how='left', on=['time', 'assetCode'], copy=False) #, right_on=['time', 'assetCodes'])   res.marketCommentary = res.marketCommentary.astype(float)     targetcol = 'returnsOpenNextMktres10'   target_presented = targetcol in res.columns   features = [col for col in res.columns if col not in ['time', 'assetCode', 'universe', targetcol]]     print('...scaling...')   if(scaler == None):       scaler = StandardScaler()       scaler = scaler.fit(res[features])   res[features] = scaler.transform(res[features])   print('...done.')   return type('', (object,), {       'scaler': scaler,       'data': res,       'x': res[features],       'y': (res[targetcol] &gt; 0).astype(int).values if target_presented else None,       'features': features,       'samples': len(res),       'assets': res['assetCode'].unique(),       'target_presented': target_presented   }) def generateTimeSeries(data, n_timesteps=1):     data.data[data.features] = data.data[data.features].fillna(data.data[data.features].mean())   #data.data[data.features] = data.data[data.features].fillna(0)   assets = data.data.groupby('assetCode', sort=False)     def grouper(n, iterable):       it = iter(iterable)       while True:          chunk = list(itertools.islice(it, n))          if not chunk:              return          yield chunk     def sample_generator():       while True:           for assetCode, days in assets:               x = days[data.features].values               y = (days['returnsOpenNextMktres10'] &gt; 0).astype(int).values if data.target_presented else None               for i in range(0, len(days) - n_timesteps + 1):                   yield (x[i: i + n_timesteps], y[i + n_timesteps - 1] if data.target_presented else 0)     def batch_generator(batch_size):       for batch in grouper(batch_size, sample_generator()):           yield tuple([np.array(t) for t in zip(*batch)])     n_samples = functools.reduce(lambda x,y : x + y, map(lambda t : 0 if len(t[1]) + 1 &lt;= n_timesteps else len(t[1]) - n_timesteps + 1, assets))   return type('', (object,), {       'gen': batch_generator,       'timesteps': n_timesteps,       'features': len(data.features),       'samples': n_samples,       'assets': list(map(lambda x: x[0], filter(lambda t : len(t[1]) + 1 &gt; n_timesteps, assets)))   })</span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูููุฐุฌ ุงูุดุจูุฉ ุงูุนุตุจูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">buildRNN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(timesteps, features)</span></span></span><span class="hljs-function">:</span></span>   i = Input(shape=(timesteps, features))   x1 = Lambda(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x[:,:,:<span class="hljs-number"><span class="hljs-number">13</span></span>])(i)   x1 = Conv1D(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'valid'</span></span>)(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>)(x1)   x1 = Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=act.sigmoid)(x1)   x2 = Lambda(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x[:,:,<span class="hljs-number"><span class="hljs-number">13</span></span>:])(i)   x2 = Conv1D(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'valid'</span></span>)(x2)   x2 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x2)   x2 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x2)   x2 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x2)   x2 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>)(x2)   x2 = Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=act.sigmoid)(x2)   x = Average()([x1, x2])   model = Model(inputs=i, outputs=x)   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> model <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">train_model_time_series</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(model, data, val_data=None)</span></span></span><span class="hljs-function">:</span></span>   print(<span class="hljs-string"><span class="hljs-string">'Building model...'</span></span>)   batch_size = <span class="hljs-number"><span class="hljs-number">4096</span></span>     optimizer = RMSprop()     <span class="hljs-comment"><span class="hljs-comment"># define roc_callback, inspired by https://github.com/keras-team/keras/issues/6050#issuecomment-329996505   def auc_roc(y_true, y_pred):       value, update_op = tf.metrics.auc(y_true, y_pred)       metric_vars = [i for i in tf.local_variables() if 'auc_roc' in i.name.split('/')[1]]       for v in metric_vars:           tf.add_to_collection(tf.GraphKeys.GLOBAL_VARIABLES, v)       with tf.control_dependencies([update_op]):           value = tf.identity(value)           return value     model.compile(loss=ls.binary_crossentropy, optimizer=optimizer, metrics=['binary_accuracy', auc_roc])     print(model.summary())     print('Training model...')     if(val_data == None):       model.fit_generator(data.gen(batch_size),           epochs=8,           steps_per_epoch=int(data.samples / batch_size),           verbose=1)   else:       model.fit_generator(data.gen(batch_size),           epochs=8,           steps_per_epoch=int(data.samples / batch_size),           validation_data=val_data.gen(batch_size),           validation_steps=int(val_data.samples / batch_size),           verbose=1)   return type('', (object,), {       'predict': lambda x: model.predict_generator(x, steps=1)   })</span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูููุฐุฌ GBM</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">train_model</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, val_data=None)</span></span></span><span class="hljs-function">:</span></span>   print(<span class="hljs-string"><span class="hljs-string">'Building model...'</span></span>)     params = {       <span class="hljs-string"><span class="hljs-string">"objective"</span></span> : <span class="hljs-string"><span class="hljs-string">"binary"</span></span>,       <span class="hljs-string"><span class="hljs-string">"metric"</span></span> : <span class="hljs-string"><span class="hljs-string">"auc"</span></span>,       <span class="hljs-string"><span class="hljs-string">"num_leaves"</span></span> : <span class="hljs-number"><span class="hljs-number">60</span></span>,       <span class="hljs-string"><span class="hljs-string">"max_depth"</span></span>: <span class="hljs-number"><span class="hljs-number">-1</span></span>,       <span class="hljs-string"><span class="hljs-string">"learning_rate"</span></span> : <span class="hljs-number"><span class="hljs-number">0.01</span></span>,       <span class="hljs-string"><span class="hljs-string">"bagging_fraction"</span></span> : <span class="hljs-number"><span class="hljs-number">0.9</span></span>,  <span class="hljs-comment"><span class="hljs-comment"># subsample       "feature_fraction" : 0.9,  # colsample_bytree       "bagging_freq" : 5,        # subsample_freq       "bagging_seed" : 2018,       "verbosity" : -1 }     ds, val_ds = lgb.Dataset(data.x.iloc[:,:13], data.y), lgb.Dataset(val_data.x.iloc[:,:13], val_data.y)   print('...training...')   model = lgb.train(params, ds, 2000, valid_sets=[ds, val_ds], early_stopping_rounds=100, verbose_eval=100)   print('...done.')     return type('', (object,), {       'model': model,       'predict': lambda x: model.predict(x.iloc[:,:13], num_iteration=model.best_iteration)   })</span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุชุฏุฑูุจ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs">n_timesteps = <span class="hljs-number"><span class="hljs-number">30</span></span> market_data, news_data = cleanData(market_train_df, news_train_df) dates = market_data[<span class="hljs-string"><span class="hljs-string">'time'</span></span>].unique() train = range(len(dates))[:int(<span class="hljs-number"><span class="hljs-number">0.85</span></span>*len(dates))] val = range(len(dates))[int(<span class="hljs-number"><span class="hljs-number">0.85</span></span>*len(dates)):] train_data_prepared = prepareData(market_data.loc[market_data[<span class="hljs-string"><span class="hljs-string">'time'</span></span>].isin(dates[train])], news_data.loc[news_data[<span class="hljs-string"><span class="hljs-string">'time'</span></span>] &lt;= max(dates[train])]) val_data_prepared = prepareData(market_data.loc[market_data[<span class="hljs-string"><span class="hljs-string">'time'</span></span>].isin(dates[val])], news_data.loc[news_data[<span class="hljs-string"><span class="hljs-string">'time'</span></span>] &gt; max(dates[train])], scaler=train_data_prepared.scaler) model_gbm = train_model(train_data_prepared, val_data_prepared) train_data_ts = generateTimeSeries(train_data_prepared, n_timesteps=n_timesteps) val_data_ts = generateTimeSeries(val_data_prepared, n_timesteps=n_timesteps) rnn = buildRNN(train_data_ts.timesteps, train_data_ts.features) model_rnn = train_model_time_series(rnn, train_data_ts, val_data_ts)</code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุชูุจุค</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">make_predictions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, template, model)</span></span></span><span class="hljs-function">:</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(hasattr(data, <span class="hljs-string"><span class="hljs-string">'gen'</span></span>)):       prediction = (model.predict(data.gen(data.samples)) * <span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>)[:,<span class="hljs-number"><span class="hljs-number">-1</span></span>]   <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:       prediction = model.predict(data.x) * <span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>   predsdf = p.DataFrame({<span class="hljs-string"><span class="hljs-string">'ast'</span></span>:data.assets,<span class="hljs-string"><span class="hljs-string">'conf'</span></span>:prediction})   template[<span class="hljs-string"><span class="hljs-string">'confidenceValue'</span></span>][template[<span class="hljs-string"><span class="hljs-string">'assetCode'</span></span>].isin(predsdf.ast)] = predsdf[<span class="hljs-string"><span class="hljs-string">'conf'</span></span>].values   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> template day = <span class="hljs-number"><span class="hljs-number">1</span></span> days_data = p.DataFrame({}) days_data_len = [] days_data_n = p.DataFrame({}) days_data_n_len = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (market_obs_df, news_obs_df, predictions_template_df) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> env.get_prediction_days():   print(<span class="hljs-string"><span class="hljs-string">f'Predicting day </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{day}</span></span></span><span class="hljs-string">'</span></span>)   days_data = p.concat([days_data, market_obs_df], ignore_index=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, copy=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, sort=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)   days_data_len.append(len(market_obs_df))   days_data_n = p.concat([days_data_n, news_obs_df], ignore_index=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, copy=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, sort=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)   days_data_n_len.append(len(news_obs_df))   data = prepareData(market_obs_df, news_obs_df, scaler=train_data_prepared.scaler)   predictions_df = make_predictions(data, predictions_template_df.copy(), model_gbm)   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(day &gt;= n_timesteps):       data = prepareData(days_data, days_data_n, scaler=train_data_prepared.scaler)       data = generateTimeSeries(data, n_timesteps=n_timesteps)       predictions_df_s = make_predictions(data, predictions_template_df.copy(), model_rnn)       predictions_df[<span class="hljs-string"><span class="hljs-string">'confidenceValue'</span></span>] = (predictions_df[<span class="hljs-string"><span class="hljs-string">'confidenceValue'</span></span>] + predictions_df_s[<span class="hljs-string"><span class="hljs-string">'confidenceValue'</span></span>]) / <span class="hljs-number"><span class="hljs-number">2</span></span>       days_data = days_data[days_data_len[<span class="hljs-number"><span class="hljs-number">0</span></span>]:]       days_data_n = days_data_n[days_data_n_len[<span class="hljs-number"><span class="hljs-number">0</span></span>]:]       days_data_len = days_data_len[<span class="hljs-number"><span class="hljs-number">1</span></span>:]       days_data_n_len = days_data_n_len[<span class="hljs-number"><span class="hljs-number">1</span></span>:]   env.predict(predictions_df)   day += <span class="hljs-number"><span class="hljs-number">1</span></span> env.write_submission_file()</code> </pre><br></div></div><br>  ุงูุญู ุจุฏูู ุจูุงูุงุช ุงูุฃุฎุจุงุฑ: <br><br><img src="https://habrastorage.org/webt/m8/vr/05/m8vr05gvobi5ffv6qrb5rz0zzqq.png"><br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูููุฏ (ุทุฑููุฉ ูุฎุชููุฉ ููุท)</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">buildRNN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(timesteps, features)</span></span></span><span class="hljs-function">:</span></span>   i = Input(shape=(timesteps, features))   x1 = Lambda(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x[:,:,:<span class="hljs-number"><span class="hljs-number">13</span></span>])(i)   x1 = Conv1D(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'valid'</span></span>)(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>)(x1)   x1 = Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=act.sigmoid)(x1)   model = Model(inputs=i, outputs=x1)   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> model</code> </pre><br></div></div><br>  ุฃุนุทู ููุง ุงููุฑุงุฑูู ูุชูุฌุฉ ููุงุซูุฉ (ุญูุงูู 0.69) ูู ุงููุฑุญูุฉ ุงูุฃููู ูู ุงููุณุงุจูุฉ ุ ูุงูุชู ุชุชูุงูู ูุน 566 ูู 2927 ููุงููุง ุ ูุจุนุฏ ุงูุดูุฑ ุงูุฃูู ูู ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ ุ ุงุฎุชูุทุช ุงูููุงูู ูู ูุงุฆูุฉ ุงููุดุงุฑููู ุจููุฉ ุ ูุงูุญู ูุน ุจูุงูุงุช ุงูุฃุฎุจุงุฑ ูุงู ูู ุงููุฑุชุจุฉ 65 ูู ุจูู 697 ูุฑูููุง ุงููุชุจููุฉ ุจูุชูุฌุฉ 3.19251 ููุง ุงูุฐู ุณูุญุฏุซ ุฎูุงู ุงูุฃุดูุฑ ุงูุฎูุณุฉ ุงูููุจูุฉ ุ ูุง ุฃุญุฏ ูุนูู. <br><br><h2 style=";text-align:right;direction:rtl">  ูุงุฐุง ุญุงููุช </h2><br><h3 style=";text-align:right;direction:rtl">  ููุงููุณ ูุฎุตุตุฉ </h3><br>  ูุธุฑูุง ูุฃู ุงููุฑุงุฑุงุช ูุชู ุชูููููุง ุจุงุณุชุฎุฏุงู ูุณุจุฉ Sharpe ุ ููู ุงูููุทูู ูุญุงููุฉ ุงุณุชุฎุฏุงููุง ููููุงุณ ูุฅููุงุก ุงูุชุฏุฑูุจ ูุจูุฑูุง. <br><br>  ูุชุฑู ู lightgbm: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sharpe_metric</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(y_pred, train_data)</span></span></span><span class="hljs-function">:</span></span> y_true = train_data.get_label() * <span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span> std = np.std(y_true * y_pred) mean = np.mean(y_true * y_pred) sharpe = np.divide(mean, std, out=np.zeros_like(mean), where=std!=<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"sharpe"</span></span>, sharpe, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre><br>  ุฃุซุจุช ุงูุชุญูู ุฃู ูุซู ูุฐุง ุงููููุงุณ ูุนูู ุจุดูู ุฃุณูุฃ ูู ูุฐู ุงููุดููุฉ ูู AUC. <br><br><h3 style=";text-align:right;direction:rtl">  ุขููุฉ ุงูุงูุชูุงู </h3><br>  ุชุณูุญ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุขููุฉ ุงูุงูุชูุงู</a> ููุดุจูุฉ ุงูุนุตุจูุฉ ุจุงูุชุฑููุฒ ุนูู ุงูููุฒุงุช "ุงูุฃูุซุฑ ุฃูููุฉ" ูู ุงูุจูุงูุงุช ุงููุตุฏุฑ.  ูู ุงููุงุญูุฉ ุงููููุฉ ุ ูุชู ุชูุซูู ุงูุงูุชุจุงู ุจูุงุณุทุฉ ูุงูู ููุฃูุฒุงู (ูุชู ุงูุญุตูู ุนููู ุบุงูุจูุง ุจุงุณุชุฎุฏุงู ุทุจูุฉ ูุชุตูุฉ ุจุงููุงูู ูุน ุชูุดูุท <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">softmax</a> ) ุ ูุงูุชู ูุชู ุถุฑุจูุง ุจูุงุณุทุฉ ุฅุฎุฑุงุฌ ุทุจูุฉ ุฃุฎุฑู.  ููุฏ ุงุณุชุฎุฏูุช ุชุทุจูููุง ูุชู ููู ุงูุชุฑููุฒ ุนูู ูุญูุฑ ุงูููุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">buildRNN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(timesteps, features)</span></span></span><span class="hljs-function">:</span></span>     <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">attention_3d_block</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inputs)</span></span></span><span class="hljs-function">:</span></span>       a = Permute((<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>))(inputs)       a = Dense(timesteps, activation=act.softmax)(a)       a = Permute((<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>))(a)       mul = Multiply()([inputs, a])       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mul     i = Input(shape=(timesteps, features))   x1 = Lambda(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x[:,:,:<span class="hljs-number"><span class="hljs-number">13</span></span>])(i)   x1 = Conv1D(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'valid'</span></span>)(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x1)   x1 = attention_3d_block(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x1)   x1 = attention_3d_block(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)(x1)   x1 = attention_3d_block(x1)   x1 = GRU(<span class="hljs-number"><span class="hljs-number">10</span></span>)(x1)   x1 = Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=act.sigmoid)(x1)   model = Model(inputs=i, outputs=x1)   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> model</code> </pre><br>  ูุจุฏู ูุฐุง ุงููููุฐุฌ ุฌููููุง ุ ููู ูุฐุง ุงูููุฌ ูู ูุนุทู ุฒูุงุฏุฉ ูู ุงููุชูุฌุฉ ุ ููุฏ ุฃุตุจุญ ุญูุงูู 0.67. <br><br><h2 style=";text-align:right;direction:rtl">  ูุง ูู ููู ูุฏูู ุงูููุช ููููุงู ุจู </h2><br>  ุงูุนุฏูุฏ ูู ุงููุฌุงูุงุช ุงูุชู ุชุจุฏู ูุงุนุฏุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุชุนุงูู ุจุดูู ุฃูุซุฑ ุชุญุฏูุฏุง ูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุขููุฉ ุงูุงูุชูุงู</a> ุ <br></li><li style=";text-align:right;direction:rtl">  ุญุงูู ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุฑููุฒ ุงูุชููุงุฆู</a> ุ <br></li><li style=";text-align:right;direction:rtl">  ุฌุฑุจ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุนูู ุนุจุฑ ุงูุฅูุชุฑูุช</a> <br></li><li style=";text-align:right;direction:rtl">  ุชุนุงูู ุจุนูุงูุฉ ูุน ุชูุงูู ุงูุฃุฎุจุงุฑ ูุจูุงูุงุช ุงูุณูู ุ ููุฐูู ูุน ุงููุนุงูุฌุฉ ุงููุณุจูุฉ ููุฃุฎุจุงุฑ. <br></li></ul><br><h2 style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌุงุช </h2><br>  ููุฏ ุงูุชูุช ูุบุงูุฑุชูุง ุ ููููู ูุญุงููุฉ ุชูุฎูุตูุง.  ุชุจูู ุฃู ุงูููุงูุณุฉ ูุงูุช ุตุนุจุฉ ุ ููููุง ูู ูุชููู ูู ููุงุฌูุฉ ุงูุฃูุณุงุฎ.  ูุดูุฑ ูุฐุง ุฅูู ุฃู ุงูุญุฏ ุงูุฃุฏูู ููุฏุฎูู ุฅูู ML ููุณ ุนุงูููุง ุฌุฏูุง ุ ูููู ููุง ูู ุงูุญุงู ูู ุฃู ุนูู ุชุฌุงุฑู ุ ูุฅู ุงูุณุญุฑ ุงูุญูููู (ูููุงู ุงููุซูุฑ ููู ูู ุงูุชุนูู ุงูุขูู) ูุชุงุญ ุจุงููุนู ูููุญุชุฑููู. <br><br>  ุงููุชุงุฆุฌ ุจุงูุฃุฑูุงู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุฏุฑุฌุฉ ุงููุตูู ูู ุงููุฑุญูุฉ ุงูุฃููู: ~ 0.69 ููุงุจู ~ 1.5 ูู ุงูููุงู ุงูุฃูู.  ูุงู ููุงู ูุง ูุนุงุฏู ุงููุชูุณุท โโุจุงููุณุจุฉ ูููุณุชุดูู ุ ูุชู ุงูุชุบูุจ ุนูู ูููุฉ 0.7 ูู ูุจู ุนุฏุฏ ูููู ุ ููุงูุช ุงููุชูุฌุฉ ุงููุตูู ูููุฑุงุฑ ุงูุนุงู ุฃูุถุง ~ 0.69 ุ ุฃูุซุฑ ุจูููู ูู ูุธูุฑู. <br></li><li style=";text-align:right;direction:rtl">  ููุงู ูู ุงููุฑุญูุฉ ุงูุฃููู: 566 ูู 2927. <br></li><li style=";text-align:right;direction:rtl">  ุงููุชูุฌุฉ ูู ุงููุฑุญูุฉ ุงูุซุงููุฉ: 3.19251 ุจุนุฏ ุงูุดูุฑ ุงูุฃูู. <br></li><li style=";text-align:right;direction:rtl">  ููุงู ูู ุงููุฑุญูุฉ ุงูุซุงููุฉ: 65 ูู 697 ุจุนุฏ ุงูุดูุฑ ุงูุฃูู. <br></li></ul><br>  ุฃูุฏ ุฃู ุฃููุช ุงูุชุจุงููู ุฅูู ุญูููุฉ ุฃู ุงูุฃุฑูุงู ูู ุงููุฑุญูุฉ ุงูุซุงููุฉ ูุง ุชุชุญุฏุซ ุจุดูู ุฎุงุต ุนู ุฃู ุดูุก ุ ุญูุซ ูุง ุชุฒุงู ููุงู ุจูุงูุงุช ููููุฉ ุฌุฏูุง ูุฅุฌุฑุงุก ุชูููู ููุนู ูููุฑุงุฑุงุช. <br><br><h2 style=";text-align:right;direction:rtl">  ุงููุฑุงุฌุน </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุญู ุงูููุงุฆู ุจุงุณุชุฎุฏุงู ุงูุฃุฎุจุงุฑ</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณูุบูุง: ุงุณุชุฎุฏุงู ุงูุฃุฎุจุงุฑ ููุชูุจุค ุจุญุฑูุงุช ุงูุฃุณูู</a> - ุตูุญุฉ ุงููุณุงุจูุฉ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Keras</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅุทุงุฑ ุงูุดุจูุฉ</a> ุงูุนุตุจูุฉ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">LightGBM</a> - ุฅุทุงุฑ GBM <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Scikit - ุชุนูู</a> - ููุชุจุฉ ุฎูุงุฑุฒููุฉ ุงูุชุนูู ุงูุขูู <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Hyperopt</a> - ููุชุจุฉ ูุชุญุณูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุนุงููุฑ ุงูููููุฉ</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงู ุนู WaveNet</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar440026/">https://habr.com/ru/post/ar440026/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar440016/index.html">ุนูุฏูุง ูููู ููุณ ุงููุฑุงุกุฉ: ONYX BOOX Monte Cristo 4 review</a></li>
<li><a href="../ar440018/index.html">ุงูุชุนุฑุถ ุงููุญูู ุงูุฏููุงูููู</a></li>
<li><a href="../ar440020/index.html">ุงูุงูุญุฏุงุฑ ุฃู ุงูุงูุญุฏุงุฑ ูู ุงูุงุฎุชุจุงุฑ</a></li>
<li><a href="../ar440022/index.html">ููุฑุงุฑู ููููุงู: ุณูุณูุญ ูู Fintech-startup Rally Rd ุจุดุฑุงุก "ุฃุณูู" ูู ุงูุณูุงุฑุงุช ุงููุงุฏุฑุฉ</a></li>
<li><a href="../ar440024/index.html">ุฅุนุงุฏุฉ ุชูุฌูู printf () ูู STM32 ุฅูู Qt Creator Console</a></li>
<li><a href="../ar440030/index.html">ุชุญุฏูุฏ PKH ุญุธุฑ ุนูู ุฌูุงุฒ ุชูุฌูู OpenWrt ูุน WireGuard ู DNSCrypt</a></li>
<li><a href="../ar440032/index.html">ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงูุฃูู ุตูุฑ ุงููุฌุฑ</a></li>
<li><a href="../ar440034/index.html">ูุจูุฉ ุงูุนูุงุฑุฉ. ูู microservice ุฅูู ูุชุฑุงุตุฉ</a></li>
<li><a href="../ar440036/index.html">ุงููุณ ุงููุชุงุจุฉ</a></li>
<li><a href="../ar440040/index.html">ูู ุงูุชูููุฉ - ูู ูููุณู. ููู ูู ุจุนุถ ุงูุฃุญูุงู ูุคุฏู ุฅูู ุทุฑูู ูุณุฏูุฏ.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>