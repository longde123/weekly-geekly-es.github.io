<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ… âœï¸ ğŸ‘©ğŸ½â€ğŸ’» Menggunakan PowerShell untuk Meningkatkan Keistimewaan Akun Lokal ğŸ‘©â€ğŸ”¬ ğŸ‘² ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eskalasi hak istimewa adalah penggunaan oleh penyerang hak akun saat ini untuk mendapatkan tingkat akses tambahan yang biasanya lebih tinggi ke sistem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menggunakan PowerShell untuk Meningkatkan Keistimewaan Akun Lokal</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/454160/"><img src="https://habrastorage.org/webt/5m/dx/hq/5mdxhqpfywe6rsdm6qeus22zxhu.jpeg"><br><br>  Eskalasi hak istimewa adalah penggunaan oleh penyerang hak akun saat ini untuk mendapatkan tingkat akses tambahan yang biasanya lebih tinggi ke sistem.  Terlepas dari kenyataan bahwa peningkatan hak istimewa mungkin merupakan hasil dari eksploitasi kerentanan zero-day, atau pekerjaan peretas kelas satu yang melakukan serangan yang ditargetkan, atau malware yang disamarkan dengan baik, tetapi paling sering ini terjadi karena konfigurasi komputer atau akun yang salah.  Mengembangkan serangan lebih lanjut, penyerang mengeksploitasi sejumlah kerentanan terpisah, yang bersama-sama dapat menyebabkan kebocoran data bencana. <br><a name="habracut"></a><br><h2>  Mengapa pengguna tidak boleh memiliki hak administrator lokal? </h2><br>  Jika Anda seorang spesialis keamanan, mungkin terlihat jelas bahwa pengguna tidak boleh memiliki hak administrator lokal, karena ini: <br><br><ul><li>  Membuat akun mereka lebih rentan terhadap berbagai serangan. </li><li>  Membuat serangan ini jauh lebih serius. </li></ul><br>  Sayangnya, bagi banyak organisasi ini masih merupakan masalah yang sangat kontroversial dan kadang disertai dengan diskusi yang memanas (lihat, misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">manajer saya mengatakan bahwa semua pengguna harus menjadi administrator lokal</a> ).  Tanpa membahas perincian diskusi ini, kami percaya bahwa penyerang memperoleh hak administrator lokal pada sistem yang sedang diselidiki: baik melalui eksploitasi atau karena mesin tidak terlindungi dengan baik. <br><br><h2>  Langkah 1. Membalikkan resolusi nama DNS melalui PowerShell </h2><br>  Secara default, PowerShell diinstal di banyak workstation lokal dan di sebagian besar server Windows.  Meskipun bukan tanpa berlebihan, itu dianggap sebagai alat kontrol dan otomatisasi yang sangat berguna, ia juga mampu berubah menjadi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">malware fileless yang</a> hampir tidak terlihat (program peretasan yang tidak meninggalkan jejak serangan). <br><br>  Dalam kasus kami, penyerang mulai melakukan pengintaian jaringan menggunakan skrip PowerShell, secara berurutan menyortir ruang alamat IP jaringan, mencoba menentukan apakah IP ini diizinkan untuk host, dan jika demikian, apa nama jaringan host ini. <br>  Ada banyak cara untuk menyelesaikan tugas ini, tetapi menggunakan cmdlet Get-ADComputer adalah opsi yang andal karena mengembalikan dataset yang sangat kaya tentang setiap node: <br><br><pre><code class="plaintext hljs">import-module activedirectory Get-ADComputer -property * -filter { ipv4address -eq '10.10.10.10'}</code> </pre> <br>  Jika kecepatan kerja di jaringan besar menyebabkan masalah, maka sistem panggilan balik DNS dapat digunakan: <br><br><pre> <code class="plaintext hljs">[System.Net.Dns]::GetHostEntry('10.10.10.10').HostName</code> </pre> <br><br><img src="https://habrastorage.org/webt/ah/3l/ia/ah3liarl5izowrmwwo8r8uo0gte.png"><br><br>  Metode daftar node pada jaringan sangat populer, karena sebagian besar jaringan tidak menggunakan model keamanan nol-kepercayaan dan tidak melacak permintaan DNS internal untuk lonjakan aktivitas yang mencurigakan. <br><br><h2>  Langkah 2: Pemilihan Sasaran </h2><br>  Hasil akhir dari langkah ini adalah untuk mendapatkan daftar nama host server dan workstation yang dapat digunakan untuk melanjutkan serangan. <br><br><img src="https://habrastorage.org/webt/q8/c6/fw/q8c6fwmptneowdatiefmti5wgdq.png"><br><br>  Dilihat dari namanya, server 'HUB-FILER' tampaknya menjadi tujuan yang layak, karena  Seiring waktu, server file cenderung mengakumulasi banyak folder jaringan dan akses berlebihan ke mereka oleh terlalu banyak orang. <br><br>  Melihat menggunakan Windows Explorer memungkinkan kami untuk menentukan apakah ada folder bersama yang terbuka, tetapi akun kami saat ini tidak dapat mengaksesnya (mungkin kami hanya memiliki hak untuk mendaftar). <br><br><h2>  <b>Langkah 3: Pelajari ACL</b> </h2><br>  Sekarang pada host HUB-FILER kami dan folder share target, kita dapat menjalankan skrip PowerShell untuk mendapatkan ACL.  Kami dapat melakukan ini dari mesin lokal, karena kami sudah memiliki hak administrator lokal: <br><br><pre> <code class="plaintext hljs">(get-acl \\hub-filer\share).access | ft IdentityReference,FileSystemRights,AccessControlType,IsInherited,InheritanceFlags â€“auto</code> </pre> <br><br>  Hasil Eksekusi: <br><br><img src="https://habrastorage.org/webt/ia/4c/ep/ia4cepe0xbhgippr_kuyco53bpm.png"><br><br>  Dari sini kita melihat bahwa grup Pengguna Domain hanya memiliki akses ke daftar, tetapi grup Helpdesk juga memiliki hak untuk berubah. <br><br><h2>  Langkah 4: Identifikasi Akun </h2><br>  Dengan menjalankan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Get-ADGroupMember</a> , kita bisa mendapatkan semua anggota grup ini: <br><br><pre> <code class="plaintext hljs">Get-ADGroupMember -identity Helpdesk</code> </pre> <br><br><img src="https://habrastorage.org/webt/t0/zl/0f/t0zl0fhqq2fulbe2ma9yrq-7tpc.png"><br><br>  Dalam daftar ini kita melihat akun komputer yang telah kita identifikasi dan yang telah kita akses: <br><br><img src="https://habrastorage.org/webt/6o/hd/4r/6ohd4ryvgxomnhzaonjt2udhnxa.png"><br><br><h2>  Langkah 5: Gunakan PSExec untuk bekerja dari akun komputer </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PsExec</a> dari Microsoft Sysinternals memungkinkan Anda untuk mengeksekusi perintah dalam konteks akun sistem SYSTEM @ HUB-SHAREPOINT, yang, seperti kita ketahui, adalah anggota gugus tugas Helpdesk.  Artinya, cukup bagi kita untuk melakukan: <br><br><pre> <code class="plaintext hljs">PsExec.exe -s -i cmd.exe</code> </pre> <br>  Nah, maka Anda memiliki akses penuh ke folder target \\ HUB-FILER \ share \ HR, karena Anda bekerja dalam konteks akun komputer HUB-SHAREPOINT.  Dan dengan akses ini, data dapat disalin ke perangkat penyimpanan portabel atau diambil dan ditransfer melalui jaringan. <br><br><h2>  Langkah 6: deteksi serangan ini </h2><br>  Kerentanan khusus ini untuk mengatur hak istimewa akun (akun komputer yang mengakses folder jaringan bersama, bukan akun pengguna atau akun layanan) dapat dideteksi.  Namun, tanpa alat yang tepat, ini sangat sulit. <br><br>  Untuk mendeteksi dan mencegah kategori serangan ini, kita dapat menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">DatAdvantage</a> untuk mengidentifikasi grup dengan akun komputer di dalamnya, dan kemudian menutup akses ke sana.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">DatAlert</a> melangkah lebih jauh dan memungkinkan Anda membuat pemberitahuan khusus untuk skenario seperti itu. <br><br>  Tangkapan layar di bawah ini menunjukkan pemberitahuan pengguna yang akan dipicu setiap kali akun komputer mengakses data pada server yang dipantau. <br><br><img src="https://habrastorage.org/webt/y8/eu/6g/y8eu6gawfmubmafib8epqcgaflk.png"><br><br><h2>  Langkah Berikutnya Menggunakan PowerShell </h2><br>  Ingin tahu lebih banyak?  Gunakan kode buka kunci "blog" untuk akses gratis ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kursus video PowerShell</a> lengkap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dan Fundamental Direktori Aktif</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id454160/">https://habr.com/ru/post/id454160/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id454140/index.html">Dari pengacara ke penguji di Yandex. Sejarah magang saya</a></li>
<li><a href="../id454144/index.html">Di Jawa 13 mereka ingin menambahkan "blok teks"</a></li>
<li><a href="../id454148/index.html">Memeriksa kinerja SOC</a></li>
<li><a href="../id454154/index.html">"Branches of Hell": kontrol cloud tempat pembuangan sampah ilegal dan tempat pembuangan sampah berbahaya</a></li>
<li><a href="../id454156/index.html">Ban dan protokol dalam otomasi industri: cara kerjanya</a></li>
<li><a href="../id454164/index.html">Bagaimana cara kerja pengujian A / B di Avito?</a></li>
<li><a href="../id454166/index.html">6 Juni - Forum VeeamON di Moskow</a></li>
<li><a href="../id454168/index.html">Arena utama negara. Bagaimana Luzhniki diperbarui sebelum Piala Dunia</a></li>
<li><a href="../id454170/index.html">Selamat datang di Pertemuan DroidHeads 8 Juni</a></li>
<li><a href="../id454172/index.html">Mengirim statistik dari DataFrame ke BigQuery menggunakan statistik Yandex.Direct sebagai contoh</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>