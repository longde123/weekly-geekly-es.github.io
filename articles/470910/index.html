<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>游 游쓇릞 游볱 쯈u칠 se puede hacer con anotaciones de contratos de microservicios? 游뱧游 游눉游 游꿮</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En una publicaci칩n anterior , hablamos sobre c칩mo y por qu칠 nosotros en Ancronis hacemos anotaciones para microservicios, y prometimos compartir nuest...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>쯈u칠 se puede hacer con anotaciones de contratos de microservicios?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acronis/blog/470910/">  En una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">publicaci칩n</a> anterior <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">,</a> hablamos sobre c칩mo y por qu칠 nosotros en Ancronis hacemos anotaciones para microservicios, y prometimos compartir nuestra pr치ctica de usar un 칰nico formato API para toda la Plataforma Acronis Cyber.  Hoy hablaremos de nuestra experiencia en las comprobaciones de anotaciones est치ticas, tambi칠n conocido como el primer paso en el camino para introducir anotaciones en una empresa. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/hm/0k/un/hm0kunnfzs9fvcgleqiyumvqny8.jpeg"></a> <br><a name="habracut"></a><br>  Entonces, suponga que ya tiene anotaciones para todas o la mayor칤a de las API.  Una pregunta razonable que nuestros colegas tambi칠n nos hicieron: "쯈u칠 se puede hacer con estos objetos m치gicos?" <br><br>  De hecho, hay dos tipos de comprobaciones que se pueden hacer directamente por anotaci칩n.  Las verificaciones est치ticas van directamente a los textos de las anotaciones Swagger o RAML.  No necesitan nada m치s, y pueden considerarse leg칤timamente la primera ventaja de usar contratos de microservicio formalizados. <br><br>  Las comprobaciones din치micas solo se pueden iniciar si tiene un servicio en funcionamiento.  Son algo m치s complicados, ya que le permiten profundizar y verificar cu치n v치lida es la anotaci칩n, probar la estabilidad del servicio y hacer mucho m치s.  Pero este es el tema de la pr칩xima publicaci칩n, y hoy nos centraremos en la est치tica. <br><br><h3>  춰Viva la gu칤a API! </h3><br>  Para no confundirte a ti mismo ni a los dem치s, vale la pena mencionar de inmediato que las verificaciones de anotaciones est치ticas se crean para controlar la conformidad de las anotaciones API (y, con suerte, las API mismas) con los requisitos corporativos.  Pueden ser solo pr치cticas adoptadas por la empresa o una API de pautas completa, que formaliza las reglas para preparar la API para sus servicios. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/084/f24/61b/084f2461b8fa9d944fbcf83ce4618ab7.jpg" alt="imagen"><br><br>  Cuando hablamos del colorido mundo de los microservicios, esto es muy importante, porque cada equipo puede tener su propio marco, su propio lenguaje de programaci칩n, una pila 칰nica o algunas bibliotecas especiales.  Bajo la influencia de pr치cticas espec칤ficas del microservicio, la presentaci칩n de la API para un observador externo est치 cambiando.  Esto crea una variedad innecesaria.  Para una interacci칩n efectiva de los elementos de un ecosistema (o plataforma), es necesario "alinear" la API tanto como sea posible. <br><br>  Aqu칤 hay un ejemplo: el c칩digo 404 se devuelve a la API de un componente solo si el recurso no existe.  Y el otro equipo vincula este error a la l칩gica de la aplicaci칩n y la API devolver치 404 cuando el usuario quiera comprar un producto que haya finalizado en el almac칠n.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">Atygaev</a> describi칩 estos problemas muy claramente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu칤</a> .  Esta inconsistencia en la comprensi칩n del c칩digo 404 ralentizar치 el desarrollo y conducir치 a errores, lo que significa llamadas innecesarias de soporte u horas adicionales de depuraci칩n, pero en cualquier caso, problemas medidos en t칠rminos monetarios. <br><br>  Los detalles de la sintaxis y los nombres adoptados por la compa침칤a se complementan con varios aspectos espec칤ficos de REST.  El desarrollador debe responder preguntas como: <br><br><ul><li>  쯇OST ser치 idempotente o no? </li><li>  쯈u칠 c칩digos de error utilizamos y qu칠 significan? </li><li>  쯇uedo agregar l칩gica empresarial a los c칩digos de error? </li></ul><br>  Ahora imagine que cada equipo debe resolver individualmente estas respuestas. <br><br>  El formato de la consulta de b칰squeda tambi칠n puede ser completamente diferente.  Por ejemplo, hay alrededor de una docena de formas de crear una muestra en la que solo se enumerar치n aquellos usuarios que tienen MacBookPro y ataques de virus frecuentes.  Cuando se trabaja en un proyecto grande que consta de docenas de microservicios, es necesario que la sintaxis de la consulta de b칰squeda sea com칰n a todas las versiones y productos de la empresa.  Y si una persona est치 acostumbrada a referirse a uno de los productos / servicios de su desarrollo, espera encontrar la misma estructura de solicitud y respuesta en otra.  De lo contrario, no se evitar치 el asombro (y el dolor). <br><br>  Muchas compa침칤as, especialmente gigantes, como <a href="">Microsoft</a> , <a href="">PayPal</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Google</a> , tienen sus propias pautas y est치n muy bien pensadas.  Pero usar las pautas de otras personas no siempre es posible, ya que est치n en gran medida vinculadas a los detalles de la empresa.  Adem치s, el pensamiento de todos tiene una estructura diferente, y las reglas pueden diferir simplemente porque es m치s conveniente para las personas trabajar de esta manera y no de otra manera. <br><br>  La comprensi칩n de que Acronis necesita su propia directriz API no lleg칩 de inmediato, sino con el creciente n칰mero de desarrolladores, microservicios y clientes e integraciones realmente externos.  En alg칰n momento, el equipo de arquitectos tuvo que establecer reglas uniformes para declarar la API, teniendo en cuenta tanto la experiencia de los gigantes de TI mencionados anteriormente como las pr치cticas de facto ya establecidas en los equipos de desarrollo. <br><br>  Uno de los problemas con esta implementaci칩n tard칤a de la API Guideline son las API publicadas existentes que no cumplen con los requisitos, lo que a su vez conlleva costos adicionales para redise침ar las interfaces y mantener la compatibilidad con versiones anteriores.  Por lo tanto, si su modelo de negocio implica una futura integraci칩n y publicaci칩n de la API, entonces debe pensar en reglas uniformes lo antes posible. <br><br><img src="https://habrastorage.org/webt/qt/yf/gz/qtyfgz3v0rojzm0dubyojcwl6hw.png"><br><br>  Por supuesto, la adopci칩n de las API de la Gu칤a no hizo que todas las API fueran constitutivas autom치ticamente.  Cada API ten칤a que ser analizada, cada devlid ten칤a que entender los nuevos requisitos.  Por lo tanto, realizamos la automatizaci칩n de las comprobaciones de RAML con la API Guideline que desarrollamos. <br>  An치lisis est치tico <br><br>  Primero debe decidir qu칠 analizaremos est치ticamente.  No todos los puntos API de la Gu칤a pueden formalizarse, por lo que primero debe resaltar un conjunto de reglas que se puedan entender f치cilmente a partir de la anotaci칩n API. <br><br>  En la primera versi칩n, identificamos las siguientes reglas: <br><br><ol><li>  Verifique las descripciones de la API.  Como dijimos en nuestro art칤culo anterior, puede crear documentaci칩n hermosa basada en la anotaci칩n API.  Esto significa que cada recurso, par치metro de consulta y respuesta debe tener una descripci칩n que brinde toda la informaci칩n necesaria a cualquier usuario de nuestra API.  Parecer칤a un poco, pero 춰qu칠 f치cil es mostrar a los desarrolladores que su anotaci칩n no es rica en descripciones! </li><li>  Comprobaci칩n de la presencia y correcci칩n de ejemplos.  Los lenguajes de anotaci칩n API tambi칠n le permiten describir ejemplos.  Por ejemplo, en respuesta podemos agregar un ejemplo de una respuesta de servicio real, algo de la vida real.  El uso de ejemplos indica c칩mo se debe usar y trabajar el punto final, y buscamos ejemplos a trav칠s del an치lisis est치tico de anotaciones. </li><li>  Validaci칩n de c칩digos de respuesta HTTP.  El est치ndar HTTP define una gran cantidad de c칩digos, pero se pueden interpretar de diferentes maneras.  Nuestra directriz formaliza el uso de c칩digos.  Tambi칠n limitamos la aplicabilidad de diferentes c칩digos seg칰n el m칠todo HTTP.  Por ejemplo, el c칩digo 201, de acuerdo con la especificaci칩n HTTP, se devuelve cuando se crea un recurso.  Por lo tanto, GET que devuelve 201 ser치 una llamada de atenci칩n (o el c칩digo se usa incorrectamente o GET crea el recurso).  Por lo tanto, nuestra directriz API proh칤be dicho uso.  Adem치s, los arquitectos tienen conjuntos de c칩digos fijos para cada m칠todo, y ahora los verificamos en modo est치tico a nivel de anotaciones. </li><li>  Comprobando los m칠todos HTTP.  Todos saben que el protocolo HTTP tiene un conjunto de m칠todos est치ndar (GET, POST, PUT, etc.), y tambi칠n hace posible el uso de m칠todos personalizados.  Nuestra directriz API describe los m칠todos permitidos que est치n permitidos, pero no deseados (OPCIONES), as칤 como completamente prohibidos (solo se pueden usar con la bendici칩n de los arquitectos).  Prohibido incluir el m칠todo HEAD est치ndar, as칤 como cualquier m칠todo personalizado.  Todo esto tambi칠n es f치cil de verificar en las anotaciones a los contratos. </li><li>  Verificaci칩n de derechos de acceso.  Esperamos que en 2019 la necesidad de soporte de autorizaci칩n no requiera explicaciones adicionales.  La buena documentaci칩n debe incluir informaci칩n sobre qu칠 roles admite la API y qu칠 m칠todos de API est치n disponibles para cada rol.  Adem치s de documentar informaci칩n sobre el modelo a seguir, grabada en el nivel de anotaci칩n, le permite hacer cosas mucho m치s interesantes en din치mica, sin embargo, hablaremos de esto en el pr칩ximo art칤culo. </li><li>  Validaci칩n de nombres.  Alivia el dolor de cabeza por usar diferentes enfoques para nombrar entidades.  En general, hay dos "campamentos": partidarios de CamelCase y snake_case.Camelcase, cuando cada palabra comienza con una letra may칰scula, y snake_case, cuando las palabras est치n separadas por guiones bajos y todo est치 escrito en min칰sculas.  En diferentes idiomas, se acostumbra dar nombres de diferentes maneras.  Por ejemplo, snake_case se acepta en Python y CamelCase se adopta en Go o Java.  Hicimos nuestra propia elecci칩n universal para todos los proyectos y corregimos en la Gu칤a API.  Por lo tanto, a trav칠s de anotaciones, verificamos los nombres de los recursos y par치metros de forma est치tica; </li><li>  Validaci칩n de encabezados personalizados.  Este es otro ejemplo de una verificaci칩n de nombres, pero est치 vinculada espec칤ficamente a las cabezas.  En Acronis, es habitual utilizar el formato del formulario X-Custom-Header-Name (a pesar de que este formato est치 en desuso).  Y controlamos su cumplimiento a nivel de anotaciones. </li><li>  Verifique el soporte HTTPS.  Cualquier servicio moderno deber칤a ser compatible con HTTPS, y algunos creen que trabajar con HTTP en estos d칤as generalmente es una mala noticia.  Por lo tanto, se debe indicar la anotaci칩n RAML o Swagger.  que el microservicio admite HTTPS sin HTTP. </li><li>  Verifique la estructura del URI.  En tiempos prehist칩ricos, es decir, antes del lanzamiento de la API de gu칤a, el URI de solicitud se ve칤a diferente en diferentes servicios: en alg칰n lugar / api / 2, en alg칰n lugar / api / nombre_servicio / v2, y as칤 sucesivamente.  Ahora, en nuestra gu칤a, se define una estructura de URI est치ndar para todas nuestras API.  El manual describe c칩mo deben verse para no crear confusi칩n. </li><li>  Comprobaci칩n de la compatibilidad de nuevas versiones.  Otro factor que cualquier autor de API debe tener en cuenta es la compatibilidad con versiones anteriores.  Es importante verificar si el c칩digo basado en la API anterior puede funcionar con la nueva versi칩n.  En funci칩n de este cambio se puede dividir en dos categor칤as: romper la compatibilidad con versiones anteriores y compatible.  Todo el mundo sabe que los cambios de 칰ltima hora son inaceptables, y si desea "mejorar" algo dram치ticamente, el desarrollador debe lanzar una nueva versi칩n de la API. Pero todos pueden cometer errores, por lo que nuestro otro objetivo en la etapa de comprobaciones est치ticas es omitir solo los cambios compatibles y jurar los incompatibles.  Se supone que la anotaci칩n, como el c칩digo, se almacena en el repositorio y, por lo tanto, tiene todo el historial de cambios.  Por lo tanto, podemos verificar nuestra REST HTTP para compatibilidad con versiones anteriores.  Por ejemplo, la adici칩n de compatibilidad (m칠todo, par치metro, c칩digo de respuesta) no viola, y la eliminaci칩n puede causar p칠rdida de compatibilidad.  Y esto ya puede verificarse a nivel de anotaci칩n. </li></ol><br><br> <i><img src="https://habrastorage.org/webt/kt/vo/wc/ktvowckxsyc4hujr2owbwmvy2qe.png"><br></i>  <i>Cuando no hay descripciones</i> <i><br><img src="https://habrastorage.org/webt/po/dv/k6/podvk6eqjgnydciv-jzbbw7-nm4.png"><br></i>  <i>Cuando hay descripciones</i> <i><br></i> <br><h3>  Conclusiones </h3><br>  Se necesita un an치lisis est치tico de las anotaciones para verificar (no, no la calidad del servicio), sino la calidad de la API.  Esta etapa le permite alinear las interfaces del programa entre s칤 para que las personas trabajen en un entorno claro y comprensible donde todo sea bastante predecible. <br><br>  Por supuesto, solo es necesario tratar con tal formalismo en compa침칤as lo suficientemente grandes, cuando verificar todas las correspondencias "manualmente" es muy largo, costoso y poco confiable.  Una peque침a empresa simplemente no la necesita.  Al menos por el momento.  Pero si en el futuro hay planes para convertirte en un unicornio, como Akronis, entonces las comprobaciones est치ticas y la API Guideline te ayudar치n. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/470910/">https://habr.com/ru/post/470910/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../470892/index.html">Implementaci칩n simple de CAM peque침o en FPGA</a></li>
<li><a href="../470894/index.html">Bala</a></li>
<li><a href="../470902/index.html">Alto rendimiento y particionamiento nativo: Zabbix con soporte TimescaleDB</a></li>
<li><a href="../470904/index.html">El camino m치s suave y peludo en aprendizaje autom치tico y redes neuronales profundas</a></li>
<li><a href="../470908/index.html">Por primera vez en el mundo con la ayuda de tecnolog칤as aditivas, se obtuvo un conjunto de motor de avi칩n de gran tama침o</a></li>
<li><a href="../470916/index.html">El punto de control electr칩nico "m치s barato" en Rusia controlado desde un tel칠fono inteligente</a></li>
<li><a href="../470918/index.html">F # 9: Opci칩n de tipo</a></li>
<li><a href="../470920/index.html">M치s de 5 formas de conectarse a una nube de l칤nea de datos</a></li>
<li><a href="../470922/index.html">Anuncio de mitap ThinkJava # 10 en Jarkov</a></li>
<li><a href="../470924/index.html">쯇or qu칠 para el nuevo proyecto tom칠 Robot Framework?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>