<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñºÔ∏è üéø üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø Aprenda t√°cticas adversas, t√©cnicas y conocimientos comunes (ATT @ CK). T√°cticas empresariales. Parte 4 üßëüèΩ‚Äçü§ù‚Äçüßëüèº üé≤ ü§ú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Escalada de privilegios 
 Enlaces a todas las partes: 
 Parte 1. Obtenci√≥n del acceso inicial (acceso inicial) 
 Parte 2. Ejecuci√≥n 
 Parte 3. Fijaci√≥...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprenda t√°cticas adversas, t√©cnicas y conocimientos comunes (ATT @ CK). T√°cticas empresariales. Parte 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428602/"><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Escalada de privilegios</a> </h1><br>  <b>Enlaces a todas las partes:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1. Obtenci√≥n del acceso inicial (acceso inicial)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2. Ejecuci√≥n</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3. Fijaci√≥n (persistencia)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 4. Escalada de privilegios</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 5. Evasi√≥n de defensa</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 6. Obtenci√≥n de credenciales (acceso de credenciales)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 7. Descubrimiento</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 8. Movimiento lateral</a> <br><br>  La escalada de privilegios es el resultado de acciones que permiten a un atacante o programa malicioso obtener un mayor nivel de permisos en el sistema o red atacados.  Las t√©cnicas de escalado de privilegios describen los m√©todos por los cuales un adversario, despu√©s de obtener acceso sin privilegios a un sistema atacado, utilizando varias "debilidades" de un sistema puede obtener derechos de administrador, sistema o ra√≠z locales.  El uso por parte de los atacantes de cuentas de usuario con derechos de acceso a sistemas o permisos espec√≠ficos para realizar ciertas operaciones tambi√©n puede considerarse una escalada de privilegios. <br><a name="habracut"></a><br>  <i>El autor no es responsable de las posibles consecuencias de aplicar la informaci√≥n establecida en el art√≠culo, y tambi√©n se disculpa por posibles imprecisiones hechas en algunas formulaciones y t√©rminos.</i>  <i>La informaci√≥n publicada es un recuento gratuito de los contenidos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MITER ATT &amp; CK</a> .</i> <br><br>  Es importante cancelar que algunas de las t√©cnicas descritas en la matriz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ATT @ CK</a> se incluyen simult√°neamente en varias etapas de la cadena de ataque, por ejemplo, la intercepci√≥n de b√∫squeda de DLL se puede usar tanto para asegurar el acceso mediante la ejecuci√≥n no autorizada de una DLL maliciosa como para aumentar los privilegios al iniciar la DLL en el proceso. trabajando en el contexto de un usuario m√°s privilegiado. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Manipulaci√≥n de tokens de acceso</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Usuario, Administrador <br>  <i>Descripci√≥n: los</i> atacantes pueden usar tokens de acceso para realizar acciones en diversos contextos de seguridad del usuario o del sistema, evitando as√≠ la detecci√≥n de actividad maliciosa.  Un adversario puede usar las funciones API de Windows para copiar tokens de acceso de procesos existentes (robo de tokens), para esto debe estar en el contexto de un usuario privilegiado (por ejemplo, un administrador).  El robo de tokens de acceso se usa generalmente para elevar los privilegios del administrador al Sistema.  Un adversario tambi√©n puede usar un token de acceso a la cuenta para la autenticaci√≥n en un sistema remoto, si esta cuenta tiene los permisos necesarios en el sistema remoto. <br>  Considere varias formas de abusar de los tokens de acceso: <br><ul><li>  Robo y suplantaci√≥n de tokens.  La suplantaci√≥n de tokens es la capacidad del sistema operativo para iniciar subprocesos en un contexto de seguridad distinto del contexto del proceso al que pertenece este subproceso.  En otras palabras, la personificaci√≥n de los tokens le permite realizar cualquier acci√≥n en nombre de otro usuario.  Un adversario puede duplicar un token de acceso usando la funci√≥n <i>DuplicateTokenEX</i> y usar <i>ImpersonateLoggedOnUser</i> para llamar a un hilo en el contexto de un usuario conectado, o usar <i>SetThreadToken</i> para asignar un token de acceso a una secuencia. </li><li>  Cree un proceso utilizando un token de acceso.  Un atacante puede crear un token de acceso utilizando la funci√≥n <i>DuplicateTokenEX</i> y luego usarlo con <i>CreateProcessWithTokenW</i> para crear un nuevo proceso que se ejecute en el contexto del usuario suplantado. </li><li>  Obtenci√≥n y suplantaci√≥n de tokens de acceso.  Un adversario, que tiene un nombre de usuario y una contrase√±a, puede crear una sesi√≥n de inicio de sesi√≥n utilizando la funci√≥n API <i>LogonUser</i> , que devolver√° una copia del token de acceso de sesi√≥n de una nueva sesi√≥n y luego usar√° la <i>funci√≥n SetThreadToken</i> para asignar un token al hilo.  Metasploit Meterpreter y CobaltStrike tienen herramientas para manipular tokens de acceso para elevar los privilegios. </li></ul><br>  <i>Recomendaciones de protecci√≥n:</i> para hacer un uso completo de las t√°cticas anteriores, un atacante debe tener derechos de administrador del sistema, as√≠ que no olvide limitar los privilegios de los usuarios comunes.  Cualquier usuario puede enga√±ar a los tokens de acceso si tienen credenciales leg√≠timas.  Limite la capacidad de los usuarios y grupos para crear tokens de acceso: <br>  <i>GPO: Configuraci√≥n del equipo&gt; [Pol√≠ticas]&gt; Configuraci√≥n de Windows&gt; Configuraci√≥n de seguridad&gt; Pol√≠ticas locales&gt; Asignaci√≥n de derechos de usuario: Crear un objeto de token</i> <br>  Tambi√©n determine qui√©n puede reemplazar los tokens de proceso de servicios locales o de red: <br>  <i>GPO: Configuraci√≥n del equipo&gt; [Pol√≠ticas]&gt; Configuraci√≥n de Windows&gt; Configuraci√≥n de seguridad&gt; Pol√≠ticas locales&gt; Asignaci√≥n de derechos de usuario: reemplazar un token de nivel de proceso</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modificaci√≥n de archivos ejecutables de aplicaciones "caracter√≠sticas de accesibilidad de Windows" (Caracter√≠sticas de accesibilidad)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> administrador <br>  <i>Descripci√≥n: las</i> aplicaciones de accesibilidad (lupa de pantalla, teclado en pantalla, etc.) se pueden iniciar utilizando combinaciones de teclas antes de que un usuario inicie sesi√≥n en el sistema.  Un atacante puede reemplazar los archivos de inicio de estos programas o cambiar la forma en que se inician y abrir una consola de comandos u obtener una puerta trasera sin iniciar sesi√≥n. <br><ul><li>  <i>C: \ Windows \ System32 \ sethc.exe</i> - lanzado 5 veces presionando la tecla Shift; </li><li>  <i>C: \ Windows \ System32 \ utilman.exe</i> : lanzado presionando la combinaci√≥n de Win + U. </li></ul><br>  En WinXP y versiones posteriores, sethc.exe y utilman.exe pueden reemplazarse, por ejemplo, con cmd.exe, luego, cuando presiona la combinaci√≥n de teclas deseada, cmd.exe se inicia antes de ingresar a Windows con privilegios del sistema. <br>  En Vista y versiones posteriores, debe cambiar la clave de registro que configura cmd.exe u otro programa como depurador, por ejemplo, para ultiman.exe.  Despu√©s de editar el registro y presionar la combinaci√≥n de teclas deseada en la pantalla de inicio de sesi√≥n o al conectarse al host a trav√©s de RDP, se ejecutar√° cmd.exe con derechos de sistema. <br>  Tambi√©n hay programas de Windows que pueden usarse para implementar esta t√©cnica de ataque: <br><ul><li>  <i>C: \ Windows \ System32 \ osk.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ Magnify.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ Narrator.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ DisplaySwitch.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ AtBroker.exe.</i> </li></ul><br>  <i>Recomendaciones de seguridad:</i> configure el inicio de la autenticaci√≥n de red obligatoria para usuarios remotos antes de crear una sesi√≥n RDP y mostrar la pantalla de inicio de sesi√≥n ( <i>habilitada de forma predeterminada en Windows Vista y posterior</i> ).  Use la puerta de enlace de escritorio remoto para administrar conexiones y configurar la seguridad RDP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modificaci√≥n de la clave de DLL de AppCert</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Administrador, Sistema <br>  <i>Descripci√≥n: las</i> DLL especificadas en el valor de la clave AppCertDLL se cargan en cada proceso que llama a las funciones API utilizadas con frecuencia: <i>CreateProcess, CreateProcessAsUser, CreateProcessWithLoginW, CreateProcessWithTokenW, WinExec</i> .  Se puede abusar del valor de la clave AppCertDLLs al hacer que una DLL maliciosa cargue y ejecute ciertos procesos.  AppCertDLLs se almacena en la siguiente clave de registro: <br>  <i>HKEY_LOCAL_MACHINE \ System \ CurrentControlSet \ Control \ Session Manager</i> . <br><br>  <i>Recomendaciones de protecci√≥n:</i> utilice todos los medios posibles para bloquear software potencialmente peligroso y descargar archivos DLL desconocidos, como AppLocker y DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modificaci√≥n de la clave DLL de AppInit</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Administrador, Sistema <br>  <i>Descripci√≥n: las</i> DLL especificadas en el valor de la clave AppInit_DLL se cargan en cada proceso que carga user32.dll.  En la pr√°ctica, esto es casi todos los programas. <br>  AppInit_DLLs se almacena en las siguientes claves de registro: <br><ul><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Windows;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Wow6432Node \ Microsoft \ Windows NT \ CurrentVersion \ Windows.</i> </li></ul><br>  Se puede abusar del valor de la clave AppInit_DLL para exceder los privilegios al cargar archivos DLL maliciosos e iniciar ciertos procesos.  La funcionalidad AppInit_DLLs est√° deshabilitada en Windows 8 y versiones posteriores cuando se activa el arranque seguro. <br><br>  <i>Recomendaciones de protecci√≥n:</i> considere usar una versi√≥n del sistema operativo no anterior a Windows 8 y habilitar el arranque seguro.  Utilice todo tipo de medios para bloquear software potencialmente peligroso y descargar archivos DLL desconocidos, como AppLocker y DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Abuso del subsistema de compatibilidad de aplicaciones (Aplicaci√≥n Shimming)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> administrador <br>  <i>Descripci√≥n: La</i> <i>infraestructura / marco de compatibilidad de aplicaciones de Microsoft Windows se</i> cre√≥ para garantizar la compatibilidad de los programas con las actualizaciones de Windows y los cambios en el c√≥digo del sistema operativo.  El sistema de compatibilidad utiliza las llamadas shim ("juntas"), bibliotecas que act√∫an como un b√∫fer entre el programa y el sistema operativo.  Usando la memoria cach√© de shim, el sistema determina la necesidad de juntas de shim (almacenadas como una base de datos .sdb).  Varios archivos .sdb almacenan varios procedimientos para interceptar el c√≥digo de la aplicaci√≥n, procesarlo y luego redirigirlo al sistema operativo.  La lista de todas las juntas de cu√±as instaladas por el instalador (sdbinst.exe) se almacena de forma predeterminada en: <br><ul><li>  <i>% WINDIR% \ AppPatch \ sysmain.sdb</i> ; </li><li>  <i>HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ InstalledSDB</i> . </li></ul><br>  Las bases de datos de shim personalizadas se almacenan en: <br><ul><li>  <i>% WINDIR% \ AppPatch [64] \ Personalizado;</i> </li><li>  <i>HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ Custom</i> . </li></ul><br>  Para garantizar la protecci√≥n en el modo de usuario, se excluye la posibilidad de cambiar el n√∫cleo del sistema operativo utilizando shim-gaskets, y se requieren derechos de administrador para instalarlos.  Sin embargo, algunos shim pads se pueden usar para omitir el Control de cuentas de usuario (UAC), la inyecci√≥n de DLL, deshabilitar la <a href="">Prevenci√≥n de ejecuci√≥n de datos</a> y el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Manejo de excepciones de estructuras</a> , as√≠ como interceptar direcciones de memoria.  Un atacante que usa juntas de ajuste puede aumentar los privilegios, instalar puertas traseras, desactivar la protecci√≥n del sistema operativo, como Windows Defender. <br><br>  <i>Recomendaciones de protecci√≥n:</i> no hay muchas maneras de evitar la aplicaci√≥n de calces.  No se recomienda deshabilitar la compatibilidad de aplicaciones para evitar problemas con la estabilidad del sistema operativo.  Microsoft lanz√≥ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">KB3045645</a> , que eliminar√° el indicador de "elevaci√≥n autom√°tica" en el archivo sdbinst.exe para evitar el uso del sistema shim para evitar el UAC. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Omitir control de cuenta de usuario</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Usuario, Administrador <br>  <i>Descripci√≥n:</i> Hay muchas formas de evitar UAC, las m√°s comunes se implementan en el proyecto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">UACMe</a> .  Se descubren nuevas formas de evitar UAC, como abusar de la aplicaci√≥n del sistema <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">eventvwr.exe</a> , que puede ejecutar un archivo binario o un script elevado.  Los programas maliciosos tambi√©n pueden integrarse en procesos confiables mediante los cuales UAC permite la escalada de privilegios sin preguntar a un usuario. <br>  Para omitir el UAC usando eventvwr.exe, la clave se modifica en el registro de Windows: <br>  <i>[HKEY_CURRENT_USER] \ Software \ Classes \ mscfile \ shell \ open \ command</i> . <br>  Para omitir el UAC usando sdclt.exe, se modifican las claves en el registro de Windows: <br>  <i>[HKEY_CURRENT_USER] \ Software \ Microsoft \ Windows \ CurrentVersion \ App Paths \ control.exe;</i> <i><br></i>  <i>[HKEY_CURRENT_USER] \ Software \ Classes \ exefile \ shell \ runas \ command \ isolatedCommand.</i> <br><br>  <i>Recomendaciones de protecci√≥n:</i> elimine a los usuarios del grupo de administradores locales en los sistemas protegidos.  Si es posible, habilite el nivel m√°s alto de protecci√≥n en la configuraci√≥n de UAC. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Intercepci√≥n de b√∫squeda de DLL (Secuestro de orden de b√∫squeda de DLL)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> usuario, administrador, sistema <br>  <i>Descripci√≥n: la</i> t√©cnica consiste en explotar vulnerabilidades en el algoritmo para encontrar mediante las aplicaciones los archivos DLL que necesitan para funcionar ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MSA2269637</a> ).  A menudo, el directorio de b√∫squeda de DLL es el directorio de trabajo del programa, por lo que los atacantes pueden reemplazar la DLL de origen por una maliciosa con el mismo nombre de archivo. <br>  Los ataques remotos en b√∫squedas de DLL se pueden llevar a cabo cuando el programa instala su directorio actual en un directorio remoto, por ejemplo, un recurso compartido de red.  Adem√°s, los atacantes pueden cambiar directamente el m√©todo de b√∫squeda y carga de archivos DLL reemplazando los archivos .manifest o .local, que describen los par√°metros de b√∫squeda de DLL.  Si el programa atacado funciona con un alto nivel de privilegios, la DLL maliciosa cargada por √©l tambi√©n se ejecutar√° con altos derechos.  En este caso, la t√©cnica se puede utilizar para aumentar los privilegios del usuario al administrador o al sistema. <br><br>  <i>Recomendaciones de protecci√≥n:</i> evite la carga remota de DLL (habilitada de manera predeterminada en Windows Server 2012+ y disponible con actualizaciones para XP + y Server 2003+).  Habilita el modo de b√∫squeda segura para archivos DLL, que restringe los directorios de b√∫squeda a directorios como <i>% SYSTEMROOT%</i> antes de realizar una b√∫squeda de DLL en el directorio de la aplicaci√≥n actual. <br>  Habilitar el modo de b√∫squeda segura de DLL: <br>  <i>Configuraci√≥n del equipo&gt; [Pol√≠ticas]&gt; Plantillas administrativas&gt; MSS (Legacy): MSS: (SafeDllSearchMode) Habilite el modo de b√∫squeda de DLL seguro.</i> <br>  Clave de registro correspondiente: <br>  <i>HKLM \ SYSTEM \ CurrentControlSet \ Control \ Session Manager \ SafeDLLSearchMode.</i> <br><br>  Considere auditar un sistema protegido para corregir deficiencias de DLL utilizando herramientas como PowerUP en PowerSploit.  No olvides bloquear el software malicioso y potencialmente peligroso, as√≠ como seguir las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">recomendaciones de Microsoft</a> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Intercepci√≥n de b√∫squeda de Dylib (secuestro de Dylib)</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Derechos:</i> usuario <br>  Descripci√≥n: la t√©cnica se basa en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">vulnerabilidades en los algoritmos de b√∫squeda de biblioteca din√°mica dylib en macOS y OS X.</a>  La conclusi√≥n es determinar el dylib que carga la aplicaci√≥n atacada y luego colocar la versi√≥n maliciosa de dylib con el mismo nombre en el directorio de trabajo de la aplicaci√≥n.  Esto har√° que la aplicaci√≥n cargue dylib, que se encuentra en el directorio de trabajo del programa.  En este caso, el Dylib malicioso se ejecutar√° con los derechos de acceso de la aplicaci√≥n atacada. <br><br>  Consejos de seguridad <i>:</i> evite que los usuarios escriban archivos en directorios de b√∫squeda dylib.  Audite las vulnerabilidades utilizando el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dylib Hijacking Scanner</a> de Objective-See. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Explotaci√≥n para la escalada de privilegios</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Derechos:</i> usuario <br>  <i>Descripci√≥n: los</i> opositores pueden aumentar los privilegios en el sistema atacado utilizando vulnerabilidades en el software. <br><br>  <i>Recomendaciones de protecci√≥n:</i> actualizaciones peri√≥dicas de software en todas las estaciones de trabajo protegidas, servidores, equipos de red y otros dispositivos conectados a la red protegida.  Analice los tipos de amenazas, vulnerabilidades y programas de explotaci√≥n que se pueden utilizar contra la organizaci√≥n protegida.  Tambi√©n se recomiendan los sistemas de protecci√≥n contra exploits, como el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Windows Defender Exploit Guard (WDEG)</a> para Windows 10 o el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enhanced Mitigation Experience Toolkit (EMET)</a> para versiones anteriores de Windows. <br><br>  h3 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">EWM Injection (Inyecci√≥n de memoria de ventana adicional)</a> <br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Administrador, Sistema <br>  <i>Descripci√≥n: La</i> t√©cnica es el abuso de la memoria adicional de la ventana de Windows, la llamada Memoria de ventana adicional (EWM).  El tama√±o de EWM es de 40 bytes, adecuado para almacenar un puntero de 32 bits y se usa a menudo para indicar una referencia a los procedimientos.  Los programas maliciosos durante la cadena de ataque pueden colocar un puntero a c√≥digo malicioso en el EWM, que posteriormente se iniciar√° mediante el proceso de la aplicaci√≥n infectada. <br><br>  <i>Recomendaciones de protecci√≥n:</i> dado que las t√©cnicas de inyecci√≥n EWM se basan en el abuso de las funciones de desarrollo del sistema operativo, los esfuerzos de protecci√≥n deben estar dirigidos a evitar el lanzamiento de programas maliciosos y herramientas maliciosas.  Es una buena pr√°ctica identificar y bloquear software potencialmente peligroso mediante AppLocker, incluir aplicaciones en la lista blanca o aplicar Pol√≠ticas de restricci√≥n de software. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Desventajas de los permisos a nivel del sistema de archivos (Debilidad de permisos del sistema de archivos)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Usuario, Administrador <br>  <i>Descripci√≥n:</i> La esencia de la t√©cnica es la sustituci√≥n de archivos ejecutables que se inician autom√°ticamente por varios procesos (por ejemplo, cuando el sistema operativo se inicia o en un momento determinado, si los derechos de los archivos ejecutables est√°n configurados incorrectamente).  Despu√©s de la suplantaci√≥n de identidad, el archivo malicioso se lanzar√° con los derechos del proceso, por lo que si el proceso tiene un nivel de acceso m√°s alto, el atacante podr√° escalar los privilegios.  En esta t√©cnica, los atacantes pueden intentar manipular los archivos binarios del servicio de Windows. <br>  Otra variante del ataque est√° asociada con la falta de algoritmos en el trabajo de los instaladores autoextra√≠bles.  Durante el proceso de instalaci√≥n, los instaladores a menudo descomprimen varios archivos √∫tiles, incluidos .dll y .exe, en el directorio% TEMP%, sin embargo, es posible que no establezcan los permisos adecuados para restringir el acceso a los archivos desempaquetados, lo que permite a los atacantes realizar suplantaci√≥n de archivos y, como resultado, aumenta los privilegios o evita el control de la cuenta, como  algunos instaladores se ejecutan con privilegios extendidos. <br><br>  <i>Recomendaciones de protecci√≥n:</i> limite los privilegios de la cuenta para que solo los administradores puedan administrar los servicios e interactuar con los archivos binarios utilizados por los servicios.  Deshabilite las opciones de escalado de privilegios UAC para usuarios est√°ndar.  La configuraci√≥n de UAC se almacena en la siguiente clave de registro: <br><ul><li>  <i>[HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Policies \ System]</i> . </li></ul><br>  Para rechazar autom√°ticamente las solicitudes de escalada de privilegios, debe agregar una clave: <br><ul><li>  <i>"ConsentPromptBehaviorUser" = dword: 00000000.</i> </li></ul><br>  Para controlar el trabajo de los instaladores, debe agregar una clave: <br><ul><li>  <i>"EnableInstallerDetection" = dword: 00000001</i> , que requerir√° una contrase√±a para instalar programas. </li></ul><br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Interceptar llamadas a funciones de la API de Windows (enlace)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Administrador, Sistema <br>  <i>Descripci√≥n:</i> las funciones de la API de Windows generalmente se almacenan en archivos DLL.  La t√©cnica de conexi√≥n es redirigir las llamadas a las funciones API mediante: <br><ul><li>  Procedimientos de enlace: procedimientos integrados en el sistema operativo que ejecutan c√≥digo cuando se llaman varios eventos, por ejemplo, pulsaciones de teclas o mover el mouse; </li><li>  Modificaciones a la tabla de direcciones (IAT), que almacena punteros a funciones API.  Esto le permitir√° "enga√±ar" a la aplicaci√≥n atacada, forz√°ndola a iniciar una funci√≥n maliciosa; </li><li>  Cambio directo de funci√≥n (empalme), durante el cual se cambian los primeros 5 bytes de la funci√≥n, en lugar de que se inserta la transici√≥n a una funci√≥n maliciosa u otra determinada por el atacante. </li></ul><br>  Al igual que las inyecciones, los atacantes pueden usar el enganche para ejecutar c√≥digo malicioso, enmascarar su ejecuci√≥n, acceder a la memoria del proceso atacado y aumentar los privilegios.  Los atacantes pueden capturar llamadas API que incluyen par√°metros que contienen datos de autenticaci√≥n.  El enganche generalmente es utilizado por rootkits para ocultar actividades maliciosas en el sistema. <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n: la</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interceptaci√≥n de eventos en el sistema operativo es parte del funcionamiento normal del sistema, por lo que cualquier restricci√≥n de esta funcionalidad puede afectar negativamente la estabilidad de las aplicaciones leg√≠timas, como el software antivirus. </font><font style="vertical-align: inherit;">Los esfuerzos para evitar el uso de t√©cnicas de intercepci√≥n deben centrarse en las etapas m√°s tempranas de la cadena de ataque. </font><font style="vertical-align: inherit;">Puede detectar actividad de enganche maliciosa al monitorear las llamadas a las funciones SetWindowsHookEx y SetWinEventHook, utilizando detectores de rootkit y analizando el comportamiento an√≥malo de los procesos.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inyecci√≥n IFEO (inyecci√≥n de opciones de ejecuci√≥n de archivos de imagen)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> El mecanismo de Opciones de ejecuci√≥n de archivos de imagen (IFEO) le permite ejecutar un depurador de programa en lugar de un programa, previamente especificado por el desarrollador en el registro:</font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Opciones de ejecuci√≥n de archivos de imagen / [ejecutable]</font></font></i> </li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKLM \ SOFTWARE \ Wow6432Node \ Microsoft \ Windows NT \ CurrentVersion \ Image File Execution Options \ [ejecutable]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donde </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ejecutable]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es el binario ejecutable del depurador.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al igual que las inyecciones, </font><font style="vertical-align: inherit;">se puede abusar </font><font style="vertical-align: inherit;">del valor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ejecutable]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ejecutando c√≥digo arbitrario para aumentar los privilegios u obtener un punto de apoyo en el sistema. Los programas maliciosos pueden usar IFEO para eludir la protecci√≥n mediante el registro de depuradores que redirigen y rechazan diversas aplicaciones del sistema y de seguridad. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n: La</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t√©cnica descrita se basa en el abuso de las herramientas de desarrollo de SO normales, por lo que cualquier restricci√≥n puede causar inestabilidad de software leg√≠timo, por ejemplo, aplicaciones de seguridad. Los esfuerzos para evitar el uso de las t√©cnicas de inyecci√≥n de IFEO deben centrarse en las primeras etapas de la cadena de ataque. Puede detectar dicho ataque monitoreando procesos con </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_only_this_process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lanzar Daemon (Lanzar Daemon)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;</font></font></h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font><i><font style="vertical-align: inherit;">: </font></i></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> administrador </font><i><font style="vertical-align: inherit;">: La</font></i><font style="vertical-align: inherit;"> t√©cnica consiste en cambiar los par√°metros de los servicios de nivel de inicio del sistema: el Daemon de inicio, especificado en los archivos plist, por el atacante. </font><font style="vertical-align: inherit;">Cuando se inicia el sistema, el proceso Lanzado carga los par√°metros de servicios (daemons) de los archivos plist ubicados en los siguientes directorios:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / System / Library / LaunchDeamons; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / Library / LaunchDeamons. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Launch Daemon se puede crear con privilegios de administrador, pero se ejecuta bajo la cuenta ra√≠z, por lo que un atacante puede escalar privilegios. </font><font style="vertical-align: inherit;">Los permisos de los archivos plist deben ser root: mientras que, sin embargo, el script o programa especificado en √©l puede tener permisos menos estrictos. </font><font style="vertical-align: inherit;">Por lo tanto, un atacante puede modificar los archivos ejecutables especificados en plist, y as√≠ modificar los servicios actuales del sistema para asegurar el sistema o escalar privilegios. </font><font style="vertical-align: inherit;">Consejos de </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seguridad:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limite los privilegios del usuario para que solo los administradores autorizados puedan crear Launch Daemon. </font><font style="vertical-align: inherit;">Considere monitorear c√≥mo se crean los archivos plist en su sistema utilizando aplicaciones como KnockKnock.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nuevos servicios</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Nombre de acceso al sistema, los atacantes pueden crear nuevos servicios y configurarlos para que se inicien autom√°ticamente. </font><font style="vertical-align: inherit;">El nombre del servicio se puede enmascarar utilizando nombres espec√≠ficos del sistema operativo. </font><font style="vertical-align: inherit;">Los servicios se pueden crear con privilegios de administrador, pero se ejecutan en nombre del sistema. </font><font style="vertical-align: inherit;">Los servicios se pueden crear desde la l√≠nea de comandos, usando herramientas de acceso remoto con interoperabilidad con la API de Windows, o usando herramientas de administraci√≥n est√°ndar de Windows y PowerShell. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de seguridad:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limite los derechos de usuario para crear nuevos servicios para que solo los administradores autorizados puedan hacerlo. </font><font style="vertical-align: inherit;">Aplicar AppLocker y la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pol√≠tica de restricci√≥n de software</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intercepci√≥n de ruta</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Usuario, administrador, sistema </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n: La</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t√©cnica de interceptar una ruta es colocar el archivo ejecutable en un directorio desde el cual la aplicaci√≥n lo iniciar√° en lugar del archivo de destino. </font><font style="vertical-align: inherit;">Un atacante puede usar los siguientes m√©todos:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rutas inexistentes. </font><font style="vertical-align: inherit;">Las rutas a los archivos ejecutables del servicio se almacenan en las claves de registro y pueden tener uno o m√°s espacios, por ejemplo, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ Archivos de programa \ service.exe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , si el atacante crea el archivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ Program.exe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el sistema </font><font style="vertical-align: inherit;">, Windows lo iniciar√° en lugar de procesar la ruta archivo objetivo de servicio.</font></font></li><li>    .    PATH  <i>C:\example</i>  <i>c:\Windows\System32</i>    <i>C:\example\net.exe</i> ,     net,   <i>C:\example\net.exe</i> ,   <i>c:\Windows\System32\net.exe</i> . </li><li>    (Search order hijacking).        , Windows,  ,        ,      . ,  ¬´example.exe¬ª    cmd.exe      net use.       example.exe  net.exe       <i>c:\Windows\System32\net.exe</i> .  ,     net.com     net.exe,  Windows  net.com     ,     PATHEXT. </li></ul><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La interceptaci√≥n de orden de b√∫squeda de archivos tambi√©n se utiliza para ejecutar archivos DLL utilizando la t√©cnica de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b√∫squeda de secuestro de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> archivos </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">DLL</font></a><font style="vertical-align: inherit;"> . </font></font></i> <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de seguridad: las</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comillas indican las rutas especificadas en los archivos de configuraci√≥n, los scripts, la variable PATH, la configuraci√≥n del servicio y los accesos directos. </font><font style="vertical-align: inherit;">Recuerde el orden de b√∫squeda de archivos ejecutables y use solo rutas completas. </font><font style="vertical-align: inherit;">Limpie las claves de registro antiguas que quedan del software remoto para que no queden claves en el registro que apunten a archivos inexistentes. </font><font style="vertical-align: inherit;">Establezca una prohibici√≥n de escritura por parte de los usuarios del sistema en el directorio ra√≠z C: \ y los directorios del sistema de Windows, limite los permisos de escritura a los directorios con archivos ejecutables.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modificaci√≥n de archivos Plist (Modificaci√≥n Plist)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usuario, Administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n: Los</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atacantes pueden modificar archivos plist, indicando en ellos su propio c√≥digo para su ejecuci√≥n en el contexto de otro usuario. </font><font style="vertical-align: inherit;">Los archivos de propiedades de plist ubicados en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Preferences</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se ejecutan con privilegios elevados, y el plist de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ / Library / Preferences</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se ejecuta con privilegios de usuario. </font><font style="vertical-align: inherit;">Consejos de seguridad </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> evite que los archivos plist se modifiquen haci√©ndolos de solo lectura.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modificaci√≥n de los monitores de puertos en el Administrador de impresi√≥n (monitores de puertos)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">: Un</font></i><font style="vertical-align: inherit;"> atacante puede organizar la ejecuci√≥n de una DLL arbitraria en nombre del Sistema cada vez que Windows se inicia utilizando el abuso de la configuraci√≥n del Administrador de impresi√≥n (Spoolsv.exe). Para interactuar con los dispositivos de impresi√≥n, Spoolsv.exe utiliza los llamados monitores de puerto, estos son archivos DLL que utilizan comandos de bajo nivel para enviarlos a los dispositivos de impresi√≥n a trav√©s de una interfaz LAN, USB, LPT o COM. Las DLL anteriores se almacenan en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ windows \ system32</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y se registran en el registro: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Print \ Monitors</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Port Monitor se puede instalar utilizando la API AddMonitor o directamente editando la clave de registro anterior. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> organice el bloqueo de software potencialmente peligroso y use herramientas de control de inicio de aplicaciones.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inyecci√≥n de c√≥digo en un proceso (inyecci√≥n de proceso), </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diez t√©cnicas de inyecci√≥n de proceso</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usuario, administrador, sistema, ra√≠z </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La inyecci√≥n de proceso es un m√©todo de ejecuci√≥n de c√≥digo arbitrario en el espacio de direcciones de un proceso vivo separado. Ejecutar c√≥digo en el contexto de otro proceso le permite acceder a la memoria del proceso inyectado, los recursos del sistema / red y posiblemente privilegios elevados. Las inyecciones de proceso tambi√©n se pueden utilizar para evitar la posible detecci√≥n de actividad maliciosa por medios de seguridad. Las t√©cnicas para implementar inyecciones en los procesos se basan en el abuso de varios mecanismos que aseguran el subprocesamiento m√∫ltiple de la ejecuci√≥n del programa en el sistema operativo. Los siguientes son algunos enfoques para inyectar c√≥digo en un proceso. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ventanas</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Inyecciones de DLL. Se realizan escribiendo la ruta a la DLL maliciosa dentro del proceso y luego ejecut√°ndola creando un subproceso remoto (Subproceso remoto: un subproceso que se ejecuta en el espacio de direcciones virtuales de otro proceso). En otras palabras, el malware escribe la DLL en el disco y luego usa una funci√≥n como CreateRemoteTread, que llamar√° a la funci√≥n LoadLibrary en el proceso inyectado. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Las inyecciones de PE (inyecci√≥n ejecutable port√°til) se basan en el abuso de las funciones de ejecuci√≥n de memoria de los archivos de PE, como DLL o EXE. El c√≥digo malicioso se escribe en el proceso sin escribir ning√∫n archivo en el disco, y luego se ejecuta la ejecuci√≥n utilizando el c√≥digo adicional o creando una secuencia remota.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ El secuestro de ejecuci√≥n de subprocesos implica la inyecci√≥n de c√≥digo malicioso o rutas DLL directamente en el subproceso del proceso. Al igual que la t√©cnica de proceso de vaciado, el flujo primero debe suspenderse. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ La inyecci√≥n en una inyecci√≥n de llamada a procedimiento asincr√≥nico (APC) implica la incrustaci√≥n de c√≥digo malicioso en la cola APC de un subproceso de proceso. Uno de los m√©todos de inyecci√≥n APC, llamado "inyecci√≥n Earle Bird", implica la creaci√≥n de un proceso suspendido en el que se puede escribir y lanzar c√≥digo malicioso en el punto de entrada del proceso a trav√©s de APC. AtomBombing es otra opci√≥n de inyecci√≥n que usa APC para invocar c√≥digo malicioso previamente escrito en la tabla global de √°tomos.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Las inyecciones de inyecci√≥n Thread Local Storage (TLS) implican manipular punteros de memoria dentro de un archivo PE ejecutable para redirigir el proceso a c√≥digo malicioso. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mac y Linux</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Ä¢ Las variables de sistema LD_RPELOAD, LD_LIBRARY_PATH (Linux), DYLIB_INSERT_LIBRARIES (macOS X) o la interfaz de programaci√≥n de aplicaciones (API) dlfcn se pueden usar para cargar din√°micamente una biblioteca (objeto compartido) en un proceso, que a su vez se puede usar para interceptar llamadas API desde Procesos en ejecuci√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ La llamada al sistema Ptrace se puede utilizar para conectarse a un proceso en ejecuci√≥n y cambiarlo mientras se est√° ejecutando.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ / proc / [pid] / mem proporciona acceso a la memoria del proceso y puede usarse para leer / escribir datos arbitrarios, sin embargo, este m√©todo rara vez se usa debido a la complejidad de su implementaci√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ La captura de VDSO (objeto compartido din√°mico din√°mico) le permite inyectar c√≥digo mientras ejecuta binarios ELF manipulando los ap√©ndices de c√≥digo de linux-vdso.so. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los programas maliciosos generalmente usan la inyecci√≥n de c√≥digo en un proceso para acceder a los recursos del sistema, lo que permite a un atacante obtener un punto de apoyo en el sistema y realizar otros cambios en el entorno atacado. Las muestras m√°s complejas pueden realizar inyecciones de procesos m√∫ltiples para dificultar su detecci√≥n. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los m√©todos para inyectar c√≥digo en los procesos se basan en el abuso de las funciones normales del sistema operativo que pueden afectar directamente el funcionamiento inestable de software leg√≠timo y productos de seguridad. </font><font style="vertical-align: inherit;">Los esfuerzos para evitar el uso de t√©cnicas de intercepci√≥n deben centrarse en las etapas m√°s tempranas de la cadena de ataque. </font><font style="vertical-align: inherit;">Use herramientas para bloquear software potencialmente peligroso, como AppLocker. </font><font style="vertical-align: inherit;">Use Yama como medida preventiva contra la inyecci√≥n de c√≥digo en ptrace, limitando el uso de ptrace solo a usuarios privilegiados. </font><font style="vertical-align: inherit;">Las medidas de seguridad adicionales pueden incluir el despliegue de m√≥dulos de seguridad del n√∫cleo que proporcionan control de acceso avanzado y restricci√≥n de procesos. </font><font style="vertical-align: inherit;">Dichas herramientas incluyen SELinux, grsecurity, AppArmor.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inyecci√≥n de historial SID</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> cada vez que un objeto se mueve de un dominio a otro, se crea un nuevo SID, que se convierte en el objectSID principal. Los SID anteriores contin√∫an almacen√°ndose en la propiedad sIDHistory, lo que garantiza que se conservan los derechos que ten√≠a el objeto antes de la migraci√≥n entre dominios. Los atacantes con derechos de administrador pueden insertar SID recopilados previamente en el historial de SID para realizar una acci√≥n en nombre de grupos o cuentas de acceso m√°s privilegiados, como los administradores de dominio. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En el sistema operativo Windows Server versi√≥n 2003 y superior, el filtrado de SID est√° habilitado de forma predeterminada, lo que implica eliminar o filtrar todos los SID excepto un dominio de confianza, pero esta opci√≥n puede deshabilitarse deliberadamente para permitir el acceso entre dominios. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los principales m√©todos para filtrar SID: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Deshabilitar SIDHistory en la configuraci√≥n de confianza (trusts) entre bosques de dominio utilizando el comando: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">netdom trust / domain: / EnableSIDHistory: no</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Aplicaci√≥n de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuarentena del filtro SID</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Esto garantiza que un objeto que contenga un SID que no sea el dominio de confianza no puede autenticarse con el dominio de confianza. La cuarentena de filtro SID se aplica a fideicomisos externos ejecutando el comando:</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">netdom trust / dominio: / cuarentena: s√≠</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No se recomienda utilizar el filtrado SID entre dominios en el mismo bosque. </font><font style="vertical-align: inherit;">Si el dominio en el bosque no es confiable, entonces no debe ser un miembro del bosque, en tal situaci√≥n, primero debe dividir los dominios confiables y no confiables en bosques separados, y luego aplicar el Filtro SID para las confianzas entre bosques.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tarea programada</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Usuario, Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Utilidades como at, schtasks y Windows Task Scheduler pueden usarse para programar programas y scripts para que se ejecuten en una fecha y hora espec√≠ficas. Se puede programar una tarea en un sistema remoto, siempre que se use RPC para la autenticaci√≥n y la impresora y el uso compartido de archivos est√© habilitado. La programaci√≥n de tareas en un sistema remoto requiere privilegios de administrador. Un atacante podr√≠a usar la ejecuci√≥n remota de c√≥digo para obtener privilegios del sistema o iniciar un proceso con una cuenta espec√≠fica. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limite los privilegios del usuario. </font><font style="vertical-align: inherit;">Usar herramientas, como el m√≥dulo PowerUP en PowerSploit, que se puede usar para encontrar debilidades en la resoluci√≥n de tareas programadas </font><font style="vertical-align: inherit;">Deshabilitar la capacidad de iniciar tareas en nombre del sistema, deshabilitar la opci√≥n " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Permitir que los operadores del servidor programen tareas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><font style="vertical-align: inherit;">en la pol√≠tica de seguridad </font><font style="vertical-align: inherit;">y la configuraci√≥n " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asignar derechos de usuario: aumentar la prioridad de programaci√≥n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debilidades en el registro de servicio Permisos Debilidad</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> si los permisos de usuarios y grupos permiten cambiar los valores de las claves en las que se almacenan los par√°metros del servicio en el registro de Windows, los atacantes pueden modificar directamente las claves en las que se almacenan las rutas a los archivos ejecutables para iniciar los servicios o utilizar varias herramientas de administraci√≥n servicios: sc.exe, PowerShell o Reg. Los atacantes tambi√©n pueden cambiar los par√°metros relacionados con la falla del servicio, por ejemplo, FailureCommand, que indica un comando que se ejecutar√° en caso de una falla del servicio o da√±o intencional. Los par√°metros de servicio se almacenan en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ services</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aseg√∫rese de que los usuarios del sistema protegido no puedan cambiar las claves del registro que almacenan los par√°metros de los componentes del sistema. </font><font style="vertical-align: inherit;">Utilice todos los medios posibles para bloquear software potencialmente peligroso, por ejemplo, Windows AppLocker.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setuid y Setgid</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos: </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">Descripci√≥n del</font></i><font style="vertical-align: inherit;"> usuario </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setuid y Setgid son marcas de permiso en sistemas Unix que permiten al usuario ejecutar archivos ejecutables con los derechos del propietario o grupo del archivo ejecutable. Si la aplicaci√≥n debe ejecutarse como root, en lugar de crear una entrada en el archivo sudo, el usuario puede especificar el indicador Setuid o Setgid. Los opositores pueden abusar de los indicadores Setuid y Setgid para realizar un escape de shell (cuando una aplicaci√≥n de consola usa un archivo abierto en otra aplicaci√≥n) o aprovechar la vulnerabilidad de la aplicaci√≥n con los indicadores Setuid y Setgid y ejecutar c√≥digo en el contexto de varios usuarios. Al ver los atributos del archivo con el comando ls -l, los indicadores anteriores se indican con el s√≠mbolo "s" en lugar de "x". La utilidad chmod puede establecer los indicadores Setuid y Setgid utilizando el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando chmod 4777 [archivo]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chmod u + s [archivo]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mantenga al m√≠nimo el n√∫mero de programas con los indicadores Setuid y Setgid establecidos.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Art√≠culos de inicio</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font><i><font style="vertical-align: inherit;">: </font></i></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> administrador </font><i><font style="vertical-align: inherit;">: Un</font></i><font style="vertical-align: inherit;"> atacante puede usar el mecanismo obsoleto, pero a√∫n trabajando en macOS Sierra, mecanismo de inicio autom√°tico para aplicaciones que usan StartupItems para configurar el lanzamiento de su c√≥digo con privilegios de root en el momento del arranque. </font><font style="vertical-align: inherit;">StartupItems es un directorio en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Startupitems</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un script de comando y un archivo de propiedades StartupParameters.plist. </font><font style="vertical-align: inherit;">El script y el archivo de propiedades deben estar en la parte superior de la jerarqu√≠a: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Startupitems / [MyStartupItem]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dado que el mecanismo StartupItems es obsoleto, la prohibici√≥n de escribir en el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directorio / Library / Startupitems /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le permitir√° evitar la creaci√≥n de elementos de inicio.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sudo</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font><i><font style="vertical-align: inherit;">: </font></i></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usuario </font><i><font style="vertical-align: inherit;">: los</font></i><font style="vertical-align: inherit;"> opositores pueden aprovechar las fallas de configuraci√≥n de Sudo para ejecutar comandos en nombre de otros usuarios o generar procesos con mayores privilegios. Las opciones de Sudo se almacenan en el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archivo / etc / sudoers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , se requieren privilegios elevados para editar este archivo. El archivo sudoers describe qu√© comandos pueden ejecutar los usuarios en nombre de otros usuarios o grupos, esto permite a los usuarios trabajar la mayor parte del tiempo con privilegios m√≠nimos y solo aumentar los privilegios si es necesario. Sin embargo, en el archivo sudoers, puede especificar usuarios para los que no se solicitar√° una contrase√±a: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombre de usuario ALL = (ALL) NOPASSWD: ALL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br> <i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consejos de </font><i><font style="vertical-align: inherit;">seguridad:</font></i><font style="vertical-align: inherit;"> el archivo sudoers debe editarse para que los usuarios siempre ingresen una contrase√±a al ejecutar sudo. </font><font style="vertical-align: inherit;">Auditd en Linux puede generar una advertencia siempre que las ID de usuario reales y efectivas no coincidan (esto sucede cuando el usuario usa sudo).</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Almacenamiento en cach√© de sudo</font></font></a> </h3><br>  <i>Sistema:</i> Linux, macOS <br>  <i>Derechos:</i> usuario <br>  <i>Descripci√≥n:</i> Varios malware, como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><i>OCX Proton Malware</i></a> , pueden abusar de la configuraci√≥n de sudo para ejecutar c√≥digo como root sin ingresar una contrase√±a.  Como el sudo toolkit fue creado para la administraci√≥n del sistema, tiene algunas funciones √∫tiles, como <i>timestamp_timeout</i> : este par√°metro almacena la cantidad de tiempo en minutos entre los inicios de sudo durante el cual el comando no solicitar√° la contrase√±a de root.  Sudo ha podido almacenar las credenciales en la memoria cach√© durante alg√∫n tiempo.  La marca de tiempo del √∫ltimo inicio de Sudo se almacena en <i>/ var / db / sudo</i> y se utiliza para determinar el tiempo de espera especificado.  Adem√°s, hay una variable <i>tty_tickets</i> que procesa cada nueva sesi√≥n de terminal de forma aislada, por lo que un tiempo de espera en una instancia de la consola no afectar√° el tiempo de espera en otra instancia. <br><br>  <i>Recomendaciones de protecci√≥n:</i> establezca el par√°metro <i>timestamp_timeout = 0</i> para que el sistema requiera una contrase√±a de root cada vez que se ejecute sudo.  Active el par√°metro <i>tty_tickets</i> para evitar que el ataque se implemente mediante sesiones de l√≠nea de comandos. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cuentas v√°lidas</a> </h3><br>  <i>Descripci√≥n: los</i> atacantes pueden robar las credenciales de una cuenta de usuario o servicio espec√≠fica mediante credenciales de acceso, capturar credenciales en el proceso de inteligencia mediante ingenier√≠a social.  Las credenciales comprometidas se pueden usar para omitir los sistemas de control de acceso y obtener acceso a sistemas remotos y servicios externos, como VPN, OWA, Escritorio remoto, o para obtener privilegios elevados en sistemas y √°reas espec√≠ficos de la red.  Si el escenario es exitoso, los atacantes pueden rechazar el malware para que sea dif√≠cil de detectar.  Adem√°s, los atacantes pueden crear cuentas usando nombres y contrase√±as predefinidos para mantener el acceso de respaldo en caso de intentos fallidos de usar otros medios. <br><br>  <i>Recomendaciones de protecci√≥n:</i> aplique una pol√≠tica de contrase√±a, siga las recomendaciones para dise√±ar y administrar una red corporativa para limitar el uso de cuentas privilegiadas en todos los niveles administrativos.  Controles regulares de las cuentas de dominio y locales y sus derechos para identificar aquellos que podr√≠an permitir a un atacante obtener un amplio acceso.  Monitoreo de la actividad de la cuenta utilizando sistemas SIEM. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Shell web</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descripci√≥n:</i> un atacante puede utilizar Web Shell como puerta de acceso para acceder a su red o acceso redundante al sistema atacado, como un mecanismo de respaldo para proteger en caso de detecci√≥n y bloqueo de los canales de acceso principales al entorno atacado. <br><br>  <i>Recomendaciones de protecci√≥n:</i> aseg√∫rese de que sus servidores web externos se actualicen regularmente y de que no haya vulnerabilidades conocidas que permitan a los atacantes cargar un archivo o script en el servidor con posterior ejecuci√≥n.  Verifique que los permisos de las cuentas y grupos con derechos de administraci√≥n del servidor no coincidan con las cuentas en la red interna que se pueden usar para iniciar sesi√≥n en el servidor web, iniciar el shell web o anclar al servidor web.  Web Shell es dif√≠cil de detectar porque  no inician conexiones y su lado del servidor puede ser peque√±o e inofensivo, por ejemplo, la versi√≥n PHP del shell de China Chopper Web parece una l√≠nea: <br>  <i>[? php <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">eval</a> ($ _POST ['contrase√±a']);]</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es428602/">https://habr.com/ru/post/es428602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es428590/index.html">Microinteracciones y micro indicaciones en la interfaz</a></li>
<li><a href="../es428592/index.html">Deje de contratar "gerentes efectivos". No solo son in√∫tiles, sino da√±inos</a></li>
<li><a href="../es428596/index.html">Elon Musk despidi√≥ a los gerentes de proyectos de Internet satelital de Starlink debido al incumplimiento de los plazos</a></li>
<li><a href="../es428598/index.html">Redes neuronales profundas para la evaluaci√≥n autom√°tica de llamadas.</a></li>
<li><a href="../es428600/index.html">SSD de efectos especiales o lo que faltaba para la modificaci√≥n: revisi√≥n de la unidad HyperX FURY RGB</a></li>
<li><a href="../es428604/index.html">Campeonato de ciencia de datos en l√≠nea</a></li>
<li><a href="../es428606/index.html">"Comprender c√≥mo funciona el sistema permiti√≥ mucho pirateo": Roy Beniosef sobre el desarrollo de Android</a></li>
<li><a href="../es428608/index.html">Los medios de comunicaci√≥n acordaron con Yandex eliminar materiales pirateados</a></li>
<li><a href="../es428610/index.html">La paradoja del tiempo de espera, o ¬øpor qu√© mi autob√∫s siempre llega tarde?</a></li>
<li><a href="../es428612/index.html">Funciones de orden superior en JavaScript: ¬øqu√© es?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>