<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî¶ üå† üë≤üèª Hacking medidores inteligentes no PHDays 8: an√°lise do concurso MeterH3cker ‚úèÔ∏è üçÇ üé¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este ano, o programa de competi√ß√£o Positive Hack Days foi reabastecido com a competi√ß√£o por elementos de hackers do sistema de rede inteligente - Mete...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hacking medidores inteligentes no PHDays 8: an√°lise do concurso MeterH3cker</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/414557/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/8c1/644/011/8c1644011798aca6c1886a379d7ad93b.png" alt="imagem"></a> <br><br>  Este ano, o programa de competi√ß√£o Positive Hack Days foi reabastecido com a competi√ß√£o por elementos de hackers do sistema de rede inteligente - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MeterH3cker</a> .  Os participantes tinham √† sua disposi√ß√£o um modelo de duas casas, conforme concebido pelos organizadores, pain√©is solares forneciam eletricidade para as casas e a energia excedente que podia ser gerada podia ser vendida √† rede el√©trica em geral a uma taxa especial.  A tarefa dos atacantes era interromper o processo normal de medi√ß√£o de eletricidade e afetar o saldo de caixa no sistema de cobran√ßa por qualquer meio poss√≠vel. <a name="habracut"></a><br><br><h2>  Suporte </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/382/1ab/0ae/3821ab0ae60f54a1581ea05096f5833b.jpg" alt="imagem"><br><br>  <i>Medidor de suporte</i> <br><br>  Casas modernas equipadas com pain√©is solares podem consumir eletricidade e devolver gera√ß√£o em excesso √† rede.  Este modelo formou a base do estande MeterH3cker. <br><br>  O estande era um modelo de dois edif√≠cios residenciais modernos com equipamentos reais, que implementavam elementos da tecnologia de rede inteligente.  Em cada casa, foram instalados controladores solares, medidores inteligentes de eletricidade e consumidores de energia.  Ambas as casas estavam conectadas a um modelo de uma subesta√ß√£o el√©trica na qual um dispositivo de coleta e transmiss√£o de dados (DTD) estava instalado;  entrevistou os medidores e o medidor da subesta√ß√£o. <br><br>  Al√©m disso, cada casa estava equipada com um sistema de aquecimento e ar condicionado, que estava sob o controle geral de um controlador dispon√≠vel na rede geral do estande.  Al√©m disso, perto das casas inteligentes, foi instalada uma esta√ß√£o de carregamento real para ve√≠culos el√©tricos, que transmitia ao USPD indica√ß√µes de seu consumo de eletricidade para o ve√≠culo el√©trico conectado. <br><br>  Estabelecemos os cen√°rios de dia e noite.  No modo "dia", os pain√©is solares nas casas geravam eletricidade, e seus contadores giravam na dire√ß√£o oposta e levavam em conta a energia "consumida" e "fornecida".  Cada casa tinha sua pr√≥pria conta pessoal, cujo saldo aumentou durante a gera√ß√£o de energia e diminuiu durante o consumo, e as tarifas configuradas nos medidores tamb√©m influenciaram os valores. <br><br>  A principal tarefa dos participantes do concurso era aumentar o saldo da conta pessoal das casas, atacando o equipamento do estande e, assim, obter benef√≠cios financeiros diretos de suas a√ß√µes de hackers. <br><br>  Para visualizar os resultados, escrevemos nosso pr√≥prio servidor de cobran√ßa, que coletava dados do USPD.  O pr√≥prio USPD, por sua vez, interrogou os contadores de v√°rias maneiras: <br><br><ol><li>  balc√£o interno n¬∫ 1 - de acordo com o protocolo Modbus do fornecedor aberto; </li><li>  o contador da casa n ¬∞ 2 foi interrogado pelo dispositivo VR-007.3 usando o protocolo Modbus de fornecedor aberto e, em seguida, o USPD recebeu dados do servidor da web VR-007.3 via HTTP; </li><li>  medidor de subesta√ß√£o - de acordo com o protocolo Modbus TCP. </li></ol><br>  Para obter valores reais de consumo de energia, os medidores de refer√™ncia que n√£o estavam dispon√≠veis para os atacantes foram conectados aos mesmos circuitos de corrente e tens√£o dos medidores atacados.  O servidor de cobran√ßa os pesquisou diretamente por meio da interface RS-485. <br><br>  Para permitir que os visitantes do f√≥rum observassem o que estava acontecendo, um grande monitor foi instalado pr√≥ximo ao estande, no qual os gr√°ficos de consumo de eletricidade eram exibidos em tempo real.  O gr√°fico azul marcou as leituras do USPD.  Eles mudaram dependendo das a√ß√µes dos atacantes.  O gr√°fico verde mostrou leituras reais de gera√ß√£o e consumo de eletricidade coletados nos medidores de refer√™ncia. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fed/36b/e9e/fed36be9e3a8837882f01e700cbc60c3.png" alt="imagem"><br><br>  <i>Exibi√ß√£o dos valores atuais de cada casa: saldo da conta pessoal, energia consumida e entregue √† rede, tarifa</i> <br><br>  Um portal interno para os participantes do concurso tamb√©m estava dispon√≠vel na rede do estande.  L√°, os valores atuais dos gr√°ficos foram exibidos, uma se√ß√£o com uma descri√ß√£o de cada elemento do estande;  as regras do concurso eram publicadas l√° e, de tempos em tempos, apareciam dicas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/431/650/9fe/4316509fe0a3694cfd33f28b36bb259a.png" alt="imagem"><br><br>  <i>Portal interno</i> <br><br><h2>  Termos de participa√ß√£o </h2><br>  A competi√ß√£o foi realizada por dois dias.  No primeiro dia houve competi√ß√µes classificat√≥rias.  Ao se conectar √† rede de estandes, cada participante teve acesso a todos os equipamentos de duas casas, uma subesta√ß√£o e uma esta√ß√£o de carregamento.  Os participantes tiveram a oportunidade de estudar equipamentos, encontrar vulnerabilidades e poss√≠veis vetores de ataque.  Durante o dia, novas dicas foram adicionadas periodicamente ao portal interno da competi√ß√£o, permitindo que os participantes detectassem pontos fracos no equipamento do estande.  Os participantes que obtiveram sucesso no estande no primeiro dia foram convidados a participar do torneio final no segundo dia. <br><br>  A final foi uma esp√©cie de duelo.  Dois participantes foram convidados para o estande, cada um com sua pr√≥pria casa.  A tarefa deles √© enganar os contadores por qualquer meio durante uma rodada de dez minutos e gerar mais energia que o inimigo - um vizinho condicional.  O vencedor foi quem teve um saldo maior na conta pessoal no final da competi√ß√£o.  Ao mesmo tempo, a tarefa foi complicada pelo fato de os participantes terem acesso ao equipamento um do outro, o que significa que eles poderiam prejudicar os vizinhos e subestimar seus resultados. <br><br><h2>  Primeiro Dia: Ronda de Qualifica√ß√£o </h2><br>  Havia muitas pessoas que queriam testar seus equipamentos de hackers.  Observe que alguns deles estavam seriamente preparados para a competi√ß√£o e tinham o software necess√°rio.  Entre eles estavam os participantes do Jap√£o, que desde as primeiras horas da competi√ß√£o estudaram cuidadosamente o estande, o que lhes permitiu alcan√ßar resultados significativos no segundo dia. <br><br>  Uma grande surpresa para n√≥s foi a participa√ß√£o de um entusiasta de hackers de 12 anos: apesar de sua idade, ele foi capaz de navegar pelo equipamento apresentado e apresentou v√°rios ataques. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/54e/004/621/54e0046211bf029f7cda68cfdb4e9d1f.jpg" alt="imagem"><br><br>  <i>Participantes</i> <br><br>  Obtivemos os primeiros resultados no meio do dia: pesquisadores japoneses uniram for√ßas para assumir o controle da esta√ß√£o de carregamento de carros el√©tricos e pararam de carregar o carro el√©trico enviando comandos de controle por meio de uma interface da web.  Um pouco mais tarde, eles conseguiram pegar a senha do administrador do controlador solar e desligar a gera√ß√£o de eletricidade. <br><br>  O jovem hacker tamb√©m n√£o ficou atr√°s dos adultos: ele aprendeu a causar uma reinicializa√ß√£o cont√≠nua do USPD, implementando um ataque de nega√ß√£o de servi√ßo e interrompendo a pesquisa de contadores. <br><br>  √Ä noite, um dos membros do grupo japon√™s alcan√ßou s√©rios desvios entre os valores de energia nos balc√µes de refer√™ncia e atacados, aumentando bastante o valor da contagem.  E seu colega descobriu uma vulnerabilidade na interface da web do contador da subesta√ß√£o, que permitia a leitura do conte√∫do dos arquivos do cart√£o flash do dispositivo, um dos quais continha um hash de senha de administrador.  Assim, ap√≥s selecionar com √™xito uma senha, ele obteve acesso aos par√¢metros do contador. <br><br>  Uma hora antes do final da rodada de qualifica√ß√£o, um participante chamado Oleg entrou no estande.  Apesar de ter pouco tempo, ele conseguiu realizar um ataque bem-sucedido e entrar no torneio, que foi realizado no dia seguinte. <br><br>  Como resultado, at√© o final do dia, todos os participantes poderiam alterar as leituras de energia em todos os medidores el√©tricos dispon√≠veis e controlar v√°rios elementos dos controladores de posi√ß√£o, uma esta√ß√£o de carregamento. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8c1/644/011/8c1644011798aca6c1886a379d7ad93b.png" alt="imagem"><br><br>  <i>Resultados dos ataques dos participantes aos contadores.</i>  <i>O gr√°fico inferior direito mostra que o coeficiente de transforma√ß√£o de contador foi alterado e o inferior esquerdo mostra que um ataque de nega√ß√£o de servi√ßo foi realizado com √™xito no contador -4</i> <br><br><h2>  Dia Dois: Torneio e Final </h2><br>  Com base nos resultados dos relat√≥rios enviados pelos participantes no final do primeiro dia, selecionamos sete participantes capazes de encontrar e explorar vulnerabilidades nos equipamentos do estande. <br><br>  Como no segundo dia, os participantes durante as rodadas podem influenciar as leituras n√£o apenas de seus contadores, mas tamb√©m do contador do vizinho rival, qualquer neglig√™ncia pode trazer s√©rias conseq√º√™ncias.  Assim, o participante Oleg, conduzindo um ataque ao equipamento de um vizinho, aumentou erroneamente a pontua√ß√£o do vizinho, porque ele executou o ataque no momento da gera√ß√£o e, em seguida, n√£o conseguiu "torcer" ele na outra dire√ß√£o pelo tempo restante da rodada.  Nas brigas subseq√ºentes, os participantes levaram em conta essa triste experi√™ncia e agiram com compet√™ncia, por exemplo, definiram os valores m√°ximos dos coeficientes de seu contador durante o per√≠odo de gera√ß√£o (modo "dia") e o m√≠nimo durante o per√≠odo de consumo (modo "noturno"). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb7/5f0/43d/cb75f043da8d96831ba77d47ab75f569.png" alt="imagem"><br><br>  <i>Classifica√ß√£o</i> <br><br>  Uma batalha s√©ria se desenrolou na final da competi√ß√£o.  No in√≠cio da rodada, a vantagem era para Satoru Takeksoshi, que nos primeiros minutos foi capaz de realizar o ataque com sucesso e aumentar bastante o saldo de sua conta.  O segundo participante - Alexey Kuznetsov - tamb√©m foi capaz de realizar um ataque no in√≠cio da rodada e aumentar o saldo de sua conta, mas em uma quantidade muito menor.  A diferen√ßa nas leituras de energia gerada foi de 25 GW ¬∑ h contra 5 GW ¬∑ h.  Na maior parte da rodada, a pontua√ß√£o n√£o mudou.  Provavelmente, para n√£o repetir a triste experi√™ncia dos primeiros participantes que atacaram na hora errada, Alex se comportou com cautela e acompanhou a mudan√ßa de regime.  Na segunda metade da rodada, ele conseguiu realizar um ataque bem-sucedido ao medidor da subesta√ß√£o el√©trica e tornar a separa√ß√£o do vizinho m√≠nima, mas a pontua√ß√£o total ainda n√£o lhe permitiu vencer.  Nos √∫ltimos segundos, Alex novamente atacou seu contador e aumentou com sucesso seu testemunho, o que lhe permitiu obter a vit√≥ria do l√≠der.  Assim, Alexey venceu, aumentando seu saldo para 92 bilh√µes.  e., e dado seu ataque bem-sucedido ao medidor da subesta√ß√£o el√©trica, sua pontua√ß√£o total permitiu que ele vencesse incondicionalmente. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dad/440/f0e/dad440f0ec1b6875c49671dc3a8e2dd0.png" alt="imagem"><br><br>  <i>O estado das contas pessoais nos √∫ltimos segundos ap√≥s o ataque final</i> <br><br><h2>  Sum√°rio </h2><br>  Assim, os vencedores: o primeiro lugar foi conquistado por Alexei Kuznetsov, o segundo lugar foi para Satoru Takekoshi, Nikita Stupin fechou os tr√™s primeiros.  O pr√™mio especial, pelo 4¬∫ lugar, foi recebido pelo jovem cracker Yuri Grishin. <br><br>  Durante a competi√ß√£o (especialmente no torneio final), ataques completamente diferentes foram demonstrados.  A maioria dos participantes tentou realizar ataques √†s leituras de energia obtidas dos medidores, aumentar a produ√ß√£o de energia no momento da gera√ß√£o e reduzir no momento do consumo.  Al√©m disso, em algumas rodadas, os competidores atacaram com sucesso a esta√ß√£o de carregamento do carro el√©trico e do controlador solar. <br><br>  No entanto, nenhum dos participantes foi capaz de realizar ataques bem-sucedidos no USPD e substituir os dados coletados diretamente nele.  Potencialmente, esses ataques podem levar ao controle completo dos dados transmitidos ao centro de cobran√ßa e aumentar sua conta por um valor arbitr√°rio.  Nos dois dias, registramos apenas uma tentativa de ataque que, aparentemente, terminou em fracasso. <br><br>  Al√©m disso, ningu√©m atacou o controlador que controla o sistema de aquecimento e ar condicionado.  Supunha-se que o invasor se conectasse ao dispositivo e pudesse controlar o equipamento usando os sinais de controle existentes.  A principal dificuldade para os atacantes foi comparar as portas abertas e o nome do equipamento, por exemplo, solicitar informa√ß√µes usando o protocolo FOX.  N√£o era necess√°rio usar software especializado para atacar este equipamento.  A dica tamb√©m n√£o ajudou, porque os atacantes n√£o a usaram, e tudo o que era necess√°rio era substituir o cabe√ßalho User-Agent no navegador para uma conex√£o bem-sucedida. <br><br>  De outras observa√ß√µes.  Durante a competi√ß√£o, os participantes fizeram muitas perguntas esclarecedoras sobre a estrutura e opera√ß√£o do estande, bem como sobre os dispositivos dispon√≠veis.  Isso pode ser explicado pelo fato de que, al√©m da tarefa de "quebrar" os dispositivos, era necess√°rio descobrir o que cada um deles faz e como explorar suas vulnerabilidades para obter lucro. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f8b/033/579/f8b033579fb97d33b1f448e3175a1217.jpg" alt="imagem"><br><br>  <i>A altura do primeiro dia</i> <br><br>  Ficamos satisfeitos que, embora nossa competi√ß√£o seja uma novidade no f√≥rum, muitos espectadores vieram que n√£o estavam participando, mas estavam interessados ‚Äã‚Äãno trabalho do estande, no sucesso dos participantes.  Os otomanos livres na frente do estande terminaram rapidamente! <br><br>  Outro fato interessante est√° associado aos participantes do Jap√£o.  O portal interno da competi√ß√£o e a documenta√ß√£o dos dispositivos dos fabricantes nacionais estavam em russo, no entanto, isso n√£o se tornou um obst√°culo para a equipe japonesa - havia habilidades pr√°ticas suficientes para demonstrar uma s√©rie de ataques bem-sucedidos.  No entanto, ap√≥s a competi√ß√£o, eles admitiram que isso lhes causava um pequeno inconveniente. <br><br>  Em geral, a competi√ß√£o mostrou que em menos de dois dias √© bem poss√≠vel entender os modernos sistemas de medi√ß√£o de eletricidade e realizar ataques bem-sucedidos. <br><br><h2>  An√°lise de outros concursos Positive Hack Days 8: </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Concurso CAMBreaker: como as c√¢meras de seguran√ßa foram atacadas</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HackBattle 2.0: como a ICO da lanchonete da escola foi atacada</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sair do concurso ATM Alone no PHDays 8</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">An√°lise da competi√ß√£o "intelig√™ncia competitiva"</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt414557/">https://habr.com/ru/post/pt414557/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt414541/index.html">Otimiza√ß√£o do aplicativo node.js.</a></li>
<li><a href="../pt414547/index.html">Planejamento de infraestrutura para recupera√ß√£o instant√¢nea de m√°quinas virtuais Recupera√ß√£o instant√¢nea de VM: parte 2</a></li>
<li><a href="../pt414549/index.html">3.000 olhos para intelig√™ncia artificial. Qual √© o sistema de monitoramento de estrutura do Centro de Lakhta?</a></li>
<li><a href="../pt414551/index.html">Instru√ß√µes para admiss√£o de doutorado nos EUA</a></li>
<li><a href="../pt414555/index.html">Como transferimos 36 milh√µes de clientes para um servi√ßo de suporte t√©cnico digital</a></li>
<li><a href="../pt414561/index.html">Escola francesa de videogame: outro mundo</a></li>
<li><a href="../pt414563/index.html">O que s√£o testes de componentes e como √© ser um SDET</a></li>
<li><a href="../pt414565/index.html">L√¢mpada para m√≥veis, cozinha ou banheiro</a></li>
<li><a href="../pt414567/index.html">An√∫ncio do RamblerFront & # 5</a></li>
<li><a href="../pt414569/index.html">Recifes de coral guardam segredos do passado e do futuro dos oceanos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>