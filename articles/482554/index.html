<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ûñ üé† üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø Casa inteligente con Xiaomi en el ejemplo de un ba√±o ü•® üë©üèª‚Äçü§ù‚Äçüë®üèø üêÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En Internet hay bastantes rese√±as y videos sobre la construcci√≥n de hogares inteligentes. Existe la opini√≥n de que todo esto es bastante costoso y pro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Casa inteligente con Xiaomi en el ejemplo de un ba√±o</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/plesk/blog/482554/"> En Internet hay bastantes rese√±as y videos sobre la construcci√≥n de hogares inteligentes.  Existe la opini√≥n de que todo esto es bastante costoso y problem√°tico en la organizaci√≥n, es decir, en general, la gran cantidad de geeks.  Pero el progreso no se detiene.  Los dispositivos se est√°n volviendo m√°s baratos, mientras que m√°s funcionales, y el dise√±o y la instalaci√≥n son bastante simples.  Sin embargo, b√°sicamente, las revisiones se centran en 1-2 ejemplos de uso, pr√°cticamente sin cubrir los matices y sin crear una imagen hol√≠stica.  Por lo tanto, en este art√≠culo quiero revisar el proyecto completado, demostrar los escenarios de uso y las dificultades en la construcci√≥n de una casa inteligente utilizando dispositivos Xiaomi con el ejemplo de un ba√±o.  Las ideas descritas con ligeras variaciones se pueden aplicar a la automatizaci√≥n del apartamento. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9h/lb/tj/9hlbtjf6rdghf--lzwsq-5bysk8.jpeg" alt="imagen" width="400" height="400"></div><br><a name="habracut"></a><br><h2>  Antecedentes o por qu√© todo esto es necesario </h2><br>  Para empezar, un poco de historia para aclarar el contexto.  A principios del oto√±o de 2018, se termin√≥ el ba√±o y se puso en funcionamiento.  La casa de ba√±os es un edificio capital aut√≥nomo con calefacci√≥n y suministro de agua durante todo el a√±o. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ns/wd/o5/nswdo5svyprgue1sgxhojmb83kk.jpeg" alt="imagen"></div><br>  Por razones obvias, nadie vive constantemente en la casa de ba√±os y no controla el estado de las instalaciones.  Por mucho que quisiera, una visita al ba√±o tampoco es un evento muy frecuente.  En consecuencia, las ideas sobre la creaci√≥n de un ba√±o "inteligente" estuvieron presentes desde el comienzo del proyecto.  En primer lugar, por razones de seguridad (incendio, inundaci√≥n, control de acceso).  Por ejemplo, apagar la calefacci√≥n a -35 grados en la calle (vivo en Novosibirsk) es una situaci√≥n muy peligrosa.  Sin embargo, a diferencia de la casa principal, no pens√© en el proyecto de automatizaci√≥n del ba√±o desde el principio y no hice cableado adicional en los lugares correctos.  Por otro lado, Internet se llev√≥ a cabo en la casa de ba√±os, y se est√° llevando a cabo una videovigilancia para la aparici√≥n de otros dos edificios (puede evaluar lo que est√° sucediendo visualmente). <br><br>  Al regresar de un viaje de negocios en noviembre de 2019, por la noche fui a la casa de ba√±os, abr√≠ la puerta principal y me sorprendi√≥ lo que vi.  Los LED del punto WiFi parpadearon desde la oscuridad y una corriente de agua brot√≥ a mis pies.  Es decir, se produjeron inundaciones, mientras que la electricidad no se apag√≥.  El agua en la casa de ba√±os se organiza utilizando su propio pozo, bomba sumergible y automatizaci√≥n que controla el proceso.  Al final result√≥ que, uno de los accesorios en el intercambio en el inodoro se interrumpi√≥ e inund√≥ todas las habitaciones.  Nunca supe por qu√© la automatizaci√≥n se compadeci√≥ y todav√≠a se apag√≥, pero logr√≥ bombear 15 cm de agua en 30 cuadrados.  En la calle ese d√≠a fue -14 grados.  El piso c√°lido se sobrepuso, continuando manteniendo la temperatura ambiente al nivel adecuado, pero apareci√≥ un 100% de humedad.  Era imposible postergar a√∫n m√°s la organizaci√≥n de una casa inteligente: debe comenzar a hacerlo. <br><br><h2>  Selecci√≥n de equipamiento </h2><br>  Durante la construcci√≥n de la casa principal, gan√© experiencia trabajando con dispositivos <a href="https://eldesalarms.com/">Eldes</a> (se cre√≥ el cableado correspondiente).  Parte de la automatizaci√≥n se realiza en <a href="https://www.raspberrypi.org/">Raspberry PI</a> .  Otra parte est√° en los <a href="https://www.aqara.com/en/home.html">dispositivos Xiaomi Aqara</a> .  La opci√≥n con Raspberry PI fue la m√°s atractiva para m√≠ e inicialmente se consider√≥ para la casa de ba√±os.  Pero, desafortunadamente, requiere significativamente m√°s esfuerzos de organizaci√≥n.  Este todav√≠a no es un dispositivo plug-and-play: comienza con ejercicios con hardware y termina con un software de escritura para sus propias necesidades.  Por ciertas razones, <a href="https://mjdm.ru/">MajorDoMo</a> no <a href="https://mjdm.ru/">estaba</a> contento.  Cruzar Raspberry PI, el adaptador ZigBee (para usar sensores inal√°mbricos Xiaomi) y Apple HomeKit requieren estudio (y la interfaz de Apple HomeKit no es muy feliz en este momento).  No hubo mucho tiempo (no quer√≠a repetir la situaci√≥n), y no hab√≠a cableado para cada punto deseado, as√≠ que decid√≠ hacer todo en los dispositivos Xiaomi. <br><br>  El dispositivo principal en esta situaci√≥n es el hub.  En el caso de Xiaomi, hay dos opciones para el hub: Xiaomi Mi Smart Home Gateway 2 y Xiaomi Aqara Gateway.  Este √∫ltimo es aproximadamente dos veces m√°s caro, m√°s adecuado para el mercado local y puede integrar dispositivos en Apple HomeKit.  Sin embargo, si instala la aplicaci√≥n Aqara Home y selecciona la regi√≥n "Rusia", al momento de escribir estas l√≠neas, solo estar√°n disponibles 13 dispositivos diferentes (interruptores, enchufes, sensores).  Si instala la aplicaci√≥n Xiaomi Home, seleccione la regi√≥n "China continental", luego cientos de dispositivos estar√°n disponibles para la conexi√≥n.  Sin embargo, si selecciona la regi√≥n "China continental", no podr√° conectar una toma de corriente europea y viceversa.  La selecci√≥n de la regi√≥n "China continental" como parte de la aplicaci√≥n Aqara Home no proporciona la integridad de los dispositivos que est√°n presentes en Xiaomi Home con la misma regi√≥n.  Por miedo a la incompatibilidad, decid√≠ parar en el centro Xiaomi Mi Smart Home Gateway 2. El precio de emisi√≥n es de aproximadamente 2000 p.  Por cierto, el centro mismo act√∫a como una l√°mpara, esto se puede tener en cuenta durante la instalaci√≥n. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vs/ul/kx/vsulkxlnghjjindbwwmxw9aemxq.jpeg" alt="imagen"></div><br>  Otra pregunta interesante es cu√°nto tiempo funcionar√° esto.  Ni siquiera se trata de sensores y bater√≠as, sino de sincronizaci√≥n y almacenamiento de datos en la nube.  La cuenta es actualmente gratuita.  Toda la informaci√≥n se almacena en los servidores de Xiaomi.  Si ma√±ana los chicos deciden que los usuarios de Rusia no deber√≠an almacenar datos en la regi√≥n de "China continental" o si Roskomnadzor proh√≠be sus servidores por alguna raz√≥n, entonces toda la casa inteligente corre el riesgo de convertirse en una calabaza.  Decid√≠ por m√≠ mismo que en este caso los sensores permanecer√°n, y el concentrador ser√° reemplazado por el adaptador Raspberri PI + ZigBee. <br><br><h2>  Control y prevenci√≥n de fugas. </h2><br>  El primer y m√°s importante escenario de automatizaci√≥n fue una continuaci√≥n natural del problema: con una fuga, debe cerrar el suministro de agua, es decir, la bomba, y enviar una notificaci√≥n sobre el problema al tel√©fono.  Hab√≠a dos lugares potencialmente peligrosos para la aparici√≥n de fugas. <br><br>  Adem√°s del concentrador para este escenario, se necesitaban dos sensores de fugas y un enchufe inteligente montado en la pared.  El precio del sensor de fugas es de aproximadamente 1400 r.  El precio de una toma de corriente inteligente es de aproximadamente 1700 p.  Los sensores de fugas son aut√≥nomos, funcionan con bater√≠as.  El fabricante afirma que una bater√≠a es suficiente para 2 a√±os. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bt/d3/q2/btd3q2gftpvfsf_drdszmsisfwm.jpeg" alt="imagen"></div><br>  La instalaci√≥n de una salida inteligente fue un poco complicada porque se necesitan enchufes cuadrados para las salidas chinas, que no se venden en nuestras tiendas habituales (pero se pueden pedir).  Perforar agujeros cuadrados sigue siendo un placer.  Adem√°s, en el buen sentido, necesita un adaptador, aunque tambi√©n hay una salida para un enchufe europeo.  En la versi√≥n de Aqara para el mercado local, actualmente no hay una salida de pared para el montaje en la pared, lo que nos une a la regi√≥n de "China continental".  Alternativamente, puede instalar un tomacorriente ordinario, enchufar un tomacorriente inteligente con un enchufe de Xiaomi, pero esto requerir√≠a dos adaptadores adicionales.  Otra alternativa es un relevo.  Pero me instal√© en un enchufe montado en la pared. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qe/rg/pg/qergpgrjkaqqosy5xr2pqc_hli8.jpeg" alt="imagen"></div><br>  En la aplicaci√≥n Xiaomi Home, se han agregado un z√≥calo y un sensor.  A continuaci√≥n, el escenario "en caso de fuga" se prescribe para dos acciones: apague el tomacorriente y env√≠e una alerta. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p7/pj/ub/p7pjubzhpjzb6tt_aoxrdd20_fs.jpeg" alt="imagen"></div><br>  El primer sensor de fugas se instal√≥ al lado de la bomba (y, de hecho, al lado del cubo).  Para la prueba, se verti√≥ agua en un plato peque√±o y se baj√≥ el sensor.  Realic√© toda la acci√≥n directamente en el sitio de instalaci√≥n del sensor para acercar la situaci√≥n lo m√°s posible a la realidad.  La prueba fue exitosa: el z√≥calo se apag√≥, la notificaci√≥n lleg√≥ al tel√©fono y el concentrador parpade√≥ en modo de emergencia. <br><br>  Se plane√≥ instalar el segundo detector de fugas en el inodoro junto al intercambio de tuber√≠as.  Pero con su instalaci√≥n, surgieron matices: el concentrador no vio el sensor, aunque la distancia era peque√±a.  El motivo es la configuraci√≥n de los locales. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ce/33/gb/ce33gbivdrkzwq2f4t-vghi69ki.jpeg" alt="imagen"></div><br>  Hab√≠a una sala de vapor entre el sitio de instalaci√≥n del centro (sala de relajaci√≥n) y el sitio de instalaci√≥n del segundo sensor de fugas (inodoro).  La sala de vapor, en las mejores tradiciones, se cose en el c√≠rculo con papel de aluminio, creando problemas con el paso de la se√±al. <br><br>  El fabricante afirma que los dispositivos pueden formar una red de malla, es decir, un dispositivo puede transmitir datos al concentrador a trav√©s de otro dispositivo.  En alg√∫n lugar encontr√© informaci√≥n de que solo los dispositivos conectados a la red (y no con bater√≠as) pueden actuar como tales transmisores en una red de malla.  Sin embargo, fue suficiente para m√≠ instalar un sensor de temperatura en la esquina del ba√±o para que la se√±al del sensor de fugas dejara de desaparecer.  Tal vez esto sea una coincidencia, porque m√°s tarde en el ba√±o debajo del techo se mont√≥ un rel√© para controlar la luz de la calle (tal vez act√∫a como un transmisor en la red de malla).  Sin embargo, el problema con la p√©rdida de se√±al del sensor de fugas en el inodoro se ha resuelto.  Adem√°s, puede verificar la conexi√≥n del dispositivo con el concentrador haciendo clic en el sensor en el centro.  Si todo est√° bien, entonces, en chino puro, la informaci√≥n relevante sonar√° desde el hub (en el caso del hub Aqara, la comunicaci√≥n ser√° en ingl√©s agradable). <br><br>  Verificando el apagado y luego encendiendo la electricidad usando la m√°quina mostr√≥ que el enchufe inteligente entra en estado apagado.  Para que cambie al estado encendido cuando aparece la electricidad, hay una configuraci√≥n correspondiente: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7m/mp/rv/7mmprvrfrwirqrveigp5hk5rbna.jpeg" alt="imagen"></div><br>  Una se√±al adicional de la inundaci√≥n de la habitaci√≥n fue un aumento de la humedad de hasta el 100%.  Sobre el control de este s√≠ntoma, en la siguiente secci√≥n. <br><br><h2>  Control de humo y temperatura. </h2><br>  La casa de ba√±os es una sala de peligro de incendio, por lo que el siguiente escenario fue identificar signos de incendio. <br><br>  Para este escenario, se necesitaban dos sensores de temperatura (y humedad) y un sensor de humo.  El precio del sensor de temperatura es de aproximadamente 1000 r.  El detector de humo cuesta alrededor de 2000 p.  En la versi√≥n de Aqara para la regi√≥n local, actualmente no hay un detector de humo, lo que nuevamente nos vincula a la regi√≥n de "China continental". <br><br>  El detector de humo estaba montado en el techo del corredor en la sala de lavado (en realidad no lejos de la estufa y la salida de la sala de vapor).  Luego, en la aplicaci√≥n Xiaomi Home, se agreg√≥ un dispositivo y se cre√≥ un escenario de "en caso de detecci√≥n de humo", seguido de enviar una notificaci√≥n al tel√©fono.  La prueba fue realizada por una repisa de la chimenea.  El sensor complet√≥ con √©xito la prueba.  El centro parpade√≥ con una alarma, adem√°s funcion√≥ una alerta audible.  El sensor en s√≠ tambi√©n era muy vil y un fuerte pitido, advirtiendo sobre el problema. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zg/ej/jg/zgejjg01wv9ayueq8tzptcumzs8.jpeg" alt="imagen"></div><br>  Otro signo de fuego es un aumento de la temperatura.  Para controlar la temperatura, se instalaron dos sensores: uno en el ba√±o y el otro en el ba√±o.  Luego, en la aplicaci√≥n, el escenario "en el caso de una temperatura superior a la establecida" se configur√≥ con la notificaci√≥n correspondiente al tel√©fono.  Por el momento, establec√≠ el umbral para la sala de relajaci√≥n en 30 grados (en el verano, probablemente, tendr√© que volver a configurarlo). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/0w/pj/nq0wpjrfwe3nsl6hfpnjxwsuzhq.jpeg" alt="imagen"></div><br>  Adem√°s, el escenario se configur√≥ "en el caso de una temperatura por debajo del conjunto" con un umbral de 18 grados y alertas al tel√©fono.  Si por alguna raz√≥n la calefacci√≥n deja de funcionar, me gustar√≠a saberlo lo antes posible.  Del mismo modo, los escenarios "en el caso de aumento de la humedad" se crearon para ambos sensores con un umbral del 70%, una alerta al tel√©fono y un apagado de la bomba de suministro de agua. <br><br>  De las bonificaciones agradables para los sensores de temperatura y humedad, los gr√°ficos hist√≥ricos est√°n disponibles en la aplicaci√≥n.  Puede, por ejemplo, determinar en qu√© momentos se us√≥ el ba√±o para su prop√≥sito previsto (picos de temperatura en el gr√°fico a continuaci√≥n) o comparar si la temperatura actual es anormal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cf/tb/av/cftbaviejmlpp8nndfwizm6un60.jpeg" alt="imagen"></div><br><br><h2>  Control de ventilaci√≥n </h2><br>  Un extracto forzado de las instalaciones se organiza en la sala de vapor.  Despu√©s de completar los procedimientos, es aconsejable ventilar la habitaci√≥n.  La ventilaci√≥n fue activada por un interruptor de llave, y la ventilaci√≥n en s√≠ misma necesita al menos 30 minutos, sin embargo, a menudo las reuniones en la casa de ba√±os terminan en la primera o segunda hora de la noche.  No siempre es posible hacer todo con anticipaci√≥n, y sentarse al final durante 30 minutos adicionales y esperar hasta que la sala de vapor est√© ventilada es un placer por debajo del promedio porque ya desea dormir. <br><br>  Para este escenario, necesit√°bamos un interruptor de llave de Xiaomi con una l√≠nea cero y montaje en la pared.  El precio de la emisi√≥n es de aproximadamente 1900 p.  Los interruptores est√°n disponibles en la versi√≥n Aqara para el mercado local. <br><br>  En mi caso, es imposible simplemente reemplazar un interruptor convencional por uno inteligente: se requiere una l√≠nea de alimentaci√≥n.  En consecuencia, tuve que estirar la l√≠nea cero hasta el orificio de montaje para el interruptor, ya que hab√≠a una gran oportunidad.  En el caso de un interruptor sin una l√≠nea cero, la instalaci√≥n ser√≠a m√°s f√°cil. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q0/k2/p-/q0k2p-qvozvt_zk3e-i407jprhk.jpeg" alt="imagen"></div><br>  Despu√©s de la instalaci√≥n, se agreg√≥ un interruptor inteligente a la aplicaci√≥n como dispositivo y se prob√≥ su rendimiento.  Hay un temporizador en la configuraci√≥n del interruptor, y puede configurar el tiempo para apagar.  Es decir, ahora, antes de salir del ba√±o, el temporizador de apagado est√° configurado para 30 minutos adicionales de ventilaci√≥n, y puede irse a dormir con seguridad. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9e/4c/5g/9e4c5gckmsp0dsiekxkbvhk5imk.jpeg" alt="imagen"></div><br>  Es posible una opci√≥n m√°s de automatizaci√≥n de procesos.  Despu√©s del ba√±o, adem√°s de la ventilaci√≥n, la puerta de la sala de vapor se abre por completo.  Esto conduce a un aumento de la temperatura en la sala de lavado, donde est√° instalado un sensor de temperatura.  Seg√∫n las lecturas de este sensor, puede crear escenarios de ventilaci√≥n con./desc.  Pero todav√≠a no he ejecutado esta opci√≥n.  Adem√°s, se podr√≠a experimentar con un sensor de puerta abierta de la sala de vapor.  Pero me temo que morir√° o se caer√° r√°pidamente, ya que la puerta est√° hecha de vidrio y en la sala de vapor tambi√©n puede estar a 120 grados. <br><br><h2>  Control de la luz de la calle </h2><br>  Otra tarea que quer√≠a automatizar era controlar la farola en la veranda.  Uno de los escenarios t√≠picos: enciende la luz de la terraza cuando est√©s cerca del edificio y oscurece afuera.  El ba√±o est√° cerrado, el interruptor de la luz de la calle est√° ubicado en el interior.  Tuve que ir tras la llave para abrir la puerta y encender la luz.  Apagar las luces requiri√≥ un procedimiento similar.  Otro escenario que surgi√≥ regularmente: enciende o apaga la luz de la terraza cuando est√°s en la casa principal.  Muy a menudo, al salir de la casa de ba√±os, olvid√© apagar la luz de la terraza y encontr√© esto cuando estaba en la casa: mirando por la ventana o mirando las c√°maras de vigilancia.  En este momento, la renuencia no suele ir a ning√∫n lado, por lo que la luz continu√≥ ardiendo toda la noche. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cc/tg/ex/cctgexbilx-hsr-tomjp9cs0gl8.jpeg" alt="imagen"></div><br>  Para implementar esta idea, se compr√≥ un rel√© de dos canales.  El precio de la emisi√≥n es de aproximadamente 2000 p.  Actualmente, faltan los rel√©s en la versi√≥n Aqara para el mercado local.  Pero se puede reemplazar con un interruptor de llave (est√° claro que instalarlo en una caja de distribuci√≥n es un proceso m√°s problem√°tico). <br><br>  Inicialmente, ten√≠a la intenci√≥n de montar el rel√© detr√°s del interruptor de llave, sin embargo, result√≥ ser muy problem√°tico tirar de la l√≠nea de alimentaci√≥n al lugar correcto (nuevamente, el rel√© necesita energ√≠a).  Un lugar ideal es una caja de conexiones donde convergen la l√≠nea de alimentaci√≥n, la l√≠nea del interruptor y la l√≠nea de las farolas.  Estaba bajo un falso techo, lo que condujo al desmantelamiento de varios rieles de revestimiento.  Era aconsejable pensar sobre este punto de antemano.  Sin embargo, la instalaci√≥n se complet√≥ con √©xito.  El diagrama de cableado es mucho m√°s complicado que para enchufes e interruptores (en mi caso, cuatro cables de 3 hilos y 8 terminales en el rel√©).  Para no tener en cuenta y no confundir nada, dibuj√© un diagrama en una hoja de papel antes de montarlo.  Luego hice una instalaci√≥n de prueba para verificar todo: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bz/n5/gd/bzn5gdba_obeh-ja73lxl2fdvjc.jpeg" alt="imagen"></div><br>  El dispositivo se conect√≥ en la aplicaci√≥n y la etapa de prueba ha comenzado.  Se supon√≠a que la luz de la calle deb√≠a encenderse / apagarse como un interruptor de llave existente anteriormente, y usar la aplicaci√≥n.  Hay dos luces en la calle: una a la izquierda y otra a la derecha.  El rel√© tiene dos canales, pero no ten√≠a sentido encenderlos por separado.  Por otro lado, no quer√≠a incluirlos a su vez con dos clics en la aplicaci√≥n.  Por lo tanto, el control se realiz√≥ en un canal de retransmisi√≥n.  Por una extra√±a coincidencia, esta opci√≥n no funcion√≥ con normalidad: se qued√≥ en una u otra posici√≥n.  Ya no quedaba mucho tiempo para los experimentos, ya que la luz del d√≠a termin√≥ y quise armar el revestimiento en el techo.  Por lo tanto, capt√© las luces en paralelo en ambos canales y todo funcion√≥ como quer√≠a.  Para que los interruptores f√≠sicos y de software funcionen como transferencias, la opci√≥n Interbloqueo se activ√≥ en la configuraci√≥n del rel√©. <br><br>  Tambi√©n ser√≠a posible organizar la luz del temporizador de encendido / apagado.  Pero este escenario a√∫n no ha estado interesado. <br><br><h2>  Control de acceso </h2><br>  Otro momento curioso fue el control sobre la apertura de la puerta de la calle.  En primer lugar, para determinar y notificar que alguien olvid√≥ cerrar esta puerta normalmente o por completo la dej√≥ abierta. <br><br>  Para este escenario, se necesitaba un sensor de apertura de ventana / puerta.  El precio de emisi√≥n es de aproximadamente 1000 r.  Hay sensores fabricados por Aqara para el mercado local (tienen bordes menos redondeados). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pb/fy/id/pbfyidivjmpgggpxrwxowgeq-h8.jpeg" alt="imagen"></div><br>  La instalaci√≥n es muy simple: los sensores est√°n montados en cinta de doble cara.  Antes del montaje, es mejor conectar el sensor en la aplicaci√≥n para ver a qu√© distancia se produce la operaci√≥n.  Las instrucciones escriben sobre un espacio de hasta 20 mm, pero esto, por decirlo suavemente, no es cierto: el sensor y el im√°n de respuesta deben montarse casi al ras.  En la casa principal, se instala un sensor similar en la puerta del garaje.  Entre la gu√≠a y el collar hay una goma de sellado con un ancho de 1 cm. A esta distancia, el sensor mostr√≥ la posici√≥n "abierta" y tuvo que aumentar el im√°n de respuesta. <br><br>  Despu√©s de agregar un nuevo dispositivo a la aplicaci√≥n, puede proceder a la automatizaci√≥n.  Configuramos el escenario "si la puerta est√° abierta durante m√°s de 1 minuto" con una notificaci√≥n al tel√©fono.  En la localizaci√≥n en ingl√©s, parte de la frase aproximadamente 1 minuto no es visible, pero el umbral de respuesta es solo eso.  En las aplicaciones Aqara sensor y Aqara Home, se pueden configurar otros intervalos de activaci√≥n.  Desafortunadamente, esto a√∫n no se puede hacer dentro de la aplicaci√≥n Xiaomi Home.  Pero la pr√°ctica ha demostrado que un intervalo de 1 minuto es m√°s que suficiente: no hay falsos positivos, todos los positivos estaban en el caso.  Tambi√©n puede mirar los registros por sensores.  Este sensor no es una excepci√≥n.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es posible, por ejemplo, determinar por registro cu√°ndo lleg√≥ la casa de ba√±os (la primera puerta se abri√≥ ese d√≠a) y cu√°ndo se fue (el √∫ltimo cierre de la puerta), estimando as√≠ el tiempo total que pas√≥ en la habitaci√≥n. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wk/uv/ry/wkuvryxsyoah4u-7dwoj0yct9a4.jpeg" alt="imagen"></div><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Impresiones operativas </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La experiencia operativa general es puramente positiva. </font><font style="vertical-align: inherit;">Por supuesto, hay algunos matices menores, pero se ha logrado el objetivo principal de la automatizaci√≥n. </font><font style="vertical-align: inherit;">En primer lugar, esta es la calma psicol√≥gica, confirmada por los resultados de las pruebas. </font><font style="vertical-align: inherit;">La comodidad tambi√©n es importante: control remoto del alumbrado p√∫blico, se obtuvo una campana extractora, apareci√≥ una l√°mpara nocturna adicional. </font><font style="vertical-align: inherit;">Despu√©s de irse de vacaciones, puede recordar y cerrar el agua de forma remota. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A continuaci√≥n se detallan los costos de todos los dispositivos anteriores en forma aproximada (sin referencia a una tienda en particular). </font><font style="vertical-align: inherit;">Al realizar el pedido en AliExpress, los precios diferir√°n en una direcci√≥n m√°s peque√±a.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i9/ij/pf/i9ijpffhxd2i-jaq00ieo58eupo.png" alt="imagen"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al elegir un conjunto de equipos, es necesario tener en cuenta la compatibilidad (para qu√© regi√≥n en particular se fabric√≥ este equipo y a qu√© familia pertenece). Dentro del marco de la aplicaci√≥n, no ser√° posible crear un escenario que, por ejemplo, por el evento detector de humo (para la regi√≥n "China continental") controle la salida de la regi√≥n europea. Si no necesita un detector de humo de tipo ex√≥tico, es mejor mirar los dispositivos Aqara para el mercado local. Al final, el rel√© se puede reemplazar, por ejemplo, con un interruptor de dos teclas. Varias tiendas que venden dispositivos Xiaomi aparentemente los importan en gris (estos dispositivos est√°n dise√±ados para la regi√≥n china). Pero, por ejemplo, el Messenger, dispositivos afortunados dise√±ados para nuestro mercado. Adem√°s de la compatibilidad de los mismos puntos de venta, tambi√©n contendr√°n instrucciones en ingl√©s y ruso. A continuaci√≥n se muestra una foto de dos sensores id√©nticos,pero para diferentes regiones (chino interno - a la izquierda y europeo externo - a la derecha):</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uw/ph/x_/uwphx_titz3r1-hhwlduqxmzlwg.jpeg" alt="imagen"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La capacidad de respuesta del control a trav√©s de la aplicaci√≥n no siempre es buena. Por ejemplo, a veces puede encontrar una situaci√≥n que, una y otra vez, en lugar de encender la luz, se produce un error en el esp√≠ritu de "solicitud fallida". El tratamiento identificado experimentalmente, que descarga la aplicaci√≥n de la memoria y lo reinicia, resuelve este problema m√°s r√°pido que esperar una respuesta en el pr√≥ximo intento. Adem√°s, a veces hay retrasos notables (hasta 20-30 segundos) con la actualizaci√≥n del estado de un sensor. En estos momentos, es mejor no presionar nuevamente los botones de encendido / apagado, sino solo esperar a que se actualice el estado. Al iniciar la aplicaci√≥n en algunas situaciones, puede ver una lista vac√≠a en lugar de una lista de dispositivos. No hay necesidad de entrar en p√°nico, por lo general aparece en los pr√≥ximos segundos. Las notificaciones en el tel√©fono no est√°n localizadas y se guardan los nombres correctos de los eventos.Adem√°s, los autores de la aplicaci√≥n utilizan peri√≥dicamente el canal de notificaci√≥n push para publicidad (nuevamente en chino). Esto, por supuesto, no me gusta, pero no hay muchas opciones.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espero que este art√≠culo haya ayudado a tener una buena idea sobre las capacidades de varios dispositivos Xiaomi para construir una casa inteligente y los escenarios de su aplicaci√≥n pr√°ctica. </font><font style="vertical-align: inherit;">Si tiene alguna pregunta, hay correcciones y adiciones, me complacer√° analizarlas en los comentarios.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/482554/">https://habr.com/ru/post/482554/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../482544/index.html">Recopilaci√≥n de un equipo de inicio con "0": instrucciones paso a paso para los m√°s peque√±os</a></li>
<li><a href="../482546/index.html">VK Tech: un a√±o de desarrollo en n√∫meros Git</a></li>
<li><a href="../482548/index.html">Semana de la seguridad 52 + 1: noticias no est√°ndar del top 3 del a√±o</a></li>
<li><a href="../482550/index.html">El misterioso programa LyX. Parte 2</a></li>
<li><a href="../482552/index.html">Registro y autorizaci√≥n usando Spring Security usando una aplicaci√≥n simple como ejemplo</a></li>
<li><a href="../482556/index.html">Alrededor de la √©poca en que el c√©sped era "m√°s verde" y AKG produc√≠a auriculares dinost√°ticos</a></li>
<li><a href="../482560/index.html">C√≥mo escribir textos sencillos</a></li>
<li><a href="../482562/index.html">Se supon√≠a que la computadora personal deb√≠a morir hace diez a√±os: lo que sucedi√≥ en su lugar</a></li>
<li><a href="../482564/index.html">Si todas las historias fueran escritas al estilo de la ciencia ficci√≥n</a></li>
<li><a href="../482566/index.html">La √∫ltima generaci√≥n de dispositivos inal√°mbricos.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>