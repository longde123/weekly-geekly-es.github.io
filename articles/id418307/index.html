<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍🍳 👩🏽‍⚖️ 🤷🏾 Alat Pembelajaran Mesin Apple 👩🏿‍🚒 👨🏾‍💻 🚩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam beberapa tahun terakhir, topik kecerdasan buatan dan pembelajaran mesin telah berhenti menjadi sesuatu untuk orang-orang dari dunia fiksi dan te...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Alat Pembelajaran Mesin Apple</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redmadrobot/blog/418307/"><p><img src="https://habrastorage.org/webt/si/by/p7/sibyp7evcy3vtvyh7jthlpqh68m.png"></p><br><p>  Dalam beberapa tahun terakhir, topik kecerdasan buatan dan pembelajaran mesin telah berhenti menjadi sesuatu untuk orang-orang dari dunia fiksi dan telah dengan kuat memasuki kehidupan sehari-hari.  Jejaring sosial menawarkan untuk menghadiri acara-acara yang menarik bagi kami, mobil-mobil di jalanan belajar bergerak tanpa sopir, dan seorang asisten suara di telepon memberi tahu kapan lebih baik meninggalkan rumah untuk menghindari kemacetan lalu lintas dan apakah akan membawa payung bersama Anda. </p><br><p>  Dalam artikel ini, kami akan mempertimbangkan alat pembelajaran mesin yang ditawarkan oleh pengembang Apple, menganalisis apa yang ditunjukkan perusahaan baru di bidang ini di WWDC18, dan mencoba memahami bagaimana menerapkan semua ini ke dalam praktik. </p><a name="habracut"></a><br><h2 id="mashinnoe-obuchenie">  Pembelajaran mesin </h2><br><p>  Jadi, pembelajaran mesin adalah proses di mana suatu sistem, menggunakan algoritma analisis data tertentu dan memproses sejumlah besar contoh, mengidentifikasi pola dan menggunakannya untuk memprediksi karakteristik data baru. </p><br><p>  Pembelajaran mesin lahir dari teori bahwa komputer dapat belajar sendiri, belum diprogram untuk melakukan tindakan tertentu.  Dengan kata lain, tidak seperti program konvensional dengan instruksi yang telah ditentukan untuk menyelesaikan masalah tertentu, pembelajaran mesin memungkinkan sistem untuk belajar bagaimana mengenali pola secara independen dan membuat prediksi. </p><br><h2 id="bnns-i-cnn">  BNNS dan CNN </h2><br><p>  Apple telah menggunakan teknologi pembelajaran mesin pada perangkatnya selama beberapa waktu: Mail mengidentifikasi email spam, Siri membantu Anda dengan cepat menemukan jawaban atas pertanyaan Anda, Foto mengenali wajah dalam gambar. </p><br><p> Di WWDC16, perusahaan memperkenalkan dua API berbasis jaringan saraf - Basic Neural Network Subroutines (BNNS) dan Convolutional Neural Networks (CNN).  BNNS adalah bagian dari sistem Accelerate, yang merupakan dasar untuk melakukan perhitungan cepat pada CPU, dan CNN adalah perpustakaan Metal Performance Shaders yang menggunakan GPU.  Anda dapat mempelajari lebih lanjut tentang teknologi ini, misalnya, di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . </p><br><h2 id="core-ml-i-turi-create">  Core ML dan Turi Create </h2><br><p>  Tahun lalu, Apple mengumumkan kerangka kerja yang sangat memudahkan bekerja dengan teknologi pembelajaran mesin - Core ML.  Ini didasarkan pada gagasan untuk mengambil model data pra-terlatih dan mengintegrasikannya ke dalam aplikasi Anda hanya dalam beberapa baris kode. </p><br><p><img src="https://habrastorage.org/webt/eg/dl/rz/egdlrzk40ao2z5a_eijvug8dhbc.png"></p><br><p>  Menggunakan Core ML, Anda dapat mengimplementasikan banyak fungsi: </p><br><ul><li>  definisi objek dalam foto dan video; </li><li>  input teks prediksi; </li><li>  pelacakan wajah dan pengenalan; </li><li>  analisis gerak; </li><li>  definisi barcode; </li><li>  pemahaman dan pengakuan teks; </li><li>  pengenalan gambar waktu nyata; </li><li>  stilisasi gambar; </li><li>  dan masih banyak lagi. </li></ul><br><p>  Core ML, pada gilirannya, menggunakan Metal tingkat rendah, Mempercepat dan BNNS, dan karenanya hasil perhitungannya sangat cepat. </p><br><p>  Kernel mendukung jaringan saraf, model linier umum, rekayasa fitur, algoritma pengambilan keputusan berbasis pohon (ansambel pohon), mendukung metode mesin vektor, model pipa. </p><br><p>  Tetapi Apple pada awalnya tidak menunjukkan teknologi sendiri untuk membuat dan melatih model, tetapi hanya membuat konverter untuk kerangka kerja populer lainnya: Caffe, Keras, scikit-learn, XGBoost, LIBSVM. </p><br><p>  Menggunakan alat pihak ketiga seringkali bukan tugas yang paling mudah, model yang dilatih cukup besar, dan pelatihan itu sendiri membutuhkan banyak waktu. </p><br><p>  Pada akhir tahun, perusahaan memperkenalkan Turi Create - sebuah kerangka kerja model pembelajaran yang ide utamanya adalah kemudahan penggunaan dan dukungan untuk sejumlah besar skenario - klasifikasi gambar, definisi objek, sistem rekomendasi, dan banyak lainnya.  Tapi Turi Create, meskipun relatif mudah digunakan, hanya mendukung Python. </p><br><h2 id="create-ml">  Buat ML </h2><br><p>  Dan tahun ini, Apple, selain Core ML 2, akhirnya menunjukkan alatnya sendiri untuk model pelatihan - kerangka Buat ML menggunakan teknologi asli Apple - Xcode dan Swift. </p><br><p>  Ini bekerja cepat, dan membuat model model dengan Create ML sangat mudah. </p><br><p>  Di WWDC, kinerja mengesankan Buat ML dan Core ML 2 diumumkan menggunakan aplikasi Memrise sebagai contoh.  Jika sebelumnya butuh 24 jam untuk melatih satu model menggunakan 20 ribu gambar, maka Buat ML mengurangi waktu ini menjadi 48 menit pada MacBook Pro dan hingga 18 menit pada iMac Pro.  Ukuran model yang dilatih menurun dari 90MB menjadi 3MB. </p><br><p>  Buat ML memungkinkan Anda menggunakan gambar, teks, dan objek terstruktur sebagai tabel, misalnya, sebagai sumber data. </p><br><p><img src="https://habrastorage.org/webt/uk/di/2e/ukdi2ewm3e2ax6bbr3ceu_fymlu.png"></p><br><h2 id="klassifikaciya-izobrazheniy">  Klasifikasi gambar </h2><br><p>  Pertama, mari kita lihat bagaimana klasifikasi gambar bekerja.  Untuk melatih model, kita memerlukan set data awal: kita mengambil tiga kelompok foto hewan: anjing, kucing dan burung dan mendistribusikannya ke folder dengan nama yang sesuai, yang akan menjadi nama-nama kategori model.  Setiap grup berisi 100 gambar dengan resolusi hingga 1920 × 1080 piksel dan ukuran hingga 1Mb.  Foto harus berbeda mungkin sehingga model yang dilatih tidak bergantung pada tanda-tanda seperti warna pada gambar atau ruang di sekitarnya. </p><br><p><img src="https://habrastorage.org/webt/w8/oz/_9/w8oz_9t_3_0fyz86xusotsdp9zi.png"></p><br><p>  Juga, untuk memeriksa seberapa baik model terlatih menangani pengenalan objek, Anda memerlukan kumpulan data uji - gambar yang tidak ada dalam dataset asli. </p><br><p>  Apple menyediakan dua cara untuk berinteraksi dengan Create ML: menggunakan UI pada MacOS Playground Xcode dan secara terprogram menggunakan CreateMLUI.framework dan CreateML.framework.  Dengan menggunakan metode pertama, cukup menulis beberapa baris kode, mentransfer gambar yang dipilih ke area yang ditentukan, dan menunggu sementara model belajar. </p><br><p><img src="https://habrastorage.org/webt/b6/zb/w_/b6zbw_ihfbmt2lx0ovib4nmkfsk.gif"></p><br><p>  Pada Macbook Pro 2017 dalam konfigurasi maksimum, pelatihan membutuhkan 29 detik untuk 10 iterasi, dan ukuran model yang dilatih adalah 33Kb.  Itu terlihat mengesankan. </p><br><p>  Mari kita coba mencari tahu bagaimana kita berhasil mencapai indikator seperti itu dan apa yang "di bawah tenda". <br>  Tugas mengklasifikasikan gambar adalah salah satu penggunaan paling populer dari jaringan saraf convolutional.  Pertama, ada baiknya menjelaskan apa itu. </p><br><p>  Seseorang, melihat gambar binatang, dapat dengan cepat menghubungkannya dengan kelas tertentu berdasarkan fitur apa pun yang membedakan.  Jaringan saraf bertindak dengan cara yang sama dengan mencari karakteristik dasar.  Mengambil array awal piksel sebagai input, ia secara berurutan meneruskan informasi melalui kelompok lapisan convolutional dan membangun abstraksi yang semakin kompleks.  Pada setiap lapisan berikutnya, ia belajar untuk menyorot fitur tertentu - pertama ini adalah garis, lalu set garis, bentuk geometris, bagian tubuh, dan sebagainya.  Pada lapisan terakhir kita mendapatkan kesimpulan dari kelas atau kelompok kelas yang mungkin. </p><br><p>  Dalam kasus Buat ML, pelatihan jaringan saraf tidak dilakukan dari awal.  Kerangka kerja ini menggunakan jaringan saraf yang sebelumnya dilatih pada kumpulan data besar, yang sudah mencakup sejumlah besar lapisan dan memiliki akurasi tinggi. </p><br><p><img src="https://habrastorage.org/webt/go/qu/el/goquell4agcijc9duege4cg1ydw.png"></p><br><p>  Teknologi ini disebut transfer learning.  Dengannya, Anda dapat mengubah arsitektur jaringan pra-terlatih sehingga cocok untuk memecahkan masalah baru.  Jaringan yang diubah kemudian dilatih tentang dataset baru. </p><br><p>  Buat ML selama ekstrak pelatihan dari foto sekitar 1000 fitur khas.  Ini bisa berupa objek, warna tekstur, lokasi mata, ukuran, dan banyak lainnya. <br>  Perlu dicatat bahwa set data awal yang digunakan untuk melatih jaringan saraf yang digunakan, seperti milik kami, mungkin berisi foto-foto kucing, anjing, dan burung, tetapi kategori ini tidak dialokasikan secara khusus.  Semua kategori membentuk hierarki.  Oleh karena itu, sangat tidak mungkin untuk menerapkan jaringan ini dalam bentuk murni - perlu untuk melatihnya kembali pada data kami. </p><br><p>  Pada akhir proses, kami melihat seberapa akurat model kami dilatih dan diuji setelah beberapa iterasi.  Untuk meningkatkan hasil, kami dapat menambah jumlah gambar dalam dataset asli atau mengubah jumlah iterasi. </p><br><p><img src="https://habrastorage.org/webt/k1/rz/to/k1rzto4lzngwwfo46taxa9vnbms.png"></p><br><p>  Selanjutnya, kita dapat menguji model sendiri pada set data uji.  Gambar di dalamnya harus unik, mis.  Jangan masukkan set sumber. </p><br><p><img src="https://habrastorage.org/webt/lw/u8/el/lwu8eld5v8q6jwqyeaygwkyzvwi.png"></p><br><p>  Untuk setiap gambar, indikator <em>kepercayaan diri</em> ditampilkan - seberapa akurat dengan bantuan model kami, kategori itu dikenali. </p><br><p>  Untuk hampir semua foto, dengan pengecualian langka, angka ini adalah 100%.  Saya secara khusus menambahkan gambar yang Anda lihat di atas ke dataset uji, dan, seperti yang Anda lihat, Buat ML yang dikenali di dalamnya 86% anjing dan 13% burung. </p><br><p>  Pelatihan model selesai, dan yang tersisa bagi kami adalah menyimpan file * .mlmodel dan menambahkannya ke proyek Anda. </p><br><p><img src="https://habrastorage.org/webt/vd/ey/xb/vdeyxbibcdbgd3f2jb6ozsrpa_u.png"></p><br><p>  Untuk menguji model, saya menulis aplikasi sederhana menggunakan kerangka Visi.  Ini memungkinkan Anda untuk bekerja dengan model Core ML dan memecahkan masalah dalam menggunakannya, seperti klasifikasi gambar atau deteksi objek. </p><br><p>  Aplikasi kita akan mengenali gambar dari kamera perangkat dan menampilkan kategori dan persentase kepercayaan dalam klasifikasi. </p><br><p>  Kami menginisialisasi model Core ML untuk bekerja dengan Vision dan mengonfigurasi kueri: </p><br><pre><code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupVision</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> visionModel = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">VNCoreMLModel</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: <span class="hljs-type"><span class="hljs-type">AnimalsClassifier</span></span>().model) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">fatalError</span></span>(<span class="hljs-string"><span class="hljs-string">"Can't load VisionML model"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> request = <span class="hljs-type"><span class="hljs-type">VNCoreMLRequest</span></span>(model: visionModel) { (request, error) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> results = request.results <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.handleRequestResults(results) } requests = [request] }</code> </pre> <br><p>  Tambahkan metode yang akan memproses hasil VNCoreMLRequest.  Kami hanya menampilkan mereka yang memiliki indikator kepercayaan lebih dari 70%: </p><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleRequestResults</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> results: [</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">])</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> categoryText: <span class="hljs-type"><span class="hljs-type">String?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> { <span class="hljs-type"><span class="hljs-type">DispatchQueue</span></span>.main.async { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.categoryLabel.text = categoryText } } <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> foundObject = results .compactMap({ $<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">VNClassificationObservation</span></span> }) .first(<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>: { $<span class="hljs-number"><span class="hljs-number">0</span></span>.confidence &gt; <span class="hljs-number"><span class="hljs-number">0.7</span></span> }) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { categoryText = <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> category = categoryTitle(identifier: foundObject.identifier) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> confidence = <span class="hljs-string"><span class="hljs-string">"\(round(foundObject.confidence * 100 * 100) / 100)%"</span></span> categoryText = <span class="hljs-string"><span class="hljs-string">"\(category) \(confidence)"</span></span> }</code> </pre><br><p>  Dan yang terakhir - kita akan menambahkan metode delegasi AVCaptureVideoDataOutputSampleBufferDelegate, yang akan dipanggil dengan setiap bingkai baru dari kamera dan menjalankan permintaan: </p><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">captureOutput</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> output: AVCaptureOutput, didOutput sampleBuffer: CMSampleBuffer, from connection: AVCaptureConnection)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pixelBuffer = <span class="hljs-type"><span class="hljs-type">CMSampleBufferGetImageBuffer</span></span>(sampleBuffer) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> requestOptions: [<span class="hljs-type"><span class="hljs-type">VNImageOption</span></span>: <span class="hljs-type"><span class="hljs-type">Any</span></span>] = [:] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cameraIntrinsicData = <span class="hljs-type"><span class="hljs-type">CMGetAttachment</span></span>( sampleBuffer, key: kCMSampleBufferAttachmentKey_CameraIntrinsicMatrix, attachmentModeOut: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { requestOptions = [.cameraIntrinsics:cameraIntrinsicData] } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> imageRequestHandler = <span class="hljs-type"><span class="hljs-type">VNImageRequestHandler</span></span>( cvPixelBuffer: pixelBuffer, options: requestOptions) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> imageRequestHandler.perform(requests) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(error) } }</code> </pre> <br><p>  Mari kita periksa seberapa baik model mengatasi tugasnya: </p><br><p><img src="https://habrastorage.org/webt/fy/5k/fl/fy5kflqc3p02w0mo0dwgaar3vle.gif"></p><br><p>  Kategori ini ditentukan dengan akurasi yang cukup tinggi, dan ini sangat mengejutkan ketika Anda mempertimbangkan seberapa cepat pelatihan berlangsung dan seberapa kecil dataset aslinya.  Secara berkala, dengan latar belakang gelap, model ini mengungkapkan burung, tapi saya pikir ini dapat dengan mudah diselesaikan dengan meningkatkan jumlah gambar dalam kumpulan data asli atau dengan meningkatkan tingkat kepercayaan minimum yang dapat diterima. </p><br><p>  Jika kami ingin melatih ulang model untuk mengklasifikasikan kategori lain, cukup tambahkan grup gambar baru dan ulangi prosesnya - ini akan memakan waktu beberapa menit. </p><br><p>  Sebagai percobaan, saya membuat kumpulan data lain, di mana saya mengubah semua foto kucing di foto satu kucing dari sudut yang berbeda, tetapi pada latar belakang yang sama dan di lingkungan yang sama.  Dalam hal ini, model hampir selalu membuat kesalahan dan mengenali kategori di ruang kosong, tampaknya mengandalkan warna sebagai fitur utama. </p><br><p>  Fitur menarik lainnya yang diperkenalkan di Vision hanya tahun ini adalah kemampuan untuk mengenali objek dalam gambar secara real time.  Ini diwakili oleh kelas VNRecognizedObjectObservation, yang memungkinkan Anda untuk mendapatkan kategori objek dan lokasinya - boundingBox. </p><br><p><img src="https://habrastorage.org/webt/fo/96/cb/fo96cbqh0flkktb9umjrfxxofu4.jpeg"></p><br><p>  Sekarang Buat ML tidak memungkinkan pembuatan model untuk mengimplementasikan fungsi ini.  Apple menyarankan menggunakan Turi Buat dalam kasus ini.  Prosesnya tidak jauh lebih rumit daripada yang di atas: Anda perlu menyiapkan folder kategori dengan foto dan file di mana untuk setiap gambar koordinat dari persegi panjang di mana objek berada akan ditunjukkan. </p><br><h2 id="natural-language-processing">  Pemrosesan bahasa alami </h2><br><p>  Fungsi Buat ML berikutnya adalah untuk melatih model untuk mengklasifikasikan teks dalam bahasa alami - misalnya, untuk menentukan pewarnaan emosional dari kalimat atau mendeteksi spam. </p><br><p><img src="https://habrastorage.org/webt/xv/fq/48/xvfq489qejhdwl_uitxcc-2yyii.png"></p><br><p>  Untuk membuat model, kita harus mengumpulkan tabel dengan kumpulan data asli - kalimat atau seluruh teks yang ditetapkan untuk kategori tertentu, dan melatih model menggunakannya dengan menggunakan objek MLTextClassifier: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> data = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">try</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MLDataTable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">contentsOf: URL(fileURLWithPath: </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"/Users/CreateMLTest/texts.json"</span></span></span></span></span><span class="hljs-function">)) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">trainingData, testingData</span></span></span><span class="hljs-function">)</span></span> = data.randomSplit(<span class="hljs-keyword"><span class="hljs-keyword">by</span></span>: <span class="hljs-number"><span class="hljs-number">0.8</span></span>, seed: <span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> textClassifier = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">try</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MLTextClassifier</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">trainingData: trainingData, textColumn: </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"text"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, labelColumn: </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"label"</span></span></span></span></span><span class="hljs-function">) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">try</span></span></span><span class="hljs-function"> textClassifier.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">to: URL(fileURLWithPath: </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"/Users/CreateMLTest/TextClassifier.mlmodel"</span></span></span></span></span><span class="hljs-function">))</span></span></code> </pre> <br><p>  Dalam hal ini, model yang dilatih adalah tipe Text Classifier: </p><br><p><img src="https://habrastorage.org/webt/kg/j1/ws/kgj1wst4121ojpwfk73yehmte_m.png"></p><br><h2 id="tablichnye-dannye">  Data tabel </h2><br><p>  Mari kita lihat lebih dekat fitur lain dari Buat ML - latih model menggunakan data terstruktur (tabel). </p><br><p>  Kami akan menulis aplikasi uji yang memprediksi harga apartemen berdasarkan lokasinya di peta dan parameter tertentu lainnya. </p><br><p>  Jadi, kami memiliki tabel dengan data abstrak tentang apartemen di Moskow dalam bentuk file csv: luas setiap apartemen, lantai, jumlah kamar dan koordinat (lintang dan bujur) diketahui.  Selain itu, biaya setiap apartemen diketahui.  Semakin dekat ke pusat atau semakin besar area, semakin tinggi harganya. </p><br><p><img src="https://habrastorage.org/webt/hd/-w/77/hd-w77qhysj80_kapqbqddwdhyi.png"></p><br><p>  Tugas Buat ML adalah membangun model yang mampu memprediksi harga apartemen berdasarkan karakteristik ini.  Tugas seperti itu dalam pembelajaran mesin disebut tugas regresi dan merupakan contoh klasik pembelajaran dengan seorang guru. </p><br><p>  Buat ML mendukung banyak model - Regresi Linier, Regresi Pohon Keputusan, Klasifikasi Pohon, Regresi Logistik, Klasifikasi Hutan Acak, Regresi Pohon Didorong, dll. </p><br><p>  Kami akan menggunakan objek MLRegressor, yang akan memilih opsi terbaik berdasarkan data input. <br>  Pertama, inisialisasi objek MLDataTable dengan konten file csv kami: </p><br><pre> <code class="hljs lisp">let trainingFile = URL(<span class="hljs-name"><span class="hljs-name">fileURLWithPath</span></span>: <span class="hljs-string"><span class="hljs-string">"/Users/CreateMLTest/Apartments.csv"</span></span>) let apartmentsData = try MLDataTable(<span class="hljs-name"><span class="hljs-name">contentsOf</span></span>: trainingFile)</code> </pre> <br><p>  Kami membagi set data awal menjadi data untuk pelatihan model dan pengujian dalam persentase 80/20: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> (trainingData, testData) = apartmentsData.randomSplit(<span class="hljs-keyword"><span class="hljs-keyword">by</span></span>: <span class="hljs-number"><span class="hljs-number">0.8</span></span>, seed: <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br><p>  Kami membuat model MLRegressor, yang menunjukkan data untuk pelatihan dan nama kolom yang nilainya ingin kami prediksi.  Jenis tugas khusus dari regresi (linier, pohon keputusan, pohon yang ditingkatkan atau hutan acak) akan secara otomatis dipilih berdasarkan studi dari data input.  Kami juga dapat menentukan kolom fitur - kolom parameter khusus untuk analisis, tetapi dalam contoh ini ini tidak diperlukan, kami akan menggunakan semua parameter.  Pada akhirnya, simpan model yang terlatih dan tambahkan ke proyek: </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> model = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-type"><span class="hljs-type">MLRegressor</span></span>(trainingData: apartmentsData, targetColumn: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> modelPath = <span class="hljs-type"><span class="hljs-type">URL</span></span>(fileURLWithPath: <span class="hljs-string"><span class="hljs-string">"/Users/CreateMLTest/ApartmentsPricer.mlmodel"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> model.write(to: modelPath, metadata: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/webt/xv/ci/-e/xvci-e7bhoxwfpvwtjdmwqwwhv0.png"></p><br><p>  Dalam contoh ini, kita melihat bahwa jenis model sudah Regulator Pipa, dan bidang Deskripsi berisi tipe regresi yang dipilih secara otomatis - Model Regresi Pohon yang Ditingkatkan.  Parameter Input dan Output sesuai dengan kolom tabel, tetapi tipe datanya telah menjadi Double. </p><br><p>  Sekarang periksa hasilnya. <br>  Inisialisasi objek model: </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> model = <span class="hljs-type"><span class="hljs-type">ApartmentsPricer</span></span>()</code> </pre> <br><p>  Kami memanggil metode prediksi, meneruskan parameter yang ditentukan untuk itu: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> area = Double(areaSlider.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> floor = Double(floorSlider.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rooms = Double(roomsSlider.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> latitude = annotation.coordinate.latitude <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> longitude = annotation.coordinate.longitude <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> prediction = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? model.prediction( area: area, floor: floor, rooms: rooms, latitude: latitude, longitude: longitude)</code> </pre><br><p>  Kami menampilkan nilai perkiraan biaya: </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> price = prediction?.price priceLabel.text = formattedPrice(price)</code> </pre> <br><p>  Mengubah titik pada peta atau nilai parameter, kami mendapatkan harga apartemen cukup dekat dengan data pengujian kami: </p><br><p><img src="https://habrastorage.org/webt/pu/j-/v1/puj-v1m8x0ghkxrh1fwogdejxfu.png"></p><br><h2 id="zaklyuchenie">  Kesimpulan </h2><br><p>  Kerangka kerja ML Buat sekarang adalah salah satu cara termudah untuk bekerja dengan teknologi pembelajaran mesin.  Itu belum memungkinkan pembuatan model untuk memecahkan beberapa masalah: pengenalan objek dalam gambar, stilisasi foto, penentuan gambar yang serupa, pengakuan tindakan fisik berdasarkan data dari accelerometer atau giroskop, yang Turi Buat, misalnya, menangani. </p><br><p>  Tetapi perlu dicatat bahwa Apple telah membuat kemajuan yang cukup serius di bidang ini selama setahun terakhir, dan, yang pasti, kita akan segera melihat perkembangan teknologi yang dijelaskan. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id418307/">https://habr.com/ru/post/id418307/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id418295/index.html">Hampir semua yang Anda ingin tahu tentang floating point di ARM, tetapi takut untuk bertanya</a></li>
<li><a href="../id418297/index.html">Ulasan smartphone Neffos N1</a></li>
<li><a href="../id418301/index.html">Konfrontasi hebat Mars pada 2018: cara mengamati dan apa yang diharapkan</a></li>
<li><a href="../id418303/index.html">Vanessa-Automation - alat untuk menguji solusi aplikasi pada platform 1C: Enterprise</a></li>
<li><a href="../id418305/index.html">Berapa banyak objek yang dipancarkan Python saat menjalankan skrip?</a></li>
<li><a href="../id418309/index.html">Bagaimana Satelit Astronomi Planck Selamanya Mengubah Persepsi Kita terhadap Semesta</a></li>
<li><a href="../id418311/index.html">Ulas Dell Latitude 7390 Notebook: Corporate Superhero</a></li>
<li><a href="../id418313/index.html">10 Alat Pengujian API Teratas</a></li>
<li><a href="../id418315/index.html">Tanpa "oops" tunggal: 10 laporan teratas dari DevOops 2017</a></li>
<li><a href="../id418317/index.html">2048 dilarang. Bukan RosKomNadzor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>