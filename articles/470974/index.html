<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåà ‚öΩÔ∏è ü§πüèΩ DNS pasivo en manos del analista üòº ‚ûø üë°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El Sistema de nombres de dominio (DNS) es un tipo de gu√≠a telef√≥nica que traduce nombres f√°ciles de usar, como "ussc.ru", en direcciones IP. Dado que ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DNS pasivo en manos del analista</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470974/"><p>  El Sistema de nombres de dominio (DNS) es un tipo de gu√≠a telef√≥nica que traduce nombres f√°ciles de usar, como "ussc.ru", en direcciones IP.  Dado que la actividad DNS est√° presente en casi todas las sesiones de comunicaci√≥n, independientemente del protocolo.  Por lo tanto, el registro de DNS es una fuente de datos valiosa para un especialista en seguridad de la informaci√≥n, ya que le permite detectar anomal√≠as u obtener datos adicionales sobre el sistema en estudio. </p><br><p> En 2004, Florian Weimer propuso un m√©todo de registro como DNS pasivo, que le permite restaurar el historial de cambios de datos DNS con la capacidad de indexar y buscar, lo que puede proporcionar acceso a los siguientes datos: </p><br><ul><li>  Nombre de dominio </li><li>  Direcci√≥n IP del nombre de dominio solicitado </li><li>  Fecha y hora de respuesta </li><li>  Tipo de respuesta </li><li>  etc. </li></ul><br><p>  Los datos para DNS pasivo se recopilan de servidores DNS recursivos con m√≥dulos integrados o al interceptar respuestas de los servidores DNS responsables de la zona. </p><br><img src="https://habrastorage.org/webt/zt/vg/gj/ztvggj6s1bxlduk5nfyw7cv0dy4.png" alt="imagen"><br><p>  <i>Figura 1. DNS pasivo (tomado de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ctovision.com</a> )</i> </p><a name="habracut"></a><br><p>  La peculiaridad del DNS pasivo es que no es necesario registrar la direcci√≥n IP del cliente, lo que ayuda a proteger la privacidad del usuario. </p><br><p>  Por el momento, hay muchos servicios que proporcionan acceso a datos DNS pasivos: </p><br><div class="scrollable-table"><table><tbody><tr><th></th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DNSDB</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">VirusTotal</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Total pasivo</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pulpo</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Senderos de seguridad</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Paraguas Investigar</a> </th></tr><tr><td>  <b>Empresa</b> </td><td>  Seguridad de visi√≥n lejana </td><td>  VirusTotal </td><td>  Riskisk </td><td>  SafeDNS </td><td>  Senderos de seguridad </td><td>  Cisco </td></tr><tr><td>  <b>Acceso</b> </td><td>  Previa solicitud </td><td>  No se requiere registro </td><td>  Inscripci√≥n gratuita </td><td>  Previa solicitud </td><td>  No se requiere registro </td><td>  Previa solicitud </td></tr><tr><td>  <b>API</b> </td><td>  Esta presente </td><td>  Esta presente </td><td>  Esta presente </td><td>  Esta presente </td><td>  Esta presente </td><td>  Esta presente </td></tr><tr><td>  <b>Disponibilidad del cliente</b> </td><td>  Esta presente </td><td>  Esta presente </td><td>  Esta presente </td><td>  Falta </td><td>  Falta </td><td>  Falta </td></tr><tr><td>  <b>Iniciar recopilaci√≥n de datos</b> </td><td>  A√±o 2010 </td><td>  A√±o 2013 </td><td>  A√±o 2009 </td><td>  Muestra solo los √∫ltimos 3 meses </td><td>  A√±o 2008 </td><td>  A√±o 2006 </td></tr></tbody></table></div><br><p>  <i>Tabla 1. Servicios con acceso a datos DNS pasivos</i> </p><br><h4>  Opciones para usar DNS pasivo </h4><br><p>  Usando DNS pasivo, puede construir conexiones entre nombres de dominio, servidores NS y direcciones IP.  Esto le permite construir mapas de los sistemas estudiados y realizar un seguimiento de los cambios en dicho mapa desde la primera detecci√≥n hasta el momento actual. </p><br><p>  El DNS pasivo tambi√©n facilita la detecci√≥n de anomal√≠as de tr√°fico.  Por ejemplo, el seguimiento de los cambios en las zonas y registros NS como A y AAAA le permite identificar sitios maliciosos utilizando el m√©todo de flujo r√°pido, que est√° dise√±ado para ocultar C&amp;C de la detecci√≥n y el bloqueo.  Dado que los nombres de dominio leg√≠timos (con la excepci√≥n de los utilizados para el equilibrio de carga) a menudo no cambiar√°n sus direcciones IP, y la mayor√≠a de las zonas leg√≠timas rara vez cambian sus servidores NS. </p><br><p>  El DNS pasivo, en contraste con la enumeraci√≥n directa de subdominios por diccionarios, le permite encontrar incluso los nombres de dominio m√°s ex√≥ticos, por ejemplo, "222qmxacaiqaaaaazibq4aaidhmbqaaa0undefined7140c0.p.hoff.ru".  Adem√°s, a veces le permite encontrar √°reas de prueba (y vulnerables) de un sitio web, materiales para desarrolladores, etc. </p><br><h4>  Examinar enlaces de correos electr√≥nicos usando DNS pasivo </h4><br><p>  Por el momento, el correo no deseado es una de las principales formas en que un atacante penetra en la computadora de la v√≠ctima o roba informaci√≥n confidencial.  Intentemos examinar el enlace de dicha carta usando DNS pasivo para evaluar la efectividad de este m√©todo. </p><br><img src="https://habrastorage.org/webt/ok/er/po/okerponr7oatd6mmgunqldthynk.jpeg" alt="imagen"><br><p>  <i>Figura 2. Correo electr√≥nico no deseado</i> </p><br><p>  El enlace de esta carta condujo al sitio magnit-boss.rocks, que ofrec√≠a recolectar autom√°ticamente bonos y recibir dinero: </p><br><img src="https://habrastorage.org/webt/f2/i9/cc/f2i9ccb3lrwvrrkkzzcu-tnmxtk.png" alt="imagen"><br><p>  <i>Figura 3. La p√°gina alojada en magnit-boss.rocks</i> </p><br><p>  Para estudiar este sitio, se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">us√≥ la API Riskiq</a> , que ya tiene 3 clientes listos para usar en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Python</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ruby</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Rust</a> . </p><br><p>  En primer lugar, aprenderemos toda la historia de este nombre de dominio, para esto usamos el comando: </p><br><p>  <i>pt-client pdns --query magnit-boss.rocks</i> </p><br><p>  Este comando mostrar√° informaci√≥n sobre todas las resoluciones de DNS asociadas con este nombre de dominio. </p><br><img src="https://habrastorage.org/webt/m4/wn/f6/m4wnf6telpyggxepwd3fwcqlros.png" alt="imagen"><br><p>  <i>Figura 4. Respuesta de la API Riskiq</i> </p><br><p>  Llevemos la respuesta de la API a una forma m√°s visual: </p><br><img src="https://habrastorage.org/webt/fi/jh/dp/fijhdp0-c8csxrlyejytmcydgr4.png" alt="imagen"><br><p>  <i>Figura 5. Todos los registros de la respuesta</i> </p><br><p>  Para futuras investigaciones, se tomaron las direcciones IP a las que se resolvi√≥ este nombre de dominio al momento de recibir la carta 01.08.2019, tales direcciones IP son las siguientes direcciones 92.119.113.112 y 85.143.219.65. </p><br><p>  Usando el comando: </p><br><p>  <i>pt-client pdns --query</i> </p><br><p>  Puede obtener todos los nombres de dominio asociados con estas direcciones IP. <br>  La direcci√≥n IP 92.119.113.112 tiene 42 nombres de dominio √∫nicos que se resolvieron en esta direcci√≥n IP, entre los cuales se encuentran dichos nombres: </p><br><ul><li>  magnit-boss.club </li><li>  igrovie-avtomaty.me </li><li>  prox-audit.xyz </li><li>  zep3-www.xyz </li><li>  y otros </li></ul><br><p>  La direcci√≥n IP 85.143.219.65 tiene 44 nombres de dominio √∫nicos que se resolvieron en esta direcci√≥n IP, entre los cuales se encuentran dichos nombres: </p><br><ul><li>  cvv2.name (sitio para la venta de datos de tarjetas de cr√©dito) </li><li>  emaills.world </li><li>  www.mailru.space </li><li>  y otros </li></ul><br><p>  Las conexiones con estos nombres de dominio sugieren suplantaci√≥n de identidad (phishing), pero creemos en las buenas personas, por lo que intentaremos obtener una bonificaci√≥n de 332,501.72 rublos.  Despu√©s de hacer clic en el bot√≥n "S√ç", el sitio nos pide que transfiramos 300 rublos de la tarjeta para desbloquear la cuenta y nos env√≠a a as-torpay.info para ingresar datos. </p><br><img src="https://habrastorage.org/webt/em/ng/e-/emnge-q11hjwa-v_km4fekbv5xc.png" alt="imagen"><br><p>  <i>Figura 6. P√°gina de inicio de Ac-pay2day.net</i> </p><br><p>  Parece un sitio legal, hay un certificado https y la p√°gina principal ofrece conectar este sistema de pago a su sitio, pero, por desgracia, todos los enlaces a la conexi√≥n no funcionan.  Este nombre de dominio se resuelve en solo 1 direcci√≥n IP: 190.115.19.74.  A su vez, tiene 1475 nombres de dominio √∫nicos que se resolvieron en esta direcci√≥n IP, incluidos nombres como: </p><br><ul><li>  ac-pay2day.net </li><li>  ac-payfit.com </li><li>  as-manypay.com </li><li>  fletkass.net </li><li>  as-magicpay.com </li><li>  y otros </li></ul><br><p>  Como podemos ver, el DNS pasivo le permite recopilar datos de manera r√°pida y eficiente sobre el recurso investigado e incluso crear una especie de huella digital que le permite revelar un esquema completo para el robo de datos personales, desde su recepci√≥n hasta el punto de venta probable. </p><br><img src="https://habrastorage.org/webt/z_/wc/bc/z_wcbcwwi8zvjfp8zu7eyqbsrik.png" alt="imagen"><br><p>  <i>Figura 7. Mapa del sistema investigado</i> </p><br><p>  No todo es tan color de rosa como nos gustar√≠a.  Por ejemplo, tales investigaciones pueden dividirse f√°cilmente en CloudFlare o servicios similares.  Y la efectividad de la base de datos depende mucho de la cantidad de consultas DNS que pasan por el m√≥dulo para recopilar datos DNS pasivos.  Sin embargo, el DNS pasivo es una fuente de informaci√≥n adicional para el investigador. </p><br><p>  <em>Autor: Especialista del Centro Ural de Sistemas de Seguridad</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/470974/">https://habr.com/ru/post/470974/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../470954/index.html">Instale Zimbra OSE 8.8.15 y Zextras Suite Pro en Ubuntu 18.04 LTS</a></li>
<li><a href="../470958/index.html">Las sondas de vida en Kubernetes pueden ser peligrosas</a></li>
<li><a href="../470962/index.html">JSConf Budapest 2019</a></li>
<li><a href="../470964/index.html">Juguetes de madera - inscripciones</a></li>
<li><a href="../470966/index.html">Contrase√±a de Unix de Ken Thompson</a></li>
<li><a href="../470976/index.html">Canci√≥n de hielo (Empresa sangrienta) y llamas (DevOps e IaC)</a></li>
<li><a href="../470978/index.html">Investigaci√≥n de mercado de analistas: d√≥nde estudian, qu√© herramientas usan y cu√°nto ganan</a></li>
<li><a href="../470980/index.html">Las tareas que los robots de software (RPA) resuelven en el sector bancario</a></li>
<li><a href="../470982/index.html">An√°lisis de confirmaciones y solicitudes de extracci√≥n en Travis CI, Buddy y AppVeyor utilizando PVS-Studio</a></li>
<li><a href="../470984/index.html">An√°lisis de confirmaciones y solicitudes de extracci√≥n en Travis CI, Buddy y AppVeyor utilizando PVS-Studio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>