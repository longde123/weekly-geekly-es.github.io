<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👏🏿 🤾🏻 🚮 Lernen, Waves Smart-Verträge auf RIDE und RIDE4DAPPS zu schreiben. Teil 1 (Multiuser Wallet) 🏉 🍉 👎🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits! 


 In jüngerer Zeit hat Waves Labs einen Wettbewerb für Entwickler angekündigt , der sich der Veröffentlichung der intelligenten Ve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lernen, Waves Smart-Verträge auf RIDE und RIDE4DAPPS zu schreiben. Teil 1 (Multiuser Wallet)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447790/"><p><img src="https://habrastorage.org/webt/hb/tu/r2/hbtur2vzsoyu97xxymahyvpyf1k.png"></p><br><p>  Hallo allerseits! </p><br><p>  In jüngerer Zeit hat Waves Labs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen</a> Wettbewerb für Entwickler <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">angekündigt</a> , der sich der Veröffentlichung der intelligenten Vertragssprachenerweiterung RIDE für dezentrale Ride4Dapps-Anwendungen im Testnetzwerk widmet! </p><br><p>  Wir haben uns für den DAO-Fall entschieden, da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ventuary</a> plant, dApp mit sozialen Funktionen zu entwickeln: Abstimmung, Spendenbeschaffung, Vertrauensmanagement usw. </p><br><p>  Wir haben mit einem einfachen Beispiel in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Q &amp; A-Sitzung</a> und in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RIDE IDE begonnen</a> - einem Beispiel mit einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gemeinsamen Brieftasche</a> . </p><a name="habracut"></a><br><p>  Schauen wir uns dieses Beispiel an, testen wir Hypothesen und betrachten einige Kuriositäten: </p><br><p>  Lassen Sie uns Alice - dApp Besitzerin haben <br>  Boob und Cooper sind Partner von Alice, Mitbegründer von Alice-BC DAO <br>  Neli ist ein Geschäftsinhaber, der eine Finanzierung benötigt <br>  Bank - eine Bank, die Token verteilt </p><br><h4>  Stufe 1. Initialisierung der Salden </h4><br><p>  Um Token im Wave-Test-Netzwerk zu empfangen, müssen Sie sich an den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wasserhahn</a> wenden und die Adresse angeben, an die Token gesendet werden sollen. </p><br><p>  Die Adresse finden Sie in der IDE, indem Sie die Kontoinformationen anzeigen. </p><br><p>  Wählen Sie Bank 10 WAVES.  Nachdem wir überprüft haben, ob sie den Block- und Transaktions-Explorer durchlaufen haben: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Browser</a> </p><br><p>  Verteilen wir nun Token von der Bank an die anderen Teilnehmer.  (Hinweise: Alle Transaktionen im Wave-Netzwerk sind nicht kostenlos, daher ist für alle Teilnehmer ein positiver Mindestsaldo erforderlich, um Transaktionen abzuschließen.) </p><br><blockquote>  1 WAVES = 100000000 Einheiten (Wavelets), da Beträge nur ganzzahlig sein können <br>  0,01 WELLEN (Transaktionsgebühr) = 1000000 </blockquote><p>  Bank -&gt; [3 WAVES] -&gt; Alice über TransferTransaction (Typ: 4). </p><br><p>  Wir überprüfen, ob der env.SEED, von dem die Transaktionen unterzeichnet werden, unserer Bank entspricht: </p><br><p><img src="https://habrastorage.org/webt/cm/zh/zq/cmzhzq4a9z5hrejneh21hz94rck.png"><br>  ￼ <br>  Wenn Sie keine passenden Startphrasen haben, wechseln Sie einfach auf der Registerkarte "Konten" zu dieser und überprüfen Sie sie erneut. </p><br><p>  Danach erstellen, kündigen und unterzeichnen wir eine Transaktion zur Übertragung von 3 WAVES Alice. <br>  Sie können die Daten von Alice auch über die Variable env.accounts lernen.  Die Nummerierung beginnt bei 0 bzw. Alice ist env.accounts [1]. </p><br><p><img src="https://habrastorage.org/webt/e6/l_/if/e6l_ifwovlpgy4w7siy86jagamo.png"></p><br><pre><code class="scala hljs">broadcast(transfer({recipient:address(env.accounts[<span class="hljs-number"><span class="hljs-number">1</span></span>]), amount: <span class="hljs-number"><span class="hljs-number">300000000</span></span>, fee: <span class="hljs-number"><span class="hljs-number">1000000</span></span>}))</code> </pre> <br><p>  Das Ergebnis kann auch im Browser beobachtet werden, der Link dazu wird unmittelbar nach der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Transaktion</a> an uns zurückgesendet. </p><br><p>  Wir stellen sicher, dass der Alice-Kontostand mit 3 WAVES aufgefüllt wird und dass 10 - 3 - 0,01 = 0,699 auf dem Bankguthaben verbleiben. </p><br><p><img src="https://habrastorage.org/webt/mf/9o/xf/mf9oxf5scbacjrcwe--sthtyfvg.png"></p><br><p><img src="https://habrastorage.org/webt/sk/nr/0d/sknr0djykfnrmbamhg7pz4ne_ye.png"></p><br><p>  Wir senden Boob und Cooper in 3 WAVES und Neli, Xena und Mark in 0,2 WAVES auf die gleiche Weise. <br>  (Anmerkungen: Wir haben einen Fehler mit einem einzelnen Zeichen gemacht und Neli 0.02 WAVES gesendet. Seien Sie vorsichtig!) </p><br><pre> <code class="scala hljs">broadcast(transfer({recipient:address(env.accounts[<span class="hljs-number"><span class="hljs-number">4</span></span>]), amount: <span class="hljs-number"><span class="hljs-number">20000000</span></span>, fee: <span class="hljs-number"><span class="hljs-number">1000000</span></span>}))</code> </pre> <br><p>  Nach dem Auffüllen des Guthabens aller Teilnehmer sehen wir: </p><br><p><img src="https://habrastorage.org/webt/dx/wd/aw/dxwdawf7j9hyghtpzwh1wpljprq.png"></p><br><h4>  Phase 2. Erstellen eines dApp-Kontos </h4><br><p>  Wir haben vereinbart, dass der Ersteller und Eigentümer der dezentralen Anwendung Alice sein wird. <br>  Installieren Sie es in Accounts als SEED und überprüfen Sie, ob env.SEED mit Alice übereinstimmt. </p><br><p>  Versuchen wir, das einfachste Skript (Vertrag) auf dem Alice-Konto zu installieren. <br>  Intelligente Kontakte in Waves sind Prädikate, die unter bestimmten Bedingungen die Ausführung ausgehender Transaktionen jeglicher Art verbieten oder zulassen.  In diesem Fall ist diese Bedingung IMMER.  Der Vertragscode ist wahr.  Wir rufen deploy () auf. </p><br><p><img src="https://habrastorage.org/webt/wu/py/dy/wupydyzu8vi884kj7apghkg5l-i.png"></p><br><p>  Gebühr für setScript-Transaktion 1400000/100000000 = 0,014 WAVES.  Alice hat 2.986 WELLEN auf ihrem Gleichgewicht. </p><br><p>  Versuchen wir nun, auf dem Alice-Konto eine komplexere intelligente Vertragslogik zu installieren, die im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel beschrieben wird</a> </p><br><blockquote>  <strong>Ride4Dapps enthält</strong> jetzt zwei neue Arten von Anmerkungen: <br><ol><li>  <strong>@Callable (i)</strong> - verwendet als Parameter i Daten darüber, welches Konto die Transaktion verursacht / signiert hat.  Das Ergebnis dieser Funktion bestimmt die Änderung des Status des dApp-Kontos.  Andere Konten können mit dieser Anmerkung Transaktionen erstellen und Funktionen ausführen und den Status des dApp-Kontos ändern. </li><li>  <strong>@Verifier (tx)</strong> - Transaktionsprüfer mit Transaktions-tx-Parameter.  Entspricht der Prädikatenlogik von RIDE.  In diesem Ausdruck können Sie weitere Änderungen an der Logik intelligenter Verträge für ein dApp-Konto aktivieren oder deaktivieren. <br>  <strong>Seien Sie aufmerksam!</strong>  Der wichtige Punkt ist, dass das Skript für das Konto standardmäßig nicht <strong>wahr ist</strong> , sondern den Signaturvergleich verwendet und nur dem Eigentümer der Signatur erlaubt, Transaktionen durchzuführen. <br><pre> <code class="scala hljs">sigVerify(tx.bodyBytes, tx.proofs[<span class="hljs-number"><span class="hljs-number">0</span></span>], tx.senderPk)</code> </pre> <br><br>  <strong>Ohne eine solche Überprüfung kann jeder Transaktionen von einem Konto aus durchführen!</strong> </li></ol><br></blockquote><p>  Lassen Sie uns das <strong>dApp-</strong> Konto als gemeinsame Brieftasche für alle Teilnehmer <strong>erstellen</strong> . </p><br><p><img src="https://habrastorage.org/webt/e4/9m/ch/e49mchekxv3gxshylylb2s5gssi.png"></p><br><p>  Um zu überprüfen, welcher Vertrag derzeit in Ihrem Konto aktiv ist, können Sie den base64-Code des Smart-Vertrags im Blockbrowser kopieren und über den Dekompiler erkennen ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">z. B.</a> ). </p><br><p><img src="https://habrastorage.org/webt/z5/xs/iv/z5xsiv5y_6akufw4svzyrfdwipy.png"></p><br><p><img src="https://habrastorage.org/webt/zf/w4/ii/zfw4iinsin-antvfjf71oghpypw.png"></p><br><p><img src="https://habrastorage.org/webt/vb/0t/tj/vb0ttjszckd-brvl_7sty0kxuty.png"></p><br><p>  Wir stellen sicher, dass die Logik des intelligenten Vertrags unseren Erwartungen entspricht. <br>  Alice hat 2.972 WELLEN auf ihrem Gleichgewicht. </p><br><p>  Diese dApp verfolgt, wie viel jeder Teilnehmer über den <strong>Datentransaktionsmechanismus - DataEntry (currentKey, newAmount)</strong> zum gemeinsamen Fonds <strong>beiträgt</strong> , wobei currentKey das Konto ist, das die Einzahlungsfunktion aufruft, und newAmount der Wert des aufgefüllten Guthabens ist. </p><br><p>  Boob und Cooper machen ihre Einzahlungen auf dApp-Konto zu je 1 WAVES. </p><br><p><img src="https://habrastorage.org/webt/ea/q9/of/eaq9ofimf-wsb4v90ky7zmfjpvu.png"></p><br><p>  Wir machen einen Fehler und die Transaktion wird nicht bestanden.  Da wir trotz der Tatsache, dass wir davon überzeugt waren, dass wir eine Transaktion im Auftrag von Bob durchführen, einen Fehler im Index gemacht und ein Bankkonto angegeben haben, das keinen intelligenten Vertrag hat.  Hier ist ein wichtiger Punkt zu beachten - bei erfolglosen Versuchen, Transaktionen einzuleiten, wird die Provision <strong>nicht abgehoben!</strong>  Alice hat 2.972 WELLEN auf ihrem Gleichgewicht.  Bob 3 hat WELLEN. </p><br><p>  Bob hat 1 WAVES an dApp Account gesendet. </p><br><pre> <code class="scala hljs">broadcast(invokeScript({dappAddress: address(env.accounts[<span class="hljs-number"><span class="hljs-number">1</span></span>]), call:{function:<span class="hljs-string"><span class="hljs-string">"deposit"</span></span>,args:[]}, payment: [{amount: <span class="hljs-number"><span class="hljs-number">100000000</span></span>, asset:<span class="hljs-literal"><span class="hljs-literal">null</span></span> }]}))</code> </pre> <br><p><img src="https://habrastorage.org/webt/na/nb/qy/nanbqy-fdxalvfweuhqfy9xnfge.png"></p><br><p>  Bob hat noch 1,99 WAVES übrig.  Das heißt, Bob zahlte 0,01 WAVES Provision </p><br><p><img src="https://habrastorage.org/webt/qb/bx/jn/qbbxjnpicgjaklsyfytsex7ji6u.png"></p><br><p>  Alice hatte 2.972 WAVES in ihrer Bilanz, es wurde 3.972.  Eine Transaktion wurde auch auf Alices Konto registriert, es wurde jedoch keine Provision vom dApp-Konto (Alice) abgezogen. <br>  Nachdem Cooper auch Alices Konto aufgefüllt hatte, wurden 4.972 WAVES in der Bilanz ausgewiesen. </p><br><p><img src="https://habrastorage.org/webt/it/fq/91/itfq91qi30frhgk00thymtmzzys.png"></p><br><p>  Im Block-Explorer auf der Registerkarte Daten können Sie herausfinden, zu wie vielen WAVES in der allgemeinen Brieftasche gehören. </p><br><p>  Cooper änderte seine Meinung darüber, den Betrag von 1 WAVES auf einer gemeinsamen Brieftasche zu belassen, und beschloss, die Hälfte der Affinitäten zurückzuziehen.  Dazu muss die Rückzugsfunktion aufgerufen werden. </p><br><p><img src="https://habrastorage.org/webt/hl/qx/df/hlqxdfug5ulr-z4hid9b2fvsmj0.png"></p><br><p>  Wir haben uns jedoch erneut geirrt, da die Rückzugsfunktion völlig andere Parameter hat, eine andere Signatur.  Achten Sie beim Entwerfen intelligenter Verträge auf RIDE4DAPPS auf diesen Moment. </p><br><p><img src="https://habrastorage.org/webt/a3/p7/jj/a3p7jjgxl3do4hwd_wrgtahjizs.png"></p><br><p>  Cooper hat 2,48 WAVES in seiner Bilanz.  Dementsprechend 3 WELLEN - 1 - 0,01 und dann + 0,5 - 0,01.  Dementsprechend kostet jeder Anruf zum Ein- und Auszahlen 0,01 WAVES.  Infolgedessen haben sich die Einträge in der dApps-Besitzertabelle wie folgt geändert. </p><br><p><img src="https://habrastorage.org/webt/dw/lm/sx/dwlmsx3wg_jheu1nj9urontq_wc.png"></p><br><p>  Bob beschloss auch, einen bestimmten Betrag aus dem gesamten Portemonnaie abzuziehen, täuschte sich jedoch und versuchte, 1,5 WELLEN zu extrahieren. </p><br><p><img src="https://habrastorage.org/webt/ba/vo/w3/bavow3e9pvqjsyaxgzipnt_n1ly.png"></p><br><p>  Der Smart-Vertrag hatte jedoch eine Überprüfung für eine solche Situation. </p><br><p>  Xena ist ein Betrüger, sie hat versucht, 1 WAVES vom allgemeinen Konto abzuheben. </p><br><p><img src="https://habrastorage.org/webt/us/kg/5w/uskg5wgcu_xubpmskq0x37lsox4.png"></p><br><p>  Sie hat auch versagt. </p><br><p>  Im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nächsten</a> Teil werden wir komplexere Probleme im Zusammenhang mit der Unvollkommenheit des Alice dApp-Kontos betrachten. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de447790/">https://habr.com/ru/post/de447790/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de447754/index.html">Menüleisten-App für macOS</a></li>
<li><a href="../de447756/index.html">Neuer Gartner Quadrant für Application Monitoring Solutions (APM)</a></li>
<li><a href="../de447758/index.html">Hacking-Geschichte eines klassischen Dendy- oder Contra-Spiels für 100 Leben</a></li>
<li><a href="../de447786/index.html">Hintergrund: Robot Fedor, was bist du?</a></li>
<li><a href="../de447788/index.html">Wir haben einen Nachrichtenaggregator mit Schwerpunkt auf Kryptowährungen erstellt - intwt.com</a></li>
<li><a href="../de447792/index.html">Dunkle Muster und das Gesetz: Wie US-Regulierungsbehörden versuchen, die Produktmechanik zu kontrollieren und den Einfluss von Technologieunternehmen zu verringern</a></li>
<li><a href="../de447794/index.html">Über einfache Dinge, kompliziert. Ein Brief eines Chemikers an einen 3D-Drucker. Lösungsmittel für Kunststoffe und Schutz gegen diese</a></li>
<li><a href="../de447798/index.html">Wie kann man ein riesiges Finanzdiagramm mit Geldwäschemustern erstellen?</a></li>
<li><a href="../de447802/index.html">Isabella 2</a></li>
<li><a href="../de447804/index.html">Die Zwergenfestung verzichtet auf Textgrafiken, aber nicht auf deren Essenz</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>