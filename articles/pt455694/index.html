<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶á üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø üîß Arquitetura de cobran√ßa de pr√≥xima gera√ß√£o: transi√ß√£o para Tarantool üö£üèø üíÜüèª üë®‚Äçüëß‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Por que uma empresa como a MegaFon, Tarantool no faturamento? Do lado de fora, parece que o vendedor geralmente vem, traz uma caixa grande, conecta o ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arquitetura de cobran√ßa de pr√≥xima gera√ß√£o: transi√ß√£o para Tarantool</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/455694/">  Por que uma empresa como a MegaFon, Tarantool no faturamento?  Do lado de fora, parece que o vendedor geralmente vem, traz uma caixa grande, conecta o plugue √† tomada - aqui vem a cobran√ßa!  Antes, mas agora √© um arcaico, e esses dinossauros j√° se extinguiram ou est√£o se extinguindo.  Inicialmente, o faturamento √© um sistema de faturamento - um leitor ou calculadora.  Nas telecomunica√ß√µes modernas, este √© um <b>sistema para automatizar todo o ciclo de vida da intera√ß√£o com o assinante, desde a celebra√ß√£o do contrato at√© a rescis√£o</b> , incluindo cobran√ßa em tempo real, aceita√ß√£o de pagamento e muito mais.  O faturamento nas empresas de telecomunica√ß√µes √© semelhante a um rob√¥ de combate - grande, poderoso e cheio de armas. <br><br><img src="https://habrastorage.org/webt/fm/qq/n0/fmqqn0374oz43yleqaghmzfmh3i.jpeg"><br><br>  E aqui est√° Tarantool?  <b>Oleg Ivlev</b> e <b>Andrey Knyazev</b> v√£o falar sobre isso.  Oleg √© o arquiteto chefe da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MegaFon,</a> com uma vasta experi√™ncia trabalhando em empresas estrangeiras, Andrey √© o diretor de sistemas de neg√≥cios.  A partir da transcri√ß√£o de seu relat√≥rio na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Tarantool Conference 2018,</a> voc√™ aprender√° por que a pesquisa e o desenvolvimento s√£o necess√°rios nas empresas, o que √© Tarantool, como o impasse para o dimensionamento vertical e a globaliza√ß√£o se tornou os pr√©-requisitos para o surgimento desse banco de dados na empresa, sobre desafios tecnol√≥gicos, a transforma√ß√£o da arquitetura e como o technostek da MegaFon se assemelha √† Netflix, Google e Amazon. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/bW24mJwSllQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h2>  Projeto de faturamento √∫nico </h2><br>  O projeto que ser√° discutido √© chamado "Faturamento √∫nico".  Foi nele que Tarantool mostrou suas melhores qualidades. <br><br><img src="https://habrastorage.org/webt/gz/zv/uz/gzzvuztrluedxrko5az64xmlqs4.jpeg"><br><br>  O crescimento do desempenho dos equipamentos Hi-End n√£o acompanhou o crescimento da base de assinantes e o crescimento no n√∫mero de servi√ßos, era esperado um maior crescimento no n√∫mero de assinantes e servi√ßos devido ao M2M, IoT, e os recursos das filiais levaram a uma deteriora√ß√£o do tempo de coloca√ß√£o no mercado.  A empresa decidiu criar um sistema comercial unificado com uma arquitetura modular de classe mundial exclusiva, em vez de 8 sistemas de cobran√ßa diferentes atuais. <br><br>  <b>MegaFon √© oito empresas em uma</b> .  Em 2009, a reorganiza√ß√£o foi conclu√≠da: filiais em toda a R√∫ssia se fundiram em uma √∫nica empresa MegaFon OJSC (agora PJSC).  Assim, a empresa possui 8 sistemas de cobran√ßa com suas pr√≥prias solu√ß√µes ‚Äúpersonalizadas‚Äù, recursos de filiais e uma estrutura organizacional diferente, TI e marketing. <br><br>  Tudo estava bem at√© que eu tive que lan√ßar um produto federal comum.  Muitas dificuldades apareceram aqui: para alguns, tarifando o arredondamento, para outros, em menor grau, e para outros, de acordo com a m√©dia aritm√©tica.  Existem milhares desses momentos. <br><br>  Apesar do fato de a vers√£o do sistema de cobran√ßa ser a mesma, de um fornecedor, as configura√ß√µes divergiram para que a cola por muito tempo.  Tentamos reduzir o n√∫mero deles e deparamos com um segundo problema que √© familiar para muitas empresas. <br><br>  <b>Escala vertical</b> .  Mesmo o ferro mais frio da √©poca n√£o atendia √†s necessidades.  Usamos o equipamento Hewlett-Packard, a linha Superdome Hi-End, mas isso n√£o exigiu nem duas ramifica√ß√µes.  Eu queria escala horizontal sem grandes custos de transa√ß√£o e investimentos de capital. <br><br>  <b>Expectativa de crescimento no n√∫mero de assinantes e servi√ßos</b> .  Os consultores h√° muito trazem hist√≥rias sobre IoT e M2M para o mundo das telecomunica√ß√µes: chegar√° o momento em que cada telefone e ferro de passar ter√£o um cart√£o SIM e dois na geladeira.  Hoje temos um n√∫mero de assinantes e, em um futuro pr√≥ximo, haver√° uma ordem de magnitude a mais. <br><br><h2>  Desafios tecnol√≥gicos </h2><br>  Esses quatro motivos nos levaram a grandes mudan√ßas.  Havia uma escolha entre atualizar o sistema e projetar do zero.  Eles pensaram por um longo tempo, tomaram decis√µes s√©rias, jogaram propostas.  Como resultado, eles decidiram projetar desde o in√≠cio e assumiram desafios interessantes - desafios tecnol√≥gicos. <br><br><h3>  Escalabilidade </h3><br>  Se antes existiam, digamos, <b>8 contas de faturamento para 15 milh√µes de assinantes</b> , e agora <b>100 milh√µes de assinantes e mais</b> deveriam ter <b>sa√≠do</b> - a carga √© uma ordem de magnitude maior. <br><br><blockquote>  N√≥s nos tornamos compar√°veis ‚Äã‚Äãem escala aos principais players da Internet, como Mail.ru ou Netflix. </blockquote><br>  Por√©m, mais movimentos para aumentar a carga e a base de assinantes representaram s√©rios desafios para n√≥s. <br><br><h3>  A geografia do nosso vasto pa√≠s </h3><br>  Entre Kaliningrado e Vladivostok, <b>7500 km e 10 fusos hor√°rios</b> .  A velocidade da luz √© finita e a esse atraso as dist√¢ncias j√° s√£o significativas.  150 ms nos canais √≥pticos modernos mais legais √© um pouco demais para o faturamento em tempo real, especialmente como agora nas telecomunica√ß√µes na R√∫ssia.  Al√©m disso, voc√™ precisa atualizar em um dia √∫til e com fusos hor√°rios diferentes - isso √© um problema. <br><br>  N√£o fornecemos apenas servi√ßos por uma taxa mensal, temos tarifas complexas, pacotes e v√°rios modificadores.  Precisamos n√£o apenas permitir ou proibir o assinante de falar, mas dar a ele uma certa cota - calcular chamadas e a√ß√µes em tempo real para que ele n√£o perceba. <br><br><h3>  Toler√¢ncia a falhas </h3><br><blockquote>  Este √© o outro lado da centraliza√ß√£o. </blockquote><br>  Se coletarmos todos os assinantes em um sistema, quaisquer eventos e desastres de emerg√™ncia ser√£o desastrosos para os neg√≥cios.  Portanto, projetamos o sistema de forma a excluir o efeito de acidentes em toda a base de assinantes. <br><br>  Isso √© novamente uma consequ√™ncia da rejei√ß√£o da escala vertical.  Quando entramos no dimensionamento horizontal, aumentamos o n√∫mero de servidores de centenas para milhares.  Eles precisam ser gerenciados e intercambi√°veis, com backup autom√°tico da infraestrutura de TI e sistema distribu√≠do restaurado. <br><br>  Desafios t√£o interessantes nos confrontaram.  Projetamos o sistema e, naquele momento, tentamos encontrar as melhores pr√°ticas do mundo para verificar o quanto estamos em tend√™ncia, o quanto seguimos tecnologias avan√ßadas. <br><br><h2>  Experi√™ncia mundial </h2><br><blockquote>  Surpreendentemente, no mundo das telecomunica√ß√µes, n√£o encontramos uma √∫nica refer√™ncia. </blockquote><br>  A Europa caiu pelo n√∫mero de assinantes e escala, os Estados Unidos - pelo plano de suas tarifas.  Vimos algo na China, mas encontramos algo na √çndia e levamos especialistas da Vodafone India. <br><br>  Para analisar a arquitetura, o Dream Team foi montado, liderado pela IBM, arquitetos de v√°rias √°reas.  Essas pessoas podem avaliar adequadamente o que estamos fazendo e trazer certo conhecimento √† nossa arquitetura. <br><br><h2>  Escala </h2><br>  Alguns n√∫meros para ilustrar. <br><br>  Projetamos um sistema para <b>80 milh√µes de assinantes com uma reserva de um bilh√£o</b> .  Portanto, removemos os limites futuros.  Isso n√£o ocorre porque vamos dominar a China, mas devido √† press√£o da IoT e M2M. <br><br>  <b>300 milh√µes de documentos s√£o processados ‚Äã‚Äãem tempo real</b> .  Embora tenhamos 80 milh√µes de assinantes, trabalhamos com clientes em potencial e aqueles que nos deixaram, se precisarmos receber receb√≠veis.  Portanto, os volumes reais s√£o muito maiores. <br><br>  <b>2 bilh√µes de transa√ß√µes</b> diariamente alteram o saldo - s√£o pagamentos, cobran√ßas, chamadas e outros eventos.  <b>200 TB de dados mudam ativamente</b> , <b>8 PB de dados</b> mudam um pouco mais devagar, e isso n√£o √© um arquivo morto, mas dados ativos em um √∫nico faturamento.  A escala do data <b>center</b> √© de <b>5 mil servidores em 14 sites</b> . <br><br><h2>  Pilha de tecnologia </h2><br>  Quando planejamos a arquitetura e montamos o sistema, importamos as tecnologias mais interessantes e avan√ßadas.  O resultado foi uma pilha tecnol√≥gica familiar a qualquer player da Internet e empresas que fabricam sistemas altamente carregados. <br><br><img src="https://habrastorage.org/webt/cq/km/ys/cqkmyscpadcxt7nokj1_y_fwlny.jpeg"><br><br>  A pilha √© semelhante √†s pilhas de outros grandes players: Netflix, Twitter, Viber.  √â composto por 6 componentes, mas queremos reduzi-lo e unific√°-lo. <br><br><blockquote>  A flexibilidade √© boa, mas em uma grande corpora√ß√£o n√£o h√° meio sem unifica√ß√£o. </blockquote><br>  N√£o vamos mudar o mesmo Oracle para Tarantool.  Nas realidades das grandes empresas, isso √© utopia ou uma cruzada por 5 a 10 anos com um resultado incompreens√≠vel.  Mas Cassandra e Couchbase podem ser substitu√≠dos por Tarantool, e estamos comprometidos com isso. <br><br><h2>  Porqu√™ Tarantool? </h2><br>  Existem 4 crit√©rios simples para escolhermos esse banco de dados. <br><br>  <b>Velocidade</b> .  Realizamos testes de estresse nos sistemas industriais MegaFon.  O Tarantool venceu - mostrou o melhor desempenho. <br><br>  Isso n√£o quer dizer que outros sistemas n√£o atendam √†s necessidades do MegaFon.  As solu√ß√µes atuais de mem√≥ria s√£o t√£o produtivas que esse estoque da empresa √© mais que suficiente.  Mas estamos interessados ‚Äã‚Äãem lidar com o l√≠der, e n√£o com quem tece na cauda, ‚Äã‚Äãincluindo o teste de carga. <br><br><blockquote>  Tarantool cobre as necessidades da empresa, mesmo a longo prazo. </blockquote><br>  <b>Custo de TCO</b> .  O suporte ao Couchbase nos volumes MegaFon custa muito espa√ßo, com o Tarantool a situa√ß√£o √© muito mais agrad√°vel e, em termos de funcionalidade, eles est√£o pr√≥ximos. <br><br>  Outro recurso interessante que influenciou levemente a nossa escolha - o Tarantool funciona melhor que outros bancos de dados com mem√≥ria.  Mostra <b>efici√™ncia m√°xima</b> . <br><br>  <b>Confiabilidade</b>  O MegaFon √© investido em confiabilidade, provavelmente como nenhum outro.  Portanto, quando analisamos o Tarantool, percebemos o que precisa ser feito para satisfazer nossos requisitos. <br><br>  Investimos nosso tempo e finan√ßas e, juntamente com o Mail.ru, criamos uma vers√£o corporativa, que agora √© usada por v√°rias outras empresas. <br><br><blockquote>  A empresa Tarantool nos satisfez totalmente com seguran√ßa, confiabilidade e registro. </blockquote><br><h3>  Parceria </h3><br>  O mais importante para mim √© <b>o contato direto com o desenvolvedor</b> .  Isso √© exatamente o que os caras do Tarantool subornaram. <br><br>  Se voc√™ procura um jogador, especialmente aquele que trabalha com um cliente √¢ncora, e diz que precisa do banco de dados para poder fazer isso, isso e aquilo, geralmente responde: <br><br>  <i>- Bem, coloque os requisitos embaixo da pilha - algum dia, provavelmente, chegaremos a eles.</i> <br><br>  Muitos t√™m um roteiro para os pr√≥ximos 2-3 anos, e √© quase imposs√≠vel integr√°-lo, e os desenvolvedores do Tarantool subornam com abertura, e n√£o apenas com o MegaFon, e adaptam seu sistema ao cliente.  Isso √© legal e n√≥s realmente gostamos. <br><br><h2>  Onde aplicamos Tarantool </h2><br>  Em n√≥s Tarantool √© usado em v√°rios elementos.  <b>O primeiro est√° no piloto</b> , que fizemos no sistema de diret√≥rio de endere√ßos.  Ao mesmo tempo, eu queria que fosse um sistema semelhante ao Yandex.Maps e ao Google Maps, mas ficou um pouco diferente. <br><br>  Por exemplo, o diret√≥rio de endere√ßo na interface de vendas.  No Oracle, a localiza√ß√£o do endere√ßo necess√°rio leva de 12 a 13 s.  - n√∫meros desconfort√°veis.  Quando mudamos para o Tarantool, substitu√≠mos o Oracle por outro banco de dados no console e realizamos a mesma pesquisa, obtemos uma acelera√ß√£o de 200 vezes!  A cidade aparece ap√≥s a terceira letra.  Agora estamos adaptando a interface para que isso aconte√ßa ap√≥s o primeiro.  No entanto, a velocidade de resposta √© completamente diferente - j√° milissegundos em vez de segundos. <br><br>  <b>O segundo aplicativo √© um t√≥pico moderno chamado TI de duas velocidades</b> .  Isso ocorre porque consultores de cada empresa dizem que as empresas devem ir para l√°. <br><br><img src="https://habrastorage.org/webt/3j/mb/oc/3jmboctdb2q3n6iwdlf1auvf_x0.jpeg"><br><br>  H√° uma camada de infraestrutura, dom√≠nios acima dela, por exemplo, um sistema de cobran√ßa, como telecomunica√ß√µes, sistemas corporativos, relat√≥rios corporativos.  Este √© o n√∫cleo que n√£o precisa ser tocado.  √â claro que isso √© poss√≠vel, mas √© paran√≥ico em fornecer qualidade, porque traz dinheiro para a corpora√ß√£o. <br><br>  Em seguida, vem a camada de microsservi√ßos - aquela que diferencia o operador ou outro jogador.  Os microsservi√ßos podem ser criados rapidamente com base em certos caches, levantando dados de diferentes dom√≠nios.  Aqui est√° um <b>campo para experimentos</b> - se algo n√£o der certo, feche um microsservi√ßo, abra outro.  Isso fornece um time-to-market verdadeiramente aprimorado e aumenta a confiabilidade e a velocidade da empresa. <br><br><blockquote>  Microsservi√ßos √© talvez o principal papel do Tarantool no MegaFon. </blockquote><br><h2>  Onde planejamos aplicar o Tarantool </h2><br>  Se compararmos nosso projeto de cobran√ßa bem-sucedido com os programas de transforma√ß√£o da Deutsche Telekom, Svyazkome, Vodafone √çndia, √© surpreendentemente din√¢mico e criativo.  No processo de implementa√ß√£o deste projeto, n√£o apenas o MegaFon e sua estrutura foram transformadas, mas tamb√©m a empresa Tarantool apareceu no Mail.ru, e nosso fornecedor Nexign (anteriormente Peter-Service) tinha uma BSS Box (solu√ß√£o de cobran√ßa em caixa). <br><br>  De certa forma, este √© um projeto hist√≥rico para o mercado russo.  Pode ser comparado com o que √© descrito no livro de Frederick Brooks "Mythical Man-Month".  Ent√£o, nos anos 60, a IBM atraiu 5.000 pessoas para desenvolver um novo sistema operacional OS / 360 para mainframes.  Temos menos - 1.800, mas os nossos est√£o em coletes e, levando em considera√ß√£o o uso de c√≥digo aberto e novas abordagens, trabalhamos de maneira mais produtiva. <br><br>  Os dom√≠nios de cobran√ßa ou, de forma mais ampla, os sistemas comerciais s√£o exibidos abaixo.  As pessoas da empresa conhecem muito bem o CRM.  Todos j√° devem ter outros sistemas: API aberta, API de gateway. <br><br><img src="https://habrastorage.org/webt/lj/g1/ec/ljg1ecnbyprze3f4js1j7899h9e.jpeg"><br><br><h3>  API aberta </h3><br>  Vejamos novamente os n√∫meros e como a API aberta funciona agora.  Sua carga √© de <b>10.000 transa√ß√µes por segundo</b> .  Como planejamos desenvolver ativamente a camada de microsservi√ßos e criar a API p√∫blica MegaFon, esperamos mais crescimento no futuro nesta parte espec√≠fica.  <b>100.000 transa√ß√µes ser√£o definitivamente</b> . <br><br>  N√£o sei se o SSO √© compar√°vel ao Mail.ru - os caras, tipo, t√™m 1.000.000 de transa√ß√µes por segundo.  Estamos extremamente interessados ‚Äã‚Äãem sua solu√ß√£o e planejamos aprender com a experi√™ncia deles - por exemplo, para fazer uma reserva de SSO funcional usando Tarantool.  Agora, os desenvolvedores do Mail.ru est√£o fazendo isso conosco. <br><br><h2>  CRM </h2><br>  CRM - esses s√£o os 80 milh√µes de assinantes que queremos trazer para um bilh√£o, porque j√° existem 300 milh√µes de documentos que incluem uma hist√≥ria de tr√™s anos.  Estamos realmente ansiosos por novos servi√ßos, e aqui <b>o ponto de crescimento s√£o os servi√ßos conectados</b> .  Esta √© uma bola que crescer√°, porque haver√° mais e mais servi√ßos.  Por conseguinte, ser√° necess√°ria uma hist√≥ria, n√£o queremos trope√ßar nisso. <br><br>  Faturando-se em termos de faturamento, trabalhando com contas a receber de clientes foi <b>transformado em um dom√≠nio separado</b> .  Para maximizar o desempenho, o <b>modelo de arquitetura da arquitetura de dom√≠nio √© aplicado</b> . <br><br><blockquote>  O sistema √© dividido em dom√≠nios, a carga √© distribu√≠da e a toler√¢ncia a falhas √© fornecida.  Al√©m disso, trabalhamos com arquitetura distribu√≠da. </blockquote><br>  Tudo o resto s√£o solu√ß√µes de n√≠vel empresarial.  Na loja de chamadas - <b>2 bilh√µes por dia</b> , 60 bilh√µes por m√™s.  √Äs vezes, √© necess√°rio recont√°-las por um m√™s, e melhor rapidamente.  <b>O monitoramento financeiro</b> √© precisamente os 300 milh√µes que crescem e crescem constantemente: os assinantes costumam correr entre as operadoras, aumentando essa parte. <br><br>  O componente de telecomunica√ß√µes mais importante das comunica√ß√µes m√≥veis √© o <b>faturamento online</b> .  Estes s√£o os sistemas que permitem ligar ou n√£o ligar, tomar uma decis√£o em tempo real.  Aqui, a carga √© de 30.000 transa√ß√µes por segundo, mas, considerando o crescimento da transfer√™ncia de dados, planejamos <b>250.000 transa√ß√µes</b> e, portanto, estamos muito interessados ‚Äã‚Äãno Tarantool. <br><br>  A imagem anterior √© dos dom√≠nios em que vamos usar o Tarantool.  O pr√≥prio CRM, √© claro, √© mais amplo e vamos aplic√°-lo no pr√≥prio n√∫cleo. <br><br>  Nosso TTX estimado de 100 milh√µes de assinantes me confunde como arquiteto - e se 101 milh√µes?  Refazer tudo de novo?  Para evitar isso, usamos caches, ao mesmo tempo aumentando a acessibilidade. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/167/a80/b0e/167a80b0e38db7f135407b097284a3ff.jpg"><br><br>  Em geral, existem duas abordagens para o uso do Tarantool.  O primeiro √© <b>criar todos os caches no n√≠vel do microsservi√ßo</b> .  Pelo que entendi, o VimpelCom segue esse caminho, criando um cache de cliente. <br><br>  Somos menos dependentes de fornecedores, estamos mudando o n√∫cleo do BSS, por isso temos um √∫nico √≠ndice de cart√£o de cliente pronto para uso.  Mas queremos bordar.  Portanto, usamos uma abordagem um pouco diferente - <b>fazemos caches dentro dos sistemas</b> . <br><br><blockquote>  Portanto, h√° menos de um rassynchron - um sistema √© respons√°vel pelo cache e pela fonte principal principal. </blockquote><br>  O m√©todo se adapta bem √† abordagem do esqueleto transacional Tarantool, quando apenas as partes relacionadas √†s atualiza√ß√µes, ou seja, altera√ß√µes de dados, s√£o atualizadas.  Todo o resto pode ser armazenado em outro lugar.  N√£o h√° um lago de dados enorme, cache global n√£o gerenciado.  Os caches s√£o projetados para o sistema, seja para produtos ou para clientes, ou para facilitar a vida do servi√ßo.  Quando um assinante chama chateado pela qualidade, quero atend√™-lo qualitativamente. <br><br><h2>  RTO e RPO </h2><br>  Existem dois termos em TI - <b>RTO</b> e <b>RPO</b> . <br><br>  <b>O objetivo</b> do tempo de recupera√ß√£o √© o tempo para recuperar um servi√ßo ap√≥s uma falha.  RTO = 0 significa que, mesmo que algo caia, o servi√ßo continuar√° funcionando. <br><br>  <b>O objetivo do ponto</b> de recupera√ß√£o √© o tempo para recuperar dados, quantos dados podemos perder por um per√≠odo de tempo.  RPO = 0 significa que n√£o estamos perdendo dados. <br><br><h2>  Desafio Tarantool </h2><br>  Vamos tentar resolver o problema do Tarantool. <br><br>  <b>Dado</b> : todo mundo entende a cesta de aplicativos, por exemplo, na Amazon ou em outro lugar.  <b>A</b> cesta √© <b>obrigada</b> a funcionar 24 horas, 7 dias por semana, ou 99,99% do tempo.  Os pedidos que chegam at√© n√≥s devem manter a ordem, porque n√£o podemos ativar ou desativar a comunica√ß√£o aleatoriamente para o assinante - tudo deve ser estritamente consistente.  A assinatura anterior afeta a pr√≥xima, portanto os dados s√£o importantes - nada deve ser perdido. <br><br>  <b>Solu√ß√£o</b> .  Voc√™ pode tentar resolv√™-lo e perguntar aos desenvolvedores do banco de dados, mas o problema n√£o √© matematicamente resolvido.  Pode-se lembrar teoremas, leis de conserva√ß√£o, f√≠sica qu√¢ntica, mas por que - n√£o pode ser resolvido no n√≠vel do BD. <br><br>  A boa e antiga abordagem arquitet√¥nica funciona aqui - voc√™ precisa conhecer bem a √°rea de assunto e √†s suas custas resolver esse rebus. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/944/6e3/d25/9446e3d25815306bbe9dce45df4350ab.jpg"><br><br>  <b>Nossa solu√ß√£o: crie um registro distribu√≠do de aplicativos para o Tarantool - um cluster distribu√≠do geograficamente</b> .  No diagrama, s√£o tr√™s centros de dados diferentes - dois para os Urais, um al√©m dos Urais, e distribu√≠mos todos os aplicativos para esses centros. <br><br>  A Netflix, hoje considerada uma das l√≠deres em TI, tinha apenas um data center at√© 2012.  Na v√©spera do Natal cat√≥lico em 24 de dezembro, esse data center caiu.  Os usu√°rios do Canad√° e dos Estados Unidos ficaram sem seus filmes favoritos, muito chateados e escreveram sobre isso nas redes sociais.  A Netflix agora tem tr√™s data centers na costa oeste-leste e um na Europa ocidental. <br><br><blockquote>  Inicialmente, criamos uma solu√ß√£o distribu√≠da geograficamente - a toler√¢ncia a falhas √© importante para n√≥s. </blockquote><br>  Portanto, temos um cluster, mas e RPO = 0 e RTO = 0?  A solu√ß√£o √© simples, dependendo do assunto. <br><br>  O que √© importante nas aplica√ß√µes?  Duas partes: jogando a cesta <b>antes de</b> tomar uma decis√£o de compra e depois.  Uma parte do DO em uma telecom √© geralmente chamada de <b>captura</b> ou <b>negocia√ß√£o de pedidos</b> .  No setor de telecomunica√ß√µes, isso pode ser muito mais complicado do que na loja on-line, porque √© necess√°rio atender o cliente, oferecer cinco op√ß√µes e tudo isso acontece por um tempo, mas a cesta est√° cheia.  Nesse ponto, uma falha √© poss√≠vel, mas n√£o √© assustadora, porque ocorre de modo interativo sob a supervis√£o de uma pessoa. <br><br>  Se o data center de Moscou falhar repentinamente, e depois mudar automaticamente para outro data center, continuaremos trabalhando.  Teoricamente, um produto em uma cesta pode ser perdido, mas voc√™ v√™ isso, complemente a cesta novamente e continue trabalhando.  Nesse caso, RTO = 0. <br><br>  No mesmo momento, existe uma segunda op√ß√£o: quando clicamos em "enviar", queremos que os dados n√£o sejam perdidos.  A partir desse momento, a automa√ß√£o come√ßa a funcionar - isso j√° √© RPO = 0. A aplica√ß√£o desses dois padr√µes diferentes em um caso pode ser apenas um cluster distribu√≠do geograficamente com um mestre comut√°vel, no outro caso, algum tipo de entrada de quorum.  Os padr√µes podem variar, mas resolvemos o problema. <br><br>  Al√©m disso, com um registro distribu√≠do de aplicativos, tamb√©m podemos dimensionar tudo - para ter muitos despachantes e contratados que acessam esse registro. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/28f/ab6/da3/28fab6da317b89510738c9b2497fe529.jpg"><br><br><h2>  Cassandra e Tarantool juntos </h2><br>  H√° outro caso - a <b>"vitrine de saldos"</b> .  Aqui est√° apenas um caso interessante do uso conjunto de Cassandra e Tarantool. <br><br>  Usamos o Cassandra, porque 2 bilh√µes de chamadas por dia n√£o √© o limite e haver√° mais.  Os profissionais de marketing gostam de colorir o tr√°fego por fonte; h√° mais e mais detalhes nas redes sociais, por exemplo.  Isso tudo aumenta a hist√≥ria. <br><br><blockquote>  Cassandra permite que voc√™ dimensione horizontalmente para qualquer volume. </blockquote><br>  Nos sentimos confort√°veis ‚Äã‚Äãcom Cassandra, mas ela tem um problema - ela n√£o √© boa em ler.    , 30 000     ‚Äî <b>  </b> . <br><br>     ,      :    ,      -   ,     Cassandra.        ,     IBM manager file transfer ‚Äî   ,     ,   UDP, ,   TCP.  ,    ,       ,   -    ,       ‚Äî  . <br><br>    ,  <b>   </b> .      Kafka  Tarantool,     , ,  ,   <b> </b> ,       , , 100        2 . <br><br>   ,       2         ,    ,   . <br><br><h2>  Conclus√£o </h2><br>     Tarantool.     Mail.ru,     . <br><br>   BCG  McKinsey, Accenture  IBM     -  ‚Äî   ,   ,    ,  ,   . ,  Tarantool             .       . <br><br><blockquote>     ‚Äî     Tarantool Conference  ,   17      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">T+ Conference 2019</a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">¬´ Tarantool  Enterprise¬ª</a> .         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">¬´ Tarantool    Oracle¬ª</a> . ,  ,    .  ‚Äî  ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>    :  ,    Tarantool, , ,   . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt455694/">https://habr.com/ru/post/pt455694/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt455678/index.html">No caminho de Sergey Pavlovich Korolev. Projeto tripulado russo moderno. Parte 1. "Federa√ß√£o"</a></li>
<li><a href="../pt455682/index.html">Quanto voc√™ gasta em infraestrutura? E como economizar nisso?</a></li>
<li><a href="../pt455684/index.html">Por que realizamos um hackathon para testadores</a></li>
<li><a href="../pt455686/index.html">Como escolher a melhor ferramenta de gerenciamento de projetos se voc√™ √© milenar?</a></li>
<li><a href="../pt455692/index.html">ASZP: restyling ou teatro come√ßa com um cabide</a></li>
<li><a href="../pt455696/index.html">O estado eletr√¥nico do futuro. Parte 2</a></li>
<li><a href="../pt455698/index.html">O livro "Como funciona o JavaScript"</a></li>
<li><a href="../pt455700/index.html">4 truques que nos ajudaram a otimizar o frontend</a></li>
<li><a href="../pt455702/index.html">Gera√ß√£o efetiva de n√∫meros em um determinado intervalo</a></li>
<li><a href="../pt455710/index.html">Por que n√≥s da Leroy Merlin precisamos de nosso pr√≥prio departamento de desenvolvimento russo para 200 pessoas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>