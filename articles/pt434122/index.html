<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç¥ üíè ‚úíÔ∏è Roteiro - N√£o √© um objeto de p√°gina ‚ù§Ô∏è ü§∂üèø üë®üèø‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Com o tempo, fazer altera√ß√µes em qualquer produto se torna mais dif√≠cil, e h√° um risco crescente de n√£o apenas lan√ßar novos recursos, mas tamb√©m quebr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Roteiro - N√£o √© um objeto de p√°gina</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/arcadia/blog/434122/"><p>  Com o tempo, fazer altera√ß√µes em qualquer produto se torna mais dif√≠cil, e h√° um risco crescente de n√£o apenas lan√ßar novos recursos, mas tamb√©m quebrar os antigos.  Freq√ºentemente, em vez de verificar manualmente todo o projeto, eles tentam automatizar esse processo.  Se voc√™ conversar com pessoas que testam interfaces e andam por confer√™ncias, fica claro que, no mundo dos testes na Web, as regras do Selenium e a grande maioria usam o Page Object como organiza√ß√£o do c√≥digo. </p><br><p>  Mas para mim, como programador, por alguma raz√£o, nunca gostei desse padr√£o e c√≥digo que vi com equipes diferentes - as letras SOLID soavam na minha cabe√ßa.  Mas eu estava pronto para aceitar o fato de que os testadores escrevem o c√≥digo como desejam, devido √† falta de alternativas, h√° cerca de um ano, no Angular Connect, ouvi um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rio</a> sobre o teste de aplicativos Angular usando o padr√£o Screenplay.  Agora eu quero compartilhar. </p><br><p><img src="https://habrastorage.org/webt/or/lk/kp/orlkkp4zbclrby1wg1sudwl64cm.jpeg"></p><a name="habracut"></a><br><h1 id="podopytnyy-krolik">  Coelho experimental </h1><br><p>  Primeiro, uma breve descri√ß√£o das ferramentas utilizadas.  Como exemplo de implementa√ß√£o, utilizarei o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SerenityJS</a> do relat√≥rio original, com o TypeScript como a linguagem dos scripts de teste. </p><br><p> Vamos colocar experimentos sobre o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aplicativo TODO</a> - um aplicativo para criar uma lista simples de tarefas.  Como exemplos, usaremos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√≥digo</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Jan Molak</a> , o criador da biblioteca (c√≥digo TypeScript, ent√£o o destaque foi um pouco). </p><br><h1 id="nachnyom-v-2009-m-godu">  Vamos come√ßar em 2009 </h1><br><p>  Nesse momento, o Selenium WebDriver apareceu e as pessoas come√ßaram a us√°-lo.  Infelizmente, em um grande n√∫mero de casos, devido √† novidade da tecnologia e √† falta de experi√™ncia em programa√ß√£o, isso est√° errado.  Os testes foram copiados e colados completos, sem suporte e "fr√°geis". </p><br><p>  O resultado √© um feedback negativo e uma m√° reputa√ß√£o com autotestes.  No final, Simon Stewart, criador do Selenium WebDriver, respondeu √† revelia em seu artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Meus testes de sel√™nio n√£o s√£o est√°veis!</a>  .  A mensagem geral: "se seus testes s√£o fr√°geis e n√£o funcionam bem - n√£o √© por causa do Selenium, mas porque os testes em si n√£o s√£o muito escritos". </p><br><p>  Para entender o que est√° em jogo, vamos dar uma olhada no seguinte cen√°rio do usu√°rio: </p><br><pre><code class="plaintext hljs">Feature: Add new items to the todo list In order to avoid having to remember things that need doing As a forgetful person I want to be able to record what I need to do in a place where I won't forget about them Scenario: Adding an item to a list with other items Given that James has a todo list containing Buy some cookies, Walk the dog When he adds Buy some cereal to his list Then his todo list should contain Buy some cookies, Walk the dog, Buy some cereal</code> </pre> <br><p>  A implementa√ß√£o ing√™nua "na testa" ser√° assim: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { browser, by, element, protractor } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">todoUserSteps</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Given(<span class="hljs-regexp"><span class="hljs-regexp">/^.*that (.*) has a todo list containing (.*)$/</span></span>, (name: string, <span class="hljs-attr"><span class="hljs-attr">items</span></span>: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { browser.get(<span class="hljs-string"><span class="hljs-string">'http://todomvc.com/examples/angularjs/'</span></span>); browser.driver.manage().window().maximize(); listOf(items).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> { element(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)).sendKeys(item, protractor.Key.ENTER); }); browser.driver.controlFlow().execute(callback); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.When(<span class="hljs-regexp"><span class="hljs-regexp">/^s?he adds (.*?) to (?:his|her) list$/</span></span>, (itemName: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { element(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)) .sendKeys(itemName, protractor.Key.ENTER) .then(callback); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Then(<span class="hljs-regexp"><span class="hljs-regexp">/^.* todo list should contain (.*?)$/</span></span>, (items: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { expect(element.all(by.repeater(<span class="hljs-string"><span class="hljs-string">'todo in todos'</span></span>)).getText()) .to.eventually.eql(listOf(items)) .and.notify(callback); }); };</code> </pre> <br><p>  Como voc√™ pode ver, uma API de baixo n√≠vel √© usada aqui, manipula√ß√µes com o DOM, copiar e colar de seletores de css.  √â claro que, no futuro, mesmo com uma pequena altera√ß√£o na interface do usu√°rio, voc√™ precisar√° alterar o c√≥digo em muitos lugares. </p><br><p>  Como solu√ß√£o, o Selenium precisava oferecer algo bom o suficiente para se livrar desses problemas e, ao mesmo tempo, acess√≠vel a pessoas com pouca ou nenhuma experi√™ncia em programa√ß√£o orientada a objetos.  Essa solu√ß√£o foi o Page Object, um padr√£o para organizar o c√≥digo. </p><br><p>  Martin Fowler o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">descreve</a> como um objeto de abstra√ß√£o em torno de uma p√°gina HTML ou de seu fragmento, permitindo que voc√™ interaja com os elementos da p√°gina sem tocar no pr√≥prio HTML.  Idealmente, esse objeto deve permitir que o c√≥digo do cliente fa√ßa e veja tudo o que uma pessoa pode fazer e ver. <br><img src="https://habrastorage.org/getpro/habr/post_images/89d/8a5/9b0/89d8a59b079f3dff71831e7f758d4e8e.png"></p><br><p>  Ap√≥s reescrever nosso exemplo de acordo com esse padr√£o, temos o seguinte: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { browser, by, element, protractor } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TodoList</span></span></span><span class="hljs-class"> </span></span>{ What_Needs_To_Be_Done = element(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)); Items = element.all(by.repeater(<span class="hljs-string"><span class="hljs-string">'todo in todos'</span></span>)); addATodoItemCalled(itemName: string): PromiseLike&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.What_Needs_To_Be_Done.sendKeys(itemName, protractor.Key.ENTER); } displayedItems(): PromiseLike&lt;string[]&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Items.getText(); } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">todoUserSteps</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> todoList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TodoList(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Given(<span class="hljs-regexp"><span class="hljs-regexp">/^.*that (.*) has a todo list containing (.*)$/</span></span>, (name: string, <span class="hljs-attr"><span class="hljs-attr">items</span></span>: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { browser.get(<span class="hljs-string"><span class="hljs-string">'http://todomvc.com/examples/angularjs/'</span></span>); browser.driver.manage().window().maximize(); listOf(items).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> { todoList.addATodoItemCalled(item); }); browser.driver.controlFlow().execute(callback); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.When(<span class="hljs-regexp"><span class="hljs-regexp">/^s?he adds (.*?) to (?:his|her) list$/</span></span>, (itemName: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { todoList.addATodoItemCalled(itemName).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> callback()); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Then(<span class="hljs-regexp"><span class="hljs-regexp">/^.* todo list should contain (.*?)$/</span></span>, (items: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { expect(todoList.displayedItems()) .to.eventually.eql(listOf(items)) .and.notify(callback); }); };</code> </pre> <br><p>  √Ä primeira vista, parece bom - nos livramos da duplica√ß√£o e adicionamos encapsulamento.  Mas h√° um problema: muitas vezes essas classes no processo de desenvolvimento crescem em tamanhos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">enormes</a> . </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/895/cea/563/895cea563685efb4c86613c9ee17d9f9.jpg"></p><br><p>  Voc√™ pode tentar decompor esse c√≥digo em componentes independentes, mas se o c√≥digo atingiu esse estado, ele j√° est√° t√£o fortemente acoplado que pode ser muito dif√≠cil e exigir√° reescrever a pr√≥pria classe e todo o c√≥digo do cliente (casos de teste) que usam esse c√≥digo. o objeto  De fato, uma classe enorme n√£o √© uma doen√ßa, mas um sintoma ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cheiro de c√≥digo</a> ).  O principal problema √© a viola√ß√£o do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Princ√≠pio da Responsabilidade √önica</a> e do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Princ√≠pio Aberto Fechado</a> .  O Objeto de P√°gina implica uma descri√ß√£o da p√°gina e todas as maneiras de interagir com ela em uma entidade, que n√£o podem ser expandidas sem alterar seu c√≥digo. </p><br><p>  Para nossas aplica√ß√µes de responsabilidade de classe TODO, s√£o as seguintes (fotos do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> ): <br><img src="https://habrastorage.org/getpro/habr/post_images/e10/92b/0d6/e1092b0d68097724e550dd2f271cf7a3.jpg" alt="Responsabilidade"></p><br><p>  Se voc√™ tentar separar essa classe com base nos princ√≠pios do SOLID, obter√° algo como o seguinte: <br><img src="https://habrastorage.org/getpro/habr/post_images/a86/9e3/d57/a869e3d571152689f7c4fd543b214057.jpg"></p><br><h1 id="domennaya-model">  Modelo de dom√≠nio </h1><br><p>  O pr√≥ximo problema que temos com o objeto de p√°gina √© que ele opera em p√°ginas.  Em qualquer teste de aceita√ß√£o, √© comum usar hist√≥rias de usu√°rios.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Behavior Driven Development (BDD)</a> e a linguagem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gherkin se</a> encaixam perfeitamente nesse modelo.  Entende-se que o caminho do usu√°rio para a meta (cen√°rio) √© mais importante que a implementa√ß√£o espec√≠fica.  Por exemplo, se voc√™ usar um widget de logon em todos os testes, ao alterar o m√©todo de logon (o formul√°rio foi movido, alternado para Logon √önico), ser√° necess√°rio alterar <em>todos os</em> testes.  Em projetos particularmente din√¢micos, isso pode ser demorado e demorado e incentivar a equipe a adiar testes de grava√ß√£o at√© que as p√°ginas se estabilizem (mesmo que tudo esteja claro nos casos de uso). </p><br><p>  Para resolver esse problema, vale a pena examin√°-lo do outro lado.  Introduzimos os seguintes conceitos: </p><br><ol><li>  Pap√©is - para quem √© tudo? </li><li>  Objetivos - por que eles (usu√°rios) est√£o aqui e o que desejam alcan√ßar? </li><li>  Tarefas - O que eles precisam fazer para alcan√ßar esses objetivos? </li><li>  A√ß√µes - como exatamente um usu√°rio deve interagir com uma p√°gina para concluir uma tarefa? </li></ol><br><p>  Assim, cada script de teste se torna, de fato, um <em>script</em> para o usu√°rio, destinado √† execu√ß√£o de uma hist√≥ria espec√≠fica do usu√°rio.  Se voc√™ combinar essa abordagem com os princ√≠pios de programa√ß√£o orientada a objetos descritos acima, o resultado ser√° um padr√£o de <em>Roteiro</em> (ou <em>Viagem do Usu√°rio</em> ).  Suas id√©ias e princ√≠pios foram expressados ‚Äã‚Äãpela primeira vez em 2007, mesmo antes do PageObject. </p><br><h1 id="screenplay">  Roteiro </h1><br><p>  Reescrevemos nosso c√≥digo usando os princ√≠pios resultantes. </p><br><p>  James √© o ator que interpretar√° nosso usu√°rio nesse cen√°rio.  Ele sabe como usar um navegador. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> james = Actor.named(<span class="hljs-string"><span class="hljs-string">'James'</span></span>).whoCan(BrowseTheWeb.using(protractor.browser));</code> </pre> <br><p>  O objetivo de James √© adicionar o primeiro item √† sua lista: </p><br><pre> <code class="plaintext hljs"> Scenario: Adding an item to a list with other items</code> </pre> <br><p>  Para atingir esse objetivo, James precisa do seguinte: </p><br><ol><li>  comece com uma lista contendo v√°rios itens, </li><li>  adicione novo item. </li></ol><br><p>  Podemos dividir isso em duas classes: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PerformsTasks, Task } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Open } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay-protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { AddATodoItem } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./add_a_todo_item'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Start</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Task</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> withATodoListContaining(items: string[]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Start(items); } performAs(actor: PerformsTasks) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> actor.attemptsTo( Open.browserOn(<span class="hljs-string"><span class="hljs-string">'/examples/angularjs/'</span></span>), ...this.addAll(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.items) ); } <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(private items: string[]) { } private addAll(items: string[]): Task[] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> items.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> AddATodoItem.called(item)); } }</code> </pre> <br><p>  A interface <code>Task</code> requer a defini√ß√£o do m√©todo <code>performAs</code> , para o qual o ator ser√° transferido durante a execu√ß√£o.  <code>attemptsTo</code> fun√ß√£o <code>attemptsTo</code> - combinator aceita qualquer n√∫mero de shuffles.  Assim, voc√™ pode construir uma variedade de sequ√™ncias.  De fato, tudo o que essa tarefa faz √© abrir um navegador na p√°gina desejada e adicionar elementos nela.  Agora, vejamos a tarefa de adicionar um elemento: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PerformsTasks, Task } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Enter } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay-protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { protractor } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { TodoList } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/todo_list'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddATodoItem</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Task</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> called(itemName: string) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AddATodoItem(itemName); } <span class="hljs-comment"><span class="hljs-comment">// required by the Task interface performAs(actor: PerformsTasks): PromiseLike&lt;void&gt; { // delegates the work to lower-level tasks return actor.attemptsTo( Enter.theValue(this.itemName) .into(TodoList.What_Needs_To_Be_Done) .thenHit(protractor.Key.ENTER) ); } constructor(private itemName: string) } }</span></span></code> </pre> <br><p>  √â mais interessante aqui: a√ß√µes de baixo n√≠vel s√£o exibidas - insira o texto no elemento da p√°gina e pressione Enter.  <code>TodoList</code> √© tudo o que resta da parte "descritiva" do Objeto de P√°gina, aqui temos seletores de css: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Target, Question, Text } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay-protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { by } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TodoList</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> What_Needs_To_Be_Done = Target .the(<span class="hljs-string"><span class="hljs-string">'"What needs to be done?" input box'</span></span>) .located(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Items = Target .the(<span class="hljs-string"><span class="hljs-string">'List of Items'</span></span>) .located(by.repeater(<span class="hljs-string"><span class="hljs-string">'todo in todos'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Items_Displayed = Text.ofAll(TodoList.Items); }</code> </pre> <br><p>  Ok, resta verificar se, ap√≥s todas as manipula√ß√µes, as informa√ß√µes corretas s√£o exibidas.  O SerenityJS oferece a interface <code>Question&lt;T&gt;</code> - uma entidade que retorna um valor exibido ou uma lista de valores ( <code>Text.ofAll</code> no exemplo acima).  Como se poderia implementar uma <em>pergunta</em> que retorna o texto de um elemento HTML: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Text</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Question</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">&gt; </span></span>{ public <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span>(target: Target): Text { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Text(target); } answeredBy(actor: UsesAbilities): PromiseLike&lt;string[]&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> BrowseTheWeb.as(actor).locate(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target).getText(); } <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(private target: Target) { } }</code> </pre> <br><p>  O que √© importante, a liga√ß√£o do navegador √© opcional.  <code>BrowseTheWeb</code> √© apenas uma <em>habilidade</em> , que permite a voc√™ interagir com o navegador.  Voc√™ pode implementar, por exemplo, a habilidade <code>RecieveEmails</code> , que permite ao ator ler cartas (para registro no site). </p><br><p>  Juntando tudo, temos esse esquema (de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Jan Molak</a> ): <br><img src="https://habrastorage.org/getpro/habr/post_images/c7c/1c1/ac3/c7c1c1ac30c645ca0d6987348274e419.png"></p><br><p>  e o seguinte cen√°rio: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> actor: Actor; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Given(<span class="hljs-regexp"><span class="hljs-regexp">/^.*that (.*) has a todo list containing (.*)$/</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name: string, items: string</span></span></span><span class="hljs-function">) </span></span>{ actor = Actor.named(name).whoCan(BrowseTheWeb.using(protractor.browser)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> actor.attemptsTo( Start.withATodoListContaining(listOf(items)) ); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.When(<span class="hljs-regexp"><span class="hljs-regexp">/^s?he adds (.*?) to (?:his|her) list$/</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">itemName: string</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> actor.attemptsTo( AddATodoItem.called(itemName) ) }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Then(<span class="hljs-regexp"><span class="hljs-regexp">/^.* todo list should contain (.*?)$/</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">items: string</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> expect(actor.toSee(TodoList.Items_Displayed)).eventually.deep.equal(listOf(items)) });</code> </pre> <br><p>  No in√≠cio, o resultado parece um pouco massivo, mas √† medida que o sistema cresce, a quantidade de c√≥digo reutilizado aumenta e as altera√ß√µes de layout e p√°gina afetam apenas os seletores de css e as tarefas / perguntas de baixo n√≠vel, deixando os scripts e as tarefas de alto n√≠vel praticamente inalterados. </p><br><h2 id="realizacii">  Implementa√ß√µes </h2><br><p>  Se falamos de bibliotecas, e n√£o de tentativas de cidades pequenas de aplicar esse padr√£o, o mais popular √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Serenity BDD</a> for Java.  Javascript / TypeScript usa sua pr√≥pria porta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SerenityJS</a> .  Fora da caixa, ela sabe como trabalhar com Pepino e Mocha. </p><br><p>  Uma pesquisa r√°pida tamb√©m produziu uma biblioteca para o .NET - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tranquire</a> .  N√£o posso dizer nada sobre ela, pois nunca a conheci antes. </p><br><p>  Ao usar o Serenity e o SerenityJS, voc√™ pode usar o utilit√°rio de gera√ß√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rios</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Relat√≥rio com fotos</b> <div class="spoiler_text"><p>  Pegue o c√≥digo usando o Mocha: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'Finding things to do'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'James can'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'remove filters so that the list'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'shows all the items'</span></span>, () =&gt; Actor.named(<span class="hljs-string"><span class="hljs-string">'James'</span></span>).attemptsTo( Start.withATodoListContaining([ <span class="hljs-string"><span class="hljs-string">'Write some code'</span></span>, <span class="hljs-string"><span class="hljs-string">'Walk the dog'</span></span> ]), CompleteATodoItem.called(<span class="hljs-string"><span class="hljs-string">'Write some code'</span></span>), FilterItems.toShowOnly(<span class="hljs-string"><span class="hljs-string">'Active'</span></span>), FilterItems.toShowOnly(<span class="hljs-string"><span class="hljs-string">'All'</span></span>), Ensure.theListOnlyContains(<span class="hljs-string"><span class="hljs-string">'Write some code'</span></span>, <span class="hljs-string"><span class="hljs-string">'Walk the dog'</span></span>), )); }); }); });</code> </pre> <br><p>  O relat√≥rio conter√° como estat√≠sticas gerais: <br><img src="https://habrastorage.org/getpro/habr/post_images/dd0/8fa/f09/dd08faf09e56d3fc272d7fab91be3d8d.png"></p><br><p>  e um detalhamento das etapas com capturas de tela: <br><img src="https://habrastorage.org/getpro/habr/post_images/3c8/19f/c52/3c819fc528d5f1af31d969af7ebbbe6e.png"></p></div></div><br><h1 id="ssylki">  Refer√™ncias </h1><br><p>  Alguns artigos relacionados: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Objetos de p√°gina refatorados: etapas do SOLID para o padr√£o de roteiro / jornada</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Al√©m dos objetos de p√°gina: automa√ß√£o de teste de pr√≥xima gera√ß√£o com serenidade e o padr√£o de roteiro</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Serenity BDD e o padr√£o de roteiro</a> </li></ol><br><p>  Artigos: </p><br><ol><li><iframe width="560" height="315" src="https://www.youtube.com/embed/8f8tdZBvAbI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></li><li><iframe width="560" height="315" src="https://www.youtube.com/embed/CocG0FBFJLU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></li></ol><br><p>  Bibliotecas: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Serenity BDD</a> - Java </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Serenity JS</a> - JavaScript / TypeScript </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tranquire</a> - .NET </li></ol><br><p>  Por favor, escreva nos coment√°rios se voc√™ usar outros padr√µes / maneiras de organizar o c√≥digo dos autotestes. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt434122/">https://habr.com/ru/post/pt434122/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt434112/index.html">Princ√≠pios de programa√ß√£o funcional em JavaScript</a></li>
<li><a href="../pt434114/index.html">19 id√©ias para desenvolvedores do Node.js que desejam crescer acima de si em 2019</a></li>
<li><a href="../pt434116/index.html">A hist√≥ria da facilidade escandalosa de invadir a infraestrutura moderna de desenvolvimento de software</a></li>
<li><a href="../pt434118/index.html">Tutorial Reagir Parte 4: Componentes pai e filho</a></li>
<li><a href="../pt434120/index.html">Tutorial React, Parte 5: Introdu√ß√£o a um aplicativo TODO, estilo b√°sico</a></li>
<li><a href="../pt434124/index.html">Ative a acelera√ß√£o de GPU no Photoshop no Wine</a></li>
<li><a href="../pt434126/index.html">Reproduzir m√≠dia usando a biblioteca VLCj</a></li>
<li><a href="../pt434128/index.html">PHP Digest No. 146 (10 a 24 de dezembro de 2018) + Resultados de 2018</a></li>
<li><a href="../pt434130/index.html">Interface reativa. Palestra de Artyom Belov no FrontTalks 2018</a></li>
<li><a href="../pt434132/index.html">Compre uma TV e enrole-a: LG planeja come√ßar a vender TVs flex√≠veis no pr√≥ximo ano</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>