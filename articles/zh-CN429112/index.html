<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤙🏿 ⏪ ✌🏻 如何在Checkpoint通过网络测试 🍗 🐜 🤲🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="大家好，我是以色列IT和安全性HackerU高等学校策展人Nikita Kurtin 

 以色列领先的信息安全公司Checkpoint今年夏天发布了一系列网络测试。 

 任务分为六类： 

 •逻辑 
 •网站 
 •编程 
 •联网 
 •倒车 
 •惊喜 

 每个方向有两个任务。 在这篇文...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>如何在Checkpoint通过网络测试</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vyshtech/blog/429112/">大家好，我是以色列IT和安全性<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>HackerU</b></a>高等学校策展人<b>Nikita</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>Kurtin</b></a> <br><br> 以色列领先的信息安全公司<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Checkpoint</a></b>今年夏天发布了一系列网络测试。 <br><br> 任务分为六类： <br><br>  •逻辑 <br>  •网站 <br>  •编程 <br>  •联网 <br>  •倒车 <br>  •惊喜 <br><br> 每个方向有两个任务。 在这篇文章中，我将告诉您如何在接下来的三个测试中仅进行四个测试： <br><br>  <b>Checkpoint</b>已经设法赢得了我的尊重和兴趣，因此我决定接受这些挑战。 但是，由于工作原因，我只能负担12个任务中的8个（来自四个不同类别）。 我设法解决了其中的7个问题。 <br><br> 挑战赛于2018年9月底正式结束。 <br><br><img src="https://habrastorage.org/webt/ms/aj/or/msajorgjjbivojhhdbh5bpk2d_c.png" alt="图片"><br><br> 因此，现在，凭着明确的良知，我可以逐步告诉您如何突破以解决以下问题： <br><br>  •逻辑挑战“ PNG ++” <br>  •网络挑战“机器人又回来了” <br>  •网络挑战赛“迭戈画廊” <br>  •编程任务“谨慎的步骤” <br>  •编程“拼图”的任务 <br>  •网络挑战“乒乓球” <br>  •联网挑战“协议” <br><br>  <u><b>挑战：PNG ++</b></u> <u><br></u> <br> 说明： <br><br> 该（链接到加密的PNG文件） <i>图像是使用自定义密码进行编码的。</i> <i><br><br></i>  <i>我们设法在这里阅读了大部分代码（链接到python代码）。</i> <i><br></i>  <i>不幸的是，有人将咖啡缓慢地洒在整个key_transformator.py上。</i> <i><br><a name="habracut"></a></i>  <i>您能帮我们解密这张图片吗？</i> <br><br>  Python代码： <br><br><img src="https://habrastorage.org/webt/zz/4y/ap/zz4yapgm1vncifqjksq4jqnbfz0.png" alt="图片"><br><br> 加密逻辑如下： <br><br>  1.将密钥长度（密钥大小）设置为4个字节 <br><br>  2.读取“ img”变量中“ flag.png”文件的字节 <br><br>  3.在文件中添加填充，至四个的第一个最接近的倍数。 填充等于丢失的字节数。 例如，如果文件长度为29个字节（缺少3个），则添加三个字节，十进制值为3（ASCII 0x03）。 或者，换句话说，填充字节不能为空（ASCII 0x00），因为其十进制值为零，这并不意味着填充。 <br><br>  4.用四个随机的大写字母（[AZ]）设置开始键。 <br><br>  5.对文件中的所有字节执行相同操作，一次加密四个字节的链 <br><br> 一个 文件中的每个字节都与密钥中的字节争吵 <br>  b。 密钥不断转换为另一个密钥，key_transformator.transform（key）负责此操作 <br>  c。 加密的字节添加到enc_data <br><br>  6.在encrypted.png中输入enc_data（加密字节） <br><br> 首先，我检查了PNG格式标头，发现前八个字节如下： <br><br>  [137，80，78，71，13，10，26，10] <br><br> 我获取了加密文件的前八个字节，并用这八个字节将它们扭曲了： <br><br><img src="https://habrastorage.org/webt/gj/2z/sv/gj2zsvokw6ajdykiypksss3hyc8.png" alt="图片"><br><br> 第一个块的键结果如下： <br>  [85，80，82，81] <br><br> 第二块-像这样： <br>  [86，81，83，82] <br><br> 由于每个后继密钥都是使用前一个密钥（key = key_transformator.transform（key）动态生成的，因此我理解了算法：在前一个密钥的每个字节上添加一个： <br>  85-&gt; 86 <br>  80-&gt; 81 <br>  82-&gt; 83 <br>  81-&gt; 82 <br><br> 然后我意识到挑战的名字隐藏了一个令人生厌的暗示。 <br><br> 我写了两个“辅助函数”： <br><br>  •“ nextKey”，它根据上一个键恢复下一个键 <br>  •“ nextChar”，它恢复下一个字母，并且在大多数情况下，如果它位于字节边界内，则仅增加一个（255） <br><br><img src="https://habrastorage.org/webt/iy/m0/ny/iym0nyw_8a8mbqtgfu3iom3zdi4.png" alt="图片"><br><br> 我将原始的4个字节[85、80 82、81]转换为字母：“ UPRQ”，然后将算法返回 <br><br><img src="https://habrastorage.org/webt/xc/4x/pf/xc4xpfo8bv7c6dx_lmy2lxxxnxm.png" alt="图片"><br><br> 该标志是在解密文件中指定的： <br><br><img src="https://habrastorage.org/webt/pu/ke/ea/pukeea0_x7zo2mc3jyv_hipjihc.png" alt="图片"><br><br>  <u><b>挑战：机器人的回归</b></u> <u><br></u> <br><br> 说明： <br><br>  <i>机器人很酷，但请相信我：他们的访问权限应受到限制！</i> 检查一下（链接） <br><br> 跟随链接，您将看到一个专门介绍机器人的页面。 基本上，所有内容都建议您检查“ robots.txt”文件的存在。 <br><br><img src="https://habrastorage.org/webt/i3/85/gp/i385gpm2k1shd1zjods7ellwhxs.png" alt="图片"><br><br> 通过将./robots.txt添加到url，我们得到以下信息： <br><br><img src="https://habrastorage.org/webt/ic/fs/qg/icfsqglz7pm83jpqhnyuibevqwm.png" alt="图片"><br><br> 我检查了./secret_login.html并遇到了注册页面 <br><br><img src="https://habrastorage.org/webt/_r/uw/uq/_ruwuq-tramkokydryvhliq6fks.png" alt="图片"><br><br> 接下来，我检查了表单的源代码以找到密码确认并看到了以下Javascript： <br><br><img src="https://habrastorage.org/webt/y1/na/pe/y1napezb5awnipexnz9pudxulbm.png" alt="图片"><br><br> 似乎在确认该值后，将其发送到授权函数，该函数使用btoa函数（Javascript中的base64解码函数）对传递的值进行解码，然后将其与字符串“ SzMzcFQjM1IwYjB0JDB1dA ==”进行比较。 <br><br> 我解码了这一行 <br><br><img src="https://habrastorage.org/webt/ho/hx/w4/hohxw4qi3wre5-6rasvxo6csv7w.png" alt="图片"><br><br> 我将结果值插入了密码字符串。 宾果！ <br><br><img src="https://habrastorage.org/webt/qe/jg/n3/qejgn31fh6jrxc-7yh7sy2g3vfk.png" alt="图片"><br><br><br>  <b><u>挑战：迭戈画廊</u></b> <b><br></b> <br> 说明： <br><br>  <i>我最近开始开发一个平台来管理猫的照片并保护我的flag.txt。</i>  <i>请检查我的系统（链接到注册表）。</i> <i><br><br></i>  <i>为了避免在安全系统中造成麻烦，例如嵌入SQL代码的能力，我想出了自己的方案。</i> <i><br><br></i>  <i>它的简短描述在这里（链接到该图）</i> <br><br> 报名表格： <br><br><img src="https://habrastorage.org/webt/5d/ml/5k/5dml5k0tqhbpkpcffcuvcir2zgq.png" alt="图片"><br><br> 预设电路： <br><br><img src="https://habrastorage.org/webt/jb/wa/jh/jbwajhtbh7rxeqwchqs4-zguhgg.png" alt="图片"><br><br> 设置测试用户名和密码后，便可以访问“ Diego”猫的公共画廊。 <br><br> 自从我注册为普通用户以来，我发现也许我需要找到一种方法来提升特权的PE（特权升级）。 通过查看针对注册用户的方案，我发现普通用户和管理员之间的区别在于方案的第三部分，中间用三个破折号隔开。 <br><br> 估计如果第一个值（用户名）是第一部分，第二个（密码）是第二部分，则角色将在具有当前权限的用户进入后立即由系统分配。 <br><br> 例如： <br><br>  START |||第一个值|||第二个值|||用户（通过Web服务添加）||| END <br><br> 我的有效载荷如下： <br><br>  •第一个值：“ niki ||| niki ||| admin ||| END \ nSTART |||其他” <br>  •第二个值：“其他” <br><br> 这可能会生成以下日志行： <br><br>  START ||| niki ||| niki |||管理员||| END <br>  START |||其他|||其他|||用户||| END <br><br> 之后，我能够以管理员身份登录并获得完整权限： <br><br><img src="https://habrastorage.org/webt/p0/1v/0h/p01v0hcr31jqfel7olalnnvyzxa.png" alt="图片"><br><br> 按下按钮只会激活一个警告，警告标志是安全的。 <br> 但是，在URL内您可以阅读： <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php</a>吗？ 查看= log.txt <br><br>  <i>通过URL</i>明确暗示了<i>LFI（本地文件包含）</i> <br><br> 我试过了 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php?view=flag.txt</a> <br><br> 旗帜是我的。 <br><br><img src="https://habrastorage.org/webt/js/ux/bj/jsuxbjcvsikvpgglmeesevd9iey.png" alt="图片"><br><br>  <b><u>挑战：谨慎的步骤</u></b> <b><br></b> <br> 说明： <br><br>  <i>这个（文件链接）是我们发现的一堆档案。</i>  <i>我们确定秘密标记隐藏在它们内部的某个位置。</i> <i><br></i>  <i>我们绝对确定要查找的数据隐藏在每个文件的注释部分中。</i> <i><br></i>  <i>您可以仔细地在文件之间查找标志吗？</i> <i><br></i>  <i>祝你好运</i> <br><br> 解压缩文件后，您将获得一个名为“ archives”的目录，其中包含两千个文件，名为“ unzipme。[Number]”。 <br><br><img src="https://habrastorage.org/webt/cu/08/gu/cu08guzhfz3ce9eypciwpsuz7so.png" alt="图片"><br><br> 我使用binwalk程序检查了第一个文件。 这是程序给我的： <br><br><img src="https://habrastorage.org/webt/dg/t5/je/dgt5je6znvxzcslet4awihbmyy8.png" alt="图片"><br><br> 是的，因此在评论部分，我们同时拥有字母和数字。 再次提示？ <br><br> 最初，我考虑过是否应该将字母与该zip文件中给定的索引连接起来，并检查下一个已经具有索引245的文件。 <br><br> 但是，这里出现了一个惊喜：第二个文件不是zip，而是rar格式。 <br><br><img src="https://habrastorage.org/webt/am/fn/wo/amfnwo5q-st0m2qqqmdb1fqw51s.png" alt="图片"><br><br> 因此，为了得到评论，我不得不“取消”它： <br><br><img src="https://habrastorage.org/webt/1a/sn/ew/1asnewamm2r4kv-ells856jizqg.png" alt="图片"><br><br> 我的逻辑是通过binwalk运行文件，如果遇到RAR，请将其解压缩以获取注释。 否则，直接查看评论部分以了解进一步的操作。 <br><br> 我的第一个猜测：数字是文件索引（每个文件的编号从0到1999）。 但是，我发现有些数字是负数，这意味着它们不能成为索引。 <br><br> 第二个猜测：这个数字是飞跃，很可能是负数。 对于每个数字，我都需要跳到下一个文件。 我知道，如果我的代码不断跳转到下一个计算的文件，则会以周期的形式创建一个小的陷阱，并且我的代码将陷入无限循环。 所以我写了一个有帐户限制的python代码。 经过几次测试，我发现数字120足够了： <br><br><img src="https://habrastorage.org/webt/i6/wp/r6/i6wpr6fkyddpaiqpj5mcqak1two.png" alt="图片"><br><br> 旗帜是我的： <br><br><img src="https://habrastorage.org/webt/az/kb/xl/azkbxlwld_iazfgfbzb9sy9zcco.png" alt="图片"><br><br> 我在下一篇文章中描述的其他三个，请阅读，尝试，我很高兴收到您的评论 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN429112/">https://habr.com/ru/post/zh-CN429112/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN429102/index.html">加拿大的电动汽车销售</a></li>
<li><a href="../zh-CN429104/index.html">高数据</a></li>
<li><a href="../zh-CN429106/index.html">独联体基础设施</a></li>
<li><a href="../zh-CN429108/index.html">谷歌：从发行中删除“盗版”链接不会解决非法内容的问题</a></li>
<li><a href="../zh-CN429110/index.html">您在教程中不太可能找到的CSS提示</a></li>
<li><a href="../zh-CN429114/index.html">如何在Checkpoint第2部分通过网络测试</a></li>
<li><a href="../zh-CN429116/index.html">创建响应图像</a></li>
<li><a href="../zh-CN429118/index.html">机场分析师</a></li>
<li><a href="../zh-CN429120/index.html">Java挑战者＃3：多态性和继承</a></li>
<li><a href="../zh-CN429122/index.html">NetApp的不久的将来</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>