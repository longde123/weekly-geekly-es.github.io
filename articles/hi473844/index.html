<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯЪа ЁЯХО ЁЯОЦя╕П рд╣рдореЗрдВ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХреЛрд▓реНрд╣реВ рдореЗрдВ C ++ 20 рд╕реЗ рд▓реЗрдХрд░ рд░реЗрдВрдЬ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреНрдпреЛрдВ рд╣реИ? тЩея╕П ЁЯРЬ ЁЯд▓ЁЯП╝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╣рд╛рд▓ рд╣реА рдореЗрдВ, рд╕реА ++ 20 рдорд╛рдирдХ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдкрд░ рдХрд╛рдлреА рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╣реИрдмреЗ ( рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЬрд╣рд╛рдВ рдХрдИ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ ) рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЕрдВрддрд░рд╛рд▓ рдХреЗ рдк...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╣рдореЗрдВ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХреЛрд▓реНрд╣реВ рдореЗрдВ C ++ 20 рд╕реЗ рд▓реЗрдХрд░ рд░реЗрдВрдЬ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреНрдпреЛрдВ рд╣реИ?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473844/"><p>  рд╣рд╛рд▓ рд╣реА рдореЗрдВ, рд╕реА ++ 20 рдорд╛рдирдХ рдореЗрдВ рд╢рд╛рдорд┐рд▓ <em>рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА</em> рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдкрд░ рдХрд╛рдлреА рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╣реИрдмреЗ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЬрд╣рд╛рдВ рдХрдИ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ</a> ) рд╢рд╛рдорд┐рд▓ рд╣реИрдВред  рдЕрдВрддрд░рд╛рд▓ рдХреЗ рдкрд░реНрдпрд╛рдкреНрдд рдЖрд▓реЛрдЪрдХ рд╣реИрдВ, рд╡реЗ рдХрд╣рддреЗ рд╣реИрдВ рдХрд┐ </p><br><ul><li>  рд╡реЗ рдмрд╣реБрдд рд╕рд╛рд░ рд╣реИрдВ рдФрд░ рдХреЗрд╡рд▓ рдмрд╣реБрдд рд╕рд╛рд░ рдХреЛрдб рдХреА рдЬрд░реВрд░рдд рд╣реИ </li><li>  рдЙрдирдХреЗ рд╕рд╛рде рдХреЛрдб рдХреА рдкрдардиреАрдпрддрд╛ рдХреЗрд╡рд▓ рдмрд┐рдЧрдбрд╝рддреА рд╣реИ </li><li>  рдЕрдВрддрд░рд╛рд▓ рдХреЛрдб рдзреАрдорд╛ </li></ul><br><p>  рдкреВрд░реА рддрд░рд╣ рд╕реЗ рджреЗрдЦрддреЗ рд╣реИрдВ <del>  рдордЬрджреВрд░реЛрдВ рдФрд░ рдХрд┐рд╕рд╛рдиреЛрдВ </del>  рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдХрд╛рд░реНрдп, рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рдЖрд▓реЛрдЪрдирд╛ рд╡реИрдз рд╣реИ <del>  рдФрд░ рдХреНрдпрд╛ рдпрд╣ рд╕рдЪ рд╣реИ рдХрд┐ рдПрд░рд┐рдХ рдирд┐рдмрд▓рд░ рдХреЛ рдмрд╛рд░реНрдЯреЛрдЬрд╝ рдорд┐рд▓реНрд╕реНрдХреА рджреНрд╡рд╛рд░рд╛ рдХрд╛рдЯ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рд╡рд╣ рдХреЗрд╡рд▓ рдкреВрд░реНрдгрд┐рдорд╛ рдХреЗ рд╕рд╛рде рд░реЗрдВрдЬ-рд╡реА 3 рд▓рд┐рдЦрддрд╛ рд╣реИ </del>  ред </p><br><p><img src="https://habrastorage.org/webt/pb/dt/ih/pbdtihbl4gn8qiqwr5uk_j8qi0a.png" alt="kdpv"></p><br><p>  рд╣рдо рдЯреНрд░реЗрдкреЗрдЬрд╝реЙрдЗрдб рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдПрдХреАрдХреГрдд рдХрд░реЗрдВрдЧреЗ: <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ f (t) = 3 t ^ 2 \ sin t ^ 3 $ рдЗрдирд▓рд╛рдЗрди $   рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ \ tau $ рдЗрдирд▓рд╛рдЗрди $   ред  рдЕрдЧрд░ <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ \ tau ^ 3 / \ pi $ рдЗрдирд▓рд╛рдЗрди $   рдПрдХ рд╡рд┐рд╖рдо рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ, рддреЛ рдЕрднрд┐рдиреНрди 2 рд╣реИред </p><a name="habracut"></a><br><p> рддреЛ, рд╕рдорд╕реНрдпрд╛: рд╣рдо рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдПрдХ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рд▓рд┐рдЦрддреЗ рд╣реИрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬреЛ рдЯреНрд░реЗрдкреЛрдЬрд╝реЙрдЗрдб рд╡рд┐рдзрд┐ рджреНрд╡рд╛рд░рд╛</a> рдЕрднрд┐рдиреНрди рдХреА рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИред  рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ, рдкрд╣рд▓реА рдирдЬрд╝рд░ рдореЗрдВ, рдпрд╣рд╛рдБ рдЕрдореВрд░реНрдд рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдЧрддрд┐ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдЪ рдирд╣реАрдВ рд╣реИред  рдХрд╛рдо рдХреЗ рд▓рд┐рдП, рдореБрдЭреЗ рдЕрдХреНрд╕рд░ "рдирдВрдмрд░ рдХреНрд░рд╢рд░" рд▓рд┐рдЦрдирд╛ рдкрдбрд╝рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдореБрдЦреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦреБрдж рд╣реИред  рдЗрд╕рд▓рд┐рдП рдореБрдЭреЗ рднреА рдЙрдирдХреЗ рдХреАрдбрд╝реЗ (рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ рдореЗрд░реЗ рд╕рд╣рдХрд░реНрдорд┐рдпреЛрдВ - рд╣рдореЗрд╢рд╛ рд╣реА рдирд╣реАрдВ) рдХрд╛ рд╕рдорд░реНрдерди рдФрд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдФрд░ рдРрд╕рд╛ рднреА рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХрд╣рддреЗ рд╣реИрдВ, рдПрдХ рд╡рд░реНрд╖ рдФрд░ рдлрд┐рд░ ... рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рджрд╕реНрддрд╛рд╡реЗрдЬ рдФрд░ рдкрд░реАрдХреНрд╖рдг рднреА рд▓рд┐рдЦрдирд╛ рд╣реЛрдЧрд╛ред </p><br><p>  рдПрдХ рдЗрдВрдЯреАрдЧреНрд░реЗрдЯрд░ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрд╛рд╕ рдХреНрдпрд╛ рддрд░реНрдХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП?  рдЗрдВрдЯреЗрдЧреНрд░реИрдмрд▓ рдлрд╝рдВрдХреНрд╢рди рдФрд░ рдЧреНрд░рд┐рдб (рдмрд┐рдВрджреБрдУрдВ рдХрд╛ рд╕реЗрдЯ) <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ t_1, t_2, t_3 ... $ рдЗрдирд▓рд╛рдЗрди $  рдЕрднрд┐рдиреНрди рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)ред  рдФрд░ рдЕрдЧрд░ рдПрдХреАрдХреГрдд рдлрд╝рдВрдХреНрд╢рди ( <code>std::function</code> рдпрд╣реАрдВ рд╣реЛрдЧрд╛) рдХреЗ рд╕рд╛рде рд╕рдм рдХреБрдЫ рд╕реНрдкрд╖реНрдЯ рд╣реИ, рддреЛ рдЧреНрд░рд┐рдб рдХреЛ рдХрд┐рд╕ рд░реВрдк рдореЗрдВ рдкреНрд░реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП?  рдЖрдЗрдП рджреЗрдЦрддреЗ рд╣реИрдВред </p><br><h2 id="varianty">  рд╡рд┐рдХрд▓реНрдк </h2><br><p>  рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП - рддрд╛рдХрд┐ рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╣реЛ - рд╣рдо рдПрдХ рдирд┐рд░рдВрддрд░ рд╕рдордп рдХрджрдо рдХреЗ рд╕рд╛рде рд▓реВрдк рдХреЗ <code>for</code> рдПрдХ рд╕рд░рд▓ рд▓рд┐рдЦреЗрдВрдЧреЗ: </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// trapezoidal rule of integration with fixed time step; // dt_fixed is the timestep; n_fixed is the number of steps double integrate() { double acc = 0; for(long long i = 1; i &lt; n_fixed - 1; ++i) { double t = dt_fixed * static_cast&lt;double&gt;(i); acc += dt_fixed * f(t); } acc += 0.5 * dt_fixed * f(0); acc += 0.5 * dt_fixed * f(tau); return acc; }</span></span></code> </pre> <br><p>  рдЗрд╕ рдЪрдХреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рдЖрдк рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдПрдХреАрдХрд░рдг рдЕрдВрддрд░рд╛рд▓ рдХреА рд╢реБрд░реБрдЖрдд рдФрд░ рдЕрдВрдд рдореЗрдВ рдФрд░ рд╕рд╛рде рд╣реА рд╕рд╛рде рдЗрд╕ рдПрдХреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЕрдВрдХреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдкрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╕реНрдЯреЙрдк - рдЯреНрд░реЗрдкреЗрдЬрд╝реЙрдЗрдб рд╡рд┐рдзрд┐ рдПрдХ рдЪрд░ рдЪрд░рдг рдХреЗ рд╕рд╛рде рднреА рд╣реЛрддреА рд╣реИ, рдФрд░ рд╣рдорд╛рд░рд╛ рдкреВрд░реНрдгрд╛рдВрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗрд╡рд▓ рдЪрд░ рдЪрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИ!  рддреЛ рдпрд╣ рд╣реИ, рд╣рдореЗрдВ рдПрдХ рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ ( <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ b $ рдЗрдирд▓рд╛рдЗрди $   ) "рдЕрд╕реНрд╡рдЪреНрдЫрддрд╛" рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╣рдорд╛рд░реЗ рдХрджрдореЛрдВ рдХреЛ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ: <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ \ Delta t (t) = \ Delta t_0 + bt $ рдЗрдирд▓рд╛рдЗрди $   ред  рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг (рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдкреИрд░рд╛рдореАрдЯрд░ рдкрд░рд┐рдЪрдп) рд╢рд╛рдпрдж рдПрдХ рд▓рд╛рдЦ рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдРрд╕рд╛ рдкреНрд░рддреАрдд рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рджреЛрд╖ рд╕рднреА рдХреЗ рд▓рд┐рдП рд╕реНрдкрд╖реНрдЯ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдФрд░ рдЕрдЧрд░ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдЕрд▓рдЧ рдХрд╛рд░реНрдп рд╣реИ?  рдФрд░ рдЕрдЧрд░ рд╣рдореЗрдВ рдЕрдкрдиреЗ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдЕрдВрддрд░рд╛рд▓ рдХреЗ рдмреАрдЪ рдореЗрдВ рдХрд╣реАрдВ рдПрдХ рдЫреЛрдЯреЗ рд╕реЗ рдХрджрдо рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ?  рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдЕрдЧрд░ рдПрдХ рдкреВрд░реНрдгрд╛рдВрдХ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╣реЛрдВ?  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рд╣рдореЗрдВ <em>рдХрд┐рд╕реА рднреА</em> рдЧреНрд░рд┐рдб рдХреЛ рд╡реНрдпрдХреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  (рдлрд┐рд░ рднреА, рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ, рдмрд╣реБрдд рдЕрдВрдд рддрдХ, рд╣рдо рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЯреНрд░реЗрдкреЛрдЬрд╝реЙрдЗрдб рд╡рд┐рдзрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ "рднреВрд▓ рдЬрд╛рдПрдВрдЧреЗ" рдФрд░ рд╕рд╛рджрдЧреА рдХреЗ рд▓рд┐рдП рд╣рдо рдПрдХ рдирд┐рд░рдВрддрд░ рдХрджрдо рдХреЗ рд╕рд╛рде рдЗрд╕рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗ, рдпрд╣ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП рдХрд┐ рдЧреНрд░рд┐рдб рдордирдорд╛рдирд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред </p><br><p>  рдЪреВрдБрдХрд┐ рдЧреНрд░рд┐рдб рдХреЛрдИ рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЙрд╕рдХреЗ рдорд╛рдиреЛрдВ рдХреЛ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ t_1, t_2, ... $ рдЗрдирд▓рд╛рдЗрди $   <code>std::vector</code> рдореЗрдВ рд▓рд┐рдкрдЯреЗ <code>std::vector</code> ред </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// trapezoidal rule of integration with fixed time step double integrate(vector&lt;double&gt; t_nodes) { double acc = 0; for(auto t: t_nodes) { acc += dt_fixed * f(t); } acc -= 0.5 * dt_fixed * f(0); acc -= 0.5 * dt_fixed * f(tau); return acc; }</span></span></code> </pre> <br><p>  рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдореЗрдВ рдкрд░реНрдпрд╛рдкреНрдд рд╕реЗ рдЕрдзрд┐рдХ рд╕рдореБрджрд╛рдп рд╣реИрдВ, рд▓реЗрдХрд┐рди рдкреНрд░рджрд░реНрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛?  рдореЗрдореЛрд░реА рдЦрдкрдд рдХреЗ рд╕рд╛рде?  рдпрджрд┐ рдкрд╣рд▓реЗ рд╕рдм рдХреБрдЫ рдкреНрд░реЛрд╕реЗрд╕рд░ рдкрд░ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдЕрдм рд╣рдореЗрдВ рдкрд╣рд▓реЗ рдореЗрдореЛрд░реА рдХреНрд╖реЗрддреНрд░ рдХреЛ рднрд░рдирд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдкрдврд╝рдирд╛ рд╣реИред  рдФрд░ рд╕реНрдореГрддрд┐ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рдПрдХ рдмрд╣реБрдд рдзреАрдореА рдЪреАрдЬ рд╣реИред  рдФрд░ рд╕реНрдореГрддрд┐ рдЕрднреА рднреА рд░рдмрд░ рдирд╣реАрдВ рд╣реИ ( <del>  рдФрд░ рд╕рд┐рд▓рд┐рдХреЙрди </del>  )ред </p><br><p>  рдЖрдЗрдП рд╕рдорд╕реНрдпрд╛ рдХреА рдЬрдбрд╝ рдХреЛ рджреЗрдЦреЗрдВред  рдПрдХ рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдЦреБрд╢ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрдпрд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ?  рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ, рд╣рдорд╛рд░реЗ рдЪрдХреНрд░ (рд▓реВрдк рдХреЗ рд▓рд┐рдП рд░реЗрдВрдЬ-рдЖрдзрд╛рд░рд┐рдд) рдХреА рдХреНрдпрд╛ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ?  <code>begin()</code> рдФрд░ <code>end()</code> рдЪрд▓рдиреЗ рд╡рд╛рд▓реЛрдВ, рдФрд░ <code>++</code> , <code>*</code> рдФрд░ <code>!=</code> рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рднреА рдХрдВрдЯреЗрдирд░ред  рддреЛ рд╣рдо рд▓рд┐рдЦреЗрдВрдЧреЗред </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   ,    ,      template &lt;typename T&gt; double integrate(T t_nodes) { double acc = 0; for(auto t: t_nodes) { acc += dt_fixed * f(t); } acc -= 0.5 * dt_fixed * f(0); acc -= 0.5 * dt_fixed * f(tau); return acc; } // ... //      class lazy_container { public: long long int n_nodes; lazy_container() { n_nodes = n_fixed; } ~lazy_container() {} class iterator { public: long long int i; // index of the current node iterator() { i = 0; } ~iterator() {} iterator&amp; operator++() { i+= 1; return *this; } // ! bool operator!=(const iterator&amp; rhs) const { return i != rhs.i; } double operator* () const { return dt_fixed * static_cast&lt;double&gt;(i); } }; iterator begin() { return iterator(); } iterator end() { iterator it; it.i = n_nodes; return it; } }; // ... //      lazy_container t_nodes; double res = integrate(t_nodes);</span></span></code> </pre> <br><p>  рд╣рдо рдпрд╣рд╛рдВ рдПрдХ рдирдП рдорд╛рди рдХреА рдЧрдгрдирд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВред <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ t_i $ рдЗрдирд▓рд╛рдЗрди $   рдорд╛рдВрдЧ рдкрд░, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рд▓реВрдк рдХреЗ <code>for</code> рдПрдХ рд╕рд░рд▓ рдореЗрдВ рдХрд┐рдпрд╛ рдерд╛ред  рдХреЛрдИ рдореЗрдореЛрд░реА рдПрдХреНрд╕реЗрд╕ рдирд╣реАрдВ рд╣реИ, рдФрд░ рдпрд╣ рдЖрд╢рд╛ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдЖрдзреБрдирд┐рдХ рд╕рдВрдХрд▓рдХ рдХреЛрдб рдХреЛ рдмрд╣реБрдд рдХреБрд╢рд▓рддрд╛ рд╕реЗ рд╕рд░рд▓ рдХрд░реЗрдВрдЧреЗред  рдЙрд╕реА рд╕рдордп, рдПрдХреАрдХреГрдд рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдХреЛрдб рдмрд╣реБрдд рдЕрдзрд┐рдХ рдирд╣реАрдВ рдмрджрд▓рд╛ рд╣реИ, рдФрд░ рдпрд╣ рдЕрднреА рднреА <code>std::vector</code> рдкрдЪрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><p>  рд▓рдЪреАрд▓рд╛рдкрди рдХрд╣рд╛рдВ рд╣реИ?  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЕрдм рд╣рдо <code>++</code> рдСрдкрд░реЗрдЯрд░ рдореЗрдВ рдХреЛрдИ рднреА рдлрд╝рдВрдХреНрд╢рди рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣реА рд╣реИ, рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдПрдХ рдПрдХрд▓ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдмрдЬрд╛рдп рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдордХреНрдЦреА рдкрд░ рдЙрддреНрдкрдиреНрди рдЧреНрд░рд┐рдб рдХреЛрдИ рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рд╣рдо рднреА (рд╢рд╛рдпрдж) рдкреНрд░рджрд░реНрд╢рди рдирд╣реАрдВ рдЦреЛрддреЗ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рдЧреНрд░рд┐рдб рдХреЛ рд╡рд┐рдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рд░ рдмрд╛рд░ рдПрдХ рдирдпрд╛ <code>lazy_container</code> рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдмрд┐рд▓реНрдХреБрд▓ рднреА рдРрд╕рд╛ рдорд╣рд╕реВрд╕ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ (рдпрд╣ рд╡рд╣реА 27 рд▓рд╛рдЗрдиреЗрдВ рд╣реИрдВ!)ред  рдмреЗрд╢рдХ, рдЖрдк рдЧреНрд░рд┐рдб рдХреЛ рд╣рдорд╛рд░реЗ рдПрдХреАрдХреГрдд рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЬрд┐рдореНрдореЗрджрд╛рд░ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ <code>lazy_container</code> рднреА <code>lazy_container</code> рд╣реИрдВ, рдЕрд░реНрдерд╛рдд, рдореБрдЭреЗ рдмрд╣рд╛рдирд╛, рдЗрд╕реЗ <code>lazy_container</code> рдХрд░реЗрдВред </p><br><p>  рдЖрдк рдкреВрдЫрддреЗ рд╣реИрдВ - рддреЛ рдлрд┐рд░ рдХреБрдЫ рдЧрд▓рдд рд╣реЛрдЧрд╛?  рд╣рд╛рдБ!  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдПрдХреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЕрдВрдХреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреНрд░реЗрд╖рд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рддреНрд░реБрдЯрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИред  рджреВрд╕рд░реЗ, рдмрдирд╛рдИ рдЧрдИ рдЧреИрд░-рдорд╛рдирдХ рд╕рд╛рдЗрдХрд┐рд▓ рдХреЛ рдХрд┐рд╕реА рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рдФрд░ рд╕рдВрднрд╡рддрдГ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреНрдпрд╛ рдЖрдк рддреБрд░рдВрдд рд╕реЛрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ, рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд╕рд╛рде, <code>++</code> рдСрдкрд░реЗрдЯрд░ рдореЗрдВ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдВрдпреЛрдЬрди рд░рдЪрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП? </p><br><p>  30 рд╕реЗ рдЕрдзрд┐рдХ рд╡рд░реНрд╖реЛрдВ рдХреЗ рд▓рд┐рдП рд╕реА ++ред  рдЗрд╕ рдЙрдореНрд░ рдореЗрдВ рдХрдИ рдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдмрдЪреНрдЪреЗ рд╣реИрдВ, рдФрд░ рд╕реА ++ рдореЗрдВ рдорд╛рдирдХ рдЖрд▓рд╕реА рдХрдВрдЯреЗрдирд░ / рдкреБрдирд░рд╛рд╡реГрддреНрдд рднреА рдирд╣реАрдВ рд╣реИрдВред  рдПрдХ рдмреБрд░рд╛ рд╕рдкрдирд╛!  рд▓реЗрдХрд┐рди рд╕рдм рдХреБрдЫ (рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдХреЗ рдЕрд░реНрде рдореЗрдВ, рдмрдЪреНрдЪреЗ рдирд╣реАрдВ) рдЕрдЧрд▓реЗ рд╕рд╛рд▓ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдмрджрд▓ рдЬрд╛рдПрдВрдЧреЗ - рдорд╛рдирдХ (рд╕рдВрднрд╡рддрдГ рдЖрдВрд╢рд┐рдХ рд░реВрдк рд╕реЗ) рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░реЗрдВрдЬ-рд╡реА 3</a> рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧрд╛, рдЬрд┐рд╕реЗ рдХрдИ рд╡рд░реНрд╖реЛрдВ рд╕реЗ рдПрд░рд┐рдХ рдирд┐рдмрд▓рд░ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╣рдо рдЗрд╕рдХреЗ рдлрд▓реЛрдВ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред  рдХреЛрдб рдпрд╣ рд╕рдм рдЕрдкрдиреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИ: </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;range/v3/view/iota.hpp&gt; #include &lt;range/v3/view/transform.hpp&gt; //... auto t_nodes = ranges::v3::iota_view(0, n_fixed) | ranges::v3::views::transform( [](long long i){ return dt_fixed * static_cast&lt;double&gt;(i); } ); double res = integrate(t_nodes);</span></span></span></span></code> </pre> <br><p>  рдПрдХреАрдХреГрдд рдХрд╛рд░реНрдп рд╕рдорд╛рди рд░рд╣рддрд╛ рд╣реИред  рдпрд╛рдиреА рд╣рдорд╛рд░реА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ 3 рд▓рд╛рдЗрдиреЗрдВ!  рдпрд╣рд╛рдБ <code>iota_view(0, n)</code> рдПрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЖрд▓рд╕реА</a> <em>рдЕрдВрддрд░рд╛рд▓</em> (рд░реЗрдВрдЬ, рдПрдХ рдРрд╕реА рд╡рд╕реНрддреБ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд╢реБрд░реВ рдФрд░ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рдПрдХ рдЖрд▓рд╕реА рд░реЗрдВрдЬ рдПрдХ рджреГрд╢реНрдп рд╣реИ), рдЬреЛ, рдЬрдм рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдкрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрд░рддрд╛ рд╣реИ, рддреЛ рд░реЗрдВрдЬ рдореЗрдВ рдЕрдЧрд▓реЗ рдирдВрдмрд░ рдХреА рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИ [0, n)ред  рдпрд╣ рдордЬреЗрджрд╛рд░ рд╣реИ рдХрд┐ рдирд╛рдо ╬╣ (рдЧреНрд░реАрдХ рдЕрдХреНрд╖рд░ iota) 50 рд╕рд╛рд▓ рдкрд╣рд▓реЗ APL рднрд╛рд╖рд╛ рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ</a> ред  рдЫрдбрд╝реА <code>|</code>  рдЖрдкрдХреЛ рдЕрдВрддрд░рд╛рд▓ рд╕рдВрд╢реЛрдзрдХ рдХреА рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдХреЛ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдФрд░ <code>transform</code> , рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдРрд╕рд╛ рдПрдХ рд╕рдВрд╢реЛрдзрдХ рд╣реИ рдЬреЛ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд▓рдВрдмреЛ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рдкреВрд░реНрдгрд╛рдВрдХреЛрдВ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдХреЛ рдмрджрд▓ рджреЗрддрд╛ рд╣реИред <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ t_1, t_2, ... $ рдЗрдирд▓рд╛рдЗрди $   ред  рд╕рдм рдХреБрдЫ рд╕рд░рд▓ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ <del>  рдПрдХ рдкрд░реА рдХрдерд╛ </del>  рд╣рд╛рд╕реНрдХреЗрд▓ред </p><br><p>  рд▓реЗрдХрд┐рди рдПрдХ рдЪрд░ рдЪрд░рдг рдХреИрд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛рдП?  рд╕рдм рдХреБрдЫ рд╕рд░рд▓ рд╣реИ: </p><br><div class="spoiler">  <b class="spoiler_title">рдереЛрдбрд╝рд╛ рд╕рд╛ рдЧрдгрд┐рдд</b> <div class="spoiler_text"><p>  рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдХрджрдо рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдордиреЗ рдПрдХреАрдХрд░рдг рдХреА рдКрдкрд░реА рд╕реАрдорд╛ рдХреЗ рдкрд╛рд╕ рдЕрдкрдиреЗ рдХрд╛рд░реНрдп рдХреА рдЕрд╡рдзрд┐ рдХрд╛ рджрд╕рд╡рд╛рдВ рд╣рд┐рд╕реНрд╕рд╛ рд▓рд┐рдпрд╛ <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ \ Delta t_ {рдлрд┐рдХреНрд╕реНрдб} = 0.1 \ рдЯрд╛рдЗрдореНрд╕ 2 \ pi / 3 \ tau ^ 2 $ рдЗрдирд▓рд╛рдЗрди $   ред  рдЕрдм рдЪрд░рдг рдкрд░рд┐рд╡рд░реНрддрдирд╢реАрд▓ рд╣реЛрдЧрд╛: рдЖрдк рдзреНрдпрд╛рди рджреЗрдВрдЧреЗ рдХрд┐ рдпрджрд┐ рдЖрдк рд▓реЗрддреЗ рд╣реИрдВ <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ t_i = \ tau (i / n) ^ {1/3} $ рдЗрдирд▓рд╛рдЗрди $   , (рдХрд╣рд╛рдБ) <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ n $ рдЗрдирд▓рд╛рдЗрди $   рдЕрдВрдХ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рд╣реИ), рддреЛ рдХрджрдо рд╣реЛрдЧрд╛ <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ \ Delta t (t) \ рд▓рдЧрднрдЧ dt_i / di = \ tau ^ 3 / (3 nt ^ 2) $ рдЗрдирд▓рд╛рдЗрди $   , рдЬреЛ рдХрд┐рд╕реА рджрд┐рдП рдЧрдП рдкреВрд░реНрдгрд╛рдВрдХ рдлрд╝рдВрдХреНрд╢рди рдХреА рдЕрд╡рдзрд┐ рдХрд╛ рджрд╕рд╡рд╛рдВ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ рдЯреА $ рдЗрдирд▓рд╛рдЗрди $   рдЕрдЧрд░ <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ n = \ tau ^ 3 / (0.1 \ рдЯрд╛рдЗрдореНрд╕ 2 \ pi) $ рдЗрдирд▓рд╛рдЗрди $   ред  рдпрд╣ рдЫреЛрдЯреЗ рдореВрд▓реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдЙрдЪрд┐рдд рд╡рд┐рднрд╛рдЬрди рдХреЗ рд▓рд┐рдП "рд╣реЗрдо" рд░рд╣рддрд╛ рд╣реИ <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ рдореИрдВ $ рдЗрдирд▓рд╛рдЗрди $   ред </p></div></div><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;range/v3/view/drop.hpp&gt; #include &lt;range/v3/view/iota.hpp&gt; #include &lt;range/v3/view/transform.hpp&gt; //... // trapezoidal rule of integration; step size is not fixed template &lt;typename T&gt; double integrate(T t_nodes) { double acc = 0; double t_prev = *(t_nodes.begin()); double f_prev = f(t_prev); for (auto t: t_nodes | ranges::v3::views::drop(1)) { double f_curr = f(t); acc += 0.5 * (t - t_prev) * (f_curr + f_prev); t_prev = t; f_prev = f_curr; } return acc; } //... auto step_f = [](long long i) { if (static_cast&lt;double&gt;(i) &lt;= 1 / a) { return pow(2 * M_PI, 1/3.0) * a * static_cast&lt;double&gt;(i); } else { return tau * pow(static_cast&lt;double&gt;(i) / static_cast&lt;double&gt;(n), 1/3.0); } }; auto t_nodes = ranges::v3::iota_view(0, n) | ranges::v3::views::transform(step_f); double res = integrate(t_nodes);</span></span></span></span></code> </pre> <br><p>  рдПрдХ рдЪреМрдХрд╕ рдкрд╛рдардХ рдиреЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдХрд┐ рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдЪрд░ рдЪрд░рдг рдиреЗ рд╣рдореЗрдВ рддреАрди рдХреЗ рдПрдХ рдХрд╛рд░рдХ рджреНрд╡рд╛рд░рд╛ рдЧреНрд░рд┐рдб рдмрд┐рдВрджреБрдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА, рдЬрдмрдХрд┐ рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╡реНрдпрдп рд╣реИрдВ <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ t_i $ рдЗрдирд▓рд╛рдЗрди $   ред  рд▓реЗрдХрд┐рди рдЕрдЧрд░ рд╣рдо рджреВрд╕рд░рд╛ рд▓реЗрдВ <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ f (t) $ рдЗрдирд▓рд╛рдЗрди $   рдЕрдВрдХреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдмрджрд▓ рд╕рдХрддреА рд╣реИ ... (рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рд▓реЗрдЦрдХ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЖрд▓рд╕реА рд╣реЛрддрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ)ред </p><br><h2 id="itak-taymingi">  рдЗрддрдирд╛ рд╕рдордп </h2><br><p>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ: </p><br><ul><li>  v1 - рд╕рд░рд▓ рд▓реВрдк </li><li>  v2 - <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ t_i $ рдЗрдирд▓рд╛рдЗрди $   <code>std::vector</code> рдореЗрдВ рдЭреВрда <code>std::vector</code> </li><li>  v3 - <code>lazy_container</code> рд╕рд╛рде <code>lazy_container</code> </li><li>  v4 - C ++ 20 (рд░реЗрдВрдЬ) рд╕реЗ рдЕрдВрддрд░рд╛рд▓ </li><li>  v5 - рдлрд┐рд░ рд╕реЗ рдЪрд▓рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рдпрд╣рд╛рдБ рдЪрд░ рд╡рд┐рдзрд┐ рдПрдХ рдЪрд░ рдкрд┐рдЪ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ </li></ul><br><p>  рдпрд╣рд╛рдБ рдпрд╣ рдХреНрдпрд╛ рд╣реИ (рд╕реЗрдХрдВрдб рдореЗрдВ) рдХреЗ рд▓рд┐рдП <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ \ tau = (10 \, 000 \, 001 \ рдЧреБрдирд╛ \ pi) ^ {1/3} $ рдЗрдирд▓рд╛рдЗрди $   рдХреЗ рд▓рд┐рдП, рдЬреАрдИ ++ 8.3.0 рдФрд░ рдЗрдВрдЯреЗрд▓┬о Xeon┬о CPU┬о X5550 рдкрд░ рдХреНрд▓реЗрдВрдЧ 8.0.0 рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ (рдЪрд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛) <math> </math> $ рдЗрдирд▓рд╛рдЗрди $ 1.5 \ рдЧреБрдирд╛ 10 ^ 8 $ рдЗрдирд▓рд╛рдЗрди $   , v5 рдХреЛ рдЫреЛрдбрд╝рдХрд░, рдЬрд╣рд╛рдВ рдЪрд░рдг рддреАрди рдЧреБрдирд╛ рдХрдо рд╣реИрдВ (рд╕рднреА рддрд░реАрдХреЛрдВ рд╕реЗ рдЧрдгрдирд╛ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рджреЛ рд╕реЗ рднрд┐рдиреНрди рд╣реЛрддрд╛ рд╣реИ 0.07 рд╕реЗ рдЕрдзрд┐рдХ рдирд╣реАрдВ): </p><br><div class="scrollable-table"><table><tbody><tr><td></td><td>  v1 </td><td>  рд╡реА 2 </td><td>  v3 </td><td>  v4 </td><td>  v5 </td></tr><tr><td>  рдЬреА ++ </td><td>  4.7 </td><td>  6.7 </td><td>  4.6 </td><td>  3.7 </td><td>  4.3 </td></tr><tr><td>  рджрдмрдВрдЧ ++ </td><td>  5.0 </td><td>  7.2 </td><td>  4.6 </td><td>  4.8 </td><td>  4.1 </td></tr></tbody></table></div><br><div class="spoiler">  <b class="spoiler_title">рдЭрдВрдбреЗ ~~ рд░рдВрдЧреАрди рдХрд╛рдЧрдЬ рд╕реЗ ~~</b> <div class="spoiler_text"><p>  g ++ -O3 -ffast-math -std = c ++ 2a -Wall -Wpedantic -I range-v3 / рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ <br>  clang ++ -Ofast -std = c ++ 2a -Wall -Wpedantic -I range-v3 / рд╢рд╛рдорд┐рд▓ рд╣реИрдВ </p></div></div><br><p>  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдордХреНрдЦреА рдкреВрд░реЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЪрд▓реА рдЧрдИ, рдордХреНрдЦреА рдХреЛ рдПрдХ рд╕рд┐рдХреНрдХрд╛ рдорд┐рд▓рд╛! </p><br><div class="spoiler">  <b class="spoiler_title">g ++ рдбрд┐рдмрдЧ рдореЛрдб рдореЗрдВ</b> <div class="spoiler_text"><p>  рдпрд╣ рдХрд┐рд╕реА рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИ </p><br><div class="scrollable-table"><table><tbody><tr><td></td><td>  v1 </td><td>  рд╡реА 2 </td><td>  v3 </td><td>  v4 </td><td>  v5 </td></tr><tr><td>  рдЬреА ++ </td><td>  5.9 </td><td>  17.8 </td><td>  7.2 </td><td>  33.6 </td><td>  14.3 </td></tr></tbody></table></div></div></div><br><h2 id="itog">  рдкрд░рд┐рдгрд╛рдо </h2><br><p>  рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдПрдХ рдмрд╣реБрдд рд╣реА рд╕рд░рд▓ рдХрд╛рд░реНрдп рдореЗрдВ, рд░реЗрдВрдЬ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рдирд┐рдХрд▓реАрдВ: 20+ рд▓рд╛рдЗрдиреЛрдВ рдкрд░ рд╕реНрд╡-рдирд┐рд░реНрдорд┐рдд рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдХреЛрдб рдХреЗ рдмрдЬрд╛рдп, рд╣рдордиреЗ 3 рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рд▓рд┐рдЦрд╛, рдЬрдмрдХрд┐ рдХреЛрдб рдХреА рдкрдардиреАрдпрддрд╛ рдпрд╛ рдЗрд╕рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд╕рд╛рде рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рдирд╣реАрдВ рдереАред </p><br><p>  рдмреЗрд╢рдХ, рдЕрдЧрд░ рд╣рдореЗрдВ рдЗрди рдкрд░реАрдХреНрд╖рдгреЛрдВ рдореЗрдВ рдЕрдВрддрд┐рдо рдкреНрд░рджрд░реНрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдХреЗ рд▓рд┐рдП), рддреЛ рд╣рдореЗрдВ рдкреНрд░реЛрд╕реЗрд╕рд░ рд╕реЗ рдФрд░ рдореЗрдореЛрд░реА рд╕реЗ рд╕рдорд╛рдирд╛рдВрддрд░ рдХреЛрдб рд▓рд┐рдЦрдХрд░ (рдпрд╛ рдУрдкрдирд╕реАрдПрд▓ рдХреЗ рддрд╣рдд рдПрдХ рд╕рдВрд╕реНрдХрд░рдг рд▓рд┐рдЦрдХрд░) рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ ... рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдЕрдЧрд░ рдореИрдВ рд▓рд┐рдЦреВрдВ рд╕рдВрд╢реЛрдзрдХ рдХреА рдмрд╣реБрдд рд▓рдВрдмреА рд╢реНрд░реГрдВрдЦрд▓рд╛ред  рдЬрдЯрд┐рд▓ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рд╕рдВрдХрд▓рдХ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рдбрд┐рдмрдЧ рдФрд░ рдкрдврд╝рдирд╛ рдЖрд╕рд╛рди рд╣реИред  рд╕рдВрдХрд▓рди рд╕рдордп рдмрдврд╝рд╛рдПрдЧрд╛ред  рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдХрднреА рдХреЛрдИ рдЗрд╕ рд▓реЗрдЦ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд▓рд┐рдЦреЗрдЧрд╛ред </p><br><p>  рдЬрдм рдореИрдВрдиреЗ рдпреЗ рдкрд░реАрдХреНрд╖рдг рд▓рд┐рдЦреЗ, рддреЛ рдореБрдЭреЗ рдЦреБрдж рдирд╣реАрдВ рдкрддрд╛ рдерд╛ рдХрд┐ рдХреНрдпрд╛ рд╣реЛрдЧрд╛ред  рдЕрдм рдореБрдЭреЗ рдкрддрд╛ рд╣реИ - рд░реЗрдВрдЬ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИ, рдЙрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЬрд┐рдирдореЗрдВ рдЖрдк рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдЗрд░рд╛рджрд╛ рд░рдЦрддреЗ рд╣реИрдВред </p><br><p><del>  рдореИрдВ рд╕рдореЛрд╡рд░ рдЦрд░реАрджрдиреЗ рдмрд╛рдЬрд╛рд░ рдЧрдпрд╛ рдерд╛ред </del></p><br><h3 id="poleznye-ssylki">  рдЙрдкрдпреЛрдЧреА рд▓рд┐рдВрдХ </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░реЗрдВрдЬ- v3 рдШрд░</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкреНрд░рд▓реЗрдЦрди рдФрд░ рдХреЗрд╕ рд╕реНрдЯрдбреАрдЬ v3</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрд╕ рд▓реЗрдЦ рд╕реЗ github рдкрд░ рдХреЛрдб</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП рд╣реИрд╕реЗрд▓ рдореЗрдВ рд╕реВрдЪреА</a> </p><br><h3 id="blagodarnosti">  рдзрдиреНрдпрд╡рд╛рдж </h3><br><p>  рдпрд╣ рд╕рдм рд▓рд┐рдЦрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж! </p><br><h3 id="ps">  рдкреБрдирд╢реНрдЪ </h3><br><p>  рдореБрдЭреЗ рдЖрд╢рд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рд╡реНрдпрдХреНрддрд┐ рдРрд╕реА рд╡рд┐рд╖рдорддрд╛рдУрдВ рдкрд░ рдЯрд┐рдкреНрдкрдгреА рдХрд░рддрд╛ рд╣реИ: i) рдпрджрд┐ рдЖрдк рдПрдХреАрдХрд░рдг рдЕрдВрддрд░рд╛рд▓ рдХреЛ 10 рдЧреБрдирд╛ рдЫреЛрдЯрд╛ рд▓реЗрддреЗ рд╣реИрдВ, рддреЛ рдореЗрд░реЗ Xeon рдкрд░ v2 рдЙрджрд╛рд╣рд░рдг v1 рдХреА рддреБрд▓рдирд╛ рдореЗрдВ 10% рддреЗрдЬ рд╣реИ, рдФрд░ v4 v1 рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рддреАрди рдЧреБрдирд╛ рддреЗрдЬ рд╣реИред  ii) рдХрднреА-рдХрднреА рдЗрдВрдЯреЗрд▓ рдХрдВрдкрд╛рдЗрд▓рд░ (icc 2019) рдЗрди рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рдХреЛрдб рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рд╕рдВрдХрд▓рд┐рдд g ++ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рджреЛрдЧреБрдирд╛ рд╣реИред  рдХреНрдпрд╛ рд╡реИрд╢реНрд╡реАрдХрд░рдг рдХреЛ рджреЛрд╖ рджреЗрдирд╛ рд╣реИ?  рдХреНрдпрд╛ рдЬреА ++ рдХреЛ рднреА рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ? </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi473844/">https://habr.com/ru/post/hi473844/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi473832/index.html">ShIoTiny: рдЕрдкрдбреЗрдЯ рдФрд░ рд╕реВрдЪрдирд╛рдПрдВ</a></li>
<li><a href="../hi473834/index.html">рдХреНрд▓реЛрдЬ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдмреНрд▓реИрдХрдмреЙрдХреНрд╕ рдирд┐рдЧрд░рд╛рдиреАред рдпреИрдВрдбреЗрдХреНрд╕ рд░рд┐рдкреЛрд░реНрдЯ</a></li>
<li><a href="../hi473838/index.html">рдбреАрдЬреЗрдЖрдИ рдорд╡рд┐рдХ рдорд┐рдиреА: рд╕рдмрд╕реЗ рд╣рд▓реНрдХрд╛ рддрд╣ рдХреНрд╡рд╛рдбреНрд░реЛрдХреЛрдкреНрдЯрд░</a></li>
<li><a href="../hi473840/index.html">UDP рд╕реЗ JAVA рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ Android рдбрд┐рд╡рд╛рдЗрд╕ рд╕реЗ рд╕реНрдЯреНрд░реАрдо рд╡реАрдбрд┐рдпреЛ</a></li>
<li><a href="../hi473842/index.html">рдЕрдХреНрдЯреВрдмрд░ рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдПрдВрдб рдЖрд░реНрдЯрд┐рдлрд┐рд╢рд┐рдпрд▓ рдЗрдВрдЯреЗрд▓рд┐рдЬреЗрдВрд╕ рдиреНрдпреВрдЬ рдбрд╛рдЗрдЬреЗрд╕реНрдЯ</a></li>
<li><a href="../hi473846/index.html">рдмреНрд▓реЙрдХрдЪреИрди рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдХреИрд╕реЗ рдорд╛рдкреЗрдВред рдкреНрд░рдореБрдЦ рдореАрдЯреНрд░рд┐рдХ</a></li>
<li><a href="../hi473848/index.html">рд╕реАред рд╣рд╛рдИрд▓рд╛рдб ++ 2019 рдкрд░</a></li>
<li><a href="../hi473852/index.html">рд░рд╛рдд рдореЗрдВ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рдкреЗрд╢реЗрд╡рд░реЛрдВ рдФрд░ рд╡рд┐рдкрдХреНрд╖</a></li>
<li><a href="../hi473854/index.html">рд╣рдо рдЖрдЦрд┐рд░реА рдЬреЛрдХрд░ рдХреЛ рдХреИрд╕реЗ рдпрд╛рдж рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi473856/index.html">рдЦрддрд░рдирд╛рдХ рд╕рд╣рдЬрддрд╛ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдЖрдк рд╕реИрдиреНрдп рдХреГрддреНрд░рд┐рдо рдмреБрджреНрдзрд┐рдорддреНрддрд╛ рдХреЛ рдореВрд░реНрдЦ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>