<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§π üë®üèº‚Äçüè≠ ‚ò£Ô∏è O mundo interior dos Formants P432 ü¶Ö üóÇÔ∏è üëßüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A hist√≥ria de como eu comprei inesperadamente um sintetizador, o consertei, descobri como ele funciona e escrevi um emulador. 

 Esta hist√≥ria come√ßou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O mundo interior dos Formants P432</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482292/"><img src="https://habrastorage.org/webt/dv/3b/pd/dv3bpdmwtjhonhrkr64jbohha3m.jpeg"><br><br>  A hist√≥ria de como eu comprei inesperadamente um sintetizador, o consertei, descobri como ele funciona e escrevi um emulador. <br><a name="habracut"></a><br>  Esta hist√≥ria come√ßou durante o festival <a href="https://2019.chaosconstructions.ru/" rel="nofollow">Chaos Constructions no</a> √∫ltimo fim de semana de agosto de 2019.  Olhando pelo Avito √† noite em busca de artefatos interessantes de uma √©poca passada, me deparei com um sintetizador barato do Formant P432.  Parecia bastante familiar para sintetizadores digitais: na parte inferior h√° um teclado de 41 teclas (3,5 oitavas), na parte superior existem bot√µes para selecionar um som, ativar os efeitos de coro e un√≠ssono, al√©m de bot√µes para ajustar o efeito vibrato.  Um joystick √© instalado √† esquerda do teclado, permitindo que voc√™ mude a afina√ß√£o para cima e para baixo, al√©m de conectar suavemente o vibrato. <br><br>  O mais interessante para mim foi que esse sintetizador era digital e gerava sons usando o m√©todo wavetable, ou seja, no momento de pressionar a tecla, gerava som com base em dados tabulares armazenados em chips ROM.  Ap√≥s um r√°pido conhecimento dos circuitos na Internet, ficou claro que o controle do sintetizador √© baseado no conhecido microprocessador KP580VM80 (i8080), e os sons s√£o armazenados em 8 chips de ROM com um volume total de 8 * 2 = 16 Kb. <br><br>  O sintetizador foi comprado e partiu lentamente da cidade do vendedor para o escrit√≥rio local da empresa de transporte, e continuei a estudar os esquemas.  O vendedor escreveu em um an√∫ncio que a ferramenta possui um defeito que se manifesta na forma de chiado quando voc√™ pressiona mais de uma tecla.  Ainda mais interessante, pensei.  "Ser√° necess√°rio encontrar e eliminar." <br><br>  Mas o principal motivo para a compra foi o desejo de lidar com o dispositivo interno e extrair amostras de sons da ROM do sintetizador. <br><br>  <b>AVISO LEGAL</b> : Os nomes dos componentes dos n√≥s e sinais do sintetizador (que n√£o sejam os indicados entre "aspas" e letras BIG) foram inventados por mim e podem diferir do que os desenvolvedores pretendiam.  A descri√ß√£o da opera√ß√£o dos n√≥s √© baseada no meu conhecimento (limitado), nos materiais da Internet e nos conselhos de pessoas experientes. <br><br><h3>  Repara√ß√£o </h3><br>  Quando o P432 [ <a href="https://habr.com/ru/post/482292/">2</a> ] chegou a mim s√£o e salvo, a primeira coisa que fiz foi desmont√°-lo.  No interior, eu n√£o esperava uma vis√£o muito agrad√°vel de feixes de fios e v√°rias placas de circuito impresso. <br><br><div class="spoiler">  <b class="spoiler_title">N√≥ de controle</b> <div class="spoiler_text">  A placa na qual os bot√µes e controles no painel frontal s√£o soldados, bem como uma indica√ß√£o dos modos de opera√ß√£o. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">N√≥ do processador</b> <div class="spoiler_text">  Ele cont√©m o microprocessador KR580VM80 e outros chips do kit 580, uma ROM de 2 KB no RF2, dois chips de RAM est√°ticos com capacidade total de 256 bytes (K541RU2).  Al√©m disso, os decodificadores s√£o instalados na placa, que alocam partes do espa√ßo de endere√ßo para intera√ß√£o com o teclado, com bot√µes e registros de controle, na sa√≠da em que os sinais de controle s√£o gerados para o n√≥ do gerador. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">N√≥ da interface MIDI</b> <div class="spoiler_text">  Ele √© instalado acima do n√≥ do processador e consiste em uma ROM separada com rotinas de mensagens MIDI, l√≥gica fina e dois microcircuitos grandes: o controlador de interrup√ß√£o VN59 e a interface BB51 em s√©rie.  Para os contatos TX / RX VN51, um circuito de implementa√ß√£o de loop de corrente midi padr√£o com isolamento do acoplador √≥ptico √© conectado. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">N√≥ de coro</b> <div class="spoiler_text">  Sob a forma de uma placa isolada com apenas entrada, sa√≠da e energia anal√≥gicas.  √â implementado em microcircuitos KA528BR2 - linhas de atraso anal√≥gicas.  A unidade √© muito barulhenta, mas d√° ao som uma cor interessante. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Montagem do gerador</b> <div class="spoiler_text">  O m√≥dulo principal do sintetizador.  Ele cont√©m 8 chips de ROM de 2 KB cada, l√≥gica digital (registradores, somadores), dois DACs, um filtro anal√≥gico com par√¢metros vari√°veis ‚Äã‚Äãe estabiliza√ß√£o t√©rmica.  O n√≥ tamb√©m cont√©m um gerador de rel√≥gio com o qual a opera√ß√£o dos registradores do n√≥ do processador √© sincronizada.  A placa filha neste n√≥ possui uma placa VCO (gerador controlado por tens√£o), que √© um refinamento de f√°brica das revis√µes posteriores do sintetizador. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Montagem de retificador e estabilizador</b> <div class="spoiler_text">  Uma fonte de alimenta√ß√£o linear que produz + 5V para pot√™ncia l√≥gica e + 12 / -15V para amplificadores operacionais.  + 5V √© estabilizado pelo KR142EN5, cujo radiador √© a caixa de metal do sintetizador e + 12 / -15V √© o estabilizador param√©trico mais simples nos diodos e transistores zener.  Uma tens√£o de alimenta√ß√£o adicional de -5V para o KR580VM50 √© formada por um diodo zener de -15V diretamente na placa da unidade processadora.  Os terra anal√≥gico e digital s√£o separados separadamente e s√£o conectados apenas neste bloco. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Teclado de instrumento</b> <div class="spoiler_text">  Chave Reed, n√£o sens√≠vel √† velocidade, como em outros sintetizadores da f√°brica de r√°dio Kachkanar da Formant. <br></div></div><br><img src="https://habrastorage.org/webt/ug/qe/2x/ugqe2xza93bmihgm3hhezgz9qxi.jpeg"><br><br>  A remo√ß√£o do n√≥ MIDI em uma placa separada com sua ROM deve-se √† presen√ßa de outro sintetizador na linha P432 - o ‚ÄúFormant MINI‚Äù, que n√£o possui interface MIDI e o efeito HOR.  O n√≥ do processador MINI √© um pouco diferente no firmware e o n√≥ do gerador √© o mesmo que no P432. <br><br>  Ent√£o, quando liguei pela primeira vez, notei dois problemas: um n√≠vel de sinal muito fraco na sa√≠da linear e o som j√° mencionado ao pressionar mais de uma tecla de cada vez.  Note-se que o P432 √© um sintetizador polif√¥nico e pode tocar simultaneamente 4 vozes (frequ√™ncias) de um timbre.  E com a inclus√£o do efeito UNISON, o n√∫mero de vozes simult√¢neas aumenta para 8, duas para cada tecla. <br><br>  O motivo do som silencioso foi encontrado quase imediatamente; a sa√≠da queimada OU K544UD1A foi a culpada. <br><br>  Depois de substitu√≠-lo, o instrumento come√ßou a soar alto, mesmo quando fones de ouvido passivos foram conectados √† sa√≠da. <br><br>  Mas com sons estranhos, a situa√ß√£o era muito incompreens√≠vel, porque mesmo quando as teclas individuais eram pressionadas, os sons dos tons n√£o eram como a demonstra√ß√£o P432 do youtube. <br><br>  Demorou um pouco para encontrar o problema, mas no final ele foi localizado no n√≠vel do DAC principal.  O bit alto da entrada digital n√£o foi suficiente para reconhec√™-lo como l√≥gico 1; portanto, o sinal de sa√≠da anal√≥gica foi distorcido.  O culpado dessa hist√≥ria foi encontrado e eliminado, ap√≥s o qual o problema foi resolvido.  Todos os tons come√ßaram a soar claros e sem problemas com alguns toques. <br><br>  Teria um fim na hist√≥ria, mas j√° havia muito tempo gasto no reparo, ent√£o decidi que n√£o dever√≠amos parar por a√≠ e precisamos descobrir: <br><br><ul><li>  como √© o processo de s√≠ntese sonora </li><li>  o que √© armazenado na ROM da unidade geradora </li><li>  como o filtro funciona e suas caracter√≠sticas </li><li>  onde a configura√ß√£o para cada par√¢metro de tom e envelope √© armazenada </li></ul><br>  O resultado deste trabalho foi a emula√ß√£o de software do P432 usando dados da ROM original. <br><br><h3>  Montagem do gerador </h3><br>  A forma de onda na sa√≠da do DAC principal da unidade geradora √© formada pelo princ√≠pio da s√≠ntese digital direta (DDS) [ <a href="https://habr.com/ru/post/482292/">1</a> ].  O sinal anal√≥gico recebido √© passado por um filtro passa-baixo e, se necess√°rio, √© misturado √† sa√≠da do coro, amplificado por um amplificador de sa√≠da e alimentado a uma sa√≠da linear.  O filtro em P432 √© feito de acordo com o esquema usado anteriormente no sintetizador Polyvox [ <a href="https://habr.com/ru/post/482292/">3</a> ]. <br><br><img src="https://habrastorage.org/webt/ts/7l/5c/ts7l5cybnhehm2zl7btvloqsorq.png"><br>  <i>O diagrama mostra a unidade geradora e seus principais blocos funcionais.</i>  <i>As setas laranja indicam entradas e sa√≠das de sinais digitais externos, sinais preto-digitais dentro do m√≥dulo, sinais azuis-anal√≥gicos.</i> <i><br></i> <br><br>  Primeiro, considere as entradas e sa√≠das: <br><br><ul><li>  Entrada ‚ÄúFrequency‚Äù (11 bits) - para cada voz, incluindo un√≠ssono, os valores correspondentes √† tecla pressionada ou √† nota MIDI v√™m do n√≥ do processador. <br></li><li>  Entrada do amplificador (8 bits) - o valor do envelope para a amplitude do sinal. </li><li>  Entrada ‚ÄúFiltro‚Äù (8 bits) - valores do envelope da frequ√™ncia de corte do filtro. </li><li>  Entrada ‚ÄúControl‚Äù - (8 bits) - 3 bits menos significativos s√£o respons√°veis ‚Äã‚Äãpela sele√ß√£o da forma de onda, 2 bits pelo deslocamento do filtro, mais 2 pelo n√≠vel de qualidade Q do filtro Q (resson√¢ncia) e o √∫ltimo bit determina se o efeito UNISON est√° ativado ou n√£o. </li><li>  ‚ÄúEndere√ßo‚Äù de sa√≠da (3 bits) - respons√°vel pela sincroniza√ß√£o com o n√≥ do processador. </li></ul><br>  Agora vamos ver como os principais blocos do n√≥ funcionam. <br><br>  O circuito de sincroniza√ß√£o, com a ajuda de multivibradores, um contador e elementos l√≥gicos, gera pulsos de controle para v√°rios m√≥dulos da unidade geradora e fornece o n√∫mero de voz atual √† sa√≠da "Address".  Quando o modo "Endere√ßo" UNISON est√° ativo, recebe os valores [0,1,2,3,4,5,6,7] e quando inativo: [0,2,4,6].  A frequ√™ncia do oscilador principal pode ser alterada em pequena medida com o bot√£o de ajuste no painel frontal e o joystick √† esquerda do teclado. <br><br><img src="https://habrastorage.org/webt/kc/m2/cf/kcm2cfudodvfljpi178cyw3yy3k.png">  <i>Diagrama de tempo de pulsos de rel√≥gio.</i>  <i>Explica√ß√µes: Unison - log.</i>  <i>0 n√≠vel ativo, FA0-2 - Sa√≠da "Endere√ßo", DD8-12 - registro do acumulador de fase, DD33-35 - registro total de votos, DD36-37 - registro DAC.</i> <i><br></i> <br><br>  A parte digital da placa do gerador para cada um dos 4 (8) votos simultaneamente com uma altera√ß√£o no valor do "Endere√ßo" de sa√≠da executa as seguintes opera√ß√µes.  No n√≥ do processador, a entrada "Frequency" recebe os valores de frequ√™ncia do sinal.  O valor linear da frequ√™ncia √© convertido em incremento de fase pelo decodificador na ROM.  Os incrementos s√£o somados no acumulador de fase (20 bits), consistindo em um somador e RAM de 8 palavras.  Os 9 bits mais altos da soma s√£o alimentados nas entradas de endere√ßo da ROM da forma de onda.  Uma √°rea espec√≠fica da ROM √© selecionada pelos tr√™s bits menos significativos da entrada "Controle".  10 bits da sa√≠da da ROM s√£o somados com o valor na entrada do ‚ÄúAmplificador‚Äù e alimentados √†s entradas da ROM de escala, o que gera um c√≥digo bipolar para o DAC.  A sa√≠da cai no buffer de acumula√ß√£o, constru√≠do em somadores e registradores, que soma sequencialmente os valores de c√≥digo de todos os 4 (8) votos.  No final de cada ciclo, o c√≥digo final √© bloqueado pelo registro de armazenamento e chega ao DAC de 12 bits.  A frequ√™ncia de emiss√£o do c√≥digo no DAC √© a frequ√™ncia de amostragem do sinal e, para P432, √© de cerca de 33 kilohertz.  Segundo Nyquist, a frequ√™ncia sonora m√°xima dispon√≠vel para o gerador P432 √© de aproximadamente 16,5 kHz. <br><br>  Se o timbre selecionado exigir uma altera√ß√£o din√¢mica dos par√¢metros do filtro passa-baixo, os valores do envelope ser√£o enviados para a entrada Filtro, que, passando pelo DAC de 10 bits, forma a tens√£o de controle do filtro do amplificador operacional.  O filtro passa-baixo √© feito de acordo com o filtro sem condensador do filtro de estado vari√°vel e inclui um circuito de estabiliza√ß√£o de temperatura, um bloco para alterar o fator Q de Q e a polariza√ß√£o inicial. <br><a name="dia1"></a><br><img src="https://habrastorage.org/webt/ii/fh/bq/iifhbqm2guxdn1b2vpagozcg9l8.png"><br>  <i>Este gr√°fico de tempo mostra dois per√≠odos de discretiza√ß√£o da placa do gerador.</i>  <i>UNISON est√° desligado.</i>  <i>A entrada de frequ√™ncia (Freq_in) de forma s√≠ncrona com a altera√ß√£o de endere√ßo recebe os n√∫meros de frequ√™ncia de quatro teclas diferentes.</i>  <i>Mas apenas os dois √∫ltimos s√£o pressionados (Volume_in = 0xFF).</i>  <i>Ao mesmo tempo, um valor constante (Filter_in = 0x60) √© emitido para a entrada "Filter".</i>  <i>O c√≥digo final √© inserido no DAC (DAC) ap√≥s o encaixe nos registros de armazenamento (DD36-37).</i> <br><br><div class="spoiler">  <b class="spoiler_title">Para UNISON inclu√≠do</b> <div class="spoiler_text">  tudo parece igual, apenas a entrada "Frequency" recebe um par de n√∫meros: para a voz principal e o un√≠ssono. <br><br>  Nota: apenas um per√≠odo √© exibido. <br><br><img src="https://habrastorage.org/webt/nn/-n/z2/nn-nz27kbozdrgb9nvn9l8apzzy.png"><br></div></div><br><h4>  Uma descri√ß√£o mais detalhada do conjunto gerador </h4><br>  Abaixo est√£o os detalhes e diagramas esquem√°ticos el√©tricos para quem deseja entender o dispositivo sintetizador com mais detalhes.  Os circuitos foram encontrados na Internet, embora um manual de opera√ß√£o [ <a href="https://habr.com/ru/post/482292/">4</a> ] e um conjunto completo de circuitos de papel [ <a href="https://habr.com/ru/post/482292/">5</a> ] tenham sido anexados ao meu sintetizador.  Boas pessoas compartilharam o arquivo com o conte√∫do de todas as ROMs em um f√≥rum, mas, como se viu, houve um erro em um dos arquivos, ent√£o tive que cancelar a inscri√ß√£o de ROMs individuais e compar√°-las com o firmware do arquivo. <br><br>  Note-se que durante a produ√ß√£o do P432, o fabricante emitiu v√°rias revis√µes das placas sintetizadoras, a fim de melhorar as caracter√≠sticas t√©cnicas, que podem diferir dos primeiros esquemas de revis√£o apresentados abaixo. <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/webt/r_/j2/wh/r_j2wh8ff0lhsgn0t4-vewucrge.jpeg"></a> <br><br><ol><li>  A ROM de convers√£o de incremento de frequ√™ncia - DD1-2, executada em dois 573RF2, cont√©m uma tabela de correspond√™ncia do valor da frequ√™ncia linear para o incremento de fase exponencial.  Graficamente, seu conte√∫do fica assim <br><br><img src="https://habrastorage.org/webt/u4/dm/w0/u4dmw0zfe_tzpofn0b8bfg-yege.png"><br><br>  S√≠ncrona com uma altera√ß√£o no valor na sa√≠da "Endere√ßo", o n√≥ do processador emite um valor de frequ√™ncia de 11 bits da voz correspondente para a entrada "Frequ√™ncia", que √© convertida em incrementos de 16 bits. <br><br><div class="spoiler">  <b class="spoiler_title">Se considerarmos o conte√∫do das 16 primeiras palavras de DD1-2, alguns n√∫meros estranhos s√£o escritos l√° que parecem n√£o ser usados ‚Äã‚Äãna s√≠ntese do som:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/9e/vx/rz/9evxrzasws-fe1lhvnloma1gzp4.png"><br></div></div></li><li>  Acumulador de fases - consiste em somadores DD3-7 (561IM1) e registros DD8-12 (561IR11).  Adicionadores s√£o inclu√≠dos na cadeia com uma capacidade total de 20 bits.  O bloco de registro permite armazenar oito valores da fase do sinal de 20 bytes.  As entradas de endere√ßo dos registros de leitura / grava√ß√£o s√£o conectadas ao barramento "Endere√ßo".  Essa inclus√£o permite receber o valor anterior na sa√≠da do pulso do rel√≥gio e salvar o valor atual da entrada.  Isso garante o ac√∫mulo de fase separadamente para cada sintetizador de voz.  Os 9 bits altos da sa√≠da do registro s√£o alimentados nas entradas de endere√ßo da ROM da forma de onda. </li><li>  Forma de onda ROM - DD13-14, DD18-19 (5732) cont√©m tabelas de oito formas de onda que podem ser sintetizadas por um conjunto gerador.  Uma √°rea de mem√≥ria espec√≠fica e um par de ROMs s√£o selecionados pelos bits S0-S2 do sinal "Control".  Sob a descri√ß√£o de cada sinal, 512 palavras s√£o atribu√≠das com uma capacidade de 11 bits.  Os 10 bits mais significativos t√™m uma finalidade de utilidade, indicando a polaridade do sinal: 1 positivo, 0 negativo.  A apar√™ncia das formas de onda √© dada levando em considera√ß√£o a revers√£o de valores negativos: <br><br><div class="spoiler">  <b class="spoiler_title">Wave_00</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/or/vw/6u/orvw6ufj6zwaagtsfpnkhbi7kco.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_01</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/f7/ki/qe/f7kiqemlbbaeapbd8zk0a1v25yi.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_02</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bp/1r/6y/bp1r6ypxrnj5ux1gcavtzv-77tk.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_03</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/xu/sb/l3/xusbl3xahaejjicw-dilwuiumtw.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_04</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/h_/ki/6l/h_ki6lga37bdnhfrul7cxoufp6m.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_05</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dm/ic/6m/dmic6msl9qiow18hx4qtvj8g_-s.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_06</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ud/q0/kj/udq0kj3ce_wdf5dclef5kdruy3m.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_07</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ec/gq/tf/ecgqtft3xeliwxyp4rkrtjlhqjq.png"></div></div></li><li>  Adicionador de Envelope - Envelope de 8 A (deslocado para a esquerda em 2 bits), somados nos elementos DD23-25 ‚Äã‚Äã(561IM1) com os 10 bits de sa√≠da menos significativos da ROM da forma de onda, √© inserido na entrada do Amplificador.  O envelope possui 4 fases: Ataque, Decaimento, Sustenta√ß√£o, Libera√ß√£o, formadas pela unidade processadora separadamente para cada uma das 4 vozes principais, dependendo do momento em que a tecla √© pressionada / liberada. <br>  Um exemplo de envelope para o tom 00: um ataque r√°pido a 255 √© claramente vis√≠vel, um decl√≠nio no n√≠vel 239 e uma diminui√ß√£o suave no n√≠vel, terminando com uma atenua√ß√£o acentuada em 0 ao soltar a tecla.  No eixo horizontal √© o tempo em segundos, no eixo vertical √© o valor da entrada "Amplificador". <br><br><div style="text-align:center;"><img alt="Envelope da entrada \ &quot;Amplificador \&quot;" src="https://habrastorage.org/webt/sc/ih/1e/scih1ebv64qe7hr9uywlvqixrpw.png"></div><br><br>  Os valores na ROM do sintetizador s√£o selecionados de forma que, em 0 na entrada do "Amplificador", a sa√≠da do DAC tamb√©m tenha um n√≠vel de sinal zero, apesar do fato de que todos os circuitos intermedi√°rios alteram constantemente os valores das vari√°veis ‚Äã‚Äãe geram sinais diferentes. </li><li>  A ROM de escala, consistindo em DD27-28 (5732), cont√©m curvas para obter o c√≥digo do sinal bipolar de acordo com o valor do bit de ordem superior da forma de onda.  Em forma gr√°fica, o conte√∫do da ROM se parece com isso. <br><br><img src="https://habrastorage.org/webt/si/vk/qd/sivkqdmz_xprac6wlofmlq85cfy.png"><br><br>  Se o d√©cimo bit for 1, o valor da sa√≠da DD28 + 256 ser√° usado e, se 0, DD27 + 1. </li><li>  O acumulador de votos no DD30-32 (561IM1) e registra o DD33-DD35 (5619) combina os valores dos c√≥digos de todos os votos antes da emiss√£o para o DAC.  Ap√≥s o processamento do c√≥digo da √∫ltima voz, o valor recebido √© transferido para o registro de armazenamento e o registro do somador √© redefinido para zero. <br><br>  Exemplo: Como mencionado acima, se "Amplificador" = 0 e o valor m√°ximo poss√≠vel de amplitude na sa√≠da da ROM da forma de onda (1 &lt;&lt; 10) -1 = 1023, na sa√≠da da ROM de escala obtemos 0 + 256 ou 255+ 1, dependendo de 10 bits da forma de onda, que fornece um total de 256 * 8 = 2048 e corresponde a 0 na sa√≠da do DAC. </li><li>  O registro de armazenamento nos elementos DD36-37 (555TM9) recebe e armazena o valor do c√≥digo na sa√≠da durante o intervalo de amostragem.  A frequ√™ncia de amostragem do n√≥ do gerador √© aproximadamente igual a 33000 Hz. </li><li>  DA38 DAC (534PA1) - converte um valor de 12 bits em um sinal bipolar anal√≥gico, o c√≥digo 2048 corresponde ao anal√≥gico 0. </li><li>  Filtro passa-baixo - constru√≠do de acordo com o esquema desenvolvido por Vladimir Kuzmin para o sintetizador Polivox, no entanto, um n√≥ para estabiliza√ß√£o t√©rmica da corrente de controle do filtro OA foi adicionado ao P432.  Al√©m disso, √© retirado do mesmo Polivox, onde foi usado para estabilizar a frequ√™ncia dos geradores.  No site do autor, voc√™ pode encontrar instru√ß√µes sobre como configurar este n√≥ [ <a href="https://habr.com/ru/post/482292/">6</a> ]. <br><br>  Muito j√° foi escrito sobre o pr√≥prio filtro, para que possamos fazer sem detalhes. <br>  O controle de filtro √© constru√≠do em um DAC de 10 bits (572PA1), cuja entrada √© alimentada com um sinal de "Filtro" de 8 bits, que √© o envelope do filtro e, dependendo do timbre, pode ser um valor constante e geralmente igual a zero.  Os par√¢metros do filtro tamb√©m s√£o afetados pelo valor de 4 bits do sinal ‚ÄúControl‚Äù: F0-F1 define o deslocamento da tens√£o de sa√≠da do DAC, e Q0-Q1 s√£o respons√°veis ‚Äã‚Äãpelo fator de qualidade (n√≠vel de resson√¢ncia) do filtro. </li><li>  Ap√≥s o filtro, √© instalado um comutador que permite ativar a mixagem com o sinal principal de sua c√≥pia processado pelo efeito HOP.  Nas primeiras modifica√ß√µes do P432, o mesmo interruptor foi usado para desligar a sa√≠da de som quando nenhuma tecla foi pressionada.  Por√©m, em revis√µes posteriores, isso foi recusado, eles come√ßaram a abrir caminhos, lan√ßar fios e adicionar novos elementos ao circuito. </li><li>  Amplificador - aumenta o n√≠vel do sinal de sa√≠da para 250mV. </li></ol><br><h3>  Configura√ß√£o e n√≥ da CPU </h3><br>  Ent√£o, descobrimos os geradores.  Agora resta entender de onde v√™m todos os sinais de controle e onde os par√¢metros que os descrevem s√£o armazenados. <br><br>  Inicialmente, planejei remover dumps de todos os sinais de controle por um analisador l√≥gico e criar um algoritmo para descrev√™-los.  Por exemplo, os envelopes do amplificador e do filtro podem ser descritos por uma fun√ß√£o linear por partes, que requer um n√∫mero limitado de par√¢metros. <br><br>  Com a entrada ‚ÄúFrequency‚Äù, tamb√©m foi suficiente registrar os valores de frequ√™ncia de uma √∫nica tecla para cada timbre e calcular todos os outros com base nela. <br><br>  De acordo com o manual de instru√ß√µes, o P432 possui um teclado de 41 teclas com um volume de 3 e 5/12 oitavas com um intervalo de C1-E4 na nota√ß√£o cient√≠fica ou C1-e1 na nota√ß√£o Helmholtz.  No entanto, na pr√°tica (para o tom 00), com base na correspond√™ncia A4 = 440 Hz, verificou-se que a tecla A na segunda oitava esquerda produz um som dessa frequ√™ncia, e isso j√° fornece a faixa C3-E6.  Como se viu mais tarde, dependendo do tom ativo, o alcance das frequ√™ncias reproduzidas pode variar, mudando em 1 ou 2 oitavas. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tamb√©m gravei os valores de bytes da entrada "Control" do analisador l√≥gico para todos os tons poss√≠veis e os trouxe para uma placa. </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lista de vozes e valores de entrada de controle</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/za/0x/9n/za0x9nglorah92outrafd3zafp8.png"></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Era √≥bvio que todos esses par√¢metros de configura√ß√£o deveriam ser armazenados em uma das ROMs do sintetizador e, ap√≥s uma pequena pesquisa, eles foram encontrados na segunda metade do firmware DD16 no n√≥ do processador. </font><font style="vertical-align: inherit;">Deixe-me lembr√°-lo de que o volume da ROM 573RF2 √© de 2048 bytes. </font></font><br><br><img src="https://habrastorage.org/webt/ra/li/sr/ralisrftayjhrw4kilnbi20ere4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1024 bytes da √°rea de configura√ß√£o foram facilmente divididos em 32 tons, alocando 32 bytes para as configura√ß√µes de cada timbre. </font><font style="vertical-align: inherit;">Passei bastante tempo procurando uma correla√ß√£o entre as configura√ß√µes de tom e as fases reais do envelope, a frequ√™ncia do som e muito mais. </font><font style="vertical-align: inherit;">Eu tive que olhar para muitos lix√µes do analisador l√≥gico.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O resultado √© essa tabela.</font></font></b> <div class="spoiler_text">      ,      00/FF,     . <br><div class="scrollable-table"><table><tbody><tr><th>  </th><th>  </th><th>  Descri√ß√£o do produto </th></tr><tr><td>  0 0 </td><td> FA_min </td><td>      </td></tr><tr><td>  1 </td><td> FA_dt </td><td>     </td></tr><tr><td>  2 </td><td> FA_max </td><td>     </td></tr><tr><td>  3 </td><td>  ? </td><td>  ? </td></tr><tr><td>  4 </td><td> FD_ft </td><td>      </td></tr><tr><td>  5 </td><td> FD_dt </td><td>     </td></tr><tr><td>  6 </td><td> FS_lvl </td><td>    </td></tr><tr><td>  7 </td><td> FREQ_u1 </td><td>     </td></tr><tr><td>  8 </td><td> FS_ft </td><td>      </td></tr><tr><td>  9 </td><td> FS_dt </td><td>     </td></tr><tr><td>  10 </td><td> FR_ft </td><td>      </td></tr><tr><td>  11 </td><td> FR_dt </td><td>     </td></tr><tr><td>  12 </td><td>  ? </td><td>  ? </td></tr><tr><td>  13 </td><td></td><td>  00 </td></tr><tr><td>  14 </td><td> FREQ_u2 </td><td>     </td></tr><tr><td>  15 </td><td> Ctrl </td><td>  ¬´¬ª </td></tr><tr><td>  16 </td><td> A_min </td><td>      </td></tr><tr><td>  17 </td><td> A_dt </td><td>     </td></tr><tr><td>  18 </td><td> A_max </td><td>      </td></tr><tr><td>  19 </td><td></td><td>  FF </td></tr><tr><td>  20 </td><td> D_ft </td><td>      </td></tr><tr><td>  21 </td><td> D_dt </td><td>     </td></tr><tr><td>  22 </td><td> S_lvl </td><td>    </td></tr><tr><td>  23 </td><td></td><td>  FF </td></tr><tr><td>  24 </td><td> S_ft </td><td>      </td></tr><tr><td>  25 </td><td></td><td>  00 </td></tr><tr><td>  26 </td><td></td><td>  00 </td></tr><tr><td>  27 </td><td> R_dt </td><td>      </td></tr><tr><td>  28. </td><td>  ? </td><td>  ? </td></tr><tr><td>  29 </td><td></td><td>  00 </td></tr><tr><td> 30 </td><td> FREQ_1 </td><td>     </td></tr><tr><td>  31 </td><td> FREQ_2 </td><td>     </td></tr></tbody></table></div></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como pode ser visto na tabela, todos os valores podem ser divididos em quatro grupos: a descri√ß√£o do envelope da entrada ‚ÄúAmplifier‚Äù, o envelope da entrada ‚ÄúFilter‚Äù, o byte da entrada ‚ÄúControl‚Äù e os bytes respons√°veis ‚Äã‚Äãpelas frequ√™ncias da voz principal e UNISON na entrada ‚ÄúFrequency‚Äù. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos consider√°-los com mais detalhes usando o exemplo do envelope do amplificador, com o qual eu lidei pela primeira vez. O envelope Filtro √© formado de maneira semelhante, com exce√ß√£o de alguns tons para os quais foi necess√°rio usar um c√≥digo r√≠gido, porque n√£o foi poss√≠vel obter o envelope correto de maneira diferente.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os par√¢metros com o sufixo * _dt especificam o delta da altera√ß√£o do n√≠vel do sinal da fase correspondente, por exemplo, para o tom 00: A_min = 0, A_dt = 48 e A_max = 255. Isso significa que o valor inicial do Ataque 0 deve ser incrementado em 48 at√© chegar a 255. Para a fase Fall, o valor de D_dt deve ser diminu√≠do de A_max para o n√≠vel S_lvl, se S_ft&gt; 0, o n√≠vel de Suporte deve diminuir a cada intervalo de S_ft em 1, simulando som suavemente desbotado. O par√¢metro R_dt indica o delta da fase de atenua√ß√£o: o n√≠vel atual do envelope deve ser reduzido em R_dt a cada intervalo de tempo at√© atingir o n√≠vel 0. O dt real √© 1 se o valor do par√¢metro * _dt &lt;= 1 e o valor * _dt em outros casos.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os par√¢metros * _ft determinam o tempo durante o qual o valor deve permanecer inalterado, um tipo de intervalo de amostragem para envelopes. Empiricamente, verificou-se que o valor zero deste par√¢metro corresponde a ~ 100 per√≠odos de amostragem DAC ou ~ 3 ms. Para valores maiores que zero, o tempo deve ser calculado usando a f√≥rmula </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int (256 / * _ft) * 100</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou seja, * _ft √© um multiplicador para o intervalo base de 100 per√≠odos DAC. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ilustra√ß√£o mostrando todas as op√ß√µes de envelope. No lado direito, ele √© duplicado com discretiza√ß√£o expl√≠cita para uma melhor compreens√£o da ess√™ncia dos par√¢metros * _ft / * _ dt. </font></font><br><br><img src="https://habrastorage.org/webt/l4/4x/eh/l44xehulnortzobmt4psredmfka.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O byte "Management" na √°rea de configura√ß√£o coincidiu com o que recebi empiricamente usando um analisador l√≥gico.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os bytes de frequ√™ncia determinam o valor da entrada Frequency. </font><font style="vertical-align: inherit;">Como j√° mencionado acima, o sintetizador pode tocar simultaneamente 4 vozes (polifonia), cada uma das quais, quando o UNISON est√° ligado, pode ser adicionado em un√≠ssono outro gerador com um ligeiro desafina√ß√£o ou deslocamento do principal por 1-2 oitavas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As frequ√™ncias s√£o codificadas em dois bytes: FREQ_1, FREQ_2 para o principal e FREQ_u1, FREQ_u2 para un√≠ssono. </font><font style="vertical-align: inherit;">Uma f√≥rmula derivada experimentalmente para calcular o valor da frequ√™ncia da nota A da segunda oitava do teclado P432.</font></font><br><br><pre><code class="python hljs">freq_offset = {<span class="hljs-number"><span class="hljs-number">4</span></span>:<span class="hljs-number"><span class="hljs-number">0xd0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>:<span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>:<span class="hljs-number"><span class="hljs-number">0x50</span></span>} freq = (config[<span class="hljs-string"><span class="hljs-string">'FREQ_1'</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + freq_offset[config[<span class="hljs-string"><span class="hljs-string">'FREQ_1'</span></span>]] + config[<span class="hljs-string"><span class="hljs-string">'FREQ_2'</span></span>]</code> </pre> <br>  Um exemplo para o tom 00, em que: FREQ_1 = 6, FREQ_2 = 8, obtemos: 6 * 0x100 + 0x50 + 8 = 0x658, o que √© consistente com os dados do analisador l√≥gico para todos os tons.  Por un√≠ssono, o c√°lculo √© semelhante. <br><br>  Vale ressaltar que, para o tom 00, o valor 0x658 corresponde a uma frequ√™ncia de 440 Hz ou nota A4. <br>  Foi experimentalmente estabelecido que o intervalo de "Frequ√™ncia" para teclas adjacentes (incluindo preto) √© de 16 (0x10) unidades.  Portanto, se soubermos o valor da 22¬™ chave √† esquerda (A da segunda oitava) - 0x658, podemos obter facilmente o valor para a extremidade esquerda (n¬∫ 1): 0x508 e a extremidade direita (n¬∫ 41): 0x788. <br><br>  Com base nisso, voc√™ pode calcular o alcance do teclado e as frequ√™ncias reproduzidas para diferentes tons.  A coluna "Frequ√™ncia" estar√° correta apenas para formas de onda simples. <br><div class="scrollable-table"><table><tbody><tr><th>  FREQ_1 </th><th>  Range </th><th>  Frequ√™ncia Hz </th><th>  Timbres </th></tr><tr><td>  4 </td><td>  C1 - E4 </td><td>  32,70 - 329,63 </td><td>  01, 07, 13, 14, 25, 30, 31, 32, 33, 34, 35 </td></tr><tr><td>  5 </td><td>  C2 - E5 </td><td>  65.41 - 659.26 </td><td>  03, 05, 06, 10, 15, 17, 23, 24, 27, 37 </td></tr><tr><td>  6 </td><td>  C3 - E6 </td><td>  130.81 - 1318.51 </td><td>  00, 02, 04, 11, 12, 16, 20, 21, 22, 26, 36 </td></tr></tbody></table></div>  O acima √© mais do que suficiente para criar o emulador P432, ent√£o vamos para ele. <br><br><h3>  Criando emula√ß√£o P432 em Python </h3><br>  Eu pensei que seria bom separar o armazenamento de configura√ß√£o e a gera√ß√£o de som, ent√£o duas classes principais foram criadas: <br><br><ul><li>  P432data, respons√°vel por carregar valores das imagens da ROM e trazer a configura√ß√£o dos tons para uma forma conveniente de uso; </li><li>  P432, contendo m√©todos para criar formas de envelope e realmente gerar amostras digitais. <br></li></ul>  N√£o vou me debru√ßar sobre o P432data em detalhes, o c√≥digo-fonte pode ser visualizado no github. <br>  Mas os m√©todos do P432 s√£o considerados em mais detalhes. <br><br>  O principal, √© claro, √© <b>gen_samples</b> com um par√¢metro indicando o n√∫mero de amostras que ele deve retornar.  Nesse m√©todo, o processamento de sinais desde o recebimento do valor na entrada ‚ÄúFrequency‚Äù at√© a sa√≠da para o DAC √© recriado o mais pr√≥ximo poss√≠vel do prot√≥tipo.  Em princ√≠pio, focando no esquema P432, voc√™ pode encontrar rapidamente os equivalentes em Python dos m√≥dulos do conjunto gerador.  A √∫nica coisa que precisou ser explicitamente adicionada foi a redu√ß√£o das vari√°veis ‚Äã‚Äãpara a dimens√£o especificada: 20 bits para o acumulador de fase, 11 bits para o somador de envelopes e 12 bits para o somador de votos.  Essa restri√ß√£o √© necess√°ria para que a l√≥gica de estouro dessas vari√°veis ‚Äã‚Äãfuncione normalmente. <br><br>  Os m√©todos para criar envelopes do amplificador <b>getADS</b> e o <b>formul√°rio do</b> filtro <b>getFADS</b> s√£o listados com os valores da amplitude do envelope, a partir dos quais gen_samples recebe valores no momento em que pressiona as teclas.  Eles possuem alguns m√©todos <b>getR</b> e <b>getFR</b> em sua empresa que formam a fase de atenua√ß√£o de envelopes.  Eles tomam o par√¢metro level como uma entrada - o valor atual do n√≠vel do envelope, a partir do qual ele diminuir√° para 0. <br><br>  As quatro vozes principais t√™m o mesmo formato de envelope do amplificador e do filtro, mas se o amplificador tiver seu pr√≥prio envelope para cada voz e iniciar quando uma tecla for pressionada, o filtro √© comum a todas as vozes, come√ßa na primeira press√£o, reinicia na pr√≥xima press√£o e dura at√© a √∫ltima deixando ir.  <a href="https://habr.com/ru/post/482292/">Olhe acima</a> <br><br>  De acordo com o manual de instru√ß√µes, o P432 emite n√∫meros de notas MIDI de 36 a 77 (na realidade 76) para as teclas de teclado 1 a 41, respectivamente.  Para n√£o reinventar a roda, decidi usar o intervalo 36-76 no emulador como os n√∫meros da tecla pressionada, ent√£o precisava do m√©todo midi2freq, que converte o n√∫mero da chave no valor "Frequency", levando em considera√ß√£o o tom selecionado. <br><br>  O √∫ltimo par de m√©todos foi <b>key_press</b> (midi_note) e <b>key_release</b> (midi_note), que formaram um dicion√°rio de correspond√™ncia da voz com a frequ√™ncia do tom fundamental, fase e posi√ß√£o atual do envelope. <br><br>  O √∫ltimo m√©todo principal √© o <b>setprog</b> (prog, clean = True), projetado para selecionar o som ativo.  <b>Setprog</b> carrega a configura√ß√£o do som desejado e, se o sinalizador limpo n√£o for limpo, limpa as vari√°veis ‚Äã‚Äãinternas.  Se clean estiver definido como False, as vari√°veis ‚Äã‚Äãinternas n√£o ser√£o redefinidas, o que permite alternar entre tons durante a gera√ß√£o do som praticamente sem cliques ou outros sons desagrad√°veis. <br><br>  Para gravar as amostras geradas no arquivo WAV, o m√©todo do utilit√°rio write_wav foi criado com base no m√≥dulo wave.  Para cada amostra, o dimensionamento √© realizado para aumentar a amplitude e traz√™-la para um formul√°rio assinado de 16 bits. <br><br>  Esses m√©todos s√£o suficientes para obter um arquivo wav com a grava√ß√£o de alguns segundos de qualquer um dos sons do sintetizador. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    p432=P432() #   p432.setprog(0) #     (  ) p432.unison=False p432.filter_en = False #   A   p432.key_press(57) #  3   samples=p432.gen_samples(33000*3) #   p432.key_release(57) #    p432.write_wav('test_00.wav',samples)</span></span></code> </pre> <br>  A forma de onda do timbre 00 √© um sinus√≥ide; portanto, na sa√≠da, obtemos um sinus√≥ide com um envelope sobreposto.  <a href="https://soundcloud.com/user-439332338/sound-00" rel="nofollow">Para ouvir.</a> <br><br><img src="https://habrastorage.org/webt/ab/69/fj/ab69fjssefu7whas7t2cgdwnehg.png"><br><br>  Um pouco mais interessante ser√° a grava√ß√£o do tom 14 com o un√≠ssono e o filtro ativados.  <a href="https://soundcloud.com/user-439332338/sound-14" rel="nofollow">Para ouvir.</a> <br><br><img src="https://habrastorage.org/webt/xp/zt/nc/xpztnckj7tfji6_nmuiozfuvn_o.png"><br><br><h4>  GUI </h4><br>  Um gerador de som do console √© bom, mas tamb√©m quero tocar no teclado.  Ent√£o, decidi criar uma GUI simples no Tkinter. <br><br>  A interface foi influenciada pelo P432 real, com a adi√ß√£o de uma legenda do teclado, um bot√£o de sele√ß√£o de entrada MIDI e a capacidade de desligar o filtro. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2p/1z/ac/2p1zac1vtiabmog8o9wurzqfoli.png"></div><br>  O bot√£o ‚ÄúMidi In‚Äù aparecer√° se voc√™ tiver o m√≥dulo ‚Äúpython-rtmidi‚Äù instalado.  Depois que voc√™ pressiona e seleciona o dispositivo de entrada Midi, o programa ativa uma fun√ß√£o de retorno de chamada que captura os eventos Note-On, Note-Off e Program Change em todos os 16 canais midi.  Atrav√©s da mudan√ßa de programa, voc√™ pode alterar o n√∫mero do tom do emulador ativo. <br><br>  Para interceptar as teclas digitadas no teclado, use o <b>m√©todo</b> Tkinter <b>bind ('&lt;KeyPress')</b> , <b>bind ('&lt;KeyRelease')</b> e, na fun√ß√£o de retorno de chamada, o n√∫mero da chave √© verificado com a lista permitida, convertido em uma nota midi e os m√©todos <b>p432.key_press ()</b> s√£o <b>chamados</b> , <b>p432.key_release ()</b> .  A intercepta√ß√£o √© ativada quando o programa √© iniciado e desativado no final. <br><br>  Para emitir som de streaming, o m√≥dulo pyaudio √© usado no modo sem bloqueio.  Ap√≥s renderizar a interface, ela inicia em um encadeamento de segmenta√ß√£o separado, e o tkinter continua trabalhando principalmente.  Na fun√ß√£o de retorno de chamada, o pyaudio passa o n√∫mero de amostras a serem geradas e, em troca, recebe amostras de gen_samples e um sinalizador de status.  Para reduzir a lat√™ncia entre o evento de anota√ß√£o (pressionando uma tecla) e a apar√™ncia do som, um buffer bastante pequeno √© selecionado: 200 amostras.  √â definido pelo par√¢metro frames_per_buffer do m√©todo open pyaudio. <br><br>  A vers√£o pyinstall compilada do P432_emulator for Windows pode ser baixada de <a href="" rel="nofollow">releases</a> . <br><br><h3>  Conclus√£o </h3><br>  Neste artigo, os detalhes da opera√ß√£o do filtro anal√≥gico no n√≥ do gerador (e sua implementa√ß√£o digital no emulador), o n√≥ do processador, o efeito HOP e a interface MIDI quase n√£o s√£o divulgados.  A √™nfase foi colocada no design da parte digital da unidade geradora, o m√©todo de armazenar os par√¢metros dos timbres e us√°-los na cria√ß√£o do emulador. <br><br>  Se o t√≥pico for de interesse, planejarei um segundo artigo com uma an√°lise do restante. <br><br>  Al√©m disso, se lhe parecer que h√° erros ou imprecis√µes na descri√ß√£o da opera√ß√£o dos n√≥s P432, escreva nos coment√°rios. <br><br>  O c√≥digo fonte do projeto, o firmware da ROM, os diagramas e o manual de opera√ß√£o est√£o dispon√≠veis no <a href="https://github.com/sintech/Formanta_P432" rel="nofollow">github</a> . <br><br><h3>  Refer√™ncias </h3><br><ol><li><a name="lit1"></a>  <a href="https://www.kit-e.ru/articles/elcomp/2001_07_50.php" rel="nofollow">Ridiko L. DDS: S√≠ntese direta de frequ√™ncia digital.</a> </li><li><a name="lit2"></a>  Museu de sintetizadores sovi√©ticos, Formant P432.  <a href="http://www.ruskeys.net/base/form432.php" rel="nofollow">www.ruskeys.net/base/form432.php</a> </li><li><a name="lit3"></a>  Wikipedia  <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D0%25BB%25D0%25B8%25D0%25B2%25D0%25BE%25D0%25BA%25D1%2581" rel="nofollow">Polyvox.</a> </li><li><a name="lit4"></a>  Instrumento de teclado eletromusical ‚ÄúFormant P432‚Äù.  <a href="https://github.com/sintech/Formanta_P432/raw/master/docs/Formanta%2520P432%2520Users%2520manual.pdf" rel="nofollow">Manual de opera√ß√£o</a> . </li><li><a name="lit5"></a>  <a href="https://github.com/sintech/Formanta_P432/tree/master/schematic" rel="nofollow">Diagramas esquem√°ticos el√©tricos do ‚ÄúFormant P432‚Äù.</a> </li><li><a name="lit6"></a>  <a href="http://www.muztech.com/manuals.php" rel="nofollow">Definir a estabilidade da temperatura do Polyvox.</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt482292/">https://habr.com/ru/post/pt482292/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt482282/index.html">O fim da era do ARMv7 ou um pouco sobre como portar jogos</a></li>
<li><a href="../pt482284/index.html">"50 tons de marrom" ou "como chegamos a isso"</a></li>
<li><a href="../pt482286/index.html">Revis√£o coletiva inesperada dos cartuchos Audio-Technica</a></li>
<li><a href="../pt482288/index.html">Presentes para o ouvinte atento: quais ganchos de √°udio estavam ocultos na "pr√©-lacuna" do CD de √°udio</a></li>
<li><a href="../pt482290/index.html">Bot de disc√≥rdia com economia com sqlite</a></li>
<li><a href="../pt482294/index.html">Not√≠cias do mundo do OpenStreetMap n¬∫ 491 (10.12.2019-16.12.2019)</a></li>
<li><a href="../pt482296/index.html">Tutorial do tutorial Ember.js. Aplicativo Super Rentals. Parte 1.1</a></li>
<li><a href="../pt482298/index.html">Programador fan√°tico. Como manter vantagens competitivas e se tornar vis√≠vel?</a></li>
<li><a href="../pt482300/index.html">Explorando registros Java 14</a></li>
<li><a href="../pt482302/index.html">Neblina psicol√≥gica sobre o Ano Novo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>