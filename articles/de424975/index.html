<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üà∏ üé° üë∞üèΩ SIEM-Tiefen: Out-of-Box-Korrelationen. Teil 2. Datenschema als Reflexion des Weltmodells üêÖ üëâüèæ üíû</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dies ist der zweite Artikel in der Reihe, der sich mit der Methodik zum Erstellen von sofort einsatzbereiten Korrelationsregeln f√ºr SIEM-Systeme befas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SIEM-Tiefen: Out-of-Box-Korrelationen. Teil 2. Datenschema als Reflexion des Weltmodells</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/424975/">  Dies ist der zweite Artikel in der Reihe, der sich mit der Methodik zum Erstellen von sofort einsatzbereiten Korrelationsregeln f√ºr SIEM-Systeme befasst.  Im vorherigen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel haben</a> wir uns diese Aufgabe gestellt, die Vorteile beschrieben, die sich aus der Implementierung ergeben, und die Hauptprobleme aufgelistet, die uns im Weg stehen.  In diesem Artikel werden wir nach L√∂sungen suchen und mit dem Problem der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Transformation des Modells der ‚ÄûWelt‚Äú</a> sowie seiner Manifestation im Stadium der Normalisierung von Ereignissen beginnen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/th/ty/w_/thtyw_5tngr0v1dhkcakeexhlw8.jpeg" alt="SIEM-Modelltransformation"></div><br><a name="habracut"></a><br>  Das Problem der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Transformation des Weltmodells</a> wurde im ersten Artikel beschrieben.  Erinnern wir uns kurz an sein Wesen: Wenn ein Ph√§nomen an der Quelle von Ereignissen auftritt (z. B. beim Starten eines Prozesses im Betriebssystem), wird es in verschiedenen Formaten festgelegt, zuerst im Speicher, dann im Ereignisprotokoll des Betriebssystems und dann im SIEM-System.  Jede Verarbeitungsstufe geht mit Datenverlust einher, da es auf Betriebssystemebene ein "Welt" -Modell gibt und im Betriebssystemprotokoll ein anderes, das durch eine Reihe von Feldern begrenzt ist, durch das Protokollschema.  Somit gibt es eine Reflexion (Transformation) eines Modells mit einer gro√üen Anzahl von Parametern zu einem anderen, mit einer kleineren Anzahl von Parametern.  Das Normalisieren und Speichern eines Ereignisses in SIEM ist eine weitere Transformation, die auch bei Datenverlust auftritt, da SIEM auch √ºber ein eigenes "Welt" -Modell verf√ºgt. <br><br>  Es ist schwierig, einen Weg zu finden, der die Transformation eines Modells in ein anderes ohne Verlust erm√∂glicht.  In Kenntnis dieser Einschr√§nkung ist es notwendig, einen solchen Ansatz zur Normalisierung und die Bildung einer Liste von Feldern des Ereignisschemas zu formulieren, in denen keine Informationen verloren gehen w√ºrden, was f√ºr die Korrelation und weitere Untersuchung von Vorf√§llen im Bereich der Informationssicherheit wichtig ist. <br><br>  Im Rahmen von SIEM wird ein Modell durch ein Schema dargestellt - eine Reihe von Feldern, in die Daten aus dem Anfangsereignis in den Normalisierungsprozess passen.  In Zukunft wird es von Spezialisten zur Erstellung von Korrelationsregeln verwendet.  Damit Vorfallermittler und diejenigen, die f√ºr die Entwicklung von Korrelationsregeln verantwortlich sind, normalisierte Ereignisse eindeutig interpretieren, muss das Schema die grundlegenden Eigenschaften erf√ºllen: <br><br><ul><li>  f√ºr Ereignisse jeglicher Art und Quellen einheitlich sein; </li><li>  Beschreiben Sie klar, wer mit wem und wie interagiert hat. </li><li>  Behalten Sie die Essenz und den Kontext der Interaktion. </li></ul><br>  Bei der Entwicklung von Normalisierungsregeln m√ºssen Informationen √ºber die Interaktion im Anfangsereignis gefunden und in speziell festgelegte Felder zerlegt werden.  Dasselbe muss mit dem Kontext und der Essenz der Interaktion gemacht werden (mehr dazu im n√§chsten Artikel). <br><br>  Es stellt sich die Frage: Ist es m√∂glich, typische Schemata f√ºr Interaktionen zu identifizieren, die alle von allen m√∂glichen IT- und Informationssicherheitsquellen verursachten Ereignisse erf√ºllen?  Wenn ja, wie sehen diese Schemata aus? <br><br>  Um die Antwort auf diese Fragen zu finden, m√ºssen Sie sich an die Analyse wenden und versuchen, so viele Normalisierungsregeln wie m√∂glich zu analysieren, die bereits in SIEM-L√∂sungen entwickelt wurden und funktionieren, um gemeinsame Muster zu identifizieren.  Im Rahmen dieser Arbeiten konnten mehr als 3.000 Normalisierungsregeln aus mehr als 100 verschiedenen Quellen aus L√∂sungen wie MaxPatrol SIEM von Positive Technologies und Micro Focus ArcSight analysiert werden.  Die Analyse ergab folgende Schlussfolgerungen: <br><br><ol><li>  Es gibt typische Interaktionsschemata. </li><li>  In jedem einzelnen Ereignis gibt es in der Regel Informationen zur Interaktion auf <b>Netzwerkebene</b> und auf <b>Anwendungsebene</b> . </li><li>  Typische Interaktionsmuster k√∂nnen auf verschiedenen Ebenen variieren, und dies muss ber√ºcksichtigt werden. </li></ol><br><a name="NetworkAppLevels"></a><br><h1>  Kommunikationsschemata auf Netzwerk- und Anwendungsschicht </h1><br>  Wir beschreiben typische Schemata f√ºr jede Ebene.  Zuvor m√ºssen Sie die Entit√§ten hervorheben, die in Ereignissen immer vorhanden sind.  Auf dieser Grundlage werden au√üerdem Interaktionsschemata erstellt.  Dazu geh√∂ren: <br><br><ul><li>  <b>Betreff</b> .  Eine Entit√§t, die ein Objekt betrifft.  Beispiel: Ein Benutzer, der einen Registrierungsschl√ºssel √§ndert, oder ein Host mit IP 10.0.0.1, der ein Paket an einen Host mit IP 20.0.0.1 sendet. </li><li>  <b>Objekt</b> .  Die vom Betreff betroffene Entit√§t. </li><li>  <b>Quelle</b>  In der Regel ein Host, der die Interaktion des Subjekts mit dem Objekt registriert und das Ereignis selbst generiert.  Die Quelle ist beispielsweise eine Firewall, die die √úbertragung von Paketen vom Host - dem Betreff mit IP 10.0.0.1 - zum Host - dem Objekt mit IP 20.0.0.1 - aufzeichnet. </li><li>  <b>Sender</b>  Es gibt F√§lle, in denen SIEM Ereignisse nicht direkt von der Quelle empf√§ngt, sondern von einem Zwischenserver, √ºber den diese Ereignisse √ºbertragen werden.  Das einfachste Beispiel ist ein Zwischen-Syslog-Server.  Ein Beispiel ist komplizierter - wenn der Sender ein Verwaltungsserver sein kann, z. B. Kaspersky Security Center.  In diesem Fall ist die Quelle ein spezifischer Agent von Kaspersky Endpoint Security. </li></ul><br>  Es k√∂nnen jedoch nicht alle Entit√§ten gleichzeitig in der Veranstaltung vertreten sein (dazu sp√§ter mehr). Daher ist es wichtig, zun√§chst Vereinbarungen zu treffen, da in diesem Fall die entsprechenden Felder des Schemas ausgef√ºllt sind.  Dies wird in Zukunft helfen, klar zwischen F√§llen zu unterscheiden, in denen diese Felder aufgrund eines Fehlers eines Spezialisten, der Normalisierungsregeln entwickelt, nicht ausgef√ºllt wurden, aus F√§llen, in denen das urspr√ºngliche Ereignis keine Daten √ºber eine Entit√§t enthielt. <br><br>  Kommen wir zu Interaktionsmustern und Ereignisbeispielen.  Aus Gr√ºnden der √úbersichtlichkeit werden alle Beispiele auf der Grundlage von Dateiprotokollen, Syslog-Nachrichten oder Datens√§tzen in einer relationalen Datenbank angegeben. Sie k√∂nnen jedoch auch f√ºr andere Protokollformate verwendet werden, z. B. bin√§r. <br><br><h2>  Netzwerkebene </h2><br>  Die prim√§re Kennung f√ºr Entit√§ten auf Netzwerkebene sind IP-Adressen.  Es ist wichtig zu verstehen, dass es m√∂glicherweise andere verwandte Kennungen gibt - MAC-Adressen auf Kanalebene, FQDN - auf Anwendungsebene.  Es stellt sich die Frage: Sprechen sie √ºber dieselbe oder eine andere Entit√§t?  K√∂nnen sich diese Bezeichner im Laufe der Zeit mit derselben Entit√§t √§ndern?  Ein separater Artikel wird diesem Thema gewidmet sein. Lassen Sie uns nun auf die Tatsache eingehen, dass die Hauptkennung f√ºr Interaktionsmodelle auf Netzwerkebene die IP-Adresse ist. <br><br>  Die typischen Interaktionsschemata dieser Ebene k√∂nnen also in zwei Klassen unterteilt werden - grundlegend und entartet. <br><br><h3>  Grundlegende Interaktionsschemata </h3><br><a name="Schema1"></a><br><img src="https://habrastorage.org/webt/-s/nl/ii/-snliisaaef13_b5_bvrawyycxi.png" height="262"><br>  <i>Schema 1. Vollst√§ndiges Interaktionsschema</i> <br><br>  Im Rahmen dieses Modells k√∂nnen f√ºr den Fall, der am SIEM-Eingang empfangen wird, alle Hauptentit√§ten unterschieden werden: Subjekt, Objekt, Quelle, Sender.  Im Interaktionsschema wirkt das Subjekt auf das Objekt.  Dieser Effekt registriert (beobachtet) die Quelle und erzeugt ein Ereignis.  Das Ereignis von der Quelle tritt in den Sender und von dort in das SIEM ein. <br><br>  Das folgende Ereignis erfasst die Aufl√∂sung der Netzwerkinteraktion zwischen Hosts durch die Stonesoft-Firewall (jetzt Forcepoint), w√§hrend das Ereignis selbst nicht direkt in SIEM eingeht, sondern von einem zwischengeschalteten Syslog-Server. <br><br><img src="https://habrastorage.org/webt/rr/99/hk/rr99hkccik_qrx1gqndn6dub870.png"><br><br>  Hier: <br>  <b>40.0.0.1</b> - Sender (Zwischen-Syslog-Server), <br>  <b>30.0.0.1</b> - Quelle (Firewall-Knoten), <br>  <b>10.0.0.1</b> - Betreff (Senden von UDP-Paketen), <br>  <b>20.0.0.1</b> - Ein Objekt (Empfang von UDP-Paketen). <br><br><img src="https://habrastorage.org/webt/mm/tv/3d/mmtv3d2b7w5gan5mcmxzuvsyyaa.png"><br>  <i>Diagramm 2: Direktes Erfassungsdiagramm ohne Sender</i> <br><br>  Nicht immer im Interaktionsschema ist ein Sender.  In der Regel ist es vorhanden, wenn ein Zwischenserver (z. B. ein Syslog-Server) zum √úbertragen von Ereignissen verwendet wird oder wenn die L√∂sung, von der Ereignisse erfasst werden, √ºber ein zentrales Verwaltungssystem verf√ºgt, z. B. Kaspersky Security Center, Check Point Smart Console oder Cisco Prime.  Bei diesem Schema fallen Ereignisse direkt von der Quelle in SIEM.  Am allermeisten werden Ereignisse durch dieses spezielle Schema beschrieben.  Ein Beispiel f√ºr ein solches Ereignis ist √ºbrigens in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abbildung 1</a> zu sehen, wenn kein Zwischen-Syslog-Server vorhanden war und wir Ereignisse direkt von der Firewall erhalten haben. <br><br><img src="https://habrastorage.org/webt/gu/vp/aw/guvpawlp6njgeswk6dukx9cf5io.png"><br><br>  Hier: <br>  <b>30.0.0.1</b> - Quelle (Firewall-Knoten), <br>  <b>10.0.0.1</b> - Betreff (Senden von UDP-Paketen), <br>  <b>20.0.0.1</b> - Ein Objekt (Empfang von UDP-Paketen). <br><br><img src="https://habrastorage.org/webt/b8/0s/m2/b80sm2hvahlh46ih3ylmb8tut9w.png"><br>  <i>Schema 3. Interaktion mit vielen Objekten</i> <br><br>  Dieses Interaktionsschema auf Netzwerkebene ist ziemlich selten und in der Regel typisch f√ºr Ereignisse von Netzwerkger√§ten.  In dem Schema interagiert ein Subjekt mit vielen Objekten. Eine √§hnliche Interaktion ist bei Ereignissen vorhanden, die Multicast-, Unicast- oder Broadcast-Broadcasts beschreiben. <br><br>  Beachten Sie, dass manchmal viele Objekte durch eine gemeinsame Kennung verbunden werden k√∂nnen - eine Subnetzadresse oder eine Broadcast-Adresse.  Dies sollte beachtet werden, da Sie bei der Analyse von Ereignissen, auch auf der Ebene der Korrelationsregeln, die potenziell wichtige Interaktion leicht √ºberspringen k√∂nnen, da in einem solchen Schema die Objektadresse hinter der Gruppenadresse verborgen ist. <br><br>  Das folgende Beispiel zeigt ein Ereignis von einem IGMP-Relay-Server, √ºber das eine Multicast-Mitgliedschaftsanforderung gesendet wird. <br><br><img src="https://habrastorage.org/webt/i7/zj/yk/i7zjykhwdwtzkocjqqaexwiiey0.png"><br><br>  Hier: <br>  <b>30.0.0.1</b> - Quelle (IGMP-Relay-Server), <br>  <b>10.0.0.1</b> - Betreff (Antrag auf Mitgliedschaft in einer Gruppe), <br>  <b>224.0.0.252</b> - Das Objekt (Multicast-Adresse). <br><br><h3>  Entartete Systeme </h3><br>  Subjekt, Objekt und Quelle sind die grundlegenden Entit√§ten in der Gruppe der grundlegenden Interaktionsschemata.  Es gibt jedoch F√§lle, in denen eine der Entit√§ten in diesem Fall abwesend sein kann. <br><br><img src="https://habrastorage.org/webt/e8/h_/z4/e8h_z4bo7ixafd2vytv7y-gxuqa.png"><br>  <i>Schema 4. Interaktion ohne Objekt</i> <br><br>  Oft ist ein solches Muster typisch in Situationen, in denen das Subjekt eine √Ñnderung seines inneren Zustands meldet - das hei√üt, es handelt gleichzeitig in der Rolle des Subjekts und des Objekts.  Diese Interaktion kann beispielsweise bei Konfigurations√§nderungen oder Malware-Erkennungsereignissen auf der Workstation beobachtet werden.  Diese Informationen werden jedoch nicht vom Subjekt selbst aufgezeichnet, sondern von einem zentralen Managementsystem und in seinem Tagebuch gespeichert. <br><br>  Das Beispiel zeigt, wie der Symantec Management Server erfasst, dass der von ihm verwaltete Symantec Endpoint Protection-Agent eine sch√§dliche Datei auf seinem Host erkannt hat. <br><br><img src="https://habrastorage.org/webt/uc/8i/tk/uc8itkdycqecus0f5xb2zhxlbgi.png"><br><br>  Hier: <br>  <b>30.0.0.1</b> - Quelle (Symantec Management Server), <br>  <b>10.0.0.1</b> - Betreff (Symantec Endpoint Protection Agent). <br><br><img src="https://habrastorage.org/webt/qq/wg/ao/qqwgaoqcw7dwndbgulrzbdimunm.png"><br>  <i>Schema 5. Kombination der Rolle des Subjekts und des Objekts in der Quelle</i> <br><br>  Das letzte entartete Interaktionsschema ist typisch f√ºr eine Situation, in der SIEM Ereignisse von einer Quelle empf√§ngt, die eine √Ñnderung ihres internen Status melden: z. B. Neukonfiguration eines Ger√§ts oder einer Software, Aktivieren oder Deaktivieren eines Netzwerkports.  In einem solchen Schema stimmt die Rolle der Quelle mit der Rolle des Subjekts und des Objekts √ºberein.  Im Gegensatz zum vorherigen Schema treten hier Ereignisse in SIEM direkt auf. <br><br>  In diesem Beispiel meldet ein Cisco IOS-basierter Switch, dass seine Schnittstelle in den UP-Status √ºbergegangen ist. <br><br><img src="https://habrastorage.org/webt/in/ap/cd/inapcd3rbeuutgbgivcfmt-ujmq.png"><br><br>  Hier ist <b>30.0.0.1</b> die Quelle (Schalter). <br><br><h2>  Anwendungsebene </h2><br>  Auf dieser Ebene gibt es Interaktionen bereits bekannter Entit√§ten: Subjekt, Objekt.  Alle Informationen √ºber die Quelle und den Sender verbleiben jedoch direkt auf Netzwerkebene und werden auf Anwendungsebene nicht wiedergegeben. <br><br>  Die meisten Arten von Ereignissen beinhalten Interaktionen gleichzeitig auf Netzwerkebene und Anwendungsebene.  Wir stellen jedoch fest, dass Ereignisse, die direkt von der Anwendungssoftware generiert werden, z. B. 1C: Enterprise, Microsoft SQL Server oder Oracle Database, ausschlie√ülich Interaktionen auf Anwendungsebene enthalten k√∂nnen. <br><br>  Dar√ºber hinaus wird auf Anwendungsebene eine zus√§tzliche <b>Ressourcenentit√§t</b> angezeigt. <br><br>  <b>Eine Ressource</b> ist eine Zwischeneinheit, durch die das Subjekt ohne direkte Interaktion Einfluss auf das Objekt aus√ºbt.  Zum Beispiel, indem Sie Alex die Rechte gew√§hren, Bob auf die MyFile zuzugreifen.  Hier ist Alex das Subjekt, Bob ist das Objekt, MyFile ist die Ressource.  Bitte beachten Sie, dass Alex in diesem Beispiel nicht direkt mit Bob interagiert. <br><br>  <i>Wichtig</i> : Ereignisse auf Anwendungsebene k√∂nnen sowohl zus√§tzliche Parameter des Betreffs und des Objekts als auch die Ressource selbst enthalten.  Zus√§tzliche Parameter einer solchen Ressource wie einer ‚ÄûDatei‚Äú k√∂nnen beispielsweise das Verzeichnis sein, in dem sie sich befindet, oder ihre Gr√∂√üe. <br>  In diesem Fall werden Betreff, Objekt und Ressource anhand des Namens oder der eindeutigen Kennung identifiziert: E-Mail-Adresse, Dateiname, Verzeichnisname, Tabellenname in der Datenbank. <br><br>  Ber√ºcksichtigen Sie zus√§tzliche Interaktionsmuster, die f√ºr die Anwendungsebene spezifisch sind. <br><br><img src="https://habrastorage.org/webt/tg/lk/rm/tglkrmwarm0l4og50f0igcsgwhm.png"><br>  <i>Abbildung 6. Ressourceninteraktion</i> <br><br>  In diesem Diagramm wirkt das Subjekt indirekt √ºber eine Zwischenressource auf das Objekt.  Ereignisse mit einem solchen Schema sind in der Regel in den Datenbank√ºberwachungsprotokollen oder bei der Arbeit mit Zugriffsrechten auf Dateien und Verzeichnisse auf Betriebssystemebene deutlich sichtbar. <br><br>  Das Beispiel zeigt einen Eintrag aus der √úberwachungsdatenbank der Oracle-Datenbank.  Es behebt den Vorgang des Widerrufs einer Rolle von einem Benutzer. <br><br><img src="https://habrastorage.org/webt/fc/fe/l3/fcfel3yxldwmxgxkj8mnp_3uf8k.png"><br><br>  Hier: <br>  <b>"ALEX"</b> - Betreff (Benutzername, der die Rolle zur√ºckzieht), <br>  <b>"BOB"</b> - Objekt (Name des Benutzers, der widerrufen wird), <br>  <b>"ROLLE"</b> - Ressource (Name der widerrufenen Rolle). <br><br><img src="https://habrastorage.org/webt/3m/kt/93/3mkt93zoast_9sgow61s6yiaou8.png"><br>  <i>Abbildung 7. Interaktion mit vielen Ressourcen</i> <br><br>  Sowohl auf Anwendungsebene als auch auf Netzwerkebene gibt es solche Arten von Ereignissen, bei denen der Betreff √ºber viele Ressourcen sofort mit dem Objekt interagiert.  Es ist sehr selten, aber es gibt Zeiten, in denen die Anzahl der Objekte auch mehr als eins betr√§gt.  Diese Arten von Ereignissen werden beim Korrigieren von Massenvorg√§ngen angezeigt.  Sie k√∂nnen beispielsweise einem Benutzer Zugriff auf mehrere Dateien gew√§hren oder die in der Richtlinie enthaltenen Regeln √§ndern. <br><br>  In diesem Beispiel erfasst die L√∂sung zum Schutz virtueller Umgebungen vGate Security Code das Hinzuf√ºgen neuer Richtlinien zum Satz. <br><br><img src="https://habrastorage.org/webt/jp/hn/il/jphnilptae5cmxk3by0plhdjnno.png"><br><br>  Hier: <br>  <b>"Admin @ VGATE"</b> - Betreff (Name des Benutzers, der die Richtlinien √§ndert) <br>  <b>"Basis"</b> - Objekt (Richtliniensatz) <br>  <b>"Installieren und Aufrechterhalten der Integrit√§t des Dateisystems", "√úberpr√ºfen der Einstellungen des SNMP-Agenten", "Deaktivieren der automatischen Installation von VMware Tools"</b> - Ressourcen (Namen der hinzugef√ºgten Richtlinien) <br><a name="ChannelModel"></a><br><h1>  Das Modell des Interaktionskanals zwischen Subjekt und Objekt </h1><br>  Bei allen Schemata haben wir verschiedene Entit√§ten (Subjekte, Objekte, Ressourcen, Quellen, Sender) unterschieden und den sogenannten Interaktionskanal zwischen ihnen festgestellt.  Lassen Sie uns n√§her auf die vorletzte Komponente des gro√üen ‚ÄûWeltmodells‚Äú eingehen, mit dem SIEM arbeiten muss - auf die Modelle des Interaktionskanals zwischen Subjekt und Objekt.  Denken Sie daran, dass die letzte Komponente der Kontext der Interaktion ist (der n√§chste Artikel wird diesem Thema gewidmet sein). <br><br>  Es gibt also zwei Entit√§ten, die miteinander interagieren.  Im Rahmen dieser Interaktion werden Daten von einer Entit√§t zu einer anderen √ºbertragen.  Dies k√∂nnen Netzwerkpakete mit Daten, Dateien oder Verwaltungsbefehlen sein.  In diesem Fall kann der gebildete Kanal in Form einer "Pipe" dargestellt werden, entlang derer ein gerichteter Daten- und Befehlsfluss stattfindet.  Ein solches Modell ist auf Netzwerkebene deutlich sichtbar, auf Anwendungsebene jedoch weniger ausgepr√§gt (siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel</a> ). <br><br><img src="https://habrastorage.org/webt/pi/3i/hl/pi3ihljaztjgnfszntwesq3s5k8.png"><br>  <i>Datenkanalmodell</i> <br><br>  Basierend auf einem solchen Modell kann jedes Ereignis, das das SIEM empf√§ngt, Informationen enthalten, die Folgendes beschreiben: <br><br><ul><li>  Die Parameter des Kanals selbst sind die "Pipe", </li><li>  Die √ºber diese ‚ÄûPipe‚Äú √ºbertragenen Daten. </li></ul><br>  Typischerweise wird ein Kanal durch Parameter wie Sitzungskennung, Daten√ºbertragungsprotokoll, Kanalaufbauzeit, Abschlusszeit, Dauer beschrieben.  Daten in Ereignissen sind durch das von den Verschl√ºsselungsalgorithmen verwendete Format, die Anzahl der √ºbertragenen Pakete und die Anzahl der √ºbertragenen Bytes gekennzeichnet. <br><br>  Stellen Sie sich ein Beispiel f√ºr ein Ereignis vor, das Daten zum Interaktionskanal enth√§lt.  Hier ist ein Ereignis der Cisco Identity Services Engine (ISE), eines Prozessmanagementsystems zum Identifizieren und Steuern des Zugriffs, das die Netzwerksitzung eines Benutzers als Teil des Abrechnungsverfahrens (Abrechnung) aufzeichnet. <br><br><a name="ComplexExample"></a><br><img src="https://habrastorage.org/webt/op/qr/qt/opqrqtfyo0do7ybijdpx7gm_va4.png"><br><br>  Hier: <br>  <b>"Acct-Session-Id = 1A346216", "Acct-Session-Time = 50", "Service-Type = Framed", "Framed-Protocol = PPP"</b> - Kommunikationskanalparameter, <br>  <b>"Acct-Input-Octets = 43525", "Acct-Output-Octets = 122215", "Acct-Input-Packets = 234", "Acct-Output-Packets = 466"</b> - Parameter der √ºber den Kanal √ºbertragenen Daten. <br><br><h1>  Ein Beispiel f√ºr Modelle der Interaktion von Entit√§ten und Kanal in einem Ereignis </h1><br>  Daher untersuchten wir die Interaktionsschemata von Netzwerkebenen und -anwendungen sowie das Modell des Interaktionskanals.  Als n√§chstes zeigen wir ein Beispiel daf√ºr, wie in einem Fall die Interaktionsschemata verschiedener Ebenen kombiniert und Informationen √ºber das Kanalmodell verwendet werden. <br><br>  Hier sehen wir ein Ereignis von der Firewall - die Cisco Adaptive Security Appliance (ASA), bei der eine ausgehende TCP-Verbindung behoben ist. <br><br><img src="https://habrastorage.org/webt/ls/ra/i5/lsrai5eqgcgrydjiwanqr4hhfde.png"><br><br>  Das Beispiel zeigt deutlich, dass es innerhalb eines Ereignisses Entit√§ten auf Netzwerkebene und auf Anwendungsebene gibt.  Auf Netzwerkebene ein Interaktionsschema zwischen Subjekt und Objekt, das von der Quelle festgelegt wird.  Es gibt keinen Sender. <br><br>  Hier: <br>  <b>30.0.0.1</b> - Quelle (Cisco ASA), <br>  <b>10.0.0.1</b> - Betreff (die Adresse <b>desjenigen,</b> der die Verbindung herstellt), <br>  <b>20.0.0.1</b> - Ein Objekt (die Adresse des Objekts, mit dem sie verbunden sind). <br><br>  Auf Anwendungsebene ein einfaches Schema, in dem nur das Subjekt und das Objekt vorhanden sind: <br>  <b>"ALEX"</b> - Betreff (Benutzername, der verbindet), <br>  <b>"BOB"</b> - Das Objekt (der Name des Benutzers, mit dem er eine Verbindung herstellt). <br><br>  Auch in diesem Fall gibt es eine Beschreibung des Daten√ºbertragungskanals, aber keine Beschreibung der Daten selbst: <br>  <b>"TCP"</b> ist das Protokoll, auf dessen Grundlage der Kanal erstellt wurde. <br>  <b>"136247"</b> ist die <b>Kanalsitzungskennung</b> . <br><br><h1>  Schlussfolgerungen </h1><br>  Wie k√∂nnen die von uns hervorgehobenen typischen Interaktionsschemata helfen? <br><br><ul><li>  <b>Erstens</b> sollte ein Experte beim Schreiben von Korrelationsregeln und beim Analysieren von Ereignissen verstehen, welche Entit√§ten in jedem Ereignis vorhanden sind, das bei SIEM eintrifft.  Dazu ist es im Stadium der Normalisierung von Ereignissen erforderlich, die Entit√§ten klar zu unterscheiden: Subjekt, Objekt, Ressource, Quelle und Sender. </li><li>  <b>Zweitens</b> ist es bei der Normalisierung wichtig zu ber√ºcksichtigen, dass das Ereignis Informationen sowohl √ºber die Interaktion der Netzwerkebene als auch der Anwendungsebene enth√§lt.  Diese beiden Wechselwirkungen k√∂nnen gleichzeitig in einem Ereignis vorhanden sein. </li><li>  <b>Drittens</b> ist die Wechselwirkung selbst eine zusammengesetzte Struktur, in der Informationen √ºber den gebildeten Kanal und √ºber die √ºber diesen Kanal √ºbertragenen Daten vorliegen. </li></ul><br>  Daher sollte das Modell der ‚ÄûWelt‚Äú, das in SIEM erstellt und durch eine Reihe von Feldern (ein Schema) dargestellt wird, Abschnitte zur Beschreibung enthalten: <br><br><ol><li>  <b>Auf Netzwerkebene</b> : <br><ul><li>  Betreff; </li><li>  Das Objekt; </li><li>  Quelle; </li><li>  Sender </li><li>  Kanal der Interaktion; </li><li>  √úber den Kanal √ºbertragene Daten. </li></ul><br></li><li>  <b>Auf Anwendungsebene</b> : <br><ul><li>  Betreff; </li><li>  Ein Objekt oder eine Vielzahl von Objekten; </li><li>  Eine Ressource oder mehrere Ressourcen. </li></ul><br></li></ol><br>  F√ºr jede Entit√§t muss eine Reihe von Eigenschaften definiert werden, die sie eindeutig identifizieren.  Auf Netzwerkebene werden Entit√§ten durch IP, MAC oder FQDN identifiziert.  Auf Anwendungsebene nach Name oder ID.  Das Schema muss √ºber dedizierte Felder zum Speichern dieser Bezeichner verf√ºgen. <br><br>  Es gibt entartete Interaktionsschemata, in denen eine Entit√§t mehrere Rollen gleichzeitig kombinieren kann.  Bei der Normalisierung solcher Ereignisse muss die Regel zum Ausf√ºllen aller Felder des Schemas, die f√ºr die gesamte Gruppe von Entit√§ten verantwortlich sind, explizit definiert werden.  In Zukunft wird dies den Korrelationsregeln helfen, einen Teil der Interaktionen nicht zu verpassen. <br><br>  Lassen Sie uns erkl√§ren: Nehmen wir den Fall, die Rolle des Subjekts und des Objekts in der Quelle zu kombinieren.        ,   ,   ,           ,      . <br><br>       ,          .      ,   . <br><br>    ,      ,  : <br><br><img src="https://habrastorage.org/webt/zo/dp/if/zodpiffknu6hbuk7e0rqpqg4h7q.png"><br> <i> ,   </i> <br><br>   ‚Äî    ¬´¬ª SIEM     ,     .  ,   ,   Alex        , ‚Äî  ,      , , .         ,       . , -     ,      ,    SIEM    . <br><br>        ,        ,    .          ,      ,     . <br><br><hr><br> <b> :</b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SIEM:  ¬´ ¬ª.  1:     ?</a> <br><br>  SIEM:  ¬´ ¬ª.  2.      ¬´¬ª ( <i> </i> ) <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SIEM:  ¬´ ¬ª.  3.1.  </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SIEM:  ¬´ ¬ª.  3.2.   </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SIEM:  ¬´ ¬ª.  4.      </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SIEM:  ¬´ ¬ª.  5.    </a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de424975/">https://habr.com/ru/post/de424975/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de424965/index.html">Reagieren Sie auf die Anwendungsentwicklung mit ReasonReact</a></li>
<li><a href="../de424967/index.html">JavaScript-Verkn√ºpfungen f√ºr Anf√§nger</a></li>
<li><a href="../de424969/index.html">Node.js-Handbuch, Teil 9: Arbeiten mit dem Dateisystem</a></li>
<li><a href="../de424971/index.html">Habrokast "Sunset Manually" # 1. Versuch, eine Umgebung f√ºr die Entwicklung eines Spielzeugs f√ºr Windows einzurichten</a></li>
<li><a href="../de424973/index.html">Gesichtserkennung auf Video: Raspberry Pi und Neural Compute Stick</a></li>
<li><a href="../de424977/index.html">Aus Fehlern lernen: Anwendungen im App Store und bei Google Play optimieren</a></li>
<li><a href="../de424979/index.html">Ulme. Bequem und umst√§ndlich. HTTP, Aufgabe</a></li>
<li><a href="../de424981/index.html">Osterei-Text-Rollenspiel im Google-Suchmaschinencode</a></li>
<li><a href="../de424985/index.html">In einem wichtigen Pr√§zedenzfall konnten US-Geheimdienste Anrufe im Messenger nicht abh√∂ren</a></li>
<li><a href="../de424987/index.html">Stellen Sie mit dem Wiener Filter unscharfe und defokussierte Bilder wieder her. Implementierung in C ++ OpenCV</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>