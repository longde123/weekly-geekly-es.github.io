<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚Äçüéì üèÇüèæ üôåüèø Panneau de commande centralis√© pour sources d'√©clairage TsPKIO-2D Rotor üë®‚Äçüë®‚Äçüë¶‚Äçüë¶ ‚õèÔ∏è üë®üèΩ‚Äçüöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="D√©sol√©, je ne m'amuse pas depuis longtemps avec le nommage, ainsi qu'avec les p√©riph√©riques pour la domotique. Plus pr√©cis√©ment, cette chose - la t√©l√©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Panneau de commande centralis√© pour sources d'√©clairage TsPKIO-2D Rotor</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/411093/"><img src="https://habrastorage.org/getpro/geektimes/post_images/72f/6a9/ceb/72f6a9ceb826b19cdb266c3d334da65b.jpg" alt="image"><br><br>  D√©sol√©, je ne m'amuse pas depuis longtemps avec le nommage, ainsi qu'avec les p√©riph√©riques pour la domotique.  Plus pr√©cis√©ment, cette chose - la t√©l√©commande de la lumi√®re - s'est av√©r√©e parce que je voulais quelque chose avec une interface push-twist-click, et non avec une dispersion habituelle de boutons.  L'effet wow n'a pas √©t√© atteint: √† la maison, je ne remarque pas la t√©l√©commande √† bout portant, mais au moins j'ai ferm√© la gestalt. <br><a name="habracut"></a><br>  TOR TOR: <br><br>  1) Gestion de trois groupes d'√©clairage dans la cuisine <br>  2) Gestion de trois groupes d'√©clairage dans la salle <br>  3) Gestion de toutes les sources lumineuses en m√™me temps <br>  4) Dur√©e de vie raisonnable de la batterie (√† partir d'une semaine) <br>  5) Compatible avec le codage Livolo, SC2260, EV1527 <br><br>  Donc, vous n'avez pas besoin de lire plus si vous n'aimez pas Arduino, les commutateurs Livolo et les prises radio chinoises.  Parce que le premier est la base de la t√©l√©commande, et le deuxi√®me et le troisi√®me sont la p√©riph√©rie. <br><br><h2>  Concept </h2><br>  La logique de contr√¥le m'a sembl√© comme suit: <br><br><ol><li>  Une pression sur le ¬´bouton¬ª commute les zones du groupe d'√©clairage dans un anneau (cuisine - pi√®ce - tout). </li><li>  Tourner le bouton, selon le sens de rotation, allume ou √©teint l'√©clairage du groupe s√©lectionn√©. </li><li>  Le mode de fonctionnement (groupe s√©lectionn√©) est affich√© par une indication LED discr√®te. </li></ol><br>  √âtant donn√© que j'utilise la radiocommande selon l'option la plus m√©pris√©e, sans protection contre les interf√©rences et les retours, en m√™me temps, une petite astuce est fournie en cas d'op√©ration manqu√©e. <br><br>  Si le fait de tourner le bouton n'aboutit pas au r√©sultat souhait√©, une pression et une rotation combin√©es dans le sens oppos√© vous permettent de sauter la commande.  Ensuite, la commande peut √™tre r√©p√©t√©e comme d'habitude. <br><br>  Autrement dit, si j'ai tourn√© le bouton dans le sens des aiguilles d'une montre et que la lumi√®re principale ne s'est pas allum√©e, je peux appuyer sur le bouton, le tourner dans le sens inverse des aiguilles d'une montre, puis le rel√¢cher et le tourner √† nouveau dans le sens des aiguilles d'une montre pour r√©p√©ter l'activation. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/V0ZpCxEb3-U" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Pourquoi si dur?  Ensuite, en plus des protocoles maladroits, j'ai aussi des p√©riph√©riques maladroits.  Par exemple, les interrupteurs d'√©clairage radiocommand√©s Livolo et les relais radio, qui ont la m√™me commande pour allumer et √©teindre, ainsi que les prises radio ordinaires, dans lesquelles les commandes pour allumer et √©teindre sont s√©par√©es. <br><br>  L'astuce de saut d'√©quipe vous permet de battre de mani√®re cr√©ative la non-inclusion (non-exclusion) sans rompre le sch√©ma g√©n√©ral de l'√©clairage.  De plus, sauter une commande vous permet de sauter par-dessus des sources de lumi√®re que vous n'avez pas besoin d'activer ou de d√©sactiver. <br><br>  Eh bien, bien s√ªr, pour comprendre ce qui se passe avec la t√©l√©commande, elle a un indicateur s√©par√© qui s'allume lors de l'envoi d'une commande. <br><br>  Si la console n'est pas touch√©e pendant un certain temps (configur√© dans le code), le contr√¥leur se met en veille.  Cependant, il ne sauvegarde pas le dernier √©tat, et quand il se r√©veille en appuyant sur le stylo, il recommence sa vie √† z√©ro. <br><br>  Ce n'est pas une erreur.  Je le r√©p√®te, j'ai des commutateurs sans r√©troaction et la console est physiquement incapable d'obtenir des informations sur l'√©tat actuel de chaque p√©riph√©rique contr√¥l√©. <br><br>  Par cons√©quent, imm√©diatement apr√®s le r√©veil, le tour du bouton allume ou √©teint la lumi√®re √† partir de z√©ro. <br><br><h2>  Premi√®re approche </h2><br>  Le concept visuel du type ¬´bo√Æte avec une torsion¬ª exigeait, comme vous pouvez le deviner, deux choses: des bo√Ætes et des torsions.  Dans la premi√®re version, le r√¥le de la box √©tait jou√© par une banque d'alimentation mince, dont l'utilisation r√©solvait deux probl√®mes √† la fois: j'avais √† la fois un bo√Ætier et un syst√®me de charge de batterie, en plus avec un connecteur.  La batterie elle-m√™me, bien s√ªr, devait √™tre remplac√©e par une batterie plus compacte, sinon le remplissage ne pourrait plus tenir. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/640/299/4df/6402994df7e71b82835d12f42541f1f0.jpg" alt="image"><br><br>  Cela s'est av√©r√© plus complexe avec la torsion.  En cherchant, j'ai trouv√© que plus le bouton du potentiom√®tre √©tait joli et plus il √©tait grand, plus le co√ªt de son gramme √©tait proche du co√ªt d'un gramme d'or.  Par cons√©quent, j'ai acquis un stylo, qui me convenait peu aux propri√©t√©s esth√©tiques. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/232/a3e/b60/232a3eb6074d6d8724fdc76d353274cc.jpg" alt="image"><br><br>  La partie contr√¥le √©tait le r√©sultat d'une exp√©rience avec ATmega328P et une suite logique du sc√©nario d√©fini par la domotique existante (sur les m√™mes protocoles radio Arduino et primitifs). <br><br>  Je n'ai pas achet√© tr√®s cher une dispersion des contr√¥leurs mentionn√©s et des prototypes conditionnels (en fait, un adaptateur d'un petit bo√Ætier √† une grande √©tape) de circuits imprim√©s dans le but d'essayer d'en faire une version √† petit budget d'Arduino avec un nombre minimal (mais raisonnable) d'√©l√©ments. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/625/ebb/095/625ebb0959641911621741e00fb1b699.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/be0/e1c/ac4/be0e1cac460246c56f97f0c45e1c8bc7.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/53d/bc5/9f1/53dbc59f1bb9ec5583f84de546b2df76.jpg" alt="image"><br><br>  L'exp√©rience s'est av√©r√©e r√©ussie et le contr√¥leur configur√© pour l'environnement Arduino a fait clignoter la LED avec succ√®s apr√®s avoir aval√© le Blink classique.  Eh bien, sur le principe de ¬´terminer la chouette¬ª, j'ai ajout√© un encodeur (avec un bouton), trois LED et un √©metteur normal avec modulation d'amplitude sur une porteuse de 433,92 MHz √† la carte r√©sultante. <br><br>  Pour placer tous les √©l√©ments dans un petit bo√Ætier, j'ai d√ª souffrir un peu, mais la t√©l√©commande fonctionnait toujours.  Et bien que, semble-t-il, le probl√®me soit r√©solu, j'en voulais plus - le cas d'origine. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/b0b/716/2cc/b0b7162cc2941009ef081f0f76e4a2a8.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/36b/08b/c76/36b08bc76093a6b66fe3f5e1b3597b1a.jpg" alt="image"><br><br><h2>  Deuxi√®me approche </h2><br>  En fait, la premi√®re version (se plaignant) en apparence d'un groupe de camarades a √©t√© bris√©e, donc je l'ai report√©e ind√©finiment.  Mais il ne l'a pas d√©mont√©: c'est dommage. <br><br>  Mais lorsque l'imprimante 3D est apparue, il s'est promis un jour de fabriquer le m√™me bo√Ætier d'origine et donc de clore la question avec la t√©l√©commande. <br><br>  Je ne sais pas si cela s‚Äôest av√©r√© bon ou mauvais - je ne sais pas vraiment comment √©valuer mes affaires.  Mais sur 3DToday, l'√©quipe est plus accueillante que sur MySKU (dont je ne me plains pas - ce n'est pas un cadeau moi-m√™me), et ils ont √©valu√© le cas plus haut que moi. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/5a1/89d/905/5a189d905d402c93afba5e4f4d88c1da.jpg" alt="image"><br><br>  Mais ayant une totale libert√© d'action, j'ai abandonn√© les batteries chinoises fragiles et agit√©es, et j'ai pris le bon vieux 18650 comme source d'√©nergie. Et, comme vous pouvez facilement le voir, ce sont pr√©cis√©ment ses dimensions qui d√©terminent largement les dimensions de l'ensemble du bo√Ætier. <br><br>  J'ai commenc√© √† rendre le bo√Ætier lui-m√™me modulaire, compos√© de nombreuses pi√®ces, ce qui m'a permis de r√©imprimer uniquement des √©l√©ments individuels (erron√©s ou peu optimaux), et non le produit entier. <br><br>  Un autre point est que je n'aime vraiment pas faire de d√©coupes pour les connecteurs, ce que je ne peux vraiment pas faire.  Par cons√©quent, dans la cha√Æne d'approvisionnement, il y a une autre astuce connue par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Evelyn le h√©risson</a> : la recharge sans fil. <br><br><img src="https://habrastorage.org/webt/ie/zq/6m/iezq6m_73cckmk6y-bidsohs9ye.jpeg"><br><br>  Dans ma zashashnik, il n'y avait qu'un autre r√©cepteur, que j'ai imm√©diatement mis en action. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/fDLqxxDvQhM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Enfin, la derni√®re astuce est assez √©vidente, mais quand m√™me: pour que la t√©l√©commande ne rampe pas autour de la table, j'ai coll√© un morceau de tapis de voiture antid√©rapant au fond.  Et √† la fin, cette chose est un monolithe absolu, bien que le r√©organiser √† un autre endroit ne soit pas non plus un probl√®me. <br><br><h2>  Ce qu'il faut pour r√©p√©ter </h2><br><h3>  Morceau de fer </h3><br>  1) Contr√¥leur ATmega328P - 1 pc.  (dans mon package TQFP, mais tout le monde peut) <br>  2) R√©sistance 10 kOhm - 5 pcs.  (4 pour supprimer le rebond de l'encodeur, 1 pour le contr√¥leur) <br>  3) R√©sistance 100 Ohms - 3 pcs. <br>  4) Condensateurs c√©ramiques 0,1 microfarads - 4 pcs.  (au contr√¥leur et suppression du rebond de l'encodeur) <br>  5) Encodeur push (valcoder) - 1 pc.  (J'ai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PEC12-4220F-S0024</a> ) <br>  6) LED - 3 pi√®ces.  (diam√®tre 3 mm) <br>  7) Carte de charge de batterie au lithium - 1 pc.  (√† partir de la banque d'alimentation qui est venue √† la main, en th√©orie, n'importe qui avec un allumage automatique sous charge fera l'affaire) <br>  8) R√©cepteur de charge sans fil Qi - 1 pc. <br>  9) Un √©metteur avec modulation d'amplitude √† 433 MHz - 1 pc.  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">comme √ßa</a> ) <br>  10) De la fibre de verre pour la carte d'encodeur <br>  11) Imprimante 3D <br>  12) Plastique appropri√© (j'ai imprim√© du PLA) <br>  13) Vis M4x30 - 4 pi√®ces. <br><br>  En g√©n√©ral, le nombre de composants peut √™tre r√©duit.  Par exemple, dans une version tr√®s minimale, le contr√¥leur ne n√©cessite pas du tout de cerclage, bien que j'ai d√©cid√© de suivre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">les conseils de Nick Gammon</a> et de ne pas m√©nager quelques condensateurs et une r√©sistance. <br><br>  De la m√™me mani√®re, vous ne pouvez pas vous soucier de la suppression mat√©rielle du rebond de contact et essayez de vous en tirer avec le logiciel.  Ensuite, vous pouvez barrer quatre autres r√©sistances et une paire de condensateurs. <br><br>  Alternativement, vous pouvez utiliser une carte Arduino pr√™te √† l'emploi, comme la Pro Mini, mais dans ce cas, je ne peux pas garantir un faible niveau de consommation d'√©nergie, et vous devrez le faire vous-m√™me.  Dans le m√™me temps, le cas devra √™tre corrig√©. <br><br>  Sch√©ma: <br><br><img src="https://habrastorage.org/webt/wo/xv/hh/woxvhhfaucpc3emhiyipfk56m1s.png"><br><br>  Pour r√©f√©rence, le brochage ATmega328p dans le bo√Ætier TQFP-32 de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Hobby Electronics</a> : <br><br><img src="https://habrastorage.org/webt/1y/ea/sp/1yeasp0veriyrgvhrafu_inlwlm.jpeg"><br><br>  Pour mon encodeur, j'ai dessin√© une petite planche: <br><br><img src="https://habrastorage.org/webt/i2/jg/d7/i2jgd7p7jlv1kyhbyjhoayd3d4k.jpeg"><br><br><img src="https://habrastorage.org/webt/ke/cr/yt/kecrytksno5yhwsjjdpcbwgc9-c.jpeg"><br><br><img src="https://habrastorage.org/webt/6y/vb/8j/6yvb8jl1h6zvpm-z-atgntumnsw.jpeg"><br><br>  S'il est bon, il devra √™tre perc√© pour monter l'encodeur, ou enfonc√© avec son ¬´ventre sur la carte (en prenant soin de l'isolement pour qu'il n'y ait pas de court-circuit) afin que l'encodeur soit mont√© a) plus ou moins uniform√©ment et b) ne vacille pas.  Historiquement, j'ai une deuxi√®me option. <br><br>  Pour le cas, il est important que la hauteur de la carte avec des pi√®ces, √† l'exclusion de l'encodeur, ne soit pas plus (ou pas beaucoup plus) de 5 mm. <br><br><div class="spoiler">  <b class="spoiler_title">Si la carte Arduino n'est pas pr√™te √† port√©e de main, alors pour que tout fonctionne, vous devez d'abord √©crire le chargeur de d√©marrage Arduino sur le contr√¥leur ATmega328P.</b> <div class="spoiler_text">  Pour ce faire, ajoutez d'abord une description de contr√¥leur √† l'environnement Arduino.  Pour ce faire, rendez-vous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur le site officiel d'Arduino</a> et t√©l√©chargez l'archive de description adapt√©e √† votre version de l'environnement ( <a href="">pour 1.6</a> , <a href="">pour 1.5</a> , <a href="">pour 1.0</a> ). <br><br>  Le contenu de l'archive doit √™tre extrait dans le dossier mat√©riel du dossier d'environnement Arduino.  √Ä l'avenir, je d√©cris ce qui se passe sur l'exemple de l'environnement 1.0.3, que j'utilise toujours. <br><br>  Lorsque les descriptions sont copi√©es, vous devez d√©marrer Arduino et charger l'esquisse du programmeur dans Arduino, qui sera utilis√© comme ce programmeur lui-m√™me.  L'esquisse se trouve dans le menu Fichier - Exemples - ArduinoISP. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/037/517/98f/03751798f648adb8fea47a284a912667.jpg" alt="image"><br><br>  Bien s√ªr, vous devez choisir votre carte et votre port.  Je choisis Mega, car je l'ai: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/7e7/483/4bd/7e74834bdd786979f926f4b65e2e344f.jpg" alt="image"><br><br>  Apr√®s avoir charg√© l'esquisse du programmeur, vous devez passer √† la carte cible.  C'est-√†-dire  dans notre cas - ATmega328 avec une fr√©quence de 8 MHz et un oscillateur ma√Ætre interne.  Il figurera dans la liste des tableaux si les descriptions mentionn√©es ci-dessus sont copi√©es correctement: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/b89/e98/7b2/b89e987b2243a79cc1d36e95d5a7ebab.jpg" alt="image"><br><br>  Vous devez maintenant connecter les lignes MISO, MOSI et SCK de la carte de programmation et de la carte avec le futur Arduino, et √©galement connecter RESET, GND et VCC.  Plus la puissance est meilleure en dernier lieu. <br><br>  Sur la base de l'infographie et de la description d'Arduino Mega ci-dessus, l'image suivante √©merge: <br><br>  SPI - Arduino Mega - ATmega328p <br><br>  MISO - 50 - 16 <br>  MOSI - 51 - 15 <br>  SCK - 52 - 17 <br>  SS (RESET) - 53 - 29 <br><br>  Connexion physique √† votre go√ªt, j'ai utilis√© une m√©thode exclusivement barbare - des fils de planche √† pain ordinaires directement dans les trous de la carte, sans soudure ni isolation: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/c14/df6/d5f/c14df6d5f4cdda937de81eb2fa555ee0.jpg" alt="image"><br><br>  Si tout est pr√™t, notez le chargeur de d√©marrage.  Tout d'abord, assurez-vous que le bon programmeur est s√©lectionn√© (Service - Programmeur - Arduino en tant que FAI): <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/e0c/dc4/a0c/e0cdc4a0c8914fbed3f5328c676f0210.jpg" alt="image"><br><br>  Ensuite, nous faisons le service - Enregistrer le chargeur de d√©marrage: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/568/21e/12f/56821e12f02cd705995d40429b15eec6.jpg" alt="image"><br></div></div><br>  Apr√®s cela, la sortie est une carte Arduino minimaliste, pour charger des croquis dans lesquels vous pouvez utiliser l'adaptateur USB-s√©rie ou une carte Arduino compl√®te avec un tel adaptateur √† bord.  Dans le premier cas, vous devez connecter RX et TX en croix, et n'oubliez pas de connecter une masse commune.  Dans le deuxi√®me cas, il est en outre n√©cessaire de court-circuiter la r√©initialisation de l'Arduino, qui est utilis√© comme adaptateur, √† la masse. <br><br>  Si vous, comme moi, n'avez pas de circuit pour r√©initialiser automatiquement le contr√¥leur avant de t√©l√©charger l'esquisse, il y a deux options: soit tirer sa r√©initialisation, soit simplement allumer son alimentation lorsque l'environnement Arduino indique que le t√©l√©chargement a commenc√©. <br><br><h3>  Logement </h3><br>  Le bo√Ætier, comme je l'ai dit, est modulaire.  Cela signifie que sur la partie int√©rieure cach√©e des yeux, vous pouvez laisser entrer le plastique qui est p√©rim√© et ne convient plus.  Vous pouvez y mettre de l'√©lectronique: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/030/0a3/251/0300a325144382295c6e3b8d54971e23.jpg" alt="image"><br><br>  J'attire l'attention sur le fait que l'√©tui est sp√©cifique et est con√ßu pour s'adapter √† ma version du remplissage. <br><br>  Je propose de rendre le rotor transparent pour qu'il disperse la lumi√®re des indicateurs.  Pour plus de poids, un √©crou M16 peut √™tre ins√©r√© √† l'int√©rieur du rotor: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/9a0/8ef/68e/9a08ef68e2a079da4af3ed1eb148e961.jpg" alt="image"><br><br>  Encore besoin d'une chemise de rotor et d'une couverture.  Le couvercle est simplement ins√©r√© vers l'int√©rieur et repose sur la friction.  Et, bien s√ªr, vous ne pouvez pas vous passer des parties sup√©rieure et inf√©rieure du bo√Ætier ext√©rieur. <br><br>  J'ai imprim√© un rotor avec un remplissage de 10%, le reste des √©l√©ments avec un remplissage de 5%.  Plastique - PLA.  La temp√©rature r√©gl√©e de la buse sur mon imprimante est de 200 ¬∞ C sur les trois premi√®res couches, 185 ¬∞ C sur la suivante.  Malheureusement, je ne peux pas dire quelle est la vraie temp√©rature de la buse.  La table est froide. <br><br>  L'assemblage est simple. <br><br><img src="https://habrastorage.org/webt/ka/cq/2-/kacq2-crn1cictkqxhpb0sok15u.jpeg"><br><br>  Les planches sont plac√©es dans les rainures du bo√Ætier durable, les LED - pieds dans les rainures de la partie inf√©rieure du bo√Ætier durable.  L'antenne de l'√©metteur est abaiss√©e, le r√©cepteur de charge sans fil est abaiss√© de la m√™me mani√®re - de sorte qu'il est plus proche de cette m√™me charge. <br><br><img src="https://habrastorage.org/webt/d9/zu/ex/d9zuextrjywuvjbj4ve68-c2rgg.png"><br><br>  Le remplissage est fix√© par une plaque interm√©diaire, dans la gorge de laquelle passe le faisceau de c√¢bles du codeur. <br><br>  L'encodeur est fix√© avec la plaque sup√©rieure, le tout est serr√© avec des vis M4x30, qui coupent elles-m√™mes les filetages en plastique. <br><br>  Maintenant, le bo√Ætier durable peut √™tre enferm√© dans les moiti√©s du bo√Ætier externe.  Un rotor est plac√© sur l'arbre du codeur et une chemise est plac√©e sur le rotor.  En option, un tapis antid√©rapant est coll√© au bas du corps.  Une autre option est un insert d√©coratif qui cache la couture entre les moiti√©s du corps. <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text">  Dans le code, vous devez sp√©cifier des commandes pour allumer et √©teindre vos p√©riph√©riques.  Facultatif - modifiez le d√©lai d'arr√™t automatique. <br><br>  Tout cela se trouve dans la section variable. <br><br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//  : http://donalmorrissey.blogspot.ru/2010/04/sleeping-arduino-part-5-wake-up-via.html //  Livolo: http://forum.arduino.cc/index.php?action=dlattach;topic=153525.0;attach=108106 #include &lt;avr/sleep.h&gt; #include &lt;avr/power.h&gt; #include &lt;livolo.h&gt; #define adc_disable() (ADCSRA &amp;= ~(1&lt;&lt;ADEN)) // disable ADC (before power-off) #define adc_enable() (ADCSRA |= (1&lt;&lt;ADEN)) // re-enable ADC #define txPin 7 //   Livolo livolo(txPin); #define PULSESHORT 450 #define PULSELONG 1350 #define PULSESYNC 13950 #define encA 5 #define encB 6 //   #define buttonPin 2 //   () #define roomLed 10 //    #define kitchenLed 9 //    #define switchLed 3 //     #define switchLedTimeOut 150 //      #define switchTreshold 4 //      #define offDelay 15000 //   #define rLev 3 //     #define kLev 3 //     #define glev 2 //     #define txPowerPin 8 //    #define kitchenBackLightOn1 12 #define kitchenBackLightOn2 34 #define kitchenMainLightOn 56 #define roomBackLightOn 12 #define roomMainLightOn1 34 #define roomMainLightOn2 56 #define mainLightOn 12 #define kitchenBackLightOff1 12 #define kitchenBackLightOff2 34 #define kitchenMainLightOff 56 #define roomBackLightOff 12 #define roomMainLighOtff1 34 #define roomMainLightOff2 56 #define mainLightOff 12 #define LivoloID 8500 volatile byte rotorMode = 0; //   byte currentMode = 0; //    int curEncA, prevEncA, curButton, prevButton; //   ,  byte encCountPlus = 0; //   byte encCountMinus = 0; //   unsigned long offTimeOut = 0; //    unsigned long modeTimeOut = 0; //        unsigned long switchLedTime = 0; //      unsigned long modeTime = 0; //   unsigned int modeTreshold = 500; //     (  ) unsigned int bounceTreshold = 200; //     byte rLevState = 0; byte kLevState = 0; byte gLevState = 0; //   k - , r - , h - , b -  boolean kBackState = false; boolean kBackState1 = false; boolean kMainState = false; boolean rBackState = false; boolean rMainState = false; boolean rMainState1 = false; boolean hMainState = false; boolean bMainState = false; boolean afterSleep = false; //      boolean modeTimeOutStart = false; boolean switchLedOn = false; boolean allOn = false; //  " "    boolean allOff = false; //  " "    static void ookPulse(int on, int off) { digitalWrite(txPin, HIGH); delayMicroseconds(on); digitalWrite(txPin, LOW); delayMicroseconds(off); } static void rcSend(long remoteCode) { for (byte reSend = 0; reSend &lt; 8; reSend++) { for(byte repeat=0; repeat&lt;4; repeat++){ for (byte i = 24; i&gt;0; i--) { // transmit remoteID byte txPulse=bitRead(remoteCode, i-1); // read bits from remote ID // Serial.print(txPulse); switch (txPulse) { case 0: // 00 ookPulse(PULSESHORT,PULSELONG); //ookPulse(PULSESHORT,PULSELONG); break; case 1: // 11 ookPulse(PULSELONG,PULSESHORT); //ookPulse(PULSELONG,PULSESHORT); break; } // switch } // for loop ookPulse(PULSESHORT,PULSESYNC); // S(ync) // Serial.println(); } // repeat } delay(150); } void switchLedToggle() { digitalWrite(switchLed, HIGH); switchLedTime = millis(); switchLedOn = true; } void lightsUp(boolean lightsUpMode) { //       ""     //   "" -   if (afterSleep == true) { if (lightsUpMode == false) { gLevState = 1; rLevState = 3; kLevState = 3; } else {gLevState = 0; rLevState = 0; kLevState = 0; } afterSleep = false; //   " " } //   if (rotorMode == 2) { if (lightsUpMode == false){ if (allOff == false) { switchLedToggle(); if (digitalRead(buttonPin) == HIGH) { //   gLevState = 0; rLevState = 0; kLevState = 0; rcSend(kitchenBackLightOff1); rcSend(kitchenBackLightOff2); rcSend(roomBackLightOff); livolo.sendButton(LivoloID, mainLightOff); } allOff = true; allOn = false; } } if (lightsUpMode == true){ //  ,    if (allOn == false) { switchLedToggle(); if (digitalRead(buttonPin) == HIGH) { gLevState = 1; rLevState = 3; kLevState = 3; rcSend(kitchenBackLightOn1); rcSend(kitchenBackLightOn2); rcSend(roomBackLightOn); livolo.sendButton(LivoloID, mainLightOff); //    Livolo livolo.sendButton(LivoloID, kitchenMainLightOn); //#1   livolo.sendButton(LivoloID, roomMainLightOn1); // #2 livolo.sendButton(LivoloID, roomMainLightOn2); // #3 livolo.sendButton(LivoloID, mainLightOn); // #6 } allOn = true; allOff = false; } } } //  if (rotorMode == 1) { if (lightsUpMode == false &amp;&amp; kLevState &gt; 0) { switchLedToggle(); if (digitalRead(buttonPin) == HIGH) { if (kLevState == 3) { //   livolo.sendButton(LivoloID, kitchenMainLightOff); // #3 } if (kLevState == 2) { //   2 livolo.sendButton(LivoloID, kitchenBackLightOff2); // #6 } if (kLevState == 1) { //   1 rcSend(kitchenBackLightOff1); } } if (kLevState!=0) { kLevState--;} // Serial.println(kLevState); } if (lightsUpMode == true &amp;&amp; kLevState &lt; 3) { switchLedToggle(); kLevState++; if (digitalRead(buttonPin) == HIGH) { if (kLevState &gt; 3) {kLevState = 3;} // Serial.println(kLevState); if (kLevState == 1) { //   1 rcSend(kitchenBackLightOn1); } if (kLevState == 2) { //   2 livolo.sendButton(LivoloID, kitchenBackLightOn2); // #6 } if (kLevState == 3) { //   livolo.sendButton(LivoloID, kitchenMainLightOn); // #3 } } } } //  if (rotorMode == 0) { if (lightsUpMode == false &amp;&amp; rLevState &gt; 0) { switchLedToggle(); if (digitalRead(buttonPin) == HIGH) { if (rLevState == 3) { //  1 livolo.sendButton(LivoloID, roomMainLighOtff1); //#1 } if (rLevState == 2) { //   livolo.sendButton(LivoloID, roomMainLightOff2); // #2 } if (rLevState == 1) { //   rcSend(roomBackLightOff); } } if (rLevState != 0) { rLevState--; } } if (lightsUpMode == true &amp;&amp; rLevState &lt; 3) { switchLedToggle(); rLevState++; if (digitalRead(buttonPin) == HIGH) { if (rLevState == 1) { //   rcSend(roomBackLightOn); } if (rLevState == 2) { //   livolo.sendButton(LivoloID, roomMainLightOn1); //#1 } if (rLevState == 3) { //   1 livolo.sendButton(LivoloID, roomMainLightOn2); // #2 } } } } } void wakeUp() { detachInterrupt(0); } void setMode() { if (rotorMode &gt;= 2 ) { rotorMode = 0; } else { rotorMode++; } offTimeOut = millis(); } void ledBlink() { for (byte iLed = 0; iLed&lt;3; iLed++) { digitalWrite(kitchenLed, HIGH); digitalWrite(roomLed, HIGH); delay(100); digitalWrite(kitchenLed, LOW); digitalWrite(roomLed, LOW); delay(100); } } void setLed() { if (rotorMode == 0) { //  digitalWrite(roomLed, HIGH); digitalWrite(kitchenLed, LOW); } if (rotorMode == 1) { //  digitalWrite(roomLed, LOW); digitalWrite(kitchenLed, HIGH); } if (rotorMode == 2) { //    digitalWrite(roomLed, HIGH); digitalWrite(kitchenLed, HIGH); } } void enterSleep() { // ledBlink(); afterSleep = true; digitalWrite(txPin, LOW); digitalWrite(txPowerPin, LOW); digitalWrite(roomLed, LOW); digitalWrite(kitchenLed, LOW); digitalWrite(switchLed, LOW); pinMode(txPin, INPUT); pinMode(txPowerPin, INPUT); pinMode(roomLed, INPUT); pinMode(kitchenLed, INPUT); pinMode(switchLed, INPUT); attachInterrupt(0, wakeUp, LOW); adc_disable(); set_sleep_mode(SLEEP_MODE_PWR_DOWN); sleep_enable(); sleep_mode(); sleep_disable(); power_all_enable(); pinMode(txPin, OUTPUT); pinMode(txPowerPin, OUTPUT); pinMode(roomLed, OUTPUT); pinMode(kitchenLed, OUTPUT); pinMode(switchLed, OUTPUT); digitalWrite(txPin, LOW); digitalWrite(txPowerPin, HIGH); // ledBlink(); setLed(); offTimeOut = millis(); allOn = false; allOff = false; } void setup() { // Serial.begin(115200); pinMode(txPin, OUTPUT); pinMode(txPowerPin, OUTPUT); pinMode(roomLed, OUTPUT); pinMode(kitchenLed, OUTPUT); pinMode(switchLed, OUTPUT); digitalWrite(txPin, LOW); digitalWrite(txPowerPin, HIGH); digitalWrite(roomLed, LOW); digitalWrite(kitchenLed, LOW); digitalWrite(switchLed, LOW); // pinMode(buttonPin, INPUT_PULLUP); pinMode(buttonPin, INPUT); pinMode(encA, INPUT); pinMode(encB, INPUT); prevEncA = digitalRead(encA); offTimeOut = millis(); rotorMode = 0; setLed(); prevButton = digitalRead(buttonPin); } void loop() { if ((millis() - offTimeOut) &gt; offDelay) { enterSleep(); } else { //     if (switchLedOn == true) { if ((millis() - switchLedTime) &gt; switchLedTimeOut) { digitalWrite(switchLed, LOW); switchLedOn = false; } } //       if (digitalRead(buttonPin) == LOW) { offTimeOut = millis(); } //   curButton = digitalRead(buttonPin); if ((prevButton == HIGH) &amp;&amp; (curButton == LOW)) { if (modeTimeOutStart == false) { modeTimeOut = millis(); modeTimeOutStart = true; } } else { if (modeTimeOutStart == true) { modeTime = millis() - modeTimeOut; if ((modeTime &lt; modeTreshold) &amp;&amp; (modeTime &gt; bounceTreshold)) { setMode(); modeTimeOutStart = false; prevButton = digitalRead(buttonPin); } else { modeTimeOutStart = false; prevButton = digitalRead(buttonPin); } } } //    if (currentMode != rotorMode) { //       ,     currentMode = rotorMode; //     setLed(); } //   curEncA = digitalRead(encA); if ((prevEncA == LOW) &amp;&amp; (curEncA == HIGH)) { offTimeOut = millis(); if (digitalRead(encB) == LOW) { encCountMinus++; encCountPlus = 0; // Serial.println("Encoder Minus"); if (encCountMinus &gt; switchTreshold) { encCountMinus = 0; lightsUp(false); } } else { encCountPlus++; encCountMinus = 0; // Serial.println("Encoder Plus"); if (encCountPlus &gt; switchTreshold) { encCountPlus = 0; lightsUp(true); } } } prevEncA = curEncA; } }</span></span></code> </pre> <br></div></div><br>  Mod√®le de cas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">par r√©f√©rence</a> . <br><br>  C‚Äôest tout. <br><br>  PS: J'ai essay√© de ne rien oublier, mais j'ai pu.  Si oui, je m'excuse et ferai de mon mieux pour r√©pondre correctement aux questions principales et corriger les erreurs. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr411093/">https://habr.com/ru/post/fr411093/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr411083/index.html">Coucher de soleil "Etoiles de l'humanit√©"</a></li>
<li><a href="../fr411085/index.html">Pi-Sonos v3.0: travailler sur des bugs ou un tout nouveau projet?</a></li>
<li><a href="../fr411087/index.html">L'avenir proche des cartes vid√©o</a></li>
<li><a href="../fr411089/index.html">Comment identifier un satellite en orbite</a></li>
<li><a href="../fr411091/index.html">Technologies des centres de donn√©es: informations g√©n√©rales sur les commutateurs QFX</a></li>
<li><a href="../fr411097/index.html">Messagerie mobile autonome</a></li>
<li><a href="../fr411099/index.html">Il est facile d'√©valuer PPFD lors de l'√©clairage d'une usine avec des LED blanches: 1000 lux = 15 Œºmol / s / m2</a></li>
<li><a href="../fr411101/index.html">Les autorit√©s de New York ont ‚Äã‚Äãautoris√© l'augmentation du co√ªt de l'√©lectricit√© pour les mineurs</a></li>
<li><a href="../fr411105/index.html">Les performances du drone Courier d√©pendent de l'endroit o√π vous vivez</a></li>
<li><a href="../fr411109/index.html">Porsche et Bugatti utilisent l'impression 3D pour cr√©er des d√©tails rares et complexes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>