<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîÄ üîÇ üòâ Aprendendo STM8S Slow Start. Parte 0 ‚õ∑Ô∏è ‚úåüèø ü¶â</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A fam√≠lia MK STM8S em rela√ß√£o ao STM8L / 32 possui um arsenal menor de perif√©ricos, mas permite que voc√™ compreenda facilmente o b√°sico e obtenha as h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprendendo STM8S Slow Start. Parte 0</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465597/"> <abbr title="Microcontrolador">A</abbr> fam√≠lia <abbr title="Microcontrolador">MK</abbr> STM8S em rela√ß√£o ao STM8L / 32 possui um arsenal menor de perif√©ricos, mas permite que voc√™ compreenda facilmente o b√°sico e obtenha as habilidades necess√°rias para trabalhar com seus irm√£os mais velhos. <br><br><h2>  0. Para quem o material √© orientado, por que e por que </h2><br>  Ao escrever este artigo, presumo que o leitor possa: <br><br><ul><li>  Leia com aten√ß√£o (o que √© raro) </li><li>  Um pouco de trabalho com a literatura t√©cnica no idioma ingl√™s (bem, ou a motiva√ß√£o para aprender, porque o primeiro idioma do programador √© o ingl√™s) </li><li>  Solda (pelo menos habilidades m√≠nimas) </li><li>  Programa√ß√£o em C (novamente, nem tudo √© t√£o complicado) </li><li>  Google (sem ele em qualquer lugar) </li><li>  Use um mult√≠metro e tenha outras habilidades b√°sicas (como ‚Äún√£o coloque os dedos no soquete‚Äù) </li></ul><br>  Considero os objetivos do artigo: <br><br><ul><li>  Vis√£o geral para executar todas as etapas do desenvolvimento de um sistema baseado em um microcontrolador </li><li>  Fa√ßa as notas introdut√≥rias necess√°rias para uma pessoa que praticamente n√£o √© dedicada </li><li>  Se poss√≠vel, o leitor entender√° onde, o que e como encontrar </li></ul><br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">(N√£o significativo)</b> <div class="spoiler_text">  Porque e porque? <br><br>  Eu acho que faz sentido fazer um curso detalhado de programa√ß√£o MK. <br><br>  Serei uma ocasi√£o para estudar toda a periferia com mais detalhes e, ao longo do caminho, ajudarei os outros. <br>  Sei que j√° existe um grande n√∫mero de artigos e at√© cursos de treinamento, mas tenho uma abordagem um pouco diferente.  (Talvez eu receba cr√≠ticas adequadas, mude de id√©ia e me junte aos caras do MX Cube). <br><br>  √â triste ver como os controladores stm se transformam em arduino. <br><br>  Em rela√ß√£o ao arduino: <br><br>  Existem 3 abordagens (conhecidas por mim, MB, apenas n√£o cresci) para <abbr title="De software">o</abbr> desenvolvimento de <abbr title="De software">software</abbr> no MK: <br><br><ol><li>  Desenvolvimento Assembler </li><li>  Desenvolvimento para um modelo MK espec√≠fico </li><li>  Desenvolvimento usando HAL e bibliotecas similares </li></ol><br>  1) Sou partid√°rio da opini√£o de que, se voc√™ estiver construindo uma casa, n√£o deve queimar todos os tijolos de barro com suas pr√≥prias m√£os, porque o montador desaparece (embora tenha come√ßado com isso).  Velocidade de desenvolvimento muito baixa. <br><br>  2) bibliotecas HAL, etc.  para um iniciante, muitos momentos ‚Äúapenas escreva assim‚Äù s√£o opacos.  Porque - tamb√©m no lixo. <br><br>  3) Considero o processo de cria√ß√£o de software para um MK espec√≠fico a op√ß√£o mais saud√°vel para um iniciante; as habilidades adquiridas tornar√£o poss√≠vel lidar com as s√©ries 8L e 32 (embora d√≥i faz√™-lo sozinho, de acordo com a documenta√ß√£o). <br><br>  Voc√™ provavelmente notou que o arduino n√£o aparece nesta lista, porque √© uma plataforma <u>educacional</u> e n√£o se destina ao desenvolvimento de dispositivos compactos com base.  Mas a abordagem de programa√ß√£o por algum motivo (n√£o sei) √© transferida e se espalha pela Internet.  E at√© usado em projetos comerciais reais.  (representa: "Fiz o download da biblioteca no f√≥rum, conectei, funcionou, n√£o sei como funciona"). <br><br>  Sugiro, do meu ponto de vista, uma abordagem academicamente e metodicamente mais significativa. <br></div></div><br><h2>  1. A escolha do microcontrolador </h2><br>  Eu tenho v√°rios STM8S105K6 no pacote LQFP32, √© dessa fam√≠lia, ent√£o eu o escolho. <br><br>  Voc√™ pode escolher qualquer MK dentro da s√©rie. <br><br>  Existem placas Discovery prontas da ST, voc√™ pode comprar dos chineses ou encomendar de outros recursos.  Existem placas prontas para o STM8S103F3P6 e similares dos chineses. <br><br>  Por√©m, deve-se notar que as placas prontas s√£o projetadas para treinamento. <br><br>  No site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">st.com</a> do fabricante, encontramos nosso MK e fazemos o download de documentos para ele: <br><br>  Manual de refer√™ncia: RM0016 - um documento comum para todas as fam√≠lias MK STM8S e STM8AF.  Em seguida √© RM. <br>  Folha de dados: Eu tenho um documento DS5855 para os STM8S105C4 / 6, STM8S105K4 / 6 e STM8S105S4 / 6.  O pr√≥ximo √© o DS. <br><br>  Das coisas deliciosas que ele tem (superficialmente): <br><br><ul><li>  Suporte de 16 MHz </li><li>  Flash de 32 KB, EEPROM de 1 KB e RAM de 2 KB </li><li>  Pot√™ncia 2.95-5.5V </li><li>  Temporizadores de 8 e 16 bits </li><li>  UART, SPI, I2C </li><li>  <abbr title="Conversor anal√≥gico para digital">ADC de</abbr> 10 bits </li><li>  at√© 38 entradas / sa√≠das discretas </li></ul><br><h2>  2. Equipamento necess√°rio </h2><br>  Vejo duas op√ß√µes para trabalhar com o MK: <br><br><ol><li><div class="spoiler">  <b class="spoiler_title">Montando um layout a partir de componentes individuais</b> <div class="spoiler_text">  √ìtimo, legal, eu gosto.  Tantas pessoas fazem. <br><br>  Nesse caso, o MK precisar√° da chamada cintagem.  O plano √© simples: <br><br><ol><li>  Pegamos uma placa de ensaio, no meu caso TQFP (32-64PIN) 0.8MM, solda MK nele </li><li>  Levamos um pente de duas carreiras PLS-2x40 para os orif√≠cios que levam √†s conclus√µes de MK </li><li>  Pegamos uma t√°bua de p√£o impressa (tenho 9x15 cm) e soldamos o √∫ltimo sandu√≠che nela </li><li>  Olhamos para o ponto 7. da RM. Fonte de alimenta√ß√£o, <u>lemos</u> .  Est√° escrito que voc√™ precisa de um capacitor conectando o pino VCAP e nossa fonte de alimenta√ß√£o de 0V.  Tamb√©m est√° escrito que voc√™ precisa procurar mais detalhadamente no DS um MK espec√≠fico na se√ß√£o de caracter√≠sticas el√©tricas.  Para mim, esta √© a cl√°usula 10.3.1 do capasitor externo VCAP com refer√™ncia √† Tabela 18, onde o valor nominal √© 470 - 3300 nF.  Tomei 1 mF (no circuito C3).  (por que voc√™ precisa, espero que voc√™ leia voc√™ mesmo no RM) </li><li>  Ibid. No DS, na cl√°usula 10.3.8.  Redefinir as caracter√≠sticas dos pinos, encontramos a capacidade do capacitor de 0,1 mF (no circuito C4).  O resistor R4 com um valor nominal de 10 kOhm √© usado em placas de depura√ß√£o e v√°rias notas de aplica√ß√£o, embora dentro do MK j√° exista um resistor de pull-up com um valor nominal de 30 a 80 kOhm (se voc√™ acredita no mesmo DS).  Paralelamente ao capacitor C4, colocamos nosso bot√£o de reset.  Esse padr√£o de redefini√ß√£o pode ser visto, por exemplo, na nota Desighn DN0005. </li><li>  Al√©m disso, o ST gosta de adicionar capacitores de energia de 100nF √†s placas de depura√ß√£o, no n√∫mero de N pinos conectados √† energia +1.  O diagrama mostra apenas pe√ßas C1, C2 e C5 3, e n√£o as soldei no quadro, mas voc√™ entendeu o significado.  Ele funcionar√° na mesa sem eles, mas no desenvolvimento comercial real, √© melhor cuidar desse assunto ao criar a placa do dispositivo. </li><li>  Solucione o conector de programa√ß√£o SWIM (eu fa√ßo do PLS-1x40) </li></ol><br>  Eu recebi um milagre: <br><br><img src="https://habrastorage.org/webt/oh/ll/d5/ohlld5z9iiuxmlnc6djwgbqe_-w.png"><br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">Compra de uma placa acabada (que n√£o impede que voc√™ trabalhe com um ferro de soldar)</b> <div class="spoiler_text">  √ìtimo, legal, eu gosto.  Tantas pessoas fazem. <br><br>  Vale a pena familiarizar-se com a configura√ß√£o da placa, se for uma placa da ST, ser√° imediatamente enviada ao programador e conectada a um cabo USB tipo B.  O site do ST ter√° um diagrama na p√°gina do produto.  No quadro, haver√° bot√µes, LEDs, tweeters, bot√µes capacitivos e outros encantos com os quais voc√™ pode jogar. <br><br>  Se o quadro for chin√™s, muitas vezes, sem um programador, voc√™ precisar√° de um programador. <br><br>  Serigrafia dos nomes das conclus√µes √© melhor n√£o acreditar e checar duas vezes em compara√ß√£o com o DS. <br></div></div></li></ol><br>  N√£o considero trabalhar com t√°buas de p√£o de contato porque n√£o a uso. <br><br>  Al√©m disso, preciso de um programador, tenho um ST-Link V2 chin√™s.  Capaz de programar e STM8 e STM32. <br><br><h2>  3. Escolhendo um IDE </h2><br>  Para mim, a quest√£o da escolha ainda n√£o √© relevante, trabalho no IAR para o STM8, porque ele fez um projeto no qual estou trabalhando atualmente, pela mesma raz√£o que a vers√£o antiga. <br><br>  Vamos ao site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">iar.com</a> , na busca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">digitamos</a> o modelo do nosso MK. <br>  Fa√ßa o download do IAR Embedded Workbench para STM8, selecione a avalia√ß√£o de tamanho limitado ao instalar e atenda a um limite de 8 KB de c√≥digo.  Ou compre.  Existem vers√µes hackeadas de recursos proibidos no territ√≥rio da Federa√ß√£o Russa, mas n√£o √© adequado para projetos comerciais. <br><br>  As instru√ß√µes de instala√ß√£o est√£o no instalador ou no Google. <br>  Estou usando a vers√£o 6.5.3.2581. <br>  Instale o ambiente, juntamente com o driver do programador. <br><br><h2>  4. Criando um Projeto </h2><br>  V√° para o IDE, v√° para Projeto -&gt; Criar novo projeto -&gt; C ++ <br><br>  Clique em OK, selecione o diret√≥rio (de prefer√™ncia sem cir√≠lico e espa√ßos), selecione o nome (sem espa√ßos e cir√≠lico). <br><br>  Vamos para a pasta raiz do nosso IDE e encontramos a pasta inc, para mim, o caminho: <br><br><pre><code class="plaintext hljs">C:\Program Files (x86)\IAR Systems\Embedded Workbench 6.5\stm8\inc</code> </pre> <br><br>  Entre os arquivos de cabe√ßalho iostm8, encontramos nosso modelo MK, para mim: <br><br><pre> <code class="plaintext hljs">iostm8s105k6.h</code> </pre> <br>  N√≥s o conectamos no in√≠cio e adicionamos um loop infinito. <br><br><div class="spoiler">  <b class="spoiler_title">Resultado:</b> <div class="spoiler_text"><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#include&lt;iostm8s105k6.h&gt; //  int main() { while(1){ //  } return 0; }</span></span></code> </pre><br></div></div><br>  No menu Projeto -&gt; Op√ß√µes -&gt; Op√ß√µes gerais na coluna Dispositivo, selecione seu MK. <br><br>  Em Projeto -&gt; Op√ß√µes -&gt; Depurador na coluna Driver, selecione ST-LINK. <br><br>  Encontre o bot√£o Baixar e depurar na barra de ferramentas. <br>  Na primeira compila√ß√£o, o ambiente solicitar√° que voc√™ selecione o nome do arquivo .eww.  (Eu nomeio o mesmo que o projeto.) <br><br>  Na parte inferior da janela Debug Log, deve haver mensagens que: <br><br><ul><li>  Pr√©-processador para STM8 - pr√©-processador iniciado </li><li>  Depurador para STM8 - depurador iniciado </li><li>  Conectado ao sistema STM8 SWIM Debugging - conectado ao MK </li><li>  Debugado carregado - ocorreu o download do firmware </li><li>  Redefini√ß√£o de destino - ocorreu uma redefini√ß√£o </li></ul><br>  Estamos no modo de depura√ß√£o, mas o programa est√° em pausa. <br>  No mesmo local da barra de ferramentas, encontramos e pressionamos o bot√£o Ir. <br>  Lan√ßamos o MK no modo de depura√ß√£o. <br><br>  Clique em Parar depura√ß√£o, a depura√ß√£o √© interrompida, mas o MK √© alimentado pelo programador e, em seguida, executa o programa, ou seja, gera um loop sem fim e n√£o faz nada. <br><br><h2>  Sum√°rio </h2><br>  O resultado foi uma breve vis√£o geral e uma introdu√ß√£o √† programa√ß√£o da s√©rie STM8S de MKs sem se programar.  Descobriu-se apenas a base para o trabalho, a partir disso geralmente tudo come√ßa - com a montagem do layout. <br><br>  N√£o vejo o ponto em mais detalhes. <br><br>  Em muitos artigos, ap√≥s a introdu√ß√£o, literalmente ap√≥s algumas linhas, os LEDs piscam, o que eu n√£o entendo. <br><br>  At√© que ponto os objetivos podem ser alcan√ßados, se o iniciante conseguiu fazer algo por conta pr√≥pria, usando as informa√ß√µes que propus.  (janela do indicador Log de depura√ß√£o) <br><br>  Obrigado pela aten√ß√£o. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt465597/">https://habr.com/ru/post/pt465597/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt465585/index.html">Como gerenciar o React Data Grid atrav√©s do Redux</a></li>
<li><a href="../pt465587/index.html">An√°lise: qual √© o mercado de balc√£o e quais transa√ß√µes s√£o feitas l√°</a></li>
<li><a href="../pt465589/index.html">Guia de Inicia√ß√£o R√°pida ao Piloto e ao PoC</a></li>
<li><a href="../pt465591/index.html">Confer√™ncia do PHP Central Europe cancelada devido ao fato de n√£o haver mulheres entre os oradores</a></li>
<li><a href="../pt465595/index.html">5G chega at√© n√≥s?</a></li>
<li><a href="../pt465599/index.html">IPFS sem dor (mas isso n√£o √© preciso)</a></li>
<li><a href="../pt465601/index.html">Por que voc√™ precisa do DevOps e que s√£o especialistas em DevOps</a></li>
<li><a href="../pt465603/index.html">Cursos vs est√°gio. Como ensinamos midbells na SimbirSoft</a></li>
<li><a href="../pt465605/index.html">O livro ‚ÄúAprendizado por refor√ßo profundo em Python. Gin√°sio OpenAI e TensorFlow para profissionais ¬ª</a></li>
<li><a href="../pt465607/index.html">Entendendo Lean e Agile no desenvolvimento de software</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>