<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙅 💅🏻 👩🏿‍🌾 Trucs et astuces de Digital Forensics: Comment trouver une connexion VPN active dans le vidage de mémoire 👦🏼 👨🏼‍🌾 💮</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Parfois, vous pouvez rencontrer un cas où un cyber-attaquant utilise un VPN pour établir un canal fiable entre le serveur C2 et l'infrastructure infor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Trucs et astuces de Digital Forensics: Comment trouver une connexion VPN active dans le vidage de mémoire</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442590/"> Parfois, vous pouvez rencontrer un cas où un cyber-attaquant utilise un VPN pour établir un canal fiable entre le serveur C2 et l'infrastructure informatique infectée.  Et, comme le disent les experts de Threat Intelligence, les attaquants utilisent souvent des outils de connexion VPN Windows natifs et des <b>fichiers</b> Windows <b>.pbk</b> (répertoire).  Permet de découvrir comment nous pouvons le détecter à l'aide d'un vidage de mémoire. <br><br>  Qu'est- <b>ce que le</b> fichier <b>.pbk</b> et à quoi il ressemble à l'intérieur?  Il s'agit simplement d'un fichier texte avec de nombreux paramètres différents à utiliser lors de l'établissement de la connexion VPN. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7e9/373/ccc/7e9373ccc8baca179bdc4970ecedac9a.jpg" alt="image"><br><br><a name="habracut"></a><br>  Le fichier du répertoire peut être exécuté avec double-clic ou via le script cmd / bat (ou bien sûr à partir de la console de commande).  Mais il existe deux outils différents pour la première et la deuxième méthode: <b>rasdial</b> et <b>rasphone</b> .  Par conséquent, nous pouvons utiliser deux façons différentes dans un processus de criminalistique numérique.  Au début des deux façons, nous devons utiliser un outil de volatilité pour obtenir et vérifier une liste de processus: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b11/89d/9bb/b1189d9bb7443e3891484afde7935325.jpg" alt="image"><br><br>  Si un processus <b>rasphone</b> est détecté, il est possible qu'une trace d'utilisation du répertoire téléphonique avec double-clic de la session RDP par exemple.  Quelles informations utiles pouvons-nous également trouver ici?  Ouvrons ce fichier de vidage dans FTK Imager et essayons de rechercher tous les paramètres .pbk.  J'ai utilisé un <b>"PhoneNumber ="</b> pour ce cas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dfe/0c9/ecb/dfe0c9ecb547ad2048110a0c7ecd7458.jpg" alt="image"><br><br>  Vous voyez ici une adresse distante pour cette connexion VPN et un numéro de port.  <b>vpn566928222.opengw.net:995</b> À partir de là, nous pouvons détecter le nom du service d'une connexion actuelle dans la RAM, en utilisant un numéro de port et une commande netscan de volatilité. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a19/a6c/8a4/a19a6c8a4195441e4a408f07d0653f4c.jpg" alt="image"><br><br>  Si le système de vidage est toujours en vie, vous pouvez tuer ce processus ou poursuivre la recherche.  Bien sûr, vous devez en savoir plus sur l'adresse IP distante: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c1/a4e/9ff/1c1a4e9ff89f7942e05170162784b120.jpg" alt="image"><br><br>  Il semble être un serveur VPN anonyme gratuit et il y en a beaucoup sur Internet.  Et c'est une question - quelle application utilise cette connexion VPN sur la station infectée? <br><br>  Je sais que le VPN est une connexion à un autre réseau privé et mon poste de travail a une autre adresse IP dans un sous-réseau étranger.  Mon sous-réseau local est <b>192.168.145.0/24</b> mais il existe plusieurs services avec différentes adresses IP locales (10.211.1.0/24) en raison de la volatilité de netscan. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bee/1ed/e1c/bee1ede1cee3458d97dcf96bbab6380c.jpg" alt="image"><br><br>  Plusieurs adresses IP de destination sont pour les cerveaux Microsoft et un service suspect Sberbank_Antifraud connecté à 149.154.167.220 - c'est une IP de pool Telegram Messenger Donc, vous pouvez maintenant commencer à étudier comment ce processus est apparu sur cette machine. <br><br>  Ok, une autre façon concerne la connexion VPN basée sur cmd / bat avec des fichiers .pbk. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fb4/001/1df/fb40011dfef0a03c3d860467b4ee9244.jpg" alt="image"><br><br>  Contrairement à rasphone, le processus <b>rasdial</b> est un marqueur de connexion VPN pilotée par ligne de commande ou par script.  Vérifions la syntaxe rasdial ici <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ss64.com/nt/rasdial.html</a> et essayons de trouver <b>/ PHONEBOOK:</b> paramètre dans le vidage de la mémoire en utilisant FTK Imager: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fab/a81/488/faba81488b3e6a954471389aa7efc4d9.jpg" alt="image"><br><br>  Voila!  Nous avons trouvé un chemin complet vers le fichier du répertoire (donc, s'il est supprimé, vous pouvez essayer de le graver), le nom d'un script .cmd et le <b>login / mot de passe</b> ("vpn", "vpn") pour la connexion "extVPN" ! <br><br>  Les étapes suivantes sont les mêmes que pour la méthode rasphone: rechercher un paramètre «PhoneNumber =», trouver une session VPN et un service suspect avec une adresse IP locale étrangère. <br><br>  Merci encore pour votre attention!  Je serai bientôt de retour avec de nouvelles bonnes choses! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr442590/">https://habr.com/ru/post/fr442590/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr442580/index.html">Rétro-ingénierie au format binaire utilisant les fichiers Korg .SNG comme exemple</a></li>
<li><a href="../fr442582/index.html">Comment nous avons essayé le mobbing</a></li>
<li><a href="../fr442584/index.html">Documents sur le bâtiment: petites joies de l'automatisation sur l'exemple de la Tour Sombre</a></li>
<li><a href="../fr442586/index.html">La vulnérabilité dans Telegram permet de contourner le mot de passe du code local de n'importe quelle longueur</a></li>
<li><a href="../fr442588/index.html">Poser une question à l'auteur de Lua</a></li>
<li><a href="../fr442592/index.html">Utilisation de comptes Joomla dans un projet Django</a></li>
<li><a href="../fr442594/index.html">Allez-vous surveiller tout pour moi? Ouais</a></li>
<li><a href="../fr442596/index.html">Bande originale du jeu: les sciences humaines pleurent aussi</a></li>
<li><a href="../fr442598/index.html">Les chasseurs de têtes sont-ils nécessaires?</a></li>
<li><a href="../fr442600/index.html">Mon système domotique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>