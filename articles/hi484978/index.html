<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСо ЁЯжВ ЁЯдЯЁЯП╜ PubSub рд▓рдЧрднрдЧ рдореБрдлреНрдд рд╣реИ: PostgreSQL рдореЗрдВ NOTIFY рд╕реБрд╡рд┐рдзрд╛рдПрдБ ЁЯСиЁЯП╜тАНтЬИя╕П ЁЯзЪЁЯП╛ ЁЯША</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдпрджрд┐ рдЖрдкрдХреЗ рдорд╛рдЗрдХреНрд░реЛрд╕реЗрд░реНрд╡рд░реНрд╕ рдкрд╣рд▓реЗ рд╕реЗ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдкреЛрд╕реНрдЯрдЧреНрд░реЗрд╕реАрдХреНрдпреВрдПрд▓ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдпрд╛ рдпрджрд┐ рдПрдХ рд╣реА рд╕реЗрд╡рд╛ рдХреЗ рдХрдИ рдЙрджрд╛рд╣рд░рдг рд╡рд┐рднрд┐...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PubSub рд▓рдЧрднрдЧ рдореБрдлреНрдд рд╣реИ: PostgreSQL рдореЗрдВ NOTIFY рд╕реБрд╡рд┐рдзрд╛рдПрдБ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484978/">  рдпрджрд┐ рдЖрдкрдХреЗ рдорд╛рдЗрдХреНрд░реЛрд╕реЗрд░реНрд╡рд░реНрд╕ <u>рдкрд╣рд▓реЗ рд╕реЗ</u> рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <u>рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдкреЛрд╕реНрдЯрдЧреНрд░реЗрд╕реАрдХреНрдпреВрдПрд▓ рдбреЗрдЯрд╛рдмреЗрд╕</u> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдпрд╛ рдпрджрд┐ рдПрдХ рд╣реА рд╕реЗрд╡рд╛ рдХреЗ рдХрдИ рдЙрджрд╛рд╣рд░рдг рд╡рд┐рднрд┐рдиреНрди рд╕рд░реНрд╡рд░реЛрдВ рдкрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд░реЗрдбрд┐рд╕ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░, рд░реИрдмрд┐рдЯрдПрдордХреНрдпреВ рдХреНрд▓рд╕реНрдЯрд░, рдпрд╛ рдХреЛрдб рдореЗрдВ рдПрдореНрдмреЗрдб рдХрд┐рдП рдмрд┐рдирд╛ рдЙрдирдХреЗ рдмреАрдЪ <b>рд╕рдВрджреЗрд╢реЛрдВ</b> (рдкрдмрд╕рдм) <b>рдХрд╛ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛</b> рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд <b>рд╕рд╕реНрддрд╛ рд╣реИред</b> <a href="https://habr.com/ru/post/326880/">рдПрдХ рдФрд░ MQ рдкреНрд░рдгрд╛рд▓реА рдХреЗ</a> рдЕрдиреБрдкреНрд░рдпреЛрдЧред <br><br>  рдЗрд╕рдХреЗ рд▓рд┐рдП, рд╣рдо <a href="https://habr.com/ru/post/483014/">рдбреЗрдЯрд╛рдмреЗрд╕ рдЯреЗрдмрд▓ рдкрд░ рд╕рдВрджреЗрд╢</a> <b>рдирд╣реАрдВ рд▓рд┐рдЦреЗрдВрдЧреЗ</b> , рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдУрд╡рд░рд╣реЗрдб рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИ, рдкрд╣рд▓реЗ рдпрд╣ <a href="https://habr.com/ru/company/postgrespro/blog/459250/">рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ</a> рдХрд┐ рдХреНрдпрд╛ <a href="https://habr.com/ru/company/postgrespro/blog/459250/">рдкреНрд░реЗрд╖рд┐рдд рд╣реИ</a> , рдФрд░ рдлрд┐рд░ <a href="https://habr.com/post/481866/">рдкрд╣рд▓реЗ рд╕реЗ рдкрдврд╝реА рдЧрдИ рдЪреАрдЬрд╝реЛрдВ рд╕реЗ</a> рднреА <a href="https://habr.com/post/481866/">рд╕рд╛рдлрд╝ рдХрд░реЗрдВ</a> ред <br><br>  рд╣рдо <a href="https://postgrespro.ru/docs/postgresql/12/sql-notify">NOTIFY</a> / <a href="https://postgrespro.ru/docs/postgresql/12/sql-listen">LISTEN</a> рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛ рд╕рдВрдЪрд╛рд░рд┐рдд рдФрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗ, рдФрд░ рд╣рдо Node.js. рдХреЗ рд▓рд┐рдП рдПрдХ рдореЙрдбрд▓ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдПрдХрддреНрд░ рдХрд░реЗрдВрдЧреЗ <br><br><img src="https://habrastorage.org/webt/er/e_/dv/ere_dvhj_y3sjkypbqeezzg_xn4.png"><br><br>  рд▓реЗрдХрд┐рди рдЗрд╕ рд░рд╛рд╕реНрддреЗ рдкрд░ рдПрдХ рд░реЗрдХ рд╣реИ рдЬрд┐рд╕реЗ рд╕рд╛рд╡рдзрд╛рдиреА рд╕реЗ рдкрд░рд┐рдзрд┐ рдореЗрдВ рд▓рд╛рдирд╛ рд╣реЛрдЧрд╛ред <br><a name="habracut"></a><br><h2>  рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕реБрд╡рд┐рдзрд╛рдПрдБ </h2><br><h4>  рд╕реБрдиреЗрдВ </h4><br><pre><code class="sql hljs">LISTEN </code> </pre> <blockquote>  Libpq рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд▓рд┐рд╕реНрдЯреЗрди рдХрдорд╛рдВрдб рдХреЛ рдПрдХ рдирд┐рдпрдорд┐рдд рдПрд╕рдХреНрдпреВрдПрд▓ рдХрдорд╛рдВрдб рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рд╕рдордп-рд╕рдордп рдкрд░ рдирдИ рд╕реВрдЪрдирд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП PQnotify рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </blockquote>  рдпрджрд┐ рдЖрдк рдкреАрдЬреА рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдирд╣реАрдВ рд▓рд┐рдЦ рд░рд╣реЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╣реИ, рддреЛ рдЬреНрдпрд╛рджрд╛рддрд░ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЖрдкрдХреЛ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдкрд░ рдХреЙрд▓ рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реЛрдЧреАред <br><br>  рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдРрд╕реА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЖрдкрдХреЗ рд▓рд┐рдП <a href="https://postgrespro.ru/docs/postgresql/12/libpq-async">рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдЕрдиреБрд░реЛрдзреЛрдВ</a> рдФрд░ <a href="https://postgrespro.ru/docs/postgresql/12/libpq-notify">рд╕реВрдЪрдирд╛рдУрдВ рдХреЗ</a> рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рд╕рд┐рдлрд╛рд░рд┐рд╢реЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд▓рд┐рдЦреА рдЧрдИ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЖрд╡реЗрджрди рдХреЛрдб рдореЗрдВ рдПрдХ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧрд╛ред  рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рдЖрдк рдХрдиреЗрдХреНрд╢рди рдкрд░ рдХреЗрд╡рд▓ <b>рд╕рдордп-рд╕рдордп</b> рдкрд░ <b><code>SELECT 1</code> рдирд┐рд╖реНрдкрд╛рджрд┐рдд</b> рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдлрд┐рд░ рдХреНрд╡реЗрд░реА рдкрд░рд┐рдгрд╛рдо рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдзрд┐рд╕реВрдЪрдирд╛ рдЖрдПрдЧреА: <blockquote>  Libpq рдХреА рдмрд╣реБрдд рдкреБрд░рд╛рдиреА рд░рд┐рд▓реАрдЬрд╝ рдореЗрдВ, NOTIFY рдХрдорд╛рдВрдб рд╕реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреА рд╕рдордп рдкрд░ рдкреНрд░рд╛рдкреНрддрд┐ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдПрдХ рд╣реА рддрд░реАрдХрд╛ рдерд╛ - рд▓рдЧрд╛рддрд╛рд░ рдХрдорд╛рдВрдб рднреЗрдЬрдиреЗ, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЦрд╛рд▓реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдФрд░ рдлрд┐рд░ рдкреНрд░рддреНрдпреЗрдХ PQexec рдХреЙрд▓ рдХреЗ рдмрд╛рдж PQnotify рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред  рдпрджреНрдпрдкрд┐ рдпрд╣ рд╡рд┐рдзрд┐ рдЕрднреА рднреА рдХрд╛рдо рдХрд░рддреА рд╣реИ, рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЗ рдЕрдХреНрд╖рдо рдЙрдкрдпреЛрдЧ рдХреЗ рдХрд╛рд░рдг рдЗрд╕реЗ рдЕрдкреНрд░рдЪрд▓рд┐рдд рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред </blockquote>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <a href="https://postgrespro.ru/docs/postgresql/12/app-psql">psql рдХреЗ</a> рд╕рдВрджрд░реНрдн рдореЗрдВ, рдпрд╣ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: <br><br><pre> <code class="plaintext hljs">_tmp=# LISTEN test; LISTEN _tmp=# SELECT 1; ?column? ---------- 1 (1 row) Asynchronous notification "test" with payload "abc123" received from server process with PID 63991.</code> </pre><br>  рдпрджрд┐ рдПрдХ рд▓рд╛рдЧреВ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рд╣рдо 1 рд╕реЗрдХрдВрдб рдХреЗ рднреАрддрд░ рдПрдХ рд╕рдВрджреЗрд╢ рджреЗрдиреЗ рдореЗрдВ рдЕрдзрд┐рдХрддрдо рджреЗрд░реА рдкрд░ рд╕рд╣рдордд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕ рддрд░рд╣ рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдХреЗ рд╕рд╛рде, рд╣рдо рдЕрдиреБрд░реЛрдз рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдЙрд╕реА рд╕рдордп, рдпрд╣ рд╡рд┐рдзрд┐ <b>рдХрдиреЗрдХреНрд╢рди рдХреЗ "рд▓рд╛рдЗрдирд┐рдВрдЧ" рдХреА рдирд┐рдЧрд░рд╛рдиреА</b> рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИ, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдХреЛрдИ рднреА рдЧрд▓рддреА рд╕реЗ рдЗрд╕реЗ рд╕рд░реНрд╡рд░ рдХреА рддрд░рдл рд╕реЗ <code>pg_terminate_backend</code> рдорд╛рдзреНрдпрдо рд╕реЗ рдирд╣реАрдВ <code>pg_terminate_backend</code> , рдпрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рдХреЛрдИ рд╕реВрдЪрдирд╛ рджрд┐рдП рдмрд┐рдирд╛ рдкреАрдЬреА рдХреЗ рдЕрдЪрд╛рдирдХ "рдХреНрд░реИрд╢" рдирд╣реАрдВ рдерд╛ред <br><br><h4>  NOTIFY </h4><br><pre> <code class="sql hljs">NOTIFY  [ ,  ]</code> </pre> <br><blockquote>  NOTIFY рдХрдорд╛рдВрдб рдЙрди рд╕рднреА рдХреНрд▓рд╛рдЗрдВрдЯ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд "рд╕рдВрджреЗрд╢" рд▓рд╛рдЗрди рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдзрд┐рд╕реВрдЪрдирд╛ рдШрдЯрдирд╛ рднреЗрдЬрддрд╛ рд╣реИ рдЬреЛ рдкрд╣рд▓реЗ рдореМрдЬреВрджрд╛ рд▓рд┐рд╕реНрдЯреЗрди рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЪреИрдирд▓ рдирд╛рдо рдХреЗ рд╕рд╛рде рдПрдХ рдЪреИрдирд▓ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рдЪреБрдХреЗ рд╣реИрдВред <br>  ... <br>  "рд╕рдВрджреЗрд╢" рд▓рд╛рдЗрди рдЬрд┐рд╕реЗ рдЕрдзрд┐рд╕реВрдЪрдирд╛ рдХреЗ рд╕рд╛рде рдкреНрд░реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ ... рдПрдХ <a href="https://postgrespro.ru/docs/postgresql/12/sql-syntax-lexical">рд╕рд░рд▓ рдкрд╛рда рд╕реНрдерд┐рд░рд╛рдВрдХ</a> рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдПрдХ рдорд╛рдирдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ, рдЗрд╕рдХреА <b>рд▓рдВрдмрд╛рдИ 8000 рдмрд╛рдЗрдЯреНрд╕ рд╕реЗ рдХрдо рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП</b> ред </blockquote>  рдпрд╣реА рд╣реИ, рдЕрдЧрд░ рд╣рдорд╛рд░реЗ "рд╕рдВрджреЗрд╢" рдореЗрдВ рдЕрдЪрд╛рдирдХ ASCII рд╕реЗ рдХреБрдЫ рдмрд╣реБрдд рдЕрд▓рдЧ рд╣реИ, рддреЛ рд╣рдореЗрдВ <u>рдЗрд╕реЗ рд╕реНрдХреНрд░реАрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛</u> , рдФрд░ рдпрджрд┐ рдпрд╣ 8000 рдмрд╛рдЗрдЯреНрд╕ (рд╡рд░реНрдг рдирд╣реАрдВ!) рдХреЗ рдЖрдХрд╛рд░ рд╕реЗ рдЕрдзрд┐рдХ рд╣реИ, рддреЛ <u>рдЗрд╕реЗ рдмреНрд▓реЙрдХреЛрдВ рдореЗрдВ рдХрд╛рдЯ рд▓реЗрдВ рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдЧреЛрдВрдж рдХрд░реЗрдВ</u> ред  рдЙрд╕реА рд╕рдордп, рд╣рдореЗрдВ рдРрд╕реЗ рдмреНрд▓реЙрдХреЛрдВ рдХреЗ рд╣рд╕реНрддрд╛рдВрддрд░рдг рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪреИрдирд▓ рдмреИрдВрдбрд╡рд┐рдбреНрде рдФрд░ рд╕рд░реНрд╡рд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рджреЛрдиреЛрдВ рдХреЛ рдмрдЪрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП - рдЕрд░реНрдерд╛рддреН, рд╕рдВрднрд╡ рд╕рд╛рдордЧреНрд░реА рдХреЗ рд░реВрдк рдореЗрдВ рдЫреЛрдЯреА рд╕реЗрд╡рд╛ "рдмрд╛рдЗрдВрдбрд┐рдВрдЧ" рдХреЛ рдЬреЛрдбрд╝реЗрдВ, рд▓реЗрдХрд┐рди рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ "рдЧрд▓рд╛" рди рджреЗрдВ, рдЗрд╕реЗ рдкреИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░реЗрдВред <code>gzip -9</code> ред <br><br>  рддрдВрддреНрд░ рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рд▓рд╛рднреЛрдВ рдореЗрдВ рд╕реЗ, рдХреЛрдИ рднреА рд╕рдВрджреЗрд╢ рдХреЗ "рд╕реНрд░реЛрдд" рдХреЗ рд▓рд┐рдП рдмрд╛рдзреНрдпрдХрд╛рд░реА рдХреЛ рдиреЛрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ ... <br><blockquote>  ... рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░реНрдп рдХреЛ рдЬрд╛рдБрдЪ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ <b>рд╕рдВрдХреЗрддрди рдкреНрд░рдХреНрд░рд┐рдпрд╛</b> (рдШрдЯрдирд╛ рдбреЗрдЯрд╛ рдореЗрдВ рд╕рдВрдХреЗрддрд┐рдд) рдХрд╛ рдкреАрдЖрдИрдбреА тАЛтАЛрд╕рддреНрд░ рдХреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдкреАрдЖрдИрдбреА тАЛтАЛрд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ (рдЖрдк рдЗрд╕реЗ libpq рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдХреЗ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ)ред  рдпрджрд┐ рд╡реЗ рдореЗрд▓ рдЦрд╛рддреЗ рд╣реИрдВ, рддреЛ рд╕рддреНрд░ рдХреЛ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреА рд╕реВрдЪрдирд╛ рдорд┐рд▓реА, рддрд╛рдХрд┐ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред </blockquote>  ... рдФрд░ рдЧрд╛рд░рдВрдЯреА рд╡рд┐рддрд░рдг рдЖрджреЗрд╢: <br><blockquote>  рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рд╕реВрдЪрдирд╛рдУрдВ рдХреЗ рдмрд╛рдж рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛, NOTIFY рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рдПрдХрд▓ рд▓реЗрдирджреЗрди рд╕реЗ рд╕реВрдЪрдирд╛рдПрдВ рд╣рдореЗрд╢рд╛ рдЙрд╕реА рдХреНрд░рдо рдореЗрдВ рдЖрддреА рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛ред  рдпрд╣ рднреА рдЧрд╛рд░рдВрдЯреА рджреА рдЬрд╛рддреА рд╣реИ рдХрд┐ <b>рд╡рд┐рднрд┐рдиреНрди рд▓реЗрдирджреЗрди рд╕реЗ рд╕рдВрджреЗрд╢ рдЙрд╕реА рдХреНрд░рдо рдореЗрдВ рдЖрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдпреЗ рд▓реЗрдирджреЗрди рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ</b> ред </blockquote>  рд╣рдо рдХреБрдЫ рднреА рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдВрдпреЛрдЬрд┐рдд рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рд╣рдорд╛рд░рд╛ рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдПрдХ рдЕрд▓рдЧ рд▓реЗрдирджреЗрди рдХреЗ рдЕрдиреБрд░реВрдк рд╣реЛрдЧрд╛ред <br><br>  рд▓реЗрдХрд┐рди рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдпрджрд┐ рдПрдХреНрд╕рдЪреЗрдВрдЬ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХрдиреЗрдХреНрд╢рди рдкрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЧрддрд┐рд╡рд┐рдзрд┐ рднреА рд╣реИ, рддреЛ рд╣рдорд╛рд░реА рд╕реВрдЪрдирд╛ рд╣рдорд╛рд░реА рд╕реНрд╡рдпрдВ рдХреА рд╕реНрд╡рддрдВрддреНрд░ рдЗрдЪреНрдЫрд╛ рдХреЗ рд▓реЗрдирджреЗрди рдХреЗ рдЕрдВрджрд░ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП <u>рджреБрд╖реНрдкреНрд░рднрд╛рд╡ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ</u> : <br><blockquote>  рд▓реЗрди-рджреЗрди рдХрд╛ NOTIFY рдкрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд░рднрд╛рд╡ рдкрдбрд╝рддрд╛ рд╣реИред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЕрдЧрд░ NOTIFY рдПрдХ рд▓реЗрдирджреЗрди рдХреЗ рдЕрдВрджрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд▓реЗрди-рджреЗрди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕реВрдЪрдирд╛рдПрдВ рджреА рдЬрд╛рддреА рд╣реИрдВ, рдФрд░ рдХреЗрд╡рд▓ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВред  рдпрд╣ рдЙрдЪрд┐рдд рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ <b>рд▓реЗрди-рджреЗрди рдмрд╛рдзрд┐рдд рд╣реЛрдиреЗ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЗрд╕рдореЗрдВ рд╕рднреА рдЖрджреЗрд╢реЛрдВ рдХреА рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЛ рд░рджреНрдж рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рдирдореЗрдВ NOTIFY рднреА рд╢рд╛рдорд┐рд▓ рд╣реИ</b> ред </blockquote>  рдЗрд╕рд▓рд┐рдП, рдПрдХ рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИ рдЬрд╣рд╛рдВ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдХреЛрдИ рд▓реЗрдирджреЗрди рдпрд╛ рд▓рдВрдмреА рдХреНрд╡реЗрд░реА рдирд╣реАрдВ рд╣реИред <br><br><h4>  AccessExclusiveLock рдбреЗрдЯрд╛рдмреЗрд╕ 0 рдХреЗ рдХрдХреНрд╖рд╛ 1262 рдХреЗ рдСрдмреНрдЬреЗрдХреНрдЯ 0 рдкрд░ </h4><br>  рдпрджрд┐ рдЕрдЪрд╛рдирдХ рдЖрдкрдХреЗ NOTIFYs рдиреЗ рдРрд╕реЗ рд▓реЙрдХ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХреЛ рдХреБрдВрдж рдФрд░ рд▓реЙрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджрд┐рдпрд╛, рддреЛ рдЖрдк рдЕрднреА рднреА "рд╢реЙрд░реНрдЯ рдкреИрдВрдЯ рд╕реЗ рдмрд╛рд╣рд░ рд╣реЛ рдЧрдП рд╣реИрдВ", рдФрд░ рдпрд╣ "рд╡рдпрд╕реНрдХ" рдПрдордХреНрдпреВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪрдиреЗ рдХрд╛ рд╕рдордп рд╣реИред <br><br>  рдЖрдЦрд┐рд░рдХрд╛рд░, рдЕрдзрд┐рд╕реВрдЪрдирд╛ рдХрддрд╛рд░, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдХрд╛рдлреА рдмрдбрд╝реА (рдорд╛рдирдХ рдмрд┐рд▓реНрдб рдореЗрдВ 8 рдЬреАрдмреА), рдЕрднреА рднреА рдкрд░рд┐рдорд┐рдд рд╣реИред  <a href="">рдЯреЙрдо рд▓реЗрди рдХреЗ рдЬрд╡рд╛рдм рдХреЗ</a> рдЕрдиреБрд╕рд╛рд░: <br><blockquote>  <i>рдпрд╣ рд▓реЙрдХ рд▓реЗрдирджреЗрди рдХреЗ рдЕрдзрд┐рд╕реВрдЪрд┐рдд рд╕рдВрджреЗрд╢ (рдУрдВ) рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рддреЗ рд╕рдордп рдЖрдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд▓реЗрдирджреЗрди рд▓реЙрдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИред</i> </blockquote>  рдпрд╣реА рд╣реИ, рдЪрд╛рд░реЛрдВ рдУрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИрдВ: <br><br><ul><li>  <b>рдХрдо рдмрд╛рд░ рднреЗрдЬреЗрдВ</b> <br>  рдпрд╣реА рд╣реИ, рднреЗрдЬреЗ рдЧрдП рд╕рдВрдХреЗрддрдХреЛрдВ рдХреЛ рдПрдХрддреНрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЕрдЧрд░ рдпреЗ рдХреБрдЫ рдХрд╛рдЙрдВрдЯрд░ рд╣реИрдВ, рдПрдХ рд▓рдВрдмреЗ рдЕрдВрддрд░рд╛рд▓ рдкрд░ред </li><li>  <b>рдХрдо рднреЗрдЬреЗрдВ</b> <br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЯреНрд░рд╛рдВрд╕рдорд┐рдЯ рдХрд┐рдП рдЧрдП JSON рд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреБрдВрдЬреА рдорд╛рдиреЛрдВ рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ "рдбрд┐рдлрд╝реЙрд▓реНрдЯ" рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдПред </li><li>  <b>рдХреЗрд╡рд▓ рд╕рдВрдХреЗрдд рднреЗрдЬреЗрдВ</b> , рдХреЛрдИ рд╕рд╛рдордЧреНрд░реА рдирд╣реАрдВ <br>  рдПрдХ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд░реВрдк рдореЗрдВ - рдХрдИ рдЪреИрдирд▓ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкреНрд░рддреНрдпреЗрдХ рдХрд╛ рдирд╛рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХреБрдЫ рд▓рд╛рдЧреВ рдЕрд░реНрдереЛрдВ рдореЗрдВ рд╣реЛрдЧрд╛ред </li><li>  рдЕрднреА рднреА <b>рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдПрдХ рд╢рд┐рдкрдореЗрдВрдЯ рдмрдирд╛рддреЗ рд╣реИрдВ</b> </li></ul><br><h2>  рдЬрдЯрд┐рд▓ рд╕рдВрджреЗрд╢ рднреЗрдЬрдирд╛ </h2><br><h4>  рд╢рд░реАрд░ рдХреА рдПрдиреНрдХреЛрдбрд┐рдВрдЧ </h4><br>  рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рд╣рдо рд╕рдВрджреЗрд╢ рдореЗрдВ рди рдХреЗрд╡рд▓ рд╡рд░реНрдгреЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдмрд▓реНрдХрд┐ рд░реВрд╕реА рдкрддреНрд░ рднреА, рдФрд░ "рдХрд┐рд╕реА рднреА рдмрд╛рдпрдиреЗрд░рд┐рдЬрд╝" - рдЗрд╕рд▓рд┐рдП, рдкреНрд░реЗрд╖рд┐рдд рд╕реНрдЯреНрд░рд┐рдВрдЧ рдмрдирд╛рдиреЗ рдХреЗ <u>рд▓рд┐рдП рд╣реЗрдХреНрд╕ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдореЗрдВ рд░реВрдкрд╛рдВрддрд░рдг рдХрд╛</u> рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реЛрдЧрд╛ред  рдФрд░ рд╣рд╛рдВ, рдпрд╣ рддрд░реАрдХрд╛ рдХрд╛рдлреА рдХрд╛рд░рдЧрд░ рд╣реИ: <br><br><pre> <code class="sql hljs">NOTIFY test, E'\x20\x21'</code> </pre> <br><pre> <code class="plaintext hljs">Asynchronous notification "test" with payload " !" received from server process with PID 63991.</code> </pre> <br>  рд▓реЗрдХрд┐рди рдлрд┐рд░ рд╕реЗ рдкреНрд░рд▓реЗрдЦрди рдХреА рдУрд░ рдореБрдбрд╝рддреЗ рд╣реИрдВ: <br><blockquote>  рдЖрдкрдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдмрдирд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдмрд╛рдЗрдЯ рдХреНрд░рдо, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЕрд╖реНрдЯрд╛рдзрд╛рд░реА рдФрд░ рд╖реЛрдбрд╢-рд╕рдВрдХреЗрддрди рдореЗрдВ, <b>рдорд╛рдиреНрдп рд╕рд░реНрд╡рд░-рдПрдиреНрдХреЛрдбреЗрдб рд╡рд░реНрдг</b> рдмрдирд╛рддреЗ рд╣реИрдВред  рдЬрдм рд╕рд░реНрд╡рд░ рдРрд╕реЗ рдмрд╛рдЗрдЯ рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ рдХреЗ рдмрдЬрд╛рдп UTF-8 рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рддреЛ рдзрд╛рд░рд╛ 4.1.2.3 рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдпреВрдирд┐рдХреЛрдб рд╡рд┐рд╢реЗрд╖ рдЕрдиреБрдХреНрд░рдо рдпрд╛ рд╡реИрдХрд▓реНрдкрд┐рдХ рдпреВрдирд┐рдХреЛрдб рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред  (рдЕрдиреНрдпрдерд╛, рдЖрдкрдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ UTF-8 рд╡рд░реНрдгреЛрдВ рдХреЛ рдПрдирдХреЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдмрд╛рдЗрдЯреНрд╕ рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдЦрдирд╛ рд╣реЛрдЧрд╛, рдЬреЛ рдмрд╣реБрдд рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ) </blockquote>  рдЗрд╕рд▓рд┐рдП, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ win1251 рд╕реЗ рдЙрджреНрдзрд░рдг рдЪрд┐рд╣реНрди-рдкрдВрдЬрд╛ рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рдЪрд┐рд╣реНрди рдХреЗ рд╕рд╛рде, рд╣рдо рджреБрдЦ рдореЗрдВ рд░реЛрдЯреА рд▓реЗрддреЗ рд╣реИрдВ: <br><br><pre> <code class="sql hljs">NOTIFY test, E'\x98' <span class="hljs-comment"><span class="hljs-comment">-- ERROR: invalid byte sequence for encoding "UTF8": 0x98</span></span></code> </pre> <br>  рдЪреВрдБрдХрд┐ рд╣рдо <i>UTF-8 рд╡рд░реНрдгреЛрдВ рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдПрдирдХреЛрдб рдХрд░рдирд╛ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдмрд╛рдЗрдЯреНрд╕ рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ</i> ", рд╣рдо <b>рдмреЗрд╕ 64 рдореЗрдВ рдкреИрдХ рдХрд┐рдП</b> рдЧрдП рд╕рдВрджреЗрд╢ рдмреЙрдбреА рдХреЛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рддреБрд░рдВрдд рд╕рд╣рдордд рд╣реЛрдВрдЧреЗ, рдпрджрд┐ рд╕реАрдорд╛ <code>\x20-\x7E</code> рдмрд╛рд╣рд░ рдХреЛрдИ рд╡рд░реНрдг рд╣реИрдВ рдпрд╛, рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ, рд╡рд┐рднрд╛рдЬрдиред  рдПрдХ рддрд░рдл, рдкреИрдХреЗрдЬрд┐рдВрдЧ рдХреА рдпрд╣ рд╡рд┐рдзрд┐ рдЕрддрд┐рд░реЗрдХ рдХреЛ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдирд╣реАрдВ рдмрдврд╝рд╛рддреА рд╣реИ (4: 3 рдЧреБрдгрд╛рдВрдХ), рджреВрд╕рд░реА рддрд░рдл, рдпрд╣ рдХрд┐рд╕реА рднреА рднрд╛рд╖рд╛ рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рд╕реНрддрд░ рдкрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдиреНрдпреВрдирддрдо рдЕрддрд┐рд░рд┐рдХреНрдд рднрд╛рд░ рдкреНрд░рджрд╛рди рдХрд░реЗрдЧрд╛ред <br><br>  рд▓реЗрдХрд┐рди рднрд▓реЗ рд╣реА рд╣рдорд╛рд░реЗ рдкрд╛рд╕ "рдЕрдЬреАрдм" рдЕрдХреНрд╖рд░ рди рд╣реЛрдВ, рдФрд░ рд╕рдВрджреЗрд╢ рдПрдХ рд╕реЗрдЧрдореЗрдВрдЯ рдореЗрдВ рдлрд┐рдЯ рдмреИрдарддрд╛ рд╣реИ, рдлрд┐рд░ рднреА рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ - <b>рдПрдкреЛрд╕реНрдЯреНрд░реЛрдлрд╝ рд╕реЗ рдмрдЪрдирд╛</b> : <br><blockquote>  рдПрдХ рдПрдкреЛрд╕реНрдЯреНрд░реЛрдл рдХреЛ рдПрдХ рдкрдВрдХреНрддрд┐ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕рдХреЗ <u>рдмрдЧрд▓</u> рдореЗрдВ <u>рджреЛ рдПрдкреЛрд╕реНрдЯреНрд░реЛрдлрд┐рд╕</u> рд▓рд┐рдЦреЗрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: 'рдЬреЛрди рдСрдл рдЖрд░реНрдХ'ред  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рджреЛрд╣рд░реЗ рдЙрджреНрдзрд░рдг (") рдХреЗ рд╕рдорд╛рди рдирд╣реАрдВ рд╣реИред </blockquote><br><h4>  рдЦрдВрдб рдкрд╣рдЪрд╛рди </h4><br>  рдЕрдЧрд▓рд╛ рдХрд╛рд░реНрдп <b>7999 рдмрд╛рдЗрдЯреНрд╕ рдХреЗ</b> рд╕рдВрдЪрд░рдг <b>рдХреЗ</b> рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓реЗ <b>рдмреНрд▓реЙрдХ</b> рдореЗрдВ рд╕рдВрджреЗрд╢ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ "рдХрдЯ" рдХрд░рдирд╛ рд╣реИ, рдЕрдЧрд░ рдЗрд╕рдХрд╛ рдЖрдХрд╛рд░ рдЕрдЪрд╛рдирдХ рдЗрд╕ рдореВрд▓реНрдп рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛред  рдФрд░ рддрд╛рдХрд┐ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдЖрджреЗрд╢ рдХреЛ рддреЛрдбрд╝рдиреЗ рдХреЗ рдмрд┐рдирд╛ рдпрд╛ "рд╡рд┐рджреЗрд╢реА" рдЦрдВрдбреЛрдВ рдХреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рдЧрд┐рд░ рд╕рдХрддрд╛ рд╣реИред  рдЗрд╕рдХреЗ рд▓рд┐рдП, рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рдХрд┐рд╕реА рди рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдкрд╣рдЪрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╣рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рджреЛ "рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ" рдЬрд╛рдирддреЗ рд╣реИрдВ - рдпрд╣ <u>рднреЗрдЬрдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдкреАрдЖрдИрдбреА</u> рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдЕрдзрд┐рд╕реВрдЪрдирд╛ рдореЗрдВ рдЖрдиреЗ <u>рд╡рд╛рд▓реЗ рдЪреИрдирд▓ рдХрд╛ рдирд╛рдо рд╣реИ</u> ред  рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реА рд╣рдореЗрдВ рдЦрдВрдбреЛрдВ рдХреЗ рдЖрдЧрдорди рдХреЗ рдЖрджреЗрд╢ рдХреА рдЧрд╛рд░рдВрдЯреА рджреЗрддрд╛ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">рдкрдбрд╝реЛрд╕реА рд▓реЗрдЦрди</b> <div class="spoiler_text">  рд╣рдо рдЙрд╕ рдорд╛рдорд▓реЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ рдЬрдм <i>рдПрдХ рд╣реА рдЪреИрдирд▓ рдХреЗ рдХрдИ рд▓реЗрдЦрдХ</i> <i>рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрдиреЗ рдХреЗ</i> рд╕рдордп рдПрдХ рд╣реА рд╕рдордп рдкрд░ рд╕рдХреНрд░рд┐рдп рд╣реЛрдВ (рдЕрд░реНрдерд╛рдд, рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдПрдХ рд╣реА рдЖрд╡реЗрджрди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рднреАрддрд░)ред  рддрдХрдиреАрдХреА рд░реВрдк рд╕реЗ, рдЗрд╕реЗ рд╕реЗрдЧрдореЗрдВрдЯ рд╣реЗрдбрд░ рдореЗрдВ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдХреЛ рдкрд╛рд╕ рдХрд░рдХреЗ рд╕рдорд░реНрдерд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ - рд▓реЗрдХрд┐рди рдпрд╣ рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдЕрдВрджрд░ рдПрдХ рдПрдХрд▓ рдкрдмрд╕рдм рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ "рд╕рд╛рдЭрд╛" рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИред <br></div></div><br><h4>  рдХрдВрдЯреЗрдирд░ рдХреА рд╕реАрдорд╛ </h4><br>  рдХрдИ рдЦрдВрдбреЛрдВ рд╕реЗ рдПрдХ рдЕрднрд┐рдиреНрди рдХрдВрдЯреЗрдирд░ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЗрд╕рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдХреНрд╖рдг рдХреЛ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдЗрд╕рдХреЗ рд▓рд┐рдП рджреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рддрд░реАрдХреЗ рд╣реИрдВ: <br><br><ul><li>  рдЙрдирдореЗрдВ рд╕реЗ рдкрд╣рд▓реЗ рдореЗрдВ рд▓рдХреНрд╖реНрдп рдЖрдХрд╛рд░ (рдмрд╛рдЗрдЯреНрд╕ рдпрд╛ рдЦрдВрдбреЛрдВ рдореЗрдВ) рдХрд╛ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг </li><li>  рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдореЗрдВ рдЕрдВрддрд┐рдо рдЦрдВрдб [рдирд╣реАрдВ] рдХреЗ рд╕рдВрдХреЗрдд рдХрд╛ рд╕рдВрдЪрд░рдг </li></ul><br>  рдЪреВрдВрдХрд┐ рд╣рдо PubSub рдХреЛ рдЖрдЦрд┐рд░рдХрд╛рд░ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдорд╛рд░реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕рдВрджреЗрд╢ рдХрдо рд╣реЛрдВрдЧреЗ рдФрд░ рдЖрдХрд╛рд░ рдХреЗ рд╣рд╕реНрддрд╛рдВрддрд░рдг рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рд╛рд░реЗ рдмрд╛рдЗрдЯреНрд╕ рдЖрд░рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рд▓рд╛рднрджрд╛рдпрдХ рдирд╣реАрдВ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╣рдо рдХрдВрдЯреЗрдирд░ рдХреА рдирд┐рд░рдВрддрд░рддрд╛ / рд╕рдорд╛рдкреНрддрд┐ рдзреНрд╡рдЬ рдХреЗ рд░реВрдк рдореЗрдВ <u>рдЦрдВрдб рдбреЗрдЯрд╛</u> рдХреЗ <u>рдкрд╣рд▓реЗ рд╡рд░реНрдг рдХреЛ</u> рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрддреЗ рд╣реБрдП рджреВрд╕рд░реА рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред <br><br><h4>  рдСрдмреНрдЬреЗрдХреНрдЯ рдЯреНрд░рд╛рдВрд╕рдлрд░ </h4><br>  рд╕рд╛рджреЗ рдЯреЗрдХреНрд╕реНрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдФрд░ JSON рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЛ "рд╕рдВрджреЗрд╢" рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдкрдХреНрд╖ рдкрд░ рдЙрд▓рдЯрд╛ рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рд▓рд┐рдП <u>рдПрдХ рдФрд░ рдкреНрд░рддреАрдХ-рдЪрд┐рд╣реНрди</u> рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред <br><br>  рдЪреВрдВрдХрд┐ рд╣рдордиреЗ рдмреЗрд╕ 64 рдореЗрдВ "рдиреЙрди-рдлреЙрд░реНрдореЗрдЯ" рдХреЛ рдПрдирдХреЛрдб рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ рдерд╛, рдЗрд╕рд▓рд┐рдП рдЭрдВрдбреЗ рдХреЗ рд▓рд┐рдП рд╣рдо рдХрд┐рд╕реА рднреА рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓реЗ рдкрд╛рддреНрд░реЛрдВ рдХреЛ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЗрд╕ рд╕реЗрдЯ рдореЗрдВ рдирд╣реАрдВ рд╣реИрдВред <br><br>  рдХреБрд▓ рдорд┐рд▓рд╛рдХрд░, рд╣рдореЗрдВ рдкреНрд░реЗрд╖рд┐рдд рдЦрдВрдбреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд┐рдХрд▓реНрдк рдорд┐рд▓реЗ: <br><br><pre> <code class="plaintext hljs">-- ""   !simple string -- "  "  @{"a":1} --    base64 #&lt;segment&gt; --    base64 $&lt;segment&gt;</code> </pre><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рдХрд┐ рдЦрдВрдб рдХреЛ рдХреЗрд╡рд▓ рдкрд╣рд▓рд╛ рдЪрд░рд┐рддреНрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдЗрд╕рдХреЗ рд╕рд╛рде рдЖрдЧреЗ рдХреНрдпрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br><h2>  рдПрдХ рдкрдмрдмрд╕ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд▓рд╛рдЧреВ рдХрд░рдирд╛ </h2><br>  рд╣рдорд╛рд░рд╛ рдЖрд╡реЗрджрди Node.js рдкрд░ рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рд╣рдо PostgreSQL рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <a href="https://www.npmjs.com/package/pg">рдиреЛрдб-рдкреЛрд╕реНрдЯрдЧреНрд░реЗрдЬ рдореЙрдбреНрдпреВрд▓</a> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред <br><br><div class="spoiler">  <b class="spoiler_title">рд╣рдо рд╢реБрд░реБрдЖрддреА рдлреНрд░реЗрдо рд▓рд┐рдЦрддреЗ рд╣реИрдВ</b> <div class="spoiler_text">  рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЪрд▓рд┐рдП PubSub рдХреЛ <a href="https://nodejs.org/dist/latest-v12.x/docs/api/events.html">EventEmitter</a> рдХреЗ рд╡рд╛рд░рд┐рд╕ рдХреЗ рд░реВрдк рдореЗрдВ <a href="https://nodejs.org/dist/latest-v12.x/docs/api/events.html">рдмрдирд╛рддреЗ рд╣реИрдВ</a> , рддрд╛рдХрд┐ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЪреИрдирд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рджрд╕реНрдпрддрд╛ рд▓реЗрдиреЗ рд╡рд╛рд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдШрдЯрдирд╛рдУрдВ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХреЗрдВ: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> util = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'util'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> EventEmitter = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'events'</span></span>).EventEmitter; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PubSub = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">connection, interval, skipSelf</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     this.connection = connection; //        this.connection.on('notification', p._onmessage.bind(this)); //         this.skipSelf = skipSelf; //  "" setInterval(() =&gt; { this.connection.query('SELECT 1'); }, interval); //     ""  this.slices = {}; }; util.inherits(PubSub, EventEmitter); const p = PubSub.prototype;</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">рд╣рдо рдЪреИрдирд▓реЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ</b> <div class="spoiler_text">  рдЪреВрдВрдХрд┐ LISTEN / UNLISTEN рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рдХрд╕рдо рдирд╣реАрдВ рдЦрд╛рддреЗ рд╣реИрдВ, рдЬрдм рдХрд┐рд╕реА рдЪреИрдирд▓ рдХреА рдкреБрдирдГ рд╕рджрд╕реНрдпрддрд╛ рд▓реЗрддреЗ рд╣реИрдВ рдпрд╛ рдЙрд╕ рд╕рджрд╕реНрдпрддрд╛ рд╕реЗ рдЬрд┐рд╕реЗ рд╣рдо рд╕рдмреНрд╕рдХреНрд░рд╛рдЗрдм рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд╕реЗ рд╕рджрд╕реНрдпрддрд╛ рдирд╣реАрдВ рд▓реЗрддреЗ рд╣реИрдВ, рд╣рдо рдХреБрдЫ рднреА рдЬрдЯрд┐рд▓ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     - "",      //     -        const quot = str =&gt; /^[_a-z][0-9a-z_\$]*$/.test(str) ? str : `"${str}"`; p.subscribe = function(channel) { this.connection.query(`LISTEN ${quot(channel)}`); return this; }; p.unsubscribe = function(channel) { this.connection.query(`UNLISTEN ${quot(channel)}`); return this; };</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">рд╕рдВрджреЗрд╢ рднреЗрдЬрдирд╛ рдФрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PAYLOAD_LIMIT = <span class="hljs-number"><span class="hljs-number">8000</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PAYLOAD_FL_STR = <span class="hljs-string"><span class="hljs-string">'!'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PAYLOAD_FL_OBJ = <span class="hljs-string"><span class="hljs-string">'@'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PAYLOAD_FL_SEQ = <span class="hljs-string"><span class="hljs-string">'#'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PAYLOAD_FL_FIN = <span class="hljs-string"><span class="hljs-string">'$'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PAYLOAD_SZ_HEAD = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PAYLOAD_SZ_DATA = PAYLOAD_LIMIT - PAYLOAD_SZ_HEAD; <span class="hljs-comment"><span class="hljs-comment">//  ""  const reASCII = /^[\x20-\x7E]*$/; //  p.publish = function(channel, payload) { let query = `NOTIFY ${quot(channel)}`; if (payload !== null &amp;&amp; payload !== undefined) { //    -    let str = typeof payload == 'string' ? PAYLOAD_FL_STR + payload : PAYLOAD_FL_OBJ + JSON.stringify(payload); if (str.length &gt; PAYLOAD_LIMIT || !reASCII.test(str)) { //   base64- const b64 = Buffer.from(str).toString('base64'); for (let pos = 0, len = b64.length; pos &lt; len; pos += PAYLOAD_SZ_DATA) { let fin = pos + PAYLOAD_SZ_DATA; let seg = fin &gt;= len ? PAYLOAD_FL_FIN + b64.slice(pos) : PAYLOAD_FL_SEQ + b64.slice(pos, fin); this.connection.query(`${query}, '${seg}'`); } } else { //        ? //     str = str.replace(/'/g, "''"); this.connection.query(`${query}, '${str}'`); } } else { //       this.connection.query(query); } return this; }; //    p._onmessage = function(msg) { const {processId, channel, payload} = msg; //  "" if (processId == this.connection.processID &amp;&amp; this.skipSelf) { return; } // ""  const id = `${processId}:${channel}`; let rv; //   let fl = payload.charAt(0); if (fl == PAYLOAD_FL_SEQ || fl == PAYLOAD_FL_FIN) { // base64 const str = payload.slice(PAYLOAD_SZ_HEAD); const slices = this.slices; let b64; if (fl == PAYLOAD_FL_FIN) { //   if (slices[id]) { slices[id].push(str); b64 = slices[id].join(''); delete slices[id]; } else { b64 = str; } } else { //     if (slices[id]) { slices[id].push(str); } else { slices[id] = [str]; } } if (b64) { rv = Buffer.from(b64, 'base64').toString(); fl = rv.charAt(0); } } else { //  / rv = payload; } if (rv !== undefined) { //   '' let res = { processId , channel }; if (rv) { //       let data = rv.slice(1); res.payload = fl == PAYLOAD_FL_OBJ ? JSON.parse(data) : data; } this.emit(channel, res); } };</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">рдХреБрдЫ рдкрд░реАрдХреНрд╖рдг</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> pg = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'pg'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> pgsql = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> pg.Client({ <span class="hljs-attr"><span class="hljs-attr">host</span></span> : <span class="hljs-string"><span class="hljs-string">'example-db'</span></span> , <span class="hljs-attr"><span class="hljs-attr">port</span></span> : <span class="hljs-number"><span class="hljs-number">5432</span></span> , <span class="hljs-attr"><span class="hljs-attr">user</span></span> : <span class="hljs-string"><span class="hljs-string">'postgres'</span></span> , <span class="hljs-attr"><span class="hljs-attr">password</span></span> : <span class="hljs-string"><span class="hljs-string">'postgres'</span></span> , <span class="hljs-attr"><span class="hljs-attr">database</span></span> : <span class="hljs-string"><span class="hljs-string">'_tmp'</span></span> }); pgsql.connect(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> psA = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PubSub(pgsql, <span class="hljs-number"><span class="hljs-number">1000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> psB = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PubSub(pgsql, <span class="hljs-number"><span class="hljs-number">1000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> chA = <span class="hljs-string"><span class="hljs-string">'channel:A'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> chB = <span class="hljs-string"><span class="hljs-string">'channel:B'</span></span>; psA.subscribe(chA); psB.subscribe(chB); psA.on(chA, (msg) =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'A:rcv'</span></span>, msg); }); psB.on(chB, (msg) =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'B:rcv'</span></span>, msg); }); psB.publish(chA); psB.publish(chA, <span class="hljs-string"><span class="hljs-string">'simple string'</span></span>); psB.publish(chA, <span class="hljs-string"><span class="hljs-string">'  '</span></span>); psB.publish(chA, {<span class="hljs-attr"><span class="hljs-attr">a</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>}); psA.publish(chB, <span class="hljs-string"><span class="hljs-string">'   100  '</span></span>.repeat(<span class="hljs-number"><span class="hljs-number">100</span></span>)); });</code> </pre></div></div><br>  рд╕рдм рдХреБрдЫ рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдк рдЗрд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдЕрдкрдиреА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдП рдЧрдП рдХрд┐рд╕реА рдЕрдиреНрдп рдкреАрдПрд▓ рдкрд░ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд╕реВрдЪрдирд╛рдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХрд╛ рдЖрдзрд╛рд░: <br><br><ul><li>  <a href="http://initd.org/psycopg/docs/advanced.html">рдЕрдЬрдЧрд░</a> </li><li>  <a href="https://tapoueh.org/blog/2018/07/postgresql-listen-notify/">рдЬрд╛рдУ</a> </li><li>  <a href="https://omniti.com/seeds/stop-collaborate-and-listen-notify.html">рдкрд░реНрд▓</a> </li><li>  <a href="https://blog.lelonek.me/listen-and-notify-postgresql-commands-in-elixir-187c49597851">рдЕрдореГрдд</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi484978/">https://habr.com/ru/post/hi484978/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi484964/index.html">InfoWatch рдЯреНрд░реИрдлрд┐рдХ рдореЙрдирд┐рдЯрд░ рдкрд░ рд▓реЛрдб рд╕рдВрддреБрд▓рди рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛</a></li>
<li><a href="../hi484966/index.html">рд╕реНрдкреНрд░рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдЯреЗрдореНрдкрд▓реЗрдЯ</a></li>
<li><a href="../hi484968/index.html">WPF DataGridред рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЗ рд▓рд┐рдП рд▓рдбрд╝реЛ</a></li>
<li><a href="../hi484972/index.html">рд╢рд░рд╛рдм 5.0 рдЬрд╛рд░реА рдХрд┐рдпрд╛</a></li>
<li><a href="../hi484974/index.html">рдЯреНрдпреВрд░рд┐рдВрдЧ рдорд╢реАрди рд╕рд┐рдореБрд▓реЗрд╢рди рдХреЗ рд▓рд┐рдП рд╡рд╛рдВрдЧ рдЯрд╛рдЗрд▓реЗрдВ</a></li>
<li><a href="../hi484982/index.html">рдХреНрдпрд╛ рдЖрдИрдЯреА рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рд╡реНрдпрд╡рд╕рд╛рдп рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ</a></li>
<li><a href="../hi484984/index.html">рдПрдХрддрд╛ рдЦреЗрд▓ рдбреЗрд╡рд▓рдкрд░ред OTUS рд╕реЗ рдирдпрд╛ рдкрд╛рдареНрдпрдХреНрд░рдо</a></li>
<li><a href="../hi484990/index.html">Luxoft TechTalks - рд╡реИрд╢реНрд╡рд┐рдХ рдЖрдИрдЯреА рдЧреБрд░реБ рдФрд░ рдЕрдзрд┐рдХ рд╕реЗ рд╡реАрдбрд┐рдпреЛ рдкреЙрдбрдХрд╛рд╕реНрдЯ</a></li>
<li><a href="../hi484992/index.html">рдмрдбрд╝реА рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рд╕реБрдВрджрд░: рд╕реЗрдЯрдЕрдк рдкрд░ 20 рдорд┐рдирдЯ рдмрд┐рддрд╛рдПрдВ, рд╣рдореЗрд╢рд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рд░реВрдкрдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рднреВрд▓ рдЬрд╛рдПрдВ</a></li>
<li><a href="../hi484996/index.html">рд╡рд░реНрдЪреБрдЕрд▓ рдкреАрдмреАрдПрдХреНрд╕ рдмреАрд▓рд╛рдЗрдиред рдореИрдиреЗрдЬрд░ рдЖрдкрдХреЛ рдХреНрдпрд╛ рдирд╣реАрдВ рдмрддрд╛рдПрдЧрд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>