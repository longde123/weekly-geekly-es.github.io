<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêâ üë®üèæ‚Äçüî¨ üî¶ Elevar IDS / NMS: Mikrotik y Suricata con una interfaz web üöµ üê± üßñüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aparentemente, tengo tal karma: no importa c√≥mo emprenda la implementaci√≥n de alg√∫n servicio en un c√≥digo abierto, definitivamente encontrar√© un mont√≥...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Elevar IDS / NMS: Mikrotik y Suricata con una interfaz web</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431600/">  Aparentemente, tengo tal karma: no importa c√≥mo emprenda la implementaci√≥n de alg√∫n servicio en un c√≥digo abierto, definitivamente encontrar√© un mont√≥n de manuales, cada uno de los cuales en mi caso particular no funcionar√°, la soluci√≥n ya preparada no se iniciar√° o me gustar√°, ¬øqu√© m√°s suceder√°? -Nunca digestibilidad, y al final tienes que atravesar el resultado t√∫ mismo. <br><br>  Esta vez, todos los manuales estaban en ELK5 o incluso anteriores, pero realmente no quer√≠a instalar el software de las versiones anteriores.  Quer√≠a tomar el software con los per√≠odos de soporte m√°s prometedores: preferiblemente el m√°s reciente desde el establo. <br><br>  Como resultado, para poder repetir la haza√±a perfecta sin repetir todo el tormento en el futuro, debe escribir hojas de trucos paso a paso que comparta con usted. <br><br>  As√≠ que hoy Mikrotik (RouterOS), Suricata 4.1, Elasticsearch + Filebeat + Kibana 6.5. <br><a name="habracut"></a><br><h3>  En lugar de unirse </h3><br>  T√©rminos: <br><br><ul><li> Mikrotik en i386 en una m√°quina virtual en el host A. Todas las interfaces en Mikrotik est√°n dispersas en VLAN, el host tiene una interfaz de red f√≠sica. </li><li>  Recursos gratuitos para IDS / IPS / NMS en el host B con una √∫nica interfaz de red f√≠sica. </li><li>  Salida de canal de 20 megabytes. </li><li>  El deseo de recibir an√°lisis sobre el tr√°fico que pasa a trav√©s de la interfaz externa de Mikrotik. </li><li>  El presupuesto en el r√°bano picante rublos y kopecks FIG. </li><li>  Una cierta cantidad de tiempo libre sin problemas. </li></ul><br>  No hablar√© aqu√≠ sobre qu√© es IDS / IPS / NMS, por qu√© es necesario y qu√© sucede.  Todo el mundo sabe esto sin m√≠, y el que no sabe, googlear√°. <br><br>  Adem√°s, no justificar√© mi elecci√≥n entre Snort y Suricata a favor de este √∫ltimo.  Esto es cuesti√≥n de gustos. <br><br>  Pero explica superficialmente c√≥mo funciona: <br><br>  Suricata de alguna manera recibe tr√°fico.  Hay tres opciones: a) pasarlo por usted mismo en modo en l√≠nea, b) recibir una copia del tr√°fico desde el puerto del conmutador yc) analizar los volcados con tr√°fico.  Suricata analiza el tr√°fico recibido y, bas√°ndose en el an√°lisis, proporciona datos sobre lo que encontr√≥ all√≠ en este tr√°fico. <br><br>  Suricata puede emitir datos en JSON.  En consecuencia, al tener datos estructurados, se pueden alimentar a alg√∫n sistema para su procesamiento, sistematizaci√≥n, an√°lisis y visualizaci√≥n. <br>  Para el an√°lisis y la visualizaci√≥n de datos, hasta donde yo entiendo, sin ser un especialista en este campo, la pila ELK es perfecta.  La pila ELK originalmente consist√≠a en Elasticsearch, Logstash, Kibana.  Ahora se le ha agregado Beat (una familia de programas de interfaz que act√∫an como intermediarios entre la fuente de datos y Logstash o Elasticsearch).  Mirando hacia el futuro, dir√© que no hubo Logstash, porque Beat alimenta perfectamente los datos directamente a Elasticsearch, y Elasticsearch los come perfectamente.  Elasticsearch transfiere los datos mordidos a Kibana, la interfaz web para toda la pila de ELK.  Kibana, usando las plantillas que Filebeat le pas√≥, le proporciona al usuario la visualizaci√≥n de datos, los llamados Dashboards.  Teniendo en cuenta el hecho de que Elasticsearch, Logstash, Beat y Kibana son el fruto del trabajo de un fabricante, toda esta granja est√° bien vinculada entre s√≠ y el proceso de vinculaci√≥n est√° bien documentado (por supuesto, seg√∫n los est√°ndares de c√≥digo abierto). <br><br>  Por lo tanto, seg√∫n lo anterior, la tarea se puede describir de la siguiente manera: obtener una copia del tr√°fico desde el puerto del enrutador, transferirla a Suricata, recibir datos en formato JSON desde Suricata, transferirla a Filebeat, para que, a su vez, los transfiera a Elasticsearch y ayud√≥ a Kibana a crear su pantalla visual. <br><br><h3>  Mikrotik RouterOS </h3><br>  Si tuviera un hardware de enrutador Mikrotik, entonces el problema de la duplicaci√≥n de puertos (duplicaci√≥n de puertos) no ser√≠a en absoluto.  Todo se decidir√° habilitando la duplicaci√≥n del tr√°fico que pasa a trav√©s de la interfaz externa a cualquier puerto libre de Mikrotik.  Si no hubiera un puerto libre en Mikrotik, podr√≠a habilitar la duplicaci√≥n de puertos en el conmutador.  Pero en mi caso, Mikrotik no ten√≠a puertos f√≠sicos en absoluto, y el puerto en el conmutador recibi√≥ tr√°fico de todo el host, en el que, adem√°s de Mikrotik, hab√≠a varias m√°quinas virtuales m√°s. <br><br>  Y luego, una vez m√°s, dije mentalmente: "¬°Gracias, Mikrotik!".  Gracias por el sniffer incorporado en RouterOS.  Por tradici√≥n, no tenemos capturas de pantalla, solo comandos de consola. <br><br>  Abra la terminal en WinBox y encienda el sniffer: <br><br> <code>/tool sniffer set filter-interface=if-out filter-stream=yes streaming-enabled=yes streaming-server=192.168.1.253 <br> /tool sniffer start</code> <br> <br>  Indique en lugar de <i>if-out el</i> nombre de la interfaz desde la que planea interceptar el tr√°fico y, en lugar de <i>192.168.1.253</i> , la direcci√≥n IP de la m√°quina donde se enviar√° el tr√°fico interceptado a trav√©s de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">TZSP</a> . <br><br>  Con Mikrotik'om todos. <br><br><h3>  Suricata </h3><br>  En general, no soy muy cabeza de Linux, as√≠ que sobre todo me gustan las distribuciones pop.  Bueno, tal vez me gusta el Debian m√°s asc√©tico.  Entonces empec√© con eso.  Bueno, y por supuesto, debido a la no cabecera de Linux, tambi√©n quer√≠a instalar binarios desde el repositorio.  La asamblea siempre es perezosa para m√≠.  Entonces, si ser√° posible elegir Debian, - <u>no elija</u> .  Ahora no recuerdo en qu√© lugar tuve la mordaza al instalar toda la granja bajo Debian, pero √©l estaba.  Y toda la historia posterior sobre la instalaci√≥n de todo bajo Ubunta. <br><br>  Se cre√≥ una m√°quina virtual de 4 n√∫cleos con 4 gigas de RAM, <a href="">se</a> descarg√≥ e instal√≥ <a href="">Ubuntu Server 18.04.1 LTS (x64)</a> <br><br><blockquote>  <b>Acuerdo</b> : todas las acciones adicionales se realizan en nombre del superusuario, por lo tanto, inicie sesi√≥n como root o agregue <i>sudo</i> a cada comando. </blockquote><br>  Como en cada etapa hice instant√°neas, y luego volv√≠ a ellas repetidamente, al final encend√≠ muchos problemas t√©cnicos con un tiempo fuera de sincronizaci√≥n en una m√°quina virtual con tiempo real. <br>  Por lo tanto, establecemos inmediatamente la zona horaria correcta y la sincronizaci√≥n NTP: <br><br> <code>systemctl start systemd-timesyncd <br> systemctl status systemd-timesyncd <br> dpkg-reconfigure tzdata</code> <br> <br>  Para asegurarse de que no haya problemas de dependencia al instalar Suricata, agregue los repositorios de <i>universo</i> a <i><b>/etc/apt/sources.list</b></i> : <br><br> <code>nano /etc/apt/sources.list</code> <br> <blockquote>  ... <br>  deb <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">archive.ubuntu.com/ubuntu</a> bionic main universe <br>  deb <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">archive.ubuntu.com/ubuntu</a> bionic-security main universe <br>  deb <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">archive.ubuntu.com/ubuntu</a> bionic-updates main universe </blockquote><br>  Tambi√©n agregamos el repositorio, donde obtendremos Suricata: <br> <code>add-apt-repository ppa:oisf/suricata-stable</code> <br> <br>  Actualizaci√≥n de la base de datos del paquete: <br> <code>apt-get update</code> <br> <br>  Instalar Suricata: <br> <code>apt-get install -y suricata</code> <br> <br>  El siguiente paso es establecer las reglas para Suricata y su actualizaci√≥n: <br> <code>apt-get install -y python-pip <br> pip install pyyaml <br> pip install https://github.com/OISF/suricata-update/archive/master.zip</code> <br> <br>  Comenzamos la actualizaci√≥n de <i>Suricata-Update en s√≠</i> : <br> <code>pip install --pre --upgrade suricata-update</code> <br> <br>  Ejecutar sin configuraci√≥n adicional nos dar√° un conjunto de reglas abierto de amenazas emergentes: <br> <code>suricata-update</code> <br> <br>  Para ver la lista de fuentes, haga: <br> <code>suricata-update list-sources</code> <br> <br>  Actualizaci√≥n de las fuentes de reglas: <br> <code>suricata-update update-sources</code> <br> <br>  Veamos qu√© se actualiz√≥ all√≠ en las fuentes, vuelva a ejecutarlo: <br> <code>suricata-update list-sources</code> <br> <br>  Incluimos todas las fuentes gratuitas: <br> <code>suricata-update enable-source ptresearch/attackdetection <br> suricata-update enable-source oisf/trafficid <br> suricata-update enable-source sslbl/ssl-fp-blacklist</code> <br> <br>  Y nuevamente actualizamos las reglas: <br> <code>suricata-update</code> <br> <br>  Suricata est√° instalado. <br><br>  Ahora necesitas obtener tr√°fico. <br><br><h3>  Trafr </h3><br>  Trafr es una aplicaci√≥n escrita por Mikrotik para convertir el tr√°fico TZSP a pcap.  La aplicaci√≥n es de 32 bits, por lo que para iniciarla deber√° habilitar la compatibilidad con aplicaciones de 32 bits en Ubunta de 64 bits: <br><br> <code>dpkg --add-architecture i386 <br> apt-get update &amp;&amp; apt-get install -y libc6:i386</code> <br> <br>  Descargue y descomprima el <i><b>tr√°fr</b></i> : <br><br> <code>wget http://www.mikrotik.com/download/trafr.tgz <br> tar xzf trafr.tgz</code> <br> <br>  Verifique que el tr√°fico est√© siendo atrapado: <br><br> <code>./trafr -s</code> <br> <br>  Despu√©s de tal lanzamiento, la salida simb√≥lica en el modo gr√°fico se rompi√≥ en la consola de la m√°quina virtual, tuve que reiniciar.  No hubo problemas para conectarse de forma remota a trav√©s de ssh a PuTTY. <br><br>  Si ve parpadeos err√°ticos en la pantalla, llega el tr√°fico y el <i><b>tr√°fico lo</b></i> atrapa.  Si es as√≠, transfiera el <i><b>tr√°fico</b></i> a la residencia permanente y ejec√∫telo con la transmisi√≥n del tr√°fico atrapado a trav√©s de la tuber√≠a de inmediato a Suricata: <br><br> <code>mv trafr /usr/local/bin/ <br> /usr/local/bin/trafr -s | suricata -c /etc/suricata/suricata.yaml -r /dev/stdin <br></code> <br><br>  Ahora verificamos que el tr√°fico llega a Suricata, para esto hacemos lo siguiente en la terminal vecina: <br><br> <code>tail -f /var/log/suricata/fast.log</code> <br> <br>  Deber√≠a ver un desplazamiento inteligente de un texto significativo: un registro de recepci√≥n de tr√°fico de suricatas. <br><br>  Tampoco estar√° mal asegurarse de que el tr√°fico de Suricata no solo reciba, sino que tambi√©n analice: <br><br> <code>tail -f /var/log/suricata/eve.json</code> <br> <br>  Esta es exactamente la salida de eventos de Suricata en el formato JSON que alimentaremos a Filebeat. <br><br><h3>  Elasticsearch + Filebeat + Kibana 6.5 </h3><br>  Instalamos la clave PGP necesaria para usar el repositorio Elastic e instalamos las dependencias necesarias: <br><br> <code>wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add - <br> echo "deb https://artifacts.elastic.co/packages/6.x/apt stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-6.x.list <br> apt-get update &amp;&amp; apt-get install -y openjdk-8-jre apt-transport-https wget nginx</code> <br> <br>  Tenga en cuenta que Java es la versi√≥n 8. Cualquier cosa por encima de 8 no es compatible.  Por lo tanto, si logr√≥ instalar un Java m√°s reciente anteriormente, dem√≥relo y coloque 8. <br><br>  Nos aseguramos de que Java est√© instalado como deber√≠a: <br><br> <code>java -version</code> <br> <br>  Obtenemos aproximadamente la siguiente conclusi√≥n: <br><blockquote>  versi√≥n de Java "1.8.0_191" <br>  Java (TM) SE Runtime Environment (compilaci√≥n 1.8.0_191-b12) <br>  VM de servidor de 64 bits Java HotSpot (TM) (compilaci√≥n 25.191-b12, modo mixto) </blockquote><br>  Cree un usuario y una contrase√±a para acceder a Kibana.  En lugar de <i>administrador,</i> elija algo que prefiera: <br><br> <code>echo "admin:`openssl passwd -apr1`" | sudo tee -a /etc/nginx/htpasswd.users</code> <br> <br>  Como el ELK girar√° en localhost, configure el proxy inverso en nginx: <br><br> <code>nano /etc/nginx/sites-available/kibana</code> <br> <blockquote>  servidor { <br>  escucha 80; <br><br>  nombre_servidor suricata.server; <br><br>  auth_basic "Acceso restringido"; <br>  auth_basic_user_file /etc/nginx/htpasswd.users; <br><br>  ubicaci√≥n / { <br>  proxy_pass <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> : 5601; <br>  proxy_http_version 1.1; <br>  proxy_set_header Upgrade $ http_upgrade; <br>  proxy_set_header Conexi√≥n 'actualizar'; <br>  proxy_set_header Host $ host; <br>  proxy_cache_bypass $ http_upgrade; <br>  } <br>  } </blockquote><br> <code>rm /etc/nginx/sites-enabled/default <br> ln -s /etc/nginx/sites-available/kibana /etc/nginx/sites-enabled/kibana <br></code> <br><br>  Reinicie nginx: <br><br> <code>systemctl restart nginx</code> <br> <br>  Ponemos Elasticsearch: <br><br> <code>apt-get install -y elasticsearch</code> <br> <br>  Active la ejecuci√≥n autom√°tica al cargar el sistema operativo: <br><br> <code>systemctl daemon-reload <br> systemctl enable elasticsearch.service</code> <br> <br>  Lanzamos: <br><br> <code>systemctl start elasticsearch.service</code> <br> <br>  Compruebe si ha aumentado: <br><br> <code>curl -X GET "localhost:9200/"</code> <br> <br>  Dependiendo del rendimiento de su pieza de hardware, iniciar ES puede tomar alg√∫n tiempo.  Si se <i>rechaza la conexi√≥n</i> , simplemente repita la solicitud y espere hasta obtener algo como: <br><blockquote>  { <br>  "Nombre": "lcZuxxm", <br>  "Cluster_name": "elasticsearch", <br>  "Cluster_uuid": "kmJHqJnlQe2Rk7F-CRi4EA", <br>  "Versi√≥n": { <br>  "N√∫mero": "6.5.1", <br>  "Build_flavor": "predeterminado", <br>  "Build_type": "deb", <br>  "Build_hash": "8c58350", <br>  "Build_date": "2018-11-16T02: 22: 42.182257Z", <br>  "Build_snapshot": falso, <br>  "Lucene_version": "7.5.0", <br>  "Minimum_wire_compatibility_version": "5.6.0", <br>  "M√≠nimo_index_compatibility_version": "5.0.0" <br>  }, <br>  Lema: Ya sabes, para la b√∫squeda <br>  } </blockquote><br>  Ponemos a Kibana: <br><br> <code>apt-get install -y kibana</code> <br> <br>  Active la ejecuci√≥n autom√°tica al cargar el sistema operativo: <br><br> <code>systemctl daemon-reload <br> systemctl enable kibana.service</code> <br> <br>  Lanzamos: <br><br> <code>systemctl start kibana.service</code> <br> <br>  Ahora puede ir a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">192.168.1.253</a> (por supuesto, la direcci√≥n IP es la que se asign√≥ a su m√°quina con un suricato).  La portada de Kibana deber√≠a abrirse. <br><br>  Ponemos Filebeat: <br><br> <code>apt-get install -y filebeat</code> <br> <br>  Active la ejecuci√≥n autom√°tica al cargar el sistema operativo: <br><br> <code>systemctl daemon-reload <br> systemctl enable filebeat</code> <br> <br>  Activamos el m√≥dulo Suricata, que forma parte del conjunto de m√≥dulos Filebeat: <br><br> <code>filebeat modules enable suricata</code> <br> <br>  Instalar complementos para Suricata en Elasticsearch: <br><br> <code><s>/usr/share/elasticsearch/bin/elasticsearch-plugin install ingest-geoip <br> /usr/share/elasticsearch/bin/elasticsearch-plugin install ingest-user-agent</s></code> <br>  <b>Ver UPD 22 de mayo de 2019.</b> <br><br>  Reiniciar Elasticsearch: <br><br> <code>systemctl restart elasticsearch.service</code> <br> <br>  Realizamos la configuraci√≥n inicial de Filebeat, al mismo tiempo que cargamos plantillas en Kibana: <br><br> <code>filebeat setup -e</code> <br> <br>  Verificamos que Filebeat haya encontrado <i>/var/log/suricata/eve.json</i> y lo est√© procesando. Para ello, ejecute Filebeat en el modo de salida de datos con el marcador de <i>publicaci√≥n</i> : <br><br> <code>filebeat -e -d "publish"</code> <br> <br>  El primero es la salida con formato json de Filebeat, luego la salida de texto simple de sus registros, y solo despu√©s de un tiempo la salida de Suricata, as√≠ que espere y aseg√∫rese de que todo funcione.  Despu√©s de eso, aborta Filebeat y vuelve a bash. <br><br>  Active la ejecuci√≥n autom√°tica al cargar el sistema operativo: <br><br> <code>systemctl daemon-reload <br> systemctl enable filebeat.service</code> <br> <br>  Ejecute Filebeat: <br><br> <code>systemctl start filebeat.service</code> <br> <br>  Vaya a Kibana, seleccione Panel de control en el men√∫ de la izquierda, seleccione <i><b>filebeat- *</b></i> index.  Seleccione Panel de control nuevamente, seleccione <b>[Suricata] Descripci√≥n general de alertas</b> de la lista, y deber√≠a obtener algo como esto: <br><br><img src="https://habrastorage.org/webt/tb/5v/st/tb5vsthdvuyveyetcbba1p_asts.png" alt="imagen"><br><br><h3>  Opcional </h3><br>  No olvide iniciar sesi√≥n, y no importa cu√°n grande sea el disco duro, Suricata lo puntuar√° muy r√°pidamente: <br><br> <code>nano /etc/logrotate.d/suricata</code> <br> <blockquote>  /var/log/suricata/*.log /var/log/suricata/*.json <br>  { <br>  semanalmente <br>  rotar 3 <br>  missingok <br>  no comprimir <br>  crear <br>  guiones compartidos <br>  postrotar <br>  / bin / kill -HUP `cat /var/run/suricata.pid 2&gt; / dev / null` 2&gt; / dev / null ||  cierto <br>  escritura final <br>  } <br></blockquote><br>  Adem√°s, hab√≠a rumores de que alguien regularmente olfatea en Mikrotik con el estado de <i>ejecuci√≥n</i> deja de dar tr√°fico.  Luego escribimos un script para reiniciar el sniffer y ejecutarlo de acuerdo con la programaci√≥n: <br><br> <code>/tool sniffer stop <br> :delay 30s <br> /tool sniffer start</code> <br> <br><h3>  Conclusi√≥n </h3><br>  Francamente, no estoy muy satisfecho con la estabilidad del paquete anterior.  A saber: vale la pena reiniciar, y comienzan los milagros.  Una vez, todo excepto una pareja dej√≥ de procesar mis reglas.  Tuve que reinstalar todo.  La segunda vez, Elasticsearch generalmente dej√≥ de recibir datos de Filebeat y tuvo que retroceder a la instant√°nea del estado antes de reiniciar. <br><br>  Todav√≠a no he resuelto estos problemas. <br><br>  Adem√°s, hay planes para implementar IPS en funci√≥n de las direcciones IP de los villanos identificados por Suricata transferidos a Mikrotik. <br><br>  <b>UPD</b> : se descartan las acusaciones de inestabilidad.  Mi conclusi√≥n sobre la finalizaci√≥n del procesamiento de reglas fue err√≥nea.  De hecho, la raz√≥n del vac√≠o en el Tablero despu√©s del reinicio se debe al hecho de que Filebeat y Elasticsearch necesitan un tiempo muy notable para analizar un archivo json de varios gigabytes de Meerkat.  Si abre el Panel con eventos durante un per√≠odo que incluye la fecha en que se <i>cre√≥ el</i> archivo <i>eve.json</i> , puede ver c√≥mo crecen las columnas del gr√°fico a medida que se procesa el archivo.  Junto con los eventos procesados, las alertas aparecen en el Tablero correspondiente.  Adem√°s, el sniffer en RouterOS en x86 nunca se colg√≥. <br><br>  <b>UPD 22 de mayo de 2019</b> : a partir de la versi√≥n Elasticsearch 6.7, los complementos ingest-geoip e ingest-user-agent se han convertido en m√≥dulos.  En consecuencia, se omite el elemento con su instalaci√≥n. <br><br>  Adem√°s, al actualizar, aparece un error de inicio de Elasticsearch.  Ver√° un error en los registros: <br><br><blockquote>  la base de datos esperada [GeoLite2-ASN.mmdb] no existe en [/ etc / elasticsearch / ingest-geoip] </blockquote><br>  Para restaurar el rendimiento, realizamos: <br><br> <code>/usr/share/elasticsearch/bin/elasticsearch-plugin remove --purge ingest-geoip <br></code> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es431600/">https://habr.com/ru/post/es431600/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es431586/index.html">C√≥mo manejar los errores en la JVM m√°s r√°pido</a></li>
<li><a href="../es431588/index.html">Ley de autoempleo. Informaci√≥n para consideraci√≥n</a></li>
<li><a href="../es431590/index.html">La modernizaci√≥n de los parques e√≥licos obsoletos del Reino Unido aumentar√° la generaci√≥n de energ√≠a en un 171%</a></li>
<li><a href="../es431596/index.html">Veeam Backup y prueba de carga de replicaci√≥n</a></li>
<li><a href="../es431598/index.html">Traemos a Internet una m√°quina virtual QEMU p√∫blica sin una tarjeta de red e intentamos extraer</a></li>
<li><a href="../es431602/index.html">Desarrolladores rusos presentaron en Londres un sistema de rehabilitaci√≥n virtual</a></li>
<li><a href="../es431604/index.html">Localizaci√≥n en Go con paquetes b√°sicos</a></li>
<li><a href="../es431608/index.html">La empresa estadounidense DriveSavers es la primera en el mundo en lanzar el servicio de pirateo de iPhone para particulares</a></li>
<li><a href="../es431610/index.html">Project Manager Lifehacks</a></li>
<li><a href="../es431612/index.html">Caja musical y codificador giratorio en placa FPGA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>