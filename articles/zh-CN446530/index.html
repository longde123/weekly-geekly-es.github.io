<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📀 👇🏽 🧑🏼‍🤝‍🧑🏼 图片中的Word2vec 🍛 📖 💇🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="“ 每件事都掩盖了宇宙的一部分。 它具有对称性，优雅性和美感 -捕捉世界的任何真正的艺术家首先要掌握的特质。 这种模式可以捕捉到季节的变化，沙子如何沿着斜坡流动，杂酚丛丛的缠结分支，叶子的模式。 

 我们正试图在我们的生活和社会中复制这种模式，因此，我们热爱节奏，歌曲，舞蹈和各种使我们快乐并安慰我...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>图片中的Word2vec</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446530/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/85d/ad8/627/85dad8627ae6845b62f5bb965c291b19.png"></div><br><br><blockquote>  <font color="gray">“ <b>每件事都掩盖了宇宙的一部分。</b></font>  <font color="gray"><b>它具有对称性，优雅性和美感</b> -捕捉世界的任何真正的艺术家首先要掌握的特质。</font>  <font color="gray">这种模式可以捕捉到季节的变化，沙子如何沿着斜坡流动，杂酚丛丛的缠结分支，叶子的模式。</font> <font color="gray"><br><br></font>  <font color="gray">我们正试图在我们的生活和社会中复制这种模式，因此，我们热爱节奏，歌曲，舞蹈和各种使我们快乐并安慰我们的形式。</font>  <font color="gray">但是，人们也可以看出寻求绝对完美的潜伏危险，因为显而易见，完美模式是不变的。</font>  <font color="gray">而且，接近完美，万物都会死亡” <i>-Dune</i> （1965）</font> </blockquote><br> 我相信嵌入概念是机器学习中最杰出的想法之一。 如果您曾经使用过Siri，Google Assistant，Alexa，Google Translate甚至是智能手机键盘来预测下一个单词，那么您已经在使用基于附件的自然语言处理模型。 在过去的几十年中，该概念已在神经模型中得到了巨大的发展（最近的发展包括在高级模型（例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BERT</a>和GPT2）中的上下文化词嵌入）。 <br><a name="habracut"></a><br>  Word2vec是2013年开发的一种有效的投资创建方法。 除了使用单词，他的一些概念甚至在商业，非语言任务中也可以有效地开发推荐机制并为数据赋予意义。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Airbnb</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">阿里巴巴</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Spotify</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Anghami等公司已</a>在其推荐引擎中使用了此技术。 <br><br> 在本文中，我们将研究使用word2vec生成附件的概念和机制。 让我们从一个示例开始，以熟悉如何以矢量形式表示对象。 您知道五个数字（向量）列表可以说明您的个性吗？ <br><br><h1> 个性化：你是什么？ </h1><br><blockquote>  <font color="gray">“我给你沙漠变色龙；</font>  <font color="gray">他与沙子融为一体的能力将告诉您所有您需要了解的有关生态学根源以及保护您个性的原因。”</font>  <font color="gray">- <i>沙丘之子</i></font> </blockquote><br> 从0到100的等级，您是否有内向型或外向型的人格（其中0是最内向的类型，100是最外向的类型）？ 您是否通过过性格测试：例如MBTI，还是更好<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的五巨头</a> ？ 系统会向您提供问题列表，然后在多个轴上进行评估，包括内向/外向。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/79f/11e/e22/79f11ee220ebf9d6f52f51a5b780b090.png"></div><br>  <i><font color="gray">五大测试结果示例。</font></i>  <i><font color="gray">他确实讲了很多关于个性的文章，并且能够预测<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">学术</a> ， <a href="">个人</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">职业的成功</a> 。</font></i>  <i><font color="gray">例如，您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在这里</a>进行检查。</font></i> <br><br> 假设我在评估内向性/外向性方面得分100分38分。 可以表示如下： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e56/729/35d/e5672935d7de17d41e78354d3742e6bc.png"></div><br><br> 或范围为-1到+1： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b39/e23/ce1/b39e23ce1c036b11763e3c45c3659a3e.png"></div><br><br> 仅凭此评估我们如何识别一个人？ 不完全是 人类是复杂的生物。 因此，我们增加了一个维度：测试的另一个特征。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2aa/ab2/ebc/2aaab2ebc1ff30f1fd832e5cf5bf9cb1.png"></div><br>  <i><font color="gray">您可以将这两个维度想象为图形上的一个点，或者甚至更好地想象为从原点到此点的向量。</font></i>  <i><font color="gray">有很多很棒的矢量工具很快就会派上用场。</font></i> <br><br> 我没有显示我们在图表上显示的哪些人格特质，这样您就不会迷恋特定的特质，但会立即了解一个人的整体性格的向量表现形式。 <br><br> 现在我们可以说这个向量部分反映了我的个性。 当比较不同的人时，这是一个有用的描述。 假设我被一辆红色大巴撞到了，您需要用一个类似的人代替我。 下图中的两个人中哪个更像我？ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/de5/380/b84/de5380b84dc9fec4bb8b52ebe6519e15.png"></div><br><br> 使用向量时，通常通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Otiai系数</a> （几何系数）计算相似度： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/640/e59/7dd/640e597dd741a28bcec986454633e31d.png"></div><br>  <i><font color="green">1号</font> <font color="gray">人物更像我。</font></i>  <i><font color="gray">一个方向上的向量（长度也很重要）给出较大的Otiai系数</font></i> <br><br> 同样，两个维度不足以评估人员。 几十年来心理学的发展导致了对五个基本人格特征（还有许多其他人格特征）的测试的产生。 因此，让我们使用所有五个维度： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df5/3ae/d7b/df53aed7b1e439561a01e69b3f765487.png"></div><br><br> 这五个尺寸的问题在于，将不再可能在2D中绘制整齐的箭头。 这是机器学习中的一个常见问题，您通常必须在多维空间中工作。 几何系数可以用于任何数量的测量是很好的： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/521/ab3/bf1/521ab3bf1374c5b37115441b7c2d27cc.png"></div><br>  <i><font color="gray">几何系数适用于任何数量的测量。</font></i>  <i><font color="gray">在五个维度上，结果要准确得多。</font></i> <br><br> 在本章的最后，我想重复两个主要思想： <br><br><ol><li> 人（和其他对象）可以表示为数字矢量（这对汽车非常有用！）。 <br></li><li> 我们可以轻松地计算出向量的相似程度。 </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/195/73d/16d/19573d16de1150ac1874640c79e0b381.png"></div><br><br><h1> 词嵌入 </h1><br><blockquote>  <font color="gray">“言语的礼物就是欺骗和幻想的礼物。”</font>  <font color="gray">- <i>沙丘之子</i></font> </blockquote><br> 基于这种理解，我们将继续学习通过训练获得的单词的矢量表示形式（它们也称为附件），并研究它们的有趣特性。 <br><br> 这是单词“ king”（GloVe矢量，在Wikipedia上受训）的附件： <br><br> <code>[ 0.50451 , 0.68607 , -0.59517 , -0.022801, 0.60046 , -0.13498 , -0.08813 , 0.47377 , -0.61798 , -0.31012 , -0.076666, 1.493 , -0.034189, -0.98173 , 0.68229 , 0.81722 , -0.51874 , -0.31503 , -0.55809 , 0.66421 , 0.1961 , -0.13495 , -0.11476 , -0.30344 , 0.41177 , -2.223 , -1.0756 , -1.0783 , -0.34354 , 0.33505 , 1.9927 , -0.04234 , -0.64319 , 0.71125 , 0.49159 , 0.16754 , 0.34344 , -0.25663 , -0.8523 , 0.1661 , 0.40102 , 1.1685 , -1.0137 , -0.21585 , -0.15155 , 0.78321 , -0.91241 , -1.6106 , -0.64426 , -0.51042 ]</code> <br> <br> 我们看到一个由50个数字组成的列表，但是很难说些什么。 让我们可视化它们以与其他向量进行比较。 将数字放在一行中： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/516/c90/5ac/516c905ac831fe8688db73f0a63d325b.png"></div><br><br> 通过其值对单元格着色（红色代表接近2，白色代表接近0，蓝色代表接近-2）： <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/46f/7cb/1d5/46f7cb1d5adc32bd16368b2681ab26a4.png"></a> </div><br><br> 现在忘记数字，仅通过颜色我们将“国王”与其他词进行对比： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c8/6b2/909/1c86b290963e8a42b375cb6a71245185.png"></div><br><br> 您看到“男人”和“女人”彼此之间的距离比与“国王”之间的距离更近吗？ 它说了些什么。 向量表示捕获了这些单词的很多信息/含义/关联。 <br><br> 这是另一个示例列表（比较具有相似颜色的列）： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d61/30b/d45/d6130bd4502710631a8c812923230f47.png"></div><br><br> 有几件事要注意： <br><br><ol><li> 在所有的单词中都有一个红色的列。 也就是说，这些单词在这个特定维度上是相似的（并且我们不知道其中编码的是什么）。 <br></li><li> 您可以看到“女人”和“女孩”非常相似。  “男人”和“男孩”也是一样。 <br></li><li>  “男孩”和“女孩”在某些方面也相似，但不同于“女人”和“男人”。 难道这是一个编码模糊的青年观念？ 大概吧 <br></li><li> 除了硬道理之外，其他所有东西都是人们的想法。 我添加了一个对象（水）以显示类别之间的差异。 例如，您可以看到蓝色的列如何下降并停在水矢量的前面。 <br></li><li> 在清晰的尺寸中，“国王”和“女王”彼此相似，而彼此不同。 也许在这里编码了模糊的版税概念？ </li></ol><br><h1> 类比 </h1><br><blockquote>  <font color="gray">言语承受着我们希望的任何负担。</font>  <font color="gray">所需要做的只是达成一项关于传统的协议，据此我们可以建立概念。”</font>  <font color="gray">- <i>沙丘皇帝</i></font> </blockquote><br> 类比的概念是表明投资具有令人难以置信的特性的著名例子。 我们可以添加和减去单词向量，得到有趣的结果。 最著名的例子是“国王-男人+女人”： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c23/71f/ead/c2371feadc58f2f2a1236c94b6b05eff.png"></div><br>  <i><font color="gray">使用python中的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Gensim</a>库，我们可以添加和减去单词向量，并且该库将找到最接近结果向量的单词。</font></i>  <i><font color="gray">该图显示了最相似的单词的列表，每个单词的几何相似度系数</font></i> <br><br> 我们像以前一样可视化此类比： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a19/84b/fea/a1984bfeab5a597c6fb6300f7d694901.png"></div><br>  <i><font color="gray">通过计算“国王–男人+女人”得出的向量并不完全等于“女王”，但这是数据集中40万个单词附件的最接近结果</font></i> <br><br> 在考虑单词的附件之后，让我们学习学习是如何发生的。 但是在继续学习word2vec之前，您需要看一下词嵌入的概念祖先：一种神经语言模型。 <br><br><h1> 语言模型 </h1><br><blockquote>  <font color="gray">“先知不受制于过去，现在或未来的幻想。</font>  <font color="gray"><b>语言形式的固定性决定了这种线性差异。</b></font>  <font color="gray">先知握住了锁舌的钥匙。</font>  <font color="gray">对于他们来说，物理图像仅保留为物理图像，仅此而已。</font> <font color="gray"><br><br></font>  <font color="gray">他们的宇宙不具有机械宇宙的性质。</font>  <font color="gray">观察者假设事件是线性的。</font>  <font color="gray">因果？</font>  <font color="gray">这是完全不同的事情。</font>  <font color="gray">先知说了几句话。</font>  <font color="gray">您会看到应该根据事物的逻辑发生的事件。</font>  <font color="gray">但是先知立即释放出无限奇迹般的力量。</font>  <font color="gray">宇宙正在发生精神上的转变。”</font>  <font color="gray">- <i>沙丘皇帝</i></font> </blockquote><br>  NLP（自然语言处理）的一个示例是智能手机键盘上下一个单词的预测功能。 数十亿人每天使用数百次。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ca4/d48/a13/ca4d48a133d58fe3c4c11e0933ea218e.png"></div><br><br> 对于<i>语言模型来说，</i>预测下一个单词是一项适当的任务。 她可以列出一个单词列表（例如两个单词），并尝试预测以下内容。 <br><br> 在上面的屏幕截图中，模型使用了这两个绿色的单词（您应为），并返回了一个选项列表（最有可能的单词<code>not</code> ）： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5a7/0fc/492/5a70fc49208b501202ed188f24ad1f2c.png"></div><br><br> 我们可以将模型想象成一个黑匣子： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/164/72f/a83/16472fa83e5eadf58f4bb05b50075654.png"></div><br><br> 但实际上，该模型会产生多个单词。 它可以得出几乎所有已知单词的概率估计（模型的“词典”从几千个单词到一百万个单词不等）。 然后，键盘应用程序会找到得分最高的单词并将其显示给用户。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7a7/eda/ad6/7a7edaad67dd51240d90426de0b198c2.png"></div><br>  <i><font color="gray">神经语言模型给出所有已知单词的概率。</font></i>  <i><font color="gray">我们用百分比表示概率，但是在所得向量中40％将表示为0.4</font></i> <br><br> 训练后，第一个神经模型（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Bengio 2003</a> ）分三个阶段计算了预后： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/27b/082/4f8/27b0824f81962e2863d6d4dcccabfdd2.png"></div><br><br> 在讨论投资时，对我们来说第一步是最相关的。 训练的结果是，创建了一个矩阵，其中包含词典中所有单词的附件。 为了获得结果，我们只需查找输入单词的嵌入并运行预测： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d1/34b/5ac/1d134b5ac32406ea363944887ce5fc53.png"></div><br><br> 现在，让我们看一下学习过程，找出如何创建这种投资矩阵。 <br><br><h1> 语言模型训练 </h1><br><blockquote>  <font color="gray">“无法通过结束过程来理解该过程。</font>  <font color="gray">理解必须与流程一起前进，与流程融为一体，与流程融为一体”- <i>沙丘</i></font> </blockquote><br> 语言模型相对于大多数其他机器学习模型具有巨大的优势：可以在我们拥有的大量文本上对其进行训练。 考虑一下我们拥有的所有书籍，文章，维基百科资料和其他形式的文本数据。 与需要人工和专门收集的数据的其他机器学习模型进行比较。 <br><br><blockquote>  <b>“您必须在他的陪伴下学习这个词”-J. R. Furs</b> </blockquote><br> 单词的附件是根据周围的单词计算的，周围的单词通常出现在附近。 机制如下： <br><br><ol><li> 我们获得了大量文本数据（例如，所有Wikipedia文章） <br></li><li> 设置一个在整个文本中滑动的窗口（例如，三个单词）。 <br></li><li> 滑动窗口会生成用于训练模型的模式。 </li></ol><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a31/fc4/626/a31fc4626de165a21c2c91844b21e7ab.png"></div><br><br> 当该窗口滑过文本时，我们（实际上）会生成一个数据集，然后将其用于训练模型。 为了理解，让我们看看滑动窗口如何处理此短语： <br><br><blockquote>  <b>“愿您不要制造具有人类思维相似性的机器” <i>-Dune</i></b> </blockquote><br> 当我们开始时，窗口位于句子的前三个单词上： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/81c/c51/a04/81cc51a0478e1655c8f3f85641cf1e4e.png"></div><br><br> 我们将前两个单词用作符号，将第三个单词用作标签： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/097/981/086/0979810868ca398fdcad3066294055f5.png"></div><br>  <i><font color="gray">我们在数据集中生成了第一个样本，以后可用于教授语言模型</font></i> <br><br> 然后，我们将窗口移至下一个位置并创建第二个示例： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/98c/0b3/f98/98c0b3f98ebf4790890fd2f66cf86ce9.png"></div><br><br> 很快，我们将积累一个更大的数据集： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4e7/3ce/50d/4e73ce50d863e1cbfde92a3b595dbaa3.png"></div><br><br> 实际上，通常在移动滑动窗口的过程中直接训练模型。 但从逻辑上讲，“数据集生成”阶段与训练阶段是分开的。 除了神经网络方法外，N-gram方法还经常用于较早的语言模型教学（请参见<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“语音和语言处理”</a>一书的第三章）。 要查看在实际产品中从N-gram转换为神经模型<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">时的区别</a> ，这是我最喜欢的Android键盘开发人员<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Swiftkey博客上的2015年一篇文章</a> ，介绍了其神经语言模型并将其与以前的N-gram模型进行比较。 我喜欢这个示例，因为它显示了如何用营销语言描述投资的算法特性。 <br><br><h1> 我们双向看 </h1><br><blockquote>  <font color="gray">“自相矛盾的迹象表明，我们应该尝试考虑其背后的原因。</font>  <font color="gray">如果矛盾使您担忧，则意味着您正在为绝对而奋斗。</font>  <font color="gray">相对主义者仅仅把悖论看作是一个有趣的，也许有趣的，有时甚至是令人恐惧的思想，但却是一个很有启发性的思想。”</font>  <font color="gray"><i>沙丘皇帝</i></font> </blockquote><br> 基于以上内容，填补空白： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/680/613/871/680613871307e53415ab86fab022276a.png"></div><br><br> 作为上下文，有五个先前的词（以及较早的对“公共汽车”的引用）。 我相信你们中的大多数人都已经猜到应该有一辆“公共汽车”。 但是，如果我在空格后再给您一个词，这会改变您的答案吗？ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45f/1fa/af0/45f1faaf0cdd4f57ac1699d87861934a.png"></div><br><br> 这完全改变了情况：现在丢失的单词很可能是“红色”。 显然，单词在空格之前和之后都具有信息价值。 事实证明，双向（左右）会计可以使您计算出更好的投资。 让我们看看如何在这种情况下配置模型训练。 <br><br><h1> 跳过克 </h1><br><blockquote>  <font color="gray">“当一个绝对明确的选择未知时，理智将有机会在舞台上处理有限的数据，在那里错误不仅可能而且也是必要的。”</font>  <font color="gray"><i>-Capitul沙丘</i></font> </blockquote><br> 除了目标之前的两个单词外，您还可以考虑目标后面的两个单词。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e2b/1f6/1a1/e2b1f61a179e7d6835b47c7149a47486.png"></div><br><br> 然后用于模型训练的数据集将如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ff/729/ed4/6ff729ed4ce86722dc9c3aa689614195.png"></div><br><br> 这称为CBOW（单词连续袋）体系结构，并且<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在word2vec</a> [pdf] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文档之一中进行了</a>描述。 还有另一种体系结构，它也显示出出色的结果，但是安排略有不同：它试图用当前单词来猜测相邻的单词。 滑动窗口如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc9/72d/baa/dc972dbaa78b592ba91b76e950ec56e0.png"></div><br>  <i><font color="gray">在绿色插槽中是输入词，每个粉红色字段表示一个可能的出口</font></i> <br><br> 粉色矩形具有不同的阴影，因为此滑动窗口实际上在我们的训练数据集中创建了四个单独的模式： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/709/8ac/dde/7098acddea8266d1efd5663ed98e6303.png"></div><br><br> 此方法称为<b>跳过语法</b>体系结构。 您可以按如下方式可视化滑动窗口： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ee2/1d8/508/ee21d850835bde9e3f14250d267d88b1.png"></div><br><br> 以下四个样本已添加到训练数据集中： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a40/871/f1c/a40871f1c1c7b48723d3737c05fc6284.png"></div><br><br> 然后我们将窗口移到以下位置： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/14a/429/c7b/14a429c7b2ae6ba7383d6d39be9e3031.png"></div><br><br> 生成另外四个示例： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e9b/b3c/89a/e9bb3c89a00306b3fd18eb86d8f2160b.png"></div><br><br> 不久我们将有更多示例： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6bb/749/096/6bb749096d3329712a7c00727b4d3cff.png"></div><br><br><h1> 学习评论 </h1><br><blockquote>  <font color="gray">“ Muad'Dib是个学习速度很快的人，因为他首先被教过如何学习。</font>  <font color="gray">但是，第一课就是对他可以学习的信念的吸收，这就是一切的基础。</font>  <font color="gray">令人惊讶的是，有多少人不相信自己可以学习和学习，还有更多的人认为学习非常困难。”</font>  <font color="gray">- <i>沙丘</i></font> </blockquote><br> 现在我们有了跳跃语法集，我们将其用于训练预测相邻单词的语言的基本神经模型。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/944/fb7/70d/944fb770d3aff38f1befa40dfaa7402a.png"></div><br><br> 让我们从数据集中的第一个样本开始。 我们将符号发送给未训练的模型，并带有预测下一个单词的请求。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/abb/5cb/9a3/abb5cb9a38d29f1a54176206637131dc.png"></div><br><br> 该模型经过三个步骤，并显示一个预测矢量（字典中每个单词的概率）。 由于模型尚未训练，因此在此阶段其预测可能不正确。 但这没什么。 我们知道她预测哪个词-这是我们当前用于训练模型的行中的结果单元格： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8af/4fd/c3d/8af4fdc3d3cc86ec1c81fdb3d2715529.png"></div><br>  <i><font color="gray">“目标向量”是其中目标词的概率为1，所有其他词的概率为0的向量</font></i> <br><br> 模型有多错误？ 从目标中减去预测向量并获得误差向量： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/b3e/395/e6db3e39593e9c8639d94ef4caccde58.png"></div><br><br> 现在可以使用该误差向量来更新模型，因此下次在相同的输入数据上更有可能给出准确的结果。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7d3/6c0/476/7d36c047604b937c907a4ef38ceaaeb7.png"></div><br><br> 培训的第一阶段到此结束。 我们继续对数据集中的下一个样本进行相同的操作，然后对下一个样本进行同样的操作，直到检查所有样本。 这是学习的第一个时代的终结。 我们将所有内容一遍又一遍地重复，因此，我们得到了训练有素的模型：您可以从中提取投资矩阵并将其用于任何应用程序中。 <br><br> 尽管我们学到了很多东西，但是要完全了解word2vec是如何真正学习的，缺少了一些关键思想。 <br><br><h1> 负选择 </h1><br><blockquote>  <font color="gray">“试图了解Muad'Dib而不了解他的致命敌人Harkonnenov就像是试图了解真相而不了解虚假是什么一样。</font>  <font color="gray">这是在不了解黑暗的情况下了解光明的尝试。</font>  <font color="gray">这是不可能的。”</font>  <font color="gray">- <i>沙丘</i></font> </blockquote><br> 回忆一下神经模型如何计算预测的三个步骤： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8dd/fe1/4ca/8ddfe14ca387bd4d16c77eb9de8ce98f.png"></div><br><br> 从计算的角度来看，第三步非常昂贵，尤其是如果您对数据集中的每个样本都这样做（数千万次）。 有必要以某种方式提高生产率。 <br><br> 一种方法是将目标分为两个阶段： <br><br><ol><li> 创建高质量的单词附件（不预测下一个单词）。 <br></li><li> 使用这些高质量的投资来教授语言模型（用于预测）。 </li></ol><br> 本文将重点关注第一步。 为了提高工作效率，您可以远离预测相邻词... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/77d/0a8/c17/77d0a8c17587248a0f790155809798fe.png"></div><br><br>  ...，然后切换到采用输入和输出单词并计算它们接近的概率（从0到1）的模型。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/220/0e3/e06/2200e3e063f3119099d1615e59538d2a.png"></div><br><br> 这种简单的转换将神经网络替换为逻辑回归模型-因此，计算变得更加简单和快捷。 <br><br> 这需要改进数据集的结构：标签现在是值为0或1的新列。在我们的表中，到处都是单位，因为我们在那里添加了邻居。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc2/d1e/874/dc2d1e87438b2492dc9b6e4b1c72162e.png"></div><br><br> 这样的模型以令人难以置信的速度计算：数分钟即可完成数百万个样本。 但是您需要关闭一个漏洞。 如果我们所有的示例都是肯定的（目标：1），则可以形成一个棘手的模型，该模型始终返回1，表明100％的准确性，但它不会学到任何东西，并且会产生垃圾投资。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ba/aa2/2d0/1baaa22d0b0c06be5398f896fa7a4c4b.png"></div><br><br> 要解决此问题，您需要在数据集中输入<i>否定模式</i> -绝对不是邻居的单词。 对于他们来说，模型必须返回0。现在，模型将不得不努力工作，但是计算仍然可以高速进行。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f4c/194/0d8/f4c1940d80c5203620196907a1478431.png"></div><br>  <i><font color="gray">对于数据集中的每个样本，添加标记为0的否定示例</font></i> <br><br> 但是要引入什么作为输出词呢？ 任意选择单词： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/84e/b22/06f/84eb2206f26b053f1ea8ec4e1b76c5b6.png"></div><br><br> 这个想法是在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">噪声比较</a>法[pdf]的影响下诞生的。 我们将实际信号（相邻单词的正例）与噪声（不是邻居的随机选择单词）进行匹配。 这在性能和统计性能之间提供了极好的折衷。 <br><br><h1> 跳过克负样本（SGNS） </h1><br> 我们研究了word2vec的两个核心概念：它们一起被称为“带有负采样的跳过语法”。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/873/720/fae/873720fae559ce7d6020be66ccb6c397.png"></div><br><br><h1> 学习word2vec </h1><br><blockquote>  <font color="gray">“一台机器无法预见对一个活着的人来说很重要的所有问题。</font>  <font color="gray">离散空间和连续连续体之间存在很大差异。</font>  <font color="gray">我们生活在一个空间中，而机器存在于另一个空间中。”</font>  <font color="gray">- <i>沙丘皇帝</i></font> </blockquote><br> 在研究了跳过语法和否定采样的基本思想之后，我们可以进一步仔细研究word2vec的学习过程。 <br><br> 首先，我们预处理训练模型的文本。 定义字典的大小（我们将其称为<code>vocab_size</code> ），例如，以10,000个附件为单位，并定义字典中单词的参数。 <br><br> 在训练开始时，我们创建两个矩阵： <code>Embedding</code>和<code>Context</code> 。 每个单词的附件都存储在字典的这些矩阵中（因此<code>vocab_size</code>是其参数之一）。 第二个参数是附件的尺寸（通常<code>embedding_size</code>设置为300，但之前我们看了一个尺寸为50的示例）。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1b7/8f8/018/1b78f8018d20fd36d0c5aef37d87a249.png"></div><br><br> 首先，我们用随机值初始化这些矩阵。 然后我们开始学习过程。 在每个阶段，我们都采取一个积极的例子，并与之相关的消极的例子。 这是我们的第一组： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d2/261/806/2d22618069aa9e3f8a820cb431c6c014.png"></div><br><br> 现在，我们有四个单词：输入单词<code>not</code>和输出/上下文单词<code>thou</code> （实际邻居）， <code>aaron</code>和<code>taco</code> （否定示例）。 我们开始在“ <code>Embedding</code> （对于输入单词）和“ <code>Context</code> （对于上下文单词）矩阵中搜索其附件，尽管这两个矩阵都包含字典中所有单词的附件。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/23e/ff0/691/23eff069128db956ce358ae758c0b8bb.png"></div><br><br> 然后，我们计算输入附件与每个上下文附件的标量积。 在每种情况下，都会获得一个数字，该数字指示输入数据和上下文附件的相似性。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/615/319/e4a/615319e4accc7235c28fc8c76dca09f6.png"></div><br><br> 现在，我们需要一种将这些估计变为某种可能性的方法：所有这些估计都必须是0到1之间的正数。这对于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">S形</a> logistic方程是一项出色的任务。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/98b/125/8b2/98b1258b21744917c993e617e0844ad8.png"></div><br><br> 乙状结肠计算的结果可以视为这些样本的模型输出。 如您所见，在乙状结肠之前和之后， <code>taco</code>的得分最高，而<code>aaron</code>的得分最低。 <br><br> 当未经训练的模型进行预测并具有真实的目标标记以进行比较时，让我们计算模型预测中有多少错误。 为此，只需从目标标签中减去S型分数即可。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d49/458/333/d49458333c28225c596014df3c6fcedb.png"></div><br>  <i><font color="gray"><code>error</code> = <code>target</code> <code>sigmoid_scores</code></font></i> <br><br> 这是术语“机器学习”的“学习”阶段的起点。 现在，我们可以使用此误差估计来调整<code>not</code> ， <code>thou</code> ， <code>aaron</code>和<code>taco</code>投资，以便下次结果更接近目标估计。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a5d/e51/cd3/a5de51cd3a86a1ed0784a709cb979bdc.png"></div><br><br> 这样就完成了培训的一个阶段。 我们改善了一些单词的附件（ <code>not</code> ， <code>thou</code> ， <code>aaron</code>和<code>taco</code> ）。 现在，我们进入下一个阶段（下一个正样本和与之相关的负样本）并重复该过程。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/637/2ab/c3a/6372abc3a3f6b623d5b2cbab02953030.png"></div><br><br> 随着我们多次遍历整个数据集，附件的数量不断增加。 然后，您可以停止该过程，将<code>Context</code>矩阵放在一旁，并将训练有素的<code>Embeddings</code>矩阵用于下一个任务。 <br><br><h1> 窗口大小和负样本数 </h1><br> 在学习word2vec的过程中，两个关键的超参数是窗口大小和否定样本数。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9fe/437/447/9fe4374479f547c1b324c7471cd61cbd.png"></div><br><br> 不同的窗口大小适合不同的任务。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">值得注意的是</a> ，较小的窗口大小（2-15）会生成具有相似索引的<i>可互换</i>附件（请注意，在查看周围的单词时，反义词通常是可互换的：例如，在相似的上下文中经常提及“好”和“坏”）。 较大的窗口大小（15–50甚至更大）会生成具有相似索引的<i>相关</i>附件。 在实践中，您通常必须为任务中有用的语义相似性提供<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">注释</a> 。 在Gensim中，默认窗口大小为5（除了输入单词本身，还包括左右两个单词）。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4f4/b0a/45a/4f4b0a45a8552d6c19c7c9459302ac48.png"></div><br><br>    —     .    5−20.    ,  2−5   ,       .  Gensim    — 5  . <br><br><h1> 结论 </h1><br><blockquote> <font color="gray">«      ,    ,   » — <i>- </i></font> </blockquote><br> ,         word2vec.  ,      ,     «skip-gram   » (SGNS),     . <br><br><h1>     </h1><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">«       »</a> [pdf] </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">«      »</a> [pdf] </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">«   »</a> [pdf] </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">«   »</a>      —    NLP. Word2vec    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">«      »</a> by <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> —      . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>        Word2vec.        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">« word2vec»</a> </li><li>   ?   : <ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> word2vec  Python</a>  Gensim </li><li>  <a href="">   C</a> ,    <a href="">       </a> </li></ul></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">    </a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">«  »</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> 2</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">«»</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN446530/">https://habr.com/ru/post/zh-CN446530/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN446514/index.html">Gmail已有15岁</a></li>
<li><a href="../zh-CN446516/index.html">肉山重生时间可视化</a></li>
<li><a href="../zh-CN446518/index.html">Web应用防火墙</a></li>
<li><a href="../zh-CN446520/index.html">一切如何开始：无人驾驶飞机的故事</a></li>
<li><a href="../zh-CN446522/index.html">Swift 5.1-有什么新功能？</a></li>
<li><a href="../zh-CN446532/index.html">Upwork收取写给潜在客户的权利的费用</a></li>
<li><a href="../zh-CN446534/index.html">Visual Studio 2019发布</a></li>
<li><a href="../zh-CN446536/index.html">队列和JMeter：与发布者和订阅者进行交换</a></li>
<li><a href="../zh-CN446538/index.html">PhotoGuru切换到“暗面”和“更明智”</a></li>
<li><a href="../zh-CN446544/index.html">Microsoft通过Azure IoT创新者和初创公司的新IP优势扩展了Azure IP优势计划</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>