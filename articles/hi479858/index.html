<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСиЁЯП╗тАНЁЯЪА ЁЯШН ЁЯХ╣я╕П LD_PRELOAD рдХреА рддрд▓рд╛рд╢ рд╣реИ ЁЯН╢ тЩЙя╕П ЁЯХ░я╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдпрд╣ рдиреЛрдЯ 2014 рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдореИрдВ рдмрд╕ рд╣рдм рдкрд░ рджрдорди рдореЗрдВ рдЖ рдЧрдпрд╛ рдФрд░ рдЙрд╕рдиреЗ рдкреНрд░рдХрд╛рд╢ рдХреЛ рдирд╣реАрдВ рджреЗрдЦрд╛ред рдкреНрд░рддрд┐рдмрдВрдз рдХреЗ рджреМрд░рд╛рди, рдореИрдВ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рднреВрд▓ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдЕрдм рдо...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>LD_PRELOAD рдХреА рддрд▓рд╛рд╢ рд╣реИ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479858/">  рдпрд╣ рдиреЛрдЯ 2014 рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдореИрдВ рдмрд╕ рд╣рдм рдкрд░ рджрдорди рдореЗрдВ рдЖ рдЧрдпрд╛ рдФрд░ рдЙрд╕рдиреЗ рдкреНрд░рдХрд╛рд╢ рдХреЛ рдирд╣реАрдВ рджреЗрдЦрд╛ред  рдкреНрд░рддрд┐рдмрдВрдз рдХреЗ рджреМрд░рд╛рди, рдореИрдВ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рднреВрд▓ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдЕрдм рдореИрдВрдиреЗ рдЗрд╕реЗ рдорд╕реМрджрд╛ рдкреНрд░рддрд┐рдпреЛрдВ рдореЗрдВ рдкрд╛рдпрд╛ред  рд╕реЛрдЪрд╛ рдерд╛ рдХрд┐ рдЗрд╕реЗ рд╣рдЯрд╛рдирд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╢рд╛рдпрдж рдХреЛрдИ рдХрд╛рдо рдЖрдПред <br><br><img src="https://habrastorage.org/webt/o1/8i/wf/o18iwf72_dlx0j9-qjr8zni5unq.png"><br><br>  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, "рд╢рд╛рдорд┐рд▓" <i>LD_PRELOAD</i> рдХреА рдЦреЛрдЬ рдХреЗ рд╡рд┐рд╖рдп рдкрд░ рдПрдХ рдЫреЛрдЯрд╛ рд╢реБрдХреНрд░рд╡рд╛рд░ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкрдврд╝рддрд╛ рд╣реИред <br><a name="habracut"></a><br><h2>  1. рдЙрди рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЫреЛрдЯрд╛ рд╡рд┐рд╖рдпрд╛рдВрддрд░ рдЬреЛ рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рд╕реЗ рдкрд░рд┐рдЪрд┐рдд рдирд╣реАрдВ рд╣реИрдВ </h2><br>  рдмрд╛рдХреА <b>рдЪрд░рдг 2 рдкрд░</b> рд╕реАрдзреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдЖрдЗрдП рдХреНрд▓рд╛рд╕рд┐рдХ рдЙрджрд╛рд╣рд░рдг рд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВ: <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;time.h&gt; int main() { srand (time(NULL)); for(int i=0; i&lt;5; i++){ printf ("%d\n", rand()%100); } }</span></span></span></span></code> </pre> <br>  рдмрд┐рдирд╛ рдХрд┐рд╕реА рдЭрдВрдбреЗ рдХреЗ рд╕рдВрдХрд▓рди: <br><br><pre> <code class="plaintext hljs">$ gcc ./ld_rand.c -o ld_rand</code> </pre><br>  рдФрд░, рдЙрдореНрдореАрдж рдХреЗ рдореБрддрд╛рдмрд┐рдХ, рд╣рдо 100 рд╕реЗ рдХрдо 5 рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="plaintext hljs">$ ./ld_rand 53 93 48 57 20</code> </pre><br>  рд▓реЗрдХрд┐рди рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХрд╛ рд╕реНрд░реЛрдд рдХреЛрдб рдирд╣реАрдВ рд╣реИ, рдФрд░ рд╣рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br>  рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдлрд╝рдВрдХреНрд╢рди рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдХреЗ рд╕рд╛рде рдЕрдкрдиреА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдмрдирд╛рдПрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">42</span></span>; }</code> </pre><br><pre> <code class="plaintext hljs">$ gcc -shared -fPIC ./o_rand.c -o ld_rand.so</code> </pre><br>  рдФрд░ рдЕрдм рд╣рдорд╛рд░реА рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдкрд╕рдВрдж рдХрд╛рдлреА рдЕрдиреБрдорд╛рдирд┐рдд рд╣реИ: <br><br><pre> <code class="plaintext hljs"># LD_PRELOAD=$PWD/ld_rand.so ./ld_rand 42 42 42 42 42</code> </pre><br>  рдпрджрд┐ рд╣рдо рдкрд╣рд▓реА рдмрд╛рд░ рдЕрдкрдиреА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рдЪрд╛рд▓ рдФрд░ рднреА рдкреНрд░рднрд╛рд╡рд╢рд╛рд▓реА рд▓рдЧрддреА рд╣реИ <br><br><pre> <code class="plaintext hljs">$ export LD_PRELOAD=$PWD/ld_rand.so</code> </pre><br>  рдпрд╛ рдкреВрд░реНрд╡-рдирд┐рд╖реНрдкрд╛рджрд┐рдд <br><br><pre> <code class="plaintext hljs"># echo "$PWD/ld_rand.so" &gt; /etc/ld.so.preload</code> </pre><br>  рдФрд░ рдлрд┐рд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рдореЛрдб рдореЗрдВ рдЪрд▓рд╛рдПрдВред  рд╣рдордиреЗ рд╕реНрд╡рдпрдВ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдХреЛрдб рдореЗрдВ рдПрдХ рднреА рд▓рд╛рдЗрди рдирд╣реАрдВ рдмрджрд▓реА рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдЕрдм рд╣рдорд╛рд░реЗ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдореЗрдВ рдПрдХ рдЫреЛрдЯреЗ рд╕реЗ рдХрд╛рд░реНрдп рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд▓реЗрдЦрди рдХреЗ рд╕рдордп, рдирдХрд▓реА <i>рд░реИрдВрдб</i> рднреА рдореМрдЬреВрдж рдирд╣реАрдВ рдерд╛ред <br><br>  рдХреНрдпрд╛ рд╣рдорд╛рд░реЗ рдХрд╛рд░реНрдпрдХреНрд░рдо рдирдХрд▓реА <i>рд░реИрдВрдб рдХрд╛</i> рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛?  рдЪрд▓реЛ рдЪрд░рдгреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЪрд▓рддреЗ рд╣реИрдВред <br>  рдЬрдм рдЖрд╡реЗрджрди рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдХреБрдЫ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрдп рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред  рд╣рдо рдЙрдиреНрд╣реЗрдВ <i>ldd</i> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="plaintext hljs"># ldd ./ld_rand linux-vdso.so.1 (0x00007ffc8b1f3000) libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007fe3da8af000) /lib64/ld-linux-x86-64.so.2 (0x00007fe3daa7e000)</code> </pre><br>  рдпрд╣ рд╕реВрдЪреА OS рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд╣рд╛рдВ рдПрдХ <i>libc.so</i> рдлрд╝рд╛рдЗрд▓ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред  рдпрд╣ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╣реИ рдЬреЛ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдФрд░ рдмреБрдирд┐рдпрд╛рджреА рдХрд╛рд░реНрдп рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ <i>рдУрдкрди</i> , <i>рдореЙрд▓реЛрдХ</i> , <i>рдкреНрд░рд┐рдВрдЯрдл</i> , рдЖрджрд┐ред рд╣рдорд╛рд░реА <i>рд░реИрдВрдб</i> рднреА рдЙрдирдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред  рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ: <br><br><pre> <code class="plaintext hljs"># nm -D /lib/x86_64-linux-gnu/libc.so.6 | grep " rand$" 000000000003aef0 T rand</code> </pre><br>  рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ <i>LD_PRELOAD</i> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдкрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рд╕реЗрдЯ рдмрджрд▓ рдЬрд╛рдПрдЧрд╛ рдпрд╛ рдирд╣реАрдВ <br><br><pre> <code class="plaintext hljs"># LD_PRELOAD=$PWD/ld_rand.so ldd ./ld_rand linux-vdso.so.1 (0x00007ffea52ae000) /scripts/c/ldpreload/ld_rand.so (0x00007f690d3f9000) libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f690d230000) /lib64/ld-linux-x86-64.so.2 (0x00007f690d405000)</code> </pre><br>  рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ рд╕реЗрдЯ рдЪрд░ <i>LD_PRELOAD</i> рд╣рдорд╛рд░реЗ <i>ld_rand.so</i> рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <i>рдмрд╛рдзреНрдп</i> рдХрд░рддрд╛ рд╣реИ, рднрд▓реЗ рд╣реА рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ рд╕реНрд╡рдпрдВ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рди рд╣реЛред  рдФрд░, рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░реЗ <i>рд░реИрдВрдб</i> рдлрд╝рдВрдХреНрд╢рди рдХреЛ <i>libc.so</i> рд╕реЗ <i>рд░реИрдВрдб рдХреА</i> рддреБрд▓рдирд╛ рдореЗрдВ рдкрд╣рд▓реЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдЧреЗрдВрдж рдкрд░ рд╢рд╛рд╕рди рдХрд░рддрд╛ рд╣реИред <br><br>  рдареАрдХ рд╣реИ, рд╣рдо рдореВрд▓ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмрджрд▓рдиреЗ рдореЗрдВ рдХрд╛рдордпрд╛рдм рд░рд╣реЗ, рд▓реЗрдХрд┐рди рдпрд╣ рдХреИрд╕реЗ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЗрд╕рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реИ рдФрд░ рдХреБрдЫ рдХреНрд░рд┐рдпрд╛рдПрдВ рдЬреЛрдбрд╝реА рдЬрд╛рддреА рд╣реИрдВред  рд╣рдо рдЕрдкрдиреЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _GNU_SOURCE #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;dlfcn.h&gt; #include &lt;stdio.h&gt; typedef int (*orig_rand_f_type)(void); int rand() { /*    */ printf("Evil injected code\n"); orig_rand_f_type orig_rand; orig_rand = (orig_rand_f_type)dlsym(RTLD_NEXT,"rand"); return orig_rand(); }</span></span></span></span></code> </pre><br>  рдпрд╣рд╛рдБ, рд╣рдорд╛рд░реЗ "additive" рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдо рдХреЗрд╡рд▓ рдкрд╛рда рдХреА рдПрдХ рдкрдВрдХреНрддрд┐ рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдореВрд▓ <i>рд░реИрдВрдб</i> рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рдкреЙрдЗрдВрдЯрд░ рдмрдирд╛рддреЗ рд╣реИрдВред  рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ <i>dlsym рдХреА</i> рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ - рдпрд╣ <i>libdl</i> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реЗ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рд╣реИ рдЬреЛ рдЧрддрд┐рд╢реАрд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЗ рдвреЗрд░ рдореЗрдВ рд╣рдорд╛рд░реЗ <i>рд░реИрдВрдб</i> рдХреЛ <i>рдвреВрдВрдвреЗрдЧрд╛</i> ред  рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд╣рдо рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЗрд╕рдХреЗ рдореВрд▓реНрдп рдХреЛ рд╡рд╛рдкрд╕ рдХрд░реЗрдВрдЧреЗред  рддрджрдиреБрд╕рд╛рд░, рд╣рдореЗрдВ рдирд┐рд░реНрдорд╛рдг рдХрд░рддреЗ рд╕рдордп <i>"-ldl"</i> рдЬреЛрдбрд╝рдирд╛ рд╣реЛрдЧрд╛: <br><br><pre> <code class="plaintext hljs">$ gcc -ldl -shared -fPIC ./o_rand_evil.c -o ld_rand_evil.so</code> </pre><br><pre> <code class="plaintext hljs">$ LD_PRELOAD=$PWD/ld_rand_evil.so ./ld_rand Evil injected code 66 Evil injected code 28 Evil injected code 93 Evil injected code 93 Evil injected code 95</code> </pre><br>  рдФрд░ рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо "рджреЗрд╢реА" <i>рд░реИрдВрдб</i> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдХреБрдЫ рдЕрд╢реЛрднрдиреАрдп рдХрд╛рд░реНрдп рдХрд░рдиреЗ рдХреЗ рдмрд╛рджред <br><br><h2>  2. рдЖрдЯрд╛ рдЦреЛрдЬ </h2><br>  рд╕рдВрднрд╛рд╡рд┐рдд рдЦрддрд░реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдпрд╣ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ <i>рдкреНрд░реАрд▓реЛрдб</i> рдирд┐рд╖реНрдкрд╛рджрд┐рдд <i>рдХрд┐рдпрд╛</i> рдЧрдпрд╛ рд╣реИред  рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рдЗрд╕реЗ рдХрд░реНрдиреЗрд▓ рдореЗрдВ рдврд╛рд▓ рджреЗрдирд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдореБрдЭреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрдерд╛рди рдореЗрдВ рдмрд┐рд▓реНрдХреБрд▓ рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рд░реБрдЪрд┐ рдереАред <br><br>  рдЕрдЧрд▓рд╛, рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рдЙрдирдХреЗ рдкреНрд░рддрд┐рдирд┐рдпреБрдХреНрддрд┐ рдХреЗ рд╕рдорд╛рдзрд╛рди рдЬреЛрдбрд╝реЗ рдореЗрдВ рдЬрд╛рдПрдВрдЧреЗред <br><br><h2>  2.1ред  рдПрдХ рд╕рд░рд▓ рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ </h2><br>  рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЖрдк рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ <i>LD_PRELOAD</i> рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдЗрд╕реЗ <i>/etc/ld.so.preload</i> рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦрдХрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЖрдЗрдП рджреЛ рд╕рд░рд▓рддрдо рдбрд┐рдЯреЗрдХреНрдЯрд░ рдмрдирд╛рдПрдВред <br><br>  рдкрд╣рд▓рд╛ рд╕реЗрдЯ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;fcntl.h&gt; int main() { char* pGetenv = getenv("LD_PRELOAD"); pGetenv != NULL ? printf("LD_PRELOAD (getenv) [+]\n"): printf("LD_PRELOAD (getenv) [-]\n"); }</span></span></span></span></code> </pre><br>  рджреВрд╕рд░рд╛ рдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓рдиреЗ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдирд╛ рд╣реИ: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;fcntl.h&gt; int main() { open("/etc/ld.so.preload", O_RDONLY) != -1 ? printf("LD_PRELOAD (open) [+]\n"): printf("LD_PRELOAD (open) [-]\n"); }</span></span></span></span></code> </pre><br>  рд▓реЛрдб рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ: <br><br><pre> <code class="plaintext hljs">$ export LD_PRELOAD=$PWD/ld_rand.so $ echo "$PWD/ld_rand.so" &gt; /etc/ld.so.preload $ ./detect_base_getenv LD_PRELOAD (getenv) [+] $ ./detect_base_open LD_PRELOAD (open) [+]</code> </pre><br>  рдЗрд╕рдХреЗ рдмрд╛рдж, [+] рд╕рдлрд▓ рдкрд╣рдЪрд╛рди рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИред <br>  рддрджрдиреБрд╕рд╛рд░, [-] рдХрд╛ рдЕрд░реНрде рд╣реИ рдмрд╛рдИрдкрд╛рд╕ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ред <br><br>  рдЗрд╕ рддрд░рд╣ рдХреЗ рдбрд┐рдЯреЗрдХреНрдЯрд░ рдХрд┐рддрдирд╛ рдкреНрд░рднрд╛рд╡реА рд╣реИ?  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдЗрдП рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _GNU_SOURCE #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;dlfcn.h&gt; char* (*orig_getenv)(const char *) = NULL; char* getenv(const char *name) { if(!orig_getenv) orig_getenv = dlsym(RTLD_NEXT, "getenv"); if(strcmp(name, "LD_PRELOAD") == 0) return NULL; return orig_getenv(name); }</span></span></span></span></code> </pre><br><pre> <code class="plaintext hljs">$ gcc -shared -fpic -ldl ./ld_undetect_getenv.c -o ./ld_undetect_getenv.so $ LD_PRELOAD=./ld_undetect_getenv.so ./detect_base_getenv LD_PRELOAD (getenv) [-]</code> </pre><br>  рдЗрд╕реА рддрд░рд╣, рд╣рдо <i>рдЦреБрд▓реЗ</i> рдЪреЗрдХ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛ рд▓реЗрддреЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _GNU_SOURCE #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;string.h&gt; #include &lt;stdlib.h&gt; #include &lt;dlfcn.h&gt; #include &lt;errno.h&gt; int (*orig_open)(const char*, int oflag) = NULL; int open(const char *path, int oflag, ...) { char real_path[256]; if(!orig_open) orig_open = dlsym(RTLD_NEXT, "open"); realpath(path, real_path); if(strcmp(real_path, "/etc/ld.so.preload") == 0){ errno = ENOENT; return -1; } return orig_open(path, oflag); }</span></span></span></span></code> </pre><br><pre> <code class="plaintext hljs">$ gcc -shared -fpic -ldl ./ld_undetect_open.c -o ./ld_undetect_open.so $ LD_PRELOAD=./ld_undetect_open.so ./detect_base_open LD_PRELOAD (open) [-]</code> </pre><br>  рд╣рд╛рдВ, рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдпрд╣рд╛рдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ <i>рдУрдкрди 64</i> , <i>рд╕реНрдЯреЗрдЯ</i> , рдЖрджрд┐, рд▓реЗрдХрд┐рди, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдХреЛрдб рдХреА рд╕рдорд╛рди 5-10 рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдЙрдиреНрд╣реЗрдВ рдзреЛрдЦрд╛ рджреЗрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред <br><br><h2>  2.2ред  рдЪрд▓ рд░рд╣рд╛ рд╣реИ </h2><br>  рдКрдкрд░ рд╣рдордиреЗ <i>LD_PRELOAD</i> рдХрд╛ рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <i>getenv ()</i> рдХрд╛ <i>рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛</i> , рд▓реЗрдХрд┐рди <i>ENV</i> рд╡реИрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдзрд┐рдХ "рдирд┐рдореНрди рд╕реНрддрд░" рддрд░реАрдХрд╛ рд╣реИред  рд╣рдо рдордзреНрдпрд╡рд░реНрддреА рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди <i>** environ</i> рд╕рд░рдгреА рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреА рдПрдХ рдкреНрд░рддрд┐ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;string.h&gt; extern char **environ; int main(int argc, char **argv) { int i; char env[] = "LD_PRELOAD"; if (environ != NULL) for (i = 0; environ[i] != NULL; i++) { char * pch; pch = strstr(environ[i],env); if(pch != NULL) { printf("LD_PRELOAD (**environ) [+]\n"); return 0; } } printf("LD_PRELOAD (**environ) [-]\n"); return 0; }</span></span></span></span></code> </pre><br>  рдЪреВрдВрдХрд┐ рдпрд╣рд╛рдВ рд╣рдо рдбреЗрдЯрд╛ рдХреЛ рд╕реАрдзреЗ рдореЗрдореЛрд░реА рд╕реЗ рдкрдврд╝рддреЗ рд╣реИрдВ, рдРрд╕реЗ рдХреЙрд▓ рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рд╣рдорд╛рд░рд╛ <i>undetect_getenv</i> рдЕрдм рдШреБрд╕рдкреИрда рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред <br><br><pre> <code class="plaintext hljs">$ LD_PRELOAD=./ld_undetect_getenv.so ./detect_environ LD_PRELOAD (**environ) [+]</code> </pre><br>  рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╕рдорд╕реНрдпрд╛ рд╣рд▓ рд╣реЛ рдЧрдИ рд╣реИ?  рдЕрднреА рднреА рд╢реБрд░реБрдЖрдд рд╣реИред <br><br>  рдкреНрд░реЛрдЧреНрд░рд╛рдо рд▓реЙрдиреНрдЪ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдореЗрдореЛрд░реА рдореЗрдВ <i>LD_PRELOAD</i> рдЪрд░ рдХрд╛ рдорд╛рди рдЕрдм рдкрдЯрд╛рдЦреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ, рдЕрд░реНрдерд╛рдд, рдЖрдк рдЗрд╕реЗ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХрд┐рд╕реА рднреА рдирд┐рд░реНрджреЗрд╢ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЗрд╕реЗ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдмреЗрд╢рдХ, рд╕реНрдореГрддрд┐ рдореЗрдВ рдХрд┐рд╕реА рд╕рд░рдгреА рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рдХрдо рд╕реЗ рдХрдо рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рд╢реИрд▓реА рд╣реИ, рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХрд┐рд╕реА рдХреЛ рд░реЛрдХ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╣рдорд╛рд░реА рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдХрд╛рдордирд╛ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ? <br><br>  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдирдХрд▓реА рдлрд╝рдВрдХреНрд╢рди <i>init ()</i> рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╣рдо рд╕реНрдерд╛рдкрд┐рдд <i>LD_PRELOAD рдХреЛ</i> рд░реЛрдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рд╣рдорд╛рд░реЗ рд▓рд┐рдВрдХрд░ рдХреЛ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _GNU_SOURCE #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;unistd.h&gt; #include &lt;dlfcn.h&gt; #include &lt;stdlib.h&gt; extern char **environ; char *evil_env; int (*orig_execve)(const char *path, char *const argv[], char *const envp[]) = NULL; //    init //       //   -  void evil_init() { //     LD_PRELOAD static const char *ldpreload = "LD_PRELOAD"; int len = strlen(getenv(ldpreload)); evil_env = (char*) malloc(len+1); strcpy(evil_env, getenv(ldpreload)); int i; char env[] = "LD_PRELOAD"; if (environ != NULL) for (i = 0; environ[i] != NULL; i++) { char * pch; pch = strstr(environ[i],env); if(pch != NULL) { //    LD_PRELOAD unsetenv(env); break; } } } int execve(const char *path, char *const argv[], char *const envp[]) { int i = 0, j = 0, k = -1, ret = 0; char** new_env; if(!orig_execve) orig_execve = dlsym(RTLD_NEXT,"execve"); //       LD_PRELOAD for(i = 0; envp[i]; i++){ if(strstr(envp[i], "LD_PRELOAD")) k = i; } //  LD_PRELOAD     ,    if(k == -1){ k = i; i++; } //    new_env = (char**) malloc((i+1)*sizeof(char*)); //   ,   LD_PRELOAD for(j = 0; j &lt; i; j++) { //    LD_PRELOAD if(j == k) { new_env[j] = (char*) malloc(256); strcpy(new_env[j], "LD_PRELOAD="); strcat(new_env[j], evil_env); } else new_env[j] = (char*) envp[j]; } new_env[i] = NULL; ret = orig_execve(path, argv, new_env); free(new_env[k]); free(new_env); return ret; }</span></span></span></span></code> </pre><br>  рд╣рдо рдкреНрд░рджрд░реНрд╢рди рдХрд░рддреЗ рд╣реИрдВ, рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="plaintext hljs">$ gcc -shared -fpic -ldl -Wl,-init,evil_init ./ld_undetect_environ.c -o ./ld_undetect_environ.so $ LD_PRELOAD=./ld_undetect_environ.so ./detect_environ LD_PRELOAD (**environ) [-]</code> </pre><br><h2>  2.3ред  / рдЦрд░реАрдж / рд╕реНрд╡ / </h2><br>  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдореЗрдореЛрд░реА рдЕрдВрддрд┐рдо рд╕реНрдерд╛рди рдирд╣реАрдВ рд╣реИ рдЬрд╣рд╛рдБ рдЖрдк <i>LD_PRELOAD</i> рд╕реНрдкреВрдлрд┐рдВрдЧ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд╡рд╣рд╛рдБ рднреА <i>/ proc / рд╣реИ</i> ред  рдЪрд▓реЛ рд╕реНрдкрд╖реНрдЯ <i>/ proc / {PID} / environ рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ</i> ред <br><br>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ <i>undetect</i> <i>** environ</i> рдФрд░ <i>/ proc / self / environ рдХреЗ</i> рд▓рд┐рдП рдПрдХ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рд╕рдорд╛рдзрд╛рди рд╣реИред  рд╕рдорд╕реНрдпрд╛ <i>рдЕрд╕рддреНрд╕реЗрд╡ (env)</i> рдХрд╛ "рдЧрд▓рдд" рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">рд╕рд╣реА рд╡рд┐рдХрд▓реНрдк</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evil_init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     LD_PRELOAD static const char *ldpreload = "LD_PRELOAD"; int len = strlen(getenv(ldpreload)); evil_env = (char*) malloc(len+1); strcpy(evil_env, getenv(ldpreload)); int i; char env[] = "LD_PRELOAD"; if (environ != NULL) for (i = 0; environ[i] != NULL; i++) { char * pch; pch = strstr(environ[i],env); if(pch != NULL) { //    LD_PRELOAD //unsetenv(env); //  unset     for(int j = 0; environ[i][j] != '\0'; j++) environ[i][j] = '\0'; break; } } }</span></span></code> </pre><br><br><pre> <code class="plaintext hljs">$ gcc -shared -fpic -ldl -Wl,-init,evil_init ./ld_undetect_environ_2.c -o ./ld_undetect_environ_2.so $ (LD_PRELOAD=./ld_undetect_environ_2.so cat /proc/self/environ; echo) | tr "\000" "\n" | grep -F LD_PRELOAD $</code> </pre><br></div></div><br>  рд▓реЗрдХрд┐рди рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рд╣рдореЗрдВ рдпрд╣ рдирд╣реАрдВ рдорд┐рд▓рд╛ рдФрд░ <i>/ proc / self / environ</i> рдореЗрдВ "рд╕рдорд╕реНрдпрд╛рдЧреНрд░рд╕реНрдд" рдбреЗрдЯрд╛ рд╣реИред <br><br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдорд╛рд░реЗ рдкрд┐рдЫрд▓реЗ "рднреЗрд╕" рдХреЗ рд╕рд╛рде рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ: <br><br><pre> <code class="plaintext hljs">$ (LD_PRELOAD=./ld_undetect_environ.so cat /proc/self/environ; echo) | tr "\000" "\n" | grep -F LD_PRELOAD LD_PRELOAD=./ld_undetect_environ.so</code> </pre><br>  <i>рдмрд┐рд▓реНрд▓реА</i> рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реА <i>рдЦреБрд▓реЗ ()</i> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╕рдорд╛рдзрд╛рди рдзрд╛рд░рд╛ 2.1 рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдм рд╣рдо рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ рд╣рдо <i>LD_PRELOAD</i> рдпреБрдХреНрдд рд▓рд╛рдЗрдиреЛрдВ рдХреЗ рдмрд┐рдирд╛ рд╕рд╣реА рдореЗрдореЛрд░реА рдорд╛рдиреЛрдВ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рддреЗ рд╣реИрдВред <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _GNU_SOURCE #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;dlfcn.h&gt; #include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;fcntl.h&gt; #include &lt;sys/stat.h&gt; #include &lt;unistd.h&gt; #include &lt;limits.h&gt; #include &lt;errno.h&gt; #define BUFFER_SIZE 256 int (*orig_open)(const char*, int oflag) = NULL; char *soname = "fakememory_preload.so"; char *sstrstr(char *str, const char *sub) { int i, found; char *ptr; found = 0; for(ptr = str; *ptr != '\0'; ptr++) { found = 1; for(i = 0; found == 1 &amp;&amp; sub[i] != '\0'; i++){ if(sub[i] != ptr[i]) found = 0; } if(found == 1) break; } if(found == 0) return NULL; return ptr + i; } void fakeMaps(char *original_path, char *fake_path, char *pattern) { int fd; char buffer[BUFFER_SIZE]; int bytes = -1; int wbytes = -1; int k = 0; pid_t pid = getpid(); int fh; if ((fh=orig_open(fake_path,O_CREAT|O_WRONLY))==-1) { printf("LD: Cannot open write-file [%s] (%d) (%s)\n", fake_path, errno, strerror(errno)); exit (42); } if((fd=orig_open(original_path, O_RDONLY))==-1) { printf("LD: Cannot open read-file.\n"); exit(42); } do { char t = 0; bytes = read(fd, &amp;t, 1); buffer[k++] = t; //printf("%c", t); if(t == '\0') { //printf("\n"); if(!sstrstr(buffer, "LD_PRELOAD")) { if((wbytes = write(fh,buffer,k))==-1) { //printf("write error\n"); } else { //printf("writed %d\n", wbytes); } } k = 0; } } while(bytes != 0); close(fd); close(fh); } int open(const char *path, int oflag, ...) { char real_path[PATH_MAX], proc_path[PATH_MAX], proc_path_0[PATH_MAX]; pid_t pid = getpid(); if(!orig_open) orig_open = dlsym(RTLD_NEXT, "open"); realpath(path, real_path); snprintf(proc_path, PATH_MAX, "/proc/%d/environ", pid); if(strcmp(real_path, proc_path) == 0) { snprintf(proc_path, PATH_MAX, "/tmp/%d.fakemaps", pid); realpath(proc_path_0, proc_path); fakeMaps(real_path, proc_path, soname); return orig_open(proc_path, oflag); } return orig_open(path, oflag); }</span></span></span></span></code> </pre><br>  рдФрд░ рдпрд╣ рдЪрд░рдг рдкреВрд░рд╛ рд╣реЛ рдЪреБрдХрд╛ рд╣реИ: <br><br><pre> <code class="plaintext hljs">$ (LD_PRELOAD=./ld_undetect_proc_environ.so cat /proc/self/environ; echo) | tr "\000" "\n" | grep -F LD_PRELOAD $</code> </pre><br>  рдЕрдЧрд▓рд╛ рд╕реНрдкрд╖реНрдЯ рд╕реНрдерд╛рди <i>/ рдЦрд░реАрдж / рд╕реНрд╡ / рдорд╛рдирдЪрд┐рддреНрд░ рд╣реИ</i> ред  рдЗрд╕ рдкрд░ рдХреЛрдИ рдорддрд▓рдм рдирд╣реАрдВ рд╣реИред  рд╕рдорд╛рдзрд╛рди рдкрд┐рдЫрд▓реЗ рдПрдХ рдХреЗ рд╕рдорд╛рди рд╣реИ: рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ рдХреЙрдкреА рдХрд░реЗрдВ <i>libsso</i> рдФрд░ <i>ld.so рдХреЗ</i> рдмреАрдЪ рдХреА рд░реЗрдЦрд╛рдПрдВред <br><br><h2>  2.4ред  рдЪреЛрдХрдкреЙрдЗрдВрдЯ рд╕реЗ рд╡рд┐рдХрд▓реНрдк </h2><br>  рдореБрдЭреЗ рдпрд╣ рд╕рдорд╛рдзрд╛рди рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЕрдкрдиреА рд╕рд╛рджрдЧреА рдХреЗ рдХрд╛рд░рдг рдкрд╕рдВрдж рдЖрдпрд╛ред  рд╕реАрдзреЗ <i>libc</i> рдФрд░ "NEXT" рдкрддреЗ рд╕реЗ рд▓реЛрдб рдХрд┐рдП рдЧрдП рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрддреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВред <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _GNU_SOURCE #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;dlfcn.h&gt; #define LIBC "/lib/x86_64-linux-gnu/libc.so.6" int main(int argc, char *argv[]) { void *libc = dlopen(LIBC, RTLD_LAZY); // Open up libc directly char *syscall_open = "open"; int i; void *(*libc_func)(); void *(*next_func)(); libc_func = dlsym(libc, syscall_open); next_func = dlsym(RTLD_NEXT, syscall_open); if (libc_func != next_func) { printf("LD_PRELOAD (syscall - %s) [+]\n", syscall_open); printf("Libc address: %p\n", libc_func); printf("Next address: %p\n", next_func); } else { printf("LD_PRELOAD (syscall - %s) [-]\n", syscall_open); } return 0; }</span></span></span></span></code> </pre><br>  рд╣рдо рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ <i>"рдУрдкрди ()"</i> рдФрд░ рдЪреЗрдХ рдХреЗ рд╕рд╛рде рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="plaintext hljs">$ export LD_PRELOAD=$PWD/ld_undetect_open.so $ ./detect_chokepoint LD_PRELOAD (syscall - open) [+] Libc address: 0x7fa86893b160 Next address: 0x7fa868a26135</code> </pre><br>  рдкреНрд░рддрд┐рдирд┐рдпреБрдХреНрддрд┐ рдФрд░ рднреА рд╕рд░рд▓ рд╣реЛ рдЧрдИ: <br><br><pre> <code class="plaintext hljs">#define _GNU_SOURCE #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;dlfcn.h&gt; extern void * _dl_sym (void *, const char *, void *); void * dlsym (void * handle, const char * symbol) { return _dl_sym (handle, symbol, dlsym); }</code> </pre><br><pre> <code class="plaintext hljs"># LD_PRELOAD=./ld_undetect_chokepoint.so ./detect_chokepoint LD_PRELOAD (syscall - open) [-]</code> </pre><br><h2>  2.5ред  Syscalls </h2><br>  рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╕рднреА, рд▓реЗрдХрд┐рди рдЕрднреА рднреА flounder рд╣реИред  рдЕрдЧрд░ рд╣рдо рд╕реАрдзреЗ рдХрд░реНрдиреЗрд▓ рдореЗрдВ рдПрдХ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рд╕рдВрдкреВрд░реНрдг рдЕрд╡рд░реЛрдзрди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░реЗрдЧрд╛ред  рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рд╕рдорд╛рдзрд╛рди, рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ, рд╡рд╛рд╕реНрддреБрдХрд▓рд╛- <i>рдирд┐рд░реНрднрд░</i> ( <i>x86_64</i> ) рд╣реИред  рдЖрдЗрдП рдЙрджреНрдШрд╛рдЯрди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП <i>ld.so.preload</i> рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;sys/stat.h&gt; #include &lt;fcntl.h&gt; #define BUFFER_SIZE 256 int syscall_open(char *path, long oflag) { int fd = -1; __asm__ ( "mov $2, %%rax;" // Open syscall number "mov %1, %%rdi;" // Address of our string "mov %2, %%rsi;" // Open mode "mov $0, %%rdx;" // No create mode "syscall;" // Straight to ring0 "mov %%eax, %0;" // Returned file descriptor :"=r" (fd) :"m" (path), "m" (oflag) :"rax", "rdi", "rsi", "rdx" ); return fd; } int main() { syscall_open("/etc/ld.so.preload", O_RDONLY) &gt; 0 ? printf("LD_PRELOAD (open syscall) [+]\n"): printf("LD_PRELOAD (open syscall) [-]\n"); }</span></span></span></span></code> </pre><br><pre> <code class="plaintext hljs">$ ./detect_syscall LD_PRELOAD (open syscall) [+]</code> </pre><br>  рдФрд░ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдПрдХ рд╣рд▓ рд╣реИред  <i>рдЖрджрдореА</i> рд╕реЗ рдЕрдВрд╢: <br><blockquote>  ptrace рдПрдХ рдРрд╕рд╛ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рдПрдХ рдкреЗрд░реЗрдВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдкреНрд░рд╡рд╛рд╣ рдХреЛ рджреЗрдЦрдиреЗ рдФрд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ, рдЙрд╕рдХреЗ рдбреЗрдЯрд╛ рдФрд░ рд░рдЬрд┐рд╕реНрдЯрд░ рдХреЛ рджреЗрдЦрдиреЗ рдФрд░ рдмрджрд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдЖрдорддреМрд░ рдкрд░, рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдбрд┐рдмрдЧрд┐рдВрдЧ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдФрд░ рдЯреНрд░реИрдХ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдореЗрдВ рдмреНрд░реЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдкреИрд░реЗрдВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд╣рд▓реЗ рдХрд╛рдВрдЯреЗ (2) рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдЯреНрд░реЗрд╕рд┐рдВрдЧ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреА рд╣реИ, рдФрд░ рдлрд┐рд░ рдкрд░рд┐рдгрд╛рдореА рдЪрд╛рдЗрд▓реНрдб рдкреНрд░рдХреНрд░рд┐рдпрд╛ PTRACE_TRACEME рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреА рд╣реИ, рдЙрд╕рдХреЗ рдмрд╛рдж (рдЖрдорддреМрд░ рдкрд░) рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди (3)ред  рджреВрд╕рд░реА рдУрд░, рдореВрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ PTRACE_ATTACH рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореМрдЬреВрджрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбреАрдмрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреА рд╣реИред <br><br>  рдЯреНрд░реЗрд╕ рдХрд░рддреЗ рд╕рдордп, рдмрдЪреНрдЪреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣рд░ рдмрд╛рд░ рд╕рд┐рдЧреНрдирд▓ рдорд┐рд▓рдиреЗ рдкрд░ рд░реБрдХ рдЬрд╛рддреА рд╣реИ, рднрд▓реЗ рд╣реА рдЗрд╕ рд╕рд┐рдЧреНрдирд▓ рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛред  (рдЕрдкрд╡рд╛рдж SIGKILL рд╣реИ, рдЬреЛ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред) рдкреНрд░рддреАрдХреНрд╖рд╛ (2) рдХрд╣реЗ рдЬрд╛рдиреЗ рдкрд░ рдореВрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЗрд╕рдХреА рд╕реВрдЪрдирд╛ рджреА рдЬрд╛рдПрдЧреА, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдпрд╣ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдмрдЪреНрдЪреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рджреЗрдЦ рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдЙрд╕рдХреЗ рдмрд╛рдж, рдорд╛рддрд╛-рдкрд┐рддрд╛ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдЪреНрдЪреЗ рдХреЛ рдХрд╛рдо рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЙрд╕реЗ рднреЗрдЬреЗ рдЧрдП рд╕рдВрдХреЗрдд рдХреА рдЕрдирджреЗрдЦреА рдХрд░рдирд╛ рдпрд╛ рдЗрд╕рдХреЗ рдмрдЬрд╛рдп рдПрдХ рдФрд░ рд╕рдВрдХреЗрдд рднреЗрдЬрдирд╛)ред <br></blockquote><br>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╕рдорд╛рдзрд╛рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рд╕реЗ рдкрд╣рд▓реЗ рдЗрд╕реЗ рд░реЛрдХрдирд╛ рдФрд░, рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ, рддреЛ рдереНрд░реЗрдб рдХреЛ рдлрдВрдХреНрд╢рди рдлрд╝рдВрдХреНрд╢рди рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░реЗрдВред <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _GNU_SOURCE #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;fcntl.h&gt; #include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;unistd.h&gt; #include &lt;errno.h&gt; #include &lt;limits.h&gt; #include &lt;sys/ptrace.h&gt; #include &lt;sys/wait.h&gt; #include &lt;sys/reg.h&gt; #include &lt;sys/user.h&gt; #include &lt;asm/unistd.h&gt; #if defined(__x86_64__) #define REG_SYSCALL ORIG_RAX #define REG_SP rsp #define REG_IP rip #endif long NOHOOK = 0; long evil_open(const char *path, long oflag, long cflag) { char real_path[PATH_MAX], maps_path[PATH_MAX]; long ret; pid_t pid; pid = getpid(); realpath(path, real_path); if(strcmp(real_path, "/etc/ld.so.preload") == 0) { errno = ENOENT; ret = -1; } else { NOHOOK = 1; // Entering NOHOOK section ret = open(path, oflag, cflag); } // Exiting NOHOOK section NOHOOK = 0; return ret; } void init() { pid_t program; //    program = fork(); if(program != 0) { int status; long syscall_nr; struct user_regs_struct regs; //     if(ptrace(PTRACE_ATTACH, program) != 0) { printf("Failed to attach to the program.\n"); exit(1); } waitpid(program, &amp;status, 0); //   SYSCALLs ptrace(PTRACE_SETOPTIONS, program, 0, PTRACE_O_TRACESYSGOOD); while(1) { ptrace(PTRACE_SYSCALL, program, 0, 0); waitpid(program, &amp;status, 0); if(WIFEXITED(status) || WIFSIGNALED(status)) break; else if(WIFSTOPPED(status) &amp;&amp; WSTOPSIG(status) == SIGTRAP|0x80) { //     syscall_nr = ptrace(PTRACE_PEEKUSER, program, sizeof(long)*REG_SYSCALL); if(syscall_nr == __NR_open) { //       NOHOOK = ptrace(PTRACE_PEEKDATA, program, (void*)&amp;NOHOOK); //   if(!NOHOOK) { //     //   regs  ptrace(PTRACE_GETREGS, program, 0, &amp;regs); // Push return address on the stack regs.REG_SP -= sizeof(long); //       ptrace(PTRACE_POKEDATA, program, (void*)regs.REG_SP, regs.REG_IP); //  RIP   evil_open regs.REG_IP = (unsigned long) evil_open; //     ptrace(PTRACE_SETREGS, program, 0, &amp;regs); } } ptrace(PTRACE_SYSCALL, program, 0, 0); waitpid(program, &amp;status, 0); } } exit(0); } else { sleep(0); } }</span></span></span></span></code> </pre><br>  рд╣рдо рдЬрд╛рдБрдЪ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="plaintext hljs">$ ./detect_syscall LD_PRELOAD (open syscall) [+] $ LD_PRELOAD=./ld_undetect_syscall.so ./detect_syscall LD_PRELOAD (open syscall) [-]</code> </pre><br>  <b>+ 0-0 = 5</b> <br><br>  рдЖрдкрдХрд╛ рдмрд╣реБрдд-рдмрд╣реБрдд рдзрдиреНрдпрд╡рд╛рдж <br><br>  <a href="https://github.com/haxelion" rel="nofollow">рдЪрд╛рд░реНрд▓реНрд╕ рд╣реБрдмреИрди</a> <br>  <a href="https://github.com/chokepoint" rel="nofollow">Chokepoint</a> <br>  <a href="https://habr.com/ru/users/valdikss/">ValdikSS</a> <br>  <a href="https://github.com/doegox" rel="nofollow">рдлрд┐рд▓рд┐рдк рдЯреЗрдЙрд╡реЗрди</a> <br>  <a href="https://stackoverflow.com/users/2327517/derhass" rel="nofollow">derhass</a> <br><br>  рдЬрд┐рдирдХреЗ рд▓реЗрдЦ, рд╕реНрд░реЛрдд рдХреЛрдб рдФрд░ рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдБ рдЗрд╕ рд▓реЗрдЦ рдХреЛ рдпрд╣рд╛рдБ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореБрдЭрд╕реЗ рдХрд╣реАрдВ рдЕрдзрд┐рдХ рдереЗред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi479858/">https://habr.com/ru/post/hi479858/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi479844/index.html">рдпреВрдПрдХреНрд╕ рдбрд┐рдЬрд╛рдЗрдирд░реЛрдВ рдХреА рдПрдХ рдЯреАрдо рдЗрдХрдЯреНрдард╛ рдХрд░реЗрдВ рдФрд░ рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рдХрд╛рдо рдкрд░ рд░рдЦрдиреЗ рдХреЗ рдХрд╛рд░рдг 7 рдорд┐рд▓рд┐рдпрди рдЦреЛ рджреЗрдВ</a></li>
<li><a href="../hi479848/index.html">рд╣рдорд╛рд░рд╛ рдЪрддреБрд░реНрдерд╛рдВрд╢ 2019 рдореЗрдВ! рдХреИрд╕реЗ рдЧрд╛рд░реНрдЯрдирд░ рдореАрдЯрд┐рдВрдЧ рд╕реЙрд▓реНрдпреВрд╢рдВрд╕ рд╡реАрдбрд┐рдпреЛ рдХреЙрдиреНрдлреНрд░реЗрдВрд╕рд┐рдВрдЧ рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ рд░рд┐рдкреЛрд░реНрдЯ рдиреЗ рдкрд╛рдВрдЪ рд╡рд░реНрд╖реЛрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдпрд╛ рд╣реИ</a></li>
<li><a href="../hi479850/index.html">Exchange Server 2019 рдХреЛ Windows Server Core 2019 рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ</a></li>
<li><a href="../hi479852/index.html">рд╣реБрдб рдХреЗ рддрд╣рдд рд╡реАрдбрд┐рдпреЛ рдХреЙрд▓: рдПрдХ рд╕рдореНрдореЗрд▓рди рдореЗрдВ рд▓рд╛рдЦреЛрдВ рдкреНрд░рддрд┐ рджрд┐рди рд╕реЗ 100 рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рддрдХ</a></li>
<li><a href="../hi479854/index.html">12 рджрд┐рд╕рдВрдмрд░ рдХреА рд╕реБрдмрд╣ рдЬрд╛рд╡рд╛ рд╣рдЬрдо</a></li>
<li><a href="../hi479860/index.html">рдЬреАрд╡рди рдореЙрдбрд▓рд┐рдВрдЧ рдХреЗ рд╡рд┐рд╖рдп рдкрд░ рдПрдХ рдмрджрд▓рд╛рд╡ред рднрд╛рдЧ реи</a></li>
<li><a href="../hi479862/index.html">рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рддреЗ рд╕рдордп 15 000 рд░реВрдмрд▓ рдХреА рдмрдЪрдд рдХреИрд╕реЗ рдХрд░реЗрдВ</a></li>
<li><a href="../hi479864/index.html">16 рд╡рд░реНрд╖реЛрдВ рдореЗрдВ WinForms + C # рдкрд░ рдЦреЗрд▓ (2 рднрд╛рдЧ)</a></li>
<li><a href="../hi479870/index.html">рд╣рдо рдЬрд╛рдиреЗ рдкрд░ рд░реВрдкрд░реЗрдЦрд╛ рдФрд░ рдХрд╛рд░реНрдп рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдмрджрд▓рддреЗ рд╣реИрдВ - рдФрд░ рди рдХреЗрд╡рд▓ред PHP NN рдХреЗ рджреВрд╕рд░реЗ mitap рдкрд░ рдХреНрдпрд╛ рд╣реЛрдЧрд╛</a></li>
<li><a href="../hi479874/index.html">рдореИрдВ рдереЙрдЯрд╡рд░реНрдХреНрд╕ рдпрд╛ рдПрдХ рдЕрдиреБрдХрд░рдгреАрдп рд╕рд╛рдХреНрд╖рд╛рддреНрдХрд╛рд░ рдореЗрдВ рдХреИрд╕реЗ рдЖрдпрд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>