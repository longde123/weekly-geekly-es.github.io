<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>↪️ 🈸 🔗 iOS 12: agrupación de notificaciones 🍬 😘 📟</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este artículo, como el anterior , está dedicado a los cambios en las notificaciones que aparecieron en iOS 12. 



 En el último artículo hablé sobre ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>iOS 12: agrupación de notificaciones</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/e-Legion/blog/416439/"><p>  Este artículo, como el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">anterior</a> , está dedicado a los cambios en las <strong>notificaciones</strong> que aparecieron en iOS 12. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fx/i6/9m/fxi69mfudubpnrldzj-w04z-j50.png" width="400"></div><br><p>  En el último artículo hablé sobre innovaciones generales, esta vez me detendré en la agrupación de notificaciones con más detalle. </p><a name="habracut"></a><br><h3 id="gruppirovka-v-ios-12">  Agrupación en iOS 12 </h3><br><p>  Para que las notificaciones provenientes de su aplicación se agrupen en iOS 12, no necesita hacer nada, la agrupación se realizará automáticamente.  Las notificaciones en la pantalla comenzarán a acumularse cuando su número llegue a 5. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kt/bi/ld/ktbild9jk0ey2gbbdbr4rhcvdow.png"></div><br><p>  El usuario tiene la oportunidad de influir en la agrupación a través de la configuración del sistema. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ui/an/df/uiandfufwzfcwfsm-fi4rrfamoa.png" width="300"></div><br><ul><li>  <strong>Automático</strong> (predeterminado): la aplicación controla la configuración de agrupación. </li><li>  <strong>Por aplicación</strong> : la configuración de la aplicación se ignora, todas las notificaciones de la aplicación se agregan a una sola pila. </li><li>  <strong>Desactivado</strong> : la configuración de la aplicación se ignora, la agrupación de notificaciones está desactivada </li></ul><br><h3 id="nastroyka-gruppirovki">  Configuración de agrupamiento </h3><br><p>  Podemos influir en la agrupación de mensajes solo si se usa el indicador <strong>Automático</strong> en la configuración.  Para hacer esto, la notificación debe especificar el parámetro <strong>thread-id</strong> .  También pasamos el <strong>thread-id</strong> a la notificación de <strong>subtítulos</strong> para mayor claridad: </p><br><pre><code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> content = <span class="hljs-type"><span class="hljs-type">UNMutableNotificationContent</span></span>() content.threadIdentifier = threadId content.subtitle = <span class="hljs-string"><span class="hljs-string">"Thread ID: \(threadId)"</span></span></code> </pre> <br><p>  Enviamos varios mensajes y vemos el resultado de la agrupación: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kw/i5/si/kwi5sij_d57mjiwnnbyaanfwnbw.png" width="300"></div><br><p>  También puede pasar <strong>thread-id</strong> para enviar notificaciones: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"aps"</span></span> : { <span class="hljs-attr"><span class="hljs-attr">"alert"</span></span> : { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span> : <span class="hljs-string"><span class="hljs-string">"Cat Title"</span></span> <span class="hljs-string"><span class="hljs-string">"body"</span></span> : <span class="hljs-string"><span class="hljs-string">"Cat Body"</span></span> } <span class="hljs-string"><span class="hljs-string">"thread-id"</span></span> : <span class="hljs-string"><span class="hljs-string">"all-cats"</span></span> } }</code> </pre> <br><p>  Cuando especifique el identificador para la notificación, no olvide especificarlo en la categoría <strong>UNNotificationCategory</strong> ; de lo contrario, no se procesarán en la extensión para notificaciones: </p><br><pre> <code class="hljs lisp">UNNotificationCategory(<span class="hljs-name"><span class="hljs-name">identifier</span></span>: <span class="hljs-string"><span class="hljs-string">"Cat-Category"</span></span>, actions: actions, intentIdentifiers: [<span class="hljs-string"><span class="hljs-string">"all-cats"</span></span>, <span class="hljs-string"><span class="hljs-string">"3-star-cats"</span></span>], options: [])</code> </pre> <br><p>  Para una categoría, puede especificar el formato del mensaje que el usuario mostrará en el dispositivo, esta es una de las innovaciones de iOS 12. Solo puede hacer esto al inicializar la categoría: </p><br><pre> <code class="hljs lisp">UNNotificationCategory(<span class="hljs-name"><span class="hljs-name">identifier</span></span>: <span class="hljs-string"><span class="hljs-string">"category-simple"</span></span>, actions: actions, intentIdentifiers: [<span class="hljs-string"><span class="hljs-string">"all-cats"</span></span>, <span class="hljs-string"><span class="hljs-string">"3-star-cats"</span></span>], hiddenPreviewsBodyPlaceholder: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, categorySummaryFormat: <span class="hljs-string"><span class="hljs-string">"%u     %@"</span></span>, options: [])</code> </pre> <br><p>  El parámetro <strong>% u</strong> es responsable de la cantidad de mensajes en el grupo; se puede modificar utilizando el argumento <strong>summaryArgumentCount</strong> .  Por ejemplo, publicó una nueva selección de gatos, en la que 10 nuevas imágenes.  No tiene sentido enviar 10 pistolas al usuario, puede enviar un mensaje con un contador igual a 10. El parámetro <strong>% @</strong> muestra el valor de la variable <strong>summaryArgument</strong> en la pantalla: </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> content = <span class="hljs-type"><span class="hljs-type">UNMutableNotificationContent</span></span>() content.summaryArgumentCount = <span class="hljs-number"><span class="hljs-number">10</span></span> content.summaryArgument = <span class="hljs-string"><span class="hljs-string">" "</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hg/sm/ua/hgsmuaxk8n5cbuwbae3j97lzixa.png" width="300"></div><br><p>  En cada grupo tenemos 3 mensajes, pero debido al hecho de que se <strong>especifica el</strong> parámetro <strong>summaryArgumentCount</strong> , el número de mensajes se muestra igual a 20. Y el <strong>summaryArgument</strong> nos permite agregar el nombre de la categoría a la que pertenecen las notificaciones push.  No está mal, pero ahora tenemos un problema de localización. </p><br><h3 id="lokalizaciya">  Localización </h3><br><p>  Para implementar la tarea de localización, agregue un <strong>archivo Stringdict</strong> al proyecto. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/op/sv/mf/opsvmfv0kdvvpgjgprijttimqnq.png" width="500"></div><br><p>  Cambie la <strong>clave de cadena localizada</strong> a <strong>NOTIFICATION_SUMMARY</strong> , de lo contrario, los valores del diccionario no se procesarán, a pesar de que cuando se recibe una cadena localizada, se pasa como parámetro una clave con el nombre del diccionario.  Los valores restantes se muestran en la figura: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ai/bv/kn/aibvknayyeg8842wwjr6_z0xrne.png" width="500"></div><br><p>  En el <strong>Inspector de archivos</strong> para el diccionario, seleccione <strong>Localizar</strong> . </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xk/um/-2/xkum-2l7wcpms3hmoldgp2qvuvc.png" width="250"></div><br><p>  Especificamos archivos para localización. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/to/nr/xk/tonrxkdqqhjo9a4g95zw_onvngq.png" width="500"></div><br><p>  Entramos en la configuración del proyecto y agregamos el idioma para localizar el <strong>ruso (ru)</strong> . </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/12/ud/md/12udmdia1te9-koqhz4j2cpeaqm.png" width="400"></div><br><p>  Los archivos en exceso se pueden eliminar del proyecto. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5f/1e/ql/5f1eqls9euqc1ukmddwaym1ev3e.png" width="400"></div><br><p>  En el código, obtenemos la cadena localizada y la pasamos como el parámetro <strong>categorySummaryFormat</strong> : </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> summary = <span class="hljs-type"><span class="hljs-type">NSString</span></span>.localizedUserNotificationString(forKey: <span class="hljs-string"><span class="hljs-string">"NOTIFICATION_SUMMARY"</span></span>, arguments: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> category = <span class="hljs-type"><span class="hljs-type">UNNotificationCategory</span></span>(identifier: <span class="hljs-string"><span class="hljs-string">"Cat-Category"</span></span>, actions: actions, intentIdentifiers: [<span class="hljs-string"><span class="hljs-string">"all-cats"</span></span>, <span class="hljs-string"><span class="hljs-string">"3-star-cats"</span></span>], hiddenPreviewsBodyPlaceholder: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, categorySummaryFormat: summary, options: [])</code> </pre> <br><p>  Como resultado, obtenemos una excelente localización de aplicaciones. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/db/39/rb/db39rbutt3ygp3adnbmkzc2qfcg.png" width="300"></div><br><p>  El proyecto creado para el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">último artículo ha</a> sido actualizado, el código se puede encontrar en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github</a> .  Dos informes en WWDC se dedicaron a la implementación de notificaciones: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Novedades en las notificaciones de usuarios</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Uso de notificaciones agrupadas</a> .  Podremos discutir las innovaciones en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MBLT DEV 2018</a> en Moscú el 28 de septiembre. </p><br><p>  ¡Que tengas una buena semana!  ^ _ ^ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es416439/">https://habr.com/ru/post/es416439/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es416429/index.html">Principios de diseño previstos para Jakarta EE</a></li>
<li><a href="../es416431/index.html">Los mejores proyectos blockchain. ICO julio de 2018 (votación)</a></li>
<li><a href="../es416433/index.html">Pregúntele a Ethan: ¿Pueden las pérdidas de radiación estelar explicar la energía oscura?</a></li>
<li><a href="../es416435/index.html">¿Por qué es tan efectivo el cerebro humano?</a></li>
<li><a href="../es416437/index.html">¿Hay suficientes productos químicos en los mundos helados para mantener la vida allí?</a></li>
<li><a href="../es416441/index.html">Seguimiento de tono, o determinación de la frecuencia de tono en el habla, utilizando Praat, YAAPT e YIN como ejemplos</a></li>
<li><a href="../es416443/index.html">9 secretos de ASP.NET Core</a></li>
<li><a href="../es416445/index.html">Seminarios web de Skillbox: los más interesantes, gratis</a></li>
<li><a href="../es416449/index.html">.NET Core + Docker en Raspberry Pi. ¿Es esto legal?</a></li>
<li><a href="../es416451/index.html">Las bases de datos de Microsoft Research ahora están disponibles para todos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>