<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóØÔ∏è üßëüèø‚Äçü§ù‚Äçüßëüèª üòß Mathe in Gamedev ist einfach. Vektoren und Integrale üëØ üàÇÔ∏è üè•</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits! Heute m√∂chte ich √ºber Mathematik sprechen. Mathematik ist eine sehr interessante Wissenschaft und kann bei der Entwicklung von Spiel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mathe in Gamedev ist einfach. Vektoren und Integrale</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430146/"> Hallo allerseits!  Heute m√∂chte ich √ºber Mathematik sprechen.  Mathematik ist eine sehr interessante Wissenschaft und kann bei der Entwicklung von Spielen und bei der Arbeit mit Computergrafiken sehr n√ºtzlich sein.  Viele (insbesondere Anf√§nger) wissen einfach nicht, wie es in der Entwicklung verwendet wird.  Es gibt viele Probleme, die kein tiefes Verst√§ndnis solcher Konzepte erfordern: Integrale, komplexe Zahlen, Gruppen, Ringe usw., aber dank der Mathematik k√∂nnen Sie viele interessante Probleme l√∂sen.  In diesem Artikel betrachten wir Vektoren und Integrale.  Bei Interesse herzlich willkommen bei cat.  Das Illustrating Unity-Projekt ist wie immer beigef√ºgt. <br><br><img src="https://habrastorage.org/webt/si/-v/9f/si-v9fgzx1j01amuhr9eueauiie.jpeg"><br><a name="habracut"></a><br>  <b>Vektormathematik.</b> <br><br>  Vektoren und Vektormathematik sind wesentliche Werkzeuge f√ºr die Spieleentwicklung.  Viele Operationen und Aktionen sind vollst√§ndig damit verbunden.  Es ist lustig, dass f√ºr die Implementierung einer Klasse, die den Pfeil eines Vektors in Unity anzeigt, bereits die meisten typischen Operationen ausgef√ºhrt wurden.  Wenn Sie sich mit Vektormathematik auskennen, ist dieser Block f√ºr Sie nicht interessant. <br><br>  <b>Vektorarithmetik und n√ºtzliche Funktionen</b> <br><br>  Analytische Formeln und andere Details sind einfach zu googeln, sodass wir keine Zeit damit verschwenden.  Die Operationen selbst werden unten durch GIF-Animationen veranschaulicht. <br><br>  <i>Es ist wichtig zu verstehen, dass jeder Punkt im Wesentlichen ein Vektor mit einem Start am Nullpunkt ist.</i> <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterst√ºtzt kein HTML5-Video. <source src="https://media.giphy.com/media/cNIrQX8PrV1J62zzKJ/giphy.mp4" type="video/mp4"></video></div></div></div><br><br>  Gifs wurden mit Unity erstellt, daher m√ºsste eine Klasse implementiert werden, die f√ºr das Rendern von Pfeilen verantwortlich ist.  Ein Vektorpfeil besteht aus drei Hauptkomponenten - einer Linie, einer Spitze und einem Text mit dem Namen eines Vektors.  Um eine Linie und einen Tipp zu zeichnen, habe ich LineRenderer verwendet.  Schauen wir uns die Klasse des Vektors selbst an: <br><br><div class="spoiler">  <b class="spoiler_title">Pfeilklasse</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> TMPro; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">VectorArrow</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 _VectorStart; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 _VectorEnd; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> TextOffsetY; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TMP_Text _Label; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Color _Color; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> LineRenderer _Line; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _CupLength; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> LineRenderer _Cup; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnValidate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { UpdateVector(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateVector</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_Line == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || _Cup == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; SetColor(_Color); _Line.positionCount = _Cup.positionCount = <span class="hljs-number"><span class="hljs-number">2</span></span>; _Line.SetPosition(<span class="hljs-number"><span class="hljs-number">0</span></span>, _VectorStart); _Line.SetPosition(<span class="hljs-number"><span class="hljs-number">1</span></span>, _VectorEnd - (_VectorEnd - _VectorStart).normalized * _CupLength); _Cup.SetPosition(<span class="hljs-number"><span class="hljs-number">0</span></span>, _VectorEnd - (_VectorEnd - _VectorStart).normalized * _CupLength); _Cup.SetPosition(<span class="hljs-number"><span class="hljs-number">1</span></span>, _VectorEnd ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_Label != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dv = _VectorEnd - _VectorStart; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> normal = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(-dv.y, dv.x).normalized; normal = normal.y &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? normal : -normal; _Label.transform.localPosition = (_VectorEnd + _VectorStart) / <span class="hljs-number"><span class="hljs-number">2</span></span> + normal * TextOffsetY; _Label.transform.up = normal; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetPositions</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 start, Vector3 end</span></span></span><span class="hljs-function">)</span></span> { _VectorStart = start; _VectorEnd = end; UpdateVector(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetLabel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> label</span></span></span><span class="hljs-function">)</span></span> { _Label.text = label; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetColor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Color color</span></span></span><span class="hljs-function">)</span></span> { _Color = color; _Line.startColor = _Line.endColor = _Cup.startColor = _Cup.endColor = _Color; } }</code> </pre> <br></div></div><br>  Da der Vektor eine bestimmte L√§nge haben soll und genau den von uns angegebenen Punkten entspricht, wird die L√§nge der Linie nach folgender Formel berechnet: <br><br><pre> <code class="cs hljs">_VectorEnd - (_VectorEnd - _VectorStart).normalized * _CupLength</code> </pre> <br>  In dieser Formel <i>(_VectorEnd - _VectorStart) ist .normalized</i> die Richtung des Vektors.  Dies kann aus der Animation mit der Differenz der Vektoren verstanden werden, vorausgesetzt, dass <i>_VectorEnd</i> und <i>_VectorStart</i> Vektoren mit einem Start bei (0,0,0) sind. <br><br>  Als n√§chstes analysieren wir die beiden verbleibenden Grundoperationen: <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterst√ºtzt kein HTML5-Video. <source src="https://media.giphy.com/media/ki8xgF72Ym8iLzByVS/giphy.mp4" type="video/mp4"></video></div></div></div><br>  Das Finden der Normalen (senkrecht) und der Mitte des Vektors sind sehr h√§ufige Aufgaben bei der Entwicklung von Spielen.  Analysieren wir sie am Beispiel einer Signatur auf einem Vektor. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dv = _VectorEnd - _VectorStart; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> normal = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(-dv.y, dv.x).normalized; normal = normal.y &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? normal : -normal; _Label.transform.localPosition = (_VectorEnd + _VectorStart) / <span class="hljs-number"><span class="hljs-number">2</span></span> + normal * TextOffsetY; _Label.transform.up = normal;</code> </pre> <br>  Um den Text senkrecht zum Vektor zu platzieren, ben√∂tigen wir eine Normalen.  In 2D-Grafiken ist das Normale recht einfach. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dv = _VectorEnd - _VectorStart; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> normal = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(-dv.y, dv.x).normalized;</code> </pre> <br>  Also haben wir das Normal zum Segment gebracht. <br><br>  normal = normal.y&gt; 0?  normal: -normal;  - Diese Operation ist daf√ºr verantwortlich, dass der Text immer √ºber dem Vektor angezeigt wird. <br><br>  Dann bleibt es, um es in der Mitte des Vektors zu platzieren und es normal auf eine Entfernung anzuheben, die sch√∂n aussehen wird. <br><br><pre> <code class="cs hljs">_Label.transform.localPosition = (_VectorEnd + _VectorStart) / <span class="hljs-number"><span class="hljs-number">2</span></span> + normal * TextOffsetY;</code> </pre> <br>  Der Code verwendet lokale Positionen, damit Sie den resultierenden Pfeil verschieben k√∂nnen. <br><br>  Aber es ging um 2D, aber was ist mit 3D? <br><br>  In 3D ist Plus oder Minus dasselbe.  Nur die Normalformel unterscheidet sich, da die Normalform bereits nicht zum Segment, sondern zur Ebene gef√ºhrt wird. <br><br><div class="spoiler">  <b class="spoiler_title">Skript f√ºr die Kamera</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SphereCameraController</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Camera _Camera; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _DistanceFromPlanet = <span class="hljs-number"><span class="hljs-number">10</span></span>; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _Offset = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _IsMoving; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> Action&lt;Vector3, Vector3, Vector3, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>&gt; OnMove; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetMouseButtonDown(<span class="hljs-number"><span class="hljs-number">0</span></span>) &amp;&amp; !_IsMoving) { RaycastHit hit; Debug.Log(<span class="hljs-string"><span class="hljs-string">"Click"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ray = _Camera.ScreenPointToRay(Input.mousePosition); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Physics.Raycast(ray, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> hit)) { Debug.Log(<span class="hljs-string"><span class="hljs-string">"hit"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startPosition = _Camera.transform.position; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> right = Vector3.Cross(hit.normal, Vector3.up).normalized; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> endPosition = hit.point + hit.normal * _DistanceFromPlanet + right * _Offset; StartCoroutine(MoveCoroutine(startPosition, endPosition, hit.point + right * _Offset)); OnMove?.Invoke(startPosition, hit.point, hit.normal, _DistanceFromPlanet, _Offset); } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveCoroutine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 start, Vector3 end, Vector3 lookAt</span></span></span><span class="hljs-function">)</span></span> { _IsMoving = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startForward = transform.forward; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> timer = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (timer &lt; Scenario.AnimTime) { transform.position = Vector3.Slerp(start, end, timer / Scenario.AnimTime); transform.forward = Vector3.Slerp(startForward, (lookAt - transform.position).normalized, timer / Scenario.AnimTime); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; timer += Time.deltaTime; } transform.position = end; transform.forward = (lookAt - transform.position).normalized; _IsMoving = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre> <br></div></div><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterst√ºtzt kein HTML5-Video. <source src="https://media.giphy.com/media/bbB1tdbYPoWPKPH7tD/giphy.mp4" type="video/mp4"></video></div></div></div><br>  In diesem Steuerbeispiel wird die Normalen zur Ebene verwendet, um den Endpunkt der Flugbahn nach rechts zu verschieben, damit die Schnittstelle den Planeten nicht blockiert.  Normal in 3D-Grafiken ist ein normalisiertes Vektorprodukt aus zwei Vektoren.  Was praktisch ist, in Unity gibt es beide Operationen und wir erhalten eine sch√∂ne kompakte Aufzeichnung: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> right = Vector3.Cross(hit.normal, Vector3.up).normalized;</code> </pre> <br>  Ich denke, dass f√ºr viele, die denken, dass Mathematik nicht ben√∂tigt wird und warum man sie √ºberhaupt wissen muss, ein wenig klarer geworden ist, welche Probleme damit einfach und elegant gel√∂st werden k√∂nnen.  Aber es war eine einfache Option, die jeder Spieleentwickler als Praktikant nicht kennen sollte.  Erh√∂hen Sie die Messlatte - sprechen Sie √ºber die Integrale. <br><br>  <b>Integrale</b> <br><br>  Im Allgemeinen haben Integrale viele Anwendungen, wie z. B. physikalische Simulationen, VFX, Analytik und vieles mehr.  Ich bin jetzt nicht bereit, alles im Detail zu beschreiben.  Ich m√∂chte eine einfache und visuell verst√§ndliche beschreiben.  Reden wir √ºber Physik. <br><br>  Angenommen, es gibt eine Aufgabe - ein Objekt an einen bestimmten Punkt zu verschieben.  Wenn Sie beispielsweise einen bestimmten Ausl√∂ser eingeben, sollten B√ºcher aus den Regalen herausfliegen.  Wenn Sie sich gleichm√§√üig und ohne Physik bewegen m√∂chten, ist die Aufgabe trivial und erfordert keine Integrale. Wenn jedoch ein Geist ein Buch aus dem Regal schiebt, sieht eine solche Geschwindigkeitsverteilung v√∂llig anders aus. <br><br>  Was ist ein Integral? <br><br>  Tats√§chlich ist dies der Bereich unter der Kurve.  Aber was bedeutet das im Kontext der Physik?  Angenommen, Sie haben eine Geschwindigkeitsverteilung √ºber die Zeit.  In diesem Fall ist der Bereich unter der Kurve der Pfad, den das Objekt durchlaufen wird, und genau das ben√∂tigen wir. <br><br><img src="https://habrastorage.org/webt/v2/j1/fi/v2j1firdsma31y_gey3e6kmquok.png"><br><br>  Unity hat ein gro√üartiges Tool namens AnimationCurve, das von der Theorie zur Praxis √ºbergeht.  Mit ihm k√∂nnen Sie die Verteilung der Geschwindigkeit √ºber die Zeit festlegen.  Lassen Sie uns eine solche Klasse erstellen. <br><br><div class="spoiler">  <b class="spoiler_title">Klasse MoveObj</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; [RequireComponent(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Rigidbody))] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MoveObject</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Transform _Target; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GraphData _Data; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Rigidbody _Rigidbody; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _Rigidbody = GetComponent&lt;Rigidbody&gt;(); Move(<span class="hljs-number"><span class="hljs-number">2f</span></span>, _Data.AnimationCurve); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Move</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> time, AnimationCurve speedLaw</span></span></span><span class="hljs-function">)</span></span> { StartCoroutine(MovingCoroutine(time, speedLaw)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MovingCoroutine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> time, AnimationCurve speedLaw</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> timer = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dv = (_Target.position - transform.position); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> distance = dv.magnitude; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> direction = dv.normalized; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> speedK = distance / (Utils.GetApproxSquareAnimCurve(speedLaw) * time); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (timer &lt; time) { _Rigidbody.velocity = speedLaw.Evaluate(timer / time) * direction * speedK; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">yield</span></span></span><span class="hljs-function"> return new </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WaitForFixedUpdate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; timer += Time.fixedDeltaTime; } _Rigidbody.isKinematic = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } }</code> </pre> <br></div></div><br>  Die GetApproxSquareAnimCurve-Methode ist unsere Integration.  Wir machen es zur einfachsten numerischen Methode. Gehen Sie einfach die Werte der Funktionen durch und fassen Sie sie eine bestimmte Anzahl von Malen zusammen.  Ich habe 1000 f√ºr die Wiedergabetreue eingestellt. Im Allgemeinen k√∂nnen Sie das Beste ausw√§hlen. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Iterations = <span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetApproxSquareAnimCurve</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AnimationCurve curve</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> square = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt;= Iterations; i++) { square += curve.Evaluate((<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) i / Iterations); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> square / Iterations; }</code> </pre> <br>  Dank dieses Bereichs wissen wir bereits, wie gro√ü die relative Entfernung ist.  Wenn wir dann die beiden zur√ºckgelegten Wege vergleichen, erhalten wir den Geschwindigkeitskoeffizienten speedK, der daf√ºr verantwortlich ist, dass wir die angegebene Strecke zur√ºcklegen. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterst√ºtzt kein HTML5-Video. <source src="https://media.giphy.com/media/yxfjOIjg8k9agGpCZ9/giphy.mp4" type="video/mp4"></video></div></div></div><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterst√ºtzt kein HTML5-Video. <source src="https://media.giphy.com/media/azI2ni7K6kwFr3LHDw/giphy.mp4" type="video/mp4"></video></div></div></div><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterst√ºtzt kein HTML5-Video. <source src="https://media.giphy.com/media/t8XCi5GR2uiat4vfQ4/giphy.mp4" type="video/mp4"></video></div></div></div><br>  M√∂glicherweise stellen Sie fest, dass die Objekte nicht genau √ºbereinstimmen. Dies liegt an einem Float-Fehler.  Im Allgemeinen k√∂nnen Sie dasselbe dezimal neu berechnen und dann f√ºr eine h√∂here Genauigkeit im Float √ºberholen. <br><br>  Eigentlich ist das alles f√ºr heute.  Wie immer gibt es am Ende einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link zum GitHub-Projekt</a> , in dem alle Quellen f√ºr diesen Artikel enthalten sind.  Und du kannst mit ihnen spielen. <br><br>  Wenn der Artikel eingeht, mache ich eine Fortsetzung, in der ich Sie √ºber die Verwendung etwas komplexerer Konzepte wie komplexe Zahlen, Felder, Gruppen und mehr informieren werde. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de430146/">https://habr.com/ru/post/de430146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de430136/index.html">Wie sie Starlink - Satelliten-Internet von Ilona Mask starten</a></li>
<li><a href="../de430138/index.html">Optimierung eines Handelsroboters: ein genetischer Algorithmus</a></li>
<li><a href="../de430140/index.html">F√ºnf Gr√ºnde f√ºr das Scheitern von SEO. Analyse erfolgloser Werbeerfahrungen anhand von Beispielen</a></li>
<li><a href="../de430142/index.html">Ist dein Windows so alt?</a></li>
<li><a href="../de430144/index.html">Wir simulieren einen realistischen Fluss in Houdini und Unreal Engine 4</a></li>
<li><a href="../de430148/index.html">Verlust personenbezogener Daten aus Moskauer MFCs</a></li>
<li><a href="../de430152/index.html">Die Installation eines eigenen professionellen Audioverst√§rkers ist nicht (sehr) teuer</a></li>
<li><a href="../de430154/index.html">"Revival of AI" ist nichts anderes als teure Hardware und Werbung, die aufgegeben wird, um eine alte Idee umzusetzen</a></li>
<li><a href="../de430156/index.html">"Abheben oder nicht": Ein neuer Player wird auf dem Markt f√ºr Streaming-Videodienste erscheinen</a></li>
<li><a href="../de430158/index.html">10 Sicherheitsgebote, die f√ºr jede Organisation n√ºtzlich sein k√∂nnen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>