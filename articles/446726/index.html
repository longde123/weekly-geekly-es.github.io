<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª‚Äçüéì üë∂üèΩ üë©üèΩ‚Äçü§ù‚Äçüë®üèª Aprendizaje profundo en computaci√≥n de flujo √≥ptico üíµ üìé ‚Ü™Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Con el advenimiento de muchas arquitecturas de redes neuronales diferentes, muchas t√©cnicas cl√°sicas de visi√≥n por computadora son cosa del pasado. Ca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprendizaje profundo en computaci√≥n de flujo √≥ptico</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/446726/">  Con el advenimiento de muchas arquitecturas de redes neuronales diferentes, muchas t√©cnicas cl√°sicas de visi√≥n por computadora son cosa del pasado.  Cada vez menos personas usan SIFT y HOG para la detecci√≥n de objetos, y MBH para el reconocimiento de acciones, y si lo usan, es m√°s como signos hechos a mano para las cuadr√≠culas correspondientes.  Hoy vamos a ver uno de los problemas cl√°sicos de CV en el que los m√©todos cl√°sicos a√∫n mantienen el liderazgo, mientras que las arquitecturas DL los respiran l√°nguidamente en la parte posterior de la cabeza. <br><br><img src="https://habrastorage.org/webt/6z/eh/72/6zeh726hjzbg1t7k20ob4wy9_o4.png"><br><a name="habracut"></a><br><h2>  Estimaci√≥n de flujo √≥ptico. </h2><br>  La tarea de calcular el flujo √≥ptico entre dos im√°genes (generalmente entre cuadros adyacentes de un video) es construir un campo vectorial <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.057ex" viewBox="0 -780.1 763.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-4F" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> O </script>  del mismo tama√±o, por otra parte <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.377ex" height="2.66ex" viewBox="0 -832 2745.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="1498" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6A" x="1943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="2356" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2"> O (i, j) </script>  corresponder√° al vector aparente de desplazamiento de p√≠xeles <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.604ex" height="2.66ex" viewBox="0 -832 1982.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6A" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="1592" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3"> (i, j) </script>  del primer cuadro al segundo.  Al construir dicho campo vectorial entre todos los cuadros adyacentes del video, obtenemos una imagen completa de c√≥mo se mueven ciertos objetos sobre √©l.  En otras palabras, esta es la tarea de rastrear todos los p√≠xeles en un video.  El flujo √≥ptico se usa de manera extremadamente amplia: en las tareas de reconocimiento de acciones, por ejemplo, un campo vectorial de este tipo le permite concentrarse en los movimientos que ocurren en el video y alejarse de su contexto [7].  Incluso las aplicaciones m√°s comunes son la odometr√≠a visual, la compresi√≥n de video, el procesamiento posterior (por ejemplo, agregar un efecto de c√°mara lenta) y mucho m√°s. <br><br><img src="https://habrastorage.org/webt/pf/hx/t6/pfhxt6t_fawwqjyxiptno85zyge.png" width="720" height="360"><br><br>  Hay espacio para algunas ambig√ºedades: ¬øqu√© se considera exactamente un sesgo visible desde el punto de vista de las matem√°ticas?  Por lo general, se supone que los valores de p√≠xeles van de un cuadro a otro sin cambios, en otras palabras: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>+</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><mi>j</mi><mo>+</mo><msub><mi>u</mi><mi>j</mi></msub><mo>,</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.096ex" height="2.78ex" viewBox="0 -832 14249.5 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="894" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="1239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6A" x="1684" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="2097" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-74" x="2542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="2903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-3D" x="3571" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-49" x="4627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="5131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="5521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2B" x="6089" y="0"></use><g transform="translate(7089,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="8006" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6A" x="8451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2B" x="9086" y="0"></use><g transform="translate(10087,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="11051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-74" x="11496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2B" x="12080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-31" x="13081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="13581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="13971" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>I</mi><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><mi>j</mi><mo>+</mo><msub><mi>u</mi><mi>j</mi></msub><mo>,</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> I (i, j, t) = I (i + u_i, j + u_j, t + 1), </script></p>  donde <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.649ex" height="2.66ex" viewBox="0 -832 3293.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="894" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="1239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6A" x="1684" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="2097" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-74" x="2542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="2903" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5"> I (i, j, t) </script>  - intensidad de p√≠xeles en coordenadas <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.604ex" height="2.66ex" viewBox="0 -832 1982.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6A" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="1592" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6"> (i, j) </script>  entonces flujo √≥ptico <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msub><mi>u</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.212ex" height="2.78ex" viewBox="0 -832 3105.2 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="1306" y="0"></use><g transform="translate(1751,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="2715" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> (u_i, u_j) </script>  muestra d√≥nde se ha movido este p√≠xel al siguiente punto en el tiempo (es decir, en el siguiente cuadro). <br><br>  En la imagen se ve as√≠: <br><br><img src="https://habrastorage.org/webt/55/pv/ql/55pvqliwe25q4uz58mc9vhf5z9m.gif"><br><br><img src="https://habrastorage.org/webt/vk/5b/wr/vk5bwroklj2xdi_ncrk-zihvhic.gif"><br><br>  Visualizar un campo vectorial directamente con vectores es visual, pero no siempre es conveniente, por lo tanto, la segunda forma com√∫n es visualizar con color: <br><br><img src="https://habrastorage.org/webt/eb/lc/a2/eblca2o7vwo_d0wtyw8gm9axdte.gif"><br><br><img src="https://habrastorage.org/webt/v4/fp/pe/v4fppenisw4sf3psqncsmg_7xqm.gif"><br><br>  Cada color en esta imagen codifica un vector espec√≠fico.  Para simplificar, se recortan vectores de m√°s de 20, y el vector en s√≠ mismo se puede restaurar por color a partir de la siguiente imagen: <br><br><img src="https://habrastorage.org/webt/wa/fo/eh/wafoeh4p14ei82ascjk7te6i0go.png" width="320" height="320"><br><br><div class="spoiler">  <b class="spoiler_title">¬°M√°s flujo de gatos!</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/4l/mo/nt/4lmont9w39gboi9b127uvnnkxqw.gif"><br><img src="https://habrastorage.org/webt/ki/-p/z4/ki-pz4kopzo9dlhzxc9u01kbkmk.gif"><br><img src="https://habrastorage.org/webt/v1/tb/xw/v1tbxwqp0sxnugfok07tksnzmds.gif"><br><img src="https://habrastorage.org/webt/pn/vj/ds/pnvjdsmzb1ikdyk3koiyfmlbp68.gif"><br><img src="https://habrastorage.org/webt/w4/wd/z-/w4wdz-cvvu21hust2ldrueki_cw.gif"><br><img src="https://habrastorage.org/webt/fx/xz/wy/fxxzwyibq5qcpaapl4tcj0f2mju.gif"><br><img src="https://habrastorage.org/webt/lo/kj/0w/lokj0wamraallgkyt1el0udou0e.gif"><br><img src="https://habrastorage.org/webt/ui/2k/ac/ui2kacgkblcf9c_5u5hkdelnxfg.gif"><br><img src="https://habrastorage.org/webt/hc/g0/me/hcg0mecxdbevoasfbcrsavhnbte.gif"><br><img src="https://habrastorage.org/webt/f3/gr/32/f3gr32ufn8t4rhuoecwnjhqy2l0.gif"><br><img src="https://habrastorage.org/webt/yr/dm/4t/yrdm4t_qnwmpoeurnwyhawdxgqw.gif"><br><img src="https://habrastorage.org/webt/p3/rb/qi/p3rbqiggl8o5tptv21ydinm5wfw.gif"><br></div></div><br>  Los m√©todos cl√°sicos han logrado una precisi√≥n bastante buena, que a veces tiene un precio.  Consideraremos el progreso que las redes neuronales han logrado en la soluci√≥n de este problema en los √∫ltimos 4 a√±os. <br><br><h2>  Datos y m√©tricas </h2><br>  Dos palabras sobre qu√© conjuntos de datos estaban disponibles y populares al comienzo de nuestra historia (es decir, 2015), y c√≥mo medir la calidad del algoritmo resultante. <br><br><h5>  Middlebury </h5><br>  Un peque√±o conjunto de datos de 8 pares de im√°genes con peque√±os desplazamientos, que, sin embargo, a veces se usa para validar algoritmos para calcular el flujo √≥ptico incluso ahora. <br><br><img src="https://habrastorage.org/webt/nc/oo/tt/ncoott5vvw5zietkw5vz6xixzpa.png"><br><br><h5>  Gatito </h5><br>  Este es un conjunto de datos marcado para aplicaciones para autom√≥viles sin conductor y ensamblado con tecnolog√≠a LIDAR.  Es ampliamente utilizado para validar algoritmos de c√°lculo de flujo √≥ptico y contiene muchos casos bastante complicados con transiciones bruscas entre cuadros. <br><br><img src="https://habrastorage.org/webt/nc/6c/82/nc6c824qepdccm51ynf1uc9ip5i.jpeg"><br><br><h5>  Sintel </h5><br>  Otro punto de referencia muy com√∫n creado sobre la base del dibujo abierto y dibujado de Sintel en Blender en dos versiones, que se designan como limpio y final.  El segundo es mucho m√°s complicado, porque  contiene muchos efectos atmosf√©ricos, ruido, desenfoque y otros problemas para los algoritmos para calcular el flujo √≥ptico. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZmiBI4tPk_o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h5>  EPE </h5><br>  La funci√≥n de error est√°ndar para la tarea de c√°lculo del flujo √≥ptico es Error de punto final o EPE.  Esto es simplemente la distancia euclidiana entre el algoritmo calculado y el flujo √≥ptico verdadero, promediado sobre todos los p√≠xeles. <br><br><h2>  Flownet (2015) </h2><br>  Al embarcarse en la construcci√≥n de una arquitectura de red neuronal para la tarea de calcular el flujo √≥ptico en 2015, los autores (de las universidades de M√∫nich y Friburgo) enfrentaron dos problemas: no hab√≠a un gran conjunto de datos marcado para esta tarea, y marcarlo manualmente ser√≠a dif√≠cil (intente marcar d√≥nde me he movido cada p√≠xel de la imagen en el siguiente cuadro), en primer lugar.  Esta tarea era bastante diferente de todas las tareas que se resolvieron con la ayuda de arquitecturas CNN antes de eso, en segundo lugar.  De hecho, esta es una tarea de regresi√≥n p√≠xel por p√≠xel, lo que la hace similar a la tarea de segmentaci√≥n (clasificaci√≥n p√≠xel por p√≠xel), pero en lugar de una imagen, tenemos dos entradas, e intuitivamente, los signos deben mostrar de alguna manera la diferencia entre las dos im√°genes.  Como primera iteraci√≥n, se decidi√≥ simplemente hacer estallar dos cuadros RGB como entrada (habiendo recibido, de hecho, una imagen de 6 canales), entre los cuales queremos calcular el flujo √≥ptico, y tomar U-net como una arquitectura con una serie de cambios.  Esta red se llamaba FlowNetS (S significa Simple): <br><br><img src="https://habrastorage.org/webt/pv/tw/ss/pvtwssodmmsjy6a58kmlvovgp80.png"><br><br><img src="https://habrastorage.org/webt/uj/tl/g-/ujtlg-sweodxqqisb9kjehzd_2a.png"><br><br>  Como puede ver en el diagrama, el codificador no se nota, el decodificador difiere de las opciones cl√°sicas de varias maneras: <br><br><ol><li>  La predicci√≥n del flujo √≥ptico ocurre no solo desde el √∫ltimo nivel, sino tambi√©n desde todos los dem√°s.  Para obtener Ground Truth para el i-√©simo nivel del decodificador, el objetivo original (es decir, el flujo √≥ptico) simplemente se reduce (casi lo mismo que la imagen) a la resoluci√≥n deseada, y el predicado obtenido en el i-√©simo nivel va m√°s all√°, t es decir, se concatena con un mapa de caracter√≠sticas que emerge de este nivel.  La funci√≥n general de las p√©rdidas de entrenamiento ser√° una suma ponderada de p√©rdidas de todos los niveles del decodificador, mientras que el peso en s√≠ ser√° mayor, cuanto m√°s cerca est√© el nivel de la salida de la red.  Los autores no dan una explicaci√≥n de por qu√© se hace esto, pero lo m√°s probable es que la raz√≥n sea el hecho de que los movimientos bruscos son mejores para detectar en los primeros niveles, entonces los vectores en el flujo √≥ptico de baja resoluci√≥n no ser√°n tan grandes. </li><li>  El diagrama muestra que la resoluci√≥n de entrada de las im√°genes es 384x512, y la salida es cuatro veces menor.  Los autores notaron que si aumenta esta salida a 384x512 por interpolaci√≥n bilineal simple, dar√° la misma calidad que si conecta dos niveles m√°s del decodificador.  Tambi√©n puede usar el enfoque variacional [2], que demuestra la calidad (+ v en la tabla con calidad). </li><li>  Como en U-net, las tarjetas de atributos del codificador se env√≠an al decodificador y se concatenan como se muestra en el diagrama. </li></ol><br><img src="https://habrastorage.org/webt/n3/hv/wt/n3hvwta--ipyc3rvgod2w1lfrnu.png"><br><br>  Para comprender c√≥mo los autores trataron de mejorar su l√≠nea de base, necesita saber cu√°l es la correlaci√≥n entre las im√°genes y por qu√© puede ser √∫til para calcular el flujo √≥ptico.  Entonces, teniendo dos im√°genes y sabiendo que el segundo es el siguiente cuadro en el video en relaci√≥n con el primero, podemos intentar comparar el √°rea alrededor del punto en el primer cuadro (para el que queremos encontrar un cambio al segundo cuadro) con √°reas del mismo tama√±o en la segunda imagen.  Adem√°s, suponiendo que el cambio no pueda ser demasiado grande por unidad de tiempo, la comparaci√≥n solo puede considerarse en un determinado vecindario del punto de partida.  Para esto, se utiliza la correlaci√≥n cruzada.  Vamos a ilustrar con un ejemplo. <br><br>  Tome dos cuadros adyacentes del video, queremos determinar d√≥nde un cierto punto ha cambiado del primer cuadro al segundo.  Suponga que alguna √°rea alrededor de este punto ha cambiado de la misma manera.  De hecho, los p√≠xeles vecinos en un video generalmente se compensan, como  lo m√°s probable, visualmente, son parte de un objeto.  Este supuesto se usa activamente, por ejemplo, en enfoques diferenciales, que se pueden leer con m√°s detalle en [5], [6]. <br><br><pre><code class="python hljs">fig, ax = plt.subplots(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) ax[<span class="hljs-number"><span class="hljs-number">0</span></span>].imshow(frame1) ax[<span class="hljs-number"><span class="hljs-number">1</span></span>].imshow(frame2);</code> </pre> <br><img src="https://habrastorage.org/webt/an/it/s5/anits5i5bvq4kreaodhtn1xtxeg.png"><br><br>  Tratemos de tomar un punto en el centro de la pata del gatito y encontrarlo en el segundo cuadro.  Toma un √°rea alrededor. <br><br><pre> <code class="python hljs">patch1 = frame1[<span class="hljs-number"><span class="hljs-number">90</span></span>:<span class="hljs-number"><span class="hljs-number">190</span></span>, <span class="hljs-number"><span class="hljs-number">140</span></span>:<span class="hljs-number"><span class="hljs-number">250</span></span>] plt.imshow(patch1);</code> </pre> <br><img src="https://habrastorage.org/webt/mr/he/rg/mrherghnedxhdep1yus3wvrtym8.png"><br><br>  Calculamos la correlaci√≥n entre esta √°rea (en la literatura inglesa a menudo escribimos plantillas o parches a partir de la primera imagen) y la segunda imagen.  La plantilla simplemente "caminar√°" a trav√©s de la segunda imagen y calcular√° el siguiente valor entre s√≠ misma y piezas del mismo tama√±o en la segunda imagen: <br><br><img src="https://habrastorage.org/webt/iz/jz/vi/izjzvibw_g1nqwnpttrby6qtax8.png"><br><br>  Cuanto mayor sea el valor de este valor, m√°s se ver√° la plantilla como la pieza correspondiente en la segunda imagen.  Con OpenCV, esto se puede hacer as√≠: <br><br><pre> <code class="python hljs">corr = cv2.matchTemplate(frame2, patch1, cv2.TM_CCORR_NORMED) plt.imshow(corr, cmap=<span class="hljs-string"><span class="hljs-string">'gray'</span></span>);</code> </pre><br>  Se pueden encontrar m√°s detalles en [7]. <br><br>  El resultado es el siguiente: <br><br><img src="https://habrastorage.org/webt/k0/k_/ph/k0k_phkyfonxwflqwatxrw6hynu.png"><br><br>  Vemos un pico claro, indicado en blanco.  Encu√©ntralo en el segundo cuadro: <br><br><pre> <code class="python hljs">min_val, max_val, min_loc, max_loc = cv2.minMaxLoc(corr) h, w, _ = patch1.shape top_left = max_loc bottom_right = (top_left[<span class="hljs-number"><span class="hljs-number">0</span></span>] + w, top_left[<span class="hljs-number"><span class="hljs-number">1</span></span>] + h) frame2_copy = frame2.copy() cv2.rectangle(frame2_copy, top_left, bottom_right, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) plt.imshow(frame2_copy);</code> </pre> <br><img src="https://habrastorage.org/webt/bo/11/v9/bo11v9zepjhqgzm5f_b6ckbrmbs.png"><br><br>  Vemos que el pie se encontr√≥ correctamente, de acuerdo con estos datos, podemos entender en qu√© direcci√≥n se movi√≥ del primer cuadro al segundo y calcular el flujo √≥ptico correspondiente.  Adem√°s, resulta que esta operaci√≥n es bastante resistente a las distorsiones fotom√©tricas, es decir.  Si el brillo en el segundo cuadro aumenta bruscamente, el pico de correlaci√≥n cruzada entre las im√°genes permanecer√° en su lugar. <br><br>  Teniendo en cuenta todo lo anterior, los autores decidieron introducir la llamada capa de correlaci√≥n en su arquitectura, pero se decidi√≥ no considerar la correlaci√≥n seg√∫n las im√°genes de entrada, sino seg√∫n los mapas de caracter√≠sticas despu√©s de varias capas de codificador.  Tal capa, por razones obvias, no tiene par√°metros de aprendizaje, aunque en esencia es similar a la convoluci√≥n, pero en lugar de filtros, aqu√≠ no usamos pesos, sino alguna √°rea de la segunda imagen: <br><br><img src="https://habrastorage.org/webt/j2/xx/bg/j2xxbga6vl1jvffhsbjzndhkul4.png"><br><br>  Por extra√±o que parezca, este truco no proporcion√≥ una mejora significativa en la calidad de los autores de este art√≠culo, sin embargo, se aplic√≥ con m√°s √©xito en trabajos posteriores, y en [9] los autores pudieron demostrar que al cambiar ligeramente los par√°metros de entrenamiento, FlowNetC puede funcionar mucho mejor. <br><br>  Los autores resolvieron el problema con la falta de un conjunto de datos de una manera bastante elegante: rasparon 964 im√°genes de Flickr sobre los temas: "ciudad", "paisaje", "monta√±a" en la resoluci√≥n de 1024 √ó 768 y utilizaron su recorte 512 √ó 384 como fondo, que luego arroj√≥ algunas sillas de un conjunto abierto de modelos 3D prestados.  Luego, varias transformaciones afines se aplicaron independientemente a las sillas y al fondo, que se utilizaron para generar la segunda imagen en un par y el flujo √≥ptico entre ellas.  El resultado es el siguiente: <br><br><img src="https://habrastorage.org/webt/4y/s7/qn/4ys7qnoa1fn9s8kaw_kclb_dtig.png"><br><br><img src="https://habrastorage.org/webt/07/y2/k5/07y2k5ryvqboyvz6w8udnenc5fq.png"><br><br>  Un resultado interesante fue que el uso de un conjunto de datos sint√©tico de este tipo hizo posible lograr una calidad relativamente buena para los datos de otro dominio.  El ajuste fino en los datos correspondientes, por supuesto, demostr√≥ m√°s cualidades (+ pies en la tabla a continuaci√≥n): <br><br><img src="https://habrastorage.org/webt/vu/wz/vt/vuwzvtxwgfrwsl5okrh_bgrk9ao.png"><br><br>  El resultado en videos reales se puede ver aqu√≠: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/k_wkDLJ8lJE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  SpyNet (2016) </h2><br>  En muchos art√≠culos posteriores, los autores trataron de mejorar la calidad resolviendo el problema del mal reconocimiento de los movimientos repentinos.  Intuitivamente, el movimiento no ser√° capturado por la red si su vector va significativamente m√°s all√° del campo receptivo de activaci√≥n.  Se propone resolver este problema debido a tres cosas: una convoluci√≥n mayor, pir√°mides y "deformar" una imagen de un par en una corriente √≥ptica.  Todo en orden. <br><br>  Entonces, si tenemos un par de im√°genes en las que el objeto se ha desplazado bruscamente (m√°s de 10 p√≠xeles), entonces simplemente podemos reducir la imagen (en 6 o m√°s veces).  El valor absoluto del desplazamiento disminuir√° significativamente, y es m√°s probable que la red pueda "atraparlo", especialmente si sus convoluciones son mayores que el desplazamiento en s√≠ (en este caso, se usan convoluciones 7x7). <br><br><img src="https://habrastorage.org/webt/ec/-w/c4/ec-wc4u9vfdfqhcw-auhrcbmdqo.jpeg"><br><br>  Sin embargo, al reducir la imagen, perdimos muchos detalles importantes, por lo que debemos pasar al siguiente nivel de la pir√°mide, en el que el tama√±o de la imagen ya es m√°s grande, teniendo en cuenta de alguna manera la informaci√≥n que recibimos antes cuando calculamos el flujo √≥ptico en un tama√±o m√°s peque√±o.  Esto se realiza utilizando el operador de deformaci√≥n, que relata la primera imagen de acuerdo con la aproximaci√≥n disponible del flujo √≥ptico (obtenido en el nivel anterior).  Una mejora en este caso es que la primera imagen que se "empuja" de acuerdo con la aproximaci√≥n del flujo √≥ptico estar√° m√°s cerca de la segunda que la original, es decir, nuevamente reduciremos el valor absoluto del flujo √≥ptico, que debemos predecir (recordar, peque√±o en valor los movimientos se detectan mucho mejor, ya que est√°n completamente incluidos en una convoluci√≥n).  Desde el punto de vista de las matem√°ticas, con una imagen de mapa de bits I y una aproximaci√≥n del flujo √≥ptico V, el operador de deformaci√≥n se puede describir de la siguiente manera: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>w</mi><mo stretchy=&quot;false&quot;>(</mo><mi>I</mi><mo>,</mo><mi>V</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>I</mi><mi>w</mi></msub><mo>,</mo><mspace width=&quot;thickmathspace&quot; /><mspace width=&quot;thickmathspace&quot; /><msub><mi>I</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>I</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>+</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="36.715ex" height="2.66ex" viewBox="0 -832 15807.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-49" x="1106" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="1610" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-56" x="2055" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="2825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-3D" x="3492" y="0"></use><g transform="translate(4548,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-77" x="622" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="5595" y="0"></use><g transform="translate(6596,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-77" x="622" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="7643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-78" x="8033" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="8605" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-3D" x="9273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-49" x="10329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="10833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-78" x="11223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2B" x="12018" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-56" x="13018" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="13788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-78" x="14177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="14750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="15139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="15529" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>w</mi><mo stretchy="false">(</mo><mi>I</mi><mo>,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>I</mi><mi>w</mi></msub><mo>,</mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><msub><mi>I</mi><mi>w</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>I</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>V</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>,</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> w (I, V) = I_w, \; \; I_w (x) = I (x + V (x)), </script></p>  donde <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.032ex" height="2.66ex" viewBox="0 -832 3888.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="1906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="2296" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="2641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6A" x="3086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="3499" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9"> x = (i, j) </script>  es decir  un punto espec√≠fico en la imagen <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.172ex" height="2.057ex" viewBox="0 -780.1 504.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-49" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> I </script>  - la imagen en s√≠ <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.787ex" height="2.057ex" viewBox="0 -780.1 769.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-56" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> V </script>  - flujo √≥ptico <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>w</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.432ex" height="2.419ex" viewBox="0 -780.1 1047.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-77" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>w</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-12"> I_w </script>  - la imagen resultante, "envuelta" en la corriente √≥ptica. <br><br>  ¬øC√≥mo aplicar todo esto en la arquitectura CNN?  Arreglamos la cantidad de niveles piramidales <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> k </script>  y un factor por el cual cada imagen subsiguiente se reduce a un nivel que comienza desde el √∫ltimo <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-14"> n </script>  .  Denote por <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.188ex" height="2.66ex" viewBox="0 -832 1803 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2217" x="913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="1413" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mo>‚àó</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15"> d (*) </script>  y <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>u</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.301ex" height="2.66ex" viewBox="0 -832 1852 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-75" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2217" x="962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="1462" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo stretchy="false">(</mo><mo>‚àó</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-16"> u (*) </script>  las funciones de disminuci√≥n y muestreo de la imagen o flujo √≥ptico por este factor. <br><br>  Tambi√©n obtendremos un conjunto de CNN-ok { <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mn>0</mn></msub><mo>.</mo><mo>.</mo><mo>.</mo><msub><mi>G</mi><mi>k</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.898ex" height="2.419ex" viewBox="0 -780.1 3831.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-30" x="1112" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2E" x="1240" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2E" x="1685" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2E" x="2130" y="0"></use><g transform="translate(2575,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6B" x="1112" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mn>0</mn></msub><mo>.</mo><mo>.</mo><mo>.</mo><msub><mi>G</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-17"> G_0 ... G_k </script>  }, uno para cada nivel de la pir√°mide.  Entonces <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.626ex" height="2.419ex" viewBox="0 -780.1 1130.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-18"> G_i </script>  -th network aceptar√° un par de im√°genes con <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="1.937ex" viewBox="0 -728.2 345.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-19"> i </script>  nivel de pir√°mide y flujo √≥ptico calculado en <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.727ex" height="2.539ex" viewBox="0 -780.1 2035.2 1093.4" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-47" x="0" y="0"></use><g transform="translate(786,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2212" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-31" x="1124" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-20"> G_ {i-1} </script>  nivel ( <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mn>0</mn></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.881ex" height="2.419ex" viewBox="0 -780.1 1240.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-30" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-21"> G_0 </script>  solo aceptar√° un tensor de ceros en su lugar).  En este caso, enviaremos una de las im√°genes a la capa de deformaci√≥n para reducir la diferencia entre ellas, y no predeciremos el flujo √≥ptico a este nivel, sino el valor que debe agregarse al flujo √≥ptico incrementado (muestreado) del nivel anterior para obtener el flujo √≥ptico a este nivel  En la f√≥rmula, se ve as√≠: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>v</mi><mi>k</mi></msub><mo>=</mo><msub><mi>G</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>I</mi><mi>k</mi><mn>1</mn></msubsup><mo>,</mo><mi>w</mi><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>I</mi><mi>k</mi><mn>2</mn></msubsup><mo>,</mo><mi>u</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.384ex" height="3.021ex" viewBox="0 -883.9 14373.7 1300.8" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6B" x="686" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-3D" x="1232" y="0"></use><g transform="translate(2288,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6B" x="1112" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="3543" y="0"></use><g transform="translate(3933,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-31" x="740" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6B" x="622" y="-463"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="4910" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-77" x="5355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="6072" y="0"></use><g transform="translate(6461,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-32" x="740" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6B" x="622" y="-463"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="7439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-75" x="7884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="8457" y="0"></use><g transform="translate(8846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-56" x="0" y="0"></use><g transform="translate(583,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2212" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-31" x="1300" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="10803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="11192" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="11582" y="0"></use><g transform="translate(12027,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-56" x="0" y="0"></use><g transform="translate(583,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2212" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-31" x="1300" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="13984" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>v</mi><mi>k</mi></msub><mo>=</mo><msub><mi>G</mi><mi>k</mi></msub><mo stretchy="false">(</mo><msubsup><mi>I</mi><mi>k</mi><mn>1</mn></msubsup><mo>,</mo><mi>w</mi><mo stretchy="false">(</mo><msubsup><mi>I</mi><mi>k</mi><mn>2</mn></msubsup><mo>,</mo><mi>u</mi><mo stretchy="false">(</mo><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>,</mo><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-22"> v_k = G_k (I_k ^ 1, w (I_k ^ 2, u (V_ {k-1})), V_ {k-1}) </script></p><br>  Para obtener el flujo √≥ptico en s√≠, simplemente agregamos el predicado de red y el flujo aumentado desde el nivel anterior: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>V</mi><mi>k</mi></msub><mo>=</mo><mi>u</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>v</mi><mi>k</mi></msub><mo>.</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.929ex" height="2.66ex" viewBox="0 -832 8150.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6B" x="825" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-3D" x="1330" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-75" x="2386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-28" x="2958" y="0"></use><g transform="translate(3348,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-56" x="0" y="0"></use><g transform="translate(583,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2212" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-31" x="1300" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-29" x="5304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2B" x="5916" y="0"></use><g transform="translate(6917,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6B" x="686" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2E" x="7871" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mi>k</mi></msub><mo>=</mo><mi>u</mi><mo stretchy="false">(</mo><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>v</mi><mi>k</mi></msub><mo>.</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-23"> V_k = u (V_ {k-1}) + v_k. </script></p>  Para obtener Ground Truth para la red en este nivel, necesitamos hacer la operaci√≥n opuesta: restar el predicado del objetivo (reducido al nivel deseado) del nivel anterior de la pir√°mide.  Esquem√°ticamente, se ve as√≠: <br><br><img src="https://habrastorage.org/webt/yh/sa/_1/yhsa_1bbklhllkzucdplckzkgk4.png"><br><br>  La ventaja de este enfoque es que podemos ense√±ar cada nivel de forma independiente.  Los autores comenzaron a entrenar desde el nivel 0, cada red posterior se inicializ√≥ con los par√°metros de la anterior.  Desde cada red <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.626ex" height="2.419ex" viewBox="0 -780.1 1130.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-24"> G_i </script>  resuelve el problema mucho m√°s simple que el c√°lculo completo del flujo √≥ptico en una imagen grande, entonces los par√°metros se pueden hacer mucho menos.  Tanto es as√≠ que ahora todo el conjunto puede caber en dispositivos m√≥viles: <br><br><img src="https://habrastorage.org/webt/hc/8o/hs/hc8ohs8qo36ifqfzlrxio5c6gas.png"><br><br>  El conjunto en s√≠ es el siguiente (un ejemplo de una pir√°mide de 3 niveles): <br><br><img src="https://habrastorage.org/webt/x1/5e/n1/x15en1dysqgqcbfs9qlmwqse7da.png"><br><br>  Queda por hablar directamente sobre arquitectura. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.626ex" height="2.419ex" viewBox="0 -780.1 1130.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25"> G_i </script>  red y hacer balance.  Cada red <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.626ex" height="2.419ex" viewBox="0 -780.1 1130.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-69" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-26"> G_i </script>  consta de 5 capas convolucionales, cada una de las cuales termina con la activaci√≥n de ReLU, excepto la √∫ltima (que predice el flujo √≥ptico).  El n√∫mero de filtros en cada capa es respectivamente { <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>32</mn><mo>,</mo><mn>64</mn><mo>,</mo><mn>32</mn><mo>,</mo><mn>16</mn><mo>,</mo><mn>2</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.598ex" height="2.419ex" viewBox="0 -780.1 6285.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="1001" y="0"></use><g transform="translate(1446,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-36"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-34" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="2447" y="0"></use><g transform="translate(2892,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="3893" y="0"></use><g transform="translate(4338,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-2C" x="5339" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMAIN-32" x="5784" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>32</mn><mo>,</mo><mn>64</mn><mo>,</mo><mn>32</mn><mo>,</mo><mn>16</mn><mo>,</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-27"> 32, 64, 32, 16, 2 </script>  }.  Las entradas de la red neuronal (la imagen, la segunda imagen "envuelta" en el flujo √≥ptico y el flujo √≥ptico en s√≠) simplemente se concatenan de acuerdo con la dimensi√≥n de los canales, por lo que su tensor de entrada tiene 8. Los resultados son impresionantes: <br><br><img src="https://habrastorage.org/webt/sm/gf/s5/smgfs5juy2q0nnpv4gptlatevlw.png"><br><br><h2>  PWC-Net (2018) </h2><br>  Inspirados por el √©xito de sus colegas alemanes, los muchachos de NVIDIA decidieron aplicar su experiencia (y tarjetas de video) para mejorar a√∫n m√°s el resultado.  Su trabajo se bas√≥ en gran medida en ideas del modelo anterior (SpyNet), por lo que PWC-Net tambi√©n tratar√° con pir√°mides, pero con pir√°mides de convoluci√≥n, no las im√°genes originales, sin embargo, en orden. <br><br>  El uso de intensidades de p√≠xeles sin procesar para calcular el flujo √≥ptico no siempre es razonable, porque  Un cambio brusco en el brillo / contraste romper√° nuestra suposici√≥n de que los p√≠xeles se mueven de un cuadro a otro sin cambios y el algoritmo no ser√° resistente a dichos cambios.  En los algoritmos cl√°sicos para calcular el flujo √≥ptico, se utilizan varias transformaciones que mitigan esta situaci√≥n, en este caso, los autores decidieron proporcionar al modelo la oportunidad de aprender ellos mismos.  Por lo tanto, en lugar de la pir√°mide de imagen en PWC-Net, se utilizan pir√°mides de convoluci√≥n (de ah√≠ la primera letra en Pwc-Net), es decir.  solo mapas de caracter√≠sticas de diferentes capas de CNN, que aqu√≠ se llama extractor de pir√°mide de caracter√≠sticas. <br><br>  Entonces, todo es casi como en SpyNet, justo antes de enviarlo a CNN, que se llama estimador de flujo √≥ptico, todo lo que necesita, a saber: <br><br><ul><li>  imagen (en este caso, un mapa de caracter√≠sticas del extractor de pir√°mides de caracter√≠sticas), </li><li>  el flujo √≥ptico muestreado arriba calculado en el nivel anterior, </li><li>  la segunda imagen, "envuelta" (recuerde la capa de deformaci√≥n, de ah√≠ la segunda letra en pWc-Net) en esta corriente √≥ptica, </li></ul><br>  entre el segundo cuadro "envuelto" y el primero habitual (de nuevo, le recuerdo que en lugar de im√°genes sin procesar, aqu√≠ se usan tarjetas de caracter√≠sticas con extractor de pir√°mides de caracter√≠sticas) considere lo que se llama volumen de costos (de ah√≠ la tercera letra en pwC-Net) y que esencialmente ya est√° correlaci√≥n previamente considerada entre dos im√°genes. <br><br><img src="https://habrastorage.org/webt/mh/f1/rl/mhf1rlctjqtb8pwymdzzlju1dpa.png"><br><br>  El toque final es la red de contexto, que se agrega inmediatamente despu√©s del estimador de flujo √≥ptico y desempe√±a el papel de procesamiento posterior capacitado para el flujo √≥ptico calculado.  Los detalles arquitect√≥nicos se pueden ver debajo del spoiler o en el art√≠culo original. <br><br><div class="spoiler">  <b class="spoiler_title">Detalles √≠ntimos</b> <div class="spoiler_text">  Entonces, el extractor piramidal de caracter√≠sticas tiene los mismos pesos para ambas im√°genes, ReLU con fugas se usa como no linealidad para cada convoluci√≥n.  Para reducir la resoluci√≥n de los mapas de caracter√≠sticas en cada nivel posterior, se utilizan convoluciones con paso 2, y <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>c</mi><mi>t</mi><mi>l</mi></msubsup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.833ex" height="3.037ex" viewBox="0 -950 789.1 1307.5" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.83ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6C" x="613" y="500"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-74" x="613" y="-395"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>c</mi><mi>t</mi><mi>l</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-28"> c_t ^ l </script>  significa mapa de caracter√≠sticas de imagen <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="1.936ex" viewBox="0 -713 361.5 833.5" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-74" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-29"> t </script>  a nivel <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.693ex" height="2.074ex" viewBox="0 -772.3 298.5 892.8" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/446726/&amp;usg=ALkJrhhq0sWQs-084CkVreESfuV_pt6oDA#MJMATHI-6C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-30"> l </script>  . <br><br><img src="https://habrastorage.org/webt/er/m5/r3/erm5r3r3hriaukcisvezaosvfcu.png"><br><br>  Estimador de flujo √≥ptico en el segundo nivel de la pir√°mide (por ejemplo).  No hay nada inusual aqu√≠, cada convoluci√≥n todav√≠a termina con ReLU con fugas, excepto la √∫ltima, que predice el flujo √≥ptico. <br><br><img src="https://habrastorage.org/webt/rm/n4/jw/rmn4jwq6vf31ml4xe7-tnyyqkno.png"><br><br>  La red de contexto todav√≠a est√° en el mismo segundo nivel de la pir√°mide, esta red utiliza convoluciones dilatadas con las mismas activaciones de ReLU con fugas, excepto en la √∫ltima capa.  Recibe el flujo √≥ptico calculado por el estimador de flujo √≥ptico y los atributos de la segunda capa desde el extremo de la capa con el mismo estimador de flujo √≥ptico.  El √∫ltimo d√≠gito en cada bloque significa dilataci√≥n constante. <br><br><img src="https://habrastorage.org/webt/yj/wj/6r/yjwj6r38by_6fx3bxym5civ0pwu.png"><br><br></div></div><br>  Los resultados son a√∫n m√°s impresionantes: <br><br><img src="https://habrastorage.org/webt/iy/8c/h3/iy8ch3ploolmtrinveqzokfehdo.png"><br><br>  En comparaci√≥n con otros m√©todos de CNN para calcular el flujo √≥ptico, PWC-Net logra un equilibrio entre la calidad y la cantidad de par√°metros: <br><br><img src="https://habrastorage.org/webt/te/3c/6n/te3c6n3jziiqxwv9cggfowif27u.png"><br><br>  Tambi√©n hay una excelente presentaci√≥n de los propios autores, en la que hablan sobre el modelo en s√≠ y sus experimentos: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/vVU8XV0Ac_0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Conclusi√≥n </h2><br>  La evoluci√≥n de las arquitecturas que resuelven el problema del conteo de flujo √≥ptico es un maravilloso ejemplo de c√≥mo el progreso en las arquitecturas CNN y su combinaci√≥n con m√©todos cl√°sicos da el mejor y el mejor resultado.  Y aunque los m√©todos cl√°sicos de CV a√∫n ganan en calidad, los resultados recientes dan la esperanza de que esto sea reparable ... <br><br><h2>  Fuentes y enlaces </h2><br>  1. FlowNet: Flujo √≥ptico de aprendizaje con redes convolucionales: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c√≥digo</a> . <br>  2. Flujo √≥ptico de gran desplazamiento: coincidencia del descriptor en la estimaci√≥n del movimiento variacional: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> . <br>  3. Estimaci√≥n del flujo √≥ptico utilizando una red de pir√°mide espacial: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c√≥digo</a> . <br>  4. PWC-Net: CNNs para flujo √≥ptico usando pir√°mide, deformaci√≥n y volumen de costos: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c√≥digo</a> . <br>  5. Lo que quer√≠a saber sobre el flujo √≥ptico, pero se avergonz√≥ de preguntar: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> . <br>  6. C√°lculo del flujo √≥ptico por el m√©todo Lucas-Canad√°.  Teor√≠a: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> . <br>  7. Plantilla que coincide con OpenCVP: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dock</a> . <br>  8. Quo Vadis, ¬øreconocimiento de acci√≥n?  Un nuevo modelo y el conjunto de datos cin√©ticos: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> . <br>  9. FlowNet 2.0: Evoluci√≥n de la estimaci√≥n del flujo √≥ptico con redes profundas: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c√≥digo</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/446726/">https://habr.com/ru/post/446726/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446714/index.html">Perversiones curiosas del mundo de TI - 4</a></li>
<li><a href="../446716/index.html">Conciencia y argumento del fin del mundo</a></li>
<li><a href="../446718/index.html">Revisi√≥n de los informes m√°s interesantes de CodeFest 2019: versi√≥n de True Engineering</a></li>
<li><a href="../446722/index.html">Las pruebas mostrar√°n: c√≥mo prepararse para la implementaci√≥n de Cisco ISE y comprender qu√© caracter√≠sticas del sistema necesita</a></li>
<li><a href="../446724/index.html">C√≥mo los desarrolladores de iOS est√°n buscando subir la apuesta con la computaci√≥n en la nube</a></li>
<li><a href="../446728/index.html">C√≥mo cambia la potencia recibida de la carga inal√°mbrica seg√∫n la ubicaci√≥n del tel√©fono</a></li>
<li><a href="../446730/index.html">Secci√≥n de back-end en DUMP: Serverless, Postgres and Go, .NET Core, GraphQL y m√°s</a></li>
<li><a href="../446732/index.html">Los feropodos no ayudar√°n: la investigaci√≥n y el modelado matem√°tico de trampas para larvas de hormigas le√≥n</a></li>
<li><a href="../446736/index.html">Oracle APEX Informes</a></li>
<li><a href="../446738/index.html">Conceptos b√°sicos del procesamiento del lenguaje natural para texto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>