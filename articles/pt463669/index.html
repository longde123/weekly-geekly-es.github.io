<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•Ñ üíØ ‚úÖ Protocolo MQTT: imers√£o conceitual üöÖ üíá üßìüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O protocolo MQTT (Transporte de Telemetria de Enfileiramento de Mensagens) √© usado h√° muitos anos, mas agora √© especialmente relevante devido ao cresc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Protocolo MQTT: imers√£o conceitual</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463669/">  O protocolo MQTT (Transporte de Telemetria de Enfileiramento de Mensagens) √© usado h√° muitos anos, mas agora √© especialmente relevante devido ao crescimento explosivo da IoT: dispositivos industriais e de consumidor implementam redes distribu√≠das e computa√ß√£o de borda, e dispositivos com transmiss√£o cont√≠nua de dados est√£o se tornando parte do cotidiano da vida. <br><br>  Isso significa que protocolos leves, abertos e acess√≠veis se tornar√£o ainda mais importantes ao longo do tempo.  Este artigo fornece uma imers√£o conceitual no MQTT: como funciona, como √© usado agora e como ser√° usado no futuro. <br><a name="habracut"></a><br><h1>  Pequena introdu√ß√£o </h1><br>  O MQTT √© um protocolo de mensagens com base em assinante do editor (pub / sub).  A vers√£o inicial em 1999 foi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">publicada por</a> Andy Stanford-Clark, da IBM, e Arlene Nipper, da Cirrus Link.  Eles visualizaram o MQTT como uma maneira de manter a comunica√ß√£o entre m√°quinas em redes com largura de banda limitada ou comunica√ß√µes imprevis√≠veis.  Uma das primeiras op√ß√µes para seu uso foi garantir que fragmentos do oleoduto estivessem em contato um com o outro e com os links centrais via sat√©lites. <br><br>  Dadas as condi√ß√µes operacionais adversas, o protocolo √© pequeno e leve.  √â ideal para dispositivos de baixa pot√™ncia e com autonomia limitada da bateria.  Agora, eles incluem smartphones onipresentes e o n√∫mero crescente de sensores e dispositivos conectados. <br><br>  Assim, o MQTT tornou-se um protocolo para transmitir dados entre dispositivos com pot√™ncia limitada da CPU e / ou dura√ß√£o da bateria, bem como para redes com largura de banda cara ou baixa, estabilidade imprevis√≠vel ou alta lat√™ncia.  √â por isso que o MQTT √© conhecido como o ve√≠culo ideal para a IoT.  Ele √© constru√≠do no protocolo TCP / IP, mas existe uma ramifica√ß√£o MQTT-SN para trabalhar via Bluetooth, UDP, ZigBee e outras redes de IoT que n√£o sejam TCP / IP. <br><br>  O MQTT n√£o √© o √∫nico protocolo de mensagens de pub / sub em tempo real de seu tipo, mas j√° se espalhou em v√°rios ambientes que dependem das comunica√ß√µes m√°quina a m√°quina.  Entre seus colegas est√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o Protocolo de Mensagens de Aplicativos da Web</a> , o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Protocolo</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">de Mensagens Orientadas a Texto de Streaming</a> e o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Protocolo de Enfileiramento de Mensagens Alternativo</a> . <br><br>  O MQTT √© a escolha l√≥gica para desenvolvedores que desejam criar aplicativos com funcionalidade confi√°vel e ampla compatibilidade com dispositivos e aplicativos conectados √† Internet, incluindo navegadores, smartphones e dispositivos de IoT. <br><br><h1>  Como o MQTT funciona: o b√°sico </h1><br>  O sistema de comunica√ß√£o constru√≠do no MQTT consiste em um servidor publicador, um servidor intermedi√°rio e um ou mais clientes.  O editor n√£o exige nenhuma configura√ß√£o para o n√∫mero ou o local dos assinantes que recebem mensagens.  Al√©m disso, os assinantes n√£o precisam ajustar para um editor espec√≠fico.  Pode haver v√°rios intermedi√°rios de mensagens no sistema. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/029/60b/c0b/02960bc0baf11fcfc7c8cd56d331ba4c.png"><br><br>  O MQTT fornece uma maneira de criar uma hierarquia de canais de comunica√ß√£o - um tipo de ramifica√ß√£o com folhas.  Sempre que o editor tiver novos dados para distribuir aos clientes, a mensagem ser√° acompanhada de uma nota de controle de entrega.  Clientes de n√≠vel superior podem receber cada mensagem, enquanto clientes de n√≠vel inferior podem receber mensagens relacionadas a apenas um ou dois canais b√°sicos, "ramifica√ß√µes" na parte inferior da hierarquia.  Isso facilita a troca de informa√ß√µes que variam em tamanho de dois bytes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">a 256 megabytes</a> . <br><br>  Um exemplo de como voc√™ pode configurar o cliente para conectar-se atrav√©s do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">broker MQTT</a> : <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> options = { <span class="hljs-attr"><span class="hljs-attr">keepalive</span></span>: <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-attr"><span class="hljs-attr">username</span></span>: <span class="hljs-string"><span class="hljs-string">'FIRST_HALF_OF_API_KEY'</span></span>, <span class="hljs-attr"><span class="hljs-attr">password</span></span>: <span class="hljs-string"><span class="hljs-string">'SECOND_HALF_OF_API_KEY'</span></span>, <span class="hljs-attr"><span class="hljs-attr">port</span></span>: <span class="hljs-number"><span class="hljs-number">8883</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = mqtt.connect(<span class="hljs-string"><span class="hljs-string">'mqtts:mqtt.ably.io'</span></span>, options);</code> </pre> <br>  Quaisquer dados publicados ou recebidos pelo broker MQTT ser√£o codificados em formato bin√°rio, pois o MQTT √© um protocolo bin√°rio.  Isso significa que, para obter o conte√∫do original, voc√™ precisa interpretar a mensagem.  Aqui est√° o que parece com Ably e JavaScript: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ably = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Ably.Realtime(<span class="hljs-string"><span class="hljs-string">'REPLACE_WITH_YOUR_API_KEY'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> decoder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TextDecoder(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> channel = ably.channels.get(<span class="hljs-string"><span class="hljs-string">'input'</span></span>); channel.subscribe(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">message</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> command = decoder.decode(message.data); });</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">√Äs</a> vezes, os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">intermedi√°rios do MQTT</a> podem acumular mensagens relacionadas a canais que n√£o possuem assinantes atuais.  Nesse caso, as mensagens ser√£o descartadas ou salvas, dependendo das instru√ß√µes na mensagem de controle.  Isso √© √∫til nos casos em que novos assinantes podem precisar do ponto de dados gravado mais recentemente, em vez de aguardar o pr√≥ximo envio. <br><br>  Vale ressaltar que o MQTT transmite credenciais de seguran√ßa em texto n√£o criptografado, caso contr√°rio, as fun√ß√µes de autentica√ß√£o ou seguran√ßa n√£o s√£o suportadas.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">√â aqui que a estrutura SSL entra em jogo</a> , ajudando a proteger as informa√ß√µes transmitidas contra intercepta√ß√£o ou adultera√ß√£o. <br><br>  Al√©m disso, no MQTT, voc√™ pode usar a autentica√ß√£o Ably em tokens se n√£o desejar divulgar sua chave de API para o cliente MQTT real (no caso de MQTT sem SSL, s√£o necess√°rios tokens para impedir a transfer√™ncia de chaves de API em texto n√£o criptografado).  Exemplo de autentica√ß√£o de token: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> options = { <span class="hljs-attr"><span class="hljs-attr">keepalive</span></span>: <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-attr"><span class="hljs-attr">username</span></span>: INSERT_TOKEN_HERE, <span class="hljs-attr"><span class="hljs-attr">password</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">port</span></span>: <span class="hljs-number"><span class="hljs-number">8883</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = mqtt.connect(<span class="hljs-string"><span class="hljs-string">'mqtts:mqtt.ably.io'</span></span>, options); client.subscribe(<span class="hljs-string"><span class="hljs-string">"[mqtt]tokenevents"</span></span>, { <span class="hljs-comment"><span class="hljs-comment">/* Create a new token called 'NEW_TOKEN' */</span></span> client.end(); options.username = NEW_TOKEN; client = mqtt.connect(<span class="hljs-string"><span class="hljs-string">'mqtts:mqtt.ably.io'</span></span>, options); });</code> </pre> <br><h1>  Funcionalidade MQTT: imers√£o mais profunda </h1><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">De acordo com a IBM</a> , o MQTT possui as seguintes propriedades: <br><br><ul><li>  Neutro no conte√∫do da mensagem <br></li><li>  Ideal para comunica√ß√µes um-para-muitos distribu√≠das e aplicativos desconectados <br></li><li>  Equipado com a fun√ß√£o LWT (Last Will and Testament, ‚Äúlast will and testament‚Äù) para notificar as partes sobre uma desconex√£o anormal do cliente <br></li><li>  Confia no TCP / IP para tarefas b√°sicas de comunica√ß√£o <br></li><li>  Projetado para entregar mensagens usando os modelos "no m√°ximo uma vez", "pelo menos uma vez" e "exatamente uma vez" </li></ul><br>  Um membro do sistema MQTT pode assumir a fun√ß√£o de publicador, consumidor ou ambas as fun√ß√µes ao mesmo tempo. <br><br>  Uma das caracter√≠sticas distintivas do MQTT √© seu entendimento exclusivo dos canais: cada um deles √© tratado como um caminho de arquivo, por exemplo: <br><br><pre> <code class="javascript hljs">channel = <span class="hljs-string"><span class="hljs-string">"user/path/channel"</span></span></code> </pre> <br>  Os canais garantem que todo cliente receba mensagens destinadas a ele.  Ao tratar os canais como caminhos de arquivo, o MQTT executa todos os tipos de fun√ß√µes de comunica√ß√£o √∫teis, incluindo a filtragem de mensagens com base em onde - em qual n√≠vel ou em qual filial - os clientes se inscrevem no caminho do arquivo. <br><br><h1>  Formato de mensagem MQTT </h1><br>  Veja os dois componentes que comp√µem cada mensagem do MQTT: <br><br><ul><li>  <b>Byte 1</b> : cont√©m o tipo de mensagem (solicita√ß√£o de conex√£o do cliente, confirma√ß√£o de assinatura, solicita√ß√£o de ping etc.), um sinalizador de duplica√ß√£o, instru√ß√µes para salvar mensagens e informa√ß√µes sobre a qualidade de servi√ßo (QoS). <br></li><li>  <b>Byte 2</b> : cont√©m informa√ß√µes sobre o tamanho restante da mensagem, incluindo a carga √∫til e quaisquer dados no cabe√ßalho de uma vari√°vel opcional. </li></ul><br>  O sinalizador QoS no byte 1 merece aten√ß√£o especial, pois est√° subjacente √† funcionalidade vari√°vel suportada pelo MQTT.  Os sinalizadores de QoS cont√™m os seguintes valores com base na inten√ß√£o e urg√™ncia da mensagem: <br><br><ul><li>  0 = n√£o mais de uma vez: o servidor √© acionado e esquece.  As mensagens podem ser perdidas ou duplicadas. <br></li><li>  1 = pelo menos uma vez: o destinat√°rio confirma a entrega.  As mensagens podem ser duplicadas, mas a entrega √© garantida <br></li><li>  2 = exatamente uma vez: o servidor fornece entrega.  As mensagens chegam exatamente uma vez sem perda ou duplica√ß√£o </li></ul><br>  Vejamos como usar os diferentes n√≠veis de QoS em dispositivos de IoT e outros aplicativos. <br><br><h1>  Onde posso usar o MQTT? </h1><br>  Como os aplicativos de IoT est√£o sendo implementados em grande escala, o MQTT surgiu como uma maneira aberta, simples e escal√°vel de implantar computa√ß√£o distribu√≠da e funcionalidade de IoT para uma base de usu√°rios mais ampla - tanto no mercado industrial quanto no consumidor. <br><br>  Como mencionado acima, o MQTT √© um protocolo de mensagens leve desenvolvido para redes e dispositivos n√£o confi√°veis ‚Äã‚Äãcom restri√ß√µes na fonte de alimenta√ß√£o e na CPU.  No entanto, isso n√£o significa que a conex√£o com a perda potencial de pacotes seja sua √∫nica aplica√ß√£o.  O MQTT fornece v√°rios n√≠veis de servi√ßo para v√°rios tipos de infraestrutura de IoT, desde a repeti√ß√£o da amostragem de dados at√© o gerenciamento de m√°quinas industriais: <br><br><ul><li>  <b>Dados do sensor ambiental</b> : Como j√° mencionado, o MQTT suporta o modelo de entrega de mensagens ‚Äún√£o mais que uma vez‚Äù.  Em redes com cobertura parcial ou alta lat√™ncia, isso significa que as informa√ß√µes podem ser perdidas ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">duplicadas</a> .  Nas √°reas em que os sensores remotos registram e transmitem dados em intervalos especificados, isso n√£o √© um problema, pois novas leituras s√£o recebidas regularmente.  Os sensores em ambientes remotos geralmente s√£o dispositivos de baixa energia, tornando o MQTT a solu√ß√£o ideal para sensores de IoT com uma prioridade de transfer√™ncia de dados relativamente baixa. <br></li><li>  <b>Dados de desempenho da m√°quina</b> : para responder rapidamente a problemas e evitar tempo de inatividade.  Por exemplo, uma instala√ß√£o de energia e√≥lica precisa fornecer os indicadores atuais de desempenho √†s equipes locais, mesmo antes que essas informa√ß√µes cheguem ao data center.  Em tais situa√ß√µes, a entrega de mensagens "pelo menos uma vez" garante que os especialistas apropriados sejam notados imediatamente pelos especialistas necess√°rios, mesmo que cheguem como duplicados.  Isso √© importante para comunica√ß√µes com m√°quinas de alta prioridade. <br></li><li>  <b>Sistemas de faturamento</b> : existem ainda mais mensagens precisas e priorit√°rias que precisam ser processadas corretamente.  Em situa√ß√µes de neg√≥cios em que a duplica√ß√£o de registros √© inaceit√°vel, inclusive em sistemas de cobran√ßa, o sinalizador de QoS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"exatamente uma vez"</a> √© √∫til.  Isso elimina a duplica√ß√£o ou perda de pacotes nos sistemas de cobran√ßa ou cobran√ßa, reduz o n√∫mero de anomalias e contradi√ß√µes desnecess√°rias, conforme combinado. </li></ul><br><h1>  Quando n√£o usar o MQTT? </h1><br>  Os desenvolvedores t√™m uma ampla sele√ß√£o de protocolos para projetar e implantar canais de comunica√ß√£o IoT bidirecional, incluindo MQTT, HTTP, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CoAP</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">WebSockets</a> (se a CPU / bateria permitir) e outros.  Se o MQTT √© a melhor op√ß√£o depende do hardware e da tarefa do aplicativo. <br><br>  Projetado para ambientes com largura de banda extremamente baixa, o protocolo MQTT pode ser bastante inflex√≠vel em sua busca para salvar todos os bytes.  Por exemplo, a especifica√ß√£o define apenas cinco mensagens de erro com as quais o servidor pode rejeitar a conex√£o (por exemplo, um nome de usu√°rio / senha inv√°lido ou uma vers√£o inaceit√°vel do protocolo).  Se o servidor quiser apontar para algum outro erro, est√° sem sorte.  Pior ainda, se ocorrer um erro ap√≥s o in√≠cio da conex√£o, n√£o h√° mecanismo para relatar um erro.  O servidor pode apenas encolher os ombros e encerrar abruptamente a conex√£o TCP, deixando o cliente sem a menor id√©ia do motivo pelo qual ele foi descartado (e sem nenhuma maneira de distinguir uma desconex√£o deliberada de um problema tempor√°rio na rede).  Para pessoas acostumadas aos protocolos pub / sub mais flex√≠veis e f√°ceis de depurar (embora menos econ√¥micos em termos de largura de banda), essa abordagem espartana pode parecer um pouco primitiva. <br><br>  O MQTT √© frequentemente referido juntamente com o HTTP; portanto, o Google conduziu um estudo comparando-os em tempo de resposta, volume de tr√°fego e outros atributos importantes para os desenvolvedores.  O MQTT ficou em primeiro lugar nos testes do Google, mas <i>apenas nas condi√ß√µes em que a conex√£o pode ser reutilizada</i> para enviar v√°rias cargas √∫teis. <br><br>  HTTP e MQTT s√£o uma boa op√ß√£o para aplicativos de IoT devido √† quantidade relativamente pequena de tr√°fego, pouca bateria e requisitos de mem√≥ria. <br><br>  O CoAP √© outro protocolo frequentemente comparado ao MQTT para o desenvolvimento de sistemas de IoT.  Eles s√£o semelhantes, mas existem diferen√ßas vis√≠veis.  O MQTT √© um protocolo muitos-para-muitos, enquanto o CoAP √© basicamente um protocolo um-para-um para comunica√ß√£o entre um servidor e um cliente.  Ao mesmo tempo, o CoAP fornece recursos de metadados, descoberta e negocia√ß√£o de conte√∫do <i>que o MQTT n√£o possui</i> . <br><br>  Nos casos em que os clientes devem receber apenas dados, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">os Eventos Enviados pelo Servidor</a> tamb√©m s√£o uma op√ß√£o adequada. <br><br><h1>  Como configurar rapidamente o MQTT </h1><br>  O reposit√≥rio MQTT no GitHub possui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">uma extensa lista de bibliotecas MQTT de c√≥digo aberto</a> em v√°rios idiomas.  A seguir est√£o dois exemplos de customiza√ß√£o usando o broker MQTT de c√≥digo aberto, a biblioteca JavaScript e a biblioteca .NET. <br><br><h3>  Eclipse Mosquitto - broker MQTT de c√≥digo aberto </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Eclipse Mosquitto</a> √© um broker de mensagens de c√≥digo aberto (EPL / EDL) que implementa os protocolos MQTT vers√£o 5.0, 3.1.1 e 3.1.  O Mosquitto √© leve e adequado para uso em todos os dispositivos: de computadores de placa √∫nica de baixo consumo a servidores de pleno direito. <br><br><h3>  MQTT.js </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MQTT.js</a> √© uma biblioteca cliente para o protocolo MQTT, escrita em JavaScript para Node.js. e um navegador.  Aqui est√° um exemplo de envio de uma mensagem usando o MQTT.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mqtt = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mqtt'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = mqtt.connect(<span class="hljs-string"><span class="hljs-string">'mqtt://test.mosquitto.org'</span></span>) client.on(<span class="hljs-string"><span class="hljs-string">'connect'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ client.subscribe(<span class="hljs-string"><span class="hljs-string">'presence'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!err) { client.publish(<span class="hljs-string"><span class="hljs-string">'presence'</span></span>, <span class="hljs-string"><span class="hljs-string">'Hello mqtt'</span></span>) } }) }) client.on(<span class="hljs-string"><span class="hljs-string">'message'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">topic, message</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// message is Buffer console.log(message.toString()) client.end() })</span></span></code> </pre> <br><h3>  MQTTnet </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O MQTTnet</a> √© uma biblioteca .NET de alto desempenho que fornece o cliente e o servidor MQTT (broker). <br><br>  Instala√ß√£o do cliente MQTT: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Create a new MQTT client. var factory = new MqttFactory(); var mqttClient = factory.CreateMqttClient();</span></span></code> </pre> <br>  Depois de definir as configura√ß√µes do cliente MQTT, √© poss√≠vel estabelecer uma conex√£o.  O c√≥digo a seguir mostra como se conectar ao servidor: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Use WebSocket connection. var options = new MqttClientOptionsBuilder() .WithWebSocketServer("broker.hivemq.com:8000/mqtt") .Build(); await client.ConnectAsync(options);</span></span></code> </pre> <br>  Receba mensagens recebidas: <br><br><pre> <code class="cpp hljs">client.UseApplicationMessageReceivedHandler(e =&gt; { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"### RECEIVED APPLICATION MESSAGE ###"</span></span>); Console.WriteLine($<span class="hljs-string"><span class="hljs-string">"+ Topic = {e.ApplicationMessage.Topic}"</span></span>); Console.WriteLine($<span class="hljs-string"><span class="hljs-string">"+ Payload = {Encoding.UTF8.GetString(e.ApplicationMessage.Payload)}"</span></span>); Console.WriteLine($<span class="hljs-string"><span class="hljs-string">"+ QoS = {e.ApplicationMessage.QualityOfServiceLevel}"</span></span>); Console.WriteLine($<span class="hljs-string"><span class="hljs-string">"+ Retain = {e.ApplicationMessage.Retain}"</span></span>); Console.WriteLine(); Task.Run(() =&gt; client.PublishAsync(<span class="hljs-string"><span class="hljs-string">"hello/world"</span></span>)); });</code> </pre> <br>  Publicar publica√ß√£o: <br><br><pre> <code class="cpp hljs">var message = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MqttApplicationMessageBuilder() .WithTopic(<span class="hljs-string"><span class="hljs-string">"MyTopic"</span></span>) .WithPayload(<span class="hljs-string"><span class="hljs-string">"Hello World"</span></span>) .WithExactlyOnceQoS() .WithRetainFlag() .Build(); await client.PublishAsync(message);</code> </pre> <br>  Consulte a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o e o wiki</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MQTTnet para obter mais exemplos</a> . <br><br>  Os provedores de n√≠vel corporativo possuem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">servidores MQTT prontos</a> para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">troca</a> de mensagens entre aplicativos m√≥veis, m√°quinas industriais e uma ampla variedade de outros usos da IoT.  Este <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">guia</a> explica como usar o MQTT por meio de um broker de n√≠vel corporativo. <br><br><h1>  E o dimensionamento? </h1><br>  Quando se trata de dimensionar o MQTT, h√° duas considera√ß√µes a serem consideradas: 1) esse √© o protocolo correto;  2) independentemente da escolha do protocolo, que infraestrutura e recursos de rede s√£o necess√°rios para lidar com o aumento do tr√°fego entre dispositivos usando o MQTT. <br><br>  O LWM2M (Lightweight Machine to Machine) √© outro protocolo que pode ser usado com o MQTT no n√≠vel corporativo.  Comparado ao MQTT, √†s vezes √© <i>mais adequado para sistemas IoT de longo prazo</i> .  O MQTT √© ideal para uma execu√ß√£o de avalia√ß√£o da IoT sem esfor√ßo, enquanto o LWM2M fornece recursos para uma infraestrutura vers√°til e de longo prazo.  O LWM2M tamb√©m fornece ferramentas superiores de gerenciamento de dispositivos, como monitoramento de conex√£o, atualiza√ß√µes de firmware e a√ß√µes de dispositivos remotos.  Para empresas com um grande n√∫mero de dispositivos n√£o gerenciados que enviam grandes quantidades de dados para uma plataforma central, o LWM2M √© a melhor op√ß√£o.  No entanto, estamos falando de implanta√ß√µes em larga escala da IoT; portanto, geralmente o MQTT √© mais do que uma op√ß√£o adequada.  Al√©m disso, o MQTT √© mais comum e possui suporte mais amplo. <br><br>  Agora, sobre as possibilidades de infraestrutura.  Quando se trata de carregamento do servidor, o n√∫mero de conex√µes simult√¢neas raramente √© um gargalo.  A maioria dos servidores / intermedi√°rios MQTT bons suporta milhares de conex√µes simult√¢neas, mas qual √© a carga de trabalho necess√°ria para processar e responder √†s mensagens ap√≥s o servidor MQTT receber os dados reais?  Como regra, existem todos os tipos de problemas em potencial, como leitura e grava√ß√£o de e para o banco de dados, integra√ß√£o com o servidor, distribui√ß√£o e gerenciamento de recursos para cada cliente, etc. Assim que uma m√°quina parar de lidar com a carga, voc√™ precisar√° adicionar servidores adicionais, ou seja, pense em balanceamento de carga, sincroniza√ß√£o de mensagens entre clientes conectados a servidores diferentes, acesso generalizado ao estado do cliente, independentemente do tempo de conex√£o ou do servidor espec√≠fico ao qual o cliente est√° conectado - a lista de produtos  zhaetsya e continua. <br><br>  Tais problemas merecem um artigo separado, e muitas informa√ß√µes podem ser encontradas na se√ß√£o Engenharia do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nosso blog</a> .  Em particular, consulte o artigo sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">algumas das complexidades de manuten√ß√£o de uma infraestrutura de mensagens em tempo real em larga escala</a> . <br><br><h1>  Qual √© a situa√ß√£o atual com o MQTT? </h1><br>  Em abril de 2019, o OASIS lan√ßou o MQTT v5.0 como um padr√£o oficial.  O OASIS √© um cons√≥rcio sem fins lucrativos de 600 organiza√ß√µes membros e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5.000 membros individuais</a> . <br><br>  A vers√£o 5.0 apresenta uma s√©rie de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">novos recursos</a> que devem ser de interesse dos desenvolvedores de sistemas em tempo real.  Esses novos recursos s√£o compat√≠veis com as vers√µes atuais do MQTT.  Entre eles est√£o: <br><br><ul><li>  <b>Relat√≥rio de erros aprimorado</b> : os c√≥digos de retorno agora podem informar que os dados n√£o est√£o sendo transmitidos por algum motivo.  Sequ√™ncias opcionais s√£o suportadas para indicar o motivo.  Eles ajudam a melhorar o diagn√≥stico de solu√ß√£o de problemas. <br></li><li>  <b>Compartilhamento de assinaturas</b> : para ajudar a equilibrar a carga, as assinaturas podem ser compartilhadas entre v√°rios clientes no lado de recebimento. <br></li><li>  <b>Propriedades da mensagem</b> : a vers√£o 5.0 introduz metadados como parte do cabe√ßalho da mensagem.  Pode transmitir informa√ß√µes adicionais ao usu√°rio final ou facilitar algumas das outras fun√ß√µes listadas abaixo. <br></li><li>  <b>Alias ‚Äã‚Äãdo canal</b> : os editores podem substituir os canais por identificadores num√©ricos para reduzir o n√∫mero de bytes a transmitir. <br></li><li>  Data de <b>vencimento da mensagem</b> : as mensagens podem ser marcadas para exclus√£o autom√°tica se o sistema n√£o puder entreg√°-las dentro de um per√≠odo de tempo especificado. </li></ul><br>  Para obter uma lista completa dos novos recursos do MQTT 5.0, consulte o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ap√™ndice C</a> do padr√£o oficial. <br><br>  Al√©m dos muitos dispositivos e servi√ßos de consumo no mercado, o MQTT encontrou uso na infraestrutura corporativa de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">todas as formas e tamanhos</a> .  S√£o smartphones e tablets, sistemas de monitoramento de energia, dispositivos m√©dicos, plataformas e plataformas de petr√≥leo, as ind√∫strias automotiva e aeroespacial, bem como sensores e sistemas de vis√£o de m√°quina usados ‚Äã‚Äãno manuseio de materiais, constru√ß√£o, cadeia de suprimentos, varejo e muito mais. <br><br><h1>  MQTT e Ably </h1><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O MQTT</a> √© um protocolo popular, amplamente suportado e relativamente maduro.  √â √≥timo para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">muitos aplicativos em tempo real</a> , e n√£o apenas para implantar a IoT.  No entanto, como a produ√ß√£o e o consumo de dados em tempo real continuam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">a crescer exponencialmente</a> , o MQTT pode nem sempre ser o protocolo certo para atender √†s suas necessidades de streaming.  Siga nossa se√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conceitos em tempo real</a> para obter informa√ß√µes sobre outros protocolos e como eles se adaptam √† sua situa√ß√£o. <br><br>  A Ably fornece um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">broker e um adaptador de protocolo MQTT</a> com tradu√ß√£o para o pr√≥prio protocolo da Ably nas duas dire√ß√µes, o que permite a integra√ß√£o com quaisquer sistemas e conex√µes existentes.  WebSockets suportados, HTTP, SSE, gRPC (em desenvolvimento), STOMP, AMQP e outros protocolos para organizar uma infraestrutura de mensagens distribu√≠das em tempo real.  Existem mais de 40 bibliotecas de clientes SDK e suporte para protocolos propriet√°rios em tempo real. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt463669/">https://habr.com/ru/post/pt463669/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt463655/index.html">O nascimento de um projeto ou como escrever seu pr√≥prio CMS</a></li>
<li><a href="../pt463657/index.html">Chatbots √© uma merda</a></li>
<li><a href="../pt463663/index.html">10 livros para entender a estrutura do mercado de a√ß√µes, investimento na bolsa de valores e negocia√ß√£o automatizada</a></li>
<li><a href="../pt463665/index.html">1,1 bilh√£o de viagens de t√°xi: cluster ClickHouse de 108 n√∫cleos</a></li>
<li><a href="../pt463667/index.html">Floresta n√£o se rende √† pesquisa de tecnologia, mas engenheiros revidam</a></li>
<li><a href="../pt463673/index.html">6 raz√µes para abrir uma startup de TI no Canad√°</a></li>
<li><a href="../pt463675/index.html">Alquimia de pessoal: qual √© a composi√ß√£o ideal da equipe do centro GosSOPKA?</a></li>
<li><a href="../pt463677/index.html">L√≠der de equipe em um controle remoto: como viajei com minha fam√≠lia e trabalhei na Gr√©cia e no Vietn√£</a></li>
<li><a href="../pt463681/index.html">Or√ßamento hidrop√¥nico para a GPU. Conhecimento e primeira experi√™ncia</a></li>
<li><a href="../pt463683/index.html">Vis√£o geral das solu√ß√µes Open Typo Correction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>