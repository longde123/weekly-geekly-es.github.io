<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¼ ğŸ“‚ ğŸ“€ åˆ¶ä½œJaCartaç¼–è¾‘å™¨ ğŸ‘ˆ ğŸˆ² ğŸ› ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="â€œå…³äºå½±å­ç‹å›½ï¼Œæˆ‘åªèƒ½è¯´ä¸€ä»¶äº‹ï¼šå­˜åœ¨ç°å®ï¼Œå­˜åœ¨å½±å­ã€‚ è¿™æ˜¯ä¸€åˆ‡çš„æœ¬è´¨ã€‚ åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œåªæœ‰ç¥ç€ï¼ˆçœŸå®åœ°çƒä¸Šçš„çœŸå®åŸå¸‚ï¼‰æ”¶é›†äº†æ‰€æœ‰ä¸œè¥¿ã€‚ å½±å­ç‹å›½åªæ˜¯è™šå¹»çš„æ— é™ã€‚ åœ¨è¿™é‡Œæ‚¨è¿˜å¯ä»¥æ‰¾åˆ°æ‰€æœ‰å†…å®¹-ä½†è¿™å°†æ˜¯é˜´å½±ï¼Œæ˜¯å¯¹ç°å®çš„æ‰­æ›²åæ˜ ã€‚ é˜´å½±ç‹å›½ä»å››é¢å…«æ–¹åŒ…å›´äº†ç¥ç€ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œæ··ä¹±è¿˜åœ¨ç»Ÿæ²»ã€‚ ä»ç¥ç€åˆ°æ··æ²Œç‹å›½...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åˆ¶ä½œJaCartaç¼–è¾‘å™¨</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/441476/">  <i>â€œå…³äºå½±å­ç‹å›½ï¼Œæˆ‘åªèƒ½è¯´ä¸€ä»¶äº‹ï¼šå­˜åœ¨ç°å®ï¼Œå­˜åœ¨å½±å­ã€‚</i>  <i>è¿™æ˜¯ä¸€åˆ‡çš„æœ¬è´¨ã€‚</i>  <i>åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œåªæœ‰ç¥ç€ï¼ˆçœŸå®åœ°çƒä¸Šçš„çœŸå®åŸå¸‚ï¼‰æ”¶é›†äº†æ‰€æœ‰ä¸œè¥¿ã€‚</i>  <i>å½±å­ç‹å›½åªæ˜¯è™šå¹»çš„æ— é™ã€‚</i>  <i>åœ¨è¿™é‡Œæ‚¨è¿˜å¯ä»¥æ‰¾åˆ°æ‰€æœ‰å†…å®¹-ä½†è¿™å°†æ˜¯é˜´å½±ï¼Œæ˜¯å¯¹ç°å®çš„æ‰­æ›²åæ˜ ã€‚</i>  <i>é˜´å½±ç‹å›½ä»å››é¢å…«æ–¹åŒ…å›´äº†ç¥ç€ã€‚</i>  <i>é™¤æ­¤ä¹‹å¤–ï¼Œæ··ä¹±è¿˜åœ¨ç»Ÿæ²»ã€‚</i>  <i>ä»ç¥ç€åˆ°æ··æ²Œç‹å›½çš„ä¸€åˆ‡çš†æœ‰å¯èƒ½ã€‚â€</i> <br> ç½—æ°Â·å“²é‡Œäºšå…¹å°¼ï¼ˆRoger Zhelyaznyï¼‰ã€‚ ç¥ç€ä¹ç‹å­ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hi/kl/ek/hiklekzlry8wpcjn7hg3nroukac.jpeg"></div><br> ä¸€åˆ‡å§‹äºéœ€è¦ä½¿ç”¨æ¥è‡ªä¸åŒçš„è¿œç¨‹å·¥ä½œç«™çš„ç›¸åŒä»¤ç‰Œä¸Šçš„å¯†é’¥ï¼ˆå¯¹äºå‡ ä¸ªä»¤ç‰Œæ¥è¯´ï¼ŒUSB over IPçš„ä»·æ ¼ä¼šç¨é«˜ä¸€äº›ï¼‰ï¼Œå¹¶ä¸”æˆ‘æ¸´æœ›æ‰“å¼€è¿™ä¸ªå°é—­çš„ä¸–ç•Œã€‚ æˆ‘<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é‡åˆ°äº†habr.com/post/276057</a>è¿™æœ¬ä¹¦çš„ä½œè€…éå¸¸å°Šé‡ä»–çš„ä½œå“ï¼Œåœ¨æˆ‘çš„é¡¹ç›®ä¸­ä½¿ç”¨äº†ä»–åè½¬çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼ˆä»£ç æ˜¯å¼€æ”¾çš„ï¼‰ã€‚ æ²¡é”™ï¼Œäº‹å®è¯æ˜ï¼Œä¸etsdk.dllå…¼å®¹çš„æ‰€æœ‰å†…å®¹ä»…é€‚ç”¨äºè“è‰²é±¼ã€‚ å› æ­¤ï¼Œå¯¹äºJaCartaï¼Œå¿…é¡»é‡å†™æ–°åŠŸèƒ½ï¼Œå¹¶ä¸”å…¶ä¸­ä¸€äº›åŠŸèƒ½å¿…é¡»è¿›è¡Œç¼–è¾‘ã€‚ <br><br> ç»è¿‡é•¿æœŸç ”ç©¶çš„ç»“æœï¼ŒJaCarta Editorå‡ºç°äº†-è¯¥ç¨‹åºæ˜¾ç¤ºå¹¶å…è®¸æ‚¨ç¼–è¾‘Aladdinä»¤ç‰Œï¼ˆåŒ…æ‹¬æœ€ç°ä»£çš„ä»¤ç‰Œï¼‰çš„å®ä½“ï¼ˆè¿™æ˜¯å®˜æ–¹æ–‡æ¡£ä¸­è°ƒç”¨ä»¤ç‰Œæ–‡ä»¶ç³»ç»Ÿå¯¹è±¡çš„æ–¹å¼ï¼Œæ˜¾ç„¶æš—ç¤ºäº†å®ƒä»¬çš„çŸ­æš‚æ€§å’Œä¸çœŸå®æ€§ï¼‰ã€‚ <br><a name="habracut"></a><br>  Rutokençš„ç±»ä¼¼åº”ç”¨ç¨‹åºå·²ä½œä¸ºRutoken SDKï¼ˆRutokenç¼–è¾‘å™¨ï¼‰çš„ä¸€éƒ¨åˆ†å…¬å¼€æä¾›ï¼Œä½†å¯¹äºAladdinï¼Œè‡³å°‘å®ƒä¸åœ¨å…¬å…±é¢†åŸŸï¼Œå°½ç®¡å¤§çº¦15å¹´å‰æ ¹æ®Internetä¸Šçš„æ–‡æ¡£åˆ¤æ–­ä¸ºï¼ˆETEditorï¼‰ã€‚ <br><br> è¯¥ç¨‹åºæ˜¯ç”¨Autoitç¼–å†™çš„ï¼Œå¹¶é€šè¿‡EToken PRO Java 72 Kï¼ŒJaCarta LTï¼ŒJaCarta Proï¼ŒJaCarta GOST-2è¿›è¡Œäº†æµ‹è¯•ã€‚ <br><br> å¦‚æœè®¡ç®—æœºä¸Šå®‰è£…äº†Rutokené©±åŠ¨ç¨‹åºï¼Œåˆ™è¯¥ç¨‹åºå°†æ— æ³•è¿è¡Œï¼ˆè¦æ±‚ETokenæˆ–Ja Cartaçš„é˜…è¯»å™¨å·ä¸º0ï¼‰ã€‚ <br><br> å‡ºäºç›¸åŒçš„åŸå› ï¼Œåªæœ‰ä¸€ä¸ªä»¤ç‰Œå¿…é¡»è¿æ¥æ‰èƒ½æ­£ç¡®æ“ä½œã€‚ <br><br> è¯¥è„šæœ¬ä½¿ç”¨Window $ç³»ç»Ÿè°ƒç”¨ï¼Œå¹¶ä¸”ä»…åœ¨æ­¤OSç³»åˆ—ä¸­è¿›è¡Œäº†æµ‹è¯•ã€‚ <br><br>  <b>è¦æ­£å¸¸å·¥ä½œï¼Œæ‚¨éœ€è¦å®‰è£…â€œ JaCarta Single Clientâ€</b> ï¼ˆå¯ä»åˆ¶é€ å•†çš„ç½‘ç«™å…è´¹ä¸‹è½½ï¼‰ï¼Œåœ¨å®‰è£…æ—¶ï¼ŒåŒ…å«JaCarta File SystemåŠŸèƒ½çš„etsdk.dllå’ŒjcFS.dllçš„æ›´æ–°ç‰ˆæœ¬éå¸¸æ˜æ˜¾ï¼ˆä¸etsdk.dllä¸­çš„åŠŸèƒ½ï¼Œä½†æ˜¯jcFSä¸­æœ‰æ›´å¤šåŠŸèƒ½ï¼Œå¦‚æœæ²¡æœ‰è¿™äº›åŠŸèƒ½ï¼Œå°†æ— æ³•ä½¿ç”¨æŸäº›ç°ä»£jakartsï¼ˆä¾‹å¦‚GOST-2ï¼‰ã€‚ å®‰è£…Unified Clientåï¼Œè‡ªç„¶ä¸å¿…æœç´¢è¯¥dllå¹¶å°†å…¶æ”¾åœ¨ç¨‹åºä¸­ï¼Œå¦åˆ™ï¼Œå¦‚æœé©±åŠ¨ç¨‹åºå®‰è£…äº†ç‰¹å®šç±»å‹çš„ä»¤ç‰Œï¼Œåˆ™è¯¥dllåº”è¯¥åœ¨programæ–‡ä»¶å¤¹ä¸­ã€‚ <br><br> æ‰€æœ‰jcFSåŠŸèƒ½éƒ½åœ¨åˆ¶é€ å•†çš„ç½‘ç«™ä¸Šè¿›è¡Œäº†è¯¦ç»†è¯´æ˜ï¼Œä½†æ˜¯ï¼Œè¿™äº›åŠŸèƒ½çš„æŸäº›å‚æ•°å¿…é¡»é€šè¿‡å®éªŒé€‰æ‹©ã€‚ <br><br> ä¸ºäº†è®¿é—®ä»¤ç‰Œçš„æ ¹ç›®å½•ï¼Œæ‚¨å¿…é¡»è°ƒç”¨ETRootDirOpenæˆ–JCRootDirOpenå‡½æ•°ï¼ˆè¿™æ˜¯ç›¸åŒçš„ï¼Œå› ä¸ºdllä¸­çš„ç¬¬ä¸€ä¸ªè°ƒç”¨ç¬¬äºŒä¸ªï¼Œå¯¹äºå‡ ä¹æ‰€æœ‰å‡½æ•°éƒ½æ˜¯å¦‚æ­¤ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›ä¾‹å¤–ï¼‰ï¼Œå…¶ä¾›åº”å•†æ ‡è¯†ç¬¦ç­‰äº0ï¼ˆå¸¸æ•°å¦‚0xF007å°†å…è®¸ä»…æŸ¥çœ‹å¤§å¤šæ•°ä½¿ç”¨è¾ƒæ—§eTokençš„å•ä¸ªç›®å½•ï¼Œè¿™äº›ç›®å½•å­˜å‚¨ä½¿ç”¨å®ç”¨ç¨‹åºï¼ˆä¾‹å¦‚PKIAdminå’ŒMessagePROï¼‰ç”Ÿæˆçš„é“¶è¡Œå¯†é’¥ã€‚ <br><br> ç°ä»£é›…åŠ è¾¾çš„ä¸‹ä¸€ä¸ªé‡è¦åŠŸèƒ½æ˜¯éœ€è¦çŸ¥é“å®‰è£…åœ¨ä»¤ç‰Œä¸Šçš„appletçš„IDï¼ŒJCSelectAppletå‡½æ•°å¯¹æ­¤è´Ÿè´£ã€‚ <br><br> è¾ƒæ—©çš„ä»¤ç‰Œé€šå¸¸å…·æœ‰é»˜è®¤çš„appletï¼Œå¹¶ä¸éœ€è¦ä¸“é—¨è°ƒç”¨æ­¤å‡½æ•°ï¼Œä½†æ˜¯å¯¹äºä¸çŸ¥é“applet idçš„æ–°çš„å’Œç›¸å¯¹è¾ƒæ–°çš„jakartsï¼Œå°†æ— æ³•è¿›è¡Œè¿›ä¸€æ­¥çš„å·¥ä½œã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒç”¨ä»ä»¤ç‰Œæ¥æ”¶ä¿¡æ¯çš„æ‰€æœ‰å‡½æ•°å°†è¿”å›Falseã€‚ åœ¨æˆ‘çš„é¡¹ç›®ä¸­ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ç°äº†ä¸¤é˜¶æ®µçš„æš´åŠ›ç ´è§£ï¼ˆä»¤ç‰Œå§‹ç»ˆå“åº”ä¸¤ä¸ªidï¼Œä½†å…¶ä¸­åªæœ‰ä¸€ä¸ªèµ·ä½œç”¨ï¼‰idï¼Œå¹¶ä»¥æ‰€éœ€çš„å€¼è¿›ä¸€æ­¥èµ·ä½œç”¨ã€‚ <br><br> æ‰€æœ‰ä¿¡æ¯éƒ½æ˜¾ç¤ºåœ¨ç›®å½•æ ‘ä¸‹çš„è¾“å‡ºçª—å£ä¸­ã€‚ <br> è¾“å…¥äº†PINç ï¼Œè¿˜ä¼šæ˜¾ç¤ºæœ‰å…³å‰©ä½™å°è¯•è¾“å…¥çš„ä¿¡æ¯ã€‚ <br> å°†æ˜¾ç¤ºç›®å½•çš„å†…å®¹å’Œæœ‰å…³æ–‡ä»¶çš„ç®€è¦ä¿¡æ¯ï¼šåç§°ï¼Œæ–‡ä»¶æ˜¯å¦ä¸ºç§äººä¿¡æ¯æ˜¯ç§äººPINç -å­—æ¯p :ï¼ˆæ–‡ä»¶åœ¨å…¶åä¸ºå…¬ç”¨ï¼Œå•ä½ä¸ºç§æœ‰ï¼‰ï¼Œæ–‡ä»¶å¤§å°åœ¨â€œ sï¼šâ€åä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ åŒå‡»æ‰“å¼€æ–‡ä»¶ã€‚ <br><br> æ‚¨å¯ä»¥æŸ¥çœ‹ä»¤ç‰Œæ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶åœ¨éœ€è¦æ—¶å°†å…¶ä»¥åå…­è¿›åˆ¶æ ¼å¼å¤åˆ¶åˆ°ç¼“å†²åŒºä¸­ï¼Œæˆ–è€…ä»¥äºŒè¿›åˆ¶å½¢å¼ä¿å­˜åˆ°è®¡ç®—æœºä¸­ã€‚ <br><br> æ‚¨ä¹Ÿå¯ä»¥æ›´æ”¹æ–‡ä»¶çš„å†…å®¹ï¼Œç„¶ååœ¨èœå•ä¸­é€‰æ‹©â€œä¿å­˜æ›´æ”¹â€ï¼ˆå¿…é¡»å…ˆè¾“å…¥PINç ï¼Œå¦‚æœå°šæœªè¾“å…¥PINç ï¼Œåˆ™ä¼šæ˜¾ç¤ºä¸€æ¡é€‚å½“çš„æ¶ˆæ¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥é€‰æ‹©å·²ç¼–è¾‘çš„æ•°æ®å¹¶å°†å…¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼‰ã€‚ <br><br> è¦åˆ é™¤æ–‡ä»¶ï¼Œè¯·é€‰æ‹©å®ƒå¹¶å•å‡»â€œåˆ é™¤â€ï¼Œç„¶åå°†å‡ºç°ä¸€ä¸ªç¡®è®¤çª—å£ã€‚ <br><br>  JaCartaæ–‡ä»¶ç³»ç»Ÿå…·æœ‰ä¸€ä¸ªæœ‰è¶£çš„åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½å­˜åœ¨äºæˆ‘æµ‹è¯•è¿‡çš„æ‰€æœ‰ä»¤ç‰Œä¸­ã€‚ å¦‚æœæ‚¨åˆ›å»ºä¸€ä¸ªç›®å½•æˆ–å¤šä¸ªç›®å½•ï¼Œå¹¶ä¸”ä»¤ç‰Œä¸Šæ²¡æœ‰æ–‡ä»¶ï¼Œåˆ™åœ¨ä¸‹ä¸€ä¸ªä½¿ç”¨ä»¤ç‰Œçš„ä¼šè¯æœŸé—´ï¼Œå®ƒä»¬å°†æ¶ˆå¤±ï¼Œæ˜¾ç„¶ï¼Œæ–‡ä»¶ç³»ç»Ÿå°†é€šè¿‡è¿™ç§æ–¹å¼æ¥ä¿å­˜ä»¤ç‰Œçš„å†…å­˜å¹¶æ¸…é™¤æ‰€æœ‰åƒåœ¾ã€‚ <br><br> å› æ­¤ï¼Œå½“æ‚¨åœ¨ç¨‹åºä¸­å•å‡»â€œåˆ›å»ºâ€æŒ‰é’®æ—¶ï¼Œç«‹å³ä»ä¸€ä¸ªç›®å½•æˆ–ä¸¤ä¸ªç›®å½•å’Œä¸€ä¸ªæ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªé“¾ã€‚ ç¨‹åºä¸­ç›®å½•çš„åµŒå¥—æ·±åº¦ä¸º2ï¼Œä¸è®¡ç®—æ ¹ç›®å½•ã€‚ åœ¨æ ¹ç›®å½•ä¸­ï¼Œæ‚¨åªèƒ½åˆ›å»ºç›®å½•ï¼Œè€Œä¸èƒ½åˆ›å»ºæ–‡ä»¶ã€‚ <br> åœ¨åˆ›å»ºï¼Œç¼–è¾‘æˆ–åˆ é™¤å®ä½“ä¹‹å‰ï¼Œæ‚¨å¿…é¡»è¾“å…¥PINç ã€‚ <br><br> å…³äºç›®å½•åç§°çš„é‡è¦æç¤ºï¼ <br><br> åœ¨å†…å®¹ç”±åˆ¶é€ å•†åˆ›å»ºçš„ä»¤ç‰Œä¸Šï¼Œæ— è®ºä½äºä½•å¤„ï¼Œæ‚¨éƒ½æ°¸è¿œä¸ä¼šçœ‹åˆ°å…·æœ‰ç›¸åŒåç§°çš„ç›®å½•ã€‚ è¿™æ˜¯ç”±äºæ–‡ä»¶ç³»ç»ŸåŠŸèƒ½ã€‚ <br><br> å‡è®¾ä»¤ç‰Œä¸Šå…·æœ‰ä»¥ä¸‹å®ä½“ï¼š// <u>0001</u> / A001 / 0008ï¼ˆå³æ–‡ä»¶å¤¹0001åœ¨æ ¹ç›®å½•ä¸­ï¼Œæ–‡ä»¶å¤¹A001åœ¨å…¶ä¸­ï¼Œæ–‡ä»¶0008åœ¨å…¶ä¸­ï¼‰ï¼Œæˆ‘ä»¬åœ¨ä»¤ç‰Œä¸Šåˆ›å»ºä¸€ä¸ªæ–°å®ä½“ï¼š// CC00 / <u>0001/1010</u> ã€‚ å½“è®¿é—®æ–‡ä»¶1010æ—¶ï¼Œå°†å¼€å§‹å¯¹ç›®å½•0001çš„æœç´¢ï¼Œè¯¥ç›®å½•ä½äºæ ¹ç›®å½•ä¸­å¹¶ä¸”é¦–å…ˆè¢«æ‰¾åˆ°ï¼Œä½†æ˜¯å…¶ä¸­æ²¡æœ‰æ­¤ç±»æ–‡ä»¶ã€‚ ç»“æœï¼Œè¯¥å‡½æ•°è¿”å›Falseå¹¶ä¸”è¯¥å®ä½“ä¸¢å¤±ï¼›æ‚¨ä¸èƒ½è®¿é—®å®ƒä¹Ÿä¸èƒ½åˆ é™¤å®ƒã€‚ ä»…ä»¤ç‰Œåˆå§‹åŒ–ä¼šæœ‰æ‰€å¸®åŠ©ã€‚ <br><br> ç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯EToken PROå’ŒJA Carta Proï¼Œå®ƒä»¬çš„å¤–è§‚ä»…ä¸åŒï¼Œå®ƒä»¬åœ¨æ ¹ç›®å½•ä¸­æœ‰ç³»ç»Ÿæ–‡ä»¶ï¼ˆå®ƒä»¬æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼‰ï¼Œå…¶ä¸­å­˜å‚¨äº†å¯†ç çš„å“ˆå¸Œå€¼ä¹‹ä¸€ï¼Œä»è€Œæ›´æ”¹äº†è¿™äº›æ–‡ä»¶ã€‚å¯¼è‡´æˆæƒå˜å¾—ä¸å¯èƒ½ï¼ˆPINç å˜å¾—ä¸æ­£ç¡®ï¼‰ï¼Œä¹‹ååªæœ‰åˆå§‹åŒ–ä¼šæœ‰æ‰€å¸®åŠ©ã€‚ <br><br> å…³äºç§é’¥ï¼Œå¯ä»¥å»ºç«‹ä»¥ä¸‹æ¡ä»¶ï¼šå¦‚æœå°†ç¬¬ä¸‰æ–¹åŠ å¯†æä¾›å•†åˆ›å»ºçš„å®¹å™¨ï¼ˆä¾‹å¦‚CryptoProï¼‰å­˜å‚¨åœ¨ä»¤ç‰Œä¸Šï¼Œåˆ™å…¶æ‰€æœ‰å†…å®¹ï¼ˆåŒ…æ‹¬ç§é’¥ï¼‰éƒ½å°†å¯ç”¨ï¼Œå®ƒåªæ˜¯å¸¦æœ‰PINç çš„é—ªå­˜é©±åŠ¨å™¨ï¼ˆå¦‚å›¾æ‰€ç¤ºï¼‰ã€‚ å¦‚æœå¯†é’¥å¯¹æ˜¯ä½¿ç”¨PKCS11åœ¨ä»¤ç‰Œä¸Šç”Ÿæˆçš„ï¼Œåˆ™ä»…è¯ä¹¦å’Œå…¬å…±å¯†é’¥å¯ç”¨ã€‚ <br><br> ç”±äºè¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§ç¨‹åºï¼Œå› æ­¤æˆ‘ä¸å»ºè®®å°†å…¶ä¸åŒ…å«æœ‰æ•ˆEDSå¯†é’¥çš„ä»¤ç‰Œä¸€èµ·ä½¿ç”¨ï¼Œæ‰€æœ‰æ“ä½œå‡è¦ç”±å®éªŒè€…æ¥æ‰¿æ‹…ã€‚ å¯¹äºåˆ›å»ºæ–°å®ä½“å°¤å…¶å¦‚æ­¤ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç»“æœå¾ˆéš¾é¢„æµ‹ã€‚ <br><br> åˆ›å»ºè¯¥ç¨‹åºçš„æ‰€æœ‰ä¿¡æ¯å‡æ¥è‡ªå…¬å¼€æ¥æºï¼Œå…¶åˆ›å»ºç›®çš„çº¯ç²¹æ˜¯ç ”ç©¶ã€‚ <br><br> è„šæœ¬æœ¬èº« <br><br><div class="spoiler">  <b class="spoiler_title">JACartaEditor.au3</b> <div class="spoiler_text"><pre><code class="vbscript hljs">#include &lt;GUIConstantsEx.au3&gt; #include &lt;WindowsConstants.au3&gt; #include &lt;EditConstants.au3&gt; #include &lt;TreeViewConstants.au3&gt; #include &lt;GuiTreeView.au3&gt; #include &lt;GuiMenu.au3&gt; #include &lt;MsgBoxConstants.au3&gt; #include &lt;StaticConstants.au3&gt; #include &lt;GuiButton.au3&gt; #NoTrayIcon ;  jcFS.dll <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> $ETSdkDll=DllOpen(<span class="hljs-comment"><span class="hljs-comment">'jcFS.dll') Func ETTokenLock($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenLock', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenUnLock($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenUnLock', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETReadersEnumOpen() Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETReadersEnumOpen', _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETReadersEnumNext($EnumId) Local $Reader=DllStructCreate('CHAR name[260]; BYTE etoken;') Local $CallRes=DllCall($ETSdkDll,'WORD','ETReadersEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Reader) _ ) Local $Result[2]=[ DllStructGetData($reader,'name'), _ DllStructGetData($reader,'etoken')] Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :$Result EndFunc Func ETReadersEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETReadersEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenBind($ReaderName) Local $In=DllStructCreate('BYTE['&amp;(StringLen($ReaderName)+1)&amp;']') Local $Out=DllStructCreate('DWORD') DllStructSetData($In,1,$ReaderName) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenBind', _ 'PTR',DllStructGetPtr($Out), _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETTokenRebind($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenRebind', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenUnbind($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenUnbind', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenLogin($BindId,$Pin='') Local $In=DllStructCreate('BYTE['&amp;(StringLen($Pin)+1)&amp;']') DllStructSetData($In,1,$Pin) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenLogin', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenPinChange($BindId,$Pin) Local $In=DllStructCreate('CHAR['&amp;(StringLen($Pin)+1)&amp;']') DllStructSetData($In,1,$Pin) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenPinChange', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenLogout($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenLogout', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETRootDirOpen($BindId,$Dir=0xF007) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETRootDirOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$BindId, _ 'DWORD',$Dir _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETDirOpen($Dir,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$Dir, _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETDirCreate($Dir,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirCreate', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$Dir, _ 'DWORD',$DirId, _ 'DWORD',0 _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETDirGetInfo($DirId) Local $Out=DllStructCreate('WORD wDirName; WORD wSize') Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirGetInfo', _ 'DWORD',$DirId, _ 'PTR',DllStructGetPtr($Out) _ ) Local $Result[2]=[ DllStructGetData($Out,'wDirName'), _ DllStructGetData($Out,'wSize')] Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :$Result EndFunc Func ETDirClose($DirId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirClose', _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETDirDelete($DirId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirDelete', _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETDirEnumOpen($DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirEnumOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETDirEnumNext($EnumId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETDirEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETFileOpen($File,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId, _ 'DWORD',$File _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETFileCreate($File,$DirId,$Size,$Private=0) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileCreate', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId, _ 'DWORD',$File, _ 'DWORD',$Size, _ 'DWORD',$Private _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETFileGetInfo($FileId) Local $Out=DllStructCreate('WORD name;WORD private;WORD;WORD size') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileGetInfo', _ 'DWORD',$FileId, _ 'PTR',DllStructGetPtr($Out) _ ) Local $Result[3]=[ DllStructGetData($Out,'name'), _ DllStructGetData($Out,'private'), _ DllStructGetData($Out,'size')] Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :$Result EndFunc Func ETFileRead($FileId) Local $FileInfo=ETFileGetInfo($FileId) If @error Then Return SetError(@error,0,False) Local $Out=DllStructCreate('BYTE ['&amp;$FileInfo[2]&amp;']') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileRead', _ 'DWORD',$FileId, _ 'DWORD',0, _ 'DWORD',0xFFFF, _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$FileInfo[2] _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETFileWrite($FileId,$Data,$Pos=0) $Data=Binary($Data) Local $DataSize=BinaryLen($Data) Local $In=DllStructCreate('BYTE['&amp;$DataSize&amp;']') DllStructSetData($In,1,$Data) Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileWrite', _ 'DWORD',$FileId, _ 'DWORD',$Pos, _ 'PTR',DllStructGetPtr($In), _ 'DWORD',$DataSize _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETFileClose($FileId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileClose', _ 'DWORD',$FileId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETFileDelete($FileId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileDelete', _ 'DWORD',$FileId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETFilesEnumOpen($DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFilesEnumOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETFilesEnumNext($EnumId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFilesEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETFilesEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETFilesEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenLabelGet($BindId) Local $Out1=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenLabelGet', _ 'DWORD',$BindId, _ 'PTR',0, _ 'PTR',DllStructGetPtr($Out1) _ ) If $CallRes[0] Then Return SetError($CallRes[0],0,False) Local $Out2=DllStructCreate('CHAR['&amp;DllStructGetData($Out1,1)&amp;']') $CallRes=DllCall($ETSdkDll,'WORD','ETTokenLabelGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out2), _ 'PTR',DllStructGetPtr($Out1) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out2,1) EndFunc Func ETTokenIDGet($BindId) Local $Out1=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenIDGet', _ 'DWORD',$BindId, _ 'PTR',0, _ 'PTR',DllStructGetPtr($Out1) _ ) If $CallRes[0] Then Return SetError($CallRes[0],0,False) Local $Out2=DllStructCreate('CHAR['&amp;DllStructGetData($Out1,1)&amp;']') $CallRes=DllCall($ETSdkDll,'WORD','ETTokenIDGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out2), _ 'PTR',DllStructGetPtr($Out1) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out2,1) EndFunc Func ETTokenMaxPinGet($BindId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenMaxPinGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETTokenMinPinGet($BindId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenMinPinGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETSelectApplet($BindId, $Applet) Local $In=DllStructCreate('DWORD') DllStructSetData($In,1,$Applet) Local $CallRes=DllCall($ETSdkDll,'WORD','ETSelectApplet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Applet) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCSelectApplet($BindId, $Applet) Local $In=DllStructCreate('WORD') DllStructSetData($In,1,$Applet) Local $CallRes=DllCall($ETSdkDll,'WORD','JCSelectApplet', _ 'DWORD',$BindId, _ 'WORD',$Applet _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCReadersEnumOpen() Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCReadersEnumOpen', _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCReadersEnumNext($EnumId) Local $Reader=DllStructCreate('CHAR name[260]; BYTE etoken;') Local $CallRes=DllCall($ETSdkDll,'WORD','JCReadersEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Reader) _ ) Local $Result[2]=[ DllStructGetData($reader,'name'), _ DllStructGetData($reader,'etoken')] Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :$Result EndFunc Func JCReadersEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCReadersEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenBind($ReaderName) Local $In=DllStructCreate('CHAR['&amp;(StringLen($ReaderName)+1)&amp;']') Local $Out=DllStructCreate('DWORD') DllStructSetData($In,1,$ReaderName) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenBind', _ 'PTR',DllStructGetPtr($Out), _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCTokenRebind($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenRebind', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenUnbind($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenUnbind', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenLogin($BindId,$Pin) Local $In=DllStructCreate('CHAR['&amp;(StringLen($Pin)+1)&amp;']') DllStructSetData($In,1,$Pin) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenLogin', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenPinChange($BindId,$Pin) Local $In=DllStructCreate('CHAR['&amp;(StringLen($Pin)+1)&amp;']') DllStructSetData($In,1,$Pin) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenPinChange', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenLogout($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenLogout', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCRootDirOpen($BindId,$Dir=0) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCRootDirOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$BindId, _ 'WORD',$Dir _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirOpen($Dir,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$Dir, _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirCreate($Dir,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirCreate', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$Dir, _ 'DWORD',$DirId, _ 'DWORD',0 _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirGetInfo($DirId) Local $Out=DllStructCreate('BYTE[8]') Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirGetInfo', _ 'DWORD',$DirId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirClose($DirId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirClose', _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCDirDelete($DirId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirDelete', _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCDirEnumOpen($DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirEnumOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirEnumNext($EnumId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCFileOpen($File,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId, _ 'DWORD',$File _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCFileCreate($File,$DirId,$Size,$Private=0) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileCreate', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId, _ 'DWORD',$File, _ 'DWORD',$Size, _ 'DWORD',$Private _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCFileGetInfo($FileId) Local $Out=DllStructCreate('WORD name;WORD private;WORD;WORD size') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileGetInfo', _ 'DWORD',$FileId, _ 'PTR',DllStructGetPtr($Out) _ ) Local $Result[3]=[ DllStructGetData($Out,'name'), _ DllStructGetData($Out,'private'), _ DllStructGetData($Out,'size')] Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :$Result EndFunc Func JCFileRead($FileId) Local $FileInfo=JCFileGetInfo($FileId) If @error Then Return SetError(@error,0,False) Local $Out=DllStructCreate('BYTE ['&amp;$FileInfo[2]&amp;']') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileRead', _ 'DWORD',$FileId, _ 'DWORD',0, _ 'DWORD',0xFFFF, _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$FileInfo[2] _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCFileWrite($FileId,$Data,$Pos=0) $Data=Binary($Data) Local $DataSize=BinaryLen($Data) Local $In=DllStructCreate('BYTE['&amp;$DataSize&amp;']') DllStructSetData($In,1,$Data) Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileWrite', _ 'DWORD',$FileId, _ 'DWORD',$Pos, _ 'PTR',DllStructGetPtr($In), _ 'DWORD',$DataSize _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCFileClose($FileId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileClose', _ 'DWORD',$FileId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCFileDelete($FileId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileDelete', _ 'DWORD',$FileId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCFilesEnumOpen($DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFilesEnumOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCFilesEnumNext($EnumId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFilesEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCFilesEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCFilesEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenLabelGet($BindId) Local $Out1=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenLabelGet', _ 'DWORD',$BindId, _ 'PTR',0, _ 'PTR',DllStructGetPtr($Out1) _ ) If $CallRes[0] Then Return SetError($CallRes[0],0,False) Local $Out2=DllStructCreate('CHAR['&amp;DllStructGetData($Out1,1)&amp;']') $CallRes=DllCall($ETSdkDll,'WORD','JCTokenLabelGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out2), _ 'PTR',DllStructGetPtr($Out1) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out2,1) EndFunc Func JCTokenIDGet($BindId) Local $Out1=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenIDGet', _ 'DWORD',$BindId, _ 'PTR',0, _ 'PTR',DllStructGetPtr($Out1) _ ) If $CallRes[0] Then Return SetError($CallRes[0],0,False) Local $Out2=DllStructCreate('CHAR['&amp;DllStructGetData($Out1,1)&amp;']') $CallRes=DllCall($ETSdkDll,'WORD','JCTokenIDGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out2), _ 'PTR',DllStructGetPtr($Out1) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out2,1) EndFunc Func JCTokenMaxPinGet($BindId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenMaxPinGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCTokenMinPinGet($BindId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenMinPinGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCTokenUnLock($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenUnLock', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenLock($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenLock', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenPinAttemptsGet($BindId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenPinAttemptsGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc ;  Opt("GUIOnEventMode", 1) Dim $BindId, $filelog, $Result, $DirIdRoot=False, $Edit, $msg, $Fileinfo, $treeview, $generalitem, $displayitem, $diritem, $Edit, $SrcSubId, $Output, $pinbutton, $hPinWin, $PinEdit, $pinokbutton, $pincancelbutton, $Pin, $Edit1, $Reader, $Applet, $AppletID, $text, $CreateDirWin Global $Dir1, $Dir2 Dim $hParentWin, $hChildWin, $sItemText, $folderbutton, $filebutton, $deletebutton, $CreateFileWin, $FileEdit, $fileokbutton, $filecancelbutton, $publicbutton, $privatebutton, $sizefile Dim $hFile, $hMain Global Enum $idSave= 1000, $Save Dim $Appname = 'JaCarta Editor' ;  applet ID  Func Applet() GUICtrlSetData($Output, '  applet ID... '&amp;@CRLF,1) Local $Result, $AppletTemp= 0 For $Applet = 0 To 65535 Step 1 $Result = 0 $Result=JCSelectApplet($BindId,$Applet) ; 0x2001 PROJAVA  E-token, 0x1002 PRO, 0x1001 R2, 0x2202 GOST, 0x2205 DATASTORE, 0x2206 -2, 0x2201, 0x2204 ( JaCarta) If $Result = True Then $AppletTemp=$Applet $AppletID=$Applet ExitLoop EndIf Next Local $Id=ETTokenLabelGet($BindId) if $Id= False Then For $Applet=$AppletTemp+1 To 65535 Step 1 $Result=0 $Result=JCSelectApplet($BindId,$Applet) If $Result = True Then ExitLoop EndIf Next EndIf JCSelectApplet($BindId,$Applet) GUICtrlSetData($Output, 'Select applet 0x'&amp;hex($Applet,4)&amp;@CRLF,1) $AppletID=$Applet EndFunc ;      Func PrintDir($Id,$Prefix) Local $EnumId=ETDirEnumOpen($Id) While 1 Local $dir=ETDirEnumNext($EnumId) If @error Then ExitLoop Local $DirId=ETDirOpen($dir,$Id) Local $Dirinfo $Dirinfo=ETDirGetInfo($DirId) Local $Dirtext='(dir)'&amp;hex($dir,4) $diritem = _GUICtrlTreeView_AddChild($treeview,$Prefix, $Dirtext) PrintDir($DirId,$diritem) ETDirClose($DirId) WEnd ETDirEnumClose($EnumId) $EnumId=ETFilesEnumOpen($Id) While 1 Local $file=ETFilesEnumNext($EnumId) If @error Then ExitLoop Local $FileId=ETFileOpen($file,$Id) $Fileinfo=ETFileGetInfo($FileId) Local $filetext='(file)'&amp;hex($file,5)&amp;' '&amp;'p: '&amp;$Fileinfo[1]&amp;' s: '&amp;$Fileinfo[2]&amp;@CRLF _GUICtrlTreeView_AddChild($treeview,$Prefix,$filetext) WEnd ETFilesEnumClose($EnumId) EndFunc ;         Func List() GUICtrlSetData($Output, '') Local $text Local $EnumId=ETReadersEnumOpen() GUICtrlSetData($Output, '   :'&amp;@CRLF,1) While 1 $Reader=ETReadersEnumNext($EnumId) If @error Then ExitLoop GUICtrlSetData($Output, $Reader[0]&amp;@CRLF,1) WEnd ETReadersEnumClose($EnumId) Local $EnumId=ETReadersEnumOpen() $Reader=ETReadersEnumNext($EnumId) $BindId=ETTokenBind($Reader[0]) $Result=JCTokenLock($BindId) GUICtrlSetData($Output, '  '&amp;$Reader[0]&amp;@CRLF,1) ;    ID ,    AppletID $Result=ETTokenIDGet($BindId) if $Result= False Then if $AppletID&lt;&gt;0 Then JCSelectApplet($BindId,$AppletID) Else Applet() EndIf EndIf $Result=ETTokenIDGet($BindId) $text=$Reader[0]&amp;' ID '&amp;$Result $generalitem = _GUICtrlTreeView_AddChild($treeview,0,$text) $Result=ETTokenLabelGet($BindId) GUICtrlSetData($Output, 'Label: '&amp;$Result&amp;@CRLF,1) $DirIdRoot=ETRootDirOpen($BindId,0) ;0xF007   0x0001    $Result=JCTokenPinAttemptsGet($BindId) ;       If $Pin &lt;&gt; 0 Then $Result=JCTokenLogin($BindId,$Pin) If $Result=False Then $Result=JCTokenPinAttemptsGet($BindId) MsgBox(0x10,$Appname,' PIN '&amp;@CRLF&amp;'   PIN : '&amp;$Result ) Else GUICtrlSetData($Output, 'Login OK'&amp;@CRLF,1) EndIf EndIf $Result=JCTokenPinAttemptsGet($BindId) GUICtrlSetData($Output, '   PIN : '&amp;$Result&amp;@CRLF,1) PrintDir($DirIdRoot,0) ETTokenUnbind($BindId) ETReadersEnumClose($EnumId) EndFunc ;     Func onClose() GUISetState(@SW_HIDE, $hPinWin) GUISetState(@SW_HIDE, $hChildWin) GUISetState(@SW_HIDE, $CreateFileWin) if @GUI_WinHandle=$hParentWin Then Exit EndIf EndFunc ;     Func onPin() GUISetState(@SW_SHOW, $hPinWin ) EndFunc ;       Func onPinOK() $Pin=GUICtrlRead($PinEdit) GUISetState(@SW_HIDE, $hPinWin) _GUICtrlTreeView_DeleteAll ($treeview) List() EndFunc ;    Func onPinCancel() GUISetState(@SW_HIDE, $hPinWin) EndFunc ;  Func Delete() If $Pin=0 Then MsgBox(0x10,$Appname,'      ' ) Else Local $hItem = _GUICtrlTreeView_GetSelection($treeview) Local $Del = _GUICtrlTreeView_GetText($treeview, $hItem) if _GUICtrlTreeView_GetChildren($treeview, $hItem)=False Then $Del=StringTrimLeft ( $Del, 6 ) Local $p=0 $p=StringInStr ($Del,"p:") $Del=StringMid ( $Del, 1, $p-2 ) if MsgBox(4 + 32, $Appname, ' '&amp; $Del &amp;' ?') = 6 Then Local $DirID=_GUICtrlTreeView_GetParentHandle($treeview, $hItem) Local $Dir= _GUICtrlTreeView_GetText($treeview, $DirID) $Dir=StringTrimLeft ( $Dir, 5 ) $BindId=ETTokenBind($Reader[0]) $Result=JCTokenLock($BindId) if $AppletID&lt;&gt;0 Then JCSelectApplet($BindId,$AppletID) EndIf If $Pin &lt;&gt; 0 Then $Result=JCTokenLogin($BindId,$Pin) If $Result=False Then $Result=JCTokenPinAttemptsGet($BindId) MsgBox(0x10,$Appname,' PIN '&amp;@CRLF&amp;'   PIN : '&amp;$Result) EndIf EndIf Local $HDir=GetDir(ETRootDirOpen($BindId,0), $Dir) Local $DELFile =JCFileOpen(Dec ($Del), $HDir) JCFileDelete($DELFile ) ETDirClose($HDir) ETTokenUnbind($BindId) _GUICtrlTreeView_DeleteAll ($treeview) List() EndIf Else MsgBox(0x10,$Appname,'           ' ) EndIf EndIf EndFunc ;     Func onFileCreate() If $Pin=0 Then MsgBox(0x10,$Appname,'      ' ) Else Local $hItem = _GUICtrlTreeView_GetSelection($treeview) Local $FileText = 0, $Dir1=0, $Dir2=0 $FileText = _GUICtrlTreeView_GetText($treeview, $hItem) ;      if StringLen($FileText) &gt;20 Then GUICtrlSetData($FileEdit, '') GUICtrlSetData($FileEdit, '//',0) Else $Dir1=StringTrimLeft ( $FileText, 5 ) Local $ParentID=_GUICtrlTreeView_GetParentHandle($treeview, $hItem) Local $ParentDir= _GUICtrlTreeView_GetText($treeview, $ParentID) if StringInStr ($ParentDir,"Dir")=0 Then $ParentDir='' GUICtrlSetData($FileEdit, '') GUICtrlSetData($FileEdit, '//'&amp;$Dir1&amp;'/',0) Else $Dir2=StringTrimLeft ( $ParentDir, 5 ) $Dir2='/'&amp;$Dir2 GUICtrlSetData($FileEdit, '') GUICtrlSetData($FileEdit, '/'&amp;$Dir2&amp;'/'&amp;$Dir1&amp;'/',0) EndIf EndIf GUISetState(@SW_SHOW, $CreateFileWin) EndIf EndFunc ;   Func onFileCancel() GUISetState(@SW_HIDE, $CreateFileWin) EndFunc ;   Func onFileOK() Local $filename=GUICtrlRead($FileEdit) Local $isPrivate=_GUICtrlButton_GetCheck($privatebutton) Local $fileSize=GUICtrlRead($sizefile) $BindId=ETTokenBind($Reader[0]) $Result=JCTokenLock($BindId) if $AppletID&lt;&gt;0 Then JCSelectApplet($BindId,$AppletID) EndIf If $Pin &lt;&gt; 0 Then $Result=JCTokenLogin($BindId,$Pin) If $Result=False Then $Result=JCTokenPinAttemptsGet($BindId) MsgBox(0x10,$Appname,' PIN '&amp;@CRLF&amp;'   PIN : '&amp;$Result ) EndIf EndIf Local $rootdir=ETRootDirOpen($BindId,0) Local $text=StringTrimLeft ( $filename, 2 ) Local $text1=StringLeft($text, 4) $dir1=JCDirOpen(Dec ($text1), $rootdir) if $dir1=false Then $dir1= ETDirCreate(Dec ($text1), $rootdir) EndIf if StringLen($text) &gt;12 Then $text=StringTrimLeft ( $text, 5 ) $text1=StringLeft($text, 4) $dir2=JCDirOpen(Dec ($text1), $dir1) if $dir2=false Then $dir2= ETDirCreate(Dec ($text1), $dir1) EndIf $text=StringTrimLeft ( $text, 5 ) Local $DstFile=JCFileCreate(Dec ($text),$Dir2,$fileSize,$isPrivate) JCFileClose($DstFile) Else $text=StringTrimLeft ( $text, 5 ) Local $DstFile=JCFileCreate(Dec ($text),$Dir1,$fileSize,$isPrivate) JCFileClose($DstFile) EndIf ETTokenUnbind($BindId) GUISetState(@SW_HIDE, $CreateFileWin) GUISetState(@SW_SHOW, $hParentWin) _GUICtrlTreeView_DeleteAll ($treeview) List() EndFunc ;     Func SaveFile() If $Pin=0 Then MsgBox(0x10,$Appname,'      ' ) Else Local $filebody=GUICtrlRead($Edit1) Local $hItem = _GUICtrlTreeView_GetSelection($treeview) Local $FileEd = _GUICtrlTreeView_GetText($treeview, $hItem) $FileEd=StringTrimLeft ( $FileEd, 6 ) Local $p=0 $p=StringInStr ($FileEd,"p:") $FileEd=StringMid ( $FileEd, 1, $p-2 ) Local $DirID=_GUICtrlTreeView_GetParentHandle($treeview, $hItem) Local $Dir= _GUICtrlTreeView_GetText($treeview, $DirID) $Dir=StringTrimLeft ( $Dir, 5 ) $BindId=ETTokenBind($Reader[0]) $Result=JCTokenLock($BindId) if $AppletID&lt;&gt;0 Then JCSelectApplet($BindId,$AppletID) EndIf If $Pin &lt;&gt; 0 Then $Result=JCTokenLogin($BindId,$Pin) If $Result=False Then $Result=JCTokenPinAttemptsGet($BindId) MsgBox(0x10,$Appname,' PIN '&amp;@CRLF&amp;'   PIN : '&amp;$Result) EndIf EndIf Local $HDir=GetDir(ETRootDirOpen($BindId,0), $Dir) Local $File=JCFileOpen(Dec ($FileEd),$HDir) Local $Data =Binary('0x' &amp; $filebody) JCFileWrite($File, $Data) JCFileClose($File) ETDirClose($HDir) ETTokenUnbind($BindId) GUISetState(@SW_HIDE, $hChildWin) _GUICtrlTreeView_DeleteAll ($treeview) List() EndIf EndFunc ;       Func SaveFileAs() Local $varFile = 0 $varFile = FileSaveDialog( " ", @MyDocumentsDir &amp; "\", "  (*.bin)", 16,'',$hParentWin) If StringLen($varFile) &gt; 3 Then Local $filedest $filedest = FileOpen($varFile, 17) ; Check if file open If $filedest = -1 Then MsgBox(0, "Error", "Unable to open file.") Exit EndIf FileWrite($filedest, $text) FileClose($filedest) EndIf EndFunc ;        Func WM_COMMAND($hWnd, $iMsg, $wParam, $lParam) #forceref $hWnd, $iMsg, $lParam Switch $wParam Case $Save SaveFile() Case $idSave SaveFileAs() EndSwitch EndFunc ;==&gt;WM_COMMAND ;   Func GUIInit() $hParentWin= GUICreate($Appname, 560, 400) GUISetOnEvent($GUI_EVENT_CLOSE,'onClose') ;   $treeview = GUICtrlCreateTreeView(6, 6, 400, 300, BitOR($TVS_HASBUTTONS, $TVS_HASLINES, $TVS_LINESATROOT, $TVS_DISABLEDRAGDROP, $TVS_SHOWSELALWAYS), $WS_EX_CLIENTEDGE) $Output = GUICtrlCreateEdit("" , 6, 320, 400, 70, $ES_AUTOVSCROLL + $WS_VSCROLL + $ES_NOHIDESEL + $ES_WANTRETURN) $pinbutton = GUICtrlCreateButton("&amp; PIN ", 430, 20, 100, 50) $filebutton = GUICtrlCreateButton("&amp;", 430, 80, 100, 50) $deletebutton = GUICtrlCreateButton("&amp;", 430, 140, 100, 50) ;     $hPinWin = GUICreate(' PIN ', 200, 200, -1, -1, $WS_SYSMENU, -1, $hParentWin) $PinEdit = GUICtrlCreateInput ("" , 50, 40, 100, 25, $ES_PASSWORD + $ES_NOHIDESEL + $ES_WANTRETURN) $pinokbutton = GUICtrlCreateButton("&amp;OK", 20, 100, 60, 40) $pincancelbutton = GUICtrlCreateButton("&amp;", 110, 100, 60, 40) ;   $CreateFileWin = GUICreate('   ', 340, 350, -1, -1, $WS_SYSMENU, -1, $hParentWin) $FileEdit = GUICtrlCreateInput ("" , 50, 70, 230, 25) $fileokbutton= GUICtrlCreateButton("&amp;OK", 70, 240, 60, 40) $filecancelbutton = GUICtrlCreateButton("&amp;", 210, 240, 60, 40) $publicbutton= _GUICtrlButton_Create($CreateFileWin, "Public", 100, 120, 50, 30, $BS_AUTORADIOBUTTON, 0) $privatebutton=_GUICtrlButton_Create($CreateFileWin, "Private", 160, 120, 50, 30, $BS_AUTORADIOBUTTON, 0) _GUICtrlButton_SetCheck($publicbutton, $BST_CHECKED) Local $label=GUICtrlCreateLabel('      hex  1001 ', 70, 20, 170, 40, $SS_CENTER) $sizefile = GUICtrlCreateInput ("10" , 220, 175, 50, 20) Local $label1=GUICtrlCreateLabel('    ', 20, 180, 200, 60, $SS_CENTER) ;   $hChildWin = GUICreate($sItemText, 300, 230, -1, -1, $WS_SYSMENU, -1, $hParentWin) $Edit1 = GUICtrlCreateEdit("", 10, 10, 240, 160, $ES_AUTOVSCROLL + $WS_VSCROLL + $ES_NOHIDESEL + $ES_WANTRETURN) ;   ""     $hFile = _GUICtrlMenu_CreateMenu () _GUICtrlMenu_InsertMenuItem ($hFile, 0, ' ...', $idSave) _GUICtrlMenu_InsertMenuItem ($hFile, 1, ' ', $Save) $hMain = _GUICtrlMenu_CreateMenu () _GUICtrlMenu_InsertMenuItem ($hMain, 0, '', 0, $hFile) _GUICtrlMenu_SetMenu ($hChildWin, $hMain) ;  GUICtrlSetOnEvent($filebutton,'onFileCreate') GUICtrlSetOnEvent($deletebutton,'Delete') GUICtrlSetOnEvent($pinbutton,'onPin') GUICtrlSetOnEvent($pinokbutton,'onPinOK') GUICtrlSetOnEvent($pincancelbutton,'onPinCancel') GUICtrlSetOnEvent($fileokbutton,'onFileOK') GUICtrlSetOnEvent($filecancelbutton,'onFileCancel') GUISetOnEvent($GUI_EVENT_CLOSE,'onClose') GUISetState(@SW_SHOW, $hParentWin) GUIRegisterMsg(0x0111, "WM_COMMAND") EndFunc ;    GUIInit() List() ;          GUIRegisterMsg($WM_NOTIFY, "MY_WM_NOTIFY") Global $iDoubleClick = 0 Func MY_WM_NOTIFY($hWnd, $Msg, $wParam, $lParam) Local $tagNMHDR, $vEvent Switch $wParam Case $treeview $tagNMHDR = DllStructCreate("int;int;int", $lParam) If @error Then Return $vEvent = DllStructGetData($tagNMHDR, 3) If $vEvent = $NM_DBLCLK Then $iDoubleClick = 1 EndIf EndSwitch $tagNMHDR = 0 EndFunc ;==&gt;MY_WM_NOTIFY ;  ,      Func GetDir( $Id,$Dir_Id) Local $DirId=0 Local $DirResult=0 Local $EnumId=ETDirEnumOpen($Id) While 1 Local $dir=ETDirEnumNext($EnumId) If @error Then ExitLoop $DirId=ETDirOpen($dir,$Id) if hex($dir,4)=$Dir_Id Then $DirResult=$DirId ExitLoop EndIf $DirResult=GetDir( $DirId, $Dir_Id) ETDirClose($DirId) WEnd ETDirEnumClose($EnumId) Return $DirResult EndFunc ;            Func ListFile($file, $Dir_Id) $BindId=ETTokenBind($Reader[0]) $Result=JCTokenLock($BindId) if $AppletID&lt;&gt;0 Then JCSelectApplet($BindId,$AppletID) EndIf If $Pin &lt;&gt; 0 Then $Result=JCTokenLogin($BindId,$Pin) If $Result=False Then $Result=JCTokenPinAttemptsGet($BindId) MsgBox(0x10,$Appname,' PIN '&amp;@CRLF&amp;'   PIN : '&amp;$Result ) EndIf EndIf if StringLen($Dir_Id)&gt;10 Then $HDir=ETRootDirOpen($BindId,0) Else Local $HDir=GetDir(ETRootDirOpen($BindId,0), $Dir_Id) EndIf $SrcSubId=JCFileOpen(Dec ($file), $HDir) $text=JCFileRead($SrcSubId) GUICtrlSetData($Edit1, hex($text)) JCFileClose($SrcSubId) ETDirClose($HDir) ETTokenUnbind($BindId) EndFunc ;          While 1 if $iDoubleClick Then Local $hItem = _GUICtrlTreeView_GetSelection($treeview) if _GUICtrlTreeView_GetChildren($treeview, $hItem)=False Then Local $hItem = _GUICtrlTreeView_GetSelection($treeview) $sItemText = _GUICtrlTreeView_GetText($treeview, $hItem) if StringInStr ($sItemText,"Dir")=0 Then Local $text1=0 $text1=StringTrimLeft ( $sItemText, 6 ) Local $p=0 $p=StringInStr ($text1,"p:") $sItemText=0 $sItemText=StringMid ( $text1, 1, $p-2 ) GUISetState(@SW_SHOW, $hChildWin) GUISetOnEvent($GUI_EVENT_CLOSE,'onClose') Local $DirID=_GUICtrlTreeView_GetParentHandle($treeview, $hItem) Local $Dir= _GUICtrlTreeView_GetText($treeview, $DirID) $text1=StringTrimLeft ( $Dir, 5 ) $Dir=$text1 ListFile($sItemText, $Dir) EndIf EndIf $iDoubleClick = 0 EndIf WEnd</span></span></code> </pre> <br></div></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¿¡æ¯æ¥æº</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">eTokenå¼€å‘äººå‘˜æŒ‡å—3.50ç‰ˆï¼ˆ2003å¹´12æœˆï¼‰</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN441476/">https://habr.com/ru/post/zh-CN441476/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN441456/index.html">å…­ä¸ªæ•…äº‹ï¼Œå¦‚ä½•ä»å¤´å¼€å§‹é‡å†™ä»£ç </a></li>
<li><a href="../zh-CN441458/index.html">æœºæ¢°è‡‚å’Œæœºæ¢°æ‰‹-å‘Šè¯‰æ‚¨ITMOå¤§å­¦æœºå™¨äººå®éªŒå®¤çš„å·¥ä½œ</a></li>
<li><a href="../zh-CN441460/index.html">æ‚¨å¦‚ä½•çœ‹å¾…ITæ•™è‚²ï¼Ÿ</a></li>
<li><a href="../zh-CN441468/index.html">Facebookå°†å…³é—­å…¶é—´è°è½¯ä»¶VPN Onavo</a></li>
<li><a href="../zh-CN441472/index.html">ç¥ç»ç½‘ç»œæ•™æˆå¦‚ä½•åœ¨äººç‰©ç…§ç‰‡ä¸­ç»˜åˆ¶ç¼ºå¤±çš„ç»†èŠ‚</a></li>
<li><a href="../zh-CN441478/index.html">XSLTä¸Šçš„äº’åŠ¨æ¸¸æˆ</a></li>
<li><a href="../zh-CN441482/index.html">ä¼Šæ°¸å¤ªå¹³æ´‹çš„æ–°å¹´è¡¨</a></li>
<li><a href="../zh-CN441484/index.html">å¾®è½¯å‘˜å·¥åå¯¹åœ¨å†›é˜Ÿä¸­ä½¿ç”¨HoloLensï¼Œå› ä¸ºæˆ˜äº‰å˜æˆäº†ç”µè„‘æ¸¸æˆ</a></li>
<li><a href="../zh-CN441490/index.html">é€‰æ‹©é˜…è¯»å™¨æ—¶è¦å¯»æ‰¾çš„å†…å®¹-æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶</a></li>
<li><a href="../zh-CN441496/index.html">çº¿ä¸Šçš„å£°éŸ³ï¼šç”µæŠ¥çš„å†å²</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>