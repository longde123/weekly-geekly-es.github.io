<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ê üì≠ üöß Reconstru√ß√£o 3D de rostos de fotografias e suas anima√ß√µes usando v√≠deo. Palestra em Yandex üôÄ üçñ üõ°Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No filme Miss√£o Imposs√≠vel 3, foi mostrado o processo de cria√ß√£o das famosas m√°scaras de espi√£o, gra√ßas ao qual alguns personagens se tornam indisting...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Reconstru√ß√£o 3D de rostos de fotografias e suas anima√ß√µes usando v√≠deo. Palestra em Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/421353/"> No filme Miss√£o Imposs√≠vel 3, foi mostrado o processo de cria√ß√£o das famosas m√°scaras de espi√£o, gra√ßas ao qual alguns personagens se tornam indistingu√≠veis dos outros.  De acordo com o enredo, inicialmente era necess√°rio fotografar a pessoa em que o her√≥i queria se transformar de v√°rios √¢ngulos.  Em 2018, um simples modelo de rosto 3D pode at√© n√£o ser impresso, mas pelo menos criado em formato digital - e com base em apenas uma foto.  Um pesquisador da VisionLabs descreveu em detalhes o processo no evento Yandex ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mundo atrav√©s dos olhos dos rob√¥s</a> ‚Äù da s√©rie Data &amp; Science, com detalhes sobre m√©todos e f√≥rmulas espec√≠ficas. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/zy9fxYDgUQw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Boa tarde  Meu nome √© Nikolai, trabalho para a VisionLabs, uma empresa de vis√£o computacional.  Nosso perfil principal √© o reconhecimento facial, mas tamb√©m temos tecnologias aplic√°veis ‚Äã‚Äãem realidade aumentada e virtual.  Em particular, temos uma tecnologia para construir uma face 3D a partir de uma foto, e hoje vou falar sobre isso. <br><br><a name="habracut"></a><img src="https://habrastorage.org/webt/hi/ks/fu/hiksfukx8cknqrbhf5kv-c9xwbs.jpeg"><br><br>  Vamos come√ßar com uma hist√≥ria sobre o que √©.  No slide, voc√™ v√™ a foto original de Jack Ma e um modelo 3D constru√≠do a partir desta foto em duas varia√ß√µes: com e sem textura, apenas geometria.  Esta √© a tarefa que estamos resolvendo. <br><br><img src="https://habrastorage.org/webt/qo/sy/10/qosy10ijsqqmfgyqiemsloakdqg.jpeg"><br><br>  Tamb√©m queremos poder animar esse modelo, mudar a dire√ß√£o do nosso olhar, express√£o facial, adicionar express√µes faciais etc. <br><br>  A aplica√ß√£o est√° em diferentes √°reas.  Os mais √≥bvios s√£o os jogos, incluindo VR.  Voc√™ tamb√©m pode fazer provadores virtuais - experimente √≥culos, barbas e penteados.  Voc√™ pode imprimir em 3D, porque algumas pessoas est√£o interessadas em acess√≥rios personalizados para o rosto.  E voc√™ pode fazer caretas para rob√¥s: imprima e mostre em alguma exibi√ß√£o no rob√¥. <br><br><img src="https://habrastorage.org/webt/uh/d4/1b/uhd41bqzarsfib5oao3zven7gxk.jpeg"><br><br>  Come√ßarei dizendo como gerar faces 3D em geral e, em seguida, passaremos √† tarefa de reconstru√ß√£o 3D como uma tarefa de gera√ß√£o inversa.  Depois disso, focaremos na anima√ß√£o e avan√ßaremos para os desafios que surgem nesta √°rea. <br><br><img src="https://habrastorage.org/webt/bk/yb/sj/bkybsja0tr11pleorczx4okgk3g.jpeg"><br><br>  Qual √© a tarefa de gerar rostos?  Gostar√≠amos de ter alguma maneira de gerar faces tridimensionais que diferem em forma e express√£o.  Aqui est√£o duas linhas com exemplos.  A primeira linha mostra faces de diferentes formas, pertencendo como se a pessoas diferentes.  E abaixo est√° a mesma face com uma express√£o diferente. <br><br><img src="https://habrastorage.org/webt/_s/md/94/_smd94kpe-kgilpu8c2ncguhgve.jpeg"><br><br>  Uma maneira de resolver o problema de gera√ß√£o s√£o os modelos deform√°veis.  A face mais √† esquerda no slide √© um tipo de modelo com m√©dia para o qual podemos aplicar deforma√ß√µes ajustando os controles deslizantes.  Aqui est√£o tr√™s controles deslizantes.  Na linha superior, existem faces na dire√ß√£o de aumentar a intensidade do controle deslizante, na linha inferior - na dire√ß√£o de diminuir.  Assim, teremos v√°rios par√¢metros personaliz√°veis.  Ao instal√°-los, voc√™ pode dar √†s pessoas formas diferentes. <br><br><img src="https://habrastorage.org/webt/rs/gj/bd/rsgjbdm2ekfclog-l9r24yj05zq.jpeg"><br><br>  Um exemplo de modelo deform√°vel √© o famoso Basel Face Model, constru√≠do a partir de digitaliza√ß√µes de rosto.  Para criar um modelo deform√°vel, voc√™ primeiro precisa levar algumas pessoas, lev√°-las a um laborat√≥rio especial e fotografar seus rostos com equipamentos especiais, traduzindo-os para 3D.  Ent√£o, com base nisso, voc√™ pode fazer novas caras. <br><br><img src="https://habrastorage.org/webt/da/lm/zi/dalmziafwox1_wosdsp25pjphiu.jpeg"><br><br>  Como √© organizado matematicamente?  Podemos imaginar um modelo tridimensional de uma face como um vetor no espa√ßo tridimensional.  Aqui n √© o n√∫mero de v√©rtices no modelo, cada v√©rtice corresponde a tr√™s coordenadas em 3D e, portanto, obtemos 3n coordenadas. <br><br><img src="https://habrastorage.org/webt/fr/h2/ek/frh2ekb0ts7xoeymvoxdthm7_ak.jpeg"><br><br>  Se temos um conjunto de varreduras, cada varredura √© representada por esse vetor e temos um conjunto de n vetores. <br><br>  Al√©m disso, podemos construir novas faces como combina√ß√µes lineares de vetores do nosso banco de dados.  Ao mesmo tempo, gostar√≠amos que os coeficientes fossem significativos.  Obviamente, eles n√£o podem ser completamente arbitr√°rios, e logo mostrarei o porqu√™.  Uma das restri√ß√µes pode ser definida para que todos os coeficientes fiquem no intervalo de 0 a 1. Isso deve ser feito, porque se os coeficientes forem completamente arbitr√°rios, as faces ser√£o implaus√≠veis. <br><br><img src="https://habrastorage.org/webt/43/x3/m_/43x3m_fwzwj8xcsvywqjusbijmm.jpeg"><br><br>  Aqui eu gostaria de dar aos par√¢metros algum significado probabil√≠stico.  Ou seja, queremos examinar um conjunto de par√¢metros e entender se √© prov√°vel que uma pessoa apare√ßa ou n√£o.  Com isso, queremos que distor√ß√µes baixas correspondam a faces distorcidas. <br><br><img src="https://habrastorage.org/webt/ge/m4/yb/gem4ybi9ha0puz8tcjv3nomiwiy.jpeg"><br><br>  Aqui est√° como faz√™-lo.  Podemos aplicar o m√©todo do componente principal a um conjunto de varreduras.  Na sa√≠da, obtemos a face m√©dia S0, obtemos a matriz V, um conjunto de componentes principais e tamb√©m obtemos varia√ß√µes de dados ao longo dos componentes principais.  Depois, podemos dar uma nova olhada na gera√ß√£o de faces, representaremos as faces como uma face m√©dia, mais a matriz dos componentes principais, multiplicada pelo vetor de par√¢metros. <br><br>  O valor dos par√¢metros √© a pr√≥pria intensidade dos controles deslizantes mencionados em um dos slides anteriores.  E tamb√©m podemos atribuir algum valor probabil√≠stico ao vetor de par√¢metros.  Em particular, podemos concordar que esse vetor seja gaussiano. <br><br><img src="https://habrastorage.org/webt/pv/bk/qq/pvbkqqdess7l175ginfuz9vkzmw.jpeg"><br><br>  Assim, obtemos um m√©todo que permite gerar faces 3D e essa gera√ß√£o √© controlada pelos seguintes par√¢metros.  Como no slide anterior, temos dois conjuntos de par√¢metros, dois vetores Œ± id e Œ± exp, eles s√£o os mesmos do slide anterior, mas Œ± id √© respons√°vel pelo formato da face e Œ± exp ser√° respons√°vel pela emo√ß√£o. <br><br>  Um novo vetor T tamb√©m aparece - um vetor de textura.  Ele tem a mesma dimens√£o que o vetor de forma e cada v√©rtice nesse vetor tem tr√™s valores RGB.  Da mesma forma, um vetor de textura √© gerado usando o vetor de par√¢metro Œ≤.  Aqui n√£o s√£o formalizados os par√¢metros que ser√£o respons√°veis ‚Äã‚Äãpor iluminar o rosto e por sua posi√ß√£o, mas tamb√©m existem. <br><br><img src="https://habrastorage.org/webt/ab/bx/23/abbx2327nyov76ewuzl_s_fa9qo.jpeg"><br><br>  Aqui est√£o exemplos de faces que podem ser geradas usando um modelo deformado.  Observe que eles diferem em forma, cor da pele e tamb√©m s√£o desenhados em diferentes condi√ß√µes de ilumina√ß√£o. <br><br><img src="https://habrastorage.org/webt/-n/ht/eu/-nhteuzhzcomppfvup80sevyhhc.jpeg"><br><br>  Agora podemos avan√ßar para a reconstru√ß√£o 3D.  Isso √© chamado de problema inverso, porque queremos selecionar esses par√¢metros para o modelo deform√°vel, de modo que a face que extra√≠mos seja o m√°ximo poss√≠vel semelhante ao original.  Esse slide difere do primeiro, pois aqui, √† direita, o rosto √© completamente sint√©tico.  Se no primeiro slide nossa textura foi tirada de uma fotografia, ent√£o aqui a textura foi tirada de um modelo deform√°vel. <br><br>  Na sa√≠da, teremos todos os par√¢metros, no slide Œ± id e Œ± exp s√£o apresentados, e tamb√©m teremos par√¢metros de ilumina√ß√£o, textura, etc. <br><br><img src="https://habrastorage.org/webt/qa/ci/ql/qaciqlkbflxmqo1a1pzzn01g4d8.jpeg"><br><br>  Dissemos que queremos garantir que o modelo gerado pare√ßa uma fotografia.  Essa similaridade √© determinada usando a fun√ß√£o de energia.  Aqui apenas consideramos a diferen√ßa pixel por pixel das imagens nos pixels em que achamos que o rosto √© vis√≠vel.  Por exemplo, se o rosto estiver virado, ocorrer√° sobreposi√ß√£o.  Por exemplo, parte da ma√ß√£ do rosto ser√° coberta pelo nariz.  E a matriz de visibilidade M deve exibir essa sobreposi√ß√£o. <br><br>  Em ess√™ncia, a reconstru√ß√£o 3D √© minimizar essa fun√ß√£o de energia.  Mas, para resolver esse problema de minimiza√ß√£o, seria bom ter inicializa√ß√£o e regulariza√ß√£o.  A regulariza√ß√£o √© necess√°ria por uma raz√£o √≥bvia, pois dissemos que, se n√£o regularizarmos os par√¢metros e os tornarmos completamente arbitr√°rios, podemos obter faces distorcidas.  A inicializa√ß√£o √© necess√°ria porque a tarefa como um todo √© complexa, possui m√≠nimos locais e voc√™ n√£o deseja lidar com eles. <br><br><img src="https://habrastorage.org/webt/jq/i-/ns/jqi-nskft-v7pvl8tadsmrldaco.jpeg"><br><br>  Como a inicializa√ß√£o pode ser feita?  Para isso, voc√™ pode usar 68 pontos principais da face.  Desde 2013-2014, surgiram muitos algoritmos que permitem a detec√ß√£o de 68 pontos com uma precis√£o bastante boa, e agora eles est√£o se aproximando de uma satura√ß√£o de sua precis√£o.  Portanto, temos uma maneira de detectar com seguran√ßa 68 pontos da face. <br><br>  Podemos adicionar um novo termo √† nossa fun√ß√£o energ√©tica, o que dir√° que queremos que as proje√ß√µes dos mesmos 68 pontos do modelo coincidam com os pontos principais da face.  Marcamos esses pontos no modelo e, de alguma forma, deformamos o modelo, torcemos, projetando os pontos e asseguramos que as posi√ß√µes dos pontos coincidam.  Na foto da esquerda, existem pontos de duas cores, violeta e amarelo.  Alguns pontos foram detectados pelo algoritmo, enquanto outros foram projetados a partir do modelo.  Marcar pontos no modelo √† direita, mas para pontos ao longo da borda da face, nenhum ponto √© marcado, mas uma linha inteira.  Isso √© feito porque quando a face √© girada, as marca√ß√µes desses pontos devem mudar e o ponto √© selecionado com uma linha. <br><br><img src="https://habrastorage.org/webt/sb/kg/n0/sbkgn0oajeqf_z-bleo0qfhzguy.jpeg"><br><br>  Aqui est√° o termo sobre o qual eu falei: √© a diferen√ßa entre coordenadas de dois vetores que descreve os pontos-chave da face e os pontos-chave projetados a partir do modelo. <br><br><img src="https://habrastorage.org/webt/wj/ku/eq/wjkueqaneclilvcxhbdsimu-gik.jpeg"><br><br>  Voltemos √† regulariza√ß√£o e consideremos todo o problema da perspectiva da conclus√£o bayesiana.  A probabilidade de o vetor Œ± ser igual a algo dado em uma imagem conhecida √© proporcional ao produto da probabilidade de observar a imagem para um dado Œ±, multiplicado pela probabilidade Œ±.  Se tomarmos o logaritmo negativo dessa express√£o, que teremos que minimizar, veremos que o termo respons√°vel pela regulariza√ß√£o ter√° uma forma concreta aqui.  Em particular, este √© o segundo termo.  Lembrando que anteriormente assumimos que o vetor Œ± √© gaussiano, vemos que o termo respons√°vel pela regulariza√ß√£o √© a soma dos quadrados dos par√¢metros reduzidos a varia√ß√µes ao longo dos componentes principais. <br><br><img src="https://habrastorage.org/webt/9t/hj/y2/9thjy2x8qmvgcqxayk7rrddusra.jpeg"><br><br>  Assim, podemos escrever a fun√ß√£o de energia completa, que cont√©m tr√™s termos.  O primeiro termo √© respons√°vel pela textura, pela diferen√ßa de pixels entre a imagem gerada e a imagem de destino.  O segundo termo √© respons√°vel por pontos-chave e o terceiro √© respons√°vel pela regulariza√ß√£o. <br><br>  Os coeficientes dos termos no processo de minimiza√ß√£o n√£o s√£o otimizados, s√£o simplesmente definidos. <br>  Aqui, a fun√ß√£o de energia √© representada como uma fun√ß√£o de todos os par√¢metros.  par√¢metros de forma Œ± id - face, par√¢metros Œ± exp - express√£o, par√¢metros Œ≤ - textura, p - outros par√¢metros sobre os quais falamos, mas n√£o formalizamos, s√£o par√¢metros de posi√ß√£o e ilumina√ß√£o. <br><br><img src="https://habrastorage.org/webt/tn/ki/np/tnkinpazftdmbqj3cyiij4vxn8s.jpeg"><br><br>  Vamos nos debru√ßar sobre esta observa√ß√£o.  Esta fun√ß√£o de energia pode ser simplificada.  A partir dele, voc√™ pode descartar o termo respons√°vel pela textura e usar apenas as informa√ß√µes transmitidas por 68 pontos.  E isso permitir√° que voc√™ crie algum tipo de modelo 3D.  No entanto, preste aten√ß√£o ao perfil do modelo.  √Ä esquerda, h√° um modelo constru√≠do apenas em pontos-chave.  √Ä direita est√° um modelo usando textura ao construir.  Observe que o perfil √† direita √© mais consistente com a fotografia central, que representa a vista frontal do rosto. <br><br><img src="https://habrastorage.org/webt/r2/kp/p9/r2kpp94wnxg7vhfz1nha-ewl4xg.jpeg"><br><br>  A anima√ß√£o com o algoritmo existente para a constru√ß√£o de um modelo 3D da face funciona de maneira bastante simples.  Lembre-se de que, ao criar um modelo 3D, obtemos dois vetores de par√¢metros, um respons√°vel pela forma e o outro pela express√£o.  Esses vetores de par√¢metros para o usu√°rio e o avatar sempre ter√£o seus pr√≥prios.  O usu√°rio tem um vetor de par√¢metros de formul√°rio, o avatar tem um vetor diferente.  No entanto, podemos tornar os vetores respons√°veis ‚Äã‚Äãpela express√£o os mesmos.  Vamos pegar os par√¢metros respons√°veis ‚Äã‚Äãpela express√£o facial do usu√°rio e simplesmente substitu√≠-los no modelo de avatar.  Assim, transferiremos a express√£o facial do usu√°rio para o avatar. <br><br>  Vamos falar sobre dois desafios nessa √°rea: a velocidade do trabalho e o modelo deform√°vel limitado. <br><br><img src="https://habrastorage.org/webt/d8/s6/q8/d8s6q8yjlm76pcdoa2p4pavf-vw.jpeg"><br><br>  A velocidade √© realmente um problema.  Minimizar a fun√ß√£o total de energia √© uma tarefa muito computacionalmente intensiva.  Em particular, pode levar de 20 a 40, em m√©dia 30 segundos.  Isso √© longo o suficiente.  Se construirmos um modelo tridimensional apenas em pontos-chave, ele ser√° muito mais r√°pido, mas a qualidade sofrer√° com isso. <br><br><img src="https://habrastorage.org/webt/wk/se/zq/wksezqkjmdzs3v25feuanneaf84.jpeg"><br><br>  Como lidar com este problema?  Voc√™ pode usar mais recursos, algumas pessoas resolvem esse problema na GPU.  Somente pontos-chave podem ser usados, mas a qualidade sofrer√°.  E voc√™ pode usar m√©todos de aprendizado de m√°quina. <br><br><img src="https://habrastorage.org/webt/p2/8m/fa/p28mfavfwitizfwss5fhreauviq.jpeg"><br><br>  Vamos ver em ordem.  Aqui est√° o trabalho de 2016, no qual a express√£o facial do usu√°rio √© transferida para um v√≠deo espec√≠fico, voc√™ pode controlar o v√≠deo usando seu rosto.  Aqui, a constru√ß√£o do modelo 3D √© realizada em tempo real usando a GPU. <br><br><img src="https://habrastorage.org/webt/dn/qx/yj/dnqxyjywcjbx5yus2v7pvcyq8vm.jpeg"><br><br>  Aqui est√£o os m√©todos que usam o aprendizado de m√°quina.  A id√©ia √© que podemos primeiro pegar uma grande base de faces, para cada face usando um algoritmo longo mas preciso para criar modelos 3D, apresentar cada modelo como um conjunto de par√¢metros e depois treinar a grade para prever esses par√¢metros.  Em particular, neste trabalho de 2016, √© utilizado o ResNet, que leva uma imagem para a entrada e fornece os par√¢metros do modelo para a sa√≠da. <br><br><img src="https://habrastorage.org/webt/p6/ng/t6/p6ngt6gzn-4mps27709zhmeuzwk.jpeg"><br><br>  O modelo tridimensional pode ser representado de outra maneira.  Neste trabalho de 2017, o modelo 3D √© apresentado n√£o como um conjunto de par√¢metros, mas como um conjunto de voxels.  A rede prev√™ voxels, transformando a imagem em uma representa√ß√£o tridimensional.  Vale ressaltar que s√£o poss√≠veis op√ß√µes de treinamento em rede para as quais os modelos 3D n√£o s√£o necess√°rios. <br><br><img src="https://habrastorage.org/webt/yw/__/ot/yw__otysknuehp7kdjgikvziijc.jpeg"><br><br>  Isso funciona da seguinte maneira.  Aqui, a parte mais importante √© a camada, que pode pegar os par√¢metros do modelo deform√°vel como entrada e renderizar a imagem.  Tem uma propriedade t√£o maravilhosa que, atrav√©s dela, voc√™ pode fazer a propaga√ß√£o de volta do erro.  A rede aceita uma imagem como entrada, prediz os par√¢metros, alimenta esses par√¢metros para uma camada que renderiza a imagem, compara essa imagem com a entrada, recebe um erro, propaga o erro de volta e continua aprendendo.  Assim, a rede aprende a prever os par√¢metros do modelo tridimensional, tendo apenas figuras como dados de treinamento.  E isso √© muito interessante. <br><br><img src="https://habrastorage.org/webt/m_/kx/vc/m_kxvcoekvrrgp41k410ikd_viu.jpeg"><br><br>  Conversamos muito sobre precis√£o - em particular, que ela sofre se descartamos alguns termos da fun√ß√£o da energia.  Vamos formalizar o que isso significa, como voc√™ pode avaliar a precis√£o da reconstru√ß√£o de face 3D.  Para fazer isso, precisamos de uma base de verifica√ß√µes da verdade verdade obtidas usando equipamento especial, usando m√©todos com rela√ß√£o aos quais existem algumas garantias de precis√£o.  Se essa base existe, podemos comparar nossos modelos reconstru√≠dos com a verdade b√°sica.  Isso √© feito simplesmente: calculamos a dist√¢ncia m√©dia dos v√©rtices do nosso modelo, que constru√≠mos, aos v√©rtices na verdade do solo e normalizamos o tamanho da varredura.  Isso deve ser feito porque as faces s√£o diferentes, algumas s√£o maiores, algumas s√£o menores e o erro na face menor seria menor, simplesmente porque a face em si √© menor.  Portanto, a normaliza√ß√£o √© necess√°ria. <br><br><img src="https://habrastorage.org/webt/a0/us/rq/a0usrqlogscnks2yygnrestgf9o.jpeg"><br><br>  Eu gostaria de falar sobre o nosso trabalho, ser√° em oficinas, h√° ECCV.  Fazemos coisas semelhantes, ensinamos o MobileNet a prever os par√¢metros de um modelo deform√°vel.  Como dados de treinamento, usamos modelos 3D criados para fotografias do conjunto de dados de 300W.  Avalie a precis√£o com base nas digitaliza√ß√µes BU4DFE. <br><br><img src="https://habrastorage.org/webt/oa/db/ha/oadbhaivdnukffi7vcdwye8vsmu.jpeg"><br><br>  Aqui est√° o resultado.  Comparamos nossos dois algoritmos com o estado da arte.  A curva amarela neste gr√°fico √© um algoritmo que leva 30 segundos e consiste em minimizar a fun√ß√£o de energia total.  Aqui, no eixo X, est√° o erro que acabamos de falar, a dist√¢ncia m√©dia entre os v√©rtices.  O eixo Y √© a fra√ß√£o de imagens em que esse erro √© menor que o do eixo X. Nesse gr√°fico, quanto maior a curva, melhor.  A pr√≥xima curva √© a nossa rede baseada em MobileNet.  A seguir, os tr√™s trabalhos sobre os quais falamos.  Rede preditiva de par√¢metros e rede preditiva de voxel. <br><br><img src="https://habrastorage.org/webt/p3/ku/82/p3ku82pa5bgvee5_k7mj2w5bfne.jpeg"><br><br>  Tamb√©m comparamos nossa rede com colegas em termos de tamanho e velocidade do modelo.  Esta √© uma vit√≥ria, porque usamos o MobileNet, o que √© bastante f√°cil. <br><br>  O segundo desafio √© a limita√ß√£o do modelo deform√°vel. <br><br><img src="https://habrastorage.org/webt/u1/6a/9j/u16a9jeq3vc6lvwvc0hu82ymqd8.jpeg"><br><br>  Preste aten√ß√£o na face esquerda, observe as asas do nariz.  H√° sombras nas asas do nariz.  As bordas das sombras n√£o coincidem com as bordas do nariz na foto, portanto, um defeito √© obtido.  A raz√£o para isso pode ser que o modelo deform√°vel, em princ√≠pio, n√£o √© capaz de construir o nariz da forma requerida, porque esse modelo deform√°vel foi obtido a partir de digitaliza√ß√µes de apenas 200 faces.  Gostar√≠amos que o nariz estivesse correto, como na foto certa.  Portanto, precisamos de alguma forma ir al√©m da estrutura do modelo deform√°vel. <br><br><img src="https://habrastorage.org/webt/eh/83/a5/eh83a5w3ovjb0t3v0d3slmazsgc.jpeg"><br><br>  Isso pode ser feito usando deforma√ß√£o n√£o param√©trica da malha.  Aqui est√£o tr√™s tarefas que gostar√≠amos de resolver: modificar a parte local da face, por exemplo, o nariz, incorpor√°-la no modelo original da face e at√© mesmo para que todo o resto permane√ßa inalterado. <br><br><img src="https://habrastorage.org/webt/kr/dt/j5/krdtj5freppwfivlapbiqtlyz-y.jpeg"><br><br>  Isso pode ser feito da seguinte maneira.  Voltemos √† designa√ß√£o da malha como um vetor no espa√ßo tridimensional e observemos o operador de m√©dia.  Este √© um operador que em S com um cabe√ßalho substitui cada v√©rtice pela m√©dia de seus vizinhos.  Os vizinhos do pico s√£o aqueles que est√£o conectados a ele por uma borda. <br><br>  Definiremos uma certa fun√ß√£o energ√©tica que descreve a posi√ß√£o do v√©rtice em rela√ß√£o aos seus vizinhos.  Queremos que a posi√ß√£o do pico em rela√ß√£o aos seus vizinhos permane√ßa inalterada, ou pelo menos n√£o mude muito.  Mas, ao mesmo tempo, modificaremos S. de alguma forma. Essa fun√ß√£o energ√©tica √© chamada interna, porque tamb√©m haver√° algum termo externo, que dir√° que, por exemplo, o nariz deve assumir uma determinada forma. <br><br><img src="https://habrastorage.org/webt/9r/0g/-o/9r0g-o4tyxpzkzgfl_3bx7_xjue.jpeg"><br><br>  Tais t√©cnicas foram utilizadas, por exemplo, no trabalho de 2015.  Eles fizeram a reconstru√ß√£o do rosto em 3D a partir de v√°rias fotografias.  Tiramos v√°rias fotos do telefone, recebemos uma nuvem de pontos e adaptamos o modelo de face a essa nuvem usando modifica√ß√µes n√£o param√©tricas. <br><br><img src="https://habrastorage.org/webt/1q/9c/yh/1q9cyhw6dspqkz57ese7dwbezyc.jpeg"><br><br>  Voc√™ pode ir al√©m do modelo deform√°vel de outra maneira.  Vamos nos concentrar na a√ß√£o do operador de suaviza√ß√£o.  Aqui, por simplicidade, √© apresentada uma malha bidimensional √† qual esse operador foi aplicado.  Existem muitos detalhes no modelo √† esquerda; no modelo √† direita, esses detalhes foram suavizados.  Mas podemos fazer algo para adicionar detalhes em vez de remov√™-los? <br><br><img src="https://habrastorage.org/webt/5k/je/ir/5kjeirpdi5wtjeapi2v6h7tsxm8.jpeg"><br><br>          .          . <br><br>      ?    -:     -  .                   .      ,     2016 .     ,  . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt421353/">https://habr.com/ru/post/pt421353/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt421343/index.html">Protegendo os dados em nuvem do Microsoft Office 365 com o Veeam</a></li>
<li><a href="../pt421345/index.html">Angular: recursos n√£o √≥bvios dos seletores de diretiva</a></li>
<li><a href="../pt421347/index.html">CORS, CSP, HTTPS, HSTS: Sobre as tecnologias de seguran√ßa da Web</a></li>
<li><a href="../pt421349/index.html">Desenvolvendo um Aplicativo Web Progressivo Nada em 15 Minutos</a></li>
<li><a href="../pt421351/index.html">Teoria da felicidade. Maldi√ß√µes do diretor e impressoras amaldi√ßoadas</a></li>
<li><a href="../pt421355/index.html">Lan√ßamento do 1.11 - WebAssembly e m√≥dulos nativos</a></li>
<li><a href="../pt421357/index.html">Para a quest√£o do imposs√≠vel. Parte 3</a></li>
<li><a href="../pt421359/index.html">O festival √© como um jogo. Taxonomia de pessoas de TI</a></li>
<li><a href="../pt421361/index.html">A AMD abriu o c√≥digo-fonte para o V-EZ, uma API Vulkan de shell de baixo n√≠vel e plataforma cruzada</a></li>
<li><a href="../pt421365/index.html">A evolu√ß√£o de uma startup. √Ågil de Yaytselov para Chiken Invaders</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>