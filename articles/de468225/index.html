<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏂🏼 👆🏼 👨🏻‍🚒 Reduzieren der Bundle-Größe mit Webpack Analyzer und React Lazy / Suspense 👄 ♓️ 👂🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mit zunehmender Komplexität von Clientanwendungen wird die Größe ihrer Bundles immer größer. In dieser Situation leiden die Menschen am meisten und si...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Reduzieren der Bundle-Größe mit Webpack Analyzer und React Lazy / Suspense</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/468225/">  Mit zunehmender Komplexität von Clientanwendungen wird die Größe ihrer Bundles immer größer.  In dieser Situation leiden die Menschen am meisten und sind aus verschiedenen Gründen gezwungen, langsame Internetverbindungen zu nutzen.  Außerdem wird es jeden Tag schlimmer. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/yp/wc/u-/ypwcu-trdbiswrdeltqb677yqxk.jpeg"></a> <br><br>  Der Autor des Artikels, dessen Übersetzung wir heute veröffentlichen, arbeitet in Wix.  Er möchte darüber sprechen, wie er mit Webpack Analyzer und React Lazy / Suspense die Größe eines Bundles um etwa 80% reduzieren konnte. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Wie früh soll die Optimierung beginnen?</font> </h2><br>  Wenn Sie gerade mit der Arbeit an Ihrer neuen Webanwendung begonnen haben, versuchen Sie wahrscheinlich, sich darauf zu konzentrieren, sie sozusagen „auf den Weg zu bringen“ und sie zum Laufen zu bringen.  Sie achten wahrscheinlich nicht besonders auf die Leistung oder die Bundle-Größe.  Ich kann das verstehen  Meine Erfahrung zeigt jedoch, dass die Leistung und die Größe der Bundles von Anfang an berücksichtigt werden sollten.  Eine gute Anwendungsarchitektur und eine zeitnahe „Reflexion über die Zukunft des Projekts“ sparen Ihnen auf lange Sicht viel Zeit und tragen dazu bei, keine ernsthaften technischen Schulden zu akkumulieren.  Natürlich ist es schwierig, alles im Voraus vorauszusehen, aber Sie sollten sich vom ersten Arbeitstag an sehr bemühen, alles richtig zu machen. <br><br>  Hier sind einige großartige Tools, die meiner Meinung nach von Anfang an verwendet werden sollten.  Mit diesen Tools können Sie „problematische“ NPM-Pakete erkennen, noch bevor sie einen wichtigen Platz in der Anwendung einnehmen. <br><br><h3>  <font color="#3AC1EF">UndBundlephobie</font> </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bundlephobia</a> ist eine Website, auf der Sie wissen, um wie viel ein bestimmtes NPM-Paket die Größe eines Bundles erhöht.  Dies ist ein großartiges Tool, mit dem der Programmierer die richtigen Entscheidungen hinsichtlich der Auswahl der Pakete von Drittanbietern treffen kann, die er möglicherweise benötigt.  Bundlephobia hilft dabei, die Anwendungsarchitektur so zu gestalten, dass ihre Größe nicht zu groß wird.  Die folgende Abbildung zeigt die Ergebnisse der Überprüfung einer beliebten Bibliothek auf Zeitarbeit, die als Moment bezeichnet wird.  Sie können sehen, dass diese Bibliothek ziemlich groß ist - fast 66 KB in komprimierter Form.  Für viele Benutzer, die im Hochgeschwindigkeitsinternet arbeiten, ist dies nichts.  Es lohnt sich jedoch, auf die Downloadzeit dieses Pakets in 2G / 3G-Netzwerken zu achten.  Sie beträgt 2,2 bzw. 1,32 Sekunden.  Und seien Sie vorsichtig, wir sprechen nur über dieses eine Paket. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c1/298/eed/1c1298eed8992918c5314e651ea04032.png"></div><br>  <i><font color="#999999">Ergebnisse der Bundlephobia-Moment-Paketanalyse</font></i> <br><br><h3>  <font color="#3AC1EF">▍Kosten importieren</font> </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Import Cost</a> ist eine sehr interessante Erweiterung für viele beliebte Code-Editoren (es gibt über eine Million Downloads für <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VS Code</a> ).  Es kann die "Kosten" importierter Pakete anzeigen.  Ich mag es besonders, weil es hilft, Problembereiche der Anwendung direkt während der Arbeit zu identifizieren.  Die folgende Abbildung (entnommen aus der Seite GitHub importieren) zeigt ein hervorragendes Beispiel für die Auswirkungen eines anderen Ansatzes zum Importieren von Entitäten auf die Projektdimensionen.  Der Import der einzigen <code>uniqueId</code> Eigenschaft aus Lodash führt also zum Import der gesamten Bibliothek in das Projekt (70 KB).  Wenn Sie die Funktion <code>uniqueId</code> direkt importieren, werden der <code>uniqueId</code> nur 2 <code>uniqueId</code> hinzugefügt.  Lesen Sie hier mehr über Importkosten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d1/488/bbb/8d1488bbb04afc1739a0a94967f74c2b.gif"></div><br>  <i><font color="#999999">Die "Kosten" für den Import der gesamten Lodash-Bibliothek in das Projekt und nur eine bestimmte Funktion aus dieser Bibliothek</font></i> <br><br><h2>  <font color="#3AC1EF">Der Fall von unangemessen großen Bündeln</font> </h2><br>  Sie haben also Ihre wunderbare Anwendung erstellt.  Es funktioniert hervorragend in Ihrem Highspeed-Internet und auf Ihrem leistungsstärksten Computer mit RAM.  Du hast es in die reale Welt entlassen.  Nach einiger Zeit kamen Beschwerden von Ihnen oder Ihren eigenen Analysten.  Diese Beschwerden betrafen die Ladezeiten der Anwendung.  Ähnliches passierte mir kürzlich, als wir bei Wix eine neue Funktion vorstellten, an der ich arbeitete. <br><br>  Lassen Sie uns über diese neue Gelegenheit sprechen, um Sie ein wenig auf den neuesten Stand zu bringen.  Dies ist eine neue Fortschrittsanzeige, die sich oben im Seitenbereich der Benutzeroberfläche für die Einstellungen der Benutzersite befindet.  Der Zweck dieses Mechanismus besteht darin, den Benutzer auf die verschiedenen Schritte aufmerksam zu machen, die er ausführen muss, damit sein Geschäftsprojekt bessere Erfolgschancen hat (Verbindung zur Suchmaschinenoptimierung, Hinzufügen von Regionen, in die Waren geliefert werden, Hinzufügen des ersten Produkts) , usw). <br><br>  Der Fortschrittsbalken wird automatisch aktualisiert, indem über Web-Sockets eine Verbindung zum Server hergestellt wird.  Wenn der Benutzer alle empfohlenen Schritte ausgeführt hat, wird ein Popup-Fenster mit Glückwünschen angezeigt.  Nachdem dieses Fenster geschlossen wurde, wird der Fortschrittsbalken ausgeblendet und nie wieder angezeigt, wenn Sie mit der Site arbeiten, auf der Sie ihn verwendet haben.  Darüber haben wir gerade gesprochen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2eb/b42/282/2ebb4228298df39e9b83358aaa7ebaac.gif"></div><br>  <i><font color="#999999">Fortschrittsbalken und Glückwunschfenster</font></i> <br><br>  Was ist passiert?  Warum haben sich unsere Analysten bei mir beschwert, dass sich die Ladezeit der Seite erhöht hat?  Als ich den Stand der Dinge auf der Registerkarte "Netzwerk" der Chrome-Entwicklertools untersuchte, wurde mir sofort klar, dass mein Bundle ziemlich groß war.  Seine Größe betrug nämlich 190 Kb. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f13/0ce/631/f130ce631ea4399322aa95583c7b2fa5.png"></div><br>  <i><font color="#999999">Mit den Chrome Developer Tools gefundene Bundle-Größe</font></i> <br><br>  "Warum braucht dieses kleine Ding ein relativ großes Bündel?", Dachte ich dann.  Aber die Wahrheit - warum? <br><br><h3>  <font color="#3AC1EF">▍Suchen Sie nach Problemstellen im Bundle</font> </h3><br>  Nachdem ich festgestellt habe, dass das Bundle zu groß ist, ist es Zeit, den Grund dafür herauszufinden.  Hier hat sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Webpack Bundle Analyzer</a> als nützlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erwiesen</a> - ein großartiges Tool zum Identifizieren von Problembereichen von Bundles.  Es öffnet sich eine neue Browser-Registerkarte und zeigt Abhängigkeitsinformationen an. <br><br>  Dies geschah, nachdem ich das Bundle mit diesem Tool analysiert hatte. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f17/465/f5f/f17465f5f21c29bbbb57f37373b0c92e.png"></div><br>  <i><font color="#999999">Ergebnisse des Webpack Bundle Analyzer</font></i> <br><br>  Mit Hilfe des Analysators konnte ich den "Verbrecher" erkennen.  Hier wurde das Lottie-Web-Paket verwendet, das die Größe des Bundles um 61,45 KB erhöhte.  Lottie ist eine sehr schöne JavaScript-Bibliothek, mit der Sie mithilfe von Standardbrowser-Tools in Adobe After Effect erstellte Animationen ausgeben können.  In meinem Fall war es so, dass unser Designer eine schöne Animation brauchte, die ausgeführt wurde, als das Fenster mit Glückwünschen erschien.  Er erstellte diese Animation und gab sie mir in Form einer JSON-Datei, die ich in das Lottie-Paket übertrug und eine wunderschöne Animation erhielt.  Zusätzlich zum Lottie-Web-Paket hatte ich auch eine JSON-Datei mit Animationsbeschreibungen.  Die Größe dieser Datei betrug 26 KB.  Infolgedessen „kosten“ mich die Lottie-Bibliothek, die JSON-Datei und einige zusätzliche kleine Abhängigkeiten ungefähr 94 KB.  Und dies ist nur eine Animation des Fensters mit Glückwünschen an den Benutzer.  Der Benutzer, als er diese Glückwünsche sah, hätte glücklich sein sollen.  Das alles machte mich traurig. <br><br><h2>  <font color="#3AC1EF">React Lazy / Suspense-Technologie hilft</font> </h2><br>  Nachdem ich die Ursache des Problems entdeckt habe, ist es Zeit, dieses Problem zu lösen.  Es war klar, dass es nicht notwendig war, zu Beginn der Arbeit alles zu laden, was für die Animation erforderlich war.  Tatsächlich bestand eine beträchtliche Chance, dass der Benutzer während der aktuellen Sitzung kein Fenster mit Glückwünschen zeigen musste.  Dann lernte ich die kürzlich erschienenen React Lazy / Suspense-Technologien kennen und dachte, dass ich jetzt wahrscheinlich eine gute Gelegenheit hatte, sie zu testen. <br><br>  Wenn Sie mit dem Konzept der "faulen" (faulen) Komponenten nicht vertraut sind, wissen Sie, dass ihre Bedeutung darin besteht, die Anwendung in kleine Codeteile zu unterteilen.  Das Herunterladen dieser Fragmente wird nur durchgeführt, wenn sie benötigt werden.  In meinem Fall drückte sich dies darin aus, dass ich aus der Hauptfunktion des Fortschrittsbalkens die Komponente auswählen musste, die für die Anzeige der Glückwünsche verantwortlich war.  Diese Komponente musste erst geladen werden, wenn der Benutzer die empfohlene Abfolge von Schritten ausgeführt hatte. <br><br>  React 16.6.0 (und neuere Versionen) verfügt über eine einfache API, mit der faule Komponenten gerendert werden können.  Dies sind <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">React.lazy und React.Suspense</a> .  Betrachten Sie ein Beispiel: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> OtherComponent = React.lazy(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'./OtherComponent'</span></span>)); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (    <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">      </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">React.Suspense</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fallback</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Loading...</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">}&gt;        </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">OtherComponent</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">      </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">React.Suspense</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">    </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">  ); }</span></span></code> </pre> <br>  Wir haben eine Komponente, die das <code>&lt;div&gt;</code> -Element anzeigt, und darin befindet sich eine <code>Suspense</code> Komponente, die die <code>OtherComponent</code> Komponente <code>OtherComponent</code> .  Wenn Sie sich die erste Zeile dieses Beispiels ansehen, sehen Sie, dass <code>OtherComponent</code> nicht direkt in den Code importiert wird.  In der Regel sieht ein <code>import OtherComponent from './OtherComponent';</code> Import wie der <code>import OtherComponent from './OtherComponent';</code>  . <br><br>  Stattdessen wird der Importbefehl als eine Funktion umrahmt, die einen Dateipfad verwendet.  Dieser Mechanismus funktioniert, da Webpack über integrierte Tools zur Codetrennung verfügt.  Wenn der Code eine ähnliche Konstruktion enthält, wird ein Versprechen zurückgegeben, das nach dem Herunterladen der Datei mit dem Inhalt dieser Datei aufgelöst wird.  Unser <code>React.lazy</code> ist in eine <code>React.lazy</code> Funktion <code>React.lazy</code> . <br><br>  In den von <code>MyComponent</code> Rendering-Materialien wird <code>MyComponent</code> in eine <code>React.Suspense</code> Komponente mit einer <code>fallback</code> Eigenschaft eingeschlossen.  In unserem Fall stellt sich heraus, dass beim Laden des Renderns <code>OtherComponent</code> Laden der entsprechenden Komponente beginnt.  In der Zwischenzeit wird gerendert, was in die <code>fallback</code> Eigenschaft geschrieben wird.  In diesem Beispiel ist dies der Text <code>Loading…</code>  Das ist in der Tat alles.  Diese Mechanismen machen einfach ihren Job. <br><br>  Es stimmt, es gibt einige Funktionen, die Sie bei der Arbeit mit Lazy / Suspense berücksichtigen müssen. <br><br><ol><li>  Eine Komponente, die "faul" importiert wird, muss den Standardexport enthalten, der der Einstiegspunkt der Komponente ist.  Benannte Exporte können hier nicht verwendet werden. </li><li>  Sie müssen die mit der Funktion <code>React.Suspense</code> importierte Komponente in die Komponente <code>React.Suspense</code> .  Die <code>React.Suspense</code> Komponente <code>React.Suspense</code> die <code>fallback</code> Eigenschaft bereitstellen.  Andernfalls tritt ein Fehler auf.  Wenn Sie jedoch erst dann etwas rendern möchten, wenn die Komponente verzögert geladen wurde, können Sie im <code>fallback</code> einfach <code>null</code> schreiben, ohne zu versuchen, die Notwendigkeit zu umgehen, etwas in diese Eigenschaft auf knifflige Weise zu schreiben. </li></ol><br><h2>  <font color="#3AC1EF">Hat mir die Verwendung von React Lazy / Suspense geholfen?</font> </h2><br>  Ja, es hat geholfen!  Die Code-Aufteilung hat einfach unglaublich funktioniert.  Werfen wir einen Blick auf die Ergebnisse der Analyse des neuen Bundles mit Webpack. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21e/502/fff/21e502fffa9544e33a750a8d23c33ede.png"></div><br>  <i><font color="#999999">Ergebnisse des Webpack Bundle Analyzer nach der Codeaufteilung</font></i> <br><br>  Wie Sie sehen können, hat sich die Größe meines Bundles um etwa 50% auf 96 KB verringert.  Großartig! <br><br>  Also was, jetzt ist das Problem gelöst?  Nein, leider.  Als ich mir die Seite ansah, stellte sich heraus, dass das Popup mit Glückwünschen die Position verloren hatte. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3b9/4a0/25d/3b94a025d8577c55a2d973928acf7c5f.png"></div><br>  <i><font color="#999999">Das Glückwunschfenster wird nicht dort angezeigt, wo Sie es benötigen</font></i> <br><br>  Das Problem war, dass ich das Fenster "geöffnet" habe, indem ich den Status der React-Komponente geändert habe.  In der Zwischenzeit habe ich mit der <code>React.Suspense</code> Komponente bereits <code>null</code> gerendert ( <code>React.Suspense</code> ich habe nichts gerendert).  Nach dem verzögerten Laden der erforderlichen Daten wurden die relevanten Materialien zum DOM hinzugefügt.  Die Positionierung des Popups wurde jedoch bereits vorgenommen.  Aufgrund der Tatsache, dass sich die Eigenschaften der entsprechenden Komponente nicht geändert haben, „wusste“ diese Komponente daher nicht, dass sie das Problem bezüglich der Positionierung lösen musste.  Wenn ich die Größe des Browserfensters geändert habe, wurde das Popup-Fenster an der richtigen Stelle angezeigt, da die entsprechende Komponente Änderungen der Eigenschaften und Ereignisse beim Ändern der Fenstergröße beobachtete und gegebenenfalls eine Neupositionierung einleitete. <br><br>  Wie kann man dieses Problem lösen?  Die Lösung bestand darin, den "Vermittler" zu eliminieren. <br><br>  Ich musste zuerst die "faule" Komponente laden und erst dann in den Zustand schreiben, der dem Fenster mit Glückwünschen mitteilen würde, dass es geöffnet werden muss.  Ich konnte dies mit denselben Webpack-Code-Sharing-Mechanismen tun, aber jetzt - ohne Importe mit <code>React.lazy</code> zu implementieren: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> loadAndSetHappyMoment() {  <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> component = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(    <span class="hljs-string"><span class="hljs-string">'../SidebarHappyMoment/SidebarHappyMoment.component'</span></span>  );  <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SidebarHappyMoment = component.SidebarHappyMoment;  <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({    <span class="hljs-attr"><span class="hljs-attr">tooltipLevel</span></span>: TooltipLevel.happyMoment,  }); }</code> </pre> <br>  Diese Funktion wird aufgerufen, nachdem meine Komponente über den Mechanismus der Web-Sockets darüber informiert wurde, dass ein Fenster mit Glückwünschen angezeigt werden muss.  Ich habe die Webpack- <code>import</code> (zweite Codezeile) verwendet.  Wenn Sie sich erinnern, habe ich oben gesagt, dass diese Funktion ein Versprechen zurückgibt, sodass ich das Konstrukt <code>async/await</code> verwenden konnte. <br><br>  Nachdem die Komponente <code>this.SidebarHappyMoment = component.SidebarHappyMoment;</code> , schreibe ich sie in die Instanz meiner Komponente (mit dem Befehl <code>this.SidebarHappyMoment = component.SidebarHappyMoment;</code> ).  Dies gibt mir die Möglichkeit, es später beim Rendern zu verwenden.  Bitte beachten Sie, dass ich jetzt benannte Exporte verwenden kann.  In meinem Fall habe ich in der obigen Zeile den Namen <code>SidebarHappyMoment</code> .  Und schließlich, und das ist nicht weniger wichtig als alles andere, „informiere“ ich das Fenster, dass es geöffnet werden muss, und ändere seinen Status entsprechend, nachdem ich weiß, dass die Komponente betriebsbereit ist. <br><br>  Infolgedessen sieht der Rendering-Code jetzt folgendermaßen aus: <br><br><pre> <code class="javascript hljs">renderTooltip() {  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.tooltipLevel === TooltipLevel.happyMoment) {    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">this.SidebarHappyMoment</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">;  }  // ... }</span></span></code> </pre> <br>  Beachten Sie, dass der Befehl <code>return &lt;this.SidebarHappyMoment /&gt;;</code>  gibt <code>this.SidebarHappyMoment</code> - was ich zuvor in die Instanz meiner Komponente geschrieben habe.  Dies ist eine normale synchrone Renderfunktion, genau wie die, die Sie millionenfach verwendet haben.  Und jetzt wird das Fenster mit Glückwünschen genau dort angezeigt, wo es angezeigt werden soll.  Und die Sache ist, dass es erst geöffnet wird, nachdem sein Inhalt einsatzbereit ist. <br><br><h2>  <font color="#3AC1EF">Produkt definiert Architektur</font> </h2><br>  Wenn die Idee in der Überschrift dieses Abschnitts in Ihrer Vorstellung ein heftiges Fragezeichen ausgelöst hat, sollten Sie sich bewusst sein, dass dies der Fall ist.  Das Produkt definiert die Architektur. <br><br>  Es geht um die Tatsache, dass das Produkt definiert, was sichtbar und interaktiv sein soll, wenn die Komponente zum ersten Mal gerendert wird.  Auf diese Weise kann der Entwickler herausfinden, was genau er vom Hauptcode trennen und bei Bedarf später laden kann.  Ich habe über die Situation nachgedacht und mich daran erinnert, dass der Benutzer, nachdem er die empfohlenen Schritte zum Einrichten der Site ausgeführt hat oder nicht der Site-Administrator ist, ihm nicht den Fortschrittsbalken und die damit verbundenen Funktionen anzeigen muss verbunden.  Mit diesen Informationen konnte ich das Bundle nun weiter teilen.  Das habe ich bekommen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/36f/5f2/eb9/36f5f2eb91ead3a7188f5d5162d75b3e.png"></div><br>  <i><font color="#999999">Die fortgesetzte Trennung des Bündels</font></i> <br><br>  Danach betrug die Größe des Bündels nur noch 38 KB.  Und ich erinnere Sie daran, dass wir mit 190 Kb angefangen haben.  Die Größe des Bündels wird um 80% reduziert.  Übrigens sehe ich bereits andere Möglichkeiten zur Codetrennung.  Ich kann es kaum erwarten, das Bundle weiter zu optimieren. <br><br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br>  Entwickler haben die Möglichkeit, sich zu bemühen, in ihrer „Komfortzone“ zu bleiben und sich nur mit dem Gerät des Codes selbst und seiner Funktionalität zu befassen.  Ein Programmierer, der die oben beschriebenen Tools verwendet, kreativ denkt und eng mit anderen Spezialisten zusammenarbeitet, kann möglicherweise die Leistung seiner Anwendung verbessern, indem er die Größe des Bundles, das die für die Arbeit mit dieser Anwendung erforderlichen Informationen enthält, erheblich reduziert. <br><br>  <b>Liebe Leser!</b>  Verwenden Sie die Code-Aufteilung, um das Laden Ihrer Webanwendungen zu beschleunigen? <br><br><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/it/t5/3p/itt53pns2iucwylb3bwn1fmmtnu.png"></a> </div><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de468225/">https://habr.com/ru/post/de468225/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de468211/index.html">"Ich wollte nur einen Witz machen, aber niemand verstand" oder wie ich mich bei der Präsentation des Projekts nicht begraben sollte</a></li>
<li><a href="../de468213/index.html">tinc-boot - Full-Mesh-Netzwerk ohne Schmerzen</a></li>
<li><a href="../de468217/index.html">Dr. Jekyll und Mr. Hyde Unternehmenskultur</a></li>
<li><a href="../de468219/index.html">Erweiterbare Erweiterungsmechanismen in JavaScript</a></li>
<li><a href="../de468223/index.html">Habr Weekly # 19 / BT-Tür für die Katze, warum die KI betrügt, was der zukünftige Arbeitgeber fragen soll, ein Tag mit iPhone 11 Pro</a></li>
<li><a href="../de468229/index.html">Ein Hinweis zur Leere in JavaScript und TypeScript</a></li>
<li><a href="../de468231/index.html">Ist die Sicherheit in AEM ein Plattform- oder Implementierungsproblem?</a></li>
<li><a href="../de468233/index.html">Die Möglichkeit, 4 Millionen Zeilen Python-Code zu überprüfen. Teil 1</a></li>
<li><a href="../de468235/index.html">Die Möglichkeit, 4 Millionen Zeilen Python-Code zu überprüfen. Teil 2</a></li>
<li><a href="../de468237/index.html">Die Möglichkeit, 4 Millionen Zeilen Python-Code zu überprüfen. Teil 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>