<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÇüèº üëÜüèº üë®üèª‚Äçüöí Reduzieren der Bundle-Gr√∂√üe mit Webpack Analyzer und React Lazy / Suspense üëÑ ‚ôìÔ∏è üëÇüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mit zunehmender Komplexit√§t von Clientanwendungen wird die Gr√∂√üe ihrer Bundles immer gr√∂√üer. In dieser Situation leiden die Menschen am meisten und si...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Reduzieren der Bundle-Gr√∂√üe mit Webpack Analyzer und React Lazy / Suspense</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/468225/">  Mit zunehmender Komplexit√§t von Clientanwendungen wird die Gr√∂√üe ihrer Bundles immer gr√∂√üer.  In dieser Situation leiden die Menschen am meisten und sind aus verschiedenen Gr√ºnden gezwungen, langsame Internetverbindungen zu nutzen.  Au√üerdem wird es jeden Tag schlimmer. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/yp/wc/u-/ypwcu-trdbiswrdeltqb677yqxk.jpeg"></a> <br><br>  Der Autor des Artikels, dessen √úbersetzung wir heute ver√∂ffentlichen, arbeitet in Wix.  Er m√∂chte dar√ºber sprechen, wie er mit Webpack Analyzer und React Lazy / Suspense die Gr√∂√üe eines Bundles um etwa 80% reduzieren konnte. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Wie fr√ºh soll die Optimierung beginnen?</font> </h2><br>  Wenn Sie gerade mit der Arbeit an Ihrer neuen Webanwendung begonnen haben, versuchen Sie wahrscheinlich, sich darauf zu konzentrieren, sie sozusagen ‚Äûauf den Weg zu bringen‚Äú und sie zum Laufen zu bringen.  Sie achten wahrscheinlich nicht besonders auf die Leistung oder die Bundle-Gr√∂√üe.  Ich kann das verstehen  Meine Erfahrung zeigt jedoch, dass die Leistung und die Gr√∂√üe der Bundles von Anfang an ber√ºcksichtigt werden sollten.  Eine gute Anwendungsarchitektur und eine zeitnahe ‚ÄûReflexion √ºber die Zukunft des Projekts‚Äú sparen Ihnen auf lange Sicht viel Zeit und tragen dazu bei, keine ernsthaften technischen Schulden zu akkumulieren.  Nat√ºrlich ist es schwierig, alles im Voraus vorauszusehen, aber Sie sollten sich vom ersten Arbeitstag an sehr bem√ºhen, alles richtig zu machen. <br><br>  Hier sind einige gro√üartige Tools, die meiner Meinung nach von Anfang an verwendet werden sollten.  Mit diesen Tools k√∂nnen Sie ‚Äûproblematische‚Äú NPM-Pakete erkennen, noch bevor sie einen wichtigen Platz in der Anwendung einnehmen. <br><br><h3>  <font color="#3AC1EF">UndBundlephobie</font> </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bundlephobia</a> ist eine Website, auf der Sie wissen, um wie viel ein bestimmtes NPM-Paket die Gr√∂√üe eines Bundles erh√∂ht.  Dies ist ein gro√üartiges Tool, mit dem der Programmierer die richtigen Entscheidungen hinsichtlich der Auswahl der Pakete von Drittanbietern treffen kann, die er m√∂glicherweise ben√∂tigt.  Bundlephobia hilft dabei, die Anwendungsarchitektur so zu gestalten, dass ihre Gr√∂√üe nicht zu gro√ü wird.  Die folgende Abbildung zeigt die Ergebnisse der √úberpr√ºfung einer beliebten Bibliothek auf Zeitarbeit, die als Moment bezeichnet wird.  Sie k√∂nnen sehen, dass diese Bibliothek ziemlich gro√ü ist - fast 66 KB in komprimierter Form.  F√ºr viele Benutzer, die im Hochgeschwindigkeitsinternet arbeiten, ist dies nichts.  Es lohnt sich jedoch, auf die Downloadzeit dieses Pakets in 2G / 3G-Netzwerken zu achten.  Sie betr√§gt 2,2 bzw. 1,32 Sekunden.  Und seien Sie vorsichtig, wir sprechen nur √ºber dieses eine Paket. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c1/298/eed/1c1298eed8992918c5314e651ea04032.png"></div><br>  <i><font color="#999999">Ergebnisse der Bundlephobia-Moment-Paketanalyse</font></i> <br><br><h3>  <font color="#3AC1EF">‚ñçKosten importieren</font> </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Import Cost</a> ist eine sehr interessante Erweiterung f√ºr viele beliebte Code-Editoren (es gibt √ºber eine Million Downloads f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VS Code</a> ).  Es kann die "Kosten" importierter Pakete anzeigen.  Ich mag es besonders, weil es hilft, Problembereiche der Anwendung direkt w√§hrend der Arbeit zu identifizieren.  Die folgende Abbildung (entnommen aus der Seite GitHub importieren) zeigt ein hervorragendes Beispiel f√ºr die Auswirkungen eines anderen Ansatzes zum Importieren von Entit√§ten auf die Projektdimensionen.  Der Import der einzigen <code>uniqueId</code> Eigenschaft aus Lodash f√ºhrt also zum Import der gesamten Bibliothek in das Projekt (70 KB).  Wenn Sie die Funktion <code>uniqueId</code> direkt importieren, werden der <code>uniqueId</code> nur 2 <code>uniqueId</code> hinzugef√ºgt.  Lesen Sie hier mehr √ºber Importkosten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d1/488/bbb/8d1488bbb04afc1739a0a94967f74c2b.gif"></div><br>  <i><font color="#999999">Die "Kosten" f√ºr den Import der gesamten Lodash-Bibliothek in das Projekt und nur eine bestimmte Funktion aus dieser Bibliothek</font></i> <br><br><h2>  <font color="#3AC1EF">Der Fall von unangemessen gro√üen B√ºndeln</font> </h2><br>  Sie haben also Ihre wunderbare Anwendung erstellt.  Es funktioniert hervorragend in Ihrem Highspeed-Internet und auf Ihrem leistungsst√§rksten Computer mit RAM.  Du hast es in die reale Welt entlassen.  Nach einiger Zeit kamen Beschwerden von Ihnen oder Ihren eigenen Analysten.  Diese Beschwerden betrafen die Ladezeiten der Anwendung.  √Ñhnliches passierte mir k√ºrzlich, als wir bei Wix eine neue Funktion vorstellten, an der ich arbeitete. <br><br>  Lassen Sie uns √ºber diese neue Gelegenheit sprechen, um Sie ein wenig auf den neuesten Stand zu bringen.  Dies ist eine neue Fortschrittsanzeige, die sich oben im Seitenbereich der Benutzeroberfl√§che f√ºr die Einstellungen der Benutzersite befindet.  Der Zweck dieses Mechanismus besteht darin, den Benutzer auf die verschiedenen Schritte aufmerksam zu machen, die er ausf√ºhren muss, damit sein Gesch√§ftsprojekt bessere Erfolgschancen hat (Verbindung zur Suchmaschinenoptimierung, Hinzuf√ºgen von Regionen, in die Waren geliefert werden, Hinzuf√ºgen des ersten Produkts) , usw). <br><br>  Der Fortschrittsbalken wird automatisch aktualisiert, indem √ºber Web-Sockets eine Verbindung zum Server hergestellt wird.  Wenn der Benutzer alle empfohlenen Schritte ausgef√ºhrt hat, wird ein Popup-Fenster mit Gl√ºckw√ºnschen angezeigt.  Nachdem dieses Fenster geschlossen wurde, wird der Fortschrittsbalken ausgeblendet und nie wieder angezeigt, wenn Sie mit der Site arbeiten, auf der Sie ihn verwendet haben.  Dar√ºber haben wir gerade gesprochen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2eb/b42/282/2ebb4228298df39e9b83358aaa7ebaac.gif"></div><br>  <i><font color="#999999">Fortschrittsbalken und Gl√ºckwunschfenster</font></i> <br><br>  Was ist passiert?  Warum haben sich unsere Analysten bei mir beschwert, dass sich die Ladezeit der Seite erh√∂ht hat?  Als ich den Stand der Dinge auf der Registerkarte "Netzwerk" der Chrome-Entwicklertools untersuchte, wurde mir sofort klar, dass mein Bundle ziemlich gro√ü war.  Seine Gr√∂√üe betrug n√§mlich 190 Kb. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f13/0ce/631/f130ce631ea4399322aa95583c7b2fa5.png"></div><br>  <i><font color="#999999">Mit den Chrome Developer Tools gefundene Bundle-Gr√∂√üe</font></i> <br><br>  "Warum braucht dieses kleine Ding ein relativ gro√ües B√ºndel?", Dachte ich dann.  Aber die Wahrheit - warum? <br><br><h3>  <font color="#3AC1EF">‚ñçSuchen Sie nach Problemstellen im Bundle</font> </h3><br>  Nachdem ich festgestellt habe, dass das Bundle zu gro√ü ist, ist es Zeit, den Grund daf√ºr herauszufinden.  Hier hat sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Webpack Bundle Analyzer</a> als n√ºtzlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erwiesen</a> - ein gro√üartiges Tool zum Identifizieren von Problembereichen von Bundles.  Es √∂ffnet sich eine neue Browser-Registerkarte und zeigt Abh√§ngigkeitsinformationen an. <br><br>  Dies geschah, nachdem ich das Bundle mit diesem Tool analysiert hatte. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f17/465/f5f/f17465f5f21c29bbbb57f37373b0c92e.png"></div><br>  <i><font color="#999999">Ergebnisse des Webpack Bundle Analyzer</font></i> <br><br>  Mit Hilfe des Analysators konnte ich den "Verbrecher" erkennen.  Hier wurde das Lottie-Web-Paket verwendet, das die Gr√∂√üe des Bundles um 61,45 KB erh√∂hte.  Lottie ist eine sehr sch√∂ne JavaScript-Bibliothek, mit der Sie mithilfe von Standardbrowser-Tools in Adobe After Effect erstellte Animationen ausgeben k√∂nnen.  In meinem Fall war es so, dass unser Designer eine sch√∂ne Animation brauchte, die ausgef√ºhrt wurde, als das Fenster mit Gl√ºckw√ºnschen erschien.  Er erstellte diese Animation und gab sie mir in Form einer JSON-Datei, die ich in das Lottie-Paket √ºbertrug und eine wundersch√∂ne Animation erhielt.  Zus√§tzlich zum Lottie-Web-Paket hatte ich auch eine JSON-Datei mit Animationsbeschreibungen.  Die Gr√∂√üe dieser Datei betrug 26 KB.  Infolgedessen ‚Äûkosten‚Äú mich die Lottie-Bibliothek, die JSON-Datei und einige zus√§tzliche kleine Abh√§ngigkeiten ungef√§hr 94 KB.  Und dies ist nur eine Animation des Fensters mit Gl√ºckw√ºnschen an den Benutzer.  Der Benutzer, als er diese Gl√ºckw√ºnsche sah, h√§tte gl√ºcklich sein sollen.  Das alles machte mich traurig. <br><br><h2>  <font color="#3AC1EF">React Lazy / Suspense-Technologie hilft</font> </h2><br>  Nachdem ich die Ursache des Problems entdeckt habe, ist es Zeit, dieses Problem zu l√∂sen.  Es war klar, dass es nicht notwendig war, zu Beginn der Arbeit alles zu laden, was f√ºr die Animation erforderlich war.  Tats√§chlich bestand eine betr√§chtliche Chance, dass der Benutzer w√§hrend der aktuellen Sitzung kein Fenster mit Gl√ºckw√ºnschen zeigen musste.  Dann lernte ich die k√ºrzlich erschienenen React Lazy / Suspense-Technologien kennen und dachte, dass ich jetzt wahrscheinlich eine gute Gelegenheit hatte, sie zu testen. <br><br>  Wenn Sie mit dem Konzept der "faulen" (faulen) Komponenten nicht vertraut sind, wissen Sie, dass ihre Bedeutung darin besteht, die Anwendung in kleine Codeteile zu unterteilen.  Das Herunterladen dieser Fragmente wird nur durchgef√ºhrt, wenn sie ben√∂tigt werden.  In meinem Fall dr√ºckte sich dies darin aus, dass ich aus der Hauptfunktion des Fortschrittsbalkens die Komponente ausw√§hlen musste, die f√ºr die Anzeige der Gl√ºckw√ºnsche verantwortlich war.  Diese Komponente musste erst geladen werden, wenn der Benutzer die empfohlene Abfolge von Schritten ausgef√ºhrt hatte. <br><br>  React 16.6.0 (und neuere Versionen) verf√ºgt √ºber eine einfache API, mit der faule Komponenten gerendert werden k√∂nnen.  Dies sind <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">React.lazy und React.Suspense</a> .  Betrachten Sie ein Beispiel: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> OtherComponent = React.lazy(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'./OtherComponent'</span></span>)); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (    <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">      </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">React.Suspense</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fallback</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Loading...</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">}&gt;        </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">OtherComponent</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">      </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">React.Suspense</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">    </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">  ); }</span></span></code> </pre> <br>  Wir haben eine Komponente, die das <code>&lt;div&gt;</code> -Element anzeigt, und darin befindet sich eine <code>Suspense</code> Komponente, die die <code>OtherComponent</code> Komponente <code>OtherComponent</code> .  Wenn Sie sich die erste Zeile dieses Beispiels ansehen, sehen Sie, dass <code>OtherComponent</code> nicht direkt in den Code importiert wird.  In der Regel sieht ein <code>import OtherComponent from './OtherComponent';</code> Import wie der <code>import OtherComponent from './OtherComponent';</code>  . <br><br>  Stattdessen wird der Importbefehl als eine Funktion umrahmt, die einen Dateipfad verwendet.  Dieser Mechanismus funktioniert, da Webpack √ºber integrierte Tools zur Codetrennung verf√ºgt.  Wenn der Code eine √§hnliche Konstruktion enth√§lt, wird ein Versprechen zur√ºckgegeben, das nach dem Herunterladen der Datei mit dem Inhalt dieser Datei aufgel√∂st wird.  Unser <code>React.lazy</code> ist in eine <code>React.lazy</code> Funktion <code>React.lazy</code> . <br><br>  In den von <code>MyComponent</code> Rendering-Materialien wird <code>MyComponent</code> in eine <code>React.Suspense</code> Komponente mit einer <code>fallback</code> Eigenschaft eingeschlossen.  In unserem Fall stellt sich heraus, dass beim Laden des Renderns <code>OtherComponent</code> Laden der entsprechenden Komponente beginnt.  In der Zwischenzeit wird gerendert, was in die <code>fallback</code> Eigenschaft geschrieben wird.  In diesem Beispiel ist dies der Text <code>Loading‚Ä¶</code>  Das ist in der Tat alles.  Diese Mechanismen machen einfach ihren Job. <br><br>  Es stimmt, es gibt einige Funktionen, die Sie bei der Arbeit mit Lazy / Suspense ber√ºcksichtigen m√ºssen. <br><br><ol><li>  Eine Komponente, die "faul" importiert wird, muss den Standardexport enthalten, der der Einstiegspunkt der Komponente ist.  Benannte Exporte k√∂nnen hier nicht verwendet werden. </li><li>  Sie m√ºssen die mit der Funktion <code>React.Suspense</code> importierte Komponente in die Komponente <code>React.Suspense</code> .  Die <code>React.Suspense</code> Komponente <code>React.Suspense</code> die <code>fallback</code> Eigenschaft bereitstellen.  Andernfalls tritt ein Fehler auf.  Wenn Sie jedoch erst dann etwas rendern m√∂chten, wenn die Komponente verz√∂gert geladen wurde, k√∂nnen Sie im <code>fallback</code> einfach <code>null</code> schreiben, ohne zu versuchen, die Notwendigkeit zu umgehen, etwas in diese Eigenschaft auf knifflige Weise zu schreiben. </li></ol><br><h2>  <font color="#3AC1EF">Hat mir die Verwendung von React Lazy / Suspense geholfen?</font> </h2><br>  Ja, es hat geholfen!  Die Code-Aufteilung hat einfach unglaublich funktioniert.  Werfen wir einen Blick auf die Ergebnisse der Analyse des neuen Bundles mit Webpack. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21e/502/fff/21e502fffa9544e33a750a8d23c33ede.png"></div><br>  <i><font color="#999999">Ergebnisse des Webpack Bundle Analyzer nach der Codeaufteilung</font></i> <br><br>  Wie Sie sehen k√∂nnen, hat sich die Gr√∂√üe meines Bundles um etwa 50% auf 96 KB verringert.  Gro√üartig! <br><br>  Also was, jetzt ist das Problem gel√∂st?  Nein, leider.  Als ich mir die Seite ansah, stellte sich heraus, dass das Popup mit Gl√ºckw√ºnschen die Position verloren hatte. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3b9/4a0/25d/3b94a025d8577c55a2d973928acf7c5f.png"></div><br>  <i><font color="#999999">Das Gl√ºckwunschfenster wird nicht dort angezeigt, wo Sie es ben√∂tigen</font></i> <br><br>  Das Problem war, dass ich das Fenster "ge√∂ffnet" habe, indem ich den Status der React-Komponente ge√§ndert habe.  In der Zwischenzeit habe ich mit der <code>React.Suspense</code> Komponente bereits <code>null</code> gerendert ( <code>React.Suspense</code> ich habe nichts gerendert).  Nach dem verz√∂gerten Laden der erforderlichen Daten wurden die relevanten Materialien zum DOM hinzugef√ºgt.  Die Positionierung des Popups wurde jedoch bereits vorgenommen.  Aufgrund der Tatsache, dass sich die Eigenschaften der entsprechenden Komponente nicht ge√§ndert haben, ‚Äûwusste‚Äú diese Komponente daher nicht, dass sie das Problem bez√ºglich der Positionierung l√∂sen musste.  Wenn ich die Gr√∂√üe des Browserfensters ge√§ndert habe, wurde das Popup-Fenster an der richtigen Stelle angezeigt, da die entsprechende Komponente √Ñnderungen der Eigenschaften und Ereignisse beim √Ñndern der Fenstergr√∂√üe beobachtete und gegebenenfalls eine Neupositionierung einleitete. <br><br>  Wie kann man dieses Problem l√∂sen?  Die L√∂sung bestand darin, den "Vermittler" zu eliminieren. <br><br>  Ich musste zuerst die "faule" Komponente laden und erst dann in den Zustand schreiben, der dem Fenster mit Gl√ºckw√ºnschen mitteilen w√ºrde, dass es ge√∂ffnet werden muss.  Ich konnte dies mit denselben Webpack-Code-Sharing-Mechanismen tun, aber jetzt - ohne Importe mit <code>React.lazy</code> zu implementieren: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> loadAndSetHappyMoment() {  <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> component = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(    <span class="hljs-string"><span class="hljs-string">'../SidebarHappyMoment/SidebarHappyMoment.component'</span></span>  );  <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SidebarHappyMoment = component.SidebarHappyMoment;  <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({    <span class="hljs-attr"><span class="hljs-attr">tooltipLevel</span></span>: TooltipLevel.happyMoment,  }); }</code> </pre> <br>  Diese Funktion wird aufgerufen, nachdem meine Komponente √ºber den Mechanismus der Web-Sockets dar√ºber informiert wurde, dass ein Fenster mit Gl√ºckw√ºnschen angezeigt werden muss.  Ich habe die Webpack- <code>import</code> (zweite Codezeile) verwendet.  Wenn Sie sich erinnern, habe ich oben gesagt, dass diese Funktion ein Versprechen zur√ºckgibt, sodass ich das Konstrukt <code>async/await</code> verwenden konnte. <br><br>  Nachdem die Komponente <code>this.SidebarHappyMoment = component.SidebarHappyMoment;</code> , schreibe ich sie in die Instanz meiner Komponente (mit dem Befehl <code>this.SidebarHappyMoment = component.SidebarHappyMoment;</code> ).  Dies gibt mir die M√∂glichkeit, es sp√§ter beim Rendern zu verwenden.  Bitte beachten Sie, dass ich jetzt benannte Exporte verwenden kann.  In meinem Fall habe ich in der obigen Zeile den Namen <code>SidebarHappyMoment</code> .  Und schlie√ülich, und das ist nicht weniger wichtig als alles andere, ‚Äûinformiere‚Äú ich das Fenster, dass es ge√∂ffnet werden muss, und √§ndere seinen Status entsprechend, nachdem ich wei√ü, dass die Komponente betriebsbereit ist. <br><br>  Infolgedessen sieht der Rendering-Code jetzt folgenderma√üen aus: <br><br><pre> <code class="javascript hljs">renderTooltip() {  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.tooltipLevel === TooltipLevel.happyMoment) {    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">this.SidebarHappyMoment</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">;  }  // ... }</span></span></code> </pre> <br>  Beachten Sie, dass der Befehl <code>return &lt;this.SidebarHappyMoment /&gt;;</code>  gibt <code>this.SidebarHappyMoment</code> - was ich zuvor in die Instanz meiner Komponente geschrieben habe.  Dies ist eine normale synchrone Renderfunktion, genau wie die, die Sie millionenfach verwendet haben.  Und jetzt wird das Fenster mit Gl√ºckw√ºnschen genau dort angezeigt, wo es angezeigt werden soll.  Und die Sache ist, dass es erst ge√∂ffnet wird, nachdem sein Inhalt einsatzbereit ist. <br><br><h2>  <font color="#3AC1EF">Produkt definiert Architektur</font> </h2><br>  Wenn die Idee in der √úberschrift dieses Abschnitts in Ihrer Vorstellung ein heftiges Fragezeichen ausgel√∂st hat, sollten Sie sich bewusst sein, dass dies der Fall ist.  Das Produkt definiert die Architektur. <br><br>  Es geht um die Tatsache, dass das Produkt definiert, was sichtbar und interaktiv sein soll, wenn die Komponente zum ersten Mal gerendert wird.  Auf diese Weise kann der Entwickler herausfinden, was genau er vom Hauptcode trennen und bei Bedarf sp√§ter laden kann.  Ich habe √ºber die Situation nachgedacht und mich daran erinnert, dass der Benutzer, nachdem er die empfohlenen Schritte zum Einrichten der Site ausgef√ºhrt hat oder nicht der Site-Administrator ist, ihm nicht den Fortschrittsbalken und die damit verbundenen Funktionen anzeigen muss verbunden.  Mit diesen Informationen konnte ich das Bundle nun weiter teilen.  Das habe ich bekommen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/36f/5f2/eb9/36f5f2eb91ead3a7188f5d5162d75b3e.png"></div><br>  <i><font color="#999999">Die fortgesetzte Trennung des B√ºndels</font></i> <br><br>  Danach betrug die Gr√∂√üe des B√ºndels nur noch 38 KB.  Und ich erinnere Sie daran, dass wir mit 190 Kb angefangen haben.  Die Gr√∂√üe des B√ºndels wird um 80% reduziert.  √úbrigens sehe ich bereits andere M√∂glichkeiten zur Codetrennung.  Ich kann es kaum erwarten, das Bundle weiter zu optimieren. <br><br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br>  Entwickler haben die M√∂glichkeit, sich zu bem√ºhen, in ihrer ‚ÄûKomfortzone‚Äú zu bleiben und sich nur mit dem Ger√§t des Codes selbst und seiner Funktionalit√§t zu befassen.  Ein Programmierer, der die oben beschriebenen Tools verwendet, kreativ denkt und eng mit anderen Spezialisten zusammenarbeitet, kann m√∂glicherweise die Leistung seiner Anwendung verbessern, indem er die Gr√∂√üe des Bundles, das die f√ºr die Arbeit mit dieser Anwendung erforderlichen Informationen enth√§lt, erheblich reduziert. <br><br>  <b>Liebe Leser!</b>  Verwenden Sie die Code-Aufteilung, um das Laden Ihrer Webanwendungen zu beschleunigen? <br><br><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/it/t5/3p/itt53pns2iucwylb3bwn1fmmtnu.png"></a> </div><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de468225/">https://habr.com/ru/post/de468225/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de468211/index.html">"Ich wollte nur einen Witz machen, aber niemand verstand" oder wie ich mich bei der Pr√§sentation des Projekts nicht begraben sollte</a></li>
<li><a href="../de468213/index.html">tinc-boot - Full-Mesh-Netzwerk ohne Schmerzen</a></li>
<li><a href="../de468217/index.html">Dr. Jekyll und Mr. Hyde Unternehmenskultur</a></li>
<li><a href="../de468219/index.html">Erweiterbare Erweiterungsmechanismen in JavaScript</a></li>
<li><a href="../de468223/index.html">Habr Weekly # 19 / BT-T√ºr f√ºr die Katze, warum die KI betr√ºgt, was der zuk√ºnftige Arbeitgeber fragen soll, ein Tag mit iPhone 11 Pro</a></li>
<li><a href="../de468229/index.html">Ein Hinweis zur Leere in JavaScript und TypeScript</a></li>
<li><a href="../de468231/index.html">Ist die Sicherheit in AEM ein Plattform- oder Implementierungsproblem?</a></li>
<li><a href="../de468233/index.html">Die M√∂glichkeit, 4 Millionen Zeilen Python-Code zu √ºberpr√ºfen. Teil 1</a></li>
<li><a href="../de468235/index.html">Die M√∂glichkeit, 4 Millionen Zeilen Python-Code zu √ºberpr√ºfen. Teil 2</a></li>
<li><a href="../de468237/index.html">Die M√∂glichkeit, 4 Millionen Zeilen Python-Code zu √ºberpr√ºfen. Teil 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>