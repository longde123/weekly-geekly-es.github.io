<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî¥ üõåüèΩ üë∂üèª 24 horas de juego Rust: experiencia de desarrollo personal üîÄ üâë üìó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo hablar√© sobre mi experiencia personal en el desarrollo de un peque√±o juego en Rust. Me llev√≥ unas 24 horas crear una versi√≥n funciona...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>24 horas de juego Rust: experiencia de desarrollo personal</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/444364/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/019/753/9bf/0197539bf7364b198561856cd6dfd961.png" alt="imagen"></div><br>  En este art√≠culo hablar√© sobre mi experiencia personal en el desarrollo de un peque√±o juego en Rust.  Me llev√≥ unas 24 horas crear una versi√≥n funcional (principalmente trabajaba por las tardes o los fines de semana).  El juego est√° lejos de terminar, pero creo que la experiencia ser√° √∫til.  Te dir√© lo que aprend√≠ y algunas de las observaciones hechas al construir el juego desde cero. <br><a name="habracut"></a><br><blockquote>  <b>Skillbox recomienda:</b> Curso pr√°ctico de dos a√±os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Soy un desarrollador web PRO"</a> . <br><br>  <b>Le recordamos:</b> <i>para todos los lectores de "Habr": un descuento de 10.000 rublos al registrarse en cualquier curso de Skillbox con el c√≥digo de promoci√≥n "Habr".</i> </blockquote><br><h3>  ¬øPor qu√© el √≥xido? </h3><br>  Eleg√≠ este lenguaje porque escuch√© muchas cosas buenas al respecto y veo que se est√° volviendo cada vez m√°s popular en el campo del desarrollo de juegos.  Antes de escribir el juego, ten√≠a poca experiencia desarrollando aplicaciones simples en Rust.  Esto fue suficiente para sentir una cierta libertad al escribir el juego. <br><br><h3>  ¬øPor qu√© exactamente el juego y qu√© tipo de juego? </h3><br>  ¬°Hacer juegos es divertido!  Me gustar√≠a por m√°s razones, pero para los proyectos de "hogar" elijo temas que no est√°n muy relacionados con mi trabajo habitual.  Que tipo de juego  Quer√≠a hacer algo as√≠ como un simulador de tenis que combina Cities Skylines, Zoo Tycoon, Prison Architect y el tenis en s√≠.  En general, result√≥ un juego sobre una academia de tenis, donde la gente viene a jugar. <br><br><h3>  Entrenamiento t√©cnico </h3><br>  Quer√≠a usar Rust, pero no sab√≠a exactamente c√≥mo "desde cero" necesitar√≠a comenzar.  No quer√≠a escribir sombreadores de p√≠xeles y usar arrastrar y soltar, as√≠ que estaba buscando las soluciones m√°s flexibles. <br><br>  Encontr√© recursos √∫tiles que comparto con ustedes: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">¬øYa estamos en el juego</a> ? Una lista de elementos de Rust necesarios para el desarrollo del juego; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Rust game dev subreddit;</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pixel art gratis.</a> </li></ul><br>  Explor√© varios motores de juegos de Rust, y finalmente eleg√≠ Piston y ggez.  Me los encontr√© cuando trabajaba en un proyecto anterior.  Al final, eleg√≠ ggez, porque parec√≠a m√°s adecuado para implementar un peque√±o juego en 2D.  La estructura modular de Piston es demasiado compleja para un desarrollador novato (o alguien que trabaja con Rust por primera vez). <br><br><h3>  Estructura del juego </h3><br>  Pas√© un poco de tiempo pensando en la arquitectura del proyecto.  El primer paso es hacer la "tierra", la gente y las canchas de tenis.  La gente debe moverse por las canchas y esperar.  Los jugadores deben tener habilidades que mejoren con el tiempo.  Adem√°s, debe haber un editor que le permita agregar nuevas personas y tribunales, pero esto ya no es gratuito. <br><br>  Pensando en todo, me puse a trabajar. <br><br><h3>  Creaci√≥n de juegos </h3><br>  <b>Inicio: c√≠rculos y abstracciones</b> <br><br>  Tom√© un ejemplo de ggez y obtuve un c√≠rculo en la pantalla.  Asombroso  Ahora algunas abstracciones.  Me pareci√≥ que es bueno ignorar la idea de un objeto de juego.  Cada objeto debe ser renderizado y actualizado como se indica aqu√≠: <br><br><pre><code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// the game object trait trait GameObject { fn update(&amp;mut self, _ctx: &amp;mut Context) -&gt; GameResult&lt;()&gt;; fn draw(&amp;mut self, ctx: &amp;mut Context) -&gt; GameResult&lt;()&gt;; } // a specific game object - Circle struct Circle { position: Point2, } impl Circle { fn new(position: Point2) -&gt; Circle { Circle { position } } } impl GameObject for Circle { fn update(&amp;mut self, _ctx: &amp;mut Context) -&gt; GameResult&lt;()&gt; { Ok(()) } fn draw(&amp;mut self, ctx: &amp;mut Context) -&gt; GameResult&lt;()&gt; { let circle = graphics::Mesh::new_circle(ctx, graphics::DrawMode::Fill, self.position, 100.0, 2.0)?; graphics::draw(ctx, &amp;circle, na::Point2::new(0.0, 0.0), 0.0)?; Ok(()) } }</span></span></code> </pre> <br>  Este c√≥digo me permiti√≥ obtener una excelente lista de objetos que puedo actualizar y renderizar en un bucle igualmente excelente. <br><br><pre> <code class="rust hljs">mpl event::EventHandler <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> MainState { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, context: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Context) -&gt; GameResult&lt;()&gt; { <span class="hljs-comment"><span class="hljs-comment">// Update all objects for object in self.objects.iter_mut() { object.update(context)?; } Ok(()) } fn draw(&amp;mut self, context: &amp;mut Context) -&gt; GameResult&lt;()&gt; { graphics::clear(context); // Draw all objects for object in self.objects.iter_mut() { object.draw(context)?; } graphics::present(context); Ok(()) } }</span></span></code> </pre> <br>  Se necesita main.rs porque contiene todas las l√≠neas de c√≥digo.  Pas√© un poco de tiempo para separar los archivos y optimizar la estructura del directorio.  As√≠ es como todo comenz√≥ a verse despu√©s de eso: <br><br>  <i>recursos -&gt; aqu√≠ es donde est√°n todos los activos (im√°genes)</i> <i><br></i>  <i>src</i> <i><br></i>  <i>- entidades</i> <i><br></i>  <i>- game_object.rs</i> <i><br></i>  <i>- circle.rs</i> <i><br></i>  <i>- main.rs -&gt; lazo principal</i> <br><br>  <b>Personas, pisos e im√°genes</b> <br><br>  El siguiente paso es crear un objeto de juego Persona y cargar im√°genes.  Todo debe basarse en fichas de 32 * 32 de tama√±o. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/642/4c6/65c/6424c665cb9442c5471a49d987954880.png"><br><br>  <b>Canchas de tenis</b> <br><br>  Despu√©s de estudiar c√≥mo se ven las canchas de tenis, decid√≠ hacerlas con fichas de 4 * 2.  Inicialmente, era posible hacer una imagen de este tama√±o o juntar 8 mosaicos separados.  Pero luego me di cuenta de que solo se necesitan dos mosaicos √∫nicos, y por eso. <br><br>  En total, tenemos dos fichas de este tipo: 1 y 2. <br><br>  Cada secci√≥n de la cancha consta de la loseta 1 o la loseta 2. Se pueden organizar como de costumbre o se pueden voltear 180 grados. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26d/de1/e6f/26dde1e6f7ec2459c89752754a048c04.png"><br><br>  <b>El modo principal de construcci√≥n (montaje)</b> <br><br>  Despu√©s de lograr la representaci√≥n de sitios, personas y mapas, me di cuenta de que tambi√©n se necesitaba un modo de compilaci√≥n b√°sico.  Se implement√≥ as√≠: cuando se presiona el bot√≥n, se selecciona el objeto y el clic lo coloca en el lugar correcto.  Entonces, el bot√≥n 1 le permite seleccionar una cancha, y el bot√≥n 2 le permite seleccionar un jugador. <br><br>  Pero a√∫n debe recordar lo que queremos decir con 1 y 2, por lo que agregu√© una estructura met√°lica para que quede claro qu√© objeto est√° seleccionado.  As√≠ es como se ve. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e96/63d/e17/e9663de17e6b402f43cab61e3905c874.gif"></div><br>  <b>Preguntas sobre arquitectura y refactorizaci√≥n</b> <br><br>  Ahora tengo varios objetos de juego: personas, canchas y pisos.  Pero para que los wireframes funcionen, debe informar a cada entidad del objeto si los objetos mismos est√°n en modo de demostraci√≥n o si simplemente se dibuja un marco.  Esto no es muy conveniente. <br><br>  Me pareci√≥ que necesitaba repensar la arquitectura para que se revelaran algunas limitaciones: <br><br><ul><li>  la presencia de una entidad que se muestra y actualiza es un problema, porque esta entidad no podr√° "saber" lo que debe representar: una imagen y una estructura al√°mbrica; </li><li>  falta de una herramienta para intercambiar propiedades y comportamiento entre entidades individuales (por ejemplo, la propiedad is_build_mode o el comportamiento de representaci√≥n).  Se podr√≠a usar la herencia, aunque no hay una forma normal de implementarla en Rust.  Lo que realmente necesitaba era el dise√±o; </li><li>  se necesitaba una herramienta para la interacci√≥n de entidades entre ellos para asignar personas a los tribunales; </li><li>  Las entidades mismas eran una mezcla de datos y l√≥gica, que r√°pidamente se sali√≥ de control. </li></ul><br><blockquote>  <i>Investigu√© un poco m√°s y descubr√≠ la arquitectura <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ECS: Entity Component System</a> , que se usa com√∫nmente en los juegos.</i>  <i>Aqu√≠ est√°n los beneficios de ECS:</i> <i><br><br></i> <ul><li>  los datos est√°n separados de la l√≥gica; </li><li>  dise√±o en lugar de herencia; </li><li>  arquitectura orientada a datos. </li></ul></blockquote><br>  ECS se caracteriza por tres conceptos b√°sicos: <br><br><ul><li>  entidades: el tipo de objeto al que hace referencia el identificador (puede ser un jugador, una pelota u otra cosa); </li><li>  componentes: las entidades consisten en ellos.  Un ejemplo es un componente de representaci√≥n, dise√±o y otros.  Es un almac√©n de datos; </li><li>  sistemas: utilizan tanto objetos como componentes, adem√°s contienen comportamiento y l√≥gica que se basan en estos datos.  Un ejemplo es un sistema de representaci√≥n que itera sobre todas las entidades con componentes para la representaci√≥n y se dedica a la representaci√≥n. </li></ul><br>  Despu√©s de estudiar, qued√≥ claro que ECS resuelve tales problemas: <br><br><ul><li>  utilizar el dise√±o en lugar de la herencia para la organizaci√≥n del sistema de entidades; </li><li>  deshacerse de un hash de c√≥digo debido a los sistemas de control; </li><li>  usando m√©todos como is_build_mode para almacenar la l√≥gica de la estructura en el mismo lugar, en el sistema de representaci√≥n. </li></ul><br>  Esto es lo que sucedi√≥ despu√©s de implementar ECS. <br><br>  <i>recursos -&gt; aqu√≠ es donde est√°n todos los activos (im√°genes)</i> <i><br></i>  <i>src</i> <i><br></i>  <i>- componentes</i> <i><br></i>  <i>- position.rs</i> <i><br></i>  <i>- person.rs</i> <i><br></i>  <i>- tennis_court.rs</i> <i><br></i>  <i>- floor.rs</i> <i><br></i>  <i>- wireframe.rs</i> <i><br></i>  <i>- mouse_tracked.rs</i> <i><br></i>  <i>- recursos</i> <i><br></i>  <i>- mouse.rs</i> <i><br></i>  <i>- sistemas</i> <i><br></i>  <i>- rendering.rs</i> <i><br></i>  <i>- constantes.rs</i> <i><br></i>  <i>- utils.rs</i> <i><br></i>  <i>- world_factory.rs -&gt; funciones de f√°brica mundial</i> <i><br></i>  <i>- main.rs -&gt; lazo principal</i> <br><br><h3>  Asignar personas a los tribunales. </h3><br>  ECS hizo la vida m√°s f√°cil.  Ahora ten√≠a una forma sistem√°tica de agregar datos a entidades y agregar l√≥gica basada en estos datos.  Y esto, a su vez, permiti√≥ organizar la distribuci√≥n de personas por tribunal. <br><br>  Lo que hice <br><br><ul><li>  agreg√≥ datos sobre los tribunales asignados a la Persona; </li><li>  datos agregados sobre personas distribuidas a TennisCourt; </li><li>  CourtChoosingSystem agregado, que le permite analizar personas y sitios, encontrar canchas disponibles y distribuir jugadores a ellos; </li><li>  agreg√≥ el sistema PersonMovementSystem, que busca a las personas asignadas a los tribunales, y si no est√°n all√≠, env√≠a a las personas donde sea necesario. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7b0/c8e/c95/7b0c8ec951007ad4d5895716c3ca7618.gif"></div><br><h3>  Para resumir </h3><br>  Realmente disfrut√© trabajando en este juego simple.  Adem√°s, me complace haber usado Rust para escribirlo porque: <br><br><ul><li>  El √≥xido te da lo que necesitas; </li><li>  √©l tiene excelente documentaci√≥n, Rust es muy elegante; </li><li>  la constancia es genial; </li><li>  No tiene que recurrir a la clonaci√≥n, la copia u otras acciones similares, que a menudo hice en C ++; </li><li>  Las opciones son muy convenientes para el trabajo, tambi√©n manejan los errores perfectamente; </li><li>  si el proyecto pudiera compilarse, en un 99% funciona, y exactamente como deber√≠a.  Me parece que los mensajes de error del compilador son los mejores que he visto. </li></ul><br>  El desarrollo del juego en Rust apenas est√° comenzando.  Pero ya existe una comunidad estable y bastante grande que trabaja para abrir Rust a todos.  Por lo tanto, miro el futuro del lenguaje con optimismo, esperando los resultados de nuestro trabajo com√∫n. <br><br><blockquote>  <b>Skillbox recomienda:</b> <br><br><ul><li>  Curso en l√≠nea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Profesi√≥n frontend-desarrollador"</a> . </li><li>  Curso pr√°ctico <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Mobile Developer PRO"</a> . </li><li>  Curso pr√°ctico anual <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Desarrollador PHP de 0 a PRO"</a> . </li></ul><br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/444364/">https://habr.com/ru/post/444364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../444352/index.html">Kontur.Kampus: te invitamos a un campamento estudiantil gratuito de desarrollo industrial cerca de San Petersburgo</a></li>
<li><a href="../444356/index.html">Tutorial de React Parte 24: Lecci√≥n de los segundos formularios</a></li>
<li><a href="../444358/index.html">Enumerable: c√≥mo generar un valor comercial</a></li>
<li><a href="../444360/index.html">La injusticia de Google Play como una buena experiencia de vida</a></li>
<li><a href="../444362/index.html">Unity y Havok trabajan en un nuevo motor de f√≠sica</a></li>
<li><a href="../444366/index.html">Seminario "Requisitos de seguridad de la informaci√≥n: c√≥mo las empresas pueden vivir con ellos"</a></li>
<li><a href="../444368/index.html">Acabamos de imprimir el micr√≥fono en una impresora 3D en el laboratorio, y luego habr√° ciencia ficci√≥n completa</a></li>
<li><a href="../444370/index.html">¬øDe qu√© es capaz el formato Mini PCI-e?</a></li>
<li><a href="../444372/index.html">Orientaci√≥n a m√°quina a larga distancia utilizando aprendizaje reforzado</a></li>
<li><a href="../444374/index.html">Efecto hipster: por qu√© los inconformistas a menudo se ven iguales</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>