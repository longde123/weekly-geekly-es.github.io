<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👏🏻 👎🏾 👸🏼 使用eo-learn对土地覆盖进行分类。 第一部分 🕴🏼 ⬜️ 💲</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="哈Ha！ 我向您介绍Matic Lubej撰写的文章“ 用eo-learn进行土地覆盖分类：第1部分 ”的翻译。 


 第二部分 
 第三部分 
 前言 


大约六个月前，对GitHub上的eo-learn存储库进行了第一次提交。 如今， eo-learn已发展成为一个了不起的开源库，可供对EO...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>使用eo-learn对土地覆盖进行分类。 第一部分</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452284/"><p> 哈Ha！ 我向您介绍Matic Lubej撰写的文章“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">用eo-learn进行土地覆盖分类：第1部分</a> ”的翻译。 </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第二部分</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第三部分</a> </p><br><h2 id="predislovie"> 前言 </h2><br><p>大约六个月前，对GitHub上的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">eo-learn</a>存储库进行了第一次提交。 如今， <code>eo-learn</code>已发展成为一个了不起的开源库，可供对EO（地球观测等译）数据感兴趣的任何人使用。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Sinergise</a>团队中的每个人都在等待从构建必要工具的阶段过渡到其用于机器学习的阶段的时刻。 现在该向您介绍有关使用<code>eo-learn</code>进行土地覆盖分类的一系列文章 </p><br><p><img src="https://habrastorage.org/webt/lv/uj/dq/lvujdqnm01rz4wdfhoxafgvhciw.png"></p><a name="habracut"></a><br><p>  <code>eo-learn</code>是一个开放源代码的Python库，它充当将地球观测/遥感与Python机器学习库的生态系统连接的桥梁。 我们已经在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Blog</a>上写了一篇单独的文章，建议您熟悉一下。 该库使用<code>numpy</code>库和<code>shapely</code>库中的基元来存储和处理卫星数据。 目前，它可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub存储库</a>中<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">找到</a> ，并且可以在指向<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ReadTheDocs</a>的适当链接处<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">找到</a>该文档。 </p><br><p><img src="https://habrastorage.org/webt/mf/jl/4r/mfjl4rxgw3pvbqw1eyeyoqr7_le.png"><br>  <em>斯洛文尼亚冬季小区域的Sentinel-2卫星图像和NDVI掩模</em> </p><br><p> 为了展示<code>eo-learn</code>的功能，我们决定使用多时相输送机，使用2017年的数据对斯洛文尼亚共和国（我们居住的国家）的领土范围进行分类。 由于完整的过程对于一篇文章来说可能太复杂了，因此我们决定将其分为三部分。 因此，无需跳过这些步骤并立即进行机器学习-首先，我们必须真正了解要使用的数据。 每篇文章都将附有Jupyter Notebook示例。 此外，对于感兴趣的人，我们已经准备了一个涵盖所有阶段的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">完整示例</a> 。 </p><br><ul><li> 在第一篇文章中，我们将指导您完成选择/分割感兴趣区域（以下简称AOI，感兴趣区域）的过程，并获取必要的信息，例如来自卫星传感器和云罩的数据。 我们还将展示一个示例，说明如何根据矢量数据在实际覆盖区域上创建数据的栅格掩码。 所有这些都是获得可靠结果的必要步骤。 </li><li> 在第二部分中，我们将深入研究机器学习过程的数据准备。 此过程包括获取随机样本以训练\验证像素，移除云图像，对时间数据进行插值以填充“空洞”等。 </li><li> 在第三部分中，我们将考虑分类器的训练和验证，当然还有精美的图形！ </li></ul><br><p><img src="https://habrastorage.org/webt/po/aq/f1/poaqf1acshjacgwywxezxkw8c_c.png"><br>  <em>夏季斯洛文尼亚小区域的Sentinel-2卫星图像和NDVI掩模</em> </p><br><h2 id="zona-interesa-vybiray"> 感兴趣的领域？ 选择！ </h2><br><p>  <code>eo-learn</code>库允许您将AOI拆分为小片段，可以在计算资源有限的情况下对其进行处理。 在此示例中，斯洛文尼亚边界​​取自“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">自然地球”</a> ，但是，您可以选择任何大小的区域。 我们还向边界添加了一个缓冲区，之后AOI尺寸约为250x170 km。 利用<code>geopandas</code>的魔力和<code>shapely</code>库，我们创建了一个打破AOI的工具。 在这种情况下，我们将区域划分为相同大小的25x17正方形，结果我们收到了300个1000x1000像素的片段，分辨率为10m。 有关拆分成碎片的决定取决于可用的计算能力。 作为此步骤的结果，我们得到了覆盖AOI的正方形列表。 </p><br><p><img src="https://habrastorage.org/webt/bh/o3/4s/bho34sb9miceo4sdykreoknjbgm.png"><br>  <em>AOI（斯洛文尼亚地区）被划分为小方块，大小约为1000x1000像素，分辨率为10m。</em> </p><br><h2 id="poluchenie-dannyh-so-sputnikov-sentinel"> 从Sentinel卫星接收数据 </h2><br><p> 确定平方后， <code>eo-learn</code>允许您自动从Sentinel卫星下载数据。 在此示例中，我们获取了2017年拍摄的所有Sentinel-2 L1C图像。 值得注意的是，可以通过类似的方式将Sentinel-2 L2A产品以及其他数据源（Landsat-8，Sentinel-1）添加到管道中。 还值得注意的是，使用L2A产品可以改善分类结果，但是我们决定使用L1C来解决方案的普遍性。 这是使用<code>sentinelhub-py</code> ，该库的工作方式类似于Sentinel-Hub服务的包装器。 研究机构和初创公司免费使用这些服务，但在其他情况下，则需要订阅。 </p><br><p><img src="https://habrastorage.org/webt/eo/h0/ux/eoh0uxgnhryalyupg59xdpfuq_i.png"><br>  <em>一个片段在不同日期的彩色图像。</em>  <em>有些图像是多云的，这意味着需要云探测器。</em> </p><br><p> 除了Sentinel数据外， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>s2cloudless</code></a>库， <code>eo-learn</code>使您可以透明地访问云和云概率数据。 该库提供了用于自动<em>逐像素</em>检测云的工具。 详细信息可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这里</a>阅读。 </p><br><p><img src="https://habrastorage.org/webt/fw/ef/zd/fwefzdfpc-yjv8b8vpzeo9figw0.png"><br>  <em>上面图像的云遮罩。</em>  <em>颜色表示特定像素出现浑浊的概率（蓝色-低概率，黄色-高）。</em> </p><br><h2 id="dobavlenie-nastoyaschih-dannyh"> 添加真实数据 </h2><br><p> 与老师一起教学需要一张带有真实数据或<em>真相</em>的卡片。 不应从字面上理解最后一个术语，因为实际上，数据只是表面上的近似值。 不幸的是，分类器的行为在很大程度上取决于该卡的质量（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">但是，对于机器学习中的大多数其他任务</a> ）。 带标签的地图通常以<code>shapefile</code>格式（例如，由州或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">社区</a>提供）作为矢量数据提供。  <code>eo-learn</code>包含用于以光栅掩码形式对矢量数据进行光栅化的工具。 </p><br><p><img src="https://habrastorage.org/webt/up/js/gl/upjsglhyqixhn9xyrd7ixadk4c0.png"><br>  <em>以一个正方形为例将数据栅格化为蒙版的过程。</em>  <em>向量文件中的多边形显示在左侧图像中，每个标签的光栅蒙版显示在中间-黑色和白色分别表示存在或不存在特定属性。</em>  <em>右图显示了一个组合的光栅蒙版，其中不同的颜色表示不同的标签。</em> </p><br><h2 id="soedinyaem-vsyo-vmeste"> 全部放在一起 </h2><br><p> 所有这些任务的行为都像构建块，可以组合为每个正方形执行的便捷操作序列。 由于此类碎片的数量可能非常多，因此绝对需要管道自动化 </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   eo_workflow = eolearn.core.LinearWorkflow( add_sentinel2_data, #     Sentinel-2 add_cloud_mask, #     append_ndvi, #  NDVI append_ndwi, #  NDWI append_norm, #     add_valid_mask, #     add_count_valid, #  -      *reference_task_array, #        save_task #   )</span></span></code> </pre> <br><p> 了解实际数据是处理此类任务的第一步。 通过将云遮罩与Sentinel-2的数据配对使用，您可以确定所有像素的质量观测值的数量，以及特定区域中云的平均概率。 因此，您可以更好地了解现有数据，并在调试其他问题时使用它。 </p><br><p><img src="https://habrastorage.org/webt/6m/t6/il/6mt6ill-w9narmsgz8ybeuew_ta.png"><br>  <em>彩色图像（左），2017年质量测量值的掩码（中）和AOI中随机碎片的2017年平均云层覆盖率（右）。</em> </p><br><p> 可能有人对任意区域的平均NDVI感兴趣，而忽略了云层。 使用云遮罩，您可以计算任何功能的平均值，而忽略没有数据的像素。 因此，由于有了掩模，我们几乎可以清除数据中任何特征的图像。 </p><br><p><img src="https://habrastorage.org/webt/dt/wi/ye/dtwiyeo9qsfd6qyrli3ck8xfgi4.png"><br>  <em>全年随机AOI片段中所有像素的平均NDVI。</em>  <em>蓝线表示忽略云内部的值而获得的计算结果。</em>  <em>当考虑所有像素时，橙色线显示平均值。</em> </p><br><h2 id="a-kak-zhe-masshtabirovanie">  “但是缩放呢？” </h2><br><p> 在我们以一个碎片为例设置输送机之后，剩下的要做的就是自动为所有碎片启动一个类似的过程（如果资源允许的话，并行执行），同时您放松地喝杯咖啡，想一想老板多大可以感到惊喜工作的结果。 管道结束后，您可以将您感兴趣的数据导出为GeoTIFF格式的单个图像。 脚本<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">gdal_merge.py</a>接收图像并将其组合，从而生成覆盖整个国家的图片。 </p><br><p><img src="https://habrastorage.org/webt/pa/bb/do/pabbdoxuho3tukngv8z6jkln_lw.png"><br>  <em>2017年AOI的正确拍摄数量。</em>  <em>包含大量图像的区域位于Sentinel-2A和Sentinel-2B卫星的轨迹相交的区域。</em>  <em>在这种情况下不会发生。</em> </p><br><p> 从上面的图像中，我们可以得出结论，输入数据是异构的-对于某些片段，图像的数量是其他图像的两倍。 这意味着我们需要采取措施对数据进行归一化-例如沿时间轴的插值。 </p><br><p> 指定的流水线执行一个片段大约需要140秒，在整个AOI中启动该过程总共需要大约12个小时。 大多数时间是在下载卫星数据。 具有上述配置的平均未压缩片段大约需要3 GB，这对于整个AOI总共提供〜1 TB的空间。 </p><br><h2 id="primer-v-jupyter-notebook">  Jupyter笔记本中的示例 </h2><br><p> 为了更简单地介绍<code>eo-learn</code>代码，我们准备了一个示例，涵盖了本文中讨论的主题。 该示例被设计为Jupyter笔记本，您可以在<code>eo-learn</code>软件包的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">examples</a>目录中找到它。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN452284/">https://habr.com/ru/post/zh-CN452284/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN452272/index.html">瀑布下的女孩</a></li>
<li><a href="../zh-CN452276/index.html">Dropbox客户端逆向工程</a></li>
<li><a href="../zh-CN452278/index.html">蓝牙LE并不那么令人恐惧，或者如何轻松改善用户体验</a></li>
<li><a href="../zh-CN452280/index.html">PostgreSQL 11：分区从Postgres 9.6到Postgres 11的演变</a></li>
<li><a href="../zh-CN452282/index.html">Watson的Elementary：与Voximplant集成</a></li>
<li><a href="../zh-CN452288/index.html">情况：美国移动运营商被指控订户地理数据非法交易</a></li>
<li><a href="../zh-CN452290/index.html">黑客在PHDays破产时会错过什么</a></li>
<li><a href="../zh-CN452294/index.html">网络研讨会“员工-后门：现代社会工程技术”</a></li>
<li><a href="../zh-CN452296/index.html">积极Hack Day 9：竞争情报竞赛5月18日</a></li>
<li><a href="../zh-CN452298/index.html">高负载.NET服务中的垃圾收集优化</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>