<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÉüèΩ üó°Ô∏è ü§∞üèæ Radar de tecnologia: uma lista de idiomas, ferramentas e plataformas que passaram pelas m√£os de Lamoda ü•ß üë¥üèª üèì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nos coment√°rios de nosso √∫ltimo artigo , houve muitas perguntas sobre as tecnologias que usamos. Neste artigo, eu - Igor Mosyagin, desenvolvedor de P&...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Radar de tecnologia: uma lista de idiomas, ferramentas e plataformas que passaram pelas m√£os de Lamoda</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lamoda/blog/428411/">  Nos coment√°rios <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">de nosso √∫ltimo artigo</a> , houve muitas perguntas sobre as tecnologias que usamos.  Neste artigo, eu - Igor Mosyagin, desenvolvedor de P&amp;D da Lamoda - vou falar sobre eles.  Abaixo do corte, voc√™ encontrar√° uma lista exaustiva de idiomas, ferramentas, plataformas e tecnologias que passaram por nossas m√£os.  O frontend, backend, banco de dados, intermedi√°rios de mensagens, caches e monitoramento, desenvolvimento e balanceamento s√£o uma hist√≥ria detalhada sobre o que usamos hoje e o que abandonamos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/631/247/aab/631247aab11173978faf7c3f35cf4c74.png"><br><br>  Meus colegas e eu estamos prontos para discutir nos coment√°rios ou no estande da empresa no HighLoad ++ 2018. <br><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://radar.thoughtworks.com/%3FsheetId%3D">Veja o radar em grande e detalhado aqui.</a> <br><br>  Como j√° dissemos, um grande n√∫mero de diferentes tecnologias e ferramentas est√° envolvido em Lamoda.  E isso n√£o √© coincid√™ncia.  Caso contr√°rio, n√£o podemos lidar com a carga!  Temos um grande armaz√©m automatizado.  Nosso call center √© atendido por 500 funcion√°rios e os processos que constru√≠mos nos permitem ligar de volta ao cliente em at√© 5 minutos ap√≥s a realiza√ß√£o do pedido.  Nosso servi√ßo de entrega opera em intervalos de 15 minutos.  Mas, al√©m de nossos pr√≥prios sistemas, temos integra√ß√£o B2B com outras lojas online.  Com uma variedade de tarefas e os requisitos de um neg√≥cio t√£o din√¢mico como o com√©rcio eletr√¥nico, o crescimento da pilha t√©cnica √© inevit√°vel, porque queremos resolver cada problema com as tecnologias mais adequadas.  A diversidade √© inevit√°vel.  Falaremos sobre os principais representantes da nossa pilha abaixo.  Mas vamos come√ßar com mecanismos que n√£o nos percam nessa variedade. <br><br><h2>  Fundamentos da arquitetura </h2><br>  Estamos caminhando ativamente para a arquitetura de microsservi√ßos.  A maioria dos sistemas j√° foi constru√≠da de acordo com essa ideologia - h√° dois anos passamos por um est√°gio de transi√ß√£o com nossos problemas e suas solu√ß√µes.  Mas n√£o vamos nos aprofundar nos detalhes desse processo - um relat√≥rio de Andrey Evsyukov " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Recursos de microsservi√ßos no exemplo de uma plataforma e-Com</a> " dir√° muito mais sobre isso. <br><br>  Para n√£o agravar a diversidade tecnol√≥gica, introduzimos a ‚Äúditadura de pr√°ticas comprovadas‚Äù, segundo a qual os criadores de novos chips s√£o recomendados para usar as tecnologias e ferramentas que j√° s√£o usadas em algum lugar da empresa.  A maioria dos servi√ßos se comunica entre si por meio da API (usamos nossa modifica√ß√£o da segunda vers√£o do padr√£o JSONRPC), mas onde a l√≥gica de neg√≥cios permite, tamb√©m usamos o barramento de dados para intera√ß√£o. <br><br>  O uso de outras tecnologias n√£o √© proibido.  No entanto, qualquer nova id√©ia deve ser testada em um comit√™ de arquitetura criado especialmente, que inclui l√≠deres das principais √°reas. <br><br>  Considerando a pr√≥xima proposta, o comit√™ d√° luz verde ao experimento ou oferece algum tipo de substitui√ß√£o da pilha existente.  A prop√≥sito, essa decis√£o depende em grande parte das circunst√¢ncias atuais nos neg√≥cios.  Por exemplo, se uma equipe chegar √†s v√©speras da venda da Black Friday e anunciar que introduzir√° tecnologia em produ√ß√£o que o comit√™ nunca tinha ouvido falar antes, provavelmente ser√° recusada.  Por outro lado, o mesmo experimento pode receber luz verde se uma nova tecnologia ou ferramenta for introduzida em circunst√¢ncias comerciais menos cr√≠ticas, e a implementa√ß√£o come√ßar√° com testes fora da produ√ß√£o. <br><br>  O Comit√™ de Arquitetura tamb√©m √© respons√°vel por manter o radar da tecnologia, fazendo as altera√ß√µes necess√°rias a cada 2-3 meses.  Um dos objetivos deste recurso √© dar √†s equipes uma id√©ia do tipo de experi√™ncia que a empresa j√° possui. <br><br>  Mas vamos para o mais interessante - para a an√°lise dos setores do nosso radar. <br><br>  Vale ressaltar que usamos uma interpreta√ß√£o um pouco fora do padr√£o das categorias de ado√ß√£o de tecnologia: <br><br><ul><li>  ADOTAR - tecnologias e ferramentas implementadas e usadas ativamente; <br></li><li>  TESTE - tecnologias e ferramentas que j√° passaram na fase de testes e est√£o se preparando para trabalhar com a produ√ß√£o (ou mesmo que j√° trabalhem l√°); <br></li><li>  AVALIA√á√ÉO - ferramentas de avalia√ß√£o que est√£o sendo avaliadas no momento e ainda n√£o afetam a produ√ß√£o.  Com a participa√ß√£o deles, apenas projetos de teste s√£o implementados; <br></li><li>  HOLD - nesta categoria, temos experi√™ncia, mas as ferramentas mencionadas s√£o usadas apenas com o suporte dos sistemas existentes - novos projetos n√£o s√£o lan√ßados neles. <br></li></ul><br><h2>  Desenvolvimento </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/486/47d/0e7/48647d0e7dd4e562c7802a04854c4247.png"><br><br><h3>  PHP - Python - Ir </h3><br>  A primeira linguagem que queremos abordar √© o PHP.  Hoje, ele resolve apenas uma parte das tarefas de back-end da loja e, inicialmente, todo o back-end trabalhava em PHP.  √Ä medida que os neg√≥cios se expandiam no front-end, a falta de velocidade e produtividade se tornava percept√≠vel - naquela √©poca, usamos o PHP 5, ent√£o o Python o substituiu (primeiro 2.xe depois 3.x).  No entanto, o PHP permite que voc√™ escreva modelos de neg√≥cios ricos, de modo que essa linguagem permaneceu no back office para automatizar v√°rios processos operacionais, em particular, integra√ß√£o com lojas online de terceiros ou servi√ßos de entrega, bem como a automa√ß√£o de um est√∫dio de conte√∫do que elabora cart√µes de produtos.  Agora j√° estamos usando o PHP 7. No PHP, escrevemos muitas bibliotecas para uso interno: integra√ß√£o e wrappers em nossa infraestrutura, camada de integra√ß√£o entre servi√ßos, v√°rios auxiliares reutilizados.  O primeiro lote de bibliotecas j√° foi levado para c√≥digo aberto em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nosso github.com</a> , e o restante, o mais "amadurecido", chegar√° em breve.  Uma das primeiras foi uma m√°quina de estado, que, presente em quase todas as aplica√ß√µes, assegura isso com o pedido antes de enviar todas as a√ß√µes necess√°rias. <br><br>  Com o tempo, o Python tamb√©m se tornou insuficiente para um back-end da loja.  Agora, preferimos um Go mais produtivo e leve. <br><br>  Talvez a transi√ß√£o para o Go tenha sido uma mudan√ßa importante, pois economizou muito hardware e recursos humanos - a efici√™ncia aumentou significativamente.  Os primeiros que fizeram os primeiros projetos no Go foram o RnD, eles n√£o quiseram lidar com as limita√ß√µes t√©cnicas do Python.  Na equipe de desenvolvimento m√≥vel, havia pessoas que o conheciam e o promoveram para a produ√ß√£o.  Desde o envio, realizamos testes e ficamos mais do que satisfeitos com o resultado.  Em casos separados, depois que parte do projeto foi reescrita do Python para o Go, o carregamento dos n√≥s do cluster caiu significativamente.  Por exemplo, reescrever o mecanismo de c√°lculo de desconto da cesta do Python para Go nos permitiu processar 8 vezes mais solicita√ß√µes nas mesmas capacidades de hardware, e o tempo m√©dio de resposta da API foi reduzido em 25 vezes.  I.e.  O Go mostrou-se mais eficiente que o Python (se voc√™ o escrever corretamente), mesmo que n√£o seja t√£o conveniente para o desenvolvedor. <br><br>  Como o desenvolvimento m√≥vel teve que interagir com dezenas de APIs internas, foi criado um gerador de c√≥digo que, de acordo com a descri√ß√£o do servi√ßo de API (de acordo com a especifica√ß√£o Swagger), um cliente pode gerar no Go.  O Go on come√ßou gradualmente a corresponder aos servi√ßos e ferramentas existentes, especialmente aqueles que criaram o "gargalo" da carga.  Al√©m de facilitar a vida do desenvolvedor de back-end para dispositivos m√≥veis, simplificamos as conven√ß√µes internas a seguir sobre como desenvolver APIs, como nomear m√©todos, como passar par√¢metros e assim por diante.  Essa padroniza√ß√£o facilitou o desenvolvimento e a implementa√ß√£o de novos servi√ßos para todas as equipes. <br><br>  Hoje, o Go j√° √© usado em quase todos os lugares - em todas as intera√ß√µes em tempo real com os usu√°rios - no back-end do site e aplicativos m√≥veis, bem como nos servi√ßos aos quais eles est√£o associados.  E onde n√£o h√° necessidade de processamento e resposta r√°pidos, por exemplo, nas tarefas de intera√ß√£o com o data warehouse, o Python permanece, pois n√£o √© igual para as tarefas de processamento de dados (embora exista aqui a penetra√ß√£o). <br><br>  Como voc√™ pode ver no radar, temos Java no ativo.  √â usado no Sistema de Gerenciamento de Armaz√©m (WMS), ajudando a coletar pedidos rapidamente.  At√© agora, temos uma pilha bastante antiga e um modelo de arquitetura antigo - um mon√≥lito girando no Wildfly 10 e 8 Java Hotspot, e tamb√©m h√° remoting e Rich client na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Netbeans Application Platform</a> (agora essa funcionalidade √© transferida para a Web).  Aqui, em nosso arsenal, temos armazenamentos padr√£o para a empresa e at√© nosso pr√≥prio monitoramento.  Infelizmente, n√£o encontramos uma ferramenta que possa visualizar bem a opera√ß√£o do armaz√©m e processos importantes (quando uma se√ß√£o est√° sobrecarregada, por exemplo), e n√≥s mesmos fizemos essa ferramenta. <br><br>  Usamos o Python como o principal idioma para aprendizado de m√°quina: criamos sistemas de recomenda√ß√£o e classificamos o cat√°logo, corrigimos erros de digita√ß√£o nas consultas de pesquisa e tamb√©m resolvemos outros problemas em conjunto com o Spark em um cluster Hadoop (PySpark).  O Python nos ajuda a automatizar o c√°lculo de m√©tricas internas e testes AB. <br><br><h3>  Desenvolvimento de front-end e mobile </h3><br>  O front-end da loja on-line para computadores, bem como sites para celular, est√° escrito em JavaScript.  Agora, o front-end est√° gradualmente migrando para a especifica√ß√£o ES6, criando novos projetos de acordo com ela.  Usamos o vue.js como a estrutura principal, mas abordaremos mais detalhadamente na se√ß√£o de ferramentas. <br><br>  O desenvolvimento de aplicativos para plataformas m√≥veis √© uma unidade separada na empresa, que inclui grupos de back-end, al√©m de aplicativos Android e iOS com suas pr√≥prias pilhas e ferramentas de tecnologia, que, devido √†s diferen√ßas de plataforma, nem sempre √© poss√≠vel unificar toda a unidade. <br><br>  H√° dois anos, todo o novo desenvolvimento do Android est√° em andamento no Kotlin, o que nos permite escrever um c√≥digo mais conciso e compreens√≠vel.  Entre os recursos mais usados, nossos desenvolvedores chamam: smartcast, classes seladas, fun√ß√µes de extens√£o, typesafe builders (DSL), funcionalidade stdlib. <br><br>  O desenvolvimento do iOS est√° em andamento no Swift, que substituiu o Objective-C. <br><br><h2>  L√≠nguas especiais </h2><br>  A variedade de tarefas do Lamoda n√£o se limita ao desenvolvimento de uma "vitrine" para diferentes plataformas; portanto, temos um n√∫mero de idiomas que s√£o usados ‚Äã‚Äãapenas na estrutura de nossos sistemas, funcionam bem l√°, mas n√£o ser√£o implementados em outras partes da infraestrutura: <br><br><ul><li>  R - usado para scripts de processamento e relat√≥rio de dados dentro da estrutura de business intelligence (BI).  Ele n√£o est√° em produ√ß√£o e n√£o √© mais usado para novas tarefas, mas ainda temos v√°rios desses scripts.  Resolvendo problemas com o R, percebemos que esse idioma n√£o √© para aplicativos altamente carregados.  Em novas tarefas, usamos Python e outras tecnologias que s√£o incompat√≠veis com R. <br></li><li>  Scala - usado pelo escrit√≥rio de desenvolvimento em Vilnius para desenvolver um sistema de automa√ß√£o de call center.  Inicialmente, esse sistema foi escrito em PHP, mas durante a transi√ß√£o para uma arquitetura de microsservi√ßo, v√°rios componentes foram reescritos no Scala.  Tamb√©m nele, a equipe de Engenharia de Dados grava trabalhos do Spark. <br></li><li>  TypeScript que estamos vendo.  A entrega j√° foi implementada com sua ajuda e, no futuro, usaremos o TypeScript + vue.js no frontend. <br></li><li>  Lua √© usada para configurar o nginx (via API do nginx); em outros projetos, n√£o √© e nunca ser√°. <br></li><li>  Somos uma empresa de moda e seguimos a moda para programa√ß√£o funcional.  Por exemplo, um emulador de dispositivo de classifica√ß√£o em um de nossos armaz√©ns est√° escrito em Haskell. <br></li></ul><br><h2>  Gerenciamento de dados </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/4b3/e03/071/4b3e03071fbd703b0a21b6c6bd6ea380.png"><br><br><h3>  DBMS, pesquisa e an√°lise de dados </h3><br>  Como muitos, os bancos de dados mais diversos que implementamos no PostgreSQL - ele √© usado sempre que bancos de dados relacionais s√£o necess√°rios, por exemplo, para armazenar um diret√≥rio.  √â muito f√°cil encontrar especialistas nessa tecnologia, al√©m disso, muitos servi√ßos diferentes est√£o dispon√≠veis. <br><br>  Obviamente, o PostgreSQL n√£o √© o √∫nico DBMS que pode ser encontrado em nossa infraestrutura de TI.  Em alguns sistemas mais antigos, por exemplo, o MySQL √© usado, enquanto o WMS possui um pouco do MongoDB.  No entanto, para altas cargas e dimensionamento (levando em considera√ß√£o o restante de nossa pilha de tecnologias), n√£o os usamos para novos projetos.  Em geral, o PostgreSQL √© o nosso tudo. <br><br>  O Aerospike tamb√©m √© vis√≠vel no radar.  N√≥s o usamos de maneira bastante ativa, mas o contrato de licen√ßa foi alterado para o produto, ent√£o a vers√£o ‚Äúour‚Äù acabou sendo um pouco cortada.  No entanto, agora olhamos para ele novamente.  Talvez reconsideremos nossa atitude em rela√ß√£o ao instrumento e a utilizemos de forma mais ativa.  Agora, o Aerospike √© usado no servi√ßo de agrega√ß√£o de eventos de exibi√ß√£o de p√°gina e no trabalho do usu√°rio com a cesta, bem como no servi√ßo de prova social ("5 pessoas adicionaram este produto aos favoritos esta semana").  Agora estamos fazendo recomenda√ß√µes ainda mais √≠ngremes. <br><br>  O Apache Solr √© usado para procurar dados de produ√ß√£o.  Paralelamente, tamb√©m usamos o ElasticSearch.  Ambas as solu√ß√µes s√£o de c√≥digo aberto, mas, se antes, quando est√°vamos implementando a pesquisa, o Apache Solr j√° tinha a terceira ou quarta vers√£o e estava desenvolvendo ativamente, e o ElasticSearch nem sequer tinha o primeiro lan√ßamento est√°vel - era muito cedo para us√°-lo na produ√ß√£o.  Agora, os pap√©is mudaram - √© muito mais f√°cil encontrar solu√ß√µes para o ElasticSearch, e novas pessoas chegaram at√© n√≥s que s√£o boas em prepar√°-lo.  No entanto, no prod temos o Solr, e n√£o mudaremos para outra solu√ß√£o pelo menos at√© a Black Friday 2018. <br><br><img src="https://habrastorage.org/webt/e-/zv/yt/e-zvytvyg9cp2fnsux3xiwvec8c.png"><br>  <i>Compara√ß√£o da din√¢mica das consultas de pesquisa Apache Solr (azul) e ElasticSearch (vermelho), de acordo com o Google Trends</i> <br><br>  A an√°lise de dados ocorre em v√°rios sistemas, em particular, usamos ativamente o Apache Hadoop.  Ao mesmo tempo, a coluna Vertica DBMS √© usada para armazenar data marts (com um volume total de cerca de 4 TB).  Sobre essas vitrines, s√£o elaborados relat√≥rios financeiros, operacionais e comerciais.  Para muitas de nossas tarefas ETL, usamos o Luigi anteriormente, mas agora estamos migrando para o Apache Airflow.  Tamb√©m usamos o Pentaho para armazenamento relacional, no qual existem cerca de mil tarefas regulares de ETL. <br><br>  Parte da an√°lise e prepara√ß√£o dos dados para outros sistemas √© realizada no Spark.  Em alguns lugares, isso n√£o √© apenas uma ferramenta de an√°lise, mas tamb√©m faz parte da nossa arquitetura lambda. <br><br>  Um papel importante na infraestrutura de TI √© desempenhado pelos sistemas ERP: Microsoft Dynamics AX e 1C.  Como DBMS, o Microsoft SQL Server √© usado.  E para relat√≥rios, seus componentes, como servi√ßos de an√°lise e servi√ßos de relat√≥rio. <br><br><h3>  Armazenamento em cache </h3><br>  Para armazenar em cache, usamos Redis.  Anteriormente, essa tarefa era executada pelo MemCached, n√£o podia ser usada como armazenamento de valor-chave com um despejo peri√≥dico em disco, portanto a abandonamos. <br><br><h3>  Filas de mensagens </h3><br>  Como intermedi√°rio de eventos, usamos duas ferramentas ao mesmo tempo - Apache Kafka e RabbitMQ. <br>  O Apache Kafka √© uma ferramenta que nos permite processar dezenas de milhares de mensagens em v√°rios sistemas em que as mensagens s√£o necess√°rias.  Clusters Kafka separados s√£o implantados para algumas partes altamente carregadas do sistema - por exemplo, para eventos ou log do usu√°rio (tivemos um bom <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rio sobre log no Highload ++ 2017</a> ).  Kafka permite que voc√™ lide com 6000 mil mensagens em massa por segundo com o uso m√≠nimo de ferro. <br><br>  Nos sistemas internos, usamos o RabbitMQ para a√ß√µes adiadas. <br><br><h2>  Plataformas e Infraestrutura </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/7f3/766/c97/7f3766c97395b3578d4375f441c1d1ce.png"><br><br><h3>  Entrega cont√≠nua </h3><br>  Para a implanta√ß√£o, √© usado o Kubernetes, que substituiu o pacote Nomad + Consul da Hashicorp.  A pilha anterior funcionou muito mal com atualiza√ß√µes de hardware.  Quando nossa equipe de opera√ß√µes mudou os servidores f√≠sicos nos quais os n√≥s estavam girando e os cont√™ineres foram armazenados, ele periodicamente se rompeu e travou, sem querer subir.  N√£o havia vers√£o est√°vel naquele momento.  Al√©m disso, n√£o usamos o mais recente naquele momento - 0.5.6, que ainda precisava ser atualizado.  A atualiza√ß√£o para a √∫ltima vers√£o beta exigiu algum trabalho.  Portanto, decidiu-se abandon√°-lo e mudar para os Kubernetes mais populares. <br><br>  Agora Nomad e C√¥nsul ainda s√£o usados ‚Äã‚Äãno controle de qualidade, mas no futuro ele tamb√©m deve se mudar para Kubernetes. <br><br>  Para implementar a entrega cont√≠nua, s√£o usados ‚Äã‚Äãcont√™ineres Docker, para os quais migramos h√° dois anos.  Para nossos servi√ßos altamente carregados (cesta, cat√°logo, site, sistema de gerenciamento de pedidos), √© importante a capacidade de buscar rapidamente alguns cont√™ineres adicionais de um servi√ßo, por isso temos cont√™ineres em todos os lugares.  E o Docker √© um dos m√©todos mais populares de conteineriza√ß√£o, portanto sua presen√ßa no radar √© bastante l√≥gica. <br><br>  Como servidor de constru√ß√£o e integra√ß√£o cont√≠nua, o Bamboo √© implementado, usado em conjunto com o Jira e o Bitbucket (pilha padr√£o). <br><br>  Jenkins tamb√©m √© mencionado no radar.  Experimentamos com ele, mas n√£o o arrastamos para novos projetos.  √â uma √≥tima ferramenta, mas simplesmente n√£o se encaixa na nossa pilha, porque j√° temos o Bamboo. <br><br>  Coletados usando os estivadores Bamboo docker s√£o armazenados no reposit√≥rio sob o controle do Artifactory. <br><br><h3>  Gerenciamento de processos e balanceamento </h3><br>  Usamos o NGINX Plus, mas n√£o em termos de balanceamento, porque suas m√©tricas n√£o s√£o suficientes para nossas tarefas.  Ele n√£o pode dizer, por exemplo, qual solicita√ß√£o √© roteada ou congelada com mais freq√º√™ncia.  Portanto, o HAProxy √© usado para equilibrar a carga.  Ele pode trabalhar de forma r√°pida e eficiente em conjunto com o nginx, sem carregar o processador e a mem√≥ria.  Al√©m disso, as m√©tricas de que precisamos est√£o prontas para uso - o HAproxy pode mostrar estat√≠sticas por n√≥s, pelo n√∫mero de conex√µes no momento, pela ocupa√ß√£o da largura de banda e muito mais. <br><br>  UWSGI √© usado para executar aplicativos Python s√≠ncronos.  O php-fpm foi usado como gerenciador de processos em todos os servi√ßos PHP. <br><br><h3>  Monitoramento </h3><br>  Usamos o Prometheus para coletar m√©tricas de nossos aplicativos e m√°quinas host (m√°quinas virtuais), bem como o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">banco de dados de s√©ries temporais do aplicativo</a> .  Coletamos logs, para isso usamos a pilha ELK, como sistema de alerta usamos o Icinga, configurado para ELK e Prometheus.  Ela envia alertas para correio e SMS.  O servi√ßo de suporte 6911 recebe os mesmos alertas e decide atrair engenheiros de servi√ßo. <br><br>  O Prometheus est√° envolvido em quase todos os lugares e, para isso, temos bibliotecas para todos os idiomas, o que permite o uso de apenas algumas linhas de c√≥digo para conectar suas m√©tricas ao projeto.  Por exemplo, uma biblioteca para PHP <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">est√° dispon√≠vel em c√≥digo aberto</a> ). <br><br>  Para exibir visualmente os resultados do monitoramento na forma de belos pain√©is, o Grafana √© usado.  Basicamente, coletamos todos os pain√©is do Prometheus, embora algumas vezes outros sistemas tamb√©m possam servir como fontes. <br><br>  Para captura e agrega√ß√£o autom√°tica de erros, usamos o Sentry, que √© integrado ao Jira e facilita o in√≠cio de um rastreador de tarefas para cada um dos problemas de produ√ß√£o.  Ele sabe como capturar o erro com algumas informa√ß√µes adicionais e retorno e, portanto, √© conveniente estrear. <br><br>  As estat√≠sticas sobre o c√≥digo das solicita√ß√µes de recebimento criadas s√£o coletadas usando o SonarQube. <br><br><h2>  Estruturas e ferramentas </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/e26/88a/e33/e2688ae33a6efe4be82eee1bea2d1384.png"><br><br>  Durante o desenvolvimento da infraestrutura de TI da Lamoda, experimentamos quase tr√™s d√∫zias de ferramentas diferentes; portanto, essa categoria √© a mais "em larga escala" do nosso radar.  At√© o momento, s√£o usados ‚Äã‚Äãativamente: <br><br><ul><li>  Symfony 3.xe mais recente - Symfony 4.x - para desenvolvimento em PHP; <br></li><li>  Django e o mecanismo de modelo Jinja para desenvolvimento em Python.  A prop√≥sito, o Jinja √© usado, inclusive, para configura√ß√£o no Ansible; <br></li><li>  Flask - para servi√ßos internos (junto com o Django), mas na produ√ß√£o n√£o o arrastamos; <br></li><li>  Spring - em desenvolvimento Java; <br></li><li>  Bootstrap - para uma variedade de ferramentas internas no desenvolvimento da Web (painel de administra√ß√£o, pain√©is caseiros, etc.); <br></li><li>  jQuery - para desenvolvimento de js; <br></li><li>  OpenAPI (Swagger) - para documenta√ß√£o de todos os servi√ßos de API, incluindo  que s√£o usados ‚Äã‚Äãpara a gera√ß√£o de c√≥digo acima no Go; <br></li><li>  Webpack - para empacotar JS e minimizar CSS; <br></li><li>  Sel√™nio - para testar o frontend; <br></li><li>  WireMock, JMeter, Allure e outros tamb√©m s√£o usados ‚Äã‚Äãem testes; <br></li><li>  Ansible - para gerenciamento de configura√ß√£o; <br></li><li>  Kibana - para visualizar os resultados da pesquisa no ElasticSearch. <br></li></ul><br>  Gostaria de falar sobre o desenvolvimento do JavaScript separadamente.  N√≥s, como muitos, temos todo um campo de experimentos.    JavaScript   .               ‚Äî Angular, ReactJS, vue.js.   ¬´ ¬ª, ,  vue.js,        ,     . <br><br><h2>    </h2><br>         ,     GO, PHP, Java, JavaScript,    PostgreSQL,    Docker  Kubernetes. <br><br> ,       .   ,         ,       .   -,        .      ,     ,   ,    . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt428411/">https://habr.com/ru/post/pt428411/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt428395/index.html">O livro ‚ÄúTe√≥rico m√≠nimo para Big Data. Tudo o que voc√™ precisa saber sobre big data ‚Äù</a></li>
<li><a href="../pt428401/index.html">Processos de desenvolvimento atrav√©s dos olhos da explora√ß√£o. Um olhar do outro lado da barricada</a></li>
<li><a href="../pt428403/index.html">Resumo de eventos para profissionais de RH na √°rea de TI em novembro de 2018</a></li>
<li><a href="../pt428407/index.html">6 parcelas t√≠picas da literatura mundial</a></li>
<li><a href="../pt428409/index.html">An√°lise de incidentes em 21 de outubro no github</a></li>
<li><a href="../pt428413/index.html">Sistemas de refrigera√ß√£o nos data centers Selectel</a></li>
<li><a href="../pt428415/index.html">Vis√£o geral do controlador de nuvem TP-Link Omada OC200</a></li>
<li><a href="../pt428417/index.html">Aprendizado de m√°quina no MatLab / Oitava: exemplos de algoritmos suportados por f√≥rmulas</a></li>
<li><a href="../pt428419/index.html">Arraste e deslize o dedo no RecyclerView. Parte 2: arraste e solte controladores, grades e anima√ß√µes personalizadas</a></li>
<li><a href="../pt428421/index.html">Sistema flex√≠vel para testar e coletar m√©tricas de programas usando o conjunto de testes LLVM como exemplo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>