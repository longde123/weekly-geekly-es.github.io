<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â˜¹ï¸ ğŸ˜¯ ğŸ· Flask-Potionä¸Šçš„åº“æ§åˆ¶ç³»ç»Ÿï¼Œç¬¬0éƒ¨åˆ†ï¼šå‡†å¤‡æ‰€éœ€çš„ä¸€åˆ‡ ğŸš˜ ğŸ¤¸ğŸ½ â™ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¼•è¨€ 


 åœ¨æˆ‘çš„å·¥ä½œä¸­ï¼Œæˆ‘å·²ç»ä½¿ç”¨Flask-Potionä¸€æ®µæ—¶é—´äº†ï¼Œè¯¥æ¡†æ¶çš„ä¸»è¦ä¼˜ç‚¹æ˜¯ï¼šä¸SQLAlchemyæ¨¡å‹çš„éå¸¸æ–¹â€‹â€‹ä¾¿çš„é›†æˆï¼Œè‡ªåŠ¨ç”ŸæˆCrudç«¯ç‚¹ï¼Œå­˜åœ¨è¯æ°´å®¢æˆ·ç«¯ ï¼ˆå¦‚æœç¼–å†™éœ€è¦åœ¨å¦ä¸€ä¸ªAPIä¸­ä½¿ç”¨çš„APIæœåŠ¡ï¼Œåˆ™éå¸¸æ–¹ä¾¿ï¼‰æœåŠ¡ï¼‰ã€‚ 


 æˆ‘æ³¨æ„åˆ°ä¿„è¯­ä¸­çš„çƒ§ç“¶è¯æ°´å‡ ä¹æ²¡æœ‰ï¼Œä½†æ˜¯æˆ‘è®¤...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Flask-Potionä¸Šçš„åº“æ§åˆ¶ç³»ç»Ÿï¼Œç¬¬0éƒ¨åˆ†ï¼šå‡†å¤‡æ‰€éœ€çš„ä¸€åˆ‡</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/472018/"><h1 id="vvedenie"> å¼•è¨€ </h1><br><p> åœ¨æˆ‘çš„å·¥ä½œä¸­ï¼Œæˆ‘å·²ç»ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Flask-Potion</a>ä¸€æ®µæ—¶é—´äº†ï¼Œè¯¥æ¡†æ¶çš„ä¸»è¦ä¼˜ç‚¹æ˜¯ï¼šä¸SQLAlchemyæ¨¡å‹çš„éå¸¸æ–¹â€‹â€‹ä¾¿çš„é›†æˆï¼Œè‡ªåŠ¨ç”ŸæˆCrudç«¯ç‚¹ï¼Œå­˜åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯æ°´å®¢æˆ·ç«¯</a> ï¼ˆå¦‚æœç¼–å†™éœ€è¦åœ¨å¦ä¸€ä¸ªAPIä¸­ä½¿ç”¨çš„APIæœåŠ¡ï¼Œåˆ™éå¸¸æ–¹ä¾¿ï¼‰æœåŠ¡ï¼‰ã€‚ </p><br><p> æˆ‘æ³¨æ„åˆ°ä¿„è¯­ä¸­çš„çƒ§ç“¶è¯æ°´å‡ ä¹æ²¡æœ‰ï¼Œä½†æ˜¯æˆ‘è®¤ä¸ºè¿™ä¸ªæ¡†æ¶å¯¹äºæŸäº›äººæ¥è¯´ä¼¼ä¹å¾ˆæœ‰è¶£ã€‚ </p><br><p> æˆ‘å†³å®šå†™å‡ ç¯‡å…³äºåŸºäºFlask-Potionä¸ºFurfuråº“åˆ›å»ºæ§åˆ¶ç³»ç»Ÿçš„æ–‡ç« ï¼Œè€Œä¸æ˜¯ç®€å•åœ°é˜…è¯»æœ‰å…³è¯¥æ¡†æ¶çš„æ–‡ç« ã€‚ </p><br><p> è¯¥ç³»ç»Ÿåº”è¯¥èƒ½å¤Ÿæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š </p><br><ul><li> å­˜å‚¨æœ‰å…³ä¹¦ç±çš„ä¿¡æ¯ï¼ˆisbnï¼Œæ ‡é¢˜ï¼Œæè¿°ï¼Œä½œè€…ç­‰ï¼‰ </li><li> å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼ˆè¯»è€…å’Œå›¾ä¹¦é¦†å‘˜ï¼‰ </li><li> åœ¨å›¾ä¹¦é¦†å‘è¡Œä¸€æœ¬ä¹¦æœ‰ä¸€å®šçš„æœŸé™ï¼Œå¯ä»¥å»¶æœŸ </li></ul><br><p>åœ¨æ­¤ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹å·¥å…·ï¼š </p><br><ul><li>  PostgreSQLçš„ </li><li>  Flaskï¼ŒFlask-SQLAlchemyï¼ŒFlask-JWTï¼ŒFlask-Potionï¼ŒFlask-Migrate </li></ul><a name="habracut"></a><br><h1 id="podgotovka"> å‡†å¤‡å·¥ä½œ </h1><br><h2 id="skelet"> éª·é«… </h2><br><p> ä¸ºäº†ä¸è‡ªå·±æ”¶é›†é¡¹ç›®çš„æ¡†æ¶ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Valefor cookiecutter-templateï¼Œè¯¥æ¨¡æ¿åŒ…æ‹¬ä¸Šè¿°æ‰€æœ‰ä¾èµ–é¡¹ï¼Œç”šè‡³æ›´å¤šã€‚ </p><br><pre><code class="bash hljs">cookiecutter gh:lemegetonx/valefor</code> </pre> <br><p> è¯¥æ¨¡æ¿åŒ…æ‹¬ä¸¤ä¸ªåº”ç”¨ç¨‹åºï¼š </p><br><ol><li> åº”ç”¨æ˜¯æœ€ä¸»è¦çš„ã€‚ å®ƒåŒ…å«ç”¨äºjwtçš„å¤„ç†å‡½æ•°ï¼Œç”¨äºè¯æ°´èµ„æºå’Œsqlalchemyæ¨¡å‹çš„mixinç±»ï¼Œä»¥åŠå¸¦æœ‰åº”ç”¨ç¨‹åºé…ç½®çš„è½¯ä»¶åŒ…ã€‚ </li><li> ç”¨æˆ·-æ¨¡æ¿çš„å¼€å¤´ï¼Œä»…åŒ…å«ç”¨æˆ·æ¨¡å‹ã€‚ </li></ol><br><h2 id="ustanovka-zavisimostey"> ä¾èµ–å®‰è£… </h2><br><p> è¯¥æ¨¡æ¿ä½¿ç”¨è¯—æ­Œæ¥è§£å†³ä¾èµ–å…³ç³»ï¼Œä½†æ˜¯æœ€è¿‘pipè¿˜æ”¯æŒ<em>pyproject.toml</em> ï¼Œå› æ­¤é€‰æ‹©æ˜¯æ‚¨è‡ªå·±çš„ã€‚ æˆ‘å°†åˆ©ç”¨è¯—æ­Œã€‚ </p><br><pre> <code class="bash hljs">poetry install</code> </pre> <br><h2 id="konfiguraciya"> æ„å‹ </h2><br><p> ä¸ºäº†ç®€åŒ–é…ç½®ï¼Œæ¨¡æ¿ä½¿ç”¨äº†è¥¿æé‡Œï¼ˆsitriï¼‰åº“ã€‚ æˆ‘ä»¬å°†éœ€è¦ç¨å¾®ä¿®æ”¹Sitriå¯¹è±¡çš„è®¾ç½®ã€‚ </p><br><ol><li> æ›´æ”¹<em>app / config / provider.py</em> ã€‚ æˆ‘ä»¬å°†ç”¨<em>YamlCredentialProvider</em>æ›¿æ¢<em>SystemCredentialProvider</em> ï¼Œä»¥ä¾¿ä»<em>credential.yaml</em>æ–‡ä»¶è·å–ç¬¬ä¸‰æ–¹ç³»ç»Ÿçš„æˆæƒæ•°æ®ï¼Œè€Œä¸ä¼šå°†å…¶æ·»åŠ åˆ°æäº¤ä¸­ï¼š </li></ol><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sitri <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Sitri <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sitri.contrib.yaml <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> YamlConfigProvider, YamlCredentialProvider configuration = Sitri( config_provider=YamlConfigProvider(yaml_path=<span class="hljs-string"><span class="hljs-string">"./config.yaml"</span></span>), credential_provider=YamlCredentialProvider(yaml_path=<span class="hljs-string"><span class="hljs-string">"./credential.yaml"</span></span>), )</code> </pre> <br><p> ç®€è€Œè¨€ä¹‹ï¼ŒPSå¯ä»¥æ›´è½»æ¾åœ°é˜…è¯»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£ä¸­</a>å®é™…å‘ç”Ÿçš„äº‹æƒ…ï¼Œç®€è€Œè¨€ä¹‹ï¼Œç°åœ¨æˆ‘ä»¬å†³å®šè¦ä»å“ªé‡Œè·å–ç”¨äºé…ç½®å’Œæˆæƒçš„æ•°æ®ã€‚ </p><br><ol><li> ç”±äºæˆ‘ä»¬å®è´¨ä¸Šæ˜¯ä½¿ç”¨ç›¸åŒçš„æä¾›ç¨‹åºï¼Œå› æ­¤æœ€å¥½ç”¨<em>database.pyä¸­çš„</em>ç‚¹æ›¿æ¢<em>get_credential</em>è°ƒç”¨ä¸­é”®ä¸­çš„ä¸‹åˆ’çº¿ã€‚ </li></ol><br><pre> <code class="python hljs">DB_NAME = configuration.get_credential(<span class="hljs-string"><span class="hljs-string">"db.name"</span></span>, path_mode=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) DB_HOST = configuration.get_credential(<span class="hljs-string"><span class="hljs-string">"db.host"</span></span>, path_mode=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) DB_PASSWORD = configuration.get_credential(<span class="hljs-string"><span class="hljs-string">"db.user.password"</span></span>, path_mode=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) DB_PORT = configuration.get_credential(<span class="hljs-string"><span class="hljs-string">"db.port"</span></span>, path_mode=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) DB_USER = configuration.get_credential(<span class="hljs-string"><span class="hljs-string">"db.user.name"</span></span>, path_mode=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><p> å› æ­¤ï¼Œ <em>config.yaml</em>æ–‡ä»¶å·²ç»åœ¨æ¨¡æ¿ä¸­ï¼Œä½†æ˜¯<em>credential.yaml</em>åº”è¯¥ç”±æ‚¨è‡ªå·±ç¼–å†™ã€‚ åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œå¿…é¡»å°†æ­¤ç±»æ–‡ä»¶æ·»åŠ åˆ°.gitignoreä¸­ï¼Œä½†æ˜¯æˆ‘ä¼šå°†<em>credential.yaml</em>æ¨¡æ¿æ·»åŠ åˆ°å­˜å‚¨åº“ä¸­ï¼Œä»¥ä¾¿ä»»ä½•è¿›å…¥è¯¥é¡¹ç›®çš„äººéƒ½å¯ä»¥ç†è§£å…¶ç»“æ„ã€‚ </p><br><p> åŸºæœ¬<em>credential.yaml</em> ï¼š </p><br><pre> <code class="plaintext hljs">db: name: furfur_db host: localhost port: 5432 user: password: passwd name: admin</code> </pre> <br><h2 id="baza-dannyh"> èµ„æ–™åº“ </h2><br><p> æˆ‘ä»¬å‡†å¤‡å·¥ä½œçš„ä¸‹ä¸€æ­¥æ˜¯éƒ¨ç½²DBMSï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸ºPostgreSQLã€‚ ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘å°†åˆ›å»ºä¸€ä¸ª<em>stack.yaml</em>æ–‡ä»¶ï¼Œå…¶ä¸­å°†ç”¨æ‰€éœ€çš„æ•°æ®æè¿°postgreså®¹å™¨çš„å¯åŠ¨ã€‚ </p><br><pre> <code class="plaintext hljs">version: '3.1' services: db: image: postgres restart: always environment: POSTGRES_PASSWORD: passwd POSTGRES_USER: admin POSTGRES_DB: furfur_db ports: - 5432:5432</code> </pre> <br><p> å¦‚å‰æ‰€è¿°ï¼Œvaleforæ¨¡æ¿åŒ…æ‹¬JWTï¼ˆå¤„ç†ç¨‹åºï¼‰æ­£å¸¸å·¥ä½œæ‰€å¿…éœ€çš„åŸºæœ¬ç”¨æˆ·æ¨¡å‹ï¼Œå› æ­¤å‡†å¤‡æ•°æ®åº“çš„æœ€åä¸€æ­¥æ˜¯è¿ç§»ï¼ˆåˆ›å»ºç”¨æˆ·è¡¨ï¼‰ã€‚ </p><br><p> ä½œä¸ºé¡¹ç›®çš„æ ¹ï¼Œæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> FLASK_APP=furfur.app flask db init flask db migrate flask db upgrade</code> </pre> <br><p> æœ‰äº†æ•°æ®åº“çš„å‡†å¤‡ä»¥åŠæˆ‘ä»¬ç³»ç»Ÿçš„ä¸€èˆ¬åŸºç¡€ï¼Œä¸€åˆ‡éƒ½å®Œæˆäº†ã€‚ </p><br><h1 id="chto-dalshe"> æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆï¼Ÿ </h1><br><p> åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ç»„ç»‡ä¸€ä¸ªç®€å•çš„è§’è‰²ç³»ç»Ÿå’ŒJWTèº«ä»½éªŒè¯ã€‚ </p><br><p> é¡¹ç›®èµ„æºåº“ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">//github.com/Egnod/furfur</a> <br> æ­¤éƒ¨åˆ†ä¸­è¯´æ˜çš„æ‰€æœ‰å†…å®¹ï¼š <a href="">https</a> : <a href="">//github.com/Egnod/furfur/releases/tag/0.0.2</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN472018/">https://habr.com/ru/post/zh-CN472018/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN472002/index.html">åœ¨Gradleä¸­é‡æ–°åŒ…è£…åŒ…è£¹</a></li>
<li><a href="../zh-CN472004/index.html">Boost.Spiritï¼Œæˆ–å°†â€œ Spiritualityâ€æ·»åŠ åˆ°åˆ—è¡¨è¿‡æ»¤å™¨</a></li>
<li><a href="../zh-CN472006/index.html">ä¸ºä»€ä¹ˆé‡æ–°å‘æ˜è½®å­å¾ˆæœ‰ç”¨</a></li>
<li><a href="../zh-CN472012/index.html">åŠå°æ—¶å†…çœ‹æ¿</a></li>
<li><a href="../zh-CN472014/index.html">OTUSã€‚ æˆ‘ä»¬æœ€å–œæ¬¢çš„é”™è¯¯</a></li>
<li><a href="../zh-CN472020/index.html">åå¤§ï¼šHolyJS 2019 Piterçš„æœ€ä½³æŠ¥å‘Š</a></li>
<li><a href="../zh-CN472022/index.html">æˆ‘ä»¬è¯»äº†12æœ¬ä¹¦</a></li>
<li><a href="../zh-CN472024/index.html">3.0ç‰ˆï¼šåšå¾—æ›´å¥½</a></li>
<li><a href="../zh-CN472026/index.html">Nevangerï¼šé“è·¯æ”¹å˜äº†</a></li>
<li><a href="../zh-CN472028/index.html">LoRaWANå’ŒNB-IoTï¼šç«äº‰å¯¹æ‰‹è¿˜æ˜¯åˆä½œä¼™ä¼´ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>