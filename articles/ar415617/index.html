<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฅฃ ๐ ๐๏ธ ุงุณุชุฎุฏุงู ููุชุจุฉ InternetPCools FPC ูู ุฏููู ๐จ๐ปโ๐ ๐จโ๐จโ๐งโ๐ฆ ๐ง</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุงููุงูุน ุ ุงูููุงูุฉ ุฃูุณุน ุฅูู ุญุฏ ูุง - ุชุตู ุทุฑููุฉ ูุงุณุชุฎุฏุงู ุงูุนุฏูุฏ ูู ุงูููุชุจุงุช ุงูุฃุฎุฑู ุจุดูุงููุฉ (ูููุณ ููุท ูู ุนุงูู Free Pascal ) ุ ูุชู ุงุฎุชูุงุฑ InternetTools ุจ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงุณุชุฎุฏุงู ููุชุจุฉ InternetPCools FPC ูู ุฏููู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415617/" style=";text-align:right;direction:rtl">  ูู ุงููุงูุน ุ ุงูููุงูุฉ ุฃูุณุน ุฅูู ุญุฏ ูุง - ุชุตู ุทุฑููุฉ ูุงุณุชุฎุฏุงู ุงูุนุฏูุฏ ูู ุงูููุชุจุงุช ุงูุฃุฎุฑู <i>ุจุดูุงููุฉ</i> (ูููุณ ููุท ูู ุนุงูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Free Pascal</a> ) ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชู</a> ุงุฎุชูุงุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">InternetTools</a> ุจุณุจุจ ููููุชูุง ุงูุฑุงุฆุนุฉ - ูุฐุง ูู ุงูุญุงู ุนูุฏูุง (ูู ุงููุฏูุด) ููููุฏ ูุณุฎุฉ ุฏููู ูุน ููุณ ุงูููุฒุงุช ูุณูููุฉ ุงูุงุณุชุฎุฏุงู. <br><br>  ุชู ุชุตููู ูุฐู ุงูููุชุจุฉ ูุงุณุชุฎุฑุงุฌ ุงููุนูููุงุช (ุงูุชุญููู) ูู ูุณุชูุฏุงุช ุงูููุจ (XML ู HTML) ุ ููุง ูุณูุญ ูู ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุบุงุช ุงูุงุณุชุนูุงู ุนุงููุฉ ุงููุณุชูู</a> ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">XPath</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">XQuery</a> ููุฅุดุงุฑุฉ ุฅูู ุงูุจูุงูุงุช ุงููุทููุจุฉ ุ ููุฎูุงุฑ ุ ุชูููุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุตูู ุงููุจุงุดุฑ</a> ุฅูู ุนูุงุตุฑ ุดุฌุฑุฉ ูุจููุฉ ุนูู ุงููุณุชูุฏ. <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ููุฏูุฉ ุฅูู InternetTools </h2><br>  ุณูุชู ุชูุถูุญ ุงููุฒูุฏ ูู ุงูููุงุฏ ุนูู ุฃุณุงุณ ูููุฉ ุจุณูุทุฉ ุฅูู ุญุฏ ูุง ุ ููุง ูุนูู ุถููุงู ุงูุญุตูู ุนูู ุชูู ุงูุนูุงุตุฑ ูู ุงูููุงุฆู ุฐุงุช ุงูุชุนุฏุงุฏ ุงูููุทู ูุงููุฑููุฉ ููุฐู ุงูููุงูุฉ ุงูุชู ุชุญุชูู ุนูู ุฑูุงุจุท ุ ูุงูุชู ุฅุฐุง ูุธุฑุช ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> ุ ูุฅู ูุซู ูุฐุง ุงูุฑูุฒ ุงูุตุบูุฑ ูููู (ูุชู ุจูุงุคู ุนูู ุฃุณุงุณ ุงููุซุงู ูุจู ุงูุฃุฎูุฑ ูุน ุชุบููุฑุงุช ุตุบูุฑุฉ ุบูุฑ ูุจุฏุฆูุฉ ): <br><br><a name="FirstTask"></a><pre style=";text-align:right;direction:rtl"><code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> xquery; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ListValue: IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ListValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xqvalue(ArticleURL).retrieve.map(ListXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln(ListValue.toString); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  ููุน ุฐูู ุ ูููู ุงูุขู ูุชุงุจุฉ ูุฐุง ุงูุฑูุฒ ุงููุถุบูุท ูุงูููุฌู ูููุงุฆู ููุท ูู Free Pascal ุ ูููููุง ุจุญุงุฌุฉ ุฅูู ุฃู ูููู ูุงุฏุฑูู ุนูู ุงุณุชุฎุฏุงู ูู ูุง ุชููุฑู ูุฐู ุงูููุชุจุฉ ูู ุชุทุจูู ุฏููู ุ ูููุถู ุฃู ูููู ุฐูู ุจุฃุณููุจ ููุงุซู ุ ูุน ููุณ ูุณุงุฆู ุงูุฑุงุญุฉ  ูู ุงูููู ุฃูุถูุง ููุงุญุธุฉ ุฃู InternetTools <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุขูู ููุคุดุฑ ุงูุชุฑุงุจุท</a> (ุงููุตูู ุฅููู ูุณููุญ ุจู ูู ุงูุนุฏูุฏ ูู ุณูุงุณู ุงูุฑุณุงุฆู ูู ููุณ ุงูููุช) ุ ูุฐูู ูุฌุจ ุฃู ูููุฑ ุฎูุงุฑูุง ุฐูู. <br><br><h2 style=";text-align:right;direction:rtl">  ุทุฑู ุงูุชูููุฐ </h2><br>  ุฅุฐุง ุงูุชุฑุจุช ูู ุงููููุฉ ุฅูู ุฃูุตู ุญุฏ ูููู ุ ูููุงู ุนุฏุฉ ุทุฑู ูุงุณุชุฎุฏุงู ุดูุก ููุชูุจ <abbr title="ูุบุฉ ุงูุจุฑูุฌุฉ">ุจูุบุฉ</abbr> ุฃุฎุฑู - ุณูุดูููู 3 ูุฌููุนุงุช ูุจูุฑุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุถุน ุงูููุชุจุฉ ูู <b>ุนูููุฉ ูููุตูุฉ</b> ุ ูุชู ุฅูุดุงุก ุงูููู ุงููุงุจู ููุชูููุฐ ูู ูุจู ุงูููุงุช ุ ูู ูุฐู ุงูุญุงูุฉ ุ <abbr title="ูุชุฑุฌู ุจุงุณูุงู ูุฌุงูู">FPC</abbr> .  ูููู ุฃูุถูุง ุชูุณูู ูุฐู ุงูุทุฑููุฉ ุฅูู ูุฆุชูู ูุงุชุตุงู ุงูุดุจูุฉ ุงููุญุชูู: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุชุตุฑ ูุฌุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุงุชุตุงู ุจูู ุงูุนูููุงุช</a> ุนูู ููุจููุชุฑ ูุงุญุฏ ููุท.  ุฃูุซุฑ ุงููุณุงุฆู ุฅูุชุงุฌูุฉ (ูุณุชูู ููุฎูุถ ุจุดูู ูุดุฑูุท) ุ ูุฎุตุตุฉ ููุฐุง ุงูููุน ูู ุงูุชุจุงุฏู ุ ุชุดูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฐุงูุฑุฉ ุงููุดุชุฑูุฉ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงููููุงุช ุบูุฑ ุงููุณูุงุฉ</a> . </li><li style=";text-align:right;direction:rtl">  ูููู ุงููุตูู ุฅูู ุงูุนูููุงุช ุนุจุฑ ุงูุดุจูุฉ - ูุชู ุชูููุฑ ุฐูู ูู ุฎูุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃูุงุจูุจ ุงููุณูุงุฉ</a> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RPC</a> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DCOM</a> ุ ุฅูุฎ. </li></ul></li><li style=";text-align:right;direction:rtl">  ุชุบููู ููุชุจุฉ ูู ููุชุจุฉ <b>ุงูุงุฑุชุจุงุท ุงูุญููู</b> ( <b>DLL)</b> (ูุดุงุฑ ุฅูููุง ูููุง ุจุนุฏ ุฃุญูุงููุง ุจุงุณู "ุงูููุชุจุฉ ุงูุฏููุงููููุฉ") ุ ุชุนูู ุ ุจุญูู ุชุนุฑูููุง ุ ูู ุฅุทุงุฑ ุนูููุฉ ูุงุญุฏุฉ.  ุนูู ุงูุฑุบู ูู ุฃูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููู ูุถุน</a> ูุงุฆูุงุช COM ูู DLLs ุ ุฅูุง ุฃู ุงูููุงูุฉ ุณุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุทุฑููุฉ ุฃุจุณุท ูุฃูู ุงุณุชููุงูุง ููููุช ุ ูุงูุชู ุชููุฑ ุ ูุน ูู ูุฐุง ุ ููุณ ุงูุฑุงุญุฉ ุนูุฏ ุงุณุชุฏุนุงุก ูุธุงุฆู ุงูููุชุจุฉ. </li><li style=";text-align:right;direction:rtl">  <b>ูููู</b>  ููุง ูู ุงูุญุงู ูู ุงูุญุงูุงุช ุงูุณุงุจูุฉ ุ ูุชู ุชุญุฏูุฏ ูุฏู ููุงุกูุฉ ูุฐุง ุงูููุฌ - ุฅุนุงุฏุฉ ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุฅูู ูุบุฉ ุฃุฎุฑู - ูู ุฎูุงู ุงูุชูุงุฒู ุจูู ุฅูุฌุงุจูุงุชูุง ูุณูุจูุงุชูุง ุ ูููู ูู ุญุงูุฉ ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุงูุฅูุชุฑูุช ุ ูุฅู ุนููุจ ุงูููู ุฃูุจุฑ ุจูุซูุฑ ุ ุฃู: ูุธุฑูุง ููููุฉ ุฑูุฒ ุงูููุชุจุฉ ุงููุจูุฑุฉ ุ ุณุชุญุชุงุฌ ุฅูู ุงูููุงู ุจุจุนุถ ุงูุฃุนูุงู ุงูุฌุงุฏุฉ ููุบุงูุฉ (ุญุชู ูุน ูุฑุงุนุงุฉ ุชุดุงุจู ูุบุงุช ุงูุจุฑูุฌุฉ) ุ ููุฐูู ุจุดูู ุฏูุฑู ุ ูุธุฑูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชุทููุฑ ุงููุบุฉ ุงููุญูููุฉ</a> ุ ุณุชุธูุฑ ูููุฉ ููู ุงูุชุตุญูุญุงุช ูุงูููุฒุงุช ุงูุฌุฏูุฏุฉ ุฅูู ุฏููู. </li></ol><br><h2 style=";text-align:right;direction:rtl">  ุฏูู </h2><br>  ุนูุงูุฉ ุนูู ุฐูู ุ ูู ุฃุฌู ุชุฒููุฏ ุงููุงุฑุฆ ุจูุฑุตุฉ ุงูุดุนูุฑ ุจุงููุฑู ุ ููุงู ุฎูุงุฑุงู ูุชููุฒุงู ุจุฑุงุญุฉ ุงุณุชุฎุฏุงูููุง. <br><br><h3 style=";text-align:right;direction:rtl">  ุชูููุฐ "ููุงุณููู" </h3><br>  ุฏุนููุง ูุญุงูู ุงูุจุฏุก ูู ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุงูุฅูุชุฑูุช ุจุฃุณููุจ ุฅุฌุฑุงุฆู ุชูููู ุทุจูุนุฉ ููุชุจุฉ ุฏููุงููููุฉ ูููููุง ุชุตุฏูุฑ ุงููุธุงุฆู ูุงูุฅุฌุฑุงุกุงุช ููุท ุ  ุณูุฌุนู ุทุฑููุฉ ุงูุงุชุตุงู ุจู DLL ููุงุซูุฉ ูู WinAPI ุ ุนูุฏูุง ูุชู ุทูุจ ููุจุถ ููุฑุฏ ูุนูู ุฃููุงู ุ ูุจุนุฏ ุฐูู ูุชู ุชูููุฐ ุงูุนูู ุงููููุฏ ุ ุซู ูุชู ุชุฏููุฑ ุงูููุจุถ ุงููุงุชุฌ (ูุบูู).  ููุณ ูู ุงูุถุฑูุฑู ุงุนุชุจุงุฑ ูุฐุง ุงูุฎูุงุฑ ููููุฐุฌ ูุญุชุฐู ุจู ูู ูู ุดูุก - ูุชู ุงุฎุชูุงุฑู ููุท ููุชูุถูุญ ูุงูููุงุฑูุฉ ุงููุงุญูุฉ ูุน ุงูุซุงูู - ููู ููุน ูู ุงูุฃูุงุฑุจ ุงูููุฑุงุก. <br><br>  ุณูุจุฏู ุชูููู ูููููุฉ ูููุงุช ุงูุญู ุงูููุชุฑุญ ุนูู ูุฐุง ุงููุญู (ุชุดูุฑ ุงูุฃุณูู ุฅูู ุงูุชุจุนูุงุช): <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/dt/uv/8p/dtuv8pkm7bwa0_rvgnkhxouoc5i.png" alt="ุชูููู ูููุงุช ุงูุชูููุฐ &quot;ุงูููุงุณูููุฉ&quot;" width="600"></div><br><br><h4 style=";text-align:right;direction:rtl">  InternetTools.Types Module </h4><br>  ูุธุฑูุง ูุฃู ุงููุบุชูู - ุฏููู ู Free Pascal - ูุชุดุงุจูุงู ุฌุฏูุง ูู ูุฐู ุงูุญุงูุฉ ุ ููู ุงููุนููู ุฌุฏูุง ุชุฎุตูุต ูุซู ูุฐู ุงููุญุฏุฉ ุงูุดุงุฆุนุฉ ุงูุชู ุชุญุชูู ุนูู ุงูุฃููุงุน ุงููุณุชุฎุฏูุฉ ูู ูุงุฆูุฉ ุชุตุฏูุฑ DLL ุ ุญุชู ูุง ุชูุฑุฑ ุชุนุฑูููุง ูู ุชุทุจูู <code>InternetToolsUsage</code> ุ ูุงูุชู ุชุชุถูู ููุงุฐุฌ ุฃูููุฉ ูููุธุงุฆู ูู ููุชุจุฉ ุฏููุงููููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">unit</span></span> InternetTools.Types; <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> TXQHandle = Integer; <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  ูู ูุฐุง ุงูุชุทุจูู ุ ุชู ุชุญุฏูุฏ ููุน ุฎุฌูู ูุงุญุฏ ููุท ุ ูููู ูู ุงููุณุชูุจู ุ ุณูู "ุชูุถุฌ" ุงููุญุฏุฉ ูุณุชุตุจุญ ูุงุฆุฏุชูุง ูุง ูููู ุฅููุงุฑูุง. <br><br><h4 style=";text-align:right;direction:rtl">  ููุชุจุฉ ุฏููุงููููุฉ ุฃุฏูุงุช ุงูุฅูุชุฑูุช </h4><br>  ูุชู ุชุญุฏูุฏ ุชูููู ุฅุฌุฑุงุกุงุช ููุธุงุฆู ููุชุจุฉ ุงูุงุฑุชุจุงุท ุงูุญููู (DLL) ูุชููู ูู ุญุฏูุง ุงูุฃุฏูู ุ ูููููุง ูุงููุฉ ูุชูููุฐ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููููุฉ</a> ุงููุฐููุฑุฉ ุฃุนูุงู: <br><br><a name="ClassicLibrary"></a><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">library</span></span> InternetTools; <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> InternetTools.Types; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenDocument</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> TXQHandle; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CloseHandle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> TXQHandle; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Count</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle)</span></span></span><span class="hljs-function">:</span></span> Integer; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ValueByIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Index</span></span></span></span><span class="hljs-function"><span class="hljs-params">: Integer)</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> OpenDocument, CloseHandle, Map, Count, ValueByIndex; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  ูุธุฑูุง ููุทุจูุนุฉ ุงูุชุฌุฑูุจูุฉ ููุชุทุจูู ุงูุญุงูู ุ ูุง ูุชู ุฅุนุทุงุก ุงูุดูุฑุฉ ุงููุงููุฉ - ูุงูุฃูู ูู ุฐูู ูู ููููุฉ ุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุฃุจุณุท ูุฐู ูุงุญููุง.  ููุง ูุง ุชุญุชุงุฌ ุฅูู ูุณูุงู ูุชุทูุจุงุช ุณูุงูุฉ ุงูุฎูุท ุ ูุงูุชู ุ ุนูู ุงูุฑุบู ูู ุฃููุง ุณุชุชุทูุจ ุจุนุถ ุงูุฌูุฏ ุ ูููููุง ูู ุชููู ุดูุฆูุง ูุนูุฏูุง. <br><br><h4 style=";text-align:right;direction:rtl">  ุชุทุจูู InternetToolsUsage </h4><br>  ุจูุถู ุงูุงุณุชุนุฏุงุฏุงุช ุงูุณุงุจูุฉ ุ ุฃุตุจุญ ูู ุงููููู ุฅุนุงุฏุฉ ูุชุงุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงู ุงููุงุฆูุฉ</a> ูู ุฏููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">program</span></span> InternetToolsUsage; ... <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> InternetTools.Types; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DLLName = <span class="hljs-string"><span class="hljs-string">'InternetTools.dll'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenDocument</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> TXQHandle; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CloseHandle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> TXQHandle; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Count</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle)</span></span></span><span class="hljs-function">:</span></span> Integer; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ValueByIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Index</span></span></span></span><span class="hljs-function"><span class="hljs-params">: Integer)</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> RootHandle, ListHandle: TXQHandle; I: Integer; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> RootHandle := OpenDocument(ArticleURL); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> ListHandle := Map(RootHandle, ListXPath); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> I := <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> Count(ListHandle) - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln( ValueByIndex(ListHandle, I) ); <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> CloseHandle(ListHandle); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> CloseHandle(RootHandle); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ReadLn; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  ุฅุฐุง ููุช ูุง ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุงูููุงุฐุฌ ุงูุฃูููุฉ ูููุธุงุฆู ูุงูุฅุฌุฑุงุกุงุช ูู ุงูููุชุจุฉ ุงูุฏููุงููููุฉ ุ ููุง ููููู ุงูููู ุฃู ุงูููุฏ ุฃุซูู ุจุดูู ูุงุฑุซู ููุงุฑูุฉ ุจุงูุฅุตุฏุงุฑ ุนูู Free Pascal ุ ูููู ุฅุฐุง ูููุง ุจุชุนููุฏ ุงููููุฉ ููููุงู ูุญุงูู ุชุตููุฉ ุจุนุถ ุงูุนูุงุตุฑ ูุนุฑุถ ุนูุงููู ุงูุงุฑุชุจุงุท ุงูููุฌูุฏุฉ ูู ุงููุชุจูู: <br><br><a name="SecondTask"></a><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> xquery; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; HrefXPath = <span class="hljs-string"><span class="hljs-string">'./a/@href'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ListValue, HrefValue: IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ListValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xqvalue(ArticleURL).retrieve.map(ListXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-comment"><span class="hljs-comment">{   }</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> HrefValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ListValue.map(HrefXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln(HrefValue.toString); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  ูู ุงููููู ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู API API ุงูุญุงูู ุ ูููู ูุนู ุงููุงุชุฌ ูุฑุชูุน ููุบุงูุฉ ุจุงููุนู ุ ููุง ูุง ูููู ุจุดูู ูุจูุฑ ูู ุฅููุงููุฉ ูุฑุงุกุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุญุณุจ ุ ุจู ุฃูุถูุง (ูููุณ ุฃูู ุฃูููุฉ) ูููููุง ุจุนูุฏูุง ุนู ูุง ุณุจู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">program</span></span> InternetToolsUsage; ... <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; HrefXPath = <span class="hljs-string"><span class="hljs-string">'./a/@href'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> RootHandle, ListHandle, HrefHandle: TXQHandle; I, J: Integer; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> RootHandle := OpenDocument(ArticleURL); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> ListHandle := Map(RootHandle, ListXPath); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> I := <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> Count(ListHandle) - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-comment"><span class="hljs-comment">{   }</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> HrefHandle := Map(ListHandle, HrefXPath); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> J := <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> Count(HrefHandle) - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln( ValueByIndex(HrefHandle, J) ); <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> CloseHandle(HrefHandle); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> CloseHandle(ListHandle); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> CloseHandle(RootHandle); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ReadLn; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  ูู ุงููุงุถุญ - ูู ุงูุญุงูุงุช ุงููุงูุนูุฉ ุงูุฃูุซุฑ ุชุนููุฏูุง ุ ุฃู ุญุฌู ุงููุชุงุจุฉ ุณูููู ุจุณุฑุนุฉ ููุท ุ ูุจุงูุชุงูู ุณููุชูู ุฅูู ุญู ุฎุงูู ูู ูุฐู ุงููุดุงูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุชูููุฐ ุงููุงุฌูุฉ </h3><br>  ุฅู ุงูุฃุณููุจ ุงูุฅุฌุฑุงุฆู ููุนูู ูุน ุงูููุชุจุฉ ุ ููุง ูู ููุถุญ ููุชู ุ ูููู ุ ูููู ูู ุนููุจ ูุจูุฑุฉ.  ูุธุฑูุง ูุฃู ููุชุจุฉ ุงูุงุฑุชุจุงุท ุงูุญููู (DLL) ุนูู ูุฐุง ุงููุญู ุชุฏุนู ุงุณุชุฎุฏุงู ุงููุงุฌูุงุช (ูุซู ุฃููุงุน ุงูุจูุงูุงุช ุงููุณุชููุฉ ูุงููุฑุชุฌุนุฉ) ุ ููููู ุชูุธูู ุงูุนูู ูุน InternetTools ุจููุณ ุงูุทุฑููุฉ ุงูููุงุณุจุฉ ุนูุฏ ุงุณุชุฎุฏุงููุง ูุน Free Pascal.  ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุงููุณุชุญุณู ุชุบููุฑ ุชูููู ุงููููุงุช ุจุดูู ุทููู ูู ุฃุฌู ุชูุฒูุน ุงูุฅุนูุงู ูุชูููุฐ ุงููุงุฌูุงุช ูู ูุญุฏุงุช ูููุตูุฉ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ik/48/ki/ik48kioqk2f51pxpdscpsid-auo.png" alt="ุชูููู ูููุงุช ุชูููุฐ ุงููุงุฌูุฉ" width="600"></div><br>  ููุง ูุงู ูู ูุจู ุ ุณูู ููุญุต ูู ููู ุนูู ุงูุชูุงูู. <br><br><h4 style=";text-align:right;direction:rtl">  InternetTools.Types Module </h4><br>  ุชุนูู ูุงุฌูุงุช ููุชู ุชูููุฐูุง ูู DLL: <br><br><a name="InternetTools_Types"></a><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">unit</span></span> InternetTools.Types; <span class="hljs-meta"><span class="hljs-meta">{$IFDEF FPC}</span></span> <span class="hljs-meta"><span class="hljs-meta">{$MODE Delphi}</span></span> <span class="hljs-meta"><span class="hljs-meta">{$ENDIF}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> IXQValue = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>; IXQValueEnumerator = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> [<span class="hljs-string"><span class="hljs-string">'{781B23DC-E8E8-4490-97EE-2332B3736466}'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveNext</span></span></span><span class="hljs-function">:</span></span> Boolean; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCurrent</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> Current: IXQValue <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> GetCurrent; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; IXQValue = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> [<span class="hljs-string"><span class="hljs-string">'{DCE33144-A75F-4C53-8D25-6D9BD78B91E4}'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetEnumerator</span></span></span><span class="hljs-function">:</span></span> IXQValueEnumerator; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenURL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  ุชูุฌููุงุช ุงูุชุฌููุน ุงูุดุฑุทู ุถุฑูุฑูุฉ ุจุณุจุจ ุงุณุชุฎุฏุงู ุงููุญุฏุฉ ุฏูู ุชุบููุฑ ูู ูู ูู ูุดุงุฑูุน ุฏููู ู FPC. <br><br>  ูุงุฌูุฉ <code>IXQValueEnumerator</code> ุงุฎุชูุงุฑูุฉ ูู ุญูุซ ุงููุจุฏุฃ ุ ููุน ุฐูู ุ ูู ุฃุฌู ุฃู ุชููู ูุงุฏุฑูุง ุนูู ุงุณุชุฎุฏุงู ุญููุงุช ุงููููุฐุฌ " <code>for ... in ...</code> " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุซุงู</a> ุ ูุง ููููู ุงูุงุณุชุบูุงุก ุนููุง ุ  ุงููุงุฌูุฉ ุงูุซุงููุฉ ูู ุงููุงุฌูุฉ ุงูุฑุฆูุณูุฉ ููู ุนุจุงุฑุฉ ุนู ุบูุงู ุชูุซููู ุนุจุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>IXQValue</code></a> ูู InternetTools (ุชู ุฅูุดุงุคู ุฎุตูุตูุง ุจุงูุงุณู ููุณู ูุชุณููู ุฑุจุท ุฑูุฒ ุฏููู ุงููุณุชูุจูู ุจูุซุงุฆู ุงูููุชุจุฉ ุนูู Free Pascal).  ุฅุฐุง ุฃุฎุฐูุง ูู ุงูุงุนุชุจุงุฑ ุงููุญุฏุฉ ูู ุญูุซ ุฃููุงุท ุงูุชุตููู ุ ูุฅู ุงููุงุฌูุงุช ุงููุนููุฉ ูููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญููุงุช</a> ุ ูุฅู ูุงูุช ูุน ููุฒุฉ ุตุบูุฑุฉ - ููุน ุชูููุฐูุง ูู ููุชุจุฉ ุฏููุงููููุฉ. <br><br>  ุชู ูุตู ุงูุญุงุฌุฉ ุฅูู ุชุนููู ููุน ููุงููุฉ <code>safecall</code> ูุฌููุน ุงูุทุฑู ุฌูุฏูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> .  ูู ูุชู ุฅุซุจุงุช ุงูุงูุชุฒุงู ุจุงุณุชุฎุฏุงู <code>WideString</code> ุจุฏูุงู ูู ุงูุณูุงุณู "ุงูุฃุตููุฉ" ุฃูุถูุง ุ ูุธุฑูุง ูุฃู ููุถูุน ุชุจุงุฏู ููุงูู ุงูุจูุงูุงุช ุงูุฏููุงููููุฉ ูุน DLLs ูุชุฌุงูุฒ ูุทุงู ูุฐู ุงูููุงูุฉ. <br><br><h4 style=";text-align:right;direction:rtl">  InternetTools.Realization Module </h4><br>  ุงูุฃูู ูู ุญูุซ ุงูุฃูููุฉ ูุงูุญุฌู - ูู ุ ููุง ูู ููุถุญ ูู ุงูุนููุงู ุ ุณูุญุชูู ุนูู ุชูููุฐ ุงููุงุฌูุงุช ูู ุงููุงุฌูุฉ ุงูุณุงุจูุฉ: ุจุงููุณุจุฉ ููู ููููุง ุ ูุชู <code>TXQValue</code> ููุท ุนู ูุฆุฉ <code>TXQValue</code> ุ ูุงูุทุฑู ุงูุชู ุชููู ุจุณูุทุฉ ููุบุงูุฉ ุจุญูุซ ุชุชููู ุฌููุนูุง ุชูุฑูุจูุง ูู ุณุทุฑ ูุงุญุฏ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ (ูุฐุง ุชูุงููุง ูุชููุน ุ ูุฃู ุฌููุน ุงููุธุงุฆู ุงูุถุฑูุฑูุฉ ููุฌูุฏุฉ ุจุงููุนู ูู ุงูููุชุจุฉ - ููุง ุชุญุชุงุฌ ููุท ูููุตูู ุฅูููุง): <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">unit</span></span> InternetTools.Realization; <span class="hljs-meta"><span class="hljs-meta">{$MODE Delphi}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> xquery, InternetTools.Types; <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> IOriginalXQValue = xquery.IXQValue; <span class="hljs-title"><span class="hljs-title">TXQValue</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TInterfacedObject, IXQValue, IXQValueEnumerator) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> FOriginalXQValue: IOriginalXQValue; FEnumerator: TXQValueEnumerator; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveNext</span></span></span><span class="hljs-function">:</span></span> Boolean; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCurrent</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetEnumerator</span></span></span><span class="hljs-function">:</span></span> IXQValueEnumerator; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenURL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">reintroduce</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constructor</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> OriginalXQValue: IOriginalXQValue)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">overload</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SafeCallException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ExceptObject: TObject; ExceptAddr: CodePointer)</span></span></span><span class="hljs-function">:</span></span> HResult; <span class="hljs-keyword"><span class="hljs-keyword">override</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> sysutils, comobj, w32internetaccess; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveNext</span></span></span><span class="hljs-function">:</span></span> Boolean; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := FEnumerator.MoveNext; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCurrent</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := TXQValue.Create(FEnumerator.Current); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetEnumerator</span></span></span><span class="hljs-function">:</span></span> IXQValueEnumerator; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> FEnumerator := FOriginalXQValue.GetEnumerator; Result := Self; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenURL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> FOriginalXQValue := xqvalue(URL).retrieve; Result := Self; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := TXQValue.Create( FOriginalXQValue.map(XQuery) ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := FOriginalXQValue.toJoinedString(LineEnding); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constructor</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> OriginalXQValue: IOriginalXQValue)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> FOriginalXQValue := OriginalXQValue; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SafeCallException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ExceptObject: TObject; ExceptAddr: CodePointer)</span></span></span><span class="hljs-function">:</span></span> HResult; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := HandleSafeCallException(ExceptObject, ExceptAddr, GUID_NULL, ExceptObject.ClassName, <span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  ูุฌุฏุฑ ุงูุชููู ุนูุฏ ุทุฑููุฉ <code>SafeCallException</code> - ุฅู ุญุธุฑูุง ุ ุฅูู ุญุฏ ูุจูุฑ ุ ููุณ ุญููููุง ( <code>TXQValue</code> ูุชุฃุซุฑ ุฃุฏุงุก <code>TXQValue</code> ุจุฏูููุง) ุ ููุน ุฐูู ุ ูุฅู ุงูุฑูุฒ ุงููุนุทู ููุง ูุณูุญ ุจุชูุฑูุฑ ูุต ุงูุงุณุชุซูุงุก ุฅูู ุฌุงูุจ ุฏููู ุงูุฐู ุณูุญุฏุซ ูู ุทุฑู ุงูุฃูุงู (ุงูุชูุงุตูู ุ ูุฑุฉ ุฃุฎุฑู ุ ูููู ุงูุนุซูุฑ ุนูููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงู</a> ุญุฏูุซ). <br><br>  ูุฐุง ุงูุญู ุ ุจุงูุฅุถุงูุฉ ุฅูู ูู ุดูุก ุขุฎุฑ ุ ุขูู ููุคุดุฑ ุงูุชุฑุงุจุท - ุจุดุฑุท ุฃูุง ูุชู ุฅุฑุณุงู <code>IXQValue</code> ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ุฎูุงู <code>OpenURL</code> ุ ุจูู <code>IXQValue</code> .  ููุฑุฌุน ุฐูู ุฅูู ุญูููุฉ ุฃู ุชูููุฐ ุงููุงุฌูุฉ ูุนูุฏ ุชูุฌูู ุงูููุงููุงุช ููุท ุฅูู InternetTools ุงูุขููุฉ ุจุงููุนู. <br><br><h4 style=";text-align:right;direction:rtl">  ููุชุจุฉ ุฏููุงููููุฉ ุฃุฏูุงุช ุงูุฅูุชุฑูุช </h4><br>  ูุธุฑูุง ููุนูู ุงูููุฌุฒ ูู ุงููุญุฏุงุช ุฃุนูุงู ุ ูููู ุฃู ุชููู ููุชุจุฉ ุงูุงุฑุชุจุงุท ุงูุฏููุงูููู ุจุชุตุฏูุฑ ูุธููุฉ ูุงุญุฏุฉ (ููุงุฑูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุงูุฎูุงุฑ</a> ุญูุซ ุชู ุงุณุชุฎุฏุงู ุงูููุท ุงูุฅุฌุฑุงุฆู): <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">library</span></span> InternetTools; <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> InternetTools.Types, InternetTools.Realization; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetXQValue</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := TXQValue.Create; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> GetXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> SetMultiByteConversionCodePage(CP_UTF8); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  ุชู ุชุตููู ุงุณุชุฏุนุงุก ุงูุฅุฌุฑุงุก <code>SetMultiByteConversionCodePage</code> ููุนูู ูุน ุณูุงุณู Unicode ุจุดูู ุตุญูุญ. <br><br><h4 style=";text-align:right;direction:rtl">  ุชุทุจูู InternetToolsUsage </h4><br>  ุฅุฐุง ูููุง ุงูุขู ุจุฅุถูุงุก ุงูุทุงุจุน ุงูุฑุณูู ุนูู ุญู ุฏููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุซุงู ุงูุฃููู</a> ุนูู ุฃุณุงุณ ุงููุงุฌูุงุช ุงูููุชุฑุญุฉ ุ ููู ูุฎุชูู ุฐูู ุนู ุฐูู ุนูู Free Pascal ุ ููุง ูุนูู ุฃูู ูููู ุงุนุชุจุงุฑ ุงููููุฉ ุงููุญุฏุฏุฉ ูู ุจุฏุงูุฉ ุงูููุงูุฉ ููุชููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">program</span></span> InternetToolsUsage; ... <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> System.Win.ComObj, InternetTools.Types; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DLLName = <span class="hljs-string"><span class="hljs-string">'InternetTools.dll'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetXQValue</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ListValue: IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ListValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> GetXQValue.OpenURL(ArticleURL).Map(ListXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln(ListValue.ToString); ReadLn; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  ูุง ูุชู ุชูุตูู ุงููุญุฏุฉ ุงูููุทูุฉ <code>System.Win.ComObj</code> ุทุฑูู ุงูุฎุทุฃ - ุจุฏูููุง ุ ุณูุตุจุญ ูุต ุฌููุน ุงุณุชุซูุงุกุงุช safecall "ุงุณุชุซูุงุก ูู ุทุฑููุฉ safecall" ุจุฏูู ูุฌู ุ ููุนู ุงููููุฉ ุงูุฃุตููุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ูู DLL. <br><br>  ูุจุงููุซู ุ ูุฅู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงู ุงููุนูุฏ</a> ููููุงู ูุญุชูู ุนูู ุงุฎุชูุงูุงุช ุทูููุฉ ูู ุฏููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs">... <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; HrefXPath = <span class="hljs-string"><span class="hljs-string">'./a/@href'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ListValue, HrefValue: IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ListValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> GetXQValue.OpenURL(ArticleURL).Map(ListXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-comment"><span class="hljs-comment">{   }</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> HrefValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ListValue.Map(HrefXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln(HrefValue.ToString); ReadLn; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br><h4 style=";text-align:right;direction:rtl">  ุงููุธุงุฆู ุงููุชุจููุฉ ููููุชุจุฉ </h4><br>  ุฅุฐุง ูุธุฑุช ุฅูู ุงูุฅููุงูุงุช ุงููุงููุฉ ููุงุฌูุฉ <a href="">IXQValue</a> ูู InternetTools ุ ูุณุชุฑู ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุงุฌูุฉ ุงูููุงุจูุฉ</a> ูู <code>InternetTools.Types</code> ุชุญุฏุฏ ุทุฑููุชูู ููุท ( <code>Map</code> ู <code>ToString</code> ) ูู ุงููุฌููุนุฉ ุงูุบููุฉ ุจุงููุงูู ุ  ุฅุถุงูุฉ ุงูุจุงูู ุงูุฐู ูุนุชุจุฑู ุงููุงุฑุฆ ุถุฑูุฑููุง ูู ุญุงูุชู ุงูุฎุงุตุฉ ูุชู ุจููุณ ุงูุทุฑููุฉ ุชูุงููุง ูุจุจุณุงุทุฉ: ุชุชู ูุชุงุจุฉ ุงูุทุฑู ุงูุถุฑูุฑูุฉ ูู <code>InternetTools.Types</code> ุ ูุจุนุฏ ุฐูู ูุชู ุฅูุดุงุคูุง ูู ูุญุฏุฉ <code>InternetTools.Realization</code> ูุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ (ุบุงูุจูุง ูุฎุท ูุงุญุฏ). <br><br>  ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ุงุณุชุฎุฏุงู ูุธููุฉ ูุฎุชููุฉ ููููุงู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฏุงุฑุฉ ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ุ ูุฅู ุชุณูุณู ุงูุฎุทูุงุช ูุดุงุจู ุฌุฏูุง: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชู <code>InternetTools.Types</code> ูุงุฌูุฉ ุฌุฏูุฏุฉ ูู <code>InternetTools.Types</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs">... ICookies = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> [<span class="hljs-string"><span class="hljs-string">'{21D0CC9A-204D-44D2-AF00-98E9E04412CD}'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Value: WideString)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ...</code> </pre> </li><li style=";text-align:right;direction:rtl">  ุซู ูุชู ุชูููุฐู ูู ูุญุฏุฉ <code>InternetTools.Realization</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs">... <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-title"><span class="hljs-title">TCookies</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TInterfacedObject, ICookies) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Value: WideString)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SafeCallException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ExceptObject: TObject; ExceptAddr: CodePointer)</span></span></span><span class="hljs-function">:</span></span> HResult; <span class="hljs-keyword"><span class="hljs-keyword">override</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ... <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> ..., internetaccess; ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TCookies</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Value: WideString)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> defaultInternet.cookies.setCookie( decodeURL(URL).host, decodeURL(URL).path, <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, Value, [] ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TCookies</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> defaultInternet.cookies.clear; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ...</code> </pre> </li><li style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ูุชู ุฅุฑุฌุงุน ูุธููุฉ ุฌุฏูุฏุฉ ุชู ุชุตุฏูุฑูุง ุฅูู ููุชุจุฉ ุงูุงุฑุชุจุงุท ุงูุญููู (DLL) ุงูุชู ุชุฑุฌุน ูุฐู ุงููุงุฌูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs">... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCookies</span></span></span><span class="hljs-function">:</span></span> ICookies; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := TCookies.Create; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> ..., GetCookies; ...</code> </pre> </li></ol><br><h4 style=";text-align:right;direction:rtl">  ุงูุฅูุฑุงุฌ ุนู ุงูููุงุฑุฏ </h4><br>  ุนูู ุงูุฑุบู ูู ุฃู ููุชุจุฉ InternetTools ุชุณุชูุฏ ุฅูู ูุงุฌูุงุช ุชุชุญูู ุชููุงุฆููุง ูู ุงูุนูุฑ ุ ุฅูุง ุฃู ููุงู ูุงุฑููุง ูุงุญุฏูุง ุบูุฑ ูุงุถุญ ูุฏ ูุคุฏู ุฅูู ุชุณุฑุจ ุงูุฐุงูุฑุฉ - ุฅุฐุง ููุช ุจุชุดุบูู ุชุทุจูู ูุญุฏุฉ ุงูุชุญูู ุงูุชุงูู (ุชู ุฅูุดุงุคู ุนูู ุฏููู ุ ููู ูุชุบูุฑ ุดูุก ูู ุญุงูุฉ FPC) ุ ุซู ูู ูู ูุฑุฉ ุชุถุบุท ูููุง ุนูู ููุชุงุญ ุงูุฅุฏุฎุงู ุ ุณุชููู ุงูุฐุงูุฑุฉ ุงูุชู ุชุณุชููููุง ุงูุนูููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs">... <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; TitleXPath = <span class="hljs-string"><span class="hljs-string">'//head/title'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> I: Integer; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> I := <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Writeln( GetXQValue.OpenURL(ArticleURL).Map(TitleXPath).ToString ); Readln; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุงุณุชุฎุฏุงู ุงููุงุฌูุงุช ููุง.  ุชููู ุงููุดููุฉ ูู ุฃู InternetTools ูุง ุชุทูู ููุงุฑุฏูุง ุงูุฏุงุฎููุฉ ุงููุฎุตุตุฉ ุฃุซูุงุก ุชุญููู ุงููุณุชูุฏ (ูู ุทุฑููุฉ <code>OpenURL</code> ) - ูุฌุจ ุฃู ูุชู ุฐูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุดูู ุตุฑูุญ</a> ุจุนุฏ ุงูุงูุชูุงุก ูู ุงูุนูู ูุนู ุ  ููุฐู ุงูุฃุบุฑุงุถ ุ ุชููุฑ ูุญุฏุฉ ููุชุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>freeThreadVars</code></a> ุฅุฌุฑุงุก <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>freeThreadVars</code></a> ุ ูุงูุฐู ูููู ุถูุงู ุงุณุชุฏุนุงุฆู ูู ุชุทุจูู ุฏููู ุจุดูู ููุทูู ูู ุฎูุงู ุชูุณูุน ูุงุฆูุฉ ุชุตุฏูุฑ DLL: <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs">... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FreeResources</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> freeThreadVars; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> ..., FreeResources; ...</code> </pre> <br>  ุจุนุฏ ุงุณุชุฎุฏุงูู ุ ุณูุชููู ููุฏุงู ุงูููุงุฑุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> I := <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Writeln( GetXQValue.OpenURL(ArticleURL).Map(TitleXPath).ToString ); FreeResources; Readln; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre> <br>  ูู ุงูููู ุฃู ูููู ูุง ููู - ูุคุฏู ุงุณุชุฏุนุงุก <code>FreeResources</code> ุฅูู ุญูููุฉ ุฃู ุฌููุน ุงููุงุฌูุงุช ุงูุชู ุชู ุชููููุง ุณุงุจููุง ุชุตุจุญ ุจูุง ูุนูู ูุฃู ุฃู ูุญุงููุงุช ูุงุณุชุฎุฏุงููุง ุบูุฑ ููุจููุฉ. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar415617/">https://habr.com/ru/post/ar415617/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar415601/index.html">ูุฌููุนุฉ Kubernetes HA ูุน ุงูุญุงููุฉ. ุฃู ุฃู ููุงู ุญูุงุฉ ุจุฏูู ุนุงูู ูููุงุกุ</a></li>
<li><a href="../ar415605/index.html">ููู ุญูุธูุง ูุนุงูุฌุฉ ุงูุจุทุงูุฉ ุจุงุณุชุฎุฏุงู Exadata</a></li>
<li><a href="../ar415611/index.html">PKI: ููุชุจุงุช GCrypt ู KSBA ูุจุฏูู ูู OpenSSL ูุน ุฏุนู ุงูุชุดููุฑ ุงูุฑูุณู. ุงุณุชูุฑุงุฑ</a></li>
<li><a href="../ar415613/index.html">ููุงุฐุง ูุง ุชุดุชุฑู ุซุฑูุงุช LED</a></li>
<li><a href="../ar415615/index.html">ุงูุชูุงุนู ูุน ุงูุฎุงุฏู ูู ุฎูุงู API ูู iOS ุนูู Swift 3. Part 2</a></li>
<li><a href="../ar415619/index.html">Apple ู Samsung ุชูููุงู ุญุฑุจ ุจุฑุงุกุงุช ุงูุงุฎุชุฑุงุน ููุฏุฉ 7 ุณููุงุช</a></li>
<li><a href="../ar415621/index.html">ูุธุงู ูุฑุงูุจุฉ ุงูุชุนุฏูู</a></li>
<li><a href="../ar415623/index.html">ุฏููุงููุงุช ุงูุทูุฑุงู ุงูุนููุฏู ููุทุงุฆุฑุฉ ุฃุฎู ูู ุงูููุงุก</a></li>
<li><a href="../ar415625/index.html">Kubernetes: ูุฏูุฉ ุนุจุฑ ุงูุฅูุชุฑูุช (4 ููููู ูู ุงูุณุงุนุฉ 19:30) ูููุซูุฉ (3-5 ุฃุบุณุทุณ)</a></li>
<li><a href="../ar415627/index.html">ููู (ูุง) ูุฌุจ ุฃู ุชููู ุฃุญูููุง: ูุตุฉ ูุฏูุฑ ููู ูุงุญุฏ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>