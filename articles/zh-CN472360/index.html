<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸš‹ ğŸ‘‹ âœ‹ æ‰«æOrchard CMSçš„ä»£ç ä»¥æŸ¥æ‰¾é”™è¯¯ ğŸ¹ ğŸ¦” ğŸ‘¨ğŸ¾â€ğŸ¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ¬æ–‡å›é¡¾äº†ä½¿ç”¨PVS-Studioé™æ€åˆ†æå™¨å¯¹Orchardé¡¹ç›®è¿›è¡Œç¬¬äºŒæ¬¡æ£€æŸ¥çš„ç»“æœã€‚ Orchardæ˜¯ä¸€ä¸ªå¼€æºå†…å®¹ç®¡ç†å™¨ç³»ç»Ÿï¼Œä½œä¸ºéè¥åˆ©ç»„ç»‡Outercurve Foundationçš„ASP.NET Open Source Galleryçš„ä¸€éƒ¨åˆ†æä¾›ã€‚ ä»Šå¤©çš„æ£€æŸ¥ç‰¹åˆ«æœ‰è¶£ï¼Œå› ä¸ºè‡ªç¬¬ä¸€æ¬¡æ£€æŸ¥ä»¥æ¥ï¼Œé¡¹...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æ‰«æOrchard CMSçš„ä»£ç ä»¥æŸ¥æ‰¾é”™è¯¯</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/472360/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ef5/c02/394/ef5c023947badf157fb4c97b6562ab91.png" alt="å›¾ç‰‡6"></div><br> æœ¬æ–‡å›é¡¾äº†ä½¿ç”¨PVS-Studioé™æ€åˆ†æå™¨å¯¹Orchardé¡¹ç›®è¿›è¡Œç¬¬äºŒæ¬¡æ£€æŸ¥çš„ç»“æœã€‚  Orchardæ˜¯ä¸€ä¸ªå¼€æºå†…å®¹ç®¡ç†å™¨ç³»ç»Ÿï¼Œä½œä¸ºéè¥åˆ©ç»„ç»‡Outercurve Foundationçš„ASP.NET Open Source Galleryçš„ä¸€éƒ¨åˆ†æä¾›ã€‚ ä»Šå¤©çš„æ£€æŸ¥ç‰¹åˆ«æœ‰è¶£ï¼Œå› ä¸ºè‡ªç¬¬ä¸€æ¬¡æ£€æŸ¥ä»¥æ¥ï¼Œé¡¹ç›®å’Œåˆ†æå™¨éƒ½å·²ç»èµ°äº†å¾ˆé•¿ä¸€æ®µè·¯ï¼Œè¿™æ¬¡æˆ‘ä»¬å°†æŸ¥çœ‹æ–°çš„è¯Šæ–­æ¶ˆæ¯å’Œä¸€äº›ä¸é”™çš„é”™è¯¯ã€‚ <br><a name="habracut"></a><br>  <b>å…³äºæœå›­CMS</b> <br><br> æˆ‘ä»¬ä¸‰å¹´å‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ£€æŸ¥è¿‡</a>æœå›­ã€‚ ä»é‚£æ—¶èµ·ï¼ŒPVS-Studioçš„Cï¼ƒåˆ†æå™¨å¾—åˆ°äº†é•¿è¶³çš„å‘å±•ï¼šæˆ‘ä»¬æ”¹è¿›äº†æ•°æ®æµåˆ†æï¼Œå¢åŠ äº†è¿‡ç¨‹é—´åˆ†æå’Œæ–°çš„è¯Šæ–­æ–¹æ³•ï¼Œå¹¶ä¿®å¤äº†ä¸€äº›è¯¯æŠ¥ã€‚ ä¸ä»…å¦‚æ­¤ï¼Œç¬¬äºŒæ¬¡æ£€æŸ¥è¿˜æ˜¾ç¤ºOrchardçš„å¼€å‘äººå‘˜å·²ä¿®å¤äº†ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­æŠ¥å‘Šçš„æ‰€æœ‰é”™è¯¯ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å·²ç»å®ç°äº†æˆ‘ä»¬çš„ç›®æ ‡ï¼Œå³è®©ä»–ä»¬æ”¹è¿›äº†ä»–ä»¬çš„ä»£ç ã€‚ <br><br> æˆ‘å¸Œæœ›ä»–ä»¬ä¹Ÿæ³¨æ„æœ¬æ–‡ï¼Œå¹¶è¿›è¡Œå¿…è¦çš„ä¿®å¤ï¼Œæˆ–è€…æ›´å¥½çš„æ˜¯ï¼Œå®šæœŸé‡‡ç”¨PVS-Studioã€‚ æé†’ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¼€æº</a>å¼€å‘äººå‘˜æä¾›äº†å…è´¹è®¸å¯è¯ã€‚ é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œä¸“æœ‰é¡¹ç›®è¿˜æœ‰å…¶ä»–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é€‰æ‹©</a> ã€‚ <br><br>  Orchardçš„æºä»£ç å¯åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a>ä¸‹è½½ã€‚ å®Œæ•´çš„é¡¹ç›®æè¿°å¯åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a>æ‰¾åˆ°ã€‚ å¦‚æœæ‚¨è¿˜æ²¡æœ‰PVS-Studioå‰¯æœ¬ï¼Œåˆ™å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸‹è½½</a>è¯•ç”¨ç‰ˆã€‚ æˆ‘ä½¿ç”¨äº†PVS-Studio 7.05 Betaï¼Œå¹¶å°†åœ¨æœ¬æ–‡ä¸­åŒ…å«ä¸€äº›è­¦å‘Šã€‚ æˆ‘å¸Œæœ›è¿™ç¯‡è¯„è®ºèƒ½ä½¿æ‚¨ç›¸ä¿¡PVS-Studioæ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å·¥å…·ã€‚ è¯·è®°ä½ï¼Œå®ƒåº”è¯¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®šæœŸ</a>ä½¿ç”¨ã€‚ <br><br>  <b>åˆ†æç»“æœ</b> <br><br> ä»¥ä¸‹æ˜¯ä»Orchardçš„ç¬¬ä¸€æ¬¡æ£€æŸ¥ä¸­è·å¾—çš„ä¸€äº›æ•°æ®ï¼Œå› æ­¤æ‚¨ä¸å¿…åœ¨ä¸¤ç¯‡æ–‡ç« ä¹‹é—´è¿›è¡Œåˆ‡æ¢å³å¯è¿›è¡Œæ¯”è¾ƒã€‚ <br><br> åœ¨ä¸Šä¸€æ¬¡æ£€æŸ¥ä¸­ï¼Œâ€œæˆ‘ä»¬å¯¹æ‰€æœ‰æ‰©å±•åä¸º.csçš„æºä»£ç æ–‡ä»¶ï¼ˆ3739ä¸ªé¡¹ç›®ï¼‰è¿›è¡Œäº†åˆ†æã€‚ æ€»å…±æœ‰214,564è¡Œä»£ç ã€‚ æ£€æŸ¥çš„ç»“æœä¸º137è­¦å‘Šã€‚ æ›´å‡†ç¡®åœ°è¯´ï¼Œæœ‰39ä¸ªç¬¬ä¸€ï¼ˆé«˜çº§ï¼‰è­¦å‘Šã€‚ ä¹Ÿæœ‰60ç§’ï¼ˆä¸­ï¼‰çº§åˆ«çš„è­¦å‘Šã€‚â€ <br><br> å½“å‰ç‰ˆæœ¬çš„Orchardç”±2767ä¸ª.csæ–‡ä»¶ç»„æˆï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥æ–‡ä»¶è¦å°1000ä¸ªå·¦å³ã€‚ å­˜å‚¨åº“çš„ç¼©å°å’Œé‡å‘½åè¡¨æ˜å¼€å‘äººå‘˜å·²ç»éš”ç¦»äº†é¡¹ç›®çš„æ ¸å¿ƒï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æäº¤966</a> ï¼‰ï¼Œè¯¥æ ¸å¿ƒçš„é•¿åº¦ä¸º108287 LOCã€‚ åˆ†æä»ªå‘å‡ºäº†153æ¡è­¦å‘Šï¼š33æ¡ç¬¬ä¸€çº§è­¦å‘Šå’Œ70æ¡ç¬¬äºŒçº§è­¦å‘Šã€‚ æˆ‘ä»¬é€šå¸¸ä¸åŒ…å«ä¸‰çº§è­¦å‘Šï¼Œè€Œæˆ‘å°†åšæŒè¿™ä¸€ä¼ ç»Ÿã€‚ <br><br>  <b>PVS-Studioè¯Šæ–­æ¶ˆæ¯ï¼š</b> V3110'TryValidateModel'æ–¹æ³•å†…å¯èƒ½æ— é™é€’å½’ã€‚  PrefixedModuleUpdater.cs 48 <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TryValidateModel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> model, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> prefix</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> TryValidateModel(model, Prefix(prefix)); }</code> </pre> <br> è®©æˆ‘ä»¬ä»æ— é™é€’å½’é”™è¯¯å¼€å§‹ï¼Œå°±åƒæˆ‘ä»¬åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­æ‰€åšçš„é‚£æ ·ã€‚ è¿™æ¬¡å¼€å‘äººå‘˜çš„ç¡®åˆ‡æ„å›¾å°šä¸æ¸…æ¥šï¼Œä½†æ˜¯æˆ‘æ³¨æ„åˆ°<i>TryValidateModel</i>æ–¹æ³•å…·æœ‰ä¸€ä¸ªå¸¦æœ‰ä¸€ä¸ªå‚æ•°çš„é‡è½½ç‰ˆæœ¬ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TryValidateModel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> model</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _updateModel.TryValidateModel(model); }</code> </pre> <br> æˆ‘è®¤ä¸ºï¼Œå°±åƒåœ¨é‡è½½ç‰ˆæœ¬çš„æƒ…å†µä¸‹ä¸€æ ·ï¼Œå¼€å‘äººå‘˜æ‰“ç®—é€šè¿‡<i>_updateModel</i>è°ƒç”¨è¯¥æ–¹æ³•<i>ã€‚</i> ç¼–è¯‘å™¨æ²¡æœ‰æ³¨æ„åˆ°é”™è¯¯ã€‚  <i>_updateModel</i>çš„ç±»å‹ä¸º<i>IUpdateModel</i> ï¼Œå½“å‰ç±»ä¹Ÿå®ç°æ­¤æ¥å£ã€‚ ç”±äºè¯¥æ–¹æ³•ä¸åŒ…å«å¯¹<i>StackOverflowExceptionçš„</i>ä»»ä½•æ£€æŸ¥ï¼Œå› æ­¤å¯èƒ½æ°¸è¿œéƒ½ä¸ä¼šè°ƒç”¨å®ƒï¼Œå°½ç®¡æˆ‘ä¸ä¼šæŒ‡æœ›å®ƒã€‚ å¦‚æœæˆ‘çš„å‡è®¾æ˜¯æ­£ç¡®çš„ï¼Œåˆ™å›ºå®šç‰ˆæœ¬åº”å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TryValidateModel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> model, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> prefix</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _updateModel.TryValidateModel(model, Prefix(prefix)); }</code> </pre> <br>  <b>PVS-Studioè¯Šæ–­æ¶ˆæ¯ï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3008ä¸º</a> â€œå†…å®¹â€å˜é‡è¿ç»­ä¸¤æ¬¡åˆ†é…å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š197ã€190ã€‚DynamicCacheTagHelper.cs 197 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProcessAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... IHtmlContent content; .... <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { content = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> output.GetChildContentAsync(); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { _cacheScopeManager.ExitScope(); } content = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> ProcessContentAsync(output, cacheContext); .... }</code> </pre> <br> åˆ†æå™¨æ£€æµ‹åˆ°ä¸¤ä¸ªå¯¹å±€éƒ¨å˜é‡<i>å†…å®¹çš„</i>åˆ†é…<i>ã€‚</i>  <i>GetChildContentAsync</i>æ˜¯ä¸€ç§å›¾ä¹¦é¦†æ–¹æ³•ï¼Œå¾ˆå°‘ä½¿ç”¨ï¼Œæˆ‘ä»¬éš¾ä»¥æ£€æŸ¥å’Œæ³¨é‡Šå®ƒã€‚ å› æ­¤ï¼Œææ€•æˆ‘ä»¬å’Œåˆ†æäººå‘˜éƒ½ä¸äº†è§£è¯¥æ–¹æ³•çš„è¿”å›å¯¹è±¡å’Œå‰¯ä½œç”¨ã€‚ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œå¦‚æœæœªåœ¨ä»£ç ä¸­è¿›ä¸€æ­¥ä½¿ç”¨è¿”å›å€¼ï¼Œåˆ™å°†è¿”å›å€¼åˆ†é…ç»™<i>å†…å®¹</i>æ¯«æ— æ„ä¹‰ã€‚ ä¹Ÿè®¸è¿™åªæ˜¯å¤šä½™çš„æ“ä½œï¼Œè€Œä¸æ˜¯é”™è¯¯ã€‚ æˆ‘ä¸èƒ½è¯´åº”è¯¥å¦‚ä½•ç¡®åˆ‡åœ°è§£å†³å®ƒï¼Œæ‰€ä»¥æˆ‘å°†å…¶ç•™ç»™å¼€å‘äººå‘˜ã€‚ <br><br>  <b>PVS-Studioè¯Šæ–­æ¶ˆæ¯ï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a>å¯èƒ½ä¸ºç©ºçš„å–æ¶ˆå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥â€œ itemTagâ€ã€‚  CoreShapes.cs 92 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;IHtmlContent&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">List</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ItemTag....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> itemTagName = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ItemTag != <span class="hljs-string"><span class="hljs-string">"-"</span></span>) { itemTagName = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(ItemTag) ? <span class="hljs-string"><span class="hljs-string">"li"</span></span> : ItemTag; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> index = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> items) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> itemTag = String.IsNullOrEmpty(itemTagName) ? <span class="hljs-literal"><span class="hljs-literal">null</span></span> : ....; .... itemTag.InnerHtml.AppendHtml(itemContent); listTag.InnerHtml.AppendHtml(itemTag); ++index; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> listTag; }</code> </pre> <br> åˆ†æå™¨æ£€æµ‹åˆ°å¯¹<i>itemTag</i>çš„ä¸å®‰å…¨å–æ¶ˆå¼•ç”¨ã€‚ æ­¤ä»£ç æ®µå¾ˆå¥½åœ°è¯´æ˜äº†é™æ€åˆ†æå·¥å…·ä¸è¿›è¡Œä»£ç å®¡æŸ¥çš„äººå·¥å¼€å‘äººå‘˜æœ‰ä½•ä¸åŒã€‚ è¯¥æ–¹æ³•å…·æœ‰ä¸€ä¸ªåä¸º<i>ItemTag</i>çš„å‚æ•°å’Œä¸€ä¸ªåä¸º<i>itemTag</i>çš„å±€éƒ¨å˜é‡ã€‚ æ— éœ€å‘Šè¯‰æ‚¨ï¼Œå®ƒå¯¹ç¼–è¯‘å™¨æœ‰å¾ˆå¤§çš„å½±å“ï¼ è¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„ï¼ˆå°½ç®¡ç›¸å…³ï¼‰å˜é‡ã€‚ å®ƒä»¬çš„å…³è”æ–¹å¼æ˜¯é€šè¿‡ç¬¬ä¸‰ä¸ªå˜é‡<i>itemTagNameã€‚</i> è¿™æ˜¯å¯¼è‡´å¯èƒ½çš„å¼‚å¸¸çš„æ­¥éª¤åºåˆ—ï¼šå¦‚æœ<i>ItemTag</i>å‚æ•°ç­‰äºâ€œ-â€ï¼Œåˆ™æ²¡æœ‰å°†ä»»ä½•å€¼åˆ†é…ç»™<i>itemTagName</i> ï¼Œå› æ­¤å®ƒå°†ä¿æŒä¸ºç©ºå¼•ç”¨ï¼Œå¦‚æœä¸ºç©ºå¼•ç”¨ï¼Œåˆ™ä½¿ç”¨å±€éƒ¨å˜é‡<i>itemTag</i>ä¹Ÿä¼šå˜æˆç©ºå¼•ç”¨ã€‚ æˆ‘è®¤ä¸ºï¼Œæœ€å¥½åœ¨å­—ç¬¦ä¸²æ£€æŸ¥ä¹‹åå¼•å‘å¼‚å¸¸ã€‚ <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;IHtmlContent&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">List</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ItemTag....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> itemTagName = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ItemTag != <span class="hljs-string"><span class="hljs-string">"-"</span></span>) { itemTagName = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(ItemTag) ? <span class="hljs-string"><span class="hljs-string">"li"</span></span> : ItemTag; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> index = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> items) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> itemTag = ....; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(String.IsNullOrEmpty(itemTag)) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> .... .... itemTag.InnerHtml.AppendHtml(itemContent); listTag.InnerHtml.AppendHtml(itemTag); ++index; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> listTag; }</code> </pre> <br>  <b>PVS-Studioè¯Šæ–­æ¶ˆæ¯ï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3095</a>åœ¨å¯¹nullè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨'remoteClient'å¯¹è±¡ã€‚ æ£€æŸ¥è¡Œï¼š49ï¼Œ51ã€‚ImportRemoteInstanceController.cs 49 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;IActionResult&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Import</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ImportViewModel model</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> remoteClient = remoteClientList.RemoteClients.FirstOrDefault(....); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> apiKey = Encoding.UTF8.GetString(....(remoteClient.ProtectedApiKey)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (remoteClient == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || ....) { .... } .... }</code> </pre> <br> åˆ†æå™¨æ£€æµ‹åˆ°å¯¹<i>remoteClient</i>çš„å–æ¶ˆå¼•ç”¨ï¼Œéšååœ¨å‡ è¡Œä¸­æ‰§è¡Œç©ºæ£€æŸ¥ã€‚ å®é™…ä¸Šï¼Œè¿™ç¡®å®æ˜¯ä¸€ä¸ªæ½œåœ¨çš„<i>NullReferenceExceptionï¼Œ</i>å› ä¸º<i>FirstOrDefault</i>æ–¹æ³•å¯èƒ½ä¼šè¿”å›ä¸€ä¸ªé»˜è®¤å€¼ï¼ˆå¯¹äºå¼•ç”¨ç±»å‹ï¼Œè¯¥å€¼ä¸º<i>null</i> ï¼‰ã€‚ æˆ‘çŒœæƒ³å¯ä»¥é€šè¿‡ç®€å•åœ°å‘ä¸Šç§»åŠ¨æ£€æŸ¥æ¥ä¿®å¤æ­¤ä»£ç æ®µï¼Œä»¥ä¾¿åœ¨å–æ¶ˆå¼•ç”¨æ“ä½œä¹‹å‰è¿›è¡Œï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;IActionResult&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Import</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ImportViewModel model</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> remoteClient = remoteClientList.RemoteClients.FirstOrDefault(....); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (remoteClient != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> apiKey = UTF8.GetString(....remoteClient.ProtectedApiKey); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... } .... }</code> </pre> <br> æˆ–è€…ï¼Œä¹Ÿè®¸åº”è¯¥é€šè¿‡å°†<i>FirstOrDefault</i>æ›¿æ¢ä¸º<i>First</i>å¹¶å®Œå…¨å–æ¶ˆæ£€æŸ¥æ¥è§£å†³æ­¤é—®é¢˜ã€‚ <br><br>  <b>PVS-Studio 7.05 Betaå‘å‡ºçš„è­¦å‘Šï¼š</b> <br><br> åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»æ³¨é‡Šäº†æ‰€æœ‰<i>LINQ</i>çš„<i>orDefault</i>æ–¹æ³•ã€‚ æ­¤ä¿¡æ¯å°†ç”±æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„æ–°è¯Šæ–­ç¨‹åºä½¿ç”¨ï¼šå®ƒæ£€æµ‹åœ¨æ²¡æœ‰äº‹å…ˆæ£€æŸ¥çš„æƒ…å†µä¸‹å–æ¶ˆå¼•ç”¨äº†è¿™äº›æ–¹æ³•è¿”å›çš„å€¼çš„æƒ…å†µã€‚ æ¯ä¸ª<i>orDefault</i>æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„å¯¹è±¡ï¼Œå¦‚æœæ‰¾ä¸åˆ°åŒ¹é…çš„å…ƒç´ ï¼Œåˆ™è¯¥å¯¹è±¡å°†å¼•å‘å¼‚å¸¸ã€‚ ä¸æŠ½è±¡çš„<i>NullReferenceException</i>ç›¸æ¯”ï¼Œæ­¤å¼‚å¸¸å°†æ›´æœ‰åŠ©äºè·Ÿè¸ªé—®é¢˜ã€‚ <br><br> æˆ‘ä¸èƒ½ä¸åˆ†äº«åœ¨Orchardé¡¹ç›®ä¸­ä»è¯¥è¯Šæ–­ç¨‹åºè·å¾—çš„ç»“æœã€‚ æœ‰27ä¸ªæ½œåœ¨å±é™©ç‚¹ã€‚ ä»¥ä¸‹æ˜¯å…¶ä¸­ä¸€äº›ï¼š <br><br>  ContentTypesAdminNodeNavigationBuilder.cs 71ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> treeBuilder = treeNodeBuilders.Where(....).FirstOrDefault(); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> treeBuilder.BuildNavigationAsync(childNode, builder, treeNodeBuilders);</code> </pre> <br>  ListPartDisplayDriver.cs 217ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> contentTypePartDefinition = ....Parts.FirstOrDefault(....); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> contentTypePartDefinition.Settings....;</code> </pre> <br>  ContentTypesAdminNodeNavigationBuilder.cs 113ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> typeEntry = node.ContentTypes.Where(....).FirstOrDefault(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> AddPrefixToClasses(typeEntry.IconClass);</code> </pre> <br>  <b>PVS-Studioè¯Šæ–­æ¶ˆæ¯ï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a>æ–¹æ³•è¿”å›å€¼å¯èƒ½ä¸ºç©ºå–æ¶ˆå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥ï¼šCreateScopeï¼ˆï¼‰ã€‚  SetupService.cs 136 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetupInternalAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SetupContext context</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shellContext = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> ....) { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> shellContext.CreateScope().UsingAsync(....); } .... }</code> </pre> <br> åˆ†æå™¨æåˆ°äº†å¯¹<i>CreateScope</i>æ–¹æ³•è¿”å›çš„å€¼çš„å–æ¶ˆå¼•ç”¨ã€‚  <i>CreateScope</i>æ˜¯ä¸€ä¸ªå¾®å°çš„æ–¹æ³•ï¼Œå› æ­¤è¿™æ˜¯å…¶å®Œæ•´çš„å®ç°ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ShellScope </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateScope</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_placeHolder) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> scope = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ShellScope(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-comment"><span class="hljs-comment">// A new scope can be only used on a non released shell. if (!released) { return scope; } scope.Dispose(); return null; }</span></span></code> </pre> <br> å¦‚æ‚¨æ‰€è§ï¼Œåœ¨ä¸¤ç§æƒ…å†µä¸‹å®ƒå¯ä»¥è¿”å›<i>null</i> ã€‚ åˆ†æå™¨ä¸çŸ¥é“æ‰§è¡Œæµç¨‹å°†éµå¾ªå“ªä¸ªåˆ†æ”¯ï¼Œå› æ­¤å®ƒå¯ä»¥å®‰å…¨è¿è¡Œå¹¶å°†ä»£ç æŠ¥å‘Šä¸ºå¯ç–‘ã€‚ å¦‚æœè¦ç¼–å†™è¿™æ ·çš„ä»£ç ï¼Œæˆ‘ä¼šç«‹å³ç¼–å†™ä¸€ä¸ªç©ºæ£€æŸ¥ã€‚ <br><br> ä¹Ÿè®¸æˆ‘çš„çœ‹æ³•æ˜¯æœ‰åè§çš„ï¼Œä½†æˆ‘è®¤ä¸ºåº”è¯¥å°½å¯èƒ½é¿å…æ¯ä¸ªå¼‚æ­¥æ–¹æ³•éƒ½å—åˆ°<i>NullReferenceExceptionçš„å½±å“</i> ï¼Œå› ä¸ºè°ƒè¯•æ­¤ç±»ä¸œè¥¿è¿œéä»¤äººæ„‰å¿«ã€‚ <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ <i>CreateScope</i>æ–¹æ³•è¢«è°ƒç”¨äº†å››æ¬¡ï¼šå…¶ä¸­ä¸¤ä¸ªè°ƒç”¨å¸¦æœ‰æ£€æŸ¥ï¼Œè€Œå¦å¤–ä¸¤ä¸ªåˆ™æ²¡æœ‰ã€‚ åä¸¤ä¸ªè°ƒç”¨ï¼ˆæ— æ£€æŸ¥ï¼‰ä¼¼ä¹æ˜¯å¤åˆ¶ç²˜è´´å…‹éš†ï¼ˆç›¸åŒçš„ç±»ï¼Œç›¸åŒçš„æ–¹æ³•ï¼Œç›¸åŒçš„è§£å¼•ç”¨ç»“æœçš„æ–¹å¼ä»¥è°ƒç”¨UsingAsyncï¼‰ã€‚ ä¸Šé¢æ˜¾ç¤ºäº†è¿™ä¸¤ä¸ªè°ƒç”¨ä¸­çš„ç¬¬ä¸€ä¸ªï¼Œæ‚¨å¯ä»¥ç¡®å®šç¬¬äºŒä¸ªè°ƒç”¨è§¦å‘äº†ç›¸åŒçš„è­¦å‘Šï¼š <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a>æ–¹æ³•è¿”å›å€¼çš„ç©ºnullå–æ¶ˆå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥ï¼šCreateScopeï¼ˆï¼‰ã€‚  SetupService.cs 192 <br><br>  <b>PVS-Studioè¯Šæ–­æ¶ˆæ¯ï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3127æ‰¾åˆ°</a>ä¸¤ä¸ªç›¸ä¼¼çš„ä»£ç ç‰‡æ®µã€‚ ä¹Ÿè®¸ï¼Œè¿™æ˜¯ä¸€ä¸ªé”™å­—ï¼Œåº”è¯¥ä½¿ç”¨â€œ AccessTokenSecretâ€å˜é‡ä»£æ›¿â€œ ConsumerSecretâ€ TwitterClientMessageHandler.cs 52 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigureOAuthAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpRequestMessage request</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(settings.ConsumerSecret)) settings.ConsumerSecret = protrector.Unprotect(settings.ConsumerSecret); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(settings.ConsumerSecret)) settings.AccessTokenSecret = protrector.Unprotect(settings.AccessTokenSecret); .... }</code> </pre> <br> è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„å¤åˆ¶ç²˜è´´é”™è¯¯ã€‚  <i>ConsumerSecret</i>è¿›è¡Œäº†ä¸¤æ¬¡æ£€æŸ¥ï¼Œè€Œ<i>AccessTokenSecret</i>æ ¹æœ¬æ²¡æœ‰è¿›è¡Œæ£€æŸ¥ã€‚ æ˜¾ç„¶ï¼Œæ­¤é—®é¢˜å›ºå®šå¦‚ä¸‹ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigureOAuthAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpRequestMessage request</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(settings.ConsumerSecret)) settings.ConsumerSecret = protrector.Unprotect(settings.ConsumerSecret); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(settings.AccessTokenSecret)) settings.AccessTokenSecret = protrector.Unprotect(settings.AccessTokenSecret); .... }</code> </pre> <br>  <b>PVS-Studioè¯Šæ–­æ¶ˆæ¯ï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3139</a>ä¸¤ä¸ªæˆ–æ›´å¤šæ¡ˆä¾‹åˆ†æ”¯æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚  SerialDocumentExecuter.cs 23 <br><br> å¦ä¸€ä¸ªå¤åˆ¶ç²˜è´´é”™è¯¯ã€‚ ä¸ºäº†æ¸…æ¥šèµ·è§ï¼Œè¿™æ˜¯å®Œæ•´çš„ç±»å®ç°ï¼ˆå¾ˆå°ï¼‰ã€‚ <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SerialDocumentExecuter</span></span> : <span class="hljs-title"><span class="hljs-title">DocumentExecuter</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IExecutionStrategy ParallelExecutionStrategy = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ParallelExecutionStrategy(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IExecutionStrategy SerialExecutionStrategy = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SerialExecutionStrategy(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IExecutionStrategy SubscriptionExecutionStrategy = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SubscriptionExecutionStrategy(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> IExecutionStrategy </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SelectExecutionStrategy</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (context.Operation.OperationType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Query: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SerialExecutionStrategy; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Mutation: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SerialExecutionStrategy; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Subscription: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SubscriptionExecutionStrategy; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> ....; } } }</code> </pre> <br> åˆ†æä»ªä¸å–œæ¬¢ä¸¤ä¸ªç›¸åŒçš„<i>æ¡ˆä¾‹</i>åˆ†æ”¯ã€‚ å®é™…ä¸Šï¼Œè¯¥ç±»å…·æœ‰ä¸‰ä¸ªå®ä½“ï¼Œè€Œswitchè¯­å¥ä»…è¿”å›å…¶ä¸­ä¸¤ä¸ªã€‚ å¦‚æœæ­¤è¡Œä¸ºæ˜¯æœ‰æ„çš„ï¼Œå¹¶ä¸”å®é™…ä¸Šå¹¶ä¸æ‰“ç®—ä½¿ç”¨ç¬¬ä¸‰ä¸ªå®ä½“ï¼Œåˆ™å¯ä»¥é€šè¿‡åˆ é™¤åˆå¹¶äº†ä¸¤ä¸ªå®ä½“çš„ç¬¬ä¸‰ä¸ªåˆ†æ”¯æ¥æ”¹è¿›ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (context.Operation.OperationType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Query: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Mutation: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SerialExecutionStrategy; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Subscription: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SubscriptionExecutionStrategy; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> ....; }</code> </pre> <br> å¦‚æœè¿™æ˜¯ä¸€ä¸ªå¤åˆ¶ç²˜è´´é”™è¯¯ï¼Œåˆ™åº”æŒ‰å¦‚ä¸‹æ‰€ç¤ºä¿®å¤ç¬¬ä¸€ä¸ªé‡å¤çš„è¿”å›å­—æ®µï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (context.Operation.OperationType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Query: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ParallelExecutionStrategy; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Mutation: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SerialExecutionStrategy; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Subscription: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SubscriptionExecutionStrategy; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> ....; }</code> </pre> <br> æˆ–è€…å®ƒåº”è¯¥æ˜¯ç¬¬äºŒç§æƒ…å†µåˆ†æ”¯ã€‚ æˆ‘ä¸çŸ¥é“é¡¹ç›®çš„è¯¦ç»†ä¿¡æ¯ï¼Œå› æ­¤æ— æ³•ç¡®å®šæ“ä½œç±»å‹å’Œç­–ç•¥çš„åç§°ä¹‹é—´çš„ç›¸å…³æ€§ã€‚ <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (context.Operation.OperationType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Query: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SerialExecutionStrategy; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Mutation: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ParallelExecutionStrategy; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OperationType.Subscription: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SubscriptionExecutionStrategy; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> ....; }</code> </pre> <br>  <b>PVS-Studioè¯Šæ–­æ¶ˆæ¯ï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a>å¯èƒ½ä¸ºç©ºçš„å–æ¶ˆå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥â€œè¯·æ±‚â€ã€‚  GraphQLMiddleware.cs 148 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExecuteAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpContext context....</span></span></span><span class="hljs-function">)</span></span> { .... GraphQLRequest request = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (HttpMethods.IsPost(context.Request.Method)) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (HttpMethods.IsGet(context.Request.Method)) { .... request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GraphQLRequest(); .... } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> queryToExecute = request.Query; .... }</code> </pre> <br> åœ¨ç¬¬ä¸€ä¸ª<i>if</i>å—ä¸­å¤šæ¬¡ä¸º<i>è¯·æ±‚</i>å˜é‡åˆ†é…äº†ä¸€ä¸ªä¸åŒäº<i>null</i>çš„å€¼ï¼Œä½†æ¯æ¬¡éƒ½æœ‰åµŒå¥—æ¡ä»¶ã€‚ åŒ…æ‹¬æ‰€æœ‰è¿™äº›æ¡ä»¶ä¼šä½¿ç¤ºä¾‹å˜å¾—å¤ªé•¿ï¼Œå› æ­¤æˆ‘ä»¬ä»…ä»‹ç»å‰å‡ ä¸ªæ¡ä»¶ï¼Œå®ƒä»¬å°†æ£€æŸ¥httpæ–¹æ³•<i>IsGet</i>æˆ–<i>IsPost</i>çš„ç±»å‹ã€‚  <i>Microsoft.AspNetCore.Http.HttpMethods</i>ç±»å…·æœ‰ä¹ç§ç”¨äºæ£€æŸ¥æŸ¥è¯¢ç±»å‹çš„é™æ€æ–¹æ³•ã€‚ å› æ­¤ï¼Œä¾‹å¦‚ï¼Œå°†<i>Delete</i>æˆ–<i>Set</i>æŸ¥è¯¢ä¼ é€’ç»™<i>ExecuteAsync</i>æ–¹æ³•å°†å¯¼è‡´å¼•å‘<i>NullReferenceException</i> ã€‚ å³ä½¿ç›®å‰æ ¹æœ¬ä¸æ”¯æŒè¿™ç§æ–¹æ³•ï¼Œæ·»åŠ å¼‚å¸¸æŠ›å‡ºæ£€æŸ¥ä»ç„¶æ˜¯æ˜æ™ºçš„ã€‚ æ¯•ç«Ÿï¼Œç³»ç»Ÿè¦æ±‚å¯èƒ½ä¼šæ›´æ”¹ã€‚ è¿™æ˜¯æ­¤ç±»æ£€æŸ¥çš„ç¤ºä¾‹ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExecuteAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpContext context....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (request == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> ....; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> queryToExecute = request.Query; .... }</code> </pre> <br>  <b>PVS-Studioè¯Šæ–­æ¶ˆæ¯ï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a>æ–¹æ³•è¿”å›å€¼å¯èƒ½ä¸ºç©ºå–æ¶ˆå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥ï¼šè·å–&lt;ContentPart&gt;ï¼ˆ...ï¼‰ã€‚  ContentPartHandlerCoordinator.cs 190 <br><br> å¤§å¤šæ•°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a>è­¦å‘Šåœ¨å¼€å‘ç¯å¢ƒä¸­æ›´æ–¹ä¾¿æŸ¥çœ‹ï¼Œå› ä¸ºæ‚¨éœ€è¦æ–¹æ³•å¯¼èˆªï¼Œé”®å…¥çªå‡ºæ˜¾ç¤ºä»¥åŠIDEçš„å‹å¥½æ°›å›´ã€‚ æˆ‘è¯•å›¾å°½é‡å‡å°‘ç¤ºä¾‹æ–‡æœ¬ï¼Œä»¥ä½¿å®ƒä»¬æ˜“äºé˜…è¯»ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæˆ‘åšå¾—ä¸å¥½ï¼Œæˆ–è€…æ‚¨æƒ³æµ‹è¯•è‡ªå·±çš„ç¼–ç¨‹æŠ€èƒ½å¹¶è‡ªå·±è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œå»ºè®®æ‚¨åœ¨ä»»ä½•å¼€æºé¡¹ç›®æˆ–æ‚¨è‡ªå·±çš„ä»£ç ä¸­æ£€æŸ¥è¯¥è¯Šæ–­ç¨‹åºçš„ç»“æœã€‚ <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoadingAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LoadContentContext context</span></span></span><span class="hljs-function">)</span></span> { .... context.ContentItem.Get&lt;ContentPart&gt;(typePartDefinition.Name) .Weld(fieldName, fieldActivator.CreateInstance()); .... }</code> </pre> <br> åˆ†æä»ªæŠ¥å‘Šæ­¤è¡Œã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹<i>Get</i>æ–¹æ³•ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> TElement Get&lt;TElement&gt;(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> ContentElement contentElement....) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> TElement : ContentElement { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (TElement)contentElement.Get(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(TElement), name); }</code> </pre> <br> å®ƒè°ƒç”¨å…¶é‡è½½ç‰ˆæœ¬ã€‚ æˆ‘ä»¬ä¹Ÿæ£€æŸ¥ä¸€ä¸‹ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> ContentElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Get</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ContentElement contentElement....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> elementData = contentElement.Data[name] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> JObject; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elementData == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } .... }</code> </pre> <br> äº‹å®è¯æ˜ï¼Œå¦‚æœä½¿ç”¨<i>åç§°</i>ç´¢å¼•å™¨ä»<i>Dataä¸­</i>è·å¾—ä¸<i>JObject</i>ä¸å…¼å®¹çš„ç±»å‹çš„å®ä½“ï¼Œåˆ™<i>Get</i>æ–¹æ³•å°†è¿”å›<i>null</i> ã€‚ æˆ‘ä¸ç¡®å®šè¿™ç§å¯èƒ½æ€§æœ‰å¤šå¤§ï¼Œå› ä¸ºè¿™äº›ç±»å‹æ¥è‡ª<i>Newtonsoft.Json</i>åº“ï¼Œä½†æˆ‘æ²¡æœ‰åšè¿‡å¾ˆå¤šå·¥ä½œã€‚ ä½†æ˜¯ä»£ç ç¼–å†™è€…æ€€ç–‘æ‰€å¯»æ‰¾çš„å…ƒç´ å¯èƒ½ä¸å­˜åœ¨ï¼Œå› æ­¤åœ¨è®¿é—®è¯»å–æ“ä½œçš„ç»“æœæ—¶ä¹Ÿåº”ç‰¢è®°è¿™ä¸€ç‚¹ã€‚ å°±ä¸ªäººè€Œè¨€ï¼Œå¦‚æœæˆ‘ä»¬è®¤ä¸ºè¯¥èŠ‚ç‚¹å¿…é¡»å­˜åœ¨ï¼Œåˆ™ä¼šåœ¨ç¬¬ä¸€ä¸ª<i>Getä¸­</i>å¼•å‘å¼‚å¸¸ï¼Œæˆ–è€…å¦‚æœè¯¥èŠ‚ç‚¹çš„ä¸å­˜åœ¨ä¸ä¼šæ”¹å˜æ•´ä½“é€»è¾‘ï¼Œåˆ™åœ¨å–æ¶ˆå¼•ç”¨ä¹‹å‰æ·»åŠ ä¸€ä¸ªæ£€æŸ¥ï¼ˆä¾‹å¦‚ï¼Œé»˜è®¤å€¼ï¼‰ã€‚ <br><br> è§£å†³æ–¹æ¡ˆ1ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> ContentElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Get</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ContentElement contentElement....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> elementData = contentElement.Data[name] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> JObject; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elementData == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>.... } .... }</code> </pre> <br> è§£å†³æ–¹æ¡ˆ2ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoadingAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LoadContentContext context</span></span></span><span class="hljs-function">)</span></span> { .... context.ContentItem.Get&lt;ContentPart&gt;(typePartDefinition.Name) ?.Weld(fieldName, fieldActivator.CreateInstance()); .... }</code> </pre> <br>  <b>PVS-Studioè¯Šæ–­æ¶ˆæ¯ï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a>å¯èƒ½ä¸ºç©ºçš„å–æ¶ˆå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥â€œç»“æœâ€ã€‚  ContentQueryOrchardRazorHelperExtensions.cs 19 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> Task&lt;IEnumerable&lt;ContentItem&gt;&gt; ContentQueryAsync(....) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> results = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> orchardHelper.QueryAsync(queryName, parameters); .... <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> results) { .... } .... }</code> </pre> <br> ä¸å‰ä¸€ä¸ªç¤ºä¾‹ç›¸æ¯”ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç¤ºä¾‹ã€‚ åˆ†æå™¨æ€€ç–‘<i>QueryAsync</i>æ–¹æ³•å¯èƒ½è¿”å›ç©ºå¼•ç”¨ã€‚ è¿™æ˜¯è¯¥æ–¹æ³•çš„å®ç°ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;IEnumerable&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">QueryAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> query = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> queryManager.GetQueryAsync(queryName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (query == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } .... }</code> </pre> <br> ç”±äº<i>GetQueryAsync</i>æ˜¯æ¥å£æ–¹æ³•ï¼Œå› æ­¤æ‚¨ä¸èƒ½ç¡®å®šæ¯ä¸ªå®ç°ï¼Œç‰¹åˆ«æ˜¯å¦‚æœæˆ‘ä»¬è®¤ä¸ºè¯¥é¡¹ç›®è¿˜åŒ…æ‹¬ä»¥ä¸‹ç‰ˆæœ¬ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;Query&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetQueryAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> document = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> GetDocumentAsync(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(document.Queries.TryGetValue(name, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> query)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> query; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br> å¯¹å¤–éƒ¨å‡½æ•°å’Œç¼“å­˜è®¿é—®çš„å¤šæ¬¡è°ƒç”¨ä½¿å¯¹<i>GetDocumentAsync</i>çš„åˆ†æå˜å¾—å›°éš¾ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¯´éœ€è¦è¿›è¡Œæ£€æŸ¥-æ›´æ˜¯å¦‚æ­¤ï¼Œå› ä¸ºè¯¥æ–¹æ³•æ˜¯å¼‚æ­¥æ–¹æ³•ã€‚ <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> Task&lt;IEnumerable&lt;ContentItem&gt;&gt; ContentQueryAsync(....) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> results = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> orchardHelper.QueryAsync(queryName, parameters); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(results == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> ....; .... <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> results) { .... } .... }</code> </pre> <br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/41f/fb1/e08/41ffb1e086795cd7ba94b22ed53ce33c.png" alt="å›¾ç‰‡14"></div><br><br>  <b>ç»“è®º</b> <br><br> æˆ‘ä¸å¾—ä¸æåˆ°Orchardçš„é«˜è´¨é‡ä»£ç ï¼ ç¡®å®ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–ç¼ºé™·ï¼Œæˆ‘åœ¨è¿™é‡Œæ²¡æœ‰è®¨è®ºï¼Œä½†æ˜¯æˆ‘å‘æ‚¨å±•ç¤ºäº†æ‰€æœ‰æœ€ä¸¥é‡çš„é”™è¯¯ã€‚ å½“ç„¶ï¼Œè¿™å¹¶ä¸æ˜¯è¯´ä¸‰å¹´æ£€æŸ¥ä¸€æ¬¡æºä»£ç å°±è¶³å¤Ÿäº†ã€‚ å¦‚æœ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®šæœŸ</a>ä½¿ç”¨é™æ€åˆ†æï¼Œæ‚¨å°†è·å¾—æœ€å¤§çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ”¶ç›Šï¼Œ</a>å› ä¸ºè¿™æ ·å¯ä»¥ä¿è¯åœ¨æœ€æ—©çš„å¼€å‘é˜¶æ®µå°±æ•è·å¹¶ä¿®å¤é”™è¯¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé”™è¯¯ä¿®å¤æœ€ä¾¿å®œï¼Œæœ€å®¹æ˜“ã€‚ <br><br> å³ä½¿ä¸€æ¬¡æ£€æŸ¥å¹¶æ²¡æœ‰å¤šå¤§å¸®åŠ©ï¼Œæˆ‘ä»ç„¶é¼“åŠ±æ‚¨ä¸‹è½½<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PVS-Studio</a>å¹¶åœ¨æ‚¨çš„é¡¹ç›®ä¸Šè¿›è¡Œå°è¯•ï¼šè°çŸ¥é“ï¼Œä¹Ÿè®¸æ‚¨è¿˜ä¼šå‘ç°ä¸€äº›æœ‰è¶£çš„é”™è¯¯ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN472360/">https://habr.com/ru/post/zh-CN472360/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN472350/index.html">Methodiuså¦‚ä½•æˆä¸ºAnnaï¼šå¼€å‘å’Œå¯åŠ¨è¯­éŸ³æ¶ˆæ¯åˆ†ç±»å™¨çš„ç»éªŒã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN472352/index.html">TechnoTextï¼Œç¬¬2é›†ã€‚ æˆ‘ä»¬è®²è¿°å“ˆå‹ƒï¼ˆHabrï¼‰çš„ä½œè€…å¦‚ä½•ç”Ÿæ´»å’Œå·¥ä½œåœ¨æ–‡ç« ä¸Š</a></li>
<li><a href="../zh-CN472354/index.html">æ¤…å­å’Œæ˜¾ç¤ºå™¨ä¹‹é—´æ˜¯ç³»ç»Ÿä¸­çš„ä¸»è¦æ¼æ´ï¼šVAPäººå‘˜</a></li>
<li><a href="../zh-CN472356/index.html">Microsoft vs IBMï¼šJavaæ”¯æŒæ–¹é¢çš„é‡å¤§å˜åŒ–</a></li>
<li><a href="../zh-CN472358/index.html">10æœˆ30æ—¥17:00ç½‘ç»œç ”è®¨ä¼šâ€œåœ¨ä¸€ä¸ªå°æ—¶å†…åœ¨CROCäº‘ä¸­éƒ¨ç½²Kubernetesé›†ç¾¤â€</a></li>
<li><a href="../zh-CN472362/index.html">æˆ‘ä»¬æœç´¢å¹¶åˆ†æOrchard CMSä»£ç ä¸­çš„é”™è¯¯</a></li>
<li><a href="../zh-CN472364/index.html">PostgreSQLå¹¶è®°å½•æ¯ä¸ªç‰¹å®šè¿æ¥çš„ä¸€è‡´æ€§è®¾ç½®</a></li>
<li><a href="../zh-CN472366/index.html">Factorioä¸­çš„æ–°è·¯å¾„æŸ¥æ‰¾å™¨ç®—æ³•</a></li>
<li><a href="../zh-CN472368/index.html">è¯­éŸ³é’“é±¼ï¼šæˆ‘ä»¬åˆ†ææ”»å‡»æ–¹æ³•å’Œé’ˆå¯¹å®ƒä»¬çš„é˜²æŠ¤æ–¹æ³•</a></li>
<li><a href="../zh-CN472372/index.html">Androidè‡ªåŠ¨åŒ– è¶…çº§è½»æ¾çš„æŒ‡å—æ¥åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªEspressoæµ‹è¯•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>