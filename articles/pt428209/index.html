<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö¨ üò∞ üóÇÔ∏è Livro de receitas do desenvolvedor: Receitas de Design Orientado a Dom√≠nio (Parte 2, estrutura e intera√ß√£o) üéø üóÇÔ∏è ü•ó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Introdu√ß√£o 


 No primeiro artigo, destacamos o escopo das pr√°ticas indicadas, para quais projetos eles podem ser aplicados e para os quais n√£o dev...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Livro de receitas do desenvolvedor: Receitas de Design Orientado a Dom√≠nio (Parte 2, estrutura e intera√ß√£o)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428209/"><p><img src="https://habrastorage.org/webt/fr/vw/on/frvwonyhe7k6st_x65v67hcbrcs.jpeg" alt="cabe√ßalho ddd"></p><br><h1 id="vvedenie">  1. Introdu√ß√£o </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">No primeiro artigo,</a> destacamos o escopo das pr√°ticas indicadas, para quais projetos eles podem ser aplicados e para os quais n√£o deveriam. </p><br><p> Neste artigo, gostaria de dar uma breve vis√£o geral dos princ√≠pios b√°sicos do DDD, al√©m de compartilhar minha experi√™ncia pessoal com a aplica√ß√£o deles.  Falaremos mais detalhadamente sobre comunica√ß√£o e abordagens estruturais com exemplos de sua implementa√ß√£o. </p><br><p>  No artigo a seguir, escreverei as poss√≠veis combina√ß√µes dos padr√µes de design aplicados, levando em considera√ß√£o sua implementa√ß√£o e, finalmente, darei um exemplo de uma implementa√ß√£o espec√≠fica de um pequeno microsservi√ßo. </p><a name="habracut"></a><br><h1 id="ddd">  DDD </h1><br><p>  Lembre-se da defini√ß√£o anterior: </p><br><blockquote>  O DDD (Domain-driven Design) √© uma abordagem para o desenvolvimento de software para a satisfa√ß√£o complexa das necessidades, vinculando fortemente a implementa√ß√£o aos principais modelos de neg√≥cios que est√£o em processo de desenvolvimento constante. </blockquote><p>  O livro de refer√™ncia que descreve a pr√°tica de constru√ß√£o de sistemas complexos √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Domain Driven Dedign de</a> Eric Evans (Big Blue Book).  Se voc√™ leu algum artigo de revis√£o sobre este t√≥pico, j√° o conhece.  Quando voc√™ usar o DDD na pr√°tica, precisar√° l√™-lo.  Este n√£o √© o livro mais f√°cil de ler: </p><br><blockquote>  A fonte can√¥nica para DDD √© o livro de Eric Evans.  N√£o √© a leitura mais f√°cil na literatura de software, mas √© um daqueles livros que retribui amplamente um investimento substancial. <br><br>  Martin Fowler: 15 de janeiro de 2014 </blockquote><p>  Se voc√™ percorrer o conte√∫do do livro, parecer√° que voc√™ n√£o est√° totalmente estruturado.  Mas o mapa nos ajudar√°. <br><img src="https://habrastorage.org/webt/oh/5e/tj/oh5etj1mf-uvet2bdyn7y1olj8k.png" alt="Mapa DDD"></p><br><p>  No mapa est√£o aquelas pr√°ticas que consideraremos hoje. </p><br><p>  O escopo das pr√°ticas abordadas no livro √© enorme.  O escopo das pr√°ticas que podem ser aplicadas fora deste livro √© ainda maior.  Antes de colocar em servi√ßo pelo menos parte deles, identifique seus objetivos.  Vou dar o meu pr√≥prio como exemplo. </p><br><ul><li>  Aumente a produtividade. </li><li>  Escreva um c√≥digo compreens√≠vel. </li><li>  Dimensionamento no n√≠vel de desenvolvimento de software. </li></ul><br><h2 id="edinyy-yazyk">  L√≠ngua √∫nica </h2><br><p>  O desenvolvimento de software raramente leva √† cria√ß√£o de algo novo, como regra, √© uma simula√ß√£o de algo existente. </p><br><blockquote>  Um modelo √© uma representa√ß√£o de um objeto real, que inclui apenas as propriedades e fun√ß√µes necess√°rias. </blockquote><p>  N√£o podemos criar um produto de software que cubra toda a √°rea de assunto.  √â poss√≠vel reproduzir apenas a parte que reproduzir√° a funcionalidade necess√°ria. </p><br><p>  Um bom exemplo de modelo seria um mapa topogr√°fico.  Ela √© um modelo de terreno.  O mapa n√£o cont√©m prados de campos e rios, mas apenas reflete a localiza√ß√£o de objetos reais um em rela√ß√£o ao outro. </p><br><p>  Para criar um modelo claro e claro para todos, voc√™ precisa falar o mesmo idioma.  N√£o apenas Eric Evans nos diz isso, mas tamb√©m senso comum.  Se os programadores usam seus termos e usam suas pr√≥prias g√≠rias, os primeiros simplesmente n√£o entender√£o o que precisa ser feito.  As empresas, neste caso, n√£o ser√£o capazes de perceber o custo real do desenvolvimento de um ou outro "recurso".  Quantas vezes voc√™ j√° ouviu: "Sim, √© apenas um bot√£o para adicionar"? </p><br><p>  Seu objetivo como projetista de sistemas deve ser obter o m√°ximo entendimento um do outro de toda a equipe.  Como conseguir isso?  Comece a falar.  Se as pessoas come√ßam a se comunicar em qualquer grupo fechado, elas t√™m um certo conjunto de termos geralmente aceito.  Em empresas diferentes, √© prov√°vel que o processo de introdu√ß√£o de um idioma comum seja diferente.  Pode ser uma decis√£o de for√ßa de vontade ou um procedimento democr√°tico.  O idioma pode ser indicado explicitamente, e n√£o √© digitado explicitamente; nesse caso, eles simplesmente come√ßam a falar.  Uma boa t√©cnica para introduzir uma linguagem comum √© a documenta√ß√£o geral. </p><br><h3 id="kak-vesti-dokumentaciyu-proekta">  Como manter a documenta√ß√£o do projeto </h3><br><ol><li>  Qualquer comunica√ß√£o entre neg√≥cios e desenvolvimento deve melhorar seu modelo. </li><li>  Ap√≥s a reuni√£o, registre o resultado na forma de documenta√ß√£o (artefato Scrum) e mostre esta documenta√ß√£o a todos os participantes no processo de desenvolvimento. </li><li>  Use um √∫nico idioma na documenta√ß√£o. </li><li>  Mais importante: n√£o perca tempo com a documenta√ß√£o.  Voc√™ ainda precisa escrever o c√≥digo e a documenta√ß√£o ser√° reescrita muitas vezes, o gasto de recursos √© caro.  Em vez de mexer com o aplicativo de gr√°ficos UML por um longo tempo, use um guardanapo, caneta e c√¢mera no telefone. </li><li>  A documenta√ß√£o requer disciplina, voc√™ n√£o pode escrev√™-la de tempos em tempos. </li><li>  Separe a documenta√ß√£o: <br><ul><li> Coment√°rios no c√≥digo - descreva momentos incompreens√≠veis diretamente no c√≥digo, deixe <code>#ODO:</code> (remova ao mesclar o c√≥digo no mestre).  Expresse sua opini√£o nos coment√°rios, por exemplo, voc√™ deve usar uma ou outra muleta ao trabalhar com o c√≥digo legasy. </li><li>  Os coment√°rios no projeto <code>README.md</code> no diret√≥rio raiz do seu projeto devem conter informa√ß√µes t√©cnicas: como iniciar o projeto, como executar testes etc.  Tamb√©m √© uma boa ideia obter um mapa onde voc√™ tem todos os projetos e em quais servidores eles est√£o sendo executados.  Registre separadamente todos os contratos aceitos. </li><li>  E o mais importante, a base de conhecimento.  Uma cole√ß√£o de documentos que descrevem os processos de neg√≥cios, essa √© a parte dos documentos dispon√≠veis para voc√™ e os neg√≥cios. </li></ul></li><li>  O principal erro de quem escreve documenta√ß√£o √© redund√¢ncia.  N√£o tente cobrir tudo e tudo, transmitir apenas o significado geral.  A documenta√ß√£o deve complementar seu projeto, mas n√£o substitu√≠-lo de forma alguma.  N√£o anote todos os termos que s√£o apenas amb√≠guos.  Se uma defini√ß√£o leva mais de duas frases, √© uma defini√ß√£o ruim. </li></ol><br><p>  Exemplo de documenta√ß√£o: </p><br><pre> <code class="markdown hljs"><span class="hljs-section"><span class="hljs-section">#         . # :  : -    - email -  ## : ###        ,     email  ,    1  (      email  ). ###           .          email . ###  email  email     .    ,    email.   . ###       ,     ,    .   . ###      email,    ,       .   2 . ###                  .    ,     ,             .</span></span></code> </pre><br><p>  Observe que, neste exemplo, n√£o especificamos um dicion√°rio expl√≠cito; no entanto, corrigimos o conceito de <em>Usu√°rio</em> , <em>Autoriza√ß√£o</em> , <em>Registro</em> .  Escrever essa documenta√ß√£o n√£o levar√° mais de 20 minutos para o especialista. </p><br><p>  Para uma pessoa que n√£o √© especialista na √°rea de assunto, o processo de escrever documenta√ß√£o √© percebido como algo complicado.  √â necess√°rio separar a cole√ß√£o de conhecimentos e o registro dos conhecimentos coletados. <code> !=  +  .</code> </p><br><blockquote>  "O que voc√™s chamam de universo", disse o quarto, "√©, de fato, um ac√∫mulo de mundos que, como a pele de um arco, est√£o um em cima do outro e s√£o gradualmente separados um do outro." <br><br>  - Excepto claramente claro!  - admirava os abderitas.  - Surpreendentemente claro!  "Eles pensaram que entendiam o fil√≥sofo, porque sabiam muito bem o que era a cebola". <br><br>  Hist√≥ria de Aberdeen, Cristov Martin Wieland </blockquote><br><h2 id="ogranichennyy-konteksty-i-domeny">  Contextos e dom√≠nios limitados </h2><br><p>  Imagine que agimos como projetista de uma startup progressiva.  Todos n√≥s adoramos pizza resfriada, xingando com correios e preenchendo formul√°rios no site por horas.  Portanto, criamos uma maravilhosa startup ‚ÄúQuatro tartarugas e um rato‚Äù: </p><br><ul><li>  Existe um site no qual as pizzarias s√£o registradas e postam seus pratos reais. </li><li>  Essas pizzarias n√£o possuem servi√ßo de correio pr√≥prio. </li><li>  Existem clientes que n√£o podem acessar a pizzaria, mas est√£o prontos para fazer um pedido pelo site ou aplicativo m√≥vel. </li><li>  Assassino 'recurso': correios n√£o s√£o pessoas especialmente contratadas, mas pessoas comuns que se registraram atrav√©s do aplicativo m√≥vel </li><li>  Os correios recebem ordens e, ap√≥s sua execu√ß√£o, recebem pagamento pelo trabalho realizado. </li><li>  Leva mais tempo para esperar por esses correios, mas a entrega e, consequentemente, a pizza, s√£o mais baratas. </li></ul><br><p>  Vamos relembrar a documenta√ß√£o que descrevemos no cap√≠tulo anterior.  L√°, em nosso dicion√°rio √∫nico, o termo <em>registro foi usado</em> .  Mas neste projeto, temos v√°rios deles: </p><br><ul><li>  Registro de cliente </li><li>  Registro de Pizzaria </li><li>  Registro de Correio </li><li>  Pedido de Registro </li></ul><br><p>  Uma linguagem unificada pertence a um contexto limitado.  O dom√≠nio da documenta√ß√£o acima √© 'Sistema de Autoriza√ß√£o'.  Vamos tentar alocar dom√≠nios para nossa inicializa√ß√£o. </p><br><p>  Mas antes de come√ßarmos, vejamos uma pequena terminologia sobre o que √© um dom√≠nio e o que √© um contexto limitado. </p><br><blockquote>  Dom√≠nio (dom√≠nio) - uma representa√ß√£o de uma estrutura de neg√≥cios real que resolve um problema espec√≠fico. </blockquote><p>  Por exemplo: Sistema de log√≠stica, Sistema de pagamento, Sistema de autoriza√ß√£o, Sistema de gerenciamento de pedidos. </p><br><p>  O dom√≠nio √© dividido em subdom√≠nios, que descrevem estruturas menores, por exemplo: uma cesta de pedidos, um sistema para a constru√ß√£o de rotas. </p><br><p>  Cada dom√≠nio tem uma √°rea limitada de responsabilidade - funcionalidade limitada. </p><br><blockquote>  Contexto limitado - um conjunto de restri√ß√µes de dom√≠nio que ajuda o dom√≠nio a se concentrar em apenas uma tarefa para obter a melhor solu√ß√£o. </blockquote><p>  Eu gosto de apresentar esse termo como uma abstra√ß√£o.  Um dom√≠nio √© um c√≠rculo.  Um contexto restrito √© um c√≠rculo. </p><br><p><img src="https://habrastorage.org/webt/nf/nm/jz/nfnmjzlgui85mvfatppogqv-kdq.jpeg" alt="Contexto do dom√≠nio"></p><br><p>  Mesmo na terminologia DDD, o kernel √© alocado. </p><br><blockquote>  O n√∫cleo (dom√≠nio principal) - o dom√≠nio mais importante que caracteriza a sua empresa. </blockquote><p>  Ent√£o, os dom√≠nios do projeto "Quatro tartarugas e um rato": </p><br><p>  <strong>Trabalhar com uma pizzaria</strong> (Pizzarias) </p><br><p>  <em>Contexto</em> : b2b tudo relacionado a pizzarias </p><br><p>  <em>Subdom√≠nios</em> : </p><br><ul><li>  registro de novas pizzarias </li><li>  adicionando sortimento </li><li>  atualizando o status da disponibilidade de um produto </li></ul><br><p>  <strong>Trabalhar com o cliente</strong> (clientes) </p><br><p>  <em>Contexto</em> : b2c, tudo relacionado ao trabalho com clientes de pizza </p><br><p>  <em>Subdom√≠nios</em> : </p><br><ul><li>  ver sortimento </li><li>  materiais informativos </li></ul><br><p>  <strong>Trabalhar com correios</strong> (sistema de entrega) </p><br><p>  <em>Contexto</em> : b2e, tudo relacionado ao trabalho com correios </p><br><p>  <em>Subdom√≠nios</em> : </p><br><ul><li>  registro de correio </li><li>  atribui√ß√£o de tarefas </li><li>  registo de pedidos de levantamento de fundos obtidos pelo correio. </li></ul><br><p>  Sistema de pedidos </p><br><p>  <em>Contexto</em> : Kernel.  Permite coordenar todos os dom√≠nios individuais, fornecendo um ciclo completo desde o recebimento de um pedido at√© a entrega da pizza ao usu√°rio.  N√£o √© um artista, mas desempenha o papel de condutor. </p><br><p>  <em>Subdom√≠nios</em> : </p><br><ul><li>  aceita√ß√£o de pedidos </li><li>  execu√ß√£o de ordens </li><li>  rastreamento do status do pedido </li></ul><br><p>  <strong>Sistema de liquida√ß√£o</strong> (faturamento) </p><br><p>  <em>Contexto</em> : cont√©m todas as transa√ß√µes financeiras.  Ele fornece intera√ß√£o com o centro de processamento. </p><br><p>  <em>Subdom√≠nios</em> : </p><br><ul><li>  aceitando dinheiro para pedidos </li><li>  dando dinheiro aos correios pelo trabalho realizado </li></ul><br><p>  <strong>Sistema de Estat√≠stica</strong> </p><br><p>  <em>Contexto</em> : A coleta e o processamento (n√£o emiss√£o) de informa√ß√µes anal√≠ticas. </p><br><p>  <em>Subdom√≠nios</em> : </p><br><ul><li>  estat√≠sticas de fundos </li><li>  estat√≠sticas da aplica√ß√£o </li></ul><br><p>  <strong>Sistema de Gerenciamento</strong> (painel <strong>Gerenciamento</strong> ) </p><br><p>  <em>Contexto</em> : A emiss√£o de informa√ß√µes anal√≠ticas.  Kit de ferramentas de decis√µes de gerenciamento. </p><br><ul><li>  an√°lises baseadas em estat√≠sticas coletadas </li><li>  pr√©-modera√ß√£o de pagamentos a correios </li></ul><br><p>  Com base nos dom√≠nios, vamos mape√°-lo. </p><br><blockquote>  Um mapa de dom√≠nio (mapa de contexto) √© uma ferramenta gr√°fica que permite descrever os relacionamentos entre dom√≠nios individuais. </blockquote><p><img src="https://habrastorage.org/webt/p1/ks/po/p1kspot2qqut90gzcn1b9fhxyn8.png" alt="Mapa de contexto"></p><br><p>  O mapa mostra links entre dom√≠nios.  Este mapa √© muito superficial, mas a √°rea de assunto n√£o √© bem conhecida.  Este √© o primeiro esbo√ßo, reescrevendo o que voc√™ obter√° o resultado esperado. </p><br><p>  O mais importante no mapa √© que vemos conex√µes entre dom√≠nios.  Essa estrutura se encaixa muito bem na arquitetura de microsservi√ßo: </p><br><blockquote>  O principal princ√≠pio da arquitetura de microsservi√ßos: conectividade fraca e forte ades√£o. </blockquote><p>  Esse princ√≠pio √© dado no livro de Sam Newman - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criando microsservi√ßos</a> , este √© o segundo livro que voc√™ precisar√° ler para iniciar o uso pr√°tico das abordagens descritas neste artigo.  O que se quer dizer: os dom√≠nios devem ser fracamente acoplados, mas intimamente ligados internamente. </p><br><p>  A tradu√ß√£o desses termos √© retirada da tradu√ß√£o oficial para o russo e, talvez, reflita mal o significado transmitido.  Nos termos originais, soa como: Baixo acoplamento (conectividade, engajamento, ader√™ncia, conjuga√ß√£o), alta coes√£o (conectividade, for√ßa). </p><br><h2 id="praktika-realizacii-domennogo-razdelenie">  Pr√°tica de implementa√ß√£o de compartilhamento de dom√≠nio </h2><br><p>  Gostaria de compartilhar minha experi√™ncia pessoal - um conjunto de decis√µes informadas.  N√£o exorto voc√™ a usar essas solu√ß√µes.  Mas eles podem ser uma boa op√ß√£o se voc√™ n√£o souber por onde come√ßar.  Com experi√™ncia pessoal, as ferramentas ser√£o mais adaptadas √†s suas necessidades. </p><br><p>  Os principais princ√≠pios que nos guiaram: </p><br><ul><li>  A simplicidade da solu√ß√£o.  Fa√ßa coisas complexas simples, n√£o simples complicadas. </li><li>  Pragmatismo  Voc√™ sempre precisa olhar para a situa√ß√£o e, na aus√™ncia de uma solu√ß√£o existente, desenvolver uma nova.  Tente tipificar tudo, mas evite o dogmatismo. </li><li>  C√≥digo! = Documenta√ß√£o.  O c√≥digo √© instru√ß√µes para a m√°quina, a documenta√ß√£o √© uma instru√ß√£o para as pessoas.  N√£o h√° necessidade de confundi-los e distribuir um ap√≥s o outro. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">S√ìLIDO</a> </li></ul><br><h3 id="kak-realizovat-domeny">  Como implementar dom√≠nios? </h3><br><p>  √â muito conveniente selecionar dom√≠nios como microsservi√ßos separados. </p><br><blockquote>  Microsservi√ßos √© um aplicativo separado que implementa a l√≥gica de um dom√≠nio. </blockquote><p>  No desenvolvimento do DDD, o princ√≠pio de alocar um microsservi√ßo em um aplicativo separado ser√° um contexto limitado.  Isso n√£o nega o princ√≠pio t√©cnico da separa√ß√£o de servi√ßos (se isso ocorrer devido √† necessidade de garantir alto desempenho).  Mas o princ√≠pio contextual ser√° dominante e obrigat√≥rio. </p><br><h3 id="kak-vydelit-svyazi-mezhdu-domenami">  Como destacar o relacionamento entre dom√≠nios? </h3><br><p>  Rela√ß√µes entre dom√≠nios √© sempre uma API.  Pode ser RESTful json api, gRPC, AMPQ.  No √¢mbito deste artigo, n√£o compararemos um protocolo com outro e destacaremos suas vantagens e desvantagens, cada um deles com seu pr√≥prio campo de aplica√ß√£o.  Ainda assim, vamos nos debru√ßar sobre recomenda√ß√µes gerais: </p><br><p>  <strong>Seja flex√≠vel na escolha de um protocolo e r√≠gido na uniformidade de sua implementa√ß√£o.</strong> </p><br><p>  Escolha um protocolo para cada par de dom√≠nios individualmente, n√£o tente usar http em qualquer lugar, talvez seja necess√°rio filas ass√≠ncronas em algum lugar e as vantagens do AMPQ se tornar√£o √≥bvias para voc√™.  N√£o ignore esta oportunidade porque voc√™ tem RESTful em todos os lugares. </p><br><p>  Por outro lado, se voc√™ estiver implementando o RESTful json, use um padr√£o de estrutura√ß√£o de dados.  Voc√™ pode preparar, por exemplo, jsonapi ou openapi.  Se, por algum motivo, as solu√ß√µes prontas n√£o se adequarem a voc√™ e voc√™ sentir que pode desenvolver seu padr√£o, descrev√™-lo e us√°-lo.  Mas use-o em qualquer lugar, n√£o crie padr√µes de "zool√≥gico".  Se voc√™ precisar se comunicar com um sistema externo onde eles n√£o sabem nada sobre seus padr√µes, escreva um adaptador de microsservi√ßo. </p><br><p><img src="https://habrastorage.org/webt/cz/ff/go/czffgobmp7v9lr2pzkjx0-3y5xq.png" alt="Adaptador"></p><br><h3 id="kak-realizovat-sabdomeny">  Como implementar subdom√≠nios? </h3><br><p>  Como m√≥dulos separados dentro de um microsservi√ßo. </p><br><blockquote>  Um m√≥dulo √© uma implementa√ß√£o de um subdom√≠nio, colocando a l√≥gica em um espa√ßo para nome separado (Espa√ßo para Nome) em um √∫nico microsservi√ßo. </blockquote><p>  Como √© tudo isso?  Vejamos um exemplo.  Como lembramos, temos um dom√≠nio do sistema de entrega - esse dom√≠nio possui tr√™s subdom√≠nios: </p><br><ul><li>  registro de correio </li><li>  quest√£o de tarefas (tarefas) </li><li>  registro de pedidos de retirada de fundos auferidos pelo correio (retirada) </li><li>  verificando se o seu microsservi√ßo est√° funcionando, ferramenta t√©cnica auxiliar (healt_checker) </li></ul><br><p>  Imagine tudo isso na forma de uma estrutura de pastas: </p><br><pre> <code class="bash hljs">$ tree --dirsfirst delivery_system delivery_system ‚îú‚îÄ‚îÄ app/ ‚îÇ ‚îú‚îÄ‚îÄ health_checker/ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îú‚îÄ‚îÄ registrations/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ forms/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ interactor/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ services/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ validations/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îÇ ‚îú‚îÄ‚îÄ tasks ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ queries/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îÇ ‚îî‚îÄ‚îÄ withdrawals ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îú‚îÄ‚îÄ forms/ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îú‚îÄ‚îÄ interactor/ ‚îÇ ‚îú‚îÄ‚îÄ services/ ‚îÇ ‚îú‚îÄ‚îÄ validations/ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îú‚îÄ‚îÄ config/ ‚îú‚îÄ‚îÄ db/ ‚îú‚îÄ‚îÄ docs/ ‚îú‚îÄ‚îÄ lib/ ‚îÇ ‚îú‚îÄ‚îÄ schemas/ ‚îÇ ‚îî‚îÄ‚îÄ values/ ‚îú‚îÄ‚îÄ public ‚îú‚îÄ‚îÄ specs ‚îú‚îÄ‚îÄ config.ru ‚îú‚îÄ‚îÄ Gemfile ‚îú‚îÄ‚îÄ Gemfile.lock ‚îú‚îÄ‚îÄ Rakefile ‚îî‚îÄ‚îÄ README.md</code> </pre> <br><p>  Cada pasta no diret√≥rio <code>apps/</code> implementa um ou outro subdom√≠nio. Dentro de cada dom√≠nio, existem v√°rios padr√µes: <code>entities</code> , <code>forms</code> , <code>services</code> etc. Vamos considerar cada um dos padr√µes aplicados em detalhes em um dos artigos futuros. </p><br><p>  Cada padr√£o √© implementado no espa√ßo de nome correspondente (espa√ßo de nome).  Por exemplo, um formul√°rio para criar um pedido de pagamento a um mensageiro: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrawal</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#   module Forms #  class Create end end end</span></span></span></span></code> </pre> <br><h3 id="kak-realizovat-svyazi-mezhdu-sabdomeny">  Como implementar a comunica√ß√£o entre subdom√≠nios? </h3><br><p>  Vejamos um exemplo espec√≠fico.  Temos uma conta de correio: <code>Registrations::Entities::Account</code> .  Refere-se ao subdom√≠nio <code>Registrations</code> - j√° que consideramos esse dom√≠nio n√£o como um processo de registro, mas como uma tabela de contas e um livro de registro, conforme indicado em nossa documenta√ß√£o comercial. </p><br><p>  Temos dois <em>processos</em> em execu√ß√£o dos quais acessamos esta conta. </p><br><ul><li>  Crie uma conta (Registro) </li><li>  Cria√ß√£o de um pedido de retirada de fundos ganhos por um mensageiro (Wihtdrawal) </li></ul><br><p>  Como vemos, esses dois processos pertencem a subdom√≠nios diferentes - Registro e Retirada. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrwals</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateOrder</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations::Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  No primeiro caso, uma chamada para a classe ser√° implementada atrav√©s de uma chamada para <code>Entities::Account</code> .  E no segundo caso, atrav√©s de uma chamada expl√≠cita para <code>Registrations::Entities::Account</code> .  I.e.  se especificarmos explicitamente um subdom√≠nio, a classe ser√° de outro subdom√≠nio e, portanto, indicamos claramente a conex√£o. </p><br><p>  Se a classe n√£o se aplicar explicitamente a nenhum dos subdom√≠nios, faz sentido mov√™-la para a pasta <code>lib/</code> .  Como regra, s√£o classes que implementam o padr√£o 'ValueObject'.  Examinaremos esse padr√£o em mais detalhes em um dos seguintes artigos. </p><br><h2 id="realizaciya-cherez-model">  Implementa√ß√£o atrav√©s do modelo. </h2><br><p>  Para citar Eric Evans: </p><br><blockquote>  Se a arquitetura do programa, ou pelo menos uma parte central dele, n√£o corresponder √† estrutura do modelo de dom√≠nio, esse modelo ser√° praticamente in√∫til e a opera√ß√£o correta do programa tamb√©m dever√° ser questionada.  Ao mesmo tempo, relacionamentos muito complexos entre modelos e fun√ß√µes na arquitetura de software s√£o dif√≠ceis de entender e, na pr√°tica, s√£o dif√≠ceis de manter √† medida que a arquitetura muda. </blockquote><p>  Vamos relembrar o exemplo de um bom modelo que eu j√° citei no in√≠cio deste artigo - um mapa topogr√°fico.  Nosso objetivo √© encontrar rapidamente a dist√¢ncia entre dois assentamentos.  Poder√≠amos usar uma tabela de refer√™ncia mostrando dois pontos entre as cidades.  E n√≥s podemos usar o cart√£o.  L√° e l√°, obtemos o mesmo resultado quase ao mesmo tempo.  Mas o mapa √© mais compacto, exibe com mais precis√£o a √°rea de assunto, √© mais universal.  O mapa como modelo √© incrivelmente expressivo.  E se a considerarmos no √¢mbito desta tarefa, medir a dist√¢ncia √© mais conveniente no mapa do que no pr√≥prio territ√≥rio, o que reflete.  Um modelo que reflete uma √°rea de assunto pode super√°-lo em algumas propriedades.  √â realmente incr√≠vel. </p><br><p>  A implementa√ß√£o do modelo √© sempre um processo criativo com resultados imprevis√≠veis.  A qualidade do seu c√≥digo n√£o √© o desempenho nem a complexidade, √© a simplicidade e a expressividade.  Melhore-o atrav√©s de refatora√ß√£o constante, torne-o flex√≠vel e elimine todos os desnecess√°rios.  Separe a camada que ser√° respons√°vel pela l√≥gica de neg√≥cios do modelo das camadas cuja necessidade √© devido √† implementa√ß√£o t√©cnica.  Como conseguimos fazer isso ser√° descrito mais adiante. </p><br><hr><br><div class="spoiler">  <b class="spoiler_title">Fontes de inspira√ß√£o</b> <div class="spoiler_text"><ul><li>  Projeto Orientado a Problemas, Eric J. Evans </li><li>  Criando microsservi√ßos, Sam Newman </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://gorodinski.com/blog/2013/04/29/sub-domains-and-bounded-contexts-in-domain-driven-design-ddd/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://martinfowler.com/bliki/BoundedContext.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://habr.com/post/316438/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://dotnetcodr.com/2015/08/06/domain-driven-design-with-web-api-revisited-part-1-introduction/</a> </li><li>  Hist√≥ria de Aberdeen, Cristov Martin Wieland </li></ul><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt428209/">https://habr.com/ru/post/pt428209/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt428193/index.html">Sobre fazer passeios</a></li>
<li><a href="../pt428197/index.html">Finan√ßas pessoais eficazes. N√≠vel 1</a></li>
<li><a href="../pt428201/index.html">Buracos de toupeira em JavaScript</a></li>
<li><a href="../pt428203/index.html">Observamos os gr√°ficos: estimativas e previs√µes para o mercado de computa√ß√£o em nuvem, dados em 2018</a></li>
<li><a href="../pt428205/index.html">Lifehacks NaviHaka</a></li>
<li><a href="../pt428211/index.html">O livro ‚ÄúArquitetura Evolucion√°ria. Suporte para mudan√ßa cont√≠nua "</a></li>
<li><a href="../pt428213/index.html">Como interpretar previs√µes de modelo no SHAP</a></li>
<li><a href="../pt428217/index.html">Milh√µes de v√≠deo chamadas por dia ou "Ligue para a m√£e!"</a></li>
<li><a href="../pt428219/index.html">De onde veio a pr√°tica de realoca√ß√£o em massa de pessoal qualificado?</a></li>
<li><a href="../pt428221/index.html">Gera√ß√£o AI de rostos realistas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>