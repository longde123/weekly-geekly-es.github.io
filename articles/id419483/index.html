<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛸️ 🏇🏿 🎲 PowerShell dan Shift + Ins, atau cara mendapatkan kecepatan Hermes saat bekerja dengan GPP 🕐 🕞 ✍🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Papan klip dan PowerShell akan mempercepat, tetapi tidak buta. 


 Menggunakan GPP untuk menambahkan file registri menyeramkan dan tidak nyaman - semu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PowerShell dan Shift + Ins, atau cara mendapatkan kecepatan Hermes saat bekerja dengan GPP</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pc-administrator/blog/419483/"><p><img src="https://habrastorage.org/webt/k0/kx/85/k0kx85rhqs17dmtkqokemwzru7o.jpeg"><br>  <em>Papan klip dan PowerShell akan mempercepat, tetapi tidak buta.</em> </p><br><p>  Menggunakan GPP untuk menambahkan file registri menyeramkan dan tidak nyaman - semua cabang registri ini, jenis kunci, nilai ... Terutama jika cabang dan nilai cukup bagus.  Tetapi ada beberapa peretas yang dapat secara signifikan mempercepat pekerjaan dengan kebijakan grup. </p><br><p>  <em>Anda dapat, tentu saja, menggantung skrip logon dengan perintah impor cabang registri.</em>  <em>Tapi ini bukan metode kami.</em> <em><a name="habracut"></a></em> </p><br><h1 id="sposob-pervyy-slegka-slozhnyy">  Cara pertama.  Agak rumit </h1><br><p>  Opsi pertama adalah membuat template GPO Anda sendiri.  Metode ini sangat nyaman jika Anda perlu mengubah parameter nilai tergantung pada pengguna.  Jika Anda tidak ingin mempelajari prinsip-prinsip pembentukan template, Anda cukup mengekspor file reg yang "benar" dan mengubahnya menjadi file template menggunakan skrip <strong>REG_2_ADMXL.vbs yang</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diterbitkan</a> di galeri skrip Technet. </p><br><p>  Misalkan kita ingin membuat hidup lebih mudah bagi pengguna dengan memasukkan beberapa mesin pencari ke Internet Explorer sebagai berikut: </p><br><ul><li>  jika Anda memasukkan teks kueri di bilah alamat " <strong>g</strong> ", kueri akan dicari di Google; </li><li>  " <strong>Y</strong> request text" - dalam Yandex; </li><li> dan " <strong>w</strong> teks permintaan" di Wikipedia bahasa Rusia. </li></ul><br><p>  Untuk melakukan ini, cukup siapkan file registri: </p><br><pre><code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">Software</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span><span class="hljs-type"><span class="hljs-type">ernet</span></span> <span class="hljs-type"><span class="hljs-type">Explorer</span></span>\<span class="hljs-type"><span class="hljs-type">SearchUrl</span></span>\<span class="hljs-type"><span class="hljs-type">W</span></span>] <span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>=<span class="hljs-string"><span class="hljs-string">"http://ru.wikipedia.org/wiki/:Search?search=%s"</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">Software</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span><span class="hljs-type"><span class="hljs-type">ernet</span></span> <span class="hljs-type"><span class="hljs-type">Explorer</span></span>\<span class="hljs-type"><span class="hljs-type">SearchUrl</span></span>\<span class="hljs-type"><span class="hljs-type">Y</span></span>] <span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>=<span class="hljs-string"><span class="hljs-string">"http://www.yandex.ru/yandsearch?rpt=rad&amp;text=%s"</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">Software</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span><span class="hljs-type"><span class="hljs-type">ernet</span></span> <span class="hljs-type"><span class="hljs-type">Explorer</span></span>\<span class="hljs-type"><span class="hljs-type">SearchUrl</span></span>\<span class="hljs-type"><span class="hljs-type">G</span></span>] <span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>=<span class="hljs-string"><span class="hljs-string">"http://www.google.com/search?q=%s"</span></span></code> </pre> <br><p>  Konversikan ke templat dengan perintah berikut: </p><br><pre> <code class="bash hljs">cscript REG_2_ADMXL.vbs IE-search.reg Ru-ru IE-search.admx</code> </pre> <br><p>  Template yang dihasilkan dan folder dengan file bahasa akan dilemparkan ke direktori template.  Sekarang kebijakan kami akan muncul di snap-in manajemen GPO. </p><br><p><img src="https://habrastorage.org/webt/zj/um/sj/zjumsjvhz4dqqnk8g-zoquqhzpc.jpeg"><br>  <em>Template yang diinstal.</em> </p><br><p>  Mekanisme ini tidak terlalu nyaman dalam hal pemeliharaan, tetapi pada prinsipnya itu bekerja.  Dan jangan secara manual menggerakkan apa pun. </p><br><p>  Opsi lain adalah menggunakan cmdlet PowerShell untuk bekerja dengan GPO.  Misalnya, untuk mengembalikan item menu konteks "Kirim" kepada pengguna, set cmdlet adalah sebagai berikut: </p><br><pre> <code class="hljs powershell"><span class="hljs-built_in"><span class="hljs-built_in">Import-module</span></span> <span class="hljs-literal"><span class="hljs-literal">-Name</span></span> GroupPolicy <span class="hljs-built_in"><span class="hljs-built_in">New-GPO</span></span> <span class="hljs-literal"><span class="hljs-literal">-Name</span></span> SendTo <span class="hljs-built_in"><span class="hljs-built_in">Set-GPRegistryValue</span></span> <span class="hljs-literal"><span class="hljs-literal">-Name</span></span> <span class="hljs-string"><span class="hljs-string">"SendTo"</span></span> <span class="hljs-literal"><span class="hljs-literal">-key</span></span> <span class="hljs-string"><span class="hljs-string">"Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders"</span></span> <span class="hljs-literal"><span class="hljs-literal">-ValueName</span></span> SendTo <span class="hljs-literal"><span class="hljs-literal">-Type</span></span> ExpandString <span class="hljs-literal"><span class="hljs-literal">-value</span></span> <span class="hljs-string"><span class="hljs-string">"C:\Users\Default\AppData\Roaming\Microsoft\Windows\SendTo"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Set-GPLink</span></span> <span class="hljs-literal"><span class="hljs-literal">-Name</span></span> SendTo <span class="hljs-literal"><span class="hljs-literal">-Target</span></span> <span class="hljs-string"><span class="hljs-string">"ou=Users,dc=domain,dc=com"</span></span> <span class="hljs-literal"><span class="hljs-literal">-LinkEnabled</span></span> Yes</code> </pre> <br><p>  Sepertinya opsi hanya satu kunci.  Jika ada banyak tombol, maka untuk kenyamanan Anda harus menemukan kembali roda dan lagi mengkonversi file registri menjadi satu set cmdlet PowerShell. </p><br><p>  Anda dapat membaca lebih lanjut tentang bekerja dengan kebijakan grup dan mengotomatisasi semua ini di salah satu artikel sebelumnya, " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Menyelam ke Templat dan Menjinakkan GPO Windows.</a> "  Baiklah, saya akan berbicara tentang metode favorit saya. </p><br><h1 id="sposob-vtoroy-kopirovat--vstavit-pochti">  Cara kedua.  Salin - Tempel (hampir) </h1><br><p>  Seperti yang mungkin Anda perhatikan (saya tidak segera memperhatikan hal ini), tindakan pada objek, termasuk operasi papan klip standar, tersedia di snap-in Manajemen Kebijakan Grup. </p><br><p><img src="https://habrastorage.org/webt/pb/oo/ig/pbooigmglwta9oxe60bkdfckyvg.jpeg"><br>  <em>Menu konteks dalam pengaturan registri GPP.</em> </p><br><p>  Jika Anda menyalin objek ke clipboard dan menempelkannya, ternyata objek ini adalah file xml.  Ini berarti bahwa file dapat dibuat sebelumnya dan ditambahkan ke snap-in tanpa secara manual mengisi kolom. </p><br><p>  Untuk ini, Malcolm McCaffery menulis naskah khusus.  Ini menghasilkan file xml berdasarkan pada file registri yang diekspor.  Skrip dapat ditemukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di blog</a> penulis. </p><br><blockquote>  Skrip penulis berisi panggilan tambahan ke fungsi Convert-Reg2Xml dan blok parameter tambahan.  Kesalahan ini mudah diperbaiki selama pengujian berjalan melalui PowerShell ISE.  Namun, untuk berjaga-jaga, saya melempar versi yang sudah diperbaiki pada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pastebin</a> .  Ada juga garpu skrip ini di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github</a> , dan bahkan layanan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">online</a> yang melakukan hal yang sama. </blockquote><p>  Menggunakan skrip sangat sederhana. </p><br><pre> <code class="hljs powershell"><span class="hljs-built_in"><span class="hljs-built_in">Convert-Reg2Xml</span></span> <span class="hljs-literal"><span class="hljs-literal">-regPath</span></span> input.reg <span class="hljs-literal"><span class="hljs-literal">-xmlPath</span></span> output.xml</code> </pre> <br><p>  Xml yang dihasilkan bahkan dapat dengan mudah diseret ke bidang untuk pengaturan registri. </p><br><p>  Mari kita menganalisis contoh spesifik.  Pertama, ekspor cabang registri "benar".  Dalam contoh ini, kami akan membuat kebijakan untuk mengaktifkan tampilan file tersembunyi, folder, ekstensi, dan pada saat yang sama kami akan membuat autostart <strong>ctfmon.exe</strong> untuk secara mulus mengubah tata letak. </p><br><p>  File registri adalah sebagai berikut: </p><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">Software</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">CurrentVersion</span></span>\<span class="hljs-type"><span class="hljs-type">Explorer</span></span>\<span class="hljs-type"><span class="hljs-type">Advanced</span></span>] <span class="hljs-string"><span class="hljs-string">"Hidden"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> <span class="hljs-string"><span class="hljs-string">"HideFileExt"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> <span class="hljs-string"><span class="hljs-string">"ShowSuperHidden"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">Software</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">CurrentVersion</span></span>\<span class="hljs-type"><span class="hljs-type">Run</span></span>] <span class="hljs-string"><span class="hljs-string">"Language Bar"</span></span>=<span class="hljs-string"><span class="hljs-string">""</span></span>ctfmon”=”CTFMON.EXE”</code> </pre> <br><p>  Konversikan ke xml.  Jika Anda melihat file yang dihasilkan, itu akan menjadi seperti ini: </p><br><div class="spoiler">  <b class="spoiler_title">Daftar XML lengkap di bawah spoiler.</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{53B533F5-224C-47e3-B01B-CA3B3F3FF4BF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HKEY_CURRENT_USER"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{53B533F5-224C-47e3-B01B-CA3B3F3FF4BF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Software"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{53B533F5-224C-47e3-B01B-CA3B3F3FF4BF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{53B533F5-224C-47e3-B01B-CA3B3F3FF4BF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Windows"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{53B533F5-224C-47e3-B01B-CA3B3F3FF4BF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CurrentVersion"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{53B533F5-224C-47e3-B01B-CA3B3F3FF4BF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Explorer"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{53B533F5-224C-47e3-B01B-CA3B3F3FF4BF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Advanced"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Registry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9CD4B2F4-923D-47f5-A062-E897DD1DAD50}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">descr</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Imported Reg File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"17"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">hive</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HKEY_CURRENT_USER"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"REG_DWORD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">displayDecimal</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"00000001"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Registry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Registry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9CD4B2F4-923D-47f5-A062-E897DD1DAD50}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HideFileExt"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">descr</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Imported Reg File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"17"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">hive</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HKEY_CURRENT_USER"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HideFileExt"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"REG_DWORD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">displayDecimal</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"00000000"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Registry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Registry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9CD4B2F4-923D-47f5-A062-E897DD1DAD50}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowSuperHidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">descr</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Imported Reg File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"17"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">hive</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HKEY_CURRENT_USER"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowSuperHidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"REG_DWORD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">displayDecimal</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"00000001"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Registry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{53B533F5-224C-47e3-B01B-CA3B3F3FF4BF}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Run"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Registry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clsid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{9CD4B2F4-923D-47f5-A062-E897DD1DAD50}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Language Bar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">descr</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Imported Reg File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"7"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Properties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"U"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">hive</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HKEY_CURRENT_USER"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Software\Microsoft\Windows\CurrentVersion\Run"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Language Bar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">default</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"REG_SZ"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">displayDecimal</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ctfmon</span></span></span><span class="hljs-tag">”=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">”CTFMON.EXE”</span></span></span><span class="hljs-tag">" /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Registry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Collection</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><p>  Sekarang Anda cukup menempelkannya ke bidang pengaturan registri.  Keindahan ini akan berubah: </p><br><p><img src="https://habrastorage.org/webt/cz/nt/hv/cznthvtmsf2ptjtndzc2xag86cw.jpeg"><br>  <em>Kebijakan yang disesuaikan.</em> </p><br><p>  Dengan ketangkasan yang tepat, proses ini membutuhkan waktu lebih sedikit daripada membaca teks ini. </p><br><p>  Untuk meningkatkan kenyamanan, Anda dapat menambahkan item untuk file registri di menu konteks untuk mengonversi file secara umum dalam dua klik. </p><br><p>  Ini akan cukup untuk membuat jenis tindakan baru untuk objek bertipe <strong>regfile</strong> dan menulis path ke skrip yang diinginkan.  Demi kenyamanan Anda, saya telah mengkompilasi ini, tentu saja, ke dalam file registri: </p><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">Software</span></span>\<span class="hljs-type"><span class="hljs-type">Classes</span></span>\<span class="hljs-type"><span class="hljs-type">regfile</span></span>\<span class="hljs-type"><span class="hljs-type">shell</span></span>\<span class="hljs-type"><span class="hljs-type">convert2xml</span></span>] <span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>=<span class="hljs-string"><span class="hljs-string">"convert2xml"</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">Software</span></span>\<span class="hljs-type"><span class="hljs-type">Classes</span></span>\<span class="hljs-type"><span class="hljs-type">regfile</span></span>\<span class="hljs-type"><span class="hljs-type">shell</span></span>\<span class="hljs-type"><span class="hljs-type">convert2xml</span></span>\<span class="hljs-type"><span class="hljs-type">command</span></span>] <span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>=<span class="hljs-string"><span class="hljs-string">"powershell.exe -File C:\\temp\\script.ps1 %1"</span></span></code> </pre> <br><p>  Jalur ke skrip ditentukan pada baris terakhir. </p><br><p>  Agar skrip dapat menyelesaikan ini, Anda harus menambahkan baris berikut ke dalamnya: </p><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$output</span></span>=(<span class="hljs-built_in"><span class="hljs-built_in">Split-Path</span></span> <span class="hljs-literal"><span class="hljs-literal">-Path</span></span> <span class="hljs-variable"><span class="hljs-variable">$args</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>]) + <span class="hljs-string"><span class="hljs-string">"\output.xml"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Convert-Reg2Xml</span></span> <span class="hljs-literal"><span class="hljs-literal">-regPath</span></span> <span class="hljs-variable"><span class="hljs-variable">$args</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-literal"><span class="hljs-literal">-xmlPath</span></span> <span class="hljs-variable"><span class="hljs-variable">$output</span></span></code> </pre> <br><p>  Sekarang, ketika Anda memanggil menu konteks, item lain akan ditampilkan, ketika Anda mengkliknya, file xml yang kita butuhkan muncul di sebelah file registri. </p><br><p><img src="https://habrastorage.org/webt/_c/-r/5r/_c-r5rfiakfsyxt-665ur5o0lw0.jpeg"><br>  <em>Item menu konteks baru.</em> </p><br><p>  Tentu saja, untuk membuat perubahan sederhana pada registri pengguna dan komputer, mekanisme seperti itu berlebihan.  Tetapi untuk mengatur sejumlah besar parameter, peretasan ini sangat nyaman. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id419483/">https://habr.com/ru/post/id419483/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id419471/index.html">Opsi migrasi dari jQuery ke javascript murni</a></li>
<li><a href="../id419473/index.html">Bagaimana keadaan di cloud, dan apa yang mendorong IaaS maju: mendiskusikan tren teknologi</a></li>
<li><a href="../id419475/index.html">Cara menemukan inspirasi dan tidak kehilangan keunikan</a></li>
<li><a href="../id419477/index.html">Lebih mudah daripada kedengarannya. Bab 11</a></li>
<li><a href="../id419479/index.html">Keamanan "Ekaterinburg Arena": bagaimana kami mempersiapkan stadion untuk Piala Dunia 2018</a></li>
<li><a href="../id419485/index.html">Ada aplikasi untuk itu: pengumuman Mobius 2018 Moscow</a></li>
<li><a href="../id419491/index.html">Bagaimana STP Bekerja</a></li>
<li><a href="../id419493/index.html">Mengapa Anda perlu Splunk? Analisis Peristiwa Keamanan</a></li>
<li><a href="../id419495/index.html">Yang "menemukan" konduksi tulang, mengapa digunakan dan seberapa aman untuk pendengaran</a></li>
<li><a href="../id419503/index.html">Buku “Algoritma dan struktur data. Pengambilan Informasi Java »</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>