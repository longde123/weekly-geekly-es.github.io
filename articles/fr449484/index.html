<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÜüèø ‚ú≥Ô∏è üë®üèæ‚Äçü§ù‚Äçüë®üèº Nous cr√©ons un capteur de contr√¥le de la qualit√© de l'air sur InfluxDB, Grafana, Docker et Raspberry Pi üòé üë©üèΩ üö∂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Avez-vous d√©j√† pens√© √† surveiller la qualit√© de l'air √† l'int√©rieur ou √† l'ext√©rieur de votre maison: o√π habitez-vous et travaillez-vous? Ce projet, q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous cr√©ons un capteur de contr√¥le de la qualit√© de l'air sur InfluxDB, Grafana, Docker et Raspberry Pi</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449484/">  Avez-vous d√©j√† pens√© √† surveiller la qualit√© de l'air √† l'int√©rieur ou √† l'ext√©rieur de votre maison: o√π habitez-vous et travaillez-vous?  Ce projet, que nous avons baptis√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">balenaSense</a> , est une unit√© de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mesure de la</a> temp√©rature, de l'humidit√©, de la pression barom√©trique et de la qualit√© de l'air, ainsi qu'un tableau de bord auquel vous pouvez acc√©der de n'importe o√π pour consulter des statistiques r√©capitulatives et suivre les tendances. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ad/95d/d7a/9ad95dd7a878fefb4e5ea05732dba925.png"><br><a name="habracut"></a><br><h1>  Table des mati√®res </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pr√©sentation</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√âquipement n√©cessaire</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Logiciels</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Assemblage d'√©quipement</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Configurer Raspberry Pi</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">D√©ploiement de logiciels</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Afficher le tableau de bord</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment √ßa marche?</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Et ensuite?</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Derni√®res pens√©es</a> </li></ul><br><a name="1"></a><h1>  Pr√©sentation </h1><br>  Pour contr√¥ler la qualit√© de l'air et de la station m√©t√©o, de nombreux fils et divers capteurs sont n√©cessaires, mais la situation est devenue plus facile apr√®s l'apparition de capteurs qui combinent toutes les lectures sur une bonne petite planche, ce qui est facile au d√©part. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/462/14c/ff9/46214cff9e49ae84360e58fb5ebb4a4e.jpg"><br><br>  Envisagez de surveiller la temp√©rature, l'humidit√©, la pression barom√©trique et la qualit√© de l'air √† l'aide d'un capteur tout-en-un qui se connecte directement au Raspberry Pi sans composants suppl√©mentaires.  Vous n'avez besoin d'aucune exp√©rience en √©lectronique, mais un fer √† souder serait le bienvenu (bien qu'il soit √©galement optionnel).  Ce projet met en ≈ìuvre une base de donn√©es pour stocker les relev√©s historiques ainsi qu'une interface graphique pour visualiser les relev√©s actuels et voir imm√©diatement les tendances. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7d0/63e/8b2/7d063e8b2d6111ed55553a3b3e3c0a47.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce0/600/884/ce06008843e25c57e8b0979bce73b6b6.png"><br><br><a name="2"></a><h1>  √âquipement n√©cessaire </h1><br>  Voici ce que vous devez acheter pour ce projet.  Selon que vous souhaitez ou non utiliser un fer √† souder, nous choisissons une carte capteur: certaines fonctionnent tout de suite, d'autres n√©cessitent un peu de soudure. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/005/300/15d/00530015dce4ec449e0477a8d7bc6d14.jpg"><br><br><h3>  Je ne veux pas souder </h3><br>  Si vous ne souhaitez pas souder, vous aurez besoin de: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Raspberry Pi Zero WH</a> (2Bv1.2 / 3B / 3B + / 3A + convient √©galement) <br></li><li>  Carte Micro-SD 8 Go (ou plus), nous recommandons les cartes SD Sandisk Extreme Pro <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Alimentation et c√¢ble</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Capteur de carte de transition Pimoroni BME680</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pimoroni Breakout Garden pHAT</a> </li></ul><br><h3>  Je veux souder - donnez-moi! </h3><br>  Si vous √™tes heureux de prendre un fer √† souder, vous aurez besoin de: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Raspberry Pi Zero W</a> (2Bv1.2 / 3B / 3B + / 3A + convient √©galement) <br></li><li>  Carte Micro-SD 8 Go (ou plus), nous recommandons les cartes SD Sandisk Extreme Pro <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Alimentation et c√¢ble</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Capteur Bosch BME680 avec contremarche</a> (voir les alternatives ci-dessous) <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">C√¢ble de connexion</a> </li></ul><br><h3>  Autres capteurs </h3><br>  Si vous avez d√©j√† une sorte de capteur, ce projet prend en charge <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sense HAT</a> avec un bonus suppl√©mentaire: un smiley sur la matrice LED (en fonction de la qualit√© de l'air, bien s√ªr)! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ede/763/1ad/ede7631adecd352c97c0675c3adcde95.png"><br><br>  Bosch BME680 avec contremarche peut √™tre command√© aupr√®s de diff√©rents fournisseurs √† des prix diff√©rents. <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pimoroni BME680</a> 18,50 ¬£ (il peut y avoir une version sans soudure avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">leur pHAT</a> ) <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Adafruit BME680</a> 22,50 $ US <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sparkfun SparkX BME680</a> 19,95 $ US (il peut y avoir une version sans soudure avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">leur pHAT</a> ) <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sans nom BME680</a> US $ 9.92 </li></ul><br>  <b>Remarque</b>  Dans l'article, nous utilisons Pimoroni: cette carte a l'avantage suppl√©mentaire que les contacts sont rompus dans le bon ordre pour le Raspberry Pi GPIO.  Lorsque vous utilisez d'autres cartes, vous devez v√©rifier que les broches d'alimentation, de masse et de bus I2C (SDA et SCL) correspondent, comme expliqu√© plus loin dans le manuel. <br><br><a name="3"></a><h1>  Logiciels </h1><br>  Nous avons ouvert le projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">balena-sense</a> sur GitHub, qui contient tous les logiciels, la configuration et le code dont vous avez besoin pour un syst√®me fonctionnel.  Nous allons d√©ployer ce projet sur un compte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">balenaCloud</a> gratuit pour distribuer tous les logiciels du Raspberry Pi, ainsi que pour fournir un acc√®s √† distance.  Par cons√©quent, vous aurez besoin de: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Outil d'√©criture de</a> carte flash SD comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">balenaEtcher</a> <br></li><li>  Compte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">balenaCloud</a> gratuit <br></li><li>  Clonez ou t√©l√©chargez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">notre projet depuis GitHub</a> </li></ul><br><a name="4"></a><h1>  Assemblage d'√©quipement </h1><br>  Il y a peu de travail sur le front mat√©riel de ce projet.  Notre objectif est de connecter la carte capteur √† la broche GPIO du Raspberry Pi. <br><br>  Le BME680 communique avec le Raspberry Pi via un bus appel√© I2C (eye-squared-see), qui est un bus s√©rie √† deux fils.  Ces deux fils sont appel√©s ligne de synchronisation (SCK) et ligne de donn√©es (SDA).  En plus des deux fils, il est n√©cessaire d'alimenter le capteur (3,3V ou 3V3) et de le mettre √† la terre. <br><br>  Si vous choisissez l'option sans soudure de Pimoroni ou Sparkfun ou en utilisant le Sense HAT, connectez simplement les nouveaux composants brillants au Raspberry Pi et toutes les connexions seront faites pour vous: passez √† l'√©tape suivante! <br><br>  Si vous d√©cidez de connecter le capteur directement au Raspberry Pi √† l'aide de Pimoroni ou d'un autre riser, l'essentiel est d'assurer la bonne connexion des contacts d√©crits ci-dessus (SDA, SCK, 3V3 et GND). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/55f/165/c76/55f165c76f33633d3539393b1472d2f5.png"></div><br><br>  Un site utile pour travailler avec GPIO sur Raspberry Pi est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pinout.xyz</a> ;  cela montre clairement que nous avons besoin des broches 1 (alimentation 3V3), 3 (SDA), 5 (SCL) et 9 (masse).  Un GPIO √† 40 broches est standard sur Pi 2 et versions ult√©rieures.  Si vous utilisez une carte Pimoroni, les contacts sont dans le bon ordre pour connecter les cartes.  Remarquez comment l'inscription sur le tableau correspond au sch√©ma de brochage ci-dessus. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ebb/832/900/ebb832900d72244bfc6038de82e9164a.jpg"><br><br>  Mais si vous connectez le capteur de cette mani√®re, la chaleur du processeur Raspberry Pi affectera les lectures.  Pour collecter des lectures plus pr√©cises, vous devez retirer le capteur de la carte: nous le faisons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">avec des c√¢bles</a> m√®re-√†-m√®re (ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Jumper Jerky</a> ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DuPont</a> , comme indiqu√© ci-dessous: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4b6/5c1/45a/4b65c145a0bd694d5ca9e266d5771d1b.jpg"><br><br>  De m√™me, si vous utilisez un autre capteur, o√π les diagrammes de brochage ne correspondent pas exactement, vous pouvez connecter ces cartes au Pi en utilisant la m√™me m√©thode.  L'essentiel est de garantir la conformit√© avec 3V3, SDA, SCL et GND.  Si la carte a des contacts pour SDI, SDO, CS - vous pouvez les ignorer, car ils sont utilis√©s pour une interface SPI alternative, que nous n'utilisons pas dans ce projet. <br><br>  Sur les photos ci-dessus, nous avons le Raspberry Pi 3A +, mais Pi Zero est √©galement une solution moins ch√®re. <br><br><a name="5"></a><h1>  Configurer Raspberry Pi </h1><br>  Nous allons flasher la carte SD avec le syst√®me d'exploitation balenaOS, l'attacher au cloud balenaCloud, y ajouter notre appareil et configurer le projet afin qu'il puisse √™tre facilement mis √† jour plus tard. <br><br>  Vous devez d'abord configurer un compte balenaCloud.  Cela signifie enregistrer, ajouter une application et ajouter un appareil. <br><br><h3>  √âtape 1. Inscrivez-vous √† balenaCloud </h3><br>  Si vous avez d√©j√† un compte GitHub ou Google, vous pouvez l'utiliser pour vous connecter sans passer par le processus d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">inscription</a> . <br><br><h3>  √âtape 2. Cr√©ation de l'application </h3><br>  Ajoutez l'application en s√©lectionnant le type d'appareil correct et <code>Starter</code> comme type d'application, puis cliquez sur <code>Create New Application</code> .  Ce type prend en charge tous les microservices et est gratuit jusqu'√† dix appareils. <br><br>  Ensuite, vous serez redirig√© vers le tableau de bord de l'application nouvellement cr√©√©e, o√π vous pourrez passer √† l'√©tape suivante et ajouter l'appareil.  Vous pouvez donner √† l'application un nom arbitraire, mais vous en aurez besoin plus tard dans le manuel lorsque nous √©crirons le code. <br><br><h3>  √âtape 3. Ajoutez l'appareil et d√©marrez le syst√®me d'exploitation </h3><br>  Apr√®s avoir cr√©√© l'application, vous pouvez ajouter un appareil √† cette application en cliquant sur le bouton vert <i>Ajouter un appareil</i> .  Lors de l'ajout d'un p√©riph√©rique, sp√©cifiez le type de p√©riph√©rique correct.  Si vous vous connectez √† un r√©seau sans fil, vous pouvez d√©finir votre SSID WiFI et votre phrase secr√®te. <br><br>  <b>Remarque:</b> Raspberry Pi 3 est indiqu√© dans l'animation, n'oubliez pas de s√©lectionner le bon type de votre appareil! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e74/09c/595/e7409c595001458580b80e39809973a6.gif"><br><br>  Ce processus cr√©e une image personnalis√©e pour l'application et le type de p√©riph√©rique, qui inclut les param√®tres r√©seau, le cas √©ch√©ant. <br><br>  <b>Remarque:</b> pour commencer, il est pr√©f√©rable de choisir une image de d√©veloppement pour effectuer certains tests et d√©panner.  Pour plus d'informations sur les diff√©rences entre les images de d√©veloppement et de production, voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Si vous √™tes s√ªr de pouvoir commencer √† d√©ployer une image de production d√®s maintenant - veuillez. <br><br><h3>  √âtape 4. Enregistrez la carte SD et le p√©riph√©rique de d√©marrage </h3><br>  Lorsque l'image du syst√®me d'exploitation est charg√©e, il est temps de flasher la carte SD.  Vous pouvez utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">balenaEtcher</a> pour cela. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a57/b06/e30/a57b06e30b246d399ee8f8ef47c3b03f.gif"><br><br>  Une fois le processus termin√©, ins√©rez la carte SD dans le Raspberry Pi et connectez la source d'alimentation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/845/649/28f/84564928f5f8fc0e7907089bc0818870.gif"><br><br>  Lorsque l'appareil d√©marre pour la premi√®re fois, il se connecte au tableau de bord balenaCloud, apr√®s quoi vous pouvez le voir dans la liste en ligne et passer √† l'√©tape suivante. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/740/785/d6c/740785d6c8aef63170470b81139a1a7b.png"><br><br>  <b>D√©pannage: l'</b> appareil devrait appara√Ætre sur le panneau dans quelques minutes.  S'il n'appara√Æt pas, quelque chose s'est mal pass√©.  La documentation contient un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">guide de d√©pannage</a> complet avec de nombreuses informations sur les raisons de ce <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">probl√®me</a> .  Si la documentation n'a pas aid√©, veuillez contacter les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">forums</a> . <br><br><a name="6"></a><h1>  D√©ploiement de logiciels </h1><br>  Lorsque votre Raspberry Pi est pr√©par√©, t√©l√©charg√© et connect√© √† balenaCloud, vous √™tes pr√™t √† installer le code d'application sur l'appareil. <br><br><h4>  Installer les outils CLI de Balena sur un poste de travail </h4><br>  BalenaCloud vous permet de transf√©rer √† distance le logiciel / code d'application vers le Raspberry Pi et d'autres appareils.  Pour rendre cela possible, votre station de travail (pas le Raspberry Pi) doit r√©pondre √† certaines exigences logicielles minimales.  <b>Remarque:</b> pour d√©ployer ce projet avec succ√®s, vous n'avez pas besoin d'ex√©cuter de commandes sur le p√©riph√©rique lui-m√™me, via SSH ou √† partir du tableau de bord balenaCloud.  Tout se fait √† distance! <br><br>  Si vous avez d√©j√† (ou vous pouvez configurer) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">npm</a> sur votre ordinateur, c'est le moyen le plus rapide d'ex√©cuter les outils CLI.  Il existe √©galement des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">binaires pour Windows, macOS et Linux</a> .  <b>Remarque:</b> si vous avez d√©j√† install√© ces outils pour nos autres projets, vous pouvez ignorer cette partie et passer directement √† l'√©tape suivante. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La documentation des outils CLI</a> d√©crit l'installation et la configuration du package npm, ainsi que les binaires. <br><br>  Lorsque la CLI est install√©e et en cours d'ex√©cution, la premi√®re √©tape consiste √† se connecter √† balenaCloud en ex√©cutant la commande de <code>balena login</code> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ebe/2dd/a9e/ebe2dda9e415ee46f57ec346b89e0360.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c8e/7ef/cda/c8e7efcda08bb42ef11aadfb231d5706.png"><br><br>  Lorsqu'une CLI fonctionnelle est enregistr√©e dans le compte, vous √™tes pr√™t √† installer des programmes sur le Raspberry Pi. <br><br><h4>  T√©l√©chargement d'un projet depuis GitHub </h4><br>  L'√©tape suivante consiste √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">t√©l√©charger le code de ce projet depuis GitHub</a> . <br><br>  Le bouton bleu chargera le fichier zip du projet, mais si vous √™tes d√©j√† familier avec Git, vous pouvez utiliser <code>git clone</code> mani√®re habituelle. <br><br><h4>  Installer sur Raspberry Pi </h4><br>  √âtant donn√© que la CLI et le dernier code sont install√©s, vous pouvez ex√©cuter ce code sur balenaCloud avec une seule commande.  L√†, l'image Docker est collect√©e et configur√©e, qui s'ex√©cutera sur votre appareil. <br><br>  Dans le r√©pertoire du projet apr√®s l'avoir d√©compress√©, ex√©cutez la commande <code>balena push &lt;appName&gt;</code> , o√π appName est le nom de l'application sp√©cifi√© au d√©but du manuel.  Par exemple, <code>balena push balenaSense</code> . <br><br>  Si tout est fait correctement, apr√®s quelques minutes, l'√©cran d'informations de votre appareil sur le panneau de commande devrait afficher les services en cours d'ex√©cution, un pour chacun des composants logiciels, quelque chose comme ceci: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/452/08c/652/45208c6529a5735789917e8ca2783b8b.png"><br><br>  La premi√®re fois que le t√©l√©chargement peut prendre plusieurs minutes (selon la vitesse de votre connexion Internet), mais seules les modifications dans le conteneur sont t√©l√©charg√©es, donc tout se passe beaucoup plus rapidement. <br><br>  <b>Remarque:</b> lorsque l'application d√©marre pour la premi√®re fois (et que vous utilisez BME680, et non Sense HAT), le capteur effectue un ¬´rodage¬ª pendant environ cinq minutes.  Pendant cette p√©riode, les lectures <i>ne seront pas</i> prises et ins√©r√©es dans la base de donn√©es.  L'application enregistrera le compte √† rebours, qui s'affiche dans le panneau balenaCloud: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/607/cd8/809/607cd8809b0176d8cb5888f9ae766fc3.png"><br><br>  Lorsque le compte atteint z√©ro, vous verrez le message 'Boucle de d√©marrage ...'.  Apr√®s cela, les lectures seront prises et ins√©r√©es dans la base de donn√©es toutes les 10 secondes. <br><br><a name="7"></a><h1>  Afficher le tableau de bord </h1><br>  J'esp√®re que vous avez flash√© l'appareil, connect√© au r√©seau et d√©marr√© sans aucun probl√®me.  L'un des grands avantages de l'utilisation d'un compte balenaCloud gratuit est la <code>Public Device URL</code> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/75e/0be/d3f/75e0bed3f3dccd7b2d43baa9a84b8134.png"><br><br>  Activez ce commutateur et cliquez sur l'ic√¥ne de fl√®che bleue pour acc√©der au tableau de bord.  Vous pouvez partager ce lien ou le mettre en signet sur votre t√©l√©phone ou un autre appareil.  Pendant que l'appareil balenaSense est connect√© et fonctionne, vous pouvez consulter le tableau de bord de n'importe o√π! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce0/600/884/ce06008843e25c57e8b0979bce73b6b6.png"><br><br>  Si vous ne souhaitez pas activer l'acc√®s public, vous pouvez toujours afficher le tableau de bord √† partir de votre propre r√©seau local par adresse IP, comme le montre la capture d'√©cran ci-dessus.  Le v√¥tre sera diff√©rent, mais entrez simplement <code>http://&lt;ip-&gt;</code> dans le navigateur, et vous aurez toujours acc√®s au tableau de bord si vous √™tes sur le m√™me r√©seau que l'appareil.  Par exemple, pour acc√©der √† mon appareil, <code>http://10.1.231.36</code> . <br><br>  Si vous souhaitez vous connecter √† Grafana et jouer avec les param√®tres, les informations d'identification par d√©faut sont <code>admin</code> et <code>admin</code> . <br><br><a name="8"></a><h1>  Comment √ßa marche? </h1><br>  Ce projet comprend trois composantes principales, trois services.  Ces noms figurent sur le tableau de bord de balenaCloud: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">InfluxDB</a> - une base de donn√©es utilis√©e pour stocker les lectures des capteurs <br></li><li>  Capteur - biblioth√®que Python et code pour acc√©der au capteur, prendre des lectures et les enregistrer dans la base de donn√©es <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Grafana</a> - utilis√© pour cr√©er un tableau de bord avec des graphiques et des rapports </li></ul><br>  Le capteur BME680 de Bosch d√©tecte la temp√©rature, l'humidit√©, la pression et la r√©sistance aux gaz.  Les capteurs de temp√©rature, d'humidit√© et de pression fonctionnent d√®s la sortie de l'emballage, mais les relev√©s de r√©sistance aux gaz seuls ne sont pas tr√®s utiles.  Ce sont des indicateurs de changements dans la composition de l'air.  Lorsque le capteur d√©marre, il d√©finit la base, puis surveille les modifications.  Les indicateurs indicatifs de la qualit√© de l'air sont donn√©s en pourcentage et tiennent compte de l'influence de l'humidit√© et de la r√©sistance aux gaz. <br><br>  Si vous utilisez le Sense HAT, o√π il n'y a pas de capteur de r√©sistance aux gaz, nous approchons les lectures de la qualit√© de l'air en fonction des valeurs de temp√©rature et d'humidit√© cibles. <br><br><a name="9"></a><h1>  Et ensuite? </h1><br>  J'esp√®re que vous avez maintenant compl√®tement lanc√© le projet, acc√©d√© au tableau de bord, pris des lectures et commenc√© √† remplir votre base de donn√©es.  Mentionnez des choses plus importantes. <br><br><h3>  Changer le mot de passe </h3><br>  Si vous ouvrez l'appareil pour un acc√®s public, il est recommand√© de changer le mot de passe de Grafana. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f5/bb8/75e/3f5bb875e74b17bf2eff4447f1245212.png"><br><br>  Nous avons configur√© le syst√®me avec le nom d'utilisateur et le mot de passe par d√©faut <code>admin</code> <code>admin</code> .  Pour les modifier, connectez-vous √† Grafana en utilisant le bouton dans le coin inf√©rieur gauche du panneau.  Vous serez invit√© √† modifier le mot de passe lors de votre premi√®re connexion. <br><br><h3>  Personnalisation </h3><br>  Le programme Grafana pour le tableau de bord et les rapports contient de nombreux param√®tres et param√®tres de configuration.  Nous avons cr√©√© un panneau de base qui pr√©sente un tableau et un graphique pour chacune des quatre options de mesure. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ca/cab/417/9cacab417c06bb7568701a26bfa5f2b2.png"><br><br>  Vous pouvez personnaliser chaque panneau Grafana en survolant le titre et en passant √† l'√©dition.  Je recommande de jouer avec les param√®tres - les modifications dans le tableau de bord ne sont pas enregistr√©es automatiquement, donc si vous faites une erreur, rechargez simplement la page, et tout reviendra √† sa forme d'origine.  Si vous souhaitez enregistrer les modifications, cliquez sur <i>Enregistrer</i> en haut du panneau de configuration et tous les param√®tres seront enregistr√©s sur votre appareil. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b5b/036/336/b5b03633659cfdf57133ba45f598f94c.png"><br><br>  Vous pouvez √©galement configurer les capteurs.  Par exemple, sur le diagramme du manom√®tre, nous avons configur√© plusieurs plages de base et valeurs de texte au lieu de chiffres.  Tout cela change √† votre go√ªt! <br><br><h3>  Logement </h3><br>  Ces capteurs sont id√©aux pour √™tre plac√©s dans une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cabine m√©t√©orologique</a> , qui prot√®ge les capteurs de la lumi√®re du soleil et de la chaleur rayonn√©e.  Si vous contr√¥lez l'environnement dans la pi√®ce, ce n'est pas si important, mais si le capteur est install√© √† l'ext√©rieur, son positionnement et sa protection sont importants pour obtenir des lectures pr√©cises. <br><br>  Les cabines m√©t√©o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sont en vente</a> , mais elles peuvent √™tre assez ch√®res, alors pensez aux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">options de bricolage</a> . <br><br>  Thingiverse poss√®de plusieurs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">b√¢timents BME680</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cabines m√©t√©o</a> . <br><br><a name="10"></a><h1>  Derni√®res pens√©es </h1><br>  Merci d'avoir lu!  Si vous d√©cidez de construire votre propre station m√©t√©orologique avec contr√¥le de la qualit√© de l'air - dites-nous comment tout s'est pass√©, quels probl√®mes sont survenus.  Des id√©es pour le d√©veloppement de notre projet peuvent √™tre exprim√©es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur les forums</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr449484/">https://habr.com/ru/post/fr449484/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr449468/index.html">Comment le "piratage √©thique" du fabricant de logiciels de jeu s'est transform√© en cauchemar complet</a></li>
<li><a href="../fr449472/index.html">Cataclysm Dark Days Ahead, analyse statique et bagels</a></li>
<li><a href="../fr449476/index.html">Un nouveau type de stockage SSD r√©duira la consommation d'√©nergie dans le centre de donn√©es - comment cela fonctionne</a></li>
<li><a href="../fr449478/index.html">Ajouter UICollectionViews √† un UITableViewCell personnalis√© qui se fait via Xib</a></li>
<li><a href="../fr449480/index.html">Choisissez le suivi de bogue appropri√©</a></li>
<li><a href="../fr449486/index.html">Exode massif des jeux par navigateur</a></li>
<li><a href="../fr449488/index.html">Cataclysm Dark Days Ahead: analyse statique et jeux Roguelike</a></li>
<li><a href="../fr449490/index.html">Slurm: Intense par Kubernetes. Programme et bonus</a></li>
<li><a href="../fr449494/index.html">Interfaces IA et o√π elles vivent</a></li>
<li><a href="../fr449496/index.html">Hackathon DevDays'19 (partie 2): analyseur de messages sonores pour la v√©rification des t√©l√©grammes et de la grammaire dans IntelliJ IDEA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>