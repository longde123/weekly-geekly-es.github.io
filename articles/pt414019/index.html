<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õπüèø ü¶í üòá Solu√ß√£o universal para UITableViewRowAction e UIContextualAction üñïüèæ üçá üö´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Muitos encontraram o problema de implementar um mapeamento de bot√£o bonito para um UITableViewCell quando deslocado para a esquerda. Alguns usavam a f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Solu√ß√£o universal para UITableViewRowAction e UIContextualAction</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tinkoff/blog/414019/"><img src="https://habrastorage.org/webt/ij/w5/3b/ijw53blhrl4aftmlr8hv6iymiu8.jpeg"><br><br>  Muitos encontraram o problema de implementar um mapeamento de bot√£o bonito para um UITableViewCell quando deslocado para a esquerda.  Alguns usavam a funcionalidade padr√£o "pronta para uso", outros se preocupavam com sua pr√≥pria implementa√ß√£o, enquanto outros gerenciavam com caracteres Unicode.  Neste artigo, mostrarei como obter a personaliza√ß√£o m√°xima do UITableViewRowAction. <br><a name="habracut"></a><br>  Primeiro, um pouco de teoria: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">UITableViewRowAction</a> √© uma classe que permite ao usu√°rio executar determinadas a√ß√µes com essa c√©lula ao mover uma c√©lula para a esquerda (como excluir, alterar etc.).  Cada inst√¢ncia desta classe representa uma a√ß√£o a ser executada e inclui texto, estilo e um manipulador de cliques.  O iOS SDK nos permite personalizar o UITableViewRowAction da seguinte maneira: <br><br><pre><code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">convenience</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(style: <span class="hljs-type"><span class="hljs-type">UITableViewRowActionStyle</span></span>, title: <span class="hljs-type"><span class="hljs-type">String?</span></span>, handler: @escaping (<span class="hljs-type"><span class="hljs-type">UITableViewRowAction</span></span>, <span class="hljs-type"><span class="hljs-type">IndexPath</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">Swift</span></span>.<span class="hljs-type"><span class="hljs-type">Void</span></span>)</code> </pre> <br>  Voc√™ tamb√©m pode definir backgroundColor. <br><br><h3>  M√©todos existentes. </h3><br>  Considere os exemplos de implementa√ß√£o existentes, ou o que encontrei na Internet. <br>  <strong>M√©todo n√∫mero 1</strong> .  Use a funcionalidade "pronto para uso".  Isso √© suficiente para usar bot√µes comuns com texto e plano de fundo.  Parece muito simples e chato: <br><img src="https://habrastorage.org/webt/nw/1a/zu/nw1azubhwsv2ak9tpiaq39jamma.jpeg"><br><br>  <strong>M√©todo n√∫mero 2</strong> .  Defina backgroundColor usando <em>UIColor (patternImage: UIImage)</em> .  Isso alcan√ßar√° a beleza, mas privar√° a versatilidade, acrescentar√° uma s√©rie de restri√ß√µes e dificuldades.  Como a largura da UITableViewRowAction √© calculada pelo tamanho do texto, √© necess√°rio especificar o <em>t√≠tulo</em> como um conjunto de caracteres de espa√ßo em branco de uma determinada largura.  N√£o poderemos usar esse m√©todo para c√©lulas com alturas din√¢micas.  Se a c√©lula aumentar de altura, ser√° algo como isto: <br><br><img src="https://habrastorage.org/webt/ni/k3/fm/nik3fmelwkdx6vzqc0f1k_ipxhm.jpeg"><br><br>  <strong>M√©todo n√∫mero 3</strong> .  Use caracteres Unicode.  N√£o h√° necessidade de calcular o tamanho do texto com espa√ßos, e esse m√©todo √© adequado para c√©lulas com altura din√¢mica.  Parece bom: <br><br><img src="https://habrastorage.org/webt/jy/f7/j8/jyf7j8qnr-dupmrdtiycimemysa.jpeg"><br><br>  Mas se quisermos colocar o texto embaixo do √≠cone, esse m√©todo n√£o ser√° adequado para n√≥s. <br><br>  <strong>M√©todo n√∫mero 4</strong> .  Use CoreGraphics para renderizar componentes da interface do usu√°rio.  A id√©ia √© desenhar manualmente uma imagem com a disposi√ß√£o desejada dos elementos (texto e imagem).  Nesse caso, voc√™ precisa calcular os tamanhos e coordenadas para a localiza√ß√£o de cada elemento.  Usando esse m√©todo, podemos criar texto e imagem, organizando-os conforme necess√°rio.  Mas esse m√©todo √© dif√≠cil de implementar.  Queremos algo mais simples. <br><br>  <strong>Outras implementa√ß√µes</strong> .  Existem mais algumas solu√ß√µes prontas.  Eles usam sua pr√≥pria implementa√ß√£o da c√©lula com a adi√ß√£o de ScrollView e outra l√≥gica.  Por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SwipeCellKit</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MGSwipeTableCell</a> .  Mas essas solu√ß√µes n√£o permitem alcan√ßar o comportamento padr√£o do iOS; elas cobrem apenas uma c√©lula, ao contr√°rio do UITableViewRowAction, criado no delegado da tabela.  Por exemplo, usando uma dessas solu√ß√µes, se voc√™ abrir a√ß√µes para o turno esquerdo para v√°rias c√©lulas, precisar√° fechar manualmente essas a√ß√µes em cada uma delas, o que √© extremamente inconveniente.  Para fazer isso, voc√™ precisa adicionar sua pr√≥pria l√≥gica para controlar as a√ß√µes abertas em um furto.  Queremos criar uma solu√ß√£o simples que n√£o exija custos adicionais, como se estiv√©ssemos usando a implementa√ß√£o padr√£o de UITableViewRowAction. <br><br><h3>  Vamos come√ßar </h3><br>  Vamos tentar criar uma solu√ß√£o universal que permita criar UITableViewRowAction com qualquer design necess√°rio. <br><br>  Crie nossa classe descendente de UITableViewRowAction e defina o m√©todo de cria√ß√£o da inst√¢ncia principal: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">typealias</span></span> <span class="hljs-type"><span class="hljs-type">RowActionTapHandler</span></span> = (<span class="hljs-type"><span class="hljs-type">RowAction</span></span>, <span class="hljs-type"><span class="hljs-type">IndexPath</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RowAction</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITableViewRowAction</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rowAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with actionHandler: @escaping RowActionTapHandler)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Self</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rowAction = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(style: .<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, title: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { action, indexPath <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> action = action <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">RowAction</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } actionHandler(action, indexPath) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rowAction } }</code> </pre><br>  Como UITableViewRowAction n√£o possui um inicializador prim√°rio, por conveni√™ncia, podemos criar um m√©todo est√°tico em que, por dentro, criamos um UITableViewRowAction de maneira padr√£o e lan√ßamos um actionHandler para manipular o clique. <br><br>  Agora vamos tentar obter uma personaliza√ß√£o universal do bot√£o UITableViewRowAction.  A id√©ia √© obter a apar√™ncia do bot√£o no UIView finalizado (que pode ser configurado em um xib regular).  Assim, podemos criar um bot√£o de qualquer tipo, com base nas prefer√™ncias individuais (qualquer fonte do texto, tamanho e disposi√ß√£o dos elementos, etc.). <br><br>  Temos duas coisas que podemos alterar em UITableViewRowAction: <em>backgroundColor</em> e <em>title</em> .  No momento, a √∫nica maneira de alterar a apar√™ncia do bot√£o UITableViewRowAction √© alterar a propriedade backgroundColor.  Portanto, nosso objetivo √© transformar: UIView -&gt; UIImage -&gt; UIColor.  Podemos obter a cor usando a imagem da seguinte maneira: <em>UIColor (patternImage: UIImage)</em> .  E podemos obter a imagem do UIView renderizando-a usando a estrutura padr√£o CoreGraphics. <br><br>  Mas primeiro vamos decidir como definir o tamanho do bot√£o: "pronto para uso" n√£o existe essa funcionalidade, e o tamanho em UITableViewRowAction √© calculado pelo tamanho do texto do campo de t√≠tulo. <br><br>  Ap√≥s realizar experimentos (medindo a largura calculada e real do bot√£o), encontrei um caractere Unicode em branco com a menor largura diferente de zero: <em>U + 200A</em> <br><br>  Vamos us√°-lo e criar uma constante: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Constants</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> placeholderSymbol = <span class="hljs-string"><span class="hljs-string">"\u{200A}"</span></span> }</code> </pre><br>  Escreveremos uma fun√ß√£o para obter uma sequ√™ncia de caracteres de espa√ßo em branco correspondente ao tamanho que precisamos: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> placeholderSymbolWidth: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span> = { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> flt_max = <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>.greatestFiniteMagnitude <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> maxSize = <span class="hljs-type"><span class="hljs-type">CGSize</span></span>(width: flt_max, height: flt_max) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> attributes = [<span class="hljs-type"><span class="hljs-type">NSFontAttributeName</span></span> : <span class="hljs-type"><span class="hljs-type">UIFont</span></span>.systemFont(ofSize: <span class="hljs-type"><span class="hljs-type">UIFont</span></span>.systemFontSize)] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> boundingRect = <span class="hljs-type"><span class="hljs-type">Constants</span></span>.placeholderSymbol.boundingRect(with: maxSize, options: .usesLineFragmentOrigin, attributes: attributes, context: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> boundingRect.width }() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">emptyTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size: CGSize)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> usefulWidth = size.width - <span class="hljs-type"><span class="hljs-type">Constants</span></span>.minimalActionWidth usefulWidth = usefulWidth &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : usefulWidth <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> countOfSymbols = <span class="hljs-type"><span class="hljs-type">Int</span></span>(floor(usefulWidth * <span class="hljs-type"><span class="hljs-type">Constants</span></span>.shiftFactor / <span class="hljs-type"><span class="hljs-type">RowAction</span></span>.placeholderSymbolWidth)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">String</span></span>(repeating: <span class="hljs-type"><span class="hljs-type">Constants</span></span>.placeholderSymbol, <span class="hljs-built_in"><span class="hljs-built_in">count</span></span>: countOfSymbols) }</code> </pre><br>  A vari√°vel <em>placeholderSymbolWidth</em> obt√©m a largura do nosso caractere Unicode e a fun√ß√£o <em>emptyTitle (para tamanho: CGSize) -&gt; String</em> calcula o n√∫mero de caracteres de espa√ßo em branco correspondente ao tamanho do <em>tamanho</em> e retorna uma sequ√™ncia desses caracteres.  A f√≥rmula acima usa a constante <em>shiftFactor</em> .  Este √© o coeficiente de desvio da largura do valor nominal.  O fato √© que, √† medida que a largura da UITableViewRowAction aumenta, um pequeno erro aumenta (ou seja, a largura real do bot√£o difere da largura calculada pela f√≥rmula usual).  Para evitar isso, usamos essa constante, derivada experimentalmente. <br><br>  O UITableViewRowAction tamb√©m possui uma largura m√≠nima de 30 (por exemplo, se voc√™ definir title = "").  Essa largura √© o m√≠nimo necess√°rio para o recuo √† esquerda e √† direita do t√≠tulo. <br>  Atualize nossas constantes: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Constants</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> placeholderSymbol = <span class="hljs-string"><span class="hljs-string">"\u{200A}"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> minimalActionWidth: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span> = <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> shiftFactor: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span> = <span class="hljs-number"><span class="hljs-number">1.1</span></span> }</code> </pre><br>  Agora vamos obter a imagem do UIView.  Vamos escrever a seguinte fun√ß√£o: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">image</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(from view: UIView)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIImage?</span></span> { <span class="hljs-type"><span class="hljs-type">UIGraphicsBeginImageContextWithOptions</span></span>(view.bounds.size, view.isOpaque, <span class="hljs-type"><span class="hljs-type">UIScreen</span></span>.main.scale) <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> context = <span class="hljs-type"><span class="hljs-type">UIGraphicsGetCurrentContext</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">assertionFailure</span></span>(<span class="hljs-string"><span class="hljs-string">"Something wrong with CoreGraphics image context"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } context.setFillColor(<span class="hljs-type"><span class="hljs-type">UIColor</span></span>.white.cgColor) context.fill(<span class="hljs-type"><span class="hljs-type">CGRect</span></span>(origin: .zero, size: view.bounds.size)) view.layer.render(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: context) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> img = <span class="hljs-type"><span class="hljs-type">UIGraphicsGetImageFromCurrentImageContext</span></span>() <span class="hljs-type"><span class="hljs-type">UIGraphicsEndImageContext</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> img }</code> </pre><br>  Esta fun√ß√£o converte nossa <em>vis√£o</em> em uma imagem.  Nesse caso, o tamanho da imagem corresponde ao tamanho da <em>visualiza√ß√£o</em> . <br><br>  A √∫ltima etapa permanece, onde implementamos o m√©todo para definir UITableViewRowAction usando UIView: <br><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupForCell</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with view: UIView)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> img = image(from: view) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.title = emptyTitle(<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: img.size) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.backgroundColor = <span class="hljs-type"><span class="hljs-type">UIColor</span></span>(patternImage: img) }</code> </pre><br>  Aqui, usamos as fun√ß√µes escritas anteriormente para configurar nosso bot√£o e definir o <em>backgroundColor</em> usando a imagem resultante. <br><br>  S√≥ isso.  Temos uma solu√ß√£o universal para UITableViewRowAction e agora podemos personaliz√°-la de qualquer forma usando o UIView. <br><br><img src="https://habrastorage.org/webt/vq/om/jh/vqomjhu5tyowfttayuyddmgqqwu.jpeg"><br><br>  A partir do iOS 11, a Apple adicionou uma nova classe para a√ß√£o de furto para c√©lulas na tabela - UIContextualAction.  Ele permite que voc√™ especifique imediatamente a imagem que ser√° exibida na a√ß√£o durante o furto (√© isso que perdemos durante todos esses anos de uso de UITableViewRowAction).  Ele deveria facilitar nossa vida, mas, al√©m de uma nova oportunidade, ele criou problemas adicionais.  Essa classe imp√µe restri√ß√µes ao tamanho da imagem, n√£o permite o uso de texto e imagem ao mesmo tempo e tamb√©m deve ter um formato especial (imagem do modelo).  Portanto, finalizei minha solu√ß√£o para oferecer suporte a a√ß√µes de furto no iOS 11. Agora, para criar uma UITableViewRowAction ou UIContextualAction, primeiro voc√™ precisa criar a f√°brica RowActionFactory, configur√°-la usando nossa view (como fizemos acima no <em>m√©todo setupForCell (com view: UIView))</em> e retorne a entidade que precisamos: UITableViewRowAction ou UIContextualAction (usando os <em>m√©todos rowAction ()</em> ou <em>contextualAction (para indexPath: IndexPath),</em> respectivamente).  A seguir, √© apresentado um exemplo do uso de RowActionFactory: <br><br><pre> <code class="hljs julia"><span class="hljs-meta"><span class="hljs-meta">@available</span></span>(iOS <span class="hljs-number"><span class="hljs-number">11.0</span></span>, *) func tableView(_ tableView: UITableView, trailingSwipeActionsConfigurationForRowAt indexPath: IndexPath) -&gt; UISwipeActionsConfiguration? { var contextualActions: [UIContextualAction] = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> actionType <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rowActionTypes { // actionType -     <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rowActionFactory = RowActionFactory { (indexPath) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tableView.setEditing(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, animated: <span class="hljs-literal"><span class="hljs-literal">true</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rowActionView = &lt;...&gt; //  UIView     rowActionFactory.setupForCell(with: rowActionView) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> contextualAction = rowActionFactory.contextualAction(<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: indexPath) { contextualActions.append(contextualAction) } } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> swipeActionsConfiguration = UISwipeActionsConfiguration(actions: contextualActions) swipeActionsConfiguration.performsFirstActionWithFullSwipe = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> swipeActionsConfiguration }</code> </pre><br>  A solu√ß√£o final pode ser encontrada aqui: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">TCSCustomRowActionFactory (github.com)</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt414019/">https://habr.com/ru/post/pt414019/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt413991/index.html">Corrija-me se puder: como estamos depurando a produ√ß√£o. Parte 2</a></li>
<li><a href="../pt414001/index.html">Como sobreviver em um mundo em mudan√ßa de desenvolvimento</a></li>
<li><a href="../pt414003/index.html">Os trens s√£o diferentes. Muito</a></li>
<li><a href="../pt414009/index.html">Os 8 melhores recursos para pr√°ticas de programa√ß√£o em 2018</a></li>
<li><a href="../pt414011/index.html">Eu posso me tornar Apple, e voc√™ tamb√©m</a></li>
<li><a href="../pt414023/index.html">Pergunte a Ethan: Qu√£o r√°pido a vida poderia ter aparecido no universo?</a></li>
<li><a href="../pt414025/index.html">Os empregadores rastreiam computadores, viagens ao banheiro e agora tamb√©m emo√ß√µes; Seu chefe segue voc√™?</a></li>
<li><a href="../pt414027/index.html">Meus amigos podem ser considerados verdadeiros amigos?</a></li>
<li><a href="../pt414029/index.html">Luz misteriosa ao redor de uma estrela rec√©m-formada, e o que os astr√¥nomos pensam sobre ela</a></li>
<li><a href="../pt414031/index.html">Ap√≥s a reuni√£o "Novos recursos do PostgreSQL 11"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>