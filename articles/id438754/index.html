<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖐🏻 😼 🧝🏼 Bagaimana kami melakukan pemantauan jaringan untuk 14.000 objek 😙 🧘🏾 🍗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami memiliki 14.000 objek, zabbix, api, python, dan keengganan untuk menambahkan objek dengan tangan. Di bawah potongan - tentang bagaimana manajer j...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana kami melakukan pemantauan jaringan untuk 14.000 objek</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/X5RetailGroup/blog/438754/">  Kami memiliki 14.000 objek, zabbix, api, python, dan keengganan untuk menambahkan objek dengan tangan.  Di bawah potongan - tentang bagaimana manajer jaringan menerapkan pemantauan dengan penambahan otomatis node jaringan, dan sedikit tentang rasa sakit yang harus saya alami. <br><br>  Artikel ini lebih berfokus pada insinyur jaringan dengan sedikit pengalaman python.  Untuk membantu otomatisasi pemantauan dan peningkatan kualitas hidup dan pekerjaan, dengan tidak adanya kebutuhan untuk memperbarui secara manual seluruh armada benda. <br><br><img src="https://habrastorage.org/webt/mw/-u/ev/mw-uevvuik_o6poo21krw2rt0gy.jpeg"><br><a name="habracut"></a><br><h2>  Singkat cerita, kami telah membangun pemantauan </h2><br>  Hai  Nama saya Alexander Prokhorov, dan bersama-sama dengan tim insinyur jaringan di departemen kami, kami mengerjakan jaringan di # ITX5.  Departemen kami mengembangkan infrastruktur jaringan, pemantauan jaringan, dan otomatisasi.  Ya, dan segala sesuatu yang terkait dengan transfer data. <br><br><img src="https://habrastorage.org/webt/g1/mu/mr/g1mumrtfj5tkbmqs52gl05_d2la.png"><br><br>  Saya akan memecah sistem pemantauan menjadi 5 subtugas: <br><br><ul><li>  Unduh Data Master </li><li>  Memperoleh informasi tentang keadaan benda </li><li>  Pemicu dan Peringatan </li><li>  Pelaporan </li><li>  Visualisasi </li></ul><br>  Dalam artikel ini kami ingin berbagi bagaimana kami melakukan integrasi pemantauan dengan data master di perusahaan kami. <br><br>  Kami memiliki 14.000 properti ritel, dan tugas pertama yang kami selesaikan adalah penentuan objek yang tidak dapat diakses, jumlah dan distribusi geografisnya. <br><br>  Pemantauan dilakukan pada <b><font color="#cc0000">Zabbix</font></b> .  Singkatnya mengapa - beruntung dan warisan.  Sisanya: <br><br><div class="spoiler">  <b class="spoiler_title">Ceritanya panjang.</b> <div class="spoiler_text"> Semuanya dimulai dengan pemasangan pemantauan pada komputer di bawah meja ... <br><br>  Ketika saya mulai bekerja untuk perusahaan pada tahun 2013, kami tidak memiliki pemantauan jaringan, meskipun jaringan itu pada saat itu besar, sekitar 4000 objek.  Kami belajar tentang penurunan besar (dan tidak begitu) paling sering dari penerimaan aplikasi, pengguna, atau dari departemen lain seperti longsoran salju. <br><br><img src="https://habrastorage.org/webt/ge/6l/du/ge6lduplk0odlklh6iazcjsw6vk.jpeg"><br><br>  Yang pertama dipasang Zabbix 1.8, sebagai produk yang mendapatkan momentum (modis, modern, muda), ringan dan terjangkau untuk menginstal open source dengan komunitas besar.  Kami hanya beruntung dengan pilihan itu. <br><br>  Tidak ada sumber daya untuk instalasi, tidak ada yang meminta.  Tidak jelas apakah ini akan berhasil, tidak ada yang punya pengalaman implementasi.  Tetapi kami membutuhkan, dan kami menginstalnya di komputer "di bawah meja."  Tingkat Redundansi - UPS. <br><br>  Pertanyaan utama setelah instalasi adalah bagaimana cara menuangkan semua objek (4k!) Ke dalam pemantauan, dan pada saat yang sama berhasil membuat aplikasi yang sudah menggantung di Remedy.  Zabbix sudah mendukung impor / ekspor xml dengan data pada host.  Jumlah objek besar, tidak ada gunanya membuat grup terpisah untuk objek (dan itu tidak muncul), dan diputuskan untuk mengunggah router objek sebagai node jaringan.  Lebih banyak peralatan jaringan tidak terkontrol (sudah dikelola). <br><br>  Parsing file kami dengan host jaringan (IPAM di excel) telah selesai, dan diformat ulang menjadi xml, yang disetujui Zabbix untuk dicerna.  Bukan yang pertama, tetapi semua host dimuat, memperbarui dilakukan setiap tiga bulan sekali, menghapus objek yang ditutup dan menambahkan yang baru.  Seiring waktu, ternyata Zabbix menjadi sumber informasi utama dan satu-satunya bagi kami dan hotline tentang ketersediaan fasilitas dan, yang paling penting, tentang penurunan massa.  Ini memungkinkan hotline untuk mengetahui tentang kecelakaan massal bahkan di malam hari, dan untuk membangunkan insinyur dengan panggilan (omong-omong, ketika tidak ada yang tahu tentang itu, lebih mudah untuk hidup).  Tidak selalu pemadaman listrik malam hari di kantor memungkinkan UPS memelihara pemantauan jaringan kami secara memadai.  Pada titik tertentu, kami mulai membuat cadangan.  Karena  pemantauan tidak stabil dan terputus-putus, perusahaan memutuskan untuk mengatur kelompok yang didedikasikan untuk tugas ini saja.  Segera, dia mulai menerapkan Zabbix terpusat, yang memeriksa tidak hanya jaringan. <br><br>  Zabbix tua kami terus hidup di bawah meja.  Setelah menambahkan sejumlah item, basis data mulai melambat sedikit, web, antrian dan jajak pendapat bertambah, jadi saya harus segera mendapatkan dua komputer lagi sebagai proxy dan meletakkan semuanya di salib, sehingga reservasi sebenarnya (dan tempat di bawah meja sudah selesai) .  Kehidupan di dalamnya didukung untuk dengan cepat menambahkan semacam parameter khusus ke pemantauan dan mengamatinya.  Untuk sisanya, kami pindah ke yang terpusat. <br><br>  Pemantauan terpusat bertanggung jawab atas semua peralatan TI - router, server, register kas, terminal.  Setelah beberapa saat, dia ditumbuhi banyak barang.  Untuk mengakses informasi aksesibilitas yang tak ternilai, Anda harus menunggu sedikit, mungkin bahkan minum kopi.  Selain itu, kami memiliki lebih banyak persyaratan untuk pemantauan jaringan yang lebih spesifik dan khusus.  Memiliki pada saat itu beberapa pengalaman bekerja dengan sistem, kami memutuskan untuk melakukan implementasi lama dari awal, tetapi memang demikian - dengan nama zabbix.noc.x5.ru Itu terletak di pusat data dengan implementasi fungsi yang diperlukan oleh diri kita sendiri.  Tentang pengantar ini dan bagian utama dari artikel ini. <br></div></div><br>  Versi Zabbix adalah 3.0 <abbr title="Dukungan jangka panjang">LTS</abbr> .  Diperbarui hanya dalam versi LTS. <br><br>  Konfigurasi - 4 mesin virtual: Server + Database, Proxy, Proxy, Web <br><br>  Dari sumber daya, kami mencoba mengikuti rekomendasi di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">zabbix.com</a> untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">implementasi</a> yang besar dan sangat besar. <br><br>  Masalah pertama yang dihadapi kami adalah penambahan otomatis node jaringan ke pemantauan.  Penemuan Biasa menghilang dengan segera.  Jangkauan jaringan kami ada di semua ruang terbuka supernet 10/8.  Banyak alamat yang harus disurvei dan penemuan otomatis akan memakan banyak sumber daya sistem, tetapi tidak akan menyelesaikan masalah dengan menambahkan informasi non-teknis tentang suatu objek. <br><br><img src="https://habrastorage.org/webt/1r/on/nm/1ronnmq5d1dutzqrzwn-3tfypdm.png" align="right" width="240"><h2>  Bagaimana cara menambahkan objek </h2><br>  Solusinya adalah menggunakan skrip eksternal untuk menambahkan objek.  Data master tentang objek perdagangan ditemukan di SAP yang digunakan di perusahaan.  Akses yang disinkronkan ke layanan <i>web</i> untuk mengunggah data langsung dari SAP tidak keluar, permintaan untuk semua objek memakan waktu cukup lama.  Melakukan panggilan asinkron.  Tepat di tengah malam, ekspor penuh dari SAP ditambahkan ke ftp dalam bentuk <i>XML</i> , dan pada siang hari <i>XML</i> dengan perbedaan dari versi terbaru jatuh di atasnya. <br><br clear="right">  Zabbix menggunakan <b><font color="#cc0000">Zabbix API</font></b> untuk memuat data, dan berinteraksi dengannya dari <i>Python</i> . <br><br>  Pada tahap pertama, kumpulan data yang kami butuhkan untuk membuat objek ditentukan.  Kami menggunakan semua tanda yang diperoleh untuk klasifikasi objek yang benar dalam sistem atau untuk kenyamanan lebih lanjut.  Tanda-tanda ini termasuk: <br><br><ul><li>  <i>Alamat IP</i> - bidang yang paling penting untuk membuat antarmuka pemantauan </li><li>  <i>SAP ID</i> - kami memiliki pengidentifikasi objek yang unik </li><li>  <i>Status</i> - terbuka / tertutup </li><li>  <i>Nama</i> - nama atau nomor objek, sering digunakan oleh pengguna saat menghubungi </li><li>  <i>Lokasi</i> - alamat fisik </li><li>  <i>Telepon</i> - telepon kontak </li><li>  <i>Grup</i> - grup grup ini dibentuk berdasarkan jenis dan lokasi objek </li></ul><br><img src="https://habrastorage.org/webt/hr/hc/29/hrhc29q4zq8axnta-ift3gjpcwm.png"><br><br><h3>  Modul Sap-sync.py </h3><br><div class="spoiler">  <b class="spoiler_title">XML dari SAP</b> <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">werks</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WERKS</span></span></span><span class="hljs-tag">&gt;</span></span>1234<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WERKS</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME1</span></span></span><span class="hljs-tag">&gt;</span></span>4321-<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PLANT_IP</span></span></span><span class="hljs-tag">&gt;</span></span>192.168.1.50<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PLANT_IP</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">REGION</span></span></span><span class="hljs-tag">&gt;</span></span>31<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">REGION</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PSTLZ</span></span></span><span class="hljs-tag">&gt;</span></span>308580<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PSTLZ</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CITY1</span></span></span><span class="hljs-tag">&gt;</span></span>.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CITY1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CITY2</span></span></span><span class="hljs-tag">&gt;</span></span> .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CITY2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">STREET</span></span></span><span class="hljs-tag">&gt;</span></span> .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">STREET</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HOUSE_NUM1</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HOUSE_NUM1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TEL_NUMBER</span></span></span><span class="hljs-tag">&gt;</span></span>(999)777-77-77<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TEL_NUMBER</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BRANCH</span></span></span><span class="hljs-tag">&gt;</span></span>CH<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BRANCH</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">REGION</span></span></span><span class="hljs-tag">&gt;</span></span>CH_MSK<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">REGION</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">REGION_NAME</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">REGION_NAME</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORMAT</span></span></span><span class="hljs-tag">&gt;</span></span>CH_MSK_D<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORMAT</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">STATUS</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">STATUS</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">werks</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">sap-sync.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python3 import sys, os, getopt, ipaddress from datetime import datetime as dt from zabbix.api import ZabbixAPI import xml.etree.cElementTree as et from report import report import existhost def ping(ip): if os.system('ping -c 2 -W 1 %s &gt; /dev/null'%ip) == 0: return True else: return False def main(argv): global opath try: opts, args = getopt.getopt(argv,"hp:",["path="]) except getopt.GetoptError: print('sync-sap-chg.py -p &lt;path&gt;') sys.exit(2) for opt, arg in opts: if opt == '-h': print('sync-sap-chg.py -p &lt;path&gt;') sys.exit() elif opt in ("-p", "--path"): opath = arg def asynchronization(file, reportdata): zapi = ZabbixAPI(url='http://z.noc.x5.ru', user='user', password='pwd') #,    left_kidney = '17855' right_kidney = '17856' f_type={'S':'Super','D':'DK','H':'Giper','A':'DK'} format={'D':'13','S':'14','H':'12','A':'13'} region={'CT':'21','UR':'19','SZ':'17',~omit~} try: #  XML tree = et.ElementTree(file=file) root = tree.getroot() for werks in root.iter('werks'): #     Zabbix interfaces=[{ 'main':'1', 'type':'2', 'useip':'1', 'port':'161' }] shop={ 'inventory':{}, 'interfaces':interfaces, 'groups':[], 'templates':[{'templateid':'10194'}], 'inventory_mode':'1' } #,     XML di = { 'WERKS':'', ~omit~, 'STATUS':'Object Opened' } #    for item in werks: di[item.tag] = item.text #  SAPID   if item.tag == 'WERKS': n_proxy = ''.join(filter(lambda x: x.isdigit(), item.text)) # IP    .   /26 try: ipaddress.ip_interface('%s/%s'%(di['PLANT_IP'].strip(),26)) ip_chk = True except: ip_chk = False # ,   IP   if (di['PLANT_IP'] != '1.1.1.1') and ip_chk: #    if di['FORMAT'][-1] in ['D','A','S','H']: shop['inventory']['alias']=di['WERKS'] shop['inventory']['name']=di['NAME1'] shop['inventory']['poc_1_phone_a']=di['TEL_NUMBER'] shop['inventory']['location']=di['STREET'] #    if (di['FORMAT'][-1] in ['H']): shop['host']=f_type[di['FORMAT'][-1]]+di['WERKS'] shop['interfaces'][0]['ip']=str(ipaddress.ip_interface('%s/%s'%(di['PLANT_IP'].strip(),24)).network[1]) # ID     shop['templates'][0]['templateid']='29529' elif (di['FORMAT'][-1] in ['S']): ~omit~ #For D balance in proxies if int(n_proxy[-1]) % 2 == 0: shop['proxy_hostid'] = right_kidney else: shop['proxy_hostid'] = left_kidney # inventory   IP shop['inventory']['oob_ip']=shop['interfaces'][0]['ip'] #    format  region shop['groups']=[{'groupid':'9'}] shop['groups'].append({'groupid':format[di['FORMAT'][-1]]}) shop['groups'].append({'groupid':region[di['FORMAT'][:2]]}) #   if di['STATUS'] == ' ': shop['status']='0' else: shop['status']='1' #   T = dt.date(dt.now()).strftime("%d %B %Y") shop['inventory']['date_hw_decomm'] = T #      Zabbix hostid = existhost.exist(shop['host']) ip = shop['interfaces'][0]['ip'] #  - ! if hostid == 0 and shop['status'] == '0' and ping(ip): zapi.host.create(shop) reportdata['new'].append(di['WERKS']) #   - ! elif hostid != 0 and di['PLANT_IP'] != '1.1.1.1': #  HOSTID  shop['hostid']=hostid #     shop.pop('interfaces') zapi.host.update(shop) reportdata['update'].append(di['WERKS']) #     os.system('mv %s /mnt/ftp/old_data/'%(file)) except: reportdata['error'].append(di['WERKS']) report('   %s.   :%s'%(file, str(reportdata['error'])), 'SAP Sync Failed!') sys.exit() def checking(path): files = os.listdir(path) files.sort() reportdata ={'new':[], 'update':[], 'error':[]} for file in files: asynchronization(path+file, reportdata) if files != []: report(' %s  ! \n  %s . \n  sap:\n %s. \n  %s . \n  sap:\n %s'%(str(files), len(reportdata['new']), str(reportdata['new']), len(reportdata['update']), str(reportdata['update'])), 'SAP Sync Succeed!') if __name__ == "__main__": main(sys.argv[1:]) checking(opath)</span></span></code> </pre><br></div></div><br>  Tujuan utama dari modul ini adalah parsing <i>XML</i> dan terjemahan <font color="#008080"><abbr title="Notasi Objek JavaScript">JSON</abbr></font> untuk Zabbix API.  Sangat nyaman dalam hal ini untuk menggunakan kamus Python, sebagai  tidak perlu memformatnya tambahan - menggunakan modul <font color="#008080">zabbix.api</font> , <font color="#008080">Anda</font> cukup memberinya kamus dengan struktur yang benar.  <i>JSON</i> dengan strukturnya terlihat seperti ini: <br><br><pre> <code class="json hljs">{ 'host': 'Hostname' 'groups': [...] 'interfaces': [{},{},{}] 'inventory': {} 'templates': [{},{},{}] 'inventory_mode': '<span class="hljs-number"><span class="hljs-number">1</span></span>' 'proxy_hostid': 'INT' 'status': '<span class="hljs-number"><span class="hljs-number">0</span></span>' } [] -  {} - </code> </pre><br>  Di bidang kami dengan alamat IP di SAP, alamat server disimpan, bukan router, tetapi menggunakan modul <font color="#008080">ipaddress</font> kami menganggap alamat subnet pertama, yang dalam kasus kami selalu merupakan router. <br><br><pre> <code class="python hljs">str(ipaddress.ip_interface(<span class="hljs-string"><span class="hljs-string">'%s/%s'</span></span>%(di[<span class="hljs-string"><span class="hljs-string">'PLANT_IP'</span></span>].strip(),<span class="hljs-number"><span class="hljs-number">24</span></span>)).network[<span class="hljs-number"><span class="hljs-number">1</span></span>])</code> </pre><br>  Tanggal pembaruan terakhir yang berhasil dicatat dalam <i>Inventaris</i> , dalam situasi kontroversial membantu untuk memahami seberapa relevan informasi dalam sistem. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   T = dt.date(dt.now()).strftime("%d %B %Y") shop['inventory']['date_hw_decomm'] = T</span></span></code> </pre><br>  Maka sangat nyaman untuk melihat statistik pada tanggal pembaruan dalam data inventaris: <br><br><img src="https://habrastorage.org/webt/ja/7j/kp/ja7jkpml-hjexniqyu-_5e2vrau.png"><br><br>  Bidang yang paling penting - <b>STATUS</b> , <i>"terbuka"</i> - ditambahkan dan mulai dipantau, status lainnya - menonaktifkan host.  Kami tidak menghapus objek untuk menjaga data historis dan statistik. <br><br>  Setelah tes, saya harus menambahkan fungsi ping untuk memeriksa apakah host dapat diakses sebelum penambahan awal, karena  dalam praktiknya, status <i>"Terbuka"</i> mulai menjumpai, yang belum cukup terbuka, tetapi hampir. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ping</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ip)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> os.system(<span class="hljs-string"><span class="hljs-string">'ping -c 2 -W 1 %s &gt; /dev/null'</span></span>%ip) == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre><br>  Sebelumnya, Zabbix API memiliki fungsi <b><font color="#008080">host.exist</font></b> , tetapi dalam versi baru dikombinasikan dengan <b><font color="#008080">host.get</font></b> .  Jika node ada, maka permintaan mengembalikan <i>hostid</i> di database zabbix.  Jika tidak ditemukan, mengembalikan 0. Untuk verifikasi, saya sekarang harus menambahkan <font color="#008080">existhost</font> , tetapi sebenarnya itu adalah <b><font color="#008080">host.get</font></b> . <br><br><div class="spoiler">  <b class="spoiler_title">existhost.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python3 import sys, getopt from zabbix.api import ZabbixAPI def main(argv): global aname try: opts, args = getopt.getopt(argv,"hn:",["name="]) except getopt.GetoptError: print('existhost.py -n &lt;name&gt;') sys.exit(2) for opt, arg in opts: if opt == '-h': print('existhost.py -n &lt;name&gt;') sys.exit() elif opt in ("-n", "--name"): aname = arg def exist(name): zapi = ZabbixAPI(url='http://z.noc.x5.ru/', user='user', password='pwd') hostget = zapi.host.get(search={'name':'%s'%name}, output='hostid') if hostget == []: return 0 else: return int(hostget[0]['hostid']) if __name__ == "__main__": main(sys.argv[1:]) print(exist(aname))</span></span></code> </pre><br></div></div><br>  Akhirnya, kami mengumpulkan informasi tentang pekerjaan yang dilakukan, menambahkannya ke log, melaporkan, dan memindahkan file yang diproses ke repositori di OLD. <br><br><div class="spoiler">  <b class="spoiler_title">report.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python3 # -*- coding: utf-8 -*- import smtplib, sys from email.mime.text import MIMEText def report(message, subject): me = 'zbx-scripts@x5.ru' you = 'mail@x5.ru' smtp_server = 'smtp.ru' msg = MIMEText(message) msg['Subject'] = subject msg['From'] = me msg['To'] = you s = smtplib.SMTP(smtp_server) s.sendmail(me, [you], msg.as_string()) s.quit() if __name__ == '__main__': report(sys.argv[2], sys.argv[1])</span></span></code> </pre><br></div></div><br>  Secara umum, basis pemantauan siap, jalankan skrip di cron untuk autorun dan lupakan. <br><br><img src="https://habrastorage.org/webt/il/hk/0r/ilhk0rph3lcm1azoquz00y_zck0.jpeg"><br><br><h2>  Cara mengisi inventaris </h2><br>  <i>Kita bukan lagi kita, kita adalah penggiat jejaring.</i> <br><br>  Tahap kedua adalah mengisi objek dengan data yang perlu dilakukan oleh para insinyur.  Penting untuk melihat semua data untuk menyelesaikan insiden dalam satu sistem, agar tidak berjalan di sistem yang berbeda, mengumpulkan informasi dalam potongan-potongan dari sumber yang berbeda.  Dan karena data teknis utama dalam pemantauan, kami juga menarik sisanya ke dalam pemantauan. <br>  Untuk mengumpulkan dan mengirimkan informasi yang diperlukan, Zabbix menulis <b><font color="#008080">inventory.py</font></b> , yang sebagian besar terlibat dalam pengumpulan data <font color="#008080"><abbr title="Protokol manajemen jaringan yang sederhana">SNMP</abbr></font> dari peralatan, dan pada tingkat yang lebih rendah menguraikan file Excel. <br><br>  Pertanyaannya adalah - mengapa tidak menggunakan <i>item</i> bawaan dan memasukkan hasilnya dalam <i>inventaris</i> menggunakan alat Zabbix itu sendiri?  Ada tiga jawaban: <br><br><ol><li>  Tindakan bersarang tidak memadai, seperti  seringkali perlu untuk menarik nilai keluar dari SNMP dan menggunakan hasilnya dalam kueri berikutnya. </li><li>  Menjalankan pengumpulan data sekali sehari pada semua node dengan skrip eksternal tidak memuat aktivitas pemantauan utama dan tidak ada antrian untuk item'am </li><li>  Ada data yang tidak dapat dikumpulkan melalui SNMP </li></ol><br>  Data penyedia, yang tidak bisa dilakukan oleh insinyur garis 1 dan 2, disimpan dalam file excel pada drive jaringan bersama dan diperbarui oleh manajer yang melakukan kontrak komunikasi.  Integrasi dengan file menyebabkan keraguan besar - excel parsing, diisi secara manual, yang dapat mengubah struktur, nama, lokasi, dll., Kemungkinan besar akan terus-menerus melakukan kesalahan.  Tetapi karena kurangnya sumber lain yang relevan dari data tersebut, saya harus menggunakannya.  Untuk melindungi diri dari penyuntingan naskah yang konstan, kami sepakat dengan manajer tentang struktur dan pengisian yang benar, menjelaskan bagaimana pembongkaran otomatis akan dilakukan dan penting untuk mengamati struktur saat ini.  Dalam praktiknya, tentu saja, kesalahan terjadi, tetapi kami dengan cepat melacaknya, mengutuk, tetapi memperbaikinya. <br><br><div class="spoiler">  <b class="spoiler_title">inventory.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python3 # -*- coding: utf-8 -*- import sys, json, pysnmp, ipaddress, xlrd from datetime import datetime as dt from pysnmp.entity.rfc3413.oneliner import cmdgen def snmp(host, operation, *oid): generator = cmdgen.CommandGenerator() auth_data = cmdgen.UsmUserData('user', 'pwd', 'hash') transport = cmdgen.UdpTransportTarget((host, 161)) getAtt = getattr(generator, '%sCmd'%operation) rst = (errorIndication, errorStatus, errorIndex, varBinds) = getAtt(auth_data, transport, *oid) if not errorIndication is None or errorStatus is True: return "Error: %s %s %s %s" % rst else: if operation=='get': return varBinds elif operation=='next': result=[] for var in varBinds: result.append(var) return result def xlsdata(file, sap): rb = xlrd.open_workbook(file) sheet = rb.sheet_by_index(0) base = {} for i in range(0, sheet.nrows-1): sapnum = str(round(sheet.cell(i,4).value)) if isinstance(sheet.cell(i,4).value,float) else sheet.cell(i,4).value name = str(round(sheet.cell(i,8).value)) if isinstance(sheet.cell(i,8).value,float) else sheet.cell(i,8).value if sap.upper() == sapnum.upper(): base = { 'type' : (sheet.cell(i,2).value), 'serialno_a' : (sheet.cell(i,13).value), 'serialno_b' : (sheet.cell(i,20).value), 'tag' : ('2') if sheet.cell(i, 20).value != '' else ('1'), 'macaddress_a' : (sheet.cell(i, 15).value), 'macaddress_b' : (sheet.cell(i, 22).value) } base['date_hw_purchase'] = dt.date(dt.now()).strftime("%d %B %Y") return (base) def inventory(host, sap): BGPASBASE={} for line in open('/path/a.prokhorov/integration/BGP-AS-BASE.cfg'): if ':' in line: line = line.split(':') BGPASBASE[line[0]]='%s(%s)'%(line[1].rstrip(), line[0]) ### Get Data from Operator shop = xlsdata('/mnt/oprf/providers_base.xlsx', sap) shop['date_hw_expiry'] = 'Failed' ### Get SNMP data shop['host_router'] = 'None' shop['host_netmask'] = 'None' shop['host_networks'] = 'None' try: ### Get Networks from router networks = '' for ip,mask in snmp(host, 'next', 'iso.3.6.1.2.1.4.20.1.1', 'iso.3.6.1.2.1.4.20.1.3'): networks = networks+str(ipaddress.ip_interface(u'%s/%s'%(ip[1].prettyPrint(), mask[1].prettyPrint())))+'\n' shop['host_networks']=networks ### Get BGP information bgppeers, ispnames = '','' for peer,asbgp in snmp(host, 'next', 'iso.3.6.1.2.1.15.3.1.7', 'iso.3.6.1.2.1.15.3.1.9'): asbgp = asbgp[1].prettyPrint() bgppeers = bgppeers+peer[1].prettyPrint()+'\n' ispnames = ispnames+(BGPASBASE.get(asbgp) if BGPASBASE.get(asbgp)!=None else asbgp)+'\n' shop['host_router'] = bgppeers.strip()[:38] shop['host_netmask'] = ispnames.strip()[:38] ### Get Vendor name and Model type hardware = snmp(host, 'get', 'iso.3.6.1.2.1.47.1.1.1.1.13.1', 'iso.3.6.1.2.1.47.1.1.1.1.10.1', 'iso.3.6.1.2.1.47.1.1.1.1.12.1', 'iso.3.6.1.2.1.1.1.0', 'iso.3.6.1.2.1.47.1.1.1.1.7.1') if str(hardware[0][1]) == '0235A325': shop['model'] = hardware[4][1].prettyPrint() else: shop['model'] = hardware[0][1].prettyPrint() shop['os_short'] = hardware[1][1].prettyPrint() shop['vendor'] = hardware[2][1].prettyPrint() version = hardware[3][1].prettyPrint() os = version.split('\n')[0] shop['os_full'] = version[:250] shop['os'] = ''.join(os.split(',')[:2])[:60] ### Make indicators shop['date_hw_expiry'] = 'Success' shop['date_hw_install'] = dt.date(dt.now()).strftime("%d %B %Y") except: shop.pop('host_router') shop.pop('host_netmask') shop.pop('host_networks') return shop #return json.dumps(dict([('inventory',shop)]), sort_keys=True, indent=4) if __name__ == "__main__": print(inventory(sys.argv[1], sys.argv[2]))</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">BGP-AS-BASE.cfg</b> <div class="spoiler_text"> <code>3216:Beeline <br> 9002:Retn <br> 2854:Orange <br> ~omit~ <br> 8359:MTS <br></code> <br></div></div><br>  File <i>BGP-AS-BASE.cfg</i> mewakili korespondensi dari nomor <i>AS</i> dan nama penyedia.  Penting untuk menentukan penyedia dengan mana <i>BGP</i> diinstal (tiba-tiba ada kesalahan dalam file dengan kontrak).  Basis eksternal tidak digunakan, seperti  Ada banyak nomor <i>AS</i> pribadi. <br><br>  Dalam hal <font color="#008080">SNMP</font> : <br><br><ul><li>  kami meminta dari subnet router oleh <font color="#008080"><abbr title="Pengidentifikasi objek">OID</abbr></font> <i>1.3.6.1.2.1.4.20.1.1</i> dan subnet mask oleh <i>OID</i> <i>1.3.6.1.2.1.4.20.1.3</i> dalam satu permintaan.  Kami memprosesnya, menerjemahkannya ke <i>xxxx / xx</i> dan menulisnya di sel <i>host_networks</i> . </li><li>  kami meminta data pada alamat ip dari rekan <i>BGP</i> , serta <i>ASN</i> mereka, kami menemukan nama penyedia dengan nomor dalam database yang kami buat.  Kami menulisnya di bidang <i>host_router</i> dan <i>host_netmask</i> .  Penting untuk segera membatasi 38 karakter, karena  bidang ini tidak mendukung lebih banyak.  Nama bidang kami dalam database tidak selalu bertepatan dengan data yang mereka simpan, karena  menggunakan bidang yang ada di database Zabbix, agar tidak mengacaukan dengan membuat bidang baru di tabel.  Nama bidang yang benar dikoreksi dalam WEB, tidak ada kebingungan. </li><li>  kami mengunggah data pada vendor, model, dan peralatan perangkat lunak.  Parsim, tulis ke variabel.  Desain yang terkait dengan penulisan model perangkat keras disebabkan oleh fakta bahwa untuk beberapa model, <i>Cisco memiliki</i> nama yang ditulis dalam <font color="#008080">OID yang</font> berbeda (paling sering untuk sasis), jadi saya harus melakukan pemeriksaan data tambahan. </li></ul><br>  Seluruh blok yang terkait dengan SNMP terlampir dalam <i>try-kecuali</i> , sehingga jika tidak ada SNMP pada peralatan, skrip tidak jatuh, dan kami setidaknya mendapatkan data dari Excel oleh penyedia.  Untuk memahami bagian skrip mana yang telah selesai dan yang tidak, kami menuliskan keberhasilan blok SNMP di bidang <i>date_hw_expiry</i> , ditambah menuliskan tanggal ketika terakhir kali kami bisa menghapus semua data SNMP, dan tanggal kapan terakhir kali kami bisa menemukan data dalam file Excel. <br><img src="https://habrastorage.org/webt/cc/he/en/ccheenqcce-qkrwbxcerarkji2e.png"><br><br>  Semua ini kembali dalam bentuk <i>JSON yang</i> siap untuk Zabbix. <br><br>  Memperbarui semua data inventaris dimulai sekali sehari, membongkar semua host dan memulai <b><i>inventory.py</i></b> untuk setiap objek. <br><br><div class="spoiler">  <b class="spoiler_title">mp-update.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python3 # -*- coding: utf-8 -*- from multiprocessing import Pool import time from zabbix.api import ZabbixAPI from inventory import inventory from report import report def updating(shop): try: shop['inventory'] = inventory(shop['interfaces'][0]['ip'], shop['host'][-4:]) shop.pop('interfaces') shop['inventory_mode'] = '1' shop.pop('host') print (shop['hostid']) return zapi.host.update(shop) except: print("&gt;&gt;&gt;",shop['hostid']) with open ('/home/local/integration/error.txt', 'a') as err: err.write(shop['hostid']) err.write("\n") if __name__ =='__main__': t = time.time() zapi = ZabbixAPI(url='http://z.noc.x5.ru/', user='user', password='pwd') shopbase = zapi.host.get(output=['host', 'hostid'], groupids= ['12', '13', '14'], monitored="1", selectInterfaces=['ip']) pool = Pool(processes=10) p=[0 for x in range(0,len(shopbase))] for i in range(0, len(shopbase), 10): print ("Index:", i,"\n",shopbase[i],"\n") pool.map(updating,shopbase[i:i+10]) pool.close() pool.join() print(time.time()-t) report('    Zabbix.', 'Inventory updating succeed')</span></span></code> </pre><br></div></div><br>  <font color="#008080">Multiprocessing</font> digunakan (contoh diambil dari bentangan luas Internet).  Untuk mencari, kami menggunakan <i>SAP ID</i> , yang kami miliki dengan nama host.  Output yang dihasilkan adalah <i>pembaruan</i> tertulis 'ohm di Zabbix. <br><br><h3>  Ringkasan </h3><br>  Untuk implementasi semua integrasi, pembaruan otomatis dan pembaruan mekanisme bawaan, Zabbix API lebih dari cukup.  Fungsi utama yang digunakan adalah <i>host.get</i> , <i>host.create</i> dan <i>host.update</i> , yang bersama-sama memungkinkan Anda untuk sepenuhnya mengontrol pembuatan dan pemutakhiran database objek pemantauan.  Data input dari fungsi-fungsi ini dapat dikirimkan dari sistem dan sumber apa pun yang tersedia. <br><br>  Modul python utama yang membantu kami mengatasi tugas ini: <i>pysnmp</i> , <i>xlrd</i> , <i>zabbix.api</i> , <i>xml</i> , <i>ipaddress</i> , <i>json</i> . <br>  <i><font color="#008080">xlrd</font></i> - parsing excel. <br>  <i><font color="#008080">xml</font></i> - parsing XML. <br>  <i><font color="#008080">pysnmp</font></i> - menarik data SNMP dari peralatan. <br><br>  Interaksi SNMP lebih mudah daripada SSH, setidaknya karena dalam praktiknya perangkat keras merespons SNMP lebih cepat daripada SSH, parsing respons SNMP praktis tidak diperlukan, meskipun CLI vendor yang berbeda sering sangat bervariasi, dan kesimpulannya sama. tim dapat berbeda bahkan dalam model yang berbeda dari vendor yang sama. <br><br>  <i>OID</i> utama yang diterapkan: <br>  <i>iso.3.6.1.2.1.4.20.1.1</i> - alamat semua antarmuka router <br>  <i>iso.3.6.1.2.1.4.20.1.3</i> - subnet mask dari semua antarmuka router <br>  <i>iso.3.6.1.2.1.15.3.1.7</i> - semua rekan BGP dari router <br>  <i>iso.3.6.1.2.1.15.3.1.9</i> - SEBAGAI semua rekan BGP dari router <br>  <i>iso.3.6.1.2.1.47.1.1.1.1.1.1.1.1</i> - model <br>  <i>iso.3.6.1.2.1.47.1.1.1.1.10.1</i> - versi singkat dari perangkat lunak <br>  <i>iso.3.6.1.2.1.47.1.1.1.1.1.12.1</i> - vendor <br>  <i>iso.3.6.1.2.1.1.1.0</i> - versi perangkat lunak terperinci <br>  <i>iso.3.6.1.2.1.47.1.1.1.1.7.1</i> - model, tipe sasis <br><br>  <i>Dashboard</i> harus ditambahkan sedikit untuk membagi masalah pada jaringan distribusi dan tidak mengganggu mereka dalam tumpukan.  Juga tambahkan beberapa bidang, misalnya ip, nama dan alamat penyedia, sehingga jika terjadi kecelakaan massal cukup untuk menyalin-tempel dari peramban ke dalam pesan semua objek dengan masalah, segera dengan semua data yang diperlukan untuk penyedia. <br><img src="https://habrastorage.org/webt/ea/m3/zo/eam3zojwyhottbk5offhtkltg3o.png"><br><br>  <i>"Workview"</i> ditulis <i>secara terpisah</i> , di mana kami dapat menemukan semua informasi yang dikumpulkan, ditambah grafik yang dikumpulkan untuk objek ini. <br><br><img src="https://habrastorage.org/webt/m1/m-/jp/m1m-jpml-eypxjlgqlsoltn7in4.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id438754/">https://habr.com/ru/post/id438754/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id438740/index.html">Mengelola Rahasia dengan HashiCorp Vault</a></li>
<li><a href="../id438746/index.html">Dalam perjalanan ke prinsip fisik evolusi biologis. Lanjutan</a></li>
<li><a href="../id438748/index.html">Infrastruktur sebagai kode, kami menang dalam skala besar (Kirill Vetchinkin, TYME)</a></li>
<li><a href="../id438750/index.html">Peradaban Mata Air, 4/5</a></li>
<li><a href="../id438752/index.html">Akuntansi langsung di bank: cara membuat pengusaha individu bahagia</a></li>
<li><a href="../id438756/index.html">Periksa Chromium Keenam, Kata Penutup</a></li>
<li><a href="../id438758/index.html">Mengapa Google mengubah antarmuka URL standar di browser</a></li>
<li><a href="../id438762/index.html">DBX: upaya untuk menyingkirkan kompilasi permintaan MySQL</a></li>
<li><a href="../id438764/index.html">Tes Chromium Keenam, Kata Penutup</a></li>
<li><a href="../id438766/index.html">DNA ekstraseluler sebagai biomarker penuaan dan berbagai patologi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>