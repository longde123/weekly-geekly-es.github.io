<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸšï¸ ğŸ¥Œ âœ¨ Karena kami merekomendasikan katalog terbaru di bioskop online ivi (+ kode Python) ğŸ‘¨ğŸ»â€ğŸ³ ğŸ¤šğŸ¿ ğŸ‘©ğŸ»â€ğŸ³</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Blog film online ivi memiliki banyak artikel tentang arsitektur sistem rekomendasi Hydra. Namun, rekomendasi tidak hanya API eksternal, tetapi juga al...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Karena kami merekomendasikan katalog terbaru di bioskop online ivi (+ kode Python)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ivi/blog/478694/">  Blog film online ivi memiliki banyak artikel tentang arsitektur sistem rekomendasi Hydra.  Namun, rekomendasi tidak hanya API eksternal, tetapi juga algoritma yang hidup "di bawah tenda" dan menerapkan logika bisnis yang cukup kompleks. <br><br>  Dalam artikel ini, saya akan berbicara tentang masalah "mulai dingin" dari konten.  Jika Anda tertarik mempelajari cara kami merekomendasikan konten yang baru saja ditambahkan ke katalog dan tidak berhasil mendapatkan umpan balik dari pengguna, selamat datang di cat. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ij/t6/fw/ijt6fwbvmdddvcfww6sk4sycv7s.jpeg"></div><br>  Artikel ini akan berisi sampel kode Python yang dapat direproduksi menggunakan Keras. <br><a name="habracut"></a><br><h2>  <font color="#fd004c">Mulai Dingin Konten: Pernyataan Masalah</font> </h2><br>  Bagaimana cara kerja rekomendasi?  Kira-kira sebagai berikut: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j6/wi/f_/j6wif_qcnwizj2zbnpeilwkunta.png"></div><br>  Kami menggunakan pipa berikut untuk rekomendasi: <br><br><ul><li>  memuat statistik tampilan konten dalam bentuk matriks konten pengguna </li><li>  terapkan kotak ajaib pembelajaran mesin </li><li>  di pintu keluar dari kotak untuk setiap unit fitur katalog muncul </li><li>  kami menggunakan fitur konten untuk rekomendasi </li></ul><br>  Semua tahapan pipa pelatihan model mulai dingin dapat ditemukan di repositori ini <a href="https://github.com/ivi-ru/hydra">github.com/ivi-ru/hydra</a> <br>  Kami mendapatkan fitur konten menggunakan pustaka implisit sebagai berikut <br><br><div class="spoiler">  <b class="spoiler_title">train_model.py</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> implicit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.sparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_npz <span class="hljs-comment"><span class="hljs-comment">#   user-item user_item_views_coo = load_npz('/srv/data/user_item_interactions.npz') als_params = { 'factors': 40, 'regularization': 0.1, 'num_threads': 3, 'iterations': 5} print('  ALS-') als_model = implicit.als.AlternatingLeastSquares(**als_params) als_model.fit(user_item_views_coo.T) als_factors = als_model.item_factors print('ALS- ,   ', als_factors.shape) als_factors_filename = '/srv/data/fair_als_factors.npy' np.save(als_factors_filename, als_factors,allow_pickle=True) print('   ', als_factors_filename)</span></span></code> </pre> <br></div></div><br>  Bagaimana cara merekomendasikan konten yang keluar pada layanan baru-baru ini?  Konten tersebut tidak akan memiliki tampilan (atau akan ada sangat sedikit tampilan) - ini berarti bahwa tidak akan ada fitur untuk konten tersebut di knalpot kotak ajaib pembelajaran mesin dan tidak akan muncul dalam rekomendasi pengguna.  Ngomong-ngomong, fitur yang kami dapatkan berdasarkan interaksi pengguna-konten disebut kolaborasi. <br><br>  Jadi, kita sampai pada masalah awal yang sulit: bagaimana kami dapat merekomendasikan konten yang tidak memiliki umpan balik pengguna?  Misalnya, dimungkinkan untuk mencampur konten baru menjadi output acak dan menunggu hingga tampilan "organik" dikumpulkan. <br><br>  Pilihan lain adalah membangun model yang dapat memprediksi fitur konten "dingin". <br><br>  Kami memutuskan untuk pergi ke jalan kedua dan ke sanalah kami datang <br><br><h2>  <font color="#fd004c">Mulai Dingin 1.0</font> </h2><br>  Untuk menyelesaikan masalah cold start, kami dibantu oleh fitur konten yang diketahui sebelumnya tentang konten baru, misalnya <br><br><ul><li>  Orang: sutradara, penulis skenario, pemeran </li><li>  genre konten: aksi, komedi, dll. </li><li>  kategori: film fitur, kartun, dokumenter </li><li>  tag editor </li></ul><br>  Tag editorial adalah deskripsi singkat tentang konten dalam bentuk seperangkat karakteristik yang terbatas (biasanya beberapa ratus).  Di bawah ini adalah satu set tag konten Beaver Zombie <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0m/vw/r7/0mvwr7kt-nvjucsgswbf2xxmsr8.png"></div><br>  Dalam perkiraan pertama, kami memecahkan masalah cold start sebagai berikut: <br><br><ul><li>  untuk setiap konten "dingin", bersihkan semirip mungkin dengan tag </li><li>  mengambil fitur kolaboratif dari konten serupa </li><li>  fitur kolaboratif konten dingin adalah rata-rata fitur tetangganya yang "panas" </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">Dengan python, tampilannya seperti ini</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> new_items_neighbors: neighbors_als_indices = row.neighbors_ids[:self.cold_start_neighbors_count] neighbors_average_factors = item_factors[neighbors_als_indices].mean(axis=<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">#       ALS item_factors[row.new_item_als_index] = neighbors_average_factors</span></span></code> </pre><br></div></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fv/i2/ob/fvi2obm53kbof86hzyehjmdjsui.png"></div><br>  Metode ini <i>entah bagaimana berhasil</i> , tetapi memiliki dua kelemahan: <br><br><ul><li>  ekstensibilitas yang lemah: sulit untuk menambahkan, misalnya, kesamaan poster dengan model </li><li>  tidak ada yang menjamin kesamaan fitur ALS untuk konten yang serupa dalam tag, dan tanpa ini, menggunakan rata-rata terlihat aneh </li></ul><br><br>  Kami menyadari bahwa Anda tidak dapat hidup seperti itu lagi, dan menghasilkan model yang lebih transparan dan dapat diperluas. <br><br><h2>  <font color="#fd004c">Refactoring model awal yang dingin</font> </h2><br><br>  Alih-alih menghitung fitur konten ALS menggunakan heuristik (seperti rata-rata), kita dapat melatih jaringan saraf yang akan memprediksi fitur konten kolaboratif - misalnya, dengan tag editor.  Model serupa sudah <a href="https://habr.com/ru/company/yandex/blog/441586/">muncul di Habr's di sini</a> , dan sebelum Yandex <a href="https://benanne.github.io/2014/08/05/spotify-cnns.html">layanan musik Spotify berbicara</a> tentang model yang sama <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dn/wg/os/dnwgosz1l0p0rurfkb-aqpvhgic.png"></div><br>  Kode prototipe model tersedia <a href="https://github.com/ivi-ru/hydra/blob/master/cold_start_problem/cold_start_model/cold_content_model.py">di repositori ivi</a> , jaringan saraf untuk cold start adalah sebagai berikut: <br><br><div class="spoiler">  <b class="spoiler_title">cold_start_model.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_get_model</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, dims: List[int])</span></span></span><span class="hljs-function"> -&gt; Sequential:</span></span> model = Sequential() model.add( Dense( units=dims[<span class="hljs-number"><span class="hljs-number">1</span></span>], activation=<span class="hljs-string"><span class="hljs-string">'linear'</span></span>, input_dim=dims[<span class="hljs-number"><span class="hljs-number">0</span></span>], kernel_initializer=WeightInitializer.custom_normal, bias_initializer=<span class="hljs-string"><span class="hljs-string">'zeros'</span></span> ) ) model.compile( loss=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> y_true, y_pred: K.sum(K.square(y_pred - y_true), axis=<span class="hljs-number"><span class="hljs-number">-1</span></span>), optimizer=optimizers.Adam(lr=self.learning_rate, decay=self.decay) ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> model</code> </pre><br></div></div><br>  Kesulitan apa yang Anda temui saat menerapkan percobaan ini? <br><br><ul><li>  Ternyata cukup sulit untuk melatih jaringan: fitur dikodekan satu panas, dan jaringan kurang terlatih karena dimensi besar dari lapisan input.  Saya harus melakukan pemilihan fitur dengan hati-hati, pada akhirnya kami hanya menggunakan kategori, genre, dan dari tag editor kami memilih yang paling "penting" menggunakan tf-idf </li><li>  masalah dengan menginstal Keras menggunakan manajer paket pipenv: python, lingkungan tidak akan, saya harus menyelesaikan paket <a href="https://bitbucket.org/muxas/maxvolpy">maxvolpy</a> pihak <a href="https://bitbucket.org/muxas/maxvolpy">ketiga</a> yang <a href="https://bitbucket.org/muxas/maxvolpy">Keras</a> tidak berteman dengan </li></ul><br><h2>  <font color="#fd004c">Hasil Eksperimen</font> </h2><br><br>  Akibatnya, kami menghapus fungsionalitas baru sedikit kurang, yang untuk beberapa sprint, pengembang menghabiskan waktu sekitar 100 jam - dan ini adalah pengalaman pertama menggunakan jaringan saraf dalam produksi pada proyek kami.  Waktu ini didistribusikan sebagai berikut: <br><br><ul><li>  60 jam untuk membaca artikel dan pengembangan prototipe </li><li>  30 jam untuk mengintegrasikan prototipe ke dalam basis kode proyek </li><li>  10 jam pada penyebaran model baru - menyeret Keras ke lingkungan python tidak begitu sederhana karena ketergantungan khusus kami (seperti maxvolpy) </li></ul><br>  Kami mendapat ruang untuk percobaan lebih lanjut - penggunaan jaringan saraf memungkinkan Anda untuk belajar tidak hanya pada tag editor, tetapi juga pada fitur lain: gambar, skrip, komentar pengguna, rekaman, dll. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id478694/">https://habr.com/ru/post/id478694/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id478680/index.html">Mengapa, dan yang paling penting, kemana orang pergi dari IT?</a></li>
<li><a href="../id478684/index.html">Pengantar SSD. Bagian 2. Antarmuka</a></li>
<li><a href="../id478688/index.html">Bagaimana rasanya belajar Ilmu Data pada tahun 2019</a></li>
<li><a href="../id478690/index.html">Perakitan dinamis dan penyebaran gambar Docker dengan werf menggunakan contoh situs dokumentasi versi</a></li>
<li><a href="../id478692/index.html">Bagaimana Java 8 didukung di Android</a></li>
<li><a href="../id478696/index.html">Bagaimana Saya Mengunjungi Urban Tech 2019. Laporan Acara</a></li>
<li><a href="../id478698/index.html">Kami membuat rencana medan interaktif dalam 15 menit</a></li>
<li><a href="../id478702/index.html">Trik Pemrosesan Metrik di Kapacitor</a></li>
<li><a href="../id478706/index.html">Arsitek beban tinggi. Kursus baru dari OTUS</a></li>
<li><a href="../id478708/index.html">Bagaimana pengacak memungkinkan Anda menghembuskan kehidupan baru ke dalam game lama</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>