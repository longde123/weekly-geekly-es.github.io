<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úçüèæ üë®üèæ‚Äçü§ù‚Äçüë®üèª üò° ‡§ï‡•Å‡§¨‡•á‡§∞‡§®‡•á‡§ü‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§Ö‡§§‡•ç‡§Ø‡§ß‡§ø‡§ï ‡§∏‡•Å‡§≤‡§≠ ‡§î‡§∞ ‡§∏‡•ç‡§ï‡•á‡§≤‡•á‡§¨‡§≤ ‡§á‡§≤‡§æ‡§∏‡•ç‡§ü‡§ø‡§∏‡§∞‡•ç‡§ö üí≥ üßë üïì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‡§™‡§ø‡§õ‡§≤‡•Ä ‡§™‡•ã‡§∏‡•ç‡§ü ‡§Æ‡•á‡§Ç, ‡§π‡§Æ‡§®‡•á MongoDB ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•É‡§§‡§ø ‡§∏‡•á‡§ü ‡§ï‡•ã ‡§∏‡•ç‡§ï‡•á‡§≤ ‡§ï‡§ø‡§Ø‡§æ ‡§î‡§∞ ‡§∏‡•ç‡§ü‡•á‡§ü‡§´‡•Å‡§≤‡§∏‡•á‡§ü ‡§™‡•á‡§∂ ‡§ï‡§ø‡§Ø‡§æ‡•§ ‡§Ö‡§¨ ‡§π‡§Æ ‡§á‡§≤‡§æ‡§∏‡•ç‡§ü‡§ø‡§∏‡§∞‡•ç‡§ö ‡§â‡§ö‡•ç‡§ö ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§§‡§æ ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ (‡§Ö‡§®‡•ç‡§Ø ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞ ‡§®‡•ã‡§°‡•ç‡§∏, ‡§°‡•á‡§ü‡§æ ‡§®‡•ã...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>‡§ï‡•Å‡§¨‡•á‡§∞‡§®‡•á‡§ü‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§Ö‡§§‡•ç‡§Ø‡§ß‡§ø‡§ï ‡§∏‡•Å‡§≤‡§≠ ‡§î‡§∞ ‡§∏‡•ç‡§ï‡•á‡§≤‡•á‡§¨‡§≤ ‡§á‡§≤‡§æ‡§∏‡•ç‡§ü‡§ø‡§∏‡§∞‡•ç‡§ö</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/432374/"><p><img src="https://habrastorage.org/getpro/habr/post_images/c87/9a8/814/c879a8814087c8665d5b0259c9b36268.jpg" alt="‡§õ‡§µ‡§ø"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">‡§™‡§ø‡§õ‡§≤‡•Ä ‡§™‡•ã‡§∏‡•ç‡§ü ‡§Æ‡•á‡§Ç,</a> ‡§π‡§Æ‡§®‡•á MongoDB ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•É‡§§‡§ø ‡§∏‡•á‡§ü ‡§ï‡•ã ‡§∏‡•ç‡§ï‡•á‡§≤ ‡§ï‡§ø‡§Ø‡§æ ‡§î‡§∞ ‡§∏‡•ç‡§ü‡•á‡§ü‡§´‡•Å‡§≤‡§∏‡•á‡§ü ‡§™‡•á‡§∂ ‡§ï‡§ø‡§Ø‡§æ‡•§  ‡§Ö‡§¨ ‡§π‡§Æ ‡§á‡§≤‡§æ‡§∏‡•ç‡§ü‡§ø‡§∏‡§∞‡•ç‡§ö ‡§â‡§ö‡•ç‡§ö ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§§‡§æ ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ (‡§Ö‡§®‡•ç‡§Ø ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞ ‡§®‡•ã‡§°‡•ç‡§∏, ‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§î‡§∞ ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§•) ‡§ï‡•á ‡§ë‡§∞‡•ç‡§ï‡•á‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§≤‡§ó‡•á ‡§∞‡§π‡•á‡§Ç‡§ó‡•á ‡§î‡§∞ ES-HQ ‡§î‡§∞ Kibana ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á‡•§ </p><br><h3 id="vam-ponadobyatsya">  ‡§Ü‡§™‡§ï‡•ã ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§ó‡•Ä: </h3><br><ol><li>  ‡§è‡§≤‡•Ä‡§∏‡•ç‡§ü‡•á‡§ï‡§∞‡•ç‡§ö ‡§ï‡•Ä ‡§è‡§ï ‡§¨‡•Å‡§®‡§ø‡§Ø‡§æ‡§¶‡•Ä ‡§∏‡§Æ‡§ù, ‡§á‡§∏‡§ï‡•á ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞, ‡§®‡•ã‡§°‡•ç‡§∏ ‡§î‡§∞ ‡§â‡§®‡§ï‡•Ä ‡§≠‡•Ç‡§Æ‡§ø‡§ï‡§æ‡§è‡§Ç‡•§ </li><li>  ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ ‡§§‡•Ä‡§® ‡§®‡•ã‡§°‡•ç‡§∏ (‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ ‡§ö‡§æ‡§∞ ‡§ï‡•ã‡§∞, 4 ‡§ú‡•Ä‡§¨‡•Ä) ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§ï‡•Å‡§¨‡•á‡§∞‡§®‡•á‡§ü‡•ç‡§∏ ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞‡•§ </li><li>  ‡§ï‡§ø‡§¨‡§®‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ‡•§ <a name="habracut"></a></li></ol><br><h3 id="arhitektura-razvertyvaniya">  ‡§§‡•à‡§®‡§æ‡§§‡•Ä ‡§µ‡§æ‡§∏‡•ç‡§§‡•Å‡§ï‡§≤‡§æ </h3><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c6e/1ba/65c/c6e1ba65c2ad1c170be4f665bc969be1.jpg" alt="‡§õ‡§µ‡§ø"></p><br><ul><li>  ‡§è‡§≤‡§ø‡§Ø‡§∏‡•ç‡§ü‡§ø‡§ï‡•ç‡§∏ ‡§ñ‡•ã‡§ú <strong>‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ï‡•ã</strong> <strong>‡§∏‡•ç‡§ü‡•á‡§ü‡§´‡•Å‡§≤‡§∏‡•á‡§ü ‡§ï‡•á</strong> ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§π‡•á‡§°‡§≤‡•á‡§∏ ‡§∏‡•á‡§µ‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§π‡§Æ‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ <strong>‡§∏‡•ç‡§•‡§ø‡§∞ ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§™‡§π‡§ö‡§æ‡§®‡§ï‡§∞‡•ç‡§§‡§æ ‡§π‡•ã‡§Ç</strong> ‡•§ </li><li>  ‡§è‡§≤‡§ø‡§Ø‡§ü‡§∏‡§∞‡•ç‡§ö <strong>‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞‡•ç‡§®‡•ã‡§°‡•ç‡§∏</strong> ‡§ï‡•ã ‡§è‡§ï ‡§π‡•á‡§°‡§≤‡•á‡§∏ ‡§∏‡•á‡§µ‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï <strong>‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•É‡§§‡§ø ‡§ï‡•á</strong> ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§  ‡§Ø‡§π <strong>‡§ë‡§ü‡•ã ‡§ñ‡•ã‡§ú ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•à</strong> ‡•§ </li><li>  <strong>‡§á‡§≤‡§æ‡§∏‡•ç‡§ü‡§ø‡§ï‡•ç‡§∏‡§ñ‡•ã‡§ú</strong> <strong>‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§®‡•ã‡§°‡•ç‡§∏ ‡§™‡§∞ ‡§™‡•â‡§°‡•ç‡§∏ ‡§ï‡•ã</strong> ‡§è‡§ï ‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï ‡§∏‡•á‡§µ‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï <strong>‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•É‡§§‡§ø ‡§ï‡•á</strong> ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§Ü‡§™ ‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ï‡•ã <strong>‡§™‡§¢‡§º‡§®‡•á / ‡§≤‡§ø‡§ñ‡§®‡•á ‡§ï‡•á</strong> ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≠‡•á‡§ú ‡§∏‡§ï‡•á‡§Ç‡•§ </li><li>  <strong>Kibanaetes</strong> <strong>‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•á ‡§¨‡§æ‡§π‡§∞</strong> ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• <strong>Kibana ‡§î‡§∞ ElasticHQ ‡§™‡•â‡§°‡•ç‡§∏</strong> ‡§ï‡•ã ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•É‡§§‡§ø ‡§ï‡•á ‡§∞‡•Ç‡§™ <strong>‡§Æ‡•á‡§Ç</strong> ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® <strong>‡§∏‡§¨‡§®‡•á‡§ü ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞</strong> ‡§∏‡•ç‡§•‡§ø‡§§ ‡§π‡•à‡§Ç (‡§µ‡•á ‡§Ö‡§®‡§æ‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¨‡§æ‡§π‡§∞ ‡§ï‡•Ä ‡§ì‡§∞ ‡§ñ‡•Å‡§≤‡•á ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç)‡•§ </li><li>  <strong>HPA (‡§π‡•ã‡§∞‡§ø‡§ú‡§®‡§≤ ‡§™‡•â‡§° ‡§ë‡§ü‡•ã‡§∏‡§æ‡§≤‡§∞)</strong> <strong>‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ï‡•á</strong> ‡§≤‡§ø‡§è ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ‡§î‡§∞ ‡§â‡§ö‡•ç‡§ö ‡§≠‡§æ‡§∞ ‡§™‡§∞ ‡§ï‡•ç‡§∑‡•à‡§§‡§ø‡§ú ‡§ë‡§ü‡•ã‡§∏‡•ç‡§ï‡•ã‡§≤‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞ ‡§π‡•à‡•§ <br>  "‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§∞‡§®‡§æ ‡§Ø‡§æ‡§¶ ‡§∞‡§ñ‡•á‡§Ç: <br><ol><li> <strong>ES_JAVA_OPTS</strong> ‡§ö‡§∞‡•§ </li><li>  <strong>CLUSTER_NAME</strong> ‡§ö‡§∞‡•§ </li><li>  ‡§µ‡§ø‡§≠‡§æ‡§ú‡§ø‡§§ ‡§Æ‡§∏‡•ç‡§§‡§ø‡§∑‡•ç‡§ï ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§∏‡•á ‡§¨‡§ö‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§µ‡§æ‡§Æ‡•Ä ‡§ï‡•Ä ‡§§‡•à‡§®‡§æ‡§§‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è <strong>NUMBER_OF_MASTERS</strong> ‡§ö‡§∞‡•§  ‡§Ø‡§¶‡§ø ‡§π‡§Æ‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ 3 ‡§∏‡•ç‡§µ‡§æ‡§Æ‡•Ä ‡§π‡•à‡§Ç, ‡§§‡•ã 2 ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§ </li><li>  ‡§Ø‡§¶‡§ø ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§®‡•ã‡§° ‡§ó‡§ø‡§∞ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§â‡§ö‡•ç‡§ö ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø‡§§‡§æ ‡§ï‡•Ä ‡§ó‡§æ‡§∞‡§Ç‡§ü‡•Ä ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Æ‡§æ‡§® <strong>‡§Ü‡§§‡•ç‡§Æ‡•Ä‡§Ø‡§§‡§æ ‡§ï‡•á</strong> ‡§≤‡§ø‡§è <strong>‡§è‡§Ç‡§ü‡•Ä-‡§è‡§´‡§ø‡§®‡§ø‡§ü‡•Ä</strong> ‡§®‡§ø‡§Ø‡§Æ‡•§ <br>  " <br>  ‡§Ü‡§á‡§è ‡§á‡§® ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§ï‡•ã GKE ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§ </li></ol></li></ul><br><pre><code class="plaintext hljs">kind: Namespace metadata: name: elasticsearch --- apiVersion: apps/v1beta1 kind: Deployment metadata: name: es-master namespace: elasticsearch labels: component: elasticsearch role: master spec: replicas: 3 template: metadata: labels: component: elasticsearch role: master spec: affinity: podAntiAffinity: preferredDuringSchedulingIgnoredDuringExecution: - weight: 100 podAffinityTerm: labelSelector: matchExpressions: - key: role operator: In values: - master topologyKey: kubernetes.io/hostname initContainers: - name: init-sysctl image: busybox:1.27.2 command: - sysctl - -w - vm.max_map_count=262144 securityContext: privileged: true containers: - name: es-master image: quay.io/pires/docker-elasticsearch-kubernetes:6.2.4 env: - name: NAMESPACE valueFrom: fieldRef: fieldPath: metadata.namespace - name: NODE_NAME valueFrom: fieldRef: fieldPath: metadata.name - name: CLUSTER_NAME value: my-es - name: NUMBER_OF_MASTERS value: "2" - name: NODE_MASTER value: "true" - name: NODE_INGEST value: "false" - name: NODE_DATA value: "false" - name: HTTP_ENABLE value: "false" - name: ES_JAVA_OPTS value: -Xms256m -Xmx256m - name: PROCESSORS valueFrom: resourceFieldRef: resource: limits.cpu resources: limits: cpu: 2 ports: - containerPort: 9300 name: transport volumeMounts: - name: storage mountPath: /data volumes: - emptyDir: medium: "" name: "storage" --- apiVersion: v1 kind: Service metadata: name: elasticsearch-discovery namespace: elasticsearch labels: component: elasticsearch role: master spec: selector: component: elasticsearch role: master ports: - name: transport port: 9300 protocol: TCP clusterIP: None view rawes-master.yml hosted with love by GitHub</code> </pre> <br><p>  (‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§®‡§æ‡§§‡•Ä ‡§î‡§∞ ‡§π‡•á‡§°‡§≤‡•á‡§∏ ‡§∏‡•á‡§µ‡§æ) </p><br><pre> <code class="plaintext hljs">root$ kubectl -n elasticsearch get all NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE deploy/es-master 3 3 3 3 32s NAME DESIRED CURRENT READY AGE rs/es-master-594b58b86c 3 3 3 31s NAME READY STATUS RESTARTS AGE po/es-master-594b58b86c-9jkj2 1/1 Running 0 31s po/es-master-594b58b86c-bj7g7 1/1 Running 0 31s po/es-master-594b58b86c-lfpps 1/1 Running 0 31s NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE svc/elasticsearch-discovery ClusterIP None &lt;none&gt; 9300/TCP 31s</code> </pre> <br><p>  ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§™‡§∞ ‡§ö‡•Ç‡§≤‡•ç‡§π‡•ã‡§Ç ‡§ï‡•á ‡§≤‡•â‡§ó ‡§ï‡§æ ‡§Ö‡§ß‡•ç‡§Ø‡§Ø‡§® ‡§ï‡§∞‡§®‡§æ ‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™ ‡§π‡•à ‡§î‡§∞ ‡§¶‡•á‡§ñ‡•á‡§Ç ‡§ï‡§ø ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§Ö‡§¨ ‡§â‡§®‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§ï‡•à‡§∏‡•á ‡§ö‡•Å‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§ú‡§¨ ‡§π‡§Æ ‡§®‡§è ‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§° ‡§î‡§∞ ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§®‡•ã‡§° ‡§ú‡•ã‡§°‡§º‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡•ã ‡§Ø‡§π ‡§ï‡•à‡§∏‡•á ‡§π‡•ã‡§ó‡§æ‡•§ </p><br><pre> <code class="plaintext hljs">root$ kubectl -n elasticsearch logs -f po/es-master-594b58b86c-9jkj2 | grep ClusterApplierService [2018-10-21T07:41:54,958][INFO ][oecsClusterApplierService] [es-master-594b58b86c-9jkj2] detected_master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300}, added {{es-master-594b58b86c-lfpps}{wZQmXr5fSfWisCpOHBhaMg}{50jGPeKLSpO9RU_HhnVJCA}{10.9.124.81}{10.9.124.81:9300},{es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [3]])</code> </pre> <br><p>  ‡§Ø‡§π‡§æ‡§Ç ‡§Ü‡§™ ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø <strong>es-master-es-594b58b86c-bj7g7</strong> ‡§®‡§æ‡§Æ ‡§ï‡•á ‡§∏‡§æ‡§• <strong>‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞</strong> ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§ö‡§Ø‡§®‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§î‡§∞ ‡§Ö‡§®‡•ç‡§Ø ‡§¶‡•ã ‡§™‡•â‡§°‡•ç‡§∏ ‡§ï‡•ã ‡§á‡§∏‡§Æ‡•á‡§Ç ‡§î‡§∞ ‡§è‡§ï-‡§¶‡•Ç‡§∏‡§∞‡•á ‡§∏‡•á ‡§ú‡•ã‡§°‡§º‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ </p><br><p>  ‡§π‡•á‡§°‡§≤‡•á‡§∏ <strong>‡§á‡§≤‡§æ‡§∏‡•ç‡§ü‡§ø‡§ï‡•ç‡§∏-‡§°‡§ø‡§∏‡•ç‡§ï‡§µ‡§∞‡•Ä</strong> ‡§∏‡•á‡§µ‡§æ ‡§è‡§ï ‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£ ‡§ö‡§∞ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§°‡•â‡§ï‡§∞ ‡§õ‡§µ‡§ø ‡§Æ‡•á‡§Ç ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ <strong>‡§ï‡•Ä</strong> ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à ‡§î‡§∞ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§  ‡§Ø‡§¶‡§ø ‡§µ‡§æ‡§Ç‡§õ‡§ø‡§§ ‡§π‡•à ‡§§‡•ã ‡§Ø‡§π ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó ‡§¨‡§¶‡§≤‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§ </p><br><p>  ‡§á‡§∏‡•Ä ‡§§‡§∞‡§π, ‡§π‡§Æ <strong>‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§°‡•ç‡§∏</strong> ‡§î‡§∞ <strong>‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§®‡•ã‡§°‡•ç‡§∏</strong> ‡§§‡•à‡§®‡§æ‡§§ <strong>‡§ï‡§∞‡§§‡•á</strong> <strong>‡§π‡•à‡§Ç</strong> ‡•§  ‡§®‡•Ä‡§ö‡•á ‡§µ‡§ø‡§®‡•ç‡§Ø‡§æ‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§ </p><br><h3 id="deploy-nod-dannyh">  ‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§° ‡§®‡§ø‡§Ø‡•Å‡§ï‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç: </h3><br><pre> <code class="plaintext hljs">kind: Namespace metadata: name: elasticsearch --- apiVersion: storage.k8s.io/v1beta1 kind: StorageClass metadata: name: fast provisioner: kubernetes.io/gce-pd parameters: type: pd-ssd fsType: xfs allowVolumeExpansion: true --- apiVersion: apps/v1beta1 kind: StatefulSet metadata: name: es-data namespace: elasticsearch labels: component: elasticsearch role: data spec: serviceName: elasticsearch-data replicas: 3 template: metadata: labels: component: elasticsearch role: data spec: affinity: podAntiAffinity: preferredDuringSchedulingIgnoredDuringExecution: - weight: 100 podAffinityTerm: labelSelector: matchExpressions: - key: role operator: In values: - data topologyKey: kubernetes.io/hostname initContainers: - name: init-sysctl image: busybox:1.27.2 command: - sysctl - -w - vm.max_map_count=262144 securityContext: privileged: true containers: - name: es-data image: quay.io/pires/docker-elasticsearch-kubernetes:6.2.4 env: - name: NAMESPACE valueFrom: fieldRef: fieldPath: metadata.namespace - name: NODE_NAME valueFrom: fieldRef: fieldPath: metadata.name - name: CLUSTER_NAME value: my-es - name: NODE_MASTER value: "false" - name: NODE_INGEST value: "false" - name: HTTP_ENABLE value: "false" - name: ES_JAVA_OPTS value: -Xms256m -Xmx256m - name: PROCESSORS valueFrom: resourceFieldRef: resource: limits.cpu resources: limits: cpu: 2 ports: - containerPort: 9300 name: transport volumeMounts: - name: storage mountPath: /data volumeClaimTemplates: - metadata: name: storage annotations: volume.beta.kubernetes.io/storage-class: "fast" spec: accessModes: [ "ReadWriteOnce" ] storageClassName: fast resources: requests: storage: 10Gi --- apiVersion: v1 kind: Service metadata: name: elasticsearch-data namespace: elasticsearch labels: component: elasticsearch role: data spec: ports: - port: 9300 name: transport clusterIP: None selector: component: elasticsearch role: data view rawes-data.yml hosted with love by GitHub</code> </pre> <br><p>  (‡§∏‡•ç‡§ü‡•á‡§ü‡§∏‡§´‡•Å‡§≤‡§∏‡•á‡§ü ‡§î‡§∞ ‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•á‡§°‡§≤‡•á‡§∏ ‡§∏‡•á‡§µ‡§æ) </p><br><p>  ‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§™‡§∞ ‡§π‡•á‡§°‡§≤‡•á‡§∏ ‡§∏‡•á‡§µ‡§æ <strong>‡§∏‡•ç‡§•‡§ø‡§∞ ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§™‡§π‡§ö‡§æ‡§®‡§ï‡§∞‡•ç‡§§‡§æ</strong> ‡§ï‡•ã ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§æ‡§∞‡•Ä ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à ‡§î‡§∞ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ï‡•á ‡§¨‡•Ä‡§ö <strong>‡§°‡•á‡§ü‡§æ ‡§∏‡•ç‡§•‡§æ‡§®‡§æ‡§Ç‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç</strong> ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡•§ </p><br><p>  ‡§ö‡•Ç‡§≤‡•ç‡§π‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§≤‡§ó‡•ç‡§® ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á <strong>‡§∏‡•ç‡§•‡§æ‡§Ø‡•Ä ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ</strong> ‡§ï‡•ã <strong>‡§™‡•ç‡§∞‡§æ‡§∞‡•Ç‡§™‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ</strong> ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à‡•§  ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§¨‡§®‡§æ‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§µ‡•â‡§≤‡•ç‡§Ø‡•Ç‡§Æ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§  ‡§Ü‡§™ ‡§è‡§ï ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§≠‡•Ä ‡§∏‡•á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç <strong>‡§ú‡•ã ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§µ‡•â‡§≤‡•ç‡§Ø‡•Ç‡§Æ ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞ ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à</strong> ‡•§  ‡§µ‡§ø‡§µ‡§∞‡§£ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">‡§Ø‡§π‡§æ‡§Å</a> ‡§™‡§¢‡§º‡•á‡§Ç‡•§ </p><br><pre> <code class="plaintext hljs">parameters: type: pd-ssd fsType: xfs allowVolumeExpansion: true ...</code> </pre> <br><h3 id="deploy-klientskih-nod">  ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§®‡•ã‡§°‡•ç‡§∏ ‡§™‡§∞‡§ø‡§®‡§ø‡§Ø‡•ã‡§ú‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç: </h3><br><pre> <code class="plaintext hljs">kind: Namespace metadata: name: elasticsearch --- apiVersion: apps/v1beta1 kind: Deployment metadata: name: es-client namespace: elasticsearch labels: component: elasticsearch role: client spec: replicas: 2 template: metadata: labels: component: elasticsearch role: client spec: affinity: podAntiAffinity: preferredDuringSchedulingIgnoredDuringExecution: - weight: 100 podAffinityTerm: labelSelector: matchExpressions: - key: role operator: In values: - client topologyKey: kubernetes.io/hostname initContainers: - name: init-sysctl image: busybox:1.27.2 command: - sysctl - -w - vm.max_map_count=262144 securityContext: privileged: true containers: - name: es-client image: quay.io/pires/docker-elasticsearch-kubernetes:6.2.4 env: - name: NAMESPACE valueFrom: fieldRef: fieldPath: metadata.namespace - name: NODE_NAME valueFrom: fieldRef: fieldPath: metadata.name - name: CLUSTER_NAME value: my-es - name: NODE_MASTER value: "false" - name: NODE_DATA value: "false" - name: HTTP_ENABLE value: "true" - name: ES_JAVA_OPTS value: -Xms256m -Xmx256m - name: NETWORK_HOST value: _site_,_lo_ - name: PROCESSORS valueFrom: resourceFieldRef: resource: limits.cpu resources: limits: cpu: 1 ports: - containerPort: 9200 name: http - containerPort: 9300 name: transport volumeMounts: - name: storage mountPath: /data volumes: - emptyDir: medium: "" name: storage --- apiVersion: v1 kind: Service metadata: name: elasticsearch namespace: elasticsearch annotations: cloud.google.com/load-balancer-type: Internal labels: component: elasticsearch role: client spec: selector: component: elasticsearch role: client ports: - name: http port: 9200 type: LoadBalancer view rawes-client.yml hosted with love by GitHub</code> </pre> <br><p>  (‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§®‡§æ‡§§‡•Ä ‡§î‡§∞ ‡§¨‡§æ‡§π‡§∞‡•Ä ‡§∏‡•á‡§µ‡§æ) </p><br><p>  ‡§Ø‡§π‡§æ‡§Ç ‡§§‡•à‡§®‡§æ‡§§ ‡§∏‡•á‡§µ‡§æ ‡§ï‡•Å‡§¨‡•á‡§∞‡§®‡•á‡§ü‡•ç‡§∏ ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•á ‡§¨‡§æ‡§π‡§∞ ES ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ö‡§≠‡•Ä ‡§≠‡•Ä ‡§∏‡§¨‡§®‡•á‡§ü ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§π‡•à‡•§  ‡§è‡§®‡•ã‡§ü‡•á‡§∂‡§® <strong>‡§ï‡•ç‡§≤‡§æ‡§â‡§°</strong> . <strong>google.com/load-balancer-type: ‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï</strong> ‡§á‡§∏‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞ ‡§π‡•à‡•§ </p><br><p>  ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ö‡§ó‡§∞ ‡§à‡§è‡§∏ ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§™‡§¢‡§º‡§®‡•á ‡§î‡§∞ ‡§≤‡§ø‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§ï‡•ã ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à, ‡§§‡•ã ‡§è‡§≤‡§æ‡§∏‡•ç‡§ü‡§ø‡§ï ‡§ñ‡•ã‡§ú ‡§∏‡•á‡§µ‡§æ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">http: //elasticsearch.elasticsearch: 9200</a> ‡§™‡§∞ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§ </p><br><p>  ‡§ú‡§¨ ‡§Ü‡§™ ‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§î‡§∞ ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ï‡§æ ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§µ‡•á ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§ú‡•Å‡§°‡§º ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á‡•§  (‡§≤‡•â‡§ó ‡§ï‡•á ‡§§‡§π‡§§ ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•Ä ‡§§‡§≤‡§æ‡§∂ ‡§ï‡§∞‡•á‡§Ç) </p><br><pre> <code class="plaintext hljs">root$ kubectl -n elasticsearch get pods -l role=data NAME READY STATUS RESTARTS AGE es-data-0 1/1 Running 0 48s es-data-1 1/1 Running 0 28s -------------------------------------------------------------------- root$ kubectl apply -f es-client.yml root$ kubectl -n elasticsearch get pods -l role=client NAME READY STATUS RESTARTS AGE es-client-69b84b46d8-kr7j4 1/1 Running 0 47s es-client-69b84b46d8-v5pj2 1/1 Running 0 47s -------------------------------------------------------------------- root$ kubectl -n elasticsearch get all NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE deploy/es-client 2 2 2 2 1m deploy/es-master 3 3 3 3 9m NAME DESIRED CURRENT READY AGE rs/es-client-69b84b46d8 2 2 2 1m rs/es-master-594b58b86c 3 3 3 9m NAME DESIRED CURRENT AGE statefulsets/es-data 2 2 3m NAME READY STATUS RESTARTS AGE po/es-client-69b84b46d8-kr7j4 1/1 Running 0 1m po/es-client-69b84b46d8-v5pj2 1/1 Running 0 1m po/es-data-0 1/1 Running 0 3m po/es-data-1 1/1 Running 0 3m po/es-master-594b58b86c-9jkj2 1/1 Running 0 9m po/es-master-594b58b86c-bj7g7 1/1 Running 0 9m po/es-master-594b58b86c-lfpps 1/1 Running 0 9m NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE svc/elasticsearch LoadBalancer 10.9.121.160 10.9.120.8 9200:32310/TCP 1m svc/elasticsearch-data ClusterIP None &lt;none&gt; 9300/TCP 3m svc/elasticsearch-discovery ClusterIP None &lt;none&gt; 9300/TCP 9m -------------------------------------------------------------------- #Check logs of es-master leader pod root$ kubectl -n elasticsearch logs po/es-master-594b58b86c-bj7g7 | grep ClusterApplierService [2018-10-21T07:41:53,731][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] new_master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300}, added {{es-master-594b58b86c-lfpps}{wZQmXr5fSfWisCpOHBhaMg}{50jGPeKLSpO9RU_HhnVJCA}{10.9.124.81}{10.9.124.81:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [1] source [zen-disco-elected-as-master ([1] nodes joined)[{es-master-594b58b86c-lfpps}{wZQmXr5fSfWisCpOHBhaMg}{50jGPeKLSpO9RU_HhnVJCA}{10.9.124.81}{10.9.124.81:9300}]]]) [2018-10-21T07:41:55,162][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] added {{es-master-594b58b86c-9jkj2}{x9Prp1VbTq6_kALQVNwIWg}{7NHUSVpuS0mFDTXzAeKRcg}{10.9.125.81}{10.9.125.81:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [3] source [zen-disco-node-join[{es-master-594b58b86c-9jkj2}{x9Prp1VbTq6_kALQVNwIWg}{7NHUSVpuS0mFDTXzAeKRcg}{10.9.125.81}{10.9.125.81:9300}]]]) [2018-10-21T07:48:02,485][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] added {{es-data-0}{SAOhUiLiRkazskZ_TC6EBQ}{qirmfVJBTjSBQtHZnz-QZw}{10.9.126.88}{10.9.126.88:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [4] source [zen-disco-node-join[{es-data-0}{SAOhUiLiRkazskZ_TC6EBQ}{qirmfVJBTjSBQtHZnz-QZw}{10.9.126.88}{10.9.126.88:9300}]]]) [2018-10-21T07:48:21,984][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] added {{es-data-1}{fiv5Wh29TRWGPumm5ypJfA}{EXqKGSzIQquRyWRzxIOWhQ}{10.9.125.82}{10.9.125.82:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [5] source [zen-disco-node-join[{es-data-1}{fiv5Wh29TRWGPumm5ypJfA}{EXqKGSzIQquRyWRzxIOWhQ}{10.9.125.82}{10.9.125.82:9300}]]]) [2018-10-21T07:50:51,245][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] added {{es-client-69b84b46d8-v5pj2}{MMjA_tlTS7ux-UW44i0osg}{rOE4nB_jSmaIQVDZCjP8Rg}{10.9.125.83}{10.9.125.83:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [6] source [zen-disco-node-join[{es-client-69b84b46d8-v5pj2}{MMjA_tlTS7ux-UW44i0osg}{rOE4nB_jSmaIQVDZCjP8Rg}{10.9.125.83}{10.9.125.83:9300}]]]) [2018-10-21T07:50:58,964][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] added {{es-client-69b84b46d8-kr7j4}{gGC7F4diRWy2oM1TLTvNsg}{IgI6g3iZT5Sa0HsFVMpvvw}{10.9.124.82}{10.9.124.82:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [7] source [zen-disco-node-join[{es-client-69b84b46d8-kr7j4}{gGC7F4diRWy2oM1TLTvNsg}{IgI6g3iZT5Sa0HsFVMpvvw}{10.9.124.82}{10.9.124.82:9300}]]])</code> ] [es-‡§ó‡•Å‡§∞‡•Å-594b58b86c-bj7g7] ‡§ú‡•ã‡§°‡§º‡§æ ‡§ó‡§Ø‡§æ {{es-‡§ó‡•Å‡§∞‡•Å-594b58b86c-9jkj2} {} {x9Prp1VbTq6_kALQVNwIWg 7NHUSVpuS0mFDTXzAeKRcg} {} {10.9.125.81 10.9 <code class="plaintext hljs">root$ kubectl -n elasticsearch get pods -l role=data NAME READY STATUS RESTARTS AGE es-data-0 1/1 Running 0 48s es-data-1 1/1 Running 0 28s -------------------------------------------------------------------- root$ kubectl apply -f es-client.yml root$ kubectl -n elasticsearch get pods -l role=client NAME READY STATUS RESTARTS AGE es-client-69b84b46d8-kr7j4 1/1 Running 0 47s es-client-69b84b46d8-v5pj2 1/1 Running 0 47s -------------------------------------------------------------------- root$ kubectl -n elasticsearch get all NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE deploy/es-client 2 2 2 2 1m deploy/es-master 3 3 3 3 9m NAME DESIRED CURRENT READY AGE rs/es-client-69b84b46d8 2 2 2 1m rs/es-master-594b58b86c 3 3 3 9m NAME DESIRED CURRENT AGE statefulsets/es-data 2 2 3m NAME READY STATUS RESTARTS AGE po/es-client-69b84b46d8-kr7j4 1/1 Running 0 1m po/es-client-69b84b46d8-v5pj2 1/1 Running 0 1m po/es-data-0 1/1 Running 0 3m po/es-data-1 1/1 Running 0 3m po/es-master-594b58b86c-9jkj2 1/1 Running 0 9m po/es-master-594b58b86c-bj7g7 1/1 Running 0 9m po/es-master-594b58b86c-lfpps 1/1 Running 0 9m NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE svc/elasticsearch LoadBalancer 10.9.121.160 10.9.120.8 9200:32310/TCP 1m svc/elasticsearch-data ClusterIP None &lt;none&gt; 9300/TCP 3m svc/elasticsearch-discovery ClusterIP None &lt;none&gt; 9300/TCP 9m -------------------------------------------------------------------- #Check logs of es-master leader pod root$ kubectl -n elasticsearch logs po/es-master-594b58b86c-bj7g7 | grep ClusterApplierService [2018-10-21T07:41:53,731][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] new_master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300}, added {{es-master-594b58b86c-lfpps}{wZQmXr5fSfWisCpOHBhaMg}{50jGPeKLSpO9RU_HhnVJCA}{10.9.124.81}{10.9.124.81:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [1] source [zen-disco-elected-as-master ([1] nodes joined)[{es-master-594b58b86c-lfpps}{wZQmXr5fSfWisCpOHBhaMg}{50jGPeKLSpO9RU_HhnVJCA}{10.9.124.81}{10.9.124.81:9300}]]]) [2018-10-21T07:41:55,162][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] added {{es-master-594b58b86c-9jkj2}{x9Prp1VbTq6_kALQVNwIWg}{7NHUSVpuS0mFDTXzAeKRcg}{10.9.125.81}{10.9.125.81:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [3] source [zen-disco-node-join[{es-master-594b58b86c-9jkj2}{x9Prp1VbTq6_kALQVNwIWg}{7NHUSVpuS0mFDTXzAeKRcg}{10.9.125.81}{10.9.125.81:9300}]]]) [2018-10-21T07:48:02,485][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] added {{es-data-0}{SAOhUiLiRkazskZ_TC6EBQ}{qirmfVJBTjSBQtHZnz-QZw}{10.9.126.88}{10.9.126.88:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [4] source [zen-disco-node-join[{es-data-0}{SAOhUiLiRkazskZ_TC6EBQ}{qirmfVJBTjSBQtHZnz-QZw}{10.9.126.88}{10.9.126.88:9300}]]]) [2018-10-21T07:48:21,984][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] added {{es-data-1}{fiv5Wh29TRWGPumm5ypJfA}{EXqKGSzIQquRyWRzxIOWhQ}{10.9.125.82}{10.9.125.82:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [5] source [zen-disco-node-join[{es-data-1}{fiv5Wh29TRWGPumm5ypJfA}{EXqKGSzIQquRyWRzxIOWhQ}{10.9.125.82}{10.9.125.82:9300}]]]) [2018-10-21T07:50:51,245][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] added {{es-client-69b84b46d8-v5pj2}{MMjA_tlTS7ux-UW44i0osg}{rOE4nB_jSmaIQVDZCjP8Rg}{10.9.125.83}{10.9.125.83:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [6] source [zen-disco-node-join[{es-client-69b84b46d8-v5pj2}{MMjA_tlTS7ux-UW44i0osg}{rOE4nB_jSmaIQVDZCjP8Rg}{10.9.125.83}{10.9.125.83:9300}]]]) [2018-10-21T07:50:58,964][INFO ][oecsClusterApplierService] [es-master-594b58b86c-bj7g7] added {{es-client-69b84b46d8-kr7j4}{gGC7F4diRWy2oM1TLTvNsg}{IgI6g3iZT5Sa0HsFVMpvvw}{10.9.124.82}{10.9.124.82:9300},}, reason: apply cluster state (from master [master {es-master-594b58b86c-bj7g7}{1aFT97hQQ7yiaBc2CYShBA}{Q3QzlaG3QGazOwtUl7N75Q}{10.9.126.87}{10.9.126.87:9300} committed version [7] source [zen-disco-node-join[{es-client-69b84b46d8-kr7j4}{gGC7F4diRWy2oM1TLTvNsg}{IgI6g3iZT5Sa0HsFVMpvvw}{10.9.124.82}{10.9.124.82:9300}]]])</code> </pre> <br><p>  <strong>‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞ ‡§™‡•â‡§° ‡§ï‡•á ‡§≤‡•â‡§ó ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¶‡§ø‡§ñ‡§æ‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§¨ ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§®‡•ã‡§° ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§</strong>  <strong>‡§°‡§ø‡§¨‡§ó‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§Ø‡§π ‡§ú‡§æ‡§®‡§®‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§π‡•à‡•§</strong> </p><br><p>  ‡§π‡§Æ‡§®‡•á ‡§∏‡§≠‡•Ä ‡§ò‡§ü‡§ï‡•ã‡§Ç ‡§ï‡•ã ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§π‡•à, ‡§î‡§∞ ‡§Ö‡§¨ ‡§π‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à: </p><br><p>  1) ‡§â‡§¨‡§Ç‡§ü‡•Ç ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§ï‡•Å‡§¨‡•á‡§∞‡§®‡•á‡§ü‡•ç‡§∏ ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§∏‡•á ‡§è‡§≤‡§ø‡§ü‡§ø‡§ï‡•ç‡§∏ ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§ </p><br><pre> <code class="plaintext hljs">root$ kubectl run my-shell --rm -i --tty --image ubuntu -- bash root@my-shell-68974bb7f7-pj9x6:/# curl http://elasticsearch.elasticsearch:9200/_cluster/health?pretty { "cluster_name" : "my-es", "status" : "green", "timed_out" : false, "number_of_nodes" : 7, "number_of_data_nodes" : 2, "active_primary_shards" : 0, "active_shards" : 0, "relocating_shards" : 0, "initializing_shards" : 0, "unassigned_shards" : 0, "delayed_unassigned_shards" : 0, "number_of_pending_tasks" : 0, "number_of_in_flight_fetch" : 0, "task_max_waiting_in_queue_millis" : 0, "active_shards_percent_as_number" : 100.0 }</code> </pre> <br><p>  2) ‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏‡§∞ ‡§ú‡•Ä‡§∏‡•Ä‡§™‡•Ä (‡§π‡§Æ‡§æ‡§∞‡•á ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç, <code>10.9.120.8</code> ) ‡§ï‡•á ‡§Ü‡§à‡§™‡•Ä ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•á ‡§¨‡§æ‡§π‡§∞ ‡§∏‡•á <code>10.9.120.8</code> ‡•§ </p><br><pre> <code class="plaintext hljs">root$ curl http://10.9.120.8:9200/_cluster/health?pretty { "cluster_name" : "my-es", "status" : "green", "timed_out" : false, "number_of_nodes" : 7, "number_of_data_nodes" : 2, "active_primary_shards" : 0, "active_shards" : 0, "relocating_shards" : 0, "initializing_shards" : 0, "unassigned_shards" : 0, "delayed_unassigned_shards" : 0, "number_of_pending_tasks" : 0, "number_of_in_flight_fetch" : 0, "task_max_waiting_in_queue_millis" : 0, "active_shards_percent_as_number" : 100.0 }</code> </pre> <br><p>  3) ‡§à‡§è‡§∏ ‡§ö‡•Ç‡§≤‡•ç‡§π‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§∞‡•ã‡§ß‡•Ä ‡§∏‡§Ç‡§¨‡§Ç‡§ß ‡§®‡§ø‡§Ø‡§Æ‡•§ </p><br><pre> <code class="plaintext hljs">root$ kubectl -n elasticsearch get pods -o wide NAME READY STATUS RESTARTS AGE IP NODE es-client-69b84b46d8-kr7j4 1/1 Running 0 10m 10.8.14.52 gke-cluster1-pool1-d2ef2b34-t6h9 es-client-69b84b46d8-v5pj2 1/1 Running 0 10m 10.8.15.53 gke-cluster1-pool1-42b4fbc4-cncn es-data-0 1/1 Running 0 12m 10.8.16.58 gke-cluster1-pool1-4cfd808c-kpx1 es-data-1 1/1 Running 0 12m 10.8.15.52 gke-cluster1-pool1-42b4fbc4-cncn es-master-594b58b86c-9jkj2 1/1 Running 0 18m 10.8.15.51 gke-cluster1-pool1-42b4fbc4-cncn es-master-594b58b86c-bj7g7 1/1 Running 0 18m 10.8.16.57 gke-cluster1-pool1-4cfd808c-kpx1 es-master-594b58b86c-lfpps 1/1 Running 0 18m 10.8.14.51 gke-cluster1-pool1-d2ef2b34-t6h9</code> </pre> <br><p>  ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§π‡§Æ‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ ‡§∏‡§Æ‡§æ‡§® ‡§®‡•ã‡§° ‡§™‡§∞ ‡§¶‡•ã ‡§∏‡§Æ‡§æ‡§® ‡§∂‡•ç‡§∞‡§µ‡§£ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç, ‡§á‡§∏‡§≤‡§ø‡§è ‡§π‡§Æ‡§®‡•á ‡§®‡•ã‡§° ‡§µ‡§ø‡§´‡§≤‡§§‡§æ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§Æ‡•á‡§Ç ‡§â‡§ö‡•ç‡§ö ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø‡§§‡§æ ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡•Ä ‡§π‡•à‡•§ </p><br><h3 id="masshtabirovanie">  ‡§∏‡•ç‡§ï‡•á‡§≤‡§ø‡§Ç‡§ó </h3><br><p>  ‡§π‡§Æ ‡§∏‡•Ä‡§™‡•Ä‡§Ø‡•Ç ‡§∏‡•Ä‡§Æ‡§æ ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è <strong>‡§ë‡§ü‡•ã‡§∏‡•ç‡§ï‡•ã‡§≤‡§ø‡§Ç‡§ó ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç</strong> ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§  ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è HPA ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§®‡•ã‡§° ‡§ï‡•á ‡§≤‡§ø‡§è: </p><br><pre> <code class="plaintext hljs">apiVersion: autoscaling/v1 kind: HorizontalPodAutoscaler metadata: name: es-client namespace: elasticsearch spec: maxReplicas: 5 minReplicas: 2 scaleTargetRef: apiVersion: extensions/v1beta1 kind: Deployment name: es-client targetCPUUtilizationPercentage: 80</code> </pre> <br><p>  ‡§ë‡§ü‡•ã-‡§∏‡•ç‡§ï‡•á‡§≤‡§ø‡§Ç‡§ó ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§®‡•ã‡§° ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§™‡•â‡§°‡•ç‡§∏ ‡§ú‡•ã‡§°‡§º‡§§‡§æ ‡§π‡•à, ‡§î‡§∞ ‡§Ø‡§π ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞ ‡§®‡•ã‡§° ‡§™‡§∞ ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§™‡•â‡§° ‡§ï‡•á ‡§≤‡•â‡§ó ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ </p><br><p>  <strong>‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§™‡§∞ ‡§™‡•â‡§°‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è</strong> , ‡§Ü‡§™‡§ï‡•ã ‡§¨‡§∏ ‡§ï‡•Å‡§¨‡•á‡§∞‡§®‡•á‡§ü‡•ç‡§∏ ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤ ‡§™‡•à‡§®‡§≤ ‡§Ø‡§æ GKE ‡§ï‡§Ç‡§∏‡•ã‡§≤ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•É‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§¨‡§¢‡§º‡§æ‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à‡•§  ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§° ‡§∏‡•ç‡§µ‡§Ø‡§Ç ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ ‡§î‡§∞ ‡§Ö‡§®‡•ç‡§Ø ‡§®‡•ã‡§°‡•ç‡§∏ ‡§∏‡•á ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§¶‡•ã‡§π‡§∞‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§ó‡§æ‡•§ </p><br><p>  <strong>‡§Æ‡•Å‡§ù‡•á ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§™‡§∞ ‡§ë‡§ü‡•ã-‡§∏‡•ç‡§ï‡•á‡§≤‡§ø‡§Ç‡§ó ‡§ï‡•Ä</strong> ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à - ‡§µ‡•á ‡§ï‡•á‡§µ‡§≤ ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§°‡•á‡§ü‡§æ ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§  ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ö‡§ó‡§∞ ‡§Ü‡§™ ‡§°‡•á‡§ü‡§æ ‡§®‡•ã‡§°‡•ç‡§∏ ‡§ú‡•ã‡§°‡§º‡§®‡•á ‡§ú‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø <strong>‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞ ‡§®‡•ã‡§°‡•ç‡§∏</strong> ‡§ï‡•Ä <strong>‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§µ‡§ø‡§∑‡§Æ ‡§π‡•à</strong> , ‡§î‡§∞ ‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è <strong>NUMBER_OF_MASTERS</strong> ‡§ö‡§∞ ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§®‡§æ ‡§® ‡§≠‡•Ç‡§≤‡•á‡§Ç‡•§ </p><br><h2 id="deploy-kibana-i-es-hq">  ‡§ï‡§ø‡§¨‡§æ‡§®‡§æ ‡§î‡§∞ ES-HQ ‡§ï‡•Ä ‡§§‡•à‡§®‡§æ‡§§‡•Ä ‡§ï‡§∞‡•á‡§Ç </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">‡§ï‡§ø‡§¨‡§æ‡§®‡§æ</a> ‡§î‡§∞ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">‡§à‡§è‡§∏-‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§æ‡§≤‡§Ø</a> </p><br><p>  Kibana ES ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§µ‡§ø‡§ú‡§º‡•Å‡§Ö‡§≤‡§æ‡§á‡§ú‡§º ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§∏‡§∞‡§≤ ‡§â‡§™‡§ï‡§∞‡§£ ‡§π‡•à, ‡§î‡§∞ ES-HQ ‡§è‡§≤‡§ø‡§∏‡•ç‡§ü‡§ø‡§ï‡•ç‡§∏ ‡§ñ‡•ã‡§ú ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§î‡§∞ ‡§Æ‡•â‡§®‡§ø‡§ü‡§∞ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§  ‡§ï‡§ø‡§¨‡§æ‡§®‡§æ ‡§î‡§∞ ES-HQ ‡§ï‡•Ä ‡§§‡•à‡§®‡§æ‡§§‡•Ä ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø, ‡§Ø‡§æ‡§¶ ‡§∞‡§ñ‡•á‡§Ç ‡§ï‡§ø: </p><br><ul><li>  ‡§π‡§Æ ‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£ ‡§ö‡§∞ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§°‡•â‡§ï ‡§õ‡§µ‡§ø ‡§Æ‡•á‡§Ç ES ‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§™‡§æ‡§∏ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ </li><li>  Kibana / ES-HQ ‡§™‡§∞‡§ø‡§®‡§ø‡§Ø‡•ã‡§ú‡§® ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•á‡§µ‡§æ ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞ ‡§¨‡§®‡•Ä ‡§π‡•Å‡§à ‡§π‡•à, ‡§Ö‡§∞‡•ç‡§•‡§æ‡§§, ‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï IP ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§  ‡§π‡§Æ ‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï ‡§ú‡•Ä‡§∏‡•Ä‡§™‡•Ä ‡§≤‡•ã‡§° ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ </li></ul><br><h3 id="deploy-kibana">  ‡§ï‡§ø‡§¨‡§æ‡§®‡§æ ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç </h3><br><pre> <code class="plaintext hljs">kind: Namespace metadata: name: elasticsearch --- apiVersion: apps/v1beta1 kind: Deployment metadata: name: es-kibana namespace: elasticsearch labels: component: elasticsearch role: kibana spec: replicas: 1 template: metadata: labels: component: elasticsearch role: kibana spec: containers: - name: es-kibana image: docker.elastic.co/kibana/kibana-oss:6.2.2 env: - name: CLUSTER_NAME value: my-es - name: ELASTICSEARCH_URL value: http://elasticsearch:9200 resources: limits: cpu: 0.5 ports: - containerPort: 5601 name: http --- apiVersion: v1 kind: Service metadata: name: kibana annotations: cloud.google.com/load-balancer-type: "Internal" namespace: elasticsearch labels: component: elasticsearch role: kibana spec: selector: component: elasticsearch role: kibana ports: - name: http port: 80 targetPort: 5601 protocol: TCP type: LoadBalancer view rawes-kibana.yml hosted with love by GitHub</code> </pre> <br><p>  (‡§§‡•à‡§®‡§æ‡§§‡•Ä ‡§î‡§∞ ‡§ï‡§ø‡§¨‡§®‡§æ ‡§∏‡•á‡§µ‡§æ) </p><br><h3 id="deploy-es-hq">  ES-HQ ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç </h3><br><pre> <code class="plaintext hljs">kind: Namespace metadata: name: elasticsearch --- apiVersion: apps/v1beta1 kind: Deployment metadata: name: es-hq namespace: elasticsearch labels: component: elasticsearch role: hq spec: replicas: 1 template: metadata: labels: component: elasticsearch role: hq spec: containers: - name: es-hq image: elastichq/elasticsearch-hq:release-v3.4.0 env: - name: HQ_DEFAULT_URL value: http://elasticsearch:9200 resources: limits: cpu: 0.5 ports: - containerPort: 5000 name: http --- apiVersion: v1 kind: Service metadata: name: hq annotations: cloud.google.com/load-balancer-type: "Internal" namespace: elasticsearch labels: component: elasticsearch role: hq spec: selector: component: elasticsearch role: hq ports: - name: http port: 80 targetPort: 5000 protocol: TCP type: LoadBalancer view rawes-hq.yml hosted with love by GitHub</code> </pre> <br><p>  (‡§§‡•à‡§®‡§æ‡§§ ‡§î‡§∞ ES-HQ ‡§∏‡•á‡§µ‡§æ) </p><br><p>  ‡§π‡§Æ ‡§¨‡§®‡§æ‡§è ‡§ó‡§è ‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏‡§∞ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ </p><br><pre> <code class="plaintext hljs">root$ kubectl -n elasticsearch get svc -l role=kibana NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE kibana LoadBalancer 10.9.121.246 10.9.120.10 80:31400/TCP 1m root$ kubectl -n elasticsearch get svc -l role=hq NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE hq LoadBalancer 10.9.121.150 10.9.120.9 80:31499/TCP 1m</code> </pre> <br><p>  http: // &lt;‡§¨‡§æ‡§π‡§∞‡•Ä- Ip-Kibana-Service&gt; / app / kibana # / home? _g = () </p><br><img src="https://habrastorage.org/webt/mh/vv/x5/mhvvx5kx_vf1gbsx-yqoyzfigja.png"><br><p>  (‡§ï‡§ø‡§¨‡§®‡§æ ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤ ‡§™‡•à‡§®‡§≤) </p><br><p>  http: // &lt;‡§¨‡§æ‡§π‡§∞‡•Ä-‡§Ü‡§à‡§™‡•Ä-‡§à‡§è‡§∏-‡§π‡§ï-‡§∏‡•á‡§µ‡§æ&gt; / #! / ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç / ‡§Æ‡•á‡§∞‡•á-‡§è‡§∏ </p><br><img src="https://habrastorage.org/webt/83/b2/o6/83b2o67igwgn4lsjhgsjmwmback.png"><br><p>  (‡§ï‡•ç‡§≤‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•Ä ‡§®‡§ø‡§ó‡§∞‡§æ‡§®‡•Ä ‡§î‡§∞ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ElasticHQ ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤ ‡§™‡•à‡§®‡§≤) </p><br><p>  ES ‡§∏‡§¨‡§∏‡•á ‡§≤‡•ã‡§ï‡§™‡•ç‡§∞‡§ø‡§Ø ‡§µ‡§ø‡§§‡§∞‡§ø‡§§ ‡§ñ‡•ã‡§ú ‡§î‡§∞ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§è‡§ï ‡§π‡•à, ‡§î‡§∞ Kubernetes ‡§Æ‡•á‡§Ç ‡§Ø‡§π ‡§∏‡•ç‡§ï‡•á‡§≤‡§ø‡§Ç‡§ó ‡§î‡§∞ ‡§â‡§ö‡•ç‡§ö ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§§‡§æ ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§π‡§≤ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§  ‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§ï‡•Å‡§¨‡•á‡§∞‡§®‡•á‡§ü‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§®‡§è ES ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•ã ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi432374/">https://habr.com/ru/post/hi432374/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi432364/index.html">‡§ß‡•ç‡§µ‡§®‡•ç‡§Ø‡§æ‡§§‡•ç‡§Æ‡§ï ‡§µ‡§∞‡•ç‡§£‡§Æ‡§æ‡§≤‡§æ: ‡§µ‡§ø‡§Æ‡§æ‡§®‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§® ‡§ï‡•à‡§∏‡•á ‡§´‡•ã‡§® ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡•ã ‡§∏‡•ç‡§•‡§æ‡§®‡§æ‡§Ç‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡•á‡§ó‡§æ</a></li>
<li><a href="../hi432366/index.html">QSAN XCubeSAN ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§Æ‡•á‡§Ç SSD ‡§ï‡•à‡§∂‡§ø‡§Ç‡§ó ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡•á‡§Ç</a></li>
<li><a href="../hi432368/index.html">‡§Ü‡§™‡§∏‡•á ‡§™‡§π‡§≤‡•á - ‡§Æ‡•â‡§°‡§∞‡•ç‡§® ‡§µ‡•á‡§¨ ‡§ê‡§™ ‡§ï‡•ã ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</a></li>
<li><a href="../hi432370/index.html">1,000-‡§ó‡•á‡§Æ ‡§ï‡•á ‡§Æ‡•à‡§ö ‡§Æ‡•á‡§Ç ‡§Ö‡§≤‡•ç‡§´‡§º‡§æ‡§ú‡§º‡•á‡§∞‡•ã ‡§®‡•á ‡§∏‡•ç‡§ü‡•â‡§ï‡§´‡§º‡§ø‡§∂ ‡§ï‡•ã ‡§π‡§∞‡§æ‡§Ø‡§æ</a></li>
<li><a href="../hi432372/index.html">Microsoft ‡§®‡•á ‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï ‡§§‡•å‡§∞ ‡§™‡§∞ ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡•Ä ‡§π‡•à ‡§ï‡§ø ‡§è‡§ú ‡§ï‡•ç‡§∞‡•ã‡§Æ‡§ø‡§Ø‡§Æ ‡§á‡§Ç‡§ú‡§® ‡§™‡§∞ ‡§∏‡•ç‡§µ‡§ø‡§ö ‡§ï‡§∞‡§§‡§æ ‡§π‡•à</a></li>
<li><a href="../hi432378/index.html">‡§∏‡§æ‡§á‡§¨‡•á‡§∞‡§ø‡§Ø‡§æ ‡§ï‡§æ ‡§è‡§ï 10 ‡§µ‡•Ä‡§Ç ‡§ó‡•ç‡§∞‡•á‡§°‡§∞ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§∞ ‡§°‡§ø‡§ú‡§æ‡§á‡§®‡§∞ ‡§¨‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡§æ ‡§π‡•à‡•§ FPGA ‡§§‡§Ç‡§§‡•ç‡§∞‡§ø‡§ï‡§æ ‡§§‡•ç‡§µ‡§∞‡§ï ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§®‡§æ‡§§‡•á ‡§π‡•à‡§Ç?</a></li>
<li><a href="../hi432380/index.html">‡§è‡§ï iPhone ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ú‡•Ä‡§µ‡§® ‡§ï‡•á ‡§õ‡§π ‡§∏‡§æ‡§≤ ‡§ú‡•ã ‡§Æ‡•Å‡§ù‡•á ‡§µ‡§ø‡§ö‡§≤‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ ‡§π‡•à</a></li>
<li><a href="../hi432382/index.html">‡§ê‡§ú‡§º ‡§á‡§® ‡§π‡§∏‡•á‡§° ‡§á‡§ó‡•á‡§≤: ‡§Æ‡§ø‡§®‡§ø‡§Æ‡•à‡§ï‡•ç‡§∏ ‡§´‡•â‡§∞ ‡§•‡•ç‡§∞‡•Ä</a></li>
<li><a href="../hi432384/index.html">‡§Ö‡§ß‡•ç‡§Ø‡§Ø‡§®: 22% Tumblr ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§è‡§ï ‡§™‡•ã‡§∞‡•ç‡§® ‡§∏‡§æ‡§á‡§ü ‡§™‡§∞ ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç, ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§Ø‡•Å‡§µ‡§æ ‡§≤‡§°‡§º‡§ï‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è</a></li>
<li><a href="../hi432386/index.html">‡§ó‡•ã‡§≤ ‡§Æ‡•á‡§ú "‡§Ü‡§à‡§ü‡•Ä ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ï‡•á ‡§µ‡§æ‡§∏‡•ç‡§§‡•Å‡§ï‡§æ‡§∞", ‡§∏‡§ø‡§§‡§Ç‡§¨‡§∞ 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>