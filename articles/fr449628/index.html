<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöô üë®üèæ‚Äçüè´ ü§õüèø Nous √©crivons "Bonjour tout le monde!" Application Web Haskell (Spock) ‚åõÔ∏è üöò üòö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je m'ennuyais d'√©crire en Python, je voulais quelque chose d'inhabituel. J'ai d√©cid√© d'essayer Haskell. Je ne connais pas la langue, mais je ne voulai...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous √©crivons "Bonjour tout le monde!" Application Web Haskell (Spock)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449628/"><p> Je m'ennuyais d'√©crire en Python, je voulais quelque chose d'inhabituel.  J'ai d√©cid√© d'essayer Haskell.  Je ne connais pas la langue, mais je ne voulais pas √©crire de programmes de formation sur console, comme le calcul factoriel.  Apr√®s avoir √©tudi√© un assez grand nombre de publications sur Haskell et son application dans la vie r√©elle, j'ai r√©alis√© que l'un des points potentiels de la croissance de la popularit√© de la langue √©tait l'√©criture d'applications Web.  Curieusement, il existe de nombreux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">frameworks Web</a> sous Haskell.  Mon choix s'est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">port√©</a> sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Spock</a> , car, √† en juger par la description, c'est un framework simple et rapide √† d√©velopper.  J'ai une certaine exp√©rience dans l'√©criture d'applications Web dans Flask, j'ai donc pens√© qu'il serait int√©ressant de comparer des approches aussi diff√©rentes pour r√©soudre des probl√®mes similaires.  Dans cet article, je vais essayer de donner ma mani√®re la plus d√©taill√©e d'essais et d'erreurs dans l'apprentissage de Haskell en √©crivant une application web √©l√©mentaire dans Spock.  Peut-√™tre que cela sera utile pour ceux qui doutent d'essayer d'√©tudier Haskell et si cela sera utile dans la vie r√©elle. </p><a name="habracut"></a><br><h2 id="nemnogo-pro-haskell-i-kak-ego-gotovit">  Un peu sur Haskell et comment le cuisiner </h2><br><p>  La premi√®re chose √† laquelle chaque d√©veloppeur est confront√© lorsqu'il apprend une nouvelle langue est le choix et la configuration d'un environnement de d√©veloppement.  Bien s√ªr, vous pouvez √©crire dans un cahier, mais si vous avez au moins une certaine exp√©rience dans le d√©veloppement de projets de production, cette m√©thode vous fera mal.  Soit dit en passant, Haskell est un langage assez ancien et commun et prend en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">charge</a> les √©diteurs et les id√©es les plus c√©l√®bres.  Mon ami Haskellist utilise emacs.  Je suis habitu√© √† l'IDE normal, j'ai donc install√© le plugin pour IntelliJ. </p><br><p>  De plus, pour le d√©veloppement, vous avez besoin d'une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pile</a> , qui est maintenant la norme et combine le compilateur, le syst√®me de gestion des packages, le syst√®me de construction et de test. </p><br><p>  Tout semble assez convivial, il n'y a eu aucun probl√®me avec l'installation.  Pour le d√©veloppement, j'utilise Mac OS, je ne l'ai pas test√© sur d'autres syst√®mes, mais je soup√ßonne que sous Linux tout d√©marrera sans probl√®me non plus. </p><br><h2 id="hello-world">  Bonjour tout le monde! </h2><br><h3 id="podgotovka">  La pr√©paration </h3><br><p> Nous allons au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tutoriel</a> et essayons de tout faire selon les instructions.  L√†, ils sugg√®rent d'abord de cr√©er un projet standard via la pile: <code>stack new MyLovelyProlect</code> .  Le projet standard est un dossier avec trois sous-dossiers: <code>app</code> , <code>src</code> , <code>test</code> .  Cela semble assez logique: un dossier pour l'application principale, un pour les fonctions auxiliaires, le troisi√®me pour les tests.  Puisque nous √©crivons "Bonjour, monde!", Nous n'avons pas besoin des dossiers <code>src</code> et <code>test</code> , mais nous n'avons pas besoin de les supprimer, car sinon nous devrons nettoyer soigneusement les autres fichiers, par exemple <code>HelloWorld.cabal</code> . </p><br><h3 id="sobstvenno-kod">  En fait, le code </h3><br><p>  Plus loin dans le tutoriel, il est propos√© de copier du code dans <code>Main.hs</code>  Nous allons simplifier un peu plus pour comparer avec ce que propose le flacon. </p><br><pre> <code class="haskell hljs"><span class="hljs-meta"><span class="hljs-meta">{-# LANGUAGE OverloadedStrings #-}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> Main <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Web.Spock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Web.Spock.Config app :: SpockM () () () () app = get root $ text "Hello World!" main :: IO () main = do cfg &lt;- defaultSpockCfg () PCNoDatabase () let mw = spock cfg app runSpock 8080 mw</code> </pre> <br><p>  A titre de comparaison, je donnerai le m√™me code en flacon: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flask app = Flask(__name__) @app.route(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Hello World!"</span></span> app.run()</code> </pre> <br><p>  Par le nombre de lignes, flask gagne toujours: 8 contre 13. Mais √©tant donn√© que Haskell est un langage typ√© typiquement et que 2 lignes occupent la d√©termination de type, la diff√©rence, √† mon avis, est petite.  Au moins, le code ci-dessus ne m'a pas fait peur d'apprendre davantage la langue. </p><br><h3 id="sborka-i-zapusk">  Assemblage et lancement </h3><br><p>  Ensuite, acc√©dez √† <code>HelloWorld.cabal</code> et ajoutez l' <code>executable HelloWorld-exe</code> √† la section <code>build-depends:</code> la <code>build-depends:</code> ligne <code>Spock &gt;=0.13</code> .  Dans le tutoriel sur le site, il est propos√© d'inclure 2 autres d√©pendances, mais pour mes besoins elles ne sont pas encore n√©cessaires.  Si nous essayons maintenant de cr√©er l'application en utilisant la <code>stack build --fast --pedantic</code> , nous obtenons l'erreur suivante: </p><br><pre> <code class="plaintext hljs">Error: While constructing the build plan, the following exceptions were encountered: In the dependencies for HelloWorld-0.1.0.0: Spock must match &gt;=0.13, but the stack configuration has no specified version (latest matching version is 0.13.0.0) needed since HelloWorld is a build target. Some different approaches to resolving this: * Consider trying 'stack solver', which uses the cabal-install solver to attempt to find some working build configuration. This can be convenient when dealing with many complicated constraint errors, but results may be unpredictable. * Recommended action: try adding the following to your extra-deps in /Users/dkvasov/Documents/Haskell/Spock/HelloWorld/stack.yaml: Spock-0.13.0.0@sha256:8115862eb4fb84a26fb7bcd34f30acf036bd2e7c4eaf813c185c5562d138bba2 Plan construction failed.</code> </pre> <br><p>  C'est assez clair: la pile ne sait pas quelle version de Spock doit √™tre install√©e, elle doit donc √™tre √©crite dans le fichier <code>stack.yaml</code> .  Ajoutez <code>extra-deps</code> et essayez de reconstruire.  L√†, d'autres erreurs similaires appara√Ætront et, par cons√©quent, dans le fichier <code>stack.yaml</code> , j'ai obtenu ce qui suit: </p><br><pre> <code class="plaintext hljs">extra-deps: - Spock-0.13.0.0 - Spock-core-0.13.0.0 - reroute-0.5.0.0 - stm-containers-0.2.16 - focus-0.1.5.2</code> </pre> <br><p>  Apr√®s cela, tout s'est rassembl√©.  Mes artefacts de collection se trouvaient dans le <code>.stack-work/dist/x86_64-osx/Cabal-2.4.0.1/build</code> . </p><br><p>  Tout a commenc√© avec la <code>stack exec HelloWorld-exe</code> commandes <code>stack exec HelloWorld-exe</code> , et sur <code>localhost:8080</code> j'ai vu l'accueil "Hello, world!".  Aucune danse avec un tambourin n'√©tait n√©cessaire. </p><br><h3 id="probuem-razobratsya-chto-voobsche-proishodit">  Nous essayons de comprendre ce qui se passe. </h3><br><p>  Jusqu'√† pr√©sent, nous n'avons utilis√© aucune connaissance sp√©cifique de la programmation fonctionnelle (FP) et du langage Haskell.  Nous avons utilis√© le bon sens et la connaissance des bases du d√©veloppement.  Vous ne pouvez pas continuer comme √ßa.  Pour une meilleure compr√©hension, nous devons savoir certaines choses sur la FA.  L'AF n'est pas l'antipode de la POO.  Ceux qui connaissent le langage Scala savent que ces deux concepts coexistent facilement.  L'antipode de FP est une programmation imp√©rative.  Alors que le mod√®le fonctionnel des calculs repose sur la composition des fonctions, le mod√®le imp√©ratif s'appuie sur le processus de changements successifs des √©tats du syst√®me.  Il s'ensuit que dans les langages purement fonctionnels tels que Haskell, on suppose que les fonctions sont "pures", c'est-√†-dire qu'elles ne contiennent pas d'√©tat mutable et "d'effets secondaires", en plus de la valeur de retour.  Cela facilite la cr√©ation de compositions de fonctionnalit√©s.  En fait, l'exigence de ¬´puret√©¬ª impose de nombreuses restrictions √† l'utilisation des langages fonctionnels dans le monde r√©el.  Cependant, comme il existe des applications de production sur Haskell, vous pouvez toujours utiliser les fonctions pures dans le monde r√©el.  Examinons de plus pr√®s nos <code>Main.hs</code> </p><br><p>  Si je comprends bien, l'application <code>app</code> est une variable de type <code>SpockM</code> , qui est une <em>monade</em> .  Tr√®s probablement, si vous n'√™tes pas familier avec le style fonctionnel de la programmation et de la th√©orie des cat√©gories, vous ne comprendrez pas la premi√®re fois de quoi il s'agit et pourquoi vous en avez besoin.  Cependant, il est n√©cessaire de traiter cela au moins au niveau de base, car les monades sont la base de l'application du langage Haskell.  Il y a pas mal d'articles de d√©tails divers sur ce sujet, y compris sur Habr√©.  Bien s√ªr, je ne les am√®nerai pas ici.  Jusqu'√† pr√©sent, je propose de consid√©rer que les monades sont une telle magie qui vous permet de produire des soi-disant effets secondaires.  Il existe une autre monade dans notre application: <code>IO</code> .  Son effet secondaire est l'entr√©e / sortie des donn√©es. </p><br><p>  SpockM est param√©tr√© par quatre autres types.  Ils correspondent √† la connexion √† la base de donn√©es, √† la session, √† l'√©tat et √† la valeur de retour.  Pour une application vide, rien de tout cela n'est n√©cessaire, nous utiliserons donc toujours le type <code>()</code> , qui est appel√© Unit.  √Ä l'int√©rieur de l' <code>app</code> nous lions des chemins aux actions.  Dans ce cas, nous avons d√©termin√© le chemin de base <code>/</code> et l'action <code>   "Hello, world!  get-</code> . </p><br><p>  Ensuite, nous cr√©ons une configuration par d√©faut et l'affectons √† <code>cfg</code> .  Ensuite, en utilisant la fonction <code>spock</code> cr√©ez un middleware pour l'application et cfg et transf√©rez-le vers <code>runSpock</code> avec le port de lancement souhait√©. </p><br><h3 id="zaklyuchenie">  Conclusion </h3><br><p>  Il est clair que tout ce qui est d√©crit ici est tr√®s simple, et tous ceux qui parlent anglais et qui sont √©quip√©s d'un cerveau pourront faire la m√™me chose en regardant le tutoriel de spock initial.  Cet article √©tait plus sur la fa√ßon dont je me suis familiaris√© avec la langue Haskell.  Et ensuite?  De plus, presque toutes les ressources d'apprentissage sugg√®rent d'utiliser l'√©tat et d'√©crire une application todo, puis de connecter la base de donn√©es, puis ... Peut-√™tre qu'√† l'avenir j'√©crirai une suite. </p><br><h2 id="ssylki">  Les r√©f√©rences </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Votre premi√®re application Web avec Spock</a> est une vid√©o assez d√©taill√©e en anglais avec une analyse d'un Hello World similaire. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr449628/">https://habr.com/ru/post/fr449628/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr449616/index.html">Entretien avec Fibonacci</a></li>
<li><a href="../fr449618/index.html">L'avenir est dans les nuages</a></li>
<li><a href="../fr449622/index.html">Personnalisez-le: personnalisez vos t√©l√©phones Snom</a></li>
<li><a href="../fr449624/index.html">Comment et pourquoi lire les fiches techniques, si les microcontr√¥leurs sont votre hobby</a></li>
<li><a href="../fr449626/index.html">Redressement cognitif: une s√©ance d'illusion √† exposition totale</a></li>
<li><a href="../fr449630/index.html">"Ils ont sugg√©r√© de se familiariser avec les calculs d'un indicateur, et il y a deux feuilles avec int√©grales et d√©riv√©es secondes"</a></li>
<li><a href="../fr449632/index.html">AMA avec Habr. V.8.0. Onboarding, des nouvelles pour tous, PWA</a></li>
<li><a href="../fr449634/index.html">J'adore l'IoT</a></li>
<li><a href="../fr449636/index.html">Comment √©viter la morsure d'un insecte qui s'embrasse</a></li>
<li><a href="../fr449640/index.html">Conception de jeux vid√©o: vous devez comprendre que vous h√©ritez</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>