<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∞üèø üí∏ üçΩÔ∏è OSPF (Teil 1) üêç ‚úîÔ∏è üåΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Artikel wurde f√ºr mich selbst geschrieben, damit ich bei Bedarf schnell mein Ged√§chtnis auffrische und die Theorie verstehe. Ich habe beschloss...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OSPF (Teil 1)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418391/"> Dieser Artikel wurde f√ºr mich selbst geschrieben, damit ich bei Bedarf schnell mein Ged√§chtnis auffrische und die Theorie verstehe.  Ich habe beschlossen, es zu ver√∂ffentlichen, vielleicht ist es f√ºr jemanden n√ºtzlich, oder vielleicht irre ich mich in etwas. <br><br>  In diesem Artikel werden wir versuchen, die OSPF-Protokolltheorie zu verstehen.  Wir werden uns nicht mit der Geschichte und dem Prozess der Erstellung des Protokolls befassen. Diese Informationen sind in fast jedem Artikel √ºber OSPF reichlich vorhanden.  Wir werden versuchen, genauer zu verstehen, wie OSPF funktioniert und wie es seine Routing-Tabelle erstellt.  Es ist wichtig, eine allgemeine Definition des Protokolls zu geben: <br><br>  <b>OSPF</b> (Open Shortest Path First) ist ein dynamisches Routing-Protokoll, das auf der Link-State-Technologie basiert und den Dijkstra-Algorithmus verwendet, um den k√ºrzesten Pfad zu finden. <br><br>  Es stellt sich sofort die Frage: Was ist Channel-Tracking-Technologie?  Ich denke, dieser Name ist nicht ganz erfolgreich.  Es kam vor, dass es zwei Arten von dynamischen Routing-Protokollen gibt: Verbindungsstatus und Distanzvektor.  Betrachten Sie ihre Arbeitsprinzipien: <br><br>  In Distance-Vector-Protokollen erkennt der Router Routeninformationen √ºber Router, die direkt mit demselben Netzwerksegment verbunden sind.  Das hei√üt, der Router verf√ºgt nur innerhalb der Grenzen seiner benachbarten Router √ºber Informationen zur Topologie und hat keine Ahnung, wie die Topologie hinter diesen Routern angeordnet ist, wobei er sich nur auf Metriken konzentriert.  In Verbindungsstatusprotokollen sollte jeder Router nicht leicht die besten Routen zu allen Remote-Netzwerken kennen, sondern auch eine vollst√§ndige Netzwerkkarte mit allen vorhandenen Verbindungen zwischen anderen Routern im Speicher haben, einschlie√ülich.  Dies wird durch den Aufbau einer speziellen LSDB-Basis erreicht, aber dazu sp√§ter mehr. <br><a name="habracut"></a><br>  Beginnen wir also damit, wie die LSDB aufgebaut ist, aus der der Router alles √ºber Routen erf√§hrt.  Wir konstruieren die anf√§ngliche Topologie f√ºr das Studium.  Es sieht so aus: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea4/c83/539/ea4c835392207c07ca33dd8ec883a707.jpg" alt="Bild"><br><br>  Wir werden OSPF konfigurieren.  Wo beginnt OSPF?  C Herstellen einer Nachbarschaft zwischen Routern - Nach dem Aktivieren von OSPF auf den Schnittstellen des Routers beginnen Router, Hello-Nachrichten zu senden.  Diese Nachricht wird alle 10 Sekunden an die Multicast-Adresse 224.0.0.5 gesendet (Hello Timer).  Wir werden OSPF zuerst auf dem vIOS1-Router aktivieren. <br><br>  Mal sehen, wie das Hello-Paket aussieht: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ca/3bf/881/6ca3bf881cddaf569bdfb54bd3913666.jpg" alt="Bild"><br><br>  In der Nachricht ist es wichtig, auf Felder wie Bereichs-ID, Quell-OSPF-Router zu achten.  Wenn der OSPF-Prozess gestartet wird, wird die Router-ID ausgew√§hlt, die erforderlich ist, um den Router unter anderen OSPF-Routern zu identifizieren.  Die Regeln f√ºr die Auswahl dieses Parameters lauten wie folgt: <br><br>  1. Konfiguriert mit einem speziellen Router-ID-Befehl ABCD - im IP-Adressformat. <br>  2. Eine Loopback-Schnittstelle und mehrere Schnittstellen mit unterschiedlichen Adressen sind konfiguriert: <br><br><ul><li>  Die der Loopback-Schnittstelle zugewiesene Adresse ist die Router-ID. </li></ul><br>  3. Konfigurierte mehrere Loopback-Schnittstellen mit jeweils mehreren IP-Adressen: <br><br><ul><li>  Die h√∂chste IP-Adresse, die einer der Loopback-Schnittstellen zugewiesen wurde, ist die Router-ID. </li></ul><br>  4. Konfigurieren Sie mehrere Schnittstellen mit jeweils einer IP-Adresse: <br><br><ul><li>  Die gr√∂√üte IP-Adresse aller aktiven Schnittstellen ist die Router-ID. </li></ul><br>  Fahren wir nun mit dem Feld Bereichs-ID fort - dies ist ein wichtigeres und grundlegenderes Konzept in OSPF.  Um mit einer gro√üen Anzahl von Routern zu arbeiten, verwendet OSPF Zonen.  Jede der Router-Schnittstellen muss zu einer Zone geh√∂ren.  In unserer Topologie geh√∂ren die Gi0 / 0-Schnittstellen von vIOS1-, vIOS2-, vIOS3- und vIOS4-Routern zur Zone 0. Der Bereich 0 wird als Backbone bezeichnet und ist das Zentrum f√ºr alle anderen Zonen.  Jede andere Zone muss mit der Backbone-Zone verbunden sein (virtuelle Verbindung wird noch nicht ber√ºcksichtigt).  In der weiteren Analyse werden diese Konzepte klarer. <br><br>  Also haben wir OSPF auf vIOS1 aktiviert und alle 10 Sekunden wurden Hello-Pakete gesendet.  Aktivieren Sie OSPF unter vIOS2 und sehen Sie, wie die Nachbarbeziehungen hergestellt werden. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9c3/721/8d4/9c37218d473f4f96d9c762300ed21bd1.jpg" alt="Bild"><br><br>  Daher √ºberwachen wir die Reihenfolge der Nachrichten sorgf√§ltig.  Erstens sendet Hello nur den Router 1.1.1.1 (192.168.1.1). Sobald wir OSPF auf 192.168.1.2 aktivieren, wird ein Hello-Paket gesendet.  vIOS1 und vIOS2 empfangen Hello-Pakete voneinander. Damit die Nachbarschaft stattfinden kann, ist es wichtig, dass die folgenden Parameter in der OSPF-Konfiguration auf beiden Routern identisch sind: <br><br><ul><li>  Hallo-Intervall - H√§ufigkeit des Sendens von Hallo-Nachrichten </li><li>  Router Dead Interval - Der Zeitraum, nach dem der Nachbar als nicht verf√ºgbar gilt, wenn kein Hallo vorhanden ist. </li><li>  Bereichs-ID - Die Nachbarschaft kann nur √ºber Schnittstellen in einer Zone eingerichtet werden. </li><li>  Authentifizierung - das f√ºr die Authentifizierung verwendete Kennwort und ggf. die Art der Authentifizierung. </li><li>  Stub-Area-Flag - Ein optionales Flag, das auf allen Routern gesetzt wird, die zum Stub-Bereich geh√∂ren </li></ul><br>  Wenn Sie sich das oben gezeigte Hello-Paket ansehen, werden alle diese Parameter im Hello-Paket angezeigt.  Sobald einer der Router (vIOS1) ein neues Hello-Paket empf√§ngt und alle Bedingungen √ºberpr√ºft, sendet er sofort ein Hello-Paket, in dem die Adresse des neuen Routers (vIOS2) im Feld Active Neighbor angegeben wird. VIOS2 empf√§ngt sich selbst und sieht sich im Nachbarfeld. F√ºgt vIOS1 hinzu an die Nachbarn und sendet das Unicast-Paket an 192.168.1.1 (vIOS1), wo es als Nachbar angezeigt wird.  Sie sind sozusagen Nachbarn geworden und jetzt beginnt der Spa√ü - der Informationsaustausch und der Aufbau der Basis-LSDB.  √úber die Einrichtung einer Nachbarschaft empfehle ich Ihnen, den folgenden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> zu lesen. <br><br>  Die LSDB-Basis enth√§lt Informationen zu Routen, und diese LSDB sollte nach der Einrichtung der Nachbarschaft auf allen Routern innerhalb derselben Zone identisch sein.  Und zun√§chst beginnen Router nach dem Einrichten einer Nachbarschaft mit der Synchronisierung ihrer Datenbanken (vIOS1 mit vIOS2).  Wie Sie sehen, beginnt alles mit dem Austausch von Nachrichten DB Description (DBD).  Lassen Sie uns zur Verdeutlichung die von OSPF verwendeten Nachrichtentypen erl√§utern: <br><br><ul><li>  Hallo - wird verwendet, um Nachbarn zu entdecken, Parameter zu √ºberpr√ºfen, Nachbarschaftsbeziehungen mit ihnen aufzubauen und die Verf√ºgbarkeit zu √ºberwachen. </li><li>  Datenbankbeschreibung (DBD) - √úberpr√ºft den Status der Datenbanksynchronisation auf Routern. </li><li>  Link-State Request (LSR) - fordert bestimmte Datens√§tze zum Status der Kan√§le vom Router zum Router zur Synchronisierung an. </li><li>  Link-State Update (LSU) - Sendet bestimmte Kanalstatusdatens√§tze als Antwort auf eine Anforderung. </li><li>  Link-State Acknowledgement (LSAck) - Best√§tigt den Empfang anderer Pakettypen. </li></ul><br>  Es ist auch wichtig, ein Konzept wie LSA einzuf√ºhren: <br><br>  <b>Link State Advertisement (LSA)</b> - Eine Dateneinheit, die den lokalen Status eines Routers oder Netzwerks beschreibt.  Viele der LSAs, die Router und Netzwerke beschreiben, bilden eine Link State Database (LSDB).  LSDB besteht aus mehreren Arten von LSA.  In <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesem</a> Artikel wird sehr detailliert √ºber jede LSA geschrieben.  DBD-Nachrichten verwenden viele Flags, um den Synchronisationsstatus zu bestimmen. Diese Nachrichten enthalten Informationen zu ihrer eigenen Datenbank.  Das hei√üt, vIOS1 meldet in diesen Nachrichten, dass in meiner Datenbank Informationen zu Netzwerken wie 192.168.0 / 24, 1.1.1.0/24 (LSA-Typ 1) enthalten sind, und vIOS2 meldet wiederum, dass es Datens√§tze enth√§lt Netzwerke: 192.168.2.0/24, 2.2.2.0/24 (LSA Typ 1).  Nach dem Empfang von DBD-Nachrichten sendet jeder Router LSAck zur Best√§tigung der empfangenen Nachricht und vergleicht dann die Informationen in der Nachbardatenbank mit seinen eigenen.  Wenn festgestellt wird, dass keine Informationen verf√ºgbar sind, sendet der Router eine LS-Anforderung, in der er vollst√§ndige Informationen zu einem LSA anfordert.  Beispielsweise hat vIOS1 eine LS-Anforderung von vIOS2 angefordert, vIOS2 antwortet mit LS Update, das bereits detaillierte Informationen zu jeder Route enth√§lt.  Unten ist das LS Update: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a79/2cc/672/a792cc672c63e0a95c5b17951567b565.jpg" alt="Bild"><br><br>  Wie Sie sehen k√∂nnen, spricht vIOS2 in diesem Beitrag √ºber die ihm bekannten Subnetze und die damit verbundenen Informationen.  Au√üerdem spricht vIOS1 √ºber seine LSDB.  Und am Ende haben Router die gleiche LSDB.  Sobald der Vorgang abgeschlossen ist, wird der Dijkstra-Algorithmus (Shortest Path First) gestartet.  Es berechnet alle bekannten Routen aus der LSDB und f√ºgt die besten davon in die Routing-Tabelle ein.  Die beste mit der niedrigeren Metrik, aber dazu sp√§ter mehr. <br><br>  Lassen Sie uns √ºber die Frage nachdenken, was passiert, wenn wir OSPF unter vIOS3 aktivieren.  Da vIOS3 LSDB erstellen und mit anderen Routern synchronisieren muss, stellt sich die Frage, mit wem genau synchronisiert werden soll.  Mit vIOS1 oder vIOS2?  Mit jedem einzeln?  Wie optimal ist das?  Daher gibt es in OSPF so etwas wie einen DR-designierten Router.  Wir f√ºhren dieses Konzept ein: <br><br>  <b>Dedizierter Router (Designated Router, DR)</b> - verwaltet den LSA-Verteilungsprozess im Netzwerk.  Jeder Netzwerkrouter stellt eine Nachbarschaftsbeziehung mit DR her.  Informationen zu √Ñnderungen im Netzwerk werden von DR, dem Router, der diese √Ñnderung erkannt hat, gesendet, und DR ist daf√ºr verantwortlich, dass diese Informationen an die anderen Router im Netzwerk gesendet werden. <br><br>  Mit anderen Worten, wenn ein neuer Router im Netzwerksegment angezeigt wird, synchronisiert er seine LSDB mit DR.  Es ist auch wichtig zu beachten, dass nicht nur neue, sondern alle anderen Router den DR dar√ºber informieren, wenn sich das Netzwerk √§ndert oder eine neue Route angezeigt wird, und der Rest diese Informationen vom DR √ºbernimmt.  Aber dann stellen sich Fragen: Was passiert, wenn DR ausf√§llt?  Wie wird DR ausgew√§hlt? <br><br>  Wenn dies fehlschl√§gt, muss ein neuer DR ausgew√§hlt werden.  Es m√ºssen neue Nachbarschaftsbeziehungen hergestellt werden, und bis die Router-Datenbanken mit der neuen DR-Datenbank synchronisiert sind, steht das Netzwerk nicht f√ºr die Paketweiterleitung zur Verf√ºgung.  Um diesen Nachteil zu beseitigen, w√§hlen Sie BDR - Backup Designated Router: <br><br>  <b>Backup Designated Router (BDR).</b>  Jeder Netzwerkrouter stellt nicht nur eine Nachbarschaftsbeziehung zu DR, sondern auch zu BDR her.  DR und BDR stellen auch Nachbarschaftsbeziehungen untereinander her.  Wenn DR ausf√§llt, wird BDR zu DR und f√ºhrt alle seine Funktionen aus.  Da Netzwerkrouter Nachbarschaftsbeziehungen zu BDRs hergestellt haben, wird die Zeit f√ºr die Nichtverf√ºgbarkeit des Netzwerks minimiert.  So erhalten wir in unserem Netzwerk nicht nur DR, sondern auch BDR.  Andere Router empfangen und melden relevante Informationen √ºber das Netzwerk nur √ºber sie.  DR und BDR k√∂nnen nur innerhalb eines Segments ausgew√§hlt werden, nicht innerhalb einer Zone!  Das hei√üt, f√ºr vIOS1-, vIOS2-, vIOS3-, vIOS4-Router werden ein DR und ein BDR ausgew√§hlt, und beispielsweise werden zwischen vIOS und vIOS1 ihre DR und BDR relativ zu ihrem Netzwerksegment bestimmt, selbst wenn sie sich im selben Bereich 0 befinden. F√ºr die Kommunikation Bei DR und BDR verwenden Router eine Multicast-Adresse von 224.0.0.6. <br><br>  Die n√§chste Frage lautet: Wie wird DR / BDR ausgew√§hlt?  Es gelten folgende Kriterien: <br><br><ol><li>  DR: Router mit der h√∂chsten Priorit√§t der OSPF-Schnittstelle. </li><li>  BDR: Router mit der zweith√∂chsten Priorit√§t der OSPF-Schnittstelle. </li><li>  Wenn die Priorit√§ten der OSPF-Schnittstellen gleich sind, wird die h√∂chste Router-ID verwendet, um die Auswahl zu treffen.  Wie gesagt, Router definieren ihre Router-ID.  Zu Beginn, als OSPF auf vIOS1 und vIOS2 gestartet wurde, fanden neben der Einrichtung einer Nachbarschaft auch DR / BDR-Wahlen statt.  VIOS2 mit ID - 2.2.2.2 gewann in diesem Streit, als vIOS1 ID - 1.1.1.1 hatte.  vIOS1 wurde als BDR ausgew√§hlt.  Es ist wichtig zu beachten, dass die Auswahl von DR und BDR nicht unmittelbar nach dem Empfang der ersten Hello-Pakete vom zweiten Router erfolgt.  Zu diesem Zweck gibt es einen speziellen Timer, der dem Router Dead Dead Interval (40 Sekunden) entspricht.  Wenn w√§hrend dieser Zeit kein Hello-Paket mit der besten ID empfangen wird, wird eine Auswahl basierend auf vorhandenen Hello-Paketen getroffen. </li></ol><br>  Erst jetzt k√∂nnen wir auf die Frage zur√ºckkommen: Was passiert, wenn wir OSPF unter vIOS3 aktivieren?  Nach der Aktivierung von OSPF beginnt vIOS3 mit dem Senden und Abh√∂ren von Hello-Paketen.  Es empf√§ngt Hello-Pakete von vIOS1 und vIOS2, die angeben, welche Router DR und BDR sind und mit wem es LSDB synchronisieren soll.  Es ist wichtig zu beachten, dass sich DR / BDR nicht √§ndert, wenn ein Router mit einer besseren ID angezeigt wird, bis einer von ihnen abst√ºrzt.  Danach beginnt vIOS3, seine LSDB mit diesen Routern zu synchronisieren. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f8e/8b2/35a/f8e8b235a0eb24d311d6b745dac5910e.jpg" alt="Bild"><br><br>  Nach dem Empfang neuer Informationen von vIOS3 sendet DR LS-Aktualisierungsnachrichten an alle Router an die Adresse 224.0.0.5, an die andere Router, die ein Paket empfangen haben, die LS-Best√§tigung an DR senden, jedoch an die Adresse 224.0.0.6 (Adresse f√ºr DR / BDR). <br><br>  Nach dem gleichen Schema verbinden wir auch vIOS4.  Nach der Synchronisation haben alle Router dieselbe LSDB.  Mal sehen, wie die Nachbarschaftszust√§nde von vIOS3 aussehen.  Befehl ip ospf neighbour anzeigen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf2/3eb/51f/bf23eb51f7a7ab94f64be8726dae9370.jpg" alt="Bild"><br><br>  Wie wir sehen k√∂nnen, ist DR 2.2.2.2, BDR 1.1.1.1 und 2WAY / DROTHER mit vIOS4 ausgew√§hlt.  Auf die Nachbarschaftsstaaten wurde <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">oben</a> verwiesen. <br><br>  Und hier sind die Nachbarschaftszust√§nde auf vIOS1 mit der etablierten Nachbarschaft mit vIOS: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f3c/583/7e7/f3c5837e7b1d99243357857cc4cb1352.jpg" alt="Bild"><br><br>  Wie Sie sehen k√∂nnen, hat er zwei DRs, weil er einen Nachbarn in einem anderen Segment des Netzwerks hat. <br><br><h3>  Multizonen </h3><br>  √úberlegen Sie, wie OSPF funktioniert, wenn mehrere Zonen verwendet werden.  √Ñndern Sie unsere Topologie, indem Sie neue Router hinzuf√ºgen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/54c/b16/f0c/54cb16f0c9293e15b65544b3b89573a4.jpg" alt="Bild"><br><br>  Zun√§chst konfigurieren wir OSPF unter vIOS1 und vIOS so, dass sich die Gi0 / 1-Schnittstellen unter vIOS und vIOS1 in Zone 1 befinden. Mal sehen, was sich √§ndert.  vIOS1 verf√ºgt jetzt √ºber Schnittstellen in Bereich 0 (Gi0 / 0) und Bereich 1 (Gi0 / 0).  Ein solcher Router wird als ABR - Area Border Router bezeichnet (im Folgenden wird ABR genauer definiert).  ABR sendet Routeninformationen von einer Zone in eine andere.  Dies erfolgt √ºber LSA Typ 3: <br><br>  <b>Typ 3 LSA - Netzwerk√ºbersicht LSA</b> - zusammenfassende Ank√ºndigung des Status von Netzwerkkan√§len: <br><br><ul><li>  Anzeigenverbreitung durch Edge-Router </li><li>  Ank√ºndigung beschreibt Routen zu Netzwerken au√üerhalb des lokalen Bereichs </li><li>  Enth√§lt Informationen zu Netzwerken und den Kosten des Pfads zu diesen Netzwerken, sendet jedoch keine Informationen zur Netzwerktopologie </li><li>  Standardm√§√üig sendet der Edge-Router f√ºr jedes ihm bekannte Netzwerk eine separate Ank√ºndigung.  Bei Bedarf kann im ABR-Netzwerk zusammengefasst werden </li><li>  Verbindungsstatus-ID - Zielnetzwerknummer. </li></ul><br>  Im Kern √§hnelt das Funktionsprinzip des Protokolls zwischen den Zonen dem des Distanzvektorprotokolls und √ºbertr√§gt nur Routeninformationen mit Metriken.  Hier ist das LS-Update von vIOS1 in Bereich 0, das 3 LSA Typ 3-Teile enth√§lt: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f3/681/fa8/3f3681fa87bb1a94778d4bec031f37a1.jpg" alt="Bild"><br><br>  Im Kern unterscheidet sich die Struktur von LSA Typ 3 nicht wesentlich von der von LSA Typ 1, sie beeinflussen das Protokoll jedoch auf unterschiedliche Weise.  Wenn ein aktualisierter LSA empfangen wird oder wenn ein LSA Typ 1 &amp; 2 verloren geht, wird SPF (Shortest Path Algorithmus) neu gestartet und die LSDB neu berechnet. <br><br>  Beim Empfang von LSA Typ 3 tritt dieser Prozess nicht auf - es wird eine Route mit einer Metrik in LSA Typ 3 erhalten. Diese LSA speichert Daten, √ºber die ABR eine bestimmte Route empfangen wurde (ABR wird im Feld Advertising Router angegeben), und eine Metrik, um diese ABR zu erreichen bereits in LSDB verf√ºgbar.  Somit wird die Metrik von LSA Typ 3 mit der Metrik der Route zu ABR zusammengefasst und wir erhalten die fertige Route, ohne den SPF neu zu starten.  Dieser Vorgang wird als <b>partielle SPF-Berechnung bezeichnet</b> .  Dies ist sehr wichtig, da in gro√üen Netzwerken die LSDB-Gr√∂√üe sehr gro√ü sein kann und das Ausf√ºhren von SPFs h√§ufig nicht gut ist.  Die Erstellung von LSA Typ 3 legt au√üerdem nahe, dass das √Ñndern und Neuberechnen von LSDBs ein Bereich ist.  ABR berichtet nur, dass sich bei einigen Routen ge√§ndert hat. <br><br>  Es ist auch wichtig zu beachten, dass jede Route von einer Nicht-Null-Zone zu einer Nicht-Null-Zone durch Bereich 0 verl√§uft. Wenn eine ABR vorhanden ist, kann sie nicht mit Bereich 0 verbunden werden (wir schlie√üen die Option mit virtueller Verbindung aus).  Bereich 0 ist der Kern, der alle anderen Zonen verbindet und das Routing zwischen den Zonen bereitstellt.  Die Definition von ABR sieht folgenderma√üen aus: <br><br>  <b>Grenzrouter (Area Border Router, ABR)</b> - verbindet eine oder mehrere Zonen mit der Trunk-Zone und fungiert als Gateway f√ºr den Verkehr zwischen Zonen.  Ein Edge-Router verf√ºgt immer √ºber mindestens eine Schnittstelle in der Trunk-Zone.  F√ºr jede angeschlossene Zone verwaltet der Router eine separate Kanalstatusdatenbank. <br>  Wir haben uns mit der Einrichtung der Nachbarschaft, der Schaffung von LSDB und SPF mit der √ºblichen Zone befasst.  Betrachten wir nun die Konvergenz und Reaktion von OSPF auf √Ñnderungen in der Topologie. <br><br>  Schauen wir uns unsere Topologie an und stellen wir uns vor, dass vIOS3 nicht mehr funktioniert (der Status der Kan√§le hat sich nicht ge√§ndert).  Dies hilft beim Wiederherstellen der Topologie des Dead Interval Timer - 40 Sekunden.  Wenn der Router w√§hrend dieses Intervalls kein Hello-Paket von einem Nachbarn empf√§ngt, bricht die Nachbarschaft zusammen.  In unserem Fall sendet DR ein LS-Update mit LSA Typ 2, was darauf hinweist, dass sich unter den angeschlossenen Routern kein vIOS3 befindet. Dies f√ºhrt dazu, dass SPF LSDB startet und erneut z√§hlt, ohne dass LSA von vIOS3 empfangen wird.  Es ist wichtig zu beachten, dass auf einem normalen vIOS4-Router selbst die Ersch√∂pfung des Dead Interval Timer und der Verlust der N√§he zu vIOS3 nicht zu einer Neuberechnung der Topologie f√ºhren. Es ist die LS Update-Nachricht mit LSA Typ 2, die diesen Prozess startet. <br><br>  <b>Typ 2 LSA - Netzwerk LSA - Netzwerkverbindungsstatusanzeige</b> : <br><br><ul><li>  Von DR in Mehrfachzugriffsnetzwerken verteilt </li><li>  Netzwerk-LSA wird nicht f√ºr Netzwerke erstellt, in denen DR nicht ausgew√§hlt ist </li><li>  Nur innerhalb einer Zone verteilt </li><li>  Verbindungsstatus-ID - IP-Adresse der DR-Schnittstelle </li></ul><br>  Das Ignorieren von Daten, die nicht mehr funktionieren, erfolgt daher mithilfe dieser Nachricht.  Diese Anzeige von Nachbarn ist der Ausl√∂ser f√ºr das Verwerfen irrelevanter Routen. <br><br>  Schalten Sie vIOS3 wieder ein und stellen Sie die Nachbarschaft wieder her.  Das n√§chste Experiment ist eine Reaktion auf die Deaktivierung der Gi0 / 1-Schnittstelle unter vIOS3.  Sobald vIOS3 Verbindungsabbr√ºche erkennt, sendet es sofort ein LS-Update an DR an die Adresse 224.0.0.6, wo gemeldet wird, dass bestimmte Routen durch Setzen eines Flags in LSA - LS Age gleich 3600 Sekunden gefallen sind.  F√ºr LSDB ist dies Max Age und alle LSAs mit Max Age werden in SPF nicht ber√ºcksichtigt, sodass sie nicht in der Routing-Tabelle enthalten sind.  Die Frage ist: Wenn Alter LSA nat√ºrlich das maximale Alter erreicht, was passiert dann?  Zu diesem Zweck verf√ºgt OSPF √ºber LSRefreshTime - entspricht der H√§lfte des maximalen Alters. Alle 1800 Sekunden wird vom Router ein LS-Update gesendet, um die Timer-Daten zu aktualisieren: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/43a/dd0/8c4/43add08c439f2826bb85e434a2280ae5.jpg" alt="Bild"><br><br>  Ferner sendet DR, nachdem er dieses LS-Update verarbeitet hat, LS LS an alle anderen Router an die Adresse 224.0.0.5.  Sobald die Router neue Informationen erhalten, senden sie LSAck.  Dies stellt eine gute Konvergenz in OSPF sicher. <br><br><h3>  Die beste Route w√§hlen </h3><br>  Der Router w√§hlt die beste Route basierend auf dem niedrigsten Metrikwert aus.  OSPF ber√ºcksichtigt jedoch auch mehrere andere Faktoren bei der Auswahl einer Route.  In diesem Fall sind die Routenquelle und ihr Typ wichtig.  Die vorrangige Routenauswahl lautet wie folgt: <br><br><ul><li>  Interne Routen einer Zone (Intra-Area) </li><li>  Routen zwischen Zonen (Interarea) </li><li>  Externe Routen Typ 1 (E1) </li><li>  Externe Routen Typ 2 (E2) </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obwohl sich die Kosten der E2-Route beim √úbertragen nach Zonen nicht √§ndern (die Kosten des Pfads zum ASBR werden nicht addiert), werden die Kosten des Pfades zum ASBR, der die Route ank√ºndigt, verglichen, wenn die Kosten der E2-Routen zusammenfallen. Die Metrik wird ber√ºcksichtigt, wenn Sie aus Routen des gleichen Typs ausw√§hlen m√ºssen. Als Metrik wird ein solches Konzept wie Kosten verwendet. Sie wird nach folgender Formel berechnet: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kosten = Referenzbandbreite / Verbindungsbandbreite. Referenzbandbreite - die Basis der Bandbreite. Standardm√§√üig ist Cisco auf 100 MBit eingestellt. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ABR-Schleifenpr√§vention.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie oben erw√§hnt, √§hnelt das Prinzip der OSPF-Operation zwischen Zonen dem Distanzvektorprotokoll. </font><font style="vertical-align: inherit;">Mithilfe der Schleifenverh√ºtungsmechanismen k√∂nnen wir feststellen, dass der nicht optimale Pfad ausgew√§hlt wird. </font><font style="vertical-align: inherit;">Beispielsweise gibt es zwischen Zonen eine Regel wie Split Horizon aus Distanzvektorprotokollen. </font><font style="vertical-align: inherit;">Betrachten Sie dies als Beispiel, wenn wir unsere Topologie an der Grenze von Zone 0 und 4 wie folgt √§ndern: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/318/d56/328/318d56328823c86abf8df0b5439e76b7.jpg" alt="Bild"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dann erhalten wir, dass vIOS18 einen nicht optimalen Pfad mit der Metrik 100 √ºber die Gi0 / 0-Schnittstelle w√§hlt. </font><font style="vertical-align: inherit;">Dies geschieht aufgrund der Tatsache, dass vIOS18 LSA-Typ 3 nicht ber√ºcksichtigt, der nicht von Zone 0 empfangen wurde. Die obige Regel verbietet auch die R√ºck√ºbertragung dieses LSA-Typs 3 zur√ºck in Zone 0.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de418391/">https://habr.com/ru/post/de418391/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de418381/index.html">Was ist neu in DevTools in Chrome Version 68?</a></li>
<li><a href="../de418383/index.html">Android-Animationen basierend auf Kotlin und RxJava</a></li>
<li><a href="../de418385/index.html">Wie ich einen Computer f√ºr alte Spiele zusammengebaut habe</a></li>
<li><a href="../de418387/index.html">Physiker Dialog √ºber die Seele</a></li>
<li><a href="../de418389/index.html">RabbitMQ vs. Kafka: Verwenden von Kafka in ereignisorientierten Anwendungen</a></li>
<li><a href="../de418393/index.html">[Freitag] Wie wir 3D Web ges√§gt haben</a></li>
<li><a href="../de418395/index.html">Elon Musk: Lokale Generatoren elektromagnetischer Felder sch√ºtzen Kolonisten auf dem Mars</a></li>
<li><a href="../de418397/index.html">Freitag Management: Kostenlose Skillbox Webinare</a></li>
<li><a href="../de418399/index.html">Auf der Welle von Selectel FM</a></li>
<li><a href="../de418401/index.html">Wie ich nicht zu dir geworden bin: ein Beitrag der Liebe zu Systemadministratoren</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>