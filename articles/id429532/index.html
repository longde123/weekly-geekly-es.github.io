<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕺🏿 👩🏽‍🤝‍👨🏾 💭 Layanan microser yang didokumentasikan sendiri (ArangoDB + swagger) 👩🏻‍🤝‍👨🏾 👂 🐞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mempertahankan dokumentasi untuk layanan-layanan microsoft mutakhir masih membutuhkan disiplin penuh dalam pengembangan, dan biaya tenaga kerja yang b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Layanan microser yang didokumentasikan sendiri (ArangoDB + swagger)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/429532/"> Mempertahankan dokumentasi untuk layanan-layanan microsoft mutakhir masih membutuhkan disiplin penuh dalam pengembangan, dan biaya tenaga kerja yang besar.  Sebagai contoh, GraphQL menawarkan pendekatan yang sangat masuk akal untuk membuat dokumentasi, di mana dokumentasi terkait erat dengan kode program dan ini menjamin kepatuhan 100% dari dokumentasi dan layanan yang didokumentasikan.  Namun, pendekatan yang tidak biasa dari GraphQL untuk pengembang yang terbiasa dengan REST-API, masih membuatnya sulit untuk mempromosikan teknologi ini dalam pengembangan aplikasi praktis.  Di sini Anda dapat mengingat SOAP, yang telah lama memecahkan masalah kesesuaian dokumentasi dan layanan, tetapi karena terlalu rumit, ia tidak berakar di antara massa pengembang yang luas. <br><br>  Saya ingin menemukan setumpuk teknologi untuk mengembangkan layanan-layanan microser yang menyediakan kemampuan mendokumentasikan diri yang sama dari kode program ketika mengembangkan layanan-layanan REST-API "tradisional".  Dan dia, ternyata, sudah ada. <br><a name="habracut"></a><br>  Kami mendefinisikan aktor dan pemain yang akan terlibat dalam contoh kecil kami. <br><br>  ArangoDB adalah basis data hybrid + dokumen-berorientasi. <br><br>  UPD  Kenalan lebih rinci dengan database ini adalah alasan untuk kekecewaan lain.  Ternyata, setelah database melebihi batas tidak terbatas, yang dibatasi oleh RAM gratis, database mulai melambat - hanya berhenti bersama dengan server.  Pada saat yang sama, asumsi malu-malu diungkapkan bahwa transisi ke mesin penyimpanan baru akan bekerja lebih baik, yang belum dikonfirmasi. <br><br>  Foxx adalah kerangka kerja layanan mikro yang dibangun ke dalam basis data ArangoDB.  Ini berjalan pada mesin JavaScript, yang (tidak seperti nodejs) dapat secara bersamaan dieksekusi dalam jumlah paralel thread yang tidak terbatas (tidak saling menghalangi), sebagai akibatnya tidak ada kebutuhan untuk konstruksi janji / daripada / canch dan async / menunggu.  Tidak seperti mongodb, di mana tidak disarankan untuk menyalahgunakan prosedur server, dan basis data relasional di mana prosedur tersimpan juga digunakan dengan hati-hati dan tentu saja tidak berinteraksi dengan klien (browser, aplikasi seluler, dll.) Melalui REST-API, ini adalah kerangka kerja layanan mikro Foxx dirancang khusus untuk pengembangan layanan mikro yang berkomunikasi langsung dengan protokol http dengan klien. <br><br>  Swagger adalah lingkungan perangkat lunak sumber terbuka yang didukung oleh ekosistem besar alat yang membantu pengembang mengembangkan, membuat, mendokumentasikan, dan mengonsumsi layanan web RESTful.  Meskipun sebagian besar pengguna mengidentifikasi Swagger dengan UI Swagger, toolkit Swagger mencakup dukungan untuk dokumentasi otomatis, pembuatan kode, dan pembuatan kasus uji. <br><br>  Fakta bahwa Swagger menyertakan dukungan untuk pembuatan kode adalah situasi yang berlawanan dengan yang ingin kami dapatkan - ketika kode mendukung pembuatan dokumentasi.  Apa yang ditawarkan ArangoDB + Foxx hanya mencakup opsi yang berlawanan.  Ketika kode microservice menghasilkan sirkuit untuk Swagger.  Namun, sekarang Anda dapat memverifikasi ini sendiri setelah melakukan pekerjaan minimum. <br><br>  Anda harus menginstal ArangoDB untuk melakukan tindakan lebih lanjut. <br><br><ol><li>  Kami masuk ke panel admin dan memilih item untuk membuat Layanan microservice baru-&gt; Tambah layanan-&gt; Baru. </li><li>  Kami mengisi formulir yang diperlukan dalam formulir yang dibuka.  Di bidang "Koleksi Dokumen", tambahkan nama koleksi dokumen yang akan dibuat ketika layanan Microsoft digunakan.  Misalnya, kucing. </li><li>  Kami klik pada tombol install, masukkan di bidang url di mana microservice akan dipasang. </li></ol><br>  Saat memasang layanan mikro, untuk setiap koleksi dari bidang "Koleksi Dokumen" (lihat klausa 2), rute akan dibuat yang mengimplementasikan operasi CRUD menggunakan metode POST, GET, PUT, dan HAPUS.  Namun, ini hanya konsep metode yang dapat Anda ubah, hapus, tambahkan yang baru.  Kami memilih satu koleksi saat membuat microservice (kucing), meskipun kami mungkin tidak melakukannya, tetapi menambahkan semuanya secara manual nanti. <br><br>  Sekarang, koleksi kucing kami memiliki rute untuk operasi CRUD, dan kami dapat mulai memanggil rute ini dari panel admin database dengan memilih tab API (Layanan -&gt; [Nama Layanan Mikro] -&gt; API).  Tab ini berisi antarmuka Swagger yang familier.  Dimungkinkan juga untuk menerbitkan antarmuka Swagger pada rute eksternal, diakses tidak hanya melalui panel admin, tetapi sebagai URL biasa. <br><br>  Jika kami mencoba menambahkan dokumen ke koleksi kucing menggunakan metode POST {"name": "Tom"}, kami mendapatkan status dengan kesalahan.  Karena  bidang nama yang belum kami definisikan.  Karenanya, kami akan terus bekerja dengan panel admin ArangoDB. <br><br>  4. Untuk pengembangan yang lebih mudah, ArangoDB menyediakan mode Pengembangan, yang diaktifkan pada tab Pengaturan (Layanan -&gt; [Nama Layanan Mikro] -&gt; Pengembangan Pengaturan-Pengaturan) <br><br>  Sekarang Anda dapat mengubah kode layanan dunia dan segera mengamati hasilnya (tanpa penyebaran tambahan).  Direktori tempat kode program layanan mikro dapat ditemukan di panel admin pada tab Info (Layanan -&gt; [Nama Layanan Mikro] -&gt; Info). <br><br>  Mari kita lihat seperti apa definisi dari rute POST. <br><br><pre><code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dd = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'dedent'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> joi = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'joi'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> httpError = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'http-errors'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> status = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'statuses'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> errors = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'@arangodb'</span></span>).errors; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> createRouter = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'@arangodb/foxx/router'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Cat = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../models/cat'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> cats = <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.context.collection(<span class="hljs-string"><span class="hljs-string">'cats'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> keySchema = joi.string().required() .description(<span class="hljs-string"><span class="hljs-string">'The key of the cat'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ARANGO_NOT_FOUND = errors.ERROR_ARANGO_DOCUMENT_NOT_FOUND.code; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ARANGO_DUPLICATE = errors.ERROR_ARANGO_UNIQUE_CONSTRAINT_VIOLATED.code; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ARANGO_CONFLICT = errors.ERROR_ARANGO_CONFLICT.code; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> HTTP_NOT_FOUND = status(<span class="hljs-string"><span class="hljs-string">'not found'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> HTTP_CONFLICT = status(<span class="hljs-string"><span class="hljs-string">'conflict'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> router = createRouter(); <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = router; router.tag(<span class="hljs-string"><span class="hljs-string">'cat'</span></span>); router.post(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> cat = req.body; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> meta; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { meta = cats.save(cat); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (e) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.isArangoError &amp;&amp; e.errorNum === ARANGO_DUPLICATE) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> httpError(HTTP_CONFLICT, e.message); } <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> e; } <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign(cat, meta); res.status(<span class="hljs-number"><span class="hljs-number">201</span></span>); res.set(<span class="hljs-string"><span class="hljs-string">'location'</span></span>, req.makeAbsolute( req.reverse(<span class="hljs-string"><span class="hljs-string">'detail'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">key</span></span>: cat._key}) )); res.send(cat); }, <span class="hljs-string"><span class="hljs-string">'create'</span></span>) .body(Cat, <span class="hljs-string"><span class="hljs-string">'The cat to create.'</span></span>) .response(<span class="hljs-number"><span class="hljs-number">201</span></span>, Cat, <span class="hljs-string"><span class="hljs-string">'The created cat.'</span></span>) .error(HTTP_CONFLICT, <span class="hljs-string"><span class="hljs-string">'The cat already exists.'</span></span>) .summary(<span class="hljs-string"><span class="hljs-string">'Create a new cat'</span></span>) .description(dd<span class="hljs-string"><span class="hljs-string">` Creates a new cat from the request body and returns the saved document. `</span></span>);</code> </pre> <br><br>  Baik validasi dan dokumentasi didasarkan pada penggunaan skema objek.  Kami akan melakukan sedikit perubahan dengan menambahkan bidang nama: <br><br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> _ = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'lodash'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> joi = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'joi'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-attr"><span class="hljs-attr">schema</span></span>: { <span class="hljs-comment"><span class="hljs-comment">// Describe the attributes with joi here _key: joi.string(), name: joi.string().description('cat`s name'), //    }, forClient(obj) { // Implement outgoing transformations here obj = _.omit(obj, ['_id', '_rev', '_oldRev']); return obj; }, fromClient(obj) { // Implement incoming transformations here return obj; } };</span></span></code> </pre><br><br>  Dengan pergi ke bookmark API, Anda dapat memastikan bahwa skema telah berubah dan sekarang objek dengan bidang nama dapat ditambahkan ke koleksi kucing. <br><br>  apapacy@gmail.com <br>  12 November 2018. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id429532/">https://habr.com/ru/post/id429532/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id429514/index.html">Microsoft memberi tahu cara mengatasi masalah keamanan data pada SSD dengan enkripsi perangkat keras yang bocor</a></li>
<li><a href="../id429522/index.html">Merancang robot layanan. Pernyataan masalah, arsitektur solusi</a></li>
<li><a href="../id429524/index.html">API JSON atau JSON RPC yang benar</a></li>
<li><a href="../id429528/index.html">Intisari bahan-bahan segar dari dunia front-end untuk minggu terakhir No. 338 (5 - 11 November, 2018)</a></li>
<li><a href="../id429530/index.html">Mesin susun monoid</a></li>
<li><a href="../id429536/index.html">PHP Digest No. 143 (1 - 12 November 2018)</a></li>
<li><a href="../id429540/index.html">Kami mengembalikan geometri objek terperinci untuk validasi bermacam-macam yang lebih akurat</a></li>
<li><a href="../id429542/index.html">Pesan pribadi dari 81.000 akun Facebook disiapkan untuk dijual</a></li>
<li><a href="../id429544/index.html">Konferensi besar NIXMultiConf (Kharkov)</a></li>
<li><a href="../id429546/index.html">“Kursus tidak hanya demi pengetahuan, banyak yang memiliki ambisi karier dan tugas pengembangan profesional”</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>