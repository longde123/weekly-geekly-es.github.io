<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∂ üìÄ üêç Des scripts simples √† l'application client-serveur √† faire soi-m√™me sur WCF: pourquoi j'aime travailler en CM üßö üë©‚Äçüî¨ üí≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le travail dans l'√©quipe de gestion de la configuration est associ√© √† la garantie de la fonctionnalit√© des processus de construction - assemblage des ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Des scripts simples √† l'application client-serveur √† faire soi-m√™me sur WCF: pourquoi j'aime travailler en CM</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/veeam/blog/417701/">  Le travail dans l'√©quipe de gestion de la configuration est associ√© √† la garantie de la fonctionnalit√© des processus de construction - assemblage des produits de l'entreprise, v√©rification pr√©liminaire du code, analyse statistique, documentation et bien plus encore.  De plus, nous travaillons constamment √† l'optimisation de divers processus et, ce qui est merveilleux, nous sommes pratiquement libres de choisir des outils pour ce travail int√©ressant.  Ensuite, je vais expliquer en d√©tail comment, n'ayant qu'un niveau de connaissance diff√©rent en C # et C ++, j'ai cr√©√© un service WCF fonctionnel pour travailler avec des files d'attente de correctifs.  Et pourquoi j'ai d√©cid√© que c'√©tait tr√®s important. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b47/a3e/2d9/b47a3e2d9febdfd19dcde2b59d58df1b.png"><br><a name="habracut"></a><br><h2>  Automatisation une fois ou instruction de 117 pages encore et encore </h2><br>  Une petite digression pour que vous compreniez pourquoi je m'inqui√®te tant de l'automatisation et de l'optimisation des processus. <br><br>  Avant Veeam, je travaillais pour une grande entreprise internationale - j'√©tais le chef d'√©quipe de l'√©quipe de gestion de la configuration, j'√©tais impliqu√© dans la construction de l'application et son d√©ploiement dans des environnements de test.  Le programme a √©t√© d√©velopp√© avec succ√®s, de nouvelles fonctions ont √©t√© ajout√©es, une documentation a √©t√© √©crite, dont j'ai √©galement pris en charge le support.  Mais j'ai toujours √©t√© surpris de voir qu'un programme aussi s√©rieux ne dispose pas d'un syst√®me de configuration de param√®tres normal, dont il y avait des dizaines, voire des centaines. <br><br>  J'ai parl√© avec les d√©veloppeurs de ce sujet et j'ai re√ßu une r√©ponse - le client n'a pas pay√© pour cette fonctionnalit√©, n'√©tait pas d'accord sur son co√ªt, donc la fonctionnalit√© n'a pas √©t√© mise en ≈ìuvre.  Mais en fait, l'AQ a souffert et nous, l'√©quipe SM, avons √©t√© directement touch√©s.  La configuration du programme et sa configuration pr√©liminaire ont √©t√© effectu√©es √† travers de nombreux fichiers de configuration, chacun ayant des dizaines de param√®tres. <br><br>  Chaque nouvelle version, chaque nouvelle version apportait ses modifications √† la configuration.  Les anciens fichiers de configuration ne pouvaient pas √™tre utilis√©s, car ils √©taient souvent incompatibles avec la nouvelle version.  En cons√©quence, chaque fois avant de d√©ployer la build pour le test ou sur les machines de travail des testeurs, vous avez d√ª passer beaucoup de temps √† configurer le programme, √† corriger les erreurs de configuration, √† consulter constamment les d√©veloppeurs sur le th√®me "pourquoi cela ne fonctionne-t-il pas comme √ßa maintenant?"  En g√©n√©ral, le processus n'a pas √©t√© optimis√©. <br><br>  Pour aider √† la configuration, nous avons eu une instruction de 117 pages en taille de police Arial 9. Nous avons d√ª lire tr√®s, tr√®s attentivement.  Parfois, il semblait plus facile de construire un noyau Linux avec les yeux ferm√©s sur un ordinateur √©teint. <br><br>  Il est devenu clair que l'optimisation ne pouvait pas √™tre √©vit√©e ici.  J'ai commenc√© √† √©crire mon configurateur pour un programme prenant en charge les profils et la possibilit√© de modifier les param√®tres en quelques secondes, mais le projet est arriv√© √† sa phase finale, et je suis pass√© √† travailler dans un autre projet.  Dans ce document, nous avons analys√© de nombreux journaux d'un syst√®me de facturation pour d'√©ventuels bogues du c√¥t√© serveur.  L'automatisation de nombreuses actions utilisant le langage Python m'a sauv√© de la quantit√© monstrueuse de travail manuel.  J'ai vraiment aim√© ce langage de script, et avec son aide, nous avons cr√©√© un ensemble de scripts d'analyse pour toutes les occasions.  Ces t√¢ches qui ont n√©cessit√© plusieurs jours d'analyse approfondie selon le ¬´cat logfile123 |  grep something_special ‚Äù, a pris quelques minutes.  Tout √©tait super ... et ennuyeux. <br><br><h2>  Gestion de la configuration - Nouvelles aventures </h2><br>  Je suis venu √† Veeam en tant que chef d'√©quipe pour une petite √©quipe CM.  De nombreux processus ont n√©cessit√© une automatisation, une optimisation et une refonte.  Mais il y avait une libert√© totale dans le choix des outils!  Le d√©veloppeur doit utiliser un langage de programmation sp√©cifique, de style code, un ensemble sp√©cifique de biblioth√®ques.  SM, d'autre part, peut ne rien utiliser du tout pour r√©soudre la t√¢che, s'il a suffisamment de temps, de courage et de patience pour cela. <br><br>  Veeam, comme de nombreuses autres soci√©t√©s, a pour t√¢che d'assembler les mises √† jour des produits.  La mise √† jour comprenait des centaines de fichiers, et il √©tait n√©cessaire de modifier uniquement ceux qui avaient chang√©, en tenant compte d'un certain nombre de conditions importantes.  Pour ce faire, nous avons cr√©√© un script PowerShell volumineux qui pourrait monter dans TFS, s√©lectionner des fichiers, les trier dans les dossiers n√©cessaires.  La fonctionnalit√© du script a √©t√© compl√©t√©e, elle est devenue progressivement √©norme, il a fallu beaucoup de temps pour d√©boguer et constamment quelques b√©quilles pour d√©marrer.  Il √©tait urgent de faire quelque chose. <br><br><h2>  Que voulaient les d√©veloppeurs </h2><br>  Voici les principales plaintes: <br><br><ul><li>  Impossible de mettre en file d'attente les correctifs.  Vous devez constamment v√©rifier la page Web pour voir quand l'assemblage du correctif priv√© se termine et vous pouvez commencer √† cr√©er le v√¥tre. <br></li><li>  Il n'y a pas de notifications d'erreurs - pour voir les erreurs dans l'interface graphique de l'application d'assemblage, vous devez vous rendre sur le serveur et regarder beaucoup de journaux volumineux. <br></li><li>  Il n'y a pas d'historique de build pour les correctifs priv√©s. <br></li></ul><br>  Il √©tait n√©cessaire de g√©rer ces t√¢ches et d'ajouter d'agr√©ables petites choses que les d√©veloppeurs ne refuseraient pas. <br><br><h2>  Que sont les correctifs priv√©s </h2><br>  Un correctif priv√© dans le contexte de notre d√©veloppement est un certain ensemble de corrections dans le code, qui est stock√© dans l'√©tag√®re de Team Foundation Server pour la branche de publication.  Une petite clarification pour ceux qui ne connaissent pas trop la terminologie TFS: <br><br><ul><li>  check-in - un ensemble de changements locaux dans le code source, qui est apport√© au code stock√© dans TFS.  Cette v√©rification peut √™tre v√©rifi√©e √† l'aide de processus d'int√©gration continue / d'archivage ferm√© qui vous permettent d'ignorer uniquement le code correct et de rejeter toutes les v√©rifications qui violent la collecte du projet final. <br></li><li>  shelveset - un ensemble de changements locaux dans le code source qui n'est pas directement apport√© au code source situ√© dans TFS, mais qui est accessible par son nom.  Le shellset peut √™tre d√©ploy√© sur la machine locale du d√©veloppeur ou du syst√®me de build pour fonctionner avec du code modifi√© qui n'est pas inclus dans TFS.  En outre, le shellset peut √™tre ajout√© √† TFS comme v√©rification apr√®s le d√©ploiement, lorsque tout le travail est termin√©.  Par exemple, le contr√¥leur de porte fonctionne de cette fa√ßon.  Tout d'abord, le shellset sur le g√©n√©rateur est v√©rifi√©.  Si la v√©rification r√©ussit, le shellset se transforme en v√©rification! <br></li></ul><br>  Voici ce que fait le g√©n√©rateur de correctifs priv√©: <br><br><ol><li>  Obtient le nom (num√©ro) du shellset et le d√©ploie sur le g√©n√©rateur de correctifs priv√©.  En cons√©quence, nous obtenons le code source de la version du produit ainsi que les modifications / correctifs du shellset.  La branche de publication reste inchang√©e. <br></li><li>  Sur un g√©n√©rateur de correctifs priv√©s, un projet ou une s√©rie de projets va pour lesquels un correctif priv√© a √©t√© effectu√©. <br></li><li>  L'ensemble des fichiers binaires compil√©s est copi√© dans le r√©pertoire r√©seau du correctif priv√©.  Le catalogue contient le nom du shellset, qui est une s√©quence de nombres. <br></li><li>  Le code source du g√©n√©rateur de correctifs priv√©s est restaur√© dans sa forme d'origine. <br></li></ol><br>  Pour la commodit√© des d√©veloppeurs, une interface Web est utilis√©e o√π vous pouvez sp√©cifier le produit pour lequel vous souhaitez collecter un correctif priv√©, sp√©cifier le num√©ro de shellset, s√©lectionner les projets pour lesquels vous souhaitez collecter un correctif priv√© et ajouter l'assembly du correctif √† la file d'attente.  La capture d'√©cran ci-dessous montre la version de travail finale de l'application Web, qui affiche l'√©tat actuel de la build, la file d'attente des correctifs priv√©s et l'historique de leur assemblage.  Dans notre exemple, seule la file d'attente pour l'assemblage des correctifs priv√©s est prise en compte. <br><br><h2>  Quel √©tait le mien </h2><br><ul><li>  Un g√©n√©rateur de correctifs priv√©s qui a collect√© des correctifs priv√©s √† partir du shellset TFS en lan√ßant une application console avec les param√®tres de ligne de commande donn√©s. <br></li><li>  Veeam.Builder.Agent - un service WCF √©crit par Veeam qui lance l'application avec des param√®tres en mode console sous l'utilisateur actuel et renvoie l'√©tat actuel de l'application. <br></li><li>  Le service Web IIS est une application sur Windows Forms qui vous permet de saisir le nom du shellset, les param√®tres sp√©cifi√©s et de d√©marrer le processus de cr√©ation d'un correctif priv√©. <br></li><li>  Une connaissance tr√®s peu approfondie de la programmation est le C ++, un peu de C # √† l'universit√©, et l'√©criture de petites applications pour l'automatisation, ajoutant de nouvelles fonctions aux processus de construction actuels et comme passe-temps. <br></li><li>  Des coll√®gues exp√©riment√©s, Google et des articles indiens MSDN sont des sources de r√©ponses √† toutes les questions. <br></li></ul><br><h2>  Que ferons-nous </h2><br>  Dans cet article, je dirai comment j'ai impl√©ment√© la mise en file d'attente de l'assemblage des correctifs et leur lancement s√©quentiel sur le g√©n√©rateur.  Voici les parties de la solution: <br><br><ul><li>  QBuilder.AppQueue est mon service WCF qui fournit le travail avec la file d'attente de g√©n√©ration et appelle le service Veeam.Builder.Agent pour ex√©cuter le programme de g√©n√©ration. <br></li><li>  dummybuild.exe est un programme de remplacement utilis√© pour le d√©bogage et comme aide visuelle.  N√©cessaire pour visualiser les param√®tres transf√©r√©s. <br></li><li>  QBuilder.AppLauncher - Service WCF qui ex√©cute des applications dans la console de l'utilisateur actuel et fonctionne en mode interactif.  Il s'agit d'un analogue consid√©rablement simplifi√© du programme Veeam.Builder.Agent √©crit sp√©cifiquement pour cet article.  Le service d'origine peut fonctionner comme un service Windows et ex√©cuter des applications dans la console, ce qui n√©cessite un travail suppl√©mentaire avec l'API Windows.  Pour d√©crire toutes les astuces, un article s√©par√© serait n√©cessaire.  Mon exemple fonctionne comme un simple service de console interactive et utilise deux fonctions - d√©marrer un processus avec des param√®tres et v√©rifier son √©tat. <br></li></ul><br>  De plus, nous avons cr√©√© une nouvelle application Web pratique qui peut fonctionner avec plusieurs g√©n√©rateurs et conserver les journaux des √©v√©nements.  Afin de ne pas surcharger l'article, nous n'en parlerons pas non plus en d√©tail.  En outre, cet article ne d√©crit pas le travail avec TFS, avec l'historique de stockage des correctifs priv√©s collect√©s et diverses classes et fonctions auxiliaires. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d3c/c13/6b9/d3cc136b9f661a26314f2a44eff3a4b3.jpg"><br><br><h2>  Cr√©ation de services WCF </h2><br>  Il existe de nombreux articles d√©taill√©s d√©crivant la cr√©ation de services WCF.  J'ai surtout aim√© le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">contenu du site Microsoft</a> .  Je l'ai pris comme base de d√©veloppement.  Pour faciliter ma connaissance du projet, j'ai √©galement pr√©sent√© les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">binaires</a> .  Commen√ßons! <br><br><h3>  Cr√©ez le service QBuilder.AppLauncher </h3><br>  Ici, nous n'aurons que le disque principal du service.  √Ä ce stade, nous devons nous assurer que le service d√©marre et fonctionne.  De plus, le code est identique pour QBuilder.AppLauncher et QBuilder.AppQueue, ce processus devra donc √™tre r√©p√©t√© deux fois. <br><br><ol><li>  Cr√©ez une nouvelle application console appel√©e QBuilder.AppLauncher <br></li><li>  Renommez Program.cs en Service.cs <br></li><li>  Renommez l'espace de noms en QBuilder.AppLauncher <br></li><li>  Ajoutez les r√©f√©rences suivantes au projet: <br>  a.  System.ServiceModel.dll <br>  b.  System.ServiceProcess.dll <br>  c.  System.Configuration.Install.dll <br></li><li>  Ajoutez les d√©finitions suivantes √† Service.cs <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ComponentModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ServiceModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ServiceProcess; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Configuration.Install;</code> </pre> <br>  Au cours de l'assemblage ult√©rieur, les d√©finitions suivantes seront √©galement n√©cessaires: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Reflection; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.XPath;</code> </pre> </li><li>  Nous d√©finissons l'interface IAppLauncher et ajoutons des fonctions pour travailler avec la file d'attente: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//    [ServiceContract(Namespace = "http://QBuilder.AppLauncher")]   public interface IAppLauncher   {    //             [OperationContract]       bool TestConnection();   }</span></span></code> </pre></li><li>  Dans la classe AppLauncherService, nous impl√©mentons l'interface et la fonction de test TestConnection: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AppLauncherService</span></span> : <span class="hljs-title"><span class="hljs-title">IAppLauncher</span></span>   {       <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestConnection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>       {           <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>;       }   }</code> </pre></li><li>  Cr√©ez une nouvelle classe AppLauncherWindowsService qui h√©rite de la classe ServiceBase.  Ajoutez la variable locale serviceHost - un lien vers ServiceHost.  Nous d√©finissons la m√©thode Main, qui appelle ServiceBase.Run (nouveau AppLauncherWindowsService ()): <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AppLauncherWindowsService</span></span> : <span class="hljs-title"><span class="hljs-title">ServiceBase</span></span>   {       <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ServiceHost serviceHost = <span class="hljs-literal"><span class="hljs-literal">null</span></span>;       <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AppLauncherWindowsService</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>       {           <span class="hljs-comment"><span class="hljs-comment">// Name the Windows Service           ServiceName = "QBuilder App Launcher";       }       public static void Main()       {           ServiceBase.Run(new AppLauncherWindowsService());       }</span></span></code> </pre></li><li>  Remplacez la fonction OnStart () qui cr√©e la nouvelle instance ServiceHost: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnStart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span>       {           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (serviceHost != <span class="hljs-literal"><span class="hljs-literal">null</span></span>)           {               serviceHost.Close();           }           <span class="hljs-comment"><span class="hljs-comment">// Create a ServiceHost for the CalculatorService type and           // provide the base address.           serviceHost = new ServiceHost(typeof(AppLauncherService));           // Open the ServiceHostBase to create listeners and start           // listening for messages.           serviceHost.Open();       }</span></span></code> </pre></li><li>  Remplacez la fonction onStop qui ferme l'instance ServiceHost: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnStop</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>       {           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (serviceHost != <span class="hljs-literal"><span class="hljs-literal">null</span></span>)           {               serviceHost.Close();               serviceHost = <span class="hljs-literal"><span class="hljs-literal">null</span></span>;           }       }   }</code> </pre></li><li>  Cr√©ez une nouvelle classe ProjectInstaller, h√©rit√©e d'Installer et marqu√©e avec RunInstallerAttribute, qui est d√©finie sur True.  Cela vous permet d'installer le service Windows √† l'aide du programme installutil.exe: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">RunInstaller(true)</span></span>]   <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ProjectInstaller</span></span> : <span class="hljs-title"><span class="hljs-title">Installer</span></span>   {       <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ServiceProcessInstaller process;       <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ServiceInstaller service;       <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProjectInstaller</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>       {           process = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceProcessInstaller();           process.Account = ServiceAccount.LocalSystem;           service = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceInstaller();           service.ServiceName = <span class="hljs-string"><span class="hljs-string">"QBuilder App Launcher"</span></span>;           Installers.Add(process);           Installers.Add(service);       }   }</code> </pre></li><li>  Modifiez le contenu du fichier app.config: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.serviceModel</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">services</span></span></span><span class="hljs-tag">&gt;</span></span>     <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"QBuilder.AppLauncher.AppLauncherService"</span></span></span><span class="hljs-tag">              </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">behaviorConfiguration</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AppLauncherServiceBehavior"</span></span></span><span class="hljs-tag">&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">host</span></span></span><span class="hljs-tag">&gt;</span></span>         <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">baseAddresses</span></span></span><span class="hljs-tag">&gt;</span></span>           <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">baseAddress</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://localhost:8000/QBuilderAppLauncher/service"</span></span></span><span class="hljs-tag">/&gt;</span></span>         <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">baseAddresses</span></span></span><span class="hljs-tag">&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">host</span></span></span><span class="hljs-tag">&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">endpoint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">                 </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">binding</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wsHttpBinding"</span></span></span><span class="hljs-tag">                 </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">contract</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"QBuilder.AppLauncher.IAppLauncher"</span></span></span><span class="hljs-tag"> /&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">endpoint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mex"</span></span></span><span class="hljs-tag">                 </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">binding</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mexHttpBinding"</span></span></span><span class="hljs-tag">                 </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">contract</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IMetadataExchange"</span></span></span><span class="hljs-tag"> /&gt;</span></span>     <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">services</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">behaviors</span></span></span><span class="hljs-tag">&gt;</span></span>     <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceBehaviors</span></span></span><span class="hljs-tag">&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">behavior</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AppLauncherServiceBehavior"</span></span></span><span class="hljs-tag">&gt;</span></span>         <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceMetadata</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">httpGetEnabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">/&gt;</span></span>         <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceDebug</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">includeExceptionDetailInFaults</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"False"</span></span></span><span class="hljs-tag">/&gt;</span></span>       <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">behavior</span></span></span><span class="hljs-tag">&gt;</span></span>     <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceBehaviors</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">behaviors</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.serviceModel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </li></ol><br><h3>  V√©rification du bon fonctionnement du service </h3><br><ol><li>  Nous compilons le service. <br></li><li>  Installez-le avec la commande installutil.exe <br>  1) Acc√©dez au dossier o√π se trouve le fichier de service compil√© <br>  2) Ex√©cutez la commande d'installation: <br>  C: \ Windows \ Microsoft.NET \ Framework64 \ v4.0.30319 \ InstallUtil.exe </li><li>  Nous allons dans le composant logiciel enfichable services.msc, v√©rifions la disponibilit√© du service QBuilder App Launcher et l'ex√©cutons. <br></li><li>  Nous v√©rifions l'aptitude au service du service √† l'aide du programme WcfTestClient.exe, qui est inclus avec VisualStudio: <br><br>  1) Ex√©cutez WcfTestClient <br>  2) Ajoutez l'adresse du service: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http: // localhost: 8000 / QBuilderAppLauncher / service</a> <br>  3) L'interface de service s'ouvre: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f32/d38/35e/f32d3835e5b7ddcb399f7e48b3028df9.png"><br><br>  4) Nous appelons la fonction de test TestConnection, v√©rifions que tout fonctionne et que la fonction renvoie une valeur: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/00e/96a/460/00e96a46098ebee72c99b32357930759.png"></li></ol><br>  Maintenant que nous avons un disque de travail du service, nous ajoutons les fonctions dont nous avons besoin. <br><br><h3>  Pourquoi ai-je besoin d'une fonction de test qui ne fait rien </h3><br>  Quand j'ai commenc√© √† apprendre √† √©crire un service WCF √† partir de z√©ro, j'ai lu un tas d'articles sur ce sujet.  Sur la table, j'avais une douzaine ou deux feuilles imprim√©es sur lesquelles je pouvais comprendre quoi et comment.  J'avoue, je n'ai pas r√©ussi √† d√©marrer imm√©diatement le service.  J'ai pass√© beaucoup de temps et suis arriv√© √† la conclusion qu'il est vraiment important de faire un disque de service.  Avec lui, vous serez s√ªr que tout fonctionne et vous pouvez commencer √† mettre en ≈ìuvre les fonctions n√©cessaires.  L'approche peut sembler inutile, mais elle vous facilitera la vie si un tas de code √©crit ne fonctionne pas comme il se doit. <br><br><h3>  Ajoutez la possibilit√© d'ex√©cuter √† partir de la console </h3><br>  Retour √† l'application.  Au stade du d√©bogage et dans un certain nombre d'autres cas, il est n√©cessaire de d√©marrer le service sous la forme d'une application console sans vous inscrire en tant que service.  Il s'agit d'une fonctionnalit√© tr√®s utile qui vous permet de vous passer de l'utilisation fastidieuse des d√©bogueurs.  C'est dans ce mode que le service QBuilder.AppLauncher fonctionne.  Voici comment l'impl√©menter: <br><br><ol><li>  Ajoutez la proc√©dure RunInteractive √† la classe AppLauncherWindowsService, qui fournit le service en mode console: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RunInteractive</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ServiceBase[] services</span></span></span><span class="hljs-function">)</span></span> {   Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Service is running in interactive mode."</span></span>);   Console.WriteLine();   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> start = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(ServiceBase).GetMethod(<span class="hljs-string"><span class="hljs-string">"OnStart"</span></span>, BindingFlags.Instance | BindingFlags.NonPublic);   <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> service <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> services)   {       Console.Write(<span class="hljs-string"><span class="hljs-string">"Starting {0}..."</span></span>, service.ServiceName);       start.Invoke(service, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { } });       Console.Write(<span class="hljs-string"><span class="hljs-string">"Started {0}"</span></span>, service.ServiceName);   }   Console.WriteLine();   Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Press any key to stop the services and end the process..."</span></span>);   Console.ReadKey();   Console.WriteLine();   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stop = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(ServiceBase).GetMethod(<span class="hljs-string"><span class="hljs-string">"OnStop"</span></span>, BindingFlags.Instance | BindingFlags.NonPublic);   <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> service <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> services)   {       Console.Write(<span class="hljs-string"><span class="hljs-string">"Stopping {0}..."</span></span>, service.ServiceName);       stop.Invoke(service, <span class="hljs-literal"><span class="hljs-literal">null</span></span>);       Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Stopped {0}"</span></span>, service.ServiceName);   }   Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"All services stopped."</span></span>); }</code> </pre></li><li>  Nous apportons des modifications √† la proc√©dure principale - ajout du traitement des param√®tres de ligne de commande.  Avec l'option / console et une session utilisateur active ouverte, nous lan√ßons le programme en mode interactif.  Sinon, nous le lan√ßons en tant que service. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> services = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceBase[]   {       <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AppLauncherWindowsService()   };   <span class="hljs-comment"><span class="hljs-comment">//           ,      /console   if (args.Length == 1 &amp;&amp; args[0] == "/console" &amp;&amp; Environment.UserInteractive)   {       //            RunInteractive(services);   }   else   {       //          ServiceBase.Run(services);   } }</span></span></code> </pre></li></ol><br><h3>  Ajouter des fonctions pour lancer l'application et v√©rifier son statut </h3><br>  Le service est rendu extr√™mement simple, il n'y a pas de contr√¥les suppl√©mentaires.  Il ne peut ex√©cuter des applications que dans la version console et au nom de l'administrateur.  Il peut √©galement les lancer en tant que service - mais vous ne les verrez pas, ils tourneront en arri√®re-plan et vous ne pourrez les voir que via le Gestionnaire des t√¢ches.  Tout cela peut √™tre impl√©ment√©, mais c'est un sujet pour un article s√©par√©.  L'essentiel pour nous ici est un exemple de travail clair. <br><br><ol><li>  Tout d'abord, ajoutez la variable globale appProcess, qui stocke le processus en cours d'ex√©cution. <br><br>  Ajoutez-le √† la <code>public class AppLauncherService : IAppLauncher</code> : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AppLauncherService</span></span> : <span class="hljs-title"><span class="hljs-title">IAppLauncher</span></span>   {       Process appProcess;</code> </pre></li><li>  Ajoutez une fonction √† la m√™me classe qui v√©rifie l'√©tat du processus en cours d'ex√©cution: <br><br><pre> <code class="cs hljs">   <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsStarted</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>       {           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (appProcess!=<span class="hljs-literal"><span class="hljs-literal">null</span></span>)           {               <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (appProcess.HasExited)               {                   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;               }               <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>               {                   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>;               }           }           <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>           {               <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;           }       }</code> </pre><br>  La fonction renvoie false si le processus n'existe pas ou n'est pas d√©j√† en cours d'ex√©cution et true si le processus est actif. <br></li><li>  Ajoutez la fonction pour lancer l'application: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fileName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arguments, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> workingDirectory, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> domain, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> timeoutInMinutes</span></span></span><span class="hljs-function">)</span></span>       {           ProcessStartInfo processStartInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProcessStartInfo();           processStartInfo.FileName = fileName;           processStartInfo.Arguments = arguments;           processStartInfo.Domain = domain;           processStartInfo.UserName = userName;           processStartInfo.CreateNoWindow = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;           processStartInfo.UseShellExecute = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;           <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>           {               <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (appProcess!=<span class="hljs-literal"><span class="hljs-literal">null</span></span>)               {                   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!appProcess.HasExited)                   {                       Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Process is still running. Waiting..."</span></span>);                       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;                   }               }           }           <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex)           {               Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Error while checking process: {0}"</span></span>, ex);           }           <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>           {               appProcess = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Process();               appProcess.StartInfo = processStartInfo;               appProcess.Start();           }           <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex)           {               Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Error while starting process: {0}"</span></span>,ex);           }           <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>;                          }</code> </pre></li></ol><br>  La fonction lance toute application avec des param√®tres.  Les param√®tres Domain et Username ne sont pas utilis√©s dans ce contexte et peuvent √™tre vides, car le service d√©marre l'application √† partir de la session de console avec des droits d'administrateur. <br><br><h3>  Lancement du service QBuilder.AppLauncher </h3><br>  Comme d√©crit pr√©c√©demment, ce service fonctionne de mani√®re interactive et vous permet d'ex√©cuter des applications dans la session actuelle de l'utilisateur, v√©rifie si le processus est en cours d'ex√©cution ou d√©j√† termin√©. <br><br><ol><li>  Pour fonctionner, vous avez besoin des fichiers QBuilder.AppLauncher.exe et QBuilder.AppLauncher.exe.config, qui sont dans l'archive sur le lien ci-dessus.  Le code source de cette application d'auto-assemblage s'y trouve √©galement. <br></li><li>  Nous d√©marrons le service avec des droits d'administrateur. <br></li><li>  La fen√™tre de console du service s'ouvrira: <br></li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/981/e79/eb4/981e79eb4757690818462d72cbba5cc4.png"><br><br>  Toute frappe dans la console de service la ferme, soyez prudent. <br><br><ol><li>  Pour les tests, ex√©cutez wcftestclient.exe, fourni avec Visual Studio.  Nous v√©rifions la disponibilit√© du service sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http: // localhost: 8000 / QBuilderAppLauncher / service</a> ou ouvrons le lien dans Internet Explorer. <br></li></ol><br>  Si tout fonctionne, passez √† l'√©tape suivante. <br><br><h3>  Cr√©ation du service QBuilder.AppQueue </h3><br>  Et maintenant passons au service le plus important, pour lequel l'article entier a √©t√© √©crit!  Nous r√©p√©tons la s√©quence d'actions dans le chapitre ¬´Cr√©ation du service QBuilder.AppLauncher¬ª et dans le chapitre ¬´Ajout du lancement √† partir de la console¬ª, en rempla√ßant AppLauncher par AppQueue dans le code. <br><br><h3>  Ajouter un lien vers le service QBuilder.AppLauncher √† utiliser dans le service de file d'attente </h3><br><ol><li>  Dans l'Explorateur de solutions pour notre projet, s√©lectionnez Ajouter une r√©f√©rence de service et sp√©cifiez l'adresse: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">localhost</a> : 8000 / QBuilderAppLauncher / service <br></li><li>  S√©lectionnez l'espace de noms: AppLauncherService. <br></li></ol><br>  Nous pouvons maintenant acc√©der √† l'interface de service √† partir de notre programme. <br><br><h3>  Cr√©er une structure pour stocker des √©l√©ments de file d'attente </h3><br>  Dans l'espace de noms de QBuilder.AppQueue, ajoutez la classe QBuildRecord: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// ,     public class QBuildRecord { // ID  public string BuildId { get; set; } // ID  public string IssueId { get; set; } //   public string IssueName { get; set; } //    public DateTime StartDate { get; set; } //    public DateTime FinishDate { get; set; } //    C# public bool Build_CSharp { get; set; } //    C++ public bool Build_Cpp { get; set; } }</span></span></code> </pre> <br><h3>  Impl√©mentation de la classe de file d'attente CXmlQueue </h3><br>  Nous ajoutons la classe CXmlQueue.cs √† notre projet, o√π se trouvent un certain nombre de proc√©dures pour travailler avec le fichier XML: <br><br><ul><li>  Constructeur CXmlQueue - d√©finit le nom initial du fichier dans lequel la file d'attente est stock√©e. <br></li><li>  SetCurrentBuild - √©crit des informations sur la construction actuelle dans le fichier XML de file d'attente.  Il s'agit d'un √©l√©ment qui n'est pas dans la file d'attente; il stocke des informations sur le processus en cours d'ex√©cution.  Peut √™tre vide. <br></li><li>  GetCurrentBuild - Obtient les param√®tres du processus en cours d'ex√©cution √† partir du fichier XML de file d'attente.  Peut √™tre vide. <br></li><li>  ClearCurrentBuild - Cela efface l'√©l√©ment currentbuild dans le fichier XML de file d'attente si le processus se termine. <br></li><li>  OpenXmlQueue - fonction pour ouvrir le fichier XML o√π la file d'attente est stock√©e.  Si le fichier est manquant, un nouveau est cr√©√©. <br></li><li>  GetLastQueueBuildNumber - chaque build de la file d'attente a son propre num√©ro de s√©rie unique.  Cette fonction renvoie sa valeur, qui est stock√©e dans l'attribut racine. <br></li><li>  IncrementLastQueueBuildNumber - augmente la valeur du num√©ro de build lors de la mise en file d'attente d'une nouvelle build. <br></li><li>  GetCurrentQueue - Renvoie une liste d'√©l√©ments QBuildRecord √† partir du fichier XML de file d'attente. <br></li></ul><br>  Dans le code d'origine, toutes ces proc√©dures √©taient plac√©es dans la classe principale, mais pour plus de clart√©, j'ai cr√©√© une classe distincte CXmlQueue.  La classe est cr√©√©e dans l'espace de noms QBuilder.AppQueue, v√©rifiez que toutes les d√©finitions n√©cessaires sont sp√©cifi√©es: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.XPath; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">QBuilder.AppQueue</span></span> { . . . }</code> </pre> <br>  Donc, nous mettons en ≈ìuvre.  La classe CXmlQueue elle-m√™me: <br><br><div class="spoiler">  <b class="spoiler_title">Cliquez pour agrandir le spoiler avec le code</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//      XML  public class CXmlQueue { //  ,    string xmlBuildQueueFile; public CXmlQueue(string _xmlQueueFile) { xmlBuildQueueFile = _xmlQueueFile; } public string GetQueueFileName() { return xmlBuildQueueFile; } // ,       xml (   xml) public QBuildRecord GetCurrentBuild() { QBuildRecord qBr; XElement xRoot = OpenXmlQueue(); XElement xCurrentBuild = xRoot.XPathSelectElement("currentbuild"); if (xCurrentBuild != null) { qBr = new QBuildRecord(); qBr.BuildId = xCurrentBuild.Attribute("BuildId").Value; qBr.IssueId = xCurrentBuild.Attribute("IssueId").Value; qBr.StartDate = Convert.ToDateTime(xCurrentBuild.Attribute("StartDate").Value); return qBr; } return null; } // ,       xml (   xml) public void SetCurrentBuild(QBuildRecord qbr) { XElement xRoot = OpenXmlQueue(); XElement newXe = (new XElement( "currentbuild", new XAttribute("BuildId", qbr.BuildId), new XAttribute("IssueId", qbr.IssueId), new XAttribute("StartDate", DateTime.Now.ToString()) )); XElement xCurrentBuild = xRoot.XPathSelectElement("currentbuild"); if (xCurrentBuild != null) { xCurrentBuild.Remove(); // remove old value } xRoot.Add(newXe); xRoot.Save(xmlBuildQueueFile); } // ,       xml,  ,    public void ClearCurrentBuild() { XElement xRoot = OpenXmlQueue(); try { XElement xCurrentBuild = xRoot.XPathSelectElement("currentbuild"); if (xCurrentBuild != null) { Console.WriteLine("Clearing current build information."); xCurrentBuild.Remove(); } } catch (Exception ex) { Console.WriteLine("XML queue doesn't have running build yet. Nothing to clear!"); } xRoot.Save(xmlBuildQueueFile); } //   XML           public XElement OpenXmlQueue() { XElement xRoot; if (File.Exists(xmlBuildQueueFile)) { xRoot = XElement.Load(xmlBuildQueueFile, LoadOptions.None); } else { Console.WriteLine("Queue file {0} not found. Creating...", xmlBuildQueueFile); XElement xE = new XElement("BuildsQueue", new XAttribute("BuildNumber", 0)); xE.Save(xmlBuildQueueFile); xRoot = XElement.Load(xmlBuildQueueFile, LoadOptions.None); } return xRoot; } //       public int GetLastQueueBuildNumber() { XElement xRoot = OpenXmlQueue(); if (xRoot.HasAttributes) return int.Parse(xRoot.Attribute("BuildNumber").Value); return 0; } //              public int IncrementLastQueueBuildNumber() { int buildIndex = GetLastQueueBuildNumber(); buildIndex++; XElement xRoot = OpenXmlQueue(); xRoot.Attribute("BuildNumber").Value = buildIndex.ToString(); xRoot.Save(xmlBuildQueueFile); return buildIndex; } //    xml     QBuildRecord public List&lt;QBuildRecord&gt; GetCurrentQueue() { List&lt;QBuildRecord&gt; qList = new List&lt;QBuildRecord&gt;(); XElement xRoot = OpenXmlQueue(); if (xRoot.XPathSelectElements("build").Any()) { List&lt;XElement&gt; xBuilds = xRoot.XPathSelectElements("build").ToList(); foreach (XElement xe in xBuilds) { qList.Add(new QBuildRecord { BuildId = xe.Attribute("BuildId").Value, IssueId = xe.Attribute("IssueId").Value, IssueName = xe.Attribute("IssueName").Value, StartDate = Convert.ToDateTime(xe.Attribute("StartDate").Value), Build_CSharp = bool.Parse(xe.Attribute("Build_CSharp").Value), Build_Cpp = bool.Parse(xe.Attribute("Build_Cpp").Value) }); } } return qList; } }</span></span></code> </pre> <br></div></div><br>  La file d'attente dans le fichier XML est la suivante: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildNumber</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"14"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"26086"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:50.515238+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"15"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"59559"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:50.6880927+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"45275"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:50.859937+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"17"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"30990"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.0321322+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16706"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.2009904+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"19"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"66540"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.3581274+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68618"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.5087854+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"21"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18453"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.6713477+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"22"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68288"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.8277942+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"89884"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:52.0151294+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">currentbuild</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"13"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4491"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"13.06.2018 16:53:16"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Cr√©ez un fichier BuildQueue.xml avec ce contenu et placez-le dans le r√©pertoire contenant le fichier ex√©cutable.  Ce fichier sera utilis√© dans le d√©bogage des tests pour faire correspondre les r√©sultats des tests. <br><br><h3>  Ajouter une classe AuxFunctions </h3><br>  Dans cette classe, je place des fonctions d'assistance.  √Ä l'heure actuelle, il n'y a qu'une seule fonction, FormatParameters, qui effectue le formatage des param√®tres pour les transmettre √† l'application console pour le lancement.  Liste du fichier AuxFunctions.cs: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">QBuilder.AppQueue</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AuxFunctions</span></span> { <span class="hljs-comment"><span class="hljs-comment">//       public static string FormatParameters(string fileName, IDictionary&lt;string, string&gt; parameters) { if (String.IsNullOrWhiteSpace(fileName)) { throw new ArgumentNullException("fileName"); } if (parameters == null) { throw new ArgumentNullException("parameters"); } var macros = String.Join(" ", parameters.Select(parameter =&gt; String.Format("\"{0}={1}\"", parameter.Key, parameter.Value.Replace(@"""", @"\""")))); return String.Format("{0} /b \"{1}\"", macros, fileName); } } }</span></span></code> </pre> <br><h3>  Ajouter de nouvelles fonctionnalit√©s √† l'interface de service </h3><br>  La fonction de test TestConnection peut √™tre supprim√©e √† ce stade.  Pour impl√©menter le travail de la file d'attente, j'avais besoin de l'ensemble de fonctions suivant: <br><br><ul><li>  PushBuild (QBuildRecord): vide.  Il s'agit d'une fonction qui ajoute une nouvelle valeur au fichier XML de file d'attente avec les param√®tres QBuildRecord <br></li><li>  TestPushBuild (): vide.  Il s'agit d'une fonction de test qui ajoute des donn√©es de test √† une file d'attente dans un fichier XML. <br></li><li>  PullBuild: QBuildRecord.  Il s'agit d'une fonction qui re√ßoit la valeur QBuildRecord du fichier XML de file d'attente.  Il peut √™tre vide. <br></li></ul><br>  L'interface sera comme ceci: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IAppQueue</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     [OperationContract] void PushBuild(QBuildRecord qBRecord); //     [OperationContract] void TestPushBuild(); //      [OperationContract] QBuildRecord PullBuild(); }</span></span></code> </pre><br><h3>  Nous impl√©mentons des fonctions dans la classe AppQueueService: IAppQueue: </h3><br><br><div class="spoiler">  <b class="spoiler_title">Cliquez pour agrandir le spoiler avec le code</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AppQueueService</span></span> : <span class="hljs-title"><span class="hljs-title">IAppQueue</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  ,    public AppLauncherClient buildAgent; // ,      private string _xmlQueueFile; public AppQueueService() { //       .     ,  . _xmlQueueFile = ConfigurationManager.AppSettings["QueueFileName"]; } public QBuildRecord PullBuild() { QBuildRecord qBr; CXmlQueue xmlQueue = new CXmlQueue(_xmlQueueFile); XElement xRoot = xmlQueue.OpenXmlQueue(); if (xRoot.XPathSelectElements("build").Any()) { qBr = new QBuildRecord(); XElement xe = xRoot.XPathSelectElements("build").FirstOrDefault(); qBr.BuildId = xe.Attribute("BuildId").Value; qBr.IssueId = xe.Attribute("IssueId").Value; qBr.IssueName = xe.Attribute("IssueName").Value; qBr.StartDate = Convert.ToDateTime(xe.Attribute("StartDate").Value); qBr.Build_CSharp = bool.Parse(xe.Attribute("Build_CSharp").Value); qBr.Build_Cpp = bool.Parse(xe.Attribute("Build_Cpp").Value); xe.Remove(); // Remove first element xRoot.Save(xmlQueue.GetQueueFileName()); return qBr; } return null; } public void PushBuild(QBuildRecord qBRecord) { CXmlQueue xmlQueue = new CXmlQueue(_xmlQueueFile); XElement xRoot = xmlQueue.OpenXmlQueue(); xRoot.Add(new XElement( "build", new XAttribute("BuildId", qBRecord.BuildId), new XAttribute("IssueId", qBRecord.IssueId), new XAttribute("IssueName", qBRecord.IssueName), new XAttribute("StartDate", qBRecord.StartDate), new XAttribute("Build_CSharp", qBRecord.Build_CSharp), new XAttribute("Build_Cpp", qBRecord.Build_Cpp) )); xRoot.Save(xmlQueue.GetQueueFileName()); } public void TestPushBuild() { CXmlQueue xmlQueue = new CXmlQueue(_xmlQueueFile); Console.WriteLine("Using queue file: {0}",xmlQueue.GetQueueFileName()); int buildIndex = xmlQueue.IncrementLastQueueBuildNumber(); Random rnd = new Random(); PushBuild (new QBuildRecord { Build_CSharp = true, Build_Cpp = true, BuildId = buildIndex.ToString(), StartDate = DateTime.Now, IssueId = rnd.Next(100000).ToString(), IssueName = "TestIssueName" } ); } }</span></span></code> </pre> <br></div></div><br><h3>  Apporter des modifications √† la classe AppQueueWindowsService: ServiceBase </h3><br>  Ajoutez de nouvelles variables au corps de classe: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// ,         private System.Timers.Timer timer; // ,       public QBuildRecord currentBuild; //public QBuildRecord processingBuild; // ,       public bool clientStarted; //    public string xmlBuildQueueFileName; //   public CXmlQueue xmlQueue; //         public string btWorkingDir; public string btLocalDomain; public string btUserName; public string buildToolPath; public string btScriptPath; public int agentTimeoutInMinutes; //  public AppQueueService buildQueueService;</span></span></code> </pre><br>  Dans le constructeur AppQueueWindowsService (), ajoutez des fonctions pour lire le fichier de configuration, initialiser les services et les classes de file d'attente: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//          try { xmlBuildQueueFileName = ConfigurationManager.AppSettings["QueueFileName"]; buildToolPath = ConfigurationManager.AppSettings["BuildToolPath"]; btWorkingDir = ConfigurationManager.AppSettings["BuildToolWorkDir"]; btLocalDomain = ConfigurationManager.AppSettings["LocalDomain"]; btUserName = ConfigurationManager.AppSettings["UserName"]; btScriptPath = ConfigurationManager.AppSettings["ScriptPath"]; agentTimeout= 30000; //    buildQueueService = new AppQueueService(); //    xmlQueue = new CXmlQueue(xmlBuildQueueFileName); } catch (Exception ex) { Console.WriteLine("Error while loading configuration: {0}", ex); }</span></span></code> </pre> <br>  AgentTimeout - fr√©quence de r√©ponse du temporisateur.  Indiqu√© en millisecondes.  Ici, nous d√©finissons que la minuterie doit se d√©clencher toutes les 30 secondes.  Dans l'original, ce param√®tre se trouve dans le fichier de configuration.  Pour l'article, j'ai d√©cid√© de le mettre en code. <br><br>  Ajoutez la fonction pour v√©rifier le processus de g√©n√©ration en cours d'ex√©cution dans la classe: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//        public bool BuildIsStarted() { IAppLauncher builderAgent; try { builderAgent = new AppLauncherClient(); return builderAgent.IsStarted(); } catch (Exception ex) { return false; } }</span></span></code> </pre><br>  Ajoutez la proc√©dure pour travailler avec la minuterie: <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimerTick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, System.Timers.ElapsedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     if (!BuildIsStarted()) { //     clientStarted,     if (clientStarted) { //     ,  clientStarted  false      currentBuild.FinishDate = DateTime.Now; clientStarted = false; } else { //       clientStarted=false ( ) -      xmlQueue.ClearCurrentBuild(); } //        currentBuild = buildQueueService.PullBuild(); //    ,     if (currentBuild != null) { //     true -    clientStarted = true; //   currentbuild -     xml            xmlQueue.SetCurrentBuild(currentBuild); //      var parameters = new Dictionary&lt;string, string&gt;(StringComparer.OrdinalIgnoreCase) { {"BUILD_ID", currentBuild.BuildId}, {"ISSUE_ID", currentBuild.IssueId}, {"ISSUE_NAME", currentBuild.IssueName}, {"BUILD_CSHARP", currentBuild.Build_CSharp ? "1" : "0"}, {"BUILD_CPP", currentBuild.Build_Cpp ? "1" : "0"} }; //       var arguments = AuxFunctions.FormatParameters(btScriptPath, parameters); try { //          AppLauncher IAppLauncher builderAgent = new AppLauncherClient(); builderAgent.Start(buildToolPath, arguments, btWorkingDir, btLocalDomain, btUserName, agentTimeout); } catch (Exception ex) { Console.WriteLine(ex); } } } } catch (Exception ex) { Console.WriteLine(ex); } }</span></span></code> </pre> <br>     OnStart,     : <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//     OnStart protected override void OnStart(string[] args) { if (serviceHost != null) { serviceHost.Close(); } //      this.timer = new System.Timers.Timer(agentTimeout); //    this.timer.AutoReset = true; this.timer.Elapsed += new System.Timers.ElapsedEventHandler(this.TimerTick); this.timer.Start(); //  ServiceHost   AppQueueService serviceHost = new ServiceHost(typeof(AppQueueService)); //  ServiceHostBase      serviceHost.Open(); }</span></span></code> </pre> <br><h3>     </h3><br>      : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ComponentModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ServiceModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ServiceProcess; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Configuration.Install; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Reflection; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Xml.XPath; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> QBuilder.AppQueue.AppLauncherService;</code> </pre><br><h3>     App.config </h3><br>      : <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"QueueFileName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BuildQueue.xml"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BuildToolPath"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"c:\temp\dummybuild.exe"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BuildToolWorkDir"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"c:\temp\"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"LocalDomain"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"."</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UserName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"username"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ScriptPath"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"C:\Temp\BuildSample.bld"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appSettings</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br><h2>    </h2><br><ol><li>   QBuilder.AppLauncher.zip.        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . <br></li><li>   dummybuild.exe     binaries  , ,  c:\temp.           ,     .     ,     BuildToolPath  BuildToolWorkDir   . <br></li><li>    \QBuilder.AppLauncher\binaries\QBuilder.AppLauncher\    QBuilder.AppLauncher.exe   .        . <br></li><li>       QBuilder.AppQueue.exe /console   . <br></li><li> ,     : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/18b/e4a/b17/18be4ab1798effcc29cfa113f6b75452.png"><br></li><li>   .    ,   30    : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/251/681/2a0/2516812a03c79a5c9b2d9811fbbdb0a0.png"><br></li><li>   BuildQueue.xml  ,       currentbuild: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildNumber</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"19"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"66540"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.3581274+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68618"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.5087854+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"21"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18453"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.6713477+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"22"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68288"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.8277942+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"89884"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:52.0151294+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">currentbuild</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16706"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"13.06.2018 23:20:06"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li>     dummy   ,       : <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildNumber</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"21"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18453"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.6713477+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"22"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68288"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:51.8277942+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"23"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"89884"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestIssueName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018-06-13T16:49:52.0151294+02:00"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_CSharp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Build_Cpp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">currentbuild</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BuildId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IssueId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"68618"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">StartDate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"13.06.2018 23:24:25"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildsQueue</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </li></ol><br>  ! <br><br><h2>  </h2><br>   powershell-    .      C#.      rulesets ‚Äî ,                setup-.                ‚Äî  ,          .          ‚Äî     MD5-   -,            . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dea/641/fbe/dea641fbea68d0be6417a2e757928d6b.png"><br> <i>  ,      </i> <br><br>      ,        ‚Äî             .    ,         ,    .      -    . <br><br>     ,    XML,   ,   .       ,       .        ,     ,    . <br><br> ,        WCF-,          XML-.         : <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/U4rXSbt_OMo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br> <b>PS</b>     ,          .  ,        ,       . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr417701/">https://habr.com/ru/post/fr417701/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr417687/index.html">Asym√©trie de vie</a></li>
<li><a href="../fr417689/index.html">Mobio s'entretient avec le PDG d'Appnext sur le march√© du CPI et les tendances des applications mobiles</a></li>
<li><a href="../fr417691/index.html">Notre √©tag√®re est un programmeur C #. Et vous?</a></li>
<li><a href="../fr417697/index.html">√âditeur d'images simple sur VueJS</a></li>
<li><a href="../fr417699/index.html">Western Digital ferme une autre usine de disques durs en raison de la baisse de la demande</a></li>
<li><a href="../fr417703/index.html">Code r√©seau Age of Empires: 1 500 archers par modem √† 28,8 kbps</a></li>
<li><a href="../fr417705/index.html">Comment un fabricant de cartes graphiques affecte la rentabilit√© de l'exploitation de GPU</a></li>
<li><a href="../fr417707/index.html">CSS-in-JS - mythes et r√©alit√© (composants de style comme exemple)</a></li>
<li><a href="../fr417709/index.html">O√π et comment les d√©veloppeurs √©valuent-ils leurs employeurs? Services d'√©valuation d'entreprises dans le secteur informatique</a></li>
<li><a href="../fr417711/index.html">Que lire sur Swift en russe?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>