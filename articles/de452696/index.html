<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📭 🤘🏽 🚲 So starten Sie Mikrozahlungen in Ihrer Anwendung 🕵🏾 🎏 👌🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Letzte Woche habe ich mein erstes öffentliches Programm entwickelt - einen Telegramm-Bot, der als Bitcoin-Geldbörse fungiert und es Ihnen ermöglicht, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So starten Sie Mikrozahlungen in Ihrer Anwendung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452696/">  Letzte Woche habe ich mein erstes öffentliches Programm entwickelt - einen Telegramm-Bot, der als Bitcoin-Geldbörse fungiert und es Ihnen ermöglicht, Münzen an andere Mitglieder von Gruppenchats zu werfen und auch externe Bitcoin-Zahlungen an sich selbst oder andere sogenannte zu leisten  "Lightning Apps".  Ich meine, dass der Leser im Allgemeinen mit Bitcoin und Telegramm vertraut ist  Ich werde versuchen, kurz zu schreiben, ohne auf Details einzugehen.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eine Auswahl von Ressourcen zu Bitcoin finden Sie unter diesem Link</a> . Telegram ist jedoch ein Instant Messaging-Tool für mobile Geräte und PCs, mit dem Sie Ihre eigenen kleinen Anwendungen (Chat-Bots) auf ihrer Plattform erstellen können. <br><br><h3>  Was sind die Hauptmerkmale dieser App? </h3><br><ul><li>  Ermöglicht es Ihnen, dem Gesprächspartner mit einem wirklich materiellen Wert zu danken oder ihn zu belohnen, und nicht nur mit einem <i>„virtuellen Like“</i> . Dies bringt die elektronische Kommunikation auf eine ganz neue Ebene </li><li>  Ein reales Beispiel für eine Anwendung, die mithilfe eines offenen Zahlungsprotokolls finanziell mit anderen Anwendungen interagieren kann </li><li>  Alle Anwendungskomponenten sind Open Source-Projekte und können geändert und auf Ihre Aufgaben angewendet werden.  Die Anwendung verwendet keine geschlossenen und / oder kommerziellen Lösungen, obwohl sie in den Bereich des elektronischen Handels passt, der heutzutage nur schwer als offen zu bezeichnen ist. </li></ul><br><h3>  Und wie kann man es im Geschäft anwenden? </h3><br>  Irgendwie so… <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/097/02b/175/09702b1750c94616a10fc66c1275c00f.png" alt="Bild"></div><a name="habracut"></a><br>  oder so ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ef/1ff/85f/3ef1ff85f1e7b77662c63a9d4d838666.png" alt="Bild"></div><br>  Was bedeuten diese Zahlen?  Dies sind <b>Einheiten von Bitcoin - Satoshi</b> .  Bei Wechselkursen von Mitte 2019 beträgt 1000 Satoshi ungefähr 0,06 USD.  Satoshi kann online ausgegeben oder einfach gegen Landeswährung umgetauscht werden.  Aus diesem Grund (Liquidität) ist dies nicht nur ein weiterer <i>„Eintrag in die Datenbank“</i> oder <i>„Punkte, die Sie in den Geschäften unserer Partner ausgeben können“,</i> sondern <b>echtes Internetgeld</b> . <br>  <i>* Ich möchte sofort darauf hinweisen, dass ich absichtlich nicht versuche, einige Wörter oder Sätze auf Russisch zu schreiben. Entweder kenne ich die Kontextübersetzung selbst in einigen Fällen nicht, oder eine solche Übersetzung klingt meiner Meinung nach eher verwirrend als richtig</i> <br><br>  Es kann sich die Frage stellen, wie eine solche Anwendung verwendet werden kann, wenn keine Bitcoins vorhanden sind.  Sie können leicht in kleinen Mengen an einem der vielen Börsen oder Tauscher gekauft werden, oder Sie können sie von einem Bitcoin-Freund erhalten oder sogar Münzen von aktuellen Bot-Benutzern erhalten.  Viele Geldbörsen am Telefon bieten an, Bitcoins direkt zu kaufen, "ohne die Kasse zu verlassen". <br><br><img src="https://habrastorage.org/getpro/habr/post_images/883/661/461/883661461bdc686aec7d084d5d581236.png" alt="Bild"><img src="https://habrastorage.org/getpro/habr/post_images/779/716/5d9/7797165d93d292700d9a41a171d882a6.png" alt="Bild"><img src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png" alt="Bild"><br><br>  Wenn wir Bitcoins (aber eher Satoshi (?)) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erhalten haben</a> - führen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@atomic_tipbot aus</a> und machen / einzahlen. <br><br>  Der Bot fragt als Antwort, wie viel Satoshi zum Guthaben hinzugefügt werden soll, und sendet ein Konto zur Zahlung, das mit einem mobilen Portemonnaie bezahlt werden kann, indem der QR-Code gescannt oder auf der Rechnungsseite auf die Schaltfläche ( <i>„In Portemonnaie öffnen“</i> ) geklickt wird. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png" alt="Bild"><img src="https://habrastorage.org/getpro/habr/post_images/4a3/da5/f76/4a3da5f76574ac9ebb2161d56bceff62.png" alt="Bild"><img src="https://habrastorage.org/getpro/habr/post_images/54d/a43/0be/54da430be68237193dee82ade50bab37.png" alt="Bild"><br><br>  Nachdem Sie die Zahlung in Ihrer Brieftasche bestätigt haben, wird fast sofort eine Zahlungsbestätigung an den Bot gesendet, die im Kontorahmen visuell angezeigt wird. <br><br>  Bis zu diesem Moment haben wir zwei Komponenten der Anwendung angesprochen - den Back-End-Telegramm-Bot und das Zahlungsverarbeitungssystem für Kryptowährungen (eher das Front-End). <br><br>  Um einen Telegramm-Bot zu erstellen, habe ich den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Python-Telegramm-Bot verwendet</a> .  Und natürlich der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Open Source</a> Bot selbst. <br><br>  Als System zur Zahlungsabwicklung und Lösung von UX-Problemen fiel die Wahl auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BTCPayServer</a> , zu dem die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation unter diesem Link verfügbar ist</a> (tatsächlich gibt es fast keine Wahl). <br><br>  Wenn Sie nach Lösungen suchen, um Zahlungsereignisse direkt zu verarbeiten, sollten Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Electrum CLI-Handbuchseiten</a> für die sogenannten beachten  On-Chain-Zahlungen und für sofortige Micro- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Payment-</a> Lösungen (Lightning) wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lightning-Charge</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sparko</a> . <br><br><h3>  Also ist es selbst gehostet oder nicht !? </h3><br>  Ja das stimmt.  In meiner Anwendung verwende ich den kostenlosen Hosting-BTCPayServer - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BTCPayJungle</a> , aber es ist absolut möglich und erfordert nicht viel Zeit, um mein eigenes Verarbeitungszentrum zu starten.  Beachten Sie jedoch, dass Sie ca. 500 GB auf der Eisenbahn benötigen, um die Bitcoin- (und Litecoin-) Blockchains zu speichern.  Für die Dauer der Synchronisierung sind außerdem Computer- und Netzwerkressourcen sowie je nach Bedarf die erforderlichen „Wrapper“ für Blockchains erforderlich, damit die Interaktion mit ihnen bequem ist.  BTCPayServer enthält keine eigenständigen privaten Schlüssel oder andere Informationen, mit denen Sie Ihre Brieftasche steuern können. <br><br>  Für (regelmäßige) Zahlungen in der Kette müssen Sie die so genannten hinzufügen  xpub-wallet-Schlüssel in BTCPayServer zum Generieren von Empfangsadressen (öffentliche Schlüssel).  Dies macht es möglich und sicher, BTCPayServer auch in einer "gemeinsam genutzten" Form zu verwenden.  Alle diese xpub-Schlüssel und -Adressen können leicht in guten Geldbörsen wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Electrum</a> für die weitere Verarbeitung abgerufen werden. <br><br>  Jeder, der auf Bitcoin gestoßen ist, hat gehört, dass Bitcoin langsam und Transaktionen teuer sind, insbesondere wenn es sich um einen Hype handelt. Daher sollten Sie für sofortige Mikrozahlungen Lightning Network-Transaktionen (außerhalb der Kette) verwenden. <br><br><h3>  Was ist dieses Blitznetzwerk? </h3><br>  Dies ist eine Art Bitcoin-Plugin, das eine zusätzliche Abstraktionsebene bildet und es Ihnen ermöglicht, sofortige und fast kostenlose Transaktionen im Bitcoin-Netzwerk durchzuführen.  All dies ist dank kryptografischer Magie mit Mehrfachsignaturen möglich, die oft als <i>intelligenter Vertrag bezeichnet werden</i> .  Es gibt verschiedene Implementierungen des Lightning Network-Protokolls. Ich verwende die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">c-lightning-</a> Implementierung in C. <br><br>  Der Hauptunterschied zwischen Zahlungen in der Kette und außerhalb der Kette (Lightning) besteht darin, wie sie gespeichert werden.  Alle <b>On-Chain-</b> Transaktionen werden an alle Netzwerkknoten weitergeleitet, bis einer der Bitcoin-Knoten einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">neuen</a> Mining- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Block</a> mit darin enthaltenen Transaktionen ankündigt.  (Es gibt sogar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">BitFury am Hub</a> ; sie produzieren nur Eisen für den Bergbau).  Aus diesem Grund nennen wir solche Transaktionen <b>On-Chain</b> .  Solche Transaktionen werden in einer gemeinsamen Blockchain aufgezeichnet und bis zum Ende ihrer Existenz darin gespeichert.  Solche Transaktionen sind auch gemeinfrei und können überwacht, verfolgt und analysiert werden. <br><br>  Bei Transaktionen <b>außerhalb der Kette</b> (Lightning) geschieht alles anders.  Jeder Knoten des Lightning-Netzwerks verfügt über eine <i>(oder mehrere)</i> On-Chain-Adressen - dies sind die üblichen Bitcoin-Adressen, von denen aus alles beginnt.  Wenn Bitcoins an einer solchen Adresse erscheinen, ist es möglich, die sogenannte zu öffnen.  <i>Blitzkanal</i> zu einem anderen Knoten, was bedeutet, dass diese beiden Knoten mithilfe kryptografischer Techniken die Verfügbarkeit von Geldern untereinander vereinbart haben.  Später werden alle Transaktionen (sowohl ihre eigenen als auch Transaktionen von Fremdknoten), die einen solchen Kanal durchlaufen, nur auf den Knoten der Transaktionsteilnehmer (und Zwischenknoten) gespeichert.  Die einzigen Transaktionen, die in der Blockchain aufgezeichnet werden, sind Transaktionen zum Öffnen oder Schließen eines Kanals.  In größerem Umfang erhalten wir ein solches Netzwerk miteinander verbundener Knoten, das zwischen den Teilnehmern Tausende verschiedener Möglichkeiten zum "Überweisen" von Geldern von einem Knoten auf einen anderen nach bestimmten strengen Regeln aufbaut.  Fast alle derartigen Transaktionen werden nur in der Datenbankdatei der Knoten selbst gespeichert.  Aus diesem Grund nennen wir sie <b>Off-Chain</b> . <br><br><h3>  Das Diagramm zeigt die Visualisierung aller Anwendungskomponenten </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/3c6/636/b8c/3c6636b8c98d52aab9bd09ff9c52afcb.png" alt="Bild"><br><br>  Kurzum: <br><br>  1) Der Benutzer sendet einen Befehl an den Bot in <b>Telegram</b> <br><br>  2) Telegramm sendet eine <b>Python-</b> Ereignismeldung an die Bot- <b>Anwendung</b> <br><br>  3) Eine <b>Python-Anwendung</b> sendet eine Anfrage an <b>BTCPayServer</b> <br><br>  4) BTCPayServer generiert eingehende BTC- und LTC-Adressen und sendet eine Rechnungsanforderung an <b>Lightning-Charge</b> , die wiederum mit dem <b>c-lightning-</b> Daemon kommuniziert.  Bei der Ausgabe erhalten wir eine schöne HTML-Form der Zahlungsabwicklung <br><br>  5) Der Benutzer bezahlt die Rechnung und sieht eine Bestätigung <br><br>  6) <b>BTCPayServer</b> sendet <i>eine Rechnungszahlungsbenachrichtigung</i> (IPN) an die angegebene callback_url, in unserem Fall <b>callbacks.py</b> (eine andere Python-Anwendung zum Empfangen von Benachrichtigungen). <br><br>  7) Entsprechend den empfangenen Daten ändert sich das Guthaben des Benutzers <br><br>  <i>... und wenn der Benutzer Geld abheben wollte (Münzen, die er von anderen erhalten hat) ...</i> <br><br>  8) Die <b>Python-Anwendung des</b> Bots wartet auf den Text oder das Bild des QR-Codes. Wenn gültige Daten empfangen werden, wird die Zahlung durch das <b>Dienstprogramm paylightning.py * ausgeführt</b> , das die Transaktion mithilfe von c-lightning RPC initialisiert. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/518/3dc/c81/5183dcc817817f1aa676ff74d17d08bb.png" alt="Bild"><br><br>  <i>* Fairerweise ist es erwähnenswert, dass mein paylightning.py-Wrapper nicht vollständig fertig ist und in bestimmten Szenarien ein falsches Negativ zurückgeben kann.</i>  <i>Ich empfehle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">,</a> in produktionsnahen Fällen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen gut getesteten Wrapper</a> zu verwenden</i> <br><br>  Was haben wir  Benutzer unseres Bots können innerhalb eines Gruppenchats oder ohne Einschränkung direkt <b>Materialwerte</b> übertragen.  Und das ist noch nicht alles - dank des Lightning Network-Protokolls, das in gewisser Weise ein einheitliches und vereinfachtes Zahlungsnetzwerk ist, ist es möglich, dasselbe Geld, das im Chat empfangen wird, an Anwendungen von Drittanbietern zu senden.  Zum Beispiel hatte Telegram bereits den ersten Bot für Bitcoin-Zahlungen - @lntxbot.  Mit „One Balance“ können Sie je nach den Vorlieben eines bestimmten Gruppenchats einen der Bots verwenden (ja, das Problem ist vollständig erfunden und die Lösung ist sehr nutzlos, aber der Punkt ist im Wesentlichen).  Das Übertragen des Guthabens von einem Bot auf einen anderen kostet nichts und dauert Sekunden!  Es ist wichtig zu beachten, dass die Schöpfer dieser Bots niemals miteinander verbunden sind. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f09/c3a/ef9/f09c3aef995f7a82560987646b0d8ee0.png" alt="Bild"><img src="https://habrastorage.org/getpro/habr/post_images/1e2/344/82c/1e234482c56aa0df1d4b341ecfe3beb8.png" alt="Bild"><br><br>  Es reicht aus, die Einzahlungsanforderungsnachricht von @lntxbot einfach an @atomic_tipbot und voul'a weiterzuleiten! <br><br>  Dies ist nicht nur das „Übertragen von Nummern in die Datenbank“, sondern eine Zahlung zwischen zwei verschiedenen, nicht verwandten Datenbanken.  So sind bereits mehrere „LApps“ in den Bot integriert, darunter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sat2.io</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lnsms.world</a> . <br><br>  <b>Was bedeutet <i>LApp-Integration</i> ?</b> <br><br>  Jeder <i>Lightning Network-</i> Knoten ist im Wesentlichen eine Bitcoin-Brieftasche.  Sie hat zwei Guthaben: On-Chain und Off-Chain.  Ein Gleichgewicht in der Kette ist erforderlich, um neue Kanäle zu eröffnen und Gelder aus geschlossenen Kanälen zu speichern.  Das Gleichgewicht außerhalb der Kette ist jedoch genau das, was zwischen den Knoten geschieht.  Die Hauptanforderungen für einen Knoten sind das Empfangen und Senden von Zahlungen, sodass jeder Knoten als Software über <i><b>Zahlungs-</b></i> und <i><b>Rechnungsfunktionen verfügt</b></i> .  Ich werde zeigen, wie das passiert: <br><br><pre><code class="bash hljs">user@ln-node:/ % lightning-cli invoice 1000000000 internal_description external_description { <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"expires_at"</span></span> : 1558709834, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6"</span></span> }</code> </pre> <br>  In diesem Fall erhalten wir eine „Rechnung“ der <a href="">BOLT11-</a> Spezifikation, bei der es sich um das Zahlungsformat im Bitcoin-Netzwerk handelt (und übrigens auch bei Litecoin).  Dies ist eine Zeile, die Informationen über den Empfänger, den Transaktionsbetrag, die Ablaufzeit der Anforderung usw. enthält. Detaillierte Informationen können durch Ausführen von decodepay in Bezug auf diese Zeile abgerufen werden: <br><br><pre> <code class="bash hljs">user@ln-node:/ % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 { <span class="hljs-string"><span class="hljs-string">"currency"</span></span> : <span class="hljs-string"><span class="hljs-string">"bc"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558105034, <span class="hljs-string"><span class="hljs-string">"expiry"</span></span> : 604800, <span class="hljs-string"><span class="hljs-string">"payee"</span></span> : <span class="hljs-string"><span class="hljs-string">"025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 1000000000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"1000000000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span> : <span class="hljs-string"><span class="hljs-string">"external_description"</span></span>, <span class="hljs-string"><span class="hljs-string">"min_final_cltv_expiry"</span></span> : 10, <span class="hljs-string"><span class="hljs-string">"routes"</span></span> : [ [ { <span class="hljs-string"><span class="hljs-string">"pubkey"</span></span> : <span class="hljs-string"><span class="hljs-string">"03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3"</span></span>, <span class="hljs-string"><span class="hljs-string">"short_channel_id"</span></span> : <span class="hljs-string"><span class="hljs-string">"574012x1255x1"</span></span>, <span class="hljs-string"><span class="hljs-string">"fee_base_msat"</span></span> : 1000, <span class="hljs-string"><span class="hljs-string">"fee_proportional_millionths"</span></span> : 1, <span class="hljs-string"><span class="hljs-string">"cltv_expiry_delta"</span></span> : 144 } ] ], <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"signature"</span></span> : <span class="hljs-string"><span class="hljs-string">"304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37"</span></span> }</code> Blitz-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 <code class="bash hljs">user@ln-node:/ % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 { <span class="hljs-string"><span class="hljs-string">"currency"</span></span> : <span class="hljs-string"><span class="hljs-string">"bc"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558105034, <span class="hljs-string"><span class="hljs-string">"expiry"</span></span> : 604800, <span class="hljs-string"><span class="hljs-string">"payee"</span></span> : <span class="hljs-string"><span class="hljs-string">"025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 1000000000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"1000000000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span> : <span class="hljs-string"><span class="hljs-string">"external_description"</span></span>, <span class="hljs-string"><span class="hljs-string">"min_final_cltv_expiry"</span></span> : 10, <span class="hljs-string"><span class="hljs-string">"routes"</span></span> : [ [ { <span class="hljs-string"><span class="hljs-string">"pubkey"</span></span> : <span class="hljs-string"><span class="hljs-string">"03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3"</span></span>, <span class="hljs-string"><span class="hljs-string">"short_channel_id"</span></span> : <span class="hljs-string"><span class="hljs-string">"574012x1255x1"</span></span>, <span class="hljs-string"><span class="hljs-string">"fee_base_msat"</span></span> : 1000, <span class="hljs-string"><span class="hljs-string">"fee_proportional_millionths"</span></span> : 1, <span class="hljs-string"><span class="hljs-string">"cltv_expiry_delta"</span></span> : 144 } ] ], <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"signature"</span></span> : <span class="hljs-string"><span class="hljs-string">"304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37"</span></span> }</code> </pre><br>  Aber um für eine solche "Rechnung" zu bezahlen, benötigen wir die Zahlungsfunktion von c-lightning: <br><br><pre> <code class="bash hljs">user@ln-node:/ % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : 163, <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63"</span></span>, <span class="hljs-string"><span class="hljs-string">"destination"</span></span> : <span class="hljs-string"><span class="hljs-string">"03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 200000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi_sent"</span></span> : 200003, <span class="hljs-string"><span class="hljs-string">"amount_sent_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200003msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558106072, <span class="hljs-string"><span class="hljs-string">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"complete"</span></span>, <span class="hljs-string"><span class="hljs-string">"payment_preimage"</span></span> : <span class="hljs-string"><span class="hljs-string">"1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019"</span></span>, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j"</span></span> }</code> Blitz-cli Pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j <code class="bash hljs">user@ln-node:/ % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : 163, <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63"</span></span>, <span class="hljs-string"><span class="hljs-string">"destination"</span></span> : <span class="hljs-string"><span class="hljs-string">"03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 200000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi_sent"</span></span> : 200003, <span class="hljs-string"><span class="hljs-string">"amount_sent_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200003msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558106072, <span class="hljs-string"><span class="hljs-string">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"complete"</span></span>, <span class="hljs-string"><span class="hljs-string">"payment_preimage"</span></span> : <span class="hljs-string"><span class="hljs-string">"1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019"</span></span>, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j"</span></span> }</code> </pre><br>  Alle Transaktionszustände werden vom gesamten Netzwerk und insbesondere von Ihrem eigenen Knoten verarbeitet.  Es besteht keine Notwendigkeit (aber es besteht eine solche Möglichkeit), mit den Autoren der Zahlungsempfängeranwendung oder einer ihrer APIs zu interagieren, um Informationen über den Status der Zahlung zu erhalten.  Es ist nicht erforderlich, den Status der Zahlung im Zwischenverarbeitungssystem zu überprüfen.  Sie müssen nicht erwarten, dass Ihre Transaktion von einer Bank oder einer Regierungsbehörde genehmigt wird.  Am Ende gibt es keine Rückbuchungen und andere externe Faktoren, die den Kontostand Ihres Kontos beeinflussen können.  Dies ist eine Lösung für die Wertverschiebung über das Internet, ohne dass ein externer Schiedsrichter erforderlich ist, der entscheidet, ob die Transaktion den Regeln entspricht (manchmal sogar internen Regeln, über die nicht alle Teilnehmer zuvor informiert wurden) oder nicht.  Es gibt keine "internen Regeln" in Bitcoin.  Die einzigen Regeln, die Sie befolgen müssen, sind die Netzwerkregeln - offen und bekannt. <br><br>  Dies macht <b>direkte</b> , <b>praktisch kostenlose</b> und <b>sofortige</b> Geldtransaktionen zwischen Personen oder Programmen realistisch real. <br><br>  Wenn Sie die Möglichkeit haben, Zahlungsdaten von einer Drittanbieteranwendung zu erhalten, können Sie finanziell mit dieser Anwendung interagieren.  Betrachten Sie als Beispiel den Dienst lnsms.world, mit dem Sie eine SMS-Nachricht an eine beliebige Nummer senden können, indem Sie sie mit Bitcoins bezahlen.  Um diese Anwendung zu integrieren, müssen wir nur Daten aus dem Webformular direkt in das SMS-Sendeskript übertragen, um Benutzeraktionen auf der Website zu emulieren: <br><br><pre> <code class="python hljs">payload = { <span class="hljs-string"><span class="hljs-string">'number'</span></span>: phone_number, <span class="hljs-string"><span class="hljs-string">'text'</span></span>: text, <span class="hljs-string"><span class="hljs-string">'force_unicode'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } send_req = requests.post(<span class="hljs-string"><span class="hljs-string">'https://lnsms.world/invoice'</span></span>, data=payload) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> send_req.status_code == <span class="hljs-number"><span class="hljs-number">201</span></span>: plain_invoice = str(send_req.text)</code> </pre><br>  Ich weiß nicht aus welchem ​​Grund, aber lnsms antwortet mit 201 HTTP-Statuscode und sendet eine Rechnung im BOLT11-Format zurück.  Nun, dies ist genug für Bot-Benutzer, um für das Senden von SMS von ihrem in Chatrooms empfangenen Guthaben zu bezahlen.  Der Benutzer weiß nicht einmal, was dort passiert, er hat nur ein paar Cent für das Versenden von SMS bezahlt.  Und ich als Entwickler gehe nicht auf die Details der Arbeit von SMS-Diensten ein.  Ich habe gerade die Zahlung weitergeleitet und den Service erhalten.  Sie können oben einen Aufschlag machen, aber Sie können es nicht tun - dies ist meine freie Wahl.  Keine Konten, Vereinbarungen oder eine andere API für einfache Aufgaben wie das Senden von SMS. <br><br>  Und jetzt stellen wir uns für den Moment vor, dass unsere Anwendung nützlicher ist als ein Chat-Bot und eine Zahlung nicht an einen anderen Bot, sondern an eine andere Anwendung oder ein anderes Gerät leistet, das mit dem Internet verbunden ist.  Oder es sind Dutzende oder sogar Hunderte unbedeutender Zahlungen pro Sekunde zwischen Geräten, Diensten, Geschäften oder einer Art von Dienstanbietern.  Dies ist die Macht der Mikrozahlungen, daher sollte das Internet der Dinge so aussehen.  Es gibt bereits Projekte wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Althea</a> , die diese Ideen zum Leben erwecken, und in naher Zukunft werden sich meiner Meinung nach große Veränderungen in dem Bereich ergeben, den wir jetzt E-Commerce nennen. <br><br>  Wenn Ihnen die Post gefallen hat und Sie Bitcoins in Aktion ausprobieren möchten, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">senden Sie mir ein Bier und weiche französische Brötchen</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de452696/">https://habr.com/ru/post/de452696/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de452684/index.html">Ein Spiel auf Svelte 3 entwickeln</a></li>
<li><a href="../de452686/index.html">Spionage, für die sie nicht verbieten (eine Geschichte aus den 80ern)</a></li>
<li><a href="../de452688/index.html">Windows-Dienst. Suchen Sie nach Systemfehlern und zeigen Sie diese in WinForm C # an</a></li>
<li><a href="../de452690/index.html">Was ist so interessant an der Transsibirischen Eisenbahn?</a></li>
<li><a href="../de452692/index.html">Der Autor des rePalm-Projekts hat Palm OS von Grund auf neu geschrieben und plant, es in eine Smart-Watch-Plattform umzuwandeln</a></li>
<li><a href="../de452698/index.html">Zwei in einem: Touristendaten und Tickets für kulturelle Veranstaltungen waren öffentlich verfügbar</a></li>
<li><a href="../de452700/index.html">Nachrichten aus der Welt von OpenStreetMap Nr. 460 (05/07/2019 - 05/05/2019)</a></li>
<li><a href="../de452702/index.html">Tests auf Code und Code für Tests</a></li>
<li><a href="../de452704/index.html">Post-Mortem-Debugging auf Cortex-M</a></li>
<li><a href="../de452706/index.html">1983 wurde dieser Computer von Bella Labs der erste Großmeister.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>