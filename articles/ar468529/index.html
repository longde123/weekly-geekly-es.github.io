<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐ฝ ๐ฉ๐ฝโ๐คโ๐ฉ๐ป ๐จ๐ผโ๐ญ ุชุฑููุถ Gorynych ุ ุฃู ุฅูุบุงุก ุชุฑุฌูุฉ eBPF ูู ุงูุบูุฏุฑุฉ ๐ฉโ๐ญ ๐คฆ๐ป ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุคูู ุงูููุงู https://github.com/Nalen98 


 ูุณุงุก ุงูุฎูุฑ 


 ูุงู ููุถูุน ุจุญุซู ูุฌุฒุก ูู ุงูุชุฏุฑูุจ ุงูุตููู ุงูุตููู ูู Summer of Hack 2019 ูู Digital Security ูู "...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุฑููุถ Gorynych ุ ุฃู ุฅูุบุงุก ุชุฑุฌูุฉ eBPF ูู ุงูุบูุฏุฑุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/468529/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/iv/og/7r/ivog7rx1sixvcarbuhefc7myery.png"></p><br><p style=";text-align:right;direction:rtl">  ูุคูู ุงูููุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://github.com/Nalen98</a> </p><br><p style=";text-align:right;direction:rtl">  ูุณุงุก ุงูุฎูุฑ </p><br><p style=";text-align:right;direction:rtl">  ูุงู ููุถูุน ุจุญุซู ูุฌุฒุก ูู ุงูุชุฏุฑูุจ ุงูุตููู ุงูุตููู ูู Summer of Hack 2019 ูู Digital Security ูู "ุฅูุบุงุก ุชุฑุฌูุฉ eBPF ูู Ghidra".  ูุงู ูู ุงูุถุฑูุฑู ุชุทููุฑ ูุธุงู eBPF bytecode ููุชุฑุฌูุฉ ุจูุบุฉ Sleigh ูู PCode Ghidra ุญุชู ูููู ูุงุฏุฑูุง ุนูู ุชูููู ุจุฑุงูุฌ eBPF ูุฅูุบุงุก ุชุฑุฌูุชูุง.  ูุชูุฌุฉ ุงูุฏุฑุงุณุฉ ูู ุงูุชุฏุงุฏ ูุทูุฑ ูู Ghidra ูุถูู ุฏุนููุง ููุนุงูุฌ eBPF.  ูููู ุงุนุชุจุงุฑ ุงูุฏุฑุงุณุฉ ุ ูุซููุง ูุซู ุฏุฑุงุณุฉ ุงููุชุฏุฑุจูู ุงูุขุฎุฑูู ุ "ุจุญู ูุฃูู ูุฑุฉ" ุ ูุฃูู ูู ููุช ุณุงุจู ูู ููู ูู ุงููููู ูู ุดูุฑุฉ eBPF ูู ุฃุฏูุงุช ุงูููุฏุณุฉ ุงูุนูุณูุฉ ุงูุฃุฎุฑู. </p><a name="habracut"></a><br><h2 id="predystoriya" style=";text-align:right;direction:rtl">  ูุจู ุงูุชุงุฑูุฎ </h2><br><p style=";text-align:right;direction:rtl">  ุฐูุจ ูุฐุง ุงูููุถูุน ุฅูู ุจุณุฎุฑูุฉ ูุจูุฑุฉ ูู ุงููุตูุฑ ุ ูุฃููู ูู ุฃูู ุนูู ุฏุฑุงูุฉ ุจู eBPF ูู ูุจู ุ ููู ูุณุชุฎุฏูู ุบุฏุฑ ูู ูุจู ุ ูุฃู ููุงู ุจุนุถ ุงูุนูุงุฆุฏ ุงูุชู ุชููู "IDA Pro ุฃูุถู".  ููุง ุงุชุถุญ ุ ูุฐุง ููุณ ุตุญูุญุง ุชูุงูุง. </p><br><p style=";text-align:right;direction:rtl">  ุงุชุถุญ ุฃู ุนูููุฉ ุงูุชุนุงุฑู ูุน Ghidra ูุงูุช ุณุฑูุนุฉ ุฌุฏูุง ุ ุญูุซ ูุงู ูุทูุฑููุง ุจูุถุน ูุซุงุฆู ุฐุงุช ููุงุกุฉ ุนุงููุฉ ููููู ุงููุตูู ุฅูููุง.  ุฃูุถุง ุ ูุงู ูุง ุจุฏ ูู ูู ุฅุชูุงู ูุบุฉ ููุงุตูุงุช ูุนุงูุฌ Sleigh ุ ูุงูุชู ุชู ุชูููุฐ ุงูุชุทููุฑ ุจูุง.  ุจุฐู ุงููุทูุฑูู ูุตุงุฑู ุฌูุฏูู ูุฃูุดุฃูุง ูุซุงุฆู ููุตูุฉ ููุบุงูุฉ ููู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฏุงุฉ</a> ููุณูุง ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Sleigh</a> ุ ูุงูุชู ุจูุถููุง ุฌุฒูู ุงูุดูุฑ ููู. </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุงูุฌุงูุจ ุงูุขุฎุฑ ูู ุงูุญุงุฌุฒ ูุงู ููุงู ูุฑุดุญ Berkeley Packet Filter.  eBPF ุนุจุงุฑุฉ ุนู ุฌูุงุฒ ุงูุชุฑุงุถู ูู Linux kernel ูุณูุญ ูู ุจุชุญููู ููุฏ ูุณุชุฎุฏู ุงุนุชุจุงุทู ูููู ุงุณุชุฎุฏุงูู ูุชุชุจุน ุงูุนูููุงุช ูุชุตููุฉ ุงูุญุฒู ูู ูุณุงุญุฉ kernel.  ุงูููุฏุณุฉ ุงููุนูุงุฑูุฉ ูู ุขูุฉ ุชุณุฌูู RISC ูุน 11 ุชุณุฌูู 64 ุจุช ุ ุนุฏุงุฏ ุจุฑุงูุฌ ูููุฏุณ 512 ุจุงูุช.  ููุงู ุนุฏุฏ ูู ุงููููุฏ ุนูู eBPF: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฏูุฑุงุช ูุญุธูุฑุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุงููุตูู ุฅูู ุงูุฐุงูุฑุฉ ูููู ููุท ูู ุฎูุงู ุงูููุฏุณ (ุณุชููู ููุงู ูุตุฉ ูููุตูุฉ ุญูู ูุฐุง ุงูููุถูุน) ุ </li><li style=";text-align:right;direction:rtl">  ุชุชููุฑ ูุธุงุฆู kernel ููุท ูู ุฎูุงู ูุธุงุฆู ูุฌููุน ุฎุงุตุฉ (ูุณุงุนุฏูู eBPF). </li></ul><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ys/gk/wv/ysgkwvdtrqvdgb8vdlyld7awrfu.png"><br>  <i>ูููู eBPF ุงูุชูููููุฌูุง.</i>  <i>ูุตุฏุฑ ุงูุตูุฑุฉ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">http://www.brendangregg.com/ebpf.html</a> .</i> </p><br><p style=";text-align:right;direction:rtl"> ุจุดูู ุฃุณุงุณู ุ ูุชู ุงุณุชุฎุฏุงู ูุฐู ุงูุชูููุฉ ูู ููุงู ุงูุดุจูุฉ - ุชุตุญูุญ ุงูุฃุฎุทุงุก ุ ุชุตููุฉ ุงูุญุฒูุฉ ุ ููุง ุฅูู ุฐูู ุนูู ูุณุชูู kernel.  ุชูุช ุฅุถุงูุฉ ุฏุนู eBPF ููุฐ ุงูุฅุตุฏุงุฑ 3.15 ูู ุงูููุงุฉ ุ ุชู ุชุฎุตูุต ุนุฏุฏ ูููู ูู ุงูุชูุงุฑูุฑ ููุฐู ุงูุชูููููุฌูุง ูู ูุคุชูุฑ ุณุจุงููู Linux 2019.  ููู ูู eBPF ุ ุจุฎูุงู Ghidra ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุบูุฑ</a> ููุชููุฉ ููุง ุชุญุชูู ุนูู ุงููุซูุฑ.  ูุฐูู ุ ูุฌุจ ุงูุจุญุซ ุนู ุงูุชูุถูุญุงุช ูุงููุนูููุงุช ุงูููููุฏุฉ ุนูู ุงูุฅูุชุฑูุช.  ุงุณุชุบุฑู ุงูุฃูุฑ ุจุนุถ ุงูููุช ููุนุซูุฑ ุนูู ุงูุฅุฌุงุจุงุช ุ ููู ูุง ุชุจูู ูู ุงูุฃูู ูู ุฃู ูุชู ุงูุงูุชูุงุก ูู ูุฐู ุงูุชูููููุฌูุง ูุณูุชู ุฅูุดุงุก ุงููุซุงุฆู ุงูุนุงุฏูุฉ. </p><br><h2 id="plohaya-dokumentaciya" style=";text-align:right;direction:rtl">  ูุซุงุฆู ุณูุฆุฉ </h2><br><p style=";text-align:right;direction:rtl">  ูุชุทููุฑ ููุงุตูุงุช ูู Sleigh ุ ุชุญุชุงุฌ ุฃููุงู ุฅูู ููู ููููุฉ ุนูู ุจููุฉ ุงููุนุงูุฌ ุงููุฏู.  ูููุง ููุชูู ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> ุงูุฑุณููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุญุชูู ุนูู ุนุฏุฏ ูู ุงูุนููุจ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูู ูุชู ูุตู ุจููุฉ ุชุนูููุงุช eBPF ุจุดูู ูุงูู. </p><br><p style=";text-align:right;direction:rtl">  ุชุดูุฑ ูุนุธู ุงูููุงุตูุงุช ุ ูุซู Intel x86 ุ ุนุงุฏุฉู ุฅูู ูุง ูุฐูุจ ุฅููู ูู ุฌุฒุก ูู ุงูุชุนูููุงุช ุ ุฃู ุงููุชูุฉ ุงูุชู ุชูุชูู ุฅูููุง.  ูุณูุก ุงูุญุธ ุ ูู ููุงุตูุงุช eBPF ุ ูุฐู ุงูุชูุงุตูู ุฅูุง ูุจุนุซุฑุฉ ูู ุฌููุน ุฃูุญุงุก ุงููุซููุฉ ุฃู ุบุงุฆุจุฉ ุชูุงููุง ุ ููุชูุฌุฉ ูุฐูู ูุชุนูู ุนูููุง ุงุณุชุฎูุงุต ุงูุญุจูุจ ุงูููููุฏุฉ ูู ุชูุงุตูู ุงูุชูููุฐ ูู ููุงุฉ Linux. </p><br><p style=";text-align:right;direction:rtl"> ุนูู ุณุจูู ุงููุซุงู ุ ูู ุจููุฉ ุงูุชุนูููุฉ <code>op:8, dst_reg:4, src_reg:4, off:16, imm:32</code> ูุง ุชูุฌุฏ ูููุฉ ุชููู ุฃู ุงูุฅุฒุงุญุฉ (off) ู ููุฑู (imm) ููููุนุชุงู ุ ููุฐุง ููู ููุบุงูุฉ ุ ูุฃูู ูุคุซุฑ ุนูู ููุนูู ูู ุงูุชุนูููุงุช ุงูุญุณุงุจูุฉ ููููุฒ.  ุณุงุนุฏ <a href="">ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุตุฏุฑ ููุธุงู</a> Linux kernel. </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุง ุชูุฌุฏ ุตูุฑุฉ ูุงููุฉ ููู ูู ุงูุนูุงุฑุฉ ูููู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุจุนุถ ุงููุซุงุฆู ุ ูููุณ ููุท ุฌููุน ุงูุชุนูููุงุช ุ ุชุชู ุงูุฅุดุงุฑุฉ ุฅูู ูุนุงููุงุชูุง ุ ูููู ุฃูุถูุง ุฏูุงูุงุชูุง ูู C ุ ูุญุงูุงุช ุงูุชุทุจูู ุ ูููุฒุงุช ุงููุนุงูู ุ ููุง ุฅูู ุฐูู.  ุชุญุชูู ูุซุงุฆู eBPF ุนูู ูุตูู ุงูุชุนูููุงุช ุ ูููู ูุฐุง ูุง ูููู ูููุทูุฑ.  ูููุธุฑ ูููุง ุจูุฒูุฏ ูู ุงูุชูุตูู. </p><br><p style=";text-align:right;direction:rtl">  ุฌููุน ุชุนูููุงุช eBPF ูู 64 ุจุช ุ ุจุงุณุชุซูุงุก <code>LDDW</code> (ุชุญููู ุงููููุฉ ุงููุฒุฏูุฌุฉ) ุ ููุจูุบ ุญุฌููุง 128 ุจุช ุ ูุชุณูุณู ุงุซููู ูู imm ูุน 32 ุจุช ููู ููููุง.  ุชุญุชูู ุชุนูููุงุช eBPF ุนูู ุงูุจููุฉ ุงูุชุงููุฉ. <br><img src="https://habrastorage.org/webt/vp/vg/y0/vpvgy0gcsrrh3-uuax8ja3fgvvs.png"><br>  <i>eBPF ุชุฑููุฒ ุงูุชุนูููุงุช</i> </p><br><p style=";text-align:right;direction:rtl">  ูุนุชูุฏ ูููู ุญูู <code>OPAQUE</code> ุนูู ูุฆุฉ ุงูุชุนูููุงุช (ALU / JMP ุ Load / Store). </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู ุ ูุฆุฉ ุชุนูููุงุช <code>ALU</code> : <br><img src="https://habrastorage.org/webt/wd/9o/un/wd9ounsyetsua9ztfnd_zgxsfdc.png"><br>  <i>ุชุนูููุงุช ALU ุงูุชุฑููุฒ</i> </p><br><p style=";text-align:right;direction:rtl">  ููุฆุฉ <code>JMP</code> ููุง ุจููุฉ ุญูููุฉ ุฎุงุตุฉ ุจูุง: <br><img src="https://habrastorage.org/webt/au/bf/kz/aubfkz1yol8kjewuqesnlcsizm0.png"><br>  <i>ูุฑุน ุชุนูููุงุช ุงูุชุฑููุฒ</i> </p><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ูุชุนูููุงุช ุงูุชุญููู / ุงููุชุฌุฑ ุ ูุฎุชูู ุงููููู: <br><img src="https://habrastorage.org/webt/6y/ei/5h/6yei5h-0e6uazrqib0ihmffi2lg.png"><br>  <i>ุชุญููู / ุชุฎุฒูู ุชุนูููุงุช ุงูุชุฑููุฒ</i> </p><br><p style=";text-align:right;direction:rtl">  ุณุงุนุฏุช <a href="">ูุซุงุฆู eBPF ุบูุฑ ุงูุฑุณููุฉ ุนูู ุญู ูุฐู ุงููุดููุฉ</a> . </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุง ุชูุฌุฏ ูุนูููุงุช ุญูู ุงููุณุงุนุฏูู ููุงุชุตุงู ุ ุญูุซ ุชู ุจูุงุก ูุนุธู ุจุฑุงูุฌ eBPF ูููุตุฉ Linux kernel. </p><br><p style=";text-align:right;direction:rtl">  ููุฐุง ุบุฑูุจ ููุบุงูุฉ ุ ูุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุณุงุนุฏูู</a> ูู ุฃูู ุดูุก ูู ุจุฑุงูุฌ eBPF ุ ููู ูุคุฏูู ุงูููุงู ุงูุชู ุชุฑูุฒ ุนูููุง ุงูุชูููููุฌูุง. </p><br></li></ul><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/wk/ao/a6/wkaoa6jcgrqrqczkw4vjmrlczf4.png"><br>  <i>ุฅููุงููุฉ ุงูุชุดุบูู ุงูุชูุงุนูู EBPF ูุน ุงููุธุงุฆู ุงูููููุฉ</i> </p><br><p style=";text-align:right;direction:rtl">  ูุณุญุจ ุงูุจุฑูุงูุฌ ูุฐู ุงููุธุงุฆู ูู kernel ุ ููุนูููู ููุท ูุน ุงูุนูููุงุช ุ ููุชุนุงูููู ูุน ุญุฒู ุงูุดุจูุฉ ุ ููุนูููู ูุน ุฎุฑุงุฆุท eBPF ุ ููุขุฎุฐ ุงููุตูู ุ ููุชูุงุนููู ูุน ุงููุณุชุฎุฏููู.  ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃู ุงููุธุงุฆู ูุง ุชุฒุงู ููููุฉ ุ ุฅูุง ุฃูู ูู ุงููุซุงุฆู ุงูุฑุณููุฉ ุ ูุฌุฏุฑ ุงููุชุงุจุฉ ุจูุฒูุฏ ูู ุงูุชูุงุตูู ุนููุง.  ุชู ุงูุนุซูุฑ ุนูู ุงูุชูุงุตูู ุงููุงููุฉ ูู <a href="">ูุตุฏุฑ</a> Linux. </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุณุช ูููุฉ ุนู ุฏุนูุงุช ุงูุฐูู. </li></ul><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/f6/yf/f_/f6yff_btrkhq2pe1f_p4artfbla.png"><br>  <i>ุงูููุงููุงุช ุงูุฐูู EBPF.</i>  <i>ูุตุฏุฑ ุงูุตูุฑุฉ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://cilium.readthedocs.io/ar/latest/bpf/#tail-calls</a> .</i> </p><br><p style=";text-align:right;direction:rtl">  ุงูููุงููุงุช ุงูุฎูููุฉ ูู ุขููุฉ ุชุณูุญ ูุฃุญุฏ ุจุฑุงูุฌ eBPF ุจุงุณุชุฏุนุงุก ุจุฑูุงูุฌ ุขุฎุฑ ุฏูู ุงูุฑุฌูุน ุฅูู ุงูุจุฑูุงูุฌ ุงูุณุงุจู ุ ุฃู ุงูููุฒ ุจูู ุจุฑุงูุฌ eBPF ุงููุฎุชููุฉ.  ูุง ูุชู ุชูููุฐูุง ูู ุงูููุญู ุงููุทูุฑ ุ ููููู ุงูุงุทูุงุน ุนูู ูุนูููุงุช ููุตูุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงุฆู Cilium</a> . </p><br><p style=";text-align:right;direction:rtl">  ูุงูุช ุงูุชูุซูู ุงูุณูุฆ ูุนุฏุฏ ูู ุงูุณูุงุช ุงููุนูุงุฑูุฉ ูู eBPF ูู "ุงูุดุธุงูุง" ุงูุฑุฆูุณูุฉ ูู ุงูุชุทููุฑ ุ ูุฃููุง ุชุณุจุจุช ูู ูุดุงูู ุฃุฎุฑู.  ูุญุณู ุงูุญุธ ุ ุชู ุญู ูุนุธููู ุจูุฌุงุญ. </p><br><h2 id="o-srede-razrabotki" style=";text-align:right;direction:rtl">  ุญูู ุจูุฆุฉ ุงูุชุทููุฑ </h2><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/5z/l7/qa/5zl7qa8zrk3sz5bwogqqbjkzj0y.png"></p><br><p style=";text-align:right;direction:rtl">  ูุง ูุนูู ุฌููุน ุงููุทูุฑูู ุฃูู ูุฅูุดุงุก ูุชุญุฑูุฑ ุฑูุฒ Sleigh ูุนููููุง ูุงูุฉ ูููุงุช ุงูุงูุชุฏุงุฏ / ุงูุจุฑูุงูุฌ ุงููุณุงุนุฏ ูู Ghidra ุ ุชูุฌุฏ ุฃุฏุงุฉ ููุงุฆูุฉ ุฅูู ุญุฏ ูุง - Eclipse IDE ูุน ุฏุนู <strong>ุงูุฅุถุงูุงุช GhidraDev</strong> ู <strong>GhidraSleighEditor</strong> .  ุนูุฏ ุฅูุดุงุก ุงูุงูุชุฏุงุฏ ุ ุณูุชู ุชุฃุทูุฑู ุนูู ุงูููุฑ ูู ุดูู ูุณูุฏุฉ ุนูู ุ ูููุงู ุชุณููุท ุงูุถูุก ููุงุณุจ ุฅูู ุญุฏ ูุจูุฑ ุนูู ุฑูุฒ Sleigh ุ ููุฐูู ูุฏูู ููุฃุฎุทุงุก ุงูุฑุฆูุณูุฉ ูู ุจูุงุก ุฌููุฉ ุงููุบุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู Eclipse ุ ููููู ุชุดุบูู Ghidra (ุจุงููุนู ูุน ุงูุชูุฏูุฏ ููุฏ ุงูุชุดุบูู) ุ debug ุ ููู ุฃูุฑ ูุฑูุญ ููุบุงูุฉ.  ูููู ุฑุจูุง ุชููู ุฃุฑูุน ูุฑุตุฉ ูุฏุนู ูุถุน "Ghidra Headless" ุ ูุง ุชุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุชุดุบูู Ghidr ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฑุณูููุฉ 100500 ูุฑุฉ ููุนุซูุฑ ุนูู ุฎุทุฃ ูู ุงูููุฏ ุ ูุชู ุชูููุฐ ุฌููุน ุงูุนูููุงุช ูู ุงูุฎูููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงููููุฑุฉ ูููู ุฃู ุชููู ูุบููุฉ!  ูููููู ุชูุฒูู Eclipse ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููููุน ุงูุฑุณูู</a> .  ูุชุซุจูุช ุงูููููู ุงูุฅุถุงูู ุ ุญุฏุฏ Ecplise ูู <strong>ุชุนูููุงุช</strong> Ecplise <strong>โ</strong> ุ ุซู ุงููุฑ ููู <strong>Add (ุฅุถุงูุฉ)</strong> ูุญุฏุฏ ุฃุฑุดูู zip plugin. </p><br><h2 id="razrabotka-rasshireniya" style=";text-align:right;direction:rtl">  ุชุทููุฑ ุงูุชูุฏูุฏ </h2><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ููุงูุชุฏุงุฏ ุ ุชู ุชุทููุฑ ูููุงุช ููุงุตูุงุช ุงููุนุงูุฌ ุ ููู ุฃุฏุงุฉ ุชุญููู ุชุฑุซ ูู ุฃุฏุงุฉ ุงูุชุญููู ุงูุฑุฆูุณูุฉ ELF ูุชูุณุน ูุฏุฑุงุชูุง ูู ุญูุซ ุงูุชุนุฑู ุนูู ุจุฑุงูุฌ eBPF ุ ููุนุงูุฌ ููู ูุชุทุจูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฎุฑุงุฆุท eBPF</a> ูู ุฃุฏุงุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅุฒุงูุฉ</a> ุชูููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ghidra</a> ู decompiler ุ ููุฐูู ูุญูู ูุชุญุฏูุฏ ุชูููุนุงุช ูุณุงุนุฏ eBPF. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/9b/au/py/9baupyq-7nmirl9wzrg8rhgs5aq.png"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/b7/ql/w3/b7qlw3ziz1trmobuvp8jb1ynnu8.png"><br>  <i>ูููุงุช ุงูุชูุฏูุฏ ููุดุฑูุน ูู Eclipse IDE</i> </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุนู ุงููููุงุช ุงูุฑุฆูุณูุฉ: </p><br><p style=";text-align:right;direction:rtl">  <code>.cspec</code> - ูุดูุฑ ุฅูู ุฃููุงุน ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ ุ ูููุฏุงุฑ ุงูุฐุงูุฑุฉ ุงููุฎุตุต ููุง ูู eBPF ุ ููุชู ุชุนููู ุญุฌู ุงูููุฏุณ ุ ููุชู ุชุนููู ุงูููุตู "stackpointer" ุนูู ุชุณุฌูู <code>R10</code> ุ ููุชู ุชูููุน ุงุชูุงููุฉ ุงูุงุชุตุงู.  ุชู ุชูููุฐ ุงูุงุชูุงููุฉ (ูุซู ุงูุจููุฉ) ููููุง ูููุซุงุฆู: </p><br><blockquote style=";text-align:right;direction:rtl">  ูุฐูู ุ ูุชู ุชุนุฑูู ุงุตุทูุงุญ ุงููุฏุงุก eBPF ุนูู ุงููุญู ุงูุชุงูู: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  R0 - ูููุฉ ุงูุฅุฑุฌุงุน ูู ูุธููุฉ in-kernel ุ ููููุฉ ุงูุฎุฑูุฌ ูุจุฑูุงูุฌ eBPF </li><li style=";text-align:right;direction:rtl">  R1 - R5 - ุงููุณุงุฆุท ูู ุจุฑูุงูุฌ eBPF ุฅูู ูุธููุฉ ูู ุงูููุงุฉ </li><li style=";text-align:right;direction:rtl">  R6 - R9 - ุงูุณุฌูุงุช ุงููุญููุธุฉ ุงูุชู ุณูุชู ุญูุธูุง ูู ูุธููุฉ ุงูููุงุฉ </li><li style=";text-align:right;direction:rtl">  R10 - ูุคุดุฑ ุฅุทุงุฑ ูููุฑุงุกุฉ ููุท ูููุตูู ุฅูู ุงูููุฏุณ </li></ul><br></blockquote><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">eBPF.cspec</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">compiler_spec</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data_organization</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">absolute_max_alignment</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">machine_alignment</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">default_alignment</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">default_pointer_alignment</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pointer_size</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wchar_size</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">short_size</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer_size</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">long_size</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">long_long_size</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float_size</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">double_size</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">long_double_size</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size_alignment_map</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">entry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">entry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">entry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">entry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size_alignment_map</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data_organization</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">global</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">range</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">space</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ram"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">range</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">space</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">global</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stackpointer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">register</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R10"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">space</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ram"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">default_proto</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">prototype</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"__fastcall"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">extrapop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">stackshift</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">minsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">maxsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">minsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">maxsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R2"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">minsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">maxsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R3"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">minsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">maxsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R4"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">minsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">maxsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R5"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">killedbycall</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">minsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">maxsize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R0"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pentry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unaffected</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">varnode</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">space</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ram"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">offset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R6"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R7"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R8"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R9"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">register</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R10"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unaffected</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">prototype</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">default_proto</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">compiler_spec</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุจู ุงููุชุงุจุนุฉ ููุตู ูููุงุช ุงูุชุทููุฑ ุ ุณูู <code>.cspec</code> ุฅูู ุณุทุฑ ุตุบูุฑ ูู ููู <code>.cspec</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stackpointer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">register</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"R10"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">space</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ram"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅูู ุงููุตุฏุฑ ุงูุฑุฆูุณู ููุดุฑ ุนูุฏ ุฅูุบุงุก ุชุฑุฌูุฉ eBPF ูู Ghidra ุ ููุฏ ุจุฏุฃ ุฑุญูุฉ ูุซูุฑุฉ ุฅูู ูููุฉ eBPF ุ ุงูุชู ุดูุฏุช ุนุฏุฏูุง ูู ุงููุญุธุงุช ุบูุฑ ุงูุณุงุฑุฉ ุ ูุงูุชู ุฌูุจุช ูุนุธู ุงูุฃูู ุฅูู ุงูุชุทูุฑ. </p><br><h2 id="all-we-need-isstack" style=";text-align:right;direction:rtl">  ูู ูุง ูุญุชุงุฌู ูู ... ูููุฉ </h2><br><p style=";text-align:right;direction:rtl">  ููููู ูุธุฑุฉ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงุฆู</a> ุงูููุงุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑุณููุฉ</a> : </p><br><blockquote style=";text-align:right;direction:rtl">  ุณ: ูู ูููู ูุจุฑุงูุฌ BPF ุงููุตูู ุฅูู ูุคุดุฑ ุงูุชุนูููุงุช ุฃู ุฅุฑุฌุงุน ุงูุนููุงูุ <br><br>  ุฌ: ูุง. <br><br>  ุณ: ูู ูููู ูุจุฑุงูุฌ BPF ุงููุตูู ุฅูู ูุคุดุฑ ุงูููุฏุณุ <br><br>  ุฌ: ูุง.  ูููู ุงููุตูู ุฅูู ูุคุดุฑ ุงูุฅุทุงุฑ ููุท (ุชุณุฌูู R10).  ูู ูุฌูุฉ ูุธุฑ ุจุฑูุงูุฌ ุงูุชุญููู ุงูุจุฑูุฌู ุ ูู ุงูุถุฑูุฑู ุฃู ูููู ูุฏูู ูุคุดุฑ ููุฏุณ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุนุฑูู LLVM ุงูุณุฌู R11 ููุคุดุฑ ููุฏุณ ูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ูู BPF ุงูุฎุงุตุฉ ุจู ุ ูููู ูุชุฃูุฏ ูู ุฃู ุงูููุฏ ุงูุฐู ุชู ุฅูุดุงุคู ูุง ูุณุชุฎุฏูู ุฃุจุฏูุง. </blockquote><p style=";text-align:right;direction:rtl">  ูุง ูุญุชูู ุงููุนุงูุฌ ุนูู ูุคุดุฑ ุชุนูููุงุช (IP) ุฃู ูุคุดุฑ ููุฏุณ (SP) ุ ูุงูุฃุฎูุฑ ููู ููุบุงูุฉ ุจุงููุณุจุฉ ูู Ghidra ุ ูุชุนุชูุฏ ุฌูุฏุฉ ุฅูุบุงุก ุชุฑุฌูุชู ุนูู ุฐูู.  ูู ููู <code>cspec</code> ุ ุชุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ุงูุณุฌู ุงูุฐู ูู ูุคุดุฑ ุงูููุฏุณ (ููุง ูู ููุถุญ ุฃุนูุงู).  <code>R10</code> ูู ุณุฌู eBPF ุงููุญูุฏ ุงูุฐู ูุณูุญ ุจุงููุตูู ุฅูู ุญุฒูุฉ ุงูุจุฑุงูุฌ ุ ููู ูุคุดุฑ ูุฑุนู ุ ููู ุซุงุจุช ูุฏุงุฆููุง ุตูุฑููุง.  ุชุนููู ุงูุชุณููุฉ "stackpointer" ุนูู <code>R10</code> ูู ููู <code>cspec</code> ุฎุทุฃ ุฌููุฑู ุ ููู ูุง ุชูุฌุฏ ุฎูุงุฑุงุช ุฃุฎุฑู ุ ูุฃู Ghidra ูู ูุนูู ูุน ููุฏุณ ุงูุจุฑูุงูุฌ.  ููููุง ูุฐูู ุ ูุฅู SP ุงูุฃุตูู ุบุงุฆุจ ุ ููุง ุดูุก ูุญู ูุญูู ูู ุจููุฉ eBPF. </p><br><p style=";text-align:right;direction:rtl">  ุชูุดุฃ ุนุฏุฉ ูุดุงูู ูู ูุฐุง: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุณูุชู ุถูุงู ุฃู ูููู ุญูู "Stack Depth" ูู Ghidra ุตูุฑุงู ุ ุญูุซ ูุชุนูู ุนูููุง ุจุจุณุงุทุฉ ุชุนููู <code>R10</code> ูููุฏุณ ูู ูุฐู ุงูุธุฑูู ุงููุนูุงุฑูุฉ ุ ููู ูู ุฌููุฑู ุฏุงุฆููุง ุตูุฑู ุ ููุฏ ุชูุช ููุงูุดุชู ุณุงุจููุง.  ุณูุนูุณ "ุนูู ุงูููุฏุณ" ุงูุณุฌู ูุน ุงูุชุณููุฉ "stackpointer". </p><br><p style=";text-align:right;direction:rtl">  ูุนููู ุฃู ุชุชุญูููุง ุ ููุฐู ูู ููุฒุงุช ุงูุนูุงุฑุฉ. </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุงูุชุนูููุงุช ุงูุชู ุชุนูู ุนูู <code>R10</code> (ุฃู ุ ุชูู ุงูุชู ุชุชุนุงูู ูุน ุงูููุฏุณ) ูุง ูุชู ูู ุชุดููุฑูุง ูู ุงูุบุงูุจ.  Ghidra ุจุดูู ุนุงู ูุง ูููู ุจูู ุชุดููุฑ ูุง ูุนุชุจุฑู ุงูููุฏ ุงูููุช (ุฃู ุงูููุชุทูุงุช ุงูุชู ูุง ูุชู ุชูููุฐูุง ูุทูููุง).  ููุธุฑูุง ูุฃู <code>R10</code> ูุงุจู ููุชุบููุฑ ุ ูุชู ุงูุชุนุฑู ุนูู ุงูุนุฏูุฏ ูู ุฅุฑุดุงุฏุงุช ุงููุชุฌุฑ / ุงูุชุญููู ูู ููุจู Ghidr ุจุงุนุชุจุงุฑูุง ุฑูุฒูุง ููุงุฆููุง ูุชุฎุชูู ูู ุฃุฏุงุฉ ูู ุงูุชุดููุฑ. </p><br><p style=";text-align:right;direction:rtl">  ูุญุณู ุงูุญุธ ุ ุชู ุญู ูุฐู ุงููุดููุฉ ุนู ุทุฑูู ูุชุงุจุฉ ูุญูู ูุฎุตุต ุ ููุฐูู ุงูุฅุนูุงู ุนู ูุณุงุญุฉ ุนููุงู ุฅุถุงููุฉ ูุน ูุณุงุนุฏู eBPF ูู ููู <code>pspec</code> ุ ูุงูุฐู ุชู ุทูุจู ูู ุฃุญุฏ ูุทูุฑู Ghidra ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุดุฑูุน Issue</a> . </p><br></li></ol><br><h2 id="razrabotka-rasshireniya-continued" style=";text-align:right;direction:rtl">  ุชุทููุฑ ุงูุฅุฑุดุงุฏ (ุชุงุจุน) </h2><br><p style=";text-align:right;direction:rtl">  <code>.ldefs</code> ูุตู ููุฒุงุช ุงููุนุงูุฌ ุ ููุญุฏุฏ ูููุงุช ุงูููุงุตูุงุช. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">eBPF.ldefs</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language_definitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eBPF"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">endian</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"little"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"64"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">variant</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">slafile</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eBPF.sla"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorspec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eBPF.pspec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eBPF:LE:64:default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>eBPF processor 64-bit little-endian<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">compiler</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">spec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eBPF.cspec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">external_name</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tool</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DWARF.register.mapping.file"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eBPF.dwarf"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language_definitions</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  <code>.opinion</code> ููู <code>.opinion</code> ุงูุชุญููู ุฅูู ุงููุนุงูุฌ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">eBPF.opinion</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">opinions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">loader</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Executable and Linking Format (ELF)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">compilerSpecID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">primary</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"247"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eBPF"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">endian</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"little"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"64"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">opinions</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุชู ุงูุฅุนูุงู ุนู ุนุฏุงุฏ ุงูุจุฑูุงูุฌ ุจุงูููุญู .pspec ุ ููู ูุน eBPF ุ ูููู ุถูููุงู ููุง ููุณุชุฎุฏู ูู ุงูููุงุตูุงุช ุจุฃู ุดูู ูู ุงูุฃุดูุงู ุ ูุฐูู ููู ูุฎุตุต ููุฃุบุฑุงุถ ุงูุดูููุฉ ููุท.  ุจุงูููุงุณุจุฉ ุ ูููู <code>PC</code> ุงูุฎุงุต ุจู eBPF ุญุณุงุจููุง ุ ูููุณ ุนููุงููุง (ูุดูุฑ ุฅูู ุงูุชุนูููุงุช ุ ูููุณ ุงูุจุงูุช ุงููุญุฏุฏ ููุจุฑูุงูุฌ) ุ ุถุน ุฐูู ูู ุงูุงุนุชุจุงุฑ ุนูุฏ ุงูููุฒ. </p><br><p style=";text-align:right;direction:rtl">  ูุญุชูู ุงูููู ุฃูุถูุง ุนูู ูุณุงุญุฉ ุนููุงู ุฅุถุงููุฉ ููุณุงุนุฏู eBPF ุ ุญูุซ ูุชู ุงูุฅุนูุงู ุนููุง ูุฃุญุฑู. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">eBPF.pspec</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">processor_spec</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">programcounter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">register</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PC"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">default_symbols</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_unspec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x0"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_map_lookup_elem"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_map_update_elem"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x2"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_map_delete_elem"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x3"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_probe_read"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x4"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_ktime_get_ns"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x5"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_trace_printk"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x6"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_get_prandom_u32"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x7"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_get_smp_processor_id"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x8"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_skb_store_bytes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x9"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_l3_csum_replace"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0xa"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_l4_csum_replace"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0xb"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_tail_call"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0xc"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_clone_redirect"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0xd"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_get_current_pid_tgid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0xe"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_get_current_uid_gid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0xf"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_get_current_comm"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x10"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_get_cgroup_classid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x11"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_skb_vlan_push"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x12"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_skb_vlan_pop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x13"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_skb_get_tunnel_key"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x14"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_skb_set_tunnel_key"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x15"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_perf_event_read"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x16"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_redirect"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x17"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_get_route_realm"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x18"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_perf_event_output"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x19"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_skb_load_bytes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x1a"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_get_stackid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x1b"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_csum_diff"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x1c"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_skb_get_tunnel_opt"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x1d"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_skb_set_tunnel_opt"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x1e"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_skb_change_proto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x1f"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_skb_change_type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x20"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_skb_under_cgroup"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x21"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_get_hash_recalc"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x22"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_get_current_task"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x23"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bpf_probe_write_user"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0x24"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">default_symbols</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">default_memory_blocks</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">memory_block</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eBPFHelper_functions"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">start_address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"syscall:0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">length</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x200"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">initialized</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">default_memory_blocks</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">processor_spec</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  <code>.sinc</code> ููู <code>.sinc</code> ูู ููู ุงูุชูุฏูุฏ ุงูุฃูุซุฑ ุญุฌููุง ุ ุญูุซ ูุชู ุชุนุฑูู ุฌููุน ุงูุณุฌูุงุช ููููู ุชุนูููุฉ eBPF ูุงูุฑููุฒ ูุฃุณููุจ ุงูุงุณุชุฐูุงุฑ ูุฏูุงูุงุช ุงูุชุนูููุงุช ูู Sleigh ููุง. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">EBPF.sinc ููุชุทู ุตุบูุฑ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">define space ram type=ram_space size=8 default; define space register type=register_space size=4; define space syscall type=ram_space size=2; define register offset=0 size=8 [ R0 R1 R2 R3 R4 R5 R6 R7 R8 R9 R10 PC ]; define token instr(64) imm=(32, 63) signed off=(16, 31) signed src=(12, 15) dst=(8, 11) op_alu_jmp_opcode=(4, 7) op_alu_jmp_source=(3, 3) op_ld_st_mode=(5, 7) op_ld_st_size=(3, 4) op_insn_class=(0, 2) ; #We'll need this token to operate with LDDW instruction, which has 64 bit imm value define token immtoken(64) imm2=(32, 63) ; #To operate with registers attach variables [ src dst ] [ R0 R1 R2 R3 R4 R5 R6 R7 R8 R9 R10 _ _ _ _ _ ]; โฆ :ADD dst, src is src &amp; dst &amp; op_alu_jmp_opcode=0x0 &amp; op_alu_jmp_source=1 &amp; op_insn_class=0x7 { dst=dst + src; } :ADD dst, imm is imm &amp; dst &amp; op_alu_jmp_opcode=0x0 &amp; op_alu_jmp_source=0 &amp; op_insn_class=0x7 { dst=dst + imm; } โฆ</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุนูู ููุญูู eBPF ุนูู ุชูุณูุน ุงููุฏุฑุงุช ุงูุฃุณุงุณูุฉ ููุญูู ELF ุจุญูุซ ููููู ุงูุชุนุฑู ุนูู ุฃู ุงูุจุฑูุงูุฌ ุงูุฐู ููุช ุจุชูุฒููู ุนูู Ghidra ูุญุชูู ุนูู ูุนุงูุฌ eBPF.  ุจุงููุณุจุฉ ูู ุ <a href="">ูุชู</a> ุชุฎุตูุต <a href="">ุซุงุจุช BPF</a> ูู <code>ElfConstants</code> Ghidra ุ ููุญุฏุฏ ุงููุญูู ูุนุงูุฌ eBPF ููู. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">eBPF_ElfExtension.java</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ghidra.app.util.bin.format.elf.extend; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.app.util.bin.format.elf.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.lang.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.util.exception.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.util.task.TaskMonitor; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eBPF_ElfExtension</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ElfExtension</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">canHandle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ElfHeader elf)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> elf.e_machine() == ElfConstants.EM_BPF &amp;&amp; elf.is64Bit(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">canHandle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ElfLoadHelper elfLoadHelper)</span></span></span><span class="hljs-function"> </span></span>{ Language language = elfLoadHelper.getProgram().getLanguage(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> canHandle(elfLoadHelper.getElfHeader()) &amp;&amp; <span class="hljs-string"><span class="hljs-string">"eBPF"</span></span>.equals(language.getProcessor().toString()) &amp;&amp; language.getLanguageDescription().getSize() == <span class="hljs-number"><span class="hljs-number">64</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDataTypeSuffix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"eBPF"</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processGotPlt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ElfLoadHelper elfLoadHelper, TaskMonitor monitor)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> CancelledException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!canHandle(elfLoadHelper)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.processGotPlt(elfLoadHelper, monitor); } }</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุทููุจ ูุนุงูุฌ ุงูุชุฑุญูู ูุชุทุจูู ุฎุฑุงุฆุท eBPF ูู ุฃุฏุงุฉ ูู ุงูุชุดููุฑ ู decompiler.  ูุชู ุงูุชูุงุนู ูุนูู ูู ุฎูุงู ุนุฏุฏ ูู ุงููุณุงุนุฏูู ุ ุชุณุชุฎุฏู ุงููุธุงุฆู ูุงุตู ููู ููุฅุดุงุฑุฉ ุฅูู ุงูุฎุฑุงุฆุท.  ุงุณุชูุงุฏูุง ุฅูู ุฌุฏูู ุงูููู ุ ูููู ููุงุญุธุฉ ุฃู ุงูููุญูู ูููู ุจุชุตุญูุญ ุชุนูููุฉ LDDW ุ ูุงูุชู ุชูุดุฆ <code>Rn</code> ููุคูุงุก ุงููุณุงุนุฏูู (ุนูู ุณุจูู ุงููุซุงู ุ <code>bpf_map_lookup_elem(โฆ)</code> ). </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ูููู ุงููุนุงูุฌ ุจุชูุฒูุน ุฌุฏูู ููู ุงูุจุฑูุงูุฌ ุ ูุงูุนุซูุฑ ุนูู ุนูุงููู ุงูููู (ุงูุชุนูููุงุช) ุ ููุฐูู ุจุฌูุน ูุนูููุงุช ุงูุณูุณูุฉ ุญูู ุงุณู ุงูุฎุฑูุทุฉ.  ุนูุงูุฉ ุนูู ุฐูู ุ ุจุงูุฑุฌูุน ุฅูู ุฌุฏูู ุงูุฑููุฒ ุ ูุฅูู ูุญุณุจ ุงูุนูุงููู ุงูุญููููุฉ ููุฐู ุงูุฎุฑุงุฆุท ูุจูุน ุงูุชุนูููุงุช. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">eBPF_ElfRelocationHandler.java</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eBPF_ElfRelocationHandler</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ElfRelocationHandler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">canRelocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ElfHeader elf)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> elf.e_machine() == ElfConstants.EM_BPF; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">relocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ElfRelocationContext elfRelocationContext, ElfRelocation relocation, Address relocationAddress)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> MemoryAccessException, NotFoundException </span></span>{ ElfHeader elf = elfRelocationContext.getElfHeader(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elf.e_machine() != ElfConstants.EM_BPF) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } Program program = elfRelocationContext.getProgram(); Memory memory = program.getMemory(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> type = relocation.getType(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> symbolIndex = relocation.getSymbolIndex(); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> value; <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> appliedSymbol = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//Relocations with maps always have type 0x1. Since eBPF hasn't names of constants (types) of relocations, it was decided to use magic //number 1. if (type == 1) { try { int SymbolIndex= relocation.getSymbolIndex(); ElfSymbol Symbol = elfRelocationContext.getSymbol(SymbolIndex); String map = Symbol.getNameAsString(); SymbolTable table = program.getSymbolTable(); Address mapAddr = table.getSymbol(map).getAddress(); String sec_name = elfRelocationContext.relocationTable.getSectionToBeRelocated().getNameAsString(); if (sec_name.toString().contains("debug")) { return; } value = mapAddr.getAddressableWordOffset(); Byte dst = memory.getByte(relocationAddress.add(0x1)); memory.setLong(relocationAddress.add(0x4), value); memory.setByte(relocationAddress.add(0x1), (byte) (dst + 0x10)); } catch(NullPointerException e) {} } if (appliedSymbol &amp;&amp; symbolIndex == 0) { markAsWarning(program, relocationAddress, Long.toString(type), "applied relocation with symbol-index of 0", elfRelocationContext.getLog()); } } }</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/_8/l_/1m/_8l_1mca5r1spj1ffuvpabjs0es.png"><br>  <i>ูุชูุฌุฉ ุชูููู ู decompiling eBPF</i> </p><br><p style=";text-align:right;direction:rtl">  ููู ุงูููุงูุฉ ุ ูุญุตู ุนูู ุฃุฏุงุฉ ูู ู ูู eBPF!  ุงุณุชุฎุฏุงู ููุตุญุฉ! </p><br><p style=";text-align:right;direction:rtl">  ุงูุชูุฏูุฏ ุนูู GitHub: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">eBPF ูู Ghidra</a> . </p><br><p style=";text-align:right;direction:rtl">  ุงููุดุฑุงุช ููุง: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> . </p><br><h3 id="ps" style=";text-align:right;direction:rtl">  PS </h3><br><p style=";text-align:right;direction:rtl">  ุดูุฑุง ุฌุฒููุง <strong>ููุฃูู ุงูุฑููู</strong> ุนูู ูุชุฑุฉ ุชุฏุฑูุจ ูุซูุฑุฉ ููุงูุชูุงู ุ ุฎุงุตุฉ ููููุฌููู ูู ูุณู ุงูุฃุจุญุงุซ (ุฃููุณุงูุฏุฑ ููููููุงู).  ุฃูุญูู ูู! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar468529/">https://habr.com/ru/post/ar468529/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar468519/index.html">ุฅูุดุงุก ูุงุนุฏุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุดุงุฆุนุฉ</a></li>
<li><a href="../ar468521/index.html">ููู ูููุง ุจุชุนููู ุฃูู ุงููุนูููุงุช</a></li>
<li><a href="../ar468523/index.html">ูู ุงูุตูุงุฑูุฎ ุฅูู ุงูุฑูุจูุชุงุช ููุง ุนูุงูุฉ ุจูุซูู ุจู. ูุตุฉ ุงูุฎุฑูุฌูู GeekBrains</a></li>
<li><a href="../ar468525/index.html">ุฃูุนุงุจ ุฎุดุจูุฉ ุ ุงูุฌุฒุก ุงูุฃูู - 1982-1985</a></li>
<li><a href="../ar468527/index.html">ุชูููู ูุญุฏุฉ ุชุญูู ุจุทุฑููุฉ ูุดููุฉ ุฏููุงููุงุช ูุนููุณ</a></li>
<li><a href="../ar468531/index.html">ุฃูู ุฑูุจูุช PHP ูููููุชุงูุชู</a></li>
<li><a href="../ar468533/index.html">ุณุจุงู ุงููุดู ููุณุงูุงุช ุทูููุฉ ุนูู DevOps ูุน Express 42</a></li>
<li><a href="../ar468535/index.html">ูุง ุชุญุชุงุฌ ุณุฌูุงุชุ</a></li>
<li><a href="../ar468537/index.html">ุฃุณุงุณูุงุช DevOps. ุงูุฏุฎูู ุฅูู ุงููุดุฑูุน ูู ุงูุตูุฑ</a></li>
<li><a href="../ar468541/index.html">ุงูุณุญุจ ูุงูุฅููุงุช ููููุงุช ูููุณุชุฎุฏููู ุงููููููููุ ูู ุชูุฒุญ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>