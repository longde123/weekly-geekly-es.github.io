<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíâ üéõÔ∏è üñïüèª Gerador de widget CRUD para Yii ü§úüèΩ üë®üèΩ‚Äçüéì üë©üèº‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O que coment√°rios sobre o artigo sobre Habr√© e op√ß√µes adicionais t√™m em comum na compra de um carro? 



 Do ponto de vista da modelagem de dados, amb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gerador de widget CRUD para Yii</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450696/">  O que coment√°rios sobre o artigo sobre Habr√© e op√ß√µes adicionais t√™m em comum na compra de um carro? <br><br><img src="https://habrastorage.org/webt/4x/ex/_2/4xex_2tbdcc_iwesc63zed-dqzm.png"><br><br>  Do ponto de vista da modelagem de dados, ambas s√£o entidades "aninhadas" que n√£o t√™m significado independente isoladamente do objeto pai. <br><br>  No Yii ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">php framework</a> ), existe o Gii - um gerador de c√≥digo interno que permite criar interfaces CRUD b√°sicas usando um modelo de dados com apenas alguns cliques do mouse, o que acelera significativamente o desenvolvimento, mas √© aplic√°vel apenas a entidades independentes, como o artigo ou a m√°quina nos exemplos acima. <br><br>  Seria √≥timo poder gerar algo semelhante para objetos de dados "aninhados", certo?  Agora - voc√™ pode, seja bem-vindo ao kat para obter detalhes. <br><a name="habracut"></a><br>  Para os mais impacientes no final do artigo, s√£o fornecidas instru√ß√µes para um in√≠cio r√°pido. <br><br>  E para os interessados ‚Äã‚Äãno artigo, s√£o considerados aspectos de um aplicativo de neg√≥cios para um dispositivo interno: <br><br><ul><li>  Caso de neg√≥cios: postagem por t√≥pico <br><ul><li>  A lista de t√≥picos nos principais </li><li>  Lista de postagens relacionadas </li></ul></li><li>  Sob o cap√¥: um gerador de gii baseado em CRUD <br><ul><li>  Gii Generator Template </li><li>  Classe base do widget </li><li>  Controlador de fachada integrado </li></ul></li><li>  In√≠cio r√°pido <br><ul><li>  Sobre suporte e desenvolvimento </li></ul></li></ul><br><h2>  Caso de neg√≥cios: postagem por t√≥pico </h2><br>  Talvez coment√°rios sobre um habr e um mau exemplo desde  geralmente s√£o mais √∫teis que o pr√≥prio artigo, mas, em qualquer caso, ao desenvolver um aplicativo, geralmente h√° situa√ß√µes em que um determinado objeto do modelo de dados √© de pouco interesse para o usu√°rio como uma entidade independente. <br><br>  Considere uma tarefa comercial simplificada: criar um site para publicar mensagens agrupadas por v√°rios t√≥picos. <br><br>  O site deve ter as seguintes interfaces: <br><br><ol><li>  A p√°gina principal - deve suportar v√°rios widgets no futuro, mas no est√°gio atual de implementa√ß√£o, existe apenas um: uma lista de t√≥picos filtrados por algum crit√©rio. </li><li>  Lista completa de t√≥picos - uma lista completa de t√≥picos em forma de tabela; </li><li>  P√°gina de t√≥pico - informa√ß√µes sobre o t√≥pico e uma lista de postagens publicadas nele. </li></ol><br>  Bonito padr√£o, certo? <br><br>  Vejamos o modelo de dados: <br><br><img src="https://habrastorage.org/webt/f0/db/dp/f0dbdpmz9gbbxhsmxhu7vmzurem.png"><br><br>  Tamb√©m n√£o h√° surpresas.  Duas classes de modelos conter√£o nossa l√≥gica de neg√≥cios: <br><br><ul><li>  A classe <b>Topic</b> - dados sobre o t√≥pico, valida√ß√£o, uma lista de postagens nele, bem como um m√©todo separado que retorna uma lista de t√≥picos filtrados pelos crit√©rios para o widget na p√°gina principal. </li><li>  A classe <b>Post</b> √© apenas dados e valida√ß√£o. </li></ul><br>  O aplicativo ser√° atendido por dois controladores: <br><br><ul><li>  <b>SiteController</b> - p√°ginas padr√£o (sobre n√≥s, contatos, etc.), autoriza√ß√£o (n√£o exigida pelos termos de refer√™ncia, mas sabemos alguma coisa) e √≠ndice - a p√°gina principal.  Porque  Como esperamos muitos widgets diferentes no futuro, faz sentido deixar a p√°gina principal nesse controlador e n√£o transferi-lo para um modelo espec√≠fico para um. </li><li>  <b>O TopicController</b> √© um conjunto padr√£o de a√ß√µes: lista, cria√ß√£o, edi√ß√£o, exibi√ß√£o e exclus√£o de t√≥picos. </li></ul><br>  Potencialmente, voc√™ tamb√©m pode gerar um <b>PostController</b> - para fins de administra√ß√£o e / ou copiar e colar partes de c√≥digo em widgets personalizados, mas deixe isso fora do escopo deste artigo. <br>  At√© agora, a maior parte do c√≥digo pode ser gerada usando o gii, o que acelera o desenvolvimento e reduz os riscos (menos c√≥digo manual = menos chance de cometer um erro). <br><br>  Restam duas perguntas: <br><br><ol><li>  Como exibir uma lista filtrada de t√≥picos na p√°gina principal? </li><li>  Como exibir uma lista de postagens por t√≥pico? </li></ol><br>  Se voc√™ puder resolv√™-los usando um gerador autom√°tico - isso ser√° uma conquista s√≥lida. <br><br><h3>  A lista de t√≥picos nos principais </h3><br>  A p√°gina principal exibida pelo site / endere√ßo do √≠ndice deve conter uma lista de t√≥picos filtrados por um crit√©rio predeterminado.  Crit√©rios de filtragem, como parte da l√≥gica de neg√≥cios, inclu√≠mos no modelo. <br><br>  Para exibi√ß√£o, existem v√°rias op√ß√µes de implementa√ß√£o. <br><br>  O primeiro, sujo e r√°pido, √© fazer tudo diretamente no arquivo view ( <b>views / site / index.php</b> ): <br><br><ol><li>  Criar <b>ActiveDataProvider</b> ; </li><li>  Preencha com dados do modelo de <b>t√≥pico</b> ; </li><li>  Exiba usando um widget <b>ListView</b> / <b>GridView</b> padr√£o, especificando os campos obrigat√≥rios manualmente. </li></ol><br>  Voc√™ pode ir um pouco mais longe e <b>agrupar</b> tudo em um arquivo de exibi√ß√£o separado, algo como <b>views / site / _topic-list-widget.php</b> , chamando sua renderiza√ß√£o do arquivo principal.  Isso dar√° um pouco mais de capacidade de gerenciamento e extensibilidade, mas ainda parece bastante sujo. <br><br>  √â prov√°vel que a maioria de n√≥s crie um widget separado de acordo com todas as regras, em um espa√ßo para nome separado ( <b>app \ widgets</b> ou <b>app \ components</b> para o modelo b√°sico - dependendo da vers√£o que voc√™ est√° usando), onde eles encapsulam a cria√ß√£o do <b>ActiveDataProvider</b> por modelo e s√£o exibidos em um separado submiss√£o.  Tudo o que resta √© chamar esse widget a partir da p√°gina principal.  Esta solu√ß√£o √© a mais correta do ponto de vista da decomposi√ß√£o de classe, gerenciabilidade e extensibilidade do c√≥digo. <br><br>  Mas parece que o c√≥digo desse widget repetir√° muito o c√≥digo do <b>TopicController</b> em termos de manipula√ß√£o de <b>actionIndex ()</b> ?  E √© t√£o chato escrever esse c√≥digo manualmente. <br><br>  Seria muito melhor gerar esse c√≥digo automaticamente e, em seguida, basta chamar o widget finalizado: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= \app\widgets\TopicControllerWidget::widget([ <span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'index'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'query'</span></span> =&gt; app\models\Topic::findBySomeSpecificCriteria() ], ]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br><h3>  Lista de postagens relacionadas </h3>  A p√°gina para exibir o t√≥pico exibido pelo endere√ßo de <b>t√≥pico / exibi√ß√£o</b> deve conter informa√ß√µes sobre o pr√≥prio t√≥pico e uma lista de mensagens publicadas nele.  Obtemos a lista de mensagens para o t√≥pico no modelo automaticamente se tivermos configurado corretamente os relacionamentos entre as tabelas, para que apenas a pergunta de exibi√ß√£o permane√ßa. <br><br>  Por analogia com a lista filtrada de t√≥picos, temos quase as mesmas op√ß√µes. <br><br>  O primeiro √© fazer tudo no c√≥digo do arquivo de exibi√ß√£o para exibir o t√≥pico ( <b>views / topic / view.php</b> ): <br><br><ol><li>  Criar <b>ActiveDataProvider</b> ; </li><li>  Preencha com dados do modelo <b>$ model-&gt; getPosts ()</b> ; </li><li>  Exiba usando um widget <b>ListView</b> / <b>GridView</b> padr√£o, especificando os campos obrigat√≥rios manualmente. </li></ol><br>  O segundo √© isolar esse c√≥digo em um arquivo de apresenta√ß√£o separado: <b>views / topic / _posts-list-widget.php</b> , apenas para n√£o ser uma desgra√ßa - reutiliz√°-lo em algum lugar ainda falhar√°. <br><br>  O terceiro √© um widget completo que duplicar√° amplamente o c√≥digo do <b>PostController</b> condicional na parte <b>actionIndex ()</b> , mas gravado manualmente. <br><br>  Ou gere o c√≥digo automaticamente e chame o widget finalizado: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([ <span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'index'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'query'</span></span> =&gt; $model-&gt;getPosts(), ], ]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br><h2>  Sob o cap√¥: um gerador de gii baseado em CRUD </h2><br>  A tarefa de neg√≥cios √© definida, os requisitos para o widget gerado s√£o descritos, descobriremos como exatamente o geraremos.  O Gii j√° possui um gerador para o controlador CRUD.  Para um widget CRUD, precisamos criar um novo gerador com base no existente. <br><br>  Alguns links para a documenta√ß√£o antes de iniciar - tamb√©m ser√° √∫til se voc√™ decidir escrever sua pr√≥pria extens√£o: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Extens√£o Yii</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modelo Yii gii</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Yii gii gerador</a> . </li></ul><br>  Obviamente, toda a funcionalidade √© empacotada na extens√£o Yii, que √© instalada atrav√©s do compositor e entra na pasta do fornecedor do seu projeto. <br><br>  A extens√£o consiste em tr√™s partes: <br><br><ol><li>  O <b>diret√≥rio templates / crud que</b> cont√©m o modelo do gerador gii; </li><li>  Arquivo <b>Controller.php</b> - controlador de fachada embutido para chamadas de widget; </li><li>  O arquivo <b>Widget.php</b> √© a classe base para todos os widgets gerados. </li></ol><br><img src="https://habrastorage.org/webt/uh/le/4c/uhle4cnzxzmubqgtoitn3ox5b_u.png"><br><br><h3>  Gii Generator Template </h3><br>  A extens√£o deve gerar c√≥digo; portanto, sua parte central √© o gerador Gii. <br><br>  Inicialmente, assumiu-se que, para implementar a extens√£o, seria suficiente escrever seu pr√≥prio modelo para o gerador CRUD-Controller interno.  A prop√≥sito, √© por isso que o diret√≥rio √© chamado de modelos, n√£o de geradores.  Por√©m, o gerador CRUD-Controller realiza uma valida√ß√£o muito intensiva dos dados de entrada, o que n√£o permitiu implementar muitos requisitos, por exemplo, alterar a classe de heran√ßa.  Portanto, a extens√£o cont√©m um gerador completo e n√£o apenas um modelo. <br><br>  O gerador gii consiste nas seguintes partes (todas est√£o dentro do diret√≥rio templates / crud): <br><br><ul><li>  O diret√≥rio <b>padr√£o</b> √© um modelo em que toda a m√°gica acontece: cada arquivo neste diret√≥rio corresponder√° a um arquivo gerado no seu projeto; </li><li>  Arquivo <b>form.php</b> - como voc√™ pode imaginar pelo nome, este √© um formul√°rio para inserir par√¢metros de gera√ß√£o (nomes de classes, etc.); </li><li>  File <b>Generator.php</b> - uma orquestra de gera√ß√£o que recebe dados do formul√°rio, os valida e depois chama seq√ºencialmente os arquivos de modelo para criar o resultado. </li></ul><br>  Os <b>arquivos</b> <b>Generator.php</b> e <b>form.php</b> cont√™m principalmente altera√ß√µes cosm√©ticas em rela√ß√£o √†s originais do gerador CRUD: nomes de arquivos, valida√ß√£o, descri√ß√µes e textos de avisos, etc. <br><br>  Os arquivos de modelo s√£o respons√°veis ‚Äã‚Äãpela visualiza√ß√£o gerada e pelo pr√≥prio c√≥digo do widget.  Primeiro, o arquivo <b>templates / crud / default / controller.php √©</b> importante, respons√°vel por gerar a classe widget diretamente, que corresponde √† classe controller do gerador original. <br><br>  O widget deve ter as mesmas a√ß√µes que o controlador CRUD, mas elas s√£o geradas de maneira um pouco diferente.  Os exemplos abaixo mostram o resultado da gera√ß√£o com coment√°rios: <br><br><ul><li>  actionIndex - em vez da sa√≠da incondicional de todos os modelos, o m√©todo aceita o par√¢metro $ query; <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($query)</span></span></span><span class="hljs-function"> </span></span>{ $dataProvider = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActiveDataProvider([ <span class="hljs-string"><span class="hljs-string">'query'</span></span> =&gt; $query, ]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'index'</span></span>, [ <span class="hljs-string"><span class="hljs-string">'dataProvider'</span></span> =&gt; $dataProvider, ]); }</code> </pre> </li><li>  actionCreate e actionUpdate - em caso de √™xito, em vez de um redirecionamento, eles simplesmente retornam o c√≥digo de sucesso, o processamento adicional √© fornecido pelo controlador de fachada interno; <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Post(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($model-&gt;load(Yii::$app-&gt;request-&gt;post()) &amp;&amp; $model-&gt;save()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'success'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'create'</span></span>, [ <span class="hljs-string"><span class="hljs-string">'model'</span></span> =&gt; $model, ]); }</code> </pre> <br></li><li>  actionDelete - suporta o m√©todo GET para exibir o widget de exclus√£o (por padr√£o - um bot√£o) e o POST para executar a a√ß√£o;  se for bem-sucedido, ele tamb√©m n√£o executa um redirecionamento, mas retorna um c√≥digo. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionDelete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id)</span></span></span><span class="hljs-function"> </span></span>{ $model = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;findModel($id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Yii::$app-&gt;request-&gt;method == <span class="hljs-string"><span class="hljs-string">'GET'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'delete'</span></span>, [ <span class="hljs-string"><span class="hljs-string">'model'</span></span> =&gt; $model, ]); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $model-&gt;delete(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'success'</span></span>; } }</code> </pre> </li></ul><br>  Por fim, os arquivos de exibi√ß√£o cont√™m as seguintes edi√ß√µes b√°sicas: <br><br><ul><li>  Todos os cabe√ßalhos traduzidos para h2 em vez de h1; </li><li>  Removido o c√≥digo respons√°vel pela exibi√ß√£o do t√≠tulo da p√°gina e pela trilha de navega√ß√£o - o widget n√£o deve afetar essas coisas; </li><li>  A cria√ß√£o e edi√ß√£o de modelos √© feita usando uma janela modal (widget Modal embutido); </li><li>  Adicionado modelo de widget de exclus√£o - com um grande bot√£o vermelho. </li></ul><br><h3>  Classe base do widget </h3><br>  Quando o gerador terminar seu trabalho, ele criar√° uma classe de widget no espa√ßo para nome do aplicativo.  A cadeia de heran√ßa √© assim: os widgets gerados para o aplicativo s√£o herdados do widget de extens√£o base, classe <b>\ ianikanov \ wce \ Widget</b> , que, por sua vez, √© herdado do widget Yii base, classe <b>\ yii \ base \ Widget</b> . <br><br>  A classe base do widget de extens√£o resolve as seguintes tarefas: <br><br><ol><li>  Define dois campos principais: $ action e $ params, atrav√©s dos quais o controle √© transferido para o widget a partir da visualiza√ß√£o de chamada; </li><li>  Define v√°rios par√¢metros padr√£o que podem ser substitu√≠dos na classe gerada, como o caminho para os arquivos de exibi√ß√£o do widget, o nome e o caminho para o controlador de fachada (sobre ele abaixo) e mensagens de erro; </li><li>  Define os par√¢metros padr√£o ao renderizar visualiza√ß√µes: render e renderFile; </li><li>  Fornece uma infraestrutura de eventos semelhante √† infraestrutura do controlador, para que filtros padr√£o como <b>AccessControl</b> e <b>VerbFilter funcionem</b> ; </li><li>  Define um m√©todo de execu√ß√£o que coleta tudo isso junto. </li></ol><br><h3>  Controlador de fachada integrado </h3>  N√£o h√° problemas com a exibi√ß√£o desses dados - os widgets s√£o para esse fim.  Mas para editar, de qualquer maneira, voc√™ precisa de um controlador.  Gere um controlador exclusivo para cada widget - toda a sua ess√™ncia est√° perdida.  O uso de um CRUD padr√£o nem sempre √© relevante, e eu n√£o quero depender do lan√ßamento adicional do gii.  Portanto, a op√ß√£o foi usada com uma fachada de controlador universal integrada. <br><br>  Este controlador √© registrado no mapa do aplicativo atrav√©s do arquivo de configura√ß√£o e cont√©m apenas um m√©todo - actionIndex, que executa as seguintes a√ß√µes: <br><br><ol><li>  Aceita uma solicita√ß√£o de um cliente; </li><li>  Transfere o controle para a classe de widget correspondente; </li><li>  Lida com erros de neg√≥cios como resultado do widget; </li><li>  Redireciona de volta para o aplicativo principal. </li></ol><br>  Talvez seja mais importante indicar o que esse controlador N√ÉO faz: <br><br><ol><li>  Ele n√£o verifica os n√≠veis de acesso - essa l√≥gica pertence a widgets espec√≠ficos; </li><li>  Ele n√£o realiza nenhuma manipula√ß√£o de entrada - os par√¢metros s√£o passados ‚Äã‚Äãpara o widget como est√£o; </li><li>  Ele n√£o manipula a sa√≠da, exceto para verificar um c√≥digo de sucesso predefinido. </li></ol><br>  Essa abordagem permite manter a versatilidade da fachada, deixando a implementa√ß√£o de requisitos de neg√≥cios, incluindo requisitos de seguran√ßa, o c√≥digo do aplicativo. <br><br><h2>  In√≠cio r√°pido </h2>  O desafio do neg√≥cio √© claro, pronto para come√ßar?  O uso da extens√£o tem quatro etapas: <br><br><ol><li>  Instala√ß√£o; </li><li>  Configura√ß√£o; </li><li>  Gera√ß√£o; </li><li>  Aplica√ß√£o. </li></ol><br>  A instala√ß√£o da extens√£o √© feita usando o compositor: <br><br><pre> <code class="bash hljs">php composer.phar require --prefer-dist ianikanov/yii2-wce <span class="hljs-string"><span class="hljs-string">"dev-master"</span></span></code> </pre> <br>  Em seguida, voc√™ precisa fazer v√°rias altera√ß√µes no arquivo de configura√ß√£o do aplicativo. <br><br>  Primeiro, adicione uma refer√™ncia ao gerador gii: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (YII_ENV_DEV) { $config[<span class="hljs-string"><span class="hljs-string">'modules'</span></span>][<span class="hljs-string"><span class="hljs-string">'gii'</span></span>] = [ <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'yii\gii\Module'</span></span>, <span class="hljs-string"><span class="hljs-string">'allowedIPs'</span></span> =&gt; [<span class="hljs-string"><span class="hljs-string">'127.0.0.1'</span></span>, <span class="hljs-string"><span class="hljs-string">'::1'</span></span>, <span class="hljs-string"><span class="hljs-string">'192.168.0.*'</span></span>, <span class="hljs-string"><span class="hljs-string">'192.168.178.20'</span></span>], <span class="hljs-string"><span class="hljs-string">'generators'</span></span> =&gt; [ <span class="hljs-comment"><span class="hljs-comment">//here 'widgetCrud' =&gt; [ 'class' =&gt; '\ianikanov\wce\templates\crud\Generator', 'templates' =&gt; [ 'WCE' =&gt; '@vendor/ianikanov/yii2-wce/templates/crud/default', // template name ], ], ], ]; }</span></span></code> </pre> <br>  Em segundo lugar, adicione o controlador de fachada integrado ao mapa: <br><br><pre> <code class="php hljs">$config = [ ... <span class="hljs-string"><span class="hljs-string">'controllerMap'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'wce-embed'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'\ianikanov\wce\Controller'</span></span>, ], ... ];</code> </pre> <br>  Isso completa a instala√ß√£o e configura√ß√£o. <br><br>  Para gerar um widget: <br><br><ol><li>  Gii aberto; </li><li>  Selecione "CRUD Controller Widget"; </li><li>  Preencha os campos do formul√°rio; </li><li>  Ver e gerar c√≥digo. </li></ol><br>  Al√©m disso, para usar o widget, ele deve ser chamado especificando a√ß√£o e par√¢metros - quase o mesmo que o controlador √© chamado. <br><br>  Widget para visualizar a lista de modelos: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([ <span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'index'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'query'</span></span> =&gt; $otherModel-&gt;getPosts(), ], ]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Widget para visualizar um modelo: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([<span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'view'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span> =&gt; [<span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; $post_id]]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Widget de cria√ß√£o de modelo (bot√£o + formul√°rio envolto em Modal): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([<span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'create'</span></span>]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Widget de altera√ß√£o de modelo (bot√£o + formul√°rio inclu√≠do no Modal): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([<span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'update'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span>=&gt;[<span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; $post_id]]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Widget de remo√ß√£o de modelo (bot√£o): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([<span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'delete'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span>=&gt;[<span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; $post_id]]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  O c√≥digo do widget e todas as visualiza√ß√µes pertencem ao aplicativo e podem ser facilmente alterados - tudo √© exatamente o mesmo que ao gerar o controlador. <br><br><h3>  Sobre suporte e desenvolvimento </h3><br>  Algumas palavras sobre como a expans√£o ser√° suportada e desenvolvida.  Eu tenho o trabalho principal e alguns dos meus projetos ‚Äúparalelos‚Äù (pet-projects).  Portanto, essa extens√£o √© um projeto paralelo dos meus projetos paralelos, portanto, desenvolverei melhorias apenas para as necessidades dos meus projetos. <br><br>  Nas melhores tradi√ß√µes de c√≥digo aberto, o c√≥digo est√° dispon√≠vel no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> , e eu o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">apoiarei</a> em termos de corre√ß√£o de bugs, e tamb√©m tentarei fazer revis√µes oportunas se algu√©m quiser enviar uma solicita√ß√£o de recebimento, para que quem estiver interessado, participe. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt450696/">https://habr.com/ru/post/pt450696/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt450682/index.html">O livro "CSS para profissionais"</a></li>
<li><a href="../pt450684/index.html">Cool Smart Jumps: Revis√£o inteligente da corda de Tangram Smart Rope</a></li>
<li><a href="../pt450686/index.html">Tr√™s outros recursos n√£o √≥bvios do Zimbra Collaboration Suite que ajudar√£o a aumentar a produtividade dos funcion√°rios</a></li>
<li><a href="../pt450692/index.html">Como as empresas usam 7 pecados capitais nas vendas de produtos</a></li>
<li><a href="../pt450694/index.html">Por que Jeff Bezos recomenda falhas de escala e assistindo a fic√ß√£o cient√≠fica</a></li>
<li><a href="../pt450698/index.html">Engrenagens em Box2D</a></li>
<li><a href="../pt450700/index.html">Novamente sobre abstra√ß√µes holey (ou sobre um ambiente imprevis√≠vel)</a></li>
<li><a href="../pt450702/index.html">O lugar √© maldito?</a></li>
<li><a href="../pt450704/index.html">Semana 19 de Seguran√ßa: Vulnerabilidades em c√¢meras IP, rastreadores GPS e monitores sem fio</a></li>
<li><a href="../pt450708/index.html">Python no Visual Studio Code - vers√£o de abril de 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>