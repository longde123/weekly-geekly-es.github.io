<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚ÄçüöÄ üñïüèª ‚úçüèΩ Erste Schritte mit stm32 oder meine Fehler nicht wiederholen ü§Ωüèø üõåüèº üßíüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eine kurze Geschichte √ºber den Rechen, der beim Erkennen von ARM am Beispiel von stm32f103c8t6 und stm32l151rct6 aufgetreten ist. 


 Meine Bekanntsch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erste Schritte mit stm32 oder meine Fehler nicht wiederholen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456280/"><p><img src="https://habrastorage.org/getpro/habr/post_images/7af/bf8/34a/7afbf834aacfe9204173342ee1d2787c.jpg" alt="Bild"></p><br><p>  Eine kurze Geschichte √ºber den Rechen, der beim Erkennen von ARM am Beispiel von stm32f103c8t6 und stm32l151rct6 aufgetreten ist. </p><a name="habracut"></a><br><p>  Meine Bekanntschaft mit Mikrocontrollern begann mit AVR.  Ich habe einige Zeit daran gearbeitet und bin von den Boards mit zerkratzten Tracks und Assembler in AtmelStudio4 zu normalen Beute- und selbstgeschriebenen Makefiles f√ºr die Arbeit im Editor (in meinem Fall KWrite) und der Befehlszeile √ºbergegangen. </p><br><p>  Aber es ist Zeit, einen Stock in ihre √§lteren Br√ºder zu stecken - ARM.  Die Wahl einer bestimmten Familie war lang und passiv (weil es keinen direkten Bedarf gab, also hatte ich es nicht eilig), aber am Ende landete sie auf stm32f1, da es vielleicht die beliebteste war.  Kaufen Sie einen Programmierer, ein Debug-Board wie Discovery oder eine blaue Pille?  Was bist du, ich bin ein Meister in AVR-Cams!  Jedes Board kann ohne zu viel Bodykit als LUT und sogar nach Bedarf hergestellt werden.  Deshalb kaufe ich mir einen nackten stm32f103c8t6 und beginne mit der Spur des Boards zu schamanisieren.  Was brauche ich?  Es sollten mindestens zwei Ports zu den K√§mmen gebracht werden. Hoppla, es ist unpraktisch, die Ports vollst√§ndig anzuzeigen.  Na ja, ich bekomme jeweils 8 Beine - vom Hafen A die j√ºngeren (0-7), vom B die √§lteren (8-15).  Trotzdem nat√ºrlich LEDs und Tasten, wie ohne Anzeige und Steuerung.  Was mich an den fertigen Debug-Boards √ºberrascht, ist das Fehlen von mindestens 2-3 LEDs und 1-2 Tasten, die mit nichts in Konflikt stehen w√ºrden.  Wie stellen sie sich das Debuggen vor?  Unter den Tasten PA8 werden PA9 selbst gefragt, sie befinden sich g√ºnstig.  USB, Jumper BOOT0, BOOT1 und ein Batterieanschluss f√ºr Uhren sind ebenfalls n√ºtzlich.  Und Anschl√ºsse f√ºr Quarz, so dass es sehr sch√∂n ist (ich habe die Anschl√ºsse f√ºr Quarz danach nie mehr verwendet).  F√ºr die Stromversorgung ben√∂tigt der Controller nicht mehr als 3,6 V und mit USB kommen 5 V. Es ist erforderlich, einen Stabilisator zu installieren.  Ich habe viel gelesen, wie Leute Stabilisatoren mit geringem Spannungsabfall w√§hlen ... warum?  Der Unterschied betr√§gt eineinhalb Volt, aber es gibt genug Eiche 78l33.  Und jetzt der JTAG-Anschluss.  Der Programmieranschluss von Atmel hatte einen Standard-ISP10 oder ISP6.  Wahrscheinlich ist JTAG auch eine Standardsache.  Es stellt sich ja heraus ... aber nur f√ºr einen einzelnen Hersteller oder sogar ein Ger√§t.  Wir schauen uns den Stecker auf st-link an: sch√∂n, 10-polig.  Wir schauen uns einen Programmierer f√ºr AVR an: oops, schon 20-polig.  Wir schauen woanders hin: mehr inkompatible Konnektoren zum Gott der inkompatiblen Standards.  Wenn ja, werden wir unsere eigenen erfinden.  Wenn √ºberhaupt, ist der Adapter zwischen ihnen nicht komplizierter als der Adapter von ISP-6 auf ISP-10.  Alles scheint fertig zu sein, Sie k√∂nnen eine Geb√ºhr erheben.  Wie sich herausstellte, ist ein Abstand von 0,5 mm f√ºr Amateure durchaus erreichbar, ich musste nicht einmal mit einem Marker malen. </p><br><p>  Nun, wie man es blinkt.  Da es USB gibt, kann es wahrscheinlich durch.  Ich habe das Datenblatt gelesen - ja, es kann nicht √ºber USB, aber √ºber UART1.  Hoppla, ich habe vergessen, es zur√ºckzuziehen.  Dar√ºber hinaus widerspricht es auch der Schaltfl√§che, die an PA9 h√§ngt.  Okay, ich werde es bei Postings ausgeben, aber es gibt noch eine weitere Schaltfl√§che.  Ein bisschen Schamanismus und das Board ist fertig und sogar in stm32flash definiert. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/180/277/876/180277876d736da44658abbce5e5d426.jpg" alt="Bild"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/4d8/341/8a5/4d83418a5f8bb271a41aefa94fd5d42c.jpg" alt="Bild"></p><br><p>  Es scheint mit Eisen aussortiert zu sein, es ist Zeit, mit dem Code fortzufahren.  Nachdem ich mehrere Artikel im Internet gelesen hatte, fand ich unter gcc-arm-none-eabi ein fertiges Archiv.  Ich werde sp√§ter genau herausfinden, wie die Montagereihenfolge eingestellt wird.  Bisher mache ich Hallo-Welten mit Tasten und LEDs.  Da dies meine erste Bekanntschaft mit dieser Familie ist, sind keine Wrapper wie HAL nur manuelle Arbeit mit Registern.  Dies ist jedoch ein v√∂llig nat√ºrlicher Ansatz, den ich nicht erw√§hnen kann.  Es nervt mich die ganze Zeit ein bisschen, die Kraft und BOOT0 auf das Board zu ziehen, aber na ja, eines Tages werde ich einen JTAG-Programmierer machen.  Seltsamerweise bin ich bei ausgeschalteter Uhr nicht auf den Rechen getreten.  Er erinnerte sich an seine Jugend, als er 3D-Verarbeitung auf TurboPascal schrieb.  Hier habe ich ein Display auf ili9341 von Himbeer-Pi und einen Controller mit bis zu 72 MHz.  Genau das ist passiert - bis zu 200 Punkte pro Modell und 11 fps.  Nat√ºrlich werden alle Transformationsmatrizen in Festkommazahlen gez√§hlt. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/D9KuP8Q5qTM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Irgendwann wollte ich ein tragbares Ger√§t herstellen, das lange Zeit im Akkubetrieb funktioniert.  Ich habe mir das Datenblatt angesehen und war ver√§rgert: Der ber√ºhmte ARM im Verbrauch ist um ein Vielfaches schlechter als der gleiche AVR-ok!  Wenn der letztere (gestochen am ersten Controller, der sich als ATmega88p herausstellte) unter Ber√ºcksichtigung der Stunden einen Verbrauch von 0,8 ŒºA hatte, dann hatte der erste selbst im wirtschaftlichsten Schlafmodus * 25 ŒºA ¬± 1,4 ŒºA bei RTC.  Das ist nicht gut.  Stm32f103 ist jedoch nicht als wirtschaftliche Serie positioniert.  Ich schaue auf der STmicroelectronics-Website nach anderen Steuerungsserien und w√§hle die Serie stm32l1 aus: Zus√§tzlich zum Verbrauch von etwa 1 ŒºA gibt es auch einen kapazitiven Sensor und einen LCD-Controller.  Die maximale Frequenz ist zwar niedriger, nur 36 MHz (oder 24 MHz, wenn USB verwendet wird), aber ich werde es irgendwie √ºberleben.  Es wurde entschieden: Ich nehme ein paar stm32l151rct6 direkt aus 32 KB RAM (es gibt auch 256 KB Flash, aber ich kann mir kaum vorstellen, wie es geh√§mmert werden kann. Es sei denn mit absolut wilder Schei√üe oder Datendateien). </p><br><ul><li>  <em>) Verwechseln Sie die Schlafmodi (Schlaf, Stopp) nicht mit dem Herunterfahren (Standby).</em> </li></ul><br><p>  Parallel dazu mache ich den st-link v2-Programmierer aus dem Ersatz-stm32f103, einfach weil ich es leid bin, mit BOOT0 und Strom zu spielen, und es ist schneller.  Ich werde jedoch die UART-Programmierung verlassen - Sie wissen nie was.  Es gab auch ein bisschen Schamanismus, aber nichts Besonderes.  Es sei denn, die Befehlszeile f√ºr openocd zu finden, stellte sich als Problem heraus.  F√ºr zuk√ºnftige Generationen werde ich sie verlassen: </p><br><pre><code class="plaintext hljs">openocd -f interface/stlink-v2.cfg -f target/stm32f1x.cfg -c "init" -c "reset halt" -c "flash write_image erase "$(firmware).bin" 0x08000000" -c "reset run" -c "exit"</code> </pre> <br><p>  F√ºr stm32l151 ist es nat√ºrlich notwendig, das Ziel auf "target / stm32l1.cfg" zu korrigieren. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/4e7/20b/8b2/4e720b8b2a7c604796d911ac8c989f2f.jpg" alt="Bild"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/6ec/f47/a66/6ecf47a661552fd60fd9fae056b1828c.jpg" alt="Bild"></p><br><p>  Ich werde in der Chronologie ein wenig voraus sein, aber nicht zur√ºckkommen.  Meine Herren, sparen Sie nicht an der Dicke der Leiterplatte!  Oder f√ºgen Sie zumindest Requisiten hinzu oder verwenden Sie keine smd-Komponenten.  Es kam vor, dass ich auf der Programmierplatine nur zwei Befestigungsl√∂cher an zuf√§lligen Stellen vorsah.  Und die Orte waren ziemlich weit vom JTAG-Anschluss entfernt.  Und nach einiger Zeit bemerkte ich, dass der Programmierer instabil ist.  Das funktioniert, dann nein, dann m√ºssen Sie √ºber UART das "Opfer" l√∂schen und es dann aufheben.  Es stellte sich heraus, dass der Widerstand, der vom Controller-Ausgang zum Stecker kam, brach.  Er fiel einfach vom Kontaktfeld vom K√∂rper.  Ich habe den Widerstand gel√∂tet.  Dann l√∂te er den Rest.  Dann erkannte er, dass selbst diese kleine Verformung der Platine, die beim Herausziehen des Kabels auftrat, f√ºr die ungl√ºcklichen Komponenten ausreichte.  Infolgedessen habe ich ein Backup direkt neben den Anschluss geklebt.  W√§hrend Sie halten. </p><br><p>  Wie der Leser bereits vermutet hat, befindet sich die Programmierung auch in einem Texteditor, w√§hrend sich Kompilierung und Firmware in der Konsole befinden.  Der Kauf eines Debugging-Boards f√ºr l151 hat mich nat√ºrlich nicht mehr inspiriert als jede andere IDE.  Ich reibe die Spuren des Rechens, den das erste Board hinterlassen hat, und z√ºchte das zweite (wobei der Programmierer als drittes gez√§hlt wird, aber es ist immer noch kein Debug-Board).  Da ich ein energieeffizientes Ger√§t debuggen wollte, muss ich mich um die Stromversorgung k√ºmmern.  Ich werde den 78l33-Stabilisator nicht √§ndern, aber ich habe seinen Ausgang mit einem Jumper zerrissen, damit ich ihn mit einem Amperemeter stechen kann (ich hoffe trotzdem f√ºr ein Mikroammeter, aber da geht es).  Lassen Sie die K√§mme die gleichen sein wie auf der vorherigen Platine - Kompatibilit√§t!  Nat√ºrlich ein paar LEDs und Tasten.  Der Rechen mit UART1 leuchtet einladend, aber ich stecke immer noch seinen Stecker und bekomme ihn nicht auf die Stirn.  Nat√ºrlich habe ich bereits JTAG, aber die Versicherung wird nicht schaden.  Genau wie beim vorherigen (und auch beim Programmierboard) war es m√∂glich, auf einer Seite zu trennen, auch wenn es nicht zu viele Jumper gibt. </p><br><p>  Als der Controller versiegelt wurde, trat ein Problem auf.  Ich glaubte irgendwie naiv, dass es einen Schl√ºssel am K√∂rper der Mikroschaltung geben sollte, der das erste Bein anzeigt.  Wer von ST erwartet, dass es gut gemacht wird, wird ZWEI Schl√ºssel symmetrisch herstellen.  Also, auf welcher Seite soll es jetzt gel√∂tet werden?  Als ich nachdachte, entschied ich, dass dies keine Schl√ºssel waren, sondern technologische Vertiefungen.  Man wei√ü nie, wie man zum Beispiel den Chip in der Herstellung positioniert.  Oder dr√ºcken Sie auf die Basis, um sie mit Kunststoff zu f√ºllen.  Dann m√ºssen Sie durch die Inschrift navigieren.  Es ist logisch, dass die Inschrift lesbar sein sollte, wenn der Mikrokreis ‚Äûnormal‚Äú positioniert ist, dh wenn sich das erste Bein in der oberen linken Ecke befindet.  Also fing er an zu l√∂ten.  Entweder ein LUT-Defekt oder krumme H√§nde, aber der Mikrokreis war schief gel√∂tet. Ich bemerkte es rechtzeitig, bevor ich ihn vollst√§ndig verl√∂tete.  Es spielt keine Rolle, es gibt eine alte Art, Tausendf√º√üler mit einer Rasierklinge zu l√∂ten: Sie wird nicht durch L√∂ten benetzt und ist d√ºnn genug, um sich nicht zu stark zu verbiegen.  Es stellte sich heraus, dass die H√§nde immer noch nicht gerade genug sind, weil die Beine gebeugt sind.  Aber nicht oben, sondern seitw√§rts, zumindest nicht sehr gut, und sie haben es irgendwie geschafft, sie zu begradigen.  Der zweite L√∂tversuch war bereits unter dem Mikroskop, aber vorher habe ich beschlossen, die Beine zu korrigieren.  Und einer von ihnen brach ab.  Woraus bestehen sie, dass man sich nicht einmal biegen kann?  Die Ausgabekomponenten haben kein solches Problem.  Nun, das ist es, ich denke, der Chip in der Ehe muss einen anderen l√∂ten.  Aber pl√∂tzlich ist das kein kritisches Bein mehr?  Nun, eine allgemeine Schlussfolgerung oder eine der Mahlzeiten.  Bisher habe ich ohne versiegelt, und dort wird es zu sehen sein.  Diesmal gelang es mir, gleichm√§√üig zu l√∂ten, obwohl das Bein auf I2C kam, mit dem ich Spa√ü haben wollte, aber zumindest nicht auf wichtigen Anschl√ºssen wie USB, JTAG, UART oder BOOT.  Ich schlie√üe es an - es funktioniert nicht, die Programmierer sehen die Karte nicht.  Seit einiger Zeit der Schamane mit L√∂tbeinen, aber es hilft nicht.  Ein Blick auf das Datenblatt st√∂√üt auf ein Bild des Controllers, das sich irgendwo im Keller des Dokuments befindet.  So k√∂nnten Sie auf die Inschrift BOKOM kommen ?!  Das hei√üt, wenn Sie den Controller so drehen, dass die Inschrift gelesen wird, befindet sich das erste Bein in der unteren linken Ecke.  Dabei stellte sich heraus, dass eine der "technologischen Aussparungen" immer noch der Schl√ºssel ist.  Es stimmt, es erkl√§rt nicht, wie man es von symmetrisch unterscheidet ... Nun, zumindest ein Hinweis.  Ich l√∂te den Controller mit einem Geb√§udef√∂n, um die Schlussfolgerungen nicht zu brechen, und diesmal l√∂te ich ihn seitw√§rts.  Der fehlerhafte Ausgang geht genau zum TX-Ausgang von UART1, dh zum Programmier- und Debugging-Anschluss.  Das ist v√∂llig schlecht, aber bevor Sie den Controller wechseln, m√ºssen Sie zumindest sicherstellen, dass Sie bei der Ausrichtung, die ich vermutet habe, beim L√∂ten nicht mit einer falschen Verbindung t√∂ten.  Ich schlie√üe den Programmierer an - es funktioniert.  Hurra.  Es sind noch kleine Dinge √ºbrig - L√∂ten Sie die Steckverbinder, Dioden und anderen Kabelb√§ume.  Die Kommentare schlugen einen anderen Weg vor - Ring the Earth: Sie sind normalerweise im Inneren des Geh√§uses verbunden und nicht vollst√§ndig symmetrisch angeordnet.  In Anbetracht des Schrittes der Schlussfolgerungen kann es schwierig sein, zu den richtigen Schlussfolgerungen zu gelangen.  Wie dem auch sei, dies ist der zuverl√§ssigste Weg. </p><br><p>  Ich m√∂chte nicht ohne UART1 mit dem Controller arbeiten, und es ist noch schlimmer als jetzt.  Und wenn doch, ist es egal, sich zu √§ndern, also entscheide ich mich, einen Chirurgen zu spielen und den Controller zu einer Beinprothese aus den Haaren von MGTF zu machen.  Zur Hand liegt ein guter elektrisch leitender Kleber, mit dem das Haar entscheidend an der Plattform des Chipk√∂rpers haftet.  Der Kleber, der auf benachbarte Beine gelangt ist, wird mit einem Skalpell r√ºcksichtslos entfernt.  Und was m√∂chten Sie in die halbe Millimeter-Plattform und nicht in die angrenzenden hervorstehenden Beine gelangen?  Ich √ºberpr√ºfe - es funktioniert.  Gie√üen Sie Cyanacrylat ein, bis es abf√§llt und um sp√§ter nicht abzufallen. </p><br><p>  Vielleicht h√§tte ich dieses Board so benutzt, wenn das Bein nicht wieder heruntergefallen w√§re.  Und es ist mit Klebstoff bedeckt.  Es ist jedoch ziemlich weich und wird mit einem Skalpell geschnitten, sodass es erfolgreich gereinigt wird.  Aber aus irgendeinem Grund m√∂chte ich nicht zum zweiten Mal denselben elektrisch leitenden Klebstoff verwenden.  Ich werde versuchen, das Bein zu l√∂ten.  Die √ºbliche Spitze des L√∂tkolbens kroch nicht hinein, aber der Kegel war im Kit enthalten (tats√§chlich war der Kegel urspr√ºnglich der einzige, aber aufgrund seiner offensichtlichen Unannehmlichkeiten wurde er durch den √ºblichen mit einem keilf√∂rmigen Sch√§rfen ersetzt), der sich vollst√§ndig hineinschleicht.  Seltsamerweise war die ‚ÄûTransplantation‚Äú erfolgreich und das Bein funktionierte wie es sollte (eine Nahaufnahme des Beins auf KDPV). </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/db2/03e/a69/db203ea69ff912c7d012e3f39ab94c17.jpg" alt="Bild"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/6ec/f47/a66/6ecf47a661552fd60fd9fae056b1828c.jpg" alt="Bild"></p><br><p>  Also, das B√ºgeleisen ist fertig, es ist Zeit, zum Code zu gehen.  Es w√§re sch√∂n, ein fertiges Beispiel unter gcc und der CMSIS-Bibliothek zu finden.  Was ist daf√ºr besser als die offizielle Website des Herstellers?  Wie sich herausstellte, teilt STmicroelectronics meinen Optimismus nicht.  Die Tatsache, dass die Navigation auf der Site √ºber einen unanst√§ndigen Ort erfolgt, ist bereits bekannt. Es ist jetzt schwierig, eine Site zu finden, die von Menschen f√ºr Menschen erstellt wurde.  Aber sie erlauben nichts von der Seite herunterzuladen!  Vielleicht w√ºrden sie es nach der Registrierung zulassen, aber vorher hatte ich nicht den Wunsch, mich irgendwo zu registrieren, und nach einer solchen Einstellung gegen√ºber Entwicklern noch mehr.  Warum zum Teufel brauchst du meine Post oder was verlangst du dort?  Pers√∂nliche Daten sammeln, Spam senden?  Gehen Sie durch den Wald, und ich werde es gemeinfrei finden!  √úbrigens war ich ein wenig √ºberrascht, dass sich das entsprechende Paket nicht im Repository befand, aber vielleicht hat ST eine Art lizenzierte H√§morrhoiden entwickelt.  Daher sende ich die Durchfallstrahlen an Vermarkter, die sich eine solche Richtlinie ausgedacht haben, und auch f√ºr eine unbequeme Website. </p><br><p>  Wie dem auch sei, die Bibliothek wurde perfekt im Internet gefunden (ich gebe keine Links, Sie wissen nie, was mit der Website passieren wird).  Eine Alternative besteht darin, die Entwicklungsumgebung oder CubeMX herunterzuladen, in die diese Bibliotheken eingebettet sind.  Das Herunterladen von der offiziellen Website ist zwar genauso unm√∂glich, daher schauen wir uns die von Drittanbietern an und installieren sie auf einer virtuellen Maschine, nur f√ºr den Fall, dass "wenn etwas passiert". </p><br><p>  Wir haben das Eisen und auch die Sorten herausgefunden.  Es ist Zeit, sich endlich mit dem Controller zu befassen.  Die erste √úberraschung war das Warten, als versucht wurde, Code von Drittanbietern unter Discovery zu verwenden.  Sie verwendeten den stm32l152-Controller, der auf den ersten Blick fast dem von mir installierten stm32l151 entspricht.  Neben geringf√ºgigen Unterschieden stellte sich heraus, dass das LCD-Modul nicht im "my" -Controller installiert war.  Ein wenig entt√§uschend, aber ich hatte immer noch nicht vor, es zu benutzen.  Obwohl ein solcher Unterschied deutlicher h√§tte unterschieden werden k√∂nnen als eine Fu√ünote im Datenblatt.  √úbrigens wird in einem Datenblatt in diesem Fall empfohlen, den VLCD-Pin an die Stromversorgung anzuschlie√üen. Auf meinem Foto ist der entsprechende 0-Ohm-Widerstand nicht verl√∂tet, aber in Wirklichkeit habe ich ihn trotzdem installiert.  Ohne es funktioniert es auch, aber √ºberlasten Sie nicht die internen Verbindungen.  Interessanter war das Verhalten der Echtzeituhr.  Sie wollten hartn√§ckig nicht arbeiten, und im Internet schreiben sie einfach "mach es, mach es, es funktioniert".  Aber es funktioniert nicht.  An einigen Stellen wurden jedoch "bekannte Probleme mit RTC in dieser Serie" erw√§hnt.  Wie dem auch sei, die Uhr ist immer noch aufgezogen, allerdings nur am eingebauten RC-Generator.  Versuche, Uhrquarz zu sperren, f√ºhrten zu endlosem Warten auf das LSE-Bereitschaftsbit.  Ich versuchte zu √ºberpr√ºfen, ob die Beine des Mikroschaltkreises von den Schienen auf dem Board gefallen waren, und zog sie im normalen GPIO-Modus.  Hochfrequenzquarz fiel ab.  WTF ?!  Im Allgemeinen wollen diese beiden Quarze nicht zusammenarbeiten, aber zumindest getrennt funktionieren sie zumindest. </p><br><p>  Und dann habe ich geraten: Sekundenkleber, der mit der H√§lfte des Controllers gef√ºllt war (es ist fl√ºssig, man kann es nicht genau auftragen, und wer h√§tte gedacht ...), gibt ein Leck und Quarz st√∂rt ihre Spitzen.  Nun, es ist nicht schwer, den Kleber von au√üen abzukratzen, aber schlie√ülich ist er sogar unter der Unterseite des Chips taub.  Und wenn gen√ºgend Lecks f√ºr Quarz vorhanden sind, wirkt sich dies auf den Verbrauch aus.  Ich suche in Google, als Leute Cyanacrylat entfernen.  Es bietet warmes Wasser (was ???) und Dimethylsulfoxid.  Ich glaube nicht an warmes Wasser, deshalb kaufe ich DMSO.  Nachdem ich mehr als eine Stunde lang einen Tropfen Chemikalie auf der Oberfl√§che des Klebers gefunden hatte, bemerkte ich den Unterschied nicht.  Aber sie bemerkten Quarz und begannen mehr oder weniger normal zu arbeiten (ich frage mich, warum? Dimexid ersetzte die vom Kleber absorbierte Feuchtigkeit?).  Dies hat mich jedoch nicht √ºberzeugt, und die Leimreste sind immer noch ein Dorn im Auge ... f√ºr nichts, das sich auf der Unterseite der Platte befindet und nicht besonders sichtbar ist.  Das warme Wasser, das ich mit Dimexid abgewaschen habe, hatte √ºbrigens keinen Einfluss auf den Kleber (ich bin nicht √ºberrascht).  Ich entdeckte, dass es so etwas wie einen Leimentferner in derselben Tube wie der Kleber selbst gibt, nur in lila.  Zumindest sollte es funktionieren!  Wie sich herausstellte, kann und funktioniert es, aber seine Konsistenz √§hnelt saurer Sahne und passt einfach nicht unter den Mikrokreislauf.  Was n√ºtzt es dir, Radiergummi ?!  Drau√üen kann ich es reinigen.  Letzte Chance: Aceton wird selten erw√§hnt.  Ich habe ein wenig Angst um die Kunststoffteile, aber es ist einfach, sie auszutauschen.  Ich gie√üe Aceton in ein Glas, werfe dort ein Brett und lasse es √ºber Nacht.  Am n√§chsten Morgen stellte sich heraus, dass Aceton wirklich funktioniert und wie!  Es gab keine Spur von Leim.  Au√üerdem l√∂ste sich der Dr√ºcker eines der Kn√∂pfe auf.  Interessanterweise bestand das zweite √úberleben wahrscheinlich aus stabilerem Kunststoff.  Ich war ein wenig √ºberrascht, dass der andere Kunststoff unber√ºhrt blieb, sogar die Inschriften blieben erhalten.  Gut, ausgezeichnet, aber der Knopf kann ersetzt werden. </p><br><p>  Jetzt ist es uns gelungen, RTC vom Uhrenquarz aus zu starten, den Ruhemodus zu ber√ºhren und mit anderen Peripherieger√§ten zu kommunizieren.  Und auch, damit es v√∂llig fengscheu war, brachte er Unterschriften an der Tafel an.  Aber nicht mit einem Marker (pl√∂tzlich wieder in L√∂sungsmitteln baden?) Sondern mit einem Skalpell zerkratzt.  Seit Jahrhunderten! </p><br><p>  Nun, f√ºr zuk√ºnftige Generationen werde ich Codebeispiele f√ºr beide Controller sowie Bibliotheken, Makefiles und mehr hinterlassen.  Es bleibt nur zu installieren gcc-arm-none-eabi, openocd, stm32flash und andere Kleinigkeiten. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">stm32f103</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">stm32l151</a> </p><br><p>  In den Kommentaren wurde ihnen mehrmals geraten, keine LUT durchzuf√ºhren und die Herstellung von Platten bei Fachleuten zu bestellen.  F√ºr das Prototyping wie hier sehe ich keinen Grund.  Eine andere Sache ist, wenn Sie ein mehrschichtiges Board oder einen noch kleineren Schritt oder ein BGA-Geh√§use oder etwas anderes ben√∂tigen, das zu Hause schwierig zu tun ist.  Und nat√ºrlich bei der Herstellung der endg√ºltigen Version des Ger√§ts und der Replikation.  Es ist nicht gut, wenn der Kunde den Fall zerlegt <del>  aus Leiterplatte gel√∂tet, </del>  und es wird ein schiefes abges√§gtes Brett ohne Maske und mit Jumpern von MGTF herausfinden. </p><br><p>  Schlussfolgerungen: </p><br><ol><li>  Sie k√∂nnen Debugging-Boards f√ºr sich selbst erstellen, wenn Sie dies w√ºnschen. Sie sind nicht schlechter als gekaufte.  Aber der Debugger-Programmierer ist immer noch besser zu kaufen, wenn er nicht zu teuer ist.  Nat√ºrlich k√∂nnen Sie es schaffen, aber Sie werden das Schema nicht √§ndern, und wenn ja, wird es nicht besser sein als der Kauf.  Wahrscheinlich auch billiger.  Es sei denn, der √ºberfl√ºssige Controller bleibt oder hat ein Lieferproblem. </li><li>  Vergessen Sie nicht den Backup-Programmieranschluss UART1, gleichzeitig die Jumper BOOT0, BOOT1.  Zus√§tzlich zur eigentlichen Programmierung ist es sehr praktisch, ein Programm mit UART zu debuggen. </li><li>  Das LQFP64-Geh√§use verf√ºgt √ºber zwei Schl√ºssel, von denen einer gef√§lscht ist.  Sie m√ºssen zur Inschrift navigieren, damit Sie mit den F√º√üen nach links schauen. </li><li>  Das L√∂ten von Bauteilen mit einem kleinen Schritt erfolgt nur unter dem Mikroskop.  Ansonsten ist es schwierig festzustellen, ob alles verschwunden ist und ob es "Rotz" gibt.  Nun, entweder auf "professionellen" Ger√§ten wie einem speziellen Haartrockner, L√∂tpaste usw.  Ich wei√ü es hier nicht, ich schreibe √ºber Amateurtechnologie. </li><li>  Sparen Sie nicht an der Leiterplattendicke.  Es verbiegt sich und dies kann ausreichen, um smd-Widerst√§nde und wahrscheinlich Kondensatoren zu besch√§digen.  Dies ist f√ºr den Ausgang nicht be√§ngstigend, und Komponenten mit verbogenen Schlussfolgerungen (Transistoren, Mikroschaltungen) werden wahrscheinlich √ºberleben. </li><li>  Die Herstellung von Steckverbindern f√ºr Quarz ist Zeitverschwendung.  Sie werden sie nicht √§ndern, also einfach auf die Platine l√∂ten. </li><li>  Das Trinken eines Tausendf√º√ülers mit einer Rasierklinge ist nur im extremsten Fall, wenn kein Haartrockner vorhanden ist.  Andernfalls ist das Risiko einer Besch√§digung zu gro√ü. </li><li>  Selbst wenn das Bein vom Mikrokreis gefallen ist, kann es wiederhergestellt werden!  Auch wenn der Abstand 0,5 mm betr√§gt.  Die Hauptsache ist, L√∂tmittel zu verwenden, keinen leitf√§higen Kleber. </li><li>  F√ºllen Sie den Chip niemals mit Cyanacrylatkleber (Superkleber)!  Er hat nicht die richtigen elektrischen und tats√§chlich mechanischen Eigenschaften. </li><li>  Aceton eignet sich am besten zum Entfernen von Sekundenkleber aus schwer zug√§nglichen Bereichen.  Es l√∂st sich vollst√§ndig auf.  Die Hauptsache ist, sicherzustellen, dass die umgebenden Komponenten nicht betroffen sind.  Von nicht schwer zug√§nglichen Stellen kann mechanisch entfernt werden. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456280/">https://habr.com/ru/post/de456280/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456266/index.html">Die Zusammenfassung interessanter Materialien f√ºr den mobilen Entwickler # 302 (vom 10. bis 16. Juni)</a></li>
<li><a href="../de456270/index.html">Redis Stream - Zuverl√§ssigkeit und Skalierbarkeit Ihrer Messaging-Systeme</a></li>
<li><a href="../de456272/index.html">Was ist Android Lint und wie k√∂nnen Sie unterst√ºtzten Code schreiben?</a></li>
<li><a href="../de456274/index.html">Psychologen: Sexroboter f√ºhren zu einer Zunahme der Anzahl von Menschen ohne ein Paar, die keine Beziehung zu anderen Menschen ben√∂tigen</a></li>
<li><a href="../de456276/index.html">Was sind Informationen?</a></li>
<li><a href="../de456282/index.html">Mehrdimensionale Grafiken in Python - von dreidimensional bis sechsdimensional</a></li>
<li><a href="../de456288/index.html">MAM: Frontend-Montage ohne Schmerzen</a></li>
<li><a href="../de456290/index.html">Telegramm Unbegrenztes Netzwerklaufwerk. Kostenlos</a></li>
<li><a href="../de456294/index.html">Unterschiede zwischen LabelEncoder und OneHotEncoder in SciKit Learn</a></li>
<li><a href="../de456296/index.html">Die Welt der dreidimensionalen Hypersph√§re. Geod√§tische Strahlverfolgung in einem geschlossenen Universum mit sph√§rischer Geometrie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>