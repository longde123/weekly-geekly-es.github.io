<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏲️ 🤗 🍑 创建您的第一个ARCore应用程序 ♒️ 🤞🏿 ✊🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在上一篇文章中，我已经解释了ARCore是什么以及它如何帮助开发人员在无需了解数学和OpenGL的情况下创建惊人的增强现实应用程序。 


 如果您还没有阅读它，我强烈建议您继续阅读本文，然后开始开发ARCore应用程序。 
 开始使用 


要开始开发ARCore应用程序，您首先需要向项目添加AR...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>创建您的第一个ARCore应用程序</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438178/"><p><img src="https://habrastorage.org/getpro/habr/post_images/cd8/f22/342/cd8f2234275cbc67a7956d0eb233e1ec.jpg" alt="创建您的第一个ARCore应用程序"></p><br><p> 在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">上一篇文章中，</a>我已经解释了ARCore是什么以及它如何帮助开发人员在无需了解数学和OpenGL的情况下创建惊人的增强现实应用程序。 </p><br><p> 如果您还没有阅读它，我强烈建议您继续阅读本文，然后开始开发ARCore应用程序。 </p><a name="habracut"></a><br><h2 id="nachalo-raboty"> 开始使用 </h2><br><p>要开始开发ARCore应用程序，您首先需要向项目添加ARCore支持。 这非常简单，因为我们将使用Android Studio和Sceneform SDK。  Sceneform自动执行两个主要操作： </p><br><ol><li> 检查ARCore。 </li><li> 请求使用相机的权限。 </li></ol><br><p> 使用Sceneform SDK创建ARCore应用程序时，您无需担心这两个步骤。 您只需要将Sceneform SDK添加到您的项目中即可。 </p><br><p> 使用一个空的Activity创建一个新的Android Studio项目。 </p><br><p>将以下依赖项添加到项目级别的<code>build.gradle</code>文件中： </p><br><pre> <code class="plaintext hljs">dependencies { classpath 'com.google.ar.sceneform:plugin:1.5.0' }</code> </pre> <br><p> 并将此依赖项添加到应用程序级别的<code>build.gradle</code>文件中： </p><br><pre> <code class="plaintext hljs">implementation "com.google.ar.sceneform.ux:sceneform-ux:1.5.0"</code> </pre> <br><p> 现在，将项目与Gradle文件同步，并等待构建完成。 因此，用于Android Studio的Sceneform SDK和Sceneform插件将添加到项目中。 这将允许您查看<code>.sfb</code> ，这些<code>.sfb</code>是将在相机中渲染的3D模型，还可以帮助您导入，查看和创建3D资源。 </p><br><h2 id="sozdanie-vashego-pervogo-arcore-prilozheniya"> 创建您的第一个ARCore应用程序 </h2><br><p> 现在，Android Studio设置已完成，并且已经安装了Sceneform SDK，我们可以开始创建第一个ARCore应用程序了。 </p><br><p> 首先，我们需要在场景中添加一个Sceneform片段。 这就是我们所有3D模型将被放置的所谓<strong>场景</strong> 。 该片段将负责初始化摄像机并自行处理权限。 </p><br><p> 转到主布局文件。 就我而言，这是<code>activity_main.xml</code>文件。 并在其中添加Sceneform片段： </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FrameLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:context</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fragment</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.ar.sceneform.ux.ArFragment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/ux_fragment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FrameLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> 我设置<code>match_parent</code>的宽度和高度，以使场景全屏显示。 您可以根据需要选择尺寸。 </p><br><h2 id="proverka-sovmestimosti"> 兼容性检查 </h2><br><p> 这是您在布局文件中需要做的所有事情。 现在我们传递给Activity，在我的例子中是<code>MainActivity</code> 。 向活动添加方法： </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkIsSupportedDeviceOrFinish</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Activity activity)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.N) { Log.e(TAG, <span class="hljs-string"><span class="hljs-string">"Sceneform requires Android N or later"</span></span>); Toast.makeText(activity, <span class="hljs-string"><span class="hljs-string">"Sceneform requires Android N or later"</span></span>, Toast.LENGTH_LONG).show(); activity.finish(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } String openGlVersionString = ((ActivityManager) activity.getSystemService(Context.ACTIVITY_SERVICE)) .getDeviceConfigurationInfo() .getGlEsVersion(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Double.parseDouble(openGlVersionString) &lt; MIN_OPENGL_VERSION) { Log.e(TAG, <span class="hljs-string"><span class="hljs-string">"Sceneform requires OpenGL ES 3.0 later"</span></span>); Toast.makeText(activity, <span class="hljs-string"><span class="hljs-string">"Sceneform requires OpenGL ES 3.0 or later"</span></span>, Toast.LENGTH_LONG) .show(); activity.finish(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> <br><p> 此方法检查您的设备是否支持Sceneform SDK。 该SDK需要Android API级别27或更高以及OpenGL ES 3.0或更高版本。 如果设备不支持这两个参数，则将不会加载场景，并且您的应用程序将显示黑屏。 </p><br><p> 但是，您仍然可以实现应用程序的所有其他功能，这些功能不需要Sceneform SDK。 </p><br><p> 检查兼容性后，我们可以创建3D模型并将其附加到场景。 </p><br><h2 id="dobavlenie-assets"> 添加资产 </h2><br><p> 现在，您需要将3D模型添加到将在屏幕上显示的项目中。 如果您熟悉创建它们的过程，则可以自己创建这些模型。 或者，您可以转到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Poly</a> 。 </p><br><p> 在那里，您将找到可供选择的庞大3D资源库。 此外，它们可以免费下载。 </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/765/458/73b/76545873b1dadbde506f9747decd5952.jpg" alt="保利"></p><br><p> 在Android Studio中，在左窗格中打开您的应用程序文件夹。 您需要一个<strong>sampledata</strong>文件夹。 该文件夹将包含您的所有3D模型。 在此文件夹中，创建一个包含您的模型名称的文件夹。 </p><br><p> 在从Poly下载的档案中，您很可能会找到3个文件： </p><br><ol><li>  <code>.mtl</code>文件 </li><li>  <code>.obj</code>文件 </li><li>  <code>.png</code>文件 </li></ol><br><p> 这三个文件中最重要的是<code>.obj</code>文件。 这是您的模型。 将所有3个文件放入<strong>sampledata-&gt;“您的模型文件夹”中</strong> 。 </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/25a/afc/34d/25aafc34d50054f1b42b3e80660d41e9.jpg" alt="3D模型的路径"></p><br><p> 现在，右键单击<code>.obj</code>文件。 第一个选项是<strong>Import Sceneform Asset</strong> 。 单击它，不更改默认设置，只需在下一个窗口中单击<strong>完成</strong> 。 之后，将项目与Gradle文件同步。 </p><br><p> 将在项目中使用的3D资源导入完成。 接下来，让我们在代码中使用3D模型并将其包含在场景中。 </p><br><h2 id="sozdanie-modeli"> 模型制作 </h2><br><p> 将以下代码添加到您的活动中，我将逐行进行解释： </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TAG = MainActivity.class.getSimpleName(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> MIN_OPENGL_VERSION = <span class="hljs-number"><span class="hljs-number">3.0</span></span>; ArFragment arFragment; ModelRenderable lampPostRenderable; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span>({<span class="hljs-string"><span class="hljs-string">"AndroidApiChecker"</span></span>, <span class="hljs-string"><span class="hljs-string">"FutureReturnValueIgnored"</span></span>}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!checkIsSupportedDeviceOrFinish(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } setContentView(R.layout.activity_main); arFragment = (ArFragment) getSupportFragmentManager().findFragmentById(R.id.ux_fragment); ModelRenderable.builder() .setSource(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, Uri.parse(<span class="hljs-string"><span class="hljs-string">"LampPost.sfb"</span></span>)) .build() .thenAccept(renderable -&gt; lampPostRenderable = renderable) .exceptionally(throwable -&gt; { Toast toast = Toast.makeText(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Unable to load andy renderable"</span></span>, Toast.LENGTH_LONG); toast.setGravity(Gravity.CENTER, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); toast.show(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }); }</code> </pre> <br><p> 首先，我们找到<code>arFragment</code> ，我们先前已将其添加到布局中。 该片段负责场景的存储和操作。 您可以将其想象为我们场景的容器。 </p><br><p> 接下来，我们使用<code>ModelRenderable</code>类构建模型。 使用<code>setSource</code>方法<code>setSource</code>我们从导入资源时生成的<code>.sfb</code>文件加载模型。  <code>thenAccept</code>方法在创建模型后获取模型，然后将加载的模型设置为变量<code>lampPostRenderable</code> 。 </p><br><p> 对于错误处理，我们有一个<code>exceptionally</code>方法，如果发生异常，则调用该方法。 </p><br><p> 所有这些都是异步发生的，因此您不必担心多线程。 </p><br><p> 现在已经加载了模型并将其保存在<code>lampPostRenderable</code>变量中，我们将其添加到场景中。 </p><br><h2 id="dobavlenie-modeli-v-scenu"> 向场景添加模型 </h2><br><p> 我们的场景位于<code>arFragment</code> ，它将接收用户触摸事件。 因此，我们需要为片段安装一个<code>onTap</code>侦听器，以便处理触摸并将对象放置在需要的位置。 将以下代码添加到<code>onCreate</code>方法： </p><br><pre> <code class="java hljs">arFragment.setOnTapArPlaneListener( (HitResult hitresult, Plane plane, MotionEvent motionevent) -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lampPostRenderable == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } Anchor anchor = hitresult.createAnchor(); AnchorNode anchorNode = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AnchorNode(anchor); anchorNode.setParent(arFragment.getArSceneView().getScene()); TransformableNode lamp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TransformableNode(arFragment.getTransformationSystem()); lamp.setParent(anchorNode); lamp.setRenderable(lampPostRenderable); lamp.select(); } );</code> </pre> <br><p> 我们为我们的AR片段设置了<code>onTapArPlaneListener</code>侦听器。 以下语法用于lambda表达式。 如果您不熟悉它，请查看有关此主题的本小<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">指南</a> 。 </p><br><p> 首先，我们使用<code>hitresult.createAnchor()</code>从<code>HitResult</code>创建<strong>锚</strong> ，并将其保存在<code>Anchor</code>对象中。 </p><br><p> 然后，我们从该锚点创建一个<strong>节点</strong> 。 它将被称为<code>AnchorNode</code>并将使用<code>setParent</code>方法连接到场景。 </p><br><p> 接下来，我们创建一个<code>TransformableNode</code> ，它将成为我们的模型，并将其绑定到我们的节点。  <code>TransformableNode</code>仍然没有任何有关它应显示的对象的信息。 我们将使用<code>setRenderable</code>方法将此对象传递给它，该方法将ModelRenderable类型的对象作为参数（记住，我们得到了这样的对象并将其命名为<code>lampPostRenderable</code> ？）。 最后，我们调用<code>lamp.select()</code>方法； </p><br><p> 哦！ 术语过多。 不用担心，我现在将解释所有内容： </p><br><ol><li><p>  <strong>场景</strong> ：这是将显示所有3D对象的地方。 该场景位于我们添加到布局的AR片段中。 </p><br></li><li><p>  <strong>HitResult</strong> ：这是一条来自无限远的假想线（或射线），它给出了其与现实世界对象的交点。 </p><br></li><li><p>  <strong>锚点</strong> ：这是现实世界中的固定位置和方向。 可以理解为三维空间中的坐标（x，y，z）。 姿势是对象在舞台上的位置和方向。 它用于将对象的局部坐标空间转换为真实坐标空间。 </p><br></li><li><p>  <strong>锚点节点</strong> ：这是一个自动在现实世界中定位的节点。 这是检测到平面时安装的第一个节点。 </p><br></li><li><p>  <strong>TransformableNode</strong> ：这是您可以与之交互的节点。 可以移动，缩放，旋转等。 在此示例中，我们可以缩放对象并旋转它。 因此，名称为可变形。 </p><br></li></ol><br><p> 没有火箭科学。 这确实相对简单。 整个场景可以以图形的形式查看，其中父级为场景，子级为锚节点，然后将其分支为其他各种节点和对象，这些对象将在屏幕上显示。 </p><br><p> 因此，您的活动应如下所示： </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.ayusch.arcorefirst; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.ActivityManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.net.Uri; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Build; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.Gravity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.MotionEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.Anchor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.HitResult; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.core.Plane; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.AnchorNode; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.rendering.ModelRenderable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.ux.ArFragment; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.ar.sceneform.ux.TransformableNode; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TAG = MainActivity.class.getSimpleName(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> MIN_OPENGL_VERSION = <span class="hljs-number"><span class="hljs-number">3.0</span></span>; ArFragment arFragment; ModelRenderable lampPostRenderable; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span>({<span class="hljs-string"><span class="hljs-string">"AndroidApiChecker"</span></span>, <span class="hljs-string"><span class="hljs-string">"FutureReturnValueIgnored"</span></span>}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!checkIsSupportedDeviceOrFinish(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } setContentView(R.layout.activity_main); arFragment = (ArFragment) getSupportFragmentManager().findFragmentById(R.id.ux_fragment); ModelRenderable.builder() .setSource(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, Uri.parse(<span class="hljs-string"><span class="hljs-string">"LampPost.sfb"</span></span>)) .build() .thenAccept(renderable -&gt; lampPostRenderable = renderable) .exceptionally(throwable -&gt; { Toast toast = Toast.makeText(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Unable to load andy renderable"</span></span>, Toast.LENGTH_LONG); toast.setGravity(Gravity.CENTER, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); toast.show(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }); arFragment.setOnTapArPlaneListener( (HitResult hitresult, Plane plane, MotionEvent motionevent) -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lampPostRenderable == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } Anchor anchor = hitresult.createAnchor(); AnchorNode anchorNode = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AnchorNode(anchor); anchorNode.setParent(arFragment.getArSceneView().getScene()); TransformableNode lamp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TransformableNode(arFragment.getTransformationSystem()); lamp.setParent(anchorNode); lamp.setRenderable(lampPostRenderable); lamp.select(); } ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkIsSupportedDeviceOrFinish</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Activity activity)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.N) { Log.e(TAG, <span class="hljs-string"><span class="hljs-string">"Sceneform requires Android N or later"</span></span>); Toast.makeText(activity, <span class="hljs-string"><span class="hljs-string">"Sceneform requires Android N or later"</span></span>, Toast.LENGTH_LONG).show(); activity.finish(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } String openGlVersionString = ((ActivityManager) activity.getSystemService(Context.ACTIVITY_SERVICE)) .getDeviceConfigurationInfo() .getGlEsVersion(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Double.parseDouble(openGlVersionString) &lt; MIN_OPENGL_VERSION) { Log.e(TAG, <span class="hljs-string"><span class="hljs-string">"Sceneform requires OpenGL ES 3.0 later"</span></span>); Toast.makeText(activity, <span class="hljs-string"><span class="hljs-string">"Sceneform requires OpenGL ES 3.0 or later"</span></span>, Toast.LENGTH_LONG) .show(); activity.finish(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } }</code> </pre> <br><p> 恭喜你！ 您刚刚完成了第一个ARCore应用程序的创建。 开始向其中添加对象，您将看到它们如何开始在现实世界中栩栩如生。 </p><br><p> 这是您第一次了解如何在Android Studio中从头开始创建简单的ARCore应用程序。 在下一课中，我将深入研究ARCore，并为应用程序添加更多功能。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN438178/">https://habr.com/ru/post/zh-CN438178/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN438168/index.html">如何破解昂贵的相机，以免太太杀了你</a></li>
<li><a href="../zh-CN438170/index.html">奖以伊利亚·塞加洛维奇（Ilya Segalovich）命名。 有关计算机科学和发行出版物的故事</a></li>
<li><a href="../zh-CN438172/index.html">苹果无法将其设备的生产转移到美国</a></li>
<li><a href="../zh-CN438174/index.html">黄色-真空-云</a></li>
<li><a href="../zh-CN438176/index.html">Mikrotik的IPSec概述</a></li>
<li><a href="../zh-CN438180/index.html">在线注册房地产交易</a></li>
<li><a href="../zh-CN438182/index.html">研究发现，适度盗版对内容制作者和发行者的好处</a></li>
<li><a href="../zh-CN438192/index.html">戴尔Inspiron 14（5482）：经济高效的2合1升级选项</a></li>
<li><a href="../zh-CN438196/index.html">如果项目是“剧院”，请使用演员...</a></li>
<li><a href="../zh-CN438198/index.html">让我们深入历史：直升机的腿在哪里生长</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>