<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔎 ☔️ 🙈 Papeles, por favor. Cómo una red neuronal nos ayuda a verificar clientes y atrapar a los estafadores 💮 👨 🍼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Antes de que un cliente pueda hacer transferencias de dinero en ePayments, tendrá que pasar por la verificación. Nos proporciona sus datos personales ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Papeles, por favor. Cómo una red neuronal nos ayuda a verificar clientes y atrapar a los estafadores</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/epayments/blog/427675/">  Antes de que un cliente pueda hacer transferencias de dinero en ePayments, tendrá que pasar por la verificación.  Nos proporciona sus datos personales y carga documentos para verificar su identidad y dirección.  Y verificamos si cumplen con los requisitos de nuestro regulador.  El flujo de solicitudes de verificación se hizo cada vez más, nos resultó difícil procesar dicho flujo de documentos.  Temíamos que el procedimiento llevaría mucho tiempo y excedería todos los términos razonables para los clientes.  Luego decidimos crear un sistema de verificación basado en el aprendizaje profundo. <br><br><img src="https://habrastorage.org/webt/a1/fp/4f/a1fp4fz9lw2mmlarfcsvtfsiprw.jpeg"><br><a name="habracut"></a><br><h2>  Programa educativo sobre reguladores y sus requisitos. </h2><br>  Para emitir dinero electrónico, debe obtener una licencia de regulador.  Si abre un sistema de pago, por ejemplo, en Rusia, el Banco Central de la Federación de Rusia se convertirá en su regulador.  ePayments es un sistema de pago en inglés, nuestro regulador es la Financial Conduct Authority (FCA), una autoridad que informa al Tesoro del Reino Unido.  FCA garantiza que cumplamos con la política contra el lavado de dinero (AML), que incluye el conjunto de procedimientos Conozca a su cliente (KYC). <br><br>  Según KYC, estamos comprometidos a verificar quién es nuestro cliente y si está asociado con grupos socialmente peligrosos.  Por lo tanto, tenemos dos obligaciones: <br><br><ol><li>  Identificación y confirmación de identidad del cliente. <br></li><li>  Conciliación de sus datos con varias listas: terroristas, personas bajo sanciones, miembros del gobierno y muchos otros. <br></li></ol><br>  Cada año, los requisitos de KYC son cada vez más estrictos y detallados.  A principios de 2017, los clientes de ePayments aún podían recibir pagos o realizar transferencias sin verificación.  Ahora esto no es posible hasta que confirmen su identidad. <br><br><h2>  Verificación manual </h2><br>  Hace unos años, nos las arreglamos por nuestra cuenta.  Los rusos enviaron un escaneo de ciertas páginas del pasaporte para confirmar su identidad, y un escaneo del contrato de arrendamiento, un recibo por el pago de la vivienda y los servicios comunales para confirmar la dirección.  ¿Recuerdas el juego Papeles, por favor?  En él, jugando como oficial de aduanas, verifica los documentos contra los requisitos cada vez más complejos del gobierno.  Nuestro departamento de atención al cliente jugaba en el trabajo todos los días. <br><br><img src="https://habrastorage.org/webt/l7/jg/cg/l7jgcg7r0ef-kdopy7ilfwr2snw.png"><br><br>  Los clientes se verifican de forma remota, sin una visita a la oficina.  Para agilizar el procedimiento, contratamos nuevos empleados, pero este es un callejón sin salida.  Entonces surgió la idea de confiar parte del trabajo de la red neuronal.  Si ella se las arregla bien con el reconocimiento facial, entonces ella hace frente a nuestras tareas.  Desde una perspectiva comercial, un sistema de verificación rápida debería ser capaz de: <br><br><ol><li>  Clasifica un documento.  Se nos envía una tarjeta de identidad y la confirmación de la dirección de residencia.  El sistema debería responder a lo que recibió al ingresar: un pasaporte de un ciudadano de la Federación Rusa, un contrato de arrendamiento u otra cosa. <br></li><li> Compare la cara en la foto y el documento.  Pedimos a los clientes que envíen selfies con una tarjeta de identidad para asegurarse de que ellos mismos estén registrados en el sistema de pago. <br></li><li>  Extraer texto  Llenar decenas de campos desde un teléfono inteligente no es muy conveniente.  Es mucho más fácil si la aplicación hizo todo por usted. <br></li><li>  Verifique los archivos de imagen para montaje fotográfico.  No debemos olvidarnos de los estafadores que quieren ingresar al sistema de manera fraudulenta. <br></li></ol><br>  En la salida, el sistema debe indicar un cierto nivel de confianza en el cliente: alto, medio o bajo.  Centrándose en tal gradación, verificaremos rápidamente y no enojaremos a los clientes con períodos prolongados. <br><br><h2>  Clasificador de documentos </h2><br>  La tarea de este módulo es asegurarse de que el usuario envíe un documento válido y dar una respuesta de lo que cargó exactamente: un pasaporte de un ciudadano de Kazajstán, un contrato de arrendamiento o un recibo por el pago de la vivienda y los servicios comunales. <br><br>  El clasificador recibe los datos de entrada: <br><br><ul><li>  Foto o documento escaneado <br></li><li>  País de residencia <br></li><li>  Tipo de documento indicado por el cliente (documento de identidad o comprobante de domicilio) <br></li><li>  Texto extraído (más sobre eso a continuación) <br></li></ul><br>  En la salida, el clasificador informa lo que recibió (pasaporte, licencia de conducir, etc.) y qué tan seguro está de la respuesta correcta. <br><br><img src="https://habrastorage.org/webt/af/ol/a9/afola9agmjxbbt8bwtr5f5s30lc.png"><br><br>  La solución ahora se ejecuta en la arquitectura de red residual amplia.  No acudimos a ella de inmediato.  La primera versión del sistema de verificación rápida funcionó sobre la base de la arquitectura a la que nos inspiró VGG.  Tenía 2 problemas obvios: una gran cantidad de parámetros (unos 130 millones) e inestabilidad en la posición del documento.  Cuantos más parámetros, más difícil es entrenar una red neuronal de este tipo: generaliza poco el conocimiento.  El documento en la fotografía debe estar centrado, de lo contrario el clasificador tendría que ser entrenado en las muestras en las que se encuentra en diferentes partes de la fotografía.  Como resultado, abandonamos VGG y decidimos cambiar a una arquitectura diferente. <br><br>  La red residual (ResNet) era más fría que VGG.  Gracias a las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">conexiones salteadas,</a> puede crear una gran cantidad de capas y lograr una alta precisión.  ResNet tiene solo alrededor de 1 millón de parámetros, y ella era indiferente a la posición del documento.  No importa dónde se encuentre en la imagen, la solución en esta arquitectura manejó la clasificación. <br><br>  Mientras estábamos finalizando la solución con un archivo, se lanzó una nueva modificación de arquitectura, la Red Residual Amplia (WRN).  La principal diferencia con ResNet es un paso atrás en términos de profundidad.  WRN tiene menos capas, pero más filtros convolucionales.  Ahora esta es la mejor arquitectura de red neuronal para la mayoría de las tareas y nuestra solución funciona en ella. <br><br><h2>  Algunas soluciones útiles </h2><br>  <b>Problema número 1. El</b> clasificador necesitaba ser entrenado.  Tuvimos que descargar muchos pasaportes y licencias de conducir rusos, kazajos y bielorrusos.  Pero, por supuesto, no puede tomar documentos de clientes.  Hay muestras en la red, pero hay muy pocas de ellas para entrenar con éxito la red neuronal. <br><br>  <b>Solución</b>  Nuestro departamento técnico generó una muestra de más de 8000 muestras de cada tipo.  Creamos una plantilla de documento y la multiplicamos por muchas muestras aleatorias.  Luego, generamos una posición aleatoria del documento en el espacio con respecto a la cámara, teniendo en cuenta su modelo matemático y sus características: distancia focal, resolución de la matriz, etc.  Al generar una fotografía artificial, se selecciona una imagen aleatoria del conjunto de datos terminado como fondo.  Después de eso, se coloca un documento con distorsiones de perspectiva en la imagen al azar.  En tal muestra, nuestra red neuronal estaba bien entrenada y definió perfectamente el documento "en batalla".  Los resultados están al final del artículo. <br><br>  <b>Problema número 2.</b> Restricción banal en recursos informáticos y memoria.  No tiene sentido enviar una red neuronal profunda a la entrada de imágenes grandes.  Y las fotos de los teléfonos inteligentes modernos son solo eso. <br><br>  <b>Solución</b>  Antes de aplicar a la entrada, la foto se comprime a un tamaño de aproximadamente 300x300 píxeles.  De la imagen de este permiso, uno puede distinguir fácilmente un documento de identificación de otro.  Para resolver este problema, podemos usar la arquitectura estándar Wide ResNet. <br><br>  <b>Problema número 3.</b> Con los documentos que confirman la dirección de residencia, todo es más complicado.  El contrato de arrendamiento o el extracto bancario solo se pueden distinguir por el texto en la hoja.  Después de reducir el tamaño de la imagen a los mismos 300x300 píxeles, cualquiera de estos documentos tiene el mismo aspecto, como una hoja A4 con texto ilegible. <br><br>  <b>Solución</b>  Para clasificar documentos arbitrarios, realizamos cambios en la arquitectura de la red neuronal misma.  En él apareció una capa de neuronas de entrada adicional, que está conectada con la capa de salida.  Las neuronas de esta capa de entrada reciben una entrada vectorial que describe el texto previamente reconocido utilizando el modelo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Bolsa de palabras</a> . <br><br>  Primero, capacitamos a una red neuronal para clasificar documentos de identidad.  Utilizamos los pesos de la red capacitada cuando inicializamos otra red con una capa adicional para clasificar documentos arbitrarios.  Esta solución tenía una alta precisión, pero el reconocimiento de texto tomó algo de tiempo.  La diferencia en la velocidad de procesamiento entre diferentes módulos y la precisión de clasificación se puede ver en la tabla No. 2. <br><br><h2>  Reconocimiento facial </h2><br>  ¿Cómo engañar a un sistema de pago que verifica documentos?  Puede pedir prestado el pasaporte de otra persona y registrarse con él.  Para asegurarse de que el cliente se esté registrando, le pedimos que se tome una selfie con una tarjeta de identidad.  Y el módulo de reconocimiento debe comparar la cara en el documento y la cara en la selfie y responder, esta es una persona o dos diferentes. <br><br>  ¿Cómo comparar 2 caras si eres un auto y piensas como un auto?  Convierta una foto en un conjunto de parámetros y compare sus valores entre sí.  Así es como funcionan las redes neuronales que reconocen caras.  Toman una imagen y la convierten en un vector de 128 dimensiones (por ejemplo).  Cuando envía otra imagen de cara a la entrada y les pide que comparen, la red neuronal convertirá la segunda cara en un vector y calculará la distancia entre ellas. <br><br><img src="https://habrastorage.org/webt/oh/_k/ia/oh_kiatmyizksxnfavh383vu_ba.png"><br>  <i>Tabla 1. Un ejemplo de cálculo de la diferencia entre vectores en reconocimiento facial.</i>  <i>Steve Buscemi difiere de sí mismo en diferentes fotos en 0.44.</i>  <i>Y de Jennifer Aniston, un promedio de 1.33.</i> <br><br>  Por supuesto, hay diferencias entre la apariencia de una persona en la vida y el pasaporte.  También seleccionamos la distancia entre los vectores y probamos en personas reales para lograr un resultado.  En cualquier caso, la decisión final la tomará la persona y un comentario del sistema será solo una recomendación. <br><br><h2>  Reconocimiento de texto </h2><br>  Hay campos de texto en los documentos que ayudan al clasificador a comprender lo que está frente a él.  Será conveniente para el usuario si el texto del mismo pasaporte se transfiere automáticamente y no tiene que escribirse manualmente, por quién y cuándo se emitió.  Para hacer esto, creamos el siguiente módulo: reconocimiento y extracción de texto. <br><br>  En algunos documentos, por ejemplo, nuevos pasaportes de la Federación de Rusia hay una zona legible por máquina (MRZ).  Con su ayuda, es fácil tomar información: es fácil leer texto en negro sobre un fondo blanco, lo cual es fácil de reconocer.  Además, MRZ tiene un formato bien conocido, gracias al cual es más fácil obtener los datos necesarios. <br><br><img src="https://habrastorage.org/webt/c8/qg/-w/c8qg-wfvna_g7uryspfq3rx-0wc.png"><br><br>  Si la tarea tiene documentos con MRZ, entonces nos resulta más fácil.  Todo el proceso se encuentra en el campo de la visión por computadora.  Si esta zona no está allí, entonces, después de reconocer el texto, debe resolver un problema interesante: comprender y ¿qué información reconocimos?  Por ejemplo, "15 de mayo de 1999" es la fecha de nacimiento o la fecha de emisión?  En esta etapa, también puede cometer un error.  MRZ es bueno porque está decodificado de forma única.  Siempre sabemos qué información y en qué parte del MRZ buscar.  Es muy conveniente para nosotros.  Pero MRZ no estaba en el documento más popular con el que trabajará la red: el pasaporte de la Federación Rusa. <br><br>  Para el reconocimiento de texto, necesitábamos una solución muy efectiva.  El texto deberá eliminarse de la imagen tomada por la cámara del teléfono y no por los fotógrafos más profesionales.  Probamos Google Tesseract y varias soluciones pagas.  No surgió nada, o funcionó mal o fue excesivamente caro.  Como resultado, comenzamos a desarrollar nuestra propia solución.  Ahora estamos terminando su prueba.  La solución muestra resultados decentes: puede leer sobre ellos a continuación.  Hablaremos sobre el módulo para verificar el montaje fotográfico un poco más tarde, cuando habrá resultados de investigación precisos en muestras de prueba y en la "batalla". <br><br><h2>  Resultado </h2><br>  El sistema se está probando actualmente en el segmento de aplicaciones para verificación de Rusia.  El segmento se determina mediante muestreo aleatorio, los resultados se guardan y se comparan con las decisiones del operador del departamento del cliente para un cliente en particular. <br><br><table><tbody><tr><td>  <b>Pais</b> </td><td>  <b>Tipo de clasificador</b> </td><td>  <b>Precisión</b> </td><td>  <b>Tiempo de trabajo, s</b> </td></tr><tr><td>  Rusia </td><td>  Tarjeta de identificación </td><td>  99,96% </td><td>  0,41 </td></tr><tr><td>  Rusia </td><td>  Documento personalizado </td><td>  98,62% </td><td>  6.89 </td></tr><tr><td>  Kazajstán </td><td>  Tarjeta de identificación </td><td>  99,51% </td><td>  0,47 </td></tr><tr><td>  Kazajstán </td><td>  Documento personalizado </td><td>  97,25% </td><td>  7.66 </td></tr><tr><td>  Bielorrusia </td><td>  Tarjeta de identificación </td><td>  98,63% </td><td>  0,46 </td></tr><tr><td>  Bielorrusia </td><td>  Documento personalizado </td><td>  98,63% </td><td>  9.66 </td></tr></tbody></table><br>  <i><i>Tabla 2. La precisión del clasificador de documentos (la clasificación correcta del documento en comparación con la evaluación del operador).</i></i> <br><br>  Una de las grandes ventajas del aprendizaje automático es que la red neuronal realmente aprende y comete menos errores.  Pronto terminaremos las pruebas en el segmento y lanzaremos el sistema de verificación en modo "combate".  El 30% de las solicitudes de verificación llegan a pagos electrónicos de Rusia, Kazajstán y Bielorrusia.  Según nuestras estimaciones, el lanzamiento ayudará a reducir la carga en el departamento del cliente en un 20-25%.  En el futuro, la solución puede ampliarse a países europeos. <br><br><h2>  ¿Buscando trabajo? </h2><br>  Estamos buscando empleados para trabajar en una oficina en San Petersburgo.  Si está interesado en un proyecto internacional con un gran grupo de tareas ambiciosas, lo estamos esperando.  No tenemos suficientes personas que no tengan miedo de realizarlas.  A continuación encontrará enlaces a vacantes en hh.ru. <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Desarrollador C #</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Desarrollador front-end</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">QA Lead</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ingeniero de control de calidad</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Desarrollador .NET Senior / Jefe de Equipo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Analista</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es427675/">https://habr.com/ru/post/es427675/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es427663/index.html">Habro osos y cangrejo</a></li>
<li><a href="../es427665/index.html">Las mejores escalas inteligentes (según Wareable)</a></li>
<li><a href="../es427669/index.html">KNX Home Control: iluminación</a></li>
<li><a href="../es427671/index.html">Sberbank y Yandex lanzaron oficialmente la plataforma comercial Beru, la versión rusa de Amazon</a></li>
<li><a href="../es427673/index.html">Machine learning @ booking.com</a></li>
<li><a href="../es427679/index.html">Reducir a cero el límite de compras libres de impuestos llevará un año y medio, si se toma una decisión</a></li>
<li><a href="../es427681/index.html">Arrastra y desliza en RecyclerView. Parte 1: ItemTouchHelper</a></li>
<li><a href="../es427683/index.html">Por qué no es buena idea portar el desbordamiento de enteros</a></li>
<li><a href="../es427685/index.html">FSB contra Internet satelital de operadores extranjeros</a></li>
<li><a href="../es427687/index.html">Referencia para aplicaciones comerciales | Arquitectura DentalTap</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>