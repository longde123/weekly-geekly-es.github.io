<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗣️ 🧝🏻 🌟 Rostelecom虚拟PBX：可以通过API进行哪些操作以及如何完成 👯 💯 💧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="现代企业将座机电话视为过时的技术：蜂窝通信可提供移动性和员工的持续可用性，社交网络和即时通讯程序是更轻松，更快捷的通信渠道。 为了跟上竞争对手，办公室PBX变得越来越像他们：它们走到云端，通过Web界面进行管理，并通过API与其他系统集成。 在这篇文章中，我们将告诉您Rostelecom虚拟PBX ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rostelecom虚拟PBX：可以通过API进行哪些操作以及如何完成</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/484180/"><img src="https://habrastorage.org/webt/9p/4z/il/9p4zilg_eledccytuo6hslf19f0.png"><br><br> 现代企业将座机电话视为过时的技术：蜂窝通信可提供移动性和员工的持续可用性，社交网络和即时通讯程序是更轻松，更快捷的通信渠道。 为了跟上竞争对手，办公室PBX变得越来越像他们：它们走到云端，通过Web界面进行管理，并通过API与其他系统集成。 在这篇文章中，我们将告诉您Rostelecom虚拟PBX API具有哪些功能，以及如何通过虚拟PBX的基本功能来使用它。 <br><a name="habracut"></a><br>  Rostelecom虚拟PBX API的主要任务是与CRM或公司站点进行交互。 例如，API包括用于主要控制系统的小部件“回调”和“从站点呼叫”：WordPress，Bitrix，OpenCart。 该API允许您执行以下操作： <br><br><ul><li> 接收信息，通知状态并根据外部系统的请求进行呼叫； <br></li><li> 获取到对话记录的临时链接； <br></li><li> 管理和接收用户的限制设置； <br></li><li> 获取有关虚拟PBX用户的信息； <br></li><li> 请求通话记录和通话记录的历史记录； <br></li><li> 下载通话记录。 <br></li></ul><br><h2>  API的工作方式 </h2><br> 集成API和外部系统使用HTTP请求进行交互。 在个人帐户中，管理员可以设置对API的请求应该到达的地址以及应该向API发送的请求的地址。 外部系统必须具有可从Internet访问且安装了SSL证书的公共地址。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aef/32c/8c5/aef32c8c5b54534a5b002a87166cb724.png"><br><br> 另外，在您的个人帐户中，域管理员可以在访问API时限制请求的IP源。 <br><br><h2> 我们获得有关虚拟PBX用户的信息 </h2><br> 要获取用户或组的列表，您需要使用<i>/ users_info</i>方法向虚拟PBX发送请求。 <br><br><pre><code class="plaintext hljs">{         "domain":"example.ru" }</code> </pre> <br> 将返回一个列表，您可以保存。 <br><br><pre> <code class="plaintext hljs">{ "result":0, "resultMessage":"", "users":[                           {                            "display_name":"test_user_1",                            "name":"admin",                            "pin":^_^quotʚquot^_^,                           "is_supervisor":true,                            "is_operator":false,                            "email":"test_user_1@mail.gov","recording":1                             },                            {                            "display_name":"test_user_2",                            "name":"test",                            "pin":^_^quotʿquot^_^,                            "is_supervisor":true,                            "is_operator":false,                            "email":"",                           "recording":1                            }              ], "groups":              [                            {                            "name":"testAPI",                            "pin":^_^quotǴquot^_^,                            "email":"Ivanov@mail.gov",                            "distribution":1,                           "users_list":[^_^quotʚquot^_^,^_^quotʿquot^_^]                            }              ]</code> </pre><br> 在此方法中，传递了两个数组。 一个带域用户，一个带域组。 该组还可以指定将在请求中发送的电子邮件。 <br><br><h2> 我们处理有关来电的信息 </h2><br> 将公司电话连接到各种CRM系统可以节省与客户互动的员工时间，并加快处理来电的速度。 例如，在当前客户的呼叫中，CRM可以打开他的卡，而在CRM中，您可以将呼叫发送到客户并将其连接到员工。 <br><br> 要通过API获取有关调用的信息，您需要使用<i>/ get_number_info</i>方法，该方法形成一个包含有关该调用所组成的组的信息的调用列表。 假设从号码1234567890传入的呼叫已经到达虚拟PBX号码，然后从PBX发送一个请求： <br><br><pre> <code class="plaintext hljs">{        "session_id":"SDsnZugDFmTW7Sec",        "timestamp":"2019-12-27 15:34:44.461",        "type":"incoming",        "state":"new",        "from_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",        "from_pin":"",        "request_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@1192.168.0.1",        "request_pin":^_^quotɟquot^_^,        "disconnect_reason":"",        "is_record":"" }</code> </pre><br> 接下来，您需要连接<i>/ get_number_info</i>处理程序。 在路由呼叫之前，当传入呼叫到达传入线路时，必须执行该请求。 如果在设置的时间内未收到对请求的响应，则根据域中建立的规则路由呼叫。 <br><br>  CRM方面的示例处理程序。 <br><br><pre> <code class="plaintext hljs">if ($account) {        $data = [            'result' =&gt; 0,            'resultMessage' =&gt; ' ',            'displayName' =&gt; $account-&gt;name,            //'PIN' =&gt; $crm_users,        ];    }        else                {        $data = [            'result' =&gt; 0,            'resultMessage' =&gt; '  ',            'displayName' =&gt; '  '.$contact,            //'PIN' =&gt; crm_users,        ];    }    return $data;</code> </pre><br> 处理程序的响应。 <br><br><pre> <code class="plaintext hljs">{        "result":0,        "resultMessage":" ",        "displayName":"   +1&lt;/i&gt; 234-56-78-90&lt;i&gt;" }</code> </pre><br><h2> 我们监视状态并下载对话记录 </h2><br> 在Rostelecom的虚拟电话交换机中，对话记录已在您的个人帐户中激活。 使用API​​，您可以跟踪此功能的状态。 在<i>call_events中</i>处理呼叫终止时<i>，</i>您可以看到<i>'is_record'</i>标志<i>，</i>该标志通知用户录音状态： <i>true</i>表示该用户<i>启用</i>了对话录音功能。 <br><br> 要下载记录，您需要<i>使用</i>调用<i>session_id</i> <i>的</i>会话ID向<i>api.cloudpbx.rt.ru/get_record</i>发送请求<i>。</i> <i><br></i> <br><pre> <code class="plaintext hljs">{        "session_id":"SDsnZugDFmTW7Sec" }</code> </pre><br> 响应将是下载会话记录文件的临时链接。 <br><br><pre> <code class="plaintext hljs">{        "result": ^_^quot&amp;#0;quot^_^,        "resultMessage": "  ",    "url": "https://api.cloudpbx.rt.ru/records_new_scheme/record/download/501a8fc4a4aca86eb35955419157921d/188254033036" }</code> </pre><br><br> 文件存储时间在您的个人帐户设置中设置。 文件删除后。 <br><br><h2> 统计与报告 </h2><br> 在单独页面上的帐户中，您可以查看所有通话的统计信息和报告，还可以按状态和时间应用过滤器。 通过API，您必须首先使用<i>/ call_events</i>方法处理调用： <br><br><pre> <code class="plaintext hljs">    {        "session_id":"SDsnZugDFmTW7Sec",        "timestamp":"2019-12-27 15:34:59.349",        "type":"incoming",        "state":"end",        "from_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",        "from_pin":"",        "request_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",        "request_pin":^_^quotʚquot^_^,        "disconnect_reason":"",        "is_record":"true"        }</code> </pre><br> 然后，调用<i>call_info</i>方法以处理该数组并在CRM系统中显示该调用。 <br><br><pre> <code class="plaintext hljs">   {        "session_id":"SDsnZugDFmTW7Sec" }</code> </pre><br> 响应将是一组数据，可以对其进行处理以将数据存储在CRM日志中。 <br><br><pre> <code class="plaintext hljs">{        "result":0,        "resultMessage":"",        "info":        {                "call_type":1,                "direction":1,                "state":1,                "orig_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",                "orig_pin":null,                "dest_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",                "answering_sipuri":"admin@example.ru",                "answering_pin":^_^quotɟquot^_^,                "start_call_date":^_^quot quot^_^,                "duration":14,                 "session_log":"0:el:123456789;0:ru:admin;7:ct:admin;9:cc:admin;14:cd:admin;",                "is_voicemail":false,                "is_record":true,                "is_fax":false,                "status_code":^_^quot&amp;#0;quot^_^,                "status_string":""        } }</code> </pre><br><br><h2> 其他有用的虚拟PBX功能 </h2><br> 除了API，虚拟PBX还具有一些可以使用的有用功能。 例如，这是一个交互式语音菜单以及蜂窝和固定通信的组合。 <br><br> 交互式语音响应（IVR）是我们在接听人之前在接收器中听到的声音。 实际上，这是一家电子运营商，可将呼叫重定向至相应部门并自动回答一些问题。 很快，将可以通过API使用IVR：现在，我们正在开发软件，该软件可让您通过IVR跟踪呼叫进度，并在呼叫者处于语音菜单时接收有关击键的信息。 <br><br> 要将公司电话传输到移动电话，可以使用软件电话应用程序，也可以单独连接固定移动融合（FMC）服务。 使用任何一种方法，网络内的呼叫都是免费的，可以使用短号码，并且可以记录呼叫并可以保留常规统计信息。 <br><br> 区别在于，软电话需要Internet进行通信，但它们并不与运营商绑定，而FMC则与特定运营商绑定，甚至可以在较旧的按键式电话上使用。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN484180/">https://habr.com/ru/post/zh-CN484180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN484170/index.html">将检查点从R77.30更新到80.20</a></li>
<li><a href="../zh-CN484172/index.html">与Unity的持续集成：如何减少组装时间并节省资源+支付线作为礼物</a></li>
<li><a href="../zh-CN484174/index.html">城堡在“极端”条件下饮酒或我们如何参加“ DOZOR”表演</a></li>
<li><a href="../zh-CN484176/index.html">在Unity中实现状态模板</a></li>
<li><a href="../zh-CN484178/index.html">用于地球的智能以太网交换机</a></li>
<li><a href="../zh-CN484182/index.html">Xenobots：来自青蛙细胞的活的纳米机器人</a></li>
<li><a href="../zh-CN484186/index.html">LDAP-“身份验证”是一种反模式</a></li>
<li><a href="../zh-CN484188/index.html">数据库设计标准</a></li>
<li><a href="../zh-CN484192/index.html">在Tar​​antool墨盒上轻松部署应用程序（第2部分）</a></li>
<li><a href="../zh-CN484194/index.html">Kubernetes翻译成儿童</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>