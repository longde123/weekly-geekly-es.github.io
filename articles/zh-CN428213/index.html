<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✋🏿 🌍 👩🏽‍🎤 如何在SHAP中解释模型预测 🥕 😇 👨🏿‍💼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="数据科学领域中最重要的任务之一不仅是构建能够做出高质量预测的模型，而且还要具有解释此类预测的能力。 

 如果我们不仅知道客户倾向于购买产品，而且了解什么会影响其购买，那么我们将来将能够制定公司战略以提高销售效率。 

 或者该模型预测患者会很快生病。 这种预测的准确性不是很高，因为 该模型隐藏了许...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>如何在SHAP中解释模型预测</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428213/"> 数据科学领域中最重要的任务之一不仅是构建能够做出高质量预测的模型，而且还要具有解释此类预测的能力。 <br><br> 如果我们不仅知道客户倾向于购买产品，而且了解什么会影响其购买，那么我们将来将能够制定公司战略以提高销售效率。 <br><a name="habracut"></a><br> 或者该模型预测患者会很快生病。 这种预测的准确性不是很高，因为 该模型隐藏了许多因素，但是对模型做出这种预测的原因的解释可以帮助医生注意新的症状。 因此，如果模型本身的精度不太高，则有可能扩大模型的应用范围。 <br><br> 在这篇文章中，我想谈谈<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SHAP</a>技术，它使您可以查看各种模型的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">内幕</a> 。 <br><br> 如果线性模型变得越来越不清晰，则预测器下系数的绝对值越大，则该预测器越重要，那么说明相同梯度增强的特征的重要性就变得更加困难。 <br><br><h2> 为什么需要这样的图书馆 </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/959/75c/7c1/95975c7c11b6c26f5f48cb388118b87d.png" alt="图片"><br><br> 在sklearn堆栈的xgboost lightGBM软件包中，内置了用于评估“木制模型”的特征重要性（特征重要性）的方法： <br><br><ol><li>  <b>增益</b> <br> 此度量显示每个特征对模型的相对贡献。 为了进行计算，我们遍历每棵树，查看每个树节点，该特征导致节点的划分，并且模型不确定性根据度量（基尼杂质，信息增益）降低了多少。 <br> 对于每个功能，总结了其对所有树木的贡献。 <br></li><li>  <b>封面</b> <br> 显示每个功能的观测数量。 例如，您有4个要素，3棵树。 假设树的节点上的特征1在树1、2和3中分别包含10、5和2个观测值，那么对于该特征，重要性为17（10 + 5 + 2）。 <br></li><li>  <b>频次</b> <br> 显示此功能在树的节点中出现的频率，即，考虑了每棵树中每个功能被分成节点的树的总数。 <br></li></ol><br> 所有这些方法的主要问题在于，尚不清楚此功能究竟如何影响模型预测。 例如，我们了解到收入水平对于评估银行客户偿还贷款的偿付能力很重要。 但是到底如何呢？ 较高的收入偏向模型预测？ <br><br> 当然，我们可以通过改变收入水平做出一些预测。 但是如何处理其他功能？ 毕竟，我们发现自己处于一种状况，需要<b>独立</b>于其他特征及其平均值来了解收入的影响。 <br><br> 有一种普通的银行客户“处于真空状态”。 模型预测将如何随着收入的变化而变化？ <br><br> 在这里， <b>SHAP</b>库可以解救。 <br><br><h2> 我们使用SHAP计算功能的重要性 </h2><br> 在<b>SHAP</b>库中，为了评估<b>要素</b>的重要性， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">计算了Shapley值</a> （通过美国数学家的名字命名，并命名了该库）。 <br><br> 为了评估功能的重要性，在<b>有</b>或<b>没有</b>此功能的<b>情况下</b>评估模型预测。 <br><br><h4> 一些史前史 </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/b6f/410/244/b6f410244b45bae7fcd61de04c764502.jpg" alt="图片"><br><br>  Shapley的含义来自博弈论。 <br><br> 考虑这种情况：一群人打牌。 如何根据他们的贡献在他们之间分配奖金？ <br><br> 有许多假设： <br><br><ul><li> 每个玩家的奖励金额等于总奖池 </li><li> 如果两个玩家对游戏做出相等贡献，他们将获得相等的奖励。 </li><li> 如果玩家未做出任何贡献，则不会获得奖励。 </li><li> 如果玩家花了两场比赛，那么他的总奖赏包括每场比赛的奖赏金额 </li></ul><br> 我们以参与者的身份介绍模型的特征，并以奖池形式作为模型的最终预测。 <br><br><h4> 让我们来看一个例子。 </h4><br> 第i个特征的Shapley值的计算公式： <br><br><p><math> </math> $$ display $$ \ begin {equation *} \ phi_ {i}（p）= \ sum_ {S \ subseteq N / \ {i \}} \ frac {| S |！（n-| S | -1） ！} {n！}（p（S \ cup \ {i \}）-p（S））\ end {equation *} $$显示$$ </p><br><br> 在这里： <br><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>p&amp;#xFF08;S&amp;#xA0;\&amp;#xA0;cup&amp;#xA0;\&amp;#xA0;{i&amp;#xA0;\}&amp;#xFF09;</mtext></merror></math>" role="presentation"><span class="noError" style="display: inline-block;" aria-hidden="true">p（S&nbsp;\&nbsp;cup&nbsp;\&nbsp;{i&nbsp;\}）</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>p（S&nbsp;\&nbsp;cup&nbsp;\&nbsp;{i&nbsp;\}）</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-2"> p（S \ cup \ {i \}）</script> 是对具有第i个特征的模型的预测， <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.613ex" height="2.419ex" viewBox="-38.5 -780.1 2847.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMATHI-53" x="1333" y="0"></use><g transform="translate(1978,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-3"> p（S）</script>  -这是没有第i个功能的模型的预测， <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> n </script>  -功能数量， <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> S </script>  -没有第i个特征的任意一组特征 <br><br> 第i个特征的Shapley值是针对每个数据样本（例如，样本中的每个客户）在所有可能的特征组合（包括不存在所有特征）上计算的，然后对求得的值取模值求和，并获得第i个特征的最终重要性。 <br><br> 这些计算非常昂贵，因此，在幕后，使用了各种算法来优化计算，有关更多详细信息，请参见上面github上的链接。 <br><br> 以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">xgboost文档中</a>的vanilla为例。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4de/6d0/b89/4de6d0b89b0f73bba9b68e5dbd446348.png" alt="图片"><br><br> 我们想评估功能对预测人是否喜欢计算机游戏的重要性。 <br><br> 在此示例中，为简单起见，我们具有两个功能：年龄（年龄）和性别（性别）。 性别（性别）取值为0和1。 <br><br> 以Bobby（树的最左节点中的小男孩）为基础，计算特征年龄（年龄）的Shapley值。 <br><br> 我们有两组S功能： <br><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>\&amp;#xA0;{\}</mtext></merror></math>" role="presentation"><span class="noError" style="display: inline-block;" aria-hidden="true">\&nbsp;{\}</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>\&nbsp;{\}</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-6"> \ {\} </script>  -没有功能 <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>\&amp;#xA0;{&amp;#x6027;&amp;#x522B;\}</mtext></merror></math>" role="presentation"><span class="noError" style="display: inline-block;" aria-hidden="true">\&nbsp;{性别\}</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>\&nbsp;{性别\}</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-7"> \ {性别\} </script>  -只有一个特征性别。 <br><br><h4> 没有要素值的情况 </h4><br> 在没有数据样本功能的情况下，即对于所有功能而言，值均为NULL的情况下，不同模型的工作方式有所不同。 <br><br> 在这种情况下，将考虑模型对树枝的预测取平均值，即没有特征的预测为 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mn>2</mn><mo>+</mo><mn>0.1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>2</mn><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mo>&amp;#x2212;</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mo stretchy=&quot;false&quot;>]</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>2</mn><mo>=</mo><mn>0.025</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.867ex" height="2.66ex" viewBox="0 -832 15442.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-32" x="1108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2B" x="1831" y="0"></use><g transform="translate(2831,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-31" x="779" y="0"></use></g><g transform="translate(4111,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2F" x="4941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-32" x="5441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2B" x="6164" y="0"></use><g transform="translate(7165,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2212" x="8217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-31" x="9218" y="0"></use><g transform="translate(9718,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-5D" x="10548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2F" x="10827" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-32" x="11327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-3D" x="12106" y="0"></use><g transform="translate(13162,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-30" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-32" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-35" x="1780" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mn>2</mn><mo>+</mo><mn>0.1</mn><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mo>−</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo>=</mo><mn>0.025</mn></math></span></span><script type="math/tex" id="MathJax-Element-8"> [（2 + 0.1）/ 2 +（-1）] / 2 = 0.025 </script>  。 <br><br> 如果我们增加年龄知识，那么模型的预测将是 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mn>2</mn><mo>+</mo><mn>0.1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>2</mn><mo>=</mo><mn>1.05</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.388ex" height="2.66ex" viewBox="0 -832 8778 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-32" x="829" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2B" x="1552" y="0"></use><g transform="translate(2553,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-31" x="779" y="0"></use></g><g transform="translate(3832,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2F" x="4662" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-32" x="5163" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-3D" x="5941" y="0"></use><g transform="translate(6997,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-30" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-35" x="1279" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mn>2</mn><mo>+</mo><mn>0.1</mn><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo>=</mo><mn>1.05</mn></math></span></span><script type="math/tex" id="MathJax-Element-9">（2 + 0.1）/ 2 = 1.05 </script>  。 <br><br> 结果，对于缺少要素的情况，Shapley的值是： <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><merror><mtext>\&amp;#xA0;frac&amp;#xA0;{|&amp;#xA0;S&amp;#xA0;|&amp;#xFF01;&amp;#xFF08;n-|&amp;#xA0;S&amp;#xA0;|&amp;#xA0;-1&amp;#xFF09;&amp;#xFF01;}&amp;#xA0;{n&amp;#xFF01;}&amp;#xFF08;p&amp;#xFF08;S&amp;#xA0;\&amp;#xA0;cup&amp;#xA0;\&amp;#xA0;{i&amp;#xA0;\}&amp;#xFF09;-p&amp;#xFF08;S&amp;#xFF09;&amp;#xFF09;=&amp;#xA0;\&amp;#xA0;frac&amp;#xA0;{1&amp;#xFF08;2-0&amp;#xA0;-1&amp;#xFF09;&amp;#xFF01;}&amp;#xA0;{2&amp;#xFF01;}&amp;#xFF08;1.025&amp;#xFF09;=&amp;#xA0;0.5125</mtext></merror></math>" role="presentation"><span class="noError" style="display: inline-block;" aria-hidden="true">\&nbsp;frac&nbsp;{|&nbsp;S&nbsp;|！（n-|&nbsp;S&nbsp;|&nbsp;-1）！}&nbsp;{n！}（p（S&nbsp;\&nbsp;cup&nbsp;\&nbsp;{i&nbsp;\}）-p（S））=&nbsp;\&nbsp;frac&nbsp;{1（2-0&nbsp;-1）！}&nbsp;{2！}（1.025）=&nbsp;0.5125</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror><mtext>\&nbsp;frac&nbsp;{|&nbsp;S&nbsp;|！（n-|&nbsp;S&nbsp;|&nbsp;-1）！}&nbsp;{n！}（p（S&nbsp;\&nbsp;cup&nbsp;\&nbsp;{i&nbsp;\}）-p（S））=&nbsp;\&nbsp;frac&nbsp;{1（2-0&nbsp;-1）！}&nbsp;{2！}（1.025）=&nbsp;0.5125</mtext></merror></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> \ frac {| S |！（n-| S | -1）！} {n！}（p（S \ cup \ {i \}）-p（S））= \ frac {1（2-0 -1）！} {2！}（1.025）= 0.5125 </script></p><br><br><h4> 知道性别的状况 </h4><br> 对于鲍比 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x6027;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x522B;</mo></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.855ex" height="2.298ex" viewBox="0 -780.1 1660 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">性</text><g transform="translate(829,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">别</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo>性</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>别</mo></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-11"> {性别} </script> 没有特征年龄的预测，只有具有特征的性别相等 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mn>2</mn><mo>+</mo><mn>0.1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>2</mn><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mo>&amp;#x2212;</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mo stretchy=&quot;false&quot;>]</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>2</mn><mo>=</mo><mn>0.025</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.867ex" height="2.66ex" viewBox="0 -832 15442.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-32" x="1108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2B" x="1831" y="0"></use><g transform="translate(2831,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-31" x="779" y="0"></use></g><g transform="translate(4111,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2F" x="4941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-32" x="5441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2B" x="6164" y="0"></use><g transform="translate(7165,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2212" x="8217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-31" x="9218" y="0"></use><g transform="translate(9718,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-5D" x="10548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2F" x="10827" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-32" x="11327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-3D" x="12106" y="0"></use><g transform="translate(13162,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-30" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-32" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/428213/&amp;usg=ALkJrhhDyXU6pda_-9C9Bj6JD_wGfbWrMg#MJMAIN-35" x="1780" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mn>2</mn><mo>+</mo><mn>0.1</mn><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mo>−</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo>=</mo><mn>0.025</mn></math></span></span><script type="math/tex" id="MathJax-Element-12"> [（2 + 0.1）/ 2 +（-1）] / 2 = 0.025 </script>  。 如果我们知道年龄，则预测是最左边的树，即2。 <br><br> 结果，在这种情况下，Shapley的值是： <br><br><p><math> </math> $$显示$$ \开始{equation *} \ frac {| S |！（n-| S | -1）！} {n！}（p（S \ cup \ {i \}）-p（S） ）= \ frac {1（2-1-1）！} {2！}（1.975）= 0.9875 \ end {equation *} $$显示$$ </p><br><br><h4> 总结一下 </h4><br><br>  Shapley对于特征年龄（年龄）的总值： <br><p><math> </math> $$ display $$ \开始{equation *} \ phi_ {Age Bobby} = 0.9875 + 0.5125 = 1.5 \ end {equation *} $$ display $$ </p><br><h2> 一个真实的商业例子 </h2><br>  SHAP库具有丰富的可视化功能，可帮助轻松，简单地为业务和分析师自己解释模型，以评估模型的充分性。 <br><br> 在其中一个项目中，我分析了公司员工的外流情况。 作为模型，使用了xgboost。 <br><br>  python中的代码： <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> shap shap_test = shap.TreeExplainer(best_model).shap_values(df) shap.summary_plot(shap_test, df, max_display=<span class="hljs-number"><span class="hljs-number">25</span></span>, auto_size_plot=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br> 结果显示的功能重要性： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f8/5d0/8d0/3f85d08d0c377285d8d6751bd04bb758.png" alt="图片"><br><br> 如何阅读： <br><br><ul><li> 中心垂直线左侧的值是负数（0），右侧是-正数（1） </li><li> 图上的线越粗，观察点越多 </li><li> 图表上的点越红，则其中的要素值越高 </li></ul><br> 从图表中，您可以得出有趣的结论并检查其适当性： <br><br><ul><li> 员工的薪水增长越低，离职的可能性就越大 </li><li> 有些办公室的资金流出较高 </li><li> 员工越年轻，离职的可能性越高 </li><li>  ... </li></ul><br> 您可以立即构成即将离任的员工的肖像：她没有提高薪水，他还很年轻，单身，长期担任一个职位，没有升职，没有很高的年度评级，他开始很少与同事交流。 <br><br> 简单方便！ <br><br> 您可以解释特定员工的预测： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/388/aab/c93/388aabc9318855e327e570de00359744.png" alt="图片"><br><br> 或者以2D图形的形式查看预测对特定特征的依赖关系： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cf8/863/c5b/cf8863c5b4e8fb3c3775725507bc9be9.png" alt="图片"><br><br> 您甚至可以在图片中可视化神经网络的预测： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ac/ab2/146/3acab21469b2afd94b135923ec5e6d4c.png" alt="图片"><br><br><h2> 结论 </h2><br> 我自己大约在六个月前了解了SHAP值，这完全替代了其他评估功能重要性的方法。 <br><br> 主要优点： <br><br><ul><li> 方便的可视化和解释 </li><li> 诚实地计算功能的重要性 </li><li> 评估特定数据子样本的功能（例如，我们的客户与样本中其他客户有何不同）的功能是通过对熊猫中的数据集进行简单过滤并进行整形分析（实际上是几行代码）来完成的 </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN428213/">https://habr.com/ru/post/zh-CN428213/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN428201/index.html">JavaScript中的痣洞</a></li>
<li><a href="../zh-CN428203/index.html">我们看一下图表：云计算市场的估计和预测，2018年的数据</a></li>
<li><a href="../zh-CN428205/index.html">救生员NaviHaka</a></li>
<li><a href="../zh-CN428209/index.html">开发人员指南：域驱动设计食谱（第2部分，结构和交互）</a></li>
<li><a href="../zh-CN428211/index.html">《进化架构》一书。 支持持续变化”</a></li>
<li><a href="../zh-CN428217/index.html">每天有数百万次视频通话，或“给妈妈打电话！”</a></li>
<li><a href="../zh-CN428219/index.html">合格人员大规模调动的做法是从哪里来的？</a></li>
<li><a href="../zh-CN428221/index.html">AI生成逼真的面孔</a></li>
<li><a href="../zh-CN428223/index.html">城市及其大数据</a></li>
<li><a href="../zh-CN428225/index.html">如何通过Google Analytics（分析）进行SaaS的网络分析：引入和跟踪渠道</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>