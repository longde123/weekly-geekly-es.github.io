<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐น ๐คถ๐ฝ ๐๏ธ ุงูุงุณุชุนุฏุงุฏ ูู C ++ 20. ุฏุฑุงุณุฉ ุญุงูุฉ Coroutines TS Real โซ ๐ฉโโค๏ธโ๐จ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู C ++ 20 ุ ูุฑุตุฉ ุงูุนูู ูุน coroutines ุฎุงุฑุฌ ููุทูุฉ ุงูุฌุฒุงุก ุนูู ูุดู ุงูุธููุฑ. ูุฐุง ุงูููุถูุน ูุฑูุจ ููุซูุฑ ููุงูุชูุงู ุจุงููุณุจุฉ ููุง ูู Yandex.Taxi (ูุชูุจูุฉ ุงุญุชูุงุฌุงุชูุง ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุงุณุชุนุฏุงุฏ ูู C ++ 20. ุฏุฑุงุณุฉ ุญุงูุฉ Coroutines TS Real</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/420861/" style=";text-align:right;direction:rtl">  ูู C ++ 20 ุ ูุฑุตุฉ ุงูุนูู ูุน coroutines ุฎุงุฑุฌ ููุทูุฉ ุงูุฌุฒุงุก ุนูู ูุดู ุงูุธููุฑ.  ูุฐุง ุงูููุถูุน ูุฑูุจ ููุซูุฑ ููุงูุชูุงู ุจุงููุณุจุฉ ููุง ูู Yandex.Taxi (ูุชูุจูุฉ ุงุญุชูุงุฌุงุชูุง ุงูุฎุงุตุฉ ุ ูููู ุจุชุทููุฑ ุฅุทุงุฑ ุบูุฑ ูุชุฒุงูู).  ูุฐูู ุ ุณูู ูุธูุฑ ุงูููู ููุฑุงุก ูุจุฑ ุจุงุณุชุฎุฏุงู ูุซุงู ุญูููู ูููููุฉ ุงูุนูู ูุน Coruteines C ++ ุจุฏูู ููุฏุณ. <br><br>  ููุซุงู ุ ููุฃุฎุฐ ุดูุฆูุง ุจุณูุทูุง: ุจุฏูู ุงูุนูู ูุน ูุงุฌูุงุช ุดุจูุฉ ุบูุฑ ูุชุฒุงููุฉ ุ ูุคูุชุงุช ุบูุฑ ูุชุฒุงููุฉ ุ ุชุชููู ูู ูุธููุฉ ูุงุญุฏุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฏุนูุง ูุญุงูู ุชุญููู ูุฅุนุงุฏุฉ ูุชุงุจุฉ "ุงููุนูุฑููุฉ" ูุฐู ูู ุนูููุงุช ุงูุงุณุชุฏุนุงุก: <br><br><img align="right" src="https://habrastorage.org/webt/za/0m/kp/za0mkphg8qyitvudyvv-dhunfae.jpeg"><br><pre style=";text-align:right;direction:rtl"><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FuncToDealWith</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ InCurrentThread(); writerQueue.PushTask([=]() { InWriterThread1(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> finally = [=]() { InWriterThread2(); ShutdownAll(); }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (NeedNetwork()) { networkQueue.PushTask([=](){ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> v = InNetworkThread(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (v) { UIQueue.PushTask([=](){ InUIThread(); writerQueue.PushTask(finally); }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { writerQueue.PushTask(finally); } }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { finally(); } }); }</code> </pre> <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h2><br>  Coroutines ุฃู coroutines ูู ุงููุฏุฑุฉ ุนูู ุฅููุงู ูุธููุฉ ูู ุงูุชูููุฐ ูู ููุงู ูุญุฏุฏ ุณููุง ุ  ุชูุฑ ูู ููุงู ูุง ุจุงูุญุงูุฉ ุงููุงููุฉ ููุธููุฉ ุงูุชููู ูุน ุงููุชุบูุฑุงุช ุงููุญููุฉ ุ  ุชุดุบูู ุงููุธููุฉ ูู ููุณ ุงูููุงู ุงูุฐู ุฃููููุงูุง ููู. <br>  ููุงู ุงูุนุฏูุฏ ูู ุงููููุงุช ูู coroutines: ููุฏุณุฉ ูููุฏุณุฉ.  ุณูุชุญุฏุซ ุนู ูุฐุง ูู ููุช ูุงุญู. <br><br><h2 style=";text-align:right;direction:rtl">  ุจูุงู ุงููุดููุฉ </h2><br>  ูุฏููุง ุงูุนุฏูุฏ ูู ููุงุฆู ุงูุชุธุงุฑ ุงูููุงู.  ุชุญุชูู ูู ูููุฉ ุนูู ููุงู ูุนููุฉ: ููุงู ูุงุฆูุฉ ุงูุชุธุงุฑ ูุฑุณู ุงูุฑุณููุงุช ุ ูููุงู ูุงุฆูุฉ ุงูุชุธุงุฑ ูุชูุงุนูุงุช ุงูุดุจูุฉ ุ ูููุงู ูุงุฆูุฉ ุงูุชุธุงุฑ ููุนูู ูุน ูุฑุต.  ุฌููุน ููุงุฆู ุงูุงูุชุธุงุฑ ูู ุฃูุซูุฉ ููุฆุฉ WorkQueue ุงูุชู ุชุญุชูู ุนูู ุทุฑููุฉ PushTask ุจุงุทูุฉ (std :: function &lt;void ()&gt; ูููุฉ) ุ.  ุชุนูุด ููุงุฆู ุงูุงูุชุธุงุฑ ููุชุฑุฉ ุฃุทูู ูู ุฌููุน ุงูููุงู ุงูููุถูุนุฉ ูููุง (ูุฌุจ ุฃูุง ูุญุฏุซ ุงููููู ุงูุฐู ุฏูุฑูุงู ูุงุฆูุฉ ุงูุชุธุงุฑ ุนูุฏูุง ุชููู ููุงู ููุงู ูุนููุฉ ูููุง). <br><br>  ุชููู ุงูุฏุงูุฉ FuncToDealWith () ูู ุงููุซุงู ุจุชูููุฐ ุจุนุถ ุงูููุทู ูู ููุงุฆู ุงูุชุธุงุฑ ูุฎุชููุฉ ุ ูุจูุงุกู ุนูู ูุชุงุฆุฌ ุงูุชูููุฐ ุ ุชุถุน ูููุฉ ุฌุฏูุฏุฉ ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ. <br><br>  ูุนูุฏ ูุชุงุจุฉ "ุงููุนูุฑููุฉ" ูุฑุฏ ุงูุงุชุตุงู ูู ุดูู ุฑูุฒ ุฒุงุฆู ุฎุทู ุ ูุถุน ุนูุงูุฉ ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงูุชู ูุฌุจ ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุฃุณุงุณูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CoroToDealWith</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ InCurrentThread(); <span class="hljs-comment"><span class="hljs-comment">// =&gt;   writerQueue InWriterThread1(); if (NeedNetwork()) { // =&gt;   networkQueue auto v = InNetworkThread(); if (v) { // =&gt;   UIQueue InUIThread(); } } // =&gt;   writerQueue InWriterThread2(); ShutdownAll(); }</span></span></code> </pre> <br>  ุฃุฑูุฏ ุชุญููู ูุฐู ุงููุชูุฌุฉ ุชูุฑูุจูุง. <br><br>  ููุงู ูููุฏ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุง ูููู ุชุบููุฑ ูุงุฌูุงุช ูุงุฆูุฉ ุงูุงูุชุธุงุฑ - ูุชู ุงุณุชุฎุฏุงููุง ูู ุฃุฌุฒุงุก ุฃุฎุฑู ูู ุงูุชุทุจูู ูู ูุจู ูุทูุฑู ุงูุทุฑู ุงูุซุงูุซ.  ูุง ููููู ูุณุฑ ุฑูุฒ ุงููุทูุฑ ุฃู ุฅุถุงูุฉ ูุซููุงุช ูุงุฆูุฉ ุงูุชุธุงุฑ ุฌุฏูุฏุฉ. </li><li style=";text-align:right;direction:rtl">  ูุง ููููู ุชุบููุฑ ุงูุทุฑููุฉ ุงูุชู ุชุณุชุฎุฏู ุจูุง ุงูุฏุงูุฉ FuncToDealWith.  ููููู ููุท ุชุบููุฑ ุงุณูู ุ ูููู ูุง ููููู ุฌุนูู ูุนูุฏ ุฃู ุฃุดูุงุก ูุฌุจ ุนูู ุงููุณุชุฎุฏู ุงูุงุญุชูุงุธ ุจูุง ูู ุงูููุฒู. </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูููู ุงูููุฏ ุงููุงุชุฌ ููุชุฌูุง ูุซู ุงูููุฏ ุงูุฃุตูู (ุฃู ุญุชู ุฃูุซุฑ ุฅูุชุงุฌูุฉ). </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุงูุญู </h2><br><h3 style=";text-align:right;direction:rtl">  ุฅุนุงุฏุฉ ูุชุงุจุฉ ุงูุฏุงูุฉ FuncToDealWith </h3><br>  ูู Coroutines TS ุ ูุชู ุถุจุท Coroutine ุนู ุทุฑูู ุชุนููู ููุน ุงููููุฉ ุงููุฑุฌุนุฉ ููุฏุงูุฉ.  ุฅุฐุง ูุงู ุงูููุน ููู ุจูุชุทูุจุงุช ูุนููุฉ ุ ูุนูุฏุฆุฐู ููููู ุงุณุชุฎุฏุงู ุงููููุงุช ุงูุฑุฆูุณูุฉ ุงูุฌุฏูุฏุฉ co_await / co_return / co_yield ุฏุงุฎู ูุต ุงููุธููุฉ.  ูู ูุฐุง ุงููุซุงู ุ ููุชุจุฏูู ุจูู ููุงุฆู ุงูุงูุชุธุงุฑ ุ ุณูุณุชุฎุฏู co_yield: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">CoroTask </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CoroToDealWith</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ InCurrentThread(); co_yield writerQueue; InWriterThread1(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (NeedNetwork()) { co_yield networkQueue; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> v = InNetworkThread(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (v) { co_yield UIQueue; InUIThread(); } } co_yield writerQueue; InWriterThread2(); ShutdownAll(); }</code> </pre> <br>  ุงุชุถุญ ุฃูู ูุดุงุจู ุฌุฏูุง ููุฑูุฒ ุงููุงุฐุจ ูู ุงููุณู ุงูุฃุฎูุฑ.  ูุชู ุฅุฎูุงุก ูู "ุงูุณุญุฑ" ููุนูู ูุน coroutines ูู ูุฆุฉ CoroTask. <br><br><h3 style=";text-align:right;direction:rtl">  CoroTask </h3><br>  ูู ุฃุจุณุท (ูู ุญุงูุชูุง) ุ ุชุชููู ูุญุชููุงุช ูุฆุฉ "ุงูููุงูู" ูู coroutine ูู ุงุณู ูุณุชุนุงุฑ ูุงุญุฏ ููุท: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;experimental/coroutine&gt; struct CoroTask { using promise_type = PromiseType; };</span></span></span></span></code> </pre> <br><br>  promo_type ูู ููุน ุจูุงูุงุช ูุฌุจ ุฃู ููุชุจู ุจุฃููุณูุง.  ูุญุชูู ุนูู ููุทู ูุตู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุงุฐุง ุชูุนู ุนูุฏ ุงูุฎุฑูุฌ ูู coroutine </li><li style=";text-align:right;direction:rtl">  ูุง ูุฌุจ ุงูููุงู ุจู ุนูุฏ ุฅุฏุฎุงู ููุฑูุชูู ูุฃูู ูุฑุฉ </li><li style=";text-align:right;direction:rtl">  ุงูุฐู ูุญุฑุฑ ุงูููุงุฑุฏ </li><li style=";text-align:right;direction:rtl">  ูุงุฐุง ุชูุนู ูุน ุงูุงุณุชุซูุงุกุงุช ุงูุชู ุชุทูุฑ ูู coroutine </li><li style=";text-align:right;direction:rtl">  ููููุฉ ุฅูุดุงุก ูุงุฆู CoroTask </li><li style=";text-align:right;direction:rtl">  ูุงุฐุง ุชูุนู ุฅุฐุง ูุงูุช ุฏุงุฎู corutins ุชุณูู co_yield </li></ul><br>  ูุฌุจ ุชุณููุฉ ููุน ุงูุงุณู ุงููุณุชุนุงุฑ ุงููุงุนุฏ ุจูุฐู ุงูุทุฑููุฉ.  ุฅุฐุง ููุช ุจุชุบููุฑ ุงูุงุณู ุงููุณุชุนุงุฑ ุฅูู ุดูุก ุขุฎุฑ ุ ูุณูู ููุณู ุงููุญูู ุงูุจุฑูุฌู ููููู ุฃูู ูุชุจุช CoroTask ุจุดูู ุบูุฑ ุตุญูุญ.  ูููู ุชุบููุฑ ุงุณู CoroTask ููููุง ุชุดุงุก. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููู ููุงุฐุง ูุนุชุจุฑ CoroTask ุถุฑูุฑููุง ุฅุฐุง ุชู ูุตู ูู ุดูุก ูู ููุน ุงููุนุฏุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูู ุงูุญุงูุงุช ุงูุฃูุซุฑ ุชุนููุฏูุง ุ ููููู ุฅูุดุงุก CoroTask ุงูุชู ุณุชุณูุญ ูู ุจุงูุชูุงุตู ูุน ุฑูุชูู ููููู ุ ูุฅุฑุณุงู ูุงุณุชูุจุงู ุงูุจูุงูุงุช ููู ุ ูุฅููุงุธู ูุชุฏููุฑู. <br></div></div><br><h3 style=";text-align:right;direction:rtl">  PromiseType </h3><br>  ุงููุตูู ุฅูู ุงูุฌุฒุก ุงูููุชุน.  ูุตู ุณููู ููุฑูุชูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WorkQueue</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-comment"><span class="hljs-comment">// forward declaration class PromiseType { public: //      `co_return;`     , ... void return_void() const { /* ...    :) */ } //        ,  CoroTask, ... auto initial_suspend() const { // ...       . return std::experimental::suspend_never{}; } //      - , ... auto final_suspend() const { // ...        //      . return std::experimental::suspend_never{}; } //     , ... void unhandled_exception() const { // ...   (  ). std::terminate(); } //    CoroTask,    , ... auto get_return_object() const { // ...  CoroTask. return CoroTask{}; } //     co_yield, ... auto yield_value(WorkQueue&amp; wq) const; // ... &lt;  &gt; };</span></span></code> </pre> <br>  ูู ุงูููุฏ ุฃุนูุงู ุ ููููู ููุงุญุธุฉ ููุน ุงูุจูุงูุงุช std :: ุงูุชุฌุฑูุจูุฉ ุงูุชุฌุฑูุจูุฉ :: suspend_never.  ูุฐุง ูู ููุน ุจูุงูุงุช ุฎุงุต ูููู ุฃู Corutin ูุง ูุญุชุงุฌ ุฅูู ุฅููุงู.  ููุงู ุฃูุถูุง ูููุถูุง - ุงูููุน std :: ุงูุชุฌุฑูุจูุฉ ุงูุชุฌุฑูุจูุฉ :: suspend_always ุ ุงูุฐู ูุฎุจุฑู ุจุฅููุงู corutin.  ูุฐู ุงูุฃููุงุน ูู ูุง ูุณูู ุจุงูุชุธุงุฑ.  ุฅุฐุง ููุช ููุชููุง ุจุจููุชูุง ุงูุฏุงุฎููุฉ ุ ููุง ุฏุงุนู ููููู ุ ูุณูู ููุชุจ Awaitables ูุฑูุจูุง. <br><br>  ุฃูุซุฑ ููุงู ุบูุฑ ุชุงูู ูู ุงูููุฏ ุฃุนูุงู ูู final_suspend ().  ุงููุธููุฉ ููุง ุชุฃุซูุฑุงุช ุบูุฑ ูุชููุนุฉ.  ูุฐุง ุ ุฅุฐุง ูู ูููู ุงูุชูููุฐ ูู ูุฐู ุงููุธููุฉ ุ ูุฅู ุงูููุงุฑุฏ ุงููุฎุตุตุฉ ูููุฑุชุจ ูู ูุจู ุงููุชุฑุฌู ุณุชูุธู ุงููุชุฑุฌู ูู ุฃุฌููุง.  ูููู ุฅุฐุง ุฃููููุง ูู ูุฐู ุงููุธููุฉ ุชูููุฐ coroutine (ุนูู ุณุจูู ุงููุซุงู ุ ุนู ุทุฑูู ุฅุฑุฌุงุน std :: ุงูุชุฌุฑูุจูุฉ ุงูุชุฌุฑูุจูุฉ :: suspend_always {}) ุ ูุณูุชุนูู ุนููู ุชุญุฑูุฑ ุงูููุงุฑุฏ ูุฏูููุง ูู ููุงู ูุง ูู ุงูุฎุงุฑุฌ: ุณูููู ุนููู ุญูุธ ูุคุดุฑ ุฐูู ุฅูู coroutine ูู ููุงู ูุง ูุงูุงุชุตุงู ุจู ุตุฑุงุญุฉ ุชุฏููุฑ ().  ูุญุณู ุงูุญุธ ุ ูุฐุง ููุณ ุถุฑูุฑูุง ููุซุงููุง. <br><br><h3 style=";text-align:right;direction:rtl">  <b>ุบูุฑ</b> ุตุญูุญ PromiseType :: ุงููุญุตูู_ูููุฉ </h3><br>  ูุจุฏู ุฃู ูุชุงุจุฉ PromiseType :: extract_value ุจุณูุทุฉ ููุบุงูุฉ.  ูุฏููุง ุฎุท.  coroutine ุ ุงูุฐู ูุฌุจ ุชุนูููู ุ ูุจุงูุชุงูู ูุถุน: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> PromiseType::yield_value(WorkQueue&amp; wq) { <span class="hljs-comment"><span class="hljs-comment">//        std::experimental::coroutine_handle&lt;&gt; this_coro = std::experimental::coroutine_handle&lt;&gt;::from_promise(*this); //    .  this_coro  operator(),    // wq      .   , //     ,  operator(),  //   . wq.PushTask(this_coro); //     . return std::experimental::suspend_always{}; }</span></span></code> </pre> <br>  ูููุง ููุงุฌู ูุดููุฉ ูุจูุฑุฉ ุฌุฏูุง ููุตุนุจ ุงูุชุดุงููุง.  ูุงูุญูููุฉ ูู ุฃููุง ูุถุนูุง ุฃููุงู ุงูููุงุญุงุช ูู ุงูุทุงุจูุฑ ุซู ูุนูููุง ููุท.  ูุฏ ูุญุฏุซ ุฃู ูุชู ุฅุฒุงูุฉ coroutine ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ููุจุฏุฃ ุชูููุฐู ุญุชู ูุจู ุฃู ูุนููู ูู ุงูุฎูุท ุงูุญุงูู.  ุณูุคุฏู ูุฐุง ุฅูู ุญุงูุฉ ุณุจุงู ุ ูุณููู ุบูุฑ ูุญุฏุฏ ูุฃุฎุทุงุก ููุช ุงูุชุดุบูู ุงููุฌูููุฉ ุชูุงููุง. <br><br><h3 style=";text-align:right;direction:rtl">  PromiseType <b>ุงูุตุญูุญ</b> : * ุงููุงุชุฌ_ุงููููุฉ </h3><br>  ูุฐูู ุ ูุญุชุงุฌ ุฃููุงู ุฅูู ุฅููุงู corutin ุซู ุฅุถุงูุชู ููุท ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ.  ููููุงู ุจุฐูู ุ ุณูู ููุชุจ Awaitable ุงูุฎุงุต ุจูุง ููุทูู ุนููู ุงูุฌุฏูู ุงูุฒููู_ููุฅุนุฏุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> PromiseType::yield_value(WorkQueue&amp; wq) { <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">schedule_for_execution</span></span></span><span class="hljs-class"> {</span></span> WorkQueue&amp; wq; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await_ready</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">noexcept</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await_suspend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::experimental::coroutine_handle&lt;&gt; this_coro)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ wq.PushTask(this_coro); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await_resume</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">noexcept</span></span></span><span class="hljs-function"> </span></span>{} }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> schedule_for_execution{wq}; }</code> </pre> <br>  ูุฌุจ ุฃู ุชุญุชูู ุงููุฆุงุช std :: ุงูุชุฌุฑูุจูุฉ ุงูุชุฌุฑูุจูุฉ :: suspend_always ู std :: ุงูุชุฌุฑูุจูุฉ ุงูุชุฌุฑูุจูุฉ :: suspend_never ู Schedule_for_execution ู Awaitables ุงูุฃุฎุฑู ุนูู 3 ูุธุงุฆู.  ูุชู ุงุณุชุฏุนุงุก await_ready ููุชุญูู ููุง ุฅุฐุง ูุงู ูุฌุจ ุฅููุงู coroutine.  ูุชู ุงุณุชุฏุนุงุก await_suspend ุจุนุฏ ุฅููุงู ุงูุจุฑูุงูุฌ ุ ููุชู ุชูุฑูุฑ ููุจุถ coroutine ุชููู ุฅููู.  ูุณูู await_resume ุนูุฏ ุงุณุชุฆูุงู ุชูููุฐ coroutine. <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุงุฐุง ูููู ูุชุงุจุชู ูู skrabs ุงูุซูุงุซู std :: ุงูุชุฌุฑูุจูุฉ :: coroutine_handle &lt;&gt;ุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ููููู ุชุญุฏูุฏ ููุน PromiseType ููุงู ุ ูุณูุนูู ุงููุซุงู ุจููุณ ุงูุทุฑููุฉ ุชูุงููุง :) <br><br>  std :: ุงูุชุฌุฑูุจูุฉ: :: coroutine_handle &lt;&gt; (ุงููููุจ ุจู std :: ุงูุชุฌุฑูุจูุฉ: :: coroutine_handle &lt;void&gt;) ูู ุงูููุน ุงูุฃุณุงุณู ูุฌููุน std :: ุงูุชุฌุฑูุจูุฉ: :: coroutine_handle &lt;DataType&gt; ุ ุญูุซ ูุฌุจ ุฃู ูููู DataType ูู ููุน_ุงูููุน ูู coroutine ุงูุญุงูู.  ุฅุฐุง ูู ุชูู ุจุญุงุฌุฉ ุฅูู ุงููุตูู ุฅูู ุงููุญุชููุงุช ุงูุฏุงุฎููุฉ ูู DataType ุ ูููููู ูุชุงุจุฉ std :: ุงูุชุฌุฑูุจูุฉ ุงูุชุฌุฑูุจูุฉ :: coroutine_handle &lt;&gt;.  ูููู ุฃู ูููู ุฐูู ูููุฏูุง ูู ุงูุฃูุงูู ุงูุชู ุชุฑูุฏ ูููุง ุงูุชุฌุฑูุฏ ูู ููุน ูุนูู ูู ููุน prom_type ูุงุณุชุฎุฏุงู ููุน ุงููุญู. <br></div></div><br><h3 style=";text-align:right;direction:rtl">  ุชู </h3><br>  ููููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฌููุน ูุชุดุบูู ุงููุซุงู ุนุจุฑ ุงูุฅูุชุฑูุช ูุงูุชุฌุฑุจุฉ ุจูู ุทุฑููุฉ</a> . <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุฅุฐุง ูู ุฃูู ุฃุญุจ co_yield ุ ููู ูููููู ุงุณุชุจุฏุงูู ุจุดูุกุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูููู ุงุณุชุจุฏุงูู ุจ co_await.  ููููุงู ุจุฐูู ุ ูู ุจุฅุถุงูุฉ ุงููุธููุฉ ุงูุชุงููุฉ ุฅูู PromiseType: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await_transform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WorkQueue&amp; wq)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> yield_value(wq); }</code> </pre><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูููู ูุงุฐุง ูู ูู ุฃูู ุฃุญุจ co_awaitุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ุงูุดูุก ุณูุฆ.  ูุง ุดูุก ูุชุบูุฑ. <br></div></div><br></div></div><br><h3 style=";text-align:right;direction:rtl">  ูุฑูุฉ ุงูุบุด </h3><br>  CoroTask ูู ูุฆุฉ ุชุถุจุท ุณููู ููุฑูุชูู.  ูู ุงูุญุงูุงุช ุงูุฃูุซุฑ ุชุนููุฏูุง ุ ูุณูุญ ูู ุจุงูุชูุงุตู ูุน ููุฑูุชูู ูุชููู ูุฃุฎุฐ ุฃู ุจูุงูุงุช ููู. <br><br>  CoroTask :: ูุนุฏ_ูุตู ููู ููุชู ุชุชููู coroutines ุ ูููููุฉ ุชุญุฑูุฑ ุงูููุงุฑุฏ ุ ูููููุฉ ุจูุงุก CoroTask. <br><br>  Awaitables (std :: ุงูุชุฌุฑูุจูุฉ: :: suspend_always ู std :: ุงูุชุฌุฑูุจูุฉ: suspend_never ู Schedule_for_execution ูุบูุฑูุง) ุชุฎุจุฑ ุงููุชุฑุฌู ุจูุง ูุฌุจ ูุนูู ูุน coroutine ูู ููุทุฉ ูุนููุฉ (ูุง ุฅุฐุง ูุงู ูู ุงูุถุฑูุฑู ุฅููุงู corutin ุ ููุง ูุฌุจ ูุนูู ูุน ุชููู corutin ููุง ูุฌุจ ูุนูู ุนูุฏูุง ูุณุชููุธ corutin) . <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุชุญุณููุงุช </h3><br>  ููุฌุฏ ุฎูู ูู PromiseType.  ุญุชู ุฅุฐุง ููุง ูุนูู ุญุงูููุง ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูููุงู ุงูุตุญูุญุฉ ุ ูุณูุณุชูุฑ ุงุณุชุฏุนุงุก co_yield ูู ุชุนููู ุงููุธุงู ุงูุฃุณุงุณู ูุฅุนุงุฏุฉ ูุถุนู ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูููุงู ููุณูุง.  ุณูููู ูู ุงูุฃูุถู ุจูุซูุฑ ุนุฏู ุฅููุงู ุชูููุฐ coroutine ุ ูููู ูููุงุตูุฉ ุงูุชูููุฐ ุนูู ุงูููุฑ. <br><br>  ุฏุนููุง ูุตูุญ ูุฐุง ุงูุนูุจ.  ููููุงู ุจุฐูู ุ ูู ุจุฅุถุงูุฉ ุญูู ุฎุงุต ุฅูู PromiseType: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">WorkQueue* current_queue_ = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>;</code> </pre> <br>  ูู ุฐูู ุ ุณูู ูุญุชูุธ ุจูุคุดุฑ ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงูุชู ูููู ุจุชูููุฐูุง ุญุงูููุง. <br><br>  ุจุนุฏ ุฐูู ุ ูุฑุต ููุน PromiseType ::: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> PromiseType::yield_value(WorkQueue&amp; wq) { <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">schedule_for_execution</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> do_resume; WorkQueue&amp; wq; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await_ready</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">noexcept</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> do_resume; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await_suspend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::experimental::coroutine_handle&lt;&gt; this_coro)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ wq.PushTask(this_coro); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await_resume</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">noexcept</span></span></span><span class="hljs-function"> </span></span>{} }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> do_not_suspend = (current_queue_ == &amp;wq); current_queue_ = &amp;wq; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> schedule_for_execution{do_not_suspend, wq}; }</code> </pre> <br>  ููุง ูููุง ุจุชุนุฏูู ุงูุฌุฏูู ุงูุฒููู ููุงูุชูููุฐ :: await_ready ().  ุงูุขู ุชุฎุจุฑ ูุฐู ุงููุธููุฉ ุงููุชุฑุฌู ุฃูู ูุง ููุฒู ุชุนููู coroutine ุฅุฐุง ูุงูุช ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูููุงู ุงูุญุงููุฉ ุชุชุทุงุจู ูุน ุชูู ุงูุชู ูุญุงูู ุงูุจุฏุก ุจูุง. <br><br>  ุชู.  ููููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฌุฑุจุฉ ุจูู ุทุฑููุฉ</a> . <br><br><h2 style=";text-align:right;direction:rtl">  ุนู ุงูุฃุฏุงุก </h2><br>  ูู ุงููุซุงู ุงูุฃุตูู ุ ูุน ูู ุงุณุชุฏุนุงุก ูู WorkQueue :: PushTask (std :: function &lt;void ()&gt; f) ุ ุฃูุดุฃูุง ูุซูููุง ูููุฆุฉ std :: function &lt;void ()&gt; ูู lambda.  ูู ุงูุดูุฑุฉ ุงูุญููููุฉ ุ ุบุงูุจูุง ูุง ุชููู ูุฐู ุงูุฃุญุฌุงุฑ ุงููุจูุฑุฉ ูุจูุฑุฉ ุงูุญุฌู ุ ูููุฐุง ุงูุณุจุจ ูุถุทุฑ std :: function &lt;void ()&gt; ุฅูู ุชุฎุตูุต ุงูุฐุงูุฑุฉ ุฏููุงูููููุง ูุชุฎุฒูู lambdas. <br><br>  ูู ูุซุงู Coroutine ุ ูููู ุจุฅูุดุงุก ุญุงูุงุช std :: function &lt;void ()&gt; ูู std :: ุงูุชุฌุฑูุจูุฉ ุงูุชุฌุฑูุจูุฉ :: coroutine_handle &lt;&gt;.  ูุนุชูุฏ ุญุฌู std :: ุงูุชุฌุฑูุจูุฉ: :: coroutine_handle &lt;&gt; ุนูู ุงูุชูููุฐ ุ ููู ูุนุธู ุงูุชุทุจููุงุช ุชุญุงูู ุฅุจูุงุก ุญุฌููุง ุนูุฏ ุงูุญุฏ ุงูุฃุฏูู.  ูุฐุง ุ ูู ุตูุตูุฉ ุ ุญุฌููุง ูุณุงูู sizeof (ุจุงุทู *).  ุนูุฏ ุฅูุดุงุก std :: function &lt;void ()&gt; ุ ูุง ูุชู ุงูุชุฎุตูุต ุงูุฏููุงูููู ูู ุงููุงุฆูุงุช ุงูุตุบูุฑุฉ. <br>  ุงูุฅุฌูุงูู - ูุน Coroutines ุ ุชุฎูุตูุง ูู ุงูุนุฏูุฏ ูู ุงูุชุฎุตูุตุงุช ุงูุฏููุงููููุฉ ุบูุฑ ุงูุถุฑูุฑูุฉ. <br><br>  ููู!  ูุง ูุณุชุทูุน ุงููุญูู ุงูุจุฑูุฌู ูู ุงูุบุงูุจ ุญูุธ ูู ุงููุญุชูู ุนูู ุงูููุฏุณ.  ูุจุณุจุจ ูุฐุง ุ ูููู ุชุฎุตูุต ุฏููุงูููู ุฅุถุงูู ูุงุญุฏ ุนูุฏ ุฏุฎูู CoroToDealWith. <br><br><h2 style=";text-align:right;direction:rtl">  ููุฏุณ ููุงุจู ููุฏุณ </h2><br>  ููุฏ ุนูููุง ููุชู ูุน Coroutines Stackless ุ ูุงูุชู ุชุชุทูุจ ุงูุฏุนู ูู ุงููุชุฑุฌู ููุนูู ูุนูุง.  ููุงู ุฃูุถูุง Coroutines ุงูููุฏุณุฉ ุงูุชู ูููู ุชูููุฐูุง ุจุงููุงูู ุนูู ูุณุชูู ุงูููุชุจุฉ. <br><br>  ุฃูููุง ูุณูุญ ุจุชุฎุตูุต ุฃูุซุฑ ุงูุชุตุงุฏูุฉ ููุฐุงูุฑุฉ ุ ููู ุงููุญุชูู ุฃู ูุชู ุชุญุณูููุง ุจุดูู ุฃูุถู ูู ูุจู ุงููุชุฑุฌู.  ุฃูุง ุงูุซุงููุฉ ููู ุฃุณูู ูู ุงูุชูููุฐ ูู ุงููุดุงุฑูุน ุงููุงุฆูุฉ ุ ูุฃููุง ุชุชุทูุจ ุชุนุฏููุงุช ุฃูู ุนูู ุงูููุฏ.  ููุน ุฐูู ุ ูู ูุฐุง ุงููุซุงู ูุง ููููู ุฃู ุชุดุนุฑ ุจุงููุฑู ุ ูููุงู ุญุงุฌุฉ ุฅูู ุฃูุซูุฉ ุฃูุซุฑ ุชุนููุฏูุง. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูููุฎุต </h2><br>  ููุฏ ุฏุฑุณูุง ุงููุซุงู ุงูุฃุณุงุณู ูุญุตููุง ุนูู CoroTask ูู ูุฆุฉ ุนุงูููุฉ ุ ูุงูุชู ูููู ุงุณุชุฎุฏุงููุง ูุฅูุดุงุก ููุฑูุชููุงุช ุฃุฎุฑู. <br><br>  ุชุตุจุญ ุงูุดูุฑุฉ ูุนูุง ุฃูุซุฑ ูุงุจููุฉ ูููุฑุงุกุฉ ูุฃูุซุฑ ุฅูุชุงุฌูุฉ ููููุงู ูู ุงูููุฌ ุงูุณุงุฐุฌ: <br><table style=";text-align:right;direction:rtl"><tbody><tr><th>  ูุงู </th><th>  ูุน coroutines </th></tr><tr><td><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FuncToDealWith</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ InCurrentThread(); writerQueue.PushTask([=]() { InWriterThread1(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> fin = [=]() { InWriterThread2(); ShutdownAll(); }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (NeedNetwork()) { networkQueue.PushTask([=](){ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> v = InNetThread(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (v) { UIQueue.PushTask([=](){ InUIThread(); writerQueue.PushTask(fin); }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { writerQueue.PushTask(fin); } }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { fin(); } }); }</code> </pre></td><td><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">CoroTask </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CoroToDealWith</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ InCurrentThread(); co_yield writerQueue; InWriterThread1(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (NeedNetwork()) { co_yield networkQueue; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> v = InNetThread(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (v) { co_yield UIQueue; InUIThread(); } } co_yield writerQueue; InWriterThread2(); ShutdownAll(); }</code> </pre> </td></tr></tbody></table><br>  ูุงูุช ููุงู ูุญุธุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููููุฉ ุงุณุชุฏุนุงุก coroutine ุขุฎุฑ ูู corutin ูุงูุชุธุงุฑ ุงูุชูุงูู </li><li style=";text-align:right;direction:rtl">  ูุง ูู ุงูุฃุดูุงุก ุงููููุฏุฉ ุงูุชู ููููู ุญุดุฑูุง ูู CoroTask </li><li style=";text-align:right;direction:rtl">  ูุซุงู ูุฌุนู ุงููุฑู ุจูู Stackless ู Stackful </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุฃุฎุฑู </h2><br>  ุฅุฐุง ููุช ุชุฑุบุจ ูู ุงูุชุนุฑู ุนูู ุงููุณุชุฌุฏุงุช ุงูุฃุฎุฑู ููุบุฉ C ++ ุฃู ุงูุชูุงุตู ุดุฎุตููุง ูุน ุฒููุงุฆู ุนูู ุงูุฅูุฌุงุจูุงุช ุ ููู ุจุฅููุงุก ูุธุฑุฉ ุนูู ูุคุชูุฑ C ++ Russia.  ูุณุชุนูุฏ ุงูุฌูุณุฉ ุงูุชุงููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู 6 ุฃูุชูุจุฑ ูู ููุฌูู ูููุบูุฑูุฏ</a> . <br><br>  ุฅุฐุง ูุงู ูุฏูู ุฃูู ูุฑุชุจุท ุจู C ++ ูุชุฑูุฏ ุชุญุณูู ุดูุก ูุง ูู ุงููุบุฉ ุฃู ุชุฑูุฏ ููุท ููุงูุดุฉ ุงูุงุจุชูุงุฑุงุช ุงููุญุชููุฉ ุ ููุฑุญุจูุง ุจู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://stdcpp.ru/</a> . <br><br>  ุญุณููุง ุ ุฅุฐุง ูุงุฌุฃู ุฃู Yandex.Taxi ูุฏูู ุนุฏุฏ ูุจูุฑ ูู ุงูููุงู ุงูุชู ูุง ุชุชุนูู ุจุงูุฑุณูู ุงูุจูุงููุฉ ุ ูุนูุฏุฆุฐ ุขูู ุฃู ูููู ูุฐุง ููุงุฌุฃุฉ ุณุงุฑุฉ ูู :) ุชุนุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฒูุงุฑุชูุง ูู 11 ุฃูุชูุจุฑ</a> ุ ุณูุชุญุฏุซ ุนู C ++ ูุงููุฒูุฏ. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar420861/">https://habr.com/ru/post/ar420861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar420845/index.html">ุชุฑููุถ ุงูููููุฏ ุจุงุณุชุฎุฏุงู ุนูุงุฒ: ูุชุญุฉ ูุญูู Wi-Fi WF2190 (Realtek8812AU Wireless LAN 802.11ac USB)</a></li>
<li><a href="../ar420847/index.html">ููุฏูุฉ ูู ุจุฑูุฌุฉ Shader ููุชุฎุทูุทุงุช</a></li>
<li><a href="../ar420853/index.html">ุชุนุฑู ุนูู Windows Pseudo Console (ConPTY)</a></li>
<li><a href="../ar420857/index.html">ุงูุชุฌูุงู ุงูุณูุณ ุนุจุฑ ุดุจูุฉ Wi-Fi: ุงููุธุฑูุฉ ูู ุงูุชุทุจูู</a></li>
<li><a href="../ar420859/index.html">ููุณุฃูุฉ ููุฑุซ ูุณูุงุณู</a></li>
<li><a href="../ar420863/index.html">ููุง ูุนููุง ุฃูู ูุงุชู ุฐูู ุฑูุณู ุ ุชุงุจุน</a></li>
<li><a href="../ar420865/index.html">ูุจุฏุฃ ุงูุนูู ุงูุฃูู. ุงูุฌุฒุก ุงูุฃูู</a></li>
<li><a href="../ar420867/index.html">ุญุณุงุจ ุงูุชูุงููุงุช ุงููุญุฏุฏุฉ: ุงูุฎูุงุฑุฒููุงุช ุงูุฃุณุงุณูุฉ</a></li>
<li><a href="../ar420869/index.html">ุงูุฅุฎูุงุก ุ HAMR ู MAMR - ุซูุงุซ ุทุฑู ูุฒูุงุฏุฉ ูุฏุฑุฉ ูุญุฑูุงุช ุงูุฃูุฑุงุต ุงูุตูุจุฉ ุงูุญุฏูุซุฉ ุฅูู ุงูุญุฏ ุงูุฃูุตู</a></li>
<li><a href="../ar420871/index.html">ููู ููููุง ุงุณุชูุฏูู ุงูููุจ ูู ุจุงูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>