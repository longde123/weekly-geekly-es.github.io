<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê¶ üì¨ üë©üèª‚Äçüé§ Otro reloj inteligente con tus propias manos. üë®‚Äçüëß ü§≤ ü§∏üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inspirado hace alg√∫n tiempo en el art√≠culo "Relojes inteligentes con sus propias manos para 1500r". , Tambi√©n decid√≠ intentar hacer un dispositivo sim...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Otro reloj inteligente con tus propias manos.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/404737/"><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/web/603/ba0/2c4/603ba02c4cbf47ae94b451b9dedfdc7d.png"></a> </p><br><p>  Inspirado hace alg√∫n tiempo en el art√≠culo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Relojes inteligentes con sus propias manos para 1500r".</a>  , Tambi√©n decid√≠ intentar hacer un dispositivo similar. </p><br><p>  Este art√≠culo no se posiciona como una gu√≠a de acci√≥n o instrucci√≥n, sino como una indicaci√≥n de los puntos clave que tuve que enfrentar.  Quiz√°s para alguien sirva como fuente de inspiraci√≥n e informaci√≥n √∫til. </p><br><p>  Selecci√≥n de componentes, dise√±o de PCB, soldadura en condiciones dif√≠ciles, carcasa impresa en 3D y JavaScript en el reloj, debajo del corte.  Bienvenido! </p><a name="habracut"></a><br><h2 id="trebovaniya">  Requisitos </h2><br><ul><li>  Necesitas saber la hora sin tener que meterte en el bolsillo detr√°s de tu tel√©fono </li><li>  Deber√≠a haber un recibo de notificaciones de llamadas entrantes, SMS y notificaciones de mensajer√≠a instant√°nea </li><li>  La duraci√≥n de la bater√≠a debe ser de al menos una semana. </li><li>  S√© lo m√°s compacto posible </li></ul><br><p>  Sobre la base de esta peque√±a lista de requisitos, puede comenzar a seleccionar los componentes y aclarar las caracter√≠sticas t√©cnicas de la implementaci√≥n.  El presupuesto del proyecto para el tiempo y las finanzas no era particularmente limitado, la producci√≥n en masa no estaba planificada, por lo que pod√≠a darse el lujo de dar un paseo y no preocuparse realmente por ahorrar cada centavo. </p><br><p>  Adem√°s del plan general, tambi√©n hab√≠a otros puramente t√©cnicos: </p><br><ul><li>  Crear y ejecutar aplicaciones personalizadas en el reloj.  Como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">guijarro</a> .  En general, en lo sucesivo, el reloj se parecer√° cada vez m√°s a un clon de Pebble, pero ¬øpor qu√© no? </li><li>  Memoria para aplicaciones y sus datos. </li><li>  Control adecuado del nivel de carga para que el reloj no se apague repentinamente cuando la bater√≠a est√° descargada, sino que muestre "palos" y se avise con anticipaci√≥n </li><li>  Aceler√≥metro, giroscopio y magnet√≥metro para el seguimiento completo del movimiento del usuario.  Para poder hacer un pod√≥metro o un reloj despertador inteligente que monitoree las fases del sue√±o por la presencia de movimiento </li></ul><br><p>  Todo esto finalmente cristaliz√≥ en un peque√±o diagrama: </p><br><p><img src="https://habrastorage.org/web/6b6/b29/8b4/6b6b298b4ae848cf84df6ab2bb900ee1.png"><br>  <em>El microcontrolador combina BLE 4.x para la comunicaci√≥n con un tel√©fono inteligente, buses I¬≤C y SPI para sensores y una pantalla con memoria, controla la vibraci√≥n y responde a las pulsaciones de los botones, todo funciona con una bater√≠a Li-Po.</em> </p><br><p>  Ahora puede comenzar el proceso de selecci√≥n de chips y piezas.  En t√©rminos de insumos laborales y tiempo empleado, fue el proceso m√°s dif√≠cil y largo, fue necesario comparar mucho, buscar y bucear de frente a donde nunca hab√≠a nadado antes. </p><br><h2 id="vybor-komponentov">  Selecci√≥n de componentes </h2><br><h3 id="mikrokontroller">  Microcontrolador </h3><br><p>  En primer lugar, debe elegir un controlador que sea el "cerebro" del dispositivo y todo lo dem√°s en la placa le servir√° para el bien. </p><br><p>  Para hacer el dispositivo m√°s compacto, es necesario usar la menor cantidad de componentes y m√≥dulos posibles.  Aqu√≠, varios <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sistemas en un chip</a> vienen al rescate, que combinan la funcionalidad de un m√≥dulo bluetooth y un microcontrolador. </p><br><div class="spoiler">  <b class="spoiler_title">¬øQu√© nos ofrece el mercado?</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/979/a27/5f2/979a275f28bf4e8fade3f573c1677038.png" alt="imagen"><br>  <em>Fuente: www.argenox.com</em> </p><br><ul><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cypress PSoC BLE</a></strong> core ARM Cortex-M0, BLE 4.2, 256kB FLASH, 32kB RAM, un mont√≥n de perif√©ricos y un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">balun</a> integrado, un amplio rango de voltaje de suministro: 1.9-5 voltios </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Texas Insturments CC2541</a></strong> - BLE 4.0 y 8051 n√∫cleos, 256kB FLASH, 8kB RAM </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Texas Instruments CC2640</a></strong> - BLE 4.1, Cortex-M3, 128kB FLASH, 20kB RAM </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dialog DA-14580</a></strong> - Cortex-M0, BLE 4.1, 16 MHz, 42 + 8kB RAM, 32kB OTP (memoria programable √∫nica, pero es posible ejecutar c√≥digo desde un SPI FLASH externo), el chip m√°s peque√±o y de menor consumo del anterior </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SiLabs EFR32</a></strong> - Cortex-M4F, 40 MHz, BLE 4.x, Bluetooth 5, FLASH de hasta 1 MB, RAM de hasta 256 KB </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Nordic nRF52832</a></strong> - Cortex-M4F, 64MHz, BLE 4.x, Bluetooth 5, 512kB FLASH, 64kB RAM, emulaci√≥n de etiqueta NFC, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">globo</a> integrado </li></ul></div></div><br><p>  En el mont√≥n de decisiones sabrosas y no muy <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">buenas</a></strong> , la elecci√≥n recay√≥ en el <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nRF52832</a></strong> , este chip result√≥ ser el m√°s productivo y bastante conveniente en t√©rminos de carcasa (6x6mm 48-pin QFN).  Tambi√©n una opci√≥n elegante que simplifica enormemente el cableado de la placa es la capacidad de asignar program√°ticamente cualquier perif√©rico a cualquiera de los pines GPIO.  Esto es algo de lo que carecen muchos microcontroladores.  Gracias al soporte NFC, puede agregar la funcionalidad de un emulador NFC al reloj y coser todas sus tarjetas de acceso en el reloj. </p><br><p><img src="https://habrastorage.org/web/e58/636/0f5/e586360f52d647bc83189ba795011014.jpg"></p><br><p>  La hoja de datos dice que hay un RTC incorporado (reloj en tiempo real), esto es conveniente.  Pero m√°s tarde result√≥ que esto no es un reloj, sino un <em>contador en</em> tiempo real, es decir  Este es el temporizador m√°s com√∫n, que opera desde cuarzo de 32.768 kHz, incluso en modo de suspensi√≥n.  Por lo tanto, en la pr√≥xima revisi√≥n del dispositivo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">usar√©</a> un chip separado para RTC, por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">STMicroelectronics M41T62LC6F</a> .  Tiene cuarzo incorporado a 32.768kHz y funciona en la interfaz I¬≤C. </p><br><p>  La <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">placa de</a> depuraci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nRF52-DK</a> cuesta bastante <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">barata</a> , alrededor de 4 mil.  rublos  En AliExpress se puede encontrar por ~ 3tys. </p><br><div class="spoiler">  <b class="spoiler_title">Por cierto</b> <div class="spoiler_text"><p>  Dado que el dispositivo no implica la producci√≥n en masa y ninguna venta en el mercado, dibujar su propia placa y construir su soluci√≥n en BLE SoC es una tarea bastante fascinante sin graves consecuencias.  Para aquellos que desean ingresar r√°pidamente al mercado, se recomienda utilizar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">m√≥dulos precertificados listos</a> para usar. </p><br><p>  Hay varias razones para esto y est√°n asociadas con la radio: para cualquier dispositivo electr√≥nico nuevo en el mercado, es necesario obtener permiso y pasar la certificaci√≥n de reguladores como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CE</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">FCC</a> . <br><img src="https://habrastorage.org/web/024/c98/5d7/024c985d746a4223b8dba41f7ec4d1f5.jpg" alt="Logotipos de reguladores, a menudo encontrados en la carcasa del dispositivo"></p><br><p>  Las alegr√≠as que lo acompa√±an incluyen un dise√±o especial de la placa, teniendo en cuenta las caracter√≠sticas de propagaci√≥n de se√±ales con una frecuencia de 2.4 GHz, blindaje, mediciones en una c√°mara anecoica, adaptaci√≥n de impedancia y otra magia de microondas.  En los m√≥dulos terminados, todo este trabajo ya ha sido realizado por sus desarrolladores, el usuario solo necesita integrar el m√≥dulo en su soluci√≥n y no hay necesidad de certificar nada. </p></div></div><br><h3 id="kvarcevye-rezonatory">  Resonadores de cuarzo </h3><br><p>  Los resonadores de cuarzo est√°n conectados al chip nRF52832 seleccionado: </p><br><ol><li>  A 32MHz para marcar el n√∫cleo y la radio, requerido </li><li>  A 32.768 kHz para cronometrar el temporizador del reloj y los intervalos de tiempo BLE durante el modo de suspensi√≥n.  Opcional, pero su conexi√≥n reduce el consumo de energ√≠a (los intervalos de tiempo se pueden acortar) y aumenta la precisi√≥n del reloj RTC. </li></ol><br><p>  Ambos tipos de cuarzo se solicitan en una carcasa de montaje en superficie con Aliexpress: </p><br><div class="spoiler">  <b class="spoiler_title">Imagen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/46f/ab8/e9c/46fab8e9c84641629e77bb14ddf5c620.png"></p></div></div><br><h3 id="displey">  Display </h3><br><p>  Para que el reloj funcione sin recargarse durante al menos una semana, es necesario resolver el problema de que la matriz de la pantalla consume mucha corriente en el modo operativo.  Seg√∫n tengo entendido, los fabricantes de relojes resuelven este problema de dos maneras: </p><br><ol><li>  Encienda la pantalla y muestre el contenido solo cuando se produce un movimiento de la mano y la pantalla del reloj cae en el campo de visi√≥n del usuario, o cuando la atenci√≥n del usuario ya ha sido atra√≠da, por ejemplo, por una notificaci√≥n o un reloj despertador </li><li>  Muestre contenido constantemente, utilizando pantallas que pr√°cticamente no consumen corriente para mostrar la imagen, y lo consumen solo para actualizar el contenido.  No tiene que ir muy lejos por ejemplos: esto es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tinta electr√≥nica</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">memoria LCD</a> o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">IMOD / mirasol</a> </li></ol><br><div class="spoiler">  <b class="spoiler_title">¬øQu√© nos ofrece el mercado?</b> <div class="spoiler_text"><p>  Para la opci√≥n cuando la pantalla la mayor parte del tiempo es el trabajo de Malevich, existen tales opciones en el mercado: OLED, TFT, Amoled, m√≥dulos telef√≥nicos LCD (Nokia, Siemens, etc.).  Queda por encontrar una pantalla con una diagonal adecuada. </p><br><p>  Ejemplos: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Peque√±as pantallas OLED</a> , como en Ali Express cuestan un centavo. <br>  Un mont√≥n de desventajas: diagonal peque√±a, monocromo, consumo de 10-20 mA, m√≥dulo voluminoso.  Sin una placa de m√≥dulo: un bucle ancho y un mar de flejes, que absorber√° una parte significativa del √°rea en la placa. </li><li>  TFT LCD, por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ILI9341</a> .  De las desventajas: consumo, bucle ancho </li></ul><br><p>  Las pantallas de E-Ink desaparecieron inmediatamente, porque la velocidad de actualizaci√≥n de la pantalla es demasiado lenta, el monocromo y, lo m√°s probable, es dif√≠cil encontrar una pantalla de E-Ink bastante peque√±a en el mercado abierto. </p><br><p>  Si observa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pebble</a> , puede ver que usa la pantalla "Siempre encendida".  Pebble Classic usa una pantalla <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">LCD de memoria SHARP</a> monocrom√°tica, Pebble Time usa una pantalla a color (64 colores) usando una tecnolog√≠a similar, pero producida por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JDI</a> , no est√° a la venta. </p><br><p>  Con respecto a IMOD / Mirasol, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Qualcomm</a> no pudo encontrar nada m√°s que folletos de marketing y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">relojes Toq de Qualcomm</a> . </p></div></div><br><p>  Quer√≠a tomar una pantalla a color como Pebble Time.  El an√°logo m√°s cercano, que est√° en venta abierta, fue <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SHARP LS013B7DH06</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">su hoja de datos</a> ). </p><br><p><img src="https://habrastorage.org/web/843/c78/b5e/843c78b5e870402cbba399bdede1fb0e.JPG"></p><br><p>  Caracteristicas </p><br><ul><li>  Diagonal 1.33 " </li><li>  Resoluci√≥n: 128x128, 8 colores (3 bits por p√≠xel) </li><li>  Dimensiones: 26.82x31.3mm </li><li>  Interfaz: SPI </li><li>  Tensi√≥n de alimentaci√≥n: 5V, pero niveles l√≥gicos SPI de 2.7V </li></ul><br><p>  La emboscada result√≥ con el voltaje de suministro, ya que la bater√≠a Li-Po no obtiene el voltaje de 5 V requerido sin convertidores de refuerzo adicionales.  Pero la corriente en la pantalla es escasa y obtener los 5V necesarios es bastante simple usando una bomba de carga del tipo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Linear LTC1754-5</a> : </p><br><p><img src="https://habrastorage.org/web/4fa/599/9d6/4fa5999d699540c1b25fdcf02d5ccc36.jpg"><br>  Otra caracter√≠stica era la necesidad de cambiar el estado del pin EXTCOMIN (Inversi√≥n COM externa) al menos una vez por segundo de un nivel alto a un nivel bajo y viceversa, para que la carga no se acumulara en el panel de la pantalla y la imagen no se congelara en un punto.  Para estos fines, puede utilizar el PWM (PWM) incorporado del microcontrolador, ajustado a un ciclo de trabajo del 50% (onda cuadrada) y una frecuencia de 1Hz o superior, o cualquier otro generador de onda cuadrada (incluido el externo). </p><br><p>  La pantalla se conecta a la placa con un cable peque√±o, es muy conveniente usar un conector FPC de 10 pines en incrementos de 0,5 mm, por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Hirose FH12-10S-0.5SH</a> : </p><br><p><img src="https://habrastorage.org/web/cd6/c7e/1d8/cd6c7e1d8d6e41e9af61a05b705f9ea0.jpg"><br>  El m√≥dulo de visualizaci√≥n no tiene su propia luz de fondo y no brilla a trav√©s de los LED como una pantalla LCD normal, por lo que por ahora no tenemos tiempo para mirar el reloj sin luz de fondo.  <em>Si alguien est√° familiarizado con el proceso de creaci√≥n de un m√≥dulo de retroiluminaci√≥n para este tipo de pantallas, responda.</em> </p><br><h3 id="akkumulyator">  Bater√≠a </h3><br><p>  Tuve que pasar alg√∫n tiempo eligiendo la bater√≠a del tama√±o correcto de la gama est√°ndar de tama√±os.  Estaba buscando una bater√≠a de pol√≠mero de litio con un voltaje de 3.7V y con una capacidad de aproximadamente 100mAh. </p><br><p>  Se plane√≥ colocar la bater√≠a debajo del tablero, sabiendo el tama√±o del tablero, puede levantar f√°cilmente una bater√≠a que se ajuste y no sobresalga. </p><br><div class="spoiler">  <b class="spoiler_title">¬øQu√© ofrece el mercado?</b> <div class="spoiler_text"><p>  En Aliexpress puedes pedir un mont√≥n de bater√≠as para casi cualquier tama√±o, lo principal es conocer el sistema de codificaci√≥n de sus nombres.  Y es as√≠: HHWWLL, donde HH es el grosor (altura) de la bater√≠a en d√©cimas de mil√≠metro, WW es su ancho y LL es su longitud en mil√≠metros. </p><br><p>  Ejemplo: 402025 - bater√≠a con un grosor de 4 mm y un tama√±o de 20x25 mm <br><img src="https://habrastorage.org/web/a8b/a4e/129/a8ba4e1299df4be69ab9048680ae8da4.png"></p></div></div><br><p>  <strong>Las</strong> bater√≠as <strong>302025</strong> (3x20x25mm) con una capacidad de 110 mAh fueron seleccionadas y ordenadas en Aliexpress. </p><br><p><img src="https://habrastorage.org/web/b54/87c/266/b5487c2667514d8ea864e303af4fcc54.png"></p><br><h3 id="pitanie">  Nutrici√≥n </h3><br><p>  Dado que las bater√≠as de pol√≠mero de litio tienen sentido para descargar solo hasta 3 voltios, se decidi√≥ alimentar todo el circuito desde 3 V estabilizados y, si el voltaje en la bater√≠a cay√≥ por debajo de 3 V, cortar el regulador de alimentaci√≥n principal para el chip de protecci√≥n ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Maxim MAX809TEUR + T</a> ). </p><br><p>  La tensi√≥n de alimentaci√≥n total de 3V se ajusta a los rangos de potencia de todos los elementos del circuito, excepto la pantalla, que necesita 5V.  Por lo tanto, la pantalla se alimenta a trav√©s del convertidor de impulso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Linear LTC1754-5</a> directamente desde la bater√≠a. </p><br><p>  Si observa la curva de descarga de este tipo de bater√≠a, <br><img src="https://habrastorage.org/web/6f9/d21/e2c/6f9d21e2cd6b475b913667c1f667fe32.gif"></p><br><p>  se puede ver que toda la capacidad de la bater√≠a cae en el rango de voltaje de ~ 4V a 3V, por lo que un convertidor reductor convencional de 3V ser√° suficiente para proporcionar al sistema un voltaje estable y al mismo tiempo absorber toda la energ√≠a de la bater√≠a sin dejar nada, pero sin descargarla en exceso . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Texas Instruments TPS78230DRVT</a> fue elegido como un convertidor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">reductor</a> , tiene una peque√±a corriente de funcionamiento de 500 nA y una corriente m√°xima de 150 mA, que es suficiente.  El estuche SON-6 es compacto y bastante pagadero: </p><br><p><img src="https://habrastorage.org/web/f31/c89/056/f31c89056e624439af40162263e57c18.jpg"></p><br><h3 id="zaryadka-akkumulyatora">  Carga de la bater√≠a </h3><br><p>  Se decidi√≥ cargar la bater√≠a a trav√©s de un puerto microUSB est√°ndar ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Molex 47346-0001</a> ), pero no es suficiente conectar la bater√≠a directamente al bus USB de 5V y cargarla de esa manera, es necesario garantizar el proceso de carga correcto, dividido en varias fases: preacondicionamiento, corriente constante, constante voltaje </p><br><div class="spoiler">  <b class="spoiler_title">Perfil de carga t√≠pico para una bater√≠a de 180 mAh</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/f70/022/db6/f70022db6ac747c089c50bfa34320854.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">Buena explicaci√≥n del proceso de carga en EEVBlog</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/A6mKd5_-abk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><p>  Una soluci√≥n popular para cargar bater√≠as de peque√±a capacidad (hasta 500 mAh) es el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">chip Microchip MCP73831</a> .  La corriente de carga (dependiendo de la capacidad de la bater√≠a) es programada por una resistencia, hay una salida de triple estado o de drenaje abierto para notificarle el comienzo y el final del proceso de carga. </p><br><p>  Tambi√©n eleg√≠ otro chip: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Maxim MAX1555EZK-T</a> .  Tiene una corriente de carga fija de 100 mAh y tiene la misma carcasa que el chip de microchip, y al mismo tiempo requiere un m√≠nimo de componentes externos y tiene una salida de drenaje abierto para notificar sobre el proceso de carga: </p><br><p><img src="https://habrastorage.org/web/b33/64a/b80/b3364ab804ef4332abb7c68fdd9452d8.jpg"></p><br><div class="spoiler">  <b class="spoiler_title">Imagen de hoja de datos</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/092/c7b/994/092c7b994d134222a43096e9eaa4fa22.png"></p></div></div><br><p>  En la pr√≥xima revisi√≥n de la placa, todav√≠a cambiar√© al chip microchip, porque la corriente de carga de 100 mA para una bater√≠a de 110 mAh es probablemente un poco demasiado. </p><br><h3 id="kontroller-yomkosti-akkumulyatora">  Controlador de capacidad de la bater√≠a </h3><br><p>  Existen varias t√©cnicas para monitorear el grado de carga de la bater√≠a que son algo diferentes en la ejecuci√≥n y precisi√≥n del resultado final (en fuentes en ingl√©s esto se llama Estado de carga): </p><br><div class="spoiler">  <b class="spoiler_title">Lista</b> <div class="spoiler_text"><ol><li><p>  Mide el llamado  Abra el voltaje de circuito / OCV (voltaje en las placas) de la bater√≠a a trav√©s del ADC y haga una conclusi√≥n sobre la capacidad de la bater√≠a.  Muy a menudo, es necesario transferir el rango de voltaje a un √°rea que sea aceptable para la operaci√≥n del ADC usando un divisor de voltaje.  Las desventajas de este enfoque son que el gr√°fico del voltaje versus la capacidad de las bater√≠as de pol√≠mero de litio es bastante plano, y las lecturas mismas cambian con cada ciclo y est√°n sujetas a ruido y a la incapacidad de medir el voltaje verdadero en las placas debido a la influencia de la corriente de carga </p><br></li><li><p>  Otra forma es medir la corriente que fluye dentro y fuera de la bater√≠a en lugar de medir el voltaje a trav√©s de las placas.  Este es el llamado recuento de culombios.  Una soluci√≥n t√≠pica es integrar el valor de la ca√≠da de voltaje en una peque√±a resistencia de derivaci√≥n de resistencia (aproximadamente 100 mOhm).  Conociendo la capacidad de la bater√≠a, por la corriente que fluy√≥ de ella durante un cierto per√≠odo de tiempo, podemos concluir cu√°nta m√°s energ√≠a queda en la bater√≠a (descuidando la autodescarga).  Las desventajas de este enfoque son que la autodescarga no se tiene en cuenta, as√≠ como el hecho de que la capacidad real de la bater√≠a cambia con cada ciclo de carga y descarga.  En t√©rminos generales, fluye menos corriente de la bater√≠a que la que fluye hacia ella cuando se carga.  Debido a esto, con el tiempo, un error en las lecturas inevitablemente se acumular√°. </p><br></li><li>  La combinaci√≥n del primer y segundo m√©todo: medici√≥n y voltaje en las placas y la corriente que fluye.  Una combinaci√≥n competente de los dos enfoques ayudar√° a construir un modelo que evaluar√° la capacidad de la bater√≠a con buena precisi√≥n.  Para que este enfoque funcione, es necesario producir al menos un ciclo de carga-descarga para recopilar datos sobre la dependencia del voltaje a trav√©s de las placas en la capacitancia.  Adem√°s, cada pr√≥ximo ciclo tendr√° que hacer cambios en el modelo de bater√≠a para que el error no se acumule.  Hay art√≠culos en los que las personas cuentan c√≥mo, utilizando el filtro de Kalman, se combinaron datos de diferentes mediciones para predecir la carga restante ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[1]</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[2]</a> ) </li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">¬øQu√© nos ofrece el mercado?</b> <div class="spoiler_text"><ul><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Maxim MAX17043</a></strong> : utilizando un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">algoritmo patentado</a> para el voltaje en las placas, construye un modelo de bater√≠a dentro de s√≠ mismo.  Promete precisi√≥n en la medici√≥n de la carga restante del 3%.  Interfaz I¬≤C.  Bonito y peque√±o cuerpo </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OnSemi LC709203F</a></strong> - mide OCV, interfaz I¬≤C, precisi√≥n de 2.8%, hay compensaci√≥n de temperatura a trav√©s de un termistor externo.  Caro y malo en Rusia </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Texas Instruments BQ27621</a></strong> - mide el voltaje en las placas, I¬≤C, precisi√≥n no especificada, costoso, paquete BGA </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Texas Instruments BQ27421</a></strong> : mide simult√°neamente el flujo de voltaje y corriente.  Interfaz I¬≤C, precisi√≥n no especificada, costosa, paquete BGA </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lineal LTC2941</a></strong> : mide la corriente de flujo, interfaz I¬≤C, precisi√≥n del 1%, adem√°s requiere una resistencia de derivaci√≥n externa (est√° incorporada en LTC2941-1), carcasa: 2x3 mm DFN-6 </li></ul></div></div><br><p>  De las opciones disponibles, se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">eligi√≥ el</a> chip <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Linear LTC2941</a> para el caso m√°s peque√±o pero pagable y un algoritmo de trabajo claro.  Pedido en AliExpress. </p><br><div class="spoiler">  <b class="spoiler_title">Imagen de hoja de datos</b> <div class="spoiler_text"><p><img src="http://cds.linear.com/image/8650.png" alt="imagen"><br>  <em>Fuente: Linear Technology</em> </p></div></div><br><p>  El microcircuito utiliza la t√©cnica de contador de culombio y cuenta la corriente que fluye con una precisi√≥n del 1%, funciona a trav√©s de la interfaz I¬≤C (SMBus) y tiene una carcasa peque√±a pero conveniente: 2x3 mm DFN-6: <br><img src="https://habrastorage.org/web/348/3e8/90b/3483e890b3e34789ad68abaa6cf19c0a.jpg"></p><br><p>  A trav√©s de I¬≤C dentro del microcircuito, puede establecer el valor de la contraparte del medidor actual, as√≠ como establecer o leer el valor del contador en s√≠.  El contador es de 16 bits y aumenta cuando la corriente fluye hacia la bater√≠a y disminuye cuando la corriente fluye desde la bater√≠a.  El valor m√°ximo del contador (0xFFFF) se puede tomar como una bater√≠a completamente cargada, y el m√≠nimo (0x0000) como una bater√≠a completamente descargada.  Con un preselector de contador bien elegido, es posible lograr que el contador alcance su m√°ximo durante la carga y llegue a cero cuando la bater√≠a est√© completamente descargada.  Es posible establecer el l√≠mite del valor del contador, debajo del cual el microcircuito har√° sonar una alarma y dar√° una interrupci√≥n. </p><br><h3 id="akselerometr">  Aceler√≥metro </h3><br><p>  Entre el mont√≥n de opciones en el mercado, se eligi√≥ un chip bastante popular: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">InvenSense MPU-9250</a> .  Este es un sistema en un caso (SiP), que combina MEMS-Aceler√≥metro, MEMS-giroscopio y chip magnet√≥metro. </p><br><p><img src="https://habrastorage.org/web/1d8/c0d/685/1d8c0d6854a7433e9d6ccb6e2ffebf08.png"></p><br><div class="spoiler">  <b class="spoiler_title">Caracteristicas</b> <div class="spoiler_text"><ul><li>  Tensi√≥n de alimentaci√≥n de 2.4V a 3.6V </li><li>  Aceler√≥metro MEMS de tres ejes y 16 bits con rangos de medici√≥n de ¬± 2g, ¬± 4g, ¬± 8g, ¬± 16g </li><li>  Giroscopio MEMS de tres ejes y 16 bits hasta 2000 ¬∞ / seg. </li><li>  Magnet√≥metro de tres ejes de 16 bits con rango de medici√≥n de hasta ¬± 4800 ŒºT </li><li>  Filtros digitales incorporados </li><li>  Interfaces I¬≤C y SPI </li><li>  Interrupciones programables </li><li>  Coprocesador para leer DMP (Procesador de movimiento digital) </li></ul></div></div><br><p>  El chip es excelente, pero al final parec√≠a que era una exageraci√≥n y un simple aceler√≥metro es suficiente para usar en un reloj.  Por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Analog ADXL362</a> : seg√∫n el fabricante, este es el aceler√≥metro MEMS de tres ejes m√°s econ√≥mico. </p><br><h3 id="flesh-pamyat">  Memoria flash </h3><br><p>  Se decidi√≥ utilizar memoria externa SPI-FLASH para aplicaciones y datos.  De una variedad de opciones, se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">eligi√≥ el</a> chip <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Winbond W25Q256FV</a> en el paquete compacto WSON-8: </p><br><p><img src="https://habrastorage.org/web/7ca/6f6/617/7ca6f6617c454838be1f4b0ee964779f.jpg"></p><br><p>  La cantidad de memoria flash es de 256 megabytes (o 32 megabytes), es suficiente.  La memoria se divide en p√°ginas de 256 bytes, agrupadas en sectores de 4 kilobytes y bloques de 32 kilobytes.  En modo activo (lectura o escritura) consume hasta 20 mA, en modo de espera, menos de 1 ŒºA. </p><br><p>  Al igual que con el aceler√≥metro, m√°s tarde comenz√≥ a parecer que 32 megabytes tambi√©n es una exageraci√≥n y podr√≠a usar la memoria FLASH incorporada del microcontrolador, ya que tiene 512 kilobytes.         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a>     . </p><br><h3 id="knopki">  </h3><br><p>  ,           (   Pebble,  ).             .          ,            : </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Wealth Metal TD-26EA</a> : </p><br><p><img src="https://habrastorage.org/web/55f/13a/47d/55f13a47d7c6491094d471c3a94af858.jpg"><br> <em>: &amp;</em> </p><br><p>  ,              . </p><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Omron B3U-3000P</a> : </p><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/889/246/2d0/8892462d032444d691d70ef546c62743.png"></p></div></div><br><p>       . </p><br><h3 id="vibromotorchik">  </h3><br><p>     ,    ,  . </p><br><p>  Aliexpress       ,   3V   (HxWxL) 3x3x12mm: </p><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/147/477/5c7/1474775c7260460896a4ea3b080e5571.jpg"></p></div></div><br><p>         ,    100mA      . </p><br><h3 id="antenna">  </h3><br><p> -     ,      -  .   ,      ,    .      ,          .    ,          . </p><br><p>   -  2.4GHz  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Johanson 2450AT18B100</a> : <br><img src="https://habrastorage.org/web/84b/dc7/0e5/84bdc70e556b490896f937b3aa23f574.jpg"></p><br><p> ,    ,   Johanson    ,     ,      Nordic.   nRF52 Johanson    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Johanson 2450FM07A0029</a> ,     - LC-  . </p><br><p> Las antenas se ordenaron en Aliexpress con cinta de 10 piezas.  para 214r / cinta. </p><br><h3 id="vsyo-ostalnoe">  Todo lo dem√°s </h3><br><p>  Los componentes pasivos para tirantes y flejes son principalmente chips de tama√±os 0402 y 0603 y se piden en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Elitan</a> .  Adem√°s de los componentes pasivos, hay dos transistores y un par de diodos en el tablero.  Participan en el control del motor de vibraci√≥n, as√≠ como en el circuito de alimentaci√≥n, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">desacoplando la alimentaci√≥n USB y la bater√≠a</a> . </p><br><h2 id="shema-i-plata">  Circuito y placa </h2><br><p>  <em>La apariencia del tablero en las capturas de pantalla es ligeramente diferente de lo que se orden√≥ y est√° presente en las fotos del dispositivo.</em>  <em>Las capturas de pantalla de la placa son solo una revisi√≥n posterior con cambios menores.</em> </p><br><p>  Habiendo decidido probar algo nuevo, dibuj√© el circuito y la placa no en el DipTrace habitual, sino en la nube EDA Upverter: un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace al dise√±o</a> . </p><br><p>  Upverter le permite llevar a cabo el dise√±o de extremo a extremo de la placa y el circuito al mismo tiempo, por lo que algunos de los elementos de cableado se realizaron de acuerdo con el esquema, y ‚Äã‚Äãparte del circuito se dise√±√≥ teniendo en cuenta las caracter√≠sticas del cableado. </p><br><p>  Otra caracter√≠stica asesina de Upverter es una enorme biblioteca de componentes, cuidadosamente generada por bots y un grupo de indios.  Result√≥ ser muy conveniente tomar la parte ya dibujada y simplemente verificar que todo sea m√°s o menos correcto, en lugar de dibujar completamente el s√≠mbolo y la huella usted mismo. </p><br><p>  Primero, decid√≠ organizar los componentes, cuya posici√≥n se fijar√° con precisi√≥n: botones, puerto microUSB y un conector para la pantalla.  No hice agujeros de montaje, con la esperanza de que el tablero quede sujeto por el estuche y que nada cuelgue. </p><br><p>  Despu√©s de la ubicaci√≥n de los elementos fijos, siga la "regla general" y primero reproduciremos la radio.  La antena con chip tiene una peque√±a √°rea de retenci√≥n cerca, dentro y debajo de la cual no se recomienda colocar pistas y pol√≠gonos en todas las capas, por lo que la regla del buen tono es colocar la antena en el borde del tablero, preferiblemente m√°s cerca de una de las esquinas.  En realidad, la ubicaci√≥n de la antena dicta la ubicaci√≥n del microcontrolador.  Para que la longitud del conductor desde el puerto de salida de la antena en el chip hasta la antena sea lo m√°s peque√±a posible (teniendo en cuenta los componentes correspondientes), colocamos el controlador m√°s cerca del borde en el que se ubicar√° la antena. </p><br><p>  Todos los dem√°s componentes se pueden ubicar (sin olvidar el sentido com√∫n) con bastante libertad.  Esto se debe al hecho de que el software puede determinar la posici√≥n de los puertos para los perif√©ricos digitales del microcontrolador nRF52. </p><br><p>  En mi poca experiencia, una disposici√≥n mutua exitosa de componentes es un 90% de √©xito y dicta la calidad de un cableado adicional, por lo que este proceso debe recibir atenci√≥n especial. </p><br><div class="spoiler">  <b class="spoiler_title">Captura de pantalla del tablero (los pol√≠gonos no est√°n inundados, vista inferior)</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/9dc/5f1/7cd/9dc5f17cd1c34a00943ebd444b28a964.png"></p></div></div><br><p>  Para mayor claridad, pint√© una topolog√≠a aproximada de √°reas clave: </p><br><p><img src="https://habrastorage.org/web/fd0/136/bef/fd0136bef5c140c3bb6b069615f4837f.png"></p><br><p>  El tablero es de cuatro capas, colocar los componentes seleccionados en el tablero y disolver sus conexiones fue cuesti√≥n de varias noches, y luego tard√≥ aproximadamente una semana en atascarse en el tablero, en busca de errores, doble comprobaci√≥n y relectura de hojas de datos para evitar sorpresas repentinas. </p><br><p>  El tablero se dibuj√≥ teniendo en cuenta los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">est√°ndares tecnol√≥gicos</a> del fabricante del tablero, que se convirti√≥ en el estadounidense <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OSHPark.com</a> : </p><br><ul><li>  Conductor / Liquidaci√≥n: 5/5 Mil </li><li>  Vias: agujero de 10/4 mil / almohadilla </li><li>  Material: FR408 </li><li>  Acabado: oro de inmersi√≥n con una subcapa de n√≠quel (ENIG) </li><li>  No se admiten vias ciegas y transiciones de capa interna (vias enterradas).  <em>Y no necesitamos</em> </li></ul><br><p>  Al mismo tiempo, el precio es de $ 10 por metro cuadrado.  pulgada y el n√∫mero de tablas en el orden - 3 piezas.  Estas son placas base de muy alta calidad y de bajo costo (para prototipos) con una m√°scara p√∫rpura reconocible, recomiendo a todos los que no son cr√≠ticos que esperen dos semanas por sus placas base bilaterales o de cuatro capas durante un mes. </p><br><div class="spoiler">  <b class="spoiler_title">Captura de pantalla de pedido</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/ab1/daf/2ae/ab1daf2ae0b64016ac897c4afd23fb51.png"></p></div></div><br><p>  Como resultado, por tres tarifas, tuve que pagar $ 14 y un mes despu√©s las recog√≠ por correo. </p><br><div class="spoiler">  <b class="spoiler_title">Fotos de tablero sin componentes</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/a45/223/d98/a45223d982164562992fd1c3b9a9b308.jpg"><br><img src="https://habrastorage.org/web/6b0/438/119/6b043811948c4552a2d51294007dd385.jpg"></p></div></div><br><p>  Todos los componentes se encuentran en la parte inferior de la placa, en la parte superior de la placa se encuentra el m√≥dulo de pantalla, debajo del cual hay una bobina NFC plana, que le permite ahorrar varios mil√≠metros de altura y garantiza un ajuste suave y apretado de la pantalla. </p><br><div class="spoiler">  <b class="spoiler_title">Resulta un sandwich</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/18a/5c4/a32/18a5c4a320d14b31be2aad99ff8e9d7f.png"></p></div></div><br><p>  En el lado superior de la placa tambi√©n hay un mont√≥n de puntos de prueba, almohadillas de prueba, a las que se conectan l√≠neas de bus I¬≤C, SPI, l√≠neas de interrupci√≥n y algunas se√±ales de control.  Se puede conectar un osciloscopio o un analizador l√≥gico a estas plataformas y esta caracter√≠stica simplifica enormemente la escritura de controladores y la depuraci√≥n de firmware.  Tambi√©n en la parte superior de la placa est√° la interfaz de depuraci√≥n JTAG (SWD) para flashear y depurar a trav√©s de Segger JLink, que se incluye en el kit nRF52-DK, y almohadillas para soldar la bobina de antena NFC. </p><br><h2 id="sborka-i-payka">  Ensamblaje y soldadura </h2><br><p>  Si sigue todo el proceso de montaje en superficie, entonces necesita pedir una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">plantilla smd (plantilla smd)</a> y pasta de soldadura, aplicar la pasta de soldadura a trav√©s de la plantilla, organizar los componentes y enviarlos al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">horno de reflujo</a> . </p><br><p>  Pero no ten√≠a horno, ni plantilla.  Y el deseo de meterse con √©l y pegar con soldadura tambi√©n.  Quer√≠a armar r√°pidamente un prototipo y comenzar a probar y escribir software.  Por lo tanto, solde manualmente todos los componentes, el m√°s peque√±o de los cuales son chips del tama√±o 0402, aplicando pasta con una aguja, colocando los componentes con pinzas de vac√≠o y soldandolos con un secador de pelo. </p><br><p>  El resultado se puede ver en la foto: </p><br><p><img src="https://habrastorage.org/web/4e1/164/938/4e11649380fb457b9ebce97f267e32ac.jpg"></p><br>  <em>Los botones no est√°n soldados y, en lugar de varios chips de tres patas, puentes.</em> <br>  <em>Pido disculpas por las fotos de baja calidad, tomadas en un ladrillo.</em> <br><br><br><div class="spoiler">  <b class="spoiler_title">Foto a trav√©s de la lupa x30</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/8d8/25c/fed/8d825cfedfe047ddb9f260548d365219.jpg"><br>  <em>Puede ver componentes ligeramente rotados y en algunos lugares un exceso de soldadura.</em>  <em>Esto es inevitable con la instalaci√≥n manual y la aplicaci√≥n de la pasta.</em> </p></div></div><br><p>  Tan pronto como se ensambl√≥ la placa, agarr√© el probador en mis manos y comenc√© a hacer sonar todo lo que pod√≠a alcanzar por cortocircuitos.  Despu√©s de asegurarse de que no parec√≠a corto, conect√≥ un cable USB.  No hay humo, los chips no se calientan, el voltaje en el puerto USB es de 5 voltios, la salida de carga es de 4.2V, el voltaje despu√©s de LDO es exactamente tres voltios.  Parece funcionar </p><br><p>  Incluso cuando est√° completamente alimentado, el dispositivo, por supuesto, no mostr√≥ absolutamente signos de vida.  Ahora necesita respirar el alma: firmware (o "sistema operativo", como algunos fabricantes de relojes: WatchOS, PebbleOS, etc.). </p><br><p>  El siguiente paso en la prueba fue conectar el depurador JLink integrado en el nRF52-DK a trav√©s de la interfaz SWD.  ¬°Conectamos el cableado, ejecutamos JLinkExe y vemos nuestro chip!  Puede comenzar a escribir firmware y probar los bloques restantes de hierro mediante programaci√≥n. </p><br><h2 id="laquooperacionnaya-sistemaraquo-dlya-chasov">  "Sistema operativo" para relojes </h2><br><p>  Para trabajos perif√©ricos de bajo nivel, Nordic ofrece su <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nRF5-SDK</a> , que es adecuado para las series nRF51 y nRF52. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/web/1c6/54b/0cd/1c654b0cd48540efbb8e9a2ab79dc299.png"></a> </p><br><p>SDK             , , NFC   .     Makefile    <code>arm-none-eabi-gcc</code>.        ,       .</p><br>
<p>       .hex-,      nRF52-DK    .   nRF52-DK  ,  Mass Storage Device (),      .hex         .</p><br>
<p>     <code>JLinkExe</code>   GDB-    <code>nrfjprog</code>.</p><br>
<p>        ,   .          ,     ,                 ,            ,      .</p><br>
<p>    ,             .</p><br>
<p><img src="https://habrastorage.org/web/2fe/4fb/faf/2fe4fbfaf96746da8573e732632c6fa8.png"><br>
<em> , -,  ,     .</em></p><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><p><img src="https://habrastorage.org/web/a1f/ee6/9e3/a1fee69e3bee4918babac61db1c25ca8.jpg"></p></div></div><br>
<p>     ,        ,    -   .      API     X-Lib            .             ,        .</p><br>
<p>  :</p><br>
<p><img src="https://thumbs.gfycat.com/BoldThornyBuck-size_restricted.gif"></p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><p><img src="https://thumbs.gfycat.com/ArtisticSoupyAntlion-size_restricted.gif" alt="image"></p></div></div><br>
<p> ,    API  ,    JavaScript (ES 5),                 .   ,  .</p><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JerryScript</a>,         , API      ,     ,    .   ,        ,   :    Date  .., JSON-,       ..</p><br>
<div class="spoiler"><b class="spoiler_title">    JS-</b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Duktape</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Espruino</a></li>
</ul></div></div><br>
<p>   JS  :</p><br>
<p><img src="https://habrastorage.org/web/ac6/a92/c2f/ac6a92c2faab4f3bb18f65b4fa2d8968.jpg"></p><br>
<p>  API          GUI,    , Bluetooth,   ..</p><br>
<p>        ( <code>-O0</code>):</p><br>
<p><img src="https://habrastorage.org/web/a41/e24/f8f/a41e24f8faf84949a14c79d1f9938cea.png"></p><br>
<p>106kB FLASH, 12.8kB RAM.   8kB RAM ‚Äî  (heap)   JavaScript .           . ,   FLASH  nRF52832  512kB,    RAM ‚Äî 64kB.</p><br>
<p> FLASH (120kB)      RAM   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> BLE- SoftDevice.</p><br>
<h2 id="korpus"></h2><br>
<p>    ‚Äî  3D- .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">TinkerCad</a>    3D-.    :</p><br>
<div class="spoiler"><b class="spoiler_title">   USB-  </b><div class="spoiler_text"><p><img src="https://habrastorage.org/web/e66/5fa/e0d/e665fae0d3414e56bead2ff4ff5050e2.jpg"></p></div></div><br>
<p><em> -          3D-,          !</em></p><br>
<h2 id="zaklyuchenie"></h2><br>
<p>       ,         .       ,   ,     ,          .  ,  ,            ,      .</p><br>
<p>         ,     API-  JS-,           JS-,   -  Android.           ,     .    ,        , , Android-   .</p><br>
<p>    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://upverter.com/EP/cdbd8b9abc72b7cd/nRF52-smart-watch/</a><br>
         ,     Github.</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al igual que el autor del art√≠culo anterior, espero que este material empuje o inspire a alguien a sumergirse en el mundo de la electr√≥nica y crear el dispositivo con el que ha estado so√±ando durante mucho tiempo.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espero sus comentarios y preguntas!</font></font></p><br>
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> agreg√≥ una encuesta.</font></font></p></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es404737/">https://habr.com/ru/post/es404737/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es404725/index.html">Intel abandona a Edison, Galileo y Joule</a></li>
<li><a href="../es404727/index.html">Elon Musk habl√≥ sobre c√≥mo se las arregla para ser tan productivo</a></li>
<li><a href="../es404731/index.html">La empresa de alojamiento de Corea del Sur pag√≥ $ 1 mill√≥n a los desarrolladores de la versi√≥n de Linux del cripto ransomware Erebus</a></li>
<li><a href="../es404733/index.html">Conocemos part√≠culas elementales (aparentemente)</a></li>
<li><a href="../es404735/index.html">Un nuevo estudio mostr√≥ que los gatos no eran domesticados como otros animales</a></li>
<li><a href="../es404741/index.html">Evaluaci√≥n de di√≥xido de carbono en una habitaci√≥n con aire acondicionado.</a></li>
<li><a href="../es404745/index.html">Preg√∫ntele a Ethan: ¬øQu√© tan grande debe ser la porci√≥n del universo para expandirse?</a></li>
<li><a href="../es404747/index.html">WikiLeaks public√≥ la documentaci√≥n de la CIA sobre la infecci√≥n de computadoras f√≠sicamente aisladas</a></li>
<li><a href="../es404749/index.html">Microsoft admiti√≥ que a veces desconecta partes de antivirus de terceros</a></li>
<li><a href="../es404751/index.html">Router con funciones VoIP en solo cien</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>