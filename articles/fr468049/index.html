<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§Ωüèø üîä üç® Utilisation de werf pour d√©ployer des graphiques Helm complexes üî¶ üë©üèΩ‚Äçüåæ üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'article est consacr√© au d√©veloppement de graphiques Helm pour Kubernetes √† l'aide de solutions pr√™tes √† l'emploi √† partir de r√©f√©rentiels de graphiq...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Utilisation de werf pour d√©ployer des graphiques Helm complexes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/468049/"><img src="https://habrastorage.org/webt/ea/ps/gb/eapsgbnltm63hd2ntcfco7qxgla.png"><br><br>  L'article est consacr√© au d√©veloppement de graphiques Helm pour Kubernetes √† l'aide de solutions pr√™tes √† l'emploi √† partir de r√©f√©rentiels de graphiques.  Avec cette approche, l'utilisateur applique des recettes communautaires ou les siennes, assurant la mise √† jour en temps opportun des composants standard de tous ses projets et la commodit√© de maintenir les solutions en g√©n√©ral. <br><br>  Une telle fonctionnalit√© pratique est d√©sormais int√©gr√©e √† notre utilitaire werf GitOps, qui devrait simplifier l'ensemble du processus d'exploitation de l'infrastructure pour les applications assembl√©es et d√©ploy√©es sur Kubernetes. <a name="habracut"></a><br><br><h2>  Heaume int√©gr√© </h2><br>  Peut-√™tre que le principal succ√®s de Helm - le "gestionnaire de paquets pour Kubernetes" - n'est pas tant li√© √† ses fonctionnalit√©s qu'au <b>d√©p√¥t de cartes</b> officiel <b>et au support des d√©p√¥ts</b> en g√©n√©ral.  Les recettes et les param√®tres des graphiques sont accompagn√©s d'une √©norme communaut√©.  Les sp√©cialistes prennent en charge les solutions √† jour requises par les utilisateurs finaux.  Chaque graphique du r√©f√©rentiel officiel est standardis√© et bien document√©. <br><br>  Dans des cas triviaux, l'utilisateur n'a m√™me pas besoin de cr√©er un graphique pour d√©ployer l'application: il trouve juste une solution toute faite, lit la documentation, pr√©pare les param√®tres et utilise le graphique officiel. <br><br>  Depuis longtemps, nous utilisons activement Helm inside werf pour d√©ployer l'infrastructure applicative et nous allons maintenant plus loin.  <a href="">Depuis la</a> version <a href="">v1.0.4-alpha.10</a> , des <b>commandes pour travailler avec les d√©pendances et les r√©f√©rentiels de graphiques</b> ont √©t√© ajout√©es √† werf pour abandonner compl√®tement le client Helm. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les commandes principales</a> pour cela: <br><br><ul><li> <code>werf helm repo</code> <br> <br><pre> <code class="plaintext hljs">add Add a chart repository fetch Download a chart from a repository and (optionally) unpack it in local directory init Init default chart repositories configuration list List chart repositories remove Remove a chart repository search Search for a keyword in charts update Update information of available charts locally from chart repositories</code> </pre> </li><li> <code>werf helm dependency</code> <br> <br><pre> <code class="plaintext hljs">build Rebuild the charts/ directory based on the requirements.lock file list List the dependencies update Update charts/ based on the contents of requirements.yaml</code> </pre> </li></ul><br>  De plus, la prise en charge de la <i>r√©f√©rence de graphique a √©t√©</i> ajout√©e √† la <code>werf helm deploy-chart</code> . <br><br>  Et voici √† quoi ressemble toute cette magie en action - plus pr√©cis√©ment, nous montrons ici une comparaison du d√©ploiement du m√™me graphique dans werf (gauche) et dans Helm (droite): <br><br><img src="https://habrastorage.org/webt/qu/ob/ww/quobww_lgdhujjzz0l0kzxm3ick.gif" alt="image"><br><br><h2>  Plus de pratique </h2><br>  Revenons √† la commodit√© d'utiliser des solutions pr√™tes √† l'emploi pour d√©ployer des applications enti√®res - un <b>exemple courant avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WordPress</a></b> .  D√©ployer son graphique Helm vers le cluster Kubernetes √† l'aide de werf pourrait ressembler √† ceci: <br><br><pre> <code class="bash hljs">$ cat &lt;&lt; EOF &gt; values.yaml wordpressBlogName: flant wordpressUsername: admin wordpressPassword: password mariadb: mariadbRootPassword: password EOF $ werf helm deploy-chart --values values.yaml stable/wordpress my-web-app</code> </pre> <br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">D√©monstration d'asciicin√®me</a> . <br><br>  √âtant donn√© que les r√©f√©rentiels contiennent de <b>nombreuses solutions</b> , vous pouvez <b>cr√©er</b> vos propres applications √† partir d'eux sous forme de cubes, o√π les cubes seront les diff√©rents graphiques Helm dont d√©pend tout le syst√®me.  Tr√®s probablement, il vous suffit de configurer correctement les composants selon vos besoins. <br><br>  Par exemple, une application Web n√©cessite une file d'attente, un cache et un stockage de donn√©es.  Comment d√©ployer ces composants via werf? <br><br>  Pour commencer - acc√©l√©rons la recherche de tout ce dont vous avez besoin en utilisant la CLI: <br><br><pre> <code class="bash hljs">$ werf helm repo search queue NAME CHART VERSION APP VERSION DESCRIPTION stable/rabbitmq 6.4.1 3.7.17 Open <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> message broker software that implements the A... stable/rabbitmq-ha 1.31.0 3.7.15 Highly available RabbitMQ cluster, the open <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> messag...</code> </pre> <br>  Par analogie, nous trouverons les composants restants pour tous les r√©f√©rentiels de graphiques enregistr√©s (la liste des r√©f√©rentiels utilis√©s peut √™tre vue en ex√©cutant la <code>werf helm repo list</code> ). <br><br>  Une fois que tout est trouv√©, il ne reste plus qu'√† les ajouter au graphique.  Il existe plusieurs fa√ßons de proc√©der: ajoutez des diagrammes de composants au r√©pertoire des diagrammes ou cr√©ez un fichier <code>requirements.yaml</code> et d√©crivez les d√©pendances, puis interagissez avec eux √† l'aide des <code>werf helm dependency build|list|update</code> sp√©ciales <code>werf helm dependency build|list|update</code> . <br><br>  Illustration du deuxi√®me chemin: <br><br><pre> <code class="bash hljs">$ cat &lt;&lt; EOF &gt; .helm/requirements.yaml dependencies: - name: mysql version: 0.3.4 repository: <span class="hljs-string"><span class="hljs-string">"@stable"</span></span> - name: redis version: 1.1.11 repository: <span class="hljs-string"><span class="hljs-string">"@stable"</span></span> - name: rabbitmq version: 0.6.16 repository: <span class="hljs-string"><span class="hljs-string">"@stable"</span></span> EOF $ werf helm dependency build $ werf deploy --env <span class="hljs-built_in"><span class="hljs-built_in">test</span></span></code> </pre> <br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">D√©monstration d'asciicin√®me</a> . <br><br>  Pendant le processus de d√©ploiement, werf <b>cr√©era toutes les d√©pendances et les suivra</b> avec le reste des ressources - aucune action suppl√©mentaire n'est requise. <br><br>  Par cons√©quent, compte tenu de l'expertise de la communaut√© exp√©riment√©e, vous gagnez beaucoup de temps sur le d√©veloppement et la maintenance des cartes.  Cependant, personne ne vous limite √† utiliser des graphiques publics: apr√®s tout, vous pouvez d√©ployer vos graphiques avec un succ√®s √©gal, dont les configurations sont pr√©par√©es en tenant compte des sp√©cificit√©s requises. <br><br>  <b>La documentation</b> sur les commandes de r√©f√©rentiel et de d√©pendance dans werf est pr√©sent√©e <a href="">ici</a> .  Vous pouvez √©galement √™tre int√©ress√© par la lecture de la documentation pour plus de d√©tails sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©ploiement vers werf</a> et les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">principales diff√©rences avec Helm</a> . <br><br><h2>  Conclusion </h2><br>  L'absence de fonctionnalit√©s essentielles pour nous dans les solutions Open Source existantes nous oblige √† cr√©er les capacit√©s, les liaisons et l'int√©gration correspondantes.  Le projet werf a √©t√© cr√©√© et soutenu, tout d'abord, pour r√©soudre les t√¢ches quotidiennes de nos ing√©nieurs DevOps. <br><br>  A titre d'exemple, nous travaillons depuis longtemps (deuxi√®me ann√©e!) Afin que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">notre proposition</a> <b>de suivi des ressources dans Helm soit</b> accept√©e comme mode alternatif dans la base de code principale du projet (en amont).  La communaut√© a accept√© et soutenu l'id√©e,  beaucoup ont besoin de cette opportunit√©.  Cependant, des progr√®s dans cette direction ont commenc√© dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Helm 3</a> et seulement maintenant ... <br><br>  Jusqu'√† pr√©sent, la mise en ≈ìuvre de cette id√©e dans Helm a √©t√© pratiquement bloqu√©e par les d√©veloppeurs.  Cependant, pendant ce temps, nous avons d√©velopp√© les fonctions correspondantes pour le suivi des ressources dans une biblioth√®que Open Source distincte - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">kubedog</a> - et nous l'utilisons d√©j√† dans werf.  Et √† en juger par l'activit√© sur GitHub, la biblioth√®que a trouv√© un int√©r√™t parmi d'autres utilisateurs de Kubernetes / Helm, ce qui est tr√®s agr√©able. <br><br>  Vous pouvez soutenir notre id√©e (et impl√©mentation) en pla√ßant une √©toile sur le projet kubedog sur GitHub et / ou un coup de pouce dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">num√©ro d'origine</a> dans Helm.  Je vous remercie! <br><br><h2>  PS </h2><br>  Lisez aussi dans notre blog: <br><br><ul><li>  Une s√©rie de notes sur les innovations dans werf: <br><ul><li>  ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Prise en charge de monorepo et multirepo dans werf et qu'est-ce que le Docker Registry a √† voir avec cela</a> ¬ª; </li><li>  ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vous pouvez maintenant assembler des images Docker en werf en utilisant le Dockerfile habituel</a> ¬ª; </li></ul></li><li>  "Un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">regard sobre sur Helm 2:" C'est ce que c'est ... "</a> "; </li><li>  ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Une introduction pratique au gestionnaire de paquets pour Kubernetes - Helm</a> ¬ª; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pr√©sentation de la biblioth√®que kubedog pour le suivi des ressources Kubernetes.</a> " </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr468049/">https://habr.com/ru/post/fr468049/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr468031/index.html">Nous portons un jeu multijoueur de C ++ sur le Web avec Cheerp, WebRTC et Firebase</a></li>
<li><a href="../fr468039/index.html">Meetup Moscou Kubernetes # 6 √† Acronis (Fiztehpark) 10/03/2019</a></li>
<li><a href="../fr468041/index.html">Annonce de l'interface Web de Kubernetes Web View (et un bref aper√ßu des autres interfaces Web pour Kubernetes)</a></li>
<li><a href="../fr468043/index.html">Comment cr√©er un kit d'interface utilisateur √† vendre. √âtapes de d√©veloppement d'un syst√®me de conception commerciale</a></li>
<li><a href="../fr468047/index.html">Utilisation des hi√©rarchies dans lsFusion</a></li>
<li><a href="../fr468051/index.html">VDS avec Windows Server sous licence pour 100 roubles: mythe ou r√©alit√©?</a></li>
<li><a href="../fr468053/index.html">Apprentissage automatique pour votre chasse √† plat. Partie 1</a></li>
<li><a href="../fr468057/index.html">D√©veloppement de syst√®me d'exploitation de type Unix - Multit√¢che et appels syst√®me (7)</a></li>
<li><a href="../fr468059/index.html">Ma deuxi√®me semaine avec Haiku: beaucoup de diamants cach√©s et d'agr√©ables surprises, ainsi que quelques probl√®mes</a></li>
<li><a href="../fr468061/index.html">Cron sur Linux: historique, utilisation et appareil</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>