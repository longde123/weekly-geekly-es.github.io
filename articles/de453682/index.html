<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôå üë®üèæ‚Äç‚úàÔ∏è ü•¶ Entwicklung der einfachsten ‚ÄûFirmware‚Äú f√ºr in Redd installierte FPGAs. Teil 2. Programmcode üå≥ ‚ö°Ô∏è üçÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Deshalb haben wir im letzten Artikel das einfachste Prozessorsystem entwickelt, mit dessen Hilfe wir den an das FPGA des Redd-Komplexes angeschlossene...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Entwicklung der einfachsten ‚ÄûFirmware‚Äú f√ºr in Redd installierte FPGAs. Teil 2. Programmcode</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453682/">  Deshalb haben wir im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">letzten Artikel</a> das einfachste Prozessorsystem entwickelt, mit dessen Hilfe wir den an das FPGA des Redd-Komplexes angeschlossenen RAM-Chip testen wollen.  Heute werden wir ein C ++ - Programm f√ºr diese Hardwareumgebung erstellen und herausfinden, wie dieses Programm eingef√ºgt und vor allem debuggt werden kann. <br><br><img src="https://habrastorage.org/webt/ao/pw/9q/aopw9qsnn52memjdqkmx8zldyec.jpeg"><br><a name="habracut"></a><br>  Das Programm wird in der Eclipse-Umgebung entwickelt.  <b>W√§hlen</b> Sie zum Starten den Men√ºpunkt <b>Tools-&gt; Nios II Software Build Tools f√ºr Eclipse</b> . <br><br><img src="https://habrastorage.org/webt/ye/84/bi/ye84bibxhoqvn0gqdltuhyna8hg.png"><br><br>  Wir m√ºssen ein Projekt und ein BSP daf√ºr erstellen.  Klicken Sie dazu im Projekt-Explorer mit der rechten Maustaste und w√§hlen Sie den Men√ºpunkt <b>Neu-&gt; Nios II-Anwendung und BSP aus Vorlage</b> . <br><br><img src="https://habrastorage.org/webt/7n/tz/kh/7ntzkheuuaqfbg810ub0jai8jmc.png"><br><br>  Die Grundvorlage, auf deren Grundlage das Projekt erstellt wird, wurde bei der Generierung des Prozessorsystems erstellt.  Daher finden wir die Datei, die es enth√§lt. <br><br><img src="https://habrastorage.org/webt/z6/iy/sl/z6iysldjqrihweonoril4dkpxeo.png"><br><br>  Wir werden dem Projekt auch einen Namen geben (ich habe es <b>SDRAMtest</b> ) und den Projekttyp ausw√§hlen.  Ich habe <b>Hello World Small gew√§hlt</b> .  Ich w√ºrde gerne <b>Memory Test</b> w√§hlen, wir f√ºhren einen Memory Test durch, aber jetzt √ºberlegen wir uns eine allgemeine Methode zum Erstellen von Anwendungen.  Daher w√§hlen wir die allgemeine Option. <br><br><img src="https://habrastorage.org/webt/nm/kd/rk/nmkdrk66vtd6raj_iyba8zqbhn0.png"><br><br>  Wir haben zwei Projekte erstellt.  Das erste ist unser Projekt, das zweite ist BSP (Board Support Package, grob gesagt, Bibliotheken f√ºr die Arbeit mit Ger√§ten). <br><br><img src="https://habrastorage.org/webt/dl/j-/fv/dlj-fvk-8ctcmbafxyirhxwnjoo.png"><br><br>  Das erste, was ich normalerweise mache, ist die BSP-Einstellungen zu bearbeiten.  Dazu w√§hle ich das zweite der erstellten Projekte aus, dr√ºcke die rechte Maustaste und w√§hle den Men√ºpunkt <b>Nios II -&gt; BSP Editor</b> . <br><br><img src="https://habrastorage.org/webt/bm/hc/1w/bmhc1w_ocq_qjnjy-2u-wsfruyc.png"><br><br>  Im Editor ist alles in Gruppen unterteilt: <br><br><img src="https://habrastorage.org/webt/3s/fp/27/3sfp27xpalx9sctult8smi6mqus.png"><br><br>  Aber um nicht entlang zu laufen, werde ich die Wurzel des Baums, das Element <b>Einstellungen</b> , ausw√§hlen und alles linear betrachten.  Ich werde auflisten, worauf Sie achten sollten.  Bildschirm mit den Grundeinstellungen: <br><br><img src="https://habrastorage.org/webt/b-/7g/vs/b-7gvsbf8dol4jpg7-coipcdqm8.png"><br><br>  Die Unterst√ºtzung f√ºr das Beenden und die Unterst√ºtzung f√ºr das Entfernen beim Beenden ist deaktiviert, wodurch unn√∂tige Teile von gro√üer Gr√∂√üe aus dem Code entfernt werden. Sie werden jedoch zun√§chst deaktiviert.  Diese Dohlen wurden ausgeschaltet, da ich die Mindestoption <b>Hallo Welt gew√§hlt habe</b> .  Wenn Sie andere Codetypen ausw√§hlen, sollten Sie auch diese Daten entfernen.  Ich kann nicht widerstehen und die C ++ - Unterst√ºtzung aktivieren.  Es ist auch notwendig, die <b>SysID-</b> Pr√ºfung zu entfernen, da sonst nichts funktioniert.  Tatsache ist, dass ich bei der Erstellung des Hardwaresystems den entsprechenden Block nicht hinzugef√ºgt habe.  Die restlichen Einstellungen sind selbsterkl√§rend und wurden nicht ge√§ndert.  Eigentlich habe ich auch noch keine anderen Einstellungen ge√§ndert.  Wenig sp√§ter werden wir hierher zur√ºckkehren, aber jetzt dr√ºcken wir die Schaltfl√§che Generieren.  Wir erstellen eine neue Version von BSP basierend auf den vorgenommenen Einstellungen.  Klicken Sie am Ende auf Beenden. <br><br>  Jetzt beginnt der Spa√ü.  So bauen Sie ein Projekt zusammen.  Dr√ºcken Sie die √ºbliche <b>Strg + B</b> - wir erhalten eine Fehlermeldung.  Dekodierungsfehler Nr.: <br><br><img src="https://habrastorage.org/webt/1i/vo/15/1ivo15ndq_u8-t_2obxebgrwf7y.png"><br><br>  Auch in der Konsole ist nichts Vern√ºnftiges: <br><br><img src="https://habrastorage.org/webt/fm/by/lz/fmbylzar83wnwwchcjcfys_sjb0.png"><br><br>  W√§hlen Sie das <b>Build-Projekt</b> f√ºr das <b>SDRAMtest-</b> Projekt aus. Wir erhalten eine angemessene Erkl√§rung: <br><br><img src="https://habrastorage.org/webt/cc/tr/_t/cctr_tjdwtd7elwqbfiuws-lxc8.png"><br><br>  In der Tat sind nicht funktionierende Vorlagen die Corporate Identity von Quartus.  Dies ist ein weiterer Grund, warum ich mich nicht f√ºr <b>Memory Test entschieden habe</b> .  Es l√§uft immer mehr.  Hier ist klar, worum es geht. <br><br>  Diese Funktion der Datei <b>alt_putstr.c schl√§gt fehl</b> : <br><br><pre><code class="plaintext hljs">/* * Uses the ALT_DRIVER_WRITE() macro to call directly to driver if available. * Otherwise, uses newlib provided fputs() routine. */ int alt_putstr(const char* str) { #ifdef ALT_SEMIHOSTING return write(STDOUT_FILENO,str,strlen(str)); #else #ifdef ALT_USE_DIRECT_DRIVERS ALT_DRIVER_WRITE_EXTERNS(ALT_STDOUT_DEV); return ALT_DRIVER_WRITE(ALT_STDOUT_DEV, str, strlen(str), 0); #else return fputs(str, stdout); #endif #endif }</code> </pre> <br>  Wir werden es sp√§ter irgendwie beheben (daf√ºr m√ºssen wir das Hardwaresystem komplizieren).  Heute brauchen wir es einfach nicht.  Ersetzen Sie ihren K√∂rper durch <b>R√ºckgabe 0</b> .  Das Projekt beginnt sich zu versammeln. <br><br>  Gro√üartig.  Wir haben bereits eine fertige <b>Elf-Datei</b> (auch wenn sie keine n√ºtzlichen Funktionen ausf√ºhrt) und wir haben Ger√§te, mit denen Sie <b>die Hex-Datei hochladen</b> k√∂nnen (erinnern Sie sich, wie wir dem Quartus-Compiler mitgeteilt haben, dass RAM-Daten durch Einrichten von Onchip RAM daraus geladen werden sollen?).  Wie konvertieren wir <b>Elfen</b> in <b>Hex</b> ?  Sehr einfach.  Wir machen uns an das Arbeitsprojekt, dr√ºcken die rechte Maustaste und w√§hlen den Men√ºpunkt <b>Make Targets-&gt; Build</b> : <br><br><img src="https://habrastorage.org/webt/0-/as/_n/0-as_nxv3f8acgl0thqxucmwrpk.png"><br><br>  Versuchen Sie im <b>angezeigten</b> Fenster zun√§chst, die erste Option ( <b>mem_init_install</b> ) auszuw√§hlen: <br><br><img src="https://habrastorage.org/webt/ew/pl/gb/ewplgbs-_lyriekrzkll7-xg2g0.png"><br><br>  Nichts wird passieren.  Aus der uns gegebenen Fehlermeldung erfahren wir jedoch, wie das Projekt f√ºr Quartus abgeschlossen werden kann: <br><br><pre> <code class="plaintext hljs">../SDRAMtest_bsp//mem_init.mk:230: *** Deprecated Makefile Target: 'mem_init_install'. Use target 'mem_init_generate' and then add mem_init/meminit.qip to your Quartus II Project. Stop.</code> </pre><br>  Wir <b>w√§hlen</b> <b>Build</b> zum Zweck von <b>mem_init_generate</b> aus. <b>Danach</b> (kurz danach !!!) f√ºgen wir die angegebene <b>qip-Datei</b> zum Hardwareprojekt hinzu (wir haben bereits gelernt, wie man Dateien hinzuf√ºgt, als wir dem Projekt ein Prozessorsystem hinzugef√ºgt haben). <br><br><img src="https://habrastorage.org/webt/jo/bz/eb/jobzebo0suitvzz6siwy7fqdddg.png"><br><br>  Nun, die <b>Hex-Datei</b> selbst kann auch mit Ihren H√§nden gef√ºhlt werden.  Da ist er: <br><br><img src="https://habrastorage.org/webt/kb/rv/kj/kbrvkjajtxtk0uf2to-fzl_ec7c.png"><br><br>  Gro√üartig.  Wir haben alles, um das Programm mit echten Funktionen zu f√ºllen.  Wir gehen zur Datei <b>hello_world_small.c</b> .  Ehrlich gesagt bin ich ein bisschen beleidigt, wenn ich mit reinem C arbeite.  Daher werde ich es cpp umbenennen.  Damit nichts schief geht, f√ºge ich dem vorhandenen Text einen Zauber hinzu: <br><br><img src="https://habrastorage.org/webt/qu/4a/fp/qu4afpj9nqcdns7fz0yg1qpme28.png"><br><br><div class="spoiler">  <b class="spoiler_title">Gleicher Text:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">extern "C" { #include "sys/alt_stdio.h" } int main() { alt_putstr("Hello from Nios II!\n"); /* Event loop never exits. */ while (1); return 0; }</code> </pre><br></div></div><br>  Es ist wichtig, den Vorgang " <b>Projekt bereinigen"</b> auszuf√ºhren, nachdem der Dateityp ersetzt wurde. Andernfalls zeigt der Compiler Fehlermeldungen an, dass die <b>* .c-</b> Datei aufgrund einiger zwischengespeicherter Informationen nicht gefunden wurde. <br><br>  Wir werden den Ged√§chtnistest einfach machen.  Ich habe nicht die Aufgabe, dem Leser beizubringen, den RAM-Chip richtig zu testen.  Wir stellen nur oberfl√§chlich sicher, dass die Adress- und Datenbusse nicht klebrig sind und keine Unterbrechungen aufweisen.  Das hei√üt, wir schreiben in jede Zelle alle Nullen und die Adresse der Zelle.  Unsere Aufgabe ist es, Arbeitscode zu erstellen, und alles andere (andere F√ºll- und Verz√∂gerungskonstanten, um zu √ºberpr√ºfen, ob die Daten neu generiert werden) sind Implementierungsdetails, die den Text komplizieren, aber sein Wesen nicht √§ndern. <br><br>  Beginnen wir mit einer einfachen und nat√ºrlichen Frage: ‚ÄûWo befindet sich das SDRAM im Adressraum?‚Äú  Ich erinnere mich, dass wir die automatische Adresszuweisungsfunktion aufgerufen haben, aber nicht einmal untersucht haben, welche Adressen tats√§chlich zugewiesen wurden.  Tats√§chlich werden wir auch jetzt nicht dorthin schauen.  Alle notwendigen Informationen sind in der Datei: <br>  <b>... \ SDRAMtest_bsp \ system.h</b> . <br><br><div class="spoiler">  <b class="spoiler_title">Als Ergebnis erhalten wir den folgenden Code:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">extern "C" { #include "sys/alt_stdio.h" #include &lt;stdint.h&gt; #include "../SDRAMtest_bsp/system.h" #include &lt;altera_avalon_pio_regs.h&gt; } int main() { bool bRes = true; volatile static uint32_t* const pSDRAM = (uint32_t*)NEW_SDRAM_CONTROLLER_0_BASE; static const int sizeInDwords = NEW_SDRAM_CONTROLLER_0_SPAN / sizeof (uint32_t); //  for (int i=0;i&lt;sizeInDwords;i++) { pSDRAM [i] = 0; } //   for (int i=0;i&lt;sizeInDwords;i++) { if (pSDRAM [i] != 0) { bRes = false; } } //   for (int i=0;i&lt;sizeInDwords;i++) { pSDRAM [i] = i; } //    for (int i=0;i&lt;sizeInDwords;i++) { if (pSDRAM [i] != i) { bRes = false; } } if (bRes) { IOWR_ALTERA_AVALON_PIO_DATA (PIO_0_BASE,0x01); } else { IOWR_ALTERA_AVALON_PIO_DATA (PIO_0_BASE,0x02); } /* Event loop never exits. */ while (1); return 0; }</code> </pre><br></div></div><br>  Wir sammeln die <b>Hex-Datei</b> (ich erinnere Sie daran durch diesen Dialog): <br><br><img src="https://habrastorage.org/webt/ig/qk/az/igqkaztuj29lzpy8oguoehfz16s.png"><br><br>  Dann kompilieren wir die Ausr√ºstung in Quartus und geben den Programmierer ein, um die resultierende ‚ÄûFirmware‚Äú mit dem resultierenden initialisierten Programmcode in den Chip zu laden. <br><br><img src="https://habrastorage.org/webt/6a/qr/kb/6aqrkbup6jtuombvl9uhy5z_ozi.png"><br><br>  Gie√üen Sie die ‚ÄûFirmware‚Äú ein und erhalten Sie eine Meldung, dass das System nur dann funktioniert, wenn es mit JTAG verbunden ist (Funktionen der SDRAM-Kernellizenz in der kostenlosen Entwicklungsumgebung).  F√ºr den Fall von Redd ist dies eigentlich nicht kritisch.  Dieser JTAG ist die ganze Zeit da. <br><br><img src="https://habrastorage.org/webt/mt/gm/7w/mtgm7wkwrrey2b67zwawvdxnxkw.png"><br><br>  Die RAM-Testergebnisse sind am Stecker, den Kontakten C21 (erfolgreich) oder B21 (Fehler) zu sehen.  Wir verbinden sie mit einem Oszilloskop. <br><br><img src="https://habrastorage.org/webt/uz/cc/ao/uzccaoobipzc-cccy68lbalfwyc.png"><br><br>  Beide Ausg√§nge sind auf Null.  Hier stimmt etwas nicht.  Es bleibt zu verstehen, was genau.  Tats√§chlich ist ein nicht funktionsf√§higes Programm einfach gro√üartig, da wir jetzt anfangen werden, das JTAG-Debugging zu lernen.  Wir zielen auf das Projekt ab, w√§hlen <b>Debug As-&gt; Nios II Hardware</b> . <br><br><img src="https://habrastorage.org/webt/ge/lq/il/gelqilnvpmdgmpmijnbdxrw4p7a.png"><br><br>  Beim ersten Mal findet das System die Hardware nicht.  Es sieht so aus (beachten Sie das rote Kreuz in der hervorgehobenen Registerkarten√ºberschrift): <br><br><img src="https://habrastorage.org/webt/wf/ou/-4/wfou-49ykdeytjz3sbkuvepobyo.png"><br><br>  Wechseln Sie zur Registerkarte Zielverbindung und aktivieren <b>Sie das</b> Kontrollk√§stchen <b>Nicht √ºbereinstimmende System-ID ignorieren</b> .  Bei nachfolgenden Experimenten musste ich manchmal auch den <b>Zeitstempel "Nicht √ºbereinstimmendes System ignorieren" setzen</b> .  Nur f√ºr den Fall, ich werde es im Bild nicht mit einem roten, sondern mit einem gelben Rahmen hervorheben, um zu betonen, dass es nicht notwendig ist, es jetzt zu installieren, aber wenn die <b>Debug-</b> Schaltfl√§che nicht aktiviert ist, kann es Zeit sein, es zu installieren. <br><br><img src="https://habrastorage.org/webt/h9/bi/be/h9bibeo2ixvlgkwc_ey30-3vow8.png"><br><br>  <b>√úbernehmen</b> ( <b>√úbernehmen</b> ) und dann auf Verbindungen <b>aktualisieren</b> (diese Schaltfl√§che ist ausgeblendet, Sie m√ºssen einen Bildlauf durchf√ºhren): <br><br><img src="https://habrastorage.org/webt/2r/yu/sa/2ryusa_heconi7hmz4zmmf0pec0.png"><br><br>  In der Liste wird ein Debugger angezeigt. Klicken Sie auf <b>Debuggen</b> ... <br><br><img src="https://habrastorage.org/webt/jx/iz/py/jxizpyxvk1r6efvhgahsx5yxica.png"><br><br>  Wir haben bei der <b>main ()</b> -Funktion angehalten.  Falls gew√ºnscht, k√∂nnen Sie am Ende des Algorithmus einen Haltepunkt setzen und pr√ºfen, ob das Programm diesen erreicht: <br><br><img src="https://habrastorage.org/webt/dv/yb/4u/dvyb4u8bdirwyd_vsx6mncxjhd4.png"><br><br>  F√ºhren Sie das Programm aus: <br><br><img src="https://habrastorage.org/webt/q0/dn/qp/q0dnqpvwdy_ervdrwibehw4wukm.png"><br><br>  Haltepunkt hat nicht funktioniert.  Lassen Sie uns das Programm stoppen und sehen, wo es ausgef√ºhrt wird. <br><br><img src="https://habrastorage.org/webt/mb/gw/aj/mbgwajwypeb5jrbc6pse9zp21tw.png"><br><br>  Alles ist schlecht.  Das Programm st√ºrzte eindeutig ab.  Wenn Sie nacheinander Haltepunkte anordnen, dann anhalten (mit der roten Schaltfl√§che ‚ÄûStop‚Äú) und das Programm neu starten (mit der Bug-Schaltfl√§che), finden Sie den Problembereich. <br><br>  Alles stirbt, wenn diese Zeile f√ºr das allererste Element ausgef√ºhrt wird: <br><br><img src="https://habrastorage.org/webt/jq/oq/fv/jqoqfvwqcfb0vel6ljtj4cg9t2i.png"><br><div class="spoiler">  <b class="spoiler_title">Gleicher Text:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> for (int i=0;i&lt;sizeInDwords;i++) { if (pSDRAM [i] != 0) { bRes = false; } }</code> </pre><br></div></div><br>  Aus Sicht von C ++ ist hier alles sauber.  Wenn Sie jedoch den zerlegten Code √∂ffnen, k√∂nnen Sie feststellen, dass dort zu viele einheitliche Befehle vorhanden sind.  Es scheint, dass der Code sich selbst gel√∂scht hat.  Und er k√∂nnte dies tun, wenn der Linker es in SDRAM einf√ºgt (dessen Inhalt dieser Code √ºberschreibt). <br><br><img src="https://habrastorage.org/webt/-q/_d/pq/-q_dpqueoo5lvsnz6mq8p3em_ju.png"><br><br>  Wir beenden das Debuggen und schlie√üen die Debugging-Perspektive. <br><br><img src="https://habrastorage.org/webt/cw/0g/1g/cw0g1gt_n_tinl5izm4pvz6v2hq.png"><br><br>  Wir gehen zum BSP-Editor, in dem wir uns am Anfang dieses Artikels befanden, aber zur Registerkarte <b>Linker Script</b> .  Wenn ich diese Registerkarte ganz am Anfang korrigieren w√ºrde, k√∂nnte ich die Technik der Eingabe des JTAG-Debugging nicht zeigen (und die gesamte Leistungsf√§higkeit im Vergleich zur einfachen Debugging-Ausgabe hervorheben, da mir die Tatsache des gestauten Codes w√§hrend des JTAG-Debugging aufgefallen ist).  So ist es.  Ein guter Linker speichert alles, dessen Gr√∂√üe gr√∂√üer ist. <br><br><img src="https://habrastorage.org/webt/uf/ij/li/ufijli2wjemuirgicymujvon-ym.png"><br><br>  Wir leiten alles an <b>onchip_memory weiter</b> ... Jetzt haben wir SDRAM - es ist nur ein St√ºck Speicher, dessen Leistung uns noch nicht garantiert wurde.  Sie k√∂nnen es keinen automatisierten Compileraktionen geben. <br><br><img src="https://habrastorage.org/webt/1i/11/k8/1i11k8pde4xbyl73v-gutl3rqwm.png"><br><br>  Wir bauen <b>bsp</b> neu <b>auf</b> , bauen das Projekt neu auf.  Muss ich das Speicherabbild neu erstellen und das FPGA √ºberlasten?  Dann wird es f√ºr halbautonome Arbeit notwendig sein, aber w√§hrend das Debuggen l√§uft - nein.  Eine neue Version des Programms wird sofort in den Arbeitsspeicher geladen, wenn eine neue Debugging-Sitzung beginnt.  Damit beim n√§chsten Laden des FPGA der Debugger nicht gestartet werden muss, muss am Ende des Debuggens eine neue <b>HEX-Datei erstellt werden,</b> und es ist w√ºnschenswert, die FPGA- ‚ÄûFirmware‚Äú damit zusammenzusetzen. <br><br>  F√ºr den neuen Code wurde ein Haltepunkt erreicht, das Testergebnis ist <b>wahr</b> : <br><br><img src="https://habrastorage.org/webt/fo/t6/xh/fot6xhtlgjo0_rs89vzidyjngxw.png"><br><br>  Das Oszilloskop hat sich am√ºsiert: Der gelbe Strahl ist in Einheit geflogen. <br><br><img src="https://habrastorage.org/webt/6j/mt/hl/6jmthlphaxtdnzhcmxyooxroxyo.png"><br><br>  Test bestanden.  Lassen Sie uns etwas knifflig werden und gleichzeitig die Systemleistung √ºberpr√ºfen.  Machen wir das Finale so: <br><br><pre> <code class="plaintext hljs"> //    GPIO if (bRes) { while (true) { IOWR_ALTERA_AVALON_PIO_DATA (PIO_0_BASE,0x01); IOWR_ALTERA_AVALON_PIO_DATA (PIO_0_BASE,0x00); } } else { while (true) { IOWR_ALTERA_AVALON_PIO_DATA (PIO_0_BASE,0x02); IOWR_ALTERA_AVALON_PIO_DATA (PIO_0_BASE,0x00); } }</code> </pre><br>  Infolgedessen haben wir einen solchen M√§ander am Oszilloskop (alles wurde durch eine lange Schleife verbunden, so dass eine kapazitive Spitze in der zweiten Zeile erschien, achten Sie nicht darauf): <br><br><img src="https://habrastorage.org/webt/ff/w1/te/ffw1tetcbq252-1bqdhsswrtkl4.png"><br><br>  Das Ergebnis ist eine Frequenz von ungef√§hr 8,3 MHz bei einer Taktfrequenz von 50 MHz, ohne den Prozessorkern zu optimieren und den Programmcode zu optimieren.  Das hei√üt, der Zugriff auf die Ports erfolgt mit einer Frequenz, die etwas h√∂her als 16 MHz ist, was einem Drittel der Systemfrequenz entspricht.  Nicht, dass es v√∂llig anders gewesen w√§re, aber besser als 4 MHz bei einer Taktfrequenz von 925 MHz f√ºr Cyclone V SoC ... Nein, der NIOS II-Prozessor selbst ist um ein Vielfaches langsamer als der Cyclone ARM mit f√ºnftem Kern, aber der Prozessor, wie gesagt , wir haben x64 im System, hier brauchen wir den Kernel mehr, der die Logik des Eisens liefert.  Und diese Logik wird genau durch die Arbeit mit Ports bereitgestellt.  Wenn die Arbeit mit Ports langsam ist, ist alles andere regelm√§√üig inaktiv und wartet darauf, dass der Bus seine Arbeit beendet.  Die aufgedeckten Merkmale sind die Zugriffsbeschr√§nkung des Prozessors auf die Ports, jedoch nicht auf die gesamte Hardware.  Wie die Arbeit als Ganzes umgesetzt werden soll, werden wir im n√§chsten Artikel betrachten. <br><br><h2>  Fazit </h2><br>  Der Artikel zeigt, wie Sie ein Projekt in C ++ f√ºr die einfachste Prozessorumgebung erstellen und konfigurieren, die f√ºr den Redd-Komplex entwickelt wurde.  Die Methoden f√ºr den Zugriff auf das Ger√§t sowie die JTAG-Debugging-Technik werden gezeigt.  Laden Sie hier das Hardware- / Software-Kit herunter, das Sie beim Schreiben des Artikels erhalten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">haben</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de453682/">https://habr.com/ru/post/de453682/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de453666/index.html">Wie ich ein unbemanntes Taxi fuhr</a></li>
<li><a href="../de453668/index.html">10 Fehler eines jungen RO (Teil I - drei Fehler)</a></li>
<li><a href="../de453672/index.html">CardInfo - API zur Bestimmung des Logos, der Farben der Bank und anderer Dinge anhand der Kartennummer</a></li>
<li><a href="../de453676/index.html">Verbindung zu Windows √ºber SSH wie unter Linux</a></li>
<li><a href="../de453678/index.html">So sehen Sie Nachhall oder Video√ºbertragung durch Ton durch Wasser - 2</a></li>
<li><a href="../de453686/index.html">Sicherheitswoche 22: Bedrohungsstatistiken, Bankentrojaner und beliebte Exploits</a></li>
<li><a href="../de453688/index.html">Java ist nicht nur ein blutiges Unternehmen, sondern auch schnell latenzempfindliche Anwendungen</a></li>
<li><a href="../de453692/index.html">3D Game Shader f√ºr Anf√§nger: Effekte</a></li>
<li><a href="../de453694/index.html">Stellen Sie wie unter Linux eine Verbindung zu Windows √ºber SSH her</a></li>
<li><a href="../de453696/index.html">Winkel-Zwei-Wege-Bindung, etwas verst√§ndnisvoller</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>