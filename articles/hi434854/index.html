<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тЭО ЁЯС╢ЁЯП╝ ЁЯдо DIY рдХрд░рддреЗ-рдХрд░рддреЗ-рдЦреБрдж рдЕрдВрддрд░рд┐рдХреНрд╖ рдпрд╛рди рдирд┐рдпрдВрддреНрд░рдг рдХрдХреНрд╖ ЁЯХ╢я╕П ЁЯШГ ЁЯМЮ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдирдорд╕реНрдХрд╛рд░ рдкреНрд░рд┐рдп рдкрд╛рдардХреЛрдВ! 

 рдПрдХ рд╡рд┐рдЪрд╛рд░ рдореБрдЭреЗ рдпрд╣рд╛рдВ рдЖрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдПрдХ рдЕрдВрддрд░рд┐рдХреНрд╖ рдпрд╛рди рдХреЗ рд▓рд┐рдП рдирд┐рдпрдВрддреНрд░рдг рдХрдХреНрд╖ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВред рдХреЛ USBред рдореВрд▓ рдЪрд╛рд▓рдХ рд╕рдорд░реНрдерди рдХреЗ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DIY рдХрд░рддреЗ-рдХрд░рддреЗ-рдЦреБрдж рдЕрдВрддрд░рд┐рдХреНрд╖ рдпрд╛рди рдирд┐рдпрдВрддреНрд░рдг рдХрдХреНрд╖</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434854/"><img src="https://habrastorage.org/webt/jq/jk/xz/jqjkxzwpn74xwt3quxzwbzwcxoa.jpeg"><br>  рдирдорд╕реНрдХрд╛рд░ рдкреНрд░рд┐рдп рдкрд╛рдардХреЛрдВ! <br><br>  рдПрдХ рд╡рд┐рдЪрд╛рд░ рдореБрдЭреЗ рдпрд╣рд╛рдВ рдЖрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдПрдХ рдЕрдВрддрд░рд┐рдХреНрд╖ рдпрд╛рди рдХреЗ рд▓рд┐рдП рдирд┐рдпрдВрддреНрд░рдг рдХрдХреНрд╖ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВред  рдХреЛ USBред  рдореВрд▓ рдЪрд╛рд▓рдХ рд╕рдорд░реНрдерди рдХреЗ рд╕рд╛рдеред  рдХрд╕реНрдЯрдо рдЫрд┐рдкрд╛рдИред  рдЫрдбрд╝реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╕рдм рдХреБрдЫ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдмрд┐рдирд╛ рдХрд┐рд╕реА рдирд╛рдЪ рдФрд░ рддрдВрдмреВ рдХреЗред  рдирддреАрдЬрддрди, рд╣рдореЗрдВ рдЕрдВрддрд░рд┐рдХреНрд╖ рд╕рд┐рдореБрд▓реЗрдЯрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд░рд╛рдХреНрд╖рд╕реА "рдЧреЗрдордкреИрдб" рдорд┐рд▓рд╛ред  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдЦреБрдж рдХреЗ рд▓рд┐рдП рдиреНрдпрд╛рдпрд╛рдзреАрд╢ред <br><a name="habracut"></a><br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдореБрдЭреЗ рдереЛрдбрд╝рд╛ рдЕрдВрджрд╛рдЬрд╛ рдерд╛ рдХрд┐ рдЕрдВрдд рдореЗрдВ рдХреНрдпрд╛ рд╣реЛрдЧрд╛ред  рдореБрдЭреЗ рджреЛ рдореБрдЦреНрдп рдЬреЙрдпрд╕реНрдЯрд┐рдХ рдЪрд╛рд╣рд┐рдП рдереЗ, рдЬреИрд╕реЗ рд╕реЛрдпреВрдЬрд╝-рдПрдордПрд╕, рдХреБрдЫ рд╕реНрд╡рд┐рдЪ, рдмрдЯрди рдФрд░ рдХрдИ рдбрд┐рд╕реНрдкреНрд▓реЗред <br><br>  рдЕрдкрдиреА рддрд╛рд▓рд┐рдХрд╛ рдХреА рдХрд╛рд░реНрдпрд╢реАрд▓ рд╕рддрд╣ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдореИрдВрдиреЗ рдХрдВрд╕реЛрд▓ рдХреА рдЪреМрдбрд╝рд╛рдИ рдЪреМрдбрд╝рд╛рдИ рдФрд░ рдЧрд╣рд░рд╛рдИ 500 * 300 рдорд┐рдореА рдЪреБрдиреАред  рдФрд░ рдирд┐рд░реНрдорд╛рдг рд╕рд╛рдордЧреНрд░реА рдХреА рддрд▓рд╛рд╢ рдореЗрдВ рдирд┐рд░реНрдорд╛рдг рдЧреЛрджрд╛рдореЛрдВ рдФрд░ рджреБрдХрд╛рдиреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдлрд╡рд╛рд╣ рдлреИрд▓рд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдЙрдиреНрд╣реЛрдВрдиреЗ 125 рдорд┐рдореА рдХреА рдКрдВрдЪрд╛рдИ рдХреЛ рдЪреБрдирд╛ред  рдирддреАрдЬрддрди, рдореИрдВрдиреЗ 4 рдорд┐рдореА рдкреНрд▓рд╛рдИрд╡реБрдб рдХреА рдПрдХ рд╢реАрдЯ рдЕрдзрд┐рдЧреНрд░рд╣рд┐рдд рдХреА, 20 * 12 рдорд┐рдореА рдФрд░ рдПрдХ рдмреЛрд░реНрдб 120 * 20 рдорд┐рдореАред <br><br>  рдХреИрдб рдореЗрдВ, рд░рд┐рдореЛрдЯ рдХрдВрдЯреНрд░реЛрд▓ рдХрд╛ рдПрдХ рд╕реНрдХреЗрдЪ рдЬрд▓реНрджреА рд╕реЗ рд╕реНрдХреЗрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рдФрд░ рдореИрдВрдиреЗ рдЗрд╕реЗ рдмрд╣реБрдд рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдПрдХ рдкреЗрдбрд╝ рдореЗрдВ рдХрд┐рдпрд╛ред  рддреАрди рдорд╣реАрдиреЗред  рд╕рдкреНрддрд╛рд╣рд╛рдВрдд рдкрд░ред  рдФрд░ рдЗрд╕рд▓рд┐рдП рдирд╣реАрдВ рдХрд┐ рдЙрдиреНрд╣реЛрдВрдиреЗ рдПрдХ рдЖрд░рд╛рдзрдирд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрддрдиреА рдЧрдВрднреАрд░рддрд╛ рд╕реЗ рдХрд╛рдо рдХрд┐рдпрд╛, рдмрд▓реНрдХрд┐ рд╕рдордп рдХреА рдХрдореА рдХреЗ рдХрд╛рд░рдгред  рдЕрдВрддрд░рд┐рдХреНрд╖ рдпрд╛рди рдпрд╛ рд╡рд┐рдорд╛рди рдХреЗ рдЕрд╕рд▓реА рдкреИрдирд▓ рдХреЗ рд░рдВрдЧ рдХреЗ рд╕рдорд╛рди, рдкреИрдирд▓ рдХреЛ рддрд╛рдордЪреАрдиреА рдХреЗ рд╕рд╛рде рдкреЗрдВрдЯ, рд╕реИрдВрдб рдФрд░ рдкреЗрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br><img src="https://habrastorage.org/webt/oa/oz/ck/oaozck0uudattfk5yl0mhztmx4o.jpeg"><br><br>  рд▓реЗрдХрд┐рди рдЕрднреА рдХреЗ рд▓рд┐рдП, рдкреЗрдВрдЯрд┐рдВрдЧ рдХрд╛ рдХрд╛рдо рдПрдХ рддрд░рдл рдЫреЛрдбрд╝ рджреЗрдВ рдФрд░ рдореИрдВ рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХ рд╕реНрдЯрдлрд┐рдВрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░реВрдВрдЧрд╛ред <br><br>  рдЕрд▓реА рдкрд░ рд░реЗрдбрд┐рдпреЛ рдХреЗ рдкреБрд░реНрдЬреЗ рдЦрд░реАрджреЗ рдЧрдПред  рдЬреЙрдпрд╕реНрдЯрд┐рдХ рдХреЗ рд░реВрдк рдореЗрдВ, рдореИрдВрдиреЗ рдпреЗ рдкрд╛рдпрд╛ред  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдРрд╕реЗ рдЬреЙрдпрд╕реНрдЯрд┐рдХ рдХреЗ рд╕рд╛рде рд╕реНрдерд┐рддрд┐ рдПрдХ рдкреВрд░реНрдг рд╕реАрдо рд╣реИред  рдФрджреНрдпреЛрдЧрд┐рдХ рд╕рдорд╛рдзрд╛рди рдмрд╣реБрдд рдорд╣рдВрдЧреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╕рд╕реНрддреЗ рд╣реИрдВ, рдЦрд┐рд▓реМрдиреЗ рдХреЗ рд░реВрдк рдореЗрдВ рдЖрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рд▓рд┐рдП рдЦрд░рд╛рдм рд╣реИрдВред  рдпреЗ рдХрд╛рдлреА рдЙрдЪреНрдЪ рдЧреБрдгрд╡рддреНрддрд╛ рд╡рд╛рд▓реЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реЗ рдХрд┐рддрдиреЗ рд╕рдордп рддрдХ рд░рд╣реЗрдВрдЧреЗ, рдЗрд╕рдХреА рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рд╣реИред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/n-/4c/96/n-4c96az3dh--wj0w8ir1cqz1qw.jpeg"></div><br>  рдмрд╛рдХреА рдЫреЛрдЯреА рдЪреАрдЬрд╝реЛрдВ рд╕реЗ рд╕рдорд╕реНрдпрд╛ рдирд╣реАрдВ рд╣реБрдИред  рдирд┐рдпрдВрддреНрд░рдХ рдиреЗ STM32 рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ред  рдЬреЙрдпрд╕реНрдЯрд┐рдХ рдХреЗ рд▓рд┐рдП рдПрдХ рдПрдбреАрд╕реА рдХреЗ рд░реВрдк рдореЗрдВ, 16-рдмрд┐рдЯ ADS1118ред  рдПрдХ 12 рд╡реА рдмрд┐рдЬрд▓реА рдХреА рдЖрдкреВрд░реНрддрд┐ рднреА рдЦрд░реАрджреА рдЧрдИ рдереАред рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рд╡реЛрд▓реНрдЯреЗрдЬ рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдореБрдЭреЗ "рд╢рд╛рд╣" рд╕реЗ рдПрдХ рдИрдВрдзрди рдЧреЗрдЬ рдорд┐рд▓рд╛, рдЬрд┐рд╕реЗ рдореИрдВ рдпрд╣рд╛рдВ рд╕рдВрд▓рдЧреНрди рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ред <br><br><img src="https://habrastorage.org/webt/jz/0k/zq/jz0kzqxm-89ytb2bmexgkdqkm5i.jpeg"><br>  <i>рддрд╕реНрд╡реАрд░ рдореЗрдВ, рдмрд┐рдЬрд▓реА рдХреА рдЖрдкреВрд░реНрддрд┐, 5 рдФрд░ 3.3 V, STM32, MCP23017, ADS1118 рдХреЗ рд▓рд┐рдП рд╕реНрдЯреЗрдмрд▓рд╛рдЗрдЬрд░реНрд╕</i> <br><br>  рдирд┐рдпрдВрддреНрд░рдХ 100-рдкрд┐рди STM32F407VET6, рдЗрд╕рд╕реЗ рдЬреБрдбрд╝рд╛: <br><br>  4 рдкрджреЛрдВ рдХреЗ рд▓рд┐рдП 2 рдЪрдпрдирдХрд░реНрддрд╛ <br>  1 рдЪрд░ рдЕрд╡рд░реЛрдз рдХрд░рдиреЗрд╡рд╛рд▓рд╛ <br>  2 рдПрдХреНрд╕рд▓ рд╕реНрд╡рд┐рдЪ <br>  4 рдореБрдЦреНрдп рдХреБрд▓реНрд╣рд╛рдбрд╝рд┐рдпреЛрдВ <br>  2 рд╕рд╣рд╛рдпрдХ рдХреБрд▓реНрд╣рд╛рдбрд╝рд┐рдпреЛрдВ <br>  2 рдирд┐рдпрдВрддреНрд░рдг рдзреБрд░реЛрдВ <br>  4 рдХреБрдВрдЬреА рд╕реНрд╡рд┐рдЪ, 2 рдмрдЯрди рдкреНрд░рддреНрдпреЗрдХ <br>  рдПрд▓рдИрдбреА рдХреЗ рд╕рд╛рде 20 рдмрдЯрди <br>  рдПрд▓рдИрдбреА рдХреЗ рд╕рд╛рде 4 рдореБрдЦреНрдп рд╕реНрд╡рд┐рдЪ <br>  рдПрд▓рдИрдбреА рдХреЗ рд╕рд╛рде 2 рдХрд╡рдХ рдмрдЯрди <br>  2 рдЯрд╛рдЗрдорд░ рдмрдЯрди <br>  рдПрд▓рдИрдбреА рдХреЗ рд╕рд╛рде 3 рд╕реНрд╡рд┐рдЪ <br>  13 рд╕реНрд╡рд┐рдЪ <br>  2 ADS1118 (ADC) <br>  4 MAX7219 (8-рдЕрдВрдХреАрдп рдПрд▓рдИрдбреА рдбрд┐рд╕реНрдкреНрд▓реЗ) <br>  2 TM1637 (рдкреНрд░рджрд░реНрд╢рди рдШрдВрдЯреЗ) <br>  1 PCF8574 (I / O рд╡рд┐рд╕реНрддрд╛рд░рдХ, рдЪрд░рд┐рддреНрд░-рд╕рдВрд╢реНрд▓реЗрд╖рд┐рдд рдкреНрд░рджрд░реНрд╢рди рдореЗрдВ рдкреНрд▓рдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛) <br><br><img src="https://habrastorage.org/webt/vl/6d/76/vl6d76rcv0daasbujiyeidj4fvc.png"><br>  <i>рдкрд░рд┐рдгрд╛рдореА рд╕рдВрд░рдЪрдирд╛</i> <br><br>  рдпрд╣ рдПрдордХреЗ рдХреЗ рд╕реИрдХрдбрд╝реЛрдВ рдкреИрд░реЛрдВ рдХреЗ рд▓рд┐рдП рдереЛрдбрд╝рд╛ рдмрд╣реБрдд рд╣реЛрдЧрд╛, рдореИрдВрдиреЗ рддрдп рдХрд┐рдпрд╛, рдФрд░ рдпрд╣рд╛рдВ I / O рд╡рд┐рд╕реНрддрд╛рд░рдХреЛрдВ рдХреЛ рдЬреЛрдбрд╝рд╛: 16 рдЗрдирдкреБрдЯ рдпрд╛ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд▓рд┐рдП MCP23017 рдХреЗ рдЪрд╛рд░ рдЯреБрдХрдбрд╝реЗред  рдЖрдЧреЗ рджреЗрдЦрддреЗ рд╣реБрдП, рдореИрдВ рдХрд╣реВрдБрдЧрд╛ рдХрд┐ 400 kHz рдХреА I2C рдмрд╕ рдХреА рдЧрддрд┐ рд╕реЗ, рдкреНрд░рддрд┐ рдЪрд┐рдк рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ 0.13 рдПрдордПрд╕ рдкреНрд░рддрд┐ рдЪрд┐рдк рдХреЗ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдореЗрдВ рджреЗрд░реА рд╣реБрдИред  рдпрд╣реА рд╣реИ, рдпрд╣ рдПрдХ рдорд╛рд░реНрдЬрд┐рди рдХреЗ рд╕рд╛рде 1 рдПрдордПрд╕ рдХреЗ рдиреНрдпреВрдирддрдо рдпреВрдПрд╕рдмреА рдорддрджрд╛рди рд╕рдордп рдХреЛ рдХрд╡рд░ рдХрд░рддрд╛ рд╣реИред <br><br>  рдмреЗрдХрд╛рд░ рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рд╛рде I2C рдХреА рдмрд╕ рдХреЛ рдирд╣реАрдВ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, MCP23017 рдореЗрдВ рдЙрди рдЖрдЙрдЯрдкреБрдЯ рдЖрдЙрдЯрдкреБрдЯ рд╣реИрдВ рдЬреЛ рдЗрдирдкреБрдЯ рдХреА рд╕реНрдерд┐рддрд┐ рдмрджрд▓рдиреЗ рдкрд░ рд╕реЗрдЯ рд╣реЛрддреЗ рд╣реИрдВред  рдореИрдВрдиреЗ рдЙрдиреНрд╣реЗрдВ рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рд▓рд╛рдЧреВ рднреА рдХрд┐рдпрд╛ред  рдЬреИрд╕рд╛ рдХрд┐ рдпрд╣ рдЖрдЧреЗ рдирд┐рдХрд▓рд╛, рд╕рдВрдкрд░реНрдХреЛрдВ рдХреЗ рддреЗрдЬ рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдг, рдпреЗ рд╡реНрдпрд╡рдзрд╛рди рдмреЗрдХрд╛рд░ рдереЗред <br><br>  ADS1118 ADC USB рдЧрддрд┐ рдХреЗ рд╕рд╛рде рдХреБрдЫ рд╣рдж рддрдХ рдирд╣реАрдВ рд░рдЦрддрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рдШреЛрд╖рд┐рдд рдкреНрд░рджрд░реНрд╢рди рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 820 рдирдореВрдиреЛрдВ рдореЗрдВ рд╣реИ, рдЬреЛ 1.2 рдПрдордПрд╕ рд╣реИ, рдЬрдмрдХрд┐ рдЗрд╕рдореЗрдВ рдХрдИ рдЗрдирдкреБрдЯ рд╣реИрдВ рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдорд▓реНрдЯреАрдкреНрд▓реЗрдХреНрд╕рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ ADC рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реИрдВред  рдореИрдВрдиреЗ рдПрдХ рдЪрд┐рдк рдкрд░ 2 рдЗрдирдкреБрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдорд╛рдиреЛрдВ рдХрд╛ рдЕрджреНрдпрддрди рд╕рдордп 2.4 рдПрдордПрд╕ рд╣реИред  рдмреБрд░рд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рдХреНрдпрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ?  рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдЕрд▓реА рдкрд░ рдХреЛрдИ рдЕрдиреНрдп 16-рдмрд┐рдЯ рдлрд╛рд╕реНрдЯ рдПрдбреАрд╕реА рдирд╣реАрдВ рд╣реИрдВред <br><br><img src="https://habrastorage.org/webt/sb/xt/jy/sbxtjyzbgnuutfbdhbh6iub1qpe.jpeg"><br>  <i>рдЕрдВрджрд░ рдпрд╣ рдРрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рддрд╛рд░реЛрдВ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдпрд╣ рдмрд╣реБрдд рдЦрд░рд╛рдм рд╣реИ</i> <br><br>  CPU рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ PLC рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреА рд╢реИрд▓реА рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдХреЛрдИ рдЕрд╡рд░реБрджреНрдз рдЕрдиреБрд░реЛрдз рдирд╣реАрдВред  рдХреЛрд░ рдкрд░рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП рдЗрдВрддрдЬрд╛рд░ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рд╕рд╛рде рд╕рдордп рдФрд░ рдирд░рдХ рдирд╣реАрдВ рд╣реБрдЖ рд╣реИ, рдЕрдЧрд▓реЗ рдЪрдХреНрд░ рдореЗрдВ рдпрд╣ рдкреВрдЫрддрд╛рдЫ рдХрд░реЗрдЧрд╛ред  рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдХреЛрдИ рдЖрд░рдЯреАрдУрдПрд╕ рдирд╣реАрдВ рд╣реИрдВ, рдореИрдВрдиреЗ рдЗрд╕реЗ рдЖрдЬрд╝рдорд╛рдпрд╛, рдореИрдВ 1 рдПрдордПрд╕ рдХреЗ рдиреНрдпреВрдирддрдо рдХрд╛рд░реНрдп рдкреНрд░рддреАрдХреНрд╖рд╛ рд╕рдордп рдореЗрдВ рднрд╛рдЧ рдЧрдпрд╛ - рдпрд╣ рдзреАрд░реЗ-рдзреАрд░реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рддрд╛ рд╣реИ рдЕрдЧрд░ рд╣рдореЗрдВ 1 рдПрдордПрд╕ рдХреА рдЖрд╡реГрддреНрддрд┐ рдХреЗ рд╕рд╛рде рдпреВрдПрд╕рдмреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбреЗрдЯрд╛ рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдирддреАрдЬрддрди, рдореБрдЭреЗ рдПрд╣рд╕рд╛рд╕ рд╣реБрдЖ рдХрд┐ рдореИрдВ рдУрдПрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдУрдПрд╕рдбреЗрд▓ () рдХреЗ рдмрд┐рдирд╛ рдХрд░реВрдВрдЧрд╛, рдФрд░ рдлрд┐рд░ рдЖрд░рдЯреАрдУрдПрд╕ рдХреНрдпреЛрдВ?  рдкреАрдПрд▓рд╕реА рдХреА рддрд░рд╣, рдЕрдирдВрдд рд▓реВрдк рдХреЗ рдЕрдВрджрд░ рдПрдХ-рдПрдХ рдХрд░рдХреЗ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рд░рдЦрдирд╛ рдХрд╛рдлреА рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред <br><br>  рдмреЗрд╢рдХ, CubeMX рдФрд░ HAL рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╡реИрд╕реЗ, рдореИрдВрдиреЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдПрдЪрдПрдПрд▓ рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд┐рдпрд╛ рдФрд░ рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪрд╛ред  рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдпрд╣ рдЕрднреА рднреА рдмрд╣реБрдд рд▓реЛрдХрдкреНрд░рд┐рдп рдХреНрдпреЛрдВ рдирд╣реАрдВ рд╣реИ, рдореБрдЦреНрдп рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕реЗ рдкрд╣рд▓реЗ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдпрд╣ рдмрд╣реБрдд рд╕рд░рд▓рддрд╛ рд╕реЗ рдЪрд▓реЗрдЧрд╛ред  рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЖрдк arduino рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВред <br><br>  рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдВ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ USB рдХрд╕реНрдЯрдо рдЫрд┐рдкрд╛рдИ рд╣реЛрдЧреАред  HID рдорд╛рдЙрд╕, рдХреАрдмреЛрд░реНрдб, рдЧреЗрдордкреИрдб, рдЬреЙрдпрд╕реНрдЯрд┐рдХ, рдХреБрдЫ рдФрд░ рд╣реИред  рдФрд░ рд░рд┐рд╡рд╛рдЬ рд╣реИред  рдпрд╣ рд╕рдм рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ, рд╡реЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдбреЗрд╡рд▓рдкрд░ рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдЦреЗ рдЧрдП рд╣реИрдВред  рдПрдХ рдХрд╕реНрдЯрдо рдбрд┐рд╡рд╛рдЗрд╕ рдЕрдЪреНрдЫрд╛ рд╣реИ рдХрд┐ рд╣рдо рд╕реНрд╡рдпрдВ рдЕрдкрдиреЗ рд╡рд┐рд╡реЗрдХ рдкрд░ рдЙрдкрд░реЛрдХреНрдд рд╕рднреА рдЙрдкрдХрд░рдгреЛрдВ рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред <br><br>  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, USB рдЪреАрдЬ рдмрд╣реБрдд рдЬрдЯрд┐рд▓ рд╣реЛрддреА рд╣реИ, рдЗрд╕рдореЗрдВ рд▓рдЧрднрдЧ рдПрдХ рд╣рдЬрд╛рд░ рдкреГрд╖реНрдареЛрдВ рдХрд╛ рдореИрдиреБрдЕрд▓ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЖрдк рдЗрд╕реЗ рд╕реНрдиреИрдк рд╕реЗ рдирд╣реАрдВ рд▓реЗ рд╕рдХрддреЗред  рднрд╛рд░реА рдореИрдиреБрдЕрд▓ рдХреЛ рдХреМрди рдирд╣реАрдВ рдкрдврд╝рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рдирдЯрд╢реЗрд▓, рдЧреВрдЧрд▓ рдореЗрдВ рдПрдХ рдмреЗрд╣рддрд░реАрди рд▓реЗрдЦ рдпреВрдПрд╕рдмреА рд╣реИред  рдЙрд╕рдХрд╛ рдЕрдиреБрд╡рд╛рдж рднреА рд╣реИред  рдореИрдВ "рдЙрдВрдЧрд▓рд┐рдпреЛрдВ рдкрд░" рдХреБрдЫ рдмрд┐рдВрджреБрдУрдВ рдХреЛ рд╕рдордЭрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реВрдВрдЧрд╛ред <br><br>  рдпреВрдПрд╕рдмреА - рд╕реНрддрд░ рдФрд░ рдЕрдореВрд░реНрдд рдХрд╛ рдПрдХ рдЧреБрдЪреНрдЫрд╛ рдХреЗ рд╕рд╛рде рдкреИрдХреЗрдЯ рдбреЗрдЯрд╛ рдЯреНрд░рд╛рдВрд╕рдлрд░ред  рдбрд┐рд╡рд╛рдЗрд╕ рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╣реИ - рдпрд╣ рдХрд┐рд╕реА рднреА рдбреЗрдЯрд╛ рдХрд╛ рдЕрдиреБрд░реЛрдз рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдореЗрдЬрдмрд╛рди рдкреВрд░реЗ рд╣рд╕реНрддрд╛рдВрддрд░рдг рдХреА рд╢реБрд░реБрдЖрдд рдХрд░рддрд╛ рд╣реИред  рд╣реЛрд╕реНрдЯ рддрдерд╛рдХрдерд┐рдд рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рд▓рд┐рдЦрддрд╛ рд╣реИ рдФрд░ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ, рд╢рд╛рд░реАрд░рд┐рдХ рд░реВрдк рд╕реЗ рдпреЗ рдПрдордХреЗ рдореЗрдореЛрд░реА рдореЗрдВ рдХреБрдЫ рдмрдлрд╝рд░ рд╣реИрдВред  рдореЗрдЬрдмрд╛рди рдХреЗ рд▓рд┐рдП рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреМрди рд╕рд╛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рд▓рд┐рдЦрдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдХреМрди рд╕рд╛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдкрдврд╝рдирд╛ рд╣реИ рдФрд░ рдХреМрди рд╕рд╛ рдбреЗрдЯрд╛ рдпрд╣ рд╣рдорд╛рд░реЗ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдмрдЯрди рдФрд░ рдХреБрд▓реНрд╣рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХрд┐рд╕ рддрд░рд╣ рдХрд╛ рдбрд┐рд╡рд╛рдЗрд╕ рд╣реИ, рдХрдиреЗрдХреНрд╢рди рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдпрд╣ рдбрд┐рд╡рд╛рдЗрд╕ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рд╣реИред  рдЗрди рд╡рд┐рд╡рд░рдгрдХреЛрдВ рдореЗрдВ рд╕реЗ рдХрдИ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд▓рд┐рдЦрдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реИ рдФрд░ рдЖрдк рдЬреИрд╕рд╛ рдЪрд╛рд╣реЗрдВ рд╡реИрд╕рд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдХрд╣реАрдВ рднреА рдЧрд▓рддрд┐рдпрд╛рдБ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╢рд╛рд░реАрд░рд┐рдХ рд░реВрдк рд╕реЗ, рд╡реЗ рдмрд╛рдЗрдЯреНрд╕ рдХреА рдПрдХ рд╕рд░рдгреА рд╣реИрдВред <br><br>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, CubeMX рд╣рдорд╕реЗ рдмреЗрд╣рддрд░ рдХрд╕реНрдЯрдо HID рдЖрд░рдВрднреАрдХрд░рдг рдХреЛрдб рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛ред <br><br><img src="https://habrastorage.org/webt/dv/vh/vm/dvvhvm9hohydqeva77lahqhwer4.png"><br><br><img src="https://habrastorage.org/webt/b8/85/an/b885and1wp7m4r6yw9e21w-4hhs.png"><br><br>  рдХреГрдкрдпрд╛ рд╕рдВрдЦреНрдпрд╛ 3 рдХреЗ рддрд╣рдд рдЕрдВрддрд┐рдо рддрд╕реНрд╡реАрд░ рдкрд░ рдзреНрдпрд╛рди рджреЗрдВред рдпрд╣ рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдХрд╛ рдЖрдХрд╛рд░ рд╣реИ, рдЬреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╣рдорд╛рд░реЗ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдХреМрди рд╕реЗ рдЕрдХреНрд╖ рдФрд░ рдмрдЯрди рд╣реИрдВред  рдпрд╣ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">HID рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдЯреВрд▓</a> рдореЗрдВ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИред  рд╕реНрд╡рд╛рдзреНрдпрд╛рдп рдХреЗ рд▓рд┐рдП рдХрдИ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВред  рдЖрдо рддреМрд░ рдкрд░, рдпрд╣рд╛рдБ рдореЗрд░рд╛ рд╡рд░реНрдгрдирдХрд░реНрддрд╛ рд╣реИред  рд╕рдордЭрдиреЗ рдореЗрдВ рдЖрд╕рд╛рдиреА рдХреЗ рд▓рд┐рдП рдЕрднреА рддрдХ рдХреЛрдИ рдбреЗрдЯрд╛ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдЬреЙрдпрд╕реНрдЯрд┐рдХ рдХреЗ рд╕рднреА рдмрдЯрди рдФрд░ рдХреБрд▓реНрд╣рд╛рдбрд╝реА рдореМрдЬреВрдж рд╣реИрдВред  рдЗрд╕реЗ usbd_custom_hid_if.c рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рд╣реИрдВрдбрд▓ рдХреНрдпреВрдм рдХреЛ рдЦрд╛рд▓реА рдХрд░рддрд╛ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">рдЫрд┐рдкрд╛рдИ рд╡рд░реНрдгрдХ (рдЖрдХрд╛рд░ 104 рдмрд╛рдЗрдЯреНрд╕)</b> <div class="spoiler_text"><pre><code class="cpp hljs">__ALIGN_BEGIN <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> CUSTOM_HID_ReportDesc_FS[USBD_CUSTOM_HID_REPORT_DESC_SIZE] __ALIGN_END = { <span class="hljs-comment"><span class="hljs-comment">/* USER CODE BEGIN 0 */</span></span> <span class="hljs-number"><span class="hljs-number">0x05</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-comment"><span class="hljs-comment">// USAGE_PAGE (Generic Desktop) 0x15, 0x00, // LOGICAL_MINIMUM (0) 0x09, 0x04, // USAGE (Joystick) 0xa1, 0x01, // COLLECTION (Application) 0x05, 0x02, // USAGE_PAGE (Simulation Controls) 0x09, 0xbb, // USAGE (Throttle) 0x15, 0x00, // LOGICAL_MINIMUM (0) 0x27, 0xff, 0xff, 0x00, 0x00, // LOGICAL_MAXIMUM (65535) 0x75, 0x10, // REPORT_SIZE (16) 0x95, 0x01, // REPORT_COUNT (1) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x05, 0x01, // USAGE_PAGE (Generic Desktop) 0x09, 0x01, // USAGE (Pointer) 0xa1, 0x00, // COLLECTION (Physical) 0x09, 0x30, // USAGE (X) 0x09, 0x31, // USAGE (Y) 0x95, 0x02, // REPORT_COUNT (2) 0x81, 0x02, // INPUT (Data,Var,Abs) 0xc0, // END_COLLECTION 0x05, 0x01, // USAGE_PAGE (Generic Desktop) 0x09, 0x32, // USAGE (Z) 0x95, 0x01, // REPORT_COUNT (1) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x33, // USAGE (Rx) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x34, // USAGE (Ry) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x35, // USAGE (Rz) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x36, // USAGE (Slider) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x39, // USAGE (Hat switch) 0x15, 0x01, // LOGICAL_MINIMUM (1) 0x25, 0x08, // LOGICAL_MAXIMUM (8) 0x35, 0x00, // PHYSICAL_MINIMUM (0) 0x46, 0x0e, 0x01, // PHYSICAL_MAXIMUM (270) 0x65, 0x14, // UNIT (Eng Rot:Angular Pos) 0x75, 0x08, // REPORT_SIZE (8) 0x95, 0x01, // REPORT_COUNT (1) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x05, 0x09, // USAGE_PAGE (Button) 0x19, 0x01, // USAGE_MINIMUM (Button 1) 0x29, 0x40, // USAGE_MAXIMUM (Button 64) 0x15, 0x00, // LOGICAL_MINIMUM (0) 0x25, 0x01, // LOGICAL_MAXIMUM (1) 0x75, 0x01, // REPORT_SIZE (1) 0x95, 0x40, // REPORT_COUNT (64) 0x55, 0x00, // UNIT_EXPONENT (0) 0x65, 0x00, // UNIT (None) 0x81, 0x02, // INPUT (Data,Var,Abs) /* USER CODE END 0 */ 0xC0 /* END_COLLECTION */ };</span></span></code> </pre> <br></div></div><br>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдЖрдкрдХреА рдкрд╕рдВрдж рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдкрд╣рд▓реЗ рдЖрдк USAGE PAGE рдкреИрд░рд╛рдореАрдЯрд░ рдФрд░ рдЖрд╡рд╢реНрдпрдХ USAGE рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, USAGE (рдереНрд░реЙрдЯрд▓) рдЕрдХреНрд╖, рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж INPUT (рдбреЗрдЯрд╛, Var, Abs) рд╢рдмреНрдж рдХреЗ рдмрд╛рдж, рд╕рд┐рд╕реНрдЯрдо рдорд╛рди рд▓реЗрдЧрд╛ рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ "рдЧреИрд╕" рдЕрдХреНрд╖ рд╣реИред  рдЪрд░ рдЕрдХреНрд╖ рдХрд╛ рдЖрдпрд╛рдо рдФрд░ рдЙрдирдХреА рд╕рдВрдЦреНрдпрд╛ рдкреИрд░рд╛рдореАрдЯрд░ LOGICAL_MAXIMUM, MINIMUM, REPORT_SIZE, REPORT_COUNT рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ, рдЬреЛ INPUT рд╕реЗ рдкрд╣рд▓реЗ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред <br><br>  рдЗрди рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА, рд╕рд╛рде рд╣реА рдХреНрдпрд╛ (рдбреЗрдЯрд╛, рд╡рд╛рд░, рдПрдмреАрдПрд╕) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдорд╛рдирд╡ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдбрд┐рд╡рд╛рдЗрд╕ (рдЫрд┐рдкрд╛рдИ) v1.11 рдХреЗ рд▓рд┐рдП рдбрд┐рд╡рд╛рдЗрд╕ рдХреНрд▓рд╛рд╕ рдкрд░рд┐рднрд╛рд╖рд╛</a> рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрд░реЗ рд╡рд┐рд╡рд░рдгрдХ рд╕реЗ рдереНрд░реЛрдЯрд▓ рдЕрдХреНрд╖ рдХреЛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИред  рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдереНрд░реЙрдЯрд▓ рдХреА рдореВрд▓реНрдп рд╕реАрдорд╛ 0-65535 рд╣реИ, рдЬреЛ рдПрдХ uint16_t рдЪрд░ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИред <br><br><pre> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">0x05</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-comment"><span class="hljs-comment">// USAGE_PAGE (Simulation Controls) 0x09, 0xbb, // USAGE (Throttle) 0x15, 0x00, // LOGICAL_MINIMUM (0) 0x27, 0xff, 0xff, 0x00, 0x00, // LOGICAL_MAXIMUM (65535) 0x75, 0x10, // REPORT_SIZE (16) 0x95, 0x01, // REPORT_COUNT (1) 0x81, 0x02, // INPUT (Data,Var,Abs)</span></span></code> </pre> <br>  рдФрд░ рд╣рд╛рдВ, рдлрд┐рд░ рднреА, рдорд╛рди рд▓реЗрдВ рдХрд┐ рдЖрдк рд╣рд░ рдмрд╛рд░ LOGICAL_MAXIMUM, MINIMUM, REPORT_SIZE, REPORT_COUNT рдирд╣реАрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ, рдореЗрдЬрдмрд╛рди рдкрд┐рдЫрд▓реЗ рдорд╛рди рд╕реЗ рдЗрд╕ рдорд╛рди рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░реЗрдЧрд╛ред  рдпрд╣ рдХреБрд▓реНрд╣рд╛рдбрд╝рд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЪрд┐рддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рдЖрдХрд╛рд░ рдФрд░ рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдмрд┐рдирд╛ рдПрдХ рдХреЗ рдмрд╛рдж рдПрдХ рдЬрд╛рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">0x09</span></span>, <span class="hljs-number"><span class="hljs-number">0x32</span></span>, <span class="hljs-comment"><span class="hljs-comment">// USAGE (Z) 0x95, 0x01, // REPORT_COUNT (1) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x33, // USAGE (Rx) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x34, // USAGE (Ry) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x35, // USAGE (Rz) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x36, // USAGE (Slider)</span></span></code> </pre> <br>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдВрд░рдЪрдирд╛ рдЗрд╕ рд╕рднреА рд╡рд┐рд╡рд░рдгрдХ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИ, рдЬреЛ рд╕реНрдкреЙрдЗрд▓рд░ рдХреЗ рдиреАрдЪреЗ рдЕрдзрд┐рдХ рд╣реИред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдЕрдм рдЕрдирд┐рд╡рд╛рд░реНрдп рдирд╣реАрдВ рд╣реИ, рдпрд╣ рд╕рдВрдХреЗрдд рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд░рд┐рдХреЙрд░реНрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> pack(push, 1) typedef struct _myReportStruct { uint16_t Throttle; uint16_t X; uint16_t Y; uint16_t Z; uint16_t Rx; uint16_t Ry; uint16_t Rz; uint16_t Slider; uint8_t Hat; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// 0 - none, 1 - up, 2 - up-right, 3 - right, 4 - down-right... uint32_t Buttons1; // 32 buttons of 1 bit each uint32_t Buttons2; // 32 buttons of 1 bit each }myReportStruct; #pragma pack(pop) volatile myReportStruct Desk;</span></span></span></span></code> </pre> <br>  рдпрд╣ рд╕рдВрд░рдЪрдирд╛ рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рд╣реЛрд╕реНрдЯ рдХреЛ рднреЗрдЬреА рдЬрд╛ рд╕рдХрддреА рд╣реИ <br><br><pre> <code class="cpp hljs">USBD_CUSTOM_HID_SendReport(&amp;hUsbDeviceFS, (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> *) &amp;Desk, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(Desk));</code> </pre> <br>  рдкрд╣рд▓рд╛ рдкреИрд░рд╛рдореАрдЯрд░ рдПрдХ рдпреВрдПрд╕рдмреА рд╣реИрдВрдбрд▓ рд╣реИ, рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╣рдорд╛рд░реЗ рдХреНрдпреВрдм рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЖрдкрдХреЛ рдЖрд╡рд╢реНрдпрдХ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рд╕рдВрднрд╛рд▓ рдкрд╣рд▓реА рдмрд╛рд░ рд╢реБрд░реВ рдХреА рдЧрдИ рд╣реИ рдФрд░ <i>рдмрд╛рд╣рд░реА USBD_HandleTypeDef hUsbDeviceFS рд▓рд┐рдЦреЗрдВ;</i>  рддрд╛рдХрд┐ рдЖрдк рдЙрд╕рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд╕рдХреЗрдВред  рджреВрд╕рд░рд╛ рдкреИрд░рд╛рдореАрдЯрд░ рд╣рдорд╛рд░реА рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдПрдХ рд╕рдВрдХреЗрддрдХ рд╣реИ рдФрд░ рддреАрд╕рд░рд╛ рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЖрдХрд╛рд░ рд╣реИред <br><br>  рдирд┐рдпрдВрддреНрд░рдХ рдХреЛ рднрд░рдиреЗ рдФрд░ рдЪрдордХрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдк рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдХреБрдЫ рдпреВрдПрд╕рдмреА рдзреАрд░реЗ-рдзреАрд░реЗ рдЖрдЧреЗ рдмрдврд╝ рд░рд╣рд╛ рд╣реИред  рд╣рдорд╛рд░реЗ рдкреИрдирд▓ рдХрд╛ рдбреЗрдЯрд╛ рдЬрд▓реНрджреА рд╕реЗ рдЕрдкрдбреЗрдЯ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред  рддреНрд╡рд░рд┐рдд рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, usbd_customhid.h рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдЖрдкрдХреЛ #define CUSTOM_HID_EPIN_SIZE рдХреЛ рдЕрдзрд┐рдХрддрдо рдорд╛рди 0x40 рдореЗрдВ рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛, #define CUSTOM_HID_POUT_SIZE рдиреЗ рднреА 0x40 рд╕реЗрдЯ рдХрд┐рдпрд╛ рд╣реИред  Usbd_customhid.c рдлрд╝рд╛рдЗрд▓ рдореЗрдВ, рдПрдВрдбрдкреЙрдЗрдВрдЯ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдореЗрдВ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХреЛ рдвреВрдВрдвреЗрдВ "/ * bInterval: рдкреЛрд▓рд┐рдВрдЧ рдЗрдВрдЯрд░рд╡рд▓ (20 рдПрдордПрд╕) * /" рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рджреЛ рдмрд┐рдВрджреБ рдХреЗ рд▓рд┐рдП рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдмрд╛рдЗрдЯ рдХреЛ 0x01 рдореЗрдВ рдмрджрд▓ рджреЗрдВ, рдХреЗрд╡рд▓ рджреЛ рдмрд╛рд░ред  рдЬреЛ 1 рдПрдордПрд╕ рдбреЗрдЯрд╛ рдПрдХреНрд╕рдЪреЗрдВрдЬ рдХреЗ рдЕрдиреБрд░реВрдк рд╣реЛрдЧрд╛ред <br><br><img src="https://habrastorage.org/webt/yf/zm/cx/yfzmcxseu1la7jgqxyql9qzm4ji.png"><br>  <i>рдпрд╣ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред</i>  <i>рдХрд┐рд╕реА рднреА рдбреНрд░рд╛рдЗрд╡рд░ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдП рдмрд┐рдирд╛ рдорд╛рдирдХ рдбрд┐рд╡рд╛рдЗрд╕</i> <br><br>  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдкреНрд░рдмрдВрдзрди рдлрд╝рдВрдХреНрд╢рди рдереЛрдбрд╝рд╛ рд╕рдордЭрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рдХрд░рдирд╛ рдХрд╛рдлреА рдЖрд╕рд╛рди рд╣реИ рдФрд░ рд╕рднреА рдмрдЯрди рдФрд░ рдХреБрд▓реНрд╣рд╛рдбрд╝реА рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рдпрд╣ рдбрд┐рд╕реНрдкреНрд▓реЗ рдХреЛ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╣реБрдЖ рд╣реИред  рдореИрдВрдиреЗ рдЗрд╕реЗ рдХрд┐рдпрд╛, рд▓рдЧрднрдЧ рдЫрд╣ рдорд╣реАрдиреЗ, рдФрд░ рдЖрдзреЗ рд╕рд╛рд▓ рддрдХ рдкреИрдирд▓ рдПрдХ рд▓рдВрдмреЗ рдмрдХреНрд╕реЗ рдореЗрдВ рдзреВрд▓ рдЗрдХрдЯреНрдард╛ рдХрд░ рд░рд╣рд╛ рд╣реИред  рдХреЛрдИ рд╕рдордп рдирд╣реАрдВред  рдЗрд╕рд▓рд┐рдП, рдореИрдВрдиреЗ рдЗрд╕ рд░реВрдк рдореЗрдВ рд▓реЗрдЦ рдХреЛ рдмрд╛рд╣рд░ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛, рдЕрдиреНрдпрдерд╛ рдпрд╣ рдмрд╛рд╣рд░ рдирд╣реАрдВ рдЖрдиреЗ рдХрд╛ рднреА рдЬреЛрдЦрд┐рдо рд╣реИред <br><br>  рдбрд┐рд╕реНрдкреНрд▓реЗ рдХреЗ рд╕рд╛рде, рдПрдХреНрд╕рд┐рд╕ рдХреЗ рд╕рд╛рде рд╕рдм рдХреБрдЫ рд╡реИрд╕рд╛ рд╣реА рд╣реИред  рдЙрдирдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЕрдкрдиреЗ рдбрд┐рд╡рд╛рдЗрд╕ HID рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдХреЛ рдкреВрд░рдХ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдмрд╕ рдпрд╣ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдпреЗ рдбрд┐рд╕реНрдкреНрд▓реЗ рд╣реИрдВ рдФрд░ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╣реЛрд╕реНрдЯ рдЖрдЙрдЯрдкреБрдЯ рдбреЗрдЯрд╛ рднреЗрдЬреЗрдЧрд╛ред <br><br>  HID рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд╣реИрдВрдбрд▓ рдореЗрдВ рдХрд╛рдлреА рд╡реГрджреНрдзрд┐ рд╣реБрдИ рд╣реИред  рдпрд╣рд╛рдБ рдореИрдВрдиреЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд░рд┐рдкреЛрд░реНрдЯ рдЖрдИрдбреА рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рд╣реИ рддрд╛рдХрд┐ рдкреВрд░реНрдг рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдкреНрд░реЗрд╖рд┐рдд / рдкреНрд░рд╛рдкреНрдд рдмрдлрд╝рд░ рдФрд░ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБрдУрдВ рдХреЛ рд░реЛрдХрдирд╛ рди рд╣реЛ рдФрд░ рдпрд╣ рдкрддрд╛ рдЪрд▓реЗ рдХрд┐ рд╣рдореЗрдВ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдкреНрд░рд╛рдкреНрдд рд╣реБрдЖ рд╣реИред  рд░рд┐рдкреЛрд░реНрдЯ рдЖрдИрдбреА рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдореВрд▓реНрдп рдХреЗ рд╕рд╛рде рдПрдХ uint8_t рдмрд╛рдЗрдЯ рд╣реИред  рд╣рдо рдбрд┐рд╡рд╛рдЗрд╕ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ HID рдореЗрдВ рдЬреЛ рдорд╛рди рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВред <br><br><div class="spoiler">  <b class="spoiler_title">CUSTOM_HID_ReportDesc_FS</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//AXIS 0x05, 0x01, // USAGE_PAGE (Generic Desktop) 0x09, 0x04, // USAGE (Joystick) 0xa1, 0x01, // COLLECTION (Application)28 0x05, 0x02, // USAGE_PAGE (Simulation Controls) 0x09, 0xbb, // USAGE (Throttle) 0x15, 0x00, // LOGICAL_MINIMUM (0) 0x27, 0xff, 0xff, 0x00, 0x00, // LOGICAL_MAXIMUM (65535) 0x75, 0x10, // REPORT_SIZE (16) 0x95, 0x01, // REPORT_COUNT (1) 0x85, 0x01, // REPORT_ID (1) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x05, 0x01, // USAGE_PAGE (Generic Desktop) 0x09, 0x01, // USAGE (Pointer) 0xa1, 0x00, // COLLECTION (Physical) 0x09, 0x30, // USAGE (X) 0x09, 0x31, // USAGE (Y) 0x95, 0x02, // REPORT_COUNT (2) 0x81, 0x02, // INPUT (Data,Var,Abs) 0xc0, // END_COLLECTION 0x05, 0x01, // USAGE_PAGE (Generic Desktop) 0x09, 0x32, // USAGE (Z) 0x95, 0x01, // REPORT_COUNT (1) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x33, // USAGE (Rx) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x34, // USAGE (Ry) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x35, // USAGE (Rz) 0x81, 0x02, // INPUT (Data,Var,Abs) 0x09, 0x36, // USAGE (Slider) 0x81, 0x02, // INPUT (Data,Var,Abs) //HAT 0x09, 0x39, // USAGE (Hat switch) 0x15, 0x01, // LOGICAL_MINIMUM (1) 0x25, 0x08, // LOGICAL_MAXIMUM (8) 0x35, 0x00, // PHYSICAL_MINIMUM (0) 0x46, 0x0e, 0x01, // PHYSICAL_MAXIMUM (270) 0x65, 0x14, // UNIT (Eng Rot:Angular Pos) 0x75, 0x08, // REPORT_SIZE (8) 0x95, 0x01, // REPORT_COUNT (1) 0x81, 0x02, // INPUT (Data,Var,Abs) //Buttons 0x05, 0x09, // USAGE_PAGE (Button) 0x19, 0x01, // USAGE_MINIMUM (Button 1) 0x29, 0x40, // USAGE_MAXIMUM (Button 64) 0x15, 0x00, // LOGICAL_MINIMUM (0) 0x25, 0x01, // LOGICAL_MAXIMUM (1) 0x75, 0x01, // REPORT_SIZE (1) 0x95, 0x40, // REPORT_COUNT (64) 0x55, 0x00, // UNIT_EXPONENT (0) 0x65, 0x00, // UNIT (None) 0x81, 0x02, // INPUT (Data,Var,Abs) //LEDs 0x85, 0x02, // REPORT_ID (2) 0x05, 0x08, // USAGE_PAGE (LEDs) 0x09, 0x4B, // USAGE (Generic Indicator) 0x95, 0x40, // REPORT_COUNT (16) 0x91, 0x02, // OUTPUT (Data,Var,Abs) 0xc0, // END_COLLECTION //LCD Displays 0x05, 0x14, // USAGE_PAGE (Alphnumeric Display) 0x09, 0x01, // USAGE (Alphanumeric Display) 0x15, 0x00, // LOGICAL_MINIMUM (0) 0xa1, 0x02, // COLLECTION (Logical) 0x09, 0x32, // USAGE (Cursor Position Report) 0xa1, 0x02, // COLLECTION (Logical) 0x85, 0x04, // REPORT_ID (4) 0x75, 0x08, // REPORT_SIZE (8) 0x95, 0x01, // REPORT_COUNT (1) 0x25, 0x13, // LOGICAL_MAXIMUM (19) 0x09, 0x34, // USAGE (Column) 0xb1, 0x22, // FEATURE (Data,Var,Abs,NPrf) 0x25, 0x03, // LOGICAL_MAXIMUM (3) 0x09, 0x33, // USAGE (Row) 0x91, 0x22, // OUTPUT (Data,Var,Abs,NPrf) 0xc0, // END_COLLECTION 0x09, 0x2b, // USAGE (Character Report) 0xa1, 0x02, // COLLECTION (Logical) 0x85, 0x05, // REPORT_ID (5) 0x95, 0x14, // REPORT_COUNT (20) 0x26, 0xFF, 0x00, // LOGICAL_MAXIMUM (255) 0x09, 0x2c, // USAGE (Display Data) 0x92, 0x02, 0x01, // OUTPUT (Data,Var,Abs,Buf) 0xc0, // END_COLLECTION 0x09, 0x24, // USAGE (Display Control Report) 0x85, 0x06, // REPORT_ID (6) 0x95, 0x01, // REPORT_COUNT (1) 0x91, 0x22, // OUTPUT (Data,Var,Abs,NPrf) 0xc0, // END_COLLECTION //LED Displays 0x05, 0x14, // USAGE_PAGE (Alphnumeric Display) 0x09, 0x01, // USAGE (Alphanumeric Display) 0x15, 0x00, // LOGICAL_MINIMUM (0) 0xa1, 0x02, // COLLECTION (Logical) 0x09, 0x2b, // USAGE (Character Report) 0xa1, 0x02, // COLLECTION (Logical) 0x85, 0x07, // REPORT_ID (7) 0x75, 0x08, // REPORT_SIZE (8) 0x95, 0x28, // REPORT_COUNT (40) 0x26, 0xFF, 0x00, // LOGICAL_MAXIMUM (255) 0x09, 0x2c, // USAGE (Display Data) 0x92, 0x02, 0x01, // OUTPUT (Data,Var,Abs,Buf) 0xc0, // END_COLLECTION //Other DATA 0x06, 0x00, 0xff, // USAGE_PAGE (Generic Desktop) 0x09, 0x01, // USAGE (Vendor Usage 1) 0xa1, 0x01, // COLLECTION (Application) 0x85, 0x08, // REPORT_ID (8) 0x09, 0x01, // USAGE (Vendor Usage 1) 0x15, 0x00, // LOGICAL_MINIMUM (0) 0x27, 0xff, 0xff, 0x00, 0x00, // LOGICAL_MAXIMUM (65535) 0x75, 0x10, // REPORT_SIZE (16) 0x95, 0x0A, // REPORT_COUNT (10) 0x91, 0x82, // OUTPUT (Data,Var,Abs,Vol)</span></span></code> </pre> </div></div><br>  рдЖрдЙрдЯрдкреБрдЯ рдХреЛ <i>рд╕реНрдереИрддрд┐рдХ int8_t</i> рдлрд╝рдВрдХреНрд╢рди <i>CUSTOM_HID_OutEvent_FS (uint8_t event_idx, uint8_t рд░рд╛рдЬреНрдп)</i> рдореЗрдВ <i>рд╕рдВрд╕рд╛рдзрд┐рдд</i> рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ <i>рд╣реИ</i> , рдЬреЛ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ usbd_cid_hid_if.c рдкрд░ рд╕реНрдерд┐рдд рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">рд╕реНрдерд┐рд░ int8_t CUSTOM_HID_OutEvent_FS ()</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> int8_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CUSTOM_HID_OutEvent_FS</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> event_idx, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> state)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* USER CODE BEGIN 6 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> dataReceiveArray[USBD_CUSTOMHID_OUTREPORT_BUF_SIZE]; USBD_CUSTOM_HID_HandleTypeDef *hhid = (USBD_CUSTOM_HID_HandleTypeDef*)hUsbDeviceFS.pClassData; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; USBD_CUSTOMHID_OUTREPORT_BUF_SIZE; i++) { dataReceiveArray[i] = hhid-&gt;Report_buf[i]; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dataReceiveArray[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-comment"><span class="hljs-comment">//report ID 2 leds { //  Report id == 2,   -     dataReceiveArray[1 + N], ,  LED } if (dataReceiveArray[0] == 4) //report ID 4 cursor position { //  Report id == 4,   -,     LCD } if (dataReceiveArray[0] == 5) //report ID 5 display data { //  Report id == 5,   -,     USB  LCD } //   ,   ID     return (USBD_OK); /* USER CODE END 6 */ }</span></span></code> </pre> <br></div></div><br>  рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рдкреАрд╕реА рдкрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд░рд╣рддрд╛ рд╣реИ рдЬреЛ рдЖрд╡рд╢реНрдпрдХ рд░рд┐рдкреЛрд░реНрдЯ рдХреЛ рд╕реНрдЯреАрдпрд░ рдбрд┐рд╕реНрдкреНрд▓реЗ рдореЗрдВ рднреЗрдЬрддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдордХреЗ рдХреЛрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрд╕рдЯреА рд╕реЗ рдПрдХ рдорд╣рд╛рди рдХрд╛рд░реНрдпрдХреНрд░рдо: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпреВрдПрд╕рдмреА рдЫрд┐рдкрд╛рдИ рдкреНрд░рджрд░реНрд╢рдирдХрд╛рд░реА</a> рдЙрдкрдпреБрдХреНрдд рд╣реИред  рдпрд╣ рдЖрдкрдХреЛ рдХрд┐рд╕реА рднреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдкреАрд╕реА рд╕реЗ рд░рд┐рдкреЛрд░реНрдЯ рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/ft/bd/e3/ftbde3fwn14llpdhjmakp7pwx4a.jpeg"><br>  <i>рдПрд▓рдИрдбреА рдбрд┐рд╕реНрдкреНрд▓реЗ рдЯреЗрд╕реНрдЯ</i> <br><br>  рдЗрд╕ рд╕реНрддрд░ рдкрд░, рдореИрдВ рдЕрдм рддрдХ рд╕рдорд╛рдкреНрдд рдХрд░ рдЪреБрдХрд╛ рд╣реВрдВред  рдФрд░ рдпрд╣ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдореИрдВ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рдХрд░реВрдВрдЧрд╛ред <br><br>  рдпрд╣ рдХреАрдмреЛрд░реНрдб рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рд░реЛрдЪрдХ рд╕рд┐рдореБрд▓реЗрдЯрд░ рдореЗрдВ рдЦреЗрд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЗрддрдирд╛ рдирд╣реАрдВ рдХрд┐ рдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ рд╡рд╛рд╣ рдкреНрд░рднрд╛рд╡ рдерд╛ред  рдХреАрдмреЛрд░реНрдб, рдпрд╣ рдПрдХ рдирд┐рдпрдВрддреНрд░рдг рдХрдХреНрд╖ рдЬреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЬреЙрдпрд╕реНрдЯрд┐рдХ рдПрдХреНрд╕рд▓ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдирд╛ рдХрдо рд╕реЗ рдХрдо, рдЕрд╕рд╛рдорд╛рдиреНрдп рд╣реИред  рдПрдХ рдЕрдВрддрд░рд┐рдХреНрд╖ рдпрд╛рддреНрд░реА рдХреА рддрд░рд╣ рдорд╣рд╕реВрд╕ рдХрд░реЗрдВред  рд╕рдЪ рд╣реИ, рдкреВрд░реНрдг рд╡рд┐рд╕рд░реНрдЬрди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реНрдкреЗрд╕рд╕реВрдЯ рдХреА рдЬрд░реВрд░рдд рд╣реЛрддреА рд╣реИред <br><br>  рдореБрдЭреЗ рдЖрд╢рд╛ рд╣реИ рдХрд┐ рдЖрдк рд░реБрдЪрд┐ рд░рдЦрддреЗ рдереЗред  рдЯрд╛рдЗрдкреЛрд╕, рдЕрд╢реБрджреНрдзрд┐рдпрд╛рдВ рдФрд░ рднреНрд░рдо рдореМрдЬреВрдж рд╣реИрдВред  рдЬреЛ рд▓реЛрдЧ рдХреЛрдб рдореЗрдВ рдЧрд╣рд░реА рдЦреБрджрд╛рдИ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рд╡реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдирд┐рд╖реНрдард╛ рд╕реЗред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi434854/">https://habr.com/ru/post/hi434854/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi434838/index.html">рд░реВрд╕реА рдПрдЖрдИ рдХрдк 2018 рдХреЛрдбрдмрд╛рд▓ рдореЗрдВ рднрд╛рдЧ рд▓реЗрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмреЙрдЯ рдмрдирд╛рдирд╛</a></li>
<li><a href="../hi434840/index.html">рдореИрдВрдиреЗ "рдЖрдкрдХреА рдбрд╛рдпрд░реА" рдХреИрд╕реЗ рдХреА - рдпрд╛ рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХ рдбрд╛рдпрд░рд┐рдпреЛрдВ рдХреЗ рдмрд╛рдЬрд╛рд░ рдкрд░ рд╕реНрдерд┐рддрд┐</a></li>
<li><a href="../hi434842/index.html">рд╢рд╣рд░ рдХреЗ рдЦреЗрдд рдмреЗрд╣рдж рдкреНрд░рднрд╛рд╡реА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЕрднреА рдирд╣реАрдВ</a></li>
<li><a href="../hi434844/index.html">100 рд░реЛрдЧрд┐рдпреЛрдВ рдХреА рд╕рдВрдЬреНрдЮрд╛рдирд╛рддреНрдордХ рдХреНрд╖рдорддрд╛рдУрдВ рдХреА рд╡рд╕реВрд▓реА (рдбреЗрд▓ рдмреНрд░реЗрдбрд╕реЗрди рджреНрд╡рд╛рд░рд╛ рдПрдХ рд▓реЗрдЦ рдХрд╛ рдЕрдиреБрд╡рд╛рдж)</a></li>
<li><a href="../hi434848/index.html">рдЯреЗрд╕реНрд▓рд╛ рдХреЗ рдирд┐рджреЗрд╢рдХ рдордВрдбрд▓ рдореЗрдВ рджреЛ рд╕реНрд╡рддрдВрддреНрд░ рдирд┐рджреЗрд╢рдХ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ - рд▓реИрд░реА рдПрд▓рд┐рд╕рди рдФрд░ рдХреЗрдЯрд▓рд┐рди рд╡рд┐рд▓реНрд╕рди-рдереЙрдореНрдкрд╕рди</a></li>
<li><a href="../hi434856/index.html">рдПрдордкреАрд╕реА рдореЗрдВ рд╡реАрдбрд┐рдпреЛ рд╢реЗрдбрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдВрдкрд╛рджрди</a></li>
<li><a href="../hi434858/index.html">рдЬреЗрдЯрдкреИрдХ рд░реЗрд╕рд┐рдВрдЧ 2019</a></li>
<li><a href="../hi434862/index.html">рдЪреАрдиреА рд╕реНрдХреВрд▓реА рдмрдЪреНрдЪреЛрдВ рдХрд╛ рд╕реНрдорд╛рд░реНрдЯ рд░реВрдк рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдХреЛ рдХрдо рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi434864/index.html">рдХрд╛рдо рдХреА рддрд▓рд╛рд╢ рдореЗрдВ рд╡рд░рд┐рд╖реНрда рдЕрднрд┐рдпрдВрддрд╛ред рдореИрдВ 15 рддрдХрдиреАрдХреА рд╕рд╛рдХреНрд╖рд╛рддреНрдХрд╛рд░реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреИрд╕реЗ рдЧрдпрд╛ рдФрд░ рдореИрдВ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛ рд╕реЛрдЪрддрд╛ рд╣реВрдВ</a></li>
<li><a href="../hi434868/index.html">рдмреНрд▓реЙрдХрдЪреЗрди рдорд░ рдЪреБрдХрд╛ рд╣реИред рд▓рдВрдмреЗ рд╕рдордп рддрдХ рд▓рд╛рдЗрд╡ рдмреНрд▓реЙрдХрдЪреЗрди</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>