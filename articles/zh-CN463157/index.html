<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸšµğŸ½ ğŸ‘©â€ğŸŒ¾ â° ESP32-CAMè§†é¢‘æµæœåŠ¡å™¨è¿æ¥I2Cå’ŒSPIæ˜¾ç¤ºå™¨ ğŸ¤¦ğŸ¾ ğŸ‘¨ğŸ»â€âš–ï¸ ğŸ‘ŒğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¸¦Diymoreç›¸æœºçš„ESP-32 CAMæ¨¡å— 

 ESP32-CAMè§†é¢‘æµæœåŠ¡å™¨ 
 è¿™é‡Œæ˜¯ä¸€ä¸ªä½¿ç”¨ç¤ºä¾‹ã€‚ 

 æ‚¨å¿…é¡»é¦–å…ˆå®‰è£…åº“ï¼š Arduino Ide Windowsä¸­çš„ Esp32æ¿ / Arduino Ide Linuxå’ŒMacä¸­çš„Esp32æ¿ 

 è¯¦ç»†çš„è®¾ç½®åœ¨æœ¬æ–‡ä¸­ã€‚ 

 å°±æˆ‘è€Œ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ESP32-CAMè§†é¢‘æµæœåŠ¡å™¨è¿æ¥I2Cå’ŒSPIæ˜¾ç¤ºå™¨</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463157/"> å¸¦<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Diymore</a>ç›¸æœºçš„ESP-32 CAMæ¨¡å— <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fe/it/oc/feitoc3nxkss7zc6ocsw7cmuyho.jpeg" width="500"></div><br><h3>  ESP32-CAMè§†é¢‘æµæœåŠ¡å™¨ </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>æ˜¯ä¸€ä¸ªä½¿ç”¨ç¤ºä¾‹ã€‚ <br><br> æ‚¨å¿…é¡»é¦–å…ˆå®‰è£…åº“ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Arduino Ide Windowsä¸­çš„</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Esp32æ¿</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Arduino Ide Linuxå’ŒMacä¸­çš„Esp32æ¿</a> <br><br> è¯¦ç»†çš„è®¾ç½®åœ¨æœ¬æ–‡ä¸­ã€‚ <br><br> å°±æˆ‘è€Œè¨€ï¼Œæˆ‘ä½¿ç”¨äº†æœªæ³¨é‡Šçš„AI-THINKERæ¨¡å— <br>  ï¼ƒå®šä¹‰CAMERA_MODEL_AI_THINKER <br><br> äººè„¸è¯†åˆ«åŠŸèƒ½ä¸é€‚ç”¨äºæˆ‘ã€‚ æ–‡ç« ä¸­çš„è¯„è®ºå¾ˆæœ‰å¸®åŠ©ã€‚ <br><a name="habracut"></a><br> ä½¿ç”¨1.02 ESPå†…æ ¸æ—¶ï¼Œé¢éƒ¨è¯†åˆ«ä¼¼ä¹ä¸å†èµ·ä½œç”¨ï¼ˆè‡³å°‘å¯¹äºç¤ºä¾‹ç¨‹åºè€Œè¨€ï¼‰ã€‚ å›æ»šåˆ°1.01å†…æ ¸å¹¶ä½¿ç”¨å±äºè¯¥å†…æ ¸çš„ç¤ºä¾‹ç¨‹åºï¼Œå°†å¯¹å…¶è¿›è¡Œâ€œä¿®å¤â€ <br><br> å›æ»šåˆ°åº“1.01çš„å…ˆå‰ç‰ˆæœ¬åï¼Œä¸€åˆ‡æ­£å¸¸ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_2/tg/47/_2tg47ntvkqznzh-nr_jhqzitz8.png"></div><br> æˆ‘æœ‰ä¸€å¯¹I2C 128x64å’ŒTFT SPI 128x128æ˜¾ç¤ºå™¨ <br><br> å¦‚æœæ‚¨æ²¡æœ‰CAMæ¨¡å—ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¸¦FIFOçš„OV7670</a>æ–‡ç« å¦‚ä½•å°†ç›¸æœºè¿æ¥åˆ°æ˜¾ç¤ºå™¨ã€‚ æ”¯æŒOV2640å’ŒOV7670æ‘„åƒæœº <br><br> åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œä»¥ä¸‹å†…å®¹å¯¹æˆ‘æœ‰ç”¨ <br><br>  ESP32ç›¸æœº+ WifiæœåŠ¡å™¨+ I2Cæ˜¾ç¤ºå±ï¼ˆAdaFruitï¼‰ <br>  ESP32ç›¸æœº+ SPI Display 1.44â€œ TFT 128x128 v1.1ï¼ˆAdaFruitï¼‰ <br>  ESP32æ‘„åƒå¤´+ SPI Display 1.8è‹±å¯¸TFT 128 * 160ï¼ˆEspressifåº“ï¼‰ <br><br>  WiFié©±åŠ¨ç¨‹åºä¸SPIæ€»çº¿å†²çªã€‚ ä½¿ç”¨å…¶ä»–åº“çš„å¯èƒ½è§£å†³æ–¹æ¡ˆã€‚  WiFiæ¨¡å—åˆå§‹åŒ–æ—¶å‡ºç°é—®é¢˜ã€‚ <br><br> ä¸»è¦é—®é¢˜æ˜¯ESP32-CAMæ¨¡å—çš„è‡ªç”±æ”¯è„šæ•°é‡æœ‰é™ã€‚ ç«¯å£çš„ä¸€éƒ¨åˆ†ç”¨äºç›¸æœºï¼Œä¸€éƒ¨åˆ†ä¸sdå¡å¹¶è¡Œã€‚  sdå¡è¿æ¥å™¨å·²å®‰è£…åœ¨æ¿ä¸Šã€‚ å¦ä¸€ä¸ªç»“è®ºï¼ˆIO4ï¼‰æ˜¯LEDæ‰‹ç”µç­’ã€‚ <br><br>  I2C Display B / Wå¯¹äºä»æ‘„åƒæœºæ¥æ”¶åˆ°çš„å›¾åƒçš„å®é™…ä½¿ç”¨å¹¶ä¸ç‰¹åˆ«æ„Ÿå…´è¶£ã€‚  TFTå½©è‰²å’Œé«˜åˆ†è¾¨ç‡ã€‚ åœ¨å®ƒä¸Šé¢ï¼Œæ‚¨å·²ç»å¯ä»¥çœ‹åˆ°è„¸ã€‚ åœ¨è¿™æ ·çš„æ˜¾ç¤ºå™¨æˆ–æ›´é«˜çš„åˆ†è¾¨ç‡ä¸Šï¼Œæ‚¨å¯ä»¥åˆ¶ä½œé—¨çœ¼ <br><br> æˆ‘é©¬ä¸Šè¦è¯´AdaFruitåº“ä¸æ˜¯æœ€å¿«çš„ã€‚ æˆ‘è®¾æ³•æ¯ç§’æ˜¾ç¤ºå‡ å¸§ã€‚ ä½¿ç”¨ä½çº§åˆ«çš„åº“æ›´æœ‰å¸Œæœ›ã€‚ ä½†æ˜¯æˆ‘æ— æ³•é€šè¿‡æ˜¾ç¤º1.44â€œ 128x128 SPI V1.1ã€‚æ¥è·å¾—ESP32_TFT_libraryã€‚ä¹Ÿè®¸ä¸æ”¯æŒILI9163ã€‚æˆ‘ä½¿ç”¨1.8â€ 128 * 160 SPI TFTï¼Œè®¾æ³•å‹ç¼©äº†å¤§çº¦12 FPSï¼  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å‹æƒ…é“¾æ¥</a> <br><br> æœ‰å‡ ä¸ªåº“çš„è¿è¡Œé€Ÿåº¦æ›´å¿«ã€‚ ä½†æ˜¯æœ‰äº›æ²¡æœ‰ç§»æ¤åˆ°esp-32ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">link</a> ï¼‰ï¼š <br><br>  4.98ç§’Adafruit_ST7735 <br>  1.71ç§’ST7735X_kbv <br>  1.30ç§’PDQ_ST7735 <br><br> è¯¥è§†é¢‘ä»¤äººå°è±¡æ·±åˆ»ï¼š <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/HnhsxP0W0m4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br> å½“ä½¿ç”¨<s>ä¸¤ä¸ªç«¯å£æ—¶ï¼Œ</s>å¾®æ§åˆ¶å™¨ä¸Šçš„HSPIæˆ–VSPIç¡¬ä»¶ç«¯å£ä¹‹ä¸€ä»¥åŠå¸¦æœ‰ILI9341é©±åŠ¨ç¨‹åºçš„æ˜¾ç¤ºå™¨å¯ä»¥æ¯ç§’æ¥æ”¶30å¸§ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é“¾æ¥</a> ï¼‰ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7a/39/93/7a3993k5m_j9z5f2juglv5s9h9g.png"></div><br><br> ä½†æ˜¯æ­£å¦‚æˆ‘ä¹‹å‰åœ¨ESP32-CAMæ¨¡å—ä¸­æ‰€è¯´ï¼Œåªæœ‰ä¸€ä¸ªSPIæ˜¯å¯ç”¨çš„ã€‚ å®ƒæ˜¾ç¤ºåœ¨ä»¥ä¸‹PINSä¸Šï¼š <br><br>  IO2-ç›´æµï¼ˆA0ï¼‰ <br>  IO14-æ—¶é’Ÿ <br>  IO15-CS <br>  IO13-MOSIï¼ˆSDAï¼‰ <br>  IO12-MISOï¼ˆè¾“å…¥ã€‚æœªä½¿ç”¨ï¼‰ <br><br>  IO0-BCKLï¼ˆèƒŒå…‰ã€‚æœªä½¿ç”¨ï¼‰ <br>  IO16-RST <br><br><img src="https://habrastorage.org/webt/ob/wr/wy/obwrwyztxqm6ct4dtlxe_fggdim.png"><br><br><img src="https://habrastorage.org/webt/nr/7e/dg/nr7edg2broaykspjtyxncso2zxy.png"><br><br> æˆ‘å°è¯•çš„ç¬¬ä¸€ä¸ªåº“æ˜¯AdaFruit SSD1306 <br><br><h3>  I2C 128x64è“è‰²OLEDæ˜¾ç¤ºå± </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ec/xl/ji/ecxljimycqq42q16yxswiehsv98.png"></div><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Wire.h&gt; #include &lt;Adafruit_GFX.h&gt; #include &lt;Adafruit_SSD1306.h&gt; #define SCREEN_WIDTH 128 // OLED display width, in pixels #define SCREEN_HEIGHT 64 // OLED display height, in pixels // Declaration for an SSD1306 display connected to I2C (SDA, SCL pins) #define OLED_RESET -1 // Reset pin # (or -1 if sharing Arduino reset pin) Adafruit_SSD1306 display; void init_display(){ pinMode(14,INPUT_PULLUP); pinMode(15,INPUT_PULLUP); Wire.begin(14,15); display = Adafruit_SSD1306(SCREEN_WIDTH, SCREEN_HEIGHT, &amp;Wire, OLED_RESET); if(!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) { // Address 0x3D for 128x64 Serial.println(F("SSD1306 allocation failed")); for(;;); // Don't proceed, loop forever } ....</span></span></span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">camera_captureï¼ˆï¼‰</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> BACKCOLOR 0x0000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// Black #define PIXELCOLOR 0xFFFF // White #define FRAME_WIDTH 320 #define FRAME_HEIGHT 240 uint16_t pixel_color = 0; esp_err_t camera_capture(){ //acquire a frame camera_fb_t * fb = esp_camera_fb_get(); if (!fb) { ESP_LOGE(TAG, "Camera Capture Failed"); return ESP_FAIL; } int i = 0; for(int y = 0; y &lt; SCREEN_HEIGHT; y++){ for(int x = 0; x &lt; SCREEN_WIDTH; x++){ i = y * FRAME_WIDTH + x; // FRAMESIZE_QVGA // 320x240 char ch = (char)fb-&gt;buf[i]; if (ch &gt; 128) pixel_color = WHITE; else pixel_color = BLACK; // Draw a single pixel in white display.drawPixel(x, y, pixel_color); } } display.display(); //return the frame buffer back to the driver for reuse esp_camera_fb_return(fb); Serial.println("Capture frame ok."); return ESP_OK; }</span></span></span></span></code> </pre><br></div></div><br> åœ¨esp32ä¸­å·¥ä½œæ—¶ï¼Œä½¿ç”¨è½¯ä»¶I2Cä»¿çœŸã€‚ æ¶‰åŠIO14å’ŒIO15ã€‚ å‡ ä¹å¯ä»¥ä½¿ç”¨ä»»ä½•å¯ç”¨ç«¯å£ï¼Œè€Œä¸ä½¿ç”¨H / Wæ€»çº¿ã€‚ <br><br> å¦‚ä½•è¿æ¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å•è‰²0.96â€œ i2c OLEDæ˜¾ç¤ºå™¨</a> ã€‚æ‚¨éœ€è¦æ³¨æ„I2Cæ€»çº¿ä¸Šçš„æ˜¾ç¤ºåœ°å€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸º0x3C <br><br><h3>  SPI Display 1.8â€œ TFT 128 * 160ä¹é‘«åº“ </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e9/ym/zg/e9ymzg6iukpuzpowfbgvlln89dg.jpeg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/eo/jv/j0/eojvj0nkmzg1dqiubx3jcaoepou.jpeg"></div><br> æ¥çº¿å›¾ï¼š <br><br>  IO2-A0 <br>  IO14-SCK <br>  IO15-CS <br>  IO13-SDA <br>  IO16-é‡ç½® <br><br><img src="https://habrastorage.org/webt/fp/v8/iv/fpv8iv79hdpoefoxwnzsc64ychm.png"><br> æ¿ä¸Šè¿˜æœ‰ä¸€ä¸ªSDå¡è¯»å¡å™¨ <br><br>  IOé…ç½®ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Configuration for other boards, set the correct values for the display used //---------------------------------------------------------------------------- #define DISP_COLOR_BITS_24 0x66 //#define DISP_COLOR_BITS_16 0x55 // Do not use! // ############################################# // ### Set to 1 for some displays, ### // for example the one on ESP-WROWER-KIT ### // ############################################# #define TFT_INVERT_ROTATION 0 #define TFT_INVERT_ROTATION1 0 // ################################################ // ### SET TO 0X00 FOR DISPLAYS WITH RGB MATRIX ### // ### SET TO 0X08 FOR DISPLAYS WITH BGR MATRIX ### // ### For ESP-WROWER-KIT set to 0x00 ### // ################################################ #define TFT_RGB_BGR 0x08 // ############################################################## // ### Define ESP32 SPI pins to which the display is attached ### // ############################################################## // The pins configured here are the native spi pins for HSPI interface // Any other valid pin combination can be used #define PIN_NUM_MISO 12 // SPI MISO #define PIN_NUM_MOSI 13 // SPI MOSI #define PIN_NUM_CLK 14 // SPI CLOCK pin #define PIN_NUM_CS 15 // Display CS pin #define PIN_NUM_DC 2 // Display command/data pin #define PIN_NUM_TCS 0 // Touch screen CS pin (NOT used if USE_TOUCH=0) // -------------------------------------------------------------- // ** Set Reset and Backlight pins to 0 if not used ! // ** If you want to use them, set them to some valid GPIO number #define PIN_NUM_RST 0 // GPIO used for RESET control #define PIN_NUM_BCKL 0 // GPIO used for backlight control #define PIN_BCKL_ON 0 // GPIO value for backlight ON #define PIN_BCKL_OFF 1 // GPIO value for backlight OFF // -------------------------------------------------------------- // ####################################################### // Set this to 1 if you want to use touch screen functions // ####################################################### #define USE_TOUCH TOUCH_TYPE_NONE // ####################################################### // ####################################################################### // Default display width (smaller dimension) and height (larger dimension) // ####################################################################### #define DEFAULT_TFT_DISPLAY_WIDTH 128 #define DEFAULT_TFT_DISPLAY_HEIGHT 160 // ####################################################################### #define DEFAULT_GAMMA_CURVE 0 #define DEFAULT_SPI_CLOCK 32000000 #define DEFAULT_DISP_TYPE DISP_TYPE_ST7735B //---------------------------------------------------------------------------- #define TFT_INVERT_ROTATION 0 #define TFT_INVERT_ROTATION1 1 #define TFT_INVERT_ROTATION2 0</span></span></code> </pre><br> ä»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Espressif</a>å®‰è£…ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒã€‚ æœ‰å…³<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¦‚ä½•æ‰§è¡Œæ­¤</a>æ“ä½œçš„è¯¦ç»†è¯´æ˜ã€‚ <br><br> å®‰è£…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åº“</a> ã€‚ éœ€è¦è¿›è¡Œä¸¤ä¸ªæ›´æ­£æ‰èƒ½ç»„è£…åº“ã€‚ <br><br> ç”Ÿæˆæ–‡ä»¶ï¼š <br><br><pre> <code class="bash hljs">+ CFLAGS += -Wno-error=tautological-compare \ + -Wno-implicit-fallthrough \ + -Wno-implicit-function-declaration</code> </pre><br> ç»„ä»¶/ tft / tftspi.cï¼š <br><br><pre> <code class="cpp hljs">+ <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"driver/gpio.h</span></span></span></span></code> </pre><br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¡¥ä¸</a> <br><br> ç„¶åå®‰è£…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ESP32 Camera Driver</a> ã€‚ <br><br> é…ç½®ï¼š <br><br>  ï¼ƒ  $ HOME / esp / esp-idf / export.sh <br>  ï¼ƒidf.py menuconfig <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yc/yl/ml/ycylmlzznbfewlweiaris71dbzo.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_3/gn/5s/_3gn5s4bmrqunmhwjeabdtxe9yu.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x8/jc/g6/x8jcg6ia43npfcol7rebn1taz7e.png"></div><br> å…è®¸è®¿é—®USBç«¯å£ä»¥è¿›è¡Œå›ºä»¶å’Œç›‘è§†ï¼š <br><br>  #sudo chmod 777 /å¼€å‘/ ttyUSB0 <br><br> æˆ‘ä»¬æ”¶é›†å¹¶å¡«å†™ï¼š <br><br>  #make -j4 &amp;&amp; make flash <br><br> é€šè¿‡ä½¿ç”¨send_dataæ–¹æ³•å†™å…¥æ•°æ®åŒ…å¯å®ç°12FPSã€‚ è®°å½•ä¸æ˜¯é€åƒç´ è¿›è¡Œçš„ï¼Œè€Œæ˜¯æ•´è¡Œç­‰äºå±å¹•çš„å®½åº¦ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">esp_err_t</span></span> camera_capture(){ <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> tstart, t1, t2; tstart = clock(); <span class="hljs-comment"><span class="hljs-comment">//acquire a frame camera_fb_t * fb = esp_camera_fb_get(); if (!fb) { printf("Camera Capture Failed\n"); return ESP_FAIL; } t1 = clock() - tstart; printf("Capture camera time: %u ms\r\n", t1); int i = 0, bufPos = 0; uint8_t hb, lb; color_t color; color_t *color_line = heap_caps_malloc(_width*3, MALLOC_CAP_DMA); tstart = clock(); for(int y = 0; y &lt; _height; y++) { bufPos = 0; for(int x = 0; x &lt; _width; x++) { i = (y * FRAME_WIDTH + x) &lt;&lt; 1; hb = fb-&gt;buf[i] ; lb = fb-&gt;buf[i + 1]; color.r = (lb &amp; 0x1F) &lt;&lt; 3; color.g = (hb &amp; 0x07) &lt;&lt; 5 | (lb &amp; 0xE0) &gt;&gt; 3; color.b = hb &amp; 0xF8; color_line[bufPos] = color; bufPos++; // TFT_drawPixel(0, 0, color, 1); } disp_select(); send_data(0, y, _width-1, y, _width, color_line); wait_trans_finish(1); disp_deselect(); } free(color_line); t1 = clock() - tstart; printf("Send buffer time: %u ms\r\n", t1); esp_camera_fb_return(fb); printf("Capture frame ok.\n"); return ESP_OK; }</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">ç›¸æœºé…ç½®</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// #if defined(CAMERA_MODEL_AI_THINKER) #define PWDN_GPIO_NUM 32 #define RESET_GPIO_NUM -1 #define XCLK_GPIO_NUM 0 #define SIOD_GPIO_NUM 26 #define SIOC_GPIO_NUM 27 #define Y9_GPIO_NUM 35 #define Y8_GPIO_NUM 34 #define Y7_GPIO_NUM 39 #define Y6_GPIO_NUM 36 #define Y5_GPIO_NUM 21 #define Y4_GPIO_NUM 19 #define Y3_GPIO_NUM 18 #define Y2_GPIO_NUM 5 #define VSYNC_GPIO_NUM 25 #define HREF_GPIO_NUM 23 #define PCLK_GPIO_NUM 22 void camera_init_(){ camera_config_t config; config.ledc_channel = LEDC_CHANNEL_0; config.ledc_timer = LEDC_TIMER_0; config.pin_d0 = Y2_GPIO_NUM; config.pin_d1 = Y3_GPIO_NUM; config.pin_d2 = Y4_GPIO_NUM; config.pin_d3 = Y5_GPIO_NUM; config.pin_d4 = Y6_GPIO_NUM; config.pin_d5 = Y7_GPIO_NUM; config.pin_d6 = Y8_GPIO_NUM; config.pin_d7 = Y9_GPIO_NUM; config.pin_xclk = XCLK_GPIO_NUM; config.pin_pclk = PCLK_GPIO_NUM; config.pin_vsync = VSYNC_GPIO_NUM; config.pin_href = HREF_GPIO_NUM; config.pin_sscb_sda = SIOD_GPIO_NUM; config.pin_sscb_scl = SIOC_GPIO_NUM; config.pin_pwdn = PWDN_GPIO_NUM; config.pin_reset = RESET_GPIO_NUM; config.xclk_freq_hz = 20000000; config.fb_count = 2; // for display config.frame_size = FRAMESIZE_QVGA; config.pixel_format = PIXFORMAT_RGB565; // camera init esp_err_t err = esp_camera_init(&amp;config); if (err != ESP_OK) { printf("Camera init failed with error 0x%x", err); return; } printf("Camera init OK\n"); }</span></span></code> </pre><br></div></div><br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¦ç‚¹</a> <br><br>  <u>FRAME_WIDTHæ˜¯QVGAçš„320åƒç´ çš„å¸§å®½åº¦</u> <br><br><pre> <code class="cpp hljs">config.frame_size = FRAMESIZE_QVGA; <span class="hljs-comment"><span class="hljs-comment">// 320x240</span></span></code> </pre><br> å®é™…ä¸Šï¼Œæˆ‘ä»¬åœ¨æ˜¾ç¤ºçª—å£ä¸­ä»¥å…¨å¸§å½¢å¼çœ‹åˆ°128 * 160 <br><br>  <i>ä½¿ç”¨ä¸€ä¸ªæ‘„åƒæœºç¼“å†²åŒºè®°å½•é…ç½®æ—¥å¿—ï¼ˆconfig.fb_count = 1ï¼‰</i> <i><br></i>  <i>æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š32æ¯«ç§’</i> <i><br></i>  <i>å‘é€ç¼“å†²æ—¶é—´ï¼š47æ¯«ç§’</i> <i><br></i>  <i>æ•è·æ¡†æ¶ã€‚</i> <br><br>  <b>ç»“æœ</b> <b><br></b>  <b>1000 /ï¼ˆ32 + 47ï¼‰= 12.65å¸§</b> <br><br><div class="spoiler">  <b class="spoiler_title">è®°å½•ä¸¤ä¸ªä¾¿æºå¼æ‘„åƒæœºç¼“å†²åŒºçš„é…ç½®ï¼ˆconfig.fb_count = 2ï¼‰</b> <div class="spoiler_text"> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š39æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š63æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š0æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š59æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š0æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š34æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š40æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š64 ms <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š0æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š59æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š0æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š34æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š40æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š63æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š0æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š60æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š0æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š34æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š39æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š63æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š0æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š60æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š1æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š34æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š40æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š63æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š0æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š60æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š0æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š34æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š40æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š63æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š0æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š59æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ <br> æ‹æ‘„ç›¸æœºæ—¶é—´ï¼š0æ¯«ç§’ <br><br> å‘é€ç¼“å†²æ—¶é—´ï¼š35æ¯«ç§’ <br><br> æ•è·æ¡†æ¶ã€‚ </div></div><br> ç”±äºä½¿ç”¨äº†æ‘„å½•ä¸€ä½“æœºçš„ç¬¬äºŒä¸ªç¼“å†²åŒºï¼Œå› æ­¤å¯ä»¥ç«‹å³è·å¾—æŸäº›å‘¨æœŸçš„ç¼“å†²åŒºã€‚ é¦–å…ˆï¼Œä½¿ç”¨ä¸åˆ°ä¸€ä¸ªç¼“å†²åŒºå°±å¯ä»¥è·å¾—å®Œæ•´çš„å¾ªç¯ï¼Œä½†æ˜¯è¿™ä¸€æ¬¡â€œç»§ç»­â€è¿›è¡Œã€‚ å‘¨æœŸä¹‹é—´çš„é—´éš”æ˜¯æµ®åŠ¨çš„ã€‚ <br><br> å‡ æ¬¡æˆ‘åœ¨æ—¥å¿—ä¸­å‘ç°â€œè§¦å‘äº†æ¬ å‹æ£€æµ‹å™¨â€ï¼Œå› æ­¤æˆ‘å…³é—­äº†æ£€æµ‹å™¨ã€‚ å› ä¸ºèµ·åˆæˆ‘ä»3.3V ESP32-CAMå¼•è„šæä¾›äº†èƒŒå…‰æ˜¾ç¤º <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"soc/rtc_cntl_reg.h"</span></span></span><span class="hljs-meta"> ... WRITE_PERI_REG(RTC_CNTL_BROWN_OUT_REG, 0); </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//disable brownout detector</span></span></span></span></code> </pre><br><h3> ç»“è®º </h3><br>  ESP32ä½æˆæœ¬åŠŸèƒ½æ¨¡å—ã€‚ å¯¹äºæ¿çš„CAMç‰ˆæœ¬ä¸­å·²å®ç°çš„ç«¯å£ï¼Œç¼ºä¹ç»“è®ºæ€§çš„ç¾éš¾æ€§ç»“è®ºï¼Œå› æ­¤ï¼Œå¦‚æœæ‚¨ç¡®å®éœ€è¦ç›¸æœºï¼Œè¯·é€‰æ‹©CAMç‰ˆæœ¬ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æœ‰ç”¨çš„é“¾æ¥</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">randomnerdtutorials.com/esp32-troubleshooting-guide</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">www.instructables.com/id/Select-Color-Display-for-ESP32</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github.com/gnulabis/UTFT-ESP</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github.com/Bodmer/TFT_eSPI</a> </div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN463157/">https://habr.com/ru/post/zh-CN463157/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN463143/index.html">Google Analyticsï¼ˆåˆ†æï¼‰å…¥é—¨ï¼šApp + Web</a></li>
<li><a href="../zh-CN463147/index.html">ROSæ‰‹æ¨è½¦æœºå™¨äººï¼Œç¬¬3éƒ¨åˆ†ï¼šåŠ é€Ÿï¼Œæ›´æ¢æ‘„åƒå¤´ï¼Œå›ºå®šæ­¥æ€</a></li>
<li><a href="../zh-CN463149/index.html">è‰¾ä¼¦Â·å‡¯ï¼ˆAlan Kayï¼‰å»ºè®®é˜…è¯»å¤è€è€Œåˆè¢«é—å¿˜ä½†é‡è¦çš„ç¼–ç¨‹ä¹¦ç±</a></li>
<li><a href="../zh-CN463151/index.html">æ”¾å¤§é•œä¸‹çš„iOS 13</a></li>
<li><a href="../zh-CN463155/index.html">ç™½å™ªå£°ç»˜åˆ¶ä¸€ä¸ªé»‘è‰²æ­£æ–¹å½¢ã€‚ ç¬¬2éƒ¨åˆ†ã€‚è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="../zh-CN463159/index.html">å…³äºå®‰å…¨æ€§ï¼Œå·ç ï¼Œç”µå­é‚®ä»¶ï¼Œä»¥åŠæœ‰å…³å¹¿å‘Šçš„å¾ˆå¤šçŸ¥è¯†</a></li>
<li><a href="../zh-CN463165/index.html">ç”µæŠ¥åå‡»DPIå¹¶é”å®š-ä¼ªé€ TLS</a></li>
<li><a href="../zh-CN463167/index.html">å¼€å§‹å¼€å‘åŸ¹è®­VRé¡¹ç›®æ‰€éœ€çš„ææ–™</a></li>
<li><a href="../zh-CN463169/index.html">å¼€æºåŠ©å¬å™¨-å·¥ä½œåŸç†</a></li>
<li><a href="../zh-CN463171/index.html">ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ï¼šåœ¨çº¿æ•™ç¨‹ï¼Œç¬¬6ç« ï¼Œç¬¬1éƒ¨åˆ†ï¼šæ·±åº¦å­¦ä¹ </a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>