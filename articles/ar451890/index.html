<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧙 ⌨️ 🐠 تفويض منطقة شبكة فرعية عكسي أقل من / 24 في BIND. كيف يعمل؟ 🛡️ 🏬 🆗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="بمجرد أن واجهت مهمة إعطاء أحد العملاء الحق في تحرير سجلات PTR الخاصة بالشبكة الفرعية المخصصة لها / 28. ليس لدي أتمتة لتحرير إعدادات BIND من الخارج. لذ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>تفويض منطقة شبكة فرعية عكسي أقل من / 24 في BIND. كيف يعمل؟</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451890/" style=";text-align:right;direction:rtl">  بمجرد أن واجهت مهمة إعطاء أحد العملاء الحق في تحرير سجلات PTR الخاصة بالشبكة الفرعية المخصصة لها / 28.  ليس لدي أتمتة لتحرير إعدادات BIND من الخارج.  لذلك قررت أن أذهب في الاتجاه الآخر - لتفويض العميل قطعة من منطقة الشبكة الفرعية PTR / 24. <br><br>  يبدو - ما يمكن أن يكون أسهل؟  نحن فقط نصف الشبكة الفرعية بالطريقة الصحيحة ونوجهها إلى NS المرغوب كما هو الحال مع المجال الفرعي.  لكن لا.  الأمر ليس بهذه البساطة (على الرغم من أنه في الواقع بدائي بشكل عام ، ولكن الحدس لن يساعد) ، ولهذا السبب أكتب هذا المقال. <br><br>  الذي يريد معرفة ذلك بنفسه يمكن قراءة <a href="">RFC</a> <br>  الذي يريد حل جاهز ، مرحبا بكم في القط. <br><a name="habracut"></a><br>  من أجل عدم تأخير أولئك الذين يحبون طريقة لصق النسخ ، أولاً سأقوم بنشر الجزء العملي ، وبعد ذلك الجزء النظري. <br><br>  <b>1. الممارسة.</b>  <b>منطقة التفويض / 28</b> <br><br>  دعنا نقول لدينا شبكة فرعية من <b>7.8.9.0/24</b> .  نحن بحاجة إلى تفويض الشبكة الفرعية <b>7.8.9.240/28</b> إلى عميل DNS <b>7.8.7.8</b> ( <b>ns1.client.domain</b> ). <br><br>  على موفر DNS ، تحتاج إلى العثور على ملف يصف المنطقة العكسية لهذه الشبكة الفرعية.  فليكن <b>9.8.7.in-addr.arpa</b> . <br>  تم تعليق المشاركات من 240 إلى 255 ، إن وجدت.  وفي نهاية الملف ، اكتب ما يلي: <br><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">255-240 IN NS 7.8.7.8 $GENERATE 240-255 $ CNAME $.255-240</code> </pre> <br>  لا تنسى زيادة المناطق التسلسلية والقيام بها <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">rndc reload</code> </pre> <br>  على هذا ، الجزء مزود انتهت.  نمررها إلى نظام أسماء النطاقات العميل. <br><br>  أولاً ، قم بإنشاء <b>/etc/bind/master/255-240.9.8.7.in-addr.arpa مع</b> المحتوى التالي: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ORIGIN 255-240.9.8.7.in-addr.arpa. $TTL 1W @ 1D IN SOA ns1.client.domain. root.client.domain. ( 2008152607 ; serial 3H ; refresh 15M ; retry 1W ; expiry 1D ) ; minimum @ IN NS ns1.client.domain. @ IN NS ns2.client.domain. 241 IN PTR test.client.domain. 242 IN PTR test2.client.domain. 245 IN PTR test5.client.domain.</code> </pre><br>  وفي <b>named.conf ،</b> أضف وصف <b>ملفنا</b> الجديد: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">zone "255-240.9.8.7.in-addr.arpa." IN { type master; file "master/255-240.9.8.7.in-addr.arpa"; };</code> </pre> <br>  ب إعادة تشغيل عملية الربط. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">/etc/init.d/named restart</code> </pre> <br>  هذا كل شيء.  الآن يمكنك التحقق. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; host 7.8.9.245 245.9.8.7.in-addr.arpa is an alias for 245.255-240.9.8.7.in-addr.arpa. 245.255-240.9.8.7.in-addr.arpa domain name pointer test5.client.domain.</code> </pre> <br>  يرجى ملاحظة أنه لا يتم توفير سجل PTR فقط ، ولكن أيضًا CNAME.  يجب أن يكون كذلك.  إذا كنت تتساءل لماذا ، ثم مرحبا بكم في الفصل التالي. <br><br>  <b>2. النظرية.</b>  <b>كيف يعمل؟</b> <br><br>  من الصعب تكوين مربع أسود وتصحيحه.  أسهل بكثير إذا فهمت ما يحدث في الداخل. <br><br>  عندما نقوم بتفويض نطاق فرعي في مجال <b>المجال</b> ، نكتب شيئًا مثل هذا: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">client.domain. NS ns1.client.domain. ns1.client.domain. A 7.8.7.8</code> </pre> <br>  نطلب من الجميع مطالبة أننا لسنا مسؤولين عن هذا الموقع ونقول من المسؤول.  <b>ويتم</b> إعادة توجيه جميع الطلبات إلى <b>client.domain</b> إلى 7.8.7.8.  عند التحقق ، نرى الصورة التالية (حذف ما لدى العميل هناك. لا يهم): <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># host test.client.domain test.client.domain has address 7.8.9.241</code> </pre> <br>  أي  أبلغنا أن هناك مثل هذا السجل A والملكية الفكرية 7.8.9.241.  لا توجد معلومات غير ضرورية. <br><br>  <b>ولكن كيف يمكن القيام بنفس الشيء مع شبكة فرعية؟</b> <br><br>  لأن  نظرًا لأن خادم DNS الخاص بنا مسجل في RIPE ، عند طلب عنوان IP PTR من شبكتنا ، فسيظل إرسال الطلب الأول إلينا.  المنطق هو نفسه كما هو الحال مع المجالات.  ولكن فقط كيفية إدخال الشبكة الفرعية في ملف المنطقة؟ <br><br>  نحن نحاول إدخاله مثل هذا: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">255-240 IN NS 7.8.7.8</code> </pre> <br>  و ... لم تحدث معجزة.  نحن لا نتلقى أي إعادة توجيه الطلب.  الشيء هو أن الربط ليس مدركًا على الإطلاق أن هذه الإدخالات في ملف المنطقة العكسية هي عناوين بروتوكول الإنترنت وأكثر من ذلك حتى لا يفهمون إدخال النطاق.  بالنسبة له ، هذا مجرد مجال فرعي رمزي.  أي  لربط لن يكون هناك فرق بين " <b>255-240</b> " و " <b>ouruperclient</b> ".  وطلب طلب الانتقال إلى حيث يجب أن يكون ، يجب أن يبدو العنوان في الطلب كما يلي: <b>241.255-240.9.8.7.in-addr.arpa</b> .  أو <b>هكذا</b> ، إذا استخدمنا <b>نطاقًا</b> فرعيًا للحرف: <b>241.oursuperclient.9.8.7.in-addr.arpa</b> .  هذا يختلف عن المعتاد: <b>241.9.8.7.in-addr.arpa</b> . <br><br>  الأيدي مثل هذا الطلب سيكون مشكلة.  وإذا نجحت ، فلا يزال من غير الواضح كيفية تطبيقها في الحياة الواقعية.  بعد كل شيء ، بناءً على طلب <b>7.8.9.241</b> ، لا يزال مزود DNS ، وليس العميل ، يرد علينا. <br><br>  وهنا يأتي دور <b>CNAME</b> . <br><br>  من جانب الموفر ، تحتاج إلى إنشاء اسم مستعار لجميع عناوين IP الخاصة بالشبكة الفرعية بتنسيق يؤدي إلى إعادة توجيه الطلب إلى DNS العميل. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">255-240 IN NS ns1.client.domain. 241 IN CNAME 241.255-240 242 IN CNAME 242.255-240  ..</code> </pre><br>  هذا هو للعمل الدؤوب =). <br><br>  وبالنسبة للكسل ، التصميم أدناه مناسب أكثر: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">255-240 IN NS ns1.client.domain. $GENERATE 240-255 $ CNAME $.255-240</code> </pre> <br>  سيتم الآن تحويل طلب المعلومات على <b>7.8.9.241</b> من <b>241.9.8.7.in-addr.arpa</b> على خادم DNS الخاص <b>بالمزود</b> إلى <b>241.255-240.9.8.7.in-addr.arpa</b> وسيتم الانتقال إلى عميل DNS. <br><br>  سيحتاج العميل إلى معالجة هذه الطلبات.  وفقًا لذلك ، نقوم بإنشاء منطقة <b>255-240.9.8.7.in-addr.arpa</b> .  في ذلك ، يمكننا بشكل أساسي نشر سجلات معاكسة لأي عنوان IP للشبكة الفرعية بالكامل / 24 ، ولكن لن يتم سؤالك إلا عن تلك التي سيقوم الموفر بإعادة توجيهها إلينا ، لذلك لن تكون قادرًا على اللعب =). <br>  للتوضيح ، سأقدم مثالاً على محتويات ملف المنطقة العكسية على جانب العميل: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ORIGIN 255-240.9.8.7.in-addr.arpa. $TTL 1W @ 1D IN SOA ns1.client.domain. root.client.domain. ( 2008152607 ; serial 3H ; refresh 15M ; retry 1W ; expiry 1D ) ; minimum @ IN NS ns1.client.domain. @ IN NS ns2.client.domain. 241 IN PTR test.client.domain. 242 IN PTR test2.client.domain. 245 IN PTR test5.client.domain.</code> </pre><br>  يرجع ذلك إلى حقيقة أننا نستخدم CNAME من جانب الموفر ، واستجابة لطلب البيانات على عنوان IP ، نحصل على سجلين وليس واحدًا. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; host 7.8.9.245 245.9.8.7.in-addr.arpa is an alias for 245.255-240.9.8.7.in-addr.arpa. 245.255-240.9.8.7.in-addr.arpa domain name pointer test5.client.domain.</code> </pre> <br>  <i><b>ولا تنسى تكوين ACL بشكل صحيح.</b></i>  <i><b>لأنه من غير المنطقي أن تأخذ منطقة PTR لنفسك ولا تجيب على أي شخص من الخارج =).</b></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar451890/">https://habr.com/ru/post/ar451890/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar451876/index.html">مركز بيانات فرانكفورت: مركز بيانات Telehouse</a></li>
<li><a href="../ar451878/index.html">البث المباشر للفيديو الاستريو إلى نظارات الواقع الافتراضي (Oculus Go)</a></li>
<li><a href="../ar451880/index.html">DevPRO'19: منظر من كشك Wrike</a></li>
<li><a href="../ar451884/index.html">سبع سنوات من العمل كمطور: ما هي الدروس التي تعلمتها</a></li>
<li><a href="../ar451886/index.html">باستخدام الرياضيات المنفصلة في الاختبار</a></li>
<li><a href="../ar451894/index.html">لمحة موجزة ومفعم بالحيوية عن برنامج التحويل البرمجي</a></li>
<li><a href="../ar451896/index.html">إن eyeDisk "غير قابلة للكسر" محمي بواسطة فحص القزحية ، ولكنه ينقل كلمة مرور بنص واضح</a></li>
<li><a href="../ar451898/index.html">الابتكار في الروسية</a></li>
<li><a href="../ar451900/index.html">المساهمة الأولى لمتصفح API من Facebook</a></li>
<li><a href="../ar451902/index.html">مايكروسوفت أزور المطور كامب روسيا</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>