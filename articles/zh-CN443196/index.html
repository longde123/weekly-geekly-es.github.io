<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💆🏾 🍉 🗯️ 离线一分钟-选择工业LTE路由器 🧡 👩🏼‍🤝‍👨🏽 👏🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在许多系统中，连接到Internet至关重要，例如在ATM，警报，监视和访问控制系统中，即使是几分钟的停机时间也很昂贵。 
 这样的系统通常使用几个Internet连接，如果主频道不可用，则会在不同的频道之间自动切换。 

 我已经厌倦了自己发明USB调制解调器的故障转移 ，并且想将其委托给单独的智...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>离线一分钟-选择工业LTE路由器</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443196/"><img alt="工业LTE Termit CR41P路由器，带天线Triad MA-2697" src="https://habrastorage.org/webt/qg/ns/hi/qgnshie5u3t0apgwhslrve0tan8.jpeg"><br><br> 在许多系统中，连接到Internet至关重要，例如在ATM，警报，监视和访问控制系统中，即使是几分钟的停机时间也很昂贵。 <br> 这样的系统通常使用几个Internet连接，如果主频道不可用，则会在不同的频道之间自动切换。 <br><br> 我已经厌倦了自己发明USB调制解调器的<abbr title="主通道发生事故时自动切换到备用通道的功能">故障转移</abbr> ，并且想将其委托给单独的智能硬件。 我决定对几台工业路由器进行比较，以了解它们是否能如期实现，并且比我的拐杖好多少。 本文将比较制造商iRZ，Termit，Robustel的路由器。 <br><br> 路由器的基本要求： <br><br><ul><li>  <b>2张SIM卡，并在运营商之间自动切换</b> -路由器应自动检测一位运营商的通讯中断，并切换到备份。 当蜂窝覆盖范围不够理想时，这对于移动系统尤为重要。 </li><li>  <b>以太网连接</b> -主系统应该只看到默认网关，并且不应该知道路由器端的调制解调器子系统和通道切换，因此没有USB。 </li><li>  <b>支持现代VPN协议：IKEv2和OpenVPN-</b>为了易于管理，并且为了不依赖真实IP地址，路由器必须能够VPN。 同时，不仅支持过时的PPTP和L2TP，还支持现代协议。 </li><li>  <b>（可选）GPS支持，GPIO可用性，RS-232 / 485串行接口</b> -这些功能对于我们的任务不是必需的，但我们也将其视为一项奖励，对某些人可能有用。 </li></ul><a name="habracut"></a><br><h2> 自制拐杖的问题 </h2><br><img alt="带两个USB调制解调器的Zyxel路由器安装在墙上。来自外部天线的导线已连接至调制解调器。" src="https://habrastorage.org/webt/hx/cs/r7/hxcsr7imx1mue6ba45gotbl1lsq.jpeg">  <font color="99999">带有两个USB调制解调器的Wi-Fi路由器（照片：Dmitry Bevza dgl.ru）</font> <br><br>  <b>故障转移</b> -在主通道无法访问的情况下，将Internet通道紧急切换到备用通道。 <br><br> 通常，为了保留Internet通道，我使用了带有OpenWRT固件和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">mwan3</a>软件包的家用Wi-Fi路由器。 它使您可以在多个Internet通道之间（包括在有线连接和USB调制解调器之间）配置自动备份和平衡。 <br><br> 这种方法的主要缺点是设备种类繁多，外部USB调制解调器的设计脆弱。 我喜欢带有HiLink固件（以太网仿真）的Huawei E3372h调制解调器。 这些调制解调器非常稳定且便宜，但是当连接外部天线时，整个结构变得非常脆弱。 天线的硬线会产生杠杆，调制解调器脱离USB端口，并且CRC9天线连接器本身不像SMA那样可靠，因为它没有螺钉安装。 <br><br><img alt="调制解调器华为E3372h。 USB调制解调器中的天线连接器不允许可靠地固定外部天线。他们很容易拉" src="https://habrastorage.org/webt/ro/xo/0f/roxo0fopuzd4u-7llqo3-zvmqvc.jpeg"><br>  <font color="99999">外部USB调制解调器上的组件非常脆弱：天线连接器未固定，调制解调器掉出端口</font> <br><br> 两个带有外部天线的USB调制解调器的设计必须很难固定，但是物理损坏和端口掉线仍然是主要问题。 该解决方案适合在难以到达的地方进行静态安装，但绝对不适合在汽车或DIN导轨上的电气面板中安装。 <br><br> 有时USB子系统挂在路由器上，并且调制解调器变得不可用。 除了mwan3（监视Internet的可用性）之外，我不得不编写一个<abbr title="看门狗-看门狗脚本，在挂起或其他问题时可重新启动设备">监视程序脚本</abbr> ，该<abbr title="看门狗-看门狗脚本，在挂起或其他问题时可重新启动设备">脚本</abbr>将分别监视调制解调器的可用性。 在某个时候，我已经厌倦了，于是我开始在一个盒子里寻找解决方案，在那里所有的问题都已经为我解决了。 <br><br><h2> 型号对照表 </h2><br> 即使单独购买调制解调器，工业路由器也比家用路由器贵。 因此，选择评审模型的主要标准是成本。 在我们的案例中，不需要其他功能，例如Wi-Fi，GPIO引脚和GPS，但我们仍会将它们作为会影响成本的选项进行比较。 <br><br><div class="scrollable-table"><table><tbody><tr><th> 型号 </th><th>  2张SIM卡 </th><th> 有线广域网 </th><th> 局域网端口 </th><th> 无线上网 </th><th> 全球定位系统 </th><th> 价钱 </th></tr><tr><td>  <b>终止CR41P</b> <div style="text-align:center;"><img width="70" src="https://habrastorage.org/webt/x9/wg/dw/x9wgdwh45lcy28q7-sdqpfdouv4.jpeg"></div></td><td align="center">  <b><font color="green">⁣⁣⁢⁢✓</font></b> </td><td align="center">  <b><font color="green">✓</font></b> </td><td align="center">  4 </td><td align="center">  <b><font color="green">✓</font></b> </td><td align="center">  <b><font color="green">✓</font></b> </td><td align="center">  ≈13000₽ </td></tr><tr><td>  <b>罗伯特R2000</b> <div style="text-align:center;"><img width="70" src="https://habrastorage.org/webt/ut/it/4y/utit4yd9chibkuq-sca7wthlh5w.jpeg"></div></td><td align="center">  <b><font color="green">✓</font></b> </td><td align="center">  <b><font color="green">✓</font></b> </td><td align="center">  2 </td><td align="center">  <b><font color="red">X</font></b> </td><td align="center">  <b><font color="red">X</font></b> </td><td align="center">  ≈12000₽ </td></tr><tr><td>  <b>艾尔兹RU22W</b> <div style="text-align:center;"><img width="70" src="https://habrastorage.org/webt/zj/gw/fq/zjgwfqzulchzwdwbxpp3hwnnlg4.jpeg"></div></td><td align="center">  <b><font color="green">✓</font></b> </td><td align="center">  <b><font color="green">✓</font></b> </td><td align="center">  4 </td><td align="center">  <b><font color="green">✓</font></b> </td><td align="center">  <b><font color="green">✓</font></b> </td><td align="center">  ≈15000₽ </td></tr></tbody></table></div><br><h2> 测试方法 </h2><br> 被比较的路由器的主要任务是在任何情况下都提供不间断的Internet，因此，如果主要路由器出现问题，我们将比较路由器切换到备用信道的性能。 为此，我们将模拟通信中断，并在服务器端测量路由器重新连接的速度。 <br><br> 作为目标主机，一个小型TP-Link MR3020路由器将连接到每个经过测试的路由器，该路由器将充当具有有效负载的计算机。 它将运行连接到服务器的OpenVPN。 监视将在服务器上启动，监视VPN隧道内部地址的可用性。 <br><br> 也就是说，在服务器端，将监视通过VPN隧道分配给mr3020的一个固定IP地址。 无论路由器上的流量通过哪个通道，监视服务器都将与一个地址交互。 因此，如果地址可用，则意味着路由器已成功切换了通道，并且NAT后面的网络中存在Internet。 <br> 为了尽快恢复OpenVPN隧道，请在服务器端将keep-alive选项设置为最小值，然后禁用加密： <br><br><pre><code class="plaintext hljs">cipher none ping 1 ping-restart 4</code> </pre> <br> 请记住，重新连接VPN需要花费时间，实际上Internet的恢复速度快于图表中显示的速度。 但是，这样的测试可以更真实地评估信道切换的事实，因为它表明路由器后面的客户端能够恢复TCP连接并恢复正常运行。 <br><br><img alt="测试台布局。 MR3020路由器充当一台运行VPN客户端的计算机。远程服务器正在监视VPN客户端的IP地址。" src="https://habrastorage.org/webt/6r/c3/qg/6rc3qgexexinb7dyzxrn57fva4u.jpeg"><br>  <font color="99999">TP-Link MR3020通过运行中的VPN隧道连接到每个路由器。</font>  <font color="99999">服务器端IP地址10.0.0.1的可用性被认为是可以正常使用的Internet</font> <br><br><h3>  PingPlotter-监控程序 </h3><br> 监视程序和OpenVPN服务器与VPN服务器位于同一台物理计算机上。 我将使用常规的ICMP Echo请求<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">监视MultiPing</a>实用程序。 请求间隔为1秒-这使您甚至可以在图表上看到主机的短期不可访问性。 <br><br><img alt="PingPlotter程序，用于监视主机可用性。模拟控制台MTR。" src="https://habrastorage.org/webt/xl/jo/hr/xljohrfhzsbcqlkvxibmyg9r5oi.jpeg"><br>  <font color="99999">PingPlotter绘制方便的ping图，显示延迟和数据包丢失</font> <br><br> 我承认，我尝试了很长时间来选择监视系统。 我尝试了zabbix，cacti，bash + rrdtool脚本，但对于我的任务而言，一切似乎都太复杂了。 结果，我找到了出色的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PingPlotter</a>程序及其简化版本，无需进行路由跟踪<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-MultiPing</a> 。 该程序允许以高达1秒的分辨率实时监视一组主机，并绘制详细的图形。 <br><br><h3> 空中的 </h3><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/rp/zb/-n/rpzb-ng9kxn09dwutarnwi3lke8.jpeg"></div><br>  <font color="99999">宽带天线Triad MA-2697，适用于蜂窝通信的基本范围</font> <br><br> 为了排除由于天线不同而导致的不同接收质量，将相同的<b>Triad MA-2697</b>天线连接到所有路由器。 根据制造商的说法，该天线是宽带的，工作在GSM-900 \ 1800 MHz，3G-2100 MHz，Wi-Fi-2400 MHz和4G WiMAX-2600 MHz频段。 我不会检查天线的质量。 即使情况不好，所有路由器也将在相同的接收条件下工作。 <br><br><h3> 移动运营商 </h3><br>  MegaFon和MTS SIM卡将安装在每台路由器中，个人价格通常是这样。 扩音器将被选作主要的MTS备份。 这样的优先级没有逻辑，选择是随机的。 在测试现场，两家运营商的LTE覆盖范围同样出色。 <br><br><h3> 测试台的缺点 </h3><br><img alt="所有路由器一次连接在桌子上。一大堆电线和天线。" src="https://habrastorage.org/webt/ws/hh/0x/wshh0xrb4btuvtynh7i1nvgc4tw.jpeg"><br>  <font color="99999">测试台部署在桌子上</font> <br><br> 由于测试台是固定在室内的，因此蜂窝网络的覆盖质量不会改变。 在这种情况下，当存在蜂窝网络信号时，不可能人为地模拟较差的覆盖范围，但是分组丢失太大。 以一种很好的方式，有必要在火车或汽车上放置一个架子，并将其搬到远离城市的地方。 这样就可以比较内置调制解调器在不良信号下的工作情况。 <br> 在我们的情况下，我们只能在主通道上完全造成通信中断，并观察路由器切换到备用通道的速度。 <br><br><h2> 终止CR41P </h2><br> 路由器由<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Digital Angel（digitalangel.ru）提供</a> <br><img src="https://habrastorage.org/webt/02/jr/46/02jr46l9ppy9zhzhxft4difgzqw.jpeg"><br><br>  <b>SoC</b> ：Atheros AR9344版本  3 <br>  <b>内存：</b> 128MB <br>  <b>闪存：</b> 16MB <br>  <b>Wi-Fi：</b> 802.11n（2.4GHz） <br>  <b>调制解调器</b> ： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Quectel EC25-E</a> （LTE Cat 4） <br>  <b>固件</b> ：基于OpenWRT 05/15/1 <br>  <b>USB主机</b> <br>  <b>微型SD</b> <br>  <b>DIN导轨安装</b> <br>  <b>GPS / GLONASS：</b> 3V有源天线 <br>  <b>串行接口：</b> RS-232 / 485 <br>  <b>I / O结论：</b> 2个数字输入（0-3V / 0-30V，电气隔离），1个模拟输入（0-24V），1个数字输出（30V，250 mA集电极开路），1个继电器输出（40V，4A SPST） ） <br><br><img src="https://habrastorage.org/webt/ng/xk/nj/ngxknj3_9ngbozqpdctv0toxxiq.jpeg"><br><br> 要安装SIM卡，您需要拧开四颗螺丝并卸下后盖。 <br><br> 好吧，这是一个更详细地考虑内部的机会。 <br><br> <a href=""><img width="200" src="https://habrastorage.org/webt/ks/9n/gw/ks9ngwqzqrk8cdyteyryts03rps.jpeg"></a> <a href=""><img width="200" src="https://habrastorage.org/webt/sx/fq/xw/sxfqxwf0yj8weghadcmgm2zzzly.jpeg"></a> <a href=""><img width="200" src="https://habrastorage.org/webt/9u/bc/ex/9ubcexugw11vsq7ijtqmf4jh8xa.jpeg"></a> <a href=""><img width="130" src="https://habrastorage.org/webt/fp/uu/r8/fpuur8zzgn5_xr_js_zerdo1bus.jpeg"></a>  <font color="99999">可点击</font> <br><br> 调制解调器部分以屏蔽形式制成，并戴在主板上。 <br> 在角落里，您可以看到继电器向I / O引脚提供了强大的负载输出。 <br><br> 评论中功能最丰富的路由器。 它具有有线WAN，并且还允许您在站（客户端）模式下将Wi-Fi用作单独的WAN。 也就是说，它可以具有四个备用Internet通道。 <br><br><img src="https://habrastorage.org/webt/xg/ct/vx/xgctvxwfg5i2_knyago4zpuxidq.png"><br><br>  Web界面立即从OpenWRT发出LuCI。 这可以在他们没有试图掩饰的设计中以及URL的路径中看到。 在我看来，这是一个加号，因为它使您自己完成系统变得容易。 固件中添加了工业功能：Modbus， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">VRRP</a> ，MQTT。 通过Modbus和MQTT，您可以控制基本功能，获取网络状态，GPS坐标，温度，开关配置文件，重启路由器，管理I / O引脚。 <br><br>  Internet通道的监视通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">multiwan</a>软件包完成，在OpenWRT Wiki中称为过时的软件包。 相反，建议使用mwan3。 <br><br><div class="spoiler">  <b class="spoiler_title">Web界面和其他功能概述</b> <div class="spoiler_text"><h3>  I / O结论 </h3><br>  I / O引脚通过Web界面进行管理，您可以立即查看状态并重命名每个引脚。 这不会替代成熟的微控制器，但可能适合于简单的自动化。 例如，通过SMS，MQTT或HTTP请求打开门或提高障碍，在触发传感器时执行操作，然后发送有关它的通知。 相当有趣的功能，可让您轻松使用一台设备。 <br><br><img width="700" alt="Termit CR41P路由器的模拟输入的触发配置接口" src="https://habrastorage.org/webt/v6/v6/zg/v6v6zgacpsc0cur47tedyaeppvc.png"><br>  <font color="99999">触发配置接口，用于模拟输入。</font>  <font color="99999">您可以指定触发器将在其中工作的电压范围，或将其配置为在退出范围时触发</font> <br><br><h3> 串行接口RS-232 / 485 </h3><br> 从物理上讲，RS-232接口采用DB9连接器（COM端口）的形式，而RS-485采用可移动端子块的形式。 在Web界面中，可以选择四种端口操作模式： <br><br><ul><li>  <b>系统控制台</b> -SSH访问 </li><li>  <b>IP串行</b> -通过Internet转发串行端口 </li><li>  <b>Modbus网关-Modbus</b> TCP &lt;-&gt; RTU转换器 </li><li>  <b>NTRIP客户端</b> -来自GPS的数据传输 </li></ul><br><img alt="在Termit CR41P路由器中选择串行端口的操作模式" src="https://habrastorage.org/webt/gu/3w/sw/gu3wswygt6lcqwfryyxmafu66ps.png"><br>  <font color="99999">选择串口操作模式</font> <br><br><h3> 全球定位系统 </h3><br>  GPS模块集成在调制解调器芯片中，可以作为USB设备使用。 它使您可以跟踪设备的坐标并通过GPS同步系统时钟，而路由器可以是NTP服务器，甚至可以在没有Internet的情况下为网络上的设备提供准确的时间。 有一个地理<abbr title="地理分区功能">围栏</abbr>功能，可让您将地理区域设置为在您访问或离开区域时触发的触发器。 离开家乡区域时，它可能对漫游很有用。 只能定义一个区域，并且只能在一个点的半径内定义，也就是说，该区域始终是一个圆。 <br><br><img src="https://habrastorage.org/webt/iu/f5/qu/iuf5qu-jiyfxqoddzb-pnsmkviw.png"><br>  <font color="99999">设置触发器触发的地理区域</font> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Dmesg输出</b> <div class="spoiler_text">  [0.000000] Linux版本3.18.44（gediminas @ gediminas-H110M-S2H）（gcc版本4.8.3（OpenWrt / Linaro GCC 4.8-2014.04 r40569））＃14 Fri May 25 15:09:41 EEST 2018 <br>  [0.000000] MyLoader：sysp = 30fe861a，boardp = 21046795，零件= 5c8953fe <br>  [0.000000]引导控制台[early0]已启用 <br>  [0.000000] CPU0修订为：0001974c（MIPS 74Kc） <br>  [0.000000] SoC：Atheros AR9344修订版3 <br>  [0.000000]确定的物理RAM映射： <br>  [0.000000]内存：08000000 @ 00000000（可用） <br>  [0.000000]找不到initrd或为空-禁用initrd <br>  [0.000000]区域范围： <br>  [0.000000]正常[内存0x00000000-0x07ffffff] <br>  [0.000000]每个节点的活动区域开始 <br>  [0.000000]早期内存节点范围 <br>  [0.000000]节点0：[内存0x00000000-0x07ffffff] <br>  [0.000000] Initmem设置节点0 [mem 0x00000000-0x07ffffff] <br>  [0.000000]在节点0上的总页数：32768 <br>  [0.000000] free_area_init_node：节点0，pgdat 803802b0，node_mem_map 81000000 <br>  [0.000000]普通区域：用于内存映射的256页 <br>  [0.000000]正常区域：保留0页 <br>  [0.000000]正常区域：32768页，LIFO批次：7 <br>  [0.000000]主指令高速缓存64kB，VIPT，4路，行大小为32字节。 <br>  [0.000000]主数据缓存32kB，4路，VIPT，缓存别名，行大小为32字节 <br>  [0.000000] pcpu-alloc：s0 r0 d32768 u32768 alloc = 1 * 32768 <br>  [0.000000] pcpu-alloc：[0] 0 <br>  [0.000000]以“区域”顺序构建了1个区域列表，移动性已分组。 总页数：32512 <br>  [0.000000]内核命令行：板= TLT-RUT900控制台= ttyS0,115200 rootfstype = squashfs，jffs2 noinitrd lpj = 1370112安静的日志级别= 3 <br>  [0.000000] PID哈希表条目：512（顺序：-1，2048个字节） <br>  [0.000000] Dentry缓存哈希表条目：16384（顺序：4、65536字节） <br>  [0.000000] Inode缓存哈希表条目：8192（顺序：3，32768字节） <br>  [0.000000]写入ErrCtl寄存器= 00000000 <br>  [0.000000]回读ErrCtl寄存器= 00000000 <br>  [0.000000]内存：125728K / 131072K可用（2611K内核代码，155K rwdata，552K rodata，256K init，189K bss，5344K保留） <br>  [0.000000] SLUB：HWalign = 32，Order = 0-3，MinObjects = 0，CPU = 1，节点= 1 <br>  [0.000000] NR_IRQS：83 <br>  [0.000000]时钟：CPU：550.000MHz，DDR：400.000MHz，AHB：200.000MHz，Ref：40.000MHz <br>  [0.000000]校准延迟回路（跳过）预设值... 274.02 BogoMIPS（lpj = 1370112） <br>  [0.000000] pid_max：默认值：最小32768：301 <br>  [0.000000]安装缓存哈希表条目：1024（顺序：0，4096字节） <br>  [0.000000] Mountpoint-cache哈希表条目：1024（顺序：0、4096字节） <br>  [0.000000] NET：注册的协议系列16 <br>  [0.000000] MIPS：机器为TELTONIKA TLT-RUT900 <br>  [0.450000] pca953x 0-0074：未在其中编译中断支持 <br>  [0.450000] i2c-gpio i2c-gpio.0：使用引脚17（SDA）和16（SCL） <br>  [0.450000]切换到时钟源MIPS <br>  [0.450000] NET：注册协议族2 <br>  [0.450000] TCP建立的哈希表条目：1024（顺序：0，4096字节） <br>  [0.450000] TCP绑定哈希表条目：1024（顺序：0、4096字节） <br>  [0.450000] TCP：已配置哈希表（已建立1024绑定1024） <br>  [0.450000] TCP：已注册reno <br>  [0.450000] UDP哈希表条目：256（顺序：0、4096字节） <br>  [0.450000] UDP-Lite哈希表条目：256（顺序：0、4096字节） <br>  [0.450000] NET：注册协议族1 <br>  [0.450000] PCI：CLS 0字节，默认32 <br>  [0.460000] futex哈希表条目：256（顺序：-1，3072字节） <br>  [0.460000] squashfs：4.0版（2009/01/31）Phillip Lougher <br>  [0.460000] jffs2：2.2版（NAND）（摘要）（LZMA）（RTIME）（CMODE_PRIORITY）©2001-2006 Red Hat，Inc. <br>  [0.460000] msgmni已设置为245 <br>  [0.460000] io Scheduler Noop已注册 <br>  [0.460000] io调度程序截止日期已注册（默认） <br>  [0.460000]串行：8250/16550驱动程序，1个端口，IRQ共享已禁用 <br>  [0.460000]控制台[ttyS0]已禁用 <br>  [0.480000] serial8250.0：MMIO 0x18020000（ir​​q = 11，base_baud = 2500000）上的ttyS0是16550A <br>  [0.480000]控制台[ttyS0]已启用 <br>  [0.480000]引导控制台[early0]已禁用 <br>  [0.480000] ar934x-hs-uart.0：MMIO 0x18500000（ir​​q = 14，base_baud = 2500000）上的ttyATH0是AR934X UART <br>  [0.500000] m25p80 spi0.0：发现gd25q128，预期为m25p80 <br>  [0.500000] m25p80 spi0.0：gd25q128（16384 KB） <br>  [0.500000]在MTD设备spi0.0上找到7个teltonika分区 <br>  [0.500000]在“ spi0.0”上创建7个MTD分区： <br>  [0.500000] 0x000000000000-0x000000020000：“ u-boot” <br>  [0.500000] 0x000000020000-0x000000030000：“配置” <br>  [0.500000] 0x000000030000-0x000000040000：“艺术” <br>  [0.500000] 0x000000040000-0x0000001630ac：“内核” <br>  [0.500000] 0x0000001630ac-0x000000f70000：“ rootfs” <br>  [0.500000] mtd：设备4（rootfs）设置为根文件系统 <br>  [0.510000]在MTD设备rootfs上找到1个squashfs-split分区 <br>  [0.510000] 0x000000b30000-0x000000f70000：“ rootfs_data” <br>  [0.510000] 0x000000040000-0x000000f70000：“固件” <br>  [0.510000] 0x000000f70000-0x000001000000：“事件日志” <br>  [0.520000] libphy：ag71xx_mdio：已探查 <br>  [1.110000] ag71xx-mdio.1：找到了AR934X内置交换机 <br>  [1.140000] eth0：0xba000000处的Atheros AG71xx，irq 5，模式：GMII <br>  [1.730000] ag71xx ag71xx.0：通过ag71xx-mdio.1连接到PHY：04 [uid = 004dd042，驱动程序=通用PHY] <br>  [1.730000] eth1：Atheros AG71xx在0xb9000000，irq 4，模式：MII <br>  [1.740000] TCP：立方注册 <br>  [1.740000] NET：注册协议族17 <br>  [1.740000]网桥：不赞成通过arp / ip / ip6tables自动过滤。 如果需要，请更新脚本以加载br_netfilter。 <br>  [1.740000]已注册网桥防火墙 <br>  [1.740000] 8021q：802.1Q VLAN支持v1.8 <br>  [1.750000] VFS：在设备31上只读挂载的根（squashfs文件系统）：4。 <br>  [1.750000]释放未使用的内核内存：256K（803a0000-803e0000） <br>  [5.030000] usbcore：已注册的新接口驱动程序usbfs <br>  [5.030000] usbcore：已注册的新接口驱动程序中心 <br>  [5.030000] usbcore：已注册的新设备驱动程序usb <br>  [5.050000] SCSI子系统已初始化 <br>  [5.050000] ehci_hcd：USB 2.0“增强型”主机控制器（EHCI）驱动程序 <br>  [5.050000] ehci平台：EHCI通用平台驱动程序 <br>  [5.050000] ehci平台ehci平台：EHCI主机控制器 <br>  [5.050000] ehci平台ehci平台：已注册新的USB总线，分配的总线号为1 <br>  [5.060000] ehci平台ehci平台：已启用TX-TX IDP修复 <br>  [5.060000] ehci平台ehci平台：irq 3，io mem 0x1b000000 <br>  [5.080000] ehci平台ehci平台：USB 2.0已启动，EHCI 1.00 <br>  [5.080000]集线器1-0：1.0：找到USB集线器 <br>  [5.080000]集线器1-0：1.0：检测到1个端口 <br>  [5.080000] uhci_hcd：USB通用主机控制器接口驱动程序 <br>  [5.090000] usbcore：已注册的新接口驱动程序usb-storage <br>  [5.400000] USB 1-1：使用ehci平台的新高速USB设备编号2 <br>  [5.550000]集线器1-1：1.0：找到USB集线器 <br>  [5.550000]集线器1-1：1.0：检测到3个端口 <br>  [5.830000] USB 1-1.1：使用ehci平台的新全速USB设备编号3 <br>  [6.620000] mount_root：从内部覆盖图加载kmods <br>  [7.080000] jffs2：通知：（339）jffs2_build_xattr_subsystem：完整地构建了xattr子系统，找到了0个xdatum（0个未选中，0个孤立）和0个xref（0个无效，0个孤立）。 <br>  [7.080000]块：尝试加载/ tmp / jffs_cfg / upper / etc / config / fstab <br>  [7.130000]块：extroot：未配置 <br>  [7.240000] jffs2：通知：（336）jffs2_build_xattr_subsystem：完整构建了xattr子系统，找到了0个xdatum（0个未选中，0个孤立）和0个xref（0个无效，0个孤立）。 <br>  [7.430000]块：尝试加载/ tmp / jffs_cfg / upper / etc / config / fstab <br>  [7.480000]块：extroot：未配置 <br>  [7.480000] mount_root：切换到jffs2覆盖 <br>  [9.980000]随机：具有18位熵的ubusd urandom读取 <br>  [11.260000] NET：已注册的协议系列10 <br>  [11.410000] ntfs：驱动程序2.1.31 [Flags：R / O MODULE]。 <br>  [11.430000]初始化XFRM netlink套接字 <br>  [11.430000] NET：注册协议家族15 <br>  [11.440000] tun：通用TUN / TAP设备驱动程序，1.6 <br>  [11.440000] tun：©1999-2004 Max Krasnyansky &lt;maxk@qualcomm.com&gt; <br>  [11.500000] l2tp_core：L2TP核心驱动程序，V2.0 <br>  [11.500000] l2tp_netlink：L2TP netlink接口 <br>  [11.510000] gre：GRE over IPv4多路分解器驱动程序 <br>  [11.510000] ip_gre：GRE over IPv4隧道驱动程序 <br>  [11.540000] ip6_tables：©2000-2006 Netfilter核心团队 <br>  [11.580000] nf_conntrack版本0.5.0（1968年存储桶，最大7872个） <br>  [12.110000] lp：驱动程序已加载，但未找到任何设备 <br>  [12.130000] ppdev：用户空间并行端口驱动程序 <br>  [12.290000] u32分类器 <br>  [12.290000]输入设备检查 <br>  [12.290000]已配置操作 <br>  [12.330000]启用镜像/重定向操作 <br>  [12.460000] cdc_acm 1-1.1：1.0：此设备无法自行执行呼叫。 它不是调制解调器。 <br>  [12.460000] cdc_acm 1-1.1：1.0：ttyACM0：USB ACM设备 <br>  [12.460000] usbcore：已注册的新接口驱动程序cdc_acm <br>  [12.460000] cdc_acm：用于USB调制解调器和ISDN适配器的USB抽象控制模型驱动程序 <br>  [12.470000] usbcore：已注册的新接口驱动程序cdc_wdm <br>  [12.500000]加载从Linux版本v4.4-rc5-1913-gc8fdf68反向移植的模块 <br>  [12.500000]由backports.git生成的backports-20151218-0-g2f58d9d <br>  [12.690000]已注册Ebtables v2.0 <br>  [12.730000] ip_tables：©2000-2006 Netfilter核心团队 <br>  [12.820000]通过NETLINK v0.30发出的Netfilter消息。 <br>  [12.850000] usbcore：注册了新的接口驱动程序usblp <br>  [12.890000] usbcore：注册了新的接口驱动程序usbserial <br>  [12.890000] usbcore：已注册的新接口驱动程序usbserial_generic <br>  [12.890000] usbserial：USB串行支持已注册为通用 <br>  [12.960000] xt_coova：准备好了 <br>  [13.050000] xt_time：内核时区为-0000 <br>  [13.050000] usbcore：注册了新的接口驱动程序ark3116 <br>  [13.050000] usbserial：已为ark3116注册USB串行支持 <br>  [13.060000] usbcore：已注册的新接口驱动程序belkin_sa <br>  [13.060000] usbserial：已为Belkin / Peracom / GoHubs USB串行适配器注册USB串行支持 <br>  [13.090000] usbcore：已注册的新接口驱动程序cdc_ether <br>  [13.170000] usbcore：已注册的新接口驱动程序cdc_ncm <br>  [13.860000] usbcore：已注册的新接口驱动程序ch341 <br>  [13.860000] usbserial：已为ch341-uart注册USB串行支持 <br>  [13.860000] usbcore：注册了新的接口驱动程序cp210x <br>  [13.860000] usbserial：已为cp210x注册了USB串行支持 <br>  [13.860000] usbcore：注册了新的接口驱动程序cypress_m8 <br>  [13.860000] usbserial：已为DeLorme Earthmate USB注册USB串行支持 <br>  [13.860000] usbserial：为HID-&gt; COM RS232适配器注册的USB串行支持 <br>  [13.860000] usbserial：已为诺基亚CA-42 V2适配器注册USB串行支持 <br>  [13.880000] usbcore：已注册的新接口驱动程序ftdi_sio <br>  [13.880000] usbserial：为FTDI USB串行设备注册的USB串行支持 <br>  [13.880000] usbcore：已注册的新接口驱动程序huawei_cdc_ncm <br>  [13.900000] usbcore：已注册的新界面驱动程序键盘跨度 <br>  [13.900000] usbserial：已为Keyspan注册了USB串行支持-（无固件） <br>  [13.900000] usbserial：为Keyspan 1端口适配器注册的USB串行支持 <br>  [13.900000] usbserial：已为Keyspan 2端口适配器注册USB串行支持 <br>  [13.900000] usbserial：已为Keyspan 4端口适配器注册USB串行支持 <br>  [13.990000] ctnetlink v0.93：向nfnetlink注册。 <br>  [14.020000] usbcore：已注册的新接口驱动程序pl2303 <br>  [14.020000] usbserial：已为pl2303注册的USB串行支持 <br>  [14.030000] PPP通用驱动程序版本2.4.2 <br>  [14.040000] PPP MPPE压缩模块已注册 <br>  [14.040000] NET：注册协议族24 <br>  [14.040000] PPTP驱动程序版本0.8.5 <br>  [14.050000] usbcore：注册了新的接口驱动程序qmi_wwan <br>  [14.140000] l2tp_ppp：PPPoL2TP内核驱动程序，V2.0 <br>  [14.140000] usbcore：已注册的新接口驱动程序选项 <br>  [14.140000] usbserial：USB串行支持注册为GSM调制解调器（1端口） <br>  [14.160000] usbcore：注册了新的接口驱动程序qcserial <br>  [14.160000] usbserial：为高通USB调制解调器注册的USB串行支持 <br>  [14.200000] ath：EEPROM regdomain：0x0 <br>  [14.200000] ath：EEPROM指示应使用默认的国家/地区代码 <br>  [14.200000] ath：正在执行EEPROM国家-&gt; regdmn映射搜索 <br>  [14.200000] ath：国家/地区映射到注册代码：0x3a <br>  [14.200000] ath：使用的国家/地区alpha2：美国 <br>  [14.200000] ath：使用的Regpair：0x3a <br>  [14.210000] ieee80211 phy0：选定的速率控制算法'minstrel_ht' <br>  [14.210000] ieee80211 phy0：Atheros AR9340 Rev：3 mem = 0xb8100000，irq = 47 <br>  [14.280000] mmc_spi spi0.1：假定3.2-3.4 V插槽电源 <br>  [17.330000] mmc_spi spi0.1：SD / MMC主机mmc0，无DMA，无WP，无关机 <br>  [17.330000] mmc_spi spi0.1：不支持卡的电压 <br>  [17.330000] mmc0：初始化SDIO卡时出现错误-22 <br>  [17.330000] mmc_spi spi0.1：不支持卡的电压 <br>  [17.330000] mmc0：初始化SD卡时出现错误-22 <br>  [17.340000] mmc_spi spi0.1：不支持卡的电压 <br>  [17.340000] mmc0：初始化MMC卡时出现错误-22 <br>  [20.700000] USB 1-1.3：使用ehci平台的新高速USB设备编号4 <br>  [20.920000]选项1-1.3：1.0：检测到GSM调制解调器（1端口）转换器 <br>  [20.920000] USB 1-1.3：GSM调制解调器（1端口）转换器现已连接到ttyUSB0 <br>  [20.930000]选项1-1.3：1.1：检测到GSM调制解调器（1端口）转换器 <br>  [20.940000] USB 1-1.3：GSM调制解调器（1端口）转换器现已连接到ttyUSB1 <br>  [20.950000]选项1-1.3：1.2：检测到GSM调制解调器（1端口）转换器 <br>  [20.950000] USB 1-1.3：GSM调制解调器（1端口）转换器现在已连接到ttyUSB2 <br>  [20.960000]选项1-1.3：1.3：检测到GSM调制解调器（1端口）转换器 <br>  [20.970000] USB 1-1.3：现已将GSM调制解调器（1端口）转换器连接到ttyUSB3 <br>  [21.000000] qmi_wwan 1-1.3：1.4：cdc-wdm0：USB WDM设备 <br>  [21.000000] qmi_wwan 1-1.3：1.4：Quectel EC21＆EC25＆EC20 R2.0在RawIP模式下工作 <br>  [21.010000] qmi_wwan 1-1.3：1.4 wwan0：在usb-ehci-platform-1.3，WWAN / QMI设备上注册'qmi_wwan'，3a：a9：1d：1a：9e：d9 <br>  [25.600000] jffs2：通知：（1621）jffs2_build_xattr_subsystem：完整地构建了xattr子系统，找到了0个xdatum（0个未选中，0个孤立）和0个xref（0个无效，0个孤立）。 <br>  [28.880000]设备eth0进入混杂模式 <br>  [28.890000] br-lan：端口1（eth0）进入转发状态 <br>  [28.890000] br-lan：端口1（eth0）进入转发状态 <br>  [30.010000] br-lan：端口1（eth0）进入了禁用状态 <br>  [34.410000]设备wlan0进入混杂模式 <br>  [34.420000] br-lan：端口2（wlan0）进入转发状态 <br>  [34.420000] br-lan：端口2（wlan0）进入转发状态 <br>  [34.460000] br-lan：端口2（wlan0）进入了禁用状态 <br>  [41.530000] br-lan：端口2（wlan0）进入转发状态 <br>  [41.530000] br-lan：端口2（wlan0）进入转发状态 <br>  [43.530000] br-lan：端口2（wlan0）进入转发状态 <br>  [51.350000]端口LED亮 <br>  [54.390000]随机：非阻塞池已初始化 <br></div></div><br><h3> 广域网设置 </h3><br>  Internet通道的优先级设置界面。 您可以选择一个主备份和两个备份。 在我们的例子中，调制解调器被选为主服务器，而有线广域网被选为备份。 <br><br><img src="https://habrastorage.org/webt/aw/v-/0f/awv-0fbsj-uhrbujobbdf1ajvju.png"><br>  <font color="99999">优先考虑互联网渠道。</font>  <font color="99999">您可以选择主要和备用</font> <br><br> 必须记住，路由器中只有一个调制解调器（无线电模块），并且网络中只能同时有一个SIM卡。 监视系统使用对给定主机的ping请求检查每个通道中的Internet可用性。 同时，您无法检查两个SIM卡中的哪个可以访问Internet，只能切换到另一个通道：有线或Wi-Fi。 切换SIM卡的条件是单独配置的，并且不依赖于常规监视。 <br><br><img src="https://habrastorage.org/webt/ac/sp/0i/acsp0ir4dzg4nn9scyraczlfx2e.png"><br>  <font color="99999">设置对Internet通道可用性的监视。</font>  <font color="99999">您可以指定要检查的主机，检查间隔和尝试次数</font> <br><br> 由于可访问性监视（openwrt的multiwan程序包）将调制解调器视为一个接口，因此如果调制解调器上的Internet不可用，它将无法启动SIM切换。  multiwan软件包只能切换主网络接口。 切换SIM卡的条件是分别设置的，并且只能在以下条件中选择：弱信号，流量限制，漫游，无网络，无PPP连接。 也就是说，在某些情况下，即使调制解调器没有Internet，调制解调器也可能不会切换SIM卡。 例如，如果操作员出现网络故障，而调制解调器具有IP地址，或者操作员阻止对网络的非付款访问，并使用付款接口重定向对存根的请求。 在这种情况下，由于与运营商之间存在正式联系，因此无法满足切换SIM卡的单一条件。 <br><br><img src="https://habrastorage.org/webt/z4/fn/_v/z4fn_v_hkzzwdmtt8v8zbqmstmy.png"><br>  <font color="99999">设置在SIM卡之间切换的条件不能与监视Internet的可用性一起使用</font> <br><br><h3> 崩溃模拟 </h3><br> 我们无法提出一种以编程方式模拟将SIM卡切换到此路由器中备用卡的条件的方法，因此我们将检查切换到备用有线信道的方法。 为此，请断开天线与路由器的连接，然后查看图表。 考虑到VPN连接的恢复，平均切换时间为12-15秒。 您可以通过减少检查间隔和切换触发的丢失数据包数量来减少此时间，但是过于主动的监视设置通常会在连接丢失仅几秒钟时导致误报。 <br><br><img src="https://habrastorage.org/webt/ld/x7/ky/ldx7kyt_jneacpbnn7k8bwnbtpm.png"><br>  <font color="99999">切换到备用频道的时间约为15秒</font> <br><br><h3> 结论 </h3><br> 具有许多其他功能的路由器。  I / O模块完成了一项有趣的工作：有模拟和数字输出，一个功率继电器。 您可以远程控制引脚并配置触发器。 这使您可以在单个路由器上使用外部外围设备构建简单的自动化。 例如，管理温室或空间供暖。 <br><br><h3> 优点 </h3><br><ul><li> 许多额外功能 </li><li>  OpenWRT平台 </li><li> 支持LTE Cat 4 </li><li> 三种类型的WAN：调制解调器，以太网，WiFi </li></ul><br><h3> 缺点 </h3><br><ul><li> 您不能为每个SIM卡指定不同的监视地址 </li><li>     SIM-       </li></ul><br><h2> Robustel R2000 </h2><br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> (euromobile.ru)</a> <br><br><img src="https://habrastorage.org/webt/n1/qj/yl/n1qjyl7k6qlzchb-xrfvodxmzq8.jpeg"><br><br> <b>SoC</b> : Atheros 533MHz <br> <b>RAM:</b> 64MB <br> <b>Flash :</b> 16MB <br> <b></b> : Huawei ME909s-120 (LTE Cat 4) <br> <b></b> : ,   Linux <br><br>    Ethernet-   .    LAN-    WAN.  , root   SSH .        (  Ubiquiti). <br><br><img src="https://habrastorage.org/webt/fr/dy/xt/frdyxt3ne19neo2alb3jnlrhaks.png"><br><br><div class="spoiler"> <b class="spoiler_title"> -</b> <div class="spoiler_text"><h3> VPN </h3><br>    OpenVPN  IPsec IKEv2. <br><br><img src="https://habrastorage.org/webt/tc/ui/94/tcui94qphqqtsiobuqim33ex75w.png"><br> <font color="99999">  IPsec-</font> <br><br><img src="https://habrastorage.org/webt/wy/5y/tc/wy5ytcup64mukqbx7cwus-s5j2y.png"><br> <font color="99999">  OpenVPN-</font> <br><br><h3>  </h3><br>      syslog <br><br><img src="https://habrastorage.org/webt/qe/bm/wb/qebmwbndt6houxtpz_wmn0ruwiu.png"><br><br>           email  SMS <br><br><img src="https://habrastorage.org/webt/5n/rp/de/5nrpdefpw527-oaiomtkojtdufw.png"><br><br><h3> User LED </h3><br>         . ,   VPN  . <br><br><img src="https://habrastorage.org/webt/yx/or/ds/yxordsyltko7ccvnoryjzllsjmq.png"><br></div></div><br><h3>  WAN </h3><br>      .          . <br><br><ul><li> <b>Cold backup:</b>    ,    </li><li> <b>Warm backup:</b>   ,    (   SIM ) <br></li><li> <b>Load balancing:</b>     </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在默认设置下，由于某种原因，禁用了切换到备用通道后返回主通道的功能。此设置在“还原间隔”中，当设置为零时，通道将在切换到备份后再也不会切换回去。</font></font><br><br><img src="https://habrastorage.org/webt/l8/mg/q0/l8mgq0me4l9-kuc_s6cnp_xbnca.png"><br> <font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置WAN优先级和模式</font></font></font> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个SIM卡都配置为单独的接口：WWAN1和WWAN2。对于每个接口，您可以分别配置地址以检查Internet的可用性以及您自己的间隔。这是审阅中唯一可以一次指定两个主机进行验证的路由器。当测试主机崩溃但可以访问Internet时，这对于防止误报很有用。</font></font><br><br><img src="https://habrastorage.org/webt/ib/bq/mw/ibbqmwpnvmirmzjpn24y7w_ri7s.png"><br> <font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以将每个SIM卡配置为检查Internet可用性。</font></font></font> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">路由器的固件并不意味着对系统的根访问，因此，如果不打开外壳，我将无法确定该设备所使用的芯片组。</font><font style="vertical-align: inherit;">因此，不能在路由器上安装自制的脚本和软件包，所有功能都严格受本机固件的功能限制。</font><font style="vertical-align: inherit;">可以从</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">robustel.com/products/app-center/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储库中安装几个其他软件包</font><font style="vertical-align: inherit;">，但这不能与OpenWRT存储库中的软件包集合进行比较。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另一方面，这种封闭的系统可用于防止固件的不受控制的更改，这些更改随后在Web界面中看不到。</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 崩溃模拟 </font></font></h3><br>            SIM-,       SIM-   ,   -   .        ,      . <br><br><img src="https://habrastorage.org/webt/q9/_y/wf/q9_ywfjronuxvlvxfexwleqvnxu.png"><br> <font color="99999">   SIM-  15-30 </font> <br><br>       SIM-  15-30 . ,          .         ,        SIM-.       ,       .       . <br><br><h3> 结论 </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">紧凑而简单的路由器，功能最少，易于配置。</font><font style="vertical-align: inherit;">封闭的平台和缺乏root访问权限可能会干扰某人。</font><font style="vertical-align: inherit;">在易于设置更重要的情况下，建议使用此功能。</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 优点 </font></font></h3><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 每个SIM卡的单独故障转移设置 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 支持LTE Cat 4 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 热备份模式，其中备份通道不会关闭 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 设置简单 </font></font></li></ul><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 缺点 </font></font></h3><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 封闭平台，无root访问权限 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 截断的SSH控制台 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 仅有一个以太网端口可以用作WAN </font></font></li></ul><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 艾尔兹RU22W </font></font></h2><br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  (digitalangel.ru)</a> <br><br><img src="https://habrastorage.org/webt/fb/9a/9p/fb9a9pe15uw7yi4nat3ubroxjqe.jpeg"><br><br> <b>SoC</b> : MediaTek MT7620A ver:2 eco:6 <br> <b>RAM:</b> 64 <br> <b>Flash :</b> 16 <br> <b>Wi-Fi:</b> 802.11n (2.4GHz) <br> <b></b> : Huawei MU709s-2 <br> <b>  MicroSD</b> <br> <b>GPS</b> <br> <b></b> :   OpenWRT 15.05 <br><br>    LTE,   3G- HSPA+/UMTS (900/2100 MHz)  2G GSM/GPRS (850/900/1800/1900 MHz),    .   GPS, Wi-Fi   . -  Ethernet-    ,         VLAN     WAN. Wi-Fi      (),    WAN. ,   SIM-    7 WAN-. 还不错 <br><br><img src="https://habrastorage.org/webt/ac/i4/as/aci4asvfbkhr1pd7eephyr5vnpe.jpeg"><br><br><div class="spoiler"> <b class="spoiler_title"> -</b> <div class="spoiler_text"><h3> - </h3><br><img src="https://habrastorage.org/webt/ba/rt/lg/bartlgh67o5nyeibyrwpecwgesg.png"><br> <i> ,   ,   ,  , IMEI,    .</i> <br><br><img src="https://habrastorage.org/webt/ji/1g/jn/ji1gjnngxube3lbfcbvqhsaj-pg.png"><br> <i>Wi-Fi-       (AP)   (Station).   ,    SSID .</i> <br><br><h3> VPN </h3><br> OpenVPN  ,   IPSec — .   Cisco IPSec,    IKEv2. <br><br><img src="https://habrastorage.org/webt/y1/zq/94/y1zq94hbklflhtuqyflb8atrn-e.png"> <font color="99999">  Cisco IPSec    IKEv2</font> <br><br>   Ethernet over IP <br><br><img src="https://habrastorage.org/webt/v_/ek/vo/v_ekvopdlr-tiqakeuicqi3ktec.png"><br><br><h3> RS-232/485 </h3><br>        serial over ip   modbus TCP&lt;-&gt;RTU.  AT-    . <br><br><img src="https://habrastorage.org/webt/hb/c4/cc/hbc4ccxc66tnvtdtfurop90yxcy.png"><br><br><h2> GPIO </h2><br>  c GPIO  .      -,     ,    . ,  - API,    ,  .     .      . <br><br><img src="https://habrastorage.org/webt/4a/9h/g0/4a9hg0vn4x4mecqxomblllawwi8.png"><br></div></div><br><h3>  WAN </h3><br><img src="https://habrastorage.org/webt/4u/rn/13/4urn13ydfvfgndltxscieamvkf0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在“路由”菜单中选择接口优先级。</font><font style="vertical-align: inherit;">您可以选择以下两种模式之一：故障转移和平衡。</font><font style="vertical-align: inherit;">万一主要服务器不可用，第一个将通道切换到备用接口，第二个将在NAT级别在接口之间平均分配流量。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用性监视和接口故障转移是使用iRZ的自制bash脚本完成的。</font><font style="vertical-align: inherit;">例如，服务</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ usr / bin / pinger</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发送ping，切换接口并控制LED。</font><font style="vertical-align: inherit;">相当苛刻的Bashism :)</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SIM卡设置 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于每个SIM卡，您可以设置自己的连接检查主机。</font><font style="vertical-align: inherit;">当我们要根据服务提供商选择不同的服务器时，这非常方便。</font><font style="vertical-align: inherit;">例如，在漫游中，我们使用一台服务器，在本国区域中使用另一台服务器。</font></font><br><br><img src="https://habrastorage.org/webt/-n/in/vj/-ninvjs0j3otmg5b1crc551cct0.png"><br> <font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以设置不同的主机，以检查每个SIM卡的通信情况</font></font></font> <br><br><h2> 全球定位系统 </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除了通过控制台上的gpsctl之外，我没有找到以某种方式使用GPS模块的功能。</font><font style="vertical-align: inherit;">Web界面根本没有提及它。</font><font style="vertical-align: inherit;">我相信它是通过本机云服务激活的，用于路由器的集中管理。</font><font style="vertical-align: inherit;">我个人无法使用GPS API被认为是一个缺点。</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 崩溃模拟 </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于每张SIM卡，我们指定了不同的主机来检查Internet的可访问性，因此我们可以轻松地模拟事故。</font><font style="vertical-align: inherit;">为此，我们将从防火墙上的第一张SIM卡中阻止主机，并查看路由器如何对此做出响应。</font><font style="vertical-align: inherit;">为了保证实验的纯度，我们将设置与第一个路由器相同的测试间隔和尝试次数。</font></font><br><br><img src="https://habrastorage.org/webt/pa/mz/qr/pamzqr3gicp5tt1rtat2mmyqkdg.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在几次尝试中，平均切换时间为30秒，有时会长时间注册第二张SIM卡，并且切换会延迟一分钟。</font><font style="vertical-align: inherit;">不知道这是由于调制解调器还是移动运营商的功能所致。</font></font><br><br><h2> 结论 </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我很高兴有机会获得多达4个有线WAN和每个SIM卡单独的故障转移设置。</font><font style="vertical-align: inherit;">GPS模块的用途仍然难以理解；没有第三方软件就无法使用。</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 优点 </font></font></h3><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 基于OpenWRT的开放平台 </font></font></li><li>   failover   SIM- </li><li>  LAN-    WAN </li></ul><br><h3>  </h3><br><ul><li>   IPsec IKEv2 </li><li> ,   GPS   GPIO    </li></ul><br><hr><br><h2> 结论 </h2><br>   ,          SOHO-.         OpenWRT,    ,        -,        watchdog-,     . <br><br>    GPIO   GPS ,   ,     ,       . <br><br>           .        .      ,         . ,     . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN443196/">https://habr.com/ru/post/zh-CN443196/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN443186/index.html">3CX技术支持响应-5 IP PBX安全规则</a></li>
<li><a href="../zh-CN443188/index.html">三只眼睛垂在柱子上，或者传说ATtiny13的五条腿就足够了</a></li>
<li><a href="../zh-CN443190/index.html">安全专业人员的Kubernetes网络策略简介</a></li>
<li><a href="../zh-CN443192/index.html">Python中没有下划线和接口的私有方法</a></li>
<li><a href="../zh-CN443194/index.html">WFIRM工程师发明了一种生物打印机，可以直接在伤口上打印皮肤</a></li>
<li><a href="../zh-CN443198/index.html">马克·扎克伯格（Mark Zuckerberg）说，Facebook正在研究一种用于阅读思想的神经接口</a></li>
<li><a href="../zh-CN443200/index.html">伊朗黑客从Citrix窃取了TB的数据</a></li>
<li><a href="../zh-CN443202/index.html">集会反对孤立的Runet</a></li>
<li><a href="../zh-CN443204/index.html">前端每周摘要（2019年3月4日至10日）</a></li>
<li><a href="../zh-CN443206/index.html">性能不佳的地雷正在等待</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>