<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“™ ğŸ“ˆ ğŸ›‚ Orkestra Pertunjukan ğŸ ğŸ‘¨â€âš–ï¸ ğŸ™ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hampir tidak salah untuk mengatakan yang terbaik dari orang 
 dapatkan sukacita melalui penderitaan. 
 Ludwig van Beethoven 





 Saya Sergey, saya b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Orkestra Pertunjukan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yamoney/blog/443822/"><p>  <em>Hampir tidak salah untuk mengatakan yang terbaik dari orang</em> <em><br></em>  <em>dapatkan sukacita melalui penderitaan.</em> <em><br></em>  <em>Ludwig van Beethoven</em> </p><br><p><img src="https://habrastorage.org/webt/9k/ht/xx/9khtxxwiwqsesccfpb5n2sbrnwo.jpeg"></p><br><p>  Saya Sergey, saya bekerja di Yandex.Money di tim riset kinerja.  Saya ingin memberi tahu Anda awal dari sebuah cerita tentang jalan kami menggunakan orkestrasi - bagaimana kami memilih instrumen dan apa yang kami perhitungkan.  Semua peristiwa dari artikel berlangsung secara real time, sehingga Anda, pembaca yang budiman, mengikuti perkembangan situasi yang hampir hidup. </p><a name="habracut"></a><br><h2 id="zachem-nam-dirizhyor-v-komande">  Mengapa kita membutuhkan konduktor di tim? </h2><br><p>  Siapa konduktor?  Dari fr.  diriger - mengelola, mengarahkan, memimpin - di dunia musik - ini adalah seseorang, pemimpin pembelajaran dan kinerja musik ansambel.  Dalam kasus kami, tempat ini ditempati oleh sistem orkestrasi dan otomatisasi. </p><br><p>  Peran mereka tidak berbeda dengan peran konduktor dalam musik - mereka diperlukan untuk membantu tim, mengarahkan dan mengatur permainannya. </p><br><p>  Sebagai aturan, sebuah tim memiliki serangkaian kapasitas tertentu - sebut saja mereka server di mana mereka melaksanakan proyek mereka. </p><br><p>  Pendekatan untuk mendapatkan dan mengoperasikan server ini beragam.  Beberapa contoh: </p><br><ul><li>  Tim membuat permintaan, misalnya, kepada kelompok operasi, untuk memberi mereka sumber daya dengan parameter tertentu. </li><li>  Kelompok operasi memberi mereka jumlah yang diperlukan - cloud atau bare metal ("bare metal") - dan berjanji untuk mempertahankannya dalam kondisi yang baik sesuai dengan SLA.  Penyesuaian juga dilakukan oleh tim operasi. </li><li>  Tim hanya menerima sumber daya cloud atau bare metal dari grup operasi, ia melakukan pengaturannya sendiri. </li><li>  Tim itu sendiri â€œmembeliâ€ sumber daya dan mendukung / mengonfigurasinya sepenuhnya secara independen. </li></ul><br><p>  Tim kami menggunakan server yang perlu didukung - memperbarui OS, menginstal paket baru, dll. </p><br><p>  Bagi kami sendiri, kami membedakan mereka menjadi dua jenis utama: </p><br><ul><li>  kelompok tangki </li><li>  kelompok layanan. </li></ul><br><p>  Grup tangki terdiri dari host dengan Yandex.Tank. </p><br><p>  Grup layanan mencakup segala sesuatu yang berkaitan dengan pemeliharaan - ini adalah berbagai layanan untuk memberikan dukungan untuk siklus rilis, menghasilkan laporan otomatis, dll. </p><br><p>  Pada satu titik, semuanya menjadi tidak nyaman untuk mengelola semua ini secara manual, dan kami berpikir untuk mengotomatiskan seluruh proses, mulai dari "memuat" server dan berakhir dengan pengembangan, tata letak, dan peluncuran layanan internal kami. </p><br><h2 id="pochemu-dirizhyor-nuzhen-dazhe-esli-orkestr-sam-umeet-igrat">  Mengapa seorang konduktor diperlukan, bahkan jika orkestra itu sendiri dapat bermain? </h2><br><p>  Untuk memulainya, kami menguasai Ansible dan mulai â€œmenuangkanâ€ server bare metal kami agar tidak terlalu bergantung pada administrator sistem - semua orang menang di sini, kami memperoleh keterampilan baru dan membebaskan administrator dari bagian pekerjaan yang selalu mereka miliki tanpa kami.  Kami berusaha keras untuk mengembangkan tim kami di luar spesialisasi dan otonomi kami sebanyak mungkin. </p><br><p>  Perusahaan telah bekerja dengan Ansible untuk waktu yang lama sudah diatur dan diatur, sehingga kami dengan mudah mengintegrasikan solusi kami ke dalam proses ini. </p><br><p>  Hosting sekarang terdiri dari tiga peran yang dimungkinkan: </p><br><ul><li>  peran pertama menginstal OS, </li><li>  gulungan pengaturan dasar untuk tuan rumah, otorisasi LDAP, misalnya, </li><li>  dan yang ketiga menginstal Yandex.Tank dan dependensi terkait dalam wadah buruh pelabuhan. </li></ul><br><p>  Mari kita beralih ke layanan yang kita gunakan di dalam tim. </p><br><p> Untuk tugas kami, kami sama-sama menggunakan Kotlin dan Python, dan sedikit lagi Golang.  Untuk menyatukan pengembangan dan penyebaran layanan kami, kami memutuskan untuk mengemasnya dalam wadah buruh pelabuhan.  Ini memberikan kebebasan untuk memilih bahasa pemrograman dan pada saat yang sama mengatur format pengiriman seragam dari aplikasinya. </p><br><h3 id="nebolshaya-remarka-pro-ipv6-v-docker">  Sebuah komentar kecil tentang ipv6 di Docker </h3><br><p>  Beberapa layanan yang berinteraksi dengan kami hanya tersedia melalui ipv6, jadi saya harus mencari cara membuat ipv6 untuk wadah. </p><br><p>  Menurut dokumentasi untuk ipv6 di situs web Docker resmi, ipv6 diaktifkan dengan menambahkan parameter ke daemon.json: </p><br><pre><code class="plaintext hljs">{ "ipv6": true, "fixed-cidr-v6": "2001:db8:1::/64" }</code> </pre> <br><p>  Dalam hal ini, penyedia harus mengeluarkan subnet ipv6, yang akan Anda <code>fixed-cidr-v6.</code> di <code>fixed-cidr-v6.</code> <br>  Namun, kami memilih opsi lain - ipv6 NAT, dan inilah alasannya: </p><br><ul><li>  Sekarang buruh pelabuhan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tidak dapat digunakan</a> hanya dengan ipv6. </li><li>  Kehadiran alamat yang dapat dialihkan secara global di setiap wadah berarti bahwa semua port (bahkan yang tidak dipublikasikan) tersedia untuk semua orang jika penyaringan tambahan tidak dilakukan. </li><li>  proxy userland untuk portpublikasi, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">iptables hanya untuk ipv4</a> . </li></ul><br><p>  ipv6 NAT adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">wadah buruh pelabuhan</a> yang dengan sendirinya mengelola aturan di ip6table dan mengeditnya saat wadah baru ditambahkan. </p><br><p>  Agar solusi ini berfungsi dengan benar, sejumlah manipulasi harus dilakukan.  Pastikan untuk menginisialisasi ip6table_nat pada sistem.  Kehadiran modul yang terinstal di sistem tidak menjamin bahwa pada saat startup modul akan dimuat ke dalam kernel.  Kami menemukan ini ketika kami mendapatkan kesalahan ini ketika memulai sebuah wadah dengan NAT pada host baru: </p><br><pre> <code class="plaintext hljs">2019/01/22 14:59:54 running [/sbin/ip6tables -t filter -N DOCKER --wait]: exit status 3: modprobe: can't change directory to '/lib/modules': No such file or directory ip6tables v1.6.2: can't initialize ip6tables table `filter': Table does not exist (do you need to insmod?)</code> </pre> <br><p>  Masalahnya dipecahkan setelah menambahkan inisialisasi ke peran Ansible menggunakan modul modprobe dan memuatnya pada startup menggunakan lineinfile: </p><br><pre> <code class="plaintext hljs">- name: Add ip6table_nat module modprobe: name: ip6table_nat state: present - name: Add ip6table_nat to boot lineinfile: path: /etc/modules line: 'ip6table_nat'</code> </pre> <br><p>  Ngomong-ngomong, ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel</a> bagus tentang Haber, yang secara singkat dan jelas menjelaskan kelebihan dan kekurangan metode tertentu untuk bekerja dengan ipv6 di buruh pelabuhan. </p><br><p>  Tetapi kembali ke pertanyaan kami yang diajukan di awal: <br>  <strong>Mengapa seorang konduktor diperlukan, bahkan jika orkestra itu sendiri dapat bermain?</strong> </p><br><p>  Sekarang semua orang tahu cara bermain di tim kami: </p><br><ul><li>  proses "mengisi" server dibuat, </li><li>  pengembangan dan penyebaran layanan disatukan. </li></ul><br><p>  Muncul pertanyaan yang masuk akal - bagaimana cara menyebarkan, memperbarui, mengontrol layanan kami dalam wadah buruh pelabuhan secara efisien dan seotomatis mungkin? </p><br><p>  Terlepas dari kenyataan bahwa setiap anggota orkestra mengetahui bagiannya sendiri, ia dapat tersesat, menjauh dari ide aslinya.  Di sini kita sampai pada fakta bahwa tanpa konduktor orkestra kita tidak akan secara efektif berlatih dan bermain secara harmonis.  Konduktor bertanggung jawab atas semua parameter kinerja, untuk memastikan bahwa semuanya disatukan oleh kecepatan dan suasana hati yang tunggal. </p><br><h2 id="kak-s-minimalnymi-vlozheniyami-poluchit-horoshego-dirizhera">  Bagaimana cara mendapatkan konduktor yang baik dengan investasi minimal? </h2><br><p>  Tema orkestrasi dikembangkan dengan baik di pasar.  Tetapi pertama-tama, mari kita bicara tentang alat pendukung yang dapat membantu konduktor. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Konsul</a> adalah sistem yang menyediakan dua fungsi utama: </p><br><ul><li>  penemuan layanan </li><li>  penyimpanan nilai kunci terdistribusi. </li></ul><br><p>  Di orkestra kami, Konsul akan bertanggung jawab untuk mendaftarkan layanan dan menyimpan konfigurasi mereka.  Ada dua opsi pendaftaran: </p><br><ul><li>  Aktif - ini adalah saat layanan itu sendiri mendaftar sendiri menggunakan HTTP API; </li><li>  Pasif - layanan harus didaftarkan secara manual. </li></ul><br><p>  Vault adalah repositori yang menstandarkan dan menyatukan penyimpanan yang aman dan bekerja dengan rahasia - kata sandi, sertifikat. <br>  Berikut adalah manfaat yang akan kami peroleh dengan menggunakan alat ini: </p><br><ul><li>  Pusat tunggal untuk membuat dan menyimpan rahasia, mengelola siklus hidup mereka melalui API HTTP. </li><li>  Transit Secrets Engine - enkripsi-dekripsi data tanpa menyimpannya.  Kemampuan untuk mengirimkan data dalam bentuk terenkripsi melalui saluran komunikasi yang tidak aman. </li><li>  Kebijakan akses yang nyaman untuk dikonfigurasi. </li><li>  Akses audit ke rahasia. </li><li>  Kemampuan untuk membuat CA (Otoritas Sertifikat) Anda sendiri untuk mengelola sertifikat yang ditandatangani sendiri dalam infrastruktur Anda. </li></ul><br><p>  Mempertimbangkan semua persyaratan kami, dua opsi cocok dengan peran konduktor - Kubernetes dan Nomad. </p><br><h4 id="kubernetes">  Kubernetes </h4><br><p>  Berapa banyak artikel dan buku yang telah ditulis tentang dia (yang ini, misalnya), laporan telah diberitahu bahwa saya akan menulis secara singkat - ini adalah prosesor universal yang dapat melakukan hampir semua hal.  Membayar untuk itu tidak selalu mudah untuk diatur dan mendukung sebuah cluster di Kubernetes. </p><br><h4 id="nomad">  Pengembara </h4><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Alat ini</a> dari HashiCorp, sebuah perusahaan yang dikenal dengan konsul dan kubah yang disebutkan di atas. </p><br><p>  Nomad bagi kami agaknya mudah diinstal dan dikonfigurasikan daripada Kubernetes.  Satu file biner berfungsi baik dalam mode server dan klien.  Pada saat yang sama, Nomad mencakup seluruh daftar tugas yang kami ingin menyelesaikannya: manajemen klaster, penjadwal cepat, dukungan multidatacenter.  Plus, ketika menggunakan konsul dan lemari besi, kami mendapatkan integrasi yang lebih ketat untuk mengatur layanan kami. </p><br><p>  Apa yang sekarang sedang bekerja: </p><br><ul><li>  menyiapkan server untuk penyebaran Konsul, </li><li>  konfigurasi cluster nomad akan dimasukkan dalam Konsul, yang nomad mana yang akan digunakan secara otomatis, </li><li>  Secara paralel, kami akan memasang lemari besi untuk menyimpan rahasia. </li></ul><br><p>  Pertanyaan di aula adalah apakah layak memiliki konduktor untuk tugas-tugas seperti itu, atau apakah orkestra baik tanpa itu?  Beri tahu kami di komentar apa pendapat Anda tentang ini. </p><br><hr><br><p>  Berlangganan ke blog kami dan tetap terhubung - kami akan segera memberi tahu Anda apa yang terjadi pada akhirnya dan apakah kami mengkonfigurasi cluster nomad, seperti yang kami inginkan. </p><br><p>  Kunjungi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ruang obrolan telegram</a> kami yang nyaman di mana Anda selalu dapat meminta saran, membantu kolega dan hanya berbicara tentang penelitian kinerja dan banyak lagi. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id443822/">https://habr.com/ru/post/id443822/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id443812/index.html">Bagaimana menerapkan bahasa pemrograman dalam JavaScript. Bagian 2: Penerjemah</a></li>
<li><a href="../id443814/index.html">Memberi adalah "bekas bisnis" saya</a></li>
<li><a href="../id443816/index.html">Kementerian Komunikasi menekankan pada operator 5G tunggal</a></li>
<li><a href="../id443818/index.html">Intisari Acara IT Digest (Bagian Dua)</a></li>
<li><a href="../id443820/index.html">Bagaimana Bandara Fukuoka menemukan langkah-langkah mana yang efektif untuk mengurangi antrian</a></li>
<li><a href="../id443824/index.html">5 alasan untuk beralih ke pencetakan 3D produk logam</a></li>
<li><a href="../id443826/index.html">Mencegah keusangan bahan ajar</a></li>
<li><a href="../id443828/index.html">Asal Mula Budaya Startup: Bagaimana Kisah Sukses Awal Membentuk Keadaan Modern dari Industri Teknologi</a></li>
<li><a href="../id443830/index.html">Tesla memperkenalkan Model Y baru - detail, foto dari presentasi dan tayangan uji coba</a></li>
<li><a href="../id443834/index.html">Runet pada pergantian milenium: apa yang Anda ingat tentang itu?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>