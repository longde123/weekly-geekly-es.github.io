<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚èèÔ∏è üî£ ü•ô ShIoTiny e o mundo: sensores anal√≥gicos ou ADCs para os menores üòà üÜë üîö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pontos principais ou sobre o que √© este artigo 


 Continua√ß√£o de uma s√©rie de artigos sobre o ShIoTiny - um controlador visualmente program√°vel basea...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ShIoTiny e o mundo: sensores anal√≥gicos ou ADCs para os menores</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466443/"><p><img src="https://habrastorage.org/webt/fr/no/k7/frnok7ogh51ujstrunvuo69naww.jpeg" alt="imagem"></p><br><h3 id="osnovnye-tezisy-ili-o-chem-eta-statya">  Pontos principais ou sobre o que √© este artigo </h3><br><p>  Continua√ß√£o de uma s√©rie de artigos sobre o <strong>ShIoTiny</strong> - um controlador visualmente program√°vel baseado no chip <strong>ESP8266</strong> .  Um recurso importante desse controlador √© a capacidade de program√°-lo desenhando um programa em um navegador. </p><br><p>  Este artigo descreve uma breve teoria da convers√£o anal√≥gico-digital e a aplica√ß√£o pr√°tica do controlador <strong>ShIoTiny</strong> ADC. </p><br><p>  <strong>Artigos anteriores da s√©rie.</strong> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ShIoTiny: pequena automa√ß√£o, a Internet das coisas ou "seis meses antes das f√©rias"</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ShIoTiny: n√≥s, links e eventos ou recursos de programas de desenho</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ShIoTiny: ventila√ß√£o em salas √∫midas (exemplo de projeto)</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ShIoTiny e o mundo ao redor: conectando sensores a entradas bin√°rias, rejei√ß√£o de contato e outros problemas</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Site do projeto</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Firmware bin√°rio, circuito do controlador e documenta√ß√£o aqui</a> </p><a name="habracut"></a><br><h3 id="vstuplenie-ili-vmesto-sereznoy-teorii">  Introdu√ß√£o ou em vez de teoria s√©ria </h3><br><p>  Em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> anterior <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">,</a> examinamos a conex√£o dos principais tipos de sensores com uma sa√≠da bin√°ria √†s entradas bin√°rias do controlador <strong>ShIoTiny</strong> . </p><br><p>  Mas, como muitas pessoas, assim como alunos e alunos, sabem, a maior parte das informa√ß√µes sobre o mundo circundante s√£o quantidades anal√≥gicas de v√°rias naturezas f√≠sicas: o poder da luz e do som, a velocidade, a press√£o do ar, o n√≠vel do l√≠quido e assim por diante. </p><br><p>  Quase todos os microprocessadores e microcontroladores modernos s√£o capazes de processar apenas valores discretos na representa√ß√£o bin√°ria. </p><br><p>  Para aqueles que ainda n√£o sabem como o valor anal√≥gico difere do valor discreto, escreverei breves explica√ß√µes.  Quem j√° sabe tudo pode pular.  Farei uma reserva imediatamente - analogias e simplifica√ß√µes t√™m um lugar para estar.  Esta n√£o √© uma disserta√ß√£o, mas explica√ß√µes breves nos dedos. </p><br><h3 id="analogovye-i-diskretnye-velichiny-professoram-akademikam-i-vunderkindam-mozhno-ne-chitat">  Quantidades anal√≥gicas e discretas (voc√™ n√£o pode ler para professores, acad√™micos e geeks) </h3><br><p>  Todo mundo estudou matem√°tica na escola.  Portanto, nos voltamos para ele e tra√ßamos analogias entre quantidades e n√∫meros anal√≥gicos e discretos. </p><br><p>  Do ponto de vista da matem√°tica, uma quantidade <strong>anal√≥gica</strong> √© um n√∫mero <strong>real</strong> , definido em qualquer ponto de um determinado segmento de uma linha num√©rica. </p><br><p>  <strong>O</strong> valor <strong>discreto</strong> do ponto de vista da matem√°tica √© <strong>um n√∫mero inteiro</strong> .  E √© definido apenas em determinados pontos de um determinado segmento de uma linha num√©rica. </p><br><p>  A figura abaixo mostra esquematicamente a localiza√ß√£o dos n√∫meros-quantidades anal√≥gicas e discretas em uma linha num√©rica. </p><br><p><img src="https://habrastorage.org/webt/_f/py/tm/_fpytmw_jsgmgxgr-1saubap86m.png" alt="imagem"></p><br><p>  Por exemplo, considere um segmento de uma linha num√©rica de <strong>-4</strong> a <strong>3</strong> .  Como voc√™ pode ver, quantidades <strong>discretas</strong> indicadas por pontos <strong>vermelhos</strong> - n√∫meros inteiros s√£o apenas 8 pe√ßas.  <strong>Os</strong> valores <strong>anal√≥gicos</strong> mostrados pela linha <strong>verde</strong> na figura s√£o infinitos. </p><br><p>  Por exemplo, temos uma certa quantidade <strong>X</strong> , que possui um intervalo de valores de <strong>0</strong> a <strong>127</strong> .  Se representarmos essa quantidade como <strong>anal√≥gica</strong> , teoricamente, podemos represent√°-la com qualquer precis√£o - por exemplo, <strong>12.123455454980</strong> ou <strong>126.00000000007</strong> ou, em geral, com um milh√£o de casas decimais. </p><br><p>  Mas assim que o microcontrolador entra no neg√≥cio e o valor de <strong>X</strong> adquire uma representa√ß√£o <strong>discreta</strong> , n√£o se pode falar em nenhuma "precis√£o infinita", mesmo teoricamente.  A precis√£o √© limitada pelo n√∫mero de d√≠gitos bin√°rios, que atribu√≠mos √† representa√ß√£o da quantidade <strong>X.</strong> </p><br><p>  Por exemplo, pegamos <strong>7</strong> bits.  Nesse caso, podemos representar o valor de <strong>X</strong> com uma precis√£o de um.  Ou seja, ser√° poss√≠vel especificar <strong>X = 1</strong> ou <strong>X = 112</strong> .  Mas <strong>X = 112,5</strong> j√° n√£o pode ser indicado - n√£o h√° profundidade de bits suficiente.  Se considerarmos que a representa√ß√£o do mesmo valor de <strong>X</strong> n√£o √© <strong>7</strong> , mas <strong>10</strong> d√≠gitos, a precis√£o da representa√ß√£o n√£o ser√° uma, mas <strong>0,125</strong> .  E nesta forma, voc√™ pode imaginar <strong>X = 95.125</strong> ou <strong>X = 112.5</strong> .  Mas, mais precisamente, por exemplo, na forma <strong>X = 112.13</strong> - esse valor j√° n√£o pode ser representado. </p><br><p>  Se voc√™ est√° confuso com o fato de eu escrever valores fracion√°rios e ao mesmo tempo falar deles como n√∫meros inteiros, lembre-se de que "pontos discretos" podem ser colocados em uma linha num√©rica, n√£o em unidades, mas, por exemplo, em <strong>0,5</strong> ou <strong>0,125</strong> unidades.  Mas, como eram, o valor final permanecer√° em qualquer segmento.  E todas as propriedades de uma quantidade discreta s√£o preservadas. </p><br><p>  <strong>A principal</strong> diferen√ßa entre um valor <strong>discreto</strong> e um <strong>anal√≥gico</strong> √© que, em qualquer segmento finito de uma linha num√©rica, haver√° um n√∫mero finito de valores discretos (inteiros) e um n√∫mero infinito de valores anal√≥gicos (reais).  Consequentemente, obtemos que a representa√ß√£o discreta de quantidades sempre tem precis√£o finita. </p><br><p>  Como resultado de tudo isso, obtemos uma <strong>conclus√£o</strong> trivial.  A maioria das quantidades mensur√°veis ‚Äã‚Äãdo mundo real √© <strong>anal√≥gica</strong> .  Os microcontroladores funcionam apenas com representa√ß√µes num√©ricas <strong>discretas</strong> de quantidades.  Portanto, antes de processar qualquer valor anal√≥gico usando um microcontrolador, esse valor deve ser representado como um valor discreto.  Sim, e em formato bin√°rio. </p><br><p>  <strong><em>Essa convers√£o de anal√≥gico para digital √© denominada convers√£o de anal√≥gico para digital</em></strong> . </p><br><h3 id="analogo-cifrovoy-preobrazovatel">  Conversor anal√≥gico para digital </h3><br><p>  Um dispositivo para converter um sinal anal√≥gico em digital √© chamado <strong>ADC</strong> ( <strong>conversor anal√≥gico-digital</strong> ). </p><br><p>  Normalmente, esse dispositivo possui uma ou mais entradas anal√≥gicas, √†s quais s√£o fornecidos um sinal anal√≥gico e uma sa√≠da digital com uma profundidade de bits especificada (geralmente de 8 a 16 bits). </p><br><p>  Microcontroladores modernos, incluindo o <strong>ESP8266</strong> , possuem unidades ADC integradas. </p><br><p>  Quais caracter√≠sticas o ADC em geral e o <strong>ESP8266 ADC</strong> em particular? </p><br><p>  <strong>A primeira</strong> caracter√≠stica √© que tipo de valor anal√≥gico de entrada o ADC converte em um c√≥digo digital de sa√≠da.  Na maioria das vezes, esse valor √© a tens√£o na entrada anal√≥gica do ADC.  Assim ser√° no nosso caso.  Mas, na natureza, existem ADCs com entrada atual. </p><br><p>  <strong>A segunda</strong> caracter√≠stica do ADC, necess√°ria na pr√°tica, √© a faixa de valores do valor de entrada do ADC.  No nosso caso, esses s√£o os valores m√≠nimo e m√°ximo de tens√£o na entrada do ADC.  Esses valores ser√£o <strong>0V</strong> e <strong>1V,</strong> respectivamente.  A faixa de entrada de <strong>1V</strong> parece pequena, mas grandes tens√µes sempre podem ser divididas e reduzidas, e pequenas tens√µes podem ser amplificadas. </p><br><p>  <strong>A terceira</strong> e talvez a caracter√≠stica mais importante do ADC √© sua capacidade.  Este valor determina a precis√£o da transforma√ß√£o ou (por nossa analogia) - com que freq√º√™ncia os pontos "discretos" s√£o colocados na linha num√©rica "real".  No nosso caso, o ADC tem uma resolu√ß√£o de <strong>10</strong> .  O que isso significa?  E isso significa que o c√≥digo digital de sa√≠da √© representado por 10 d√≠gitos bin√°rios e possui 1024 valores - de 0 a 1023. <br>  A rigor, vale lembrar que a precis√£o da convers√£o depende n√£o apenas da profundidade do bit, mas tamb√©m de v√°rios outros par√¢metros, por exemplo, a linearidade do ADC.  Mas muito j√° foi escrito sobre isso por tios muito espertos em livros muito espertos; portanto, neste artigo deixarei o leitor sem detalhes. </p><br><p>  Al√©m disso, o <strong>ESP8266 ADC</strong> pode detectar transbordamento, ou seja, uma situa√ß√£o em que uma tens√£o maior que <strong>1V √©</strong> aplicada √† entrada. </p><br><p>  Se voc√™ pegar um livro de refer√™ncia inteligente sobre ADCs e olhar para l√°, haver√° dezenas de outras caracter√≠sticas.  Todos eles s√£o necess√°rios e importantes, mas n√£o iremos t√£o longe.  <strong>Por exemplo</strong> , <em>n√£o tocaremos nos par√¢metros de tempo do ADC</em> , pois acreditamos que, no nosso caso, os valores medidos mudam bastante lentamente e o ADC os converte em uma representa√ß√£o digital "instantaneamente". </p><br><p>  <strong>Resumir o resultado</strong> preliminar. <br>  O controlador <strong>ShIoTiny</strong> possui um ADC embutido no <strong>ESP8266</strong> . </p><br><p>  Uma tens√£o na faixa de <strong>0</strong> a <strong>1V</strong> √© aplicada √† entrada do <strong>ADC ESP8266</strong> . </p><br><p>  Na sa√≠da do <strong>ESP8266 ADC,</strong> obtemos um n√∫mero proporcional √† tens√£o de entrada no intervalo de <strong>0</strong> a <strong>1023</strong> .  A tens√£o <strong>0V</strong> corresponde ao c√≥digo <strong>0</strong> na sa√≠da ADC, a tens√£o <strong>1V</strong> corresponde ao c√≥digo <strong>1023</strong> na sa√≠da ADC. </p><br><p>  A leitura dos dados do ADC no <strong>ShIoTiny √©</strong> realizada a uma velocidade de aproximadamente <strong>10 vezes por segundo</strong> . </p><br><p>  A entrada de hardware do ADC √© protegida contra sobretens√£o, semelhante √† maneira como as entradas bin√°rias <strong>Input1,2,3 s√£o protegidas</strong> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">veja aqui</a> ). </p><br><p>  √â isso para o <strong>hardware ShIoTiny ADC</strong> . </p><br><p>  Agora vamos <strong>lidar com o</strong> n√≥ <strong>ADC1</strong> , que processa dados do <strong>ADC de</strong> hardware do <strong>ESP8266</strong> . </p><br><h3 id="programmnye-navoroty-ili-uzel-adc1">  Software sinos ou assobios ADC1 </h3><br><p>  No diagrama do programa no editor <strong>ElDraw</strong> , o conjunto do conversor anal√≥gico-digital √© chamado <strong>ADC1</strong> . </p><br><img src="https://habrastorage.org/webt/bt/wn/ub/btwnub4pibvpje98rsdylqdvizs.png"><br><p>  Como j√° mencionado, o n√≥ <strong>ADC1</strong> recebe dados do <strong>ADC de</strong> hardware <strong>ESP8266</strong> aproximadamente <strong>10 vezes por segundo</strong> .  Mas o n√≥ especificado n√£o se acalma com isso, mas come√ßa a processar esses dados e at√© analis√°-los um pouco. </p><br><p>  <strong>Em primeiro lugar</strong> , √© verificado - houve um estouro de ADC?  Ou seja - o ADC n√£o entrou mais do que <strong>1V</strong> ?  Se tal situa√ß√£o for detectada, a sa√≠da do n√≥ <strong>ADC1 ser√°</strong> configurada para <strong>NAN</strong> ( <strong>n√£o um n√∫mero</strong> ). </p><br><p>  <strong>Em segundo lugar</strong> , se n√£o houver transbordamento, o valor de sa√≠da do ADC <strong>0..1023 √©</strong> convertido no valor de tens√£o na entrada do ADC <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.116ex" height="1.817ex" viewBox="0 -520.7 1341.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-6E" x="345" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-1"> u_ {in} </script>  - um n√∫mero de ponto flutuante no intervalo <strong>0..1</strong> . </p><br><p>  <strong>Em terceiro lugar</strong> , esse valor convertido <strong>0..1 √©</strong> recalculado de acordo com a f√≥rmula <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi><mo>=</mo><mi>k</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub><mo>+</mo><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.014ex" height="2.419ex" viewBox="0 -780.1 7755.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-3D" x="1130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-6B" x="2186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-63" x="2958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-64" x="3391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-6F" x="3915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-74" x="4400" y="0"></use><g transform="translate(4762,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-6E" x="345" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-2B" x="6325" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-62" x="7326" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi><mo>=</mo><mi>k</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub><mo>+</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> X = k \ cdot u_ {in} + b </script>  onde <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.116ex" height="1.817ex" viewBox="0 -520.7 1341.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-6E" x="345" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-3"> u_ {in} </script>  - tens√£o na entrada do ADC (de <strong>0</strong> a <strong>1V</strong> );  <strong>k</strong> √© o intervalo (intervalo <strong>ADC</strong> ) <strong>eb</strong> √© o deslocamento ( <strong>deslocamento ADC</strong> ).  E, finalmente, o valor obtido de <strong>X √©</strong> definido para a sa√≠da do n√≥ <strong>ADC1</strong> . </p><br><p>  E finalmente <strong>no quinto</strong> .  Se o valor de <strong>X</strong> tiver sido alterado em uma porcentagem especificada (de <strong>1</strong> a <strong>100%</strong> ), a unidade ADC gerar√° eventos, causando uma convers√£o dos valores dos n√≥s conectados a ela.  Este √© essencialmente o par√¢metro de <strong>sensibilidade</strong> do <strong>ADC</strong> ( <strong>altera√ß√µes do ADC, intervalo%</strong> ).  Afinal, geralmente n√£o h√° raz√£o para reagir ‚Äúa todos os espirros‚Äù, ou seja, √†s escassas mudan√ßas nos bits inferiores do ADC - eles geralmente ‚Äúfazem barulho‚Äù.  Portanto, o par√¢metro de sensibilidade √© de grande import√¢ncia pr√°tica. </p><br><p>  Surge a pergunta leg√≠tima - como configuramos essas configura√ß√µes?  Clique com o mouse no n√≥ <strong>ADC1</strong> no diagrama e voc√™ ver√° uma janela de configura√ß√µes. </p><br><p>  Nele voc√™ pode definir tudo o que precisa.  Para o nosso caso, ser√° uma janela, como na figura. </p><br><p><img src="https://habrastorage.org/webt/cn/so/ub/cnsoubc9q_rhu-2p6hlffcd_1ig.png" alt="imagem"></p><br><p>  Nesta janela, voc√™ pode definir todos os par√¢metros mencionados acima - a faixa, o deslocamento e a sensibilidade do ADC. </p><br><p>  Se voc√™ n√£o especificou nada, o intervalo ser√° 1. O deslocamento √© zero.  E a sensibilidade √© de 1%. </p><br><p>  Ou seja, por padr√£o, de fato, a sa√≠da do n√≥ <strong>ADC1</strong> ser√° o valor da tens√£o anal√≥gica fornecida √† entrada ADC. </p><br><p>  Como voc√™ pode ver, o n√≥ <strong>ADC1 √©</strong> bastante complexo.  Por que tudo isso √© feito? <del>  Sim para voc√™, meus queridos usu√°rios! </del>  Brincadeirinha, √© claro, como um ego√≠sta malicioso, levei em conta a experi√™ncia anterior e tentei facilitar minha vida. </p><br><p>  N√≥s, como engenheiros simples, queremos que os valores sejam apresentados n√£o em "papagaios", mas em valores normais e compreens√≠veis - volts, amperes, quilogramas ou metros. </p><br><p>  Muitos sensores fornecem o valor "em papagaios", esperando que um microcontrolador inteligente os recalcule para os valores desejados. </p><br><p>  Para esse fim, foi introduzida a convers√£o do valor ADC medido pela fun√ß√£o de um dado. </p><br><p>  Mas, como sempre, √© melhor ver uma vez do que ouvir dez vezes.  Tamb√©m √© melhor tentar uma vez do que ver dez vezes ... Mas esse n√£o √© o ponto. <br>  Portanto, darei alguns exemplos n√£o complicados: um sistema de controle de fonte de alimenta√ß√£o e um sistema de medi√ß√£o de temperatura baseado em um sensor com uma sa√≠da de corrente de <strong>4-20mA</strong> . </p><br><h3 id="kontrol-pitayuschey-seti">  Monitoramento de rede </h3><br><p>  Medir a tens√£o √© uma tarefa comum.  Por exemplo, queremos medir a tens√£o da rede el√©trica <strong>~ 220V</strong> .  Se temos um fornecimento ruim de eletricidade, a tarefa √© muito real.  N√£o precisamos de uma mudan√ßa muito, muito precisa.  Basta que, quando a tens√£o estiver 15% acima da norma, o <strong>rel√©1 for</strong> acionado no <strong>ShIoTiny</strong> e, quando a tens√£o for reduzida em 15% da norma, o <strong>rel√©2 for acionado</strong> . </p><br><p>  Obviamente, n√£o podemos <strong>conectar a</strong> entrada <strong>ADC1 do</strong> controlador <strong>ShIoTIny</strong> em um soquete.  O que fazer  Em primeiro lugar, a tens√£o deve ser reduzida para um n√≠vel aceit√°vel - <strong>0..1V</strong> .  E, em segundo lugar, deve ser retificado: nosso ADC n√£o pode medir a tens√£o alternada. </p><br><p>  A voltagem na rede pode estar abaixo da norma e acima dela.  Por uma quest√£o de simplicidade, <strong>assumimos</strong> que <strong>220V da</strong> tens√£o <strong>da</strong> rede corresponder√° a <strong>0,5V da</strong> tens√£o na entrada do ADC. </p><br><p>  Em seguida, procuramos por qualquer transformador de abaixamento que a <strong>~ 220V da</strong> tens√£o de entrada nos forne√ßa, digamos <strong>~ 3V da</strong> tens√£o de sa√≠da e monte um circuito como na figura abaixo. </p><br><br><p>  Aqui, uma <strong>surpresa</strong> pode aguardar os ignorantes em eletr√¥nica.  Na sa√≠da do retificador, n√£o a tens√£o de <strong>3V</strong> DC aparece repentinamente, mas mais de <strong>4V</strong> !  De fato, tudo √© simplesmente explicado.  Quando medimos uma tens√£o alternada, o volt√≠metro mostra o valor <strong>real da</strong> tens√£o.  E quando retificamos essa tens√£o, na sa√≠da do retificador obtemos o valor de <strong>pico</strong> da tens√£o, que para o sinal sinusoidal √© de cerca de <strong>1,41</strong> , e exatamente <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mn>2</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.791ex" height="2.298ex" viewBox="0 -728.2 2493.5 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-71" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-72" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-74" x="1631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-32" x="1993" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-4"> \ sqrt 2 </script>  vezes mais que o atual.  Da√≠ o "incompreens√≠vel" <strong>4,23V</strong> na sa√≠da do retificador. </p><br><p>  E, finalmente, precisamos calcular o divisor de tens√£o, ou seja, a resist√™ncia <strong>R1</strong> e <strong>R2</strong> .  Precisamos obter a sa√≠da do divisor <strong>0,5V</strong> com uma tens√£o na entrada <strong>4,23V</strong> .  Portanto, a tens√£o retificada de <strong>4,23V</strong> deve ser dividida por <strong>8,46</strong> vezes.  Para fazer isso, defina o resistor <strong>R2 = 100 Ohms</strong> e o resistor <strong>R1 = 746 Ohms</strong> .  Mas isso √© ideal.  Na verdade, resistores com uma resist√™ncia de <strong>746 ohms</strong> n√£o existem.  Sim, e os transformadores n√£o s√£o particularmente precisos.  Portanto, se algu√©m se atreve a tentar esta solu√ß√£o, <strong>recomendo fortemente que voc√™</strong> coloque o resistor <strong>R1 = 760 Ohms</strong> e leve o aparador <strong>R2</strong> do resistor, com uma resist√™ncia de <strong>180 Ohms</strong> ou <strong>220 Ohms</strong> .  Em seguida, voc√™ pode, armado com um volt√≠metro, ajustar <strong>R2</strong> para que a <strong>~ 220V a</strong> tens√£o no enrolamento prim√°rio do transformador, na sa√≠da do divisor (ou, que √© o mesmo, na entrada do <strong>ADC1</strong> ) seja <strong>= 0,5V</strong> . </p><br><p>  Medimos a tens√£o n√£o apenas dessa maneira, mas para fazer algo excedendo ou diminuindo a norma.  Por exemplo, ligue a energia de backup para que algum dispositivo n√£o queime e n√£o desligue. </p><br><p>  Portanto, desenharemos o esquema de programa mais simples, que, quando a tens√£o est√° <strong>15%</strong> acima da norma, faz com que o rel√© <strong>Rel√©1 funcione</strong> e quando a tens√£o diminui <strong>15%</strong> da norma, o rel√© <strong>Rel√©2 funciona</strong> .  Al√©m disso, a sobretens√£o ou subtens√£o deve ser mantida na rede por <strong>pelo menos 1 minuto</strong> para acionar um rel√©.  Isso evitar√° alarmes falsos durante picos curtos de tens√£o que geralmente ocorrem na rede.  O programa do esquema que implementa nossa ideia √© mostrado na figura. </p><br><p><img src="https://habrastorage.org/webt/vq/t0/bo/vqt0bo1gbldkrrwflef9j6e8ada.png" alt="imagem"></p><br><p>  Para que este circuito funcione, √© necess√°rio definir o coeficiente k (faixa) igual a <strong>440</strong> nas configura√ß√µes dos par√¢metros ADC, conforme mostrado na figura. </p><br><p><img src="https://habrastorage.org/webt/3a/iw/x8/3aiwx8bupssyh3wkvimax7bxnfe.png" alt="imagem"></p><br><p>  Com um coeficiente de <strong>440</strong> e uma tens√£o de tens√£o na entrada do ADC <strong>0,5V,</strong> a sa√≠da do n√≥ <strong>ADC1</strong> ser√° <strong>220</strong> .  Essa √© a verdadeira tens√£o da rede! </p><br><p>  Isso √© muito conveniente, pois permite definir as constantes imediatamente em volts: <strong>220V + 15%</strong> √© <strong>253V</strong> e <strong>220V-15%</strong> √© <strong>187V</strong> .  Se necess√°rio, esses valores podem ser facilmente alterados sem perder tempo calculando e convertendo a tens√£o em "papagaios". </p><br><h3 id="datchik-temperatury-4-20ma">  Sensor de temperatura 4-20mA </h3><br><p>  Sensores com uma sa√≠da de corrente de 4-20mA s√£o muito comuns na ind√∫stria.  Na vida cotidiana, voc√™ n√£o os encontrar√° com frequ√™ncia.  No entanto, algu√©m os tem e esse algu√©m quer adapt√°-los √† causa. </p><br><p>  O ADC permite o uso de tais sensores em conjunto com o controlador <strong>ShIoTiny</strong> . </p><br><p>  Por que a corrente de sa√≠da do sensor √© precisamente <strong>4-20mA</strong> ?  Eu vou explicar </p><br><p>  As sa√≠das atuais funcionam bem em longas filas.  Diga um quil√¥metro.  Eles n√£o se importam com a resist√™ncia dos fios: a corrente √© a mesma ao longo de todo o comprimento do fio, independentemente da resist√™ncia dos condutores. </p><br><p>  O valor inicial atual de <strong>4mA</strong> , e n√£o apenas a falta de corrente, facilita a detec√ß√£o de uma quebra de fio.  Se o sensor estiver inteiro e o fio n√£o estiver quebrado, sempre haver√° corrente.  Pelo menos <strong>4mA</strong> .  E se o fio <strong>quebrar,</strong> n√£o h√° corrente ( <strong>0mA</strong> ). </p><br><p>  Suponha que tenhamos um sensor de temperatura com uma sa√≠da de corrente de <strong>4-20mA</strong> e uma faixa de temperatura medida de <strong>-40C</strong> a <strong>+ 125C</strong> .  Queremos conect√°-lo ao <strong>ShIoTin</strong> .  A primeira coisa que precisamos fazer √© converter a corrente em tens√£o.  Um meio ideal para essa convers√£o √© um resistor convencional. </p><br><p>  Como a tens√£o m√°xima na entrada do ADC √© <strong>1V</strong> e a corrente m√°xima na linha √© <strong>20mA</strong> , √© f√°cil calcular que um resistor que converte <strong>20mA</strong> em <strong>1V</strong> ter√° uma resist√™ncia de <strong>50 Ohms</strong> .  ( <em>N√£o conhe√ßa a lei de Ohm - fique em casa!</em> ). </p><br><p>  Vamos conectar nosso sensor conforme mostrado na figura. </p><br><p><img src="https://habrastorage.org/webt/7a/fq/og/7afqogxbvlo_0tb4ytycdnaynqm.png" alt="imagem"></p><br><p>  O sensor √© um gerador de corrente proporcional √† temperatura medida.  Com uma resist√™ncia de <strong>50 Ohms</strong> conectada em paralelo √† entrada <strong>ADC1</strong> , os seguintes valores de tens√£o estar√£o na entrada ADC, dependendo da corrente gerada no circuito do sensor: </p><br><ul><li>  corrente <strong>menor que 4mA</strong> , tens√£o na entrada ADC menor que <strong>0,2V</strong> - quebra de linha; </li><li>  corrente de <strong>4mA a 20mA</strong> , tens√£o de <strong>0,2V a 1V</strong> - o sensor est√° funcionando; </li><li>  a corrente √© <strong>superior a 20mA</strong> , a tens√£o de entrada √© <strong>superior a 1V</strong> - o sensor est√° com defeito.  Com um curto-circuito no sensor, um resistor de 50 Ohm pode queimar se tiver menos de 2W de pot√™ncia. </li></ul><br><p>  Suponha que desejemos medir a temperatura e public√°-la pelo <strong>MQTT</strong> .  Al√©m disso, publicaremos o status do sensor (circuito aberto, curto-circuito ou tudo est√° em ordem). </p><br><p>  A primeira coisa que precisamos fazer √© recalcular o valor dos "papagaios" para graus.  Sabendo que uma temperatura de <strong>-40</strong> ¬∞ <strong>C</strong> corresponde a uma corrente de <strong>4 mA</strong> e uma tens√£o na entrada do ADC de <strong>0,2 V</strong> , e uma temperatura de <strong>+125 ¬∞ C</strong> corresponde a uma corrente de <strong>20 mA</strong> e uma tens√£o na entrada do ADC de <strong>1</strong> <strong>V</strong> , obtemos os coeficientes: <strong>k = 206,25</strong> <strong>eb = -81,25</strong> .  Digite esses coeficientes na janela de configura√ß√µes do ADC, conforme mostrado na figura. </p><br><p><img src="https://habrastorage.org/webt/pn/bn/ss/pnbnsso2veaouphppgibtzqx8do.png" alt="imagem"></p><br><p>  Quem deseja verificar a exatid√£o do c√°lculo de <strong>keb</strong> - decide por si mesmo o sistema mais simples de equa√ß√µes: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mn>0</mn><mo>,</mo><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>k</mi><mo>+</mo><mi>b</mi><mo>=</mo><mo>&amp;#x2212;</mo><mn>40</mn><mspace linebreak=&quot;newline&quot; /><mn>1</mn><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>k</mi><mo>+</mo><mi>b</mi><mo>=</mo><mn>125</mn><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="5.31ex" viewBox="0 -780.1 33095.6 2286.5" role="img" focusable="false" style="vertical-align: -3.499ex; max-width: 638px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(9683,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-67" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-69" x="1626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-6E" x="1972" y="0"></use><g transform="translate(2572,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-73" x="1899" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-30" x="4941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-2C" x="5441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-32" x="5886" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-63" x="6637" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-64" x="7070" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-6F" x="7594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-74" x="8079" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-6B" x="8441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-2B" x="9184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-62" x="10185" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-3D" x="10892" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-2212" x="11949" y="0"></use><g transform="translate(12727,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-34"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-30" x="500" y="0"></use></g></g><g transform="translate(10661,-1332)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-63" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-64" x="1184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-6F" x="1707" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-74" x="2193" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-6B" x="2554" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-2B" x="3298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-62" x="4298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-3D" x="5006" y="0"></use><g transform="translate(6062,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-65" x="7813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-6E" x="8280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-64" x="8881" y="0"></use><g transform="translate(9404,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhgLVy3t2xp475QcAmukYMTNDZA62w#MJMATHI-73" x="1899" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mn>0</mn><mo>,</mo><mn>2</mn><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>k</mi><mo>+</mo><mi>b</mi><mo>=</mo><mo>‚àí</mo><mn>40</mn><mspace linebreak="newline"></mspace><mn>1</mn><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>k</mi><mo>+</mo><mi>b</mi><mo>=</mo><mn>125</mn><mtext>&nbsp;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> \ begin {cases} 0,2 \ cdot k + b = -40 \\ 1 \ cdot k + b = 125 \ end {cases} </script></p><br><p>  Bem, o esquema do programa n√£o ser√° nada complicado e √© mostrado na figura abaixo. </p><br><p><img src="https://habrastorage.org/webt/nn/yg/u9/nnygu9gstcce-b58llm-k5fyxns.png" alt="imagem"></p><br><p>  No caso em que tudo esteja bem e o sensor de temperatura de <strong>4-20mA</strong> estiver <strong>funcionando</strong> , a temperatura ser√° publicada no servidor <strong>MQTT</strong> sob o nome <strong>/ t_sens</strong> .  Os sintomas tamb√©m s√£o publicados sob os nomes <strong>/ sens_short</strong> e <strong>/ sens_break</strong> .  Se tudo estiver bem, os sinais de um acidente s√£o zero. </p><br><p>  Se a linha <strong>quebrar</strong> , a temperatura ser√° menor que <strong>-40 ¬∞ C.</strong>  Nesse caso, o par√¢metro <strong>/ sens_break</strong> no broker do <strong>MQTT</strong> ser√° publicado como uma unidade. </p><br><p>  Se houver um curto-circuito na linha, a temperatura ser√° superior a <strong>+ 125 ¬∞ C.</strong>            <strong>1</strong>         <strong>NAN</strong> ( <strong>-</strong> ).     <strong>/sens_short</strong>  <strong>MQTT</strong>     . </p><br><p>        <strong>Relay3</strong> ,  , ,   . </p><br><p>    ¬´¬ª ,   , ,  200      . </p><br><h3 id="zaklyuchenie">  Conclus√£o </h3><br><p>      <strong>ShIoTiny</strong>  ,      .      ,  . </p><br><p>  ,  -    ¬´¬ª  ,  - , -   . </p><br><p>   ‚Äî     .      . </p><br><p>           : <strong>shiotiny@yandex.ru</strong> . </p><br><h3 id="ssylki">  Refer√™ncias </h3><br><p>        ,   ,     . </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">       <br></a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">- </a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   .      </a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">       <br></a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  :   4-20  ‚Äì    </a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   ESPPOWER     ANDROID</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt466443/">https://habr.com/ru/post/pt466443/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt466433/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 41. VLAN nativa do DHCP Snooping e Nondefault</a></li>
<li><a href="../pt466435/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 42. Roteamento Inter-VLAN e SVI</a></li>
<li><a href="../pt466437/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 43. Protocolos de Roteamento Dist√¢ncia do Vetor e Estado do Link</a></li>
<li><a href="../pt466439/index.html">Verifique voc√™ mesmo: quantas perguntas voc√™ pode responder √† ChGK?</a></li>
<li><a href="../pt466441/index.html">C√≥digo de bugs Python: 10 erros mais comuns que os desenvolvedores cometem</a></li>
<li><a href="../pt466445/index.html">Ataques entre rela√ß√µes de confian√ßa entre dom√≠nios</a></li>
<li><a href="../pt466447/index.html">Para que devemos construir uma CDN?</a></li>
<li><a href="../pt466449/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 44. Introdu√ß√£o ao OSPF</a></li>
<li><a href="../pt466451/index.html">Read_You'n n√£o pode jogar</a></li>
<li><a href="../pt466453/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 45. Configurando o OSPF</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>