<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>  锔 Estaci贸n Meteorol贸gica Arduino 锔  猬锔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Estaci贸n Meteorol贸gica Arduino 


 Decid铆 escribir un art铆culo detallado que explica todos los aspectos de la creaci贸n de una estaci贸n meteorol贸gica A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Estaci贸n Meteorol贸gica Arduino</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443664/"><h2>  Estaci贸n Meteorol贸gica Arduino </h2><br><p>  Decid铆 escribir un art铆culo detallado que explica todos los aspectos de la creaci贸n de una estaci贸n meteorol贸gica Arduino, ya que es dif铆cil cubrir todo el proceso de una vez.  Mi versi贸n de la estaci贸n meteorol贸gica es conveniente porque sus datos se almacenan en una computadora. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/sBqkzON_YKQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><div class="spoiler">  <b class="spoiler_title">Lo que se necesita</b> <div class="spoiler_text"><ul><li>  red local construida usando un enrutador Wifi </li><li>  una computadora </li><li><img src="https://habrastorage.org/webt/xb/q0/dy/xbq0dy-gp5qjd0j99ezolrwrxz0.jpeg" alt="arduino UNO">  Arduino UNO (utilic茅 la r茅plica china). <br></li><li>  Cable USB para conectar a Arduino. </li><li><img src="https://habrastorage.org/webt/xb/x4/vq/xbx4vqqfnzsavras07uqzi216uq.jpeg">  bar贸metro BME280 5V I2C (sensor de temperatura, humedad, presi贸n) <br></li><li>  estaci贸n de soldadura con secador de pelo </li><li>  soldadura 0.7 mm </li><li>  flujo. </li><li><img src="https://habrastorage.org/webt/lr/ns/vh/lrnsvhg4egw1azrzl9v7zssjfrk.jpeg">  M贸dulo Wi-Fi ESP8266 versi贸n ESP-01 <br></li><li>  4 cables de mam谩 a pap谩 para el tablero. </li><li>  4 cables macho a hembra para protoboard </li><li>  4 cables de 50 cm de largo para el tablero. </li><li>  8 tubos delgados termocontra铆bles de 10 cm de largo cada uno. </li><li>  1 tubo grande termocontra铆ble de tal di谩metro que incluya "4 cables de 50 cm de largo para una placa de prueba" junto con otros tubos termocontra铆bles </li></ul><br></div></div><br><h3>  Configuraci贸n de red </h3><br><p>  Cada computadora de la red debe ver el dispositivo en el que se encuentra el servidor. Se recomienda instalar los mismos grupos de trabajo en todas las computadoras de la red. </p><br> <a href=""><img src="https://habrastorage.org/webt/ud/9g/do/ud9gdo-xql0u2zohzhhjggrgggs.jpeg"></a> <p>  <i>Click para ampliar.</i> </p><br><hr><br><p>  <b>Debe deshabilitar bradmauser y otros firewalls.</b> </p><br><p>  En la configuraci贸n de red, en las propiedades del adaptador inal谩mbrico, en la pesta帽a de acceso, coloque al principio la casilla de verificaci贸n "permitir que otros usuarios accedan" y luego haga clic en la configuraci贸n; <br>  ponga todas las marcas de verificaci贸n en la configuraci贸n, ver谩 los nombres de los servicios en lugar de los n煤meros. </p><br> <a href=""><img src="https://habrastorage.org/webt/tm/rp/iu/tmrpiumi5cfgy2z__uewznwfsfm.jpeg"></a> <p>  <i>Click para ampliar.</i> </p><br> <a href=""><img src="https://habrastorage.org/webt/l5/aj/oe/l5ajoew55mnqtr9or8wr5q7gvfq.jpeg"></a> <p>  <i>Click para ampliar.</i> </p><br><hr><br><p>  Debe abrir los puertos <em>80</em> y <em>3306</em> en el enrutador.  Le mostrar茅 el ejemplo de un enrutador Tenda: en primer lugar, descubra su <em>direcci贸n IP local</em> ; para esto, haga clic en el icono de red inal谩mbrica.  A continuaci贸n, en el panel abierto, cerca del nombre de su red, aparecer谩n <em>Propiedades</em> .  Despu茅s, despl谩cese hacia abajo. </p><br> <a href=""><img src="https://habrastorage.org/webt/9a/sk/ui/9askui6kcvu7i04omioewoz5cpg.jpeg"></a> <p>  <i>Click para ampliar.</i> </p><br><hr><br><p>  Luego, abra la p谩gina web del enrutador, lo tengo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://192.168.0.1</a> , ingrese la contrase帽a del enrutador, haga clic en Configuraci贸n avanzada, luego en Virtal Server. Luego ingrese primero la <em>IP local</em> y el puerto <em>80.</em> Luego repita la operaci贸n, pero ingrese el puerto <em>3306</em> . </p><br> <a href=""><img src="https://habrastorage.org/webt/j7/wd/3u/j7wd3umngfpeofjenbduzck8ivq.jpeg"></a> <p>  Click para ampliar. </p><br> <a href=""><img src="https://habrastorage.org/webt/1o/ji/tt/1ojittsmyle-r6cg36dzxxjyfdw.jpeg"></a> <p>  <i>Click para ampliar.</i> </p><br><br><hr><br><p>  Necesitamos los siguientes componentes: <br><br></p><ul><li>  <em>Apache</em> : los datos de la estaci贸n meteorol贸gica se enviar谩n aqu铆. </li><li>  <em>PHP</em> : recoger谩 datos de la estaci贸n meteorol贸gica y guardar谩 la base de datos. </li><li>  <em>Mysql</em> : bases de datos donde se almacenar谩 la temperatura, ya que usar solo PHP significa que es imposible proporcionar visualizaci贸n para varias computadoras y otros dispositivos. </li><li>  <em>HeidiSQL</em> es un <em>visor</em> y editor de base de datos (puede usar cualquier otro, por ejemplo: "PhpMyAdmin"). </li></ul><br><p>  No describir茅 en detalle la configuraci贸n del servidor <em>Apache</em> , porque hay mucha informaci贸n en Internet. Lo principal <em>es</em> configurar <em>Apache</em> y <em>MySQL</em> para que sean visibles en la red local. <br><br>  Despu茅s de eso, cree una tabla en la base de datos: la temperatura se guardar谩 all铆. <br><br>  Un ejemplo de mi p谩gina de controlador (lecturas del sensor) en el servidor: </p><br><br><div class="spoiler">  <b class="spoiler_title">C贸digo PHP</b> <div class="spoiler_text"><pre><code class="php hljs">$link = mysqli_connect(<span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-string"><span class="hljs-string">"root"</span></span>, <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$link) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">":     MySQL."</span></span> . PHP_EOL; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"  errno: "</span></span> . mysqli_connect_errno() . PHP_EOL; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"  error: "</span></span> . mysqli_connect_error() . PHP_EOL; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"  MySQL !"</span></span> . PHP_EOL; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"  : "</span></span> . mysqli_get_host_info($link) . PHP_EOL; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_GET[<span class="hljs-string"><span class="hljs-string">'temp'</span></span>])){ $c=$_GET[<span class="hljs-string"><span class="hljs-string">'temp'</span></span>]; $vlah=$_GET[<span class="hljs-string"><span class="hljs-string">'vlah'</span></span>]; $davlen=$_GET[<span class="hljs-string"><span class="hljs-string">'davlen'</span></span>]; $sql = <span class="hljs-string"><span class="hljs-string">"UPDATE `temp1` SET `C`='$c',`vlah`='$vlah',`davlen`='$davlen' WHERE `id`='1'"</span></span>;<span class="hljs-comment"><span class="hljs-comment">//     mysqli_query($link,$sql); } echo"&lt;br&gt;"; $sql1="SELECT * FROM `temp1`";//  $result = mysqli_query($link,$sql1); $row = mysqli_fetch_all($result,MYSQLI_NUM); echo " "; echo $row[count($row)-1][0]; echo " C"; echo"&lt;br&gt;"; echo " "; echo $row[count($row)-1][1]; echo "hPa"; echo"&lt;br&gt;"; echo " "; echo $row[count($row)-1][2]; echo "%";</span></span></code> </pre> <br></div></div><br><h3>  3. Configurando esp8266 </h3><br><p>  Conecte el esp-01 al adaptador y con茅ctelo al Arduino de la siguiente manera: <em>Rx-RX, TX-TX, GND-GND, VCC-5V</em> ; <br>  Conecte a tierra el puerto <em>RESET</em> Arduino a <em>GND</em> ; </p><br> <a href=""><img src="https://habrastorage.org/webt/na/n8/3k/nan83kwjixwsyljtavnoforknnm.jpeg"></a> <p>  <a href=""><i>Click para ampliar.</i></a> </p><br><br><p>  Conecte su arduino a su computadora, abra el <em>IDE de Arduino</em> , luego el <em>Serial Monitor</em> , luego especifique Rate <em>115200</em> y <br>  <em>Tanto NL como CR</em> . <br></p><br> <a href=""><img src="https://habrastorage.org/webt/hz/w_/jg/hzw_jgmc7muyjvzrfsq9gvd6zwa.jpeg"></a> <p>  <a href=""><i>Click para ampliar.</i></a> </p><br><ol><li>  Ingrese el comando <b>AT</b> . </li><li>  Resalta <b>OK</b> . </li><li>  Ingrese <b>AT + RESTORE</b> , le pedir谩 al m贸dulo la configuraci贸n de f谩brica. </li><li>  Ingrese <b>AT + CWMODE_CUR = 1</b> , esto pondr谩 el m贸dulo en modo cliente. </li><li>  Ingrese <b>AT + CWJAP_CUR = "Network_name", "Password"</b> - conexi贸n a wifi. </li><li>  Resalte <b>Aceptar</b> si se ha producido una conexi贸n. </li></ol><br><h3>  Configurar bme280 y compilaci贸n final </h3><br><p>  Conecte las conclusiones de acuerdo con el diagrama (la atenci贸n al diagrama muestra esp8266 sin un adaptador, pero en realidad necesita estar conectado al adaptador, y ya desde <br>  4 adaptadores de salida tienen la misma funci贸n que se muestra en el diagrama.  ) </p><br> <a href=""><img src="https://habrastorage.org/webt/2y/gz/8w/2ygz8w6joha1nexv-e5fdezoqus.jpeg"></a> <p>  <a href=""><i>Click para ampliar.</i></a> </p><br><p>  Abra el IDE de Arduino y pegue el siguiente c贸digo: </p><br><div class="spoiler">  <b class="spoiler_title">C贸digo IDE Arduino</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#include &lt;Wire.h&gt; void setup(){ Wire.begin(); Serial.begin(9600); while (!Serial); Serial.println("\nI2C Scanner"); } void loop(){ byte error, address; int nDevices; Serial.println("Scanning..."); nDevices = 0; for(address = 8; address &lt; 127; address++ ){ Wire.beginTransmission(address); error = Wire.endTransmission(); if (error == 0){ Serial.print("I2C device found at address 0x"); if (address&lt;16) Serial.print("0"); Serial.print(address,HEX); Serial.println(" !"); nDevices++; } else if (error==4) { Serial.print("Unknow error at address 0x"); if (address&lt;16) Serial.print("0"); Serial.println(address,HEX); } } if (nDevices == 0) Serial.println("No I2C devices found\n"); else Serial.println("done\n"); delay(5000);</code> </pre><br></div></div><br><p>  Abra el <em>Monitor de serie</em> y recuerde la direcci贸n de IC2 resaltada. <br>  Descargue las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bibliotecas Sensor Library</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Touch Library</a> y descompr铆malas en <em>C: \ Users \ user \ Documents \ Arduino</em> .  Abierto <br>  <em>C: \ Usuarios \ usuario \ Documentos \ Arduino \ bibliotecas \ Adafruit_BME280_Library-master</em> y cambie la direcci贸n: </p><br> <a href=""><img src="https://habrastorage.org/webt/6h/zj/wj/6hzjwjvtf2-tqipynjsl6nneqck.jpeg" width="200" height="200"></a> <p>  <a href="">Click para ampliar.</a> </p><br><p>  Abra el IDE de Arduino y coloque el c贸digo: </p><br><div class="spoiler">  <b class="spoiler_title">C贸digo IDE Arduino</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#include &lt;SoftwareSerial.h&gt; #define RX 10//    esp8266 #define TX 11//    esp8266 String AP = "Aleks"; //   String PASS = "1brui47ci881"; //  String HOST = "192.168.0.185";//   String PORT = "80";//  String field = "field1"; int countTrueCommand; int countTimeCommand; boolean found = false; int valSensor = 1; SoftwareSerial esp8266(RX,TX); #include &lt;Wire.h&gt; #include &lt;SPI.h&gt; #include &lt;Adafruit_Sensor.h&gt; #include &lt;Adafruit_BME280.h&gt; #define BME_SCK 13 #define BME_MISO 12 #define BME_MOSI 11 #define BME_CS 10 #define SEALEVELPRESSURE_HPA (1013.25) Adafruit_BME280 bme; // I2C //Adafruit_BME280 bme(BME_CS); // hardware SPI //Adafruit_BME280 bme(BME_CS, BME_MOSI, BME_MISO, BME_SCK); // software SPI unsigned long delayTime; void setup() { Serial.begin(9600); bool status; // default settings // (you can also pass in a Wire library object like &amp;Wire2) status = bme.begin(); if (!status) { Serial.println("Could not find a valid BME280 sensor, check wiring!"); while (1); } esp8266.begin(115200); sendCommand("AT",5,"OK"); sendCommand("AT+CWMODE=1",5,"OK"); sendCommand("AT+CWJAP=\""+ AP +"\",\""+ PASS +"\"",20,"OK"); sendCommand("AT+CIPMUX=1",5,"OK"); } void loop() { float vlah=bme.readPressure() / 100.0F; sendCommand("AT+CIPSTART=0,\"TCP\",\""+ HOST +"\","+ PORT,15,"OK"); String cmd = "GET /?temp="+String(bme.readTemperature())+"&amp;vlah="+String(vlah)+"&amp;davlen="+String(bme.readHumidity())+" HTTP/1.1\r\nHost: 192.168.0.185\r\n\r\n";// GET    ,temp,vlah,davlen           . sendCommand("AT+CIPSEND=0," +String(cmd.length()+4),4,"&gt;"); esp8266.println(cmd);delay(1500);countTrueCommand++; sendCommand("AT+CIPCLOSE=0",5,"OK"); delay(100000); } void printValues() { Serial.print("Temperature = "); Serial.print(bme.readTemperature()); Serial.println(" *C"); Serial.print("Pressure = "); Serial.print(bme.readPressure() / 100.0F); Serial.println(" hPa"); Serial.print("Humidity = "); Serial.print(bme.readHumidity()); Serial.println(" %"); Serial.println(); } void sendCommand(String command, int maxTime, char readReplay[]) { Serial.print(countTrueCommand); Serial.print(". at command =&gt; "); Serial.print(command); Serial.print(" "); while(countTimeCommand &lt; (maxTime*1)) { esp8266.println(command);//at+cipsend if(esp8266.find(readReplay))//ok { found = true; break; } countTimeCommand++; } if(found == true) { Serial.println("OYI"); countTrueCommand++; countTimeCommand = 0; } if(found == false) { Serial.println("Fail"); countTrueCommand = 0; countTimeCommand = 0; } found = false; }</code> </pre> <br></div></div><br><p>  Listo  Los datos de temperatura se transferir谩n como variables a la base de datos. <br><br>  Como puede ver, mi estaci贸n meteorol贸gica requiere un conocimiento inicial de programaci贸n web, pero el resultado lo vale. </p><br><div class="spoiler">  <b class="spoiler_title">Fuentes</b> <div class="spoiler_text"><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Instalaci贸n del servidor web.</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Conjunto Apache</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">scaner ic2</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ESP8266</a> <br></li></ol></div></div><p></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/443664/">https://habr.com/ru/post/443664/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../443654/index.html">Siguiendo el rastro de las calculadoras: calcular</a></li>
<li><a href="../443656/index.html">Siguiendo los pasos de las calculadoras: calcular</a></li>
<li><a href="../443658/index.html">Configuraci贸n del cl煤ster de Kubernetes HA en bare metal, monitoreo, registros y ejemplos de uso. Parte 3/3</a></li>
<li><a href="../443660/index.html">Expertos: "Un esc谩ner 3D costar谩 10 veces m谩s barato que un error con el control de calidad tradicional"</a></li>
<li><a href="../443662/index.html">Comprender el c贸digo limpio en Android</a></li>
<li><a href="../443666/index.html">Nuestro enfoque para colorear hilos</a></li>
<li><a href="../443668/index.html">Volver a los microservicios con Istio. Parte 3</a></li>
<li><a href="../443670/index.html">Error en la nueva versi贸n de Google Chrome (73.0.3683.75)</a></li>
<li><a href="../443672/index.html">Pruebas basadas en riesgo</a></li>
<li><a href="../443676/index.html">Vinilo en lugar de un sello postal: rareza inusual</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>