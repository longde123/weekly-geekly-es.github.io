<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👰🏾 😘 📂 Unity软件包管理器 🆔 🎅 👩🏼‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unity是一个已经存在很长时间并且正在不断发展的平台。 但是，同时处理多个项目，在使用通用源（.cs），库（.dll）和其他资产（图像，声音，模型，预制件）时仍然会遇到困难。 在本文中，我们将讨论我们为Unity解决此类问题的本机解决方案的经验。 


 共享资源分配方法 
 将共享资源用于不同项...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Unity软件包管理器</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/plarium/blog/445432/">  Unity是一个已经存在很长时间并且正在不断发展的平台。 但是，同时处理多个项目，在使用通用源（.cs），库（.dll）和其他资产（图像，声音，模型，预制件）时仍然会遇到困难。 在本文中，我们将讨论我们为Unity解决此类问题的本机解决方案的经验。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dh/oi/ua/dhoiua7oixnvqg4vuinca6sylua.jpeg"></div><a name="habracut"></a><br><h3> 共享资源分配方法 </h3><br> 将共享资源用于不同项目的方法不止一种，但是每种方法各有利弊。 <br><br>  <b>1.复制-在项目之间“动手”复制资源。</b> <br><br> 优点： <br><br><ul><li> 适用于各种资源。 </li><li> 没有依赖性问题。 </li><li> 资产GUID没问题。 </li></ul><br> 缺点： <br><br><ul><li> 巨大的存储库。 </li><li> 无法进行版本控制。 </li><li> 跟踪共享资源更改的难度。 </li><li> 难以更新共享资源。 </li></ul><br>  <b>2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Git子模块</a> -通过外部子模块分配共享资源。</b> <br><br> 优点： <br><br><ul><li> 您可以使用源代码。 </li><li> 资产可以分配。 </li><li> 没有依赖性问题。 </li></ul><br> 缺点： <br><br><ul><li> 需要的Git技能。 </li><li>  Git对二进制文件不是很友好-您必须连接LFS。 </li><li> 存储库的访问控制。 </li><li> 升级和降级困难。 </li><li>  GUID可能会发生冲突，Unity并没有明确的行为来解决它们。 </li></ul><br>  <b>3. NuGet-通过NuGet软件包分发共享库。</b> <br><br> 优点： <br><br><ul><li> 方便使用不依赖Unity的项目。 </li><li> 方便的版本控制和相关性解析。 </li></ul><br> 缺点： <br><ul><li>  Unity不知道如何直接使用NuGet软件包（在GitHub上，您可以找到适用于Unity的NuGet软件包管理器，它可以解决此问题，但有一些细微差别）。 </li><li> 分配其他类型资产的困难。 </li></ul><br>  <b>4. Unity软件包管理器-通过Unity的本机解决方案分配共享资源。</b> <br><br> 优点： <br><br><ul><li> 用于处理程序包的本机接口。 </li><li> 防止GUID冲突时覆盖包中的.meta文件的保护。 </li><li> 版本控制的可能性。 </li><li> 为Unity分配各种资源的能力。 </li></ul><br> 缺点： <br><br><ul><li>  GUID冲突可能仍然会发生。 </li><li> 没有要实现的文档。 </li></ul><br> 后一种方法的优点多于缺点。 但是，由于缺少文档，它现在不是很流行，因此我们将对其进行详细介绍。 <br><br><h3>  Unity软件包管理器 </h3><br>  Unity软件包管理器（以下称UPM）是一个软件包管理工具。 它是在Unity 2018.1中添加的，仅用于Unity Technologies开发的软件包。 但是，从版本2018.3开始，可以添加自定义程序包。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9t/zl/_n/9tzl_nq847ma7etdkyzl_qrq0cs.jpeg"></div><br>  <i>Unity软件包管理器界面</i> <br><br> 包不属于项目源（资产目录）。 它们位于单独的目录<code>%projectFolder%/Library/PackageCache</code>并且不以任何方式影响项目，它们在源代码中仅提及在<code>packages/manifest.json</code>文件中。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/we/f4/b-/wef4b-0oo4h1r5n4vlx4wd-yc_q.jpeg"></div><br>  <i>项目文件系统中的软件包</i> <br><br><h4> 包裹来源 </h4><br>  UPM可以使用多种软件包来源： <br><br>  <b>1.文件系统。</b> <br><br> 优点： <br><br><ul><li> 实施速度。 </li><li> 无需第三方工具。 </li></ul><br> 缺点： <br><br><ul><li> 版本控制的复杂性。 </li><li> 与项目一起工作的每个人都需要文件共享。 </li></ul><br>  <b>2. Git存储库。</b> <br><br> 优点： <br><br><ul><li> 只需要一个Git仓库。 </li></ul><br> 缺点： <br><br><ul><li> 您无法通过UPM窗口在版本之间切换。 </li><li> 并非适用于所有Git存储库。 </li></ul><br>  <b>3. npm存储库。</b> <br><br> 优点： <br><br><ul><li> 完全支持UPM功能，用于分发正式的Unity软件包。 </li></ul><br> 缺点： <br><br><ul><li> 当前，它将忽略除“ -preview”以外的所有字符串版本的软件包。 </li></ul><br> 下面我们看一下UPM + npm的实现。 该捆绑包很方便，因为它允许您使用任何类型的资源和管理程序包版本，并且还完全支持本机UPM界面。 <br><br> 您可以将<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Verdaccio</a>用作npm存储库。 它有详细的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文档</a> ，仅需几个命令即可启动它。 <br><br><h4> 环境设定 </h4><br> 首先，您需要安装<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">node.js。</a> <br><br><h4> 包创建 </h4><br> 要创建一个包，您必须将描述它的<code>package.json</code>文件放在包含该<code>package.json</code>内容的目录中。 您需要执行以下操作： <br><br><ol><li> 转到我们要打包的项目目录。 </li><li> 运行<code>npm init</code>命令，并在对话框中输入所需的值。 对于名称，以反向域的格式指定名称，例如<code>com.plarium.somepackage</code> 。 </li><li> 为了方便地显示包名称，请将<code>displayName</code>属性添加到<code>package.json</code>并填充它。 </li><li> 由于npm是面向js的，因此该文件包含我们不需要的属性，以及Unity不使用的<code>scripts</code> 。 最好将它们删除，以免使包装说明混乱。 该文件应如下所示： <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"com.plarium.somepackage"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"displayName"</span></span>: <span class="hljs-string"><span class="hljs-string">"Some Package"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.0.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Some Package Description"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"keywords"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"Unity"</span></span>, <span class="hljs-string"><span class="hljs-string">"UPM"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"AUTHOR"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"license"</span></span>: <span class="hljs-string"><span class="hljs-string">"UNLICENSED"</span></span> }</code> </pre> <br></li><li> 打开Unity并为package.json生成一个.meta文件（如果没有.meta文件，Unity不会看到资产，Unity的软件包仅用于读取）。 </li></ol><br><h4> 包裹寄送 </h4><br> 要发送软件包，您需要运行以下命令： <code>npm publish --registry *   *</code> 。 <br><br><h4> 通过Unity软件包管理器安装和更新软件包 </h4><br> 要将包添加到Unity项目，您需要： <br><br><ol><li> 将软件包源信息添加到<code>manifest.json</code>文件中。 为此，添加<code>scopedRegistries</code>属性并指定范围和将在其中搜索特定范围的源地址。 <br><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"scopedRegistries"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Main"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"scopes"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"com.plarium"</span></span> ] } ]</code> </pre></li><li> 转到Unity并打开“程序包管理器”窗口（使用自定义程序包与使用内置程序包没有什么不同）。 </li><li> 选择所有软件包。 </li><li> 找到所需的软件包并添加。 </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zh/hs/w7/zhhsw7qjnfod3dx7b5p1fh0if3y.jpeg"></div><br><h4> 处理源代码并进行调试 </h4><br> 为了使源连接到项目，必须为程序包创建一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">程序集定义</a> 。 <br><br> 使用软件包不会限制调试功能。 但是，在Unity中使用软件包时，如果软件包中发生错误，则无法通过在控制台中单击错误来进入IDE。 这是由于Unity不会将脚本视为单独的文件，因为在使用Assembly Definition时，它们会收集在库中并连接到项目。 使用项目中的源代码时，可以通过单击切换到IDE。 <br><br> 连接了程序包的项目中的脚本： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cb/g-/0t/cbg-0tgicnsv1h7j8vqdwq4mack.jpeg"></div><br> 带有工作断点的软件包脚本： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tp/dz/s0/tpdzs0bpqtw3nhwjhqf4c1aqoyq.jpeg"></div><br><h4> 紧急补丁修复 </h4><br> 添加到项目中的Unity软件包是只读的，但是可以在软件包缓存中对其进行编辑。 为此，您必须： <br><br><ol><li> 转到程序包缓存中的程序包。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/63/hy/kq/63hykqpzx_6epumfkfvph3f7w1w.jpeg"></div><br></li><li> 进行必要的更改。 </li><li> 更新<code>package.json</code>文件中的版本。 </li><li> 将软件包<code>npm publish --registry *   *</code>发送<code>npm publish --registry *   *</code> 。 </li><li> 通过UPM界面将软件包版本更新为更正的版本。 </li></ol><br><h4> 包裹进口冲突 </h4><br> 导入软件包时，可能会发生以下GUID冲突： <br><br><ol><li> 包-包。 如果在导入程序包时似乎已经添加的程序包具有具有相同GUID的资产，则导入的程序包中具有匹配GUID的资产将不会添加到项目中。 </li><li> 包是一个项目。 如果在导入软件包时，似乎项目中包含具有匹配GUID的资产，则软件包中的资产将不会添加到项目中。 但是，依赖它们的资产将开始使用项目中的资产。 </li></ol><br><h4> 将资产从项目转移到包中 </h4><br> 如果在Unity打开的情况下将资产从项目转移到包中，其功能将保留，并且从属资产中的链接将开始使用包中的资产。 <br><br>  <b>重要提示</b> ：当您将资产从项目复制到程序包时，将发生冲突“程序包-项目”，如上节所述。 <br><br><h4> 可能的冲突解决方案 </h4><br><ol><li> 导入所有资产以避免冲突时，请根据其自己的算法重新分配GUID。 </li><li> 将所有资产添加到一个项目中，并随后将其分为多个包。 </li><li> 创建一个包含所有资产的GUID的数据库，并在发送数据包时进行验证。 </li></ol><br><h3> 结论 </h3><br>  UPM是用于将共享资源分配给Unity的新解决方案，它可以替代现有方法。 本文所述的建议是根据实际情况提出的。 我们希望您发现它们有用。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN445432/">https://habr.com/ru/post/zh-CN445432/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN445420/index.html">您大脑皮层中有170亿台计算机</a></li>
<li><a href="../zh-CN445422/index.html">哪种编程语言最不安全？</a></li>
<li><a href="../zh-CN445424/index.html">在Kafka上使用异步API开发退款工具服务的经验</a></li>
<li><a href="../zh-CN445426/index.html">PostgreSQL服务Rails应用程序的优化</a></li>
<li><a href="../zh-CN445428/index.html">高质量Wi-Fi-现代款待的基础和业务引擎</a></li>
<li><a href="../zh-CN445434/index.html">世界上最糟糕的工作：寻找一名Habraautor</a></li>
<li><a href="../zh-CN445436/index.html">在DevOps中进行再培训-为自己做好准备</a></li>
<li><a href="../zh-CN445438/index.html">了解基于它的元素和Web组件</a></li>
<li><a href="../zh-CN445440/index.html">代码审查：贡献者和审查者的错误提示</a></li>
<li><a href="../zh-CN445444/index.html">REC和Trina（Solar）的高性能太阳能模块更新</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>