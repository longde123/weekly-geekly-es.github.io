<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëñ üòÑ ü§¥üèº Liste de contr√¥le: ce qui devait √™tre fait avant de d√©marrer les microservices dans prod üë®‚Äçüåæ üõÄüèª üìΩÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article contient un bref extrait de ma propre exp√©rience et de l'exp√©rience de mes coll√®gues avec qui j'ai pass√© des jours et des nuits √† ratisser...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Liste de contr√¥le: ce qui devait √™tre fait avant de d√©marrer les microservices dans prod</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438064/"><p><img src="https://habrastorage.org/webt/y7/-a/th/y7-ath7wga1jfx9issm1rhog2lg.jpeg" width="45%" align="right">  Cet article contient un bref extrait de ma propre exp√©rience et de l'exp√©rience de mes coll√®gues avec qui j'ai pass√© des jours et des nuits √† ratisser des incidents.  Et de nombreux incidents n'auraient jamais eu lieu si tout le monde aimait leurs microservices √©crits au moins un peu plus pr√©cis√©ment. </p><br><p>  Malheureusement, certains programmeurs de <s>bas</s> niveau croient s√©rieusement qu'un Dockerfile avec une sorte de commande √† l'int√©rieur est en soi un microservice et il peut √™tre d√©ploy√© m√™me maintenant.  Les dockers tournent, le banc est boueux.  Cette approche est lourde de probl√®mes allant d'une baisse des performances, de l'incapacit√© √† d√©boguer et du d√©ni de service √† un cauchemar appel√© incoh√©rence des donn√©es. </p><br><p>  Si vous pensez que le moment est venu de lancer une autre application dans Kubernetes / ECS / quoi que ce soit, alors j'ai quelque chose √† objecter. </p><br><p> <strong>La version anglaise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">est √©galement disponible</a></strong> . </p><a name="habracut"></a><br><p>  Je me suis form√© un certain ensemble de crit√®res pour √©valuer l'√©tat de pr√©paration des demandes de lancement en production.  Certains points de cette liste de contr√¥le ne peuvent pas √™tre appliqu√©s √† toutes les applications, mais uniquement √† des applications sp√©ciales.  D'autres s'appliquent g√©n√©ralement √† tout.  Je suis s√ªr que vous pouvez ajouter vos options dans les commentaires ou contester certains de ces points. </p><br><p>  Si votre micro-service ne r√©pond pas √† au moins un des crit√®res, je ne permettrai pas qu'il soit dans mon cluster id√©al, construit dans un bunker √† 2000 m√®tres sous terre avec chauffage au sol et un syst√®me d'alimentation Internet autonome ferm√©. </p><br><p>  Allons-y ... </p><br><p>  <i>Remarque: l'ordre des articles n'a pas d'importance.</i>  <i>Quoi qu'il en soit, pour moi.</i> </p><br><h2 id="korotkoe-opisanie-v-readme">  Readme Br√®ve description </h2><br><blockquote>  Il contient une br√®ve description de lui-m√™me au tout d√©but de Readme.md dans son r√©f√©rentiel. </blockquote><p>  Dieu, cela semble si simple.  Mais combien de fois j'ai rencontr√© que le r√©f√©rentiel ne contient pas la moindre explication pourquoi il est n√©cessaire, quelles t√¢ches il r√©sout, etc.  Il n'est pas n√©cessaire de parler de quelque chose de plus compliqu√©, comme les options de configuration. </p><br><h2 id="integraciya-s-sistemoy-monitoringa">  Int√©gration avec un syst√®me de surveillance </h2><br><blockquote>  Envoie des m√©triques √† DataDog, NewRelic, Prometheus, etc. </blockquote><p>  Analyse de la consommation des ressources, des fuites de m√©moire, des traces de pile, de l'interd√©pendance des services, du taux d'erreur - sans comprendre tout cela (et pas seulement), il est extr√™mement difficile de contr√¥ler ce qui se passe dans une grande application distribu√©e. </p><br><h2 id="opovescheniya-nastroeny">  Alertes configur√©es </h2><br><blockquote>  Le service comprend des alertes qui couvrent toutes les situations standard ainsi que les situations uniques connues. </blockquote><p>  Les m√©triques sont bonnes, mais personne ne les suivra.  Par cons√©quent, nous recevons automatiquement les appels / push / sms si: </p><br><ul><li>  La consommation de CPU / m√©moire a consid√©rablement augment√©. </li><li>  Le trafic a augment√© / diminu√© fortement. </li><li>  Le nombre de transactions trait√©es par seconde a radicalement chang√© dans toutes les directions. </li><li>  La taille de l'artefact apr√®s assemblage a consid√©rablement chang√© (exe, app, pot, ...). </li><li>  Le pourcentage d'erreurs ou leur fr√©quence a d√©pass√© le seuil autoris√©. </li><li>  Le service a cess√© d'envoyer des m√©triques (situation souvent n√©glig√©e). </li><li>  La r√©gularit√© de certains √©v√©nements attendus est viol√©e (le travail cron ne fonctionne pas, tous les √©v√©nements ne sont pas trait√©s, etc.) </li><li>  ... </li></ul><br><h2 id="runbooks-sozdany">  Runbooks cr√©√©s </h2><br><blockquote>  Un document a √©t√© cr√©√© pour le service qui d√©crit les √©ventualit√©s connues ou attendues. </blockquote><br><ul><li>  comment s'assurer que l'erreur est interne et ne d√©pend pas d'un tiers; </li><li>  si cela d√©pend o√π, √† qui et quoi √©crire; </li><li>  comment le red√©marrer en toute s√©curit√©; </li><li>  comment restaurer √† partir d'une sauvegarde et o√π se trouvent les sauvegardes; </li><li>  Quels tableaux de bord / requ√™tes sp√©ciaux sont cr√©√©s pour surveiller ce service; </li><li>  Le service a-t-il son propre panneau d'administration et comment y acc√©der? </li><li>  existe-t-il une API / CLI et comment l'utiliser pour r√©soudre les probl√®mes connus; </li><li>  et ainsi de suite. </li></ul><br><p>  La liste peut varier consid√©rablement entre les organisations, mais au moins les choses de base devraient √™tre l√†. </p><br><h2 id="vse-logi-pishutsya-v-stdoutstderr">  Tous les journaux sont √©crits en STDOUT / STDERR </h2><br><blockquote>  Le service ne cr√©e aucun fichier journal en mode production, ne les envoie √† aucun service externe, ne contient aucune abstraction redondante pour la rotation des journaux, etc. </blockquote><p>  Lorsqu'une application cr√©e des fichiers journaux, ces journaux sont inutiles.  Vous n'entrerez pas dans 5 conteneurs fonctionnant en parall√®le, en esp√©rant rattraper l'erreur dont vous avez besoin (et vous voil√†, <em>pleurer</em> ...).  Le red√©marrage du conteneur entra√Ænera une perte compl√®te de ces journaux. </p><br><p>  Si une application √©crit ses propres journaux sur un syst√®me tiers, par exemple, dans Logstash, cela cr√©e une redondance inutile.  Le service voisin ne sait pas comment proc√©der, car  a-t-il un cadre diff√©rent?  Vous obtenez un zoo. </p><br><p>  L'application √©crit une partie des journaux dans des fichiers et une partie sur stdout car il est pratique pour le d√©veloppeur de voir INFO dans la console et DEBUG dans les fichiers?  C'est g√©n√©ralement la pire option.  Personne n'a besoin de complexit√© et de code et de configurations compl√®tement redondants que vous devez conna√Ætre et maintenir. </p><br><h2 id="logi---eto-json">  Les journaux sont Json </h2><br><blockquote>  Chaque ligne de journal est √©crite au format Json et contient un ensemble coh√©rent de champs </blockquote><p>  Jusqu'√† pr√©sent, presque tout le monde √©crit des journaux en texte brut.  C'est un vrai d√©sastre.  Je serais heureux de ne jamais conna√Ætre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Grok Patterns</a> .  Je r√™ve parfois d'eux et je me fige, essayant de ne pas bouger, pour ne pas attirer leur attention.  Essayez d'analyser les exceptions Java dans les journaux une seule fois. </p><br><p>  Json est bon, c'est le feu qui vient du ciel.  Ajoutez-y simplement: </p><br><ul><li>  horodatage en <strong>millisecondes</strong> selon la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 3339</a> ; </li><li>  niveau: info, avertissement, erreur, d√©bogage </li><li>  user_id; </li><li>  nom_app </li><li>  et d'autres domaines. </li></ul><br><p>  T√©l√©chargez sur n'importe quel syst√®me appropri√© (ElasticSearch correctement configur√©, par exemple) et profitez-en.  Connectez les journaux de nombreux microservices et ressentez √† nouveau <em>les</em> bonnes applications monolithiques. </p><br><p>  <em>(Et vous pouvez ajouter Request-Id et obtenir le tra√ßage ...)</em> </p><br><h2 id="logi-s-urovnyami-verbosity">  Journaux avec niveaux de verbosit√© </h2><br><blockquote>  L'application doit prendre en charge une variable d'environnement, par exemple LOG_LEVEL, avec au moins deux modes de fonctionnement: ERREURS et DEBUG. </blockquote><p>  Il est souhaitable que tous les services d'un m√™me √©cosyst√®me prennent en charge la m√™me variable d'environnement.  Pas une option de configuration, pas une option sur la ligne de commande (bien que cela soit r√©versible, bien s√ªr), mais imm√©diatement par d√©faut depuis l'environnement.  Vous devriez pouvoir obtenir autant de journaux que possible en cas de probl√®me et le moins de journaux possible, si tout va bien. </p><br><h2 id="fiksirovannye-versii-zavisimostey">  Versions de d√©pendances fixes </h2><br><blockquote>  Les d√©pendances des gestionnaires de packages sont fixes, y compris les versions mineures (par exemple, cool_framework = 2.5.3). </blockquote><p>  Cela a d√©j√† √©t√© beaucoup discut√©, bien s√ªr.  Certaines corrections de d√©pendances sur les versions majeures, en esp√©rant que seules les corrections de bugs mineurs et les correctifs de s√©curit√© seront dans les versions mineures.  C'est faux. <br>  Chaque modification de chaque d√©pendance doit √™tre refl√©t√©e dans une <em>validation distincte</em> .  Pour qu'il puisse √™tre annul√© en cas de probl√®me.  Est-ce difficile √† contr√¥ler avec vos mains?  Il existe des robots utiles, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">comme celui-ci</a> , qui garderont une trace des mises √† jour et cr√©eront des demandes d'extraction pour chacun d'entre vous. </p><br><h2 id="dockerized">  Dockerized </h2><br><blockquote>  Le r√©f√©rentiel contient Dockerfile et docker-compose.yml pr√™ts pour la production </blockquote><p>  Docker est depuis longtemps la norme pour de nombreuses entreprises.  Il y a des exceptions, mais m√™me si vous n'avez pas Docker en production, tout ing√©nieur devrait √™tre en mesure de composer Docker et de ne penser √† rien d'autre pour obtenir un assemblage de dev pour la v√©rification locale.  Et l'administrateur syst√®me doit avoir l'assembly d√©j√† v√©rifi√© par les d√©veloppeurs avec les versions n√©cessaires des biblioth√®ques, des utilitaires, etc., dans lesquels l'application fonctionne <em>au moins en quelque sorte</em> pour l'adapter √† la production. </p><br><h2 id="konfiguraciya-cherez-okruzhenie">  Configuration de l'environnement </h2><br><blockquote>  Toutes les options de configuration importantes sont lues √† partir de l'environnement et l'environnement a une priorit√© sup√©rieure aux fichiers de configuration (mais inf√©rieure aux arguments de ligne de commande au d√©marrage). </blockquote><p>  Personne ne voudra jamais lire vos fichiers de configuration et √©tudier leur format.  Acceptez-le. </p><br><p>  Plus de d√©tails ici: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://12factor.net/config</a> </p><br><h2 id="readiness-and-liveness-probes">  Sondes de pr√©paration et de vivacit√© </h2><br><blockquote>  Contient des points de terminaison ou des commandes cli appropri√©s pour tester la pr√©paration √† r√©pondre aux demandes au d√©marrage et √† la disponibilit√© tout au long de la vie. </blockquote><p>  Si l'application sert des requ√™tes HTTP, elle devrait avoir deux interfaces par d√©faut: </p><br><ol><li><p>  Pour v√©rifier que l'application est active et non bloqu√©e, un test de vivacit√© est utilis√©.  Si l'application ne r√©pond pas, elle peut √™tre automatiquement arr√™t√©e par des orchestrateurs comme Kubernetes, " <em>mais ce n'est pas exact</em> ".  En fait, tuer une application gel√©e peut provoquer un effet domino et mettre d√©finitivement votre service.  Mais ce n'est pas un probl√®me de d√©veloppeur, faites simplement ce point final. </p><br></li><li><p>  Pour v√©rifier que l'application n'a pas seulement d√©marr√©, mais est pr√™te √† accepter les demandes, un test de pr√©paration est effectu√©.  Si l'application a √©tabli une connexion √† la base de donn√©es, au syst√®me de mise en file d'attente, etc., elle doit r√©pondre avec un statut de 200 √† 400 (pour Kubernetes). </p><br></li></ol><br><h2 id="ogranicheniya-resursov">  Limites des ressources </h2><br><blockquote>  Contient des limites sur la consommation de m√©moire, CPU, espace disque et toutes autres ressources disponibles dans un format coh√©rent. </blockquote><p>  L'impl√©mentation sp√©cifique de cet √©l√©ment sera tr√®s diff√©rente selon les organisations et les orchestrateurs.  Cependant, ces limites doivent √™tre d√©finies dans un format unique pour tous les services, √™tre diff√©rentes pour diff√©rents environnements (prod, dev, test, ...) et √™tre en <em>dehors du r√©f√©rentiel avec le code d'application</em> . </p><br><h2 id="sborka-i-dostavka-avtomatizirovana">  L'assemblage et la livraison sont automatis√©s </h2><br><blockquote>  Le syst√®me CI / CD utilis√© dans votre organisation ou projet est configur√© et peut fournir l'application √† l'environnement souhait√© selon le flux de travail accept√©. </blockquote><p>  <em>Rien n'est jamais livr√© √† la production manuellement.</em> </p><br><p>  Peu importe la difficult√© d'automatiser l'assemblage et la livraison de votre projet, cela doit √™tre fait avant que ce projet ne soit mis en production.  Cet √©l√©ment comprend la cr√©ation et l'ex√©cution d'Ansible / Chef cookbooks / Salt / ..., la cr√©ation d'applications pour les appareils mobiles, la construction d'une fourchette du syst√®me d'exploitation, la cr√©ation d'images de machines virtuelles, peu importe. <br>  Vous ne pouvez pas automatiser?  Vous ne pouvez donc pas lancer cela dans le monde.  Apr√®s vous, personne ne le r√©cup√©rera. </p><br><h2 id="graceful-shutdown--korrektnoe-vyklyuchenie">  Arr√™t progressif - arr√™t correct </h2><br><blockquote>  L'application peut traiter SIGTERM et d'autres signaux et interrompre syst√©matiquement son travail apr√®s la fin du traitement de la t√¢che en cours. </blockquote><p>  C'est un point extr√™mement important.  Les processus Docker deviennent orphelins et fonctionnent pendant des mois en arri√®re-plan o√π personne ne les voit.  Les op√©rations non transactionnelles s'interrompent au milieu de l'ex√©cution, cr√©ant une incoh√©rence des donn√©es entre les services et les bases de donn√©es.  Cela conduit √† des erreurs impr√©visibles et tr√®s, tr√®s co√ªteuses. </p><br><p>  Si vous ne contr√¥lez aucune d√©pendance et ne pouvez pas garantir que votre code traitera correctement SIGTERM, utilisez quelque chose comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dumb-init</a> . </p><br><p>  Plus d'infos ici: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://12factor.net/disposability</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://kubernetes.io/docs/concepts/workloads/pods/pod/#termination-of-pods</a> </li></ul><br><h2 id="soedinenie-s-bazoy-dannyh-regulyarno-proveryaetsya">  Connexion √† la base de donn√©es v√©rifi√©e r√©guli√®rement </h2><br><blockquote>  L'application envoie constamment un ping √† la base de donn√©es et r√©pond automatiquement √† l'exception de ¬´perte de connexion¬ª pour toutes les demandes, essayant de la restaurer par elle-m√™me ou de terminer son travail correctement </blockquote><p>  J'ai vu de nombreux cas (ce n'est pas seulement une tournure de discours) lorsque des services cr√©√©s pour traiter des files d'attente ou des √©v√©nements ont perdu leur connexion par timeout et ont commenc√© √† verser sans cesse des erreurs dans les journaux, √† renvoyer des messages dans les files d'attente, √† les envoyer √† Dead Letter Queue ou tout simplement √† ne pas faire leur travail. </p><br><h2 id="masshtabiruetsya-gorizontalno">  Mise √† l'√©chelle horizontalement </h2><br><blockquote>  Avec une charge croissante, il suffit d'ex√©cuter davantage d'instances d'application pour garantir que toutes les demandes ou t√¢ches sont trait√©es. </blockquote><p>  Toutes les applications ne peuvent pas √©voluer horizontalement.  Un exemple frappant est le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kafka Consumers</a> .  Ce n'est pas n√©cessairement mauvais, mais si une application particuli√®re ne peut pas √™tre lanc√©e deux fois, toutes les parties int√©ress√©es doivent en √™tre inform√©es √† l'avance.  Ces informations devraient √™tre une horreur, se bloquer dans le fichier Lisez-moi et dans la mesure du possible.  Certaines applications en g√©n√©ral ne peuvent en aucun cas √™tre lanc√©es en parall√®le, ce qui cr√©e de s√©rieuses difficult√©s dans son support. </p><br><p>  Il est pr√©f√©rable que l'application elle-m√™me contr√¥le ces situations ou qu'un wrapper soit √©crit pour elle qui surveille efficacement les ¬´concurrents¬ª et ne permette tout simplement pas au processus de d√©marrer ou de d√©marrer le travail jusqu'√† ce qu'un autre processus termine son travail ou jusqu'√† ce qu'une configuration externe permette √† N processus de fonctionner simultan√©ment. </p><br><h2 id="dead-letter-queues-i-ustoychivost-k-plohim-soobscheniyam">  Files d'attente de lettres mortes et mauvaise r√©silience des messages </h2><br><blockquote>  Si le service √©coute les files d'attente ou r√©pond aux √©v√©nements, la modification du format ou du contenu des messages n'entra√Æne pas sa chute.  Les tentatives infructueuses de traitement de la t√¢che sont r√©p√©t√©es N fois, apr√®s quoi le message est envoy√© √† Dead Letter Queue. </blockquote><p>  Plusieurs fois, j'ai vu red√©marrer sans cesse des consommateurs et des lignes qui ont gonfl√© √† une taille telle que leur traitement ult√©rieur a pris de nombreux jours.  Tout √©couteur de file d'attente doit √™tre pr√™t √† modifier le format, √† des erreurs al√©atoires dans le message lui-m√™me (en tapant des donn√©es dans json, par exemple), ou lorsqu'il est trait√© par du code enfant.  J'ai m√™me rencontr√© une situation o√π la biblioth√®que RabbitMQ standard pour un framework extr√™mement populaire ne prenait pas en charge les tentatives, les compteurs de tentatives, etc. </p><br><p>  Pire encore, lorsqu'un message est simplement d√©truit en cas d'√©chec. </p><br><h2 id="ogranichenie-na-kolichestvo-obrabatyvaemyh-soobscheniy-i-zadach-odnim-processom">  Limitation du nombre de messages et de t√¢ches trait√©s par processus </h2><br><blockquote>  Il prend en charge une variable d'environnement, qui peut √™tre forc√©e de limiter le nombre maximal de t√¢ches trait√©es, apr√®s quoi le service s'arr√™tera correctement. </blockquote><p>  Tout coule, tout change, surtout la m√©moire.  Le graphique en constante augmentation de la consommation de m√©moire et OOM tu√©s √† la fin est la norme dans les esprits kubern√©tiques modernes.  La mise en ≈ìuvre d'un test primitif qui vous ferait simplement √©conomiser, m√™me le besoin m√™me d'examiner toutes ces fuites de m√©moire, vous faciliterait la vie.  J'ai souvent vu des gens consacrer beaucoup de temps et d'efforts (et d'argent) pour arr√™ter ce roulement, mais rien ne garantit que le prochain engagement de votre coll√®gue ne fera pas empirer les choses.  Si l'application peut survivre une semaine - c'est un excellent indicateur.  Laissez-le ensuite se terminer et red√©marrez.  C'est mieux que SIGKILL (sur SIGTERM voir ci-dessus) ou l'exception "out of memory".  Pendant quelques d√©cennies, cette fiche vous suffit. </p><br><h2 id="ne-ispolzuet-third-party-integracii-s-filtraciey-po-ip-adresam">  N'utilise pas d'int√©gration tierce avec filtrage par adresses IP </h2><br><blockquote>  Si l'application envoie des demandes √† un service tiers qui autorise l'acc√®s √† partir d'adresses IP limit√©es, le service effectue ces appels indirectement via un proxy inverse. </blockquote><p>  C'est un cas rare, mais extr√™mement d√©sagr√©able.  Il est tr√®s g√™nant lorsqu'un petit service bloque la possibilit√© de changer le cluster ou de d√©placer l'ensemble de l'infrastructure dans une autre r√©gion.  Si vous devez communiquer avec une personne qui ne sait pas utiliser oAuth ou VPN, configurez √† l'avance le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">proxy inverse</a> .  N'impl√©mentez pas dans votre programme l'ajout / suppression dynamique de telles int√©grations externes, car ce faisant, vous vous clouez dans le seul runtime disponible.  Il est pr√©f√©rable d'automatiser imm√©diatement ces processus pour g√©rer les configurations Nginx, et dans votre application, contactez-le. </p><br><h2 id="ochevidnyy-http-user-agent">  Agent utilisateur HTTP √©vident </h2><br><blockquote>  Le service remplace l'en-t√™te User-agent par un en-t√™te personnalis√© pour toutes les demandes √† n'importe quelle API, et cet en-t√™te contient suffisamment d'informations sur le service lui-m√™me et sa version. </blockquote><p>  Lorsque vous avez 100 applications diff√©rentes qui se parlent, vous pouvez devenir fou en voyant dans les journaux quelque chose comme "Go-http-client / 1.1" et l'adresse IP dynamique du conteneur Kubernetes.  Identifiez toujours votre application et sa version de mani√®re explicite. </p><br><h2 id="ne-narushaet-licenzii">  Ne viole pas la licence </h2><br><blockquote>  Il ne contient pas de d√©pendances qui limitent excessivement l'application, ce n'est pas une copie du code de quelqu'un d'autre, etc. </blockquote><p>  C'est un cas qui va de soi, mais il s'est av√©r√© que m√™me l'avocat qui a √©crit la NDA a maintenant le hoquet. </p><br><h2 id="ne-ispolzuet-nepodderzhivaemye-zavisimosti">  N'utilise pas de d√©pendances non prises en charge </h2><br><blockquote>  Lorsque vous d√©marrez le service pour la premi√®re fois, il n'inclut pas les d√©pendances d√©j√† obsol√®tes. </blockquote><p>  Si la biblioth√®que que vous avez utilis√©e dans le projet n'est plus prise en charge par quiconque, recherchez un autre moyen d'atteindre l'objectif ou d√©veloppez la biblioth√®que elle-m√™me. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Il y a des v√©rifications tr√®s sp√©cifiques sur ma liste pour des technologies ou des situations sp√©cifiques, mais j'ai juste oubli√© d'ajouter quelque chose.  Je suis s√ªr que vous trouverez √©galement quelque chose √† retenir. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr438064/">https://habr.com/ru/post/fr438064/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr438050/index.html">Filtre de Kalman pour minimiser la valeur d'entropie d'une erreur al√©atoire avec une distribution non gaussienne</a></li>
<li><a href="../fr438052/index.html">Interacteur, mod√®le d'op√©ration</a></li>
<li><a href="../fr438058/index.html">"Analyse des donn√©es en Python" en deux parties</a></li>
<li><a href="../fr438060/index.html">Estimation de l'orientation spatiale, ou Comment ne pas avoir peur des filtres Mahoney et Majwik</a></li>
<li><a href="../fr438062/index.html">Mon adresse n'est pas une maison ou une rue, mon adresse est l'Union sovi√©tique?</a></li>
<li><a href="../fr438066/index.html">10 cha√Ænes YouTube √©ducatives en anglais dont vous n'avez jamais entendu parler</a></li>
<li><a href="../fr438070/index.html">Comment la g√©n√©ration Y est-elle devenue une g√©n√©ration √©puis√©e?</a></li>
<li><a href="../fr438074/index.html">[Annonce pour Iekaterinbourg, Novossibirsk, Saint-P√©tersbourg] Session de test d'automatisation: Nous couvrirons tout de la Neva √† l'Ob avec des tests</a></li>
<li><a href="../fr438078/index.html">Facebook paie 20 $ par mois pour la mise en place de son pseudo-VPN</a></li>
<li><a href="../fr438080/index.html">√âlectronique aliment√©e par un signal Wi-Fi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>