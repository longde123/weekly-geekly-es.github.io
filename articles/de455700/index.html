<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöó üö∞ üòæ 4 Tricks, die uns geholfen haben, das Frontend zu optimieren üç° üóØÔ∏è üêÅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sch√∂ne Animationen sind seit langem in Designtrends verankert. UI-Designer erstellen aufwendige Karussells, Downloads, Men√ºanimationen und andere Deko...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>4 Tricks, die uns geholfen haben, das Frontend zu optimieren</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/epayments/blog/455700/"><p>  Sch√∂ne Animationen sind seit langem in Designtrends verankert.  UI-Designer erstellen aufwendige Karussells, Downloads, Men√ºanimationen und andere Dekorationen, w√§hrend Frontend-Entwickler sie in Code √ºbersetzen.  Die Seite sollte aber nicht nur gut aussehen, sondern auch schnell funktionieren. </p><br><p>  Ein modernes Frontend sollte seinen Code optimieren.  Dies gilt insbesondere f√ºr Produkte, bei denen der gr√∂√üte Teil des Publikums von mobilen Ger√§ten auf die Website gelangt.  Einige Animationsmethoden bleiben sogar in Chrome auf Top-Computern zur√ºck, sollten jedoch auf einem durchschnittlichen Smartphone reibungslos funktionieren. </p><br><p>  Unsere Entwickler verwendeten eine Vielzahl von Techniken, um die Website zu optimieren und ihre Arbeit zu beschleunigen.  Ich habe 4 der interessantesten gesammelt.  Wir teilen Wissen, das f√ºr Anf√§nger und Profis n√ºtzlich ist, und bieten Links zu n√ºtzlichen Tutorials. </p><br><p><img src="https://habrastorage.org/webt/1e/2e/ic/1e2eic7lnnlwnm22gy1y2ah8zto.jpeg"></p><a name="habracut"></a><br><h2 id="1-animaciya-na-scss">  1. Animation auf SCSS </h2><br><p>  <strong>Die Seite hat viele Animationen.</strong>  <strong>Wir brauchen den Browser, um ihn mit einer stabilen Bildrate von 60 fps abzuspielen.</strong>  <strong>In reinem CSS ist dies schwierig, daher verwenden wir SCSS.</strong> </p><br><p>  Um die Schieberegler zu erstellen, haben wir die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Swiper-</a> Bibliothek verwendet.  F√ºr einen horizontalen Schieberegler ist die Verwendung dieser Bibliothek gerechtfertigt, da wir vom Benutzer Unterst√ºtzung f√ºr svayp bereitstellen mussten.  F√ºr ein vertikales Endloskarussell wird Swiper jedoch nicht ben√∂tigt, es gibt keine Benutzerinteraktion.  Daher wollten wir dieselbe Funktionalit√§t nur mit CSS-Funktionen wiederholen. </p><br><p>  Die erste und wichtigste Bedingung beim Arbeiten mit CSS-Animationen ist die Verwendung nur der Transformations- und Deckkrafteigenschaften.  Browser k√∂nnen die Animation dieser Eigenschaften unabh√§ngig voneinander optimieren und stabile 60 fps erzeugen.  Die Verwendung von @keyframes allein ist jedoch nicht m√∂glich, um unterschiedliche Animationen f√ºr unterschiedliche Elemente zu schreiben, und es ist zu zeitaufw√§ndig, jedes Element einzeln in reinem CSS zu animieren.  Wie schreibe ich schnell die Animation, die wir brauchen?  Wir haben uns f√ºr SCSS entschieden, den SASS-Dialekt - eine funktionalere CSS-Erweiterung. </p><br><p>  Lassen Sie uns die Verwendung von SCSS am Beispiel unseres vertikalen Schiebereglers analysieren. </p><br><p><img src="https://habrastorage.org/webt/bt/si/ia/btsiiagvb3utwdiuf4hasoszp7a.gif"></p><br><p>  Zu unserer Verf√ºgung steht ein Beh√§lter, dessen H√∂he der H√∂he der drei Elemente des Karussells entspricht.  Im Inneren befindet sich ein weiterer Beh√§lter, der alle Elemente des Karussells enth√§lt. </p><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-vertical-carousel-slider"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-wrapper slider-items"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Wir entfernen die Sichtbarkeit der dar√ºber hinausgehenden Containerelemente und legen die H√∂he der Bl√∂cke fest. </p><br><pre> <code class="plaintext hljs">.b-vertical-carousel-slider { position: relative; overflow: hidden; height: $itemHeight * 3; .vertical-carousel-slider-item { height: $itemHeight; } }</code> </pre> <br><p>  Die Berechnung der Animation √§ndert sich nur, wenn sich die Anzahl der Elemente im Karussell √§ndert.  Als n√§chstes schreiben wir ein Mixin, das einen Eingabeparameter verwendet - <code>$itemCount</code> </p><br><pre> <code class="plaintext hljs">@mixin verticalSlideAnimation($itemCount) { }</code> </pre> <br><p>  Generieren Sie im Mixin einen Keyframe f√ºr jedes Element, legen Sie den Anfangszustand daf√ºr fest und bestimmen Sie mit <code>:nth-child</code> die Animation f√ºr das Element. </p><br><pre> <code class="plaintext hljs">for $i from * 1 through $itemCount { $animationName: carousel-item-#{$itemCount}-#{$i}; @keyframes #{$animationName} { 0% { transform: translate3d(0, 0, 0) scale(.95); } } .vertical-carousel-slider-item:nchild(#{$i}) { animation: $stepDuration * $itemCount $animation ease infinite; } }</code> </pre> <br><p>  W√§hrend der Animation verschieben wir die Elemente nur entlang der y-Achse und √§ndern die Skalierung f√ºr das Element in der Mitte. </p><br><p>  Karussellelementzust√§nde: </p><br><ol><li>  Frieden </li><li>  Y-Offset </li><li>  Y-Offset </li><li>  Y-Versatz mit abnehmendem </li></ol><br><p>  Jeder Gegenstand bewegt sich um <code>$itemCount</code> Zeiten nach oben, erh√∂ht sich einmal und verringert sich einmal w√§hrend der Bewegung.  Daher werden wir die Animation f√ºr jede der Aufw√§rtsbewegungen generieren und berechnen. </p><br><pre> <code class="plaintext hljs">@keyframes #{$animationName} { 0% { transform: translate3d(0, 0, 0) scale(.95); } @for $j from 0 through $itemCount { $isFocusedStep: $i == $j + 2; $isNotPrevStep: $i != $j + 1; $offset: 100% / $itemCount * ($animationTime / $stepDuration); @if ($isFocusedStep) { #{getPercentForStep($j, $itemCount, $offset)} { transform: getTranslate($j - 1) scale(.95); } #{getPercentForStep($j, $itemCount)} { transform: getTranslate($j) scale(1); } #{getPercentForStep($j + 1, $itemCount, $offset)} { transform: getTranslate($j) scale(1); } #{getPercentForStep($j + 1, $itemCount)} { transform: getTranslate($j + 1) scale(.95); } } @else if ($isNotPrevStep) { #{getPercentForStep($j, $itemCount, $offset)} { transform: getTranslate($j - 1) scale(.95); } #{getPercentForStep($j, $itemCount)} { transform: getTranslate($j) scale(.95); } } } }</code> </pre> <br><p>  Es bleiben noch einige Variablen und Funktionen zu definieren: </p><br><ul><li>  <code>$animationTime</code> - Bewegungszwischenzeit </li><li>  <code>$stepDuration</code> - Gesamtausf√ºhrungszeit eines Animationsschritts ( <code>$animationTime</code> + Karussellruhezeit) </li><li>  <code>getPercentForStep($step, $itemCount, $offset)</code> - eine Funktion, die den Extrempunkt eines der Zust√§nde in Prozent zur√ºckgibt. </li><li>  <code>getTranslate($step)</code> - gibt je nach Animationsschritt die √úbersetzung zur√ºck </li></ul><br><p>  Beispiel f√ºr Funktionsimplementierungen: </p><br><pre> <code class="plaintext hljs">@function getPercentForStep($step, $count, $offset: 0) { @return 100% * $step / $count - $offset; } @function getTranslate($step) { @return translate3d(0, -100% * $step, 0); }</code> </pre> <br><p>  Wir haben ein funktionierendes Karussell mit einem zunehmenden Element in der Mitte.  Es bleibt ein Schatten unter den zunehmenden Elementen zu machen.  Anfangs hatte jedes Element des Karussells ein Pseudoelement: danach, das wiederum einen Schatten hatte.  Um die Schatteneigenschaft nicht zu animieren, haben wir die Opazit√§tseigenschaft daf√ºr verwendet, d.h.  zeigte nur und versteckte den Schatten. </p><br><p>  In der neuen Implementierung f√ºr eine solche L√∂sung m√ºssen Sie jedoch viele zus√§tzliche Keyframes f√ºr jedes Pseudoelement generieren.  Wir haben beschlossen, es einfacher zu machen: Es wird einen Block mit einem Schatten geben, der genau unter dem mittleren Element des Karussells Platz einnimmt. </p><br><p>  F√ºgen Sie ein Div hinzu, das f√ºr den Schatten verantwortlich ist. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-vertical-carousel-slider"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-wrapper"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-shadow"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Wir stilisieren es und f√ºgen Animationen hinzu. </p><br><pre> <code class="plaintext hljs">@keyframes shadowAnimation { 0% { opacity: 1; } 80% { opacity: 1; } 90% { opacity: 0; } 100% { opacity: 1; } } .vertical-carousel-slider-shadow { top: $itemHeight; left: 0; right: 0; height: $itemHeight; animation: $stepDuration shadowAnimation ease infinite; }</code> </pre> <br><p>  In diesem Fall m√ºssen Sie keine M√∂glichkeit zum Animieren des Schattens unter jedem Element generieren und √ºberlegen, wir animieren nur einen Block, er hat zwei Zust√§nde - er ist sichtbar und verborgen </p><br><p>  Als Ergebnis haben wir ein reines CSS-Karussell, das nur mit gut optimierten Eigenschaften animiert.  Dadurch kann der Browser die Hardwarebeschleunigung zum Rendern verwenden.  Daher der greifbare Gewinn im Vergleich zu JS Animation: </p><br><ol><li>  Beim Scrollen von Seiten mit Animationen auf schwachen Ger√§ten wurden Frames in JS-Animationen deutlich √ºbersprungen, wodurch die FPS auf 15 bis 20 gesenkt wurden.  CSS-Animationen haben die Dinge deutlich verbessert.  Auf diesen Ger√§ten betrug diese Zahl mindestens 50-55 FPS. </li><li>  Wir haben die Arbeit eines Drittanbieter-Moduls losgeworden, f√ºr das es nicht erforderlich war. </li><li>  Die Animation wird auch dann abgespielt, wenn JS deaktiviert ist </li></ol><br><p>  JS-Animationen sollten verwendet werden, wenn eine strikte Kontrolle √ºber jedes Bild erforderlich ist: Pause, R√ºckw√§rtswiedergabe, R√ºcklauf, Reaktion auf Benutzeraktionen.  In anderen F√§llen empfehlen wir die Verwendung von reinem CSS. </p><br><p>  <strong>N√ºtzliche Links</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Animationsanleitung verwischen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Handbuch zu CSS-Eigenschaften und Browseraufgaben</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anleitung zur Schattenanimation</a> </li></ul><br><h2 id="2-ispolzovanie-intersection-observer-api">  2. Verwenden der Intersection Observer-API </h2><br><p>  <strong>Die Animation, die der Site-Besucher nicht sieht, wird irgendwo au√üerhalb der Sichtweite abgespielt und l√§dt die CPU.</strong>  <strong>Mit dem Intersection Observer bestimmen wir, welche Art von Animation gerade auf dem Bildschirm sichtbar ist, und spielen sie nur ab.</strong> </p><br><p>  Alle Tricks aus dem letzten Absatz k√∂nnen mit dem Intersection Observer kombiniert werden.  Dieses Tool hilft, den Browser nicht mit Animationen zu laden, die der Site-Besucher nicht sieht.  Bisher wurden ressourcenintensive ‚ÄûZuh√∂rer‚Äú von Ereignissen verwendet, um zu verstehen, ob ein Besucher ein animiertes Element betrachtete, und dies erzeugte keinen starken ‚ÄûAuspuff‚Äú.  Der Unterschied zwischen der Verwendung von Animationen au√üerhalb des Ansichtsfensters und der Verwendung von Listenern war minimal.  Die Intersection Observer-API ben√∂tigt weniger Ressourcen und hilft dabei, nur die Animation abzuspielen, die f√ºr den Besucher sichtbar ist. </p><br><p>  Auf unserer Website wird die Animation nur aktiviert, wenn ein Element im Ansichtsfenster angezeigt wird.  Wenn wir dies nicht tun w√ºrden, w√ºrden die Seiten mit der st√§ndigen Ausf√ºhrung von Schleifenanimationen √ºberladen, die nicht sichtbar waren.  Mit der Intersection Observer-API k√∂nnen Sie den Schnittpunkt des Elements mit dem √ºbergeordneten Element oder den Umfang des Dokuments √ºberwachen. </p><br><p>  <strong>Implementierungsbeispiel</strong> </p><br><p>  Als Beispiel zeigen wir, wie Sie die Animation in JS optimieren k√∂nnen.  Die Idee ist einfach: Die Animation wird abgespielt, w√§hrend sich das animierte Element im Ansichtsfenster befindet.  F√ºr die Implementierung verwenden wir die Intersection Observer API. </p><br><p>  F√ºgen Sie den Stilen eine <code>is-paused</code> Klassenbehandlung hinzu </p><br><pre> <code class="plaintext hljs">.b-vertical-carousel-slider.is-paused { .vertical-carousel-slider-wrapper { .vertical-carousel-slider-item { animation-play-state: paused; } } .vertical-carousel-slider-shadow { animation-play-state: paused; } }</code> </pre> <br><p>  Das hei√üt,  Wenn diese Klasse angezeigt wird, wird die Animation angehalten. </p><br><p>  Nun beschreiben wir die Logik des Hinzuf√ºgens und Entfernens dieser Klasse </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.IntersectionObserver) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> el = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'.b-vertical-carousel-slider'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> observer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IntersectionObserver(intersectionObserverCallback); observer.observe(el); }</code> </pre> <br><p>  Hier haben wir eine Instanz von IntersectionObserver erstellt und die Funktion intersectionObserverCallback angegeben, die funktioniert, wenn sich die Sichtbarkeit √§ndert. </p><br><p>  Definieren Sie nun <code>intersectionObserverCallback</code> </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intersectionObserverCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">entries</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (entries[<span class="hljs-number"><span class="hljs-number">0</span></span>].intersectionRatio === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } helperDOM.toggleClass(el, <span class="hljs-string"><span class="hljs-string">'is-paused'</span></span>, entries[<span class="hljs-number"><span class="hljs-number">0</span></span>].intersectionRatio &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>); };</code> </pre> <br><p>  Jetzt wird die Animation nur auf den sichtbaren Elementen abgespielt.  Sobald das Element aus dem Sichtfeld verschwunden ist, wird die Animation angehalten.  Wenn der Besucher zu ihm zur√ºckkehrt, wird die Wiedergabe fortgesetzt. </p><br><p>  <strong>N√ºtzliche Links</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Browser, die Intersection Observer unterst√ºtzen</a> </li><li>  F√ºr Browser, die dies nicht unterst√ºtzen, m√ºssen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">polyfil verwenden</a> </li></ul><br><h2 id="3-rendering-svg">  3. SVG-Rendering </h2><br><p>  <strong>Eine gro√üe Anzahl von Bildern oder die Verwendung von Sprites f√ºhrt in den ersten Sekunden nach dem Laden zu Friesen und Verz√∂gerungen.</strong>  <strong>Durch das Einbetten von SVG in den Seitencode wird das Laden visuell reibungsloser.</strong> </p><br><p>  Bei der Auswahl der Methoden f√ºr die Arbeit mit Bildern hatten wir zwei Optimierungsoptionen: Einbetten von SVG in HTML oder Verwenden von Sprites.  Wir haben uns f√ºr die Einbettung entschieden.  Wir binden den XML-Code jedes Bildes direkt in den HTML-Code der Seiten ein.  Dadurch wird die Gr√∂√üe geringf√ºgig erh√∂ht, SVG wird jedoch sofort im Dokument bereitgestellt. </p><br><p>  Viele Entwickler verwenden weiterhin SVG-Sprites.  Was ist das Wesentliche der Methode: Eine Reihe von Bildern (z. B. Symbole) werden in einer gro√üen Bildfl√§che gesammelt, die als Sprite bezeichnet wird.  Wenn Sie ein bestimmtes Symbol anzeigen m√ºssen, wird ein Sprite aufgerufen, nach dem die Koordinaten des bestimmten Teils angegeben werden, auf dem es sich befindet.  Dies ist schon lange geschehen, selbst bei der ersten Version von HTTP.  Sprites halfen dabei, die Datei aggressiv zwischenzuspeichern und die Anzahl der Serveranforderungen zu reduzieren.  Dies war wichtig, da viele gleichzeitige Anforderungen den Browser verlangsamten.  Die Verwendung von SVG-Sprites ist eine typische Kr√ºcke, mit der Sie die Logik des Arbeitens vernachl√§ssigen, um Ressourcen zu sparen.  Jetzt ist die Anzahl der Anfragen nicht mehr so ‚Äã‚Äãwichtig, daher empfehlen wir das Einbetten. </p><br><p>  Erstens wirkt es sich positiv auf die Leistung aus Sicht des Besuchers aus.  Er sieht, wie die Symbole sofort geladen werden und leidet nicht die ersten Sekunden nach dem Laden der Seite.  Bei Verwendung von Sprite- oder PNG-Bildern wird die geladene Seite etwas langsamer.  Dies ist besonders dann zu sp√ºren, wenn der Besucher die geladene Seite sofort scrollt - FPS sinkt auf Nicht-Top-Ger√§ten auf 5-15.  Durch das Einbetten von SVG in HTML wird die Seitenlatenz verringert (subjektiv aus Sicht des Clients) und Friese und Framespr√ºnge beim Laden werden entfernt. </p><br><h2 id="4-keshirovanie-s-ispolzovaniem-service-worker-i-http-cache">  4. Caching mit Service Worker und HTTP-Cache </h2><br><p>  <strong>Es macht keinen Sinn, eine nicht ge√§nderte Seite neu zu laden und den Besucherverkehr zu verwenden.</strong>  <strong>Es gibt viele Caching-Strategien, wir haben uns f√ºr die effizienteste Kombination entschieden.</strong> </p><br><p>  Es lohnt sich, nicht nur die CPU / GPU, sondern auch das Netzwerk optimal zu nutzen.  Mobile Ger√§te sind nicht nur in Bezug auf Ressourcen, sondern auch in Bezug auf Internetgeschwindigkeit und Datenverkehr eine Einschr√§nkung.  Caching hat uns hier geholfen.  Sie k√∂nnen Antworten auf HTTP-Anforderungen speichern und verwenden, ohne erneut eine Antwort vom Server zu erhalten. </p><br><p>  Als wir √ºber eine Caching-Strategie nachdachten, entschieden wir uns, Service Worker und HTTP-Cache gleichzeitig zu verwenden.  Beginnen wir mit dem ersten und fortgeschritteneren.  Service Worker ist eine js-Datei, die ihre Seite oder Datei steuern, Anforderungen abfangen und √§ndern sowie Anforderungen programmgesteuert zwischenspeichern kann.  Es fungiert als Proxy zwischen der Site und dem Server und bestimmt deren Offline-Verhalten.  All dies geschieht auf der "Vorderseite", ohne ein "Backend" anzuschlie√üen. </p><br><p>  Service Worker hat eine enorme Variabilit√§t.  Wir k√∂nnen das Verhalten nach Belieben programmieren.  Wir wissen beispielsweise, dass ein Besucher, der mit einer Wahrscheinlichkeit von 90% auf Seite 1 gegangen ist, auf Seite 2 geht.  Wir bitten SW, die zweite Seite mit dem Hintergrund zu laden, wenn sich der Besucher noch auf der ersten befindet.  Wenn er dazu geht, wird die Seite sofort geladen.  Es kann f√ºr verschiedene Aufgaben verwendet werden: </p><br><ul><li>  Hintergrunddatensynchronisation </li><li>  Offline-Rechner </li><li>  Benutzerdefinierte Vorlagen </li><li>  Reaktion auf eine bestimmte Zeit und ein bestimmtes Datum. </li></ul><br><p>  Service Worker-Dateien k√∂nnen in verschiedenen Diensten erstellt werden.  Wir empfehlen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Workbox</a> .  Es ist recht einfach und erm√∂glicht es Ihnen, eine Reihe von Regeln zu erstellen, nach denen das Caching ausgef√ºhrt wird, z. B. Precache. </p><br><p>  Servicemitarbeiter unterst√ºtzen nicht alle Browser wie IE, Safari oder Chrome vor Version 40.0.  Wenn das Ger√§t nicht damit arbeiten kann, befolgt es die HTTP-Cache-Caching-Regeln.  Wir haben den Seiten die folgenden HTTP-Header hinzugef√ºgt: </p><br><pre> <code class="plaintext hljs">cache-control: no-cache last-modified: Mon, 06 May 2019 04:26:29 GMT</code> </pre> <br><p>  In diesem Fall f√ºgt der Browser dem Repository Antworten auf Anforderungen hinzu, sendet jedoch bei jeder nachfolgenden Anforderung einen Header, um nach √Ñnderungen zu suchen. </p><br><pre> <code class="plaintext hljs">if-modified-since: Mon, 06 May 2019 04:26:29 GMT</code> </pre> <br><p>  Falls keine √Ñnderungen aufgetreten sind, erh√§lt der Browser eine Antwort mit dem Code 304 Nicht ge√§ndert und verwendet den im Cache gespeicherten Inhalt.  Wenn √Ñnderungen am Dokument vorgenommen werden, wird die Antwort mit dem Code 200 zur√ºckgegeben und eine neue Antwort in den Browserspeicher geschrieben. </p><br><p>  Wenig sp√§ter haben wir die Caching-Methode ge√§ndert und die Hash-Menge im Dateinamen √ºberpr√ºft.  Es stellt sicher, dass die Ressource eindeutig bleibt.  Daher k√∂nnten wir Inhalte aggressiv zwischenspeichern.  Der folgende Header wurde als Antwort hinzugef√ºgt: </p><br><pre> <code class="plaintext hljs">Cache-control:max-age=31536000, immutable</code> </pre> <br><p>  Das maximale Alter gibt die maximale Caching-Zeit an, in unserem Fall 1 Jahr.  Ein unver√§nderlicher Wert bedeutet, dass eine solche Antwort nicht auf √Ñnderungen √ºberpr√ºft werden muss. </p><br><p>  <strong>N√ºtzliche Links</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/">HTTP-Caching-Handbuch</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Handbuch zur Verwendung der Service Worker-API</a> </li></ul><br><p>  Dies sind nicht alle M√∂glichkeiten, um die Site zu optimieren.  Dies k√∂nnte zu einer Ablehnung des Bootstraps f√ºhren, die Anzahl der DOM-Elemente und -Ereignisse verringern und vieles mehr.  Dies sind jedoch die Tipps, die uns geholfen haben, die Website trotz der gro√üen Menge an Animationen schnell und reaktionsschnell zu gestalten. </p><br><h3 id="priglashaem-v-nashu-komandu">  Wir laden Sie in unser Team ein </h3><br><p>  F√ºr unsere ehrgeizigen Aufgaben suchen wir in unserem B√ºro in St. Petersburg immer coole Spezialisten: Entwickler, Tester, Designer.  Unten gibt es offene Stellen - machen Sie mit. </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Frontend-Entwickler</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">QS-Ingenieur</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Softwareentwicklungsingenieur im Test</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de455700/">https://habr.com/ru/post/de455700/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de455686/index.html">Wie w√§hle ich das beste Projektmanagement-Tool aus, wenn Sie ein Millennial sind?</a></li>
<li><a href="../de455692/index.html">ASZP: Restyling oder Theater beginnen mit einem Kleiderb√ºgel</a></li>
<li><a href="../de455694/index.html">Abrechnungsarchitektur der n√§chsten Generation: √úbergang zu Tarantool</a></li>
<li><a href="../de455696/index.html">Der elektronische Zustand der Zukunft. Teil 2</a></li>
<li><a href="../de455698/index.html">Das Buch "Wie JavaScript funktioniert"</a></li>
<li><a href="../de455702/index.html">Effektive Zahlengenerierung in einem bestimmten Intervall</a></li>
<li><a href="../de455710/index.html">Warum brauchen wir bei Leroy Merlin eine eigene russische Entwicklungsabteilung f√ºr 200 Mitarbeiter?</a></li>
<li><a href="../de455714/index.html">Exportieren Sie Google Forms automatisch mit IFTTT und Django nach Notion</a></li>
<li><a href="../de455716/index.html">15 Best Practices f√ºr die Bereitstellung von Business Intelligence-Software</a></li>
<li><a href="../de455720/index.html">Wie wir eine Benutzeroberfl√§che f√ºr Anzeigensysteme erstellen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>