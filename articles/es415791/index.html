<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëµüèø üå§Ô∏è üöÇ Optimizaci√≥n de contratos inteligentes. C√≥mo los tipos de solidez afectan los costos de transacci√≥n üê∫ ü¶ó üßî</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúLos programadores pasan una gran cantidad de tiempo preocup√°ndose por la velocidad de sus programas, y los intentos por lograr la eficiencia a menudo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Optimizaci√≥n de contratos inteligentes. C√≥mo los tipos de solidez afectan los costos de transacci√≥n</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415791/"><blockquote> <i>‚ÄúLos programadores pasan una gran cantidad de tiempo preocup√°ndose por la velocidad de sus programas, y los intentos por lograr la eficiencia a menudo tienen un impacto negativo dram√°tico en la capacidad de depurarlos y respaldarlos.</i>  <i>Es necesario olvidarse de las peque√±as optimizaciones, por ejemplo, en el 97% de los casos.</i>  <i>¬°La optimizaci√≥n prematura es la ra√≠z de todo mal!</i>  <i>¬°Pero no debemos perder de vista el 3% donde es realmente importante!</i> <br>  <b>Donald Knut</b> <br></blockquote><img src="https://habrastorage.org/webt/dw/wh/fv/dwwhfvvtvsgi2ilhvtjscuk8xyc.png" alt="Gas et√©reo"><br><br>  Cuando realizamos auditor√≠as de contratos inteligentes, a veces nos preguntamos si su desarrollo se relaciona con el 97% donde no hay necesidad de pensar en la optimizaci√≥n o si estamos tratando solo con el 3% de los casos en los que es importante.  En nuestra opini√≥n, lo m√°s probable es el segundo.  A diferencia de otras aplicaciones, los contratos inteligentes no se actualizan, no pueden optimizarse "sobre la marcha" (siempre que su algoritmo no est√© establecido, pero este es un tema aparte).  El segundo argumento a favor de <i>la</i> optimizaci√≥n <i>temprana del</i> contrato es que, a diferencia de la mayor√≠a de los sistemas donde la suboptimidad se manifiesta solo en escala, relacionada con los detalles espec√≠ficos del hierro y el medio ambiente, se mide por una gran cantidad de m√©tricas, un contrato inteligente tiene esencialmente la √∫nica m√©trica de rendimiento: consumo de gas. <br><br>  Por lo tanto, es t√©cnicamente m√°s f√°cil evaluar la efectividad de un contrato, pero los desarrolladores a menudo contin√∫an confiando en su intuici√≥n y hacen la misma "optimizaci√≥n prematura" ciega de la que habl√≥ el profesor Knut.  Comprobaremos qu√© tan intuitiva corresponde la soluci√≥n a la realidad mediante el ejemplo de elegir la profundidad de bits de una variable.  En este ejemplo, como en la mayor√≠a de los casos pr√°cticos, no lograremos ahorros, e incluso viceversa, nuestro contrato resultar√° m√°s costoso en t√©rminos de consumo de gas. <br><a name="habracut"></a><br><h2>  ¬øQu√© tipo de gas? </h2><br>  Ethereum es como una computadora global, cuyo "procesador" es la m√°quina virtual EVM, el "c√≥digo de programa" es una secuencia de comandos y datos grabados en un contrato inteligente, y las llamadas son transacciones que provienen del mundo exterior.  Las transacciones se empaquetan en estructuras relacionadas, bloques que ocurren una vez cada pocos segundos.  Y dado que el tama√±o del bloque es, por definici√≥n, limitado, y el protocolo de procesamiento es determinista (requiere un procesamiento uniforme de todas las transacciones en el bloque por parte de todos los nodos de la red), para satisfacer una demanda potencialmente ilimitada con un recurso limitado de nodos y proteger contra DoS, el sistema debe proporcionar un algoritmo justo para elegir la solicitud de qui√©n atender, y cuya ignorancia, como mecanismo en muchas cadenas de bloques p√∫blicas, existe un principio simple: el remitente puede elegir la cantidad de remuneraci√≥n para el minero por realizar su transferencia  ktsii y elige minero que necesiten disponer de un bloque, y no cuyos, la elecci√≥n de los m√°s rentables por s√≠ mismos. <br><br>  Por ejemplo, en Bitcoin, donde el bloque est√° limitado a un megabyte, el minero elige incluir la transacci√≥n en el bloque o no en funci√≥n de su longitud y la comisi√≥n propuesta (elegir aquellos con la relaci√≥n m√°xima de satoshis por byte). <br><br>  Para el protocolo Ethereum m√°s complejo, este enfoque no es adecuado, porque un solo byte puede representar tanto la ausencia de una operaci√≥n (por ejemplo, el c√≥digo STOP) como la operaci√≥n de escritura lenta y costosa en el almacenamiento (SSTORE).  Por lo tanto, para cada c√≥digo de operaci√≥n en el aire se proporciona su propio precio, dependiendo de su consumo de recursos. <br><br><div class="spoiler">  <b class="spoiler_title">Lista de tarifas de la especificaci√≥n del protocolo</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/wb/to/i4/wbtoi4ymmqlobftzqqvykhau2iq.png" alt="Programa de tarifas de Ethereum"><br>  Tabla de flujo de gas para diferentes tipos de operaciones.  De la especificaci√≥n del protocolo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ethereum Yellow Paper</a> . <br></div></div><br>  A diferencia de Bitcoin, el remitente de la transacci√≥n Ethereum no establece la comisi√≥n en criptomoneda, sino la cantidad m√°xima de gas que est√° dispuesto a gastar: <b>startGas</b> y el precio por unidad de gas: <b>gasPrice</b> .  Cuando la m√°quina virtual ejecuta el c√≥digo, la cantidad de gas para cada operaci√≥n posterior se resta de startGas hasta que se alcanza la salida del c√≥digo o se agota el gas.  Aparentemente, es por eso que se usa un nombre tan extra√±o para esta unidad de trabajo: la transacci√≥n se llena con gas como un autom√≥vil, y llegar√° al punto de destino o no, dependiendo de si hay suficiente volumen lleno en el tanque.  Al finalizar la ejecuci√≥n del c√≥digo, la cantidad de aire recibida al multiplicar el gas realmente consumido por el precio establecido por el remitente ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">wei</a> por gas) se debita del remitente de la transacci√≥n.  En la red global, esto sucede en el momento de "extraer" el bloque, que incluye la transacci√≥n correspondiente, y en el entorno Remix, la transacci√≥n se "extrae" al instante, de forma gratuita y sin ninguna condici√≥n. <br><br><h2>  Nuestra herramienta - Remix IDE </h2><br>  Para el "perfil" del consumo de gas, utilizaremos el entorno en l√≠nea para desarrollar los contratos Ethereum del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Remix IDE</a> .  Este IDE contiene editor de c√≥digo de resaltado de sintaxis, visor de artefactos, renderizador de interfaz de contrato, depurador visual de m√°quina virtual, compiladores JS de todas las versiones posibles y muchas otras herramientas importantes.  Recomiendo comenzar el estudio del √©ter con √©l.  Una ventaja adicional es que no requiere instalaci√≥n, solo √°bralo en un navegador desde el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sitio oficial</a> . <br><br><h2>  Selecci√≥n de tipo variable </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La especificaci√≥n del lenguaje Solidity</a> ofrece al desarrollador hasta treinta y dos bits de tipos enteros uint, de 8 a 256 bits.  Imagine que est√° desarrollando un contrato inteligente dise√±ado para almacenar la edad de una persona en a√±os.  ¬øQu√© profundidad de bit elige? <br><br>  Ser√≠a bastante natural elegir el tipo m√≠nimo suficiente para una tarea espec√≠fica: uint8 encajar√≠a matem√°ticamente aqu√≠.  Ser√≠a l√≥gico suponer que cuanto m√°s peque√±o es el objeto que almacenamos en la cadena de bloques y menos memoria gastamos en la ejecuci√≥n, menos gastos generales tenemos, menos pagamos.  Pero en la mayor√≠a de los casos, esta suposici√≥n ser√° incorrecta. <br><br>  Para el experimento, tomamos el contrato m√°s simple de lo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">que</a> ofrece la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n</a> oficial de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Solidity</a> y lo recopilamos en dos versiones, usando el tipo variable uint256 y el tipo 32 veces m√°s peque√±o, uint8. <br><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_uint256.sol</b> <div class="spoiler_text"><pre> <code class="hljs powershell"><code>pragma solidity ^<span class="hljs-number"><span class="hljs-number">0.4</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>; contract SimpleStorage { //uint is alias <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> uint256 uint storedData; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span></span> { storedData = x; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">view</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">returns</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> storedData; } }</code> <br></code> </pre> <code><code>pragma solidity ^0.4.0; contract SimpleStorage { //uint is alias for uint256 uint storedData; function set(uint x) public { storedData = x; } function get() public view returns (uint) { return storedData; } }</code> <br></code> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_uint8.sol</b> <div class="spoiler_text"><pre> <code class="hljs powershell">pragma solidity ^<span class="hljs-number"><span class="hljs-number">0.4</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>; contract SimpleStorage { uint8 storedData; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint8 x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span></span> { storedData = x; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">view</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">returns</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> storedData; } }</code> </pre> <br><br></div></div><br><h2>  Medici√≥n de "ahorros" </h2><br>  Por lo tanto, los contratos se crean, cargan en Remix, se implementan y las llamadas a los m√©todos .set () se ejecutan mediante transacciones.  Que vemos  <b>Grabar un tipo largo es m√°s costoso que uno corto</b> : ¬°20464 versus 20205 unidades de gas!  Como?  Por qu√©  ¬°Vamos a resolverlo! <br><br><img src="https://habrastorage.org/webt/rq/7p/bo/rq7pbohiqrtea8mp2bem0hddqlu.png" alt="Consumo de gas et√©reo en Remix IDE"><br><br><h2>  Almacenar uint8 vs uint256 </h2><br>  Escribir en el almacenamiento persistente es una de las operaciones m√°s costosas en el protocolo por razones obvias: en primer lugar, registrar el estado aumenta el tama√±o del espacio en disco requerido por el nodo completo.  El tama√±o de este almacenamiento aumenta constantemente y cuanto m√°s estados se almacenan en los nodos, cuanto m√°s lenta es la sincronizaci√≥n, mayor es el requisito de infraestructura (tama√±o de partici√≥n, n√∫mero de iops).  En las horas pico, son las operaciones de E / S de disco lento las que determinan el rendimiento de toda la red. <br><br>  Ser√≠a l√≥gico esperar que el almacenamiento de uint8 deber√≠a costar decenas de veces m√°s barato que uint256.  Sin embargo, en el depurador puede ver que ambos valores se encuentran exactamente iguales en la ranura de almacenamiento que un valor de 256 bits. <br><br><img src="https://habrastorage.org/webt/7x/v-/e8/7xv-e8hrnzwrta4z0z7adgticm0.png"><br><br>  Y en este caso particular, el uso de uint8 no ofrece ninguna ventaja en el costo de escribir en el almacenamiento. <br><br><h2>  Manejo de uint8 vs uint256 </h2><br>  ¬øQuiz√°s obtendremos beneficios cuando trabajemos con uint8 si no durante el almacenamiento, y al menos cuando manipulemos datos en la memoria?  A continuaci√≥n se comparan las instrucciones para la misma funci√≥n obtenida para diferentes tipos de variables. <br><br><img src="https://habrastorage.org/webt/wj/qq/4h/wjqq4hi8_gkc0lfxckcyhjygbu4.png"><br><br>  Puede ver que las operaciones con uint8 tienen incluso <b>m√°s instrucciones</b> que uint256.  Esto se debe a que la m√°quina convierte el valor de 8 bits en una palabra nativa de 256 bits y, como resultado, el c√≥digo est√° rodeado de instrucciones adicionales que paga el remitente.  No solo escribir, sino tambi√©n ejecutar c√≥digo con un tipo uint8 en este caso es m√°s costoso. <br><br><h2>  ¬øD√≥nde se puede justificar el uso de tipos cortos? </h2><br>  Nuestro equipo ha estado involucrado en la auditor√≠a de contratos inteligentes durante mucho tiempo, y hasta ahora no ha habido un solo caso pr√°ctico en el que el uso de un tipo peque√±o en el c√≥digo proporcionado para la auditor√≠a conduzca a ahorros.  Mientras tanto, en algunos casos muy espec√≠ficos, los ahorros son te√≥ricamente posibles.  Por ejemplo, si su contrato almacena una gran cantidad de peque√±as variables o estructuras de estado, entonces se pueden empaquetar en menos ranuras de almacenamiento. <br><br>  La diferencia ser√° m√°s evidente en el siguiente ejemplo: <br><br>  1. contrato con 32 variables uint256 <br><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_32x_uint256.sol</b> <div class="spoiler_text"><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">pragma</span></span> solidity<span class="hljs-regexp"><span class="hljs-regexp"> ^0.4.0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">contract</span></span> SimpleStorage { <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData1; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData2; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData3; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData4; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData5; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData6; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData7; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData8; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData9; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData10; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData11; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData12; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData13; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData14; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData15; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData16; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData17; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData18; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData19; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData20; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData21; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData22; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData23; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData24; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData25; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData26; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData27; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData28; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData29; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData30; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData31; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData32; <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> set(uint x) public { <span class="hljs-attribute"><span class="hljs-attribute">storedData1</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData2</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData3</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData4</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData5</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData6</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData7</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData8</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData9</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData10</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData11</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData12</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData13</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData14</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData15</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData16</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData17</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData18</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData19</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData20</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData21</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData22</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData23</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData24</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData25</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData26</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData27</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData28</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData29</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData30</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData31</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData32</span></span> = x; } <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> get() public view returns (uint) { <span class="hljs-attribute"><span class="hljs-attribute">return</span></span> storedData1; } }</code> </pre> <br><br></div></div><br>  2. contrato con 32 variables uint8 <br><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_32x_uint8.sol</b> <div class="spoiler_text"><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">pragma</span></span> solidity<span class="hljs-regexp"><span class="hljs-regexp"> ^0.4.0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">contract</span></span> SimpleStorage { <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData1; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData2; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData3; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData4; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData5; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData6; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData7; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData8; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData9; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData10; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData11; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData12; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData13; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData14; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData15; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData16; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData17; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData18; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData19; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData20; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData21; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData22; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData23; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData24; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData25; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData26; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData27; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData28; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData29; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData30; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData31; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData32; <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> set(uint8 x) public { <span class="hljs-attribute"><span class="hljs-attribute">storedData1</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData2</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData3</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData4</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData5</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData6</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData7</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData8</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData9</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData10</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData11</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData12</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData13</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData14</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData15</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData16</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData17</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData18</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData19</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData20</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData21</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData22</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData23</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData24</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData25</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData26</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData27</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData28</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData29</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData30</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData31</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData32</span></span> = x; } <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> get() public view returns (uint) { <span class="hljs-attribute"><span class="hljs-attribute">return</span></span> storedData1; } }</code> </pre> <br><br></div></div><br>  La implementaci√≥n del primer contrato (32 uint256) costar√° menos, solo 89941 de gas, pero .set () ser√° mucho m√°s costoso ya que  Ocupar√° 256 ranuras de almacenamiento, lo que costar√° 640,639 de gas por cada llamada.  El segundo contrato (32 uint8) ser√° dos veces y media m√°s costoso cuando se implemente (221663 gas), pero cada llamada al m√©todo .set () ser√° mucho m√°s barata, porque  cambia solo una celda de la etapa (185291 gas). <br><br><h2>  ¬øDeber√≠a aplicarse tal optimizaci√≥n? </h2><br>  La importancia del efecto de la optimizaci√≥n de tipo es un punto discutible.  Como puede ver, incluso para un caso sint√©tico especialmente seleccionado, <b>no</b> obtuvimos m√∫ltiples diferencias.  La elecci√≥n de usar uint8 o uint256 es m√°s bien una ilustraci√≥n del hecho de que la optimizaci√≥n debe aplicarse de manera significativa (con una comprensi√≥n de las herramientas, la creaci√≥n de perfiles) o no pensar en absoluto.  Aqu√≠ hay algunas pautas generales: <br><br><ul><li>  si el contrato contiene muchos n√∫meros peque√±os o estructuras compactas en el repositorio, puede pensar en la optimizaci√≥n; </li><li>  si usa el tipo "abreviado", recuerde las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">vulnerabilidades de exceso / disminuci√≥n de flujo</a> ; </li><li>  para variables de memoria y argumentos de funci√≥n que no est√°n escritos en el repositorio, siempre es mejor usar el tipo nativo uint256 (o su alias uint).  Por ejemplo, no tiene sentido establecer el iterador de la lista en uint8, solo perder; </li><li>  El <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">orden de las variables en el contrato</a> es de gran importancia para el embalaje correcto en las ranuras de almacenamiento para el compilador. </li></ul><br><h2>  Referencias </h2><br>  Terminar√© con consejos que no tienen contraindicaciones: experimente con herramientas de desarrollo, conozca las especificaciones del lenguaje, la biblioteca y los marcos.  Aqu√≠ est√°n los enlaces m√°s √∫tiles, en mi opini√≥n, para comenzar a aprender sobre la plataforma Ethereum: <br><br><ul><li>  El entorno de desarrollo de contratos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Remix</a> es un IDE muy funcional basado en navegador; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La especificaci√≥n del lenguaje Solidity</a> , el enlace ir√° espec√≠ficamente a la secci√≥n sobre Dise√±o de variables de estado; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Un repositorio de</a> contratos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">muy interesante</a> del famoso equipo OpenZeppelin.  Ejemplos de la implementaci√≥n de tokens, contratos de venta masiva, y lo m√°s importante: la biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SafeMath</a> , la que ayuda a trabajar de forma segura con los tipos; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ethereum Yellow Paper</a> , especificaci√≥n formal de la m√°quina virtual Ethereum; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ethereum White Paper</a> , la especificaci√≥n de la plataforma Ethereum, un documento m√°s general y de alto nivel con una gran cantidad de enlaces; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ethereum en 25 minutos</a> , una breve pero t√©cnica introducci√≥n a Ethereum del creador de la plataforma, Vitalik Buterin; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Etherscan blockchain explorer</a> , una ventana al mundo real de ether, un navegador de bloques, transacciones, tokens, contratos en la red principal.  En Etherscan encontrar√° un explorador para las redes de prueba Rinkeby, Ropsten, Kovan (redes con transmisi√≥n gratuita, basadas en diferentes protocolos de consenso). </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es415791/">https://habr.com/ru/post/es415791/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es415779/index.html">Implementaci√≥n de una plataforma segura de software NAS</a></li>
<li><a href="../es415781/index.html">¬øPor qu√© los f√≠sicos piensan que la teor√≠a de cuerdas puede llegar a ser "la teor√≠a de todo"?</a></li>
<li><a href="../es415783/index.html">Los discos estelares nos revelan los secretos de la aparici√≥n de planetas</a></li>
<li><a href="../es415785/index.html">SpaceX env√≠a robot de inteligencia artificial a ISS</a></li>
<li><a href="../es415789/index.html">Algoritmos de patentes para programas de computadora</a></li>
<li><a href="../es415793/index.html">Gu√≠a completa de pedidos pendientes de dominio</a></li>
<li><a href="../es415795/index.html">Escribir una interfaz de usuario de Snapchat en Swift</a></li>
<li><a href="../es415797/index.html">Expresiones regulares + programaci√≥n l√≥gica. Cual es el resultado?</a></li>
<li><a href="../es415801/index.html">Google: nuestra IA de "tel√©fono" no es lo suficientemente buena como para ser peligrosa</a></li>
<li><a href="../es415805/index.html">Modificaci√≥n del m√≥dulo de barrera GSM Doorhan para control de Internet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>