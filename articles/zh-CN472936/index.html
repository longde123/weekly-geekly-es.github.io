<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍🌾 👎 👉🏼 操作TA505：对网络基础结构进行分组。 第三部分 👨🏾‍💼 ♉️ 👩🏻‍🌾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="网络基础结构分析在恶意活动研究中起着重要作用。 有关在各个时间间隔上与域名对应的IP地址的信息，您可以识别新的攻击者服务器。 解决相反的问题（追溯到解析为给定IP地址的域）将提供新的域，您可以针对其重复搜索过程，从而使链条越来越远。 获得的所有信息有助于了解节点的地理位置，突出显示“最喜欢的”托管人...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>操作TA505：对网络基础结构进行分组。 第三部分</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/472936/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/62a/aa0/0c2/62aaa00c24efe0e4797c29ebcff2e241.jpg" alt="图片"></a> <br><br> 网络基础结构分析在恶意活动研究中起着重要作用。 有关在各个时间间隔上与域名对应的IP地址的信息，您可以识别新的攻击者服务器。 解决相反的问题（追溯到解析为给定IP地址的域）将提供新的域，您可以针对其重复搜索过程，从而使链条越来越远。 获得的所有信息有助于了解节点的地理位置，突出显示“最喜欢的”托管人和注册商，并记下攻击者在注册下一个域时指示的字段的特征值。 <br><br> 乍一看，几天，几周甚至几个月后，无用的元信息就会派上用场。 确实，在进行恶意软件分析的过程中，迟早会出现归因问题，即一种工具属于一个或另一个犯罪集团的归属：这里所有间接的迹象都可以提供帮助，包括有关网络指标的数据。 <br><br> 在本文中，我们将研究TA505网络基础设施的最典型特征，并展示与另一个黑客组织Buhtrap的交集。 <a name="habracut"></a><br><br><h2> 域名注册商 </h2><br> 我们总共分析了该组的372个域，并确定了22个提供域名获取服务的组织。 攻击者最感兴趣的是以下资源： <br><br><ul><li>  WhoisGuard，Inc.  -28个域名， </li><li> 时代国际有限公司-26个域名。 </li></ul><br> 巴拿马组织<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WhoisGuard</a>提供了一个向公众隐藏其注册数据的机会。 这<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">绝不</a>是使用该公司服务匿名化调查并使调查复杂化的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第一种情况</a> 。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8cf/c1b/bd9/8cfc1bbd9346e5e8b9b23f3008b525d7.jpg" alt="图片"><br><br>  <i>该组的恶意软件家族分发使用WhoisGuard服务注册的TA505域</i> <br><br> 此外，我们发现使用了其他类似服务-PROTECTSERVICE，LTD，Whois隐私保护基金会，Domains by Proxy，LLC-但程度较小。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">时代国际有限公司</a>是香港最大的注册商之一。 值得注意的是，在向该提供商注册大多数域时，攻击者使用了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">动态DNS-</a>结果，域名解析到的IP地址经常更改，从而很难找到进一步的踪迹。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8a/ca5/b7c/e8aca5b7c0b10afc53b893afb74a92e3.jpg" alt="图片"><br><br>  <i>该组的恶意软件家族使用Eranet International Limited服务注册的TA505域的分布</i> <br><br><h2> 域名注册人 </h2><br> 在某些情况下，在研究WHOIS域名信息期间，有可能获得某些字段的唯一值。 <br><br>  TA505组域名WHOIS信息： <br><br><img src="https://habrastorage.org/webt/fl/lx/ar/fllxarhuijeyaveiyb_gzzqzgfm.png"><br><br> 当然，并非所有领域都可以被盲目信任。 但是，其中一些值可以提供有趣的信息。 例如，通过电子邮件<b>ctouma2@gmail.com，</b>您可以转到已注册为相同值<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的</a>其他域的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">列表</a> 。 另一个邮箱<b>0141.koppe.pan@gmail.com</b>可以提供许多不同的资源： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Github</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Steam</a> ，日本黑客论坛<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Qiita</a>上的帐户，以及指向个人资料中恶意域的链接， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">YouTube频道</a> ，Skype帐户（实时：141.koppe。锅）等 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8c7/9ba/a39/8c79baa39e2887fcb36bf43ea842c1a2.jpg" alt="图片"><br><br>  <i>Qiita黑客论坛上的可疑域名注册人页面</i> <br><br> 我们将不对本文的范围进行深入的WHOIS数据分析。 我们仅注意到，攻击者通常在第一阶段就利用被入侵的合法资源来托管恶意软件。 以下是此类域的示例： <br><br><ul><li>  greenthumbsup [。] jp </li><li>  fakers.co [。] jp </li><li>  nanepashemet [。] com </li><li>  nagomi-753 [。] jp </li><li>  iluj [。]在 </li></ul><br><h2> 自治系统（AS） </h2><br> 为了完整起见，我们给出了自治系统（AS）的顶部，该自治系统拥有管理服务器的IP地址。 当然，一个自治系统具有许多主机：合法主机和不合法主机，包括起源非常不同的各种恶意软件家族。 以下统计信息应理解为攻击者偏好的特征。 连同其他事实一起，归因可能很重要。 <br><br>  TA505组经常使用的自治系统： <br><br><img src="https://habrastorage.org/webt/qw/l6/5y/qwl65ykvpoanzfvn4siffg0uzem.png"><br><br><h2> 与布哈特集团交汇 </h2><br> 在2019年7月11日，我们的ESET同事发表<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了一篇</a>有关Buhtrap组最近在Win32k Windows组件中使用零日漏洞的攻击<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的文章</a> 。 所描述的模块之一是所谓的抓取器模块，用于从电子邮件客户端，浏览器等中窃取用户密码。一段时间之后，我们发现了与所描述的模块（MD5：c6e9d7280f77977a6968722e8124f51c）类似的模块，其主体具有相同的管理服务器（redmond.corp-微软[。] com）。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b1d/2a8/537/b1d2a8537215501e256a0af7a0614ecb.jpg" alt="图片"><br><br>  <i>在Buhtrap采集器模块中管理服务器</i> <br><br> 根据<a href="">PaSiveTotal</a>资源，此主机将从2019年6月6日起解析为IP地址95 [。] 179.159.170。 <br><br> 不久之前，2019年7月2日，我们来自Proofpoint的同事<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">宣布了</a>新的TA505工具，其中一种叫做Andromut（也<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">称为</a> Gelup），是FlawedAmmyy RAT引导程序。 我们遇到的一种引导加载程序变体（MD5：0cbeb424d96e5c268ec2525d603f64eb）使用compatexchange-cloudapp [。] Net域作为管理服务器。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6cb/414/26a/6cb41426af25ba135796772487c350ac.jpg" alt="图片"><br><br>  <i>解密后来自TA505的Gelup管理服务器</i> <br><br> 根据PaSiveTotal资源，此主机将从2019年6月8日起解析为IP地址95 [。] 179.159.170。 <br><br> 两个域都向同一注册商（Tucows Domains Inc.）注册，相差两天，解析为同一IP地址。 考虑到这两个组织都在6月进行了定期攻击，因此我们得出结论，Buhtrap和TA505使用共同的主机作为管理服务器。 <br><br> 我们还添加了域compatexchange-cloudapp [。] Net不仅在上面的引导程序中使用，还在旧版的Buhtrap组件中使用。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/232/bf8/cd3/232bf8cd3aade1f7bc858671124e3536.jpg" alt="图片"><br><br>  <i>TA505和Buhtrap在基础设施中的第一个交叉点</i> <br><br> 一段时间后，我们遇到了另一个类似的交叉点：这次，来自Buhtrap的另一个采集卡的域和来自TA505的Smoke Loader的域以相同的方式相遇：域test-service012505 [。] Com Smoke Loader（MD5：5fc6f24d43bc7ca45a81d159291955d1）和安全遥测[。从2019年7月17日到16日的网络抓取器（MD5：79d1a836423c7ee57b6127cf2930a9d9）分别解析为IP地址194 [。] 4.56.252。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/19c/d1f/e23/19cd1fe236f22164d0b33d0af9a0e851.jpg" alt="图片"><br><br>  <i>TA505和Buhtrap在基础设施中的第二个交汇点</i> <br><br><h2> 结论 </h2><br> 我们熟悉TA505组的网络基础结构的功能。 我们检查了管理服务器的域名注册商和托管人的特征。 我们注意到域名注册过程中指定的客户信息的奇怪功能； 这可以作为更详细研究的起点。 我们检查了TA505和Buhtrap组之间的基础设施交叉点。 共享服务器的情况可以用不同的方式解释：组可以通过协议共享服务器； 组可以有一个单独的管理实体来协调其行为； 两组都可以从第三方租用服务器（从而节省了资源）。 我们将继续监视这两个团体的活动，并寻找有关他们可能的联系和联合活动的新信息。 <br><br>  <b>作者</b> ：积极技术公司的Alexey Vishnyakov和Maxim Anfinogenov <br><br><div class="spoiler">  <b class="spoiler_title">国际奥委会</b> <div class="spoiler_text">  TA505 C2： <br>  0141koppepan [。] Com <br>  bigpresense [。]顶部 <br>  last [。] pw <br>  fakers.co [。] jp <br>  greenthumbsup [。] jp <br>  iluj [。]在 <br> 肯托纳[。] su <br>  koppepan [。]应用 <br>  makosoft [。] hu <br>  microsoftsyncservice [。] biz <br>  nagomi-753 [。] jp <br>  nanepashemet [。] com <br>  newfolder2-service [。]空间 <br>  office365onlinehome [。] com <br>  solsin [。]顶部 <br>  test-service012505 [。] com <br>  Windows的几个更新[。] COM <br>  windows-update-02-zh [。] com <br>  c6e9d7280f77977a6968722e8124f51c-Buhtrap采集卡模块 <br>  redmond.corp-microsoft [。] com-Grabber C＆C <br>  0cbeb424d96e5c268ec2525d603f64eb-TA505的Gelup下载器 <br>  compatexchange-cloudapp [。]网络-Gelup C＆C <br>  95.179.159 [。] 170-TA505和Buhtrap共享主机 <br>  79d1a836423c7ee57b6127cf2930a9d9-Buhtrap采集卡模块 <br> 安全遥测[。]网-Grabber C＆C <br>  5fc6f24d43bc7ca45a81d159291955d1-TA505的烟雾加载器下载器 <br>  test-service012505 [。] com-烟雾装载器C＆C <br>  194 [。] 4.56.252-TA505和Buhtrap共享主机 </div></div><br><h3> 该系列中的先前文章： </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">TA505行动：我们如何分析Trojan Dridex，Locky勒索软件和Neutrino僵尸网络创建者的新工具</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">操作TA505，第二部分：使用NetSupport RAT学习ServHelper后门</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN472936/">https://habr.com/ru/post/zh-CN472936/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN472922/index.html">防御者程序员胜于熵</a></li>
<li><a href="../zh-CN472926/index.html">加速收益定律（第1部分）</a></li>
<li><a href="../zh-CN472930/index.html">硅谷天体物理学家量化时尚</a></li>
<li><a href="../zh-CN472932/index.html">IntelliJ IDEA静态分析与人的思想</a></li>
<li><a href="../zh-CN472934/index.html">什么是零信任？ 安全模式</a></li>
<li><a href="../zh-CN472940/index.html">关于骗子和人</a></li>
<li><a href="../zh-CN472946/index.html">一个好的开发者是明智的，不是聪明的</a></li>
<li><a href="../zh-CN472950/index.html">保护IT初创企业知识产权的10种方法</a></li>
<li><a href="../zh-CN472954/index.html">甘特图vs看板板</a></li>
<li><a href="../zh-CN472956/index.html">履带式机器人的建造历史</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>