<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸš® ğŸ‘©ğŸ¿ ğŸ˜† Pemecahan masalah dengan pwnable.kr 24 - login sederhana. Hamparan bingkai tumpukan ğŸ¤µğŸ½ ğŸ§›ğŸ¾ ğŸ§‘ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada artikel ini, kita akan menyelesaikan tugas ke-24 dari situs pwnable.kr dan belajar tentang menumpuk bingkai tumpukan. 

 Informasi Organisasi  Te...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pemecahan masalah dengan pwnable.kr 24 - login sederhana. Hamparan bingkai tumpukan</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468761/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="gambar"></div><br>  Pada artikel ini, kita akan menyelesaikan tugas ke-24 dari situs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pwnable.kr</a> dan belajar tentang menumpuk bingkai tumpukan. <br><br><div class="spoiler">  <b class="spoiler_title">Informasi Organisasi</b> <div class="spoiler_text">  Terutama bagi mereka yang ingin mempelajari sesuatu yang baru dan berkembang di bidang informasi dan keamanan komputer, saya akan menulis dan berbicara tentang kategori berikut: <br><br><ul><li>  PWN; </li><li>  kriptografi (Crypto); </li><li>  teknologi jaringan (Jaringan); </li><li>  membalikkan (Reverse Engineering); </li><li>  steganografi (Stegano); </li><li>  pencarian dan eksploitasi kerentanan WEB. </li></ul><br>  Selain itu, saya akan membagikan pengalaman saya dalam forensik komputer, analisis malware dan firmware, serangan pada jaringan nirkabel dan jaringan area lokal, melakukan pentest dan menulis eksploitasi. <br><a name="habracut"></a><br>  Agar Anda dapat mengetahui tentang artikel baru, perangkat lunak, dan informasi lainnya, saya membuat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saluran di Telegram</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">grup untuk membahas masalah apa pun</a> di bidang ICD.  Juga, saya pribadi akan mempertimbangkan permintaan pribadi Anda, pertanyaan, saran dan rekomendasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">secara pribadi dan akan menjawab semua orang</a> . <br><cut></cut><br>  Semua informasi disediakan hanya untuk tujuan pendidikan.  Penulis dokumen ini tidak bertanggung jawab atas kerusakan yang disebabkan seseorang sebagai akibat dari menggunakan pengetahuan dan metode yang diperoleh sebagai hasil dari mempelajari dokumen ini. <br></div></div><br><h2>  Solusi pekerjaan login sederhana </h2><br>  Kami melanjutkan bagian kedua.  Saya akan segera mengatakan bahwa ini lebih sulit daripada yang pertama dan kami tidak diberi kode sumber aplikasi.  Jangan lupakan pembahasannya di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .  Mari kita mulai. <br><br>  Klik pada ikon dengan tanda masuk sederhana tanda tangan.  Kami diberi alamat dan port untuk menghubungkan dan program itu sendiri. <br><br><img src="https://habrastorage.org/webt/1g/5k/y3/1g5ky3q7oclvpdrkmbmuoojfew0.png" alt="gambar"><br><br>  Unduh semua yang mereka berikan kepada kami, periksa binernya. <br><br><img src="https://habrastorage.org/webt/d4/ik/ay/d4ikay9hapwq7e8dofp4upu7xuw.png" alt="gambar"><br><br>  Ini adalah elf 32-bit dengan canary yang terpasang dan stack yang tidak dapat dieksekusi.  Kami mendekompilasi dalam IDA Pro. <br><br><img src="https://habrastorage.org/webt/z8/9y/3t/z89y3thmraeji37baleexeeo7ne.png" alt="gambar"><br><br>  Dalam program ini, data pengguna diterjemahkan dari base64.  Variabel v7 menyimpan panjang string yang diterjemahkan.  Selanjutnya, v7 dibandingkan dengan 12. Jika tes dilewatkan, string yang didekodekan disalin ke variabel input, dan kemudian fungsi auth dipanggil, ke mana panjang string yang didekodekan dilewatkan sebagai parameter.  Dan jika kita melewati otentikasi, fungsi yang benar dipanggil.  Mari kita lihat fungsi auth. <br><br><img src="https://habrastorage.org/webt/zt/kq/uh/ztkquhhsdyvhddmp6shn1hdunik.png" alt="gambar"><br><br>  Sepertinya buffer overflow.  Lihatlah tumpukan itu. <br><br><img src="https://habrastorage.org/webt/zw/6r/cd/zw6rcd0n-nswgdojdpo1qnbgjrg.png" alt="gambar"><br><br>  Tidak.  Kami tidak dapat meluap buffer, karena ini membutuhkan lebih dari 12 byte.  Alamat tempat nilai variabel disimpan menarik, terutama variabel v4 yang melakukan penyalinan. <br><br><img src="https://habrastorage.org/webt/yf/r1/i0/yfr1i0s9vbec-3wrrkzibmcxrio.png" alt="gambar"><br><br>  Ini adalah alamat [ESP + 32].  Lihatlah kode untuk ini dalam bentuk dibongkar. <br><br><img src="https://habrastorage.org/webt/ca/gq/kl/cagqkltbv-hsu6anyeqqgfqy7b0.png" alt="gambar"><br><br>  Instruksi berikut diperlukan untuk menyimpan bingkai tumpukan. <br> <code>push ebp <br> mov ebp, esp</code> <br>  Untuk mengembalikan tumpukan, gunakan pernyataan cuti.  Yang kami lakukan operasi terbalik. <br><br><img src="https://habrastorage.org/webt/pb/tq/l1/pbtql14yyojqyn1_hd7eshfzgl0.png" alt="gambar"><br><br>  Yang paling menarik adalah instruksi ketiga <code>sub esp, 28h</code> . <br><br>  Jadi, tumpang tindih terjadi: esp berkurang sebesar 40, dan variabel v2 terletak di esp + 32 dan membutuhkan 12 byte.  Yaitu, setelah memindahkan nilai dari esp ke ebp, alamat empat byte terakhir dari variabel v2 akan disimpan dalam ebp.  Ketika instruksi meninggalkan dan retn dieksekusi, empat byte terakhir dari variabel v2 sekarang akan berada di bingkai tinggi stack. <br><br>  Mari kita periksa dan berikan baris input QUFBQUFBQUFCQkJC. <br><br><img src="https://habrastorage.org/webt/mz/cx/0v/mzcx0vt54mbmppksh9q1j4yeg-s.png" alt="gambar"><br><br>  Jika asumsi kami benar, maka setelah menjalankan retn dalam fungsi auth, bagian atas tumpukan akan menjadi alamat "BBBB". <br><br><img src="https://habrastorage.org/webt/px/-n/tj/px-ntjgjb6pvnbtpxgofh-cwf78.png" alt="gambar"><br><br>  Sekarang jalankan cuti. <br><br><img src="https://habrastorage.org/webt/fs/pl/kv/fsplkvdn9spk6zbi6laol6fkb5g.png" alt="gambar"><br><br>  Ada "BBBB" di EBP dan sekarang setelah mengeksekusi cuti di fungsi utama, program akan macet.  Dengan demikian, kita bisa di depan alamat bagian atas tumpukan di mana alamat yang ingin kita tuju akan ditemukan.  Maka bebannya akan seperti ini: 4 byte + alamat di mana kita pergi + alamat ke awal beban. <br><br>  Pertama, tulis templat. <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> base64 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * r = remote(<span class="hljs-string"><span class="hljs-string">'pwnable.kr'</span></span>, <span class="hljs-number"><span class="hljs-number">9003</span></span>) r.recv() r.interactive()</code> </pre> <br>  Sekarang kita mencari tahu alamat yang ingin kita tuju - ini adalah 0x8049284 di dalam fungsi yang benar. <br><br><img src="https://habrastorage.org/webt/gz/y_/qk/gzy_qktjqg7ewvanmiugy1kqmd4.png" alt="gambar"><br><br>  Alamat ini akan menjadi bagian kedua dari beban kami.  Bagian ketiga dari beban akan menjadi alamat variabel input (alamat beban). <br><br><img src="https://habrastorage.org/webt/sg/xt/v-/sgxtv-dqhi1eldkfupoizg3mje8.png" alt="gambar"><br><br>  Kami menyusun beban dalam kode.  Jangan lupa untuk menyandikan di base64: <br><pre> <code class="python hljs">payload = <span class="hljs-string"><span class="hljs-string">"A"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span> + p32(<span class="hljs-number"><span class="hljs-number">0x8049284</span></span>) + p32(<span class="hljs-number"><span class="hljs-number">0x811EB40</span></span>) payload = b64encode(payload)</code> </pre><br>  Kode lengkap. <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> base64 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * r = remote(<span class="hljs-string"><span class="hljs-string">'pwnable.kr'</span></span>, <span class="hljs-number"><span class="hljs-number">9003</span></span>) r.recv() payload = <span class="hljs-string"><span class="hljs-string">"A"</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span> + p32(<span class="hljs-number"><span class="hljs-number">0x8049284</span></span>) + p32(<span class="hljs-number"><span class="hljs-number">0x811EB40</span></span>) payload = b64encode(payload) r.send(payload+<span class="hljs-string"><span class="hljs-string">"\n"</span></span>) r.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/ge/ey/wy/geeywypjyxqnqsi_lfbb7sfbn7i.png" alt="gambar"><br><br>  Dan dapatkan poin Anda.  Jujur saja, tugas ini tidak mudah bagi saya. <br><br><img src="https://habrastorage.org/webt/ey/uc/i8/eyuci8f_4bpue1yyfbwwlqk0eks.png" alt="gambar"><br><br>  Dan kami melanjutkan: di artikel berikutnya - forensik.  Anda dapat bergabung dengan kami di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Telegram</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id468761/">https://habr.com/ru/post/id468761/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id468747/index.html">Bagaimana saya menghabiskan musim panas di VK</a></li>
<li><a href="../id468749/index.html">Acara Android LiveData</a></li>
<li><a href="../id468753/index.html">Buta warna - teman laki-laki (Departemen Kesehatan tidak benar)</a></li>
<li><a href="../id468757/index.html">Koneksi MySQL setelah kesalahan 1040: terlalu banyak koneksi</a></li>
<li><a href="../id468759/index.html">Tentang [[trivial_abi]] di Dentang</a></li>
<li><a href="../id468765/index.html">Pentingnya mengkonfirmasi perintah kontrol menggunakan Delimobile sebagai contoh</a></li>
<li><a href="../id468767/index.html">Mainan kayu, bagian dua - 1986-1988</a></li>
<li><a href="../id468769/index.html">Xavier Noria on Rails 6, konsultasi dan banyak lagi</a></li>
<li><a href="../id468773/index.html">Perusahaan energi India NTPC akan membangun taman tenaga surya 5.000 megawatt</a></li>
<li><a href="../id468775/index.html">Supremasi AI: Catur Leela. Atau tentang bagaimana jaringan saraf terbuka sepenuhnya menang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>