<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßóüèæ üö∫ üë®üèæ‚Äçü§ù‚Äçüë®üèΩ Dijkstra pour le temps lin√©aire üßï ü§∏üèº ü§ΩüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salutations √† tous, et particuli√®rement √† ceux qui s'int√©ressent aux math√©matiques discr√®tes et √† la th√©orie des graphes. 
 Contexte 


 Il se trouve ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dijkstra pour le temps lin√©aire</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416195/"><p>  Salutations √† tous, et particuli√®rement √† ceux qui s'int√©ressent aux math√©matiques discr√®tes et √† la th√©orie des graphes. </p><br><h3 id="predystoriya">  Contexte </h3><br><p>  Il se trouve que, pouss√© par l'int√©r√™t, je d√©veloppais un service de construction de circuits.  itin√©raires.  La t√¢che consistait √† planifier les meilleurs itin√©raires en fonction de la ville d'int√©r√™t pour l'utilisateur, des cat√©gories d'√©tablissements et du calendrier.  Eh bien, l'une des sous-t√¢ches consistait √† calculer le temps de trajet d'une institution √† l'autre.  Depuis que j'√©tais jeune et stupide, j'ai r√©solu ce probl√®me de front, avec l'algorithme de Dijkstra, mais en toute honn√™tet√©, il convient de noter que seulement avec lui, il √©tait possible de d√©marrer l'it√©ration d'un n≈ìud √† des milliers d'autres, la mise en cache de ces distances n'√©tait pas une option, les √©tablissements de plus de 10k seulement dans Moscou seule, et des d√©cisions comme la distance de Manhattan dans nos villes ne fonctionnent pas du tout. </p><a name="habracut"></a><br><p>  Il s'est donc av√©r√© qu'il √©tait possible de r√©soudre le probl√®me de performances dans le probl√®me de la combinatoire, mais la plupart du temps pour traiter la demande √©tait consacr√©e √† la recherche de chemins non mis en cache.  Le probl√®me a √©t√© compliqu√© par le fait que le graphique routier Osm √† Moscou est assez grand (un demi-million de n≈ìuds et 1,1 million d'arcs). </p><br><p>  Je ne parlerai pas de toutes les tentatives et qu'en fait le probl√®me pourrait √™tre r√©solu en coupant les arcs suppl√©mentaires du graphique, je vais seulement vous dire qu'√† un moment donn√© il m'est apparu et j'ai r√©alis√© que si vous approchez l'algorithme de Dijkstra du point de vue de l'approche probabiliste, il peut √™tre lin√©aire. </p><cut></cut><br><h3 id="deykstra-za-logarifmicheskoe-vremya">  Dijkstra pour le temps logarithmique </h3><br><p>  Tout le monde sait, mais qui sait, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lisez</a> que l'algorithme de Dijkstra en utilisant une file d'attente avec la complexit√© logarithmique d'insertion et de suppression peut conduire √† une complexit√© de la forme O (n <em>log (n) + m</em> log (n)).  Lorsque vous utilisez le tas de Fibonacci, la complexit√© peut √™tre r√©duite √† O (n * log (n) + m), mais toujours pas lin√©aire, mais je voudrais. </p><br><p>  Dans le cas g√©n√©ral, l'algorithme de file d'attente est d√©crit comme suit: </p><br><p>  Soit: </p><br><ul><li>  V est l'ensemble des sommets du graphe </li><li>  E est l'ensemble des bords du graphe </li><li>  w [i, j] est le poids du bord du n≈ìud i au n≈ìud j </li><li>  a - d√©but du sommet de la recherche </li><li>  file d'attente q-vertex </li><li>  d [i] - distance jusqu'au i-√®me n≈ìud </li><li>  d [a] = 0, pour tous les autres d [i] = + inf </li></ul><br><p>  Alors que q n'est pas vide: </p><br><ul><li>  v est le sommet avec le minimum d [v] de q </li><li>  Pour tous les sommets u pour lesquels il existe une transition vers E √† partir du sommet v <br><ul><li>  si d [u]&gt; w [vu] + d [v] <br><ul><li>  supprimer u de q avec la distance d [u] </li><li>  d [u] = w [vu] + d [v] </li><li>  ajouter u √† q avec la distance d [u] </li></ul></li></ul></li><li>  supprimer v de q </li></ul><br><p>  Si la file d' attente d'utiliser un arbre rouge-noir, o√π l' insertion et le retrait se produisent dans un journal (n), et la recherche de l'√©l√©ment minimum de m√™me pour log (n), la complexit√© de l'algorithme sera <em>O (n log (n) +</em> log m (n)) . </p><br><p>  Et ici, il convient de noter une caract√©ristique importante: rien n'emp√™che, en th√©orie, de consid√©rer le sommet plusieurs fois.  Si le sommet a √©t√© examin√© et que la distance jusqu'√† celui-ci a √©t√© mise √† jour √† une valeur incorrecte, sup√©rieure √† la valeur r√©elle, alors, √† condition que t√¥t ou tard le syst√®me converge et que la distance jusqu'√† u soit mise √† jour √† la valeur correcte, il est permis de faire de telles astuces.  Mais il convient de noter - un sommet doit √™tre consid√©r√© plus d'une fois avec une faible probabilit√©. </p><br><h3 id="sortiruyuschaya-hesh-tablica">  Trier la table de hachage </h3><br><p>  Pour r√©duire le temps d'ex√©cution de l'algorithme de Dijkstra √† un lin√©aire, une structure de donn√©es est propos√©e, qui est une table de hachage avec des num√©ros de noeud (node_id) comme valeurs.  Je note que le besoin du tableau d ne dispara√Æt pas, il est toujours n√©cessaire d'obtenir la distance au i√®me n≈ìud en temps constant. </p><br><p>  La figure ci-dessous montre un exemple de la structure propos√©e. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f4b/d73/9ee/f4bd739ee96f2b4a49e92e989642eccf.png" alt="image"></p><br><p>  D√©crivons par √©tapes la structure de donn√©es propos√©e: </p><br><ul><li>  le n≈ìud u est √©crit dans la cellule avec un nombre √©gal √† d [u] // bucket_size, o√π bucket_size est la puissance de la cellule (par exemple, 20 m√®tres, c'est-√†-dire que la cellule au num√©ro 0 contiendra des n≈ìuds dont la distance sera comprise entre [0, 20) m√®tres ) </li><li>  le dernier n≈ìud de la premi√®re cellule non vide, c'est-√†-dire  l'op√©ration d'extraction de l'√©l√©ment minimum sera effectu√©e dans O (1).  Il est n√©cessaire de conserver l'√©tat actuel de l'identifiant du num√©ro de la premi√®re cellule non vide (min_el). </li><li>  l'op√©ration d'insertion est effectu√©e en ajoutant un nouveau num√©ro de n≈ìud √† la fin de la cellule et en ex√©cutant √©galement O (1), car  le calcul du nombre de cellules s'effectue en un temps constant. </li><li>  l'op√©ration de suppression, comme dans le cas d'une table de hachage, une √©num√©ration normale est possible, et on pourrait faire une hypoth√®se et dire qu'avec une petite taille de cellule, c'est aussi O (1).  Si cela ne vous d√©range pas la m√©moire (en principe, et il ne faut pas beaucoup, un autre tableau par n), alors vous pouvez cr√©er un tableau de positions dans la cellule.  Dans ce cas, si l'√©l√©ment est supprim√© au milieu de la cellule, il est n√©cessaire de d√©placer la derni√®re valeur de la cellule vers l'emplacement supprim√©. </li><li>  un point important lors du choix de l'√©l√©ment minimum: il n'est minimal qu'avec une certaine probabilit√©, mais l'algorithme examinera la cellule min_el jusqu'√† ce qu'elle devienne vide et t√¥t ou tard l'√©l√©ment r√©el minimum sera pris en compte, et si nous avons accidentellement mis √† jour la valeur de la distance au n≈ìud accessible √† partir de minimum, alors les n≈ìuds adjacents au minimum peuvent √† nouveau √™tre dans la file d'attente et la distance √† eux sera correcte, etc. </li><li>  Vous pouvez √©galement supprimer des cellules vides jusqu'√† min_el, √©conomisant ainsi de la m√©moire.  Dans ce cas, la suppression du n≈ìud v de la file d'attente q ne doit √™tre effectu√©e qu'apr√®s avoir consid√©r√© tous les n≈ìuds adjacents. </li><li>  et vous pouvez √©galement modifier la puissance des cellules, les param√®tres pour augmenter la taille des cellules et le nombre de cellules lorsque vous devez augmenter la taille de la table de hachage. </li></ul><br><h3 id="rezultaty-zamerov">  R√©sultats de mesure </h3><br><p>  Des contr√¥les ont √©t√© effectu√©s sur la carte osm de Moscou, d√©charg√©s via osm2po en postgres, puis charg√©s en m√©moire.  Les tests ont √©t√© √©crits en Java.  Il y avait 3 versions du graphique: </p><br><ul><li>  graphique source - 0,43 million de n≈ìuds, 1,14 million d'arcs </li><li>  version compress√©e du graphique avec 173 000 n≈ìuds et 750 000 arcs </li><li>  version pi√©tonne de la version compress√©e du graphique, 450k arcs, 100k n≈ìuds. </li></ul><br><p>  Voici une image avec des mesures sur diff√©rentes versions du graphique: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f64/fa3/205/f64fa3205f438f9345918aa76393055a.png" alt="image"></p><br><p>  Consid√©rez la d√©pendance de la probabilit√© de revoir le sommet et la taille du graphique: </p><br><table><thead><tr><th>  nombre de vues de n≈ìuds </th><th>  compter les sommets </th><th>  probabilit√© de revoir le n≈ìud </th></tr></thead><tbody><tr><td>  104915 </td><td>  100015 </td><td>  4.8 </td></tr><tr><td>  169429 </td><td>  167892 </td><td>  0,9 </td></tr><tr><td>  431490 </td><td>  419594 </td><td>  2.8 </td></tr></tbody></table><br><p>  Vous pouvez remarquer que la probabilit√© ne d√©pend pas de la taille du graphique et est plut√¥t sp√©cifique √† la demande, mais elle est petite et sa plage est configur√©e en modifiant la puissance de la cellule.  Je vous serais tr√®s reconnaissant de vous aider √† construire une modification probabiliste de l'algorithme avec des param√®tres garantissant un intervalle de confiance dans la plage dont la probabilit√© de visualisation r√©p√©t√©e ne d√©passera pas un certain pourcentage. </p><br><p>  Des mesures qualitatives ont √©galement √©t√© effectu√©es pour confirmer pratiquement la comparaison de l'exactitude du r√©sultat des algorithmes avec la nouvelle structure de donn√©es, qui a montr√© une co√Øncidence compl√®te de la longueur de chemin la plus courte de 1000 n≈ìuds al√©atoires √† 1000 autres n≈ìuds al√©atoires sur le graphique.  (et ainsi de suite 250 it√©rations) lorsque vous travaillez avec une table de hachage de tri et un arbre rouge-noir. </p><br><p>  Le code source de la structure de donn√©es propos√©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">est situ√© sur le lien</a> </p><br><p>  PS: Je connais l'algorithme Torup et le fait qu'il r√©sout le m√™me probl√®me en temps lin√©aire, mais je n'ai pas pu ma√Ætriser ce travail fondamental en une soir√©e, m√™me si j'ai compris l'id√©e en termes g√©n√©raux.  Au moins, si je comprends bien, une autre approche y est propos√©e, bas√©e sur la construction d'un arbre couvrant minimal. <br>  PSS Dans une semaine, j'essaierai de trouver l'heure et de faire une comparaison avec le bouquet Fibonacci et d'ajouter un peu plus tard le navet github avec des exemples et des codes de test. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr416195/">https://habr.com/ru/post/fr416195/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr416183/index.html">Test des donn√©es: exigences et niveaux</a></li>
<li><a href="../fr416187/index.html">Suite √† la rencontre ¬´Nouvelles fonctionnalit√©s de PostgreSQL 11¬ª (Partie 2)</a></li>
<li><a href="../fr416189/index.html">Le traitement de Scrum "m√©canique". Partie 3. Travail SM</a></li>
<li><a href="../fr416191/index.html">Impl√©mentation de bas niveau de l'arborescence des pr√©fixes trie en PHP</a></li>
<li><a href="../fr416193/index.html">Comment les robots peuvent travailler ensemble avec les humains (et non √† la place)</a></li>
<li><a href="../fr416197/index.html">Les moteurs du nouveau programme DARPA r√©ussissent les tests</a></li>
<li><a href="../fr416199/index.html">La sonde Dawn a envoy√© des photos d√©taill√©es des points blancs de Ceres: c'est du soda ordinaire</a></li>
<li><a href="../fr416201/index.html">3 super jeux de soci√©t√© de science-fiction en anglais</a></li>
<li><a href="../fr416205/index.html">Les sp√©cialistes ont contourn√© la protection des spectres dans les navigateurs populaires</a></li>
<li><a href="../fr416207/index.html">"Pas pire qu'√† Poudlard" - les futurs √©tudiants parlent d'informatique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>