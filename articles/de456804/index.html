<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôëÔ∏è üèØ üë©üèΩ‚ÄçüöÄ Folgen Sie dem Geld: Wie die RTM-Gruppe begann, die Adressen von C & C-Servern in einer Krypto-Brieftasche zu verstecken ‚ôêÔ∏è ‚òïÔ∏è üö£üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Cyberkriminelle RTM stiehlt seit 2015 Geld von Bankkunden. Die meisten Opfer sind russische Unternehmen. Von Cyberkriminellen verwendete sch√§dlich...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Folgen Sie dem Geld: Wie die RTM-Gruppe begann, die Adressen von C & C-Servern in einer Krypto-Brieftasche zu verstecken</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/bizone/blog/456804/"><p>  Die Cyberkriminelle RTM stiehlt seit 2015 Geld von Bankkunden. Die meisten Opfer sind russische Unternehmen.  Von Cyberkriminellen verwendete sch√§dliche Software wird in der Informationssicherheitsgemeinschaft h√§ufig auch als RTM bezeichnet. </p><br><p>  √úber dieses Programm wurden zahlreiche technische Berichte verfasst, in denen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der</a> allgemeine Mechanismus der Malware <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ausf√ºhrlich</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">beschrieben</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wird</a> .  In diesem Artikel konzentrieren wir uns auf Methoden zum Abrufen der Adressen der verwaltenden (C &amp; C) RTM-Server.  In jeder Iteration des Programms n√§hern sich Angreifer dieser Aufgabe erfinderisch: Sie verteilen die Adresse √ºber Blogs, verwenden das System alternativer DNS-Server und das Tor-Netzwerk.  Neulich stellten wir fest, dass RTM begann, IP in Transaktionen auf einer Bitcoin-Brieftasche zu verbergen. </p><a name="habracut"></a><br>
<h2 id="chto-takoe-rtm">  Was ist RTM? </h2><br><p>  RTM ist im Kern ein Bankentrojaner.  Das Hauptziel des Programms besteht darin, Angreifern die Manipulation von Zahlungsauftr√§gen des Opferunternehmens zu erm√∂glichen, um seine Gelder stillschweigend auf das Konto von Cyberkriminellen zu √ºberweisen. </p><br><p>  In der Regel wird RTM √ºber Mailinglisten an den Computer des Opfers gesendet, seltener √ºber gehackte Websites (z. B. Nachrichtenpublikationen) oder gef√§lschte Ressourcen f√ºr Buchhalter.  Kriminelle h√§ngen eine gepackte ausf√ºhrbare Datei an Briefe an.  Als Mittel zum Verpacken verwenden Angreifer sowohl ihre eigenen Entwicklungs- als auch selbstextrahierenden Archive. <br><br><img src="https://habrastorage.org/webt/yx/om/zt/yxomztdq36c76jqytbtszywrmb4.png"><br>  <em>Beispiele f√ºr ausf√ºhrbare EXE-Dateien, die von der RTM-Gruppe verteilt werden</em> <br><br>  Die Beispieldateien in der Abbildung sind in der Reihenfolge ihrer Verteilung angeordnet.  Die meiste Zeit wurden ausf√ºhrbare RTM-Dateien mit einem benutzerdefinierten Packer gepackt und als PDF-Dokument getarnt.  Anfang 2019 erschienen die ersten Beispiele, die ein selbstextrahierendes RAR-Archiv sind und als Datei im DOCX-Format getarnt sind.  RTM wird derzeit als selbstextrahierendes CAB-Archiv vertrieben. <br><br> <a href=""><img src="https://habrastorage.org/webt/_j/74/zf/_j74zfs8mil30ygys31kqe6s2de.png"></a> <br>  <em>Bin√§re Darstellung der Datei "Payment 11.06.exe"</em> <br><br>  Nach dem Start kopiert die ausf√ºhrbare Datei die gepackte DLL auf die Festplatte und startet sie mit dem Dienstprogramm rundll32.exe.  Der interne Name dieser Bibliothek lautet in der Regel core.dll.  Die nachfolgende Operation erfolgt im Adressraum des Prozesses rundll32.exe. </p><br><p>  Es ist core.dll, die die prim√§re Interaktion mit dem RTM-Steuerungsserver bereitstellt, √ºber die das Programm Befehle und zus√§tzliche Module von den Angreifern empf√§ngt. </p><br><p>  Die Module werden in verschl√ºsselter Form geliefert und k√∂nnen auf verschiedene Arten gestartet werden.  Mit diesen Komponenten k√∂nnen Angreifer einen kompromittierten Computer fernsteuern, Zahlungsdokumente im 1C-System ersetzen usw. </p><br><h2 id="sposoby-nahozhdeniya-upravlyayuschego-servera">  M√∂glichkeiten, einen Verwaltungsserver zu finden </h2><br><h3 id="rss">  RSS-Feed </h3><br><p>  In den ersten Versionen von RTM wurde ein RSS-Feed verwendet, um die Adressen der Steuerungsserver zu aktualisieren.  Angreifer haben in LiveJournal ein Blog erstellt, das C &amp; C-Adressen in verschl√ºsselter Form enth√§lt.  Um neue Adressen von Steuerungsservern zu erhalten, wurde eine Anfrage an die Adresse hxxps: //.livejournal [.] Com / data / rss / gesendet und die Antwort im folgenden Format verarbeitet (z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://f72bba81c921.livejournal.com/data/rss/</a> ). :: <br><br> <a href=""><img src="https://habrastorage.org/webt/5u/m4/qo/5um4qobgrnukxcybwv8rw6qext0.png"></a> <br>  <em>RSS-Feed-Inhalt.</em>  <em>Das Beschreibungsfeld enth√§lt verschl√ºsselte Adressen von Steuerungsservern</em> <br><br> <a href=""><img src="https://habrastorage.org/webt/ct/j4/gf/ctj4gfv0ynnkkehxte5aoklhzbc.png"></a> <br>  <em>Entschl√ºsselte Zeilen mit der Anfangsadresse des verwaltenden Servers und der Adresse des RSS-Feeds</em> </p><br><h3 id="bit">  .bit </h3><br><p>  Im M√§rz 2016 begann RTM, Dom√§nen in der Bit-Zone als Adressen von Steuerungsservern zu verwenden.  Sie werden von einem alternativen Namecoin-DNS-Registrar unterst√ºtzt, der auf der Blockchain-Technologie basiert.  Das System ist dezentralisiert, sodass es schwierig ist, .bit-Dom√§nen zu blockieren. </p><br><p>  Die IP-Adressen der Verwaltungsserver auf .bit RTM wurden auf zwei Arten ermittelt: </p><br><ul><li>  √ºber die Namecoin Block Browser API; </li><li>  durch Domainnamenaufl√∂sung mit speziellen DNS-Servern. </li></ul><br><p> <a href=""><img src="https://habrastorage.org/webt/ep/-s/dn/ep-sdnvmvh_kksp1y66mbzow6xm.png"></a> <br>  <em>Die Funktion zum Abrufen von IP-Adressen von Verwaltungsservern</em> <br><br>  Beim Abrufen von IP-Adressen von Steuerungsservern √ºber die Namecoin-Blockbrowser-API wird der Inhalt unter der Adresse hxxps: //namecoin.cyphrs [.] Com / api / name_show / d / stat-counter-7 (am Beispiel des Domain-Stat-Counters) verarbeitet -7 [.] Bit): <br><br> <a href=""><img src="https://habrastorage.org/webt/ru/4n/h6/ru4nh6y9tlovyvei-pkorkb1tgy.png"></a> <br>  <em>Die Funktion zum Abrufen von IP-Adressen von Steuerungsservern √ºber die Namecoin-Blockbrowser-API</em> <br><br>  Die IP-Adressen des Verwaltungsservers werden vom Antworttext abgerufen.  Zus√§tzlich zu Anfragen an hxxps: //namecoin.cyphrs [.] Com / api / name_show / d / verwendeten Angreifer auch Anfragen an hxxps: // namecha [.] In / name / d / verarbeiteten sie das Feld "Aktueller Wert": <br><br> <a href=""><img src="https://habrastorage.org/webt/mx/8v/z4/mx8vz48xfaxt7bcswxfenlwjyzg.png"></a> <br>  <em>Webseiteninhalt unter URL hxxps: // namecha [.] In / name / d / stat-counter-7</em> <br><br>  Wenn es nicht m√∂glich war, auf diese Weise eine IP-Adresse zu erhalten, l√∂sen die Angreifer den Dom√§nennamen des Steuerungsservers mit der Funktion DnsQuery_A mithilfe spezieller DNS-Server auf (z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">von hier aus</a> ). <br></p><p>  Die Verwendung der Funktion DnsQuery_A im Bibliothekscode core.dll sieht folgenderma√üen aus: <br><br> <a href=""><img src="https://habrastorage.org/webt/wj/6-/ai/wj6-aiarsn-jcqpa8sxjwgosjlk.png"></a> <br>  <em>Die Funktion zum Abrufen von IP-Adressen von Verwaltungsservern durch Aufl√∂sen von Dom√§nennamen mithilfe spezieller DNS-Server</em> <br><br>  Die Funktion DnsQuery_A hat den folgenden Prototyp: <br><br> <a href=""><img src="https://habrastorage.org/webt/iu/rr/9d/iurr9d6pt5cmdm0oz3vajjkfzzi.png"></a> <br>  <em>Der Prototyp der in der Header-Datei WinDNS.h deklarierten Funktion DnsQuery_A</em> <br><br>  Das vierte Argument f√ºr die Funktion DnsQuery_A ist die Adresse der Struktur _IP4_ARRAY auf dem Stapel.  Es enth√§lt ein Array von IP-Adressen spezieller DNS-Server: <br><br> <a href=""><img src="https://habrastorage.org/webt/jj/3q/ho/jj3qhorwwvf9bip77fm431ro4xg.png"></a> <br>  <em>_IP4_ARRAY-Struktur auf dem Stapel</em> <br><br>  Wenn die Funktion DnsQuery_A erfolgreich ausgef√ºhrt wurde, kann die IP-Adresse des verwaltenden Servers durch Lesen des folgenden Werts abgerufen werden: pDnsRecord -&gt; Data.A.IpAddress. </p><br><p>  Aus dem dekompilierten Code einer der Instanzen ist ersichtlich, dass ein spezieller DNS-Server 188.165 [.] 200.156 zum Aufl√∂sen des C &amp; C-Dom√§nennamens verwendet wird.  Im Fehlerfall wird eine Liste mit drei DNS-Servern verwendet: 91.217 [.] 137.37, 188.165 [.] 200.156, 217.12 [.] 210.54. </p><br><h3 id="tor">  Tor </h3><br><p>  Am 15. Februar 2019 entdeckten wir erstmals RTM-Beispiele, deren Verwaltungsserver sich im Tor-Netzwerk befindet (hxxp: // 5aaw3unbkm5jqx7d [.] Onion / index [.] Php). <br><br> <a href=""><img src="https://habrastorage.org/webt/e1/gy/cf/e1gycfr_b8cqznqlntjdr9n6myi.png"></a> <br>  <em>Tor-Verwaltungsserveradresse unter entschl√ºsselten Zeichenfolgen</em> <br><br> <a href=""><img src="https://habrastorage.org/webt/jz/-z/ku/jz-zkujibvahyxxex-uhh7yc_4s.png"></a> <br>  <em>Der Abschnitt des disassemblierten Codes, in dem die URL des Steuerungsservers analysiert wird</em> <br><br>  Solche Proben wurden bis zum 9. April 2019 gesendet, wonach RTM erneut auf die Verwendung der .bit-Dom√§nenzone umstellte. </p><br><h3 id="bitkoyn">  Bitcoin </h3><br><p>  Am 10. Juni 2019 haben wir ein RTM-Beispiel entdeckt, das die IP-Adressen von C &amp; C-Servern aus Transaktionen mit einer bestimmten Krypto-Brieftasche empf√§ngt.  Jede IP-Adresse ist in der Anzahl der aufgelisteten Bitcoins in zwei Transaktionen verborgen. </p><br><p>  Um IP-Adressen zu erhalten, stellt C &amp; C VPO eine Anfrage an hxxps: // chain [.] Also / api / v2 / get_tx_received / BTC /.  Die Antwort enth√§lt eine Reihe von Transaktionen mit dem Crypto Wallet-Konto.  Ein Beispiel zeigt der Screenshot: <br><br> <a href=""><img src="https://habrastorage.org/webt/6w/x3/tf/6wx3tf7-wsljmvslwhb5hhrmpde.png"></a> <br><br>  Betrachten Sie den Codeabschnitt, in dem die IP-Adressen des Verwaltungsservers abgerufen werden: <br><br> <a href=""><img src="https://habrastorage.org/webt/nu/bt/p6/nubtp6f35wmgwqdqcvrp52_qhn8.png"></a> <br><br>  Die FindValue-Funktion sucht nach dem Bruchteil des √úberweisungsbetrags.  Die Suche wird ab dem Ende des Puffers ausgef√ºhrt, und bei jedem nachfolgenden Funktionsaufruf werden Daten ausgehend vom aktuellen Index verarbeitet.  Das hei√üt, bei aufeinanderfolgenden Aufrufen der FindValue-Funktion werden die Werte 8483, 40030, 14728 usw. erhalten.  Das Programm generiert zwei IP-Adressen: Jede Adresse wird in zwei aufeinander folgenden √úbersetzungen ausgeblendet. <br><br> <a href=""><img src="https://habrastorage.org/webt/kx/qd/vb/kxqdvbttrzbvjaoljqjttn7dg1s.png"></a> <br>  <em>Zerlegter Code zum Abrufen einer IP-Adresse aus √úbertragungen an eine Krypto-Brieftasche</em> <br><br>  Dieser Code f√ºhrt Folgendes aus: <br></p><pre><code class="python hljs">ip_address = str(value_1 &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) + <span class="hljs-string"><span class="hljs-string">"."</span></span> + str(value_1 &gt;&gt; <span class="hljs-number"><span class="hljs-number">0x8</span></span>) + <span class="hljs-string"><span class="hljs-string">"."</span></span> + str(value_0 &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) + <span class="hljs-string"><span class="hljs-string">"."</span></span> + str(value_0 &gt;&gt; <span class="hljs-number"><span class="hljs-number">0x8</span></span>)</code> </pre> <br><p>  Das hei√üt, durch Auflisten von 0,00008483 BTC und dann 0,00040030 BTC versteckten die Angreifer die IP-Adresse 94.156 [.] 35.33 f√ºr ihr Programm.  In √§hnlicher Weise erh√§lt RTM aus den beiden vorherigen Transaktionen die zweite IP-Adresse des Verwaltungsservers. </p><br><p>  Daher wird bis heute RTM-Malware gesendet. </p><br><h2 id="zaklyuchenie">  Fazit </h2><br><p>  M√∂glicherweise stellen Sie fest, dass RTM bei der Organisation der √úbertragung der C &amp; C-Serveradresse gerne Ans√§tze verwendet, mit denen Sie die IP-Adresse dynamisch √§ndern k√∂nnen, ohne den Quellcode der Malware zu √§ndern. </p><br><p>  Dies erleichtert einerseits den Angreifern das Leben und kann Analysten in die Irre f√ºhren.  Auf der anderen Seite k√∂nnen Spezialisten die Adressen von Kontrollservern vorhersagen, bevor b√∂swillige Mailings ausgef√ºhrt werden. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456804/">https://habr.com/ru/post/de456804/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456790/index.html">PostgreSQL News Digest. Ausgabe Nr. 16</a></li>
<li><a href="../de456792/index.html">Stellen Sie Kubernetes Cluster mit Kubespray auf OpenStack bereit</a></li>
<li><a href="../de456794/index.html">Web-UI-Architektur: Eine h√∂lzerne Vergangenheit, eine seltsame Gegenwart und eine gl√§nzende Zukunft</a></li>
<li><a href="../de456796/index.html">Svalbard - neuer Name f√ºr das Projekt Have I Been Pwned vor dem Verkauf</a></li>
<li><a href="../de456798/index.html">SDL 2 Tutorials: Lektion 5 - Texturen</a></li>
<li><a href="../de456806/index.html">Ein Bot aus allen Sorgen</a></li>
<li><a href="../de456808/index.html">So verbessern Sie die Leistung von Front-End-Webanwendungen: F√ºnf Tipps</a></li>
<li><a href="../de456810/index.html">Die ersten. Eine Tesla-freie Geschichte</a></li>
<li><a href="../de456812/index.html">Was gibt es an der ITMO University - IT-Festivals, Hackathons, Konferenzen und offene Seminare</a></li>
<li><a href="../de456818/index.html">Der Systemadministrator in einem unzug√§nglichen Unternehmen. Die unertr√§gliche Last des Seins?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>