<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äçü§ù‚Äçüë®üèª üë©üèø‚Äçüî¨ ‚ùáÔ∏è Gu√≠a completa de CMake. Segunda parte: sistema de compilaci√≥n üìí üîô üìô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduccion 


 Este art√≠culo analiza el uso del sistema de compilaci√≥n CMake utilizado en una gran cantidad de proyectos C / C ++. Se recomienda enc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gu√≠a completa de CMake. Segunda parte: sistema de compilaci√≥n</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432096/"><p><img src="https://habrastorage.org/webt/lf/se/70/lfse70sjifxiyddiuym73hdvcho.png"></p><br><h1 id="vvedenie">  Introduccion </h1><br><p>  Este art√≠culo analiza el uso del sistema de compilaci√≥n CMake utilizado en una gran cantidad de proyectos C / C ++.  Se recomienda encarecidamente que lea la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">primera parte del</a> manual para evitar malentendidos sobre la sintaxis del lenguaje CMake, que aparece expl√≠citamente en todo el art√≠culo. </p><a name="habracut"></a><br><h1 id="zapusk-cmake">  Lanzamiento de CMake </h1><br><p>  Los siguientes son ejemplos del uso del lenguaje CMake que debe practicar.  Experimente con el c√≥digo fuente modificando los comandos existentes y agregando otros nuevos.  Para ejecutar estos ejemplos, instale CMake desde el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sitio web oficial</a> . </p><br><h1 id="princip-raboty">  Principio de funcionamiento </h1><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El sistema de compilaci√≥n CMake</a> es un contenedor sobre otras utilidades dependientes de la plataforma (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ninja</a> o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Make</a> ).  Por lo tanto, en el proceso de ensamblaje en s√≠, no importa cu√°n parad√≥jico pueda sonar, no participa directamente. </p><br><p> El sistema de compilaci√≥n CMake acepta un archivo <code>CMakeLists.txt</code> con una descripci√≥n de las reglas de compilaci√≥n en el lenguaje formal de CMake, y luego genera archivos de compilaci√≥n intermedios y nativos en el mismo directorio aceptado en su plataforma. </p><br><p>  Los archivos generados contendr√°n nombres espec√≠ficos de utilidades del sistema, directorios y compiladores, mientras que los comandos CMake solo usan el concepto abstracto del compilador y no est√°n vinculados a herramientas dependientes de la plataforma que difieren mucho en los diferentes sistemas operativos. </p><br><h1 id="proverka-versii-cmake">  Comprobaci√≥n de la versi√≥n de CMake </h1><br><p>  El comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>cmake_minimum_required</code></a> verifica la versi√≥n en ejecuci√≥n de CMake: si es inferior al m√≠nimo especificado, CMake termina con un error fatal.  Un ejemplo que demuestra el uso t√≠pico de este comando al comienzo de cualquier archivo CMake: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#     CMake: cmake_minimum_required(VERSION 3.0)</span></span></code> </pre> <br><p>  Como se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">se√±al√≥</a> en los comentarios, el comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>cmake_minimum_required</code></a> establece todos los indicadores de compatibilidad (consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>cmake_policy</code></a> ).  Algunos desarrolladores establecen intencionalmente una versi√≥n baja de CMake y luego ajustan la funcionalidad manualmente.  Esto le permite admitir simult√°neamente las versiones antiguas de CMake y, en algunos lugares, aprovechar las nuevas funciones. </p><br><h1 id="oformlenie-proekta">  Dise√±o del proyecto </h1><br><p>  Al comienzo de cualquier <code>CMakeLists.txt</code> debe especificar las caracter√≠sticas del proyecto con el equipo del proyecto para un mejor dise√±o con entornos integrados y otras herramientas de desarrollo. </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyProject": project(MyProject VERSION 1.2.3.4 LANGUAGES C CXX)</span></span></code> </pre> <br><p>  Vale la pena se√±alar que si se omite la palabra clave <code>LANGUAGES</code> , los idiomas predeterminados son <code>C CXX</code> .  Tambi√©n puede deshabilitar la indicaci√≥n de cualquier idioma escribiendo la palabra clave <code>NONE</code> como una lista de idiomas o simplemente dejando una lista vac√≠a. </p><br><h1 id="zapusk-skriptovyh-faylov">  Ejecutar archivos de script </h1><br><p>  El comando de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>include</code></a> reemplaza la l√≠nea de su llamada con el c√≥digo del archivo especificado, actuando de manera similar al comando de <code>include</code> preprocesador C / C ++.  Este ejemplo ejecuta el archivo de script <code>MyCMakeScript.cmake</code> comando descrito: </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(<span class="hljs-string"><span class="hljs-string">"'TEST_VARIABLE' is equal to [${TEST_VARIABLE}]"</span></span>) <span class="hljs-comment"><span class="hljs-comment">#   `MyCMakeScript.cmake`  : include(MyCMakeScript.cmake) message("'TEST_VARIABLE' is equal to [${TEST_VARIABLE}]")</span></span></code> </pre> <br><p>  En este ejemplo, el primer mensaje notificar√° que la variable <code>TEST_VARIABLE</code> no se ha definido, sin embargo, si el script <code>MyCMakeScript.cmake</code> esta variable, el segundo mensaje ya informar√° sobre el nuevo valor de la variable de prueba.  Por lo tanto, el archivo de script incluido por el comando de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>include</code></a> no crea su propio alcance, que se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mencion√≥</a> en los comentarios al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo anterior</a> . </p><br><h1 id="kompilyaciya-ispolnyaemyh-faylov">  Compilaci√≥n de archivos ejecutables. </h1><br><p>  El comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_executable</code></a> compila el archivo ejecutable con el nombre de la lista de origen.  Es importante tener en cuenta que el nombre del archivo final depende de la plataforma de destino (por ejemplo, <code>&lt;ExecutableName&gt;.exe</code> o simplemente <code>&lt;ExecutableName&gt;</code> ).  Un ejemplo t√≠pico de llamar a este comando: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyExecutable"  #  "ObjectHandler.c", "TimeManager.c"  "MessageGenerator.c": add_executable(MyExecutable ObjectHandler.c TimeManager.c MessageGenerator.c)</span></span></code> </pre> <br><h1 id="kompilyaciya-bibliotek">  Compilaci√≥n de la biblioteca </h1><br><p>  El comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_library</code></a> compila la biblioteca con la vista y el nombre especificados de la fuente.  Es importante tener en cuenta que el nombre final de la biblioteca depende de la plataforma de destino (por ejemplo, <code>lib&lt;LibraryName&gt;.a</code> o <code>&lt;LibraryName&gt;.lib</code> ).  Un ejemplo t√≠pico de llamar a este comando: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyLibrary"  #  "ObjectHandler.c", "TimeManager.c"  "MessageConsumer.c": add_library(MyLibrary STATIC ObjectHandler.c TimeManager.c MessageConsumer.c)</span></span></code> </pre> <br><ul><li>  Las bibliotecas est√°ticas se definen mediante la palabra clave <code>STATIC</code> como el segundo argumento y son archivos de archivos de objetos asociados con archivos ejecutables y otras bibliotecas en tiempo de compilaci√≥n; </li><li>  Las bibliotecas din√°micas se especifican mediante la palabra clave <code>SHARED</code> como segundo argumento y son bibliotecas binarias cargadas por el sistema operativo durante la ejecuci√≥n del programa; </li><li>  Las bibliotecas modulares est√°n definidas por la palabra clave <code>MODULE</code> como el segundo argumento y son bibliotecas binarias cargadas utilizando la t√©cnica de ejecuci√≥n por el propio ejecutable; </li><li>  Las bibliotecas de objetos se definen por la palabra clave <code>OBJECT</code> como el segundo argumento y son un conjunto de archivos de objetos asociados con archivos ejecutables y otras bibliotecas en tiempo de compilaci√≥n. </li></ul><br><h1 id="dobavlenie-ishodnikov-k-celi">  Agregar fuente al objetivo </h1><br><p>  Hay casos que requieren m√∫ltiples adiciones de archivos de origen al destino.  Para hacer esto, se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_sources</code></a> comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_sources</code></a> , que puede agregar or√≠genes al destino muchas veces. </p><br><p>  El primer argumento para el comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_sources</code></a> es el nombre del objetivo previamente especificado usando los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_executable</code></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_library</code></a> o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_executable</code></a> , y los argumentos siguientes son una lista de los archivos fuente que se agregar√°n. </p><br><p>  Las llamadas repetidas al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_sources</code></a> agregan los archivos fuente al destino en el orden en que fueron llamados, por lo que los dos bloques de c√≥digo inferiores son funcionalmente equivalentes: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyExecutable"   # "ObjectPrinter.c"  "SystemEvaluator.c": add_executable(MyExecutable ObjectPrinter.c SystemEvaluator.c) #    "MyExecutable"  "MessageConsumer.c": target_sources(MyExecutable MessageConsumer.c) #    "MyExecutable"  "ResultHandler.c": target_sources(MyExecutable ResultHandler.c)</span></span></code> </pre> <br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyExecutable"   # "ObjectPrinter.c", "SystemEvaluator.c", "MessageConsumer.c"  "ResultHandler.c": add_executable(MyExecutable ObjectPrinter.c SystemEvaluator.c MessageConsumer.c ResultHandler.c)</span></span></code> </pre> <br><h1 id="generiruemye-fayly">  Archivos generados </h1><br><p>  La ubicaci√≥n de los archivos de salida generados por los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_library</code></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_executable</code></a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_library</code></a> se determina solo en la etapa de generaci√≥n, sin embargo, esta regla se puede cambiar con varias variables que determinan la ubicaci√≥n final de los archivos binarios: </p><br><ul><li>  Las variables <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>RUNTIME_OUTPUT_DIRECTORY</code></a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>RUNTIME_OUTPUT_NAME</code></a> determinan la ubicaci√≥n de los objetivos de ejecuci√≥n; </li><li>  Las variables <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>LIBRARY_OUTPUT_DIRECTORY</code></a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>LIBRARY_OUTPUT_NAME</code></a> determinan la ubicaci√≥n de las bibliotecas; </li><li>  Las variables <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>ARCHIVE_OUTPUT_DIRECTORY</code></a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>ARCHIVE_OUTPUT_NAME</code></a> determinan la ubicaci√≥n de los archivos. </li></ul><br><p>  Los archivos ejecutables siempre se consideran objetivos de ejecuci√≥n, las bibliotecas est√°ticas se consideran objetivos de archivo y las bibliotecas modulares se consideran objetivos de biblioteca.  Para las plataformas "no DLL", las bibliotecas din√°micas se consideran objetivos de la biblioteca, y para las "plataformas DLL", los objetivos de ejecuci√≥n.  Dichas variables no se proporcionan para las bibliotecas de objetos, ya que este tipo de bibliotecas se genera en las entra√±as del directorio <code>CMakeFiles</code> . </p><br><p>  Es importante tener en cuenta que todas las plataformas basadas en Windows, incluida <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cygwin,</a> se consideran "plataformas DLL". </p><br><h1 id="komponovka-s-bibliotekami">  Dise√±o de la biblioteca </h1><br><p>  El comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_link_libraries</code></a> biblioteca o ejecutable con otras bibliotecas proporcionadas.  El primer argumento para este comando es el nombre del objetivo generado por los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_library</code></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_executable</code></a> o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_library</code></a> , y los argumentos posteriores son los nombres de los objetivos de la biblioteca o las rutas completas a las bibliotecas.  Un ejemplo: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyExecutable"  #  "JsonParser", "SocketFactory"  "BrowserInvoker": target_link_libraries(MyExecutable JsonParser SocketFactory BrowserInvoker)</span></span></code> </pre> <br><p>  Vale la pena se√±alar que las bibliotecas modulares no se pueden vincular con archivos ejecutables u otras bibliotecas, ya que est√°n destinadas √∫nicamente a la carga mediante t√©cnicas de ejecuci√≥n. </p><br><h1 id="rabota-s-celyami">  Trabaja con objetivos </h1><br><p>  Como se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">menciona</a> en los comentarios, los objetivos en CMake tambi√©n est√°n sujetos a manipulaci√≥n manual, aunque muy limitada. </p><br><p>  Es posible controlar las propiedades de los objetivos dise√±ados para establecer el proceso de ensamblaje del proyecto.  El comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>get_target_property</code></a> valor de la propiedad de destino en la variable proporcionada.  Este ejemplo muestra el valor de la propiedad <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>C_STANDARD</code></a> objetivo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>C_STANDARD</code></a> en la pantalla: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   "VALUE"   "C_STANDARD": get_target_property(VALUE MyTarget C_STANDARD) #      : message("'C_STANDARD' property is equal to [${VALUE}]")</span></span></code> </pre> <br><p>  El comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>set_target_properties</code></a> establece las propiedades de destino especificadas en los valores especificados.  Este comando acepta una lista de objetivos para los que se establecer√°n valores de propiedad, y luego la palabra clave <code>PROPERTIES</code> , seguida de una lista de la forma <code>&lt; &gt; &lt; &gt;</code> : </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   'C_STANDARD'  "11", #   'C_STANDARD_REQUIRED'  "ON": set_target_properties(MyTarget PROPERTIES C_STANDARD 11 C_STANDARD_REQUIRED ON)</span></span></code> </pre> <br><p>  El ejemplo anterior establece las propiedades de los objetivos <code>MyTarget</code> que afectan el proceso de compilaci√≥n, a saber: al compilar el objetivo <code>MyTarget</code> CMake <code>MyTarget</code> compilador use el est√°ndar C11.  Todos los nombres de propiedades de destino conocidos se enumeran en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esta p√°gina</a> . </p><br><p>  Tambi√©n es posible verificar objetivos previamente definidos utilizando la construcci√≥n <code>if(TARGET &lt;TargetName&gt;)</code> : </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#  "The target was defined!"   "MyTarget"  , #    "The target was not defined!": if(TARGET MyTarget) message("The target was defined!") else() message("The target was not defined!") endif()</span></span></code> </pre> <br><h1 id="dobavlenie-podproektov">  Agregar subproyectos </h1><br><p>  El comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_subdirectory</code></a> solicita a CMake que procese inmediatamente el archivo de subproyecto especificado.  El siguiente ejemplo demuestra la aplicaci√≥n del mecanismo descrito: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   "subLibrary"    , #       "subLibrary/build": add_subdirectory(subLibrary subLibrary/build)</span></span></code> </pre> <br><p>  En este ejemplo, el primer argumento para el comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_subdirectory</code></a> es el subproyecto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_subdirectory</code></a> , y el segundo argumento es opcional e informa a CMake sobre la carpeta destinada a los archivos generados del subproyecto incluido (por ejemplo, <code>CMakeCache.txt</code> y <code>cmake_install.cmake</code> ). </p><br><p>  Vale la pena se√±alar que todas las variables del √°mbito primario son heredadas por el directorio agregado, y todas las variables definidas y redefinidas en este directorio ser√°n visibles solo para √©l (si la palabra clave <code>PARENT_SCOPE</code> no <code>PARENT_SCOPE</code> especificada por el argumento del comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>set</code></a> ).  Esta caracter√≠stica fue <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mencionada</a> en los comentarios al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo anterior</a> . </p><br><h1 id="poisk-paketov">  Paquete de b√∫squeda </h1><br><p>  El comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>find_package</code></a> encuentra y carga la configuraci√≥n de un proyecto externo.  En la mayor√≠a de los casos, se utiliza para la vinculaci√≥n posterior de bibliotecas externas como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Boost</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GSL</a> .  Este ejemplo llama al comando descrito para buscar la biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GSL</a> y luego vincular: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#     "GSL": find_package(GSL 2.5 REQUIRED) #      "GSL": target_link_libraries(MyExecutable GSL::gsl) #      "GSL": target_include_directories(MyExecutable ${GSL_INCLUDE_DIRS})</span></span></code> </pre> <br><p>  En el ejemplo anterior, el comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>find_package</code></a> acepta el nombre del paquete como primer argumento y luego la versi√≥n requerida.  La opci√≥n <code>REQUIRED</code> requiere imprimir un error fatal y finalizar CMake si no se encuentra el paquete requerido.  Lo opuesto es la opci√≥n <code>QUIET</code> , que requiere que CMake contin√∫e su trabajo, incluso si no se encontr√≥ el paquete. </p><br><p>  A continuaci√≥n, el <code>MyExecutable</code> vincula a la biblioteca GSL con el comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_link_libraries</code></a> utilizando la variable <code>GSL::gsl</code> , que encapsula la ubicaci√≥n del GSL ya compilado. </p><br><p>  Al final, se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_include_directories</code></a> comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_include_directories</code></a> , que informa al compilador sobre la ubicaci√≥n de los archivos de encabezado de la biblioteca GSL.  Tenga en cuenta que la variable <code>GSL_INCLUDE_DIRS</code> se usa para <code>GSL_INCLUDE_DIRS</code> ubicaci√≥n de los encabezados que describ√≠ (este es un ejemplo de la configuraci√≥n del paquete importado). </p><br><p>  Probablemente desee verificar el resultado de una b√∫squeda de paquetes si especific√≥ la opci√≥n <code>QUIET</code> .  Esto se puede hacer comprobando la <code>&lt;PackageName&gt;_FOUND</code> , que se determina autom√°ticamente despu√©s de que se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>find_package</code></a> comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>find_package</code></a> .  Por ejemplo, si importa con √©xito la configuraci√≥n de GSL en su proyecto, la variable <code>GSL_FOUND</code> se convertir√° en verdadera. </p><br><p>  En general, el comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>find_package</code></a> tiene dos tipos de lanzamiento: modular y configuraci√≥n.  El ejemplo anterior aplic√≥ una forma modular.  Esto significa que cuando se llama al comando, CMake busca un archivo de script con la forma <code>Find&lt;PackageName&gt;.cmake</code> en el directorio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>CMAKE_MODULE_PATH</code></a> , y luego lo inicia e importa todas las configuraciones necesarias (en este caso, CMake lanz√≥ el archivo <code>FindGSL.cmake</code> est√°ndar). </p><br><h1 id="sposoby-vklyucheniya-zagolovkov">  Formas de incluir encabezados </h1><br><p>  Puede informar al compilador sobre la ubicaci√≥n de los encabezados incluidos mediante dos comandos: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>include_directories</code></a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_include_directories</code></a> .  Usted decide cu√°l usar, sin embargo, vale la pena considerar algunas diferencias entre ellos (la idea se sugiere en los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">comentarios</a> ). </p><br><p>  El comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>include_directories</code></a> afecta el alcance del directorio.  Esto significa que todos los directorios de encabezado especificados por este comando se usar√°n para todos los prop√≥sitos del <code>CMakeLists.txt</code> actual, as√≠ como para subproyectos procesados ‚Äã‚Äã(ver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_subdirectory</code></a> ). </p><br><p>  El comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_include_directories</code></a> afecta al objetivo especificado por el primer argumento, y no afecta a otros objetivos.  El siguiente ejemplo demuestra la diferencia entre los dos comandos: </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_executable</span></span>(RequestGenerator RequestGenerator.c) <span class="hljs-keyword"><span class="hljs-keyword">add_executable</span></span>(ResponseGenerator ResponseGenerator.c) <span class="hljs-comment"><span class="hljs-comment">#     "RequestGenerator": target_include_directories(RequestGenerator headers/specific) #    "RequestGenerator"  "ResponseGenerator": include_directories(headers)</span></span></code> </pre> <br><p>  En los comentarios se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">menciona</a> que en los proyectos modernos el uso de los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>link_libraries</code></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>include_directories</code></a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>link_libraries</code></a> es indeseable.  Una alternativa son los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_link_libraries</code></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_include_directories</code></a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>target_link_libraries</code></a> que act√∫an solo en objetivos espec√≠ficos y no en todo el alcance actual. </p><br><h1 id="ustanovka-proekta">  Proyecto de instalacion </h1><br><p>  El comando de instalaci√≥n genera reglas de instalaci√≥n para su proyecto.  Este comando es capaz de trabajar con objetivos, archivos, carpetas y m√°s.  Primero, considere establecer metas. </p><br><p>  Para establecer objetivos, debe pasar la palabra clave <code>TARGETS</code> como primer argumento de la funci√≥n descrita, seguida de una lista de los objetivos que se establecer√°n y luego la palabra clave <code>DESTINATION</code> con la ubicaci√≥n del directorio en el que se establecer√°n estos objetivos.  Este ejemplo demuestra una configuraci√≥n t√≠pica de objetivos: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   "TimePrinter"  "DataScanner"   "bin": install(TARGETS TimePrinter DataScanner DESTINATION bin)</span></span></code> </pre> <br><p>  El proceso para describir la instalaci√≥n de archivos es similar, excepto que en lugar de la <code>TARGETS</code> , especifique <code>FILES</code> .  Un ejemplo que demuestra la instalaci√≥n de archivos: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   "DataCache.txt"  "MessageLog.txt"   "~/": install(FILES DataCache.txt MessageLog.txt DESTINATION ~/)</span></span></code> </pre> <br><p>  El proceso para describir la instalaci√≥n de carpetas es similar, excepto que debe especificar <code>DIRECTORY</code> lugar de la palabra clave <code>FILES</code> .  Es importante tener en cuenta que durante la instalaci√≥n se copiar√° todo el contenido de la carpeta, y no solo su nombre.  Un ejemplo de instalaci√≥n de carpetas es el siguiente: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   "MessageCollection"  "CoreFiles"   "~/": install(DIRECTORY MessageCollection CoreFiles DESTINATION ~/)</span></span></code> </pre> <br><p>  Despu√©s de completar el procesamiento CMake de todos sus archivos, puede instalar todos los objetos descritos con el <code>sudo checkinstall</code> (si CMake genera un <code>Makefile</code> ), o puede realizar esta acci√≥n con el entorno de desarrollo integrado que admite CMake. </p><br><h1 id="naglyadnyy-primer-proekta">  Ejemplo visual del proyecto. </h1><br><p>  Esta gu√≠a no estar√≠a completa sin demostrar un ejemplo real del uso del sistema de compilaci√≥n CMake.  Considere un diagrama de proyecto simple usando CMake como el √∫nico sistema de compilaci√≥n: </p><br><pre> <code class="plaintext hljs">+ MyProject - CMakeLists.txt - Defines.h - StartProgram.c + core - CMakeLists.txt - Core.h - ProcessInvoker.c - SystemManager.c</code> </pre> <br><p>  El archivo de ensamblaje principal <code>CMakeLists.txt</code> describe la compilaci√≥n de todo el programa: primero, se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_executable</code></a> comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_executable</code></a> que compila el archivo ejecutable, luego se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_subdirectory</code></a> comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>add_subdirectory</code></a> , que estimula el procesamiento del subproyecto, y finalmente, el archivo ejecutable est√° vinculado a la biblioteca compilada: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    CMake: cmake_minimum_required(VERSION 3.0) #   : project(MyProgram VERSION 1.0.0 LANGUAGES C) #      "MyProgram": add_executable(MyProgram StartProgram.c) #    "core/CMakeFiles.txt": add_subdirectory(core) #    "MyProgram"  #    "MyProgramCore": target_link_libraries(MyProgram MyProgramCore) #    "MyProgram"   "bin": install(TARGETS MyProgram DESTINATION bin)</span></span></code> </pre> <br><p>  El archivo de ensamblaje principal llama al archivo <code>core/CMakeLists.txt</code> y compila la biblioteca est√°tica <code>MyProgramCore</code> destinada a vincularse con el archivo ejecutable: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    CMake: cmake_minimum_required(VERSION 3.0) #      "MyProgramCore": add_library(MyProgramCore STATIC ProcessInvoker.c SystemManager.c)</span></span></code> </pre> <br><p>  Despu√©s de una serie de comandos <code>cmake . &amp;&amp; make &amp;&amp; sudo checkinstall</code>  <code>cmake . &amp;&amp; make &amp;&amp; sudo checkinstall</code> sistema de compilaci√≥n CMake se completa con √©xito.  El primer comando comienza a procesar el archivo <code>CMakeLists.txt</code> en el directorio ra√≠z del proyecto, el segundo comando finalmente compila los archivos binarios necesarios y el tercer comando instala el <code>MyProgram</code> compilado en el sistema. </p><br><h1 id="zaklyuchenie">  Conclusi√≥n </h1><br><p>  Ahora puede escribir los suyos y comprender los archivos CMake de otras personas, y puede leer en detalle sobre otros mecanismos en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sitio web oficial</a> . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El pr√≥ximo art√≠culo de</a> esta gu√≠a se centrar√° en probar y crear paquetes con CMake y se lanzar√° en una semana.  Hasta pronto! <br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es432096/">https://habr.com/ru/post/es432096/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es432086/index.html">Impresi√≥n 3D en la escuela internacional que lleva el nombre de M.V. Lomonosov</a></li>
<li><a href="../es432088/index.html">Alta disponibilidad de MySQL en GitHub</a></li>
<li><a href="../es432090/index.html">Magento Meetup Kharkiv No. 4 - informes en video</a></li>
<li><a href="../es432092/index.html">Errores desagradables al escribir pruebas unitarias</a></li>
<li><a href="../es432094/index.html">Hackathon en l√≠nea conjunto de OpenGift y Credits Blockchain Platform</a></li>
<li><a href="../es432098/index.html">Pilotos autom√°ticos en el transporte por carretera, c√≥mo interactuar con especiales. en transporte?</a></li>
<li><a href="../es432100/index.html">C√≥mo mejoramos la conversi√≥n de facturaci√≥n</a></li>
<li><a href="../es432102/index.html">Funciones expl√≠citas de JavaScript</a></li>
<li><a href="../es432104/index.html">Resumen de eventos de TI de diciembre (primera parte)</a></li>
<li><a href="../es432106/index.html">Food Design Digest, noviembre de 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>