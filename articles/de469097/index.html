<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>☮️ 👊🏽 🔱 CentOS 8 Webserver mit PHP7, Node.js und Redis 👨🏻‍🎓 👨‍👩‍👦‍👦 😣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vorwort 
 Es ist 2 Tage her, dass die neue Version des CentOS-Betriebssystems herauskam, nämlich CentOS 8. Und bis jetzt gibt es im Internet einige Ar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>CentOS 8 Webserver mit PHP7, Node.js und Redis</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/469097/"><h2>  Vorwort </h2><br>  Es ist 2 Tage her, dass die neue Version des CentOS-Betriebssystems herauskam, nämlich CentOS 8. Und bis jetzt gibt es im Internet einige Artikel darüber, wie man etwas darin macht, also habe ich beschlossen, diese Lücke zu schließen.  Darüber hinaus werde ich Ihnen nicht nur erklären, wie Sie dieses Programmpaar installieren, sondern auch, wie ich die Installation von Linux in einer virtuellen Umgebung in der modernen Welt für allgemeine Aufgaben wie Festplattenpartitionierung und mehr im Allgemeinen sehe. <br><br>  Aber am Anfang möchte ich kurz darüber sprechen, warum Sie von allen vorherigen zu dieser Version wechseln sollten, und dafür gibt es zwei Gründe: <br><a name="habracut"></a><br><ol><li>  PHP7!  In der vorherigen Version von CentOS wurde "Orthodox" php5.4 installiert ... <br><br>  Nun, wenn auch etwas ernster, dann sprangen viele Pakete über mehrere Versionen in großen Mengen.  Wir (Fans von Redhat-ähnlichen Betriebssystemen) sind endlich eingetreten, wenn nicht die Zukunft, dann zumindest die Gegenwart.  Und Ubuntu-Anhänger werden uns nicht mehr auslachen und mit den Fingern nach uns stechen, na ja ... zumindest für eine Weile;). </li><li>  Übergang von yum zu dnf.  Der Hauptunterschied besteht darin, dass jetzt die Arbeit mit mehreren Versionen von Paketen offiziell unterstützt wird.  Genau hier in der Abbildung acht hat es mir noch nie geholfen, aber es klingt vielversprechend. </li></ol><br><h2>  Erstellen einer virtuellen Maschine </h2><br>  Hypervisoren sind unterschiedlich und ich habe keinen Zweck, den Leser für einen bestimmten zu schärfen. Ich werde Ihnen allgemeine Prinzipien erläutern. <br><br><h3>  Die Erinnerung </h3><br>  Erstens ... Um das CentOS-System sicher ab 7 zu installieren, und meiner Meinung nach war es bei 6 dasselbe („aber das ist nicht korrekt“), werden <i>mindestens</i> 2 GB RAM benötigt.  Deshalb rate ich Ihnen, zu beginnen und so viel zu geben. <br><br>  Wenn dies jedoch nach der Installation der Fall ist, kann der Speicherplatz reduziert werden.  Bei 1 GB funktioniert das nackte System ganz gut, habe ich überprüft. <br><br><h3>  Fahren </h3><br>  Erstellen Sie für eine normale Installation eine virtuelle Festplatte mit 20 bis 30 GB.  Dies reicht für das System.  Und eine zweite Platte für Daten.  Es kann sowohl beim Erstellen einer virtuellen Maschine als auch danach hinzugefügt werden.  Normalerweise füge ich später hinzu. <br><br><h3>  CPU </h3><br>  Auf einem Kern verlangsamt sich ein nacktes System nicht.  Und da Ressourcen frei skalierbar sind, sehe ich keinen Grund, in der Installationsphase mehr zu geben (es sei denn, Sie kennen die Anforderungen im Idealfall und sind zu faul, um erneut in den Konfigurator zu wechseln). <br><br>  Der Rest kann normalerweise standardmäßig belassen werden. <br><br><h2>  Installation selbst </h2><br>  Also ... Wir starten das Installationsprogramm ... Ich persönlich habe diese Dienste schon lange nur in Form von virtuellen Maschinen bereitgestellt, daher beschreibe ich nicht alle Arten von Verteilungsdatensätzen auf einem USB-Flash-Laufwerk. Ich habe die ISO einfach als CD in meinen Lieblingshypervisor gemountet, sie heruntergeladen und gefahren. <br><br>  Die Grundinstallation ist recht typisch, ich werde mich nur auf einige Punkte konzentrieren. <br><br><h3>  Quellenauswahl </h3><br>  Seit der Veröffentlichung der achten Version hat der Spiegel von Yandex den ganzen Tag gelogen.  Nun, das heißt, es steigt periodisch an und zeigt dann wieder einen Fehler an.  Ich bin sicher, dass die Angelegenheit eine übermäßige Belastung des Dienstes darstellt.  Um die Quelle anzugeben, musste ich persönlich, anstatt die übliche Adresse einzugeben, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hierher</a> gehen, den Spiegel auswählen, den ich dort mag, und die Adresse manuell in das Installationsfenster eingeben.  Es ist wichtig zu <b>beachten,</b> dass Sie den Pfad zu dem Ordner angeben müssen, in dem sich das <b>Repodata-Verzeichnis befindet</b> .  Zum Beispiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mirror.corbina.net/pub/Linux/centos/8/BaseOS/x86_64/os</a> . <br><br><h3>  Festplattenausfall </h3><br>  Diese Frage ist meiner Meinung nach eher religiös.  Jeder Administrator hat seine eigene Position zu diesem Thema.  Aber ich teile immer noch meinen Standpunkt zu dieser Frage. <br><br>  Ja, im Prinzip können Sie den gesamten Platz der Wurzel zuordnen und arbeiten, meistens ist es sogar ganz gut.  Warum dann einen Garten mit verschiedenen Abschnitten umzäunen?  - Die Hauptgründe dafür sind meiner Meinung nach 2: Quoten und Portabilität. <br><br>  Wenn beispielsweise ein Fehler aufgetreten ist und Fehler im Hauptdatenbereich aufgetreten sind, möchte ich das System trotzdem laden und Wiederbelebungsmaßnahmen durchführen können.  Daher ordne ich persönlich eine separate Partition unter / boot zu.  Da liegt der Kernel und der Bootloader.  Normalerweise reichen 500 Megabyte aus, aber in seltenen Fällen kann es länger dauern. Da wir bereits daran gewöhnt sind, Speicherplatz mit Terabyte zu messen, ordne ich diesem Abschnitt 2 GB zu.  Und hier ist es wichtig, dass es nicht lvm gemacht werden kann. <br><br>  Als nächstes kommt die Wurzel des Systems.  Für eine normale Installation benötigte ich nie mehr als 4 GB pro System, aber bei geplanten Ereignissen verwende ich häufig das Verzeichnis / tmp, um Distributionen zu entpacken, und ich sehe keinen Sinn darin, es als separaten Abschnitt hervorzuheben - in modernen Systemen wird es automatisch bereinigt, daher füllt es sich nicht .  Also ordne ich unter dem Stamm 8 GB zu. <br><br>  Tauschen ... Im Großen und Ganzen gibt es wenig praktischen Nutzen daraus.  Wenn Sie begonnen haben, Swap auf dem Server zu verwenden, bedeutet dies heute in der realen Welt nur, dass der Server mehr RAM hinzufügen muss.  Andernfalls sind Leistungsprobleme garantiert (oder ein Programm hat einen Speicherverlust).  Daher dient dieser Abschnitt nur zu Diagnosezwecken.  Daher sind 2 GB eine große Zahl.  Ja, egal wie viel Speicher der Server hat.  Ja, ich habe alle Artikel gelesen, in denen über das Verhältnis von Speicher zu Auslagerungsvolumen geschrieben wurde ... IMHO, sie sind veraltet.  Für 10 Jahre Praxis war dies für mich nie nützlich.  Vor 15 Jahren habe ich sie benutzt, ja. <br><br>  Jeder kann entscheiden, ob / zu Hause in einem separaten Abschnitt IMHO zuweisen.  Wenn jemand dieses Verzeichnis auf dem Server aktiv verwendet, ist es besser, es hervorzuheben.  Wenn niemand - kein Grund. <br><br>  Als nächstes / var.  Meiner Meinung nach ist es notwendig, es herauszustellen.  Für den Anfang können Sie sich auf eine 4-GB-Nummer beschränken und dann, wie es geht.  Und ja, mit "wie es geht" meine ich das <br><br><ol><li>  Erstens können Sie jederzeit eine andere Festplatte in das Unterverzeichnis / var einhängen (was ich später anhand eines Beispiels zeigen werde). </li><li>  Zweitens haben wir lvm - Sie können immer hinzufügen.  Und normalerweise müssen Sie hinzufügen, wenn zu viele Protokolle dort eingehen.  Aber ich konnte diese Zahl noch nie im Voraus vorhersagen, also beginne ich mit 2 GB und schaue dann. </li></ol><br>  Der nicht zugewiesene Speicherplatz bleibt in der Datenträgergruppe frei, Sie können ihn später jederzeit verwenden. <br><br><h4>  LVM </h4><br>  <b>Es</b> ist sinnvoll, <b>alle</b> Partitionen außer / boot in LVM zu erstellen.  Ja, einschließlich Tausch.  Ja, der Austausch für alle Spitzen sollte am Anfang der Festplatte erfolgen, und im Fall von LVM kann dessen Position im Prinzip nicht bestimmt werden.  Aber wie ich oben geschrieben habe, sollte Ihr System <i>überhaupt keinen</i> Swap verwenden.  Daher spielt es keine Rolle, wo er ist.  Nun, nicht '95 leben wir ehrlich! <br><br>  Darüber hinaus gibt es in LVM mehrere grundlegende Entitäten, mit denen Sie leben können müssen: <br><br><ul><li>  physisches Volumen </li><li>  Volumengruppe </li><li>  logisches Volumen </li></ul><br>  Physische Volumes werden zusammen gruppiert, wobei sich jedes physische Volume nur in einer Gruppe befindet und sich die Gruppe auf mehreren physischen Volumes gleichzeitig befinden kann. <br>  Und logische Volumes gehören jeweils zur selben Gruppe. <br><br>  Aber ... Wir sind verdammt noch mal das 21. Jahrhundert auf dem Hof.  Und die Server sind virtuell.  Es macht keinen Sinn, auf sie dieselben Mechanismen anzuwenden, die auf physische angewendet wurden.  Und für virtuelle ist es wichtig, dass die Daten vom System getrennt sind!  Dies ist insbesondere für die Möglichkeit sehr wichtig, Daten schnell auf eine andere virtuelle Maschine umzuschalten (z. B. beim Umschalten auf ein neues Betriebssystem) und im Allgemeinen für alle möglichen nützlichen Vorteile (z. B. getrennte Sicherungen nach Abschnitten mithilfe des Hypervisors).  Daher wird eine Datenträgergruppe für das System verwendet, und notwendigerweise wird eine andere für Daten verwendet!  Diese logische Trennung hilft viel im Leben! <br><br>  Wenn Sie beim Erstellen einer virtuellen Maschine nur eine virtuelle Festplatte erstellt haben, ist die Konfiguration beendet.  Und wenn zwei, dann markieren Sie die zweite noch nicht. <br><br>  <b>Wir starten die Installation.</b> <br><br><h2>  Nach der Installation </h2><br>  Das frisch installierte System wurde also endlich hochgefahren.  Das erste, was überprüft werden muss, ist das Internet. <br><br><pre><code class="bash hljs">ping ya.ru</code> </pre> <br>  Gibt es eine Antwort?  - Gut, drücken Sie Strg-C. <br>  Wenn nicht, richten Sie das Netzwerk ein, es gibt kein Leben ohne dies, aber in meinem Artikel geht es nicht darum. <br><br>  Wenn wir nicht schon unter der Wurzel sind, gehen wir unter die Wurzel, denn um <i>so</i> viele Befehle mit sudo einzugeben, vlom ich persönlich (und paranoide Admins vergeben mir): <br><br><pre> <code class="bash hljs">sudo -i</code> </pre> <br>  Jetzt tippen wir als erstes <br><br><pre> <code class="bash hljs">dnf -y update</code> </pre> <br>  Und wenn Sie diesen Artikel im Jahr 2019 lesen, wird höchstwahrscheinlich nichts passieren, aber es war einen Versuch wert. <br><br><h3>  Konfigurieren Sie nun das verbleibende Laufwerk </h3><br>  Angenommen, wir hatten eine xvda-Partition mit einem System, dann ist die Datenfestplatte xvdb.  Ok <br><br>  Die meisten Tipps beginnen mit den Worten "Starten Sie fdisk und erstellen Sie eine Partition ...". <br><br>  Das <i>ist also nicht wahr</i> ! <br><br>  Ich werde den Pfannkuchen noch einmal wiederholen, weil es wichtig ist!  In diesem Fall ist es schädlich, Partitionen darauf zu erstellen, wenn Sie mit LVM arbeiten, das ein Ganzes belegt, auch wenn es sich um eine virtuelle Festplatte handelt!  Jedes Wort ist in diesem Satz wichtig.  Wenn wir ohne LVM arbeiten, ist es notwendig.  Wenn wir auf dem Festplattensystem und Daten sagen - es ist notwendig.  Wenn wir aus irgendeinem Grund die Hälfte der Festplatte leer lassen müssen - auch notwendig.  Aber normalerweise sind alle diese Annahmen rein theoretisch.  Wenn wir dem vorhandenen Abschnitt Orte hinzufügen möchten, ist dies mit dieser Konfiguration am einfachsten.  Und die einfache Verwaltung überwiegt so sehr, dass wir uns bewusst dieser Konfiguration zuwenden. <br><br>  Und der Vorteil ist, dass Sie, wenn Sie den Datenbereich erweitern möchten, dem virtuellen Bereich nur Speicherplatz hinzufügen und dann die Gruppe mit vgextend erweitern.  In seltenen Fällen kann etwas anderes erforderlich sein, aber zumindest müssen Sie am Anfang nicht das logische erweitern, was bereits nett ist.  Um dieses Volume selbst zu erweitern, wird empfohlen, das vorhandene am Anfang zu löschen und dann ein neues zu erstellen. Dies sieht nicht besonders gut aus und kann nicht live durchgeführt werden. Die Erweiterung gemäß dem von mir angegebenen Szenario kann im laufenden Betrieb durchgeführt werden, ohne dass die Partition ausgehängt werden muss. <br><br>  Insgesamt erstellen wir ein physisches Volume, dann eine Gruppe von Volumes, einschließlich dieses Volumes, und dann einen Abschnitt für unseren Server: <br><br><pre> <code class="bash hljs">pvcreate /dev/xvdb vgcreate data /dev/xvdb lvcreate -n www -L40G data mke2fs -t ext4 /dev/mapper/data-www</code> </pre><br>  Hier können Sie anstelle des Großbuchstabens "L" (und der Größe in GB) eine kleine angeben und dann die relative Größe anstelle der absoluten Größe angeben. Um beispielsweise die Hälfte des derzeit in der Datenträgergruppe verfügbaren Speicherplatzes zu verwenden, müssen Sie "-l + 50% FREE" angeben. <br><br>  Und der letzte Befehl formatiert die Partition im ext4-Dateisystem (das in meiner Praxis bisher die größte Stabilität zeigt, falls alles kaputt geht, also bevorzuge ich es). <br><br>  Montieren Sie nun die Partition an der richtigen Stelle.  Fügen Sie dazu die richtige Zeile zu / etc / fstab hinzu: <br><br><pre> <code class="bash hljs">/dev/mapper/data-www /var/www ext4 defaults 1 2</code> </pre> <br>  Und wir tippen <br><br><pre> <code class="bash hljs">mount /var/www</code> </pre> <br>  Wenn ein Fehler auftritt, schlagen wir Alarm!  Weil es bedeutet, dass wir einen Fehler in / etc / fstab haben.  Und dass wir beim nächsten Neustart sehr große Probleme haben werden.  Das System bootet möglicherweise überhaupt nicht, was für Cloud-Dienste oft sehr traurig ist.  Daher müssen Sie entweder die zuletzt angehängte Zeile dringend korrigieren oder ganz löschen!  Aus diesem Grund haben wir nicht begonnen, den Befehl mount manuell zu schreiben - dann hätten wir keine so hervorragende Gelegenheit gehabt, die Konfiguration von Direct-to-Home-Appliances zu überprüfen. <br><br>  Jetzt stellen wir tatsächlich alles, was wir wollten, und öffnen die Ports unter dem Web: <br><br><pre> <code class="bash hljs">dnf groupinstall <span class="hljs-string"><span class="hljs-string">"Development Tools"</span></span> dnf -y install httpd @nodejs @redis php firewall-cmd --add-service http --permanent firewall-cmd --add-service https --permanent</code> </pre><br>  Optional können Sie die Datenbank auch hier ablegen, aber ich persönlich versuche, sie vom Webserver getrennt zu halten.  Obwohl es schneller ist, sie in der Nähe zu halten, ja.  Die Geschwindigkeit virtueller Netzwerkadapter liegt normalerweise im Gigabit-Bereich, und wenn Sie auf demselben Computer arbeiten, erfolgt der Zugriff fast sofort.  Aber weniger sicher.  Hier ist wem wichtiger. <br><br>  Fügen Sie nun den Parameter zur Konfigurationsdatei hinzu (erstellen Sie eine neue, moderne CentOS-Ideologie wie diese). <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"vm.overcommit_memory = 1"</span></span>&gt; /etc/sysctl.d/98-sysctl.conf</code> </pre> <br>  Starten Sie den Server neu. <br>  In den Kommentaren wurde ich beschimpft, weil ich Ihnen geraten habe, SeLinux auszuschalten. Deshalb werde ich das Problem beheben und darüber schreiben, dass Sie danach daran denken müssen, SeLinux zu konfigurieren. <br>  <b>Eigentlich Gewinn!</b>  <b>:) :)</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de469097/">https://habr.com/ru/post/de469097/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de469079/index.html">Python in Visual Studio Code: September-Erweiterungsupdate</a></li>
<li><a href="../de469085/index.html">Wir nehmen die Software aus dem passwortgeschützten Mikrocontroller Renesas M16C heraus</a></li>
<li><a href="../de469087/index.html">MVCC in PostgreSQL-2. Gabeln, Dateien, Seiten</a></li>
<li><a href="../de469093/index.html">Vergleich weniger populärer und nicht sehr CLI-Bibliotheken: Cliff, Plac, Plumbum und andere (Teil 2)</a></li>
<li><a href="../de469095/index.html">ML.NET- und Model Builder-Updates veröffentlicht: Was ist neu?</a></li>
<li><a href="../de469099/index.html">Testaufgaben beim Interview des Entwicklers - macht das Sinn?</a></li>
<li><a href="../de469101/index.html">Englisch lernen: wie man lernt, als Muttersprachler zu sprechen</a></li>
<li><a href="../de469109/index.html">Holzspielzeug, Teil Drei - 1989</a></li>
<li><a href="../de469111/index.html">Objekt durch var ersetzen: Was könnte schief gehen?</a></li>
<li><a href="../de469115/index.html">Discovery.js-Handbuch: Schnellstart</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>