<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏴‍☠️ 🎟️ 👷🏻 DEFCON-Konferenz 27. Profitieren Sie von Hacker-Produkten für macOS. Teil 1 🌤️ 🛫 👐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Briefing-Reden . Immer wenn ein neues Beispiel für Malware für macOS entdeckt wird, haben wir die Möglichkeit, neue Hacking-Möglichkeiten zu evaluiere...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DEFCON-Konferenz 27. Profitieren Sie von Hacker-Produkten für macOS. Teil 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/474418/"><blockquote>  <sup><b>Briefing-Reden</b> .</sup>  <sup>Immer wenn ein neues Beispiel für Malware für macOS entdeckt wird, haben wir die Möglichkeit, neue Hacking-Möglichkeiten zu evaluieren, die wir zu unserem eigenen Vorteil nutzen können.</sup>  <sup>Ich meine, das Leben ist kurz, warum sollte man es damit verbringen, eigene Malware zu schreiben?</sup> <sup><br><br></sup>  <sup>Wir beginnen diese Diskussion mit der Erörterung einer Methode zur Anpassung an den „persönlichen Gebrauch“ vorhandener Malware, wobei sowohl die Nachteile als auch die Vorteile dieses Ansatzes hervorgehoben werden.</sup>  <sup>Anschließend werden verschiedene Malware-Beispiele für macOS bewaffnet, darunter eine interaktive Hintertür, ein Implantat zur Exfiltration von Dateien, Ransomware und sogar Adware.</sup>  <sup>Unsere Einstellungen umfassen verschiedene binäre Änderungen der Laufzeit, die diese Schadprogramme dazu zwingen, Aufgaben von unseren eigenen C &amp; C-Servern anzunehmen und / oder automatisch Aktionen in unserem Namen auszuführen.</sup> <sup><br><br><img src="https://habrastorage.org/webt/tv/rl/4e/tvrl4ea4ei1bog3dekukhvmico8.jpeg"><br><br></sup>  <sup>Natürlich werden diese Proben jetzt in ihrem ursprünglichen Zustand von Antivirenprodukten nachgewiesen.</sup>  <sup>Daher werden wir Änderungen in Betracht ziehen, die die Unsichtbarkeit unserer "Hacker" -Tools für herkömmliche Antivirenprogramme sicherstellen.</sup> <sup><br><br></sup>  <sup>Zusammenfassend betrachten wir neue heuristische Methoden, die solche Bedrohungen weiterhin erkennen können, um Mac-Benutzer auch vor solchen modifizierten Bedrohungen zu schützen.</sup>  <sup>Warum wird das benötigt?</sup>  <sup>Weil dies ein normaler Zyklus menschlicher Entwicklung ist und wir einfach nicht erkennen, dass die Zerstörung, die wir sehen, die Einführung neuer Technologien bedeutet, die vor der Schaffung neuer Arbeitsplätze alte zerstören.</sup> </blockquote><a name="habracut"></a>  Grüße an alle, heute werden wir das Thema der Schaffung von "Massenvernichtungswaffen" auf der Basis von MacOS-Hacking-Produkten diskutieren.  Mein Name ist Patrick, ich bin ein Synack-Analyst bei Digital Security und ich bin auch der Schöpfer der Mac-Sicherheitswebsite und der kostenlosen Objective-See-Sicherheitssuite für macOS. <br><br>  Wir werden darüber sprechen, die Malware anderer Leute für ihre eigenen geheimen Zwecke neu zu erstellen, und ich werde erklären, warum dies eine großartige Idee ist.  Dann werde ich zeigen, wie genau verschiedene Beispiele von Malware für Mac neu erstellt werden, und da wir möchten, dass unsere Exploits sowohl für die integrierten Antiviren-Dienste von Apple als auch für Antivirensoftware von Drittanbietern unsichtbar bleiben.  Am Ende werden wir uns mit verschiedenen gängigen Techniken zur Erkennung dieses überarbeiteten Softwareprodukts befassen, da unser oberstes Ziel darin besteht, sicherzustellen, dass Mac-Benutzer vor solchen Bedrohungen geschützt sind. <br><br>  Beginnen wir mit einem Schema, das den Prozess der Wiederverwendung von Malware für Ihre eigenen Anforderungen konzeptionell erklärt. <br><br><img src="https://habrastorage.org/webt/ar/0h/qq/ar0hqqjxnmmdzvxhgdyo22--8bc.jpeg"><br><br>  Stellen Sie sich vor, Hacker A hat sorgfältig hochentwickelte Malware mit vollem Funktionsumfang entwickelt und sie mit verschiedenen Computersystemen auf der ganzen Welt infiziert.  Hacker B hat es geschafft, diese Malware versehentlich zu erreichen oder sie aus einem infizierten System zu extrahieren.  Dieser Hacker legt eine Probe dieses Produkts in sein Labor und legt die Unterlagen ab.  Wenn wir über das Neuprofilieren sprechen, meinen wir, einige der vorhandenen Malware entsprechend Ihren Anforderungen neu zu gestalten oder zu konfigurieren. <br><br>  Die Folie zeigt, dass Hacker B diese Software nach der Änderung gegen neue Ziele einsetzen kann, gegen eine andere Infrastruktur als die, für die sie von Hacker A entwickelt wurde. Dies ist eine ziemlich vernünftige Idee.  Sie fragen sich vielleicht, warum dies notwendig ist, aber wir können mindestens zwei Gründe nennen, warum sich dies lohnt. <br><br><img src="https://habrastorage.org/webt/je/92/ar/je92arzrz5ywc4c2ehpl1yijpci.jpeg"><br><br>  Erstens gibt es gut finanzierte Organisationen, hochmotivierte und technisch bewaffnete Gruppen, Hacker, die für Regierungsbehörden wie die CIA arbeiten, und ganze wissenschaftliche Labors, die unglaublich bösartige Software entwickeln.  Darüber hinaus wurde diese voll ausgestattete Software vor Ort wiederholt getestet. <br><br>  Da ich ziemlich faul bin und anstatt zu programmieren, mich lieber am Strand suhlen, surfen oder Yoga machen möchte, dachte ich: Da diese Leute eine so effektive Hacker-Software erstellen, warum sie nicht verwenden und für Ihre Bedürfnisse neu erstellen?  Lassen Sie diejenigen, die mehr Zeit und Geld haben, die ganze harte Arbeit für mich tun. <br><br>  Zweitens, wenn jemand unsere konvertierten Programme findet, wird seine Urheberschaft immer noch den ursprünglichen Entwicklern und nicht uns zugeschrieben, und das ist sehr gut.  Sie könnten fragen: "OK, Patrick, wenn dies eine so coole Idee ist, warum haben die Leute das noch nicht getan?"  Ich werde antworten: "Sie machen das!"  Ich kann nichts speziell kommentieren, aber die öffentlich zugänglichen Folien zeigen, dass die NSA das Neuprofilieren von Malware verwendet hat, um die Schwachstellen beliebter Antivirenprogramme zu testen.  Die New York Times berichtete, dass chinesische Hacker ebenfalls eine ähnliche Technik anwenden. <br><br>  Die Verwendung einer überarbeiteten Hacker-Software verschafft diesen wohlhabenden Agenturen einen doppelten Vorteil.  Erstens verwenden sie in anderen Ländern entwickelte Spyware gegen die Ziele, dass eine andere Agentur, ein anderes Land oder eine Cyberspionage-APT-Gruppe bereits mit geringem Risiko arbeitet.  Wenn Sie beispielsweise in der NSA arbeiten und in ein Objekt hacken, das andere Hacker bereits ausführen, aber dort keinen eigenen Code einfügen möchten, können Sie sicher überarbeitete Software von Drittanbietern verwenden.  Gleichzeitig bleibt Ihre Aktivität geheim, da es bereits diejenigen gibt, die dies überhaupt verdächtigen. <br><br><img src="https://habrastorage.org/webt/yi/v2/go/yiv2golydkeg9sy7da-izvcobzq.jpeg"><br><br>  Da solche Agenturen es vorziehen, heimlich zu arbeiten, sind sie nicht daran interessiert, dass jemand etwas über ihre Beteiligung an solchen Angelegenheiten erfährt, und überarbeitete Software trägt dazu bei.  Natürlich treten Probleme bei der Änderung von Hacker-Programmen auf, über die wir heute sprechen werden. <br><br><img src="https://habrastorage.org/webt/bi/81/en/bi81enenfuz14twl3sjbqwh2qwe.jpeg"><br><br>  Aber wir werden sehen, dass diese Probleme nicht unüberwindbar sind.  Angenommen, wir haben ein Stück Malware eines anderen zum Remake übernommen.  Erstens haben wir keinen Quellcode, es gibt nur ein Beispiel für Binärcode, daher müssen wir Reverse Engineering verwenden.  Ich nenne dies die Phase der Analyse, in der wir versuchen zu verstehen, was diese Software tut, wie sie implementiert ist, wie sie installiert ist, welche Funktionen sie hat und natürlich herausfinden, mit welchem ​​C &amp; C-Server sie kommuniziert. <br><br>  Nachdem wir uns mit all dem befasst haben, beginnt die zweite Phase - herauszufinden, wie Sie diese Malware patchen können.  Da wir keine Quelle haben, entwickeln wir einen Patch auf Binärebene. <br><br>  Da diese Software in den meisten Fällen mit ihrem eigenen C &amp; C-Server interagiert, erfahren wir, wie sie herausfindet, woher die Adresse dieses Servers stammt und welches Protokoll für den Datenaustausch verwendet wird.  Erst danach können Sie Ihren eigenen C &amp; C-Server erstellen, auf dem die überarbeitete Software bereitgestellt wird, um von dort aus mit dem neuen infizierten System zu interagieren. <br><br>  Da wir bekannte Malware verwenden, weisen Apple oder andere Antivirensicherheitssysteme höchstwahrscheinlich Signaturen für diese Bedrohung auf.  Daher müssen wir in der letzten Phase der Neuprofilierung herausfinden, wie die Erkennung von überarbeiteter Software verhindert werden kann. <br><br>  Das Re-Profiling muss sehr verantwortungsbewusst angegangen werden, wenn nicht wirklich schlimme Dinge passieren sollen. <br><br><img src="https://habrastorage.org/webt/dw/pm/vf/dwpmvfoigcizeeajk4o828oppo4.jpeg"><br><br>  Lassen Sie mich Ihnen ein Beispiel geben, wie wir versucht haben, eine Malware für macOS neu zu erstellen.  Während des Patch-Vorgangs haben wir vergessen, die Sicherungsadresse in den Hacker-C &amp; C-Server zu ändern.  Wir waren uns sicher, dass wir einen vollständig überarbeiteten Teil der Malware verwenden, aber irgendwann haben wir ein Backup an den ursprünglichen Hacker-Server gesendet, um ihm Zugriff auf die von uns angegriffene Infrastruktur zu gewähren.  Daher muss die Veränderung der Software anderer Personen sehr sorgfältig angegangen werden. <br><br>  Lassen Sie uns nun speziell über das Remake von Malware für Mac sprechen, deren Zweck darin besteht, die Hacker-Software eines anderen zu erstellen. <br><br><img src="https://habrastorage.org/webt/8p/av/zi/8pavzimr-jwncqt12sypeb-vbeg.jpeg"><br><br>  Der erste Schritt besteht darin, ein Beispiel für Malware für die Konvertierung anhand von zwei Kriterien auszuwählen.  Das erste ist herauszufinden, dass diese Malware Ihnen eine Vorstellung davon geben sollte, ob Sie eine interaktive Hintertür oder einen Crypto Miner usw. benötigen. <br><br><img src="https://habrastorage.org/webt/oq/ko/r0/oqkor0zgt6egkpgqcg0heexqbx4.jpeg"><br><br>  Vielleicht ist Ihnen die Zuweisung von Spyware wichtig - ob sie der CIA oder russischen Hackern zugeschrieben wird.  Auf objectiv-see.com haben wir eine beeindruckende Sammlung von Malware für macOS zusammengestellt.  Alle Beispiele für überarbeitete Software, über die wir heute sprechen werden, können von dieser Website heruntergeladen werden. <br><br>  Sobald Sie eine Probe zur Änderung ausgewählt haben, ist die Zeit für die Analyse gekommen.  Sein Hauptzweck ist es, Dinge wie Fernzugriff herauszufinden.  Wenn Malware auf einen Remote-C &amp; C-Server zugreift, müssen Sie herausfinden, um welche Art von Server es sich handelt und ob es möglich ist, die Software so zu ändern, dass sie uns nicht kontaktieren kann. <br><br><img src="https://habrastorage.org/webt/el/19/oz/el19ozfoidikywbelmn87bjzbao.jpeg"><br><br>  Wenn die Malware nicht mit dem Remote-Server kommuniziert, müssen wir uns noch mit dem Protokoll befassen, um zu wissen, wie dieses Programm zu rätseln ist, wenn es erneut eine Verbindung zu uns herstellt.  Und natürlich müssen Sie die Funktionen dieser Malware vollständig verstehen - wie sie funktioniert, wie sie mit dem System interagiert, auch aus der Ferne, um zu wissen, mit welchen Befehlen Sie Malware fernsteuern können. <br><br>  Sobald Sie alles herausgefunden haben, ist es Zeit, neu zu konfigurieren oder neu zu profilieren.  Dies bedeutet normalerweise, dass Sie Malware auf Binärebene patchen müssen. <br><br><img src="https://habrastorage.org/webt/op/2b/am/op2bamloaosdoqg6wkhjbv-sik0.jpeg"><br><br>  Diese Folie zeigt, dass wir die Adresse des ursprünglichen C &amp; C-Servers gefunden haben, der in den Code eingebettet ist, und diese durch die Adresse ersetzen können, die wir im HEX-Editor benötigen.  Dies bedeutet, dass diese Software nach der Änderung mit unserem eigenen Server kommunizieren und Aufgaben von dort empfangen kann. <br><br>  Wie gesagt, wenn die Malware eine Hintertür oder ein Implantat ist und vom ursprünglichen C &amp; C-Server aus gesteuert wird, müssen wir unseren eigenen Verwaltungsserver schreiben und sicherstellen, dass das Programm angemeldet und mit ihm verbunden ist, damit wir alle seine Funktionen remote nutzen können. <br><br><img src="https://habrastorage.org/webt/kf/i9/cn/kfi9cnlonrkb7gwzsdwrtprreta.jpeg"><br><br>  Ein benutzerdefinierter C &amp; C-Server sollte nicht zu kompliziert sein. Schreiben Sie einfach ein kompetentes Python-Skript. Wenn Sie jedoch vorhaben, Ihre Software gegen viele Ziele einzusetzen, benötigen Sie möglicherweise etwas Ernsthafteres.  In der vorherigen DefCon wurde erläutert, wie einer dieser C &amp; C-Server für die Analyse von Softwarebeispielen erstellt wird.  Es ist wahrscheinlich, dass sich jedes der zu analysierenden Beispiele von den anderen unterscheidet, die ein anderes Protokoll verwenden. Daher benötigen Sie für jedes Beispiel der konvertierten Software einen separaten C &amp; C-Server. <br><br><h3>  FruitFly Backdoor neu gestalten </h3><br>  Schauen wir uns ein echtes Beispiel für die Neugestaltung von Malware für Mac an.  Diese Hintertür wurde vor etwa 15 Jahren von den Mac-Sicherheitsexperten erstellt und heißt FruitFly oder Fruit Fly. <br><br>  Diese voll ausgestattete Backdoor, die Remote-Multitasking unterstützt, hat uns als idealen Kandidaten für die Neuprofilierung gedient.  Es kann Dateien und Systemprozesse infizieren, eine Webcam und eine Befehlszeile steuern, als Keylogger dienen, Screenshots vom Desktop des Opfers aus der Ferne erstellen und Informationen über infizierte Computer unter macOS sammeln.  Wir wollten all diese Funktionen nutzen, um unsere eigenen Probleme zu lösen. <br><br><img src="https://habrastorage.org/webt/q2/ig/bv/q2igbv8bxidoucqh398afrut0w4.jpeg"><br><br>  Die FruitFly-Hintertür war ein sehr verwirrendes Perl-Skript, aber wenn Sie es sich genau ansehen, können Sie sehen, dass seine Logik Befehlszeilenargumente verarbeitet.  Wir können sagen, dass dieses Skript prüft, ob bestimmte Befehlszeilenoptionen oder Flags dazu führen, dass es etwas unternimmt. <br><br><img src="https://habrastorage.org/webt/m_/jc/ho/m_jchouqkbuxw5dh0zi7rafbayg.jpeg"><br><br>  Es stellt sich heraus, dass er nach einem Port oder einer Kombination von Ports sucht, um Ihren Computer mit seinem C &amp; C-Server zu verbinden.  Dies bedeutet, dass wir das ursprüngliche Perl-Skript oder eine schädliche Binärdatei nicht wiederholen müssen, wenn wir über die Befehlszeile eine Richtung zu unserem eigenen Server erstellen können. <br><br>  Wir begannen herauszufinden, ob es möglich ist, dieses FruitFly-Skript als Launcher zu speichern.  Wie auf der Folie gezeigt, können wir die Adresse unseres eigenen C &amp; C-Servers darin einbetten.  Dies bedeutet, dass wir diese Hintertür einfach neu profilieren können, um eine Verbindung zu unserem Server herzustellen, wobei die Verbindung mit dem ursprünglichen Hacker-Server umgangen wird. <br><br><img src="https://habrastorage.org/webt/8k/9k/hc/8k9khcoxopqticqaojsmrgwdhig.jpeg"><br><br>  Um diese Backdoor zu verwenden, muss sie jedoch auf dem Computer des Benutzers installiert sein.  Die gute Nachricht ist, dass ich bereits ein solches Installationsprogramm geschrieben habe, das auf pastebin.com verfügbar ist.  Es sind ein paar Codezeilen, die Malware genauso installieren wie die ursprüngliche Hintertür.  Da ich zuvor auch einen C &amp; C-Server geschrieben habe, um dieses Beispiel zu analysieren, können wir beginnen, seine Funktionsweise zu demonstrieren. <br><br>  Echtzeit-Demonstrationen wie diese sind immer ein Risiko, daher werde ich diese Malware auf meinem eigenen Forschungs-Laptop ausführen, nicht auf einer virtuellen Maschine.  Ich wiederhole: Ich möchte Ihnen die volle Leistungsfähigkeit der konvertierten Malware zeigen, und die Demonstration unter realen Bedingungen ist glaubwürdiger. Schauen wir uns diese Software in Aktion auf einer echten Hardware an. <br><br>  Als erstes müssen Sie den C &amp; C-Server starten.  Sie sehen, dass das System jetzt auf eine Verbindung wartet.  Anschließend müssen Sie Malware über das Installationsprogramm ausführen und die IP-Adresse dieses Servers übergeben.  Nach dem Start sehen wir auf der rechten Seite des Fensters, dass Malware erfolgreich eine Verbindung zu unserem C &amp; C-Server hergestellt hat.  Wir sehen auch eine ganze Reihe von Hacking-Aufgaben, die diese Malware für Prozesse verwenden kann, die auf meinem persönlichen Laptop ausgeführt werden. <br><br><img src="https://habrastorage.org/webt/vl/n0/lw/vln0lwtlwelhpdr3y1v8zfasxkk.jpeg"><br><br>  Die Ausführung von Befehl Nr. 13 zeigt, wo diese Malware im Verzeichnis / Users / Patrick / fpsaud installiert ist.  Mit Befehl Nr. 2 können Sie einen Screenshot erstellen, und mit Parameter 0 können Sie einen Vollbild-Screenshot erstellen. <br><br><img src="https://habrastorage.org/webt/mp/pc/3b/mppc3blujqwwj7mbaey7s33fvpg.jpeg"><br><br>  Jetzt werde ich versuchen, einen Screenshot zu machen und ihn an unseren C &amp; C-Server zu senden.  Wie Sie sehen können, funktioniert alles so, wie es sollte.  So funktioniert die neu gestaltete FruitFly-Hintertür. <br><br><h3>  Änderung des Miner CreativeUpdate </h3><br>  Als Nächstes werden wir darüber sprechen, CreativeUpdate Cryptocurrency Miner für unsere Zwecke neu zu erstellen.  Dies ist nützlich, wenn Sie die Computer anderer Personen für das Crypto Mining verwenden möchten, aber gleichzeitig keine Zeit, Fähigkeiten und Ressourcen haben. <br><br><img src="https://habrastorage.org/webt/jg/wu/lp/jgwulpzh_d6c6qfz2fg597-cdrw.jpeg"><br><br>  Dieser Crypto Miner ist in Trojaner integriert und wird über beliebte Anwendungen von Drittanbietern von MacUpdate.com vertrieben.  Die Folie zeigt ein Beispiel für die Installation des Firefox Quantum-Browsers, der nicht über die Signatur des ursprünglichen Mozila-Entwicklers verfügt und einen Crypto Miner von einem der Adobe Creative Cloud-Server auf den Computer des Benutzers herunterlädt. <br><br><img src="https://habrastorage.org/webt/9a/ru/an/9aruanbz7pv85jg0irp7mgfjzb0.jpeg"><br><br>  Wenn wir ein infiziertes Disk-Image mit einem solchen Trojaner mounten und Reverse Engineering auf die Hauptbinärdatei anwenden, werden wir feststellen, dass es eine Methode namens "Skript mit Drucken ausführen" - "Skript mit Drucken ausführen" verwendet.  Wenn Sie sich ansehen, was es mit einem Dekompiler oder Disassembler macht, können Sie sehen, dass es einfach eine Datei namens "Skript" außerhalb des Ressourcenverzeichnisses der Anwendung ausführt.  Zunächst startet er ein Trojaner-Programm unter dem Deckmantel einer Kopie eines beliebten Produkts, das der Benutzer auf seinen Computer heruntergeladen hat, beispielsweise den Firefox-Browser, damit er nichts Schlimmes vermutet. <br><br><img src="https://habrastorage.org/webt/yr/ie/2e/yrie2eidsplxe3up0v9cb5nyy9o.jpeg"><br><br>  Als nächstes sehen wir in diesem Skript, dass es mit dem Angreifer-Server kommuniziert, von wo es das Archiv mdworker.zip herunterlädt.  Während des Entpackens installiert dieses Archiv etwas namens mdworker auf dem System.  Wenn Sie sich die aus dem Archiv extrahierte MacOS.plist-Datei ansehen, sehen Sie, dass diese sehr schädliche mdworker-Binärdatei auf dem Computer des Benutzers gespeichert wird. <br><br><img src="https://habrastorage.org/webt/rx/i6/uq/rxi6uqgxuqtjbqcq5inuwtjuzag.jpeg"><br><br>  Wir sehen auch Befehlszeilenargumente, die an diese Binärdatei übergeben werden.  Wenn Sie diese binäre mdworker-Datei ausführen, können Sie sehen, dass es sich um einen vollständig legalen Cryptocurrency Miner handelt, der der Mining-Firma Miner Gate gehört. <br><br>  Die Befehlszeilenargumente geben auch das Miner-Konto an, an das die Ergebnisse des Mining und die Art der Kryptowährung für das Mining gesendet werden. <br><br>  Da die entsprechenden Parameter über die Befehlszeile übergeben und nicht in eine Binärdatei eingebettet werden, können wir wie im Fall von Fruit Fly Befehlszeilenargumente ersetzen, um diese Malware für unsere Zwecke wiederzuverwenden.  Daher ändern wir zuerst die Datei der Eigenschaftsliste, die Eigenschaftsliste oder die .plist der Malware so, dass sie auf unser eigenes Miner-Konto verweist, und packen erneut alle Komponenten der Malware in das Archiv.  Anstatt das Archiv vom Server herunterzuladen, fügen wir es einfach der Malware-Anwendung hinzu.  Dies ist viel einfacher und autonomer, da wir keinen Remote-Server zum Booten konfigurieren müssen. <br><br>  Als Nächstes konfigurieren wir das Skript neu, damit es mit dem von uns hinzugefügten Archiv funktioniert.  Schließlich verpacken wir alles in ein Firefox.dmg-Image und können uns an die Arbeit machen. <br><br><img src="https://habrastorage.org/webt/xb/hl/c7/xbhlc73ts2ofwqfcdl0--pjifw4.jpeg"><br><br>  Ich mache Sie auf die zweite Demo aufmerksam.  Im Dateifenster sehen Sie Anwendungskomponenten, einschließlich eines schädlichen Skripts, des Archivs mdworker.zip, der Anwendungseinstellungsdatei AppSettings.plist und des ursprünglichen Firefox-Browsers. <br><br><img src="https://habrastorage.org/webt/qc/y9/0q/qcy90qwhi2c_htghgujrjbhlxog.jpeg"><br><br>  Im Hauptfenster sehen wir, wie der vom Benutzer heruntergeladene Inhalt beim Start aussieht. <br><br><img src="https://habrastorage.org/webt/si/6-/qi/si6-qizmthmtmeipzrludaaxjne.jpeg"><br><br>       ,       .     ,      Firefox     . <br><br>  ,          ,       macOS.  ,         mdworker,    ,          patrick@objective-see.com. <br><br><h3> - ransomware </h3><br>      ,    , ,     - ransomware,       . <br><br><img src="https://habrastorage.org/webt/7t/wn/rv/7twnrvk1wk853o2hvg_my32qkbm.jpeg"><br><br>     ,    KeRanger.    ,       macOS.           Bit-Torrent,    -.    ,   ,     . <br><br>    ,        General.rtf.     ,    ,    macOS.       ,      C&amp;C-        . <br><br><img src="https://habrastorage.org/webt/mi/eo/6i/mieo6iymxpoxcg116xarhs3izgg.jpeg"><br><br>         ,    ,    ,  «»  .    -. <br><br>      . -,      ,          . <br><br><img src="https://habrastorage.org/webt/u6/ng/bt/u6ngbtuxi7brtza2nfjpth_l2zu.jpeg"><br><br>    ,       ,        HEX-  ,   «»,       C&amp;C-,      127.0.0.1.     RSA    ,     RSA-         ,              NetCat. <br><br>     .   ,  ,    KeRanger. NetCat     ,      . <br><br><img src="https://habrastorage.org/webt/an/fz/el/anfzelfpla0mab3nqouakkukl_w.jpeg"><br><br>     ,             . <br><br><img src="https://habrastorage.org/webt/90/4c/nt/904cntgxcyw4fcvfxx1wogob-la.jpeg"><br><br>               README_FOR_DECRIPT.txt.    ,    : «      wardle@objective-see.com!». <br><br><img src="https://habrastorage.org/webt/at/rf/ag/atrfagcuscbsrisiysy4atpxbhe.jpeg"><br><br><h3>  Windtall </h3><br>       Windtall.   ,     ,     APT-.      ,       . <br><br><img src="https://habrastorage.org/webt/sk/ub/66/skub66ctvfoeenocme7-j8b0eea.jpeg"><br><br>          malware.            macOS,  ,  URL-. <br><br>         ,        .         ,   ,    , macOS       Custom URL,    ,    . <br><br>        ,  , ,  -   URL,  macOS   . <br><br>     Java     .    ,     URL,     Mac.     Java-,        URL,     . <br>   ,  ,       ,     ,       . <br><br><img src="https://habrastorage.org/webt/kw/-s/kf/kw-skfacnumohxmrjnbo_jkz9po.jpeg"><br><br>   ,   ,      . ,  ,         ,         ,          C&amp;C-      . <br><br>      .          SPF, ,       C&amp;C-,         , ,         C&amp;C-. <br><br><img src="https://habrastorage.org/webt/-q/ig/vd/-qigvdzvffym3nebnatyn_zvtek.jpeg"><br><br>  24:00 <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> DEFCON 27.       macOS.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/InL3YA_6P6s" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Ein bisschen Werbung :) </h3><br>  Vielen Dank für Ihren Aufenthalt bei uns.  Mögen Sie unsere Artikel?  Möchten Sie weitere interessante Materialien sehen?  Unterstützen Sie uns, indem Sie eine Bestellung aufgeben oder Ihren Freunden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cloud VPS für Entwickler ab 4,99 USD</a> empfehlen. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dies</a> ist ein <b>30% iger Rabatt für Habr-Benutzer auf ein einzigartiges Analogon von Einstiegsservern, das wir für Sie erfunden haben:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die ganze Wahrheit über VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s ab 20 US-Dollar oder wie man einen Server freigibt?</a>  (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verfügbar). <br><br>  <b>Dell R730xd 2 mal günstiger?</b>  Nur wir haben <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2 x Intel TetraDeca-Core Xeon 2 x E5-2697v3 2,6 GHz 14C 64 GB DDR4 4 x 960 GB SSD 1 Gbit / s 100 TV ab 199 US-Dollar</a> in den Niederlanden!</b>  <b><b>Dell R420 - 2x E5-2430 2,2 GHz 6C 128 GB DDR3 2x960 GB SSD 1 Gbit / s 100 TB - ab 99 US-Dollar!</b></b>  Lesen Sie mehr über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das Erstellen von Infrastruktur-Bldg.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse mit Dell R730xd E5-2650 v4 Servern für 9.000 Euro für einen Cent?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de474418/">https://habr.com/ru/post/de474418/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de474402/index.html">API-Handbuch für Vavr-Sammlungen</a></li>
<li><a href="../de474404/index.html">Analyse der gelösten Probleme aus der Programmiermeisterschaft von Yandex (Frontend-Entwicklung) 2019</a></li>
<li><a href="../de474406/index.html">BlueKeeps erster Auftritt in freier Wildbahn wurde aufgezeichnet</a></li>
<li><a href="../de474408/index.html">Revolution oder Evolution des Seitenobjektmodells?</a></li>
<li><a href="../de474414/index.html">Wir schreiben unseren eigenen Voxelmotor</a></li>
<li><a href="../de474420/index.html">Thermostatbildung: wie es passiert ist</a></li>
<li><a href="../de474422/index.html">Spannende Open Source-Plattformen für die Entwicklung mobiler Anwendungen</a></li>
<li><a href="../de474424/index.html">Blended Training - was ist das und wie funktioniert es?</a></li>
<li><a href="../de474426/index.html">Die Zeichentrickserie "Mathematical Circle"</a></li>
<li><a href="../de474430/index.html">DevOpsDays Moskau - eine Konferenz, die die Community für die Community veranstaltet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>