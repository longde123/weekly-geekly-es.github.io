<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñïüèΩ ü§ê üë©üèæ‚Äç‚öñÔ∏è Acesse o 2FA seguro na blockchain ‚§µÔ∏è üîß ü§æüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As mensagens SMS s√£o o m√©todo mais popular de autentica√ß√£o de dois fatores (2FA). √â usado por bancos, carteiras eletr√¥nicas e de criptografia, caixas ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Acesse o 2FA seguro na blockchain</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476090/">  As mensagens SMS s√£o o m√©todo mais popular de autentica√ß√£o de dois fatores (2FA).  √â usado por bancos, carteiras eletr√¥nicas e de criptografia, caixas de correio e todos os tipos de servi√ßos;  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o n√∫mero de usu√°rios do m√©todo est√° se aproximando de 100%</a> . <br><br>  Eu tenho um tal surto de eventos √© ultrajante, porque este m√©todo √© inseguro.  Reatribua o n√∫mero de um cart√£o SIM para outro iniciado no in√≠cio da era m√≥vel - √© assim que o n√∫mero √© restaurado quando o SIM √© perdido.  Os ‚Äúespecialistas em desmame de dinheiro digital‚Äù perceberam: a op√ß√£o ‚Äúsubstituir cart√µes SIM‚Äù pode ser usada em esquemas fraudulentos.  Afinal, quem controla o cart√£o SIM pode gerenciar servi√ßos banc√°rios on-line, carteiras eletr√¥nicas e at√© criptomoedas de outras pessoas.  E voc√™ pode assumir o n√∫mero de outra pessoa subornando um funcion√°rio de telecomunica√ß√µes usando fraude ou documentos falsos. <br><br><img src="https://habrastorage.org/webt/sm/lg/oh/smlgohi_vtrtginwsqvp3t2jqy8.png"><br><br>  Milhares de epis√≥dios de troca de SIM foram descobertos - √© assim que esse esquema de fraude foi chamado.  A escala do desastre sugere que o mundo em breve abandonar√° o 2FA via SMS.  Mas isso n√£o acontece - o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estudo</a> diz que n√£o s√£o os usu√°rios que escolhem o m√©todo 2FA, mas os propriet√°rios do servi√ßo. <br><br>  Sugerimos o uso do m√©todo 2FA seguro com a entrega de c√≥digos √∫nicos via blockchain e informaremos como conect√°-lo ao propriet√°rio do servi√ßo. <br><a name="habracut"></a><br><h2>  A conta vai para milh√µes </h2><br>  Em 2019, a fraude de troca de SIM aumentou 63%, de acordo com a pol√≠cia de Londres, e a ‚Äúverifica√ß√£o m√©dia‚Äù do atacante foi de 4.000 libras esterlinas.  N√£o encontrei estat√≠sticas na R√∫ssia, mas presumo que seja ainda pior. <br><br>  A troca de SIM √© usada para roubar populares Twitter, Instagram, Facebook, contas VK, contas banc√°rias e recentemente chegou a criptomoedas, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relata o jornal Times</a> do empres√°rio de bitcoin Joby Weeks.  Casos de alto perfil de roubo de criptomoedas com a ajuda da troca de SIM surgiram na imprensa desde 2016;  em 2019, chegou um pico real. <br><br>  Em maio, promotores dos EUA no distrito leste de Michigan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">indiciaram</a> nove jovens entre 19 e 26 anos de idade: supostamente eram membros de uma gangue de hackers chamada The Community.  A quadrilha √© acusada de sete ataques de swap, como resultado dos quais hackers se apropriaram de criptomoedas no valor de mais de US $ 2,4 milh√µes.  E em abril, um estudante da Calif√≥rnia, Joel Ortiz, recebeu 10 anos de pris√£o por troca de SIM;  US $ 7,5 milh√µes em criptomoedas se tornaram sua presa. <br><br><img src="https://habrastorage.org/webt/xy/b4/61/xyb4614ligd5ao0hslycslmxq3u.jpeg"><br>  <i>Foto de Joel Ortiz em uma confer√™ncia de imprensa da universidade.</i>  <i>Dois anos depois, ele ser√° detido por fraude cibern√©tica.</i> <br><br><h2>  O princ√≠pio da troca de SIM </h2><br>  Swap significa troca.  Em todos esses esquemas, os criminosos atribuem o n√∫mero de telefone da v√≠tima, geralmente atrav√©s da reemiss√£o de um cart√£o SIM, e o usam para redefinir uma senha.  Uma troca t√≠pica de SIM na teoria se parece com isso: <br><br><ol><li>  Intelig√™ncia.  Os fraudadores descobrem os dados pessoais da v√≠tima: nome e telefone.  Eles podem ser encontrados em fontes abertas (redes sociais, amigos) ou obtidas de um c√∫mplice - um funcion√°rio de uma operadora de celular. </li><li>  Bloqueio.  O cart√£o SIM da v√≠tima est√° desativado;  Para fazer isso, basta ligar para o suporte t√©cnico do provedor, informar o n√∫mero e dizer que o telefone foi perdido. </li><li>  Capturar, transferir n√∫meros para o seu cart√£o SIM.  Normalmente, isso tamb√©m √© feito atrav√©s de um c√∫mplice em uma empresa de telecomunica√ß√µes ou falsificando documentos. </li></ol><br>  Na vida real, √© ainda mais grave.  Os invasores selecionam uma v√≠tima e monitoram diariamente a localiza√ß√£o do telefone - um pedido de informa√ß√µes que o assinante mudou para roaming custa de 1 a 2 centavos.  Assim que o propriet√°rio do cart√£o SIM for para o exterior, eles concordam com o gerente no sal√£o de comunica√ß√£o para emitir um novo cart√£o SIM.  Custa cerca de US $ 50 (eu encontrei informa√ß√µes - em diferentes pa√≠ses e de diferentes operadoras, de US $ 20 a US $ 100), enquanto o gerente ser√° demitido na pior das hip√≥teses - n√£o h√° responsabilidade por isso. <br><br>  Agora, todos os invasores receber√£o todos os SMS e o propriet√°rio do telefone n√£o poder√° fazer nada a respeito - ele est√° no exterior.  E ent√£o os vil√µes t√™m acesso a todas as contas da v√≠tima e, se desejado, alteram as senhas. <br><br><h2>  Chances de devolver mercadorias roubadas </h2><br>  √Äs vezes, os bancos v√£o em dire√ß√£o √†s v√≠timas e retiram as transfer√™ncias de suas contas.  Portanto, √© poss√≠vel devolver dinheiro fiduci√°rio, mesmo que o infrator n√£o seja encontrado.  Mas com as carteiras de criptomoedas, tudo √© mais complicado - tanto <i>t√©cnica</i> quanto legalmente.  At√© o momento, nenhuma bolsa / carteira pagou uma compensa√ß√£o para trocar as v√≠timas. <br><br>  Se as v√≠timas querem defender seu dinheiro em ju√≠zo, acusam o operador: ele criou as condi√ß√µes para o roubo de dinheiro da conta.  Foi exatamente o que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Michael Turpin fez</a> , que perdeu US $ 224 milh√µes devido √† troca e agora est√° processando a empresa de telecomunica√ß√µes AT&amp;T. <br><br><img src="https://habrastorage.org/webt/1d/bx/cp/1dbxcp8cbskbzhc8dlpwm3rqggm.png"><br><br>  At√© o momento, nenhum estado possui esquemas de trabalho para proteger legalmente os propriet√°rios de criptomoedas.  √â imposs√≠vel segurar seu capital ou receber uma compensa√ß√£o por sua perda.  Portanto, impedir um ataque de troca √© mais f√°cil do que combater suas consequ√™ncias.  A maneira mais √≥bvia √© usar um "segundo fator" mais confi√°vel para o 2FA. <br><br><h2>  A troca de SIM n√£o √© o √∫nico problema 2FA via SMS </h2><br>  Os c√≥digos de confirma√ß√£o no SMS tamb√©m n√£o s√£o seguros do ponto de vista t√©cnico.  As mensagens podem ser interceptadas devido a vulnerabilidades fatais no Sistema de Sinaliza√ß√£o 7 (SS7).  O 2FA por SMS √© oficialmente reconhecido como inseguro (o Instituto Nacional de Padr√µes e Tecnologia dos EUA fala sobre isso em seu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Guia de autentica√ß√£o digital</a> ). <br><br>  Al√©m disso, a presen√ßa do 2FA geralmente inspira o usu√°rio com uma sensa√ß√£o de falsa seguran√ßa e ele escolhe uma senha mais simples.  Portanto, essa autentica√ß√£o n√£o complica, mas facilita o acesso de um invasor √† conta. <br><br>  E, muitas vezes, os SMS v√™m com um longo atraso ou nem chegam. <br><br><h2>  Outros m√©todos 2FA </h2><br>  Obviamente, em smartphones e SMS, a luz n√£o converge.  Existem outros m√©todos 2FA.  Por exemplo, c√≥digos TAN √∫nicos: o m√©todo √© primitivo, mas est√° funcionando - ainda √© usado em alguns bancos.  Existem sistemas que usam dados biom√©tricos: impress√µes digitais, exames de retina.  Outra op√ß√£o que parece um compromisso razo√°vel em termos de conveni√™ncia, confiabilidade e pre√ßo s√£o aplicativos especiais para o 2FA: RSA Token, Google Authenticator.  E existem chaves f√≠sicas e outros m√©todos. <br><br>  Em teoria, tudo parece l√≥gico e confi√°vel.  Mas, na pr√°tica, as solu√ß√µes modernas de 2FA t√™m problemas e, por causa deles, a realidade √© diferente das expectativas. <br><br>  De acordo com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estudo</a> , o uso do 2FA √© um inconveniente em princ√≠pio, e a popularidade do 2FA via SMS √© explicada por ‚Äúmenos inconveniente em compara√ß√£o com outros m√©todos‚Äù - o recebimento de c√≥digos √∫nicos √© compreens√≠vel para o usu√°rio. <br><br>  Muitos usu√°rios de m√©todos 2FA associam-se ao medo de que o acesso seja perdido.  Uma chave f√≠sica ou uma lista de senhas da TAN podem ser perdidas ou roubadas.  Pessoalmente, tenho uma experi√™ncia negativa usando o Google Authenticator.  Meu primeiro smartphone com esse aplicativo quebrou - avalie meus esfor√ßos para restaurar o acesso √†s contas.  Outro problema √© a transi√ß√£o para um novo dispositivo.  O Google Authenticator n√£o pode exportar devido a problemas de seguran√ßa (se as chaves puderem ser exportadas, que tipo de seguran√ßa existe?).  Uma vez transferi as chaves manualmente e depois decidi que era mais f√°cil deixar o smartphone antigo em uma caixa na prateleira. <br><br>  O m√©todo 2FA deve ser: <br><br><ul><li>  Seguro - somente voc√™ deve obter acesso √† sua conta, n√£o invasores </li><li>  Confi√°vel - voc√™ obt√©m acesso √† sua conta sempre que precisar </li><li>  Conveniente e acess√≠vel - o uso do 2FA √© claro e leva um tempo m√≠nimo </li><li>  Barato </li></ul><br>  Acreditamos que o blockchain √© a solu√ß√£o certa. <br><br><h2>  Use 2FA na blockchain </h2><br>  Para um usu√°rio, o 2FA no blockchain parece o mesmo que receber c√≥digos √∫nicos via SMS.  A √∫nica diferen√ßa est√° no canal de entrega.  A maneira de obter um c√≥digo 2FA depende do que a blockchain oferece.  Em nosso projeto (as informa√ß√µes est√£o no meu perfil), este √© um aplicativo da Web, Tor, iOS, Android, Linux, Windows, MacOS. <br><br>  O servi√ßo gera um c√≥digo √∫nico e o envia para o messenger no blockchain.  Al√©m disso, de acordo com os cl√°ssicos: o usu√°rio digita o c√≥digo recebido na interface de servi√ßo e efetua login. <br><br><img src="https://habrastorage.org/webt/4a/yq/ph/4ayqphaul5iozz1f_v2g0q4ziqw.png"><br><br>  No artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como um mensageiro descentralizado funciona na blockchain,</a> escrevi que a blockchain garante a seguran√ßa e a privacidade das mensagens.  Sobre o envio de c√≥digos 2FA, destacarei: <br><br><ul><li>  Um clique para criar uma conta - sem telefones ou e-mails. </li><li>  Todas as mensagens com c√≥digos 2FA s√£o criptografadas curva de ponta a ponta25519xsalsa20poly1305. </li><li>  O ataque MITM √© exclu√≠do - cada mensagem com um c√≥digo 2FA √© uma transa√ß√£o no blockchain e √© assinada pelo Ed25519 EdDSA. </li><li>  Uma mensagem com um c√≥digo 2FA cai em seu bloco.  A sequ√™ncia e o carimbo de data e hora dos blocos n√£o podem ser fixados e, portanto, a ordem das mensagens. </li><li>  N√£o existe uma estrutura central que verifique a "autenticidade" de uma mensagem.  Isso √© feito por um sistema de n√≥s distribu√≠dos com base em consenso e pertence aos usu√°rios. </li><li>  Incapacidade de desativar - as contas n√£o podem ser bloqueadas e as mensagens podem ser exclu√≠das. </li><li>  Acesse c√≥digos 2FA de qualquer dispositivo a qualquer momento. </li><li>  Mensagem de confirma√ß√£o de entrega com c√≥digo 2FA.  Um servi√ßo que envia uma senha de uso √∫nico sabe com certeza que foi entregue.  N√£o h√° bot√µes "Enviar novamente". </li></ul><br>  Para compara√ß√£o com alguns outros m√©todos 2FA, compilei uma tabela: <br><br><img src="https://habrastorage.org/webt/pl/am/tm/plamtmeiv5xnjmupd5bevfrpftu.png"><br><br>  O usu√°rio recebe uma conta no messenger blockchain para receber c√≥digos em uma segunda senha - apenas √© usada para inserir.  Portanto, os m√©todos de aplica√ß√£o podem ser diferentes: voc√™ pode usar uma conta para obter c√≥digos para todos os servi√ßos ou criar uma conta separada para cada servi√ßo. <br><br>  H√° tamb√©m uma desvantagem - uma conta deve ter pelo menos uma transa√ß√£o.  Para que o usu√°rio receba uma mensagem criptografada com um c√≥digo, voc√™ precisa conhecer sua chave p√∫blica, e ele aparece no blockchain apenas com a primeira transa√ß√£o.  N√≥s sa√≠mos dessa maneira: eles nos deram a oportunidade de receber tokens gratuitos em nossa carteira.  No entanto, uma solu√ß√£o mais correta √© nomear a conta como uma chave p√∫blica.  (Para compara√ß√£o, nosso n√∫mero de conta <i>U1467838112172792705</i> √© um derivado da chave p√∫blica <i>cc1ca549413b942029c4742a6e6ed69767c325f8d989f7e4b71ad82a164c2ada</i> . Para o mensageiro, isso √© mais conveniente e leg√≠vel, mas para os c√≥digos 2FA do sistema de envio).  Acho que no futuro algu√©m tomar√° essa decis√£o e transferir√° "Conveni√™ncia e acessibilidade" para a zona verde. <br><br>  O custo do envio de um c√≥digo 2FA √© realmente baixo - 0,001 ADM, agora √© 0,00001 USD.  Mais uma vez, voc√™ pode aumentar sua blockchain e fazer o pre√ßo zero. <br><br><h2>  Como conectar o 2FA no blockchain ao seu servi√ßo </h2><br>  Espero ter conseguido interessar alguns leitores para adicionar autoriza√ß√£o de blockchain aos seus servi√ßos. <br><br>  Vou lhe dizer como fazer isso usando o exemplo do nosso messenger e, por analogia, voc√™ pode usar outra blockchain.  No aplicativo de demonstra√ß√£o 2FA, usamos o postgresql10 para armazenar informa√ß√µes da conta. <br><br>  Etapas de conex√£o: <br><br><ol><li>  Crie uma conta no blockchain a partir da qual voc√™ enviar√° c√≥digos 2FA.  Voc√™ receber√° uma senha, usada como chave privada para criptografar mensagens com c√≥digos e para assinar transa√ß√µes. </li><li>  Adicione um script ao seu servidor para gerar c√≥digos 2FA.  Se voc√™ j√° usa outro m√©todo 2FA com entrega de senha √∫nica, esta etapa j√° foi conclu√≠da. </li><li>  Adicione um script ao seu servidor para enviar c√≥digos para o usu√°rio no messenger blockchain. </li><li>  Crie uma interface de usu√°rio para enviar e inserir o c√≥digo 2FA.  Se voc√™ j√° usa outro m√©todo 2FA com entrega de senha √∫nica, esta etapa j√° foi conclu√≠da. </li></ol><br>  <b>1 Crie uma conta</b> <br><br>  Criar uma conta na blockchain √© a gera√ß√£o de uma chave privada, uma chave p√∫blica e um endere√ßo de conta derivado dela. <br><br><img src="https://habrastorage.org/webt/7o/at/vs/7oatvsalils_l9wsl8av5cjqtkc.png"><br><br>  Primeiro, √© gerada a senha BIP39, a partir da qual o hash SHA-256 √© considerado.  O hash √© usado para gerar a chave privada ks e a chave p√∫blica kp.  Da chave p√∫blica com o mesmo SHA-256 com invers√£o, obtemos o endere√ßo no blockchain. <br><br>  Se voc√™ deseja enviar c√≥digos 2FA sempre de uma nova conta, o c√≥digo para criar uma conta precisar√° ser adicionado ao servidor: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Mnemonic <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bitcore-mnemonic'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.passphrase = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mnemonic(Mnemonic.Words.ENGLISH).toString() ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> bip39 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bip39'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> crypto <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'crypto'</span></span> adamant.createPassphraseHash = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">passphrase</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> seedHex = bip39.mnemonicToSeedSync(passphrase).toString(<span class="hljs-string"><span class="hljs-string">'hex'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> crypto.createHash(<span class="hljs-string"><span class="hljs-string">'sha256'</span></span>).update(seedHex, <span class="hljs-string"><span class="hljs-string">'hex'</span></span>).digest() } ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sodium <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'sodium-browserify-tweetnacl'</span></span> adamant.makeKeypair = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">hash</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> keypair = sodium.crypto_sign_seed_keypair(hash) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">publicKey</span></span>: keypair.publicKey, <span class="hljs-attr"><span class="hljs-attr">privateKey</span></span>: keypair.secretKey } } ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> crypto <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'crypto'</span></span> adamant.getAddressFromPublicKey = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">publicKey</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> publicKeyHash = crypto.createHash(<span class="hljs-string"><span class="hljs-string">'sha256'</span></span>).update(publicKey, <span class="hljs-string"><span class="hljs-string">'hex'</span></span>).digest() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> temp = Buffer.alloc(<span class="hljs-number"><span class="hljs-number">8</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; i++) { temp[i] = publicKeyHash[<span class="hljs-number"><span class="hljs-number">7</span></span> - i] } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'U'</span></span> + bignum.fromBuffer(temp).toString() }</code> </pre> <br>  No aplicativo de demonstra√ß√£o, n√≥s o simplificamos - criamos uma conta no aplicativo da Web e enviamos os c√≥digos a partir dele.  Na maioria dos casos, isso √© mais conveniente para o usu√°rio: ele sabe que o servi√ßo envia c√≥digos 2FA de uma conta espec√≠fica e pode nome√°-lo. <br><br><img src="https://habrastorage.org/webt/j6/0p/pi/j60ppi_a1zvkc-ifcrdxkaz8ow8.png"><br><br>  <b>2 Gera√ß√£o de c√≥digos 2FA</b> <br><br>  O c√≥digo 2FA precisa ser gerado para cada login do usu√°rio.  Usamos a biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">speakeasy</a> , mas voc√™ pode escolher qualquer outra. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> hotp = speakeasy.hotp({ counter, <span class="hljs-attr"><span class="hljs-attr">secret</span></span>: account.seSecretAscii, });</code> </pre><br>  Valida√ß√£o do c√≥digo 2FA do usu√°rio inserido pelo usu√°rio: <br><br><pre> <code class="javascript hljs">se2faVerified = speakeasy.hotp.verify({ <span class="hljs-attr"><span class="hljs-attr">counter</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.seCounter, <span class="hljs-attr"><span class="hljs-attr">secret</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.seSecretAscii, <span class="hljs-attr"><span class="hljs-attr">token</span></span>: hotp, });</code> </pre><br>  <b>3 Enviar c√≥digo 2FA</b> <br><br>  Voc√™ pode usar a API do n√≥ blockchain, a biblioteca JS API ou o console para enviar o c√≥digo 2FA.  Neste exemplo, usamos o console - esta √© a Command Line Interface, um utilit√°rio que simplifica a intera√ß√£o com o blockchain.  Para enviar uma mensagem com um c√≥digo 2FA, voc√™ precisa usar o comando <code>send message</code> do console. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> util = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'util'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> exec = util.promisify(<span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'child_process'</span></span>).exec); ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> command = <span class="hljs-string"><span class="hljs-string">`adm send message </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${adamantAddress}</span></span></span><span class="hljs-string"> "2FA code: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${hotp}</span></span></span><span class="hljs-string">"`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> { error, stdout, stderr } = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> exec(command);</code> </pre><br>  Uma maneira alternativa de enviar mensagens √© usar o m√©todo <code>send</code> na biblioteca da API JS. <br><br>  <b>4 interface de usu√°rio</b> <br><br>  O usu√°rio precisa ter a oportunidade de inserir o c√≥digo 2FA, isso pode ser feito de v√°rias maneiras, dependendo da plataforma do seu aplicativo.  No nosso exemplo, este √© o Vue. <br><br><img src="https://habrastorage.org/webt/1g/yb/yv/1gybyvcmjucrqilrcpo74k8onoy.png"><br><br>  O c√≥digo fonte do aplicativo demo de autoriza√ß√£o de dois fatores no blockchain pode ser visualizado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub</a> .  H√° um link na demonstra√ß√£o ao vivo no Leia-me para experiment√°-lo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt476090/">https://habr.com/ru/post/pt476090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt476060/index.html">Not√≠cias do mundo do OpenStreetMap n¬∫ 485 (29.10.2019 - 04.11.2019)</a></li>
<li><a href="../pt476074/index.html">Carro el√©trico caseiro - parte 1</a></li>
<li><a href="../pt476076/index.html">Limpo demais?</a></li>
<li><a href="../pt476082/index.html">Array.splice e Array.slice em JavaScript</a></li>
<li><a href="../pt476088/index.html">Confer√™ncia BLACK HAT USA. Enrique√ßa ou morra: ganhe dinheiro na Internet usando o Black Hat. Parte 1</a></li>
<li><a href="../pt476092/index.html">Sobre as instru√ß√µes "Fot√¥nica", "Programa√ß√£o e TI" e "Informa√ß√£o e seguran√ßa cibern√©tica" da Olimp√≠ada "Eu sou um profissional"</a></li>
<li><a href="../pt476094/index.html">O Retorno da Era dos Imp√©rios: Tudo sobre a Era dos Imp√©rios IV</a></li>
<li><a href="../pt476096/index.html">Invent√°rio de I a Z. Consideramos ativos de TI</a></li>
<li><a href="../pt476098/index.html">Estruturas de dados em Java. M√©todos √∫teis da classe auxiliar</a></li>
<li><a href="../pt476100/index.html">Arquitetura de sistemas de computadores 1 parte. Port√µes l√≥gicos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>