<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘©ğŸ» â˜£ï¸ â¡ï¸ Bestimmung der Anzahl der Stockwerke eines Hauses aus seinem Foto ohne maschinelles Lernen ğŸ‘¨ğŸ»â€ğŸ”¬ ğŸ‘¨ğŸ¿â€ğŸ¤â€ğŸ‘¨ğŸ» â¬›ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel werde ich meiner Meinung nach eine interessante LÃ¶sung fÃ¼r das Problem der Computererkennung von Objekten in einem Bild ohne Schulun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bestimmung der Anzahl der Stockwerke eines Hauses aus seinem Foto ohne maschinelles Lernen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422867/"><p><img src="https://habrastorage.org/webt/cj/m6/ap/cjm6ap1__gr044luewh6bnieg90.png"></p><br><p>  In diesem Artikel werde ich meiner Meinung nach eine interessante LÃ¶sung fÃ¼r das Problem der Computererkennung von Objekten in einem Bild ohne Schulung geben. </p><a name="habracut"></a><br><p> Aufgabe: Wenn Sie ein Foto eines mehrstÃ¶ckigen GebÃ¤udes haben, versuchen Sie, die Anzahl der Stockwerke zu bestimmen. </p><br><p>  Eine gute SchÃ¤tzung fÃ¼r die Anzahl der Stockwerke kann die Anzahl der Fenster in der Vertikalen des Hauses angeben.  Fenster, Balkone und andere GegenstÃ¤nde sind gute Eigenschaften von FuÃŸbÃ¶den (insbesondere in WohngebÃ¤uden).  Ich werde WohngebÃ¤ude betrachten, deren Bilder im Netzwerk leicht zu finden sind.  Eine wichtige EinschrÃ¤nkung sollte im Voraus beachtet werden: Das Haus im Bild muss vollstÃ¤ndig vertikal dargestellt werden, damit alle Stockwerke visuell erfasst werden kÃ¶nnen. </p><br><p>  Die Aufgabe ist rational in zwei Phasen unterteilt: </p><br><ol><li>  Suchen Sie nach dem vertikalen â€Streifenâ€œ der zu zÃ¤hlenden Fenster.  Zwei Unteraufgaben: Erstens mÃ¼ssen Sie im Bildbereich des Hauses nach Fenstern suchen, und zweitens gibt es viele Fenster in WohngebÃ¤uden. Es macht keinen Sinn, alle zu analysieren.  Es ist notwendig, unter ihnen die vertikale Sequenz hervorzuheben, die fÃ¼r die nachfolgende Analyse am besten geeignet ist. </li><li>  Bestimmung der Anzahl der Stockwerke (Fenster oder andere charakteristische Objekte) durch den ausgewÃ¤hlten Bereich des Hauses. </li></ol><br><p>  Dieser Artikel ist hauptsÃ¤chlich dem ersten Schritt der LÃ¶sung gewidmet.  Der zweite Schritt befindet sich noch in der Entwicklung, aber ich werde auch einige Ergebnisse seiner LÃ¶sung nennen. </p><br><h2 id="shag-1-poisk-oblasti-s-oknami">  Schritt 1. Suchen Sie nach dem Bereich mit Fenstern </h2><br><p>  Die Grundidee ist, dass eine Reihe identischer Objekte (wie Fenster), die in einem Haus in einer Reihe identischer Objekte gut unterscheidbar sind, eine periodische Folge von Pixelhelligkeit erzeugen.  Dies ist genau die Reihenfolge, die gefunden werden muss.  Nachfolgend sind die Hauptstufen des Algorithmus aufgefÃ¼hrt. </p><br><p>  Zuerst Ã¼bersetzen wir das Bild in Graustufen und skalieren es (ich habe Bilder mit einer GrÃ¶ÃŸe von 400 x 600 Pixel verwendet). <br><img src="https://habrastorage.org/webt/u0/et/u1/u0etu1wqvivumyejtlrnabusalq.png" alt="Bild"><br>  <em>Abb. 1 Original s / w-Bild</em> </p><br><p>  Weiter in der Schleife: </p><br><ol><li>  Auswahl auf dem Bild eines relativ schmalen (40px) Streifens auf die gesamte HÃ¶he (Abb. 2, unteres Bild ohne Punkte) </li><li>  Mittelung der Helligkeit Ã¼ber die Breite des Streifens.  Es zeigt sich die Linie w der Verteilung der gemittelten Helligkeit Ã¼ber die HÃ¶he des Hauses (Abb. 2, obere Grafik).  Es hat eine deutlich sichtbare periodische Struktur, die fÃ¼r den Bereich charakteristisch ist, in dem sich Fenster befinden.  Fenster im Schatten sind weniger unterscheidbar, aber das tut nicht weh. </li><li>  Die Differenz dw der um den Abstand sh verschobenen Werte von w und w wird berechnet.  Das Suchverfahren verwendet einen solchen Verschiebungswert sh, um die maximale Verringerung des Medians der Differenzen dw zu erreichen (Fig. 2, untere Grafik). <br><img src="https://habrastorage.org/webt/9h/-a/vu/9h-avuydpoc8snu7eebt0dro2ny.png" alt="Bild"><br><img src="https://habrastorage.org/webt/9f/l5/im/9fl5imoofp3wriyh9clqraz_zga.png" alt="Bild"><br>  <em>Abb.2 "Fensterstreifen"</em> </li></ol><br><p>  Es reicht jedoch nicht aus, das Bildband zu finden, auf dem der Median am stÃ¤rksten reduziert wurde.  Tatsache ist, dass Bereiche mit viel GrÃ¼n oder Himmel mit kleinen Scherwerten eine grÃ¶ÃŸere Abnahme bewirken kÃ¶nnen als Fenster.  Wenn wir jedoch die AbhÃ¤ngigkeit des Medianwerts vom Verschiebungswert fÃ¼r Streifen mit und ohne Fenster darstellen, kÃ¶nnen wir einen wesentlichen Unterschied feststellen: Bei Verschiebungswerten nahe der HÃ¶he der BÃ¶den weist das Diagramm mit Fenstern deutlich sichtbare Extrema auf.  Daher ist es nicht erforderlich, das absolut erreichbare Niveau des Medians zu messen, sondern dessen maximale Abnahme vom Maximum wÃ¤hrend der Schichtzunahme fÃ¼r jedes Fenster.  Dies ist ein wichtiger Punkt. </p><br><table><thead><tr><th>  ohne Fenster </th><th>  mit Fenstern </th></tr></thead><tbody><tr><td><img src="https://habrastorage.org/webt/yt/xa/6z/ytxa6zixd0e_zwzd64wecqc2ilg.png" alt="Bild"></td><td><img src="https://habrastorage.org/webt/5h/op/o7/5hopo7xr4ngt33e7ypwikb7y9ou.png" alt="Bild"></td></tr></tbody></table><br><p>  <em>Abb. 3 Ã„nderung des Medians der gemittelten Helligkeit mit zunehmender Verschiebung</em> </p><br><p>  Unten ist Python3-Code mit Kommentaren. </p><br><pre><code class="hljs pgsql">image = Image.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>("raf_data/32.jpg").resize((<span class="hljs-number"><span class="hljs-number">600</span></span>,<span class="hljs-number"><span class="hljs-number">400</span></span>)) # . img = np.<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(image.convert("L"), dtype=<span class="hljs-type"><span class="hljs-type">float</span></span>)/<span class="hljs-number"><span class="hljs-number">255</span></span> SEARCH_WIDTH = <span class="hljs-number"><span class="hljs-number">40</span></span> #    x_opt = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] #    :      sh_range = range(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>) #    kmax = <span class="hljs-number"><span class="hljs-number">0</span></span> #       <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, img.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>]-SEARCH_WIDTH, <span class="hljs-type"><span class="hljs-type">int</span></span>(SEARCH_WIDTH/<span class="hljs-number"><span class="hljs-number">2</span></span>)): amax = <span class="hljs-number"><span class="hljs-number">0</span></span> amin = <span class="hljs-number"><span class="hljs-number">1</span></span> #      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> sh <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sh_range: #    w = img[:,x:x+SEARCH_WIDTH].mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) aim = (pd.DataFrame(w)-pd.DataFrame(w).shift(sh))[sh:].abs().median().<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>] #    aim    sh <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> aim&gt;amax: amax = aim amin = amax <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> aim&lt;amin: amin = aim aim_k = amax/amin <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> aim_k&gt;kmax: x_opt = [x, sh, w] kmax = aim_k print(<span class="hljs-string"><span class="hljs-string">' : {0},  : {1}'</span></span>.format(x_opt[<span class="hljs-number"><span class="hljs-number">0</span></span>], x_opt[<span class="hljs-number"><span class="hljs-number">1</span></span>]))</code> </pre> <br><p>  Fig. 2 markiert die Punkte, die im Abstand der gefundenen Verschiebung eingestellt sind.  Wie Sie sehen kÃ¶nnen, markieren sie jedes Fenster gut.  Das heiÃŸt,  Wir kennen bereits die HÃ¶he des Bodens! <br>  Der betrachtete Algorithmus findet gute regelmÃ¤ÃŸige Zonen an den Fassaden verschiedener WohngebÃ¤ude (Abb. 4). <br><img src="https://habrastorage.org/webt/xh/vl/h5/xhvlh5ukzlxnwpi5iugar7f2x4u.png" alt="Bild"><br><img src="https://habrastorage.org/webt/nk/lg/oa/nklgoakyvddkiunj1l-wqyr0npu.png" alt="Bild"><br><img src="https://habrastorage.org/webt/5f/ty/vb/5ftyvboxmvu_klg5mozu9x07w0a.png" alt="Bild"><br>  <em>Abb. 4 Beispiel</em> </p><br><h2 id="shag-2-podschyot-chisla-etazhey">  Schritt 2. ZÃ¤hlen der Anzahl der Stockwerke </h2><br><p>  In diesem Schritt beginnen die Hauptschwierigkeiten.  Weitere Aktionen kÃ¶nnen wie folgt sein: </p><br><ol><li>  SchÃ¤tzen Sie die HÃ¶he des Hauses, indem Sie die Kurve der Unterschiede der durchschnittlichen Helligkeit analysieren oder maschinelles Lernen anwenden.  Teilen Sie die HÃ¶he des Hauses durch die HÃ¶he des Bodens und erhalten Sie die Anzahl der Stockwerke. </li><li>  Suchen Sie im Fenster des ersten Schritts nach Objekten, die Fenstern Ã¤hnlich sind, und zÃ¤hlen Sie sie direkt, z. B. an bestimmten Punkten. </li></ol><br><p>  Es erscheint natÃ¼rlich, zuerst die erste Methode auszuprobieren: Sobald die HÃ¶he der BÃ¶den bekannt ist, muss die HÃ¶he des Hauses bestimmt werden.  Schemata, die den in Schritt 1 gezeigten Ã¤hnlich sind, erweisen sich jedoch unter BerÃ¼cksichtigung aller mÃ¶glichen Grenzen und ÃœbergÃ¤nge als schlecht geeignet, um die HÃ¶he des Hauses zu bestimmen.  In einigen FÃ¤llen ist es mÃ¶glich, gute Arbeitsbeispiele zu erhalten, aber fÃ¼r ein konstant gutes Ergebnis sind AnsÃ¤tze mit maschinellem Lernen erforderlich. </p><br><p><img src="https://habrastorage.org/webt/qq/8c/eg/qq8ceg0kmzuzhxqfshishxoiyac.png" alt="Bild"><br>  <em>Abb. 5 Bestimmen der HÃ¶he des Hauses anhand eines zufÃ¤lligen Waldes</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de422867/">https://habr.com/ru/post/de422867/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de422857/index.html">Implementieren Ihres IoC-Containers</a></li>
<li><a href="../de422859/index.html">Das Kommunikationsministerium schlug vor, auf SIM-Karten mit VerschlÃ¼sselung vom FSB umzusteigen</a></li>
<li><a href="../de422861/index.html">Informationen zum Erstellen von JDK 8 unter Ubuntu, zur QualitÃ¤t des Hotspot-Codes und warum in C ++ alles fehlschlÃ¤gt</a></li>
<li><a href="../de422863/index.html">StÃ¤mme, Gilden, ZugzÃ¼ge und kein TDD: Wie die mobile Entwicklung in Uber, Spotify, Odnoklassniki und Avito funktioniert</a></li>
<li><a href="../de422865/index.html">Java Enterprise Open Lektion "CDI in Aktion"</a></li>
<li><a href="../de422869/index.html">Wir beherrschen neue Programmiersprachen und stÃ¼tzen uns auf das bereits Gelernte</a></li>
<li><a href="../de422871/index.html">Identifizieren Sie aussagekrÃ¤ftige Profile in VK</a></li>
<li><a href="../de422873/index.html">Pizza ala-halb beaufsichtigt</a></li>
<li><a href="../de422875/index.html">Warum Sie kein VPS / VDS fÃ¼r 200 Rubel mieten sollten oder wie Sie den richtigen virtuellen Server auswÃ¤hlen</a></li>
<li><a href="../de422877/index.html">"Ist das IoT?" - lernen, das Internet der Dinge nicht alle hintereinander anzurufen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>