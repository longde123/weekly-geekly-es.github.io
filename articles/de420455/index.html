<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛌🏽 🧝🏿 🤐 [Javawatch Live] Die Geschichte einer Pull-Anfrage. `os.version` in SubstrateVM 👨🏻‍💻 🦊 🐎</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ein Jahr ist vergangen, seit der vorherige Trick erfolgreich war: ein Video auf YouTube anstelle eines Posts zu veröffentlichen. "Shameful talk about ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>[Javawatch Live] Die Geschichte einer Pull-Anfrage. `os.version` in SubstrateVM</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/420455/">  Ein Jahr ist vergangen, seit der vorherige Trick erfolgreich war: ein Video auf YouTube anstelle eines Posts zu veröffentlichen.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Shameful talk about singleton"</a> hat 7.000 Aufrufe auf YouTube und doppelt so viele auf Habré in der Textversion erhalten.  Für einen Artikel, der in einem völlig hartnäckigen Zustand geschrieben wurde und über das alte Knopfakkordeon erzählt, ist dies ein kleiner Erfolg. <br><br>  Heute habe ich die ganze Nacht eine neue Version installiert.  Dieses Mal ist das Thema viel jünger: die Geschichte des Engagements für experimentelle Technologie - SubstrateVM.  Aber der Grad der Hartnäckigkeit ist auf ein neues Niveau gestiegen. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/f0nD_8G1uB0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Ich freue mich sehr auf Ihre Kommentare!  Ich erinnere Sie daran, dass es am besten ist, wenn Sie etwas in diesem Beitrag verbessern möchten, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das auf Github einzureichen</a> .  Ich möchte sagen: "Gefällt mir und abonniere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den neuen Kanal</a> , aber werden alle seine Releases trotzdem in deinem Java-Hub sein?" <br><br>  Technisch: Das Video hat einen, der näher am Ende klebt.  Ich habe gerade ein unkomprimiertes Video geschrieben und meine m2-SSD mit einer Größe von nur fünfhundert Gigabyte ist schnell übergelaufen.  Und keine andere Festplatte konnte einem solchen Datendruck standhalten.  Deshalb musste ich mich für eine halbe Stunde trennen und ging raus und fand weitere fünfzig Gigs, um die letzten paar Minuten aufzunehmen.  Dies wurde durch Löschen der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">von GoogleChrome kompilierten</a> Dateien erreicht.  Ich habe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zum Zeitpunkt der Aufnahme</a> über die Aufnahmesoftware in der FB geschrieben, es gibt viele Schmerzen. <br><br>  Ein weiteres technisch interessantes: YouTube hat mich aus irgendeinem Grund beim Live-Streaming blockiert.  Gleichzeitig gibt es keinen einzigen Streik und kein einziges Stigma auf dem Konto.  Hoffen wir, dass dies nur ein Pfosten ist und nach 90 Tagen alles zurück ist. <br><a name="habracut"></a><br><blockquote>  Dieser Artikel zitiert aus einem Code von Oracle.  Sie können diesen Code nicht für sich selbst verwenden (es sei denn, Sie lesen die Originallizenz und es erlaubt ihn beispielsweise unter den Bedingungen der GPL).  Das ist kein Scherz.  Olso, warnte ich. <br></blockquote><br><h1>  Prikazka (und ein Märchen wird vor uns liegen) </h1><br>  Viele haben bereits Geschichten gehört, dass „das neue Java in Java geschrieben wird“ und fragen sich, wie das sein könnte.  Es gibt ein Policy Dokument von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Project Metropolis</a> und einen entsprechenden Brief von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">John Rose</a> , aber dort ist alles ziemlich vage. <br><br>  Es klingt wie eine Art gruselige, blutige Magie.  In der gleichen Sache, die Sie jetzt versuchen können, gibt es nicht nur keine Magie, sondern alles ist dumm wie die Rückseite einer Schaufel, wenn Sie Ihre Zähne damit ausschlagen.  Natürlich gibt es einige Nuancen, aber dies wird eines Tages sehr später sein. <br><br>  Ich werde es am Beispiel einer lehrreichen Geschichte zeigen, die im Sommer passiert ist.  Wie sie den Aufsatz „Wie ich den Sommer verbracht habe“ in Schulen schreiben. <br><br>  Um eine kleine Bemerkung zu beginnen.  Das Projekt, das derzeit in Oracle Labs vorab kompiliert wird, ist GraalVM.  Die Komponente, die tatsächlich Nishtyaki ausführt und Java-Code in eine ausführbare Datei (in eine ausführbare Datei) verwandelt, ist SubstrateVM oder kurz SVM.  Verwechseln Sie dies nicht mit der gleichen Abkürzung, die von Datensatanisten (Support Vector Machine) verwendet wird.  Hier geht es um SVM. Als Schlüsselelement werden wir weiter darüber sprechen. <br><br><h1>  Erklärung des Problems </h1><br>  Also, "wie ich den Sommer verbracht habe."  Ich saß im Urlaub, verbrachte zwei F5 auf dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Grail Github</a> und stieß auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesen</a> : <br><br><img src="https://habrastorage.org/webt/uy/pg/ig/uypgig4krayn8dmvfzif_rd3em0.png"><br><br>  Eine Person möchte, dass <code>os.version</code> den richtigen Wert <code>os.version</code> . <br><br>  Nun, ich wollte den Fehler beheben?  Der Junge sagte - der Junge tat es. <br><br>  Wir werden überprüfen, ob unser Kunde lügt. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Main</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(System.getProperty(<span class="hljs-string"><span class="hljs-string">"os.version"</span></span>)); } }</code> </pre><br>  Erstens, wie der Auspuff in echtem Java aussieht: <code>4.15.0-32-generic</code> .  Ja, das ist frisches Ubuntu LTS Bionic. <br><br>  Versuchen Sie nun, dasselbe auf SVM zu tun: <br><br><pre> <code class="bash hljs">$ ls Main.java $ javac -cp . Main.java $ ls Main.class Main.java $ native-image Main Build on Server(pid: 18438, port: 35415) classlist: 151.77 ms (<span class="hljs-built_in"><span class="hljs-built_in">cap</span></span>): 1,662.32 ms setup: 1,880.78 ms error: Basic header file missing (&lt;zlib.h&gt;). Make sure libc and zlib headers are available on your system. Error: Processing image build request failed</code> </pre><br>  Na ja.  Dies liegt daran, dass ich speziell für den „sauberen“ Test eine völlig neue virtuelle Maschine erstellt habe. <br><br><pre> <code class="bash hljs">$ sudo apt-get install zlib1g-dev libc6 libc6-dev $ native-image Main Build on Server(pid: 18438, port: 35415) classlist: 135.17 ms (<span class="hljs-built_in"><span class="hljs-built_in">cap</span></span>): 877.34 ms setup: 1,253.49 ms (typeflow): 4,103.97 ms (objects): 1,441.97 ms (features): 41.74 ms analysis: 5,690.63 ms universe: 252.43 ms (parse): 1,024.49 ms (inline): 819.27 ms (compile): 4,243.15 ms compile: 6,356.02 ms image: 632.29 ms write: 236.99 ms [total]: 14,591.30 ms</code> </pre><br>  Absolute Laufzeitzahlen können schrecklich sein.  Aber erstens war es das, was es tun sollte: Hier werden sehr höllische Optimierungen angewendet.  Und zweitens ist dies eine gebrechliche virtuelle Maschine, die Sie wollen. <br><br>  Und schließlich der Moment der Wahrheit: <br><br><pre> <code class="hljs cs">$ ./main <span class="hljs-literal"><span class="hljs-literal">null</span></span></code> </pre><br>  Es scheint, dass unser Gast nicht gelogen hat, wirklich nicht funktioniert. <br><br><h1>  Erster Ansatz: Eigenschaften vom Host stehlen </h1><br>  Dann habe ich die globale <code>os.version</code> nach <code>os.version</code> und festgestellt, dass sich alle diese Eigenschaften in der <code>SystemPropertiesSupport</code> Klasse befinden. <br><br>  Ich werde nicht den vollständigen Pfad in die Datei schreiben, da die Möglichkeit, die richtigen Projekte für IntelliJ IDEA und Eclipse zu generieren, direkt in SVM integriert ist.  Das ist sehr cool und erinnert überhaupt nicht an die Qualen, die OpenJDK meistens erleben muss.  Lassen Sie die IDE Klassen für uns öffnen.  Also: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SystemPropertiesSupport</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String[] HOSTED_PROPERTIES = { <span class="hljs-string"><span class="hljs-string">"java.version"</span></span>, ImageInfo.PROPERTY_IMAGE_KIND_KEY, <span class="hljs-string"><span class="hljs-string">"line.separator"</span></span>, <span class="hljs-string"><span class="hljs-string">"path.separator"</span></span>, <span class="hljs-string"><span class="hljs-string">"file.separator"</span></span>, <span class="hljs-string"><span class="hljs-string">"os.arch"</span></span>, <span class="hljs-string"><span class="hljs-string">"os.name"</span></span>, <span class="hljs-string"><span class="hljs-string">"file.encoding"</span></span>, <span class="hljs-string"><span class="hljs-string">"sun.jnu.encoding"</span></span>, }; <span class="hljs-comment"><span class="hljs-comment">//... }</span></span></code> </pre><br>  Dann habe ich, ohne meinen Kopf einzuschließen, einfach <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eine</a> weitere Variable zu diesem Satz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hinzugefügt</a> : <br><br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"os.arch"</span></span>, <span class="hljs-string"><span class="hljs-string">"os.name"</span></span>, <span class="hljs-string"><span class="hljs-string">"os.version"</span></span></code> </pre><br>  Ich baue um, laufe, bekomme die begehrte Zeile <code>4.15.0-32-generic</code> .  Hurra! <br><br>  Aber hier ist das Problem: Jetzt wird auf <em>jedem</em> Computer, auf dem dieser Code ausgeführt wird, immer <code>4.15.0-32-generic</code> .  Selbst wenn <code>uname -a</code> die vorherige Version des Buckets auf altem Ubunt zurückgibt. <br><br>  Es wird deutlich, dass diese Variablen zum Zeitpunkt der Kompilierung in die Quelldatei geschrieben werden. <br>  Und wirklich, Sie müssen die Kommentare sorgfältig lesen: <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** System properties that are taken from the VM hosting the image generator. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String[] HOSTED_PROPERTIES</code> </pre><br>  Andere Methoden müssen angewendet werden. <br><br><h2>  Schlussfolgerungen </h2><br><ul><li>  Wenn eine Systemeigenschaft aus "Haupt-Java" in SVM angezeigt werden soll, ist dies sehr einfach.  Wir schreiben die gewünschte Immobilie an der richtigen Stelle, das ist alles. </li><li>  Sie können in der IDE arbeiten, die gleichzeitig Java und Python unterstützt.  Zum Beispiel in IntelliJ IDEA Ultimate mit einem Python-Plugin oder dem gleichen in Eclipse. </li></ul><br><h1>  Zweiter Ansatz </h1><br>  Wenn Sie die SystemPropertiesSupport- <code>SystemPropertiesSupport</code> durchsuchen, finden wir eine viel vernünftigere Sache: <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** System properties that are lazily computed at run time on first access. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Map&lt;String, Supplier&lt;String&gt;&gt; lazyRuntimeValues;</code> </pre><br>  Unter anderem blockiert die Verwendung dieser Eigenschaften den Prozess der Erstellung einer ausführbaren Datei immer noch nicht.  Es ist klar, dass sich alles verlangsamen wird, wenn wir in <code>HOSTED_PROPERTIES</code> viel <code>HOSTED_PROPERTIES</code> . <br><br>  Die Registrierung von faulen Eigenschaften erfolgt auf offensichtliche Weise unter Bezugnahme auf eine Methode, die Folgendes zurückgibt: <br><br><pre> <code class="hljs kotlin">lazyRuntimeValues.put(<span class="hljs-string"><span class="hljs-string">"user.name"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::userNameValue); lazyRuntimeValues.put(<span class="hljs-string"><span class="hljs-string">"user.home"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::userHomeValue); lazyRuntimeValues.put(<span class="hljs-string"><span class="hljs-string">"user.dir"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::userDirValue);</code> </pre><br>  Darüber hinaus sind alle diese Methodenreferenzen Schnittstellen, und für jede der unterstützten Plattformen ist dasselbe <code>this::userDirValue</code> implementiert.  In diesem Fall sind dies <code>PosixSystemPropertiesSupport</code> und <code>WindowsSystemPropertiesSupport</code> . <br><br>  Wenn wir neugierig auf eine Implementierung für Windows sind, werden wir das Traurige sehen: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">userDirValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"C:\\Users\\somebody"</span></span>; }</code> </pre><br>  Wie Sie sehen, wird Windows noch nicht unterstützt :-) Das eigentliche Problem besteht jedoch darin, dass die Generierung von ausführbaren Dateien für Windows noch nicht abgeschlossen ist. Die Unterstützung dieser Methoden wäre also völlig unnötig. <br><br>  Das heißt, Sie müssen die folgende Methode implementieren: <br><br><pre> <code class="java hljs">lazyRuntimeValues.put(<span class="hljs-string"><span class="hljs-string">"os.version"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::osVersionValue);</code> </pre><br>  Und dann unterstützen Sie es in zwei oder drei verfügbaren Schnittstellen. <br><br>  Aber was soll man dort schreiben? <br><br><h2>  Schlussfolgerungen </h2><br><ul><li>  Wenn Sie eine neue Eigenschaft hinzufügen möchten, die zur Laufzeit berechnet wird, müssen Sie nur eine Methode schreiben.  Das Ergebnis kann vom aktuellen Betriebssystem abhängen, der Schaltmechanismus funktioniert bereits und fragt nicht. </li></ul><br><h1>  Ein bisschen Archäologie </h1><br>  Das erste, was mir in den Sinn kommt, ist einen Blick auf eine Implementierung in OpenJDK zu werfen und dreist zu kopieren und einzufügen.  Ein wenig Archäologie und Plünderungen werden einen mutigen Entdecker niemals davon abhalten! <br><br>  Sie können jedes Java-Projekt in der Idee öffnen, dort <code>System.getProperty("os.version")</code> schreiben und mit Strg + Klick zur Implementierung der Methode <code>getProperty()</code> .  Es stellt sich heraus, dass all dies dumm in <code>Properties</code> liegt. <br><br>  Es scheint, kopiere und füge einfach die Stelle ein, an der diese <code>Properties</code> gefüllt sind, und renne inbrünstig in die Leere.  Leider stoßen wir auf ein Problem: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">native</span></span></span><span class="hljs-function"> Properties </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initProperties</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Properties props)</span></span></span></span>;</code> </pre><br>  Noooooooooooooo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d4d/ca9/698/d4dca9698ffccaf0de2944194698e857.gif"><br><br>  Aber alles hat so gut angefangen. <br><br><h1>  Gab es einen Jungen? </h1><br>  Wie wir wissen, ist die Verwendung von C ++ schlecht.  Wird C ++ in SVM verwendet? <br><br>  Einfach so!  <code>src/com.oracle.svm.native</code> gibt es sogar ein spezielles Paket: <code>src/com.oracle.svm.native</code> . <br><br>  Und in diesem Paket, Horror-Horror, liegt die Datei <code>getEnviron.c</code> mit <code>getEnviron.c</code> so: <br><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **environ; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> **</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getEnviron</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> environ; }</code> </pre><br><h1>  Es ist Zeit, sich mit C ++ anzulegen </h1><br>  Tauchen Sie jetzt etwas tiefer und öffnen Sie die vollständigen OpenJDK-Quellen. <br><br>  Wenn jemand sie noch nicht hat, können Sie <a href="">im Internet suchen</a> oder herunterladen.  Ich warne Sie, sie schwingen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">von hier aus</a> , immer noch mit Hilfe von Mercurial, und es wird immer noch ungefähr eine halbe Stunde dauern. <br><br>  Die Datei, die wir benötigen, befindet sich unter <code>src/java.base/share/native/libjava/System.c</code> . <br><br>  Haben Sie bemerkt, dass dies der Pfad zur Datei ist und nicht nur der Name?  Das ist richtig, Sie können Ihre neue glänzende modische Idee schieben, die für 200 US-Dollar pro Jahr gekauft wurde.  Sie können <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CLion ausprobieren</a> , aber um irreversible psychische Schäden zu vermeiden, ist es besser, nur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Visual Studio Code zu verwenden</a> .  Er hebt bereits etwas hervor, versteht aber immer noch nicht, was er gesehen hat (er streicht nicht alles rot durch). <br><br>  Kurzes Nacherzählen von <code>System.c</code> : <br><br><pre> <code class="hljs lisp">java_props_t *sprops = GetJavaProperties(<span class="hljs-name"><span class="hljs-name">env</span></span>)<span class="hljs-comment"><span class="hljs-comment">; PUTPROP(props, "os.version", sprops-&gt;os_version);</span></span></code> </pre><br>  Sie werden wiederum in <code>src/java.base/unix/native/libjava/java_props_md.c</code> . <br>  Jede Plattform hat ihre eigene solche Datei, sie wechseln durch <code>#define</code> . <br><br>  Und hier fängt es an.  Es gibt viele Plattformen.  Jede Nekrophilie wie AIX kann bewertet werden, da GraalVM sie offiziell nicht unterstützt (soweit ich weiß, sind GNU-Linux, macOS und Windows am Anfang geplant).  GNU / Linux und Windows unterstützen die Verwendung von <code>&lt;sys/utsname.h&gt;</code> , das vordefinierte Methoden zum <code>&lt;sys/utsname.h&gt;</code> des Namens und der Version des Betriebssystems enthält. <br><br>  Aber macOS hat ein <a href="">schreckliches Stück Govnokod</a> . <br><br><ul><li>  Der Name "Mac OS X" ist darin fest beschichtet (obwohl es schon lange MacOS ist); </li><li>  Es hängt von der Version von Makoshi ab.  Vor 10.9 hatte das SDK keine <code>operatingSystemVersion</code> Funktion, und Sie mussten <code>SystemVersion.plist</code> Hand lesen. </li><li>  Für diese Subtraktion wird die ObjC-Erweiterung wie folgt verwendet: </li></ul><br><pre> <code class="objectivec hljs"><span class="hljs-comment"><span class="hljs-comment">// Fallback if running on pre-10.9 Mac OS if (osVersionCStr == NULL) { NSDictionary *version = [NSDictionary dictionaryWithContentsOfFile : @"/System/Library/CoreServices/SystemVersion.plist"]; if (version != NULL) { NSString *nsVerStr = [version objectForKey : @"ProductVersion"]; if (nsVerStr != NULL) { osVersionCStr = strdup([nsVerStr UTF8String]); } } }</span></span></code> </pre><br>  Wenn anfangs die Idee bestand, dies manuell in einem guten Stil umzuschreiben, dann stürzte es schnell in die Realität ab.  Was ist, wenn ich irgendwo im Dschungel dieser Nudeln von ifs herumspiele, jemand sie kaputt macht und mich auf dem zentralen Platz aufhängt?  Na nafig.  <strong>Es ist notwendig, zu kopieren und einzufügen.</strong> <br><br><h2>  Schlussfolgerungen </h2><br><ul><li>  IDE wird nicht benötigt; </li><li>  Jede Kommunikation mit C ++ ist schmerzhaft, unangenehm und wird auf den ersten Blick nicht verstanden. </li></ul><br><h1>  Kopieren-Einfügen ist die Norm? </h1><br>  Dies ist ein wichtiges Thema, von dem die Höhe der weiteren Qualen abhängt.  Ich wollte wirklich nicht manuell umschreiben, aber es ist noch schlimmer, wegen Lizenzverletzung vor Gericht zu kommen.  Also ging ich zum Github und fragte Codrut Stancu direkt danach.  Hier ist, was er <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">antwortete</a> : <br><br>  <em>»Die Wiederverwendung von OpenJDK-Code, beispielsweise das Kopieren und Einfügen, ist aus Sicht der Lizenzierung eine normale Sache.</em>  <em>Dafür gibt es jedoch einen sehr guten Grund.</em>  <em>Wenn eine Funktion implementiert werden kann, indem der JDK-Code ohne Kopieren wiederverwendet wird, z. B. durch Ersetzen gepatcht wird, ist dies viel besser. "</em> <br><br>  Das klingt nach einer offiziellen Erlaubnis zum Kopieren und Einfügen! <br><br><h1>  Wir haben normal geredet ... </h1><br>  Ich fing an, diesen Code zu portieren, stieß aber auf meine Faulheit.  Um macOS für verschiedene Versionen zu testen, müssen Sie mindestens eine mit dem nekrophilen 10.8 Mountain Lion finden.  Ich habe zwei meiner Apple-Geräte zur Verfügung und eines von einem Freund. Außerdem kann ich es auf einer Test-VMWare bereitstellen. <br><br>  Aber Faulheit.  Und diese Faulheit hat mich gerettet. <br><br>  Ich ging in den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Chatraum</a> und fragte Chris Seaton, welche Toolchain für die Montage am besten geeignet sei.  Welche Version des Betriebssystems unterstützt wird, C ++ - Compiler usw. <br><br>  Als Antwort erhielt er eine überraschte Stille aus dem Chat und Chris antwortete, dass er das Wesentliche des Problems nicht verstehe. <br><br>  Es dauerte eine Weile, bis Chris herausfand, was ich tun wollte, und bat ihn, es <strong>nie wieder zu tun</strong> . <br><blockquote>  Das fehlt wirklich die Idee von SVM.  SVM ist reines Java, es soll keinen Code von OpenJDK enthalten.  Sie können es lesen, in Java konvertieren, aber niemand möchte C ++ - Code von OpenJDK.  Das ist das Letzte, was wir wollen. <br></blockquote><br>  Das Beispiel der Mathematikbibliotheken überzeugte ihn nicht.  Zumindest sind sie in C geschrieben, und die Aufnahme von C ++ würde bedeuten, eine völlig neue Sprache mit der Codebasis zu verbinden.  Und eine, die Fufufu ist. <br><br>  Was müssen Sie tun?  Schreiben Sie in <strong>System Java</strong> . <br><br>  Und wenn Aufrufe des C / C ++ Platform SDK nicht vermieden werden können, sollte dies ein einzelner Systemaufruf sein, der in die C-API eingeschlossen ist.  Daten werden in Java abgerufen, und dann wird die Geschäftslogik ausschließlich in Java geschrieben, auch wenn das Platform SDK über bequeme, vorgefertigte Möglichkeiten verfügt, dies auf der C ++ - Seite anders zu tun. <br><br>  Ich seufzte und begann den Quellcode zu studieren, um zu verstehen, wie dies anders gemacht werden kann. <br><br><h2>  Schlussfolgerungen </h2><br><ul><li>  Sprechen Sie mit Personen im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Chat über</a> obskure Details.  Sie antworten, wenn die Fragen nicht völlig idiotisch sind.  Obwohl dieses Beispiel zeigt, dass Chris bereit ist, idiotische Themen zu diskutieren, auch wenn dies seine Zeit nicht persönlich spart; </li><li>  C ++ ist im Projekt überhaupt nicht vorhanden.  Es gibt keinen Grund zu der Annahme, dass sich jemand von ihm unter den Boden ziehen lässt. </li><li>  Stattdessen müssen Sie in System Java mit C als letztem Ausweg schreiben (z. B. beim Aufrufen des Plattform-SDK). </li></ul><br><h1>  Geiger wird nicht benötigt </h1><br><blockquote>  Ein Geiger wird nicht gebraucht, Liebes.  Er isst nur überschüssigen Kraftstoff. <br></blockquote><br>  Dann war ich von etwas Traurigkeit überwältigt, denn schau her.  Wenn wir unter Windows <code>&lt;sys/utsname.h&gt;</code> haben und wir dumm auf seine Antwort hoffen - es ist einfach und unkompliziert. <br><br>  Aber wenn er nicht da ist, was muss dann getan werden? <br><br><ul><li>  Integrierte cmd-Befehle oder Windows-Dienstprogramme aufrufen?  Ausgabe eines Textes in russischer Sprache, der analysiert werden muss.  Dies ist der tiefste Punkt, und er stimmt möglicherweise nicht mit dem überein, was das echte OpenJDK an dieser Stelle beantworten wird. </li><li>  Aus der Registrierung nehmen?  Auch hier gibt es Nuancen, zum Beispiel beim Wechsel von Windows 7 zu 10 hat sich die Methode zum Speichern digitaler Nummern in der Registrierung geändert, und in Windows 10 müssen Sie entweder die Hände von den Haupt- und Nebenkomponenten kleben oder einfach antworten, dass es sich um Windows 10 mit einer Ziffer handelt.  Welche dieser Methoden korrekter ist (lässt die Ärsche der Benutzer nicht bereuen), ist unklar. </li></ul><br>  Glücklicherweise wurde meine Angst <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">durch die</a> Pull-Quest <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">von</a> Paul Woegerer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unterbrochen</a> , die alles reparierte. <br><br>  Interessanterweise wurde zuerst alles im Assistenten repariert ( <code>os.version</code> gab im Test <code>os.version</code> <code>null</code> aus), und erst dann bemerkte ich eine Pull-Anfrage.  Das Problem ist, dass dieses Commit auf dem Github nicht als Pullrequest markiert ist - es ist ein einfaches Commit mit der Aufschrift <code>PullRequest: graal/1885</code> im Kommentar.  Tatsache ist, dass die Jungs von Oracle Labs Github nicht verwenden, sondern nur für die Interaktion mit externen Committern benötigen.  Wir alle, die wir nicht das Glück hatten, bei Oracle Labs zu arbeiten, müssen Benachrichtigungen über neue Commits im Repository abonnieren und alle lesen. <br><br>  Jetzt können Sie sich entspannen und sehen, wie Sie diese Funktion <em>richtig</em> implementieren. <br><br>  Mal sehen, was für ein Biest das ist, System Java. <br><br>  Wie ich bereits sagte, ist alles einfach, wie die Rückseite einer Schaufel, wenn sie versuchen, Ihre Zähne auszuschlagen.  Und genauso schmerzhaft.  Schauen Sie sich das Zitat aus dem Pool an: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">osVersionValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (osVersionValue != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> osVersionValue; } <span class="hljs-comment"><span class="hljs-comment">/* On OSX Java returns the ProductVersion instead of kernel release info. */</span></span> CoreFoundation.CFDictionaryRef dict = CoreFoundation._CFCopyServerVersionDictionary(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dict.isNull()) { dict = CoreFoundation._CFCopySystemVersionDictionary(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dict.isNull()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> osVersionValue = <span class="hljs-string"><span class="hljs-string">"Unknown"</span></span>; } CoreFoundation.CFStringRef dictKeyRef = DarwinCoreFoundationUtils.toCFStringRef(<span class="hljs-string"><span class="hljs-string">"MacOSXProductVersion"</span></span>); CoreFoundation.CFStringRef dictValue = CoreFoundation.CFDictionaryGetValue(dict, dictKeyRef); CoreFoundation.CFRelease(dictKeyRef); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dictValue.isNull()) { dictKeyRef = DarwinCoreFoundationUtils.toCFStringRef(<span class="hljs-string"><span class="hljs-string">"ProductVersion"</span></span>); dictValue = CoreFoundation.CFDictionaryGetValue(dict, dictKeyRef); CoreFoundation.CFRelease(dictKeyRef); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dictValue.isNull()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> osVersionValue = <span class="hljs-string"><span class="hljs-string">"Unknown"</span></span>; } osVersionValue = DarwinCoreFoundationUtils.fromCFStringRef(dictValue); CoreFoundation.CFRelease(dictValue); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> osVersionValue; }</code> </pre><br>  Mit anderen Worten, wir schreiben Wort für Wort in Java, was wir in C schreiben würden. <br><br>  <code>DarwinExecutableName</code> an, wie <code>DarwinExecutableName</code> geschrieben ist: <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">apply</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* Find out how long the executable path is. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> CIntPointer sizePointer = StackValue.get(CIntPointer.class); sizePointer.write(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DarwinDyld._NSGetExecutablePath(WordFactory.nullPointer(), sizePointer) != -<span class="hljs-number"><span class="hljs-number">1</span></span>) { VMError.shouldNotReachHere(<span class="hljs-string"><span class="hljs-string">"DarwinExecutableName.getExecutableName: Executable path length is 0?"</span></span>); } <span class="hljs-comment"><span class="hljs-comment">/* Allocate a correctly-sized buffer and ask again. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] byteBuffer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[sizePointer.read()]; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (PinnedObject pinnedBuffer = PinnedObject.create(byteBuffer)) { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> CCharPointer bufferPointer = pinnedBuffer.addressOfArrayElement(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DarwinDyld._NSGetExecutablePath(bufferPointer, sizePointer) == -<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">/* Failure to find executable path. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String executableString = CTypeConversion.toJavaString(bufferPointer); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String result = realpath(executableString); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }</code> </pre><br>  All diese <code>CIntPointer</code> , <code>CCharPointer</code> , <code>PinnedObject</code> , was. <br><br>  Für meinen Geschmack ist dies unangenehm und hässlich.  Sie müssen manuell mit Zeigern arbeiten, die wie Java-Klassen aussehen.  Sie müssen die entsprechende <code>release</code> rechtzeitig aufrufen, damit der Speicher nicht verloren geht. <br><br>  Wenn es Ihnen jedoch so erscheint, als wären dies <em>ungerechtfertigte</em> Maßnahmen, können Sie sich erneut die <a href="">Implementierung von GC in .NET</a> ansehen und entsetzt darüber sein, wozu C ++ führt, wenn Sie nicht rechtzeitig anhalten.  Ich erinnere Sie daran, dass dies eine riesige CPP-Datei ist, die größer als ein Megabyte ist.  Es gibt <a href="">einige Beschreibungen</a> seiner Arbeit, aber sie reichen eindeutig nicht aus, um von einem externen Mitarbeiter verstanden zu werden.  Der obige Code sieht zwar böse aus, ist aber durchaus verständlich und wird mithilfe einer statischen Analyse für Java analysiert. <br><br>  Was das Wesentliche des Commits betrifft, habe ich Fragen an ihn.  Und zumindest ist dort keine Windows-Unterstützung implementiert.  Wenn ein Codegen für Windows angezeigt wird, werde ich versuchen, diese Aufgabe zu übernehmen. <br><br><h2>  Schlussfolgerungen </h2><br><ul><li>  Müssen in System Java schreiben.  Lob, nenn süßes Brot.  Es gibt noch keine Optionen; </li><li>  Abonnieren Sie Benachrichtigungen aus dem Repository auf GitHub und lesen Sie die Commits. Andernfalls fliegen wichtige PRs vorbei. </li><li>  Fragen Sie nach Möglichkeit nach wichtigen Funktionen der Verantwortlichen für diesen Bereich.  Es gibt viele Dinge, die implementiert werden, aber sie sind der Öffentlichkeit noch nicht bekannt.  Es gibt eine Chance, ein Fahrrad zu erfinden, und viel schlimmer als das, das von den Jungs von Oracle Labs hergestellt wurde. </li><li>  Informieren Sie die verantwortliche Person am Github, wenn Sie eine Funktion in Angriff nehmen.  Wenn er nicht antwortet - schreiben Sie einen Brief, werden die Adressen aller Teammitglieder leicht gegoogelt. </li></ul><br><h1>  Nachwort </h1><br>  Diese Schlacht endet, aber überhaupt kein Krieg. <br><br>  Kämpfer, warte sensibel auf neue Artikel über Habré und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">passe in unsere Reihen</a> ! <br><br>  Ich möchte Sie daran erinnern, dass Oleg Shelaev, der einzige <strong>offizielle</strong> GraalVM-Evangelist von Oracle, zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nächsten Joker-Konferenz kommen wird</a> .  Nicht nur "der einzige russische Sprecher", sondern "der einzige im Allgemeinen".  Der Titel des Berichts ( <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">„Java vorab mit GraalVM kompilieren“</a></em> ) weist darauf hin, dass SubstrateVM nicht darauf verzichten kann. <br><br>  Übrigens wurde Oleg kürzlich eine Dienstwaffe ausgestellt - ein Bericht über Habré, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Shelajev-Oleg</a> .  Es gibt dort noch keine Beiträge, aber Sie können diesen Benutzernamen verwenden. <br><br>  Sie können mit Oleg und Oleg in unserem Chatroom-Chat im Telegramm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sprechen</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@graalvm_ru</a> .  Im Gegensatz zu ishshuyev auf Github können Sie dort in jeder Form kommunizieren, und niemand wird gesperrt ( <em>dies ist jedoch nicht korrekt</em> ). <br><br>  Ich erinnere Sie auch daran, dass wir jede Woche zusammen mit dem Debriefing-Podcast den Java Digest veröffentlichen.  Zum Beispiel war dies die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">letzte Zusammenfassung</a> .  Von Zeit zu Zeit werden dort Nachrichten über GraalVM übersprungen (tatsächlich verwandle ich die gesamte Ausgabe nicht in eine GraalVM-Pressemitteilung, nur aus Respekt vor dem Publikum :-) <br><br>  Vielen Dank für das Lesen - und bis bald! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de420455/">https://habr.com/ru/post/de420455/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de420441/index.html">Die 10 häufigsten Sicherheitsfehler in Python und wie man sie vermeidet</a></li>
<li><a href="../de420443/index.html">Cybersicherheitsexperten haben einen Skimmer-Detektor entwickelt - SkimReaper</a></li>
<li><a href="../de420447/index.html">Computer History Museum - der Ort, an dem die IT protokolliert wird</a></li>
<li><a href="../de420451/index.html">Server in den Clouds: Vorbereitung zum Start</a></li>
<li><a href="../de420453/index.html">Skillbox Friday Webinare: Entwicklung und alles darüber</a></li>
<li><a href="../de420457/index.html">Übersicht über die Simplify3D 3D-Drucksoftware</a></li>
<li><a href="../de420459/index.html">Symbol mit einem Zähler in der oberen Symbolleiste: Ein Beispiel für verschiedene Ansätze für eine Aufgabe</a></li>
<li><a href="../de420461/index.html">10 Zitate von schlechten Designern</a></li>
<li><a href="../de420463/index.html">ICO ist zu Recht im Niedergang, aber sie haben eine Chance, sich zu ändern</a></li>
<li><a href="../de420465/index.html">Nginx-Variablen mit njs: einfach, schmerzlos und über JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>