<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘¨ğŸ½ ğŸ˜ ğŸ”² æˆ‘å¦‚ä½•ç¼–å†™æ ‡å‡†çš„C ++ 11åº“ï¼Œæˆ–è€…ä¸ºä»€ä¹ˆboostå¦‚æ­¤ä»¤äººææƒ§ã€‚ ç¬¬äºŒç«  ğŸ§šğŸ½ ğŸ‘¨ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ» ğŸ‘©ğŸ¼â€âœˆï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å…ˆå‰éƒ¨åˆ†çš„æ‘˜è¦ 
 ç”±äºä½¿ç”¨C ++ 11ç¼–è¯‘å™¨çš„èƒ½åŠ›å—åˆ°é™åˆ¶ï¼Œå¹¶ä¸”ç”±äºç¼ºä¹æ›¿ä»£æ€§ï¼Œboostå¸Œæœ›åœ¨ç¼–è¯‘å™¨éšé™„çš„C ++ 98 / C ++ 03åº“ä¹‹ä¸Šç¼–å†™è‡ªå·±çš„æ ‡å‡†C ++ 11åº“å®ç°ã€‚ 

 é™¤äº†æ ‡å‡†å¤´æ–‡ä»¶type_traitsä¹‹å¤– ï¼Œè¿˜æ·»åŠ äº† thread ï¼Œ Mutex ï¼Œ chrono ï¼Œ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æˆ‘å¦‚ä½•ç¼–å†™æ ‡å‡†çš„C ++ 11åº“ï¼Œæˆ–è€…ä¸ºä»€ä¹ˆboostå¦‚æ­¤ä»¤äººææƒ§ã€‚ ç¬¬äºŒç« </h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417099/"><img src="https://habrastorage.org/webt/lr/zq/if/lrzqifvfeajppx2fdvqbxnwf4ce.png" alt="æ˜¯çš„-æ˜¯çš„ï¼Œæˆ‘å¥‰è¡Œè¿™ä¸€åº§å³é“­ã€‚" width="300" height="350" align="left"><h3> å…ˆå‰éƒ¨åˆ†çš„æ‘˜è¦ </h3><br> ç”±äºä½¿ç”¨C ++ 11ç¼–è¯‘å™¨çš„èƒ½åŠ›å—åˆ°é™åˆ¶ï¼Œå¹¶ä¸”ç”±äºç¼ºä¹æ›¿ä»£æ€§ï¼Œboostå¸Œæœ›åœ¨ç¼–è¯‘å™¨éšé™„çš„C ++ 98 / C ++ 03åº“ä¹‹ä¸Šç¼–å†™è‡ªå·±çš„æ ‡å‡†C ++ 11åº“å®ç°ã€‚ <br><br> é™¤äº†æ ‡å‡†å¤´æ–‡ä»¶<b>type_traitsä¹‹å¤–</b> ï¼Œè¿˜æ·»åŠ <b>äº†</b> <b>thread</b> ï¼Œ <b>Mutex</b> ï¼Œ <b>chrono</b> ï¼Œ <b>nullptr.h</b> ï¼Œ <b>å®ƒä»¬</b>å®ç°äº†<i>std :: nullptr_t</i>å’Œ<b>core.h</b> ï¼Œå…¶ä¸­æ·»åŠ äº†ä¸<b>ä¾èµ–</b>äºç¼–è¯‘å™¨çš„<b>åŠŸèƒ½</b>ç›¸å…³çš„å®ï¼Œå¹¶æ‰©å±•äº†æ ‡å‡†åº“ã€‚ <br><br> é“¾æ¥åˆ°GitHubï¼Œä¸ºä¸è€çƒ¦çš„è¯»è€…å’Œéè¯»è€…æä¾›ä»Šå¤©çš„ç»“æœï¼š <br><br><blockquote>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¬¢è¿æœ‰å»ºè®¾æ€§çš„æ‰¹è¯„å’Œæ‰¹è¯„</a></b> </blockquote><a name="habracut"></a><br><h4> ç›®å½• </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¼•è¨€</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬1ç« ã€‚Viam supervadet vadens</a> <br>  <b>ç¬¬2ç« ã€‚#ifndef __CPP11_SUPPORT__ï¼ƒå®šä¹‰__COMPILER_SPECIFIC_BUILT_IN_AND_MACRO_HELL__ #endif</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬3ç« ã€‚æ‰¾åˆ°ç†æƒ³çš„nullptrå®ç°</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬4ç« C ++æ¨¡æ¿é­”æœ¯</a> <br>  .... <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">4.1æˆ‘ä»¬ä»å°å¤„ç€æ‰‹</a> <br>  .... <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">4.2å…³äºæ—¥å¿—ä¸ºæˆ‘ä»¬ç¼–è¯‘äº†å¤šå°‘ä¸ªå¥‡è¿¹èˆ¬çš„é”™è¯¯</a> <br>  .... <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">4.3æŒ‡é’ˆå’Œæ‰€æœ‰æ‰€æœ‰</a> <br>  .... <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">4.4æ¨¡æ¿åº“è¿˜éœ€è¦ä»€ä¹ˆ</a> <br> ç¬¬äº”ç«  <br>  ... <br><br><h3> ç¬¬2ç« ã€‚#ifndef __CPP11_SUPPORT__ï¼ƒå®šä¹‰__COMPILER_SPECIFIC_BUILT_IN_AND_MACRO_HELL__ #endif </h3><br> åœ¨å¯¹æ‰€æœ‰ä»£ç è¿›è¡Œäº†ä¸€äº›æ¢³ç†å¹¶å°†å…¶æŒ‰â€œæ ‡å‡†â€æ ‡å¤´åˆ’åˆ†ä¸ºå•ç‹¬çš„<b>å‘½åç©ºé—´stdexåï¼Œ</b>æˆ‘ç»§ç»­å¡«å……<b>type_traits</b> ï¼Œ <b>nullptr.h</b>ä»¥åŠç›¸åŒçš„<b>core.h</b> ï¼Œå…¶ä¸­åŒ…å«å®æ¥ç¡®å®šç¼–è¯‘å™¨ä½¿ç”¨å¹¶æ”¯æŒçš„æ ‡å‡†ç‰ˆæœ¬<b>æœ¬æœºnullptr</b> ï¼Œ <b>char16_t</b> ï¼Œ <b>char32_t</b>å’Œ<b>static_assert</b> ã€‚ <br><br> ä»ç†è®ºä¸Šè®²ï¼Œä¸€åˆ‡éƒ½å¾ˆç®€å•-æ ¹æ®C ++æ ‡å‡†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ï¼ˆç¬¬14.8æ¡ï¼‰ï¼Œ</a> <b>__cplusplus</b>å®å¿…é¡»ç”±ç¼–è¯‘å™¨å®šä¹‰ï¼Œå¹¶ä¸å—æ”¯æŒæ ‡å‡†çš„ç‰ˆæœ¬ç›¸å¯¹åº”ï¼š <br><br><pre><code class="cpp hljs">C++ pre-C++<span class="hljs-number"><span class="hljs-number">98</span></span>: <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __cplusplus 1 C++98: #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __cplusplus 199711L C++98 + TR1: #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __cplusplus 199711L </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// ??? C++11: #define __cplusplus 201103L C++14: #define __cplusplus 201402L C++17: #define __cplusplus 201703L</span></span></span></span></code> </pre> <br> å› æ­¤ï¼Œç¡®å®šæ”¯æŒå¯ç”¨æ€§çš„ä»£ç å¾ˆç®€å•ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (__cplusplus &gt;= 201103L) </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  C++ 11   #define _STDEX_NATIVE_CPP11_SUPPORT //   11  (nullptr, static_assert) #define _STDEX_NATIVE_CPP11_TYPES_SUPPORT //    char16_t, char32_t #endif</span></span></span></span></code> </pre><br><img src="https://habrastorage.org/webt/oq/qj/y8/oqqjy8dy_l8fyahlkfb3m-6uv3u.jpeg" alt="å›¾ç‰‡" width="300" height="250" align="left"> å®é™…ä¸Šï¼Œå¹¶éæ‰€æœ‰äº‹æƒ…éƒ½é‚£ä¹ˆç®€å•ï¼Œç°åœ¨æœ‰è¶£çš„æ‹æ–å¼€å§‹äº†ã€‚ <br><br> é¦–å…ˆï¼Œä¸æ˜¯æ‰€æœ‰çš„ç¼–è¯‘å™¨ï¼Œç”šè‡³æ²¡æœ‰ç¼–è¯‘å™¨éƒ½æ²¡æœ‰å®Œå…¨ï¼Œç«‹å³å®ç°ä¸‹ä¸€ä¸ªæ ‡å‡†ã€‚ ä¾‹å¦‚ï¼Œåœ¨Visual Studio 2013 <b>ä¸­ï¼Œ</b>å¾ˆé•¿ä¸€æ®µæ—¶é—´<b>éƒ½</b>æ²¡æœ‰<b>constexpr</b> ï¼Œè€Œå®ƒå£°ç§°å®ƒæ”¯æŒC ++ 11-å¹¶è­¦å‘Šè¯´å®ç°ä¸å®Œæ•´ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œ <b>auto</b> -pleaseï¼Œ <b>static_assert-</b>ä¸€æ ·å®¹æ˜“ï¼ˆå³ä½¿ä»æ—©æœŸçš„MS VSèµ·ä¹Ÿä¸€æ ·ï¼‰ï¼Œä½†æ˜¯<b>constexpr</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å´ä¸</a>å®¹æ˜“ã€‚ å…¶æ¬¡ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç¼–è¯‘å™¨ï¼ˆè€Œä¸”æ›´ä»¤äººæƒŠè®¶ï¼‰éƒ½æ­£ç¡®åœ°å…¬å¼€äº†æ­¤å®šä¹‰å¹¶åŠæ—¶è¿›è¡Œäº†æ›´æ–°ã€‚ çªç„¶ï¼Œåœ¨åŒä¸€ä¸ªç¼–è¯‘å™¨ä¸­ï¼ŒVisual Studio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¹¶æœª</a>ä»ç¼–è¯‘å™¨çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸­<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ›´æ”¹__cplusplus</a> <b>å®šä¹‰</b>çš„ç‰ˆæœ¬ï¼Œå°½ç®¡æ—©å°±å®£å¸ƒäº†å¯¹C ++ 11çš„å®Œå…¨æ”¯æŒï¼ˆè¿™ä¹Ÿä¸æ˜¯çœŸçš„ï¼Œå¯¹æ­¤å­˜åœ¨ä¸åŒçš„ä¸æ»¡ä¹‹æƒ…-ä¸€æ—¦å¯¹è¯æ¶‰åŠâ€œæ–°åŠŸèƒ½â€çš„ç‰¹å®šåŠŸèƒ½æ—¶ï¼‰ â€œ 11ä½æ ‡å‡†å¼€å‘äººå‘˜ç«‹å³è¯´ï¼Œæ²¡æœ‰C99é¢„å¤„ç†å™¨ï¼Œæ²¡æœ‰å…¶ä»–â€åŠŸèƒ½â€ï¼‰ã€‚ å¦‚æœæ ‡å‡†ç¼–è¯‘å™¨ä¸å®Œå…¨ç¬¦åˆå£°æ˜çš„æ ‡å‡†ï¼Œåˆ™å…è®¸ç¼–è¯‘å™¨å°†æ­¤å®šä¹‰è®¾ç½®ä¸ºä¸ä¸Šè¿°å€¼ä¸åŒçš„æƒ…å†µï¼Œè¿™ä½¿æƒ…å†µæ›´åŠ æ¶åŒ–ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾ä¸ºç»™å®šçš„å®è¿›è¡Œè¿™æ ·çš„å®šä¹‰å®šä¹‰æ˜¯åˆç†çš„ï¼ˆéšç€æ–°åŠŸèƒ½çš„å¼•å…¥ï¼Œå¢åŠ äº†éšè—åœ¨è¯¥å®šä¹‰åé¢çš„æ•°é‡ï¼‰ï¼š <br><br><pre> <code class="cpp hljs">standart C++<span class="hljs-number"><span class="hljs-number">98</span></span>: <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __cplusplus 199711L </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// C++98 standart C++98 + TR1: #define __cplusplus 200311L // C++03 nonstandart C++11: #define __cplusplus 200411L // C++03 + auto and dectype nonstandart C++11: #define __cplusplus 200511L // C++03 + auto, dectype and constexpr(partly) ... standart C++11: #define __cplusplus 201103L // C++11</span></span></span></span></code> </pre><br> ä½†æ˜¯ä¸æ­¤åŒæ—¶ï¼Œæ²¡æœ‰ä¸€ä¸ªä¸»è¦çš„æµè¡Œç¼–è¯‘å™¨å¯¹æ­¤åŠŸèƒ½â€œç£¨æŸâ€ã€‚ <br><br> ç”±äºæ‰€æœ‰è¿™äº›ï¼ˆæˆ‘ä¸æ€•è¿™ä¸ªè¯ï¼‰ï¼Œç°åœ¨ï¼Œå¯¹äºæ¯ä¸ªéæ ‡å‡†ç¼–è¯‘å™¨ï¼Œæ‚¨éƒ½å¿…é¡»ç¼–å†™è‡ªå·±çš„ç‰¹å®šæ£€æŸ¥ï¼Œä»¥æ‰¾å‡ºå“ªç§C ++æ ‡å‡†åŠå…¶æ”¯æŒçš„ç¨‹åº¦ã€‚ å¥½æ¶ˆæ¯æ˜¯ï¼Œæˆ‘ä»¬åªéœ€è¦å­¦ä¹ ä¸€äº›ç¼–è¯‘å™¨åŠŸèƒ½å³å¯æ­£å¸¸å·¥ä½œã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬ç°åœ¨é€šè¿‡<b>_MSC_VER</b>å®æ·»åŠ Visual Studioçš„ç‰ˆæœ¬æ£€æŸ¥ï¼Œæ­¤ç¼–è¯‘å™¨æ˜¯å”¯ä¸€çš„ã€‚ å› ä¸ºåœ¨æˆ‘æ‰€æ”¯æŒçš„ç¼–è¯‘å™¨åº“ä¸­ï¼Œè¿˜æœ‰C ++ Borland Builder 6.0ï¼Œè€Œå…¶å¼€å‘äººå‘˜åˆéå¸¸çƒ­è¡·äºä¸Visual Studioå…¼å®¹ï¼ˆåŒ…æ‹¬å…¶â€œåŠŸèƒ½â€å’Œé”™è¯¯ï¼‰ï¼Œæ‰€ä»¥çªç„¶ä¹‹é—´ä¹Ÿæœ‰äº†è¿™ä¸ªå®ã€‚ å¯¹äºå…¼å®¹clangçš„ç¼–è¯‘å™¨ï¼Œæœ‰ä¸€ä¸ªéæ ‡å‡†å®<b>__has_featureï¼ˆ</b> feature_name <b>ï¼‰</b> ï¼Œæ‚¨å¯ä»¥é€šè¿‡å®ƒæŸ¥çœ‹ç¼–è¯‘å™¨æ˜¯å¦æ”¯æŒè¯¥åŠŸèƒ½ã€‚ ç»“æœï¼Œä»£ç è†¨èƒ€ä¸ºï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> __has_feature #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __has_feature(x) 0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// Compatibility with non-clang compilers. #endif // Any compiler claiming C++11 supports, Visual C++ 2015 and Clang version supporting constexpr #if ((__cplusplus &gt;= 201103L) || (_MSC_VER &gt;= 1900) || (__has_feature(cxx_constexpr))) // C++ 11 implementation #define _STDEX_NATIVE_CPP11_SUPPORT #define _STDEX_NATIVE_CPP11_TYPES_SUPPORT #endif</span></span></span></span></code> </pre><br> æ˜¯å¦æƒ³æ¥è§¦æ›´å¤šçš„ç¼–è¯‘å™¨ï¼Ÿ æˆ‘ä»¬æ·»åŠ äº†å¯¹Codegear C ++ Builderçš„æ£€æŸ¥ï¼Œè¯¥æ£€æŸ¥å™¨æ˜¯Borlandçš„ç»§æ‰¿äººï¼ˆå¤„äºæœ€åçš„è¡¨ç°ï¼Œä½†ç¨åä¼šè¯¦ç»†ä»‹ç»ï¼‰ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> __has_feature #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __has_feature(x) 0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// Compatibility with non-clang compilers. #endif // Any compiler claiming C++11 supports, Visual C++ 2015 and Clang version supporting constexpr #if ((__cplusplus &gt;= 201103L) || (_MSC_VER &gt;= 1900) || (__has_feature(cxx_constexpr))) // C++ 11 implementation #define _STDEX_NATIVE_CPP11_SUPPORT #define _STDEX_NATIVE_CPP11_TYPES_SUPPORT #endif #if !defined(_STDEX_NATIVE_CPP11_TYPES_SUPPORT) #if ((__cplusplus &gt; 199711L) || defined(__CODEGEARC__)) #define _STDEX_NATIVE_CPP11_TYPES_SUPPORT #endif #endif</span></span></span></span></code> </pre><br> è¿˜å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºVisual Studioå·²ç»æ”¯æŒ<b>_MSC_VER 1600</b>ç¼–è¯‘å™¨ç‰ˆæœ¬çš„<b>nullptr</b>ä»¥åŠå†…ç½®ç±»å‹<b>char16_t</b>å’Œ<b>char32_t</b> ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ­£ç¡®å¤„ç†æ­¤é—®é¢˜ã€‚ æ·»åŠ äº†æ›´å¤šæ£€æŸ¥ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> __has_feature #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __has_feature(x) 0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// Compatibility with non-clang compilers. #endif // Any compiler claiming C++11 supports, Visual C++ 2015 and Clang version supporting constexpr #if ((__cplusplus &gt;= 201103L) || (_MSC_VER &gt;= 1900) || (__has_feature(cxx_constexpr))) // C++ 11 implementation #define _STDEX_NATIVE_CPP11_SUPPORT #define _STDEX_NATIVE_CPP11_TYPES_SUPPORT #endif #if !defined(_STDEX_NATIVE_CPP11_TYPES_SUPPORT) #if ((__cplusplus &gt; 199711L) || defined(__CODEGEARC__)) #define _STDEX_NATIVE_CPP11_TYPES_SUPPORT #endif #endif #if ((!defined(_MSC_VER) || _MSC_VER &lt; 1600) &amp;&amp; !defined(_STDEX_NATIVE_CPP11_SUPPORT)) #define _STDEX_IMPLEMENTS_NULLPTR_SUPPORT #else #define _STDEX_NATIVE_NULLPTR_SUPPORT #endif #if (_MSC_VER &gt;= 1600) #ifndef _STDEX_NATIVE_CPP11_TYPES_SUPPORT #define _STDEX_NATIVE_CPP11_TYPES_SUPPORT #endif #endif</span></span></span></span></code> </pre><br> åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å°†æ£€æŸ¥æ˜¯å¦æ”¯æŒC ++ 98ï¼Œå› ä¸ºå¯¹äºä¸å¸¦C ++ 98çš„ç¼–è¯‘å™¨ï¼Œæ ‡å‡†åº“ä¸­ä¸ä¼šåŒ…å«æŸäº›å¤´æ–‡ä»¶ï¼Œå¹¶ä¸”æˆ‘ä»¬æ— æ³•ä½¿ç”¨ç¼–è¯‘å™¨æ¥éªŒè¯å®ƒä»¬çš„ä¸å­˜åœ¨ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å…¨é€‰</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> __has_feature #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __has_feature(x) 0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// Compatibility with non-clang compilers. #endif // Any compiler claiming C++11 supports, Visual C++ 2015 and Clang version supporting constexpr #if ((__cplusplus &gt;= 201103L) || (_MSC_VER &gt;= 1900) || (__has_feature(cxx_constexpr))) // C++ 11 implementation #define _STDEX_NATIVE_CPP11_SUPPORT #define _STDEX_NATIVE_CPP11_TYPES_SUPPORT #endif #if !defined(_STDEX_NATIVE_CPP11_TYPES_SUPPORT) #if ((__cplusplus &gt; 199711L) || defined(__CODEGEARC__)) #define _STDEX_NATIVE_CPP11_TYPES_SUPPORT #endif #endif #if ((!defined(_MSC_VER) || _MSC_VER &lt; 1600) &amp;&amp; !defined(_STDEX_NATIVE_CPP11_SUPPORT)) #define _STDEX_IMPLEMENTS_NULLPTR_SUPPORT #else #define _STDEX_NATIVE_NULLPTR_SUPPORT #endif #if (_MSC_VER &gt;= 1600) #ifndef _STDEX_NATIVE_CPP11_TYPES_SUPPORT #define _STDEX_NATIVE_CPP11_TYPES_SUPPORT #endif #endif #if _MSC_VER // Visual C++ fallback #define _STDEX_NATIVE_MICROSOFT_COMPILER_EXTENSIONS_SUPPORT #define _STDEX_CDECL __cdecl #if (__cplusplus &gt;= 199711L) #define _STDEX_NATIVE_CPP_98_SUPPORT #endif #endif // C++ 98 check: #if ((__cplusplus &gt;= 199711L) &amp;&amp; ((defined(__INTEL_COMPILER) || defined(__clang__) || (defined(__GNUC__) &amp;&amp; ((__GNUC__ &gt; 4) || (__GNUC__ == 4 &amp;&amp; __GNUC_MINOR__ &gt;= 4)))))) #ifndef _STDEX_NATIVE_CPP_98_SUPPORT #define _STDEX_NATIVE_CPP_98_SUPPORT #endif #endif</span></span></span></span></code> </pre><br></div></div><br> ç°åœ¨ï¼Œæ¥è‡ªboostçš„å¤§é‡é…ç½®å¼€å§‹å‡ºç°åœ¨æˆ‘çš„è®°å¿†ä¸­ï¼Œè®¸å¤šåŠªåŠ›å·¥ä½œçš„å¼€å‘äººå‘˜ç¼–å†™äº†æ‰€æœ‰è¿™äº›ä¾èµ–äºç¼–è¯‘å™¨çš„å®ï¼Œå¹¶ç»˜åˆ¶äº†ç‰¹å®šç‰ˆæœ¬çš„ç‰¹å®šç¼–è¯‘å™¨æ‰€æ”¯æŒå’Œä¸æ”¯æŒçš„å†…å®¹çš„åœ°å›¾ï¼Œæˆ‘ä¸ªäººå¯¹æ­¤æ„Ÿåˆ°ä¸å®‰ï¼Œæˆ‘æ°¸è¿œä¸è¦çœ‹æˆ–è§¦æ‘¸å®ƒã€‚ ä½†å¥½æ¶ˆæ¯æ˜¯æ‚¨å¯ä»¥åœ¨è¿™é‡Œåœä¸‹æ¥ã€‚ è‡³å°‘å¯¹äºæˆ‘æ¥è¯´ï¼Œè¿™è¶³ä»¥æ”¯æŒå¤§å¤šæ•°æµè¡Œçš„ç¼–è¯‘å™¨ï¼Œä½†æ˜¯å¦‚æœæ‚¨å‘ç°ä¸å‡†ç¡®æˆ–æƒ³è¦æ·»åŠ å…¶ä»–ç¼–è¯‘å™¨ï¼Œæˆ‘å°†éå¸¸ä¹æ„æ¥å—è¯·æ±‚è¯·æ±‚ã€‚ <br><br> ä¸boostç›¸æ¯”ï¼Œè¿™æ˜¯ä¸€ä¸ªäº†ä¸èµ·çš„æˆå°±ï¼Œæˆ‘ç›¸ä¿¡å¯ä»¥åœ¨ä»£ç ä¸­ä¿æŒä¸ç¼–è¯‘å™¨ç›¸å…³çš„å®çš„åˆ†å¸ƒï¼Œè¿™ä½¿ä»£ç æ›´æ•´æ´ï¼Œæ›´æ˜“äºç†è§£ï¼Œå¹¶ä¸”ä¸ä¼šä¸ºæ¯ä¸ªOSå’Œæ¯ä¸ªç¼–è¯‘å™¨å †ç§¯æ•°åä¸ªé…ç½®æ–‡ä»¶ã€‚ ç¨åæˆ‘ä»¬å°†è®¨è®ºè¿™ç§æ–¹æ³•çš„ç¼ºç‚¹ã€‚ <br><br> åœ¨è¿™ä¸€é˜¶æ®µï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥å¼€å§‹è¿æ¥11ç§æ ‡å‡†ä¸­ç¼ºå°‘çš„åŠŸèƒ½ï¼Œè€Œæˆ‘ä»¬é¦–å…ˆä»‹ç»çš„æ˜¯<b>static_assert</b> ã€‚ <br><br><h3>  static_assert </h3><br> æˆ‘ä»¬å®šä¹‰äº†<i>StaticAssertion</i>ç»“æ„ï¼Œè¯¥ç»“æ„å°†å¸ƒå°”å€¼ä½œä¸ºæ¨¡æ¿å‚æ•°-å°†å­˜åœ¨æˆ‘ä»¬çš„æ¡ä»¶ï¼Œå¦‚æœä¸æ»¡è¶³ï¼ˆè¡¨è¾¾å¼ä¸º<b>false</b> ï¼‰ï¼Œåˆ™åœ¨ç¼–è¯‘éä¸“ç”¨æ¨¡æ¿æ—¶ä¼šå‘ç”Ÿé”™è¯¯ã€‚ å¦ä¸€ä¸ªç”¨äºæ¥æ”¶<b>sizeofï¼ˆ</b> <i>StaticAssertion</i> <b>ï¼‰çš„</b>è™šæ‹Ÿç»“æ„ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> stdex { <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> detail { <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StaticAssertion</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StaticAssertion</span></span></span><span class="hljs-class">&lt;true&gt; {</span></span> }; <span class="hljs-comment"><span class="hljs-comment">// StaticAssertion&lt;true&gt; template&lt;int i&gt; struct StaticAssertionTest { }; // StaticAssertionTest&lt;int&gt; } }</span></span></code> </pre><br> ä»¥åŠè¿›ä¸€æ­¥çš„å®è§‚é­”æœ¯ <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> _STDEX_NATIVE_CPP11_SUPPORT #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> STATIC_ASSERT(expression, message) static_assert((expression), #message) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// no C++11 support #define CONCATENATE(arg1, arg2) CONCATENATE1(arg1, arg2) #define CONCATENATE1(arg1, arg2) CONCATENATE2(arg1, arg2) #define CONCATENATE2(arg1, arg2) arg1##arg2 #define STATIC_ASSERT(expression, message)\ struct CONCATENATE(__static_assertion_at_line_, __LINE__)\ {\ stdex::detail::StaticAssertion&lt;static_cast&lt;bool&gt;((expression))&gt; CONCATENATE(CONCATENATE(CONCATENATE(STATIC_ASSERTION_FAILED_AT_LINE_, __LINE__), _WITH__), message);\ };\ typedef stdex::detail::StaticAssertionTest&lt;sizeof(CONCATENATE(__static_assertion_at_line_, __LINE__))&gt; CONCATENATE(__static_assertion_test_at_line_, __LINE__) #ifndef _STDEX_NATIVE_NULLPTR_SUPPORT #define static_assert(expression, message) STATIC_ASSERT(expression, ERROR_MESSAGE_STRING) #endif #endif</span></span></span></span></code> </pre><br> ç”¨æ³•ï¼š <br><br><pre> <code class="cpp hljs">STATIC_ASSERT(<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>*) == <span class="hljs-number"><span class="hljs-number">4</span></span>, non_x32_platform_is_unsupported);</code> </pre><br><blockquote> æˆ‘çš„å®ç°ä¸<a href="">æ ‡å‡†</a>å®ç°ä¹‹é—´çš„é‡è¦åŒºåˆ«æ˜¯ï¼Œåœ¨<u>ä¸</u>å‘ŠçŸ¥ç”¨æˆ·çš„<u>æƒ…å†µä¸‹ï¼Œ</u>ä¸ä¼šé‡è½½æ­¤å…³é”®å­—ã€‚ è¿™æ˜¯ç”±äºä»¥ä¸‹äº‹å®ï¼šåœ¨C ++ä¸­ï¼Œä¸å¯èƒ½å®šä¹‰å¤šä¸ªå…·æœ‰ä¸åŒæ•°é‡çš„å‚æ•°ä½†ä¸€ä¸ªåç§°çš„å®šä¹‰ï¼Œå¹¶ä¸”æ²¡æœ‰æ¶ˆæ¯çš„å®ç°æ¯”æ‰€é€‰é€‰é¡¹çš„ç”¨å¤„å°‘å¾—å¤šã€‚ æ­¤åŠŸèƒ½å¯¼è‡´ä»¥ä¸‹äº‹å®ï¼šä»æœ¬è´¨<b>ä¸Šè®²</b> ï¼Œæˆ‘çš„å®ç°ä¸­çš„<b>STATIC_ASSERT</b>æ˜¯å·²ç»åœ¨C ++ 11ä¸­æ·»åŠ çš„ç‰ˆæœ¬ã€‚ </blockquote> è®©æˆ‘ä»¬çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆã€‚ é€šè¿‡æ£€æŸ¥<b>__cplusplus</b>å’Œéæ ‡å‡†çš„ç¼–è¯‘å™¨å®çš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬è·å¾—äº†æœ‰å…³_STDEX_NATIVE_CPP11_SUPPORT <b>define</b>è¡¨ç¤ºçš„æœ‰å…³C ++ 11æ”¯æŒï¼ˆä»¥åŠå› æ­¤çš„<b>static_assert</b> ï¼‰çš„è¶³å¤Ÿä¿¡æ¯ã€‚ å› æ­¤ï¼Œå¦‚æœå®šä¹‰äº†æ­¤å®ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨æ ‡å‡†çš„<b>static_assert</b> ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> _STDEX_NATIVE_CPP11_SUPPORT #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> STATIC_ASSERT(expression, message) static_assert((expression), #message)</span></span></code> </pre><br><blockquote> è¯·æ³¨æ„ï¼Œ <b>STATIC_ASSERT</b>å®çš„ç¬¬äºŒä¸ªå‚æ•°æ ¹æœ¬ä¸æ˜¯<b>å­—ç¬¦ä¸²æ–‡å­—ï¼Œ</b>å› æ­¤ä½¿ç”¨é¢„å¤„ç†ç¨‹åºè¿ç®—ç¬¦<b>ï¼ƒ</b>æˆ‘ä»¬å°†æŠŠ<i>message</i>å‚æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä»¥ä¼ è¾“åˆ°æ ‡å‡†<b>static_assert</b> ã€‚ </blockquote> å¦‚æœæˆ‘ä»¬æ²¡æœ‰ç¼–è¯‘å™¨çš„æ”¯æŒï¼Œåˆ™ç»§ç»­æ‰§è¡Œã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å°†å£°æ˜ç”¨äºâ€œç²˜åˆâ€å­—ç¬¦ä¸²çš„è¾…åŠ©å®ï¼ˆé¢„å¤„ç†ç¨‹åºè¿ç®—ç¬¦<b>##</b>å¯¹æ­¤è´Ÿè´£ï¼‰ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CONCATENATE(arg1, arg2) CONCATENATE1(arg1, arg2) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CONCATENATE1(arg1, arg2) CONCATENATE2(arg1, arg2) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CONCATENATE2(arg1, arg2) arg1##arg2</span></span></code> </pre><br><blockquote> ä¸ºäº†èƒ½å¤Ÿå°†åŒä¸€<b>CONCATENATE</b>å®çš„ç»“æœä½œä¸ºå‚æ•°ä¼ é€’ç»™<i>arg1</i>å’Œ<i>arg2</i> ï¼Œæˆ‘ç‰¹åˆ«ä¸æ˜¯ç®€å•åœ°ä½¿ç”¨<b>#define CONCATENATEï¼ˆ</b> <i>arg1</i> ï¼Œ <i>arg2</i> <b>ï¼‰</b> <i>arg1 ##</i> <i>arg2</i> ã€‚ </blockquote> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»¥æ¼‚äº®çš„åç§°__static_assertion_at_line_ {è¡Œå·}å£°æ˜ä¸€ä¸ªç»“æ„ï¼ˆå®<b>__LINE__</b>ä¹Ÿç”±æ ‡å‡†å®šä¹‰ï¼Œå¹¶ä¸”å¿…é¡»æ‰©å±•ä¸ºè°ƒç”¨å®ƒçš„è¡Œå·ï¼‰ï¼Œç„¶ååœ¨è¯¥ç»“æ„å†…æ·»åŠ ä¸€ä¸ªç±»å‹ä¸º<i>StaticAssertion</i>çš„å­—æ®µï¼Œåç§°ä¸ºSTATIC_ASSERTION_FAILED_AT_LINE_ {è¡Œå·} _WITHæ¥è‡ªè°ƒç”¨å®çš„é”™è¯¯æ¶ˆæ¯}ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> STATIC_ASSERT(expression, message)\ struct CONCATENATE(__static_assertion_at_line_, __LINE__)\ {\ stdex::detail::StaticAssertion</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;static_cast&lt;bool&gt;((expression))&gt; CONCATENATE(CONCATENATE(CONCATENATE(STATIC_ASSERTION_FAILED_AT_LINE_, __LINE__), _WITH__), message);\ };\ typedef stdex::detail::StaticAssertionTest&lt;sizeof(CONCATENATE(__static_assertion_at_line_, __LINE__))&gt; CONCATENATE(__static_assertion_test_at_line_, __LINE__)</span></span></span></span></code> </pre><br>  <i>ä½¿ç”¨StaticAssertionä¸­çš„</i> templateå‚æ•°<i>ï¼Œ</i>æˆ‘ä»¬ä¼ é€’ä¸€ä¸ªåœ¨<b>STATIC_ASSERTä¸­</b>æ£€æŸ¥çš„è¡¨è¾¾å¼ï¼Œå°†å…¶è½¬æ¢ä¸º<b>bool</b> ã€‚ æœ€åï¼Œä¸ºäº†é¿å…åˆ›å»ºå±€éƒ¨å˜é‡å’Œé›¶å¼€é”€æ£€æŸ¥ç”¨æˆ·æ¡ä»¶ï¼Œå£°æ˜äº†ç±»å‹ä¸º<i>StaticAssertionTest &lt;sizeofï¼ˆ{ä¸Šé¢å£°æ˜çš„ç»“æ„</i>çš„åç§°<i>}ï¼‰</i>çš„åˆ«åï¼Œåç§°ä¸º__static_assertion_test_at_line_ {è¡Œå·}ã€‚ <br><br> å‘½åçš„æ‰€æœ‰ç¾æ„Ÿä»…æ˜¯ä¸ºäº†ä»ç¼–è¯‘é”™è¯¯ä¸­æ¸…æ¥šåœ°è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªè‚¯å®šçš„ç»“æœï¼Œè€Œä¸ä»…æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œè€Œä¸”è¿˜æ˜¾ç¤ºä¸ºæ­¤æ–­è¨€è®¾ç½®çš„é”™è¯¯æ¶ˆæ¯ã€‚  <b>sizeof</b>æŠ€å·§æ˜¯å¼ºåˆ¶ç¼–è¯‘å™¨å®ä¾‹åŒ–<i>StaticAssertion</i>æ¨¡æ¿ç±»çš„å¿…è¦æ¡ä»¶ï¼Œè¯¥æ¨¡æ¿ç±»ä½äºåˆšåˆšå£°æ˜çš„ç»“æ„å†…éƒ¨ï¼Œä»è€Œæ£€æŸ¥ä¼ é€’ç»™assertçš„æ¡ä»¶ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">STATIC_ASSERTç»“æœ</b> <div class="spoiler_text"><blockquote>  GCCï¼š <br>  30ï¼š103ï¼šé”™è¯¯ï¼šå­—æ®µ'STATIC_ASSERTION_FAILED_AT_LINE_36_WITH__non_x32_platform_is_unsupported'å…·æœ‰ä¸å®Œæ•´çš„ç±»å‹'stdex :: detail :: StaticAssertion &lt;false&gt;' <br>  25:36ï¼šæ³¨æ„ï¼šåœ¨å®â€œ CONCATENATE2â€çš„å®šä¹‰ä¸­ <br>  23:36ï¼šæ³¨æ„ï¼šæ‰©å±•å®â€œ CONCATENATE1â€ <br>  30:67ï¼šæ³¨æ„ï¼šæ‰©å±•å®â€œ CONCATENATEâ€ <br>  24:36ï¼šæ³¨æ„ï¼šæ‰©å±•å®â€œ CONCATENATE2â€ <br>  23:36ï¼šæ³¨æ„ï¼šæ‰©å±•å®â€œ CONCATENATE1â€ <br>  30:79ï¼šæ³¨æ„ï¼šæ‰©å±•å®â€œ CONCATENATEâ€ <br>  24:36ï¼šæ³¨æ„ï¼šæ‰©å±•å®â€œ CONCATENATE2â€ <br>  23:36ï¼šæ³¨æ„ï¼šæ‰©å±•å®â€œ CONCATENATE1â€ <br>  30:91ï¼šæ³¨æ„ï¼šåœ¨å®â€œ CONCATENATEâ€çš„æ‰©å±•ä¸­ <br>  36ï¼š3ï¼šæ³¨æ„ï¼šåœ¨å®â€œ STATIC_ASSERTâ€çš„æ‰©å±•ä¸­ <br><br>  Borland C ++ Builderï¼š <br>  [C ++é”™è¯¯] stdex_test.cppï¼ˆ36ï¼‰ï¼šE2450æœªå®šä¹‰ç»“æ„'stdex :: detail :: StaticAssertion &lt;0&gt;' <br>  [C ++é”™è¯¯] stdex_test.cppï¼ˆ36ï¼‰ï¼šE2449â€œ STATIC_ASSERTION_FAILED_AT_LINE_36_WITH__non_x32_platform_is_unsupportedâ€çš„å¤§å°æœªçŸ¥æˆ–ä¸ºé›¶ <br>  [C ++é”™è¯¯] stdex_test.cppï¼ˆ36ï¼‰ï¼šE2450æœªå®šä¹‰ç»“æ„'stdex :: detail :: StaticAssertion &lt;0&gt;' <br><br>  Visual Studioï¼š <br> é”™è¯¯c2079 </blockquote><br></div></div><br> æˆ‘æƒ³æ‹¥æœ‰çš„ç¬¬äºŒä¸ªâ€œæŠ€å·§â€æ˜¯<b>countof-</b>è®¡ç®—æ•°ç»„ä¸­å…ƒç´ çš„æ•°é‡ã€‚  Sisherséå¸¸å–œæ¬¢é€šè¿‡sizeofï¼ˆarrï¼‰/ sizeofï¼ˆarr [0]ï¼‰å£°æ˜æ­¤å®ï¼Œä½†æ˜¯æˆ‘ä»¬å°†ç»§ç»­ã€‚ <br><br><h3> æ•° </h3><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> _STDEX_NATIVE_CPP11_SUPPORT #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;cstddef&gt; namespace stdex { namespace detail { template &lt;class T, std::size_t N&gt; constexpr std::size_t _my_countof(T const (&amp;)[N]) noexcept { return N; } } // namespace detail } #define countof(arr) stdex::detail::_my_countof(arr) #else //no C++11 support #ifdef _STDEX_NATIVE_MICROSOFT_COMPILER_EXTENSIONS_SUPPORT // Visual C++ fallback #include &lt;stdlib.h&gt; #define countof(arr) _countof(arr) #elif defined(_STDEX_NATIVE_CPP_98_SUPPORT)// C++ 98 trick #include &lt;cstddef&gt; template &lt;typename T, std::size_t N&gt; char(&amp;COUNTOF_REQUIRES_ARRAY_ARGUMENT(T(&amp;)[N]))[N]; #define countof(x) sizeof(COUNTOF_REQUIRES_ARRAY_ARGUMENT(x)) #else #define countof(arr) sizeof(arr) / sizeof(arr[0]) #endif</span></span></span></span></code> </pre><br> å¯¹äºæ”¯æŒ<b>constexprçš„</b>ç¼–è¯‘å™¨ï¼Œ <b>æˆ‘ä»¬å°†</b>å£°æ˜æ­¤æ¨¡æ¿çš„constexprç‰ˆæœ¬ï¼ˆå¯¹äºæ‰€æœ‰æ ‡å‡†è€Œè¨€ï¼Œç»å¯¹ä¸éœ€è¦é€šè¿‡<i>COUNTOF_REQUIRES_ARRAY_ARGUMENT</i>æ¨¡æ¿å®ç°ï¼‰ï¼Œå…¶ä½™çš„åˆ™é€šè¿‡æ¨¡æ¿å‡½æ•°<i>COUNTOF_REQUIRES_ARRAY_ARGUMENTå¼•å…¥</i> ã€‚  Visual Studioåœ¨è¿™é‡Œå†æ¬¡ä»¥<b>stdlib.h</b>å¤´æ–‡ä»¶ä¸­å­˜åœ¨<b>_countof</b>è‡ªå·±çš„å®ç°è€Œ<b>è‘—ç§°</b> ã€‚ <br><br>  <i>COUNTOF_REQUIRES_ARRAY_ARGUMENT</i>å‡½æ•°çœ‹èµ·æ¥å¾ˆå“äººï¼Œ <i>å¼„æ¸…æ¥š</i>å®ƒçš„ä½œç”¨éå¸¸æ£˜æ‰‹ã€‚ å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œæ‚¨ä¼šç†è§£å®ƒé‡‡ç”¨æ¨¡æ¿ç±»å‹<i>T</i>å’Œå¤§å°<i>N</i>çš„å…ƒç´ æ•°ç»„ä½œä¸ºå”¯ä¸€å‚æ•°-å› æ­¤ï¼Œåœ¨ä¼ è¾“å…¶ä»–ç±»å‹çš„å…ƒç´ ï¼ˆä¸æ˜¯æ•°ç»„ï¼‰çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°ç¼–è¯‘é”™è¯¯ï¼Œè¿™æ— ç–‘æ˜¯ä»¤äººé«˜å…´çš„ã€‚ ä»”ç»†è§‚å¯Ÿä¸€ä¸‹ï¼Œæ‚¨å¯ä»¥å‘ç°ï¼ˆå¾ˆéš¾ï¼‰è¿”å›äº†å¤§å°ä¸º<i>N</i>çš„<b>char</b>å…ƒç´ æ•°ç»„<i>ã€‚</i> é—®é¢˜æ˜¯ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æ‰€æœ‰è¿™äº›ï¼Ÿ è¿™æ˜¯<b>sizeof</b>è¿ç®—ç¬¦<b>å‘æŒ¥ä½œç”¨çš„åœ°æ–¹</b> ï¼Œå®ƒåœ¨ç¼–è¯‘æ—¶å…·æœ‰ç‹¬ç‰¹çš„å·¥ä½œèƒ½åŠ›ã€‚ è°ƒç”¨<b>sizeofï¼ˆ</b> <i>COUNTOF_REQUIRES_ARRAY_ARGUMENT</i> <b>ï¼‰</b>ç¡®å®šå‡½æ•°è¿”å›çš„<b>char</b>å…ƒç´ æ•°ç»„çš„å¤§å°ï¼Œå¹¶ä¸”ç”±äºæ ‡å‡†<b>sizeofï¼ˆcharï¼‰</b> == 1ï¼Œå› æ­¤è¿™æ˜¯åŸå§‹æ•°ç»„ä¸­<i>Nä¸ª</i>å…ƒç´ çš„æ•°é‡ã€‚ ä¼˜é›…ï¼Œç¾ä¸½ï¼Œå®Œå…¨å…è´¹ã€‚ <br><br><h3> æ°¸è¿œ </h3><br> æˆ‘<b>æ°¸è¿œ</b>éœ€è¦å¦ä¸€ä¸ªæ— é™å¾ªç¯çš„å°è¾…åŠ©å®ï¼Œè¿™æ˜¯<b>æ°¸è¿œçš„</b> ã€‚ å®šä¹‰å¦‚ä¸‹ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> !defined(forever) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> forever for(;;) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> STRINGIZE_HELPER(x) #x #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> STRINGIZE(x) STRINGIZE_HELPER(x) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> WARNING(desc) message(__FILE__ </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"("</span></span></span><span class="hljs-meta"> STRINGIZE(__LINE__) </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">") : warning: "</span></span></span><span class="hljs-meta"> desc) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> WARNING(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"stdex library - macro 'forever' was previously defined by user; ignoring stdex macro definition"</span></span></span><span class="hljs-meta">) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">undef</span></span></span><span class="hljs-meta"> STRINGIZE_HELPER #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">undef</span></span></span><span class="hljs-meta"> STRINGIZE #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">undef</span></span></span><span class="hljs-meta"> WARNING #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span></span></code> </pre><br> å®šä¹‰æ˜¾å¼æ— é™å¾ªç¯çš„ç¤ºä¾‹è¯­æ³•ï¼š <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; forever { ++i; }</code> </pre><br> è¯¥å®ä»…ç”¨äºæ˜¾å¼å®šä¹‰æ— é™å¾ªç¯ï¼Œå¹¶ä¸”ä»…å‡ºäºâ€œæ·»åŠ è¯­æ³•ç³–â€çš„åŸå› è€ŒåŒ…å«åœ¨åº“ä¸­ã€‚ å°†æ¥ï¼Œæˆ‘å»ºè®®å¯ä»¥é€šè¿‡å®šä¹‰<b>FOREVER</b>æ’ä»¶å®æ¥æ›¿æ¢å®ƒã€‚ åœ¨ä¸Šè¿°åº“ä»£ç ç‰‡æ®µä¸­ï¼Œæœ€å¼•äººæ³¨ç›®çš„æ˜¯å¦‚æœç”¨æˆ·å·²ç»å®šä¹‰äº†<b>forever</b>å®ï¼Œåˆ™åŒä¸€<b>WARNING</b>å®ä¼šåœ¨æ‰€æœ‰ç¼–è¯‘å™¨ä¸­ç”Ÿæˆè­¦å‘Šæ¶ˆæ¯ã€‚ å®ƒä½¿ç”¨ç†Ÿæ‚‰çš„æ ‡å‡†<b>__LINE__</b>å®å’Œæ ‡å‡†<b>__FILE__å®</b> ï¼Œè¯¥<b>å®</b>å°†è½¬æ¢ä¸ºå…·æœ‰å½“å‰æºæ–‡ä»¶åç§°çš„å­—ç¬¦ä¸²ã€‚ <br><br><h3>  stdex_assert </h3><br> ä¸ºäº†åœ¨è¿è¡Œæ—¶å®ç°<b>æ–­è¨€</b> ï¼Œå°†å®<b>stdex_assert</b>å¼•å…¥ä¸ºï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> defined(assert) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> NDEBUG #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; #define stdex_assert(condition, message) \ do { \ if (! (condition)) { \ std::cerr &lt;&lt; "Assertion `" #condition "` failed in " &lt;&lt; __FILE__ \ &lt;&lt; " line " &lt;&lt; __LINE__ &lt;&lt; ": " &lt;&lt; message &lt;&lt; std::endl; \ std::terminate(); \ } \ } while (false) #else #define stdex_assert(condition, message) ((void)0) #endif #endif</span></span></span></span></code> </pre><br> æˆ‘ä¸ä¼šè¯´æˆ‘ä¸ºè¿™ä¸ªå®ç°æ„Ÿåˆ°éå¸¸è‡ªè±ªï¼ˆå°†æ¥ä¼šæ›´æ”¹ï¼‰ï¼Œä½†æ˜¯åœ¨è¿™é‡Œä½¿ç”¨äº†ä¸€ç§æœ‰è¶£çš„æŠ€æœ¯ï¼Œæˆ‘æƒ³å¼•èµ·å¤§å®¶çš„æ³¨æ„ã€‚ ä¸ºäº†ä»åº”ç”¨ç¨‹åºä»£ç çš„èŒƒå›´ä¸­éšè—æ£€æŸ¥ï¼Œä½¿ç”¨äº†<b>do</b> <i>{}</i> <b>whileï¼ˆfalseï¼‰</b>æ„é€ ï¼Œè¯¥æ„é€ å°†è¢«æ‰§è¡Œï¼Œè¿™å¾ˆæ˜æ˜¾ï¼Œå¹¶ä¸”ä¸€æ¬¡ä¸ä¼šåœ¨é€šç”¨åº”ç”¨ç¨‹åºä»£ç ä¸­å¼•å…¥â€œæœåŠ¡â€ä»£ç ã€‚ è¯¥æŠ€æœ¯éå¸¸æœ‰ç”¨ï¼Œå¹¶åœ¨åº“ä¸­çš„å…¶ä»–å¤šä¸ªåœ°æ–¹ä½¿ç”¨ã€‚ <br><br> å¦åˆ™ï¼Œå®ç°ä¸æ ‡å‡†<b>æ–­è¨€</b>éå¸¸ç›¸ä¼¼-ä½¿ç”¨æŸä¸ª<b>NDEBUG</b>å®ï¼ˆç¼–è¯‘å™¨é€šå¸¸åœ¨å‘è¡Œç‰ˆæœ¬ä¸­è®¾ç½®è¯¥å®ï¼‰ï¼Œæ–­è¨€ä»€ä¹ˆéƒ½ä¸åšï¼Œå¦åˆ™å¦‚æœä¸æ»¡è¶³æ–­è¨€æ¡ä»¶ï¼Œåˆ™ä¼šä¸­æ–­ç¨‹åºçš„æ‰§è¡Œå¹¶å°†æ¶ˆæ¯è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯æµã€‚ <br><br><h3> æ²¡æœ‰ </h3><br> å¯¹äºä¸å¼•å‘å¼‚å¸¸çš„å‡½æ•°ï¼Œæ–°æ ‡å‡†ä¸­å¼•å…¥äº†<b>noexcept</b>å…³é”®å­—ã€‚ é€šè¿‡å®å®ç°ä¹Ÿæ˜¯éå¸¸ç®€å•å’Œè½»æ¾çš„ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> _STDEX_NATIVE_CPP11_SUPPORT #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> stdex_noexcept noexcept #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> stdex_noexcept throw() #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span></span></code> </pre><br> ä½†æ˜¯ï¼Œæœ‰å¿…è¦äº†è§£ï¼ŒæŒ‰æ ‡å‡†ï¼Œ <b>noexcept</b>å¯ä»¥é‡‡ç”¨å€¼<b>bool</b> ï¼Œå¹¶ä¸”è¿˜<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¯ä»¥ç”¨äº</a>ç¡®å®šåœ¨ç¼–è¯‘æ—¶ä¼ é€’ç»™å®ƒçš„è¡¨è¾¾å¼ä¸ä¼šå¼•å‘å¼‚å¸¸ã€‚ å¦‚æœæ²¡æœ‰ç¼–è¯‘å™¨æ”¯æŒï¼Œåˆ™æ— æ³•å®ç°æ­¤åŠŸèƒ½ï¼Œå› æ­¤è¯¥åº“ä¸­åªæœ‰â€œç²¾ç®€â€çš„<b>stdex_noexcept</b> ã€‚ <br><br> ç¬¬äºŒç« ç»“æŸã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬ä¸‰ç« </a>å°†è®¨è®ºnullptrå®ç°çš„å¤æ‚æ€§ï¼Œä¸ºä»€ä¹ˆä¸åŒçš„ç¼–è¯‘å™¨ä¼šæœ‰æ‰€ä¸åŒï¼Œtype_traitsçš„å¼€å‘ä»¥åŠåœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„ç¼–è¯‘å™¨ä¸­çš„å…¶ä»–é”™è¯¯ã€‚ <br><br> è°¢è°¢æ‚¨çš„å…³æ³¨ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN417099/">https://habr.com/ru/post/zh-CN417099/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN417087/index.html">HPE Digitize 2018ï¼šæ´»åŠ¨å’Œç°åœºç›´æ’­</a></li>
<li><a href="../zh-CN417089/index.html">é‡å­è®¡ç®—æœºï¼šä¸€ä¸ªå…‰å­ç»Ÿæ²»ä¸€åˆ‡</a></li>
<li><a href="../zh-CN417091/index.html">ä¸ºç½‘ç»œåˆ›å»ºå¡é€šæ°´ç€è‰²å™¨ã€‚ ç¬¬ä¸‰éƒ¨åˆ†</a></li>
<li><a href="../zh-CN417093/index.html">å¸¦æœ‰Modbusçš„è§¦æ‘¸å¼€å…³ï¼šä¸ºä»€ä¹ˆéœ€è¦å®ƒä»¬ä»¥åŠå¦‚ä½•åœ¨æ™ºèƒ½å…¬å¯“ä¸­åº”ç”¨å®ƒä»¬</a></li>
<li><a href="../zh-CN417097/index.html">JavaScriptå…ƒç¼–ç¨‹</a></li>
<li><a href="../zh-CN417101/index.html">Readyçš„å®šä¹‰-æˆ‘ä»¬å¿˜äº†å‘Šè¯‰æˆ‘ä»¬çš„</a></li>
<li><a href="../zh-CN417103/index.html">Spark SQLã€‚ å…³äºæŸ¥è¯¢ä¼˜åŒ–å™¨çš„ä¸€äº›çŸ¥è¯†</a></li>
<li><a href="../zh-CN417105/index.html">åœ¨3Dæ‰“å°æœºä¸Šæ‰“å°ã€‚ 3Dtoolçš„ç§˜å¯†ç»å†</a></li>
<li><a href="../zh-CN417107/index.html">Trueæ—¶æ¸¸æˆçš„åˆ›é€ è€…ï¼šäº†è§£ï¼ˆï¼‰æ¸¸æˆå¼€å‘ï¼ŒVRé—®é¢˜å’ŒMLæ¨¡æ‹Ÿçš„çŸ¥è¯†</a></li>
<li><a href="../zh-CN417109/index.html">ç†æŸ¥å¾·Â·æ±‰æ˜ï¼ˆRichard Hammingï¼‰ï¼šç¬¬10ç« ã€‚</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>