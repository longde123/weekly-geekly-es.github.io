<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶ì ü§≥üèø ü•ê Impact de la protection Spectre, Meltdown et Foreshadow sur les performances de Linux 4.19 üõÄüèª üß¶ ü§µüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="R√©cemment, l'une des questions les plus courantes est de savoir comment la protection contre Meltdown / Spectre, et maintenant √©galement contre L1TF /...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Impact de la protection Spectre, Meltdown et Foreshadow sur les performances de Linux 4.19</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421931/">  R√©cemment, l'une des questions les plus courantes est de savoir comment la protection contre Meltdown / Spectre, et maintenant √©galement contre L1TF / Foreshadow, affecte les performances de Linux.  Le d√©but <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du</a> d√©veloppement du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">noyau Linux 4.19</a> ce mois-ci a aliment√© le feu non seulement pour x86_64, mais aussi pour POWER / s390 / ARM.  Pour avoir une id√©e g√©n√©rale de l'effet des correctifs sur les performances, j'ai test√© trois syst√®mes Intel Xeon et deux syst√®mes AMD EPYC, ainsi qu'une machine virtuelle de chaque c√¥t√©, pour √©valuer les performances par d√©faut du noyau Linux 4.19 avec et sans correctifs correspondants. <br><br><img src="https://habrastorage.org/webt/ny/54/eb/ny54eb_sf-hbc3gnhnmicbijlus.jpeg"><br><a name="habracut"></a><br>  Sur toutes les machines, un syst√®me a √©t√© install√© avec le noyau Linux 4.19-rc1 sorti le week-end dernier.  Sur Intel, les correctifs correspondants incluent l'isolement des tables de pages (PTI / KPTI) pour Meltdown et divers correctifs Spectre contre l'ex√©cution sp√©culative de commandes, y compris l'effacement du pointeur __user, en utilisant retpoline via IBPB IBRS_FW, le correctif pour la vuln√©rabilit√© de contournement de magasin sp√©culatif en utilisant prctl et seccomp, et √©galement l'inversion PTE et le vidage conditionnel du cache dans les machines virtuelles - c'est pour L1TF / Foreshadow. <br><br>  Par d√©faut, le noyau Linux ne fournit pas de protection ¬´compl√®te¬ª contre les vuln√©rabilit√©s en d√©sactivant la prise en charge Intel HT / SMT, alors gardez cela √† l'esprit si vous utilisez des machines virtuelles et fournissez du code non fiable ou un acc√®s des utilisateurs √† la machine virtuelle.  Si vous s√©lectionnez une protection compl√®te et d√©sactivez SMT, l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">impact sur les performances est beaucoup plus notable en</a> raison de la r√©duction de moiti√© du nombre de threads disponibles.  Les fournisseurs de services cloud semblent simplement configurer des planificateurs afin que les flux SMT ne passent pas par les utilisateurs.  Cela √©vite le co√ªt √©norme √©vident de la d√©sactivation de Hyper Threading.  Alors maintenant, nous ne faisons que comparer la protection du noyau stock / par d√©faut. <br><br><img src="https://habrastorage.org/webt/kh/fe/dx/khfedx0pj97ldov-l55f4cidlwa.jpeg"><br><br>  AMD EPYC, par d√©faut, fournit une protection uniquement pour les vuln√©rabilit√©s correspondantes qui les concernent: cela efface le pointeur __user pour Spectre V1, AMD Retpoline IBPB pour Spectre V2 et d√©sactive le contournement de magasin sp√©culatif (SSBD) pour Spectre V4. <br><br><img src="https://habrastorage.org/webt/cq/ms/lw/cqmslwmsupwjqmyrsd1dwoypby0.jpeg"><br><br>  Apr√®s avoir test√© toutes les configurations sur le noyau de stock Linux 4.19-rc1, les tests ont √©t√© r√©p√©t√©s en utilisant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">divers commutateurs de protection lors de l'ex√©cution</a> .  Tous les syst√®mes ont √©t√© test√©s avec Ubuntu 18.04.1 LTS x86_64 avec le noyau Linux 4.19-rc1 via Ubuntu Mainline Kernel PPA, le dernier microcode / BIOS, le syst√®me de fichiers GCC 7.3 et EXT4. <br><br><img src="https://habrastorage.org/webt/ml/n5/ps/mln5psdiqvdrykijquh0shkve90.jpeg"><br><br>  Configurations du syst√®me dans le test: <br><br><ul><li>  Intel Xeon E3-1280 v5 Skylake sur carte m√®re MSI Z170A SLI PLUS, 16 Go DDR4 et 256 Go Toshiba RD400 NVMe SSD. </li><li>  Intel Xeon E5-2687W v3 Haswell sur carte m√®re MSI X299 SLI PLUS, 32 Go DDR4 et 80 Go Intel 530 SATA 3.0 SSD. </li><li>  Deux racks Intel Xeon Gold 6138 Tyan 1U avec 96 Go de RAM et SSD Samsung 970 EVO NVMe 256 Go. </li><li>  Machine virtuelle KVM sur le serveur Xeon Gold √† double processeur susmentionn√©.  Cette machine virtuelle √©tait le seul processus actif sur la machine et a √©t√© configur√©e pour acc√©der √† 80% des c≈ìurs / threads du CPU (64 threads), 48 Go de RAM et un disque virtuel de 118 Go.  Pendant les tests, la protection contre les vuln√©rabilit√©s a √©t√© d√©sactiv√©e sur l'h√¥te et la machine virtuelle. </li><li>  AMD EPYC 7601 sur un serveur Tyan 2U avec 128 Go de RAM et 280 Go SSD Intel Optane 900p NVMe. </li><li>  La machine virtuelle KVM sur le serveur AMD EPYC 7601 susmentionn√©. Elle a acc√®s √† 80% des c≈ìurs / threads du processeur (52 threads), 48 Go de RAM et un disque virtuel de 120 Go. </li><li>  Serveur AMD EPYC 7551 sur une carte m√®re Gigabyte MZ31-AR0 avec 32 Go de RAM et SSD NVMe Samsung 960 EVO 256 Go. </li></ul><br>  √âvidemment, les configurations des machines sont diff√©rentes et elles ne sont pas destin√©es √† √™tre compar√©es entre elles, √† savoir pour v√©rifier la protection on / off contre les vuln√©rabilit√©s des processeurs du noyau Linux 4.19.  Par cons√©quent, pour plus de clart√©, toutes les donn√©es sont normalis√©es en fonction des performances de chaque syst√®me.  Tous les tests de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Suite de tests Phoronix</a> . <br><br>  Pour l'article, des tests li√©s √† Spectre / Meltdown, c'est-√†-dire avec des interactions d'entr√©e-sortie ou de noyau intensives, ont √©t√© s√©lectionn√©s.  La charge est uniquement sur le CPU et ne d√©pend pas fortement du cache du processeur. <br><br><img src="https://habrastorage.org/webt/oo/vi/ba/oovibakv98wgg-0sby352zo6718.jpeg"><br><br>  Le profil CompileBench est probablement le moyen le plus simple de montrer l'impact de Spectre / Meltdown.  Sur le noyau Linux 4.19, lorsque la protection est activ√©e, les processeurs Intel affichent une diminution de 7 √† 16% des performances, tandis que les processeurs AMD affichent une diminution de 3 √† 4%. <br><br><img src="https://habrastorage.org/webt/d3/n9/tp/d3n9tpig2tr9pxkzkhtkfoil-um.jpeg"><br><br>  Une situation similaire dans les sous-tests avec la lecture d'un arbre compil√©.  Les processeurs Intel ont une baisse de performances de 14 √† 15%, les processeurs AMD une baisse de 4 √† 5%. <br><br><img src="https://habrastorage.org/webt/_y/u9/lz/_yu9lz69pephav9opkigeaxvtze.jpeg"><br><br>  Dans les t√¢ches r√©elles comme la compilation du noyau Linux, la diff√©rence de performances sera d'environ 2%. <br><br><img src="https://habrastorage.org/webt/sv/-x/ha/sv-xha-gkgnrdkktyibfovq9t8g.jpeg"><br><br>  Le benchmark du planificateur du noyau Hackbench souffre √©galement de l'activation de la s√©curit√©.  Dans les processeurs Intel, les performances sont r√©duites d'environ 20%, √† l'exception de Xeon Gold.  Les syst√®mes AMD EPYC ne font pas beaucoup de diff√©rence. <br><br><img src="https://habrastorage.org/webt/04/06/kd/0406kdun9xswkjy0waknggdgj08.jpeg"><br><br>  Le serveur de base de donn√©es PostgreSQL est l'une des vraies applications qui ont souffert d'une d√©gradation des performances apr√®s l'installation de la protection sur les processeurs.  Dans ce test particulier, la diff√©rence pour les processeurs Intel √©tait de 5 √† 8% et pour les EPYC de 1%. <br><br><img src="https://habrastorage.org/webt/d7/ht/z5/d7htz5ce483cindrcyaoszxhknq.jpeg"><br><br><img src="https://habrastorage.org/webt/_r/g7/gw/_rg7gw5len0ay5jnsascpkopmq8.jpeg"><br><br><img src="https://habrastorage.org/webt/wo/ol/ar/woolarputb09q2zbz83vexnrl5i.jpeg"><br><br>  Un autre vrai programme avec une d√©gradation des performances due √† Spectre / Meltdown est l'√©diteur graphique GIMP.  La diff√©rence pour Intel est de 5 √† 10%, pour AMD - de 0 √† 2%. <br><br><img src="https://habrastorage.org/webt/xc/q6/_w/xcq6_wirra5za2bncyixkzidug4.jpeg"><br><br>  Le SGBD Redis sur le syst√®me Intel Skylake E3 v5 ralentit de 11%, et sur les autres processeurs Intel - de 5-7%, la diff√©rence entre les syst√®mes AMD EPYC est de 1-5%. <br><br><img src="https://habrastorage.org/webt/qm/s1/iu/qms1iupekz-mk2mbz4bvpcuj5nw.jpeg"><br><br>  Le serveur Web Nginx sur les syst√®mes Xeon test√©s sur le noyau Linux 4.19 a montr√© une diff√©rence de performances allant jusqu'√† 20% et sur AMD EPYC - de 1-2% √† 6%. <br><br><img src="https://habrastorage.org/webt/f2/gx/io/f2gxio7epg4idsah433z4owp-yo.jpeg"><br><br>  De m√™me, le serveur Web Apache lors de l'installation par d√©faut s'ex√©cute beaucoup plus lentement apr√®s avoir activ√© la protection sur les processeurs Intel et pratiquement sans modifications sur les processeurs AMD. <br><br><img src="https://habrastorage.org/webt/6x/az/ad/6xazadxauibjyqviwxdwesoex4s.jpeg"><br><br>  Dans le test de la vitesse de cr√©ation de fichiers OSBench, le syst√®me sur Intel Xeon ralentit de 13-16% et les syst√®mes EPYC de 6-9%. <br><br><img src="https://habrastorage.org/webt/jz/vx/g8/jzvxg8ciylrguvqbtfdd_2oy6uy.jpeg"><br><br>  Le test de cr√©ation de threads montre √©galement une diff√©rence notable entre les processeurs Intel et AMD. <br><br><img src="https://habrastorage.org/webt/uc/ic/nw/ucicnw3c70sjdmflrbaccejf1v4.jpeg"><br><br><img src="https://habrastorage.org/webt/aq/ge/nf/aqgenf8s9z88j9mdzb35eq340e8.jpeg"><br><br>  Lors du d√©marrage de programmes et de la cr√©ation de processus, il existe une diff√©rence plus petite mais notable dans le fonctionnement par d√©faut du noyau Linux 4.19 par rapport √† la protection d√©sactiv√©e. <br><br>  Voici comment les choses se passent avec les performances des processeurs sur le noyau Linux 4.19 apr√®s l'installation des correctifs.  Gardez √† l'esprit que si votre syst√®me est ouvert √† des utilisateurs / codes peu fiables, en particulier dans les machines virtuelles, des actions suppl√©mentaires peuvent √™tre n√©cessaires pour la protection, telles que l1tf = full, jusqu'√† la d√©sactivation de SMT / HT ou le vidage obligatoire du cache L1, quoi d'autre diminuera davantage les performances du syst√®me.  L'effet de ces protections contre L1TF / Foreshadow est d√©crit plus en d√©tail dans un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article pr√©c√©dent</a> . <br><br>  Peut-√™tre qu'√† l'avenir, nous ex√©cuterons des tests similaires sur Linux 4.19 avec des processeurs de bureau et les charges de travail correspondantes. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr421931/">https://habr.com/ru/post/fr421931/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421921/index.html">Pourquoi un informaticien devrait "savoir ce que vivent les autres"?</a></li>
<li><a href="../fr421923/index.html">Nous comprenons les m√©tiers du design</a></li>
<li><a href="../fr421925/index.html">Pr√©sentation de l'imprimante 3D Raise 3D Pro 2 Plus</a></li>
<li><a href="../fr421927/index.html">Pr√©sentation du smartphone General Mobile GM8 Go: un employ√© du budget turc avec Android 8.1 Oreo Go Edition</a></li>
<li><a href="../fr421929/index.html">Un an avant le Brexit: la Grande-Bretagne r√©sout le probl√®me des p√©nuries de main-d'≈ìuvre gr√¢ce √† la robotique</a></li>
<li><a href="../fr421933/index.html">L'√©tude du syst√®me de fichiers HDD du mod√®le DVR QCM-08DL</a></li>
<li><a href="../fr421935/index.html">Premi√®res impressions de la transition d'Ubuntu 16.04 LTS √† Ubuntu 18.04 LTS</a></li>
<li><a href="../fr421937/index.html">Smart city inside - un coup d'≈ìil sur Huawei</a></li>
<li><a href="../fr421939/index.html">Utilisation de SQL dans Rails</a></li>
<li><a href="../fr421945/index.html">Google et Mastercard concluent un accord secret pour suivre les achats dans les magasins</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>