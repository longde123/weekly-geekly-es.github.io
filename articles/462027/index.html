<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòé ü•Å üö∑ C√≥mo Dark implementa el c√≥digo de 50 ms ‚òïÔ∏è üë®üèº‚Äç‚úàÔ∏è üè∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cuanto m√°s r√°pido sea el proceso de desarrollo, m√°s r√°pido se desarrolla la empresa de tecnolog√≠a. 


 Desafortunadamente, las aplicaciones modernas f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo Dark implementa el c√≥digo de 50 ms</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/462027/"><p><img src="https://habrastorage.org/webt/o4/lk/bi/o4lkbi449pbpjqw84e0wt-tywlq.png"></p><br><p>  Cuanto m√°s r√°pido sea el proceso de desarrollo, m√°s r√°pido se desarrolla la empresa de tecnolog√≠a. </p><br><p>  Desafortunadamente, las aplicaciones modernas funcionan en nuestra contra: nuestros sistemas deben actualizarse en tiempo real y al mismo tiempo para no molestar a nadie y no provocar tiempos de inactividad e interrupciones.  La implementaci√≥n en tales sistemas se convierte en una tarea compleja y requiere tuber√≠as de entrega continua complejas incluso en equipos peque√±os. </p><br><p>  Estas tuber√≠as generalmente tienen una aplicaci√≥n estrecha, funcionan lentamente y no son confiables.  Los desarrolladores primero deben crearlos manualmente y luego administrarlos, y las empresas a menudo contratan equipos completos de DevOps para esto. </p><br><p>  La velocidad de desarrollo depende de la velocidad de estas tuber√≠as.  Para los mejores equipos, la implementaci√≥n demora entre 5 y 10 minutos, pero generalmente demora mucho m√°s, y para una implementaci√≥n lleva varias horas. </p><a name="habracut"></a><br><p>  En la oscuridad, tarda 50 ms.  <em>Cincuenta.</em>  <em>Milisegundos</em>  Dark es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">una soluci√≥n completa con un lenguaje de programaci√≥n, un editor y una infraestructura</a> dise√±ados espec√≠ficamente para la entrega continua, y todos los aspectos de Dark, incluido el lenguaje en s√≠, se crean con una vista de despliegue instant√°neo seguro. </p><br><h3 id="pochemu-konveyery-nepreryvnoy-postavki-takie-medlennye">  ¬øPor qu√© los transportadores continuos son tan lentos? </h3><br><p> Digamos que tenemos una aplicaci√≥n web de Python y que ya hemos creado un canal de entrega continua maravilloso y moderno.  Para un desarrollador que est√° ocupado con este proyecto todos los d√≠as, la implementaci√≥n de un cambio menor se ver√° as√≠: </p><br><h3 id="vnesenie-izmeneniy">  Haciendo cambios </h3><br><ul><li>  Creando una nueva rama en git </li><li>  Realizar cambios detr√°s del interruptor de funci√≥n </li><li>  Prueba de unidad para verificar cambios con y sin interruptor de funci√≥n </li></ul><br><h3 id="pul-rekvest">  Solicitud de piscina </h3><br><ul><li>  Comprometer comprometer </li><li>  Publicar cambios en un repositorio remoto en github </li><li>  Solicitud de piscina </li><li>  CI se crea autom√°ticamente en segundo plano </li><li>  Revisi√≥n de c√≥digo </li><li>  Algunas revisiones m√°s, si es necesario </li><li>  Combinar cambios con git wizard. </li></ul><br><h3 id="ci-vypolnyaetsya-na-mastere">  CI se ejecuta en el asistente </h3><br><ul><li>  Establecer dependencias frontend a trav√©s de npm </li><li>  Creaci√≥n y optimizaci√≥n de recursos HTML + CSS + JS </li><li>  Ejecutar en el extremo frontal de las pruebas unitarias y funcionales </li><li>  Instalar dependencias de Python desde PyPI </li><li>  Ejecutar en el backend de pruebas unitarias y funcionales </li><li>  Pruebas de integraci√≥n en ambos extremos. </li><li>  Enviar recursos frontend a CDN </li><li>  Construyendo un contenedor para un programa Python </li><li>  Enviar un contenedor al registro </li><li>  Actualizaci√≥n del manifiesto de Kubernetes </li></ul><br><h3 id="zamena-starogo-koda-novym">  Sustituci√≥n de c√≥digo antiguo por nuevo </h3><br><ul><li>  Kubernetes lanza m√∫ltiples instancias de un nuevo contenedor </li><li>  Kubernetes est√° esperando que las instancias entren en funcionamiento </li><li>  Kubernetes agrega instancias al equilibrador de carga HTTP </li><li>  Kubernetes espera a que las viejas instancias dejen de usarse </li><li>  Kubernetes detiene instancias antiguas </li><li>  Kubernetes repite estas operaciones hasta que las nuevas instancias reemplacen a todas las antiguas. </li></ul><br><h3 id="vklyuchenie-novogo-pereklyuchatelya-funkcii">  Encienda el nuevo interruptor de funci√≥n </h3><br><ul><li>  El nuevo c√≥digo se incluye solo para m√≠, para asegurarme de que todo est√© bien </li><li>  Se incluye un nuevo c√≥digo para el 10% de los usuarios; se realiza un seguimiento de las m√©tricas operativas y comerciales </li><li>  Se incluye un nuevo c√≥digo para el 50% de los usuarios; se realiza un seguimiento de las m√©tricas operativas y comerciales </li><li>  El nuevo c√≥digo se incluye para el 100% de los usuarios, se realiza un seguimiento de las m√©tricas operativas y comerciales </li><li>  Finalmente, repite todo el procedimiento para eliminar el c√≥digo anterior y cambiar </li></ul><br><p>  El proceso depende de las herramientas, el lenguaje y el uso de arquitecturas orientadas a servicios, pero en t√©rminos generales, se ve as√≠.  No mencion√© las implementaciones de migraci√≥n de bases de datos porque esto requiere una planificaci√≥n cuidadosa, pero a continuaci√≥n describir√© c√≥mo Dark trata con esto. </p><br><p>  Aqu√≠ hay muchos componentes, y muchos de ellos pueden ralentizarse f√°cilmente, bloquearse, provocar una competencia temporal o hacer caer el sistema de trabajo. </p><br><p>  Y dado que estas tuber√≠as casi siempre se crean para una ocasi√≥n especial, es dif√≠cil confiar en ellas.  Muchas personas tienen d√≠as en los que el c√≥digo no se puede implementar, porque hay problemas en el Dockerfile, uno de los docenas de servicios bloqueados o el especialista adecuado en vacaciones. </p><br><p>  Peor a√∫n, muchos de estos pasos no hacen nada en absoluto.  Los necesit√°bamos antes cuando implementamos el c√≥digo de inmediato para los usuarios, pero ahora tenemos conmutadores para el nuevo c√≥digo, y estos procesos est√°n divididos.  Como resultado, el paso en el que se implementa el c√≥digo (el antiguo se reemplaza por el nuevo) ahora se ha convertido en un riesgo adicional. </p><br><p>  Por supuesto, esta es una tuber√≠a muy reflexiva.  El equipo que lo cre√≥ se tom√≥ el tiempo y el dinero para implementarlo r√°pidamente.  Por lo general, las canalizaciones de implementaci√≥n son mucho m√°s lentas y poco confiables. </p><br><h3 id="realizaciya-nepreryvnoy-postavki-v-dark">  Implementaci√≥n de entrega continua en la oscuridad </h3><br><p>  La entrega continua es tan importante para Dark que fijamos nuestra vista a tiempo en menos de un segundo.  Recorrimos todos los pasos de la tuber√≠a para eliminar todo lo innecesario, y recordamos el resto.  As√≠ es como eliminamos los pasos. </p><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jessie Frazelle</a> acu√±√≥ la nueva palabra deployless en la conferencia Future of Software Development en Reykjavik </blockquote><p>  Inmediatamente decidimos que Dark se basar√≠a en el concepto de "sin despliegue" (gracias a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jesse Frazel</a> por el neologismo).  Sin implementaci√≥n significa que cualquier c√≥digo se implementa instant√°neamente y est√° listo para usarse en producci√≥n.  Por supuesto, no vamos a perder un c√≥digo defectuoso o incompleto (describir√© los principios de seguridad a continuaci√≥n). </p><br><p>  En la demostraci√≥n de Dark, a menudo nos preguntaban c√≥mo logramos acelerar la implementaci√≥n.  Pregunta extra√±a  La gente probablemente piense que hemos encontrado alg√∫n tipo de supertecnolog√≠a que compara el c√≥digo, lo compila, lo empaqueta en un contenedor, lanza una m√°quina virtual, lanza un contenedor en uno fr√≠o y cosas as√≠, y todo esto en 50 ms.  Esto es casi imposible.  Pero hemos creado un motor de despliegue especial, que no necesita todo esto. </p><br><p>  Dark lanza int√©rpretes en la nube.  Suponga que escribe c√≥digo en una funci√≥n o controlador para HTTP o eventos.  Enviamos diff al √°rbol de sintaxis abstracta (la implementaci√≥n del c√≥digo utilizado internamente por nuestro editor y servidores) a nuestros servidores, y luego ejecutamos este c√≥digo cuando se reciben solicitudes.  Por lo tanto, la implementaci√≥n se ve como un registro modesto en la base de datos: instant√°nea y primaria.  La implementaci√≥n es muy r√°pida porque incluye lo m√≠nimo. </p><br><p>  En el futuro, planeamos hacer un compilador de infraestructura de Dark, que crear√° y ejecutar√° la infraestructura ideal para un alto rendimiento y confiabilidad de las aplicaciones.  La implementaci√≥n instant√°nea, por supuesto, no va a ninguna parte. </p><br><h2 id="bezopasnoe-razvertyvanie">  Despliegue seguro </h2><br><h3 id="strukturirovannyy-redaktor">  Editor estructurado </h3><br><p>  El c√≥digo en Dark est√° escrito en el editor Dark.  El editor estructurado no comete errores de sintaxis.  De hecho, Dark ni siquiera tiene un analizador.  A medida que escribe, trabajamos directamente con el √Årbol de sintaxis abstracta (AST) como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Paredit</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Sketch-n-Sketch</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Tofu</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Prune</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MPS</a> . </p><br><p>  Cualquier c√≥digo incompleto en Dark tiene una sem√°ntica de ejecuci√≥n v√°lida, al igual que los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">agujeros escritos en Hazel</a> .  Por ejemplo, si cambia una llamada de funci√≥n, mantenemos la funci√≥n anterior hasta que se pueda utilizar la nueva. </p><br><p>  Cada programa en Dark tiene su propio significado, por lo que un c√≥digo incompleto no interfiere con el trabajo terminado. </p><br><h3 id="rezhimy-redaktirovaniya">  Modos de edici√≥n </h3><br><p>  Escribes c√≥digo en Dark en dos casos.  Primero: escribe un c√≥digo nuevo y es el √∫nico usuario.  Por ejemplo, est√° en el REPL, y otros usuarios nunca tendr√°n acceso a √©l, o es una nueva ruta HTTP a la que no se refiere en ning√∫n lado.  Puede trabajar aqu√≠ sin precauciones, y ahora est√° trabajando aproximadamente en el entorno de desarrollo. </p><br><p>  Segunda situaci√≥n: el c√≥digo ya est√° en uso.  Si el tr√°fico pasa por el c√≥digo (funciones, controladores de eventos, bases de datos, tipo), se debe tener cuidado.  Para hacer esto, bloqueamos todo el c√≥digo usado y requerimos el uso de herramientas m√°s estructuradas para editarlo.  A continuaci√≥n, hablar√© sobre las herramientas estructurales: conmutadores de funciones para HTTP y controladores de eventos, una potente plataforma de migraci√≥n para bases de datos y un nuevo m√©todo de control de versiones para funciones y tipos. </p><br><h3 id="pereklyuchateli-funkciy">  Interruptores de funci√≥n </h3><br><p>  Una forma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de eliminar la complejidad adicional</a> en Dark es solucionar varios problemas con una soluci√≥n.  Los conmutadores de funciones realizan muchas tareas diferentes: reemplazar el entorno de desarrollo local, las ramas de git, implementar c√≥digo y, por supuesto, la versi√≥n tradicional lenta y controlada de c√≥digo nuevo. </p><br><p>  La creaci√≥n y el despliegue de un cambio de funci√≥n se realiza en nuestro editor en una sola operaci√≥n.  Crea un espacio vac√≠o para el nuevo c√≥digo y proporciona controles de acceso para el antiguo y el nuevo c√≥digo, as√≠ como botones y comandos para la transici√≥n gradual al nuevo c√≥digo o su exclusi√≥n. </p><br><p>  Los conmutadores de funci√≥n est√°n integrados en el lenguaje oscuro, e incluso los conmutadores incompletos realizan su tarea: si no se cumple la condici√≥n del conmutador, se ejecutar√° el c√≥digo bloqueado anterior. </p><br><h3 id="sreda-razrabotki">  Entorno de desarrollo </h3><br><p>  Los interruptores de funci√≥n reemplazan el entorno de desarrollo local.  Hoy en d√≠a, es dif√≠cil para los equipos asegurarse de que todos usen las mismas versiones de herramientas y bibliotecas (formateadores de c√≥digo, linters, gestores de paquetes, compiladores, preprocesadores, herramientas de prueba, etc.) Con Dark, no necesita instalar dependencias localmente, controlar la instalaci√≥n local de Docker o tomar otras medidas para garantizar al menos una apariencia de igualdad entre el entorno de desarrollo y la producci√≥n.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dado que tal igualdad sigue siendo imposible</a> , ni siquiera pretendemos que nos estamos esforzando por lograrla. </p><br><p>  En lugar de crear un entorno local clonado, los conmutadores en Dark crean un nuevo entorno limitado en producci√≥n que reemplaza el entorno de desarrollo.  En el futuro, tambi√©n planeamos crear un entorno limitado para otras partes de la aplicaci√≥n (por ejemplo, clones de bases de datos instant√°neos), aunque por ahora esto no parece tan importante. </p><br><h3 id="vetki-i-razvertyvaniya">  Ramas y despliegues </h3><br><p>  Ahora hay varias formas de ingresar c√≥digo nuevo en los sistemas: ramas git, la fase de implementaci√≥n y los conmutadores de funciones.  Resuelven un problema en diferentes partes del flujo de trabajo: git - en las etapas previas a la implementaci√≥n, implementaci√≥n - en el momento de la transici√≥n del c√≥digo antiguo al nuevo, y los conmutadores de funci√≥n - para la liberaci√≥n controlada de c√≥digo nuevo. </p><br><p>  La forma m√°s efectiva es cambiar de funci√≥n (al mismo tiempo, la m√°s f√°cil de entender y usar).  Con ellos, puedes abandonar por completo los otros dos m√©todos.  Es especialmente √∫til eliminar la implementaci√≥n: si usamos interruptores de funci√≥n para incluir el c√≥digo de todos modos, el paso de transferir los servidores al nuevo c√≥digo solo crea riesgos innecesarios. </p><br><p>  Git es dif√≠cil de usar, especialmente para principiantes, y realmente lo limita, pero tiene ramas convenientes.  Alisamos muchos de los defectos de git.  Dark se edita en tiempo real y ofrece la capacidad de trabajar juntos al estilo de Google Docs, de modo que no tiene que enviar el c√≥digo y con menos frecuencia puede realizar la reubicaci√≥n y la fusi√≥n. </p><br><p>  Los conmutadores de funciones respaldan la implementaci√≥n segura.  Junto con las implementaciones instant√°neas, le permiten probar r√°pidamente conceptos en peque√±os fragmentos con un bajo riesgo, en lugar de aplicar un cambio importante que puede hacer caer el sistema. </p><br><h3 id="versionirovanie">  Versionado </h3><br><p>  Para cambiar las funciones y los tipos, usamos versiones.  Si desea cambiar una funci√≥n, Dark crea una nueva versi√≥n de esta funci√≥n.  Luego puede invocar esta versi√≥n utilizando el conmutador en el controlador de eventos o HTTP.  (Si esta funci√≥n es profunda en el gr√°fico de llamadas, se crea una nueva versi√≥n de cada funci√≥n en el proceso. Puede parecer que es demasiado, pero las funciones no interfieren si no las usa, por lo que ni siquiera lo notar√°). </p><br><p>  Por las mismas razones, estamos versionando tipos.  Hablamos sobre nuestro sistema de tipos en detalle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en una publicaci√≥n anterior</a> . </p><br><p>  Al versionar funciones y tipos, puede realizar cambios en la aplicaci√≥n gradualmente.  Puede verificar que cada controlador individual funcione con la nueva versi√≥n, no necesita hacer todos los cambios de forma inmediata en las aplicaciones (pero tenemos herramientas para hacerlo r√°pidamente si lo desea). </p><br><p>  Esto es mucho m√°s seguro que desplegar todo de una vez, como lo es ahora. </p><br><h3 id="novye-versii-paketov-i-standartnaya-biblioteka">  Nuevas versiones de paquetes y biblioteca est√°ndar </h3><br><p>  Cuando actualiza un paquete en Dark, no reemplazamos inmediatamente el uso de cada funci√≥n o tipo en toda la base de c√≥digo.  Esto no es seguro.  El c√≥digo contin√∫a usando la misma versi√≥n que us√≥, y usted actualiza el uso de funciones y tipos a una nueva versi√≥n para cada caso individual usando los interruptores. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/rh/t3/4w/rht34wyibolrgracbz88tnqqhg0.png"></a> <br>  <em>Una captura de pantalla de una parte de un proceso autom√°tico en Dark que muestra dos versiones de la funci√≥n Dict :: get.</em>  <em>Dict :: get_v0 devolvi√≥ el tipo Any (que rechazamos), y Dict :: get_v1 devolvi√≥ el tipo Option.</em> </p><br><p>  A menudo ofrecemos una nueva funci√≥n en la biblioteca est√°ndar y excluimos versiones anteriores.  Los usuarios con versiones antiguas en el c√≥digo conservar√°n el acceso a ellos, pero los nuevos usuarios no podr√°n obtenerlos.  Vamos a proporcionar herramientas para transferir usuarios de versiones antiguas a versiones nuevas en 1 paso, y nuevamente usando interruptores de funci√≥n. </p><br><p>  Dark tambi√©n brinda una oportunidad √∫nica: una vez que ejecutamos su c√≥digo de trabajo, podemos probar las nuevas versiones nosotros mismos, comparando el resultado de las solicitudes nuevas y antiguas para informarle sobre los cambios.  Como resultado, las actualizaciones de paquetes, que a menudo se realizan a ciegas (o requieren pruebas de seguridad rigurosas), presentan muchos menos riesgos y pueden ocurrir autom√°ticamente. </p><br><h3 id="novye-versii-dark">  Nuevas versiones oscuras </h3><br><p>  La transici√≥n de Python 2 a Python 3 se ha prolongado durante una d√©cada y sigue siendo un problema.  Una vez que creamos Dark para la entrega continua, estos cambios de idioma deben considerarse. </p><br><p>  Cuando hacemos peque√±os cambios en el idioma, creamos una nueva versi√≥n de Dark.  El c√≥digo antiguo permanece en la versi√≥n anterior de Dark, y el nuevo c√≥digo se usa en la nueva versi√≥n.  Para cambiar a la nueva versi√≥n de Dark, puede usar los interruptores o versiones de funciones. </p><br><p>  Esto es especialmente √∫til teniendo en cuenta que Dark ha aparecido recientemente.  Muchos cambios en el idioma o la biblioteca pueden fallar.  La versi√≥n gradual del lenguaje nos permite hacer actualizaciones menores, es decir, no podemos apurarnos y posponer muchas decisiones sobre el idioma hasta que tengamos m√°s usuarios y, por lo tanto, m√°s informaci√≥n. </p><br><h3 id="migracii-baz-dannyh">  Migraciones de bases de datos </h3><br><p>  Existe una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">f√≥rmula est√°ndar</a> para la migraci√≥n segura de la base de datos: </p><br><ul><li>  Reescribe el c√≥digo para admitir formatos nuevos y antiguos </li><li>  Convierta todos los datos a un nuevo formato </li><li>  Eliminar acceso a datos antiguos </li></ul><br><p>  Como resultado, la migraci√≥n de la base de datos se retrasa y requiere muchos recursos.  Y estamos acumulando esquemas obsoletos, porque incluso las tareas simples, como corregir el nombre de una tabla o columna, no valen la pena. </p><br><p>  Dark tiene una plataforma de migraci√≥n de base de datos efectiva que (esperamos) simplificar√° tanto el proceso que ya no le tendr√° miedo.  Todos los almacenes de datos en Dark (pares clave-valor o tablas hash persistentes) son de tipo.  Para migrar un almac√©n de datos, simplemente asigne un nuevo tipo y una funci√≥n de reversi√≥n y reversi√≥n para convertir valores entre los dos tipos. </p><br><p>  El acceso a los almacenes de datos en Dark es a trav√©s de nombres de variables versionadas.  Por ejemplo, el almac√©n de datos de los usuarios inicialmente se llamar√≠a Users-v0.  Cuando se crea una nueva versi√≥n con un tipo diferente, el nombre cambia a Users-v1.  Si los datos se guardan a trav√©s de Users-v0, y usted accede a ellos a trav√©s de Users-v1, se aplica la funci√≥n roll-over.  Si los datos se guardan a trav√©s de Users-v1, y usted accede a ellos a trav√©s de Users-v0, se utiliza la funci√≥n de reversi√≥n. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/ui/sl/wd/uislwdrfrvact0d1ts5icnk-4ka.png"></a> <br>  <em>Pantalla de migraci√≥n de base de datos con nombres de campo para la antigua base de datos, expresiones de reversi√≥n y reversi√≥n e instrucciones para habilitar la migraci√≥n.</em> </p><br><p>  Use los conmutadores de funci√≥n para enrutar llamadas a Users-v0 a Users-v1.  Puede hacer este √∫nico controlador HTTP a la vez para reducir los riesgos, y los conmutadores tambi√©n funcionan para usuarios individuales para que pueda verificar que todo funcione como se esperaba.  Cuando Users-v0 no se deja, Dark convierte todos los datos restantes en segundo plano del formato anterior al nuevo.  Ni siquiera lo notar√°s. </p><br><h3 id="testirovanie">  Prueba </h3><br><p>  Dark es un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lenguaje de programaci√≥n funcional con escritura est√°tica</a> y valores inmutables; por lo tanto, su superficie de prueba es significativamente m√°s peque√±a en comparaci√≥n con los lenguajes orientados a objetos con escritura din√°mica.  Pero a√∫n necesitas probar. <br>  En Dark, el editor ejecuta autom√°ticamente pruebas unitarias en segundo plano para el c√≥digo editable y, de forma predeterminada, ejecuta estas pruebas para todos los interruptores de funci√≥n.  En el futuro, queremos usar los tipos est√°ticos para eliminar autom√°ticamente el c√≥digo para encontrar errores. </p><br><p>  Adem√°s, Dark ejecuta su infraestructura en producci√≥n, y esto abre nuevas posibilidades.  Guardamos autom√°ticamente las solicitudes HTTP en la infraestructura oscura (por ahora guardamos todas las solicitudes, pero luego queremos cambiar a la b√∫squeda).  Probamos un nuevo c√≥digo en ellos y realizamos pruebas unitarias, y si lo desea, puede convertir f√°cilmente consultas interesantes en pruebas unitarias. </p><br><h3 id="ot-chego-my-izbavilis">  De lo que nos deshacemos </h3><br><p>  Como no tenemos una implementaci√≥n, pero hay conmutadores de funciones, aproximadamente el 60% de la tuber√≠a de implementaci√≥n permanece por la borda.  No necesitamos sucursales de git o solicitudes de agrupaci√≥n, creaci√≥n de recursos y contenedores de back-end, env√≠o de recursos y contenedores a registros o pasos de implementaci√≥n en Kubernetes. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/gc/9e/g-/gc9eg-szouq0dtrxxr8jd6c6dyo.jpeg"></a> <br>  <em>Comparaci√≥n de la tuber√≠a de entrega continua est√°ndar (izquierda) y el suministro continuo de Dark (derecha).</em>  <em>En Dark, la entrega consta de 6 pasos y un ciclo, mientras que la versi√≥n tradicional incluye 35 pasos y 3 ciclos.</em> </p><br><p>  En Dark, solo hay 6 pasos y 1 ciclo en la implementaci√≥n (pasos que se repiten varias veces), mientras que la tuber√≠a de suministro continuo moderno consta de 35 pasos y 3 ciclos.  En Dark, las pruebas se ejecutan autom√°ticamente y ni siquiera lo ves;  las dependencias se instalan autom√°ticamente;  todo lo relacionado con git o github ya no es necesario;  No es necesario recolectar, probar y enviar contenedores Docker;  La implementaci√≥n de Kubernetes ya no es necesaria. </p><br><p>  Incluso los pasos restantes en Dark se han vuelto m√°s f√°ciles.  Dado que los conmutadores de funciones se pueden controlar en una sola acci√≥n, no tiene que pasar por todo el proceso de implementaci√≥n por segunda vez para eliminar el c√≥digo anterior. </p><br><p>  Simplificamos la entrega de c√≥digo tanto como sea posible, reduciendo el tiempo y los riesgos de la entrega continua.  Tambi√©n simplificamos enormemente las actualizaciones de paquetes, las migraciones de bases de datos, las pruebas, el control de versiones, la instalaci√≥n de dependencias, la igualdad entre el entorno de desarrollo y la producci√≥n, y las actualizaciones de versiones de idiomas r√°pidas y seguras. </p><br><p>  Respondo preguntas sobre esto en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">HackerNews</a> . </p><br><p>  Para obtener m√°s informaci√≥n sobre el dispositivo Dark, lea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el art√≠culo de Dark</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">s√≠ganos en Twitter</a> (o en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">m√≠</a> ) o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">reg√≠strese en una versi√≥n beta y reciba notificaciones de las siguientes publicaciones</a> .  Si vienes a StrangeLoop en septiembre, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ven a nuestro lanzamiento</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/462027/">https://habr.com/ru/post/462027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../462013/index.html">Historial de problemas de migraci√≥n de Docker Storage (Docker root)</a></li>
<li><a href="../462015/index.html">Universo de informes de SAP</a></li>
<li><a href="../462021/index.html">C√≥mo dejar de hacer lo mismo</a></li>
<li><a href="../462023/index.html">Cascadeur: el futuro de la animaci√≥n del juego</a></li>
<li><a href="../462025/index.html">Modelo de datos de red relacional</a></li>
<li><a href="../462029/index.html">19 caracter√≠sticas √∫tiles del archivo .htaccess</a></li>
<li><a href="../462031/index.html">¬°Como si leyeras los registros !: inicia Hotspot 2.0 en la red Wi-Fi en el metro</a></li>
<li><a href="../462033/index.html">La √∫ltima cena de desarrolladores</a></li>
<li><a href="../462035/index.html">Python Vs R - Ciencia de datos</a></li>
<li><a href="../462041/index.html">Enfoques de segmentaci√≥n m√≥vil - Traducci√≥n</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>