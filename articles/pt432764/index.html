<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßë‚Äçü§ù‚Äçüßë ü§• üëêüèº UDB. O que √© isso? ‚ôçÔ∏è üçè üë©üèø‚Äçü§ù‚Äçüë®üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nos coment√°rios do meu artigo sobre o controle de LEDs RGB usando o bloco PSoC do microcontrolador UDB da Cypress, sugeriu-se que seria bom dizer brev...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>UDB. O que √© isso?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432764/"><img src="https://habrastorage.org/webt/-g/uu/1k/-guu1klnqoqlqkjqj0jhxdp87o0.jpeg"><br><br>  Nos coment√°rios do meu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo sobre o controle de LEDs RGB usando o bloco PSoC do microcontrolador UDB da Cypress,</a> sugeriu-se que seria bom dizer brevemente no in√≠cio do artigo o que √© UDB.  Como j√° observei no artigo, n√£o posso escrever sobre o UDB brevemente, mas voc√™ pode simplesmente transferir a documenta√ß√£o da empresa para familiarizar o leitor dom√©stico com uma ferramenta t√£o poderosa para implementar as fun√ß√µes de firmware. <br><a name="habracut"></a><br><br>  Mas primeiro, vejamos o que √© PSoC.  PSoC √© uma fam√≠lia de chipsets Cypress para implementar sistemas integrados.  Fam√≠lias diferentes t√™m um n√∫cleo de processador diferente (para PSoC 3 √© MCS-51, para PSoC 4 √© Cortex M0, para PSoC 5LP √© Cortex M3 e para PSoC 6 s√£o duas de uma vez: Cortex M0 + e Cortex M4) e um conjunto de l√≥gica program√°vel.  Al√©m disso, essa l√≥gica n√£o √© puramente digital; h√° coisas anal√≥gicas l√°.  Al√©m de um conjunto de diferentes ADCs, tamb√©m existem comutadores anal√≥gicos.  Voc√™ pode at√© conectar programaticamente as pernas atrav√©s de circuitos anal√≥gicos, no entanto, a resist√™ncia do circuito ser√° medida em quilogramas.  Existem amplificadores operacionais dentro do PSoC que podem ser alternados programaticamente, o que significa que voc√™ pode construir diferentes blocos anal√≥gicos neles. <br><br>  A prop√≥sito, os PSoCs podem ser alimentados por qualquer voltagem de 2,7 a 5,5 volts.  Ou seja, voc√™ n√£o precisa pensar em nenhum tipo de estabilizador com energia da bateria ou com USB. <br><br>  Mas eu escrevi sobre coisas anal√≥gicas puramente para uma palavra vermelha.  Agora vamos nos concentrar nas coisas digitais.  A maioria dos controladores modernos possui unidades perif√©ricas poderosas que fornecem uma enorme variedade de fun√ß√µes.  Mas, na pr√°tica, em cada desenvolvimento de software espec√≠fico, esses blocos n√£o s√£o totalmente utilizados, mas apenas parcialmente.  E no PSoC, em vez de um monte de coisas boas, a l√≥gica do programa √© implementada, semelhante √† l√≥gica dos FPGAs cl√°ssicos.  Dessa forma, √© poss√≠vel implementar exatamente os blocos necess√°rios, incluindo-os nos modos necess√°rios.  E os recursos n√£o devem ser gastos em modos n√£o utilizados, dando-os para a implementa√ß√£o de algum tipo de coisas pr√≥prias. <br><br>  E aqui muitas vezes surgem alguns mal-entendidos.  Muitos desenvolvedores est√£o acostumados ao fato de que existem dois tipos de circuitos integrados de l√≥gica program√°vel (FPGAs): CPLD e FPGA.  Portanto, muitos que ouviram falar do PSoC acreditam que existe um tipo de CPLD-box que pode ser programado no Veriolg.  De fato, sim e n√£o.  Um certo n√∫mero de PLDs (sem "C", apenas PLDs) est√° realmente l√°, e voc√™ pode realmente program√°-los no Verilog.  Mas, realmente, esses PLDs fazem parte dos blocos UDB.  E √© o UDB que √© o principal elemento da l√≥gica program√°vel implementada no PSoC.  Este bloco √© extremamente original e oferece simplesmente as mais amplas oportunidades para o desenvolvedor.  Considere a figura da documenta√ß√£o corporativa que explica a ess√™ncia do uso de blocos UDB. <br><br><img src="https://habrastorage.org/webt/ge/96/v7/ge96v7q6f8qwol5v38hqy1qfook.png"><br><br>  Como estudei tudo usando a fam√≠lia PSoC 5LP como exemplo, vou traduzir a documenta√ß√£o para ele.  Mas antes de come√ßar, direi algumas palavras sobre o pre√ßo desses controladores.  Se voc√™ for ao Ali Express e olhar a t√°bua de p√£o para eles, ter√° uma sensa√ß√£o triste.  Francamente falando, em compara√ß√£o com STM32-DISCOVERY, eles ainda n√£o s√£o nada, mas em compara√ß√£o com os prot√≥tipos STM32F103C8T6, eles s√£o um pouco caros.  Antes de tudo, isso se deve ao fato de que os modelos corporativos sempre n√£o t√™m um, mas dois controladores.  As fun√ß√µes JTAG s√£o implementadas no PSoC 5LP, mesmo que o controlador de destino e o PSoC 4 (o √∫ltimo geralmente n√£o possua uma porta USB). <br><br>  Mas dividindo o pre√ßo por dois, ainda conseguimos que seja mais alto que o do STM32F103, que √© semelhante no n√∫cleo do processador.  No entanto, se adicionarmos o CPLD mais simples ao mesmo STM32 do lado de fora, o pre√ßo total sair√° a favor do PSoC.  E adicionaremos as pernas perdidas √† conex√£o desses dois casos (o PSoC tem todas as conex√µes internas).  E tamb√©m o pre√ßo de cent√≠metros quadrados do tabuleiro.  Portanto, se voc√™ precisar trabalhar apenas com o n√∫cleo do processador, o PSoC realmente n√£o ser√° necess√°rio.  Se voc√™ precisar trazer alguma funcionalidade ao n√≠vel do firmware ou hardware, precisar√° do PSoC.  Nele, o sistema sair√° mais barato e f√°cil. <br><br>  Na verdade, tenho uma ideia man√≠aca de tentar fazer suporte de hardware para o kernel do nosso RTOS MAX.  Para fazer isso, estudei a metodologia para o desenvolvimento de aplicativos Bare Metal para o Altera V SoC (infelizmente, o recurso de arquitetura existe de tal forma que o sistema operacional pode ser mais lento, mas voc√™ n√£o pode aceler√°-lo - solicita√ß√µes √∫nicas ao hardware v√™m com lat√™ncia louca).  Para isso, comecei a dominar o PSoC.  N√£o cheguei ao overclock do kernel (existem apenas pensamentos gerais), mas gostei muito da ideia da programa√ß√£o UDB.  Obviamente, agora estou interessado em levar essa id√©ia ao n√∫mero m√°ximo de programadores dom√©sticos.  Portanto, prosseguimos com a tradu√ß√£o da parte correspondente da documenta√ß√£o propriet√°ria do Cypress no UDB.  A numera√ß√£o dos cap√≠tulos e figuras √© mantida de acordo com o documento original. <br><br>  O conte√∫do geral do ciclo ‚ÄúUDB.  O que √© isso? " <br>  Parte 1. Introdu√ß√£o.  Pld.  (Artigo atual) <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2. Datapath.</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3. Datapath FIFO.</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 4. Datapath ALU.</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 5. Caminho de Dados.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pequenas coisas √∫teis.</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 6. M√≥dulo de gerenciamento e status.</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 7. M√≥dulo de controle de tempo e redefini√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 8. Endere√ßando UDB</a> <br><br><h1>  UDB.  O que √© isso?  Parte 1 </h1><br><h2>  21. Blocos digitais universais </h2><br>  Neste cap√≠tulo, veremos como os UDBs (Universal Digital Blocks) permitem o desenvolvimento de fun√ß√µes perif√©ricas digitais program√°veis.  A arquitetura UDB encontra um equil√≠brio entre granularidade de configura√ß√£o e implementa√ß√£o eficiente.  Os UDBs consistem em uma combina√ß√£o de l√≥gica n√£o comutada semelhante a uma matriz l√≥gica program√°vel (PLM, ingl√™s PLD), l√≥gica estruturada (aut√¥matos operacionais, a seguir denominados Datapath) e um esquema de rastreamento flex√≠vel. <br><br><h3>  21.1 Recursos </h3><br><ul><li>  Para uma flexibilidade ideal, cada UDB cont√©m os seguintes componentes: <br>  ‚Ä¢ Caminho de dados de 8 bits baseado na ALU (Unidade Aritm√©tica e L√≥gica, ALU) com reposit√≥rio de instru√ß√µes de 8 instru√ß√µes, v√°rios registradores e buffers FIFO; <br>  ‚Ä¢ dois PLDs, cada um com 12 entradas, oito termos conjuntivos (Termos do Produto, PT) e quatro sa√≠das de macroc√©lulas; <br>  ‚Ä¢ registros de gerenciamento e status; <br>  ‚Ä¢ m√≥dulos de rel√≥gio e redefini√ß√£o. </li><li>  O PSoC 5LP cont√©m uma matriz de at√© 24 UDB de tamanho. </li><li>  Rastreamento flex√≠vel entre elementos da matriz UDB. </li><li>  Os elementos UDB podem ser divididos ou encadeados para criar fun√ß√µes maiores. </li><li>  Implementa√ß√£o flex√≠vel de v√°rias fun√ß√µes digitais, incluindo temporizadores, contadores, moduladores de largura de pulso (incluindo PWM com um gerador de banda morta), UART, barramento I2C, barramento SPI e verifica√ß√£o / gera√ß√£o de CRC. </li></ul><br><h3>  21.2 Diagrama de blocos </h3><br>  A Figura 21-1 mostra o UDB como uma constru√ß√£o que cont√©m dois blocos l√≥gicos b√°sicos, PLD, Datapath e as fun√ß√µes de controle, status, rel√≥gio e redefini√ß√£o. <br><br><img src="https://habrastorage.org/webt/fo/zu/co/fozucosb4fhjohp6uuhbi1-onzq.png"><br>  <i>Figura 21-1.</i>  <i>Diagrama de blocos do UDB.</i> <br><br><h3>  21.3 Como funciona </h3><br>  Os principais componentes do UDB s√£o: <br><br><ul><li>  PLD (2).  Dados de recursos de rastreio s√£o alimentados para as entradas desses blocos.  Eles implementam l√≥gica combinacional e captura de dados, o que permite implementar m√°quinas de estados finitos, controlar as opera√ß√µes do bloco Datapath, configurar condi√ß√µes de entrada e controlar sa√≠das. </li><li>  Datapath.  Este bloco cont√©m ALU program√°vel dinamicamente, quatro registros, dois buffers FIFO, comparadores e gera√ß√£o de condi√ß√£o. </li><li>  Gerenciamento e status (Status e Controle).  Esses m√≥dulos fornecem um mecanismo para a intera√ß√£o dos microprogramas do processador central (CPU) e a sincroniza√ß√£o com as opera√ß√µes UDB.  Os registros de controle atuam nos elementos internos, e os registros de status l√™em o estado dos elementos externos. </li><li>  Controle de rel√≥gio e redefini√ß√£o  Esses m√≥dulos fornecem sele√ß√£o de tempo e habilitam, al√©m de redefinir a sele√ß√£o no UDB. </li><li>  Sinais de encadeamento.  O PLD e o Datapath possuem sinais que permitem encadear blocos adjacentes em uma cadeia para criar fun√ß√µes de bits mais altos. </li><li>  Canal de rastreamento  Os UDBs s√£o conectados ao canal de rastreamento por meio de matrizes de comuta√ß√£o program√°veis ‚Äã‚Äãpara comunica√ß√£o entre blocos dentro do mesmo UDB e para comunica√ß√£o com outros UDBs na matriz. </li><li>  Interface de barramento do sistema (Sysytem Bus Interface).  Todos os registros e RAM em cada UDB s√£o projetados no espa√ßo de endere√ßo do sistema e o acesso a eles pode ser obtido usando o processador central ou atrav√©s do acesso direto √† mem√≥ria (English Direct Memory Access, DMA) na forma de 8 bits e 16 bits dados. </li></ul><br><h4>  21.3.1  Pld </h4><br>  Cada UDB possui dois PLDs 12C4.  Os blocos PLD mostrados na Figura 21-1 podem ser usados ‚Äã‚Äãpara implementar m√°quinas de estado, processar dados de E / S e criar l√≥gica de tabela (Eng. Lookup Table, LUT).  Al√©m disso, o PLD pode ser configurado para executar fun√ß√µes aritm√©ticas, definir a sequ√™ncia do Datapath e gerar status.  A l√≥gica geral pode ser sintetizada e projetada em blocos PLD.  Esta se√ß√£o fornece uma vis√£o geral da arquitetura do PLD. <br><br>  O PLD possui 12 entradas que transmitem informa√ß√µes em 8 termos conjuntivos em um array AND.  Em cada termo conjuntivo, voc√™ pode escolher uma entrada direta (verdadeira, T) ou inversa (complemento, C).  A sa√≠da de termos conjuntivos vai para a entrada da matriz OR.  A letra 'C' em 12C4 indica que os termos OR s√£o constantes para todas as entradas e cada entrada OR pode obter acesso program√°tico a qualquer termo conjuntivo.  Essa estrutura fornece flexibilidade m√°xima e garante que todas as entradas e sa√≠das possam ser movidas. <br><br><img src="https://habrastorage.org/webt/j8/f9/c7/j8f9c7wdwgm9s5gedhb7swc8i08.png"><br>  <i>Figura 21-2.</i>  <i>A estrutura do PLD 12C4.</i> <br><br><h4>  21.3.1.1 Macro PLD </h4><br>  A arquitetura das macroc√©lulas √© mostrada na Figura 21-3.  A sa√≠da controla a matriz de rastreio e pode ser travada ou Raman.  Para travamento, √© usado um gatilho D com entrada direta ou inversa ou um gatilho T com um n√≠vel de entrada alto ou baixo.  O gatilho de sa√≠da pode ser configurado ou redefinido durante a inicializa√ß√£o ou de forma ass√≠ncrona durante a opera√ß√£o normal, por um sinal externo do canal de rastreamento. <br><br><img src="https://habrastorage.org/webt/fo/rg/1w/forg1w4bmsa7n4mjt27c5mucwss.png"><br>  <i>Figura 21-3.</i>  <i>Arquitetura de macroc√©lula.</i> <br><br>  <b>Registro de c√©lula de macro PLD somente leitura</b> <br>  Al√©m de controlar a matriz de rastreamento, as sa√≠das de macroc√©lulas dos dois PLDs s√£o projetadas no espa√ßo de endere√ßo na forma de um registro somente leitura de 8 bits, que pode ser acessado usando a CPU ou o DMA. <br><br><img src="https://habrastorage.org/webt/a5/oc/zc/a5oczcwt1zvvzivxmrgbcc_opju.png"><br>  <i>Figura 21-4.</i>  <i>O registro de macroc√©lula PLD somente leitura.</i> <br><br><h4>  21.3.1.2 cadeia de hifeniza√ß√£o PLD </h4><br>  Os PLDs s√£o vinculados no endere√ßamento UDB.  Como mostra a Figura 21-5, a entrada da cadeia de transporte de selina √© encaminhada do UDB anterior para o circuito, atrav√©s de cada macro c√©lula em ambos os PLDs, depois √© encaminhada para o pr√≥ximo UDB como sa√≠da da cadeia de transporte de selagem.  Para apoiar o posicionamento eficiente de fun√ß√µes aritm√©ticas, s√£o gerados termos conjuntivos especiais (PT), usados ‚Äã‚Äãem macroc√©lulas juntamente com uma cadeia de hifeniza√ß√£o. <br><br><img src="https://habrastorage.org/webt/ms/fi/ai/msfiaihduu5-28whmd5iethri9y.png"><br>  <i>Figura 21-5.</i>  <i>Cadeia de hifeniza√ß√£o do PLD e entradas especiais de termos conjuntivos.</i> <br><br><h4>  21.3.1.3 Configura√ß√£o do PLD </h4><br>  Cada PLD aparece antes da CPU ou DMA na forma de RAM com acesso de 16 bits.  A matriz AND possui 12 √ó 8 √ó 2 bits ou 24 bytes para programa√ß√£o, e a matriz OR possui 4 √ó 8 bits ou 4 bytes para programa√ß√£o.  Al√©m disso, cada c√©lula de macro possui um byte de configura√ß√£o, totalizando 32 bytes de configura√ß√£o por PLD.  Como cada UDB possui 2 PLDs, a configura√ß√£o total de cada UDB √© de 64 bytes. <br><br>  Da pr√≥xima vez, consideraremos os Aut√¥matos Operacionais (Datapaths). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt432764/">https://habr.com/ru/post/pt432764/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt432752/index.html">Formigueiro ou fortaleza? Estou construindo uma casa pelo pre√ßo de um apartamento. 3 parte. Fonte de alimenta√ß√£o</a></li>
<li><a href="../pt432754/index.html">Armazenamento de dados em mem√≥ria e em disco trar√° ao p√∫blico</a></li>
<li><a href="../pt432756/index.html">Implementamos suporte √† acessibilidade sem alterar o componente visual do aplicativo m√≥vel</a></li>
<li><a href="../pt432760/index.html">Exibi√ß√µes de produtos vetoriais ou outro uso do modelo Word2Vec</a></li>
<li><a href="../pt432762/index.html">O detector de mentiras AI pode detectar quando uma pessoa est√° mentindo</a></li>
<li><a href="../pt432766/index.html">Como codificar uma mensagem secreta em uma impress√£o digital</a></li>
<li><a href="../pt432768/index.html">Fones de ouvido sem fio para "maratonas em s√©rie": a Dolby os oferecer√° por US $ 599</a></li>
<li><a href="../pt432770/index.html">Botnets e seus tipos: o que √© conhecido em 2018</a></li>
<li><a href="../pt432772/index.html">Como criamos um servi√ßo de campanha publicit√°ria em conformidade com o GDPR</a></li>
<li><a href="../pt432774/index.html">Frontend DevDay. Grava√ß√£o de relat√≥rio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>