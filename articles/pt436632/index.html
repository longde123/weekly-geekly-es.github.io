<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüè´ üë©‚Äç‚úàÔ∏è üö∂ Como constru√≠mos um sistema para processar, armazenar e analisar dados no SIBUR ü§∏üèΩ üë®üèª‚Äçüéì üë∏üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No in√≠cio de 2018, iniciamos ativamente o processo de digitaliza√ß√£o da produ√ß√£o e processos na empresa. No setor petroqu√≠mico, essa n√£o √© apenas uma t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como constru√≠mos um sistema para processar, armazenar e analisar dados no SIBUR</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sibur_official/blog/436632/"> No in√≠cio de 2018, iniciamos ativamente o processo de digitaliza√ß√£o da produ√ß√£o e processos na empresa.  No setor petroqu√≠mico, essa n√£o √© apenas uma tend√™ncia da moda, mas um novo passo evolutivo no sentido de aumentar a efici√™ncia e a competitividade.  Considerando as especificidades do neg√≥cio, que, sem nenhuma digitaliza√ß√£o, mostra bons resultados econ√¥micos, os digitalizadores enfrentam uma tarefa dif√≠cil: alterar processos estabelecidos na empresa √© uma tarefa bastante meticulosa. <br><br>  Nossa digitaliza√ß√£o come√ßou com a cria√ß√£o de dois centros e seus blocos funcionais correspondentes. <br><br>  Essa √© a ‚ÄúFun√ß√£o da tecnologia digital‚Äù, que inclui todas as √°reas de produtos: digitaliza√ß√£o de processos, IIoT e an√°lises avan√ßadas, al√©m de um centro de gerenciamento de dados que se tornou uma √°rea independente. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/4g/jl/qx/4gjlqx_herptacpn_zj0wl1tyai.png" width="900"></a> <br><br>  E apenas a principal tarefa do escrit√≥rio de dados √© implementar totalmente a cultura de tomada de decis√£o com base em dados (sim, sim, decis√£o orientada a dados), bem como, em princ√≠pio, otimizar tudo relacionado ao trabalho com dados: an√°lise, processamento , armazenamento e relat√≥rios.  A peculiaridade √© que todas as nossas ferramentas digitais ter√£o que n√£o apenas usar ativamente seus pr√≥prios dados, ou seja, aqueles que eles geram (por exemplo, desvios m√≥veis ou sensores IIoT), mas tamb√©m dados externos, com uma compreens√£o clara de onde e por que s√£o necess√°rios. usar. <br><br>  Meu nome √© Artyom Danilov, sou o chefe do departamento de Infraestrutura e Tecnologia da SIBUR. Neste post, mostrarei como e sobre o que constru√≠mos um grande sistema de processamento e armazenamento de dados para toda a SIBUR.  Para come√ßar, falaremos apenas sobre a arquitetura de n√≠vel superior e como voc√™ pode se tornar parte de nossa equipe. <br><a name="habracut"></a><br>  Aqui est√£o as √°reas que incluem trabalho em um escrit√≥rio de dados: <br><br>  <b>1. Trabalhar com dados</b> <br><br>  Os profissionais envolvidos ativamente no invent√°rio e na cataloga√ß√£o de nossos dados trabalham aqui.  Eles entendem o que precisa de uma fun√ß√£o espec√≠fica, podem determinar que tipo de an√°lise pode ser necess√°ria, quais m√©tricas devem ser monitoradas para a tomada de decis√µes e como os dados s√£o usados ‚Äã‚Äãem uma √°rea de neg√≥cios espec√≠fica. <br><br>  <b>2. Visualiza√ß√£o de BI e dados</b> <br><br>  A dire√ß√£o est√° intimamente relacionada √† primeira e permite visualizar os resultados do trabalho dos rapazes da primeira equipe. <br><br>  <b>3. Dire√ß√£o do controle de qualidade dos dados</b> <br><br>  Aqui, as ferramentas de controle de qualidade dos dados s√£o introduzidas e toda a metodologia desse controle √© implementada.  Em outras palavras, os funcion√°rios daqui implementam software, escrevem v√°rias verifica√ß√µes e testes, entendem como ocorrem as verifica√ß√µes cruzadas entre sistemas diferentes, observam as fun√ß√µes dos funcion√°rios respons√°veis ‚Äã‚Äãpela qualidade dos dados e tamb√©m estabelecem uma metodologia comum. <br><br>  <b>4. Gest√£o do NSI</b> <br><br>  Somos uma grande empresa.  Temos muitos tipos diferentes de diret√≥rios - e prestadores de servi√ßos, materiais e um diret√≥rio de empresas ... Em geral, acredite, existem diret√≥rios mais do que suficientes. <br><br>  Quando uma empresa compra ativamente algo para suas atividades, geralmente possui processos especiais para preencher esses diret√≥rios.  Caso contr√°rio, o caos atingir√° um n√≠vel tal que ser√° imposs√≠vel trabalhar a partir da palavra "completamente".  Tamb√©m temos esse sistema (MDM). <br><br>  Aqui est√£o os problemas.  Suponha que, em uma das divis√µes regionais, da qual temos muito, os funcion√°rios se sentem e insiram dados no sistema.  Contribua manualmente, com todas as consequ√™ncias decorrentes deste m√©todo.  Ou seja, eles precisam inserir dados, verificar se tudo chegou ao sistema na forma correta, sem duplicatas.  Ao mesmo tempo, algumas coisas, no caso de preencher alguns detalhes e campos obrigat√≥rios, voc√™ deve pesquisar e pesquisar no Google de forma independente.  Por exemplo, voc√™ tem uma empresa TIN e precisa de outras informa√ß√µes - consulte servi√ßos especiais e o registro. <br><br>  Todos esses dados, √© claro, j√° est√£o em algum lugar, portanto, seria correto simplesmente retir√°-los automaticamente. <br><br>  Anteriormente, a empresa, em princ√≠pio, n√£o possu√≠a posi√ß√£o √∫nica, uma equipe clara que faria isso.  Havia muitas divis√µes dispersas que inseriam dados manualmente.  Mas geralmente √© dif√≠cil para essas estruturas formularem exatamente o que exatamente e onde exatamente no processo de trabalhar com dados deve ser alterado para que tudo fique perfeito.  Portanto, estamos revisando o formato e a estrutura de gerenciamento do NSI. <br><br>  <b>5. Implementa√ß√£o do data warehouse (n√≥ de dados)</b> <br><br>  Foi exatamente isso que come√ßamos a fazer nesta √°rea. <br><br>  Vamos definir imediatamente os termos, caso contr√°rio, as frases que eu uso podem se cruzar com alguns outros conceitos.  Grosso modo, n√≥ de dados = data lake + data warehouse  Um pouco mais adiante, revelarei isso com mais detalhes. <br><br><h2>  Arquitetura </h2><br>  Primeiro, tentamos descobrir com que tipo de dados trabalhar - quais sistemas existem, quais sensores.  Entendemos como seriam os dados de streaming (√© o que as pr√≥prias empresas geram a partir de todos os seus equipamentos, isto √© IIoT e assim por diante) e sistemas cl√°ssicos, diferentes CRM, ERP e similares. <br><br>  Percebemos que os dados nos sistemas atuais n√£o ser√£o diretamente suficientes para serem muito grandes em volume, mas com a introdu√ß√£o de ferramentas digitais e IIoT, haver√° muitos deles.  E tamb√©m haver√° dados muito heterog√™neos dos sistemas cont√°beis cl√°ssicos.  Portanto, eles criaram a arquitetura desse plano. <br><br><img src="https://habrastorage.org/webt/gl/du/oi/glduoijtyvx22eji6khqkqfv36w.png" width="900"><br><br>  Mais detalhes sobre os blocos. <br><br><h2>  Armazenamento </h2><br><img src="https://habrastorage.org/webt/ln/_0/-f/ln_0-f2nprbrqjd3kij_28w1omk.png" width="900"><br><br>  Este √© o n√∫cleo da nossa plataforma.  O que √© usado para processar e armazenar dados.  O desafio √© fazer o download de dados de mais de 60 sistemas diferentes quando eles come√ßarem a entreg√°-los.  Ou seja, geralmente existem todos os dados que podem ser √∫teis para a tomada de algumas decis√µes. <br><br>  Vamos come√ßar com a extra√ß√£o e o processamento de dados.  Para esses fins, planejamos usar a ferramenta NiFi ETL para streaming e pacote de dados, bem como ferramentas de processamento de streaming: Flume para recep√ß√£o e decodifica√ß√£o inicial de dados, Kafka para buffering, Flink e Spark Streaming como as principais ferramentas de processamento de fluxo de dados. <br><br>  Mais dif√≠cil de trabalhar com sistemas de pilha SAP.  √â necess√°rio recuperar dados do SAP usando uma ferramenta ETL separada - SAP Data Services. <br><br>  Como ferramentas de armazenamento, planejamos usar a plataforma Cloudera Hadoop (HDFS, HBASE, Hive, Impala propriamente dita), o DBMS anal√≠tico da Vertica e, para casos individuais, a pesquisa el√°stica. <br><br>  Basicamente, usamos a pilha mais avan√ßada.  Sim, voc√™ pode tentar jogar tomates em n√≥s e provocar o que chamamos de pilha mais moderna, mas na verdade - √©. <br><br>  N√£o estamos limitados ao desenvolvimento legado, mas n√£o podemos usar a vantagem em uma solu√ß√£o industrial devido √† orienta√ß√£o expl√≠cita da empresa em nossa plataforma.  Portanto, talvez n√£o arrastemos Horton, mas nos limitemos a Clouder, sempre que poss√≠vel, estamos definitivamente tentando arrastar uma ferramenta mais nova. <br><br><img src="https://habrastorage.org/webt/lf/wm/zp/lfwmzpvisjt9aqjdluibpq5erbo.png" width="900"><br><br>  O SAS Data Quality √© usado para controlar a qualidade dos dados e o Airflow √© usado para gerenciar toda essa bondade.  Monitoramos toda a plataforma atrav√©s da pilha ELK.  Planejamos fazer a maior parte da visualiza√ß√£o no Tableau, alguns relat√≥rios completamente est√°ticos no SAP BO. <br><br>  J√° entendemos que parte das tarefas n√£o pode ser realizada por meio de solu√ß√µes de BI padr√£o, pois √© necess√°ria uma visualiza√ß√£o em tempo real muito sofisticada com muitos controles de papel√£o.  Portanto, escreveremos nossa pr√≥pria estrutura de visualiza√ß√£o, que pode ser incorporada em produtos digitais em desenvolvimento. <br><br><h2>  Sobre a plataforma digital </h2><br>  Se voc√™ olhar um pouco mais amplamente, agora nossos colegas da fun√ß√£o de tecnologia digital est√£o construindo uma √∫nica plataforma digital, cuja tarefa √© desenvolver rapidamente nossos pr√≥prios aplicativos. <br><br>  O data lake √© um dos elementos desta plataforma. <br>  Como parte dessa atividade, entendemos que precisaremos implementar uma interface conveniente para acessar dados anal√≠ticos.  Portanto, planejamos implementar a API de dados e o modelo de objeto de produ√ß√£o para um acesso mais conveniente aos dados de produ√ß√£o. <br><br><h2>  O que mais fazemos e de quem precisamos </h2><br>  Al√©m de armazenar e processar dados, todo o aprendizado de m√°quina, bem como a estrutura IIoT, funcionar√° em nossa plataforma.  O lago atuar√° tanto como fonte de dados para modelos de treinamento e trabalho, quanto como capacidade para modelos de trabalho.  Uma estrutura de ML que funcionar√° no topo da plataforma j√° est√° pronta. <br><br><img src="https://habrastorage.org/webt/r2/tc/fm/r2tcfmmxq-nndk0dqy7zazdfwfs.jpeg" width="900"><br><br>  No momento, tenho uma equipe, dois arquitetos e seis desenvolvedores, por isso estamos procurando ativamente novas pessoas (preciso de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">arquitetos</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">engenheiros de dados</a> ) que nos ajudar√£o no desenvolvimento da plataforma.  Voc√™ n√£o precisa bisbilhotar no legado (o legado est√° aqui apenas na entrada dos sistemas), a pilha √© nova. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/QkZgrAs8PJg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  √â a√≠ que as sutilezas estar√£o - √© nas integra√ß√µes.  Conectar o antigo ao novo, para que ele funcione bem e resolva problemas, √© um desafio.  Al√©m disso, ser√° necess√°rio inventar, elaborar e pendurar v√°rias m√©tricas diferentes. <br><br>  A coleta de dados √© realizada em todos os principais sistemas - 1C, SAP e um monte de tudo o mais.  Com base nos dados coletados aqui, todas as an√°lises, todas as previs√µes, todos os relat√≥rios digitais ser√£o criados. <br><br>  Em resumo, queremos que os dados funcionem muito bem.  Por exemplo, marketing e vendas - eles t√™m pessoas que coletam todas as estat√≠sticas manualmente.  Ou seja, eles ficam sentados e, de 5 sistemas diferentes, extraem dados diferentes em formatos diferentes, baixam-nos de 5 programas diferentes e descarregam tudo isso no Excel.  Em seguida, eles resumem as informa√ß√µes em tabelas unificadas do Excel, de alguma forma tentam fazer a visualiza√ß√£o. <br><br>  Em geral, o vag√£o leva todo esse tempo.  Queremos resolver esses problemas com nossa plataforma.  E nos posts a seguir, falaremos detalhadamente sobre como conectamos os elementos e configuramos a opera√ß√£o correta do sistema. <br><br>  A prop√≥sito, al√©m dos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">arquitetos</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">engenheiros de dados</a> desta equipe, teremos o maior prazer em ver: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Desenvolvedores de BI</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Especialistas em qualidade de dados</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Desenvolvedores de back-end</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Especialistas em NSI</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parceiro de dados</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt436632/">https://habr.com/ru/post/pt436632/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt436622/index.html">Botovodstvo</a></li>
<li><a href="../pt436624/index.html">Estudo: a maioria dos usu√°rios n√£o entende como o Facebook lida com seus dados.</a></li>
<li><a href="../pt436626/index.html">Python se torna a linguagem de programa√ß√£o mais popular do mundo.</a></li>
<li><a href="../pt436628/index.html">Melhorando o agente Q-Learning baseado em a√ß√µes, adicionando recorr√™ncias e recompensas</a></li>
<li><a href="../pt436630/index.html">Microsservi√ßos. Unifica√ß√£o e por que √© t√£o importante. Parte 1 - Configura√ß√£o</a></li>
<li><a href="../pt436634/index.html">Apenas sobre configura√ß√µes internas e externas para o aplicativo no Unity3D</a></li>
<li><a href="../pt436636/index.html">Como crio um servi√ßo de recomenda√ß√£o da comunidade VKontakte</a></li>
<li><a href="../pt436638/index.html">Redistribuindo janelas entre monitores ap√≥s acordar do modo de suspens√£o</a></li>
<li><a href="../pt436640/index.html">Minha experi√™ncia em publicidade e desenvolvimento de aplicativos Android e iOS</a></li>
<li><a href="../pt436642/index.html">Ticket to Ride.Europa - etapas modestas na aritm√©tica do jogo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>