<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöª üëê üç¶ Videochamadas ocultas: de milh√µes por dia a 100 participantes em uma confer√™ncia üòü ‚≠ïÔ∏è üßìüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Agora, parece imposs√≠vel encontrar um messenger sem o recurso de chamada. Isso √© conveniente para os usu√°rios, porque todas as comunica√ß√µes podem ser ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Videochamadas ocultas: de milh√µes por dia a 100 participantes em uma confer√™ncia</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/odnoklassniki/blog/479852/">  Agora, parece imposs√≠vel encontrar um messenger sem o recurso de chamada.  Isso √© conveniente para os usu√°rios, porque todas as comunica√ß√µes podem ser conduzidas em um aplicativo.  Se combinarmos todas as estat√≠sticas dispon√≠veis na m√≠dia, as pessoas conversam pela Internet mais de um bilh√£o de minutos por dia.  E com o desenvolvimento da tecnologia, a participa√ß√£o da comunica√ß√£o por v√≠deo est√° aumentando, porque o v√≠deo transmite melhor as emo√ß√µes do interlocutor e permite criar o efeito da presen√ßa. <br><br>  Um novo desafio para o servi√ßo de videochamada √© reunir ao mesmo tempo uma fam√≠lia inteira ou um grupo de amigos localizados em diferentes partes do mundo, ou colegas trabalhando remotamente no mesmo projeto, para planejar. <br><img src="https://habrastorage.org/webt/mh/zl/8a/mhzl8ar7wkjk2akfni3vzzbiufi.jpeg"><br>  O chefe de desenvolvimento das plataformas de v√≠deo e fita, Alexander Tobol ( <a href="https://habr.com/ru/users/alatobol/" class="user_link">alatobol</a> ), mostrar√° que, sob o cap√¥, existe um servi√ßo de chamada de v√≠deo, quais tecnologias e hacks usar para criar seu servidor de confer√™ncia e como transferir o v√≠deo corretamente.  Venha e aprenda como transferir um servi√ßo de chamada individual para chamadas em grupo para 100 pessoas e por que voc√™ precisa de suporte para tantos participantes. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/2z4XO3fyn3U" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  O artigo √© baseado em um relat√≥rio sobre o <a href="https://www.highload.ru/">HighLoad ++ Siberia</a> , no qual Alexander Tobol tenta fornecer uma imagem completa.  Se voc√™ j√° conhece outros materiais sobre o t√≥pico (por exemplo, <a href="https://habr.com/ru/company/oleg-bunin/blog/428217/">sobre os recursos de transmiss√£o de v√≠deo</a> e <a href="https://habr.com/ru/company/oleg-bunin/blog/461829/">protocolos de rede</a> ), pode pular a parte te√≥rica e ir direto para a <a href="https://habr.com/ru/company/odnoklassniki/blog/479852/">solu√ß√£o</a> . <br><br>  <strong>O esbo√ßo do artigo:</strong> <br><br><ul><li>  Hist√≥rico e chamadas de dispositivo. </li><li>  <a href="https://habr.com/ru/company/odnoklassniki/blog/479852/">Transi√ß√£o de chamadas individuais para chamadas em grupo.</a> </li><li>  <a href="https://habr.com/ru/company/odnoklassniki/blog/479852/">Servi√ßo de chamada de grupo DIY.</a> </li><li>  <a href="https://habr.com/ru/company/odnoklassniki/blog/479852/">Servidor de confer√™ncia: explore os concorrentes e fa√ßa melhor.</a> </li></ul><br><h2>  Hist√≥rico de chamadas </h2><br>  O primeiro aplicativo conhecido para chamadas, e com o v√≠deo, foi o Skype, apareceu em 2006.  Em Odnoklassniki, lan√ßamos chamadas com base em uma solu√ß√£o da Adobe em 2010-2012 ... H√° alguns anos, n√≥s a refizemos completamente no WebRTC (mais sobre esse lan√ßamento <a href="https://habr.com/ru/company/oleg-bunin/blog/428217/">aqui</a> ), no ano passado, adicionamos chamadas de grupo.  Essa transi√ß√£o ser√° discutida no artigo. <br><img src="https://habrastorage.org/webt/5v/-d/9o/5v-d9oc0kvmij7u43f4q8dihyoa.jpeg"><br>  Por que acho que posso lhe dizer como fazer isso?  Porque nosso p√∫blico-alvo mensal usando chamadas excede 10 milh√µes de pessoas e <strong>temos mais de 2 milh√µes de chamadas por dia</strong> .  Al√©m disso, mais da metade acontece em plataformas m√≥veis. <br><br>  As chamadas em grupo s√£o o servi√ßo que mais cresce, e nosso objetivo √© 100 participantes simult√¢neos da confer√™ncia.  Por que tanto?  Em primeiro lugar, √†s vezes voc√™ deseja compartilhar uma bela foto com seus amigos e colegas de classe ou realizar um semin√°rio.  Em segundo lugar, mesmo se voc√™ acha que seu servi√ßo n√£o precisa de algo, tudo pode mudar. <br><br>  Agora, pode parecer que videoconfer√™ncias para 100 participantes n√£o s√£o necess√°rias e, cinco anos atr√°s, eles me perguntaram por que estamos lan√ßando v√≠deo em 4K.  Agora, uma TV 4K √© comum e est√°vamos prontos em 2014. <br><blockquote>  O ponto n√£o est√° adiantado.  Se voc√™ deseja prestar um bom servi√ßo, aumente sua barra de requisitos. </blockquote>  Se voc√™ puder fazer chamadas de bom funcionamento para 50 a 100 pessoas, para 6 a 10 usu√°rios tudo funcionar√° bem. <br><br>  Cada servi√ßo de chamada possui 4 componentes relativamente independentes: <br><br><ul><li>  <strong>Sinaliza√ß√£o</strong>  A tarefa √© ligar para o assinante, trocar dados iniciais, informar o que cada assinante pode fazer e estabelecer um canal atrav√©s do qual os dados de v√≠deo possam ser transmitidos. </li><li>  <strong>V√≠deo / √°udio.</strong>  Os dados de v√≠deo e √°udio s√£o compactados usando codecs. </li><li>  <strong>Rede.</strong>  √â necess√°rio garantir o trabalho em redes ruins, implementar recupera√ß√£o de pacotes, conex√µes P2P, etc. </li><li>  <strong>Topologia</strong> - adicionada em caso de chamadas em grupo. </li></ul><br>  Voc√™ pode falar sobre qualquer uma dessas partes separadamente.  Mas eu quero dar uma vis√£o geral de como as chamadas funcionam, ent√£o tentarei encaixar tudo em uma hist√≥ria. <br><br>  Antes de come√ßar a trabalhar no servi√ßo, voc√™ precisa identificar os <strong>requisitos</strong> : <br><br><ul><li>  <strong>Estabele√ßa rapidamente uma conex√£o</strong> para que a conex√£o seja estabelecida imediatamente ap√≥s o interlocutor atender o telefone. </li><li>  <strong>Alta qualidade de chamada</strong> para que o v√≠deo n√£o se desfa√ßa e n√£o congele. </li><li>  <strong>O n√∫mero de participantes na chamada</strong> , para que voc√™ possa ligar em bate-papos, nos quais at√© 100 participantes. </li><li>  <strong>Baixa lat√™ncia entre os chamadores.</strong>  Lat√™ncia de 1,3 s, uma vez que a Polycom n√£o nos conv√©m. </li></ul><br>  Aqui est√£o os significados espec√≠ficos nos quais esses requisitos para chamadas de grupo s√£o expressos: in√≠cio de uma chamada n√£o mais que 1 segundo;  uma rede na qual o v√≠deo de 300 Kbps funciona de forma est√°vel;  lat√™ncia do chamador para o ouvinte n√£o mais que 0,5 segundos;  100 usu√°rios em uma chamada. <br><br><h2>  O que est√° no caminho? </h2><br>  Como voc√™ sabe, os dados nas redes s√£o transmitidos em pacotes: h√° um soquete, voc√™ envia um fluxo de dados para l√°, tudo voa para longe, como se em uma caixa preta, ele fosse montado e funcionasse. <br><img src="https://habrastorage.org/webt/e4/pa/vy/e4pavyyaikufar_cl4sqw1karxe.jpeg"><br>  Mas as redes s√£o diferentes.  Metade das chamadas s√£o feitas atrav√©s de redes m√≥veis e nem sempre parecem uma via expressa. <br><img src="https://habrastorage.org/webt/ck/62/va/ck62vamogxhsgqdjuvvmoa1jlrq.jpeg"><br>  As redes podem ser sobrecarregadas, os dados ser√£o perdidos e precisar√£o ser restaurados, carregando ainda mais a rede.  Existem redes com as quais tudo parece estar em ordem, mas os pacotes ainda desaparecem - por exemplo, devido ao fato de o roteador Wi-Fi estar localizado atr√°s de um muro de concreto armado. <br><br><h2>  Funcionalidades de rede </h2><br>  Analisaremos as principais caracter√≠sticas que descrevem a qualidade da rede. <br><br><h3>  RTT </h3><br>  Tempo de ida e volta - o tempo entre o servidor enviar os dados para o cliente e receber a confirma√ß√£o de volta. <br><br>  Lembre-se, queremos estabelecer uma conex√£o em 1 segundo.  Se o tempo de ida e volta for de 200 ms, com a conex√£o sendo estabelecida, por exemplo, atrav√©s de TCP, al√©m de alguns TLS, <strong>voc√™ poder√° perder 500 ms apenas na conex√£o</strong> .  Restam apenas 500 ms, ou seja,  mais algumas solicita√ß√µes, ap√≥s as quais a conex√£o deve ser estabelecida.  Portanto, com solicita√ß√µes extras com RTT, voc√™ precisa trabalhar com muito cuidado. <br><br>  Um exemplo: <br><br><pre><code class="xml hljs">$ ping google.com 64 bytes from 173.194.73.139: icmp_seq=5 ttl=44 time=211.847 ms round-trip min/avg/max/stddev = 209.471/220.238/266.304/19.062 ms RTT = 220ms $ curl -o /dev/null -w "HTTP time taken: %{time_connect}\nHTTPS time taken: %{time_appconnect}\n" -s https://www.google.com HTTP time taken: 0.231 HTTPS time taken: 0.797 HTTP = 230ms HTTPS = 800ms</code> </pre> <br>  Com RTT = 220ms, receber uma resposta via https leva at√© 800 ms.  Portanto, se voc√™ tiver uma conex√£o segura de soquete da Web, com esse ping, o segundo inteiro desaparecer√°. <br><img src="https://habrastorage.org/webt/h7/jz/fz/h7jzfzctyl9uto140qct-vu05um.jpeg"><br>  A tabela mostra os atrasos no handshake medidos em redes m√≥veis ( <a href="https://youtu.be/0xKAR0AHIdY">neste</a> relat√≥rio, mais detalhes sobre a opera√ß√£o de aplicativos em redes m√≥veis). <br><br><h3>  Rendimento </h3><br>  Voc√™ pode enviar pacotes para a rede como quiser: em lotes ou martelar imediatamente tudo no buffer, eles ainda chegar√£o ao cliente uniformemente.  O n√∫mero de pacotes ou dados por segundo √© a largura de banda ou largura de banda. <br><br>  O problema √© que a <strong>largura de banda nas redes m√≥veis est√° mudando constantemente</strong> .  Se houver uma queda acentuada e os dados forem transmitidos com a mesma taxa de bits, eles obviamente sofrer√£o perdas e a chamada do usu√°rio ser√° interrompida.  Isso tamb√©m ter√° que lutar. <br><br><h3>  Perda de pacotes </h3><br>  Ao transferir dados, o pacote pode ser perdido.  Nesse caso, h√° uma op√ß√£o: pular parte dos pacotes e obter distor√ß√µes ou tentar retransmitir pacotes e obter um quadro de congelamento. <br><br><h3>  Jitter </h3><br>  O fato √© que os pacotes n√£o chegam uniformemente, um de cada vez, mas em pacotes agrupados em algum intervalo. <br><br><img src="https://habrastorage.org/webt/zs/hc/fu/zshcfujfcg6helcc8rnx8pyfor4.jpeg"><br>  O jitter √© f√°cil de medir: <br><br><pre> <code class="xml hljs">PING highload.ru (178.248.233.16): 56 data bytes icmp_seq=11 ttl=43 time=117.177 ms icmp_seq=12 ttl=43 time=132.868 ms icmp_seq=13 ttl=43 time=176.413 ms icmp_seq=14 ttl=43 time=225.981 ms</code> </pre> <br>  Pinganuli highload.ru v√°rias vezes (o ping √© um valor inst√°vel, √© necess√°rio fazer a m√©dia), obtivemos o jitter m√©dio: <code>((132-117)+(176-132)+(225-176)) / 3 = (14 + 44 + 79) / 3 = 46 </code> . <br><img src="https://habrastorage.org/webt/zj/4n/wp/zj4nwpcfmrefzo989lg_ipmbffy.jpeg"><br>  Suponha que transmitamos um v√≠deo e um quadro seja um pacote de rede.  V√°rios quadros s√£o reproduzidos sem interrup√ß√£o, mas o terceiro p√°ssaro est√° atrasado devido ao tremor - obtemos um quadro congelado.  Portanto, voc√™ precisa acumular pacotes em algum lugar e equalizar esse efeito. <br><br>  Ou seja, para caracterizar redes sem fio, basta conhecer os seguintes valores: RTT (tempo de ida e volta);  largura de banda BW (largura de banda);  porcentagem de perda de pacotes;  instabilidade. <br><br><h2>  Como √© o usu√°rio? </h2><br>  Antes de come√ßar a otimizar o trabalho com a rede, voc√™ precisa descobrir que tipo de Internet os usu√°rios t√™m - talvez todo mundo tenha uma rede perfeita, qualquer solu√ß√£o funcionar√°. <br><br>  Em 80% dos casos, o usu√°rio final usa uma conex√£o sem fio: √© uma rede m√≥vel ou Wi-Fi. <br><br><img src="https://habrastorage.org/webt/ub/_w/ep/ub_wepc3hzha5g1vmnbcuvu5758.jpeg"><br><br>  Na R√∫ssia, fora da regi√£o oeste e das grandes cidades, as caracter√≠sticas m√©dias da rede s√£o: RTT - 200 ms, largura de banda - 1,1 Mbps, perda de pacotes - 0,6%, jitter - 5ms. <br><br>  Dividimos esses valores por tipos de redes e percebemos que √© necess√°rio aprender a trabalhar nisso. <br><br><img src="https://habrastorage.org/webt/vb/mk/6u/vbmk6ue1tjohnzk9dmybx7jgiq4.jpeg"><br><br><h2>  Recursos de desenvolvimento de chamadas </h2><br>  Muitas pessoas esquecem, mas LTE e 3G s√£o canais de comunica√ß√£o assim√©tricos: o downlink √© sempre mais do que o uplink.  Dependendo do tipo de protocolo, essa propor√ß√£o pode variar de 15/85 a 30/70.  Ao projetar chamadas, isso √© importante. <br><br>  Como verificar qual canal seus clientes t√™m? <br><br><img src="https://habrastorage.org/webt/9y/kz/pj/9ykzpjasmaqko3glxox9ps6tkgs.jpeg"><br><br>  Voc√™ pode ver o speedtest, qual √© a propor√ß√£o de velocidade no mundo entre a Internet m√≥vel e a fixa.  Verificou-se que em todo o mundo a Internet fixa tamb√©m √© assim√©trica.  Felizmente, na R√∫ssia, acabou sendo sim√©trico: a taxa de uplink / downlink em uma Internet fixa via Wi-Fi na R√∫ssia √© de 50/50.  Vamos nos concentrar em tais valores. <br><br><img src="https://habrastorage.org/webt/al/6o/zb/al6ozb-zf_b_f8vecacwryr-gce.jpeg"><br><br>  <strong>Conclus√£o: as</strong> redes sem fio s√£o populares e inst√°veis. <br><br><ul><li>  Mais de 80% dos clientes usam internet sem fio. </li><li>  As configura√ß√µes sem fio est√£o mudando dinamicamente. </li><li>  As redes sem fio t√™m altas taxas de perda de pacotes, instabilidade e reordena√ß√£o. </li><li>  Canal assim√©trico de liga√ß√£o ascendente / liga√ß√£o descendente numa propor√ß√£o de 30/70. </li></ul><br><h2>  Chamadas </h2><br>  Com esse armazenamento de conhecimento, voltemos √† implementa√ß√£o de chamadas de grupo.  Considere um algoritmo para uma chamada de grupo simples, que refinamos. <br><br>  <strong>Etapa 1.</strong> Alice quer ligar para Boris e enviar uma oferta, na qual ela relata tudo o que pode, que suporta protocolos, configura√ß√µes etc. <br><img src="https://habrastorage.org/webt/k-/gr/xz/k-grxzwigzw4xaqgctisb27xalq.jpeg"><br>  <strong>Etapa 2.</strong> Boris responde Alice, ap√≥s o qual uma conex√£o de transporte √© estabelecida. <br><img src="https://habrastorage.org/webt/qf/yp/my/qfypmyzwq5sjl8et0tg2ju6vddm.jpeg"><br>  <strong>Etapa 3.</strong> Depois disso, a troca de dados de √°udio / v√≠deo come√ßa. <br><img src="https://habrastorage.org/webt/rb/7w/hh/rb7whhnevjv6s15l0nmvftyx2lq.jpeg"><br>  A arquitetura de qualquer chamada √© semelhante ao diagrama abaixo. <br><img src="https://habrastorage.org/webt/_n/6g/7o/_n6g7ohpbtl7wonvxjfrdcb8w2a.jpeg"><br>  Sempre existe um servidor compartilhado, mas quando a conex√£o √© estabelecida, os usu√°rios j√° podem transferir dados P2P ou atrav√©s de servidores de terceiros. <br><br>  Os dados s√£o capturados por uma c√¢mera que os codifica no dispositivo e os envia para a conex√£o do soquete.  Eles passam pela rede, s√£o reproduzidos do outro lado pelo codec e exibidos na tela. <br><br>  Considere todas as etapas do algoritmo em detalhes e tente alternar de chamadas individuais para grupos. <br><br><h2>  Sinaliza√ß√£o </h2><br>  Tarefa: relatar uma chamada e estabelecer conex√µes de dados. <br><br>  Tudo √© bem simples: <br><br><ul><li>  Alice liga, uma notifica√ß√£o √© enviada para Boris em um dispositivo m√≥vel ou navegador. </li><li>  Um soquete da web ou qualquer outra conex√£o √© estabelecida. </li><li>  Depois disso, a negocia√ß√£o ocorre - Alice e Boris concordam. </li><li>  Quando o telefone √© capturado em um dispositivo, a chamada termina automaticamente no outro. </li></ul><br><img src="https://habrastorage.org/webt/x8/p8/4a/x8p84akywewgezvufnt64jqfmp8.jpeg"><br>  A plataforma de chamada em Odnoklassniki suporta v√°rios clientes e transportes.  Todos eles se aproximam de algum tipo de servidor, que atua no atendimento de chamadas e no encaminhamento de mensagens. <br><img src="https://habrastorage.org/webt/on/3v/9s/on3v9swzgtmfub9c_ru18qwjl1m.jpeg"><br>  No caso de uma falha no servidor ou instala√ß√£o de atualiza√ß√µes, h√° um armazenamento persistente no qual todas as mensagens s√£o registradas.  Em caso de perda do servidor, voc√™ pode facilmente mudar para outro.  √â isso que o ZooKeeper faz. <br><br>  A √∫nica dificuldade √© <strong>exatamente uma vez</strong> .  N√£o queremos aplicar algumas mensagens duas vezes.  Esse problema √© resolvido de forma simples: todas as mensagens t√™m um n√∫mero de s√©rie - duas vezes uma √∫nica mensagem n√£o chegar√°. <br><br>  Al√©m disso, voc√™ precisa ter cuidado ao criar uma chamada.  Uma pessoa pode criar uma chamada, desligar e criar outra chamada.  Ou pode n√£o travar, mas ainda criar outro.  Todas essas chamadas n√£o s√£o exclusivas - n√£o est√° claro se √© um rel√© ou se o usu√°rio clicou duas vezes no bot√£o de chamada.  √â facilmente reparado: um ID exclusivo √© gerado no cliente e a desduplica√ß√£o √© realizada nele.  Em princ√≠pio, <strong>n√£o h√° dificuldades em sinalizar</strong> . <br><br>  A sinaliza√ß√£o p2p para o grupo √© finalizada facilmente. <br><img src="https://habrastorage.org/webt/7q/y6/zh/7qy6zhw2z72nbjcazwlx681hrau.jpeg"><br>  As mesmas ofertas e respostas que Alice agora envia n√£o apenas para Boris, mas tamb√©m para Dima.  Eles os recebem, concordam, os canais de troca de dados aparecem entre eles. <br><br><h2>  √Åudio / V√≠deo </h2><br>  Para lidar com uma liga√ß√£o em grupo e entender quais tecnologias s√£o necess√°rias, teremos que falar um pouco sobre o que √© o v√≠deo. <br><br>  O v√≠deo tem 24 ou 60 quadros por segundo.  Para compact√°-los, codecs s√£o usados.  A principal ess√™ncia dos codecs √© que, a cada poucos quadros, h√° um quadro de refer√™ncia (como JPEG), e os quadros intermedi√°rios s√£o determinados atrav√©s de altera√ß√µes. <br><img src="https://habrastorage.org/webt/yl/2d/fs/yl2dfs-nsm6cmuifnpaykbyhnkg.jpeg"><br>  Na figura acima, o primeiro quadro com a m√°quina √© o de refer√™ncia e, no quadro seguinte, apenas as altera√ß√µes (movimento da m√°quina) s√£o codificadas, e da pr√≥xima vez tamb√©m apenas as altera√ß√µes. <br><br>  Isso √© chamado de grupo de imagens - um conjunto independente de quadros interconectados que podem ser decodificados.  Codec √© um algoritmo de transforma√ß√£o entre quadros.  Quanto mais √≠ngreme o codec, melhor ele comprime os dados e mais recursos s√£o necess√°rios. <br><div class="scrollable-table"><table><tbody><tr><td>  Qualidade </td><td>  Permiss√£o </td><td>  Taxa de bits m√≠nima </td></tr><tr><td>  FullHD </td><td>  1920x1080 </td><td>  4 Mbps </td></tr><tr><td>  HD </td><td>  1280x720 </td><td>  1,5 Mbps </td></tr><tr><td>  baixo </td><td>  640 x 360 </td><td>  600 kbps </td></tr><tr><td>  mais baixo </td><td>  426x240 </td><td>  300 kbps </td></tr></tbody></table></div>  Sobre a propor√ß√£o de taxas de bits do codec, existem regras gerais (consulte o <a href="https://youtu.be/e1JYFRwHzkQ">link</a> ). <br><br>  Os codecs mais populares usados ‚Äã‚Äãpara chamadas s√£o <strong>H.264 e VP8</strong> .  O H.264 √© bom porque em todos os lugares trabalha duro e n√£o consome bateria.  Mas geralmente em telefones um codificador (codificador) e 4 decodificadores.  Para todo o resto, voc√™ precisa do software VP8, que consome uma boa bateria.  Vale a pena alterar a prioridade para H.264 para chamadas em grupo (consulte o <a href="https://is.gd/5WaBAP">link</a> sobre como fazer isso). <br><br>  O codec pode codificar com uma vari√°vel (taxa de bits vari√°vel) ou uma taxa de bits constante (taxa de bits constante).  Muitos codecs nos dispositivos n√£o oferecem suporte a uma taxa de bits constante, ent√£o voc√™ precisa viver com a imagem √† esquerda. <br><img src="https://habrastorage.org/webt/6r/ej/mt/6rejmtldwpgvu2an6bbjwu7-xoq.jpeg"><br><br><h3>  Codecs de √°udio </h3><br>  Existem v√°rios codecs legados para √°udio, como o G711.  O codec Opus √© muito popular - resolve o problema de codifica√ß√£o com taxas de bits baixas e altas, porque por dentro cont√©m o SILK do Skype e o codec CELT para m√∫sica. <br><br>  Vale dizer que o Opus possui um algoritmo proativo de corre√ß√£o de erros de FEC (Forward Error Correction).  Para o √°udio, esse algoritmo funciona assim: em cada pacote existem dados em alta qualidade e dados de quadros anteriores por algum tempo em baixa qualidade.  Assim, se o pacote anterior for perdido, voc√™ poder√° obter os dados do pacote anterior com baixa qualidade e, de alguma forma, perder.  Em m√©dia, resulta muito bom. <br><br>  Ao trabalhar com codecs de √°udio, √© interessante observar o gr√°fico, que mostra a propor√ß√£o da qualidade do sinal de entrada e da taxa de bits. <br><img src="https://habrastorage.org/webt/_r/wd/em/_rwdemfrce5rw2njez4pge9wgr0.jpeg"><br>  Pode-se ver que o Opus resolve quase todos os problemas.  √â interessante prestar aten√ß√£o no AAC, usado na codifica√ß√£o de v√≠deo em v√°rios servi√ßos de hospedagem, e no antigo codec Speex, usado exclusivamente para √°udio e at√© 32 Kbps, funciona bem. <br><br><h3>  Dados de patologia de m√≠dia </h3><br>  Para entender como as topologias funcionam, quais recursos elas t√™m, voc√™ precisa entender como um codec de v√≠deo lida com as perdas. <br><img src="https://habrastorage.org/webt/vt/dn/zm/vtdnzmfdmc8n8bxq_rmmfoscpls.jpeg"><br>  No primeiro caso, nada foi perdido, e vemos uma boa imagem.  Na segunda linha, um quadro aleat√≥rio √© perdido - existem pequenos artefatos na imagem.  No terceiro caso, o quadro de refer√™ncia desapareceu; portanto, at√© o pr√≥ximo quadro de refer√™ncia, ser√£o mostradas altera√ß√µes que se sobrep√µem aleatoriamente. <br><br>  Obviamente, criar quadros de refer√™ncia geralmente √© caro porque a taxa de bits est√° aumentando.  Portanto, quase todos os servi√ßos de chamada de alguma forma suportam a capacidade de solicitar um quadro de refer√™ncia em caso de perda.  No WebRTC, isso √© chamado de quadro INTRA completo. <br><br>  A topologia mais simples √© enviar todo o seu v√≠deo para todos os outros participantes da confer√™ncia. <br><img src="https://habrastorage.org/webt/st/mt/bu/stmtbu09eze8vg6letvekimnosu.jpeg"><br>  Come√ßamos um codec e come√ßamos a transferir v√≠deo.  Alice liga a c√¢mera, o codec, envia seu v√≠deo para Boris e Dima.  Mas se o Dima tem Internet ruim, o Boris sofre, porque √© preciso diminuir a qualidade de todo o v√≠deo.  E se Dima perdeu o tiro e pediu um de apoio, Boris tamb√©m receber√°, embora ele n√£o precise dele. <br><br>  Por outro lado, voc√™ pode colar todos os v√≠deos em um fluxo.  Isso exigir√° equipamento especial e, possivelmente, haver√° atrasos adicionais, mas essa solu√ß√£o tamb√©m existe. <br><br><h3>  Transporte ou entregue v√≠deo e √°udio com um atraso m√≠nimo </h3><br>  N√≥s temos uma escolha de protocolos TCP ou UDP. <br><div class="scrollable-table"><table><tbody><tr><td>  TCP </td><td>  UDP </td></tr><tr><td>  Confi√°vel </td><td>  N√£o confi√°vel </td></tr><tr><td>  Orientado a conex√£o </td><td>  Sem conex√£o </td></tr><tr><td>  Retransmiss√£o de segmento e controle de fluxo atrav√©s de janelas </td><td>  Sem janelas ou retransmiss√£o </td></tr><tr><td>  Sequenciamento de segmento </td><td>  Sem sequenciamento </td></tr><tr><td>  Sequencia√ß√£o de confirma√ß√£o </td><td>  Sem reconhecimento </td></tr></tbody></table></div>  Provavelmente todos lembram que o TCP √© um protocolo confi√°vel, que em caso de perda de pacotes os envia novamente.  √â por isso que essa ordem de quadros √© poss√≠vel, como na figura abaixo. <br><img src="https://habrastorage.org/webt/si/qm/rc/siqmrcta6lzauazsdsbitbkifvo.jpeg"><br>  Se um pacote estiver faltando, voc√™ poder√° pular livremente esse dos 24 quadros do v√≠deo, mas o TCP n√£o permitir√° que voc√™ receba o seguinte at√© enviar o perdido.  <strong>A entrega de v√≠deo por TCP √© extremamente ineficiente.</strong>  O UDP √© recomendado para essas tarefas e todos os servi√ßos de chamada o utilizam. <br><br>  Este <a href="https://habr.com/ru/company/oleg-bunin/blog/461829/">artigo</a> fornece todos os recursos dos dois protocolos e explica por que todo o streaming funciona no UDP.  Como parte do t√≥pico de hoje, basta sabermos que o UDP n√£o est√° dispon√≠vel em todos os lugares, n√£o funciona em 3% das redes. <br><img src="https://habrastorage.org/webt/tv/ky/jz/tvkyjzwzytjo2pgxmfgek1afv_8.jpeg"><br>  Em geral, os usu√°rios podem estabelecer conex√µes P2P entre si. <br><img src="https://habrastorage.org/webt/xe/nj/ew/xenjewfqamelio5eqywflbiyn54.jpeg"><br>  Essa √© a mais lucrativa, porque, se nos ligarmos em Novosibirsk, √© muito melhor se comunicar diretamente e n√£o usar um servidor adicional que forne√ßa alavancagem. <br><br>  Mas o NAT existe e mais de 97% dos usu√°rios agora est√£o localizados atr√°s dele - poucos t√™m IPs externos.  Por um lado, esse problema ser√° resolvido mais cedo ou mais tarde pelo IPv6.  Ali√°s, na R√∫ssia, o MTS foi o primeiro a lan√ß√°-lo.  Agora eles oferecem suporte total ao IPv6, e todos os seus clientes t√™m IPs brancos. <br><br>  O NAT pode romper, pode n√£o romper e, em seguida, voc√™ precisar√° usar o fallback atrav√©s do servidor.  H√° tamb√©m um <a href="https://habr.com/ru/company/oleg-bunin/blog/428217/">artigo sobre</a> como romper o NAT. <br><br><h3>  Buffer de tremula√ß√£o entre transporte e quadros </h3><br>  N√≥s seguimos em frente.  Agora precisamos do buffer de jitter para nivelar o efeito do jitter <br><img src="https://habrastorage.org/webt/od/eb/m5/odebm5kla1eprghttikfis_tzm8.jpeg"><br>  Come√ßamos a mostrar proativamente os quadros com algum atraso e, enquanto isso, alinhamos os quadros no mesmo intervalo no buffer. <br><br>  O buffer aumenta dinamicamente. <br><img src="https://habrastorage.org/webt/_q/-s/o4/_q-so4lqgyenwyrlcbk2u141h2k.jpeg"><br>  Se o quadro for perdido e a imagem congelada, o buffer aumentar√° e j√° estaremos trabalhando com um buffer desse tamanho. <br><br>  Mas pode haver uma situa√ß√£o inversa quando voc√™ precisar reduzir o buffer.  Por exemplo, a rede se estabilizou e o tempo precisa ser atualizado.  Se voc√™ simplesmente reduzir o buffer, ser√° rid√≠culo, as pessoas come√ßar√£o a falar muito rapidamente com a voz de um gnomo.  Portanto, existem algoritmos especiais que ajustam imperceptivelmente a velocidade do √°udio: remova pausas entre palavras ou reduza sons que s√£o muito longos na fala. <br><br>  Se voc√™ deseja transcodificar um v√≠deo e consertar algo, primeiro precisa ter um buffer de instabilidade, e sua lat√™ncia n√£o ser√° menor que a instabilidade de lat√™ncia desta rede.  Ou seja, definitivamente aumenta a lat√™ncia e lembramos que realmente queremos manter dentro de 0,5 s. <br><img src="https://habrastorage.org/webt/um/vs/2i/umvs2isu-bjnd2sp4u7ke7sqyv4.jpeg"><br>  Expire - a teoria acabou! <br><br><h2><a name="ok-call"></a>  Chamadas para OK </h2><br>  Antes das chamadas em grupo, t√≠nhamos chamadas p2p, a biblioteca WebRTC era usada, clientes web e m√≥veis eram coletados, a sinaliza√ß√£o era escrita. <br><img src="https://habrastorage.org/webt/kj/sl/uo/kjsluoez0wxxhsya9ttbfaev--k.jpeg"><br><br><h3>  An√°lise do concorrente </h3><br>  Quando voc√™ n√£o sabe o que fazer, observe seus concorrentes.  Para refer√™ncia, escolhemos um conjunto: Skype, WhatsApp, Hangouts, ICQ, Zoom.  Medimos o n√∫mero m√°ximo de participantes em uma chamada em grupo, lat√™ncia, consumo de bateria e qualidade. <br><br>  O mais interessante √© determinar o atraso.  Fazemos da seguinte maneira: ligue o timer, comece a gravar um v√≠deo, fa√ßa uma liga√ß√£o. <br><img src="https://habrastorage.org/webt/0k/_q/ct/0k_qctbyc9_eenat32mcm3zbz10.jpeg"><br>  100 ms - atraso da c√¢mera a partir do momento em que o v√≠deo atingiu a lente, antes de ser desenhado na matriz do telefone.  Depois disso, o v√≠deo √© enviado para a rede e vemos um atraso de 310 ms na chamada. <br><img src="https://habrastorage.org/webt/eg/oi/g5/egoig53tzrzn-1byodqkwmfcfsq.jpeg"><br>  N√£o se esque√ßa de medir o uso da CPU no dispositivo.  A partir do iOS 12, tornou-se poss√≠vel fazer isso sistematicamente, mas usamos um pir√¥metro √† moda antiga. <br><br>  Obteve os seguintes resultados: <br><img src="https://habrastorage.org/webt/mk/tu/1s/mktu1se2wjoa_lwb842wsfkyouk.jpeg"><br>  O WhatsApp e o ICQ t√™m no m√°ximo 4 participantes, o Skype possui 25 (Skype for Business 250) e o Hangouts e Zoom t√™m 100 participantes.  O Hangouts costumava ter cerca de 35 membros e agora ele passou para a se√ß√£o 100+. <br><br>  O zoom demora um pouco mais, mas o Hangouts consome mais energia da bateria.  Pareceu-me que o Zoom tem melhor qualidade, mas h√° artigos que dizem o contr√°rio - essa √© uma m√©trica subjetiva. <br><img src="https://habrastorage.org/webt/mu/sa/9b/musa9bet2chfnzj55svmkj5j9qk.jpeg"><br>  Alguns servi√ßos usam WebRTC aberto, outros usam protocolos propriet√°rios.  Mas √© √≥bvio que o tipo de transporte usado abaixo n√£o afeta o n√∫mero de participantes na chamada.  Existem solu√ß√µes com 100 chamadas e protocolos pr√≥prios (Zoom) e com WebRTC (Hangouts). <br><br><h3>  Escala de 2 a N </h3><br>  Considere um caso interessante: existe um cliente com um canal assim√©trico, entrada 3 Mbit / s, sa√≠da 1,5 Mbit / s, perda de pacotes 0,6%, jitter 50 ms.  H√° v√≠deo em HD (1280x720) com uma taxa de bits de 1,5 Mbps e v√≠deo com uma resolu√ß√£o de 640x360 (vamos chamar de BAIXA) a 600 Kbps.  Queremos transmitir v√≠deos legais. <br><br>  Caso duas pessoas liguem para p2p, tudo ser√° simples.  Eles t√™m rede de entrada suficiente, a rede de sa√≠da √© suficientemente r√≠gida, porque o canal √© assim√©trico e n√£o h√° problemas com codecs - todos os codecs s√£o gratuitos. <br><br>  Quando come√ßamos a fazer chamadas em grupo, precisamos reconectar todos.  A vers√£o mais simples da topologia √© <strong>Mesh</strong> ou "todos para todos". <br><img src="https://habrastorage.org/webt/xt/zk/th/xtzkthwsqgph-xmvnpzufncfl6o.jpeg"><br>  √â √≥timo que servidores intermedi√°rios n√£o sejam necess√°rios, mas est√° se tornando problem√°tico oferecer a todos o seu v√≠deo para clientes com essas caracter√≠sticas.  E se o cliente n√£o puder distribuir o v√≠deo para algu√©m sozinho, ser√° necess√°rio diminuir a qualidade, porque o fluxo comum √© codificado para todos. <br><br>  Nesse caso, para 5 participantes, nem 3 nem 4 Mbps s√£o suficientes. <br><img src="https://habrastorage.org/webt/ah/h5/rf/ahh5rfvgcjjkm70qhzv1ruduaws.jpeg"><br>  Portanto, no WhatsApp em uma chamada de grupo, h√° no m√°ximo 4 participantes e n√£o ser√° mais enquanto eles usarem o Mesh. <br><br>  Outra op√ß√£o √© <strong>coletar a</strong> imagem inteira <strong>no servidor</strong> .  Essa √© a mais lucrativa para o cliente: ele tem uma conex√£o com o servidor, o servidor coleta a imagem e o cliente recebe de volta. <br><img src="https://habrastorage.org/webt/bg/_3/qh/bg_3qhrgkt1izvjkwciy4pfegbm.jpeg"><br>  Mas suponha que nossos usu√°rios de Petropavlovsk-Kamchatsky, Komsomolsk-on-Amur e Novosibirsk desejam conversar por meio de um servidor de Moscou.  Naturalmente, tudo sair√° muito mal.  A presen√ßa da CDN ajudar√° um pouco, mas ainda assim obter√° uma grande quantidade de buffers de jitter, que no total far√£o uma adi√ß√£o decente √† lat√™ncia. <br><br>  A pr√≥xima topologia - <strong>mistura final</strong> - sugere n√£o coletar uma imagem geral no servidor para evitar esses atrasos, mas simplesmente lan√ßa pacotes. <br><img src="https://habrastorage.org/webt/1k/aj/cc/1kajccrtduezyvharoklxqwlv0e.jpeg"><br>  Ou seja, o servidor nesta topologia √© simplesmente um rel√© que transfere dados. <br><br>  Tudo est√° ficando um pouco melhor: o usu√°rio recebe transmiss√µes de todos os outros participantes da chamada e envia os seus apenas uma vez.  Mas, novamente, h√° problemas: <br><br><ul><li>  <strong>Qualidade.</strong>  Todos os destinat√°rios do seu fluxo t√™m uma rede diferente.  Se uma pessoa estiver conectada √† Internet com baixa qualidade, o v√≠deo precisar√° ser entregue em baixa resolu√ß√£o e, consequentemente, a imagem ficar√° ruim para todos. </li><li>  <strong>Quadros de refer√™ncia do Storm</strong> .  Se uma pessoa com Internet ruim solicita constantemente um quadro de refer√™ncia, todos tamb√©m come√ßam a receber oporniks.  Este √© um uso ineficiente de taxa de bits, a qualidade diminui novamente. </li></ul><br><img src="https://habrastorage.org/webt/26/wj/bv/26wjbvlg4tlfijnuif4dwzpfc8m.jpeg"><br>  Se um <strong>sistema centralizado for usado</strong> , ou seja, todo o v√≠deo ser√° coletado no servidor.  Isso requer muitos est√°gios de codifica√ß√£o, que adicionam lat√™ncia e requerem hardware adicional.  Na mistura final, pelo contr√°rio, tudo √© r√°pido e f√°cil. <br><br>  <strong>Contras topologias:</strong> <br><br><ul><li>  Malha - no m√°ximo 4 membros. </li><li>  Centralizado - problemas com transcodifica√ß√£o e jitter. </li><li>  Mistura final - limites de qualidade e quadros de refer√™ncia de tempestade. </li></ul><br>  Somente o ICQ e o Skype trabalham na topologia Mesh e todo o resto √© mistura final.  Mas, como lembramos, todos os servi√ßos s√£o diferentes em termos de caracter√≠sticas - o que significa que n√£o existe apenas a mistura final, mas outra coisa. <br><br>  O Hangouts fez o truque com a mixagem final. <br><img src="https://habrastorage.org/webt/pm/uy/25/pmuy25cx0untfvn3gbk0qmcehay.jpeg"><br>  Dois codificadores s√£o lan√ßados em cada cliente: H.264 em alta qualidade e VP8 em baixa qualidade.  Assim, para usu√°rios com boa Internet, o servidor transmite v√≠deo de alta qualidade; para quem tem Internet ruim, √© pior e a qualidade baixa se adapta √† pior rede.  Duas qualidades s√£o boas, mas isso √© tr√°fego extra dos clientes e consumo de bateria.  Mas n√£o h√° buffer de instabilidade <br><br>  A tabela mostra que, com o Hangouts em execu√ß√£o, o telefone aquece acima de tudo, h√° atrasos m√≠nimos, mas a qualidade √© prejudicada, porque a baixa qualidade ainda consome a alta taxa de bits. <br><img src="https://habrastorage.org/webt/na/6n/2f/na6n2fs0u3ebkqez1jjntk3kel0.jpeg"><br>    ,    : -      ,  H.264,         (    )   End mixing   .      centralized-,    ,    ,       ,     . <br><img src="https://habrastorage.org/webt/db/15/pw/db15pwl1tkdxpxd4xpz8gp-sba4.jpeg"><br> ,      :      .   ,        , ,     ,   -     .    ,           . <br><br>        . <br><img src="https://habrastorage.org/webt/0o/9y/6b/0o9y6bt7zahjvydljkpnkvaxvyk.jpeg"><br> ,  ,    ,       latency     .    ,        , ,   ,       .                 centralized,    ,  ,   jitter-  .          ,            ,   . <br><br>        ¬´¬ª,   .          100,  50,   20   .           . <br><img src="https://habrastorage.org/webt/du/88/yt/du88ytnejvtsgryudgkdfntv7pg.jpeg"><br>         ‚Äî  ,       5 .      .    :  ,     ,      ,      ‚Äî      . <br><br>  ¬´¬ª      , ,    , ‚Äî  .       :   ,    - ,    fps.  ,          ‚Äî  .    - ,  .    ,     . <br><br><h2><a name="fin"></a>   </h2><br>    Mesh  3-4       latency,    ,         Mesh.      ,   HD   End mixing, a SD ‚Äî  centralized. <br><br>       Zoom. <br><img src="https://habrastorage.org/webt/h9/5q/2q/h95q2que4mihuktnf2mz18zsjua.jpeg"><br> ,    -    ,   Zoom  ,    WebRTC.   <strong>   WebRTC</strong> ,        . <br><br><h2>  </h2><br>      . <br><br> <strong>CPU   ,  .</strong>       ‚Äî ,    ,   ,   ,   CPU ,  .     ,       . <br><br>   :   ,    ,      . <br><br> <strong> screen sharing   .</strong>    screen sharing,       ,    .   screen sharing  .  ,   fps ‚Äî ,    ,    . <br><br> <strong>        .</strong>    ‚Äî     centralized,      ,       .    ,   . <br><img src="https://habrastorage.org/webt/kd/b4/zt/kdb4ztkg9daqyfjryhpzg4u7uac.jpeg"><br>  ,        ,    ,     .         ,    ,                 . <br><br><h2><a name="server"></a>   </h2><br> ,   ,  -     .               . <br><img src="https://habrastorage.org/webt/ga/ve/43/gave43pdwqyaly4pm7b1amurzxc.jpeg"><br><br><h3> Packet pacing </h3><br> -,  UDP-     .   UDP   pacing.    UDP-  ,     . <br><img src="https://habrastorage.org/webt/mc/mb/t3/mcmbt33ngipgrs1xlf3hvhbx6d8.jpeg"><br>   ,      UDP ,   21       100%.           ‚Äî     . <br><br>     pacing?    ,         (   <a href=""></a> ) ‚Äî   ,  .  ,         ,  , ,  ,     ,   -             . <br><br>   : <br><br><ul><li>  pacing,     . </li><li>   pacing, ,  ,   ,      . </li></ul><br>     :        ,  pacing ,    ‚Äî. <br><br>    packet pacing? <br><img src="https://habrastorage.org/webt/wp/y3/vx/wpy3vxtcvgzvn8lukrnrpm2sx2w.jpeg"><br>   ,   (    )      ,   ,  - .   (  ),     ,       ,     . <br><br>    ‚Äî packet loss ,   pacing. <br><br><h3> MTU </h3><br> TCP  ,       MTU.      UDP,     ,  MTU ‚Äî    ,      . <br><br>       MTU 1500,        MTU 1100,   . ,    ,        , , ,    (   ).       ,   MTU . <br><img src="https://habrastorage.org/webt/rc/r7/jv/rcr7jvrykz5mtbajkmskh-s9if0.jpeg"><br>  TCP  ,       .   ,   MTU:   -   ,    , ,    MTU.         ,   MTU,    ,  . <br><br>   . <br><img src="https://habrastorage.org/webt/mp/fx/ct/mpfxctwu5bck6fnp2_nr_lsmugc.jpeg"><br>   ,     :      ,  ,      .  98%          1350.    <strong>MTU = 1350</strong> ,    ,    2%    ‚Äî  ,  . <br><br><h3>   </h3><br> WebRTC  SACK, NACK, FEC.       . <br><br>   ,   1‚Äì3%     ‚Äî  ,      . <br><br>  WebRTC      negative acknowledgement (NACK). <br><img src="https://habrastorage.org/webt/n4/ik/zh/n4ikzhbxffmdjuf-a79snq2vaum.jpeg"><br>         ,  ,  -  ,  . <br><br>  , TCP   acknowledgement,     selective acknowledgement.  negative acknowledgement  ,        FEC (Forward Error Correction). <br><br>     ,   SACK, NACK, FEC,   <a href="https://youtu.be/e1JYFRwHzkQ"></a> . <br><br>  FEC ,   ,   .  :      ,   ,         .     , ,    ‚Äî   . <br><img src="https://habrastorage.org/webt/fo/dw/-s/fodw-s_sepjc4qkhonlbr_k-6pq.jpeg"><br>    FEC ‚Äî  XOR,      , ,  .       ,     -  . <br><br>  <a href="https://tools.ietf.org/html/draft-ietf-payload-flexible-fec-scheme-20"></a>   ,       .     ,        ,     ,     FEC-.  ,   ,         , ,          . <br><br> ,   , <strong>   </strong> .    , : <br><br><ul><li>  90%     500 /. </li><li>    ‚Äî 3-4,        Mesh  End mixing. </li><li>      ‚Äî  27  (,  ). </li></ul><br><h2> Check List </h2><br>          : <br><br><ul><li> Packet pacing. </li><li> MTU discovery. </li><li>  . </li><li> C    . </li></ul><br>    ,     signalling,   WebRTC,   ,   ,     - . <br><br>       ,     : <br><br><ul><li> <strong>Packet loss:</strong> , packet pacing, FEC,  MTU. </li><li> <strong>   :</strong>    back pressure  ,         FEC-. </li><li> <strong>Jitter</strong>     jitter buffer,     latency. </li><li> <strong>RTT:</strong>   ,      signaling. </li></ul><br><h1>      </h1><br> WebRTC ‚Äî    .  RTP,        ,    ,   .     WebRTC  . <br><br>    ,   Zoom, Skype  Line,    .      .         . ,    ,     <a href="https://habr.com/ru/company/oleg-bunin/blog/413479/"></a>   UDP- (      ,   WebRTC),   .   ,    ,    . ,    Google STADIA. <br><br> STADIA ‚Äî   ,       .    WebRTC,  ,     .  Google      WebRTC.     WebRTC     SRTP WebRTC  QUIC.  ,    ,    . <br><br>   QUIC,     .    Chrome  c Android   Google  YouTube,    TCP ‚Äî  QUIC  UDP  Google.     30%   QUIC/UDP. <br><br>     QUIC     20-30%,  TCP.    - QUIC    ,       . <br><br><h1>  Conclus√µes </h1><br>     ,           .  ,     : signaling; / ;   . ,     ,    . <br><br>     ? <br><br><ul><li>  ,     - ,    . </li><li>       ,    . </li></ul><br>      /     . <br><br>  ,    , ‚Äî <strong>   </strong> .        ,  latency,  . ,    !   -       :) <br><br><blockquote>    HighLoad++     . <a href="https://www.highload.ru/spb/2020"> </a> (      )   ,  <a href="https://conf.ontico.ru/lectures/propose%3Fconference%3Dhl2020-spb"> </a>   6-7  2020   .    ,   <a href="http://eepurl.com/VYVaf"></a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt479852/">https://habr.com/ru/post/pt479852/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt479836/index.html">A Duma do Estado adotou emendas √† lei de eletricidade em termos de microgera√ß√£o. As alternativas ser√£o felizes?</a></li>
<li><a href="../pt479842/index.html">A Universidade de Bata criou um neur√¥nio anal√≥gico eletr√¥nico</a></li>
<li><a href="../pt479844/index.html">Re√∫na uma equipe de designers de UX e perca 7 milh√µes devido a erros de contrata√ß√£o</a></li>
<li><a href="../pt479848/index.html">Nosso no quadrante 2019! Como o relat√≥rio anal√≠tico de videoconfer√™ncia do Gartner Meeting Solutions mudou nos √∫ltimos cinco anos</a></li>
<li><a href="../pt479850/index.html">Instale o Exchange 2019 no Windows Server Core 2019</a></li>
<li><a href="../pt479854/index.html">12 de dezembro pela manh√£ Java digest</a></li>
<li><a href="../pt479858/index.html">Procurando por LD_PRELOAD</a></li>
<li><a href="../pt479860/index.html">Uma varia√ß√£o no t√≥pico de modelagem de vida. Parte 2</a></li>
<li><a href="../pt479862/index.html">Como economizar 15.000 rublos ao registrar o software</a></li>
<li><a href="../pt479864/index.html">Jogo no WinForms + C # em 16 anos (2 partes)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>