<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç£ üïπÔ∏è ü§πüèº Von der Poolanforderung bis zur Freigabe. Bericht Yandex.Taxi üîÖ üòµ üî≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es gibt einen kritischen Zeitraum im Ver√∂ffentlichungszyklus des Dienstes - von dem Moment an, in dem eine neue Version vorbereitet wird, bis zu dem M...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Von der Poolanforderung bis zur Freigabe. Bericht Yandex.Taxi</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/439704/">  Es gibt einen kritischen Zeitraum im Ver√∂ffentlichungszyklus des Dienstes - von dem Moment an, in dem eine neue Version vorbereitet wird, bis zu dem Moment, in dem sie den Benutzern zur Verf√ºgung steht.  Teamaktionen zwischen diesen beiden Kontrollpunkten sollten von Release zu Release konsistent und nach M√∂glichkeit automatisiert sein.  In seinem Bericht beschrieb der Alberist von Sergey Pomazanov die Prozesse, die jeder Yandex.Taxi-Poolanforderung folgen. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/1_j72yHvXUw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - Guten Abend!  Mein Name ist Sergey, ich bin der Leiter der Automatisierungsgruppe bei Yandex.Taxi.  Kurz gesagt, die Hauptaufgabe unserer Gruppe besteht darin, den Zeitaufwand f√ºr die L√∂sung ihrer Probleme zu minimieren.  Dies umfasst alles von CI bis hin zu Entwicklungs- und Testprozessen. <br><br>  Was macht unsere Entwicklung, wenn der Code geschrieben wird? <br><br><a name="habracut"></a>  Um die neue Funktionalit√§t zu testen, √ºberpr√ºfen wir zun√§chst alles lokal.  F√ºr lokale Tests haben wir eine gro√üe Anzahl von Tests.  Wenn ein neuer Code angezeigt wird, muss dieser ebenfalls mit Tests abgedeckt werden. <br><br><img src="https://habrastorage.org/webt/cy/lr/el/cylrel5kfrii-dvrh7wvpbgh6fw.jpeg"><br><br>  Unsere Testabdeckung ist nicht so gut, wie wir m√∂chten, aber wir versuchen, sie auf einem ausreichenden Niveau zu halten. <br><br>  Zum Testen verwenden wir Google Test und ein selbst geschriebenes Pytest-Framework, mit dem wir nicht nur den "Python" -Teil, sondern auch den "Plus" -Teil testen.  Mit unserem Framework k√∂nnen Sie vor jedem Test Dienste starten, Daten in die Datenbank hochladen, Caches aktualisieren, alle externen Anforderungen l√∂schen usw. Ein ausreichend funktionierendes Framework, mit dem Sie alles nach Belieben ausf√ºhren und sperren k√∂nnen, damit wir nicht versehentlich welche erhalten Anfragen au√üerhalb. <br><br>  Zus√§tzlich zu Funktionstests bieten wir Integrationstests an.  Sie erm√∂glichen es Ihnen, ein anderes Problem zu l√∂sen.  Wenn Sie nicht sicher sind, ob Ihr Dienst ordnungsgem√§√ü mit anderen Diensten interagiert, k√∂nnen Sie den Stand ausf√ºhren und eine Reihe von Tests ausf√ºhren.  Bisher haben wir eine Reihe grundlegender Tests, die sich jedoch langsam erweitern. <br><br>  Der Stand basiert auf der Technologie von Docker und Docker Compose, bei der jeder Container seine eigenen Dienste hat und alle miteinander interagieren.  Dies geschieht in einer isolierten Umgebung.  Sie haben ein eigenes isoliertes Netzwerk, eine eigene Datenbank und einen eigenen Datensatz.  Und die Tests bestehen so, als w√ºrde jemand eine mobile Anwendung starten, auf Schaltfl√§chen klicken und eine Bestellung aufgeben.  In diesem Moment fahren die virtuellen Autos, bringen den Passagier, dann wird das Geld vom Passagier abgebucht und so weiter.  Grunds√§tzlich erfordern alle Tests die Interaktion vieler Dienste und Komponenten gleichzeitig. <br><br>  Nat√ºrlich testen wir nur unsere Services und nur unsere Komponenten, da wir keine externen Services testen sollten und alles extern benetzen. <br><br>  Der Stand war praktisch genug, um vor Ort zu fahren und ein Taschentaxi herauszuholen.  Sie k√∂nnen diesen Standpunkt einnehmen, ihn auf einem lokalen Computer oder auf einer virtuellen Maschine oder einer anderen Entwicklungsmaschine ausf√ºhren.  Nachdem Sie den Stand gestartet haben, k√∂nnen Sie eine f√ºr ein Taschentaxi angepasste mobile Anwendung nehmen, auf Ihrem Computer konfigurieren und Bestellungen aufgeben.  Alles ist genau das gleiche wie in der Produktion oder anderswo.  Wenn Sie die neue Funktionalit√§t testen m√ºssen, k√∂nnen Sie einfach Ihren Code eingeben. Er wird in der gesamten Umgebung abgerufen und ausgef√ºhrt. <br><br>  Auch hier k√∂nnen Sie einfach den gew√ºnschten Dienst ausf√ºhren.  Dazu m√ºssen Sie die Datenbank erh√∂hen, mit den erforderlichen Inhalten f√ºllen oder eine Basis aus vorhandenen Umgebungen entnehmen und mit dem Dienst verbinden.  Und dann k√∂nnen Sie ihn einfach kontaktieren, einige Fragen stellen und pr√ºfen, ob es richtig funktioniert oder nicht. <br><br>  Ein weiterer wichtiger Punkt ist die Stilpr√ºfung.  Wenn f√ºr die ‚ÄûPluspunkte‚Äú alles einfach ist, verwenden wir das Clang-Format und pr√ºfen, ob der Code mit ihm √ºbereinstimmt oder nicht. F√ºr Python verwenden wir bis zu vier Analysatoren: Flake8, Pylint, Mypy und anscheinend autopep8. <br><br>  Wir verwenden diese Analyseger√§te haupts√§chlich in der Standardlieferung.  Wenn die M√∂glichkeit besteht, einen Designstil zu w√§hlen, verwenden wir den Google-Stil.  Das einzige, was wir durch Hinzuf√ºgen unserer eigenen korrigiert haben, ist eine √úberpr√ºfung der Sortierung der Importe, damit die Importe korrekt sortiert werden. <br><br>  Nachdem Sie den lokal √ºberpr√ºften Code erstellt haben, k√∂nnen Sie eine Poolanforderung ausf√ºhren.  Pool-Anfragen werden auf GitHub erstellt. <br><br><img src="https://habrastorage.org/webt/dx/sj/ac/dxsjacymhqczij9ourzfrtnxai0.jpeg"><br><br>  Das Erstellen einer Poolanforderung auf GitHub bietet TeamCity viele M√∂glichkeiten.  TeamCity f√ºhrt automatisch alle oben genannten Tests aus, √ºberpr√ºft sie automatisch und in der Poolanforderung selbst wird √ºber den Status der Passage geschrieben, ob die Tests bestanden wurden oder nicht.  Das hei√üt, ohne TeamCity zu besuchen, k√∂nnen Sie sehen, ob es bestanden hat oder nicht, und indem Sie auf den Link klicken, um zu verstehen, was schief gelaufen ist und was behoben werden muss. <br><br>  Wenn Sie nicht √ºber gen√ºgend Taschen-Taxis und -Tests verf√ºgen und die tats√§chliche Interaktion mit einem echten Service √ºberpr√ºfen m√∂chten, verf√ºgen wir √ºber eine Testumgebung, die die Produktion wiederholt.  Wir haben zwei dieser Testumgebungen.  Eine ist f√ºr die mobile Entwicklung von Testern und die zweite f√ºr Entwickler.  Die Testumgebung ist so produktionsnah wie m√∂glich. Wenn Anforderungen an externe Services gestellt werden, werden diese auch aus Testumgebungen gestellt.  Die einzige Einschr√§nkung besteht darin, dass die Testumgebung nach M√∂glichkeit externe Ressourcen testet.  Und die Produktionsumgebung geht in Produktion. <br><br>  Mehr √ºber die Testumgebung, wir machen das ganz einfach √ºber TeamCity.  Es ist notwendig, das entsprechende Label auf GitHub zu platzieren und nach dem Festlegen auf die Schaltfl√§che "Benutzerdefiniert sammeln" zu klicken.  Also nennen wir es.  Dann werden alle Poolanforderungen mit diesem Label konkurriert, und dann beginnt die automatische Zusammenstellung von Paketen mit Clustering. <br><br>  Zus√§tzlich zu Routinetests sind manchmal Lasttests erforderlich.  Wenn Sie Code bearbeiten, der Teil eines hoch geladenen Dienstes ist, k√∂nnen wir hierf√ºr Lasttests durchf√ºhren.  In Python gibt es nur wenige hoch geladene Dienste, von denen einige in C ++ neu geschrieben wurden. Trotzdem bleiben sie bestehen, manchmal gibt es einen Ort, an dem man sein kann.  Lasttests finden √ºber das Lunapark-System statt.  Es verwendet Yandex.Tank, es ist frei verf√ºgbar, Sie k√∂nnen es herunterladen und ansehen.  Mit dem Tank k√∂nnen Sie bei einem Dienst feuern, Diagramme erstellen, verschiedene Lademethoden ausf√ºhren und anzeigen, welche Last derzeit auf dem Dienst war und welche Ressourcen verwendet wurden.  Es reicht aus, √ºber TeamCity auf die Schaltfl√§che zu klicken, das Paket wird abgeholt und kann dann bei Bedarf gerollt werden.  Oder f√ºllen Sie es einfach manuell aus und f√ºhren Sie es dort aus. <br><br><img src="https://habrastorage.org/webt/a5/ny/uu/a5nyuuqz_opgjup2cr5mjqcweqc.jpeg"><br><br>  W√§hrend Sie Ihren Code testen, kann einer der Entwickler in diesem Moment beginnen, sich Ihren Code anzusehen und ihn zu √ºberpr√ºfen. <br><br>  Worauf wir dabei achten: <br><br><img src="https://habrastorage.org/webt/cy/ul/h3/cyulh3bd1lfyhcraxx3x6gtdccm.jpeg"><br><br>  Einer der wichtigen Punkte - die Funktionalit√§t muss deaktiviert sein.  Dies bedeutet, dass unabh√§ngig davon, um welchen Code es sich handelt, Fehler darin vorhanden waren oder nicht. Vielleicht funktioniert diese Funktionalit√§t nicht so, wie sie urspr√ºnglich beabsichtigt war. Vielleicht wollten die Manager etwas anderes, oder vielleicht versucht diese Funktionalit√§t, einen anderen Dienst bereitzustellen, der nicht bereit war zu neuen Lasten, und Sie m√ºssen die F√§higkeit haben, es schnell auszuschalten und alles in einen normalen Zustand zu versetzen. <br><br>  Wir haben auch die Regel, dass beim Rollout neue Funktionen deaktiviert und erst aktiviert werden sollten, nachdem sie in allen Clustern und allen Rechenzentren eingef√ºhrt wurden. <br><br>  Vergessen Sie nicht, dass wir eine API haben, die von mobilen Anwendungen verwendet wird, die m√∂glicherweise l√§ngere Zeit nicht aktualisiert werden.  Wenn wir einige r√ºckw√§rts inkompatible √Ñnderungen in unserer API vornehmen, k√∂nnen einige Anwendungen ausfallen und wir k√∂nnen nicht alle Anwendungen zwingen, nur herunterzuladen und zu aktualisieren.  Dies wird sich negativ auf unseren Ruf auswirken.  Daher m√ºssen alle neuen Funktionen abw√§rtskompatibel sein.  Dies gilt nicht nur f√ºr die externe API, sondern auch f√ºr die interne API, da Sie nicht gleichzeitig den gesamten Code f√ºr alle Rechenzentren, f√ºr alle Computer und f√ºr alle Cluster bereitstellen k√∂nnen.  In jedem Fall werden sowohl der alte als auch der neue Code gleichzeitig bei uns leben.  Infolgedessen erhalten wir einige Abfragen, die nicht irgendwo verarbeitet werden k√∂nnen, und es treten Fehler auf. <br><br>  Sie sollten auch √ºber das N√§chste nachdenken: Wenn Ihr Code pl√∂tzlich nicht mehr funktioniert oder Sie einen neuen Microservice geschrieben haben, in dem potenzielle Probleme auftreten, m√ºssen Sie auf die Folgen vorbereitet sein und sich verschlechtern k√∂nnen.  Mein Kollege wird bei der n√§chsten Pr√§sentation dar√ºber sprechen. <br><br>  Wenn Sie √Ñnderungen an hoch ausgelasteten Diensten vornehmen und nicht auf das Ende einiger Vorg√§nge warten m√ºssen, k√∂nnen Sie einige Dinge asynchron irgendwo im Hintergrund oder als separaten Prozess ausf√ºhren.  Dies ist besser, da ein separater Prozess weniger Auswirkungen auf die Produktion hat und das System insgesamt stabiler arbeitet. <br><br><img src="https://habrastorage.org/webt/4f/gt/l2/4fgtl2iijso_y_j8ecaekyi_aik.jpeg"><br><br>  Es ist auch wichtig, dass alle Daten, die wir von au√üen erhalten, wir ihnen nicht vertrauen, sie validieren, irgendwie verifizieren usw. Alle Daten, die wir haben, sollten in Gruppen unterteilt werden, die wir gebildet haben oder Rohdaten, die die Validierung nicht bestanden haben.  Dies schlie√üt alle Daten ein, die m√∂glicherweise von anderen externen Diensten oder direkt von Benutzern abgerufen werden k√∂nnten, da m√∂glicherweise alles kommen k√∂nnte.  Vielleicht hat jemand speziell eine b√∂swillige Anfrage gesendet, und alles sollte mit uns besprochen werden. <br><br><img src="https://habrastorage.org/webt/zn/vn/q4/znvnq49zowpwiono0al7g6eczde.jpeg"><br><br>  Es gibt immer noch F√§lle, in denen der Dienst auf Anfrage m√∂glicherweise nicht zum richtigen Zeitpunkt reagiert.  M√∂glicherweise ist die Verbindung unterbrochen oder es ist ein Fehler aufgetreten. Es kann viele Situationen geben.  Die mobile Anwendung wei√ü nicht, was letztendlich passiert ist, sondern f√ºhrt lediglich eine erneute Anforderung durch. <br><br>  Es ist sehr wichtig, dass bei diesen erneuten Anfragen, egal wie viele es sind, am Ende alles wie urspr√ºnglich erwartet mit einer einzigen Anfrage funktioniert.  Wir sollten keine Spezialeffekte haben.  Es sollte auch ber√ºcksichtigt werden, dass wir mehr als einen Service haben, viele Maschinen, viele Rechenzentren, verteilte St√ºtzpunkte und Rennen f√ºr alle m√∂glich sind.  Der Code sollte so geschrieben sein, dass er nicht an mehreren Stellen gleichzeitig ausgef√ºhrt wird, damit wir keine Rennen haben. <br><br>  Ein ebenso wichtiger Punkt ist die F√§higkeit, Probleme zu diagnostizieren.  In allem gibt es immer Probleme, und Sie m√ºssen verstehen, wo sie aufgetreten sind.  Im Idealfall wurde die Existenz des Problems nicht durch den Support-Service, sondern durch √úberwachung ermittelt.  Und w√§hrend wir einige Situationen analysierten, konnten wir schlie√ülich verstehen, was passiert ist, indem wir einfach die Protokolle lesen, ohne den Code zu lesen.  Sogar die Person, die den Code noch nie gesehen hat, damit er ihn am Ende durch die Protokolle bekommen kann. <br><br>  Und im Idealfall, wenn die Situation sehr kompliziert ist, m√ºssen Sie anhand der Protokolle √ºberpr√ºfen k√∂nnen, in welche Richtung das Programm am Ende gelaufen ist und was die Nachbesprechung erheblich vereinfacht hat.  Da die Situation in der Vergangenheit so verlaufen ist und es jetzt unwahrscheinlich ist, dass sie reproduziert werden kann, gibt es bereits keine Daten oder andere Daten oder andere Situationen. <br><br>  Wenn Sie neue Vorg√§nge in der Datenbank ausf√ºhren oder einen neuen erstellen, m√ºssen Sie ber√ºcksichtigen, dass viele Daten vorhanden sein k√∂nnen.  Vielleicht schreiben Sie unendlich viele Datens√§tze in diese Datenbank, und wenn Sie nicht daran denken, sie zu archivieren, kann es zu Problemen kommen, die Datenbank w√§chst einfach auf unbestimmte Zeit und es gibt keine Ressourcen mehr, keine Festplatten und kein Sharding.  Es ist wichtig, Daten archivieren und nur die Betriebsdaten speichern zu k√∂nnen, die derzeit ben√∂tigt werden.  Au√üerdem m√ºssen Indexabfragen f√ºr alle Datenbanken durchgef√ºhrt werden.  Eine Nicht-Index-Abfrage kann die gesamte Produktion platzieren.  Eine kleine Anfrage an die am meisten geladene zentrale Sammlung kann alles stellen.  Du musst sehr vorsichtig sein. <br><br>  Wir begr√º√üen keine vorzeitigen Optimierungen.  Wenn jemand versucht, eine Fabrik zu einer sehr universellen Methode zu machen, die m√∂glicherweise F√§lle f√ºr die Zukunft behandelt, m√∂chte sie vielleicht eines Tages erweitert werden - dies ist nicht unsere Gewohnheit, da es m√∂glich ist, dass sie sich entwickelt Es wird v√∂llig falsch sein, und vielleicht wird dieser Code irgendwann vergraben, oder vielleicht ist alles nicht notwendig, sondern erschwert nur das Lesen und Verstehen des Codes.  Weil das Lesen und Verstehen des Codes sehr wichtig ist.  Es ist wichtig, dass der Code sehr einfach und leicht ist. <br><br>  Wenn Sie Ihrem Code eine neue Datenbank hinzuf√ºgen oder √Ñnderungen an der API vornehmen, verf√ºgen wir √ºber eine Dokumentation, die teilweise aus dem Code generiert wird und teilweise im Wiki erstellt wird.  Diese Informationen sind wichtig, um auf dem neuesten Stand zu bleiben.  Wenn nicht, kann dies jemanden irref√ºhren oder anderen Entwicklern Probleme bereiten.  Weil der Code alleine geschrieben ist, aber viel unterst√ºtzt wird. <br><br>  Ein wichtiger Teil ist die Einhaltung des allgemeinen Stils.  Die Hauptsache in diesem Fall ist die Einheitlichkeit.  Wenn der gesamte Code einheitlich geschrieben ist, ist er leicht zu verstehen, leicht zu lesen und Sie m√ºssen sich nicht mit allen Details und Nuancen befassen.  Einheitlich geschriebener Code kann den gesamten Entwicklungsprozess m√∂glicherweise in Zukunft beschleunigen. <br><br>  Ein weiterer Punkt, den wir nicht speziell auf Bewertungen pr√ºfen, ist, dass wir nicht nach Fehlern suchen.  Weil der Autor mit der Suche nach Fehlern besch√§ftigt sein sollte.  Wenn es w√§hrend der √úberpr√ºfung Fehler gibt, werden sie nat√ºrlich dar√ºber schreiben, aber es sollte keine gezielte Suche geben, dies liegt ausschlie√ülich in der Verantwortung der Person, die den Code schreibt. <br><br>  Wenn Ihr Code geschrieben ist, ist die √úberpr√ºfung abgeschlossen, Sie k√∂nnen ihn einfrieren, aber es kommt h√§ufig vor, dass Sie zus√§tzliche Aktionen ausf√ºhren und in die Datenbank migrieren m√ºssen. <br><br><img src="https://habrastorage.org/webt/2x/-5/s7/2x-5s7zzkdpr8vdacojgjcsayzy.jpeg"><br><br>  F√ºr Migrationen schreiben wir ein Python-Skript, das mit dem Backend kommunizieren kann.  Das Backend wiederum hat eine Verbindung zu allen unseren Basen und kann alle erforderlichen Operationen ausf√ºhren.  Das Skript wird √ºber das Skriptstart-Administrationsfenster gestartet. Anschlie√üend wird es ausgef√ºhrt. Das Protokoll und die Ergebnisse werden angezeigt.  Und wenn Sie langfristige Strahloperationen ben√∂tigen, k√∂nnen Sie nicht alles auf einmal aktualisieren. Sie m√ºssen dies mit Bl√∂cken von 1000-10000 mit einigen Pausen tun, um die Basis nicht versehentlich mit diesen Operationen zu versehen. <br><br><img src="https://habrastorage.org/webt/kc/tc/i4/kctci40g68ovk-1jywdr7is2h9u.jpeg"><br><br>  Wenn der Code geschrieben, √ºberpr√ºft, getestet und alle Migrationen ausgef√ºhrt wurden, k√∂nnen Sie ihn sicher in GitHub zusammenf√ºhren und weiter freigeben. <br><br>  F√ºr einige Dienste haben wir eine Regelung, nach der wir zu einem bestimmten Zeitpunkt einf√ºhren m√ºssen, aber einen wesentlichen Teil der Dienste k√∂nnen wir jederzeit einf√ºhren. <br><br>  Dies alles geschieht mit TeamCity. <br><br><img src="https://habrastorage.org/webt/uy/5q/hs/uy5qhsjjmwkjkdigex_wgykubfw.jpeg"><br><br>  Alles beginnt mit dem Erstellen von Paketen.  TeamCity macht Git Flow oder seinen Anschein.  Wir bewegen uns langsam vom Git-Flow weg zu unseren Best Practices, die wir f√ºr bequemer hielten.  TeamCity produziert all dies, sammelt Pakete und f√ºllt sie aus.  Wir warten weiter, bis die Tests diese Pakete weitergeben.  Zum Ausrollen der Version sind bestandene Tests erforderlich.  Wenn die Tests fehlschlagen, m√ºssen Sie zuerst herausfinden, was letztendlich schief gelaufen ist.  Die verwendeten Tests sind gleich, regelm√§√üig und integrativ.  Sie pr√ºfen das bereits montierte Paket, fertig, genau, was in Produktion gehen wird.  Dies ist nur f√ºr den Fall, pl√∂tzlich gibt es Probleme in der zusammengebauten Verpackung, pl√∂tzlich wird etwas nicht kopiert, pl√∂tzlich hat sich herausgestellt, dass etwas fehlt. <br><br>  Es ist auch erforderlich, dass wir ein Release-Ticket in unserem Tracker erstellen, in dem jeder Entwickler abbestellen muss, wie er diesen Code getestet hat, und das alle Aufgaben enthalten muss, die ausgef√ºhrt werden m√ºssen. <br><br>  Dies erfolgt auch automatisch in TeamCity, das die Liste der Commits durchl√§uft.  Wir haben die Anforderung, dass in jedem Commit ein Schl√ºsselwort "Relates" gefolgt vom Namen der Aufgabe enthalten sein muss.  Ein in Python geschriebenes Skript durchl√§uft all dies automatisch, erstellt eine Liste der gel√∂sten Aufgaben, erstellt eine Liste der Autoren und erstellt ein Release-Ticket. Alle Autoren werden aufgefordert, sich von ihren Tests abzumelden und zu best√§tigen, dass sie bereit sind, das Release zu "starten". <br><br><img src="https://habrastorage.org/webt/mz/hn/7t/mzhn7t86z09-ewjvhdyr-kvqr44.jpeg"><br><br>  Wenn alle bereit sind, werden Best√§tigungen gesammelt, und zuerst erfolgt die Einf√ºhrung - im Vorstall.  Dies ist ein kleiner Teil der Produktion.  F√ºr jeden Dienst werden mehrere Rechenzentren verwendet. In jedem Rechenzentrum k√∂nnen mehrere Maschinen vorhanden sein.  Eine der Maschinen ist vorstabil, und der Code wird zuerst nur auf einer oder mehreren Maschinen bereitgestellt. <br><br>  Wenn der Code entleert ist, folgen wir den Diagrammen, den Protokollen und dem, was am Ende des Dienstes passiert.  Wenn alles in Ordnung ist, wenn die Grafiken zeigen, dass alles stabil ist und jeder √ºberpr√ºft hat, ob seine Funktionalit√§t ordnungsgem√§√ü funktioniert, wird sie auf den Rest der Umgebung √ºbertragen, die wir als stabil bezeichnen.  Beim Ausrollen in den Stall ist alles gleich: Wir sehen uns die Diagramme und Protokolle an und pr√ºfen, ob bei uns alles in Ordnung ist. <br><br>  Der Rollout ist vorbei, alles ist in Ordnung.  Und wenn etwas schief gelaufen ist, wenn pl√∂tzlich Probleme? <br><br><img src="https://habrastorage.org/webt/9r/pd/qk/9rpdqkpeibqn-uud5knv1age12m.jpeg"><br><br>  Wir sammeln Hotfix.  Dies geschieht nach dem gleichen Prinzip wie bei git flow, dh einem Zweig vom Hauptzweig.  Vom Master wird eine separate Poolanforderung erstellt, die Korrekturen vornimmt. Das von TeamCity gestartete Skript friert sie ein, f√ºhrt alle erforderlichen Vorg√§nge aus, sammelt alle Pakete auf dieselbe Weise und rollt weiter. <br><br><img src="https://habrastorage.org/webt/jc/tq/ep/jctqep5zyjjh3cebljvmvqjoino.jpeg"><br><br>  Am Ende m√∂chte ich √ºber die Richtung sprechen, in die wir uns bewegen.  Wir bewegen uns in Richtung eines einzelnen Repositorys, wenn viele Dienste gleichzeitig in einem Repository gespeichert sind.  Jeder von ihnen hat unabh√§ngige Berechnungen: beim Testen, in Releases.  Bei Poolanfragen pr√ºfen wir auch bei Verwendung von TeamCity, welche Dateien betroffen waren und zu welchen Diensten sie geh√∂ren.  Gem√§√ü dem Abh√§ngigkeitsdiagramm bestimmen wir, welche Tests wir letztendlich ausf√ºhren m√ºssen und was zu √ºberpr√ºfen ist.  Wir streben eine maximale Isolation der Dienste voneinander an.  Bisher funktioniert es nicht sehr gut, aber wir bem√ºhen uns darum, dass viele Dienste in einem Repository gespeichert werden k√∂nnen, einen gemeinsamen Code haben und dies keine Probleme verursacht und das Entwicklungsleben vereinfacht.  Das ist alles, danke euch allen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439704/">https://habr.com/ru/post/de439704/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439692/index.html">AT & T wurde wegen √Ñnderung des Netzwerksymbols von 4G auf 5G E verklagt</a></li>
<li><a href="../de439694/index.html">Intelligentes Gewebe, das auf √Ñnderungen der K√∂rpertemperatur reagiert</a></li>
<li><a href="../de439696/index.html">Auf dem Wellenkamm oder "Ich will Mainstream" - aber lohnt es sich?</a></li>
<li><a href="../de439698/index.html">Einf√ºhrung in die Programmierung: Ein einfacher 3D-Shooter von Grund auf √ºber das Wochenende, Teil 1</a></li>
<li><a href="../de439700/index.html">Brettspielpatent in Russland</a></li>
<li><a href="../de439706/index.html">Konferenz BLACK HAT. Lehren aus dem √úberleben eines DDOS-Angriffs mit 300 Gbit / s. Teil 1</a></li>
<li><a href="../de439708/index.html">Konferenz BLACK HAT. Lehren aus dem √úberleben eines DDOS-Angriffs mit 300 Gbit / s. Teil 2</a></li>
<li><a href="../de439710/index.html">Merkmale der Erstellung von Produkten f√ºr den US-Markt</a></li>
<li><a href="../de439712/index.html">√ñffentliches Beschaffungswesen: das Gleichgewicht zwischen dem italienischen Streik und dem russischen Verbrecher</a></li>
<li><a href="../de439714/index.html">Russen bei Apple: Wie wir einen Vertrag √ºber Millionen mit Beatles und ‚Äûeinigen Jerry‚Äú -Liedern bekommen haben</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>