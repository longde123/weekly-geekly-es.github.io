<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òÉÔ∏è üö≥ üë©üèº‚Äçüöí Matem√°ticas en Gamedev es simple. Vectores e integrales ‚öìÔ∏è ü¶Å üêΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos! Hoy me gustar√≠a hablar de matem√°ticas. La matem√°tica es una ciencia muy interesante y puede ser muy √∫til cuando se desarrollan juegos y,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Matem√°ticas en Gamedev es simple. Vectores e integrales</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430146/"> Hola a todos!  Hoy me gustar√≠a hablar de matem√°ticas.  La matem√°tica es una ciencia muy interesante y puede ser muy √∫til cuando se desarrollan juegos y, de hecho, cuando se trabaja con gr√°ficos por computadora.  Muchos (especialmente los principiantes) simplemente no saben c√≥mo se usa en el desarrollo.  Hay muchos problemas que no requieren una comprensi√≥n profunda de conceptos tales como: integrales, n√∫meros complejos, grupos, anillos, etc., pero gracias a las matem√°ticas puedes resolver muchos problemas interesantes.  En este art√≠culo, consideramos vectores e integrales.  Si est√° interesado, bienvenido a cat.  Se adjunta el proyecto ilustrativo de Unity, como siempre. <br><br><img src="https://habrastorage.org/webt/si/-v/9f/si-v9fgzx1j01amuhr9eueauiie.jpeg"><br><a name="habracut"></a><br>  <b>Matem√°ticas vectoriales</b> <br><br>  Los vectores y las matem√°ticas vectoriales son herramientas esenciales para el desarrollo del juego.  Muchas operaciones y acciones est√°n vinculadas a √©l por completo.  Es curioso que para implementar una clase que muestra la flecha de un vector en Unity, ya haya tomado la mayor√≠a de las operaciones t√≠picas.  Si conoce bien las matem√°ticas vectoriales, este bloque no ser√° interesante para usted. <br><br>  <b>Aritm√©tica vectorial y funciones √∫tiles.</b> <br><br>  Las f√≥rmulas anal√≠ticas y otros detalles son f√°ciles de buscar en Google, por lo que no perderemos tiempo en esto.  Las operaciones en s√≠ se ilustrar√°n con animaciones gif a continuaci√≥n. <br><br>  <i>Es importante entender que cualquier punto en esencia es un vector con un comienzo en el punto cero.</i> <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Su navegador no admite video HTML5. <source src="https://media.giphy.com/media/cNIrQX8PrV1J62zzKJ/giphy.mp4" type="video/mp4"></video></div></div></div><br><br>  Los gifs se hicieron con Unity, por lo que ser√≠a necesario implementar una clase que sea responsable de representar las flechas.  Una flecha vectorial consta de tres componentes principales: una l√≠nea, una punta y un texto con el nombre de un vector.  Para dibujar una l√≠nea y una punta, utilic√© LineRenderer.  Veamos la clase del vector en s√≠: <br><br><div class="spoiler">  <b class="spoiler_title">Clase de flecha</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> TMPro; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">VectorArrow</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 _VectorStart; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 _VectorEnd; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> TextOffsetY; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TMP_Text _Label; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Color _Color; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> LineRenderer _Line; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _CupLength; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> LineRenderer _Cup; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnValidate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { UpdateVector(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateVector</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_Line == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || _Cup == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; SetColor(_Color); _Line.positionCount = _Cup.positionCount = <span class="hljs-number"><span class="hljs-number">2</span></span>; _Line.SetPosition(<span class="hljs-number"><span class="hljs-number">0</span></span>, _VectorStart); _Line.SetPosition(<span class="hljs-number"><span class="hljs-number">1</span></span>, _VectorEnd - (_VectorEnd - _VectorStart).normalized * _CupLength); _Cup.SetPosition(<span class="hljs-number"><span class="hljs-number">0</span></span>, _VectorEnd - (_VectorEnd - _VectorStart).normalized * _CupLength); _Cup.SetPosition(<span class="hljs-number"><span class="hljs-number">1</span></span>, _VectorEnd ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_Label != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dv = _VectorEnd - _VectorStart; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> normal = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(-dv.y, dv.x).normalized; normal = normal.y &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? normal : -normal; _Label.transform.localPosition = (_VectorEnd + _VectorStart) / <span class="hljs-number"><span class="hljs-number">2</span></span> + normal * TextOffsetY; _Label.transform.up = normal; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetPositions</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 start, Vector3 end</span></span></span><span class="hljs-function">)</span></span> { _VectorStart = start; _VectorEnd = end; UpdateVector(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetLabel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> label</span></span></span><span class="hljs-function">)</span></span> { _Label.text = label; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetColor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Color color</span></span></span><span class="hljs-function">)</span></span> { _Color = color; _Line.startColor = _Line.endColor = _Cup.startColor = _Cup.endColor = _Color; } }</code> </pre> <br></div></div><br>  Como queremos que el vector tenga una cierta longitud y se corresponda exactamente con los puntos que especificamos, la f√≥rmula calcula la longitud de la l√≠nea: <br><br><pre> <code class="cs hljs">_VectorEnd - (_VectorEnd - _VectorStart).normalized * _CupLength</code> </pre> <br>  En esta f√≥rmula <i>(_VectorEnd - _VectorStart) .normalized</i> es la direcci√≥n del vector.  Esto se puede entender a partir de la animaci√≥n con la diferencia de vectores, suponiendo que <i>_VectorEnd</i> y <i>_VectorStart</i> son vectores con un comienzo en (0,0,0). <br><br>  A continuaci√≥n, analizamos las dos operaciones b√°sicas restantes: <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Su navegador no admite video HTML5. <source src="https://media.giphy.com/media/ki8xgF72Ym8iLzByVS/giphy.mp4" type="video/mp4"></video></div></div></div><br>  Encontrar el normal (perpendicular) y el medio del vector son tareas muy comunes cuando se desarrollan juegos.  Analic√©moslos con el ejemplo de colocar una firma en un vector. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dv = _VectorEnd - _VectorStart; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> normal = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(-dv.y, dv.x).normalized; normal = normal.y &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? normal : -normal; _Label.transform.localPosition = (_VectorEnd + _VectorStart) / <span class="hljs-number"><span class="hljs-number">2</span></span> + normal * TextOffsetY; _Label.transform.up = normal;</code> </pre> <br>  Para colocar el texto perpendicular al vector, necesitamos una normal.  En gr√°ficos 2D, lo normal es bastante simple. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dv = _VectorEnd - _VectorStart; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> normal = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(-dv.y, dv.x).normalized;</code> </pre> <br>  Entonces tenemos lo normal en el segmento. <br><br>  normal = normal.y&gt; 0?  normal: normal  - esta operaci√≥n es responsable de garantizar que el texto siempre se muestre sobre el vector. <br><br>  Luego queda colocarlo en el medio del vector y elevarlo a una distancia que se ver√° hermosa. <br><br><pre> <code class="cs hljs">_Label.transform.localPosition = (_VectorEnd + _VectorStart) / <span class="hljs-number"><span class="hljs-number">2</span></span> + normal * TextOffsetY;</code> </pre> <br>  El c√≥digo usa posiciones locales para que pueda mover la flecha resultante. <br><br>  Pero se trataba de 2D, pero ¬øqu√© pasa con 3D? <br><br>  En 3D, m√°s o menos es lo mismo.  Solo la f√≥rmula normal difiere, ya que la normal ya no se lleva al segmento, sino al plano. <br><br><div class="spoiler">  <b class="spoiler_title">Gui√≥n para c√°mara</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SphereCameraController</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Camera _Camera; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _DistanceFromPlanet = <span class="hljs-number"><span class="hljs-number">10</span></span>; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> _Offset = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _IsMoving; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> Action&lt;Vector3, Vector3, Vector3, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>&gt; OnMove; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetMouseButtonDown(<span class="hljs-number"><span class="hljs-number">0</span></span>) &amp;&amp; !_IsMoving) { RaycastHit hit; Debug.Log(<span class="hljs-string"><span class="hljs-string">"Click"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ray = _Camera.ScreenPointToRay(Input.mousePosition); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Physics.Raycast(ray, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> hit)) { Debug.Log(<span class="hljs-string"><span class="hljs-string">"hit"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startPosition = _Camera.transform.position; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> right = Vector3.Cross(hit.normal, Vector3.up).normalized; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> endPosition = hit.point + hit.normal * _DistanceFromPlanet + right * _Offset; StartCoroutine(MoveCoroutine(startPosition, endPosition, hit.point + right * _Offset)); OnMove?.Invoke(startPosition, hit.point, hit.normal, _DistanceFromPlanet, _Offset); } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveCoroutine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 start, Vector3 end, Vector3 lookAt</span></span></span><span class="hljs-function">)</span></span> { _IsMoving = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startForward = transform.forward; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> timer = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (timer &lt; Scenario.AnimTime) { transform.position = Vector3.Slerp(start, end, timer / Scenario.AnimTime); transform.forward = Vector3.Slerp(startForward, (lookAt - transform.position).normalized, timer / Scenario.AnimTime); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; timer += Time.deltaTime; } transform.position = end; transform.forward = (lookAt - transform.position).normalized; _IsMoving = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre> <br></div></div><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Su navegador no admite video HTML5. <source src="https://media.giphy.com/media/bbB1tdbYPoWPKPH7tD/giphy.mp4" type="video/mp4"></video></div></div></div><br>  En este ejemplo de control, lo normal al plano se usa para desplazar el punto final de la trayectoria hacia la derecha para que la interfaz no bloquee el planeta.  Normal en gr√°ficos 3D es un producto vectorial normalizado de dos vectores.  Lo cual es conveniente, en Unity existen ambas operaciones y obtenemos un hermoso registro compacto: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> right = Vector3.Cross(hit.normal, Vector3.up).normalized;</code> </pre> <br>  Creo que para muchos que piensan que las matem√°ticas no son necesarias y por qu√© necesitan saberlas, ha quedado un poco m√°s claro qu√© problemas se pueden resolver de manera simple y elegante.  Pero era una opci√≥n simple que todo desarrollador de juegos no deber√≠a conocer como pasante.  Sube el list√≥n: habla de las integrales. <br><br>  <b>Integrales</b> <br><br>  En general, las integrales tienen muchas aplicaciones, como: simulaciones f√≠sicas, efectos visuales, an√°lisis y mucho m√°s.  No estoy listo para describir todo en detalle ahora.  Quiero describir una simple y visualmente comprensible.  Hablemos de f√≠sica. <br><br>  Supongamos que hay una tarea: mover un objeto a un cierto punto.  Por ejemplo, al ingresar a un cierto disparador, los libros de los estantes deber√≠an salir volando.  Si desea moverse de manera uniforme y sin f√≠sica, la tarea es trivial y no requiere integrales, pero cuando un fantasma empuja un libro de un estante, esa distribuci√≥n de velocidad se ver√° completamente diferente. <br><br>  ¬øQu√© es una integral? <br><br>  De hecho, esta es el √°rea bajo la curva.  Pero, ¬øqu√© significa esto en el contexto de la f√≠sica?  Supongamos que tiene una distribuci√≥n de velocidad en el tiempo.  En este caso, el √°rea debajo de la curva es el camino por el que pasar√° el objeto, y esto es exactamente lo que necesitamos. <br><br><img src="https://habrastorage.org/webt/v2/j1/fi/v2j1firdsma31y_gey3e6kmquok.png"><br><br>  Pasando de la teor√≠a a la pr√°ctica, Unity tiene una gran herramienta llamada AnimationCurve.  Al usarlo, puede especificar la distribuci√≥n de la velocidad en el tiempo.  Creemos una clase as√≠. <br><br><div class="spoiler">  <b class="spoiler_title">clase MoveObj</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; [RequireComponent(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Rigidbody))] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MoveObject</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Transform _Target; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GraphData _Data; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Rigidbody _Rigidbody; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _Rigidbody = GetComponent&lt;Rigidbody&gt;(); Move(<span class="hljs-number"><span class="hljs-number">2f</span></span>, _Data.AnimationCurve); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Move</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> time, AnimationCurve speedLaw</span></span></span><span class="hljs-function">)</span></span> { StartCoroutine(MovingCoroutine(time, speedLaw)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MovingCoroutine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> time, AnimationCurve speedLaw</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> timer = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dv = (_Target.position - transform.position); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> distance = dv.magnitude; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> direction = dv.normalized; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> speedK = distance / (Utils.GetApproxSquareAnimCurve(speedLaw) * time); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (timer &lt; time) { _Rigidbody.velocity = speedLaw.Evaluate(timer / time) * direction * speedK; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">yield</span></span></span><span class="hljs-function"> return new </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WaitForFixedUpdate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; timer += Time.fixedDeltaTime; } _Rigidbody.isKinematic = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } }</code> </pre> <br></div></div><br>  El m√©todo GetApproxSquareAnimCurve es nuestra integraci√≥n.  Lo convertimos en el m√©todo num√©rico m√°s simple, simplemente revise los valores de las funciones y sume un cierto n√∫mero de veces.  Configur√© 1000 para fidelidad, en general, puedes elegir el mejor. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Iterations = <span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetApproxSquareAnimCurve</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AnimationCurve curve</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> square = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt;= Iterations; i++) { square += curve.Evaluate((<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) i / Iterations); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> square / Iterations; }</code> </pre> <br>  Gracias a esta √°rea, ya sabemos cu√°l es la distancia relativa.  Y luego, al comparar los dos caminos recorridos, obtenemos el coeficiente de velocidad speedK, que es responsable de garantizar que recorremos la distancia dada. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Su navegador no admite video HTML5. <source src="https://media.giphy.com/media/yxfjOIjg8k9agGpCZ9/giphy.mp4" type="video/mp4"></video></div></div></div><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Su navegador no admite video HTML5. <source src="https://media.giphy.com/media/azI2ni7K6kwFr3LHDw/giphy.mp4" type="video/mp4"></video></div></div></div><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Su navegador no admite video HTML5. <source src="https://media.giphy.com/media/t8XCi5GR2uiat4vfQ4/giphy.mp4" type="video/mp4"></video></div></div></div><br>  Puede notar que los objetos no coinciden exactamente, esto se debe a un error flotante.  En general, puede recalcular lo mismo en decimal y luego adelantar en flotante para una mayor precisi√≥n. <br><br>  En realidad eso es todo por hoy.  Como siempre, al final hay un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace al proyecto GitHub</a> , en el que se encuentran todas las fuentes de este art√≠culo.  Y puedes jugar con ellos. <br><br>  Si aparece el art√≠culo, har√© una secuela en la que te contar√© sobre el uso de conceptos un poco m√°s complejos, como n√∫meros complejos, campos, grupos y m√°s. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es430146/">https://habr.com/ru/post/es430146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es430136/index.html">C√≥mo lanzar√°n Starlink: Internet satelital de Ilona Mask</a></li>
<li><a href="../es430138/index.html">Optimizar un robot comercial: un algoritmo gen√©tico</a></li>
<li><a href="../es430140/index.html">Cinco razones para el fracaso del SEO. An√°lisis de la experiencia de promoci√≥n fallida con ejemplos</a></li>
<li><a href="../es430142/index.html">¬øSu Windows es tan viejo?</a></li>
<li><a href="../es430144/index.html">Simulamos un r√≠o realista en Houdini y Unreal Engine 4</a></li>
<li><a href="../es430148/index.html">Fuga de datos personales de MFC de Mosc√∫</a></li>
<li><a href="../es430152/index.html">Poner su propio amplificador de audio profesional no es (muy) costoso</a></li>
<li><a href="../es430154/index.html">"Revival of AI" no es m√°s que hardware costoso y publicidad abandonada para implementar una vieja idea</a></li>
<li><a href="../es430156/index.html">"Despegue o no": aparecer√° un nuevo reproductor en el mercado de servicios de transmisi√≥n de video</a></li>
<li><a href="../es430158/index.html">10 mandamientos de seguridad que podr√≠an ser √∫tiles para cualquier organizaci√≥n</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>