<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§© üë≤ üéÖ Convergence avec Kubernetes ‚ôìÔ∏è üòª ‚ûï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Normalisation totale 


 J'ai pr√©par√© ce mat√©riel pour mon discours √† la conf√©rence et j'ai demand√© √† notre directeur technique quelle √©tait la princi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Convergence avec Kubernetes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/427441/"><h3 id="totalnaya-standartizaciya">  Normalisation totale </h3><br><p>  J'ai pr√©par√© ce mat√©riel pour mon discours √† la conf√©rence et j'ai demand√© √† notre directeur technique quelle √©tait la principale caract√©ristique de Kubernetes pour notre organisation.  Il a r√©pondu: </p><br><blockquote>  Les d√©veloppeurs eux-m√™mes ne comprennent pas combien de travail suppl√©mentaire ils ont accompli. </blockquote><p>  Apparemment, il a √©t√© inspir√© par le livre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Factfulness¬ª</a> r√©cemment lu - il est difficile de remarquer des changements mineurs et continus pour le mieux, et nous perdons constamment de vue nos progr√®s. </p><br><p>  Mais le passage √† Kubernetes n'est certainement pas insignifiant. </p><br><p><img src="https://habrastorage.org/webt/72/vu/bn/72vubnen7dnspn7tp9wmy2if9cu.png"></p><a name="habracut"></a><br><p> Pr√®s de 30 de nos √©quipes ex√©cutent tout ou partie des charges de travail sur les clusters.  Environ 70% de notre trafic HTTP est g√©n√©r√© par des applications sur des clusters Kubernetes.  Il s'agit probablement de la plus grande convergence de technologies depuis que j'ai rejoint l'entreprise apr√®s le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rachat de uSwitch</a> par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Forward</a> en 2010, lorsque nous sommes pass√©s de .NET et de serveurs physiques √† AWS et d'un syst√®me monolithique aux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">microservices</a> . </p><br><p>  Et tout s'est pass√© tr√®s rapidement.  Fin 2017, toutes les √©quipes utilisaient leur infrastructure AWS.  Ils ont mis en place des √©quilibreurs de charge, des instances EC2, des mises √† jour de cluster ECS et des trucs comme √ßa.  Un peu plus d'un an s'est √©coul√© et tout a chang√©. </p><br><p>  Nous avons pass√© un minimum de temps √† converger et, par cons√©quent, Kubernetes nous a aid√©s √† r√©soudre des probl√®mes urgents - notre cloud se d√©veloppait, l'organisation devenait plus compliqu√©e et nous pouvions √† peine int√©grer de nouvelles personnes dans les √©quipes.  Nous n'avons pas chang√© l'organisation pour utiliser Kubernetes.  Au contraire, nous avons utilis√© Kubernetes pour changer l'organisation. </p><br><p>  Les d√©veloppeurs n'ont peut-√™tre pas remarqu√© de grands changements, mais les donn√©es parlent d'elles-m√™mes.  Plus d'informations √† ce sujet plus tard. </p><br><hr><br><p>  Il y a de nombreuses ann√©es, j'√©tais √† une conf√©rence de Clojure et j'ai entendu une conf√©rence de Michael Nygard <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur l'architecture qui ne peut pas √™tre amen√©e √† son √©tat final</a> .  Il m'a ouvert les yeux.  Un syst√®me ordonn√© et ordonn√© semble caricatural lorsqu'il compare les magasins de t√©l√©vision aux produits de cuisine et √† l'architecture logicielle √† grande √©chelle - le syst√®me existant ressemble √† un couteau stupide, et une sorte de bouillie sort au lieu de tranches √©gales.  Sans un nouveau couteau, il n'y a rien √† penser √† la salade. </p><br><p>  Il s'agit de la fa√ßon dont les organisations adorent les projets sur trois ans: la premi√®re ann√©e est le d√©veloppement et la pr√©paration, la deuxi√®me ann√©e est la mise en ≈ìuvre, la troisi√®me est le retour.  Dans une conf√©rence, il dit que ces projets se font g√©n√©ralement en continu et arrivent rarement √† la fin de la deuxi√®me ann√©e (souvent en raison de l'acquisition par une autre entreprise et d'un changement de direction et de strat√©gie), donc l'architecture habituelle est </p><br><blockquote>  stratification du changement dans un semblant de stabilit√©. </blockquote><p>  Et uSwitch est un excellent exemple. </p><br><p>  Nous sommes pass√©s √† AWS pour de nombreuses raisons - notre syst√®me ne pouvait pas faire face aux pics de charge, et l'organisation √©tait entrav√©e par un syst√®me trop rigide et des √©quipes √©troitement li√©es form√©es pour des projets sp√©cifiques et divis√©es par sp√©cialisation. </p><br><p>  Nous n'allions pas tout quitter, transf√©rer tous les syst√®mes et recommencer.  Nous avons cr√©√© de nouveaux services avec proxy via l'√©quilibreur de charge existant et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©touff√© progressivement l'ancienne</a> application.  Nous voulions montrer imm√©diatement le retour et dans la premi√®re semaine nous avons effectu√© des tests A / B de la premi√®re version du nouveau service en production.  En cons√©quence, nous avons pris des produits √† long terme et avons commenc√© √† former des √©quipes pour eux de d√©veloppeurs, designers, analystes, etc. Et nous avons imm√©diatement vu le r√©sultat.  En 2010, cela semblait √™tre une v√©ritable r√©volution. </p><br><p>  Ann√©e apr√®s ann√©e, nous avons ajout√© de nouvelles √©quipes, de nouveaux services et applications et ¬´√©trangl√©¬ª progressivement le syst√®me monolithique.  Les √©quipes ont progress√© rapidement - maintenant, elles travaillent ind√©pendamment les unes des autres et se composent de sp√©cialistes dans tous les domaines n√©cessaires.  Nous avons minimis√© les interactions d'√©quipe pour les versions de produits.  Nous avons allou√© plusieurs commandes uniquement pour la configuration de l'√©quilibreur de charge. </p><br><p>  Les √©quipes elles-m√™mes ont choisi des m√©thodes de d√©veloppement, des outils et des langages.  Nous leur avons assign√© une t√¢che, et ils ont eux-m√™mes trouv√© une solution, car ils √©taient les mieux inform√©s en la mati√®re.  Avec AWS, ces changements sont devenus plus faciles. </p><br><p>  Nous avons intuitivement suivi les principes de la programmation - les √©quipes qui sont peu connect√©es les unes aux autres seront moins susceptibles de communiquer et nous n'aurons pas √† d√©penser de pr√©cieuses ressources pour coordonner leur travail.  Tout cela est tr√®s bien d√©crit dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">livre</a> r√©cemment publi√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Accelerate</a> . </p><br><p>  En cons√©quence, comme Michael Nygard l'a d√©crit, nous avons obtenu un syst√®me de plusieurs couches de changements - certains syst√®mes ont √©t√© automatis√©s avec Puppet, certains avec Terraform, quelque part nous avons utilis√© ECS, quelque part EC2. </p><br><p>  En 2012, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nous √©tions fiers de notre architecture, qui pouvait √™tre facilement modifi√©e pour exp√©rimenter</a> , trouver des solutions r√©ussies et les d√©velopper. </p><br><p>  Mais en 2017, nous avons r√©alis√© que beaucoup de choses avaient chang√©. </p><br><hr><br><p>  AWS est d√©sormais beaucoup plus complexe qu'en 2010. Il offre une tonne d'options et de fonctionnalit√©s, mais non sans cons√©quences.  Aujourd'hui, toute √©quipe qui travaille avec EC2 doit choisir un VPC, une configuration r√©seau et bien plus encore. </p><br><p>  Nous l'avons v√©cu par nous-m√™mes - les √©quipes ont commenc√© √† se plaindre qu'elles consacraient de plus en plus de temps √† la maintenance de l'infrastructure, par exemple, la mise √† jour des instances <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans les clusters AWS ECS</a> , les machines EC2, le passage des √©quilibreurs ELB √† ALB, etc. </p><br><p>  Mi-2017, lors d'un √©v√©nement d'entreprise, j'ai exhort√© chacun √† standardiser son travail afin d'am√©liorer la qualit√© globale des syst√®mes.  J'ai utilis√© la m√©taphore de l'iceberg hackneyed pour montrer comment nous cr√©ons et maintenons le logiciel: </p><br><p><img src="https://habrastorage.org/webt/sn/ci/pt/sncipt6axzuuqa2pcqxrpbcwzh0.png"></p><br><p>  J'ai dit que la plupart des √©quipes de notre entreprise devraient cr√©er des services ou des produits et se concentrer sur la r√©solution de probl√®mes, le code d'application, les plates-formes et les biblioth√®ques, etc. Dans cet ordre.  Beaucoup de travail reste sous l'eau - int√©gration des journaux, augmentation de l'observabilit√©, gestion des secrets, etc. </p><br><p>  √Ä cette √©poque, chaque √©quipe de d√©veloppeurs d'applications a g√©r√© la quasi-totalit√© de l'iceberg et a pris toutes les d√©cisions par elle-m√™me - en choisissant le langage, l'environnement de d√©veloppement, la biblioth√®que et l'outil de m√©triques, le syst√®me d'exploitation, le type d'instance, le stockage. </p><br><p>  √Ä la base de la pyramide, nous avions une infrastructure Amazon Web Services.  Mais tous les services AWS ne sont pas identiques.  Ils ont un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Backend-as-a-Service (BaaS)</a> , par exemple pour l'authentification et le stockage des donn√©es.  Et il existe d'autres services de niveau relativement bas, comme EC2.  Je voulais √©tudier les donn√©es et comprendre que les √©quipes ont des raisons de se plaindre et qu'elles passent vraiment plus de temps √† travailler avec des services de bas niveau et prennent beaucoup de d√©cisions pas les plus importantes. </p><br><p>  J'ai divis√© les services en cat√©gories, en utilisant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CloudTrail, j'ai</a> collect√© toutes les statistiques disponibles, puis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">j'ai</a> utilis√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BigQuery</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Athena</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ggplot2</a> pour voir comment la situation des d√©veloppeurs a chang√© r√©cemment.  Une croissance pour des services tels que RDS, Redshift, etc., que nous consid√©rons souhaitable (et attendue), et une croissance pour EC2, CloudFormation, etc. - au contraire. </p><br><p><img src="https://habrastorage.org/webt/dd/bd/-f/ddbd-fy5t4wzicbekukgyx_lji0.png"></p><br><p>  Chaque point du diagramme montre les 90e (rouge), 80e (vert) et 50e (bleu) centiles pour le nombre de <strong>services</strong> de <strong>bas niveau</strong> que nos employ√©s ont utilis√©s chaque semaine pendant une certaine p√©riode.  J'ai ajout√© des lignes de lissage pour montrer la tendance. </p><br><p>  Bien que nous ayons vis√© des abstractions de niveau sup√©rieur lors du d√©ploiement de logiciels, par exemple √† l'aide de conteneurs et d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Amazon ECS</a> , nos d√©veloppeurs ont r√©guli√®rement utilis√© de plus en plus de services AWS et n'ont pas suffisamment ignor√© les difficult√©s de gestion des syst√®mes.  En deux ans, le nombre de services a doubl√© pour 50% des salari√©s et presque tripl√© pour 20%. </p><br><p>  Cela a limit√© la croissance de notre entreprise.  Les √©quipes ont cherch√© l'autonomie, mais comment embaucher de nouvelles personnes?  Nous avions besoin de d√©veloppeurs d'applications et de produits solides et d'une connaissance du syst√®me AWS de plus en plus sophistiqu√©. </p><br><hr><br><p>  Nous voulions √©largir nos √©quipes et en m√™me temps pr√©server les principes avec lesquels nous avons r√©ussi: autonomie, coordination minimale et infrastructure libre-service. </p><br><p>  Avec Kubernetes, nous avons accompli cela avec des abstractions ax√©es sur les applications et la possibilit√© de maintenir et de configurer des clusters avec une coordination d'√©quipe minimale. </p><br><h3 id="abstrakcii-s-fokusom-na-prilozheniya">  Abstractions ax√©es sur l'application </h3><br><p>  Les concepts de Kubernetes sont faciles √† associer au langage utilis√© par le d√©veloppeur d'applications.  Supposons que vous g√©rez des versions d'application en tant que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©ploiement</a> .  Vous pouvez ex√©cuter plusieurs r√©pliques derri√®re le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">service</a> et les mapper √† HTTP via <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ingress</a> .  Et gr√¢ce aux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ressources utilisateur,</a> vous pouvez √©tendre et sp√©cialiser cette langue en fonction de vos besoins. </p><br><p>  Les √©quipes travaillent plus efficacement avec ces abstractions.  Fondamentalement, cet exemple contient tout ce dont vous avez besoin pour d√©ployer et ex√©cuter une application Web.  Le reste est Kubernetes. </p><br><p>  Dans l'image avec l'iceberg, ces concepts sont au niveau de l'eau et combinent les t√¢ches du d√©veloppeur d'en haut avec la plate-forme ci-dessous.  L'√©quipe de gestion du cluster peut prendre des d√©cisions de bas niveau et insignifiantes (concernant la gestion des m√©triques, la journalisation, etc.) et en m√™me temps parler le m√™me langage avec les d√©veloppeurs au-dessus de l'eau. </p><br><p>  En 2010, uSwitch avait des √©quipes traditionnelles pour la maintenance d'un syst√®me monolithique, et plus r√©cemment, nous avions un service informatique qui g√©rait partiellement notre compte AWS.  Il me semble que le manque de concepts communs a s√©rieusement entrav√© le travail de cette √©quipe. </p><br><p>  Essayez de dire quelque chose d'utile si vous n'avez que des instances EC2 dans votre vocabulaire, des √©quilibreurs de charge et des sous-r√©seaux.  Il √©tait difficile, voire impossible, de d√©crire l'essence de la demande.  Il peut s'agir d'un paquet Debian, d'un d√©ploiement via Capistrano, etc.  Nous n'avons pas pu d√©crire l'application dans une langue commune √† tous. </p><br><p>  Au d√©but des ann√©es 2000, j'ai travaill√© chez ThoughtWorks √† Londres.  Lors de l'entrevue, on m'a conseill√© de lire la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">conception ax√©e sur les probl√®mes d'</a> Eric Evans.  J'ai achet√© un livre sur le chemin du retour et j'ai commenc√© √† lire dans le train.  Depuis lors, je me souviens d'elle dans presque tous les projets et syst√®mes. </p><br><p>  L'un des principaux concepts du livre est une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">langue unique</a> dans laquelle diff√©rentes √©quipes communiquent.  Kubernetes fournit simplement un tel langage unifi√© aux d√©veloppeurs et aux √©quipes de maintenance des infrastructures, et c'est l'un de ses principaux avantages.  De plus, il peut √™tre √©tendu et compl√©t√© par d'autres domaines et secteurs d'activit√©. </p><br><p>  La communication dans un langage commun est plus productive, mais nous devons quand m√™me limiter autant que possible l'interaction entre les √©quipes. </p><br><h3 id="neobhodimyy-minimum-vzaimodeystviya">  Minimum d'interaction n√©cessaire </h3><br><p>  Les auteurs d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Accelerate</a> mettent en √©vidence les caract√©ristiques d'une architecture faiblement coupl√©e avec laquelle les √©quipes informatiques travaillent plus efficacement: </p><br><blockquote>  En 2017, le succ√®s de la livraison continue d√©pendait de la capacit√© de l'√©quipe √†: <br>  Changez s√©rieusement la structure de votre syst√®me sans l'autorisation de la direction. <br>  Changez s√©rieusement la structure de votre syst√®me, sans attendre que les autres √©quipes changent la leur, et sans cr√©er beaucoup de travail inutile pour les autres √©quipes. <br>  Effectuer leurs t√¢ches sans communiquer ni coordonner leur travail avec les autres √©quipes. <br>  D√©ployez et publiez un produit ou un service √† la demande, quels que soient les autres services qui lui sont associ√©s. <br>  Faites la plupart des tests √† la demande, sans environnement de test int√©gr√©. </blockquote><p>  Nous avions besoin de grappes logicielles multi-locataires centralis√©es pour toutes les √©quipes, mais en m√™me temps, nous voulions maintenir ces caract√©ristiques.  Nous n'avons pas encore atteint l'id√©al, mais nous essayons du mieux que nous pouvons: </p><br><ul><li>  Nous avons plusieurs clusters de travail, et les √©quipes choisissent elles-m√™mes o√π ex√©cuter l'application.  Nous n'utilisons pas encore la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">f√©d√©ration</a> (nous attendons la prise en charge d'AWS), mais nous avons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Envoy</a> pour l'√©quilibrage de charge sur les √©quilibreurs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ingress</a> dans diff√©rents clusters.  Nous automatisons la plupart de ces t√¢ches √† l'aide du pipeline de livraison continue (nous avons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Drone</a> ) et d'autres services AWS. </li><li>  Tous les clusters ont le m√™me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">espace de noms</a> .  Environ un pour chaque √©quipe. </li><li>  Nous contr√¥lons l'acc√®s aux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">espaces</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">noms</a> via <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RBAC</a> (contr√¥le d'acc√®s bas√© sur les r√¥les).  Pour l'authentification et l'autorisation, nous utilisons l'identit√© d'entreprise dans Active Directory. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les clusters √©voluent automatiquement</a> et nous faisons de notre mieux pour optimiser le temps de d√©marrage du n≈ìud.  Cela prend encore quelques minutes, mais, en g√©n√©ral, m√™me avec de grandes charges de travail, nous faisons sans coordination. </li><li>  Les applications √©voluent automatiquement en fonction des mesures au niveau de l'application de Prometheus.  Les √©quipes de d√©veloppement contr√¥lent la mise √† l'√©chelle automatique de leur application par des m√©triques de requ√™te par seconde, des op√©rations par seconde, etc. Gr√¢ce √† la mise √† l'√©chelle automatique du cluster, le syst√®me pr√©pare les n≈ìuds lorsque la demande d√©passe les capacit√©s du cluster actuel. </li><li>  Nous avons √©crit Go avec un outil en ligne de commande appel√© <strong>u</strong> qui standardise l'authentification des commandes dans Kubernetes, utilise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vault</a> , les demandes d'informations d'identification AWS temporaires, etc. </li></ul><br><p><img src="https://habrastorage.org/webt/oy/qv/bm/oyqvbm7x1orfe2kpjxubpis6r60.png"></p><br><p>  Je ne suis pas s√ªr qu'avec Kubernetes nous ayons plus d'autonomie, mais il est d√©finitivement rest√© √† un niveau √©lev√©, et en m√™me temps nous nous sommes d√©barrass√©s de certains probl√®mes. </p><br><hr><br><p>  Le passage √† Kubernetes a √©t√© rapide.  Le diagramme montre le nombre total <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d'espaces de noms</a> (approximativement √©gal au nombre de commandes) dans nos clusters de travail.  Le premier est apparu en f√©vrier 2017. </p><br><p><img src="https://habrastorage.org/webt/ux/y_/q_/uxy_q_hravmwkjhead1bgzkspz4.png"></p><br><p>  Nous avions des raisons de nous pr√©cipiter - nous voulions √©viter que les petites √©quipes focalis√©es sur leur produit ne se soucient de l'infrastructure. </p><br><p>  La premi√®re √©quipe a accept√© de passer √† Kubernetes lorsque leur serveur d'applications a manqu√© d'espace en raison de param√®tres de rotation du journal incorrects.  La transition n'a pris que quelques jours et ils se sont de nouveau mis au travail. </p><br><p>  R√©cemment, les √©quipes sont pass√©es √† Kubetnetes pour des outils am√©lior√©s.  Les clusters Kubernetes simplifient l'int√©gration avec notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Hashicorp Vault</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Google Cloud Trace</a> et des outils similaires.  <em>Toutes</em> nos √©quipes b√©n√©ficient de fonctionnalit√©s encore plus efficaces. </p><br><hr><br><p>  J'ai d√©j√† montr√© un graphique avec des centiles du nombre de services que nos employ√©s ont utilis√©s chaque semaine de la fin de 2014 √† 2017.  Et voici une suite de ce diagramme √† ce jour. </p><br><p><img src="https://habrastorage.org/webt/o7/fa/mu/o7famum8vaa0uuuw5e2ynah0-ay.png"></p><br><p>  Nous avons progress√© dans la gestion du cadre AWS complexe.  Je suis heureux que maintenant la moiti√© des employ√©s fassent la m√™me chose qu'au d√©but de 2015.  Nous avons 4 √† 6 employ√©s dans l'√©quipe de cloud computing, quelque part autour de 10% du nombre total - il n'est pas surprenant que le 90e centile n'ait presque pas boug√©.  Mais j'esp√®re que des progr√®s ici aussi. </p><br><p>  Enfin, je vais parler de la fa√ßon dont notre cycle de d√©veloppement a chang√©, et encore une fois rappeler le livre Accelerate r√©cemment lu. </p><br><p>  Le livre mentionne deux mesures de d√©veloppement all√©g√©es: le d√©lai d'ex√©cution et la taille du package.  Le d√©lai est pris en compte de la demande √† la livraison de la solution finie.  La taille de l'emballage est la quantit√© de travail.  Plus la taille de l'emballage est petite, plus le travail est efficace: </p><br><blockquote>  Plus l'emballage est petit, plus le cycle de production est court, moins la variabilit√© du processus, moins de risques, de co√ªts et de co√ªts, nous obtenons des commentaires plus rapidement, travaillons plus efficacement, nous avons plus de motivation, nous essayons de terminer plus rapidement et de reporter la livraison moins souvent. </blockquote><p>  Le livre sugg√®re de mesurer la taille des paquets par fr√©quence de d√©ploiement - plus le d√©ploiement est fr√©quent, plus les paquets sont petits. </p><br><p>  Nous avons des donn√©es pour <em>certains</em> d√©ploiements.  Les donn√©es ne sont pas tout √† fait exactes - certaines √©quipes envoient des versions directement √† la branche principale du r√©f√©rentiel, d'autres utilisent d'autres m√©canismes.  Cela ne comprend pas toutes les demandes, mais les donn√©es sur 12 mois peuvent √™tre consid√©r√©es comme indicatives. </p><br><p><img src="https://habrastorage.org/webt/dt/vt/53/dtvt53s-2o7-w9rs-7qx6dhnydc.png"></p><br><p>  L'√©chec de la trenti√®me semaine est No√´l.  Pour le reste, nous voyons que la fr√©quence de d√©ploiement augmente, ce qui signifie que la taille des paquets diminue.  De mars √† mai 2018, la fr√©quence des sorties a presque doubl√©, et r√©cemment nous faisons parfois plus d'une centaine de num√©ros par jour. </p><br><p>  Le passage √† Kubernetes n'est qu'une partie de notre strat√©gie de standardisation, d'automatisation et d'am√©lioration des outils.  Tr√®s probablement, tous ces facteurs ont influenc√© la fr√©quence des rejets. </p><br><p>  Accelerate parle √©galement de la relation entre la fr√©quence de d√©ploiement et le nombre d'employ√©s, et de la rapidit√© avec laquelle une entreprise peut travailler si le personnel est augment√©.  Les auteurs soulignent les limites de l'architecture et des √©quipes associ√©es: </p><br><blockquote>  On pense traditionnellement que l'expansion d'une √©quipe augmente la productivit√© globale, mais diminue la productivit√© des d√©veloppeurs individuels. </blockquote><p>  Si nous prenons les m√™mes donn√©es sur la fr√©quence des d√©ploiements et faisons un diagramme de la d√©pendance au nombre d'utilisateurs, nous pouvons voir que nous pouvons augmenter la fr√©quence des versions, m√™me si nous avons plus de personnes. </p><br><p><img src="https://habrastorage.org/webt/xc/ti/xf/xctixfjqbqgkbdooamerhtg3d_e.png"></p><br><p>  Au d√©but de l'article, j'ai mentionn√© le livre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Factfulness</a> (qui a inspir√© notre CTO).  La transition vers Kubernetes est devenue pour nos d√©veloppeurs la convergence technologique la plus importante et la plus rapide.  Nous progressons par petites √©tapes, et il est facile de ne pas remarquer √† quel point tout a chang√© pour le mieux.  C'est bien que nous ayons des donn√©es, et elles montrent que nous avons r√©alis√© ce que nous voulons - nos employ√©s sont engag√©s dans leur produit et prennent des d√©cisions importantes dans leur domaine. </p><br><p>  Avant, c'√©tait bon pour nous.  Nous avions des microservices, AWS, des √©quipes bien √©tablies pour les produits, des d√©veloppeurs responsables de leurs services en production, des √©quipes et une architecture faiblement coupl√©es.  J'en ai parl√© dans le rapport <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Notre √¢ge des Lumi√®res¬ª</a> (¬´Notre √¢ge des Lumi√®res¬ª) lors d'une conf√©rence en 2012.  Mais il n'y a pas de limite √† la perfection. </p><br><p>  En fin de compte, je veux citer un autre livre - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Scale</a> .  Je l'ai commenc√© r√©cemment et il y a un fragment int√©ressant sur la consommation d'√©nergie dans les syst√®mes complexes: </p><br><blockquote>  Pour maintenir l'ordre et la structure dans un syst√®me en d√©veloppement, un apport constant d'√©nergie est n√©cessaire et cr√©e un d√©sordre.  Par cons√©quent, pour maintenir la vie, nous devons manger tout le temps afin de vaincre l'entropie in√©vitable. <br>  Nous combattons l'entropie en fournissant plus d'√©nergie pour la croissance, l'innovation, l'entretien et la r√©paration, ce qui devient plus difficile avec le vieillissement du syst√®me, et cette bataille est la base de toute discussion s√©rieuse sur le vieillissement, la mortalit√©, la durabilit√© et l'autosuffisance de tout syst√®me, qu'il s'agisse d'un organisme vivant , entreprise ou soci√©t√©. </blockquote><p>  Je pense que vous pouvez ajouter des syst√®mes informatiques ici.  J'esp√®re que nos derniers efforts garderont l'entropie m√™me pendant un certain temps. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr427441/">https://habr.com/ru/post/fr427441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr427431/index.html">Fonctionnement d'Android, partie 4</a></li>
<li><a href="../fr427433/index.html">√âquilibrage du trafic dans les r√©seaux IP de l'op√©rateur</a></li>
<li><a href="../fr427435/index.html">STM32H7 - r√©glage de l'horloge sans HAL</a></li>
<li><a href="../fr427437/index.html">Configuration des serveurs li√©s: serveur sql ms et teradata</a></li>
<li><a href="../fr427439/index.html">Toute la v√©rit√© sur RTOS. Article # 16. Signaux</a></li>
<li><a href="../fr427443/index.html">Vivisection du succ√®s</a></li>
<li><a href="../fr427447/index.html">PVS-Studio prend en charge la cha√Æne d'outils int√©gr√©e GNU Arm</a></li>
<li><a href="../fr427449/index.html">Comment comprendre Tensorflow et ne pas mourir, et m√™me enseigner quelque chose sur une voiture</a></li>
<li><a href="../fr427451/index.html">Connectez les t√¢ches phpStorm √† Bitrix24</a></li>
<li><a href="../fr427453/index.html">Comment j'ai fait la transmission du son sur le Raspberry Pi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>