<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🏫 🧔🏾 🦌 Mengapa Windows membaca satu file seratus ribu kali untuk membuka menu? 👂🏽 👩🏻‍⚕️ 👨🏾‍⚕️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="“Explorer menghabiskan 700 ms untuk membuka menu konteks pada taskbar. 75% dari waktu ini, ia melakukan operasi baca 114.801 dari satu file, jumlah ra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mengapa Windows membaca satu file seratus ribu kali untuk membuka menu?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466941/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ch/_4/cr/ch_4crxmyunnytvqypom95isxzu.png"></div><br>  <i>“Explorer menghabiskan 700 ms untuk membuka menu konteks pada taskbar.</i>  <i>75% dari waktu ini, ia melakukan operasi baca 114.801 dari satu file, jumlah rata-rata data yang dibaca adalah 68 byte.</i> <i><br><br></i>  <i>Haruskah saya menulis posting tentang ini, atau tweet yang agak sarkastik? "</i> <br><br>  Saya bekerja dengan cepat di komputer, dan karena itu mengganggu saya ketika saya harus menunggu selesainya operasi yang harus dilakukan secara instan.  Rintangan terus-menerus pada laptop tugas berat saya di rumah adalah penutupan windows yang lambat pada taskbar.  Saya klik kanan pada ikon, tunggu menu untuk membuka, dan kemudian pilih "Tutup Jendela".  Yang paling lambat dalam proses ini adalah gerakan mouse, tetapi ternyata komponen terpanjang adalah penundaan sebelum menu muncul. <br><br>  Ini mengganggu saya untuk waktu yang lama, tetapi saya menunjukkan kontrol diri yang tidak seperti biasanya dan menjaga diri saya dari iritasi.  Itu sampai hari ini, ketika saya akhirnya mematahkan dan meraih pelacak <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ETW</a> . <br><br><blockquote>  Posting ini ditulis sebagai cek untuk blogging cepat.  Sekitar 90 menit berlalu dari saat masalah ditemukan dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tweet sarkastik</a> tentang hal itu sampai posting diterbitkan. </blockquote><a name="habracut"></a><br>  Pelacak ETW memperbaiki cara saya mengklik kanan pada taskbar dan menutup dua jendela Explorer.  Saya menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">UIforETW</a> <em>Tracing untuk</em> fungsi <em>file</em> dengan opsi default, menghasilkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">log diagnostik 20,9 MB</a> . <br><br>  Terkadang bagian yang paling sulit dalam menganalisis jejak adalah menemukan lokasi masalahnya, tetapi dalam kasus ini bagian analisisnya sepele.  Ada tiga tanda yang jelas yang menunjukkan tempat yang tepat, dan penyebab kejahatan yang sangat menyakitkan. <br><br>  Sinyal pertama adalah peristiwa input.  UIforETW berisi <a href="">input logger</a> terintegrasi (cukup anonim sehingga saya tidak sengaja mencuri kata sandi atau informasi pribadi), jadi saya hanya perlu mempelajari peristiwa <em>MouseUp</em> dan <em>Button Type</em> secara terperinci dengan nilai 2 sesuai dengan tombol kanan mouse.  Pada saat yang sama, tanda pada garis waktu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">WPA</a> muncul ketika peristiwa ini terjadi - lihat garis vertikal pada tangkapan layar: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/473/260/dfb/473260dfbe7feb356779ba3856bd0200.png"></div><br>  Ini menjelaskan kepada saya bahwa ketika saya melepaskan tombol mouse kanan, maka setelah 600 ms perubahan jendela berubah, yang, menurut pendapat saya, sesuai dengan saat menu ditampilkan.  Selain itu, RuntimeBroker.exe memiliki blok yang jelas dari aktivitas CPU antara peristiwa melepaskan tombol mouse dan mengubah fokus jendela. <br><br>  <em>Belum terbukti</em> bahwa perubahan fokus jendela dan aktivitas CPU saling terkait, tetapi setelah melakukan pengukuran menggunakan aplikasi perekaman layar, saya melihat bahwa dibutuhkan sekitar 660 ms untuk menampilkan menu, jadi saya cenderung mempercayai ini. <br><br>  Langkah selanjutnya adalah mempelajari apa yang dilakukan RuntimeBroker.exe.  Meskipun <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Penggunaan CPU (Tepat)</a> membantu Anda untuk melihat berapa banyak waktu CPU menggunakan proses dan mengapa itu menganggur, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tabel Penggunaan CPU (Sampel)</a> adalah alat yang baik untuk mengetahui berapa waktu CPU dihabiskan.  Saya hati-hati mempelajarinya dan dengan cepat menemukan bahwa 264 sampel berasal dari <em>KernelBase.dll! ReadFile</em> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/af9/b29/3fb/af9b293fbc60d45984d282de5c7ac571.png"></div><br>  Setelah mencari sedikit lebih banyak, saya menemukan tumpukan panggilan lain yang juga mempengaruhi fungsi ini, jadi saya klik kanan dan pilih <em>View Callers-&gt; By Function</em> .  Mode yang dihidupkan (dengan tumpukan terbalik) menunjukkan bahwa dari 899 sampel proses ini, 628 sampel, atau 70%, dari tumpukan panggilan berbeda melewati fungsi ini: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/027/118/5ee/0271185ee13e7aa4eafdb84921bbde1f.png"></div><br>  271 sampel dalam aliran ini tidak melewati fungsi, dan sampel yang tersisa (tidak ditampilkan) berada di aliran lain. <br><br>  Perhatikan bahwa 899 sampel dalam aliran 10 252 mewakili dua klik mouse, yaitu sekitar 450 sampel atau 450 ms (pada frekuensi sampling standar 1 kHz) per klik mouse. <br><br><h2>  Terkadang file I / O adalah waktu CPU </h2><br>  Penggunaan CPU (Sampel) menunjukkan waktu <em>CPU</em> , jadi disk I / O biasanya tidak ditampilkan di sini, karena pada saat ini aliran tertidur dan menunggu disk.  Fakta bahwa operasi I / O ditampilkan sebagai waktu CPU berarti bahwa semua pembacaan jatuh pada cache sistem dan waktu CPU adalah sumber daya kernel tambahan (lihat <em>ntoskrnl.exe</em> dalam tumpukan panggilan sampel pertama) yang dihabiskan untuk mendapatkan data dari cache. <br><br>  Sekarang <em>file I / O telah</em> dicurigai, kita harus pergi ke <em>Graph Explorer-&gt; Storage-&gt; File I / O.</em>  Setelah sedikit menyesuaikan tampilan kolom, kami mendapat hasil mengesankan berikut: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3a6/778/c22/3a6778c22693377d8954494d5714c3b3.png"></div><br>
  ,    10 252     <em>RuntimeBroker.exe</em>  229 604  <em>ReadFile</em>,    15 686 586 .         68 .<br>
<br>
    .<br>
<br>
 ,       —  .  ,   <em>RuntimeBroker.exe</em>     .         4 027 904 ,    ,         ,   1,9      .<br>
<br>
  ,              .     ,        (   ):<br>
<br>
<code>%appdata%\Microsoft\Windows\Recent\AutomaticDestinations\f01b4d95cf55d32a.automaticDestinations-ms</code><br>
<br>
        WPA.    —     ,         .               :<br>
<br>
<div style="text-align:center;"><img width="654" height="145" alt="Image" src="https://habrastorage.org/getpro/habr/post_images/6e7/f9c/edd/6e7f9cedde92e2f54da11fd5858b26e5.png"></div><br>
  «     „“,   ( )   (  )     „“/ .     ,   ». <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">, </a>!<br>
<br>
,     .       ,        ,       ,     .<br>
<br>
<h2> </h2><br>
<ul>
<li>  ReadFile,   68 . ,   ,      .  ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">     4 </a>,     <em></em>.</li>
<li>, -   ,        —   .</li>
<li>, -     ,     . ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">  ETW</a>   !</li>
<li>      <a title="https://aka.ms/AA60dfg" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://aka.ms/AA60dfg</a></li>
<li>      ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">UIforETW</a>   ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a></li>
<li> ,        ( ,     ),  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">shift+    </a>.     ,      .</li>
<li>  Hacker news  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a></li>
<li>  Reddit  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a></li>
<li>  Twitter  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a></li>
</ul></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id466941/">https://habr.com/ru/post/id466941/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id466925/index.html">Bagaimana menjalankan VDS Hi-CPU untuk Bitrix, bubarkan burung beo dan jangan sampai bangkrut</a></li>
<li><a href="../id466929/index.html">Tambahkan Segarkan Token</a></li>
<li><a href="../id466931/index.html">Optimalisasi Kinerja untuk Aplikasi .NET (C #)</a></li>
<li><a href="../id466933/index.html">Cara berteman industri dan data besar</a></li>
<li><a href="../id466937/index.html">Bagaimana kami melakukan Olimpiade online All-Rusia dalam bahasa Inggris, matematika, dan ilmu komputer</a></li>
<li><a href="../id466949/index.html">Prospek untuk jaringan kuantum: siapa yang terlibat di dalamnya dan mengapa</a></li>
<li><a href="../id466955/index.html">Teka-teki resume. Bagian 3. Tabir rahasia dihapus</a></li>
<li><a href="../id466957/index.html">iPhone 11, iPad baru, TV +, Arcade, dan lainnya. Apa yang ditunjukkan Apple hari ini</a></li>
<li><a href="../id466963/index.html">Habrastatistics: bagaimana Habr hidup tanpa geektimes</a></li>
<li><a href="../id466965/index.html">Presentasi Apple 10 September 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>