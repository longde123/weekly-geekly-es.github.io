<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤³ğŸ½ ğŸ„ ğŸ•‰ï¸ OpenSceneGraphï¼šä¸Qtæ¡†æ¶é›†æˆ ğŸ¥™ ğŸ¤œğŸ» ğŸ´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¼•è¨€ 
 ä¸€æ–¹é¢ï¼ŒOpenSceneGraphå¼•æ“æœ¬èº«å…·æœ‰é«˜çº§å­ç³»ç»Ÿï¼Œç”¨äºç®¡ç†çª—å£ï¼Œå¤„ç†ç”¨æˆ·è¾“å…¥äº‹ä»¶ï¼Œå‘é€å’Œæ¥æ”¶ç”¨æˆ·æ¶ˆæ¯ã€‚ æˆ‘ä»¬åœ¨æœ¬ç³»åˆ—çš„å‰å‡ ç¯‡æ–‡ç« ä¸­å¯¹æ­¤è¿›è¡Œäº†è¯¦ç»†è®¨è®ºã€‚ é€šå¸¸ï¼Œå†åŠ ä¸ŠC ++ / STLçš„åŠŸèƒ½ï¼Œè¿™å¯¹äºå¼€å‘ä»»æ„å¤æ‚çš„åº”ç”¨ç¨‹åºå·²ç»è¶³å¤Ÿäº†ã€‚ 

 å°†OSGé›†æˆåˆ°QtDesignerå¼€å‘çš„...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OpenSceneGraphï¼šä¸Qtæ¡†æ¶é›†æˆ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438654/"><img src="https://habrastorage.org/webt/py/ks/3w/pyks3wlvjf_zfef-sqocutbnimk.jpeg"><br><br><h1> å¼•è¨€ </h1><br> ä¸€æ–¹é¢ï¼ŒOpenSceneGraphå¼•æ“æœ¬èº«å…·æœ‰é«˜çº§å­ç³»ç»Ÿï¼Œç”¨äºç®¡ç†çª—å£ï¼Œå¤„ç†ç”¨æˆ·è¾“å…¥äº‹ä»¶ï¼Œå‘é€å’Œæ¥æ”¶ç”¨æˆ·æ¶ˆæ¯ã€‚ æˆ‘ä»¬åœ¨æœ¬ç³»åˆ—çš„å‰å‡ ç¯‡æ–‡ç« ä¸­å¯¹æ­¤è¿›è¡Œäº†è¯¦ç»†è®¨è®ºã€‚ é€šå¸¸ï¼Œå†åŠ ä¸ŠC ++ / STLçš„åŠŸèƒ½ï¼Œè¿™å¯¹äºå¼€å‘ä»»æ„å¤æ‚çš„åº”ç”¨ç¨‹åºå·²ç»è¶³å¤Ÿäº†ã€‚ <br><br>  <i>å°†OSGé›†æˆåˆ°QtDesignerå¼€å‘çš„åº”ç”¨ç¨‹åºä¸­çš„ç¤ºä¾‹ã€‚</i>  <i>è¯¥ç¤ºä¾‹å°†åœ¨ä¸‹é¢è¯¦ç»†è®¨è®ºã€‚</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/1LWLSxAUWwU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> å¦ä¸€æ–¹é¢ï¼Œä¸ºäº†åŠ å¿«C ++çš„å¼€å‘é€Ÿåº¦ï¼Œä½¿ç”¨äº†ä¸¤ä¸ªç¬¬ä¸‰æ–¹åº“æ¥æ‰©å±•è¯¥è¯­è¨€çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚boostï¼‰ï¼Œè¿˜ä½¿ç”¨äº†æ•´ä¸ªæ¡†æ¶ï¼Œè¿™äº›æ¡†æ¶ä½¿å¼€å‘å…·æœ‰å¹¿æ³›åŠŸèƒ½ç›®çš„çš„è·¨å¹³å°åº”ç”¨ç¨‹åºå˜å¾—å®¹æ˜“å’Œå®¹æ˜“ã€‚ ä¸€ç§è¿™æ ·çš„æ¡†æ¶æ˜¯éå¸¸æµè¡Œçš„Qtã€‚ ä¸ç®¡ä»–ä»¬å¦‚ä½•æ‰¹è¯„Qtçš„å…ƒå¯¹è±¡ç¼–è¯‘å™¨ä»¥åŠå…¶ä»–ç¼ºç‚¹å’Œä¸ä¾¿ä¹‹å¤„ï¼ŒQtçš„ä¼˜åŠ¿éƒ½åœ¨äºå®ƒå¯ä»¥è§£å†³è·¨å¹³å°å¼€å‘ä¸­æ‰€æœ‰å¯èƒ½çš„ä»»åŠ¡çš„æ‰©å±•ç±»åº“ï¼Œä»¥åŠå®ç°ç±»ä¹‹é—´æ¶ˆæ¯ä¼ é€’å­ç³»ç»Ÿçš„â€œä¿¡å·-æ’æ§½â€çš„æ¦‚å¿µã€‚ ä¿¡å·å’Œæ—¶éš™è¿˜åŸºäºåº”ç”¨ç¨‹åºä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„äº¤äº’æ–¹æ³•ä»¥åŠè¿›ç¨‹é—´é€šä¿¡ã€‚ <br><br> è€Œä¸”ï¼Œå°†ä¸¤ç§æŠ€æœ¯ç»“åˆèµ·æ¥å°†éå¸¸æœ‰è¶£ï¼šQtå’ŒOSGã€‚ æˆ‘çš„å›¢é˜Ÿä¸å¾—ä¸è§£å†³ä¸€ä¸ªç±»ä¼¼çš„é—®é¢˜ï¼Œæˆ‘å·²ç»åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æˆ‘çš„ä¸€ç¯‡å‡ºç‰ˆç‰©ä¸­</a>å†™è¿‡ã€‚ ä½†æ˜¯ï¼Œæˆ‘æƒ³è¿›ä¸€æ­¥æ‰©å¤§è¿™ä¸ªé—®é¢˜ï¼Œæœ¬æ–‡å°†è®¨è®ºè¿™ä¸ªä¸»é¢˜ã€‚ <br><a name="habracut"></a><br> é›†æˆOSGå’ŒQtæœ‰ä¸¤ç§é€‰æ‹©ï¼š <br><br><ol><li> ä½¿ç”¨Qtä¿¡å·å’Œæ’æ§½ä¸OSGåº”ç”¨ç¨‹åºä¸­çš„å¯¹è±¡è¿›è¡Œäº¤äº’ <br></li><li> å°†OSGæŸ¥çœ‹å™¨é›†æˆåˆ°ç”¨C ++ / Qtå¼€å‘çš„å›¾å½¢ç•Œé¢ä¸­ï¼ŒåŒ…æ‹¬ä½¿ç”¨QtDesignerè¡¨å•è®¾è®¡å™¨ <br></li></ol><br> ç¬¬ä¸€ä¸ªé€‰é¡¹é€‚ç”¨äºä¸éœ€è¦ä½¿ç”¨Qtæä¾›çš„GUIå…ƒç´ ï¼Œä½†æ‚¨æƒ³ç¡®ä¿åº”ç”¨ç¨‹åºç»„ä»¶é€šè¿‡ä¿¡å·å’Œæ’æ§½è¿›è¡Œäº¤äº’çš„æƒ…å†µã€‚ ä¾‹å¦‚ï¼Œæˆ‘æå‡ºäº†ä½¿ç”¨Qté€šè¿‡TCPå¥—æ¥å­—å°†OSGåº”ç”¨ç¨‹åºä¸è¿›ç¨‹é—´é€šä¿¡åº“é›†æˆçš„éœ€æ±‚ã€‚ <br><br> å½“éœ€è¦OSGå¼•æ“é›†æˆå’Œä½¿ç”¨Qtå¼€å‘çš„å›¾å½¢åº”ç”¨ç¨‹åºæ—¶ï¼Œéœ€è¦ç¬¬äºŒä¸ªé€‰é¡¹ã€‚ ä¿¡å·å’Œæ’æ§½å¯ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œé™¤æ­¤ä»¥å¤–ï¼ŒQtè¿˜æä¾›äº†æ ‡å‡†åŒ–çš„GUIå…ƒç´ çš„æ•´ä¸ªèŒƒå›´ã€‚ <br><br><h1>  1. OSGçª—å£ç³»ç»Ÿä¸­çš„Qtä¿¡å· </h1><br> ç¬¬ä¸€ä¸ªç¤ºä¾‹æœ‰äº›ç»¼åˆï¼šæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªå…·æœ‰åŸå§‹åœºæ™¯çš„ç®€å•OSGåº”ç”¨ç¨‹åºï¼› åˆ›å»ºä¸¤ä¸ªç±»ï¼Œå…¶ä¸­ä¸€ä¸ªå°†å¤„ç†å‡»é”®ï¼Œå¦ä¸€ä¸ªç±»å‘æ§åˆ¶å°æ˜¾ç¤ºæœ‰å…³æŒ‰ä¸‹å“ªä¸ªé”®çš„æ¶ˆæ¯ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤„ç†ç¨‹åºå°†ç”ŸæˆQtä¿¡å·ï¼Œå¹¶å°†æœ‰å…³æŒ‰é”®çš„æ¶ˆæ¯ä½œä¸ºå‚æ•°ã€‚ <br><br> ä¸ºäº†ä¸Qté›†æˆï¼Œæ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶å³å¯ <br><br><ol><li> ä»QObjectç»§æ‰¿äº¤äº’ç±» <br></li><li> ç»„ç»‡ä¿¡å·å¤„ç†å¾ªç¯ <br></li><li> åˆ›å»ºåœ¨åº”ç”¨ç¨‹åºæ“ä½œæœŸé—´å†…å­˜ä¸­å­˜åœ¨çš„QApplicationï¼ˆæˆ–QCoreApplicationï¼‰ç±»çš„å®ä¾‹ <br></li></ol><br> å®Œæ•´çš„ç¤ºä¾‹ä»£ç å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æˆ‘çš„OSGè¯¾ç¨‹å­˜å‚¨åº“ä¸­æ‰¾åˆ°</a> ï¼Œè¯¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å­˜å‚¨åº“</a>åŒ…å«è¯¥å‘¨æœŸçš„æ‰€æœ‰è¯¾ç¨‹ã€‚ <br><br> é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªå°†â€œæ‰­æ›²â€ä¿¡å·å¤„ç†é˜Ÿåˆ—çš„ç±»ã€‚ <br><br>  <strong>qt-events.h</strong> <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> QT_EVENTS_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> QT_EVENTS_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osgGA/GUIEventHandler&gt; #include &lt;QCoreApplication&gt; //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ class QtEventsHandler : public osgGA::GUIEventHandler { public: QtEventsHandler(); virtual bool handle(const osgGA::GUIEventAdapter &amp;ea, osgGA::GUIActionAdapter &amp;aa); protected: }; #endif // QT_EVENTS_H</span></span></span></span></code> </pre> <br>  <strong>qt-events.cpp</strong> <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"qt-events.h"</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ QtEventsHandler::QtEventsHandler() { } //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ bool QtEventsHandler::handle(const osgGA::GUIEventAdapter &amp;ea, osgGA::GUIActionAdapter &amp;aa) { Q_UNUSED(aa) switch (ea.getEventType()) { case osgGA::GUIEventAdapter::FRAME: { // Process qt signals and event QCoreApplication::processEvents(QEventLoop::AllEvents); break; } default: break; } return false; }</span></span></span></span></code> </pre><br> ä¸€åˆ‡éƒ½éå¸¸ç®€å•-æ­¤ç±»æ˜¯æ ‡å‡†çš„OSGäº‹ä»¶å¤„ç†ç¨‹åºï¼Œåœ¨æ¸²æŸ“å¸§æ—¶ï¼Œå¯é€šè¿‡è°ƒç”¨æ¥å¯åŠ¨Qtä¿¡å·é˜Ÿåˆ—å¤„ç† <br><br><pre> <code class="cpp hljs">QCoreApplication::processEvents(QEventLoop::AllEvents);</code> </pre><br> ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨OSGå†…ç½®çš„æœºåˆ¶å†æ¬¡åˆ›å»ºä¸€ä¸ªå¤„ç†é”®ç›˜çš„ç±»ï¼Œä½†åŒæ—¶èƒ½å¤Ÿå‘é€Qtä¿¡å·ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœ€è¿‘ç»è¿‡åˆ†æçš„å¤šé‡ç»§æ‰¿ <br><br>  <strong>å¯†é’¥å¤„ç†ç¨‹åº</strong> <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> KEY_HANDLER_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> KEY_HANDLER_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osgGA/GUIEventHandler&gt; #include &lt;QObject&gt; //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ class KeyboardHandler : public QObject, public osgGA::GUIEventHandler { Q_OBJECT public: KeyboardHandler(QObject *parent = Q_NULLPTR) : QObject(parent) , osgGA::GUIEventHandler () { } bool handle(const osgGA::GUIEventAdapter &amp;ea, osgGA::GUIActionAdapter &amp;aa) { switch (ea.getEventType()) { case osgGA::GUIEventAdapter::KEYDOWN: emit sendMessage("Pressed key " + QString(ea.getKey())); break; default: break; } return false; } signals: void sendMessage(QString msg); private: }; #endif // KEY_HANDLER_H</span></span></span></span></code> </pre><br> è¯¥ç±»å°†å¤„ç†æœ‰å…³å·²æŒ‰ä¸‹é”®çš„æ¶ˆæ¯ï¼Œå¹¶å‘é€åŒ…å«å·²æŒ‰ä¸‹é”®ä»£ç çš„æ¶ˆæ¯ã€‚ è¯¥ä¿¡å·å°†ç”±æœªä»¥ä»»ä½•æ–¹å¼ä¸OSGè¿æ¥çš„ç±»æ¥æ”¶ï¼Œè¯¥ç±»æ˜¯QObjectçš„åä»£ï¼Œå¹¶ä¸”åŒ…å«ä¸€ä¸ªå°†æ¶ˆæ¯æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºçš„å•ä¸ªæ’æ§½ <br><br>  <strong>æ¥æ”¶å™¨</strong> <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> RECEIVER_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> RECEIVER_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;QObject&gt; #include &lt;iostream&gt; //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ class Receiver : public QObject { Q_OBJECT public: Receiver(QObject *parent = Q_NULLPTR) : QObject(parent) {} public slots: void printMessage(QString msg) { std::cout &lt;&lt; msg.toStdString() &lt;&lt; std::endl; } }; #endif // RECEIVER_H</span></span></span></span></code> </pre><br> ç°åœ¨ï¼Œé€šè¿‡ç¼–å†™OSGåº”ç”¨ç¨‹åºå°†å®ƒä»¬æ”¾åœ¨ä¸€èµ· <br><br>  <strong>ä¸»æ–‡ä»¶</strong> <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> MAIN_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MAIN_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osgViewer/Viewer&gt; #include &lt;osgDB/ReadFile&gt; #include &lt;QCoreApplication&gt; #include "qt-events.h" #include "keyhandler.h" #include "receiver.h" #endif</span></span></span></span></code> </pre><br>  <strong>main.cpp</strong> <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"main.h"</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ int main(int argc, char *argv[]) { QCoreApplication app(argc, argv); osg::ref_ptr&lt;osg::Node&gt; scene = osgDB::readNodeFile("../data/cessnafire.osg"); osgViewer::Viewer viewer; viewer.setSceneData(scene.get()); viewer.addEventHandler(new QtEventsHandler); viewer.setUpViewInWindow(0, 0, 1024, 768); KeyboardHandler *keyboardHandler = new KeyboardHandler; Receiver *receiver = new Receiver; QObject::connect(keyboardHandler, &amp;KeyboardHandler::sendMessage, receiver, &amp;Receiver::printMessage); viewer.addEventHandler(keyboardHandler); return viewer.run(); }</span></span></span></span></code> </pre><br> é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºQCoreApplicationç±»çš„å®ä¾‹ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">QCoreApplication </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">app</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(argc, argv)</span></span></span></span>;</code> </pre><br> å¯¹äºæ‰€æè¿°çš„æŠ€æœ¯æ¥è¯´ï¼Œè¿™æ˜¯å¿…éœ€çš„ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬<em>ä¸ä¼šè°ƒç”¨QCoreApplication :: execï¼ˆï¼‰æ–¹æ³•</em> ï¼ ç›¸åï¼Œä¿¡å·å¤„ç†å¾ªç¯å°†åœ¨osgViewer :: Viewer :: runï¼ˆï¼‰å¾ªç¯å†…æ—‹è½¬ï¼Œä¸ºæ­¤æˆ‘ä»¬åˆ›å»ºå¹¶æ³¨å†Œç›¸åº”çš„å¤„ç†ç¨‹åº <br><br><pre> <code class="cpp hljs">viewer.addEventHandler(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QtEventsHandler);</code> </pre><br> æˆ‘ä»¬åˆ›å»ºå°†é€šè¿‡Qtä¿¡å·äº¤äº’çš„ç±»çš„å®ä¾‹ï¼Œå°†ä¸€ä¸ªçš„ä¿¡å·ä¸å¦ä¸€ä¸ªçš„æ’æ§½è¿æ¥ <br><br><pre> <code class="cpp hljs">KeyboardHandler *keyboardHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> KeyboardHandler; Receiver *receiver = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Receiver; QObject::connect(keyboardHandler, &amp;KeyboardHandler::sendMessage, receiver, &amp;Receiver::printMessage);</code> </pre><br> æ³¨å†Œé”®ç›˜å¤„ç†ç¨‹åº <br><br><pre> <code class="cpp hljs">viewer.addEventHandler(keyboardHandler);</code> </pre><br> å…¨éƒ¨è¿è¡ŒæŸ¥çœ‹å™¨ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> viewer.run();</code> </pre><br> çœ‹åˆ°è¿™æ ·çš„ç…§ç‰‡ <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/HKJJb0cMl7I" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> æ˜¯çš„ï¼Œè¯¥ç¤ºä¾‹æœ‰äº›äººä¸ºè®¾è®¡ï¼Œä½†å®ƒè¯´æ˜äº†ä½¿ç”¨Qtæœºåˆ¶å°†ä»£ç é›†æˆåˆ°ä½¿ç”¨OSGçš„åº”ç”¨ç¨‹åºä¸­çš„ä¸»è¦åŸç†ã€‚ è¿™ä¸ªæƒ³æ³•æ¥è‡ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">OpenSceneGraph 3. Cookbook</a> ï¼Œä¸ºæˆ‘å’Œæˆ‘çš„å¼€å‘å›¢é˜ŸèŠ‚çœäº†å¤§é‡æ—¶é—´å’Œç²¾åŠ›ï¼Œä½¿æˆ‘å¯ä»¥ä½¿ç”¨åŸºäºQtçš„æ¨¡å—ï¼Œè¯¥æ¨¡å—å·²åœ¨æˆ‘ä»¬çš„ä»£ç åº“ä¸­çš„ä»£ç åº“ä¸­è¿›è¡Œäº†è°ƒè¯•å’Œæ ‡å‡†åŒ–ã€‚ <br><br> ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä»ç„¶æƒ³åœ¨Qt GUIåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨OSGï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ <br><br><h1>  2. osgQtåº“ </h1><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">osgQt</a>æ˜¯ä¸€ä¸ªç”¨äºä»¥ä¸‹ç›®çš„çš„é›†æˆåº“ï¼š <br><br><ol><li> åœ¨Qtä¸Šå¼€å‘çš„åº”ç”¨ç¨‹åºçš„å›¾å½¢ç•Œé¢ä¸­åµŒå…¥åœ¨OSGä¸Šå®ç°çš„3Dåœºæ™¯ </li><li> åœ¨OSGåœºæ™¯å†…çš„3Då‡ ä½•å›¾å½¢è¡¨é¢ä¸ŠåµŒå…¥Qtå°éƒ¨ä»¶ã€‚ æ˜¯çš„ï¼Œæ‚¨æ²¡å¬é”™-Qtå°éƒ¨ä»¶å¯ä»¥åœ¨è™šæ‹Ÿä¸–ç•Œä¸­å®‰é™åœ°å·¥ä½œã€‚ æ€»æœ‰ä¸€å¤©æˆ‘ä¼šç¤ºèŒƒ </li></ol><br> è¯¥åº“å­˜åœ¨æŸäº›é—®é¢˜ï¼Œæˆ‘ä»¬é€šè¿‡ä»”ç»†ç ”ç©¶ä¸è¯¥åº“ç›¸è¿çš„ç¤ºä¾‹å¹¶é˜…è¯»å·²ç»æåˆ°çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">OpenSceneGraph 3</a> ï¼Œè®¾æ³•è§£å†³äº†è¿™äº›é—®é¢˜<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ã€‚</a> <br><br> åº“åº”è¯¥è¢«ç»„è£…ï¼Œå¹¶ä¸”è¯¥è¿‡ç¨‹ç±»ä¼¼äºå¼•æ“æœ¬èº«çš„ç»„è£…ï¼Œè¿™å°†åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ¬å‘¨æœŸçš„ç¬¬ä¸€ç¯‡æ–‡ç« </a>ä¸­è¿›è¡Œè¯¦ç»†æè¿°ã€‚ å”¯ä¸€è¦æ³¨æ„çš„æ˜¯ï¼Œåº”é€‰æ‹©-DCMAKE_INSTALL_PREFIXæ¥é€‰æ‹©ä¸æ„å»ºå¼•æ“æ—¶æŒ‡å®šçš„åç§°ç›¸åŒçš„åç§°-å› æ­¤osâ€‹â€‹gQtå°†å®‰è£…åœ¨å¼•æ“æ—è¾¹ï¼Œå¹¶ä¸”åœ¨å¼€å‘è¿‡ç¨‹ä¸­å°†å¾ˆæ–¹ä¾¿ä½¿ç”¨ã€‚ <br><br><h1>  3.å°†osgViewer :: Vieweré›†æˆåˆ°Qt GUIä¸­ </h1><br> ä»¥ä¸‹ç¤ºä¾‹å°†éå¸¸æœ‰ç”¨ã€‚ æˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªæŸ¥çœ‹å™¨ï¼Œä½¿æ‚¨å¯ä»¥ä½¿ç”¨æ ‡å‡†Qtæ§ä»¶åŠ è½½* .osgæ ¼å¼çš„æ¨¡å‹ã€‚ æ­¤å¤–ï¼Œè¦å¼€å‘å›¾å½¢ç•Œé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨QtDeisgnerã€‚ <br><br> è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œä¾‹å¦‚â€œ Qt Widgets Applicationâ€ <br><br><img src="https://habrastorage.org/webt/hk/t5/sj/hkt5sjllzcuqyfyfm08ugnag0bw.png"><br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨èœå•æ ï¼Œå·¥å…·æ å’ŒçŠ¶æ€æ ç”Ÿæˆä¸»åº”ç”¨ç¨‹åºçª—å£ã€‚ åœ¨QtDesignerä¸­ï¼Œå°†QFrameç»„ä»¶æ·»åŠ åˆ°æ­¤çª—å£ã€‚ <br><br> <a href=""><img src="https://habrastorage.org/webt/ek/4r/8c/ek4r8can5b5v63ex03jbw0v4czu.png"></a> <br><br> æˆ‘ä»¬å°†OSGæŸ¥çœ‹å™¨æ”¾åœ¨æ­¤æ¡†æ¶ä¸­ã€‚  OSGæŸ¥çœ‹å™¨æœ¬è´¨ä¸Šå°†æ˜¯Qtå°éƒ¨ä»¶ï¼Œå¯¹äºå…¶å®ç°ï¼Œæˆ‘ä»¬å°†ç¼–å†™QViewerWidgetç±»ã€‚ æˆ‘å°†å…¨éƒ¨èµ„æ–™æ”¾åœ¨æ‰°æµæ¿ä¸Šï¼Œä»¥å…ä½¿ä»£ç ç‰‡æ®µæ¨¡ç³Šæ¼”ç¤ºæ–‡ç¨¿ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">qviewerwidget.h</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> QVIEWER_WIDGET_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> QVIEWER_WIDGET_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;QWidget&gt; #include &lt;osgViewer/Viewer&gt; #include &lt;osgQt/GraphicsWindowQt&gt; //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ class QViewerWidget : public QWidget { public: QViewerWidget(const QRect &amp;geometry); virtual ~QViewerWidget(); osg::Group *getScene(); osgViewer::Viewer *getViewer(); protected: osg::ref_ptr&lt;osg::Group&gt; scene; osgViewer::Viewer viewer; private: osgQt::GraphicsWindowQt *createGraphicsWindow(const QRect &amp;geometry); void initCamera(const QRect &amp;geometry); void paintEvent(QPaintEvent *); }; #endif // QVIEWER_WIDGET_H</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">qviewerwidget.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs">include <span class="hljs-string"><span class="hljs-string">"qviewerwidget.h"</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osgViewer/ViewerEventHandlers&gt; #include &lt;osgGA/TrackballManipulator&gt; #include &lt;QGridLayout&gt; //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ QViewerWidget::QViewerWidget(const QRect &amp;geometry) : QWidget() , scene(new osg::Group) { initCamera(geometry); viewer.setSceneData(scene); viewer.addEventHandler(new osgViewer::StatsHandler); viewer.setCameraManipulator(new osgGA::TrackballManipulator); viewer.setThreadingModel(osgViewer::Viewer::SingleThreaded); osgQt::GraphicsWindowQt *gw = static_cast&lt;osgQt::GraphicsWindowQt *&gt;(viewer.getCamera()-&gt;getGraphicsContext()); QGridLayout *layout = new QGridLayout; if (layout != Q_NULLPTR) { layout-&gt;addWidget(gw-&gt;getGLWidget()); this-&gt;setLayout(layout); } } //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ QViewerWidget::~QViewerWidget() { } //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ osg::Group *QViewerWidget::getScene() { return scene.get(); } //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ osgViewer::Viewer *QViewerWidget::getViewer() { return &amp;viewer; } //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ osgQt::GraphicsWindowQt *QViewerWidget::createGraphicsWindow(const QRect &amp;geometry) { osg::DisplaySettings *ds = osg::DisplaySettings::instance().get(); osg::ref_ptr&lt;osg::GraphicsContext::Traits&gt; traits = new osg::GraphicsContext::Traits; traits-&gt;windowName = ""; traits-&gt;windowDecoration = false; traits-&gt;x = geometry.x(); traits-&gt;y = geometry.y(); traits-&gt;width = geometry.width(); traits-&gt;height = geometry.height(); if (traits-&gt;height == 0) traits-&gt;height = 1; traits-&gt;doubleBuffer = true; traits-&gt;alpha = ds-&gt;getMinimumNumAlphaBits(); traits-&gt;stencil = ds-&gt;getMinimumNumStencilBits(); traits-&gt;sampleBuffers = ds-&gt;getMultiSamples(); traits-&gt;samples = ds-&gt;getNumMultiSamples(); return new osgQt::GraphicsWindowQt(traits.get()); } //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ void QViewerWidget::initCamera(const QRect &amp;geometry) { osg::Camera *camera = viewer.getCamera(); osg::ref_ptr&lt;osgQt::GraphicsWindowQt&gt; gw = createGraphicsWindow(geometry); gw-&gt;setTouchEventsEnabled(true); camera-&gt;setGraphicsContext(gw.get()); const osg::GraphicsContext::Traits *traits = gw-&gt;getTraits(); camera-&gt;setClearColor(osg::Vec4(0.7f, 0.7f, 0.7f, 1.0f)); camera-&gt;setViewport(0, 0, traits-&gt;width, traits-&gt;height); double aspect = static_cast&lt;double&gt;(traits-&gt;width) / static_cast&lt;double&gt;(traits-&gt;height); camera-&gt;setProjectionMatrixAsPerspective(30.0, aspect, 1.0, 1000.0); } //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ void QViewerWidget::paintEvent(QPaintEvent *) { viewer.frame(); }</span></span></span></span></code> </pre><br></div></div><br> å®ç°çš„ä¸»è¦æ€æƒ³æ˜¯ä½¿ç”¨osgQt :: GraphicsWindowç±»ï¼Œè¯¥ç±»åŸºäºQGLWidgetç±»åˆ›å»ºå›¾å½¢çª—å£ã€‚ è‹¥è¦åˆ›å»ºæ­¤çª—å£ï¼Œè¯·ä½¿ç”¨æ–¹æ³• <br><br><pre> <code class="cpp hljs">osgQt::GraphicsWindowQt *QViewerWidget::createGraphicsWindow(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> QRect &amp;geometry) { osg::DisplaySettings *ds = osg::DisplaySettings::instance().get(); osg::ref_ptr&lt;osg::GraphicsContext::Traits&gt; traits = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::GraphicsContext::Traits; traits-&gt;windowName = <span class="hljs-string"><span class="hljs-string">""</span></span>; traits-&gt;windowDecoration = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; traits-&gt;x = geometry.x(); traits-&gt;y = geometry.y(); traits-&gt;width = geometry.width(); traits-&gt;height = geometry.height(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (traits-&gt;height == <span class="hljs-number"><span class="hljs-number">0</span></span>) traits-&gt;height = <span class="hljs-number"><span class="hljs-number">1</span></span>; traits-&gt;doubleBuffer = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; traits-&gt;alpha = ds-&gt;getMinimumNumAlphaBits(); traits-&gt;stencil = ds-&gt;getMinimumNumStencilBits(); traits-&gt;sampleBuffers = ds-&gt;getMultiSamples(); traits-&gt;samples = ds-&gt;getNumMultiSamples(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osgQt::GraphicsWindowQt(traits.get()); }</code> </pre><br> æ ¹æ®ä¼ è¾“åˆ°è¾“å…¥çš„å‡ ä½•å‚æ•°ä»¥åŠOSG 3Dæ¸²æŸ“çš„æ‰€éœ€è®¾ç½®æ¥é…ç½®çª—å£ã€‚ è¿”å›çš„æŒ‡é’ˆæ˜¯åº”è¯¥ä¼ é€’ç»™ç›¸æœºçš„OSGå›¾å½¢ä¸Šä¸‹æ–‡ã€‚ å› æ­¤ï¼Œä¸‹ä¸€æ­¥æ˜¯åˆå§‹åŒ–ç›¸æœº <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> QViewerWidget::initCamera(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> QRect &amp;geometry) { osg::Camera *camera = viewer.getCamera(); osg::ref_ptr&lt;osgQt::GraphicsWindowQt&gt; gw = createGraphicsWindow(geometry); gw-&gt;setTouchEventsEnabled(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); camera-&gt;setGraphicsContext(gw.get()); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> osg::GraphicsContext::Traits *traits = gw-&gt;getTraits(); camera-&gt;setClearColor(osg::Vec4(<span class="hljs-number"><span class="hljs-number">0.7f</span></span>, <span class="hljs-number"><span class="hljs-number">0.7f</span></span>, <span class="hljs-number"><span class="hljs-number">0.7f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>)); camera-&gt;setViewport(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, traits-&gt;width, traits-&gt;height); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> aspect = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>&gt;(traits-&gt;width) / <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>&gt;(traits-&gt;height); camera-&gt;setProjectionMatrixAsPerspective(<span class="hljs-number"><span class="hljs-number">30.0</span></span>, aspect, <span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">1000.0</span></span>); }</code> </pre><br> å®é™…é€šè¯ <br><br><pre> <code class="cpp hljs">camera-&gt;setGraphicsContext(gw.get());</code> </pre><br> å¹¶å°†ä¸QGLWidgetå°éƒ¨ä»¶å…³è”çš„æ‰€éœ€ä¸Šä¸‹æ–‡ä¼ é€’ç»™ç›¸æœºã€‚ æˆ‘ä»¬å°†æ•´ä¸ªå°éƒ¨ä»¶ä¾‹ç¨‹æ”¾å…¥ç±»æ„é€ å‡½æ•°ä¸­ <br><br><pre> <code class="cpp hljs">QViewerWidget::QViewerWidget(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> QRect &amp;geometry) : QWidget() , scene(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::Group) { initCamera(geometry); viewer.setSceneData(scene); viewer.addEventHandler(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osgViewer::StatsHandler); viewer.setCameraManipulator(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osgGA::TrackballManipulator); viewer.setThreadingModel(osgViewer::Viewer::SingleThreaded); osgQt::GraphicsWindowQt *gw = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;osgQt::GraphicsWindowQt *&gt;(viewer.getCamera()-&gt;getGraphicsContext()); QGridLayout *layout = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QGridLayout; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (layout != Q_NULLPTR) { layout-&gt;addWidget(gw-&gt;getGLWidget()); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;setLayout(layout); } }</code> </pre><br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é…ç½®æŸ¥çœ‹å™¨å¹¶ç‰¹åˆ«æ³¨æ„æŒ‘æˆ˜ <br><br><pre> <code class="cpp hljs">viewer.setThreadingModel(osgViewer::Viewer::SingleThreaded);</code> </pre><br> å°†æŸ¥çœ‹å™¨åˆ‡æ¢åˆ°å•çº¿ç¨‹æ¨¡å¼ã€‚ è¿™æ˜¯å°†OSGé›†æˆåˆ°Qtä¸­æ—¶çš„å¿…è¦æªæ–½ï¼Œå› ä¸ºåœ¨æŸäº›Linuxå‘è¡Œç‰ˆä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨OSGä½¿ç”¨çš„å¤šçº¿ç¨‹æ¸²æŸ“æ—¶ï¼Œç¨‹åºå°†å´©æºƒã€‚ è¿™æ ·åšçš„åŸå› éœ€è¦å•ç‹¬æ±‡æŠ¥ï¼Œå› æ­¤è¯·ç»§ç»­æ³¨æ„æ­¤ä»£ç  <br><br><pre> <code class="cpp hljs">osgQt::GraphicsWindowQt *gw = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;osgQt::GraphicsWindowQt *&gt;(viewer.getCamera()-&gt;getGraphicsContext()); QGridLayout *layout = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QGridLayout; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (layout != Q_NULLPTR) { layout-&gt;addWidget(gw-&gt;getGLWidget()); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;setLayout(layout); }</code> </pre><br> åœ¨å…¶ä¸­æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå›¾å±‚ï¼Œè¯¥å›¾å±‚å¹²æ‰°äº†ä»ç›¸æœºçš„å›¾å½¢ä¸Šä¸‹æ–‡è¿”å›çš„QGLWidgetï¼Œå¹¶è½¬æ¢ä¸ºosgQt :: GraphicsWindowsæŒ‡é’ˆã€‚ æˆ‘ä»¬é€šè¿‡è°ƒç”¨å°†åˆ›å»ºçš„å›¾å±‚æ·»åŠ åˆ°æˆ‘ä»¬çš„å°éƒ¨ä»¶QViewerWidgetä¸­ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;setLayout(layout);</code> </pre><br> ä¸ºäº†ä½¿æˆ‘ä»¬çš„çª—å£å°éƒ¨ä»¶ä»¥åŠæ›´æ–°çª—å£æ—¶è¦æ›´æ–°çš„åœºæ™¯ï¼Œæ‚¨éœ€è¦é‡æ–°å®šä¹‰QPaintEventäº‹ä»¶å¤„ç†ç¨‹åº <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> QViewerWidget::paintEvent(QPaintEvent *) { viewer.frame(); }</code> </pre><br> åœ¨å…¶ä¸­æˆ‘ä»¬é€šè¿‡è°ƒç”¨osgViewer :: Viewer :: frameï¼ˆï¼‰æ–¹æ³•æ¥å¯åŠ¨æ¡†æ¶çš„æ¸²æŸ“ã€‚ <br><br> å¥½çš„ï¼Œå°éƒ¨ä»¶çš„ä»£ç å·²ç»å‡†å¤‡å¥½ï¼Œç°åœ¨æˆ‘ä»¬å°†å…¶åµŒå…¥åˆ°çª—ä½“ä¸Šçš„æ¡†æ¶ä¸­ã€‚ ä¸ºæ­¤ï¼Œåœ¨MainWindowç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ç¼–å†™äº†è¿™æ ·çš„ä»£ç  <br><br><pre> <code class="cpp hljs">MainWindow::MainWindow(QWidget *parent) : QMainWindow(parent) , ui(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Ui::MainWindow) , qviewer(Q_NULLPTR) { ui-&gt;setupUi(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); QGridLayout *layout = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QGridLayout; qviewer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QViewerWidget(QRect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, ui-&gt;frame-&gt;width(), ui-&gt;frame-&gt;height())); layout-&gt;addWidget(qviewer); ui-&gt;frame-&gt;setLayout(layout); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;setCentralWidget(ui-&gt;frame); connect(&amp;timer, &amp;QTimer::timeout, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, &amp;MainWindow::update); timer.start(<span class="hljs-number"><span class="hljs-number">40</span></span>); connect(ui-&gt;actionQuit, &amp;QAction::triggered, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, &amp;MainWindow::quit); connect(ui-&gt;actionClean, &amp;QAction::triggered, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, &amp;MainWindow::clean); connect(ui-&gt;actionOpen, &amp;QAction::triggered, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, &amp;MainWindow::open); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;setWindowTitle(<span class="hljs-string"><span class="hljs-string">"QViewerWidget example"</span></span>); }</code> </pre><br> æˆ–è€…æ›´ç¡®åˆ‡åœ°è¯´ï¼Œæˆ‘ä»¬ä»ç„¶å¯¹æ­¤éƒ¨åˆ†æ„Ÿå…´è¶£ <br><br><pre> <code class="cpp hljs">QGridLayout *layout = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QGridLayout; qviewer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QViewerWidget(QRect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, ui-&gt;frame-&gt;width(), ui-&gt;frame-&gt;height())); layout-&gt;addWidget(qviewer); ui-&gt;frame-&gt;setLayout(layout); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;setCentralWidget(ui-&gt;frame);</code> </pre><br> åœ¨è¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå›¾å±‚ï¼Œåˆ›å»ºå°ºå¯¸ç­‰äºæ¡†æ¶å¤§å°çš„çª—å£å°éƒ¨ä»¶ï¼Œå°†åˆ›å»ºçš„çª—å£å°éƒ¨ä»¶æ·»åŠ åˆ°è¯¥å›¾å±‚ï¼Œç„¶åå°†è¯¥å›¾å±‚é™„åŠ åˆ°æ¡†æ¶ã€‚ å¹¶ä¸”ï¼Œä¸ºäº†é¿å…æ‰“æ‰°æ­¤ç¤ºä¾‹ä¸­çš„å¸ƒå±€ï¼Œæˆ‘ä»¬å°†æ¡†æ¶æ‹‰ä¼¸åˆ°çª—å£çš„æ•´ä¸ªå·¥ä½œåŒºï¼Œä½¿å…¶æˆä¸ºä¸­å¤®çª—å£å°éƒ¨ä»¶ã€‚ <br><br> è¦è¿›è¡Œæ¸²æŸ“ï¼Œæ‚¨åº”è¯¥å®‰æ’æŒ‰è®¡æ—¶å™¨å®šæœŸæ›´æ–°çª—å£ã€‚ ä¸ºæ­¤ï¼Œåˆ›å»ºä¸€ä¸ªé—´éš”ä¸º40æ¯«ç§’ï¼ˆæ¯ç§’25å¸§ï¼‰çš„è®¡æ—¶å™¨ï¼Œå¹¶å°†å…¶è¶…æ—¶ä¿¡å·ä¸çª—å£æ›´æ–°æ’æ§½å…³è”ã€‚ æˆ‘ä½¿ç”¨Qt5è¯­æ³•è¿™æ ·åš <br><br><pre> <code class="cpp hljs">connect(&amp;timer, &amp;QTimer::timeout, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, &amp;MainWindow::update); timer.start(<span class="hljs-number"><span class="hljs-number">40</span></span>);</code> </pre><br> ä»¥å‰å·²ç»ä»¥è¿™ç§æ–¹å¼ä¸ºçª—å£ç±»å®šä¹‰äº†æ›´æ–°æ§½ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> MainWindow::update() { QMainWindow::update(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;geometry()); }</code> </pre><br> ä¸ºä»€ä¹ˆè¿™æ ·ï¼Œå› ä¸ºæ‚¨å¯ä»¥æŒ‰ç…§å¤§å¤šæ•°osgQtç¤ºä¾‹æ‰€ç¤ºçš„ç›¸åŒæ–¹å¼å°†è®¡æ—¶å™¨ä¿¡å·ä¸QMainWindow :: updateæ’æ§½ç›´æ¥å…³è” <br><br><pre> <code class="plaintext hljs">connect(&amp;timer, SIGNAL(timeout), this, SLOT(update));</code> </pre><br> äº‹å®æ˜¯ï¼Œä¸èµæˆä½¿ç”¨SIGNALï¼ˆï¼‰å’ŒSLOTï¼ˆï¼‰å®çš„è¯­æ³•ï¼Œå¹¶ä¸”ç”±äºæœŸæœ›è¿‡æ¸¡åˆ°Qt6ï¼Œå¿…é¡»å°†å…¶ä¸¢å¼ƒã€‚ åŒæ—¶ï¼ŒQMainWindowç±»æ²¡æœ‰å‚æ•°çš„updateï¼ˆï¼‰æ’æ§½æ²¡æœ‰é‡è½½ï¼Œè¿™å°†åœ¨ç¼–è¯‘æœŸé—´å¯¼è‡´ç»‘å®šè°ƒç”¨é”™è¯¯ã€‚ ä¸ºæ­¤ï¼Œæˆ‘å¿…é¡»å®šä¹‰ä¸å¸¦å‚æ•°çš„updateï¼ˆï¼‰æ’æ§½ï¼Œåœ¨å…¶ä¸­è°ƒç”¨åŸºæœ¬QMainWindow :: updateï¼ˆï¼‰ï¼Œå¹¶åœ¨å…¶ä¸­ä¼ é€’çª—å£çš„å®¢æˆ·åŒºã€‚ <br><br> æ·»åŠ åˆ°è¿™ä¸ªåœ°æ–¹å¹¶è¿è¡Œç¨‹åºï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€å®šçš„ç»“æœ <br><br><img src="https://habrastorage.org/webt/s4/hb/h7/s4hbh78isikshkekfsbefaht8wg.png"><br><br> é€šè¿‡æŒ‰â€œ Sâ€ï¼Œæˆ‘ä»¬å¯ä»¥æ¿€æ´»OSGç»Ÿè®¡ç›‘è§†å™¨ï¼Œå¹¶ç¡®ä¿æˆ‘ä»¬çš„å°éƒ¨ä»¶èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œå¹¶ç»˜åˆ¶ä¸€ä¸ªç©ºç™½åœºæ™¯ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ä»€ä¹ˆæ ·çš„ç»Ÿè®¡ç›‘æ§å™¨ï¼Ÿ</b> <div class="spoiler_text"> ä¸ºäº†ä¸ä½¿æ–‡ç« è¿‡è½½ï¼Œæˆ‘å°†åœ¨æ­¤å¤„è¿›è¡Œä»‹ç»ã€‚  OSGå…·æœ‰å†…ç½®çš„ç›‘è§†å™¨ï¼Œå¯å®æ—¶æ˜¾ç¤ºå¼•æ“ç»Ÿè®¡ä¿¡æ¯ã€‚ è¦å°†å…¶æ·»åŠ åˆ°æŸ¥çœ‹å™¨ä¸­ï¼Œæˆ‘ä»¬åŒ…æ‹¬å¤´æ–‡ä»¶ <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osgViewer/ViewerEventHandlers&gt;</span></span></span></span></code> </pre><br> å¹¶å‘æŸ¥çœ‹å™¨æ·»åŠ ä¸€ä¸ªå¤„ç†ç¨‹åº <br><br><pre> <code class="cpp hljs">viewer.addEventHandler(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osgViewer::StatsHandler);</code> </pre><br> ç„¶åéšæ—¶æŒ‰â€œ Sâ€ä»¥æ˜¾ç¤ºå¾ˆå¤šæœ‰ç”¨çš„ä¿¡æ¯ã€‚ <br></div></div><br><h1>  4.å®Œæˆæˆ‘ä»¬çš„æŸ¥çœ‹å™¨ï¼šæ·»åŠ èœå• </h1><br> åœ¨è¡¨å•è®¾è®¡å™¨ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨â€œé¢å‘é¼ æ ‡â€ç¼–ç¨‹æ¥è‡ªå®šä¹‰èœå•ï¼ˆå¯¹æ­¤æˆ‘å¹¶ä¸åœ¨æ„ï¼Œä½†æ˜¯æ˜¯çš„ï¼Œæœ‰æ—¶å¾ˆæ–¹ä¾¿ï¼‰ã€‚ æœ€åæˆ‘ä»¬ä¼šå¾—åˆ°è¿™æ ·çš„ä¸œè¥¿ <br><br> <a href=""><img src="https://habrastorage.org/webt/5h/lg/4y/5hlg4ynz134k85tyg9gko_mzjlm.png"></a> <br><br> ç°åœ¨ï¼Œæˆ‘ä»¬å°†å¯åŠ¨é€‚å½“çš„å¤„ç†å™¨æ’æ§½ï¼Œä½¿æ‚¨å¯ä»¥æ²¿ä»å¯¹è¯æ¡†ä¸­é€‰æ‹©çš„è·¯å¾„åŠ è½½æ¨¡å‹ï¼Œæ¸…é™¤åœºæ™¯å¹¶é€€å‡ºåº”ç”¨ç¨‹åº <br><br><div class="spoiler">  <b class="spoiler_title">èœå•å¤„ç†ç¨‹åºä»£ç </b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ void MainWindow::open() { osg::Group *scene = qviewer-&gt;getScene(); if (scene == nullptr) return; QString path = QFileDialog::getOpenFileName(Q_NULLPTR, tr("Open model file"), "./", tr("OpenSceneGraph (*.osg *.osgt *.osgb *.ivi)")); if (path.isEmpty()) return; scene-&gt;removeChildren(0, scene-&gt;getNumChildren()); osg::ref_ptr&lt;osg::Node&gt; model = osgDB::readNodeFile(path.toStdString()); scene-&gt;addChild(model.get()); } //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ void MainWindow::clean() { osg::Group *scene = qviewer-&gt;getScene(); if (scene == nullptr) return; scene-&gt;removeChildren(0, scene-&gt;getNumChildren()); } //------------------------------------------------------------------------------ // //------------------------------------------------------------------------------ void MainWindow::quit() { QApplication::quit(); }</span></span></code> </pre><br></div></div><br> ä¹‹åï¼Œæˆ‘ä»¬å°†è·å¾—éå¸¸æ–¹ä¾¿çš„* .osgæ ¼å¼æ¨¡å‹çš„æŸ¥çœ‹å™¨ã€‚ <br><br><img src="https://habrastorage.org/webt/vj/ub/ml/vjubmllisl3w25nyca0dn90udv0.png"><br><br> æœ¬æ–‡å¼€å¤´çš„è§†é¢‘ä¸­å±•ç¤ºäº†ä»–çš„ä½œå“çš„æ¼”ç¤ºã€‚ æ­¤ç¤ºä¾‹çš„å®Œæ•´æºä»£ç <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨æ­¤å¤„ã€‚</a> <br><br><h1> ç»“è®º </h1><br> å¦‚æˆ‘ä»¬æ‰€è§ï¼ŒOSGå’ŒQtçš„é›†æˆåœ¨ç†è§£æˆ–å®ç°æ–¹é¢å¹¶ä¸æ˜¯ç‰¹åˆ«å›°éš¾ã€‚ è¿™å¯¹äºä¸ºæŠ€æœ¯å¯è§†åŒ–ä»¥åŠå¯èƒ½çš„æ¸¸æˆåˆ›å»ºè·¨å¹³å°åº”ç”¨ç¨‹åºæä¾›äº†å¾ˆå¤§çš„å¸®åŠ©ã€‚ <br><br> æœ¬æ–‡æ‰“å¼€äº†OSGç³»åˆ—çš„ç»­ç¯‡ï¼Œå®ƒå°†æ¦‚è¿°å¤æ‚çš„å¼€å‘æŠ€æœ¯ã€‚ æˆ‘è®¤ä¸ºå¥¹æˆåŠŸäº†ã€‚ è°¢è°¢ï¼Œå†è§ï¼ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN438654/">https://habr.com/ru/post/zh-CN438654/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN438644/index.html">æœºå™¨å­¦ä¹ ç®—æ³•çš„å®‰å…¨æ€§ã€‚ ä½¿ç”¨Pythonä¿æŠ¤å’Œæµ‹è¯•æ¨¡å‹</a></li>
<li><a href="../zh-CN438646/index.html">å…³äºåœ¨æ‰‹æŒ‡ä¸Šåˆ›å»ºé¢„ç®—ç«‹ä½“å›¾åƒï¼ˆç«‹ä½“å›¾ï¼Œæµ®é›•å›¾ï¼Œç«‹ä½“é•œï¼‰</a></li>
<li><a href="../zh-CN438648/index.html">BIç³»ç»Ÿçš„æ¯”è¾ƒï¼ˆTableauï¼ŒPower BIï¼ŒOracleï¼ŒQlikï¼‰</a></li>
<li><a href="../zh-CN438650/index.html">ç«ç®­9M729ã€‚ å…³äºINFæ¡çº¦â€œè¿åè€…â€çš„å‡ å¥è¯</a></li>
<li><a href="../zh-CN438652/index.html">Portabelization IDA</a></li>
<li><a href="../zh-CN438658/index.html">å¦‚ä½•å­¦ä¹ å­¦ä¹ </a></li>
<li><a href="../zh-CN438662/index.html">æˆ‘çˆ±ä¸Šæ¨¡ç³Šçš„é‚£ä¸€å¤©</a></li>
<li><a href="../zh-CN438664/index.html">Swiftç¼–è¯‘å™¨è®¾å¤‡ã€‚ ç¬¬äºŒéƒ¨åˆ†</a></li>
<li><a href="../zh-CN438666/index.html">ç»ç†ä¸ç¨‹åºå‘˜</a></li>
<li><a href="../zh-CN438668/index.html">â€œå¯»æ‰¾èƒ½å¤Ÿé©±åŠ¨çš„æ•…äº‹â€ï¼šå…³äºæ’­å®¢ï¼Œç¼–è¾‘å·¥ä½œå’Œåª’ä½“èŒä¸šçš„æ’­å®¢</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>