<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßíüèº üó∫Ô∏è üëçüèº Remplacement d'un pressostat m√©canique par un pressostat num√©rique (aux propri√©taires de puits) üé† üèä üí™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La premi√®re fois que j'ai d√ª r√©gler un pressostat m√©canique √† ressorts, j'ai r√©alis√© que j'avais besoin d'un appel √† un ami, ou plut√¥t √† mon p√®re, car...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Remplacement d'un pressostat m√©canique par un pressostat num√©rique (aux propri√©taires de puits)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/408933/"> La premi√®re fois que j'ai d√ª r√©gler un pressostat m√©canique √† ressorts, j'ai r√©alis√© que j'avais besoin d'un appel √† un ami, ou plut√¥t √† mon p√®re, car le m√©canisme, bien que bien pens√© et tol√©rant aux pannes, est √† un niveau √©lev√©, mais il y a un inconv√©nient, m√™me un ajustement unique du visage . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/13e/24d/072/13e24d0724dea32524577289dea261f6.jpg" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/953/7be/772/9537be77296c01b41348a4e722cef8bf.jpg" alt="image"></div><br>  Je demande une coupe, c'est plus int√©ressant l√†-bas;) <br><a name="habracut"></a><br>  Je l'ai en quelque sorte compris et j'ai m√™me r√©ussi √† l'ajuster, mais j'ai pass√© du temps et des nerfs √† ce sujet.  Ensuite, j'ai r√©alis√© qu'un relais num√©rique serait g√©nial, il suffit d'appuyer sur les boutons et de r√©gler celui souhait√©.  Bien s√ªr, beaucoup peuvent me condamner √† plusieurs √©gards: <br><br>  "Vous √™tes un imb√©cile que vous ne pouvez pas g√©rer le pressostat le plus simple et les deux ressorts." <br>  - la m√©canique dirige, cela fonctionnera pour toujours. <br>  - pourquoi y a-t-il quelque chose √† r√©glementer: une fois un plombier fix√© pour XX * (taux du pays) roubles et tout <br><br>  Sans probl√®me, vous pouvez continuer la liste pendant longtemps, mais par la nature de votre ing√©nierie, j'aimerais tout d√©velopper et am√©liorer tout autour de moi, sans tordre les ressorts et penser quand les contacts du relais m√©canique y br√ªlent et que le relais de protection de la pompe thermique commence √† fonctionner quand vous √™tes tous en savon: D, et encore mieux ta femme :) <br><br>  Nous devons rendre hommage, le relais m√©canique fonctionne d√©j√† pour moi depuis la 4√®me ann√©e et rien ne s'est pass√© avec √ßa (pah pah pah), j'ai juste eu √† reconstruire, nettoyer les contacts, et ces "CLIC!" Ont commenc√© √† briller.  ils se sont un peu tendus dans le garage et ... ont fait peur √† ma souris, de sorte qu'il a d√ª s'enfuir. <br><br><div class="spoiler">  <b class="spoiler_title">√âchapper</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/-fVq93IuNN0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  Depuis que j'aime l'automatisation et que je suis pass√© du 1 fil √† l'arduino en passant par l'esp, je peux et fais divers m√©tiers √† la maison, ou plut√¥t des appareils, pour vous faciliter la vie.  Le cercle d'amis conna√Æt la liste des projets que j'essaie de terminer et de mettre en ≈ìuvre, mais il n'y a absolument pas de temps pour cela.  Cette construction du bain se d√©roulera pour tout l'√©t√© (750 heures), puis la neige s'accumulera :), et voici la nouvelle ann√©e au nez! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/d20/61c/46b/d2061c46b4400e77cb2c657f745003d9.jpg" alt="image"></div><br>  Beaucoup de gens m'aiment aussi, en particulier dans le domaine informatique.  Mais ce n'est qu'amusant, la vie est une chose int√©ressante, et sans elle en aucune fa√ßon.  Un grand merci √©galement √† tous ceux qui me soutiennent - sans vos aimables paroles, la motivation ne serait pas la m√™me.  Merci √† ma femme d'avoir compris l'amour de mes planches) <br><br>  Des paroles, nous sautons dans la r√©alit√©.  Je me suis tourn√© √† la recherche d'un relais num√©rique et j'ai r√©alis√© que c'√©tait tr√®s difficile dans cette direction, soit √©trang√®re pour 100 $ et pas du tout comme je le souhaiterais ... soit m√©canicien pour 15 $.  Je l'apporte en $, car on sait depuis longtemps que si nous passions √† $, m√™me les grands-m√®res ne se baigneraient pas, comme avec les pi√®ces.  Mais je suis un coquin - la maison est connect√©e √† Internet, mais il n'y a pas de pressostat - fou! <br><br>  Th√®me pour les trolls: j'ai commenc√© √† travailler avec Arduino d'origine chinoise, pas les originaux, mais les chinois, ils fonctionnent de la m√™me mani√®re, o√π il y a des erreurs mineures, mais ils ne me blessent pas de mani√®re √† cracher de la lave de n√©gatif et √† secouer esp8266, qui meurt de l'√©lectricit√© statique plus rapidement que vous allez le brancher sur votre ordinateur, et m√™me avec une alimentation 3,3, que vous devez aller chercher), √† moins que ce ne soit NodeMCU, que j'adore. <br><br>  J'adore esp8266 et Arduino et les gens, mais pour s'asseoir rapidement pour assembler un appareil d'automatisation fonctionnel et stable, arduino est une chose indispensable + Le c√¢blage en langage C aide beaucoup √† r√©aliser rapidement ce qui est requis.  (personne ne reprochera ce que vous avez √©crit dans le langage de script Lua de frein).  esp8266 (mon avis) - bon l√† o√π vous n'avez pas besoin de mesurer l'ADC et Internet est n√©cessaire.  Bien que sa "combustion \ humidit√©" soit tr√®s d√©cevante. <br><br>  Nous revenons √† nos moutons, c'est-√†-dire un relais :) <br><br>  En cons√©quence, j'ai trouv√© un capteur en Chine pour 5 $, avec un ADC 0-5V et j'ai d√©cid√© de l'essayer.  Pas m√™me ainsi, j'ai b√™tement tir√© pour l'appliquer et assembler l'appareil.  Des fantasmes √©rotiques imm√©diats ont commenc√©, comment les LED clignotent) et les boutons de r√©glage sont press√©s, et les chiffres ch√©ris s'allumeront sur l'√©cran bleu embl√©matique chinois et tout cela fonctionnera avec une pression r√©elle dans notre peigne. <br><br>  J'ai r√©fl√©chi, je l'ai d√©crit, dessin√©, planifi√©, command√© et j'ai commenc√© √† √©crire le code jusqu'√† ce que l'√©rotisme passe avec des pens√©es. <br><br>  Quand le capteur est arriv√©, j'ai r√©alis√© que le capteur √©tait tr√®s bien fait. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/cac/9f7/0e4/cac9f70e428dc26b50ef47c3f69e21a3.jpg" alt="image"></div><br>  De plus, j'ai r√©alis√© qu'il commen√ßait √† montrer des donn√©es non pas √† partir de z√©ro, mais de 0,5 V √† 4,5 V.  de 0 √† 12 bar.  J'√©tais tr√®s content, car j'√©tais content de reconna√Ætre la singularit√© de cet appareil, vous pouvez suivre quand le capteur meurt et n'affiche pas le convoit√© 0,5 √† la sortie. <br><br>  Insertion du capteur dans le syst√®me actuel, laissant la m√©canique ¬´au cas o√π¬ª. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/953/ff1/9a8/953ff19a89efd97c7de0c335a0d841a0.jpg" alt="image"></div><br>  Une chose est triste, il n'y avait pas de donn√©es sur le capteur, comment calculer ses lectures, mais comme il y avait une ligne lin√©aire sur le graphique, j'ai d√ª (honteux, je l'admets) - ouvrir le manuel ALGEBRA et r√©apprendre, rappelez-vous comment ils construisent une relation lin√©aire directe dans √©quation :) par deux points et √† propos d'un miracle, j'ai rapidement obtenu (vous pouvez me faire honte) une formule simple ch√©rie dans laquelle, apr√®s avoir converti le signal ADC en VOLTS, j'ai compris combien de pression j'ai en bar.  √âtant donn√© que le capteur lui-m√™me a √©mis de 0 √† 1,2 Mpa - il n'est pas difficile de traduire en Bar - sachant que: <br><br>  1 Pa = 1,0E-5 bar <br>  soit 1200000Pa = 12Bar <br>  La pression de la pompe ne d√©passant pas 4Bar, ce capteur suffit pour les yeux! <br><br>  Ensuite, j'ai pris l'Arduino Uno - il tra√Ænait trop, je l'utilise g√©n√©ralement pour la conception articul√©e rapide, les tests, puis j'utilise l'Arduino Nano, car il est d√©pourvu du kit de carrosserie gauche et sa taille est 3 fois plus petite!  Et oui, les Arduinistes d'origine chinoise me pardonneront, j'√©tais d√©sol√© de la regarder au ralenti, je dois la laisser entrer dans l'appareil!  J'ai pens√© et achet√© une petite bo√Æte en plastique IP55, j'ai bu un trou sous l'√©cran, que j'ai achet√© il y a 4 ans!  Karl!  Et puis je ne savais pas que cet √©cran LCD 16 * 2 se lancerait dans une entreprise aussi utile.  J'ai pris 2 boutons automatiques sur le march√© automobile, soud√© les fils et je n'ai m√™me pas con√ßu la carte s√©par√©ment, comme je le fais pour Nano - car Uno est stupidement grand et pas du tout √† de telles fins. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a6e/c78/d35/a6ec78d35d2e73c21da5ab9f53bfbd25.jpg" alt="image"><br><br>  L'algorithme est assez simple et subit toujours des tests sur le terrain, le code du projet pour y regarder de plus pr√®s se trouve <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Je n'ai pas honte de l'afficher s'il y a des critiques constructives, je suis pr√™t √† apporter des modifications, car il est ouvert √† toute discussion. <br><br>  J'ai essay√© d'incorporer les principes suivants dans l'algorithme: <br><br>  - Initialisation des donn√©es: au d√©marrage, toutes les variables de fonctionnement sont v√©rifi√©es et initi√©es <br>  - Interrogation initiale du capteur: on v√©rifie si le capteur n'est pas tomb√© en panne (en cas de panne, le relais de la pompe est coup√© juste au cas o√π) les donn√©es sont calcul√©es et transf√©r√©es √† la pression actuelle dans le peigne (peigne de distribution, auquel les voisins sont connect√©s + entr√©e de pompe + accumulateur hydraulique) si tout est dans la pression de consigne inf√©rieure et sup√©rieure, alors nous continuons d'√©couter et de calculer les donn√©es <br>  - Les donn√©es sont affich√©es visuellement √† l'√©cran sous la forme: <br><br>  basse pression - pression actuelle - haute pression <br>  indice de chute de pression - [bloque, affiche la pression dans le syst√®me] <br><br>  Cela vous permet d'√©valuer rapidement situevina ce qui se passe. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a16/a6f/711/a16a6f7117f1602f238acc0115cba914.jpg" alt="image"><br><br>  - Si la pression actuelle est inf√©rieure √† LOWER: un relais √† semi-conducteurs est coup√© de 15A (test√© pendant des ann√©es) et la pompe se met en marche et d√©livre de l'eau silencieusement, rapidement, sans √©tincelles ni clics.  La pression TOP d√©clenche le relais.  La pompe ne s'allumera jamais et s'√©teindra, le cas √©ch√©ant, avec des lectures de capteur qui sont au-del√† de la plage raisonnable.  C'est √ßa la s√©curit√©. <br><br>  - Je calcule l'indice de chute de pression lorsque la moiti√© de la pression reste dans le peigne et les pr√©c√©dents et actuels sont v√©rifi√©s toutes les 10 secondes, si la diff√©rence est inf√©rieure √† la valeur par d√©faut de 0,05 - puis l'indice actuel change et la pompe se met en marche, c'est-√†-dire que la logique est une consommation d'eau rapide et que pour pr√©voir l'inclusion de la pompe, j'utilise cette logique.  La logique ne fonctionne pas jusqu'√† pr√©sent √† 100%, puisque je teste encore ce moment, il y a des failles associ√©es au timing millis () des arduins eux-m√™mes, cela me d√©range un peu, mais je vais trouver une solution pour un calcul clair.  La logique est d√©clench√©e au d√©but, puis l'index tombe √† 0,01 et la logique ne fonctionne plus, mais cela n'affecte pas l'allumage et l'extinction de la pompe.  Ici, vous pouvez holivit sur le sujet ¬´la pompe doit √™tre allum√©e un certain nombre de fois par heure et pas plus¬ª - vous en avez le droit), je ne contesterai pas - ce sujet est en cours d'analyse. <br><br>  - il y a des boutons lat√©raux qui vous permettent de r√©gler le seuil BAS et HAUT pour allumer et √©teindre la pompe DYNAMIQUEMENT, sans red√©marrer, juste b√™tement √† la vol√©e - regardez l'√©cran et appuyez sur les boutons lat√©raux ....  pratique sur!  les donn√©es sont imm√©diatement √©crites dans l'EEPPROM et lorsque l'unit√© est allum√©e, elle est charg√©e √† partir de l√† (c'est une m√©moire constante pour √©crire des nombres de 0 √† 255 octets, ce n'est pas suffisant pour les petits caprices).  Il y a un point, cependant, que les nombres √† virgule flottante sont si difficiles et h√©morragiques qu'il a √©t√© simplement d√©cid√© de ma part comme ceci: sachant que le nombre x.x0 est une pression de type flottant, il peut facilement √™tre converti en octet si vous multipliez par 10 et √©crire dans la m√©moire, c'est-√†-dire: exemple: 1,80 * 10 = 18 - apr√®s multiplication, le nombre flottant supprime automatiquement le dernier z√©ro et nous obtenons un nombre qui correspond au type d'octet, lors de la lecture, nous le divisons par 10,0 et obtenons la forme oppos√©e pour travailler dans notre syst√®me et type flotteur. <br><br>  - Tout le bien sera disponible en ¬´lecture seule¬ª √† l'ext√©rieur de la maison, ce qui nous permettra de comprendre la situation avec la pression non seulement en pression art√©rielle, mais aussi dans les tuyaux! <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/e04/3c9/963/e043c99632033b3dc2fe5bf4479c726f.jpg" alt="image"><br><br>  Eh bien, c'est comme tout, pardonnez-moi, qui sont g√™n√©s par les d√©tails du code, les stupides TYPES de donn√©es et les d√©tails intimes du chargement des donn√©es de la m√©moire, sautez cela parce que, sachant qu'il y a des gens de la sph√®re informatique, ils poseront toutes sortes de questions ou, vice versa, riront de mes algorithmes simples qui n'utilisent pas AI \ ML √† la mode et d'autres algorithmes m√©ga cool et big data.  Esp√©rons que les ing√©nieurs comprendront √©galement d'autres parties li√©es √† la partie m√©canique. <br><br>  En g√©n√©ral, la conclusion est la suivante: vous pouvez tout faire, vous pouvez le faire facilement, le faire dans l'int√©r√™t, et comme l'a dit un jour mon commentateur pr√©f√©r√©: vous pouvez √™tre un adulte et ¬´jouer avec des jouets pour enfants¬ª. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/b98/8d9/760/b988d9760525a615924a2c77c37bb68f.jpg" alt="image"></div><br><div class="spoiler">  <b class="spoiler_title">essais sur le terrain</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/cn3C7iSAZ1k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  Votre casquette, automatisation, gars comp√©tent et bonne journ√©e √† vous! <br><br>  Mauvaises herbes: <br><br>  - Je continue de tester l'indice de chute de pression pour un d√©marrage pr√©matur√© <br>  - Arduino uno (Chine) - des probl√®mes avec la minuterie millis () sont apparus - je vais v√©rifier arduino nano (ce n'est jamais arriv√© auparavant, je suppose un mod√®le incurv√©) (je ne l'ai pas compris, donc je ne le sais pas) <br>  - L'erreur est d√©clar√©e de 1,5% - √† partir de 1,2 bar - c'est 0,18 bar - en fait - j'ai quelque part 0,3 par rapport √† mon manom√®tre, mais je ne sais pas combien elle se situe ... donc 2% admettent l'erreur maximale - vous pouvez mettre l'erreur dans l'algorithme (comme je le fais) et ressemblera plus ou moins √† la v√©rit√©.  Ne lancez pas de satellites - cela fera l'affaire) <br><br>  <b>upd: l'</b> √©tiquette de prix dans la r√©gion de 15-18 $ a √©t√© publi√©e pour le produit. <br><br>  Bonne ann√©e!  Que tous vos projets se r√©alisent, des BAINS seront construits, il y aura de la CHALEUR dans la maison et toute votre famille amicale sera avec vous!  Qu'il n'y ait que de bonnes nouvelles pour la nouvelle ann√©e. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr408933/">https://habr.com/ru/post/fr408933/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr408923/index.html">"Merci pour l'aide, camarade!" Acc√©l√©rer les PC de jeu AMD Ryzen</a></li>
<li><a href="../fr408925/index.html">Steampunk Hi-Fi: un pass√© alternatif pour les √©quipements sonores</a></li>
<li><a href="../fr408927/index.html">Steam a cess√© d'accepter les paiements en Bitcoin en raison de la forte volatilit√© de la crypto-monnaie</a></li>
<li><a href="../fr408929/index.html">Les d√©veloppeurs de certains jeux mobiles exploitent la crypto-monnaie sur les smartphones des utilisateurs</a></li>
<li><a href="../fr408931/index.html">Courte critique du PC portable ASUS N580VD</a></li>
<li><a href="../fr408935/index.html">Antenne intelligente pour les r√©seaux LTE</a></li>
<li><a href="../fr408939/index.html">Rapport final sur le projet de satellite Mayak</a></li>
<li><a href="../fr408941/index.html">Connecteur de diagnostic OBD-II comme interface pour l'IoT</a></li>
<li><a href="../fr408943/index.html">Ce que l'ennui fait √† une personne: la science de la conscience errante</a></li>
<li><a href="../fr408945/index.html">Un millionnaire anonyme de Bitcoin donne 86 millions de dollars √† une ≈ìuvre caritative.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>