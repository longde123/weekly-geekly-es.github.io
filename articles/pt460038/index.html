<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîè üë® üë®üèΩ‚Äçüéì Dungeon Generation em Diablo 1 ü§≤ üë©üèº‚Äçü§ù‚Äçüë®üèø üõåüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Diablo 1 √© o cl√°ssico 1996 de hackers e barras roguelike. Essa foi uma das primeiras tentativas bem-sucedidas de apresentar as massas aos roguelike, q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dungeon Generation em Diablo 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460038/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7ac/daa/380/7acdaa38058e3058ff1a6ba9a7ca0ce2.png" alt="imagem"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Diablo 1</a> √© o cl√°ssico 1996 de hackers e barras roguelike.  Essa foi uma das primeiras tentativas bem-sucedidas de apresentar as massas aos roguelike, que at√© ent√£o tinham gr√°ficos de nicho na forma de arte ASCII.  O jogo gerou v√°rias sequ√™ncias e muitas simula√ß√µes.  Ela √© conhecida por sua atmosfera sombria e sombria, engrossando √† medida que o jogador desce para as masmorras localizadas sob a cidade de Tristram.  Foi um dos primeiros jogos com gera√ß√£o de mapas procedurais para mim, e a possibilidade de gerar n√≠veis t√£o confi√°veis ‚Äã‚Äãme chocou. <br><br>  Recentemente, descobri que, devido √† descoberta de v√°rios arquivos com s√≠mbolos de depura√ß√£o, v√°rios f√£s do jogo assumiram a tarefa de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fazer engenharia reversa do c√≥digo-fonte</a> para limp√°-lo e descobrir como era o c√≥digo escrito pelos desenvolvedores.  Assim come√ßou minha excurs√£o de uma semana ao estudo de como o desenvolvedor l√≠der David Brevik criou esses n√≠veis.  Talvez por isso, a m√°gica do jogo tenha me desmoronado parcialmente, mas eu aprendi muitas t√©cnicas que ser√£o √∫teis para desenvolvedores de jogos semelhantes, portanto, neste artigo, eu as compartilharei. <br><br>  Agradecemos a David Brevik e √† equipe Blizard North por criar um jogo t√£o incr√≠vel, bem como a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">galaxyhaxz</a> e a equipe Devilution por seu incr√≠vel trabalho em restaurar o c√≥digo-fonte leg√≠vel do projeto. <br><a name="habracut"></a><br><h1>  1. Introdu√ß√£o </h1><br>  Diablo √© um jogo que consiste em pe√ßas isom√©tricas.  O jogo consiste em 4 etapas, cada uma com 4 n√≠veis.  Etapas do jogo: Catedral, Catacumbas, Cavernas e Inferno.  Existem tamb√©m v√°rios n√≠veis fixos, por exemplo, a cidade de Tristram, que n√£o considerarei no artigo.  O Diablo possui procedimentos de gera√ß√£o de n√≠vel separados para cada um dos quatro est√°gios; portanto, primeiro falarei sobre seus recursos e depois considerarei separadamente a opera√ß√£o de cada um dos est√°gios. <br><br>  Eu s√≥ estava interessado em como os n√≠veis eram gerados.  Para aprender sobre miss√µes, monstros, etc.  Eu recomendo a leitura <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">do Guia do Jarulf para Diablo e Hellfire</a> , que descreve esses aspectos em detalhes. <br><br><h1>  Recursos Gerais </h1><br>  Embora cada est√°gio tenha seu pr√≥prio gerador de n√≠vel, todos eles t√™m caracter√≠sticas comuns. <br><br><h2>  Calabou√ßos e Azulejos </h2><br>  Cada n√≠vel do jogo √© gerado para preencher uma grade de 40 x 40 pe√ßas.  O eixo X corresponde ao sudeste e o eixo Y corresponde ao sudoeste. <br><br>  Esses blocos s√£o usados ‚Äã‚Äãapenas para tarefas de gera√ß√£o de n√≠vel.  Depois de criar um n√≠vel, cada bloco √© dividido em 4 "fragmentos de masmorra", que s√£o renderizados na tela. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aac/af2/49b/aacaf249b2356c104c27fb93a053b87a.png"></div><br>  Essa grade mais detalhada √© usada para determinar blocos atravessados ‚Äã‚Äãe tamb√©m fornece uma reutiliza√ß√£o mais eficiente da mem√≥ria gr√°fica.  Anteriormente, escrevi sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">esquemas de divis√£o de blocos</a> . <br><br>  Isso significa que o cart√£o padr√£o Diablo consiste em mais de cem pe√ßas, muitas das quais s√£o pequenas varia√ß√µes de outras, para levar em considera√ß√£o todas as maneiras poss√≠veis de conect√°-las.  Falaremos sobre isso mais tarde. <br><br>  Para minha surpresa, diferentemente de outros jogos desta s√©rie, os mapas de masmorra n√£o s√£o compostos de blocos pr√©-criados.  Quase tudo √© criado usando algoritmos. <br><br><h2>  Processo em v√°rias etapas </h2><br>  Cada procedimento de gera√ß√£o de masmorra √© dividido em dois est√°gios.  A pr√©-gera√ß√£o n√£o lida com a escolha dos ladrilhos.  Ele simplesmente gera uma matriz na qual s√£o marcados azulejos aceit√°veis, azulejos nos quais h√° portas e alguns outros detalhes de alto n√≠vel.  No segundo est√°gio, esse espa√ßo em branco da masmorra √© convertido em uma matriz de blocos, ap√≥s a qual a gera√ß√£o √© executada e as altera√ß√µes s√£o feitas considerando esses blocos. <br><br>  Isso deve ser incrivelmente conveniente para o designer.  Voc√™ pode experimentar uma planta totalmente independente da escolha de azulejos e estilo.  Mas, em muitos casos, eles est√£o interconectados, proporcionando um senso de n√≠vel mais hol√≠stico. <br><br>  Todos os est√°gios da cria√ß√£o de espa√ßos em branco nas masmorras come√ßam com um n√≠vel cheio de "dureza" s√≥lida, ap√≥s o qual as partes individuais do n√≠vel se transformam recursivamente em ladrilhos.  Vou discutir isso em mais detalhes abaixo. <br><br><h2>  Fragmentos acabados </h2><br>  Fragmentos acabados s√£o blocos de n√≠vel pr√©-criados que s√£o simplesmente inseridos em um n√≠vel gerado aleatoriamente.  Eles s√£o usados ‚Äã‚Äãpara a maioria das miss√µes de jogos.  Em cada n√≠vel, pode haver apenas um fragmento finalizado, cuja localiza√ß√£o em cada est√°gio √© selecionada separadamente. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fef/c34/5c5/fefc345c546569296a0e1059c6a2bbbb.gif"></div><br>  <i>O a√ßougue √© um dos primeiros trechos pr√©-fabricados encontrados no jogo.</i> <br><br><h2>  Mini sets </h2><br>  Os mini-kits s√£o outra maneira de inserir conte√∫do em um n√≠vel de conte√∫do pr√©-criado.  S√£o pequenos peda√ßos, geralmente com aproximadamente 3 √ó 3, inseridos aleatoriamente na masmorra.  Existe um esquema simples de correspond√™ncia de padr√µes, gra√ßas ao qual eles aparecem apenas nos lugares "certos".  Geralmente, eles s√£o codificados com requisitos adicionais, por exemplo, os mini-conjuntos n√£o podem ser colocados pr√≥ximos uns dos outros, n√£o podem se sobrepor a fragmentos prontos, e assim por diante.  Alguns mini-kits sempre pesquisam e substituem, enquanto outros fazem isso com uma probabilidade fixa. <br><br>  Os mini kits Diablo s√£o usados ‚Äã‚Äãpara diversos fins.  Eles s√£o usados ‚Äã‚Äãpara colocar objetos grandes de ladrilhos, como escadas, para corrigir combina√ß√µes de ladrilhos que n√£o se conectam bem entre si e para adicionar varia√ß√£o aleat√≥ria aos ladrilhos. <br><br><h2>  Salas tem√°ticas </h2><br>  Os quartos tem√°ticos s√£o pequenos espa√ßos delimitados por uma parede e uma porta.  Geralmente neles, de maneira aleat√≥ria, certos objetos predeterminados est√£o localizados.  Por exemplo, as bibliotecas sempre t√™m uma estante com duas velas de cada lado, v√°rios suportes para livros e monstros aleat√≥rios.  As tocas de monstros cont√™m muitos monstros e um item aleat√≥rio, e assim por diante. <br><br>  Nos n√≠veis do est√°gio athedral, o gerador cria salas adequadas que s√£o reconhecidas pelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">preenchimento</a> e reutilizadas.  Em outros est√°gios, o algoritmo encontra espa√ßos abertos nos quais paredes e uma porta s√£o desenhadas para criar salas. <br><br>  Cada tipo de sala tem√°tica possui certos requisitos para o tamanho e o est√°gio em que √© gerada. <br><br><h2>  Substitui√ß√µes de ladrilhos </h2><br>  Algumas cartas t√™m uma adapta√ß√£o especial das pe√ßas, mas todas t√™m uma caracter√≠stica comum: algumas pe√ßas podem ser substitu√≠das por varia√ß√µes semelhantes.  Os ladrilhos mais comuns (por exemplo, pisos e paredes planas) t√™m v√°rias varia√ß√µes, o que reduz a monotonia do n√≠vel.  As substitui√ß√µes de ladrilhos nunca s√£o reutilizadas lado a lado. <br><br><h2>  Compara√ß√£o de padr√µes e "corre√ß√µes" </h2><br>  Como mencionado acima, os mini-conjuntos s√£o usados ‚Äã‚Äãcomo um mecanismo de busca e substitui√ß√£o que corrige as falhas do gerador.  Mas, na maioria dos est√°gios, existem procedimentos que detectam e corrigem problemas mais espec√≠ficos.  N√£o vou entrar em detalhes, porque h√° apenas um monte deles.  Basta dizer que Diablo √© bastante problem√°tico e, mais perto do lan√ßamento, ficou √≥bvio que seria mais f√°cil adicionar reconhecimento de problemas espec√≠ficos do que eliminar suas causas fundamentais. <br><br>  Uma das "corre√ß√µes" mais comuns era o "bloqueio": verificava se era poss√≠vel passar por toda a masmorra e recome√ßava a gera√ß√£o, se n√£o fosse. <br><br><h2>  Miss√µes </h2><br>  A maioria das miss√µes foi criada usando fragmentos prontos, mas alguns usaram sua pr√≥pria l√≥gica.  Por exemplo, Zhar, o Louco, gera salas de biblioteca tem√°ticas, a entrada para √Ågua Envenenada √© gerada por mini-discagem e Anvil of Fury possui um c√≥digo de gera√ß√£o de n√≠vel espec√≠fico.  N√£o entrarei em detalhes, mas o c√≥digo est√° cheio de verifica√ß√µes semelhantes para miss√µes. <br><br><h1>  Catedral </h1><br>  A catedral √© provavelmente a mais ic√¥nica das etapas de Diablo.  √â caracterizada por longas filas de arcos g√≥ticos, salas apertadas e muitos gargalos na forma de portas.  Vamos ver como foi criado. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/68a/04e/c56/68a04ec568d05dac4c8f8c2040d68680.png" alt="imagem"></div><br><h2>  Calabou√ßo em branco </h2><br>  A primeira coisa que o algoritmo faz √© desenhar o n√∫cleo do cart√£o.  Ele seleciona aleatoriamente at√© tr√™s salas 10 √ó 10 em posi√ß√µes predeterminadas ao longo do eixo central X ou Y. Um amplo corredor que liga as salas tamb√©m √© desenhado ao longo do eixo.  Se houver um fragmento acabado no n√≠vel, ele estar√° sempre localizado no centro de uma dessas salas.  Essas salas centrais de calabou√ßo s√£o marcadas como inadequadas para novas paredes, de modo que permane√ßam sempre grandes espa√ßos abertos. <br><br>  Todas as outras salas s√£o geradas pela t√©cnica de brotamento recursivo em uma fun√ß√£o chamada <code>L5roomGen</code> , que √© acionada em cada uma dessas salas e pela sele√ß√£o de um eixo. <br><br><h3>  Fun√ß√£o L5roomGen </h3><br><ul><li>  Ela passa pelo ret√¢ngulo da sala original, da qual voc√™ precisa come√ßar a brotar, bem como pelo eixo preferido. </li><li>  Com uma probabilidade de 1/4, o eixo preferido muda. </li><li>  O tamanho aleat√≥rio da nova sala √© selecionado, com 2, 4 ou 6 pe√ßas de cada lado. </li><li>  Para cada lado da sala original ao longo do eixo selecionado (ou seja, SE / NS para X, SW / NE para Y): <br><ul><li>  O ret√¢ngulo da nova sala est√° alinhado com o centro da borda da sala original </li><li>  A verifica√ß√£o √© feita antes disso, n√£o havia nada desenhado e n√£o chegamos ao final do mapa.  Paredes requerem uma borda de um bloco. </li><li>  Se a verifica√ß√£o for bem sucedida, uma sala √© desenhada. </li></ul></li><li>  Para cada sala a ser <code>L5roomGen</code> , <code>L5roomGen</code> √© chamado recursivamente, que passa pela nova sala e pelo eixo oposto ao usado anteriormente. </li></ul><br>  Por fim, esse procedimento come√ßa com v√°rias salas cortadas dentro dos ladrilhos "s√≥lidos" e cola repetidamente novos ret√¢ngulos para cortar novas √°reas transit√°veis.  Nesta fase, todas as "salas" est√£o abertas de um lado, porque cada nova sala est√° localizada diretamente ao lado da anterior, sem passes para a coloca√ß√£o de paredes. <br><br>  Em seguida, o gerador calcula o n√∫mero de blocos atravessados ‚Äã‚Äãgerados.  Se estiver abaixo do limite m√≠nimo, que aumenta a cada n√≠vel, a masmorra √© destru√≠da e a tentativa de gera√ß√£o √© realizada novamente. <br><br><h2>  Calabou√ßo </h2><br>  At√© o momento, o algoritmo possui apenas os blocos "s√≥lidos" e de g√™nero.  Precisamos substitu√≠-los por revestimentos de parede reais.  Para isso, Diablo usa o algoritmo dos quadrados de marcha, que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">descrevi em um artigo anterior</a> . <br><br>  No entanto, o jogo usa sua varia√ß√£o incomum.  O conjunto de azulejos da catedral cont√©m paredes, mas eles sempre est√£o localizados na extremidade do azulejo.  Portanto, h√° um ladrilho com uma parede na borda nordeste, mas n√£o h√° ladrilhos com uma parede na borda sudeste.  Para criar paredes em outros lados, voc√™ precisa encontrar um ladrilho "s√≥lido" que tenha uma parede adicional que se estenda para fora da borda do ladrilho.  Parece estranho, mas na verdade √© muito conveniente para classificar paredes por profundidade. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b65/14b/193/b6514b19377666d0c7b06bf76002dd08.svg"></div><br>  Para lidar com isso, Diablo pula algumas paredes durante a fase dos cubos de marchas: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/553/284/1c2/5532841c2542510b979e4dae6dee2183.svg"></div><br>  Paredes adicionais s√£o adicionadas mais tarde, no est√°gio "reparos".  Eu acho que esse procedimento simples afeta mais o "estilo" da catedral.  Como as paredes opostas s√£o fixadas em ladrilhos s√≥lidos, no caso de duas salas separadas por um revestimento, a parede oposta simplesmente n√£o ser√° criada.  Isso significa que as divis√≥rias entre as salas s√£o "mais finas" do que as que voc√™ pode obter na resolu√ß√£o em que os quadrados de marcha s√£o executados. <br><br>  Depois de colocar as paredes principais, o gerador adiciona quatro colunas independentes a cada uma das salas centrais e uma colunata de arcos para o corredor central.  Isso permite que voc√™ d√™ √† catedral um senso de design com mais cuidado do que outros n√≠veis, e tamb√©m ajuda os jogadores a navegar. <br><br>  O gerador ent√£o adiciona aleatoriamente paredes divis√≥rias.  Paredes separadas sempre v√£o diretamente ao longo do eixo de uma parede para outra.  Eles come√ßam nos cantos, de modo que as √°reas s√£o lindamente divididas em salas.  Em 25% dos casos, uma parede √© uma s√©rie de arcos, em 25% dos casos √© uma s√©rie de arcos com uma grade bloqueando a entrada e, em todos os outros casos, √© uma parede s√≥lida.  No caso de grades e paredes s√≥lidas, em algum lugar ao longo da parede de separa√ß√£o, uma porta ou arco √© adicionado aleatoriamente para tornar o espa√ßo aceit√°vel. <br><br>  O procedimento de preenchimento detecta poss√≠veis salas tem√°ticas. <br><br>  As escadas s√£o colocadas para conectar-se a outros n√≠veis.  Se for imposs√≠vel coloc√°-los, a tentativa de gerar a masmorra come√ßa de novo. <br><br>  Quanto ao arranjo de mini-conjuntos, "corre√ß√µes" e substitui√ß√µes, n√£o os considerarei em detalhes.  Acima de tudo, adoro o mini-kit PANCREAS1, que tem 1% de chance de colocar uma pilha de carne ensanguentada no piso.  No final, 5 a 10 objetos de l√¢mpada s√£o colocados nele para decorar a masmorra. <br><br><h1>  Catacumbas </h1><br>  Ao contr√°rio da catedral, que parece ser um edif√≠cio projetado, as catacumbas parecem muito mais espont√¢neas.  Eles s√£o caracterizados por salas quadradas conectadas umas √†s outras por muitos corredores sinuosos.  Em muitos lugares, em vez de portas, grandes aberturas est√£o localizadas.  aumentando a probabilidade de o jogador estar cercado por muitos inimigos. <br><br>  O algoritmo de gera√ß√£o mais complexo do jogo foi usado para gerar catacumbas.  Suspeito que a falta de tempo tenha for√ßado os desenvolvedores a aplicar solu√ß√µes mais simples nos est√°gios subseq√ºentes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/086/22d/49e/08622d49e3f39ea4fca7d81a67393183.jpg" alt="imagem"></div><br><h2>  Calabou√ßo em branco </h2><br>  O procedimento para criar um espa√ßo de calabou√ßo para catacumbas √© bastante exclusivo.  Em todos os outros est√°gios, h√° um √∫nico valor booleano indicando a presen√ßa ou aus√™ncia de sexo (mais um conjunto de bits para detalhes adicionais).  As catacumbas armazenam a masmorra em branco na forma de um cart√£o ASCII, quase como o cl√°ssico de um roguel.  E isso n√£o √© particularmente surpreendente, dada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">a</a> admiss√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">David Brevik de que ele inspirou Diablo na Angband</a> . <br><br>  O gerador da sala principal √© novamente um algoritmo recursivo, mas desta vez uma parti√ß√£o recursiva.  A fun√ß√£o <code>CreateRoom</code> chamada para toda a √°rea da masmorra de 40 √ó 40 menos 1 lado a lado. <br><br><h3>  Fun√ß√£o CreateRoom </h3><br><ul><li>  A fun√ß√£o <code>CreateRoom</code> um ret√¢ngulo que indica a √°rea dentro da qual voc√™ deseja gerar salas.  Os detalhes tamb√©m s√£o passados ‚Äã‚Äãpara a fun√ß√£o sobre a sala original (inicialmente nula) </li><li>  Se a √°rea for muito estreita, a fun√ß√£o ser√° encerrada. </li><li>  Um tamanho aleat√≥rio √© selecionado para a sala de 4 a 9 pe√ßas de cada lado, levando em considera√ß√£o o tamanho m√°ximo da √°rea em que voc√™ deseja colocar a sala. </li><li>  Na √°rea, uma posi√ß√£o aleat√≥ria √© selecionada para colocar a sala. </li><li>  A sala √© renderizada em um mapa ASCII.  Na figura, o s√≠mbolo <code>'.'</code>  os pisos s√£o indicados, o s√≠mbolo <code>'#'</code> √© a parede circundante e as letras <code>'A'</code> , <code>'B'</code> , <code>'C'</code> e <code>'E'</code> s√£o os quatro cantos. </li><li>  Se uma sala tiver uma sala de origem: <br><ul><li>  Um ladrilho aleat√≥rio √© selecionado nas bordas mais pr√≥ximas das salas originais e novas. </li><li>  Esta informa√ß√£o √© registrada na lista de corredores, que ser√° usada posteriormente. </li></ul></li><li>  As partes restantes da √°rea, com exce√ß√£o da sala atual, s√£o cortadas, criando quatro ret√¢ngulos. </li><li>  O tamanho de cada ret√¢ngulo √© reduzido em dois blocos para criar um espa√ßo entre as salas e, em seguida, a fun√ß√£o <code>CreateRoom</code> √© chamada recursivamente, a regi√£o para a qual esse ret√¢ngulo √© usado e a sala criada como fonte. </li></ul><br>  Se houver um fragmento finalizado no mapa, ele estar√° sempre na primeira sala criada pelo CreateRoom e suas dimens√µes ser√£o feitas para que esse fragmento seja colocado nele. <br><br>  Depois de chamar o <code>CreateRoom</code> obtemos um array ASCII semelhante ao mostrado abaixo (obrigado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nomdenom</a> por extra√≠-lo do c√≥digo): <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">A</span></span>#<span class="hljs-selector-id"><span class="hljs-selector-id">#B</span></span> #..# <span class="hljs-selector-tag"><span class="hljs-selector-tag">A</span></span>###<span class="hljs-selector-id"><span class="hljs-selector-id">#B</span></span> #..# #....# #..# #....# <span class="hljs-selector-tag"><span class="hljs-selector-tag">C</span></span>#<span class="hljs-selector-id"><span class="hljs-selector-id">#E</span></span> #....# <span class="hljs-selector-tag"><span class="hljs-selector-tag">C</span></span>###<span class="hljs-selector-id"><span class="hljs-selector-id">#EA</span></span>####<span class="hljs-selector-id"><span class="hljs-selector-id">#B</span></span> #.....# #.....# <span class="hljs-selector-tag"><span class="hljs-selector-tag">A</span></span>#######<span class="hljs-selector-id"><span class="hljs-selector-id">#B</span></span> #.....# #........# #.....# #........# <span class="hljs-selector-tag"><span class="hljs-selector-tag">C</span></span>####<span class="hljs-selector-id"><span class="hljs-selector-id">#E</span></span> #........# <span class="hljs-selector-tag"><span class="hljs-selector-tag">A</span></span><span class="hljs-selector-id"><span class="hljs-selector-id">#B</span></span> #........# #.# #........# #.# #........# #.# #........# #.# #........# #.# <span class="hljs-selector-tag"><span class="hljs-selector-tag">C</span></span>#######<span class="hljs-selector-id"><span class="hljs-selector-id">#E</span></span> #.# #.# <span class="hljs-selector-tag"><span class="hljs-selector-tag">A</span></span><span class="hljs-selector-id"><span class="hljs-selector-id">#BC</span></span><span class="hljs-selector-id"><span class="hljs-selector-id">#E</span></span> #.# <span class="hljs-selector-tag"><span class="hljs-selector-tag">A</span></span>###<span class="hljs-selector-id"><span class="hljs-selector-id">#B</span></span> #.# #....# #.# #....# #.# #....# #.# <span class="hljs-selector-tag"><span class="hljs-selector-tag">C</span></span>###<span class="hljs-selector-id"><span class="hljs-selector-id">#E</span></span> #.# #.# <span class="hljs-selector-tag"><span class="hljs-selector-tag">A</span></span>####<span class="hljs-selector-id"><span class="hljs-selector-id">#BC</span></span><span class="hljs-selector-id"><span class="hljs-selector-id">#E</span></span> #.....# <span class="hljs-selector-tag"><span class="hljs-selector-tag">A</span></span>##<span class="hljs-selector-id"><span class="hljs-selector-id">#B</span></span> #.....# #...# #.....# <span class="hljs-selector-tag"><span class="hljs-selector-tag">C</span></span>##<span class="hljs-selector-id"><span class="hljs-selector-id">#E</span></span> #.....# <span class="hljs-selector-tag"><span class="hljs-selector-tag">C</span></span>####<span class="hljs-selector-id"><span class="hljs-selector-id">#E</span></span></code> </pre><br>  Nesse caso, a sala "raiz", criada originalmente, era a mais baixa. <br><br>  Em seguida, as informa√ß√µes do corredor coletadas anteriormente s√£o aplicadas.  Uma linha √© desenhada entre cada par de pontos gravados.  Quando cruza uma parede, <code>'D'</code> escrito e, quando cruza um bloco s√≥lido, <code>','</code> .  Os corredores t√™m uma largura aleat√≥ria: 1, 2 ou 3. Os ladrilhos de canto s√£o usados ‚Äã‚Äãpara auxiliar na navega√ß√£o. <br><br>  Se as portas estiverem adjacentes a outra porta, elas ser√£o puladas e os corredores poder√£o se sobrepor, o que permite ocultar a simplicidade do gerador. <br><br>  Ap√≥s gravar todos os corredores, o cart√£o ASCII √© limpo.  Os ladrilhos de canto se tornam ladrilhos, e os ladrilhos <code>' '</code> ao lado de <code>','</code> tamb√©m se tornam paredes.  Finalmente, os caracteres <code>','</code> s√£o substitu√≠dos pelos caracteres <code>'.'</code>  .  Ent√£o, temos o plano de masmorra mostrado abaixo. <br><br><pre> <code class="hljs css">#### #..# ###### #..# #....# #..# #....# <span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>## #....# #.# <span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>#### #<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>#### #..# #.....# #..# ###.....# #<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>######## #<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>.....# #........# #.#.....# #........# ### #.#<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>#### #........# #.### #.##...# #........###<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>.# #.##...# #........##..#.# #.##...# #........##..#.# #.##...# #........##..#.# #.##...# #........##..#.# #.##...# ##<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>#######..#.# #.##...# #.......#..#.# #.##<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>## ###.....#..### #.# #.# ######<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>##.# #.# #.# #....#.# #.# #.# #...<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>.# #.# #.# #....###### #.# #.# #<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>####....## #.# #.# #...........# #.# #.# ####....##<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>####.# ### ######.....##.# #####<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>.....##.# #..<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>.#....<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>..# #####.#.....#### #########</code> </pre><br>  Como voc√™ pode ver, esse procedimento pode deixar bastante espa√ßo vazio no mapa.  Portanto, o pr√≥ximo passo do gerador √© "preencher os vazios".  Ele procura por se√ß√µes de parede adjacentes nas quais ret√¢ngulos de piso adicionais possam ser colados.  Os ret√¢ngulos podem ter pelo menos 5 √ó 5 e n√£o mais de 12 √ó 14 em tamanho. <br><br>  O preenchimento de vozes continua at√© que um m√≠nimo de 700 blocos seja obtido ou o limite de novas tentativas seja atingido.  Se o gerador falhar em atingir 700 pe√ßas, a gera√ß√£o de masmorras come√ßar√° do zero. <br><br>  Isso nos d√° o espa√ßo em branco mostrado abaixo. <br><br><pre> <code class="hljs css"> ########## #........# ########### #........# #.........# #........# #.........# #........# #.........# #### #........# #.........# #..# #######..###.........# #..# #..............# #..# #..............# <span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>## #..............# #.# <span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>####.........# #<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>#### #..# ########### #.....# #..# ###.....# #<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>######## #<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>.....# #........# #.#.....# ########........# ### #.#<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>#### #...............# #.### #.##...# #...............###<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>.# #.##...# #...............##..#.# #.##...# #...............##..#.# #.##...# #...............##..#.# #.##...# #...............##..#.# #.##...# #......##<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>#######..#.# #.##...# #......# #.......#..#.# #.##<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>## #......# ###.....#..### #.# #.# #......########<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>##.# #.# #.# #.........# #....#.# #.# #.# #.........# #...<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>.# #.# #.# #.........# #....###### #.# #.# #.........# #<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>####....## #.# #.# #.........# #...........# #.# #.# #.........# ####....##<span class="hljs-selector-id"><span class="hljs-selector-id">#D</span></span>####.# ### #.........# ######.....##.# #.........# #####<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>.....##.# #.........# #..<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>.#....<span class="hljs-selector-class"><span class="hljs-selector-class">.D</span></span>..# ########### #####.#.....#### #########</code> </pre><br><h2>  Calabou√ßo </h2><br>  Novamente, as catacumbas s√£o diferentes da f√≥rmula de n√≠vel padr√£o.  Em vez do algoritmo de quadrados de marcha (que atribui blocos com base em 2 √ó 2 quadrados do espa√ßo em branco da masmorra), ele usa seu pr√≥prio procedimento de correspond√™ncia de padr√µes, que examina cada um dos ret√¢ngulos 3 √ó 3 do espa√ßo em branco da masmorra e seleciona o bloco correspondente para a masmorra.  Os padr√µes determinam o que cada ladrilho de calabou√ßo deve ser: uma parede, piso, porta, ladrilho s√≥lido ou uma combina√ß√£o deles.  Eu n√£o entendo bem o porqu√™. <br><br>  O restante da fun√ß√£o lhe parecer√° familiar da Catedral.  Escadas para cima e para baixo s√£o colocadas no mapa, a masmorra √© verificada quanto √† possibilidade de passagem completa e v√°rias corre√ß√µes tamb√©m s√£o realizadas.  Conforme descrito na se√ß√£o Recursos gerais, as salas s√£o inseridas, seguidas por muitos mini-conjuntos e substitui√ß√µes de ladrilhos. <br><br>  Eu acho que os mini-sets de alguma forma afetam as portas, mas s√£o muito chatos de ler sem ferramentas, ent√£o eu n√£o me aprofundei neste t√≥pico. <br><br><h1>  Cavernas </h1><br>  Os n√≠veis das cavernas s√£o preenchidos com vastos espa√ßos abertos e rios de lava.  As paredes desta √°rea s√£o √°speras e onduladas.  Os √∫nicos componentes retangulares aqui s√£o os andaimes de madeira, que aparentemente apareceram depois das pr√≥prias cavernas. <br><br>  Esta fase √© uma das mais bonitas do jogo, gra√ßas √† lava animada.  Sente-se que √© muito diferente dos n√≠veis anteriores compostos por quartos.  Portanto, fiquei muito surpreso que a parte principal da gera√ß√£o seja modelada de acordo com os princ√≠pios do palco da Catedral, e as cartas tenham uma apar√™ncia mais "caverna" usando truques complicados. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b6/b2c/a41/9b6b2ca41b1a48ad9aebcd9be48ee162.jpg" alt="imagem"></div><br><h2>  Calabou√ßo em branco </h2><br>  A cria√ß√£o de um n√≠vel de caverna come√ßa com uma sala 2 √ó 2 aleat√≥ria, localizada em algum lugar pr√≥ximo ao centro do mapa.  O gerador chama o procedimento <code>DRLG_L3CreateBlock</code> para cada borda deste bloco. <br><br>  Ao desenhar ret√¢ngulos nesse n√≠vel, o preenchimento normal n√£o √© usado.  Os interiores s√£o sempre s√≥lidos, mas cada ladrilho na borda tem 50% de chance de se tornar um piso, caso contr√°rio, permanece s√≥lido. <br><br><h3>  Procedimento DRLG_L3CreateBlock </h3><br><ul><li>  Essa fun√ß√£o obt√©m a borda do ret√¢ngulo, ou seja,  ponto de partida, dire√ß√£o e comprimento. </li><li>  O tamanho do bloco rec√©m-criado √© selecionado no intervalo de 3-4 para cada lado. </li><li>  O novo bloco √© colocado aleatoriamente em rela√ß√£o √† borda de entrada. </li><li>  Se n√£o houver espa√ßo suficiente para desenhar um bloco, a sa√≠da ser√° realizada. </li><li>  O bloco est√° desenhado. </li><li>  Com uma probabilidade de 1/4, a sa√≠da √© executada. </li><li>  <code>DRLG_L3CreateBlock</code> √© chamado <code>DRLG_L3CreateBlock</code> para tr√™s arestas, al√©m da de onde viemos. </li></ul><br>  Embora esse procedimento seja semelhante ao <code>L5roomGen</code> , o uso de um tamanho de bloco muito menor e o desenho de bordas grossas proporcionam uma apar√™ncia muito mais org√¢nica.  Al√©m disso, ele n√£o inclui uma borda de 1 ladrilho para paredes; portanto, diferente dos geradores anteriores, ele pode criar loops. <br><br>  Ap√≥s criar um esbo√ßo aproximado da forma da masmorra, o gerador aplica os procedimentos de eros√£o: <br><br><ul><li>  Primeiro, ele encontra √°reas de ladrilhos 2 √ó 2 com ladrilhos s√≥lidos na diagonal oposta.  Muitas vezes, √© dif√≠cil trabalhar com essas forma√ß√µes ao executar quadrados de marcha; portanto, um dos ladrilhos s√≥lidos √© substitu√≠do aleatoriamente por sexo. </li><li>  Todos os ladrilhos √∫nicos s√≥lidos cercados por 8 pisos s√£o substitu√≠dos por um piso. </li><li>  Todas as se√ß√µes longas e retas das paredes s√£o desbastadas aleatoriamente, substituindo 50% das paredes por pisos. </li><li>  As diagonais de blocos cont√≠nuos s√£o eliminadas repetidamente. </li></ul><br>  Todos esses procedimentos adicionam mais ladrilhos para que o mapa fique mais aberto. <br><br>  Se tiver menos de 600 pisos, o mapa ser√° regenerado. <br><br><h2>  Calabou√ßo </h2><br>  Os espa√ßos em branco do calabou√ßo s√£o convertidos em ladrilhos usando quadrados de marcha.  Ao contr√°rio da Catedral e das Catacumbas, o conjunto de pe√ßas √© muito mais conveniente aqui e cont√©m quase todas as combina√ß√µes necess√°rias para a marcha dos quadrados.  N√£o h√° ladrilhos para paredes diagonalmente opostas, mas eles foram eliminados na fase da pe√ßa, para que nunca apare√ßam. <br><br>  Ent√£o, como sempre, existem muitos mini-sets.  O c√≥digo possui v√°rios mini-conjuntos que definem uma se√ß√£o separada de paredes e a substituem por estalagmites e pisos, o que aumenta a abertura dos espa√ßos. <br><br>  Lagos de lava s√£o adicionados.  O algoritmo procura uma se√ß√£o de parede adjacente usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">preenchimento</a> .  Se ele conseguir encontrar uma se√ß√£o de paredes / ladrilhos s√≥lidos com menos de 40 ladrilhos completamente cercados por ladrilhos, eles ser√£o substitu√≠dos por lava.  Se o lago de lava n√£o puder ser encontrado, a gera√ß√£o da masmorra come√ßar√° novamente. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/282/8a4/716/2828a4716c9319b5399e76ccb04b11a9.png"></div><br>  <i>Uma parede 3 √ó 3 se transforma em um lago de lava</i> <br><br>  Em seguida, v√°rios rios de lava s√£o adicionados.  O gerador faz v√°rias tentativas para desenhar um rio come√ßando no lago de lava e terminando na parede.  Os seguintes requisitos s√£o impostos ao rio: ele n√£o deve cruzar-se, o rio tem um comprimento de 7-100 ladrilhos e deve haver um local adequado para a ponte sobre ele.  O bloco da ponte garante que todo o mapa permane√ßa aceit√°vel.  Se houver espa√ßo no mapa, podem ser adicionados at√© quatro rios. <br><br>  Em seguida, s√£o colocados quartos tem√°ticos.  Nesta fase, as paredes das salas tem√°ticas s√£o cercas de madeira, pelas quais voc√™ n√£o pode passar, mas pode assistir.  A cerca de madeira tamb√©m √© usada nos dois procedimentos a seguir.  O primeiro coloca uma cerca em todas as se√ß√µes restantes das paredes, tendo se√ß√µes retas razoavelmente longas.  O segundo desenha uma linha de cercas no mapa, de uma parede para a outra, e depois insere a porta.  Ao contr√°rio do procedimento para gerar uma catedral, ele n√£o procura cantos para come√ßar a criar essas paredes. <br><br><h1>  Inferno </h1><br>  O inferno √© a perna final de Diablo.  Nele, a √™nfase principal j√° est√° nos monstros, e o design dos n√≠veis segue o caminho.  Esse est√°gio tem o menor conjunto de pe√ßas de todos, e a maior parte √© usada para enormes escadas e pentagramas.  Os n√≠veis infernais geralmente consistem em v√°rias salas quadradas e t√™m um layout sim√©trico. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/180/9a3/804/1809a38040316bde51bb114a03f10f99.png" alt="imagem"></div><br><h2>  Calabou√ßo em branco </h2><br>  A gera√ß√£o do inferno come√ßa com uma sala aleat√≥ria de 5 a 6 pe√ßas de cada lado (mais se houver um fragmento pronto para a miss√£o) e, em seguida, o mesmo brotamento recursivo √© aplicado como na Catedral.  No entanto, a gera√ß√£o √© limitada a 20 √ó 20. <br><br>  √â adicionado um corredor vertical e horizontal, esticado at√© a borda da √°rea 20 √ó 20. <br><br>  Em seguida, o espa√ßo em branco da masmorra √© espelhado horizontal e verticalmente para obter o tamanho completo. <br><br><h2>  Calabou√ßo </h2><br>  Os espa√ßos em branco do calabou√ßo s√£o novamente convertidos em ladrilhos usando quadrados de marcha.  Ent√£o, semelhante √† cria√ß√£o da catedral, paredes s√£o adicionadas, como nas catacumbas e cavernas. <br><br><h1>  Conclus√£o </h1><br>  Eu realmente gostei de ler este c√≥digo.  Embora haja obviamente bugs, os nomes s√£o atribu√≠dos aleatoriamente e algumas partes n√£o podem ser recriadas em c√≥digo-fonte de alta qualidade, √© claramente vis√≠vel que esse c√≥digo passou por um teste s√©rio em batalha e est√° cheio de id√©ias inteligentes. <br><br>  Aqui est√£o as li√ß√µes mais importantes para mim: <br><br><ul><li>  O diabo est√° nos detalhes: os componentes individuais n√£o s√£o insanamente complexos, mas quando combinados, eles d√£o algo maravilhoso.  Eu posso imaginar como os desenvolvedores se preocuparam em melhorar a qualidade at√© que os n√≠veis passassem de apenas bons para incr√≠veis.  O n√∫mero de blocos e a complexidade combinat√≥ria dos conjuntos de blocos tamb√©m √© muito alto - √© imposs√≠vel implement√°-lo sem aten√ß√£o √† maneira como os elementos est√£o conectados. </li><li>  Pesquisar e substituir a correspond√™ncia de padr√µes √© uma ferramenta muito poderosa com a qual voc√™ pode implementar muitos efeitos diferentes.  Ele corrige bugs de gera√ß√£o, adiciona variabilidade, insere conte√∫do pr√©-criado, gerencia eros√£o e muito mais. </li><li>  Dividir a gera√ß√£o da masmorra no mapa de pat√™ncia (prepara√ß√£o da masmorra) e gera√ß√£o de ladrilhos tamb√©m √© uma t√©cnica muito conveniente, tanto em termos de design quanto de depura√ß√£o. </li><li>       ,       .      ,         . </li><li>   ,      . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt460038/">https://habr.com/ru/post/pt460038/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt460020/index.html">O que √© o Deno e como esse projeto √© diferente do Node.js?</a></li>
<li><a href="../pt460022/index.html">PHP Digest No. 160 (1 a 15 de julho de 2019)</a></li>
<li><a href="../pt460028/index.html">Solu√ß√£o de problemas com pwnable.kr 04 - flag. Arquivos execut√°veis ‚Äã‚Äãempacotados</a></li>
<li><a href="../pt460030/index.html">Desenvolvimento nativo, React Native e Flutter: crit√©rios de sele√ß√£o</a></li>
<li><a href="../pt460036/index.html">A habilidade B2B de Alice: do prot√≥tipo ao primeiro rublo salvo</a></li>
<li><a href="../pt460040/index.html">Obter instru√ß√£o USRN do Rosreestr usando python, ignorando a API</a></li>
<li><a href="../pt460044/index.html">Controle de temperatura do aquecedor do forno, com temporizador no Arduino</a></li>
<li><a href="../pt460046/index.html">Compara√ß√£o do framework Python BDD: pr√≥s e contras</a></li>
<li><a href="../pt460048/index.html">Como criamos o gerenciamento de vulnerabilidades</a></li>
<li><a href="../pt460050/index.html">NeoQUEST 2019 face a face: no mundo da seguran√ßa cibern√©tica</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>