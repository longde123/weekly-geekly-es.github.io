<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüç≥ üôéüèæ üë©üèæ‚Äç‚úàÔ∏è Outro rel√≥gio inteligente com suas pr√≥prias m√£os ü¶Ä üö≥ üë®‚Äç‚úàÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inspirado h√° algum tempo pelo artigo "Rel√≥gios inteligentes com suas pr√≥prias m√£os para 1500r". , Tamb√©m decidi tentar criar um dispositivo semelhante...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Outro rel√≥gio inteligente com suas pr√≥prias m√£os</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/404737/"><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/web/603/ba0/2c4/603ba02c4cbf47ae94b451b9dedfdc7d.png"></a> </p><br><p>  Inspirado h√° algum tempo pelo artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Rel√≥gios inteligentes com suas pr√≥prias m√£os para 1500r".</a>  , Tamb√©m decidi tentar criar um dispositivo semelhante. </p><br><p>  Este artigo n√£o est√° posicionado como um guia de a√ß√£o ou instru√ß√£o, mas como uma indica√ß√£o dos pontos principais que eu tive que enfrentar.  Talvez para algu√©m isso sirva como fonte de inspira√ß√£o e informa√ß√µes √∫teis. </p><br><p>  Sele√ß√£o de componentes, layout de PCB, solda em condi√ß√µes adversas, estojo impresso em 3D e JavaScript no rel√≥gio - sob o corte.  Bem vindo! </p><a name="habracut"></a><br><h2 id="trebovaniya">  Exig√™ncias </h2><br><ul><li>  Voc√™ precisa descobrir o tempo sem precisar ir para o bolso atr√°s do telefone </li><li>  Deve haver um recebimento de notifica√ß√µes de chamadas recebidas, SMS e notifica√ß√µes de mensageiros instant√¢neos </li><li>  A dura√ß√£o da bateria deve ser de pelo menos uma semana </li><li>  Seja o mais compacto poss√≠vel </li></ul><br><p>  J√° com base nesta pequena lista de requisitos, voc√™ pode come√ßar a selecionar os componentes e esclarecer os recursos t√©cnicos da implementa√ß√£o.  O or√ßamento do projeto para tempo e finan√ßas n√£o era particularmente limitado, a produ√ß√£o em massa n√£o era planejada, para que voc√™ pudesse dar um passeio e n√£o se preocupar em economizar cada centavo. </p><br><p>  Al√©m do plano geral, havia tamb√©m puramente t√©cnicos: </p><br><ul><li>  Criando e executando aplicativos personalizados no rel√≥gio.  Como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">seixo</a> .  Em geral, daqui em diante, o rel√≥gio se parecer√° cada vez mais com um clone do Pebble, mas por que n√£o </li><li>  Mem√≥ria para aplicativos e seus dados </li><li>  Controle adequado do n√≠vel de carga para que o rel√≥gio n√£o se apague repentinamente quando a bateria estiver descarregada, mas mostra "palitos" e √© avisado com anteced√™ncia </li><li>  Aceler√¥metro, girosc√≥pio e magnet√¥metro para rastreamento completo do movimento do usu√°rio.  Ser capaz de fazer um ped√¥metro ou um despertador inteligente que monitore as fases do sono pela presen√ßa de movimento </li></ul><br><p>  Tudo isso acabou se cristalizando em um pequeno diagrama: </p><br><p><img src="https://habrastorage.org/web/6b6/b29/8b4/6b6b298b4ae848cf84df6ab2bb900ee1.png"><br>  <em>O microcontrolador combina o BLE 4.x para comunica√ß√£o com um smartphone, os barramentos I¬≤C e SPI para sensores e um display com mem√≥ria, controla a vibra√ß√£o e responde ao pressionamento de bot√µes, tudo √© alimentado por uma bateria de Li-Po.</em> </p><br><p>  Agora voc√™ pode iniciar o processo de sele√ß√£o de chips e pe√ßas.  Em termos de m√£o-de-obra e tempo gasto, foi o processo mais dif√≠cil e demorado, foi necess√°rio comparar muito, pesquisar e mergulhar de cabe√ßa para onde eu nunca havia nadado antes. </p><br><h2 id="vybor-komponentov">  Sele√ß√£o de componentes </h2><br><h3 id="mikrokontroller">  Microcontrolador </h3><br><p>  Primeiro de tudo, voc√™ precisa escolher um controlador que ser√° o "c√©rebro" do dispositivo e tudo o mais no quadro o servir√° para o bem. </p><br><p>  Para tornar o dispositivo mais compacto, √© necess√°rio usar o m√≠nimo de componentes e m√≥dulos poss√≠vel.  Aqui, v√°rios <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sistemas em um chip</a> v√™m em socorro, que combinam a funcionalidade de um m√≥dulo bluetooth e um microcontrolador. </p><br><div class="spoiler">  <b class="spoiler_title">O que o mercado nos oferece?</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/979/a27/5f2/979a275f28bf4e8fade3f573c1677038.png" alt="imagem"><br>  <em>Fonte: www.argenox.com</em> </p><br><ul><li>  ARM Cortex-M0 do n√∫cleo <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cypress PSoC BLE</a></strong> , BLE 4.2, 256kB FLASH, 32kB RAM, um monte de perif√©ricos e um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">balun</a> integrado, uma ampla faixa de tens√£o de alimenta√ß√£o: 1,9-5 volts </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Inst√¢ncias do Texas CC2541</a></strong> - BLE 4.0 e 8051-core, 256kB FLASH, 8kB RAM </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Texas Instruments CC2640</a></strong> - BLE 4.1, Cortex-M3, 128kB FLASH, 20kB RAM </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Caixa de di√°logo DA-14580</a></strong> - Cortex-M0, BLE 4.1, 16 MHz, 42 + 8kB de RAM, 32kB OTP (mem√≥ria program√°vel √∫nica, mas √© poss√≠vel executar o c√≥digo de um SPI FLASH externo), o chip menor e menos consumidor dos itens acima </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SiLabs EFR32</a></strong> - Cortex-M4F, 40 MHz, BLE 4.x, Bluetooth 5, at√© 1MB FLASH, at√© 256kB de RAM </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Nordic nRF52832</a></strong> - Cortex-M4F, 64MHz, BLE 4.x, Bluetooth 5, 512kB FLASH, 64kB de RAM, emula√ß√£o de tags NFC, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bal√£o</a> integrado </li></ul></div></div><br><p>  No monte de decis√µes saborosas e <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">poucas</a></strong> , a escolha caiu no <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nRF52832</a></strong> , este chip acabou sendo o mais produtivo e bastante conveniente em termos de caixa (6x6mm QFN de 48 pinos).  Uma op√ß√£o elegante que simplifica bastante a fia√ß√£o da placa √© a capacidade de atribuir programaticamente quaisquer perif√©ricos a qualquer um dos pinos GPIO.  Isso √© algo que muitos microcontroladores n√£o possuem.  Gra√ßas ao suporte √† NFC, voc√™ pode adicionar a funcionalidade de um emulador de NFC ao rel√≥gio e costurar todas as suas placas de passe no rel√≥gio. </p><br><p><img src="https://habrastorage.org/web/e58/636/0f5/e586360f52d647bc83189ba795011014.jpg"></p><br><p>  A folha de dados diz que h√° um RTC embutido (rel√≥gio em tempo real), isso √© conveniente.  Mas depois descobriu-se que este n√£o √© um rel√≥gio, mas um <em>contador em</em> tempo real, ou seja.  Este √© o cron√¥metro mais comum, operando em quartzo de 32.768kHz, inclusive no modo de suspens√£o.  Portanto, na pr√≥xima revis√£o do dispositivo, usarei um chip separado para o RTC, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">STMicroelectronics M41T62LC6F</a> .  Possui quartzo embutido em 32.768kHz e funciona na interface I¬≤C. </p><br><p>  A <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">placa de</a> depura√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nRF52-DK</a> custa muito <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">barato</a> , cerca de 4 mil.  rublos.  No Aliexpress pode ser encontrado por ~ 3tys. </p><br><div class="spoiler">  <b class="spoiler_title">By the way</b> <div class="spoiler_text"><p>  Como o dispositivo n√£o envolve produ√ß√£o em massa e nenhuma venda no mercado, desenhar sua pr√≥pria placa e desenvolver sua solu√ß√£o no BLE SoC √© uma tarefa fascinante, sem consequ√™ncias s√©rias.  Para quem deseja entrar rapidamente no mercado, √© recomend√°vel usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">m√≥dulos pr√©-certificados prontos</a> . </p><br><p>  H√° v√°rias raz√µes para isso e elas est√£o associadas ao r√°dio: para qualquer novo dispositivo eletr√¥nico no mercado, √© necess√°rio obter permiss√£o e passar a certifica√ß√£o de reguladores como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CE</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">FCC</a> . <br><img src="https://habrastorage.org/web/024/c98/5d7/024c985d746a4223b8dba41f7ec4d1f5.jpg" alt="Logotipos de reguladores, frequentemente encontrados no estojo do dispositivo"></p><br><p>  As alegrias que acompanham incluem um layout especial da placa, levando em considera√ß√£o as caracter√≠sticas de propaga√ß√£o de sinais com uma frequ√™ncia de 2,4 GHz, blindagem, medi√ß√µes em uma c√¢mara anec√≥ica, correspond√™ncia de imped√¢ncias e outras magias de microondas.  Nos m√≥dulos finalizados, todo esse trabalho j√° foi realizado por seus desenvolvedores, o usu√°rio s√≥ precisa incorporar o m√≥dulo em sua solu√ß√£o e n√£o h√° necessidade de certificar nada. </p></div></div><br><h3 id="kvarcevye-rezonatory">  Ressonadores de quartzo </h3><br><p>  Os ressonadores de quartzo s√£o conectados ao chip nRF52832 selecionado: </p><br><ol><li>  A 32 MHz para sincronizar o n√∫cleo e o r√°dio, √© necess√°rio </li><li>  A 32.768kHz para registrar o rel√≥gio e os intervalos de tempo BLE durante o modo de suspens√£o.  Opcional, mas sua conex√£o reduz o consumo de energia (os intervalos de tempo podem ser reduzidos) e aumenta a precis√£o do rel√≥gio RTC. </li></ol><br><p>  Ambos os tipos de quartzo s√£o pedidos em um suporte de montagem em superf√≠cie com o Aliexpress: </p><br><div class="spoiler">  <b class="spoiler_title">Imagem</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/46f/ab8/e9c/46fab8e9c84641629e77bb14ddf5c620.png"></p></div></div><br><h3 id="displey">  Exibi√ß√£o </h3><br><p>  Para que o rel√≥gio funcione sem recarregar por pelo menos uma semana, √© necess√°rio resolver o problema de que a matriz de exibi√ß√£o consome muita corrente no modo de opera√ß√£o.  Pelo que entendi, os fabricantes de rel√≥gios resolvem esse problema de duas maneiras: </p><br><ol><li>  Ligue a tela e exiba o conte√∫do somente quando ocorrer um movimento do ponteiro e a tela do rel√≥gio cair no campo de vis√£o do usu√°rio ou quando a aten√ß√£o do usu√°rio j√° tiver sido atra√≠da, por exemplo, por uma notifica√ß√£o ou um despertador </li><li>  Exiba o conte√∫do constantemente, usando monitores que praticamente n√£o consomem corrente para exibir a imagem e consuma apenas para atualizar o conte√∫do.  Voc√™ n√£o precisa ir longe para obter exemplos: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tinta eletr√¥nica</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Memory LCD</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">IMOD / mirasol</a> </li></ol><br><div class="spoiler">  <b class="spoiler_title">O que o mercado nos oferece?</b> <div class="spoiler_text"><p>  Para a op√ß√£o em que a tela na maioria das vezes √© trabalho de Malevich, existem op√ß√µes no mercado: OLED, TFT, Amoled, m√≥dulos de telefone LCD (Nokia, Siemens etc.).  Resta encontrar uma tela com uma diagonal adequada. </p><br><p>  Exemplos: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pequenos displays OLED</a> , como o Ali Express, custam um centavo. <br>  Um monte de desvantagens: pequena diagonal, monocrom√°tica, consumo 10-20mA, m√≥dulo volumoso.  Sem uma placa de m√≥dulo - um loop amplo e um mar de cintas, que absorver√£o uma parte significativa da √°rea na placa. </li><li>  LCD TFT, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ILI9341</a> .  Das desvantagens: consumo, loop amplo </li></ul><br><p>  As telas no E-Ink desapareceram imediatamente, porque a velocidade de atualiza√ß√£o da tela √© muito lenta, o monocrom√°tico e, provavelmente, √© dif√≠cil encontrar um display de E-Ink bastante pequeno no mercado aberto. </p><br><p>  Se voc√™ olhar no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pebble</a> , poder√° ver que ele usa a tela "Sempre ligada".  O Pebble Classic usa uma tela <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LCD</a> monocrom√°tica <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SHARP Memory</a> , a Pebble Time usa uma tela colorida (64 cores) usando uma tecnologia semelhante, mas produzida pela <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JDI</a> , ela n√£o est√° √† venda. </p><br><p>  Em rela√ß√£o ao IMOD / Mirasol, a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Qualcomm</a> n√£o encontrou nada al√©m de folhetos de marketing e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">rel√≥gios Toq da Qualcomm</a> . </p></div></div><br><p>  Eu queria ter uma tela colorida como o Pebble Time.  O anal√≥gico mais pr√≥ximo, que est√° √† venda, foi o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SHARP LS013B7DH06</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sua folha de dados</a> ). </p><br><p><img src="https://habrastorage.org/web/843/c78/b5e/843c78b5e870402cbba399bdede1fb0e.JPG"></p><br><p>  Caracter√≠sticas </p><br><ul><li>  Diagonal 1,33 " </li><li>  Resolu√ß√£o: 128x128, 8 cores (3 bits por pixel) </li><li>  Dimens√µes: 26.82x31.3mm </li><li>  Interface: SPI </li><li>  Tens√£o de alimenta√ß√£o: 5V, mas n√≠veis l√≥gicos SPI de 2,7V </li></ul><br><p>  A emboscada acabou com a tens√£o de alimenta√ß√£o, uma vez que a bateria de Li-Po n√£o recebe a tens√£o de 5V necess√°ria sem conversores de impulso adicionais.  Mas a corrente na tela √© escassa e obter os 5V necess√°rios √© bastante simples com uma bomba de carga como a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Linear LTC1754-5</a> : </p><br><p><img src="https://habrastorage.org/web/4fa/599/9d6/4fa5999d699540c1b25fdcf02d5ccc36.jpg"><br>  Outro recurso foi a necessidade de alternar o estado do pino EXTCOMIN (Invers√£o externa do COM) pelo menos uma vez por segundo de um n√≠vel alto para um n√≠vel baixo e vice-versa, para que a carga n√£o se acumulasse no painel da tela e a imagem n√£o congelasse em um ponto.  Para esses fins, voc√™ pode descartar o PWM (PWM) embutido do microcontrolador, ajustado para um ciclo de trabalho de 50% (onda quadrada) e uma frequ√™ncia de 1Hz ou superior, ou qualquer outro gerador de onda quadrada (inclusive externo). </p><br><p>  O monitor √© conectado √† placa usando um cabo pequeno, √© muito conveniente usar um conector FPC de 10 pinos em incrementos de 0,5 mm, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Hirose FH12-10S-0.5SH</a> : </p><br><p><img src="https://habrastorage.org/web/cd6/c7e/1d8/cd6c7e1d8d6e41e9af61a05b705f9ea0.jpg"><br>  O m√≥dulo de exibi√ß√£o n√£o possui luz de fundo pr√≥pria e n√£o brilha atrav√©s dos LEDs como uma tela LCD comum; portanto, por enquanto n√£o temos tempo para assistir ao rel√≥gio sem luz de fundo.  <em>Se algu√©m estiver familiarizado com o processo de cria√ß√£o de um m√≥dulo de luz de fundo para esse tipo de tela, responda.</em> </p><br><h3 id="akkumulyator">  Bateria </h3><br><p>  Eu tive que gastar algum tempo escolhendo a bateria do tamanho certo da faixa padr√£o de tamanhos.  Eu estava procurando uma bateria de pol√≠mero de l√≠tio com uma tens√£o de 3,7V e uma capacidade de aproximadamente 100mAh. </p><br><p>  A bateria foi planejada para ser colocada embaixo da placa, sabendo o tamanho da placa, voc√™ pode facilmente pegar uma bateria que encaixe e n√£o fique com nada. </p><br><div class="spoiler">  <b class="spoiler_title">O que o mercado oferece?</b> <div class="spoiler_text"><p>  No Aliexpress, voc√™ pode solicitar um monte de baterias para praticamente qualquer tamanho, o principal √© conhecer o sistema de codifica√ß√£o de seus nomes.  E √© assim: HHWWLL, onde HH √© a espessura (altura) da bateria em d√©cimos de mil√≠metro, WW √© sua largura e LL √© seu comprimento em mil√≠metros. </p><br><p>  Exemplo: 402025 - bateria com uma espessura de 4 mm e um tamanho de 20x25 mm <br><img src="https://habrastorage.org/web/a8b/a4e/129/a8ba4e1299df4be69ab9048680ae8da4.png"></p></div></div><br><p>  <strong>302025</strong> (3x20x25mm) baterias com capacidade de 110mAh foram selecionadas e encomendadas no Aliexpress. </p><br><p><img src="https://habrastorage.org/web/b54/87c/266/b5487c2667514d8ea864e303af4fcc54.png"></p><br><h3 id="pitanie">  Nutri√ß√£o </h3><br><p>  Como as baterias de pol√≠mero de l√≠tio fazem sentido para descarregar apenas at√© 3 volts, foi decidido alimentar todo o circuito a partir de 3V estabilizados e se a tens√£o na bateria cair abaixo de 3V, desligue o regulador de energia principal do chip de prote√ß√£o ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Maxim MAX809TEUR + T</a> ). </p><br><p>  A tens√£o total de alimenta√ß√£o de 3V se encaixa nas faixas de pot√™ncia de todos os elementos do circuito, exceto no display, que precisa de 5V.  Portanto, a tela √© alimentada atrav√©s do conversor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">linear LTC1754-5</a> boost diretamente da bateria. </p><br><p>  Se voc√™ observar a curva de descarga desse tipo de bateria, <br><img src="https://habrastorage.org/web/6f9/d21/e2c/6f9d21e2cd6b475b913667c1f667fe32.gif"></p><br><p>  pode ser visto que toda a capacidade da bateria cai na faixa de tens√£o de ~ 4V a 3V, portanto, um conversor de redu√ß√£o convencional de 3V ser√° suficiente para fornecer ao sistema uma voltagem est√°vel e, ao mesmo tempo, sugar efetivamente toda a energia da bateria sem deixar nada, mas sem descarregar demais . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Texas Instruments TPS78230DRVT</a> foi escolhido como um conversor abaixador, possui uma pequena corrente operacional de 500nA e uma corrente m√°xima de 150mA, o que √© suficiente.  O gabinete do SON-6 √© compacto e bastante pag√°vel: </p><br><p><img src="https://habrastorage.org/web/f31/c89/056/f31c89056e624439af40162263e57c18.jpg"></p><br><h3 id="zaryadka-akkumulyatora">  Carga da bateria </h3><br><p>  Foi decidido carregar a bateria atrav√©s de uma porta microUSB padr√£o ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Molex 47346-0001</a> ), mas n√£o basta conectar a bateria diretamente ao barramento USB de 5V e carreg√°-la assim, √© necess√°rio garantir o processo de carregamento correto, dividido em v√°rias fases: pr√©-condicionamento, corrente constante, constante tens√£o. </p><br><div class="spoiler">  <b class="spoiler_title">Perfil de carregamento t√≠pico para uma bateria de 180mAh</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/f70/022/db6/f70022db6ac747c089c50bfa34320854.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">Boa explica√ß√£o do processo de carregamento no EEVBlog</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/A6mKd5_-abk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><p>  Uma solu√ß√£o popular para carregar baterias de pequena capacidade (at√© 500mAh) √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">chip Microchip MCP73831</a> .  A corrente de carregamento (dependendo da capacidade da bateria) √© programada por um resistor; h√° uma sa√≠da de estado triplo ou de dreno aberto para notific√°-lo do in√≠cio e do fim do processo de carregamento. </p><br><p>  Eu tamb√©m escolhi outro chip - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Maxim MAX1555EZK-T</a> .  Possui uma corrente de carga fixa de 100mAh e o mesmo compartimento do chip de microchip, al√©m de exigir um m√≠nimo de componentes externos e uma sa√≠da de dreno aberto para notificar sobre o processo de carregamento: </p><br><p><img src="https://habrastorage.org/web/b33/64a/b80/b3364ab804ef4332abb7c68fdd9452d8.jpg"></p><br><div class="spoiler">  <b class="spoiler_title">Imagem da folha de dados</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/092/c7b/994/092c7b994d134222a43096e9eaa4fa22.png"></p></div></div><br><p>  Na pr√≥xima revis√£o da placa, ainda mudarei para o chip de microchip, porque a corrente de carga de 100mA para uma bateria de 110mAh provavelmente √© um pouco demais. </p><br><h3 id="kontroller-yomkosti-akkumulyatora">  Controlador de capacidade da bateria </h3><br><p>  Existem v√°rias t√©cnicas para monitorar o grau de carga da bateria que s√£o um pouco diferentes na execu√ß√£o e precis√£o do resultado final (em fontes em ingl√™s, isso √© chamado de estado de carga): </p><br><div class="spoiler">  <b class="spoiler_title">Lista</b> <div class="spoiler_text"><ol><li><p>  Me√ßa o chamado  tens√£o de circuito aberto / OCV (tens√£o nas placas) da bateria atrav√©s do ADC e fa√ßa uma conclus√£o sobre a capacidade da bateria.  Na maioria das vezes, √© necess√°rio transferir a faixa de tens√£o para uma √°rea aceit√°vel para a opera√ß√£o do ADC usando um divisor de tens√£o.  As desvantagens dessa abordagem s√£o que o gr√°fico de tens√£o versus capacidade das baterias de pol√≠mero de l√≠tio √© bastante plano, e as pr√≥prias leituras mudam a cada ciclo e est√£o sujeitas a ru√≠do e incapacidade de medir a tens√£o real nas placas devido √† influ√™ncia da corrente de carga </p><br></li><li><p>  Outra maneira √© medir a corrente que entra e sai da bateria em vez de medir a tens√£o nas placas.  Esta √© a chamada contagem de coulomb.  Uma solu√ß√£o t√≠pica √© integrar o valor da queda de tens√£o em um pequeno resistor de deriva√ß√£o de resist√™ncia (cerca de 100 mOhm).  Conhecendo a capacidade da bateria, pela corrente que saiu dela por um certo per√≠odo de tempo, podemos concluir quanto mais energia resta na bateria (negligenciando a autodescarga).  As desvantagens dessa abordagem s√£o que a descarga autom√°tica n√£o √© levada em considera√ß√£o, al√©m do fato de que a capacidade real da bateria muda a cada ciclo de descarga de carga.  Grosso modo, menos corrente flui da bateria do que flui para ela durante o carregamento.  Por esse motivo, com o tempo, um erro nas leituras inevitavelmente se acumular√°. </p><br></li><li>  A combina√ß√£o dos primeiro e segundo m√©todos: medi√ß√£o e tens√£o nas placas e a corrente que flui.  Uma combina√ß√£o competente das duas abordagens ajudar√° a construir um modelo que avaliar√° a capacidade da bateria com boa precis√£o.  Para que essa abordagem funcione, √© necess√°rio produzir pelo menos um ciclo de carga-descarga para coletar dados sobre a depend√™ncia da tens√£o entre as placas na capacit√¢ncia.  Al√©m disso, cada pr√≥ximo ciclo precisar√° fazer altera√ß√µes no modelo da bateria para que o erro n√£o se acumule.  Existem artigos nos quais as pessoas contam como, usando o filtro Kalman, dados de diferentes medidas foram combinados para prever a carga restante ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[1]</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[2]</a> ) </li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">O que o mercado nos oferece?</b> <div class="spoiler_text"><ul><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Maxim MAX17043</a></strong> - usando um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">algoritmo propriet√°rio</a> para voltagem nas placas, constr√≥i um modelo de bateria dentro de si.  Promete precis√£o na medi√ß√£o da carga restante de 3%.  Interface I¬≤C.  Corpo bonito e pequeno </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OnSemi LC709203F</a></strong> - mede a interface OCV, I¬≤C, precis√£o de 2,8%, h√° compensa√ß√£o de temperatura atrav√©s de um termistor externo.  Caro e ruim na R√∫ssia </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Texas Instruments BQ27621</a></strong> - mede a tens√£o nas placas, I¬≤C, precis√£o n√£o especificada, dispendioso, pacote BGA </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Texas Instruments BQ27421</a></strong> - mede simultaneamente a tens√£o e o fluxo de corrente.  Interface I¬≤C, precis√£o n√£o especificada, pacote BGA caro </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LTC2941 linear</a></strong> - mede a corrente de fluxo, interface I¬≤C, precis√£o de 1%, requer adicionalmente um resistor de deriva√ß√£o externo (integrado no LTC2941-1), caixa: 2x3mm DFN-6 </li></ul></div></div><br><p>  Das op√ß√µes dispon√≠veis, o chip <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Linear LTC2941</a> foi escolhido para o menor caso, mas pag√°vel, e um algoritmo de trabalho claro.  Encomenda no Aliexpress. </p><br><div class="spoiler">  <b class="spoiler_title">Imagem da folha de dados</b> <div class="spoiler_text"><p><img src="http://cds.linear.com/image/8650.png" alt="imagem"><br>  <em>Fonte: Tecnologia Linear</em> </p></div></div><br><p>  O microcircuito usa a t√©cnica do contador coulomb e conta a corrente fluida com uma precis√£o de 1%, funciona via interface I¬≤C (SMBus) e possui uma caixa pequena mas conveniente: 2x3mm DFN-6: <br><img src="https://habrastorage.org/web/348/3e8/90b/3483e890b3e34789ad68abaa6cf19c0a.jpg"></p><br><p>  Atrav√©s de I¬≤C dentro do microcircuito, voc√™ pode definir o valor da contraparte atual do medidor, bem como definir ou ler o valor do pr√≥prio contador.  O contador √© de 16 bits e aumenta quando a corrente entra na bateria e diminui quando a corrente sai da bateria.  O valor m√°ximo do contador (0xFFFF) pode ser considerado como uma bateria totalmente carregada e o m√≠nimo (0x0000) como uma bateria totalmente descarregada.  Com um pr√©-seletor de contador bem escolhido, √© poss√≠vel conseguir que o contador atinja seu m√°ximo durante o carregamento e atinja zero quando a bateria estiver completamente descarregada.  √â poss√≠vel definir o limite do valor do contador, abaixo do qual o microcircuito tocar√° um alarme e dar√° uma interrup√ß√£o. </p><br><h3 id="akselerometr">  Aceler√¥metro </h3><br><p>  Entre o monte de op√ß√µes no mercado, foi escolhido um chip bastante popular: o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">InvenSense MPU-9250</a> .  Este √© um sistema em um caso (SiP), combinando aceler√¥metro MEMS, girosc√≥pio MEMS e chip de magnet√¥metro. </p><br><p><img src="https://habrastorage.org/web/1d8/c0d/685/1d8c0d6854a7433e9d6ccb6e2ffebf08.png"></p><br><div class="spoiler">  <b class="spoiler_title">Caracter√≠sticas</b> <div class="spoiler_text"><ul><li>  Tens√£o de alimenta√ß√£o de 2.4V a 3.6V </li><li>  Aceler√¥metro MEMS de tr√™s eixos e 16 bits com faixas de medi√ß√£o de ¬± 2g, ¬± 4g, ¬± 8g, ¬± 16g </li><li>  Girosc√≥pio MEMS de tr√™s eixos e 16 bits at√© 2000 ¬∞ / s </li><li>  Magnet√¥metro de tr√™s eixos e 16 bits com faixa de medi√ß√£o de at√© ¬± 4800ŒºT </li><li>  Filtros Digitais Integrados </li><li>  Interfaces I¬≤C e SPI </li><li>  Interrup√ß√µes program√°veis </li><li>  Co-processador para leitura de DMP (Digital Motion Processor) </li></ul></div></div><br><p>  O chip √© excelente, mas no final parecia um exagero e um aceler√¥metro simples √© suficiente para uso em um rel√≥gio.  Por exemplo, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ADXL362 anal√≥gico</a> - de acordo com o fabricante, este √© o aceler√¥metro MEMS de tr√™s eixos mais econ√¥mico. </p><br><h3 id="flesh-pamyat">  Mem√≥ria flash </h3><br><p>  Decidiu-se usar a mem√≥ria SPI-FLASH externa para aplicativos e dados.  Entre v√°rias op√ß√µes, o chip <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Winbond W25Q256FV</a> no pacote compacto WSON-8 foi escolhido: </p><br><p><img src="https://habrastorage.org/web/7ca/6f6/617/7ca6f6617c454838be1f4b0ee964779f.jpg"></p><br><p>  A quantidade de mem√≥ria flash √© de 256 megabytes (ou 32 megabytes), √© suficiente.  A mem√≥ria √© dividida em p√°ginas de 256 bytes, agrupadas em setores de 4 kilobytes e blocos de 32 kilobytes.  No modo ativo (leitura ou grava√ß√£o), ele consome at√© 20mA, no modo de espera - menos de 1ŒºA. </p><br><p>  Como no aceler√¥metro, mais tarde come√ßou a parecer que 32 megabytes tamb√©m √© um exagero e, em vez disso, voc√™ pode usar a mem√≥ria FLASH embutida do microcontrolador, ele j√° possui 512 kilobytes.         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>     . </p><br><h3 id="knopki">  </h3><br><p>  ,           (   Pebble,  ).             .          ,            : </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wealth Metal TD-26EA</a> : </p><br><p><img src="https://habrastorage.org/web/55f/13a/47d/55f13a47d7c6491094d471c3a94af858.jpg"><br> <em>: &amp;</em> </p><br><p>  ,              . </p><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Omron B3U-3000P</a> : </p><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/889/246/2d0/8892462d032444d691d70ef546c62743.png"></p></div></div><br><p>       . </p><br><h3 id="vibromotorchik">  </h3><br><p>     ,    ,  . </p><br><p>  Aliexpress       ,   3V   (HxWxL) 3x3x12mm: </p><br><div class="spoiler">  <b class="spoiler_title">Imagem</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/147/477/5c7/1474775c7260460896a4ea3b080e5571.jpg"></p></div></div><br><p>         ,    100mA      . </p><br><h3 id="antenna">  </h3><br><p> -     ,      -  .   ,      ,    .      ,          .    ,          . </p><br><p>   -  2.4GHz  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Johanson 2450AT18B100</a> : <br><img src="https://habrastorage.org/web/84b/dc7/0e5/84bdc70e556b490896f937b3aa23f574.jpg"></p><br><p> Em geral, essas antenas s√£o bastante populares, e os pr√≥prios Johanson tamb√©m produzem baluns especialmente otimizados para certos fabricantes, incluindo os n√≥rdicos.  Especialmente para o nRF52, a Johanson criou um filtro harm√¥nico <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Johanson 2450FM07A0029</a> , que substitui o filtro LC recomendado na frente da antena no design de refer√™ncia. </p><br><p>  As antenas foram encomendadas no Aliexpress com 10pcs de fita.  para 214r / fita. </p><br><h3 id="vsyo-ostalnoe">  Todo o resto </h3><br><p>  Os componentes passivos para suspens√≥rios e cintas s√£o principalmente chips dos tamanhos 0402 e 0603 e encomendados na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Elitan</a> .  Al√©m dos componentes passivos, existem dois transistores e um par de diodos na placa.  Eles participam no controle do motor de vibra√ß√£o, bem como no circuito de energia, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dissociando a energia USB e a bateria</a> . </p><br><h2 id="shema-i-plata">  Circuito e placa </h2><br><p>  <em>A apar√™ncia do quadro nas capturas de tela √© um pouco diferente do que foi pedido e est√° presente nas fotos do dispositivo.</em>  <em>As capturas de tela do painel s√£o uma revis√£o um pouco mais tarde, com pequenas altera√ß√µes.</em> </p><br><p>  Tendo decidido tentar algo novo, desenhei o circuito e a placa n√£o no habitual DipTrace, mas na nuvem EDA Upverter: um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">link para o design</a> . </p><br><p>  O upverter permite que voc√™ execute o projeto de ponta a ponta da placa e do circuito ao mesmo tempo, de modo que alguns dos elementos da fia√ß√£o foram executados de acordo com o esquema e parte do circuito foi projetada levando em considera√ß√£o os recursos da fia√ß√£o. </p><br><p>  Outro recurso matador do Upverter √© uma enorme biblioteca de componentes, cuidadosamente gerada por bots e um bando de √≠ndios.  Acabou sendo muito conveniente pegar a pe√ßa j√° desenhada e apenas verificar se tudo est√° mais ou menos correto, em vez de desenhar o s√≠mbolo e a pegada completamente. </p><br><p>  Primeiro, decidi organizar os componentes, cuja posi√ß√£o ser√° corrigida com precis√£o: bot√µes, porta microUSB e um conector para a tela.  N√£o fiz furos de montagem, na esperan√ßa de que a placa seja presa √† caixa e nada fique pendurado. </p><br><p>  Ap√≥s a localiza√ß√£o dos elementos fixos, siga a "regra de ouro" e criaremos o r√°dio primeiro.  A antena do chip possui uma pequena √°rea de descanso pr√≥xima, dentro e sob a qual n√£o √© recomend√°vel colocar faixas e pol√≠gonos em todas as camadas, portanto a regra do bom tom √© colocar a antena na borda da placa, de prefer√™ncia mais perto de um dos cantos.  Na verdade, a localiza√ß√£o da antena determinava a localiza√ß√£o do microcontrolador.  Para que o comprimento do condutor da porta de sa√≠da da antena no chip at√© a pr√≥pria antena seja o menor poss√≠vel (levando em considera√ß√£o os componentes correspondentes), colocamos o controlador mais pr√≥ximo da borda em que a antena estar√° localizada. </p><br><p>  Todos os outros componentes podem ser localizados (sem esquecer o bom senso) bastante livremente.  Isso se deve ao fato de que a posi√ß√£o das portas dos perif√©ricos digitais do microcontrolador nRF52 pode ser determinada programaticamente. </p><br><p>  Na minha pouca experi√™ncia, um arranjo m√∫tuo de componentes bem-sucedido √© 90% de sucesso e determina a qualidade da fia√ß√£o adicional; portanto, esse processo deve receber aten√ß√£o especial. </p><br><div class="spoiler">  <b class="spoiler_title">Captura de tela do quadro (pol√≠gonos n√£o s√£o inundados, vista inferior)</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/9dc/5f1/7cd/9dc5f17cd1c34a00943ebd444b28a964.png"></p></div></div><br><p>  Para maior clareza, pintei uma topologia aproximada das principais √°reas: </p><br><p><img src="https://habrastorage.org/web/fd0/136/bef/fd0136bef5c140c3bb6b069615f4837f.png"></p><br><p>  O painel √© de quatro camadas, colocar os componentes selecionados no painel e dissolver suas conex√µes foi uma quest√£o de v√°rias noites; em seguida, demorou cerca de uma semana para ficar preso no painel, procurando erros, verificando duas vezes e lendo novamente as folhas de dados para evitar surpresas repentinas. </p><br><p>  A placa foi desenhada levando em considera√ß√£o os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">padr√µes tecnol√≥gicos</a> do fabricante da placa, que se tornou o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OSHPark.com</a> americano: </p><br><ul><li>  Condutor / autoriza√ß√£o: 5/5 Mil </li><li>  Vias: 10/4 mil buraco / almofada </li><li>  Material: FR408 </li><li>  Acabamento: imers√£o em ouro com subcamada de n√≠quel (ENIG) </li><li>  Vias cegas e transi√ß√µes de camada interna (vias enterradas) n√£o s√£o suportadas.  <em>E n√£o precisamos</em> </li></ul><br><p>  Ao mesmo tempo, o pre√ßo √© de US $ 10 por metro quadrado.  polegadas e o n√∫mero de placas na ordem - 3pcs.  Como s√£o placas-m√£e de alta qualidade e baratas (para prot√≥tipos) com uma m√°scara roxa reconhec√≠vel, recomendo a todos que n√£o s√£o cr√≠ticos esperar duas semanas por suas placas-m√£e bilaterais ou de quatro camadas por um m√™s. </p><br><div class="spoiler">  <b class="spoiler_title">Screenshot da ordem</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/ab1/daf/2ae/ab1daf2ae0b64016ac897c4afd23fb51.png"></p></div></div><br><p>  Como resultado, por tr√™s taxas, tive que pagar US $ 14 e, um m√™s depois, busc√°-las por correio. </p><br><div class="spoiler">  <b class="spoiler_title">Fotos da placa sem componentes</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/a45/223/d98/a45223d982164562992fd1c3b9a9b308.jpg"><br><img src="https://habrastorage.org/web/6b0/438/119/6b043811948c4552a2d51294007dd385.jpg"></p></div></div><br><p>  Todos os componentes est√£o localizados na parte inferior da placa, na parte superior da placa est√° o m√≥dulo da tela, embaixo da qual h√° uma bobina NFC plana, que permite economizar v√°rios mil√≠metros de altura e garante um ajuste suave e firme da tela. </p><br><div class="spoiler">  <b class="spoiler_title">Acontece que um sandu√≠che</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/18a/5c4/a32/18a5c4a320d14b31be2aad99ff8e9d7f.png"></p></div></div><br><p>  No lado superior da placa tamb√©m h√° v√°rios pontos de teste, blocos de teste, aos quais est√£o conectadas linhas de barramento I¬≤C, SPI, linhas de interrup√ß√£o e alguns sinais de controle.  Um oscilosc√≥pio ou analisador l√≥gico pode ser conectado a essas plataformas e esse recurso simplifica bastante a grava√ß√£o de drivers e o firmware de depura√ß√£o.  Tamb√©m no lado superior da placa est√° a interface de depura√ß√£o JTAG (SWD) para piscar e depurar via Segger JLink, que est√° inclu√≠do no kit nRF52-DK, e almofadas para soldar a bobina da antena NFC. </p><br><h2 id="sborka-i-payka">  Montagem e solda </h2><br><p>  Se voc√™ seguir todo o processo de montagem da superf√≠cie, precisar√° solicitar um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">est√™ncil smd (est√™ncil smd)</a> e uma pasta de solda, aplicar a pasta de solda atrav√©s do est√™ncil, organizar os componentes e envi√°-los ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">forno de refluxo</a> . </p><br><p>  Mas eu n√£o tinha fornalha nem est√™ncil.  E o desejo de mexer com ele e colar de solda tamb√©m.  Eu queria montar rapidamente um prot√≥tipo e come√ßar a testar e escrever software.  Portanto, soldados manualmente todos os componentes, dos quais os menores s√£o chips de tamanho 0402, aplicando pasta com uma agulha, colocando os componentes em pin√ßas a v√°cuo e soldando-os com um secador de cabelo. </p><br><p>  O resultado pode ser visto na foto: </p><br><p><img src="https://habrastorage.org/web/4e1/164/938/4e11649380fb457b9ebce97f267e32ac.jpg"></p><br>  <em>Os bot√µes n√£o s√£o soldados e, em vez de v√°rias fichas de tr√™s pernas - jumpers.</em> <br>  <em>Pe√ßo desculpas pelas fotos de baixa qualidade, tiradas em um tijolo.</em> <br><br><br><div class="spoiler">  <b class="spoiler_title">Foto atrav√©s da lente de aumento x30</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/8d8/25c/fed/8d825cfedfe047ddb9f260548d365219.jpg"><br>  <em>Voc√™ pode ver componentes levemente girados e em alguns lugares um excesso de solda.</em>  <em>Isso √© inevit√°vel com a instala√ß√£o manual e a aplica√ß√£o da pasta.</em> </p></div></div><br><p>  Assim que a placa foi montada, peguei o testador em minhas m√£os e comecei a tocar em tudo o que podia alcan√ßar em busca de curtos-circuitos.  Depois de se certificar de que ele n√£o parecia curto, ele conectou um cabo USB.  N√£o h√° fuma√ßa, os chips n√£o esquentam, a voltagem na porta USB √© de 5 volts, a sa√≠da de carga √© de 4,2V, a voltagem ap√≥s o LDO √© exatamente de tr√™s volts.  Parece funcionar. </p><br><p>  Mesmo quando totalmente energizado, o dispositivo, √© claro, n√£o mostrava absolutamente nenhum sinal de vida.  Agora voc√™ precisa dar alma a ela - firmware (ou "sistema operacional", como alguns fabricantes de rel√≥gios: WatchOS, PebbleOS etc.). </p><br><p>  A pr√≥xima etapa do teste foi conectar o depurador JLink embutido no nRF52-DK por meio da interface SWD.  Conectamos a fia√ß√£o, executamos o JLinkExe e vemos nosso chip!  Voc√™ pode come√ßar a escrever o firmware e testar os blocos restantes de ferro programaticamente. </p><br><h2 id="laquooperacionnaya-sistemaraquo-dlya-chasov">  "Sistema operacional" para rel√≥gios </h2><br><p>  Para trabalhos perif√©ricos de baixo n√≠vel, a Nordic oferece seu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nRF5-SDK</a> , adequado para as s√©ries nRF51 e nRF52. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/web/1c6/54b/0cd/1c654b0cd48540efbb8e9a2ab79dc299.png"></a> </p><br><p>SDK             , , NFC   .     Makefile    <code>arm-none-eabi-gcc</code>.        ,       .</p><br>
<p>       .hex-,      nRF52-DK    .   nRF52-DK  ,  Mass Storage Device (),      .hex         .</p><br>
<p>     <code>JLinkExe</code>   GDB-    <code>nrfjprog</code>.</p><br>
<p>        ,   .          ,     ,                 ,            ,      .</p><br>
<p>    ,             .</p><br>
<p><img src="https://habrastorage.org/web/2fe/4fb/faf/2fe4fbfaf96746da8573e732632c6fa8.png"><br>
<em> , -,  ,     .</em></p><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><p><img src="https://habrastorage.org/web/a1f/ee6/9e3/a1fee69e3bee4918babac61db1c25ca8.jpg"></p></div></div><br>
<p>     ,        ,    -   .      API     X-Lib            .             ,        .</p><br>
<p>  :</p><br>
<p><img src="https://thumbs.gfycat.com/BoldThornyBuck-size_restricted.gif"></p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><p><img src="https://thumbs.gfycat.com/ArtisticSoupyAntlion-size_restricted.gif" alt="image"></p></div></div><br>
<p> ,    API  ,    JavaScript (ES 5),                 .   ,  .</p><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JerryScript</a>,         , API      ,     ,    .   ,        ,   :    Date  .., JSON-,       ..</p><br>
<div class="spoiler"><b class="spoiler_title">    JS-</b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Duktape</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Espruino</a></li>
</ul></div></div><br>
<p>   JS  :</p><br>
<p><img src="https://habrastorage.org/web/ac6/a92/c2f/ac6a92c2faab4f3bb18f65b4fa2d8968.jpg"></p><br>
<p>  API          GUI,    , Bluetooth,   ..</p><br>
<p>        ( <code>-O0</code>):</p><br>
<p><img src="https://habrastorage.org/web/a41/e24/f8f/a41e24f8faf84949a14c79d1f9938cea.png"></p><br>
<p>106kB FLASH, 12.8kB RAM.   8kB RAM ‚Äî  (heap)   JavaScript .           . ,   FLASH  nRF52832  512kB,    RAM ‚Äî 64kB.</p><br>
<p> FLASH (120kB)      RAM   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> BLE- SoftDevice.</p><br>
<h2 id="korpus"></h2><br>
<p>    ‚Äî  3D- .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">TinkerCad</a>    3D-.    :</p><br>
<div class="spoiler"><b class="spoiler_title">   USB-  </b><div class="spoiler_text"><p><img src="https://habrastorage.org/web/e66/5fa/e0d/e665fae0d3414e56bead2ff4ff5050e2.jpg"></p></div></div><br>
<p><em> -          3D-,          !</em></p><br>
<h2 id="zaklyuchenie"></h2><br>
<p>       ,         .       ,   ,     ,          .  ,  ,            ,      .</p><br>
<p>         ,     API-  JS-,           JS-,   -  Android.           ,     .    ,        , , Android-   .</p><br>
<p>    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://upverter.com/EP/cdbd8b9abc72b7cd/nRF52-smart-watch/</a><br>
         ,     Github.</p><br>
<p>    , ,       -        ,      .</p><br>
<p>      !</p><br>
<p><strong>P.S.:</strong>  .</p></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt404737/">https://habr.com/ru/post/pt404737/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt404725/index.html">Intel abandona Edison, Galileo e Joule</a></li>
<li><a href="../pt404727/index.html">Elon Musk falou sobre como ele consegue ser t√£o produtivo</a></li>
<li><a href="../pt404731/index.html">Empresa de hospedagem sul-coreana pagou US $ 1 milh√£o aos desenvolvedores da vers√£o Linux do Erebus de criptografia ransomware</a></li>
<li><a href="../pt404733/index.html">Conhecemos part√≠culas elementares (aparentemente)</a></li>
<li><a href="../pt404735/index.html">Um novo estudo mostrou que os gatos n√£o eram domados como outros animais</a></li>
<li><a href="../pt404741/index.html">Avalia√ß√£o do di√≥xido de carbono em uma sala com ar condicionado</a></li>
<li><a href="../pt404745/index.html">Pergunte a Ethan: Qual o tamanho da por√ß√£o do universo para expandir?</a></li>
<li><a href="../pt404747/index.html">O WikiLeaks publicou documenta√ß√£o da CIA sobre a infec√ß√£o de computadores fisicamente isolados</a></li>
<li><a href="../pt404749/index.html">A Microsoft admitiu que √†s vezes desconecta partes de antiv√≠rus de terceiros</a></li>
<li><a href="../pt404751/index.html">Roteador com recursos de VoIP em apenas cem</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>