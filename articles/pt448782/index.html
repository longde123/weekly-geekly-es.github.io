<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜó üç® üå∫ Teste de Python com pytest. Introdu√ß√£o ao pytest, Cap√≠tulo 1 üí£ üî¢ üëçüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Voltar Pr√≥ximo 


 Descobri que o Python Testing com pytest √© um guia introdut√≥rio extremamente √∫til para o ambiente de testes pytest. Isso j√° me traz...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Teste de Python com pytest. Introdu√ß√£o ao pytest, Cap√≠tulo 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448782/"><p><img src="https://habrastorage.org/webt/jl/jn/bb/jljnbbjr-ejh473xy_eccsmknpk.png">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Voltar</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pr√≥ximo</a> <img src="https://habrastorage.org/webt/rw/dy/-g/rwdy-grsvbpcetjttrmecdkxtlk.png"></p><br><p> <em>Descobri que o Python Testing com pytest √© um guia introdut√≥rio extremamente √∫til para o ambiente de testes pytest.</em>  <em>Isso j√° me traz dividendos na minha empresa.</em> <em><br></em> <br>  Chris barbeador <br>  Vice-presidente de produto, tecnologia de insurrei√ß√£o </p><br><p><img src="https://habrastorage.org/webt/hd/--/9w/hd--9w134j0rxhmxftrflbbdopy.png"></p><a name="habracut"></a><br><p>  Os exemplos deste livro foram escritos usando Python 3.6 e pytest 3.2.  O pytest 3.2 suporta Python 2.6, 2.7 e Python 3.3+. </p><br><blockquote>  O c√≥digo-fonte do projeto Tarefas, bem como todos os testes mostrados neste livro, est√£o dispon√≠veis no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" title="https://pragprog.com/titles/bopytest/source_code">link</a> na p√°gina da Web do livro em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" title="https://pragprog.com/titles/bopytest">pragprog.com</a> .  Voc√™ n√£o precisa fazer o download do c√≥digo-fonte para entender o c√≥digo de teste;  o c√≥digo de teste √© apresentado de forma conveniente nos exemplos.  Mas, para acompanhar as tarefas do projeto ou adaptar exemplos de teste para testar seu pr√≥prio projeto (suas m√£os est√£o desamarradas!), Voc√™ deve acessar a p√°gina da Web do livro e fazer o download do trabalho.  L√°, na p√°gina do livro, h√° um link para mensagens de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" title="https://pragprog.com/titles/bopytest/errata">errata</a> e um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" title="https://forums.pragprog.com/forums/438">f√≥rum de discuss√£o</a> . </blockquote><p>  Sob o spoiler, h√° uma lista de artigos desta s√©rie. </p><br><div class="spoiler">  <b class="spoiler_title">Sum√°rio</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>1. Introdu√ß√£o</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>Cap√≠tulo 1: Introdu√ß√£o ao pytest</strong></a> (Este artigo) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>Cap√≠tulo 2: Escrevendo fun√ß√µes de teste</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>Cap√≠tulo 3: Acess√≥rios Pytest</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>Cap√≠tulo 4: Acess√≥rios embutidos</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>Cap√≠tulo 5: Plugins</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>Cap√≠tulo 6: Configura√ß√£o</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>Cap√≠tulo 7: Usando pytest com outras ferramentas</strong></a> </li></ul></div></div><br><h2 id="poehali">  Vamos l√° </h2><br><p>  Este √© o teste: </p><br><blockquote>  <strong>ch1 / test_one.py</strong> </blockquote><br><pre><code class="plaintext hljs">def test_passing(): assert (1, 2, 3) == (1, 2, 3)</code> </pre> <br><p>  Aqui est√° o que parece na inicializa√ß√£o: </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest test_one.py ===================== test session starts ====================== collected 1 items test_one.py . =================== 1 passed in 0.01 seconds ===================</code> </pre> <br><p><img src="https://habrastorage.org/webt/v0/ak/lu/v0aklucdm0i8nrqtk1v1dwb2oeg.png"></p><br><p>  O ponto ap√≥s <em>test_one.py</em> significa que um teste foi executado e passou.  Se precisar de mais informa√ß√µes, voc√™ pode usar <code>-v</code> ou <code>--verbose</code> : </p><br><pre> <code class="plaintext hljs">$ pytest -v test_one.py ===================== test session starts ====================== collected 1 items test_one.py::test_passing PASSED =================== 1 passed in 0.01 seconds ===================</code> </pre> <br><p><img src="https://habrastorage.org/webt/ss/rb/7i/ssrb7i7io-h6ikadzulg5yncvyw.png"></p><br><p>  Se voc√™ possui um terminal colorido, PASSA e a linha inferior √© verde.  √ìtimo! </p><br><p>  Este √© um teste que falhou: </p><br><blockquote>  <strong>ch1 / test_two.py</strong> </blockquote><br><pre> <code class="plaintext hljs">def test_failing(): assert (1, 2, 3) == (3, 2, 1)</code> </pre> <br><p>  A maneira como o pytest mostra falhas de teste √© uma das muitas raz√µes pelas quais os desenvolvedores adoram o pytest.  Vamos ver o que vem disso: </p><br><pre> <code class="plaintext hljs">$ pytest test_two.py ===================== test session starts ====================== collected 1 items test_two.py F =========================== FAILURES =========================== _________________________ test_failing _________________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Use -v to get the full diff test_two.py:2: AssertionError =================== 1 failed in 0.04 seconds ===================</code> </pre> <br><p><img src="https://habrastorage.org/webt/dr/sh/wu/drshwua2ie5btbcena-4xlewiz4.png"></p><br><p>  √ìtimo!  O teste <em>test_failing</em> obt√©m sua se√ß√£o para nos mostrar por que falhou. </p><br><p>  E o pytest relata com precis√£o que a primeira falha: o √≠ndice 0 √© uma incompatibilidade. </p><br><p>  Grande parte desta mensagem √© vermelha, o que a destaca (se voc√™ possui um terminal colorido). </p><br><p>  Isso j√° √© muita informa√ß√£o, mas h√° uma linha com uma dica que diz Use <code>-v</code> para obter ainda mais descri√ß√µes de diferen√ßas. </p><br><p>  Vamos ligar este <code>-v</code> : </p><br><pre> <code class="plaintext hljs">$ pytest -v test_two.py ===================== test session starts ====================== collected 1 items test_two.py::test_failing FAILED =========================== FAILURES =========================== _________________________ test_failing _________________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Full diff: E - (1, 2, 3) E ? ^ ^ E + (3, 2, 1) E ? ^ ^ test_two.py:2: AssertionError =================== 1 failed in 0.04 seconds ===================</code> </pre> <br><p><img src="https://habrastorage.org/webt/u9/8l/dn/u98ldncvvmy1ha0ygy6krwekhvm.png"></p><br><p>  Uau! <br>  pytest adiciona o caractere de sinal de intercala√ß√£o (^) para nos mostrar exatamente qual √© a diferen√ßa. <br>  Se voc√™ j√° est√° impressionado com a facilidade de escrever, ler e executar testes com pytest e como √© f√°cil ler a sa√≠da para ver onde a falha ocorreu, bem ... voc√™ ainda n√£o viu nada.  De onde veio, existem muitos mais milagres.  Fique e deixe-me mostrar por que acho que o pytest √© absolutamente a melhor plataforma de teste. </p><br><p>  No restante deste cap√≠tulo, voc√™ instalar√° o pytest, examinar√° as v√°rias maneiras de execut√°-lo e seguir√° algumas das op√ß√µes de linha de comando mais usadas.  Nos pr√≥ximos cap√≠tulos, voc√™ aprender√° a escrever fun√ß√µes de teste que maximizam o poder do pytest, como inserir o c√≥digo de instala√ß√£o nas se√ß√µes de configura√ß√£o e desmontagem chamadas acess√≥rios, e como usar acess√≥rios e plugins para realmente sobrecarregar os testes de software. </p><br><p>  Mas primeiro tenho que me desculpar.  Desculpe testar a <code>assert (1, 2, 3) == (3, 2, 1)</code> , √© t√£o chato.  Eu ou√ßo ronco ?!  Ningu√©m escreveria esse teste na vida real.  Os testes de software consistem em c√≥digo que verifica outro software que, infelizmente, nem sempre funciona de maneira positiva.  E <code>(1, 2, 3) == (1, 2, 3)</code> sempre funcionar√°.  √â por isso que n√£o usaremos testes muito est√∫pidos como este no restante do livro.  Consideraremos testes para um projeto de software real.  Usaremos um projeto de Tarefas de amostra que requer c√≥digo de teste.  Espero que isso seja simples o suficiente para ser facilmente compreendido, mas n√£o t√£o simples a ponto de ser entediante. </p><br><p>  Outra aplica√ß√£o √∫til dos testes de software √© testar suas suposi√ß√µes sobre como o software em teste funciona, o que pode incluir testar sua compreens√£o de m√≥dulos e pacotes de terceiros e at√© criar estruturas de dados Python. </p><br><p>  O projeto Tarefas usa a estrutura Tarefa, com base no m√©todo de f√°brica nomeada de duplo, que faz parte da biblioteca padr√£o.  A estrutura da tarefa √© usada como uma estrutura de dados para transferir informa√ß√µes entre a interface do usu√°rio e a API. </p><br><p>  No restante deste cap√≠tulo, usarei a Tarefa para demonstrar como iniciar o pytest e usar algumas op√ß√µes de linha de comando comumente usadas. </p><br><p>  Aqui est√° a tarefa: </p><br><pre> <code class="plaintext hljs">from collections import namedtuple Task = namedtuple('Task', ['summary', 'owner', 'done', 'id'])</code> </pre> <br><p>  Antes de pularmos para os exemplos, vamos dar um passo atr√°s e falar sobre como obter o pytest e instal√°-lo. </p><br><p>  A fun√ß√£o de f√°brica <em>namedtuple ()</em> existe desde o Python 2.6, mas ainda acho que muitos desenvolvedores de Python n√£o sabem o qu√£o legal √© isso.  Pelo menos, usar a tarefa para casos de teste ser√° mais interessante que <code>(1, 2, 3) == (1, 2, 3)</code> ou <code>(1, 2)==3</code> . </p><br><p>  Antes de passar para os exemplos, vamos dar um passo atr√°s e falar sobre onde obter o pytest e como instal√°-lo. </p><br><h2 id="dobyvaem-pytest">  Pytest de minera√ß√£o </h2><br><p>  Sede da Pytest <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://docs.pytest.org</a> .  Esta √© a documenta√ß√£o oficial.  Mas ele se espalha pelo PyPI (o √≠ndice do pacote Python) em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://pypi.python.org/pypi/pytest</a> . </p><br><p>  Como outros pacotes Python distribu√≠dos atrav√©s do PyPI, use <strong>pip</strong> para instalar o pytest no ambiente virtual usado para teste: </p><br><pre> <code class="plaintext hljs">$ pip3 install -U virtualenv $ python3 -m virtualenv venv $ source venv/bin/activate $ pip install pytest</code> </pre> <br><p>  Se voc√™ n√£o conhece o virtualenv ou o pip, apresentarei voc√™.  Consulte o Ap√™ndice 1, ‚ÄúAmbientes virtuais‚Äù, na p√°gina 155 e o Ap√™ndice 2, na p√°gina 159. </p><br><p>  <strong>E o windows, python 2 e venv?</strong> </p><br><p>  O exemplo virtualenv e pip deve funcionar em muitos sistemas POSIX, como Linux e macOS, bem como em muitas vers√µes do Python, incluindo o Python 2.7.9 e posterior. </p><br><p>  A <em>fonte venv / bin / enable</em> na linha n√£o funcionar√° no Windows; use <em>venv \ Scripts \ activ.bat</em> . <br>  Fa√ßa o seguinte: </p><br><pre> <code class="plaintext hljs">C:\&gt; pip3 install -U virtualenv C:\&gt; python3 -m virtualenv venv C:\&gt; venv\Scripts\activate.bat (venv) C:\&gt; pip install pytest</code> </pre> <br><p>  Para o Python 3.6 e superior, voc√™ pode conviver com venv em vez de virtualenv e n√£o precisa se preocupar em instal√°-lo primeiro.  Est√° inclu√≠do no Python 3.6 e posterior.  No entanto, ouvi dizer que algumas plataformas ainda se comportam melhor com o virtualenv. </p><br><h2 id="zapuskaem-pytest">  Executar pytest </h2><br><pre> <code class="plaintext hljs">$ pytest --help usage: pytest [options] [file_or_dir] [file_or_dir] [...] ...</code> </pre> <br><p>  Sem argumentos, o pytest examinar√° seu diret√≥rio atual e todos os subdiret√≥rios dos arquivos de teste e executar√° o c√≥digo de teste encontrado.  Se voc√™ der ao pytest um nome de arquivo, um nome de diret√≥rio ou uma lista deles, eles ser√£o encontrados l√°, em vez do diret√≥rio atual.  Cada diret√≥rio especificado na linha de comando √© examinado recursivamente para encontrar o c√≥digo de teste. </p><br><p>  Por exemplo, vamos criar um subdiret√≥rio chamado task e come√ßar com este arquivo de teste: </p><br><blockquote>  <strong>ch1 / tasks / test_three.py</strong> </blockquote><br><pre> <code class="plaintext hljs">"""   Task.""" from collections import namedtuple Task = namedtuple('Task', ['summary', 'owner', 'done', 'id']) Task.__new__.__defaults__ = (None, None, False, None) def test_defaults(): """  ,      .""" t1 = Task() t2 = Task(None, None, False, None) assert t1 == t2 def test_member_access(): """  .field () namedtuple.""" t = Task('buy milk', 'brian') assert t.summary == 'buy milk' assert t.owner == 'brian' assert (t.done, t.id) == (False, None)</code> </pre> <br><p>  O teste test_member_access () √© para demonstrar como acessar membros por nome e n√£o por √≠ndice, que √© um dos principais motivos para usar nomeduplos. </p><br><p>  Vamos colocar mais alguns testes em um segundo arquivo para demonstrar a funcionalidade _asdict () e _replace () </p><br><p>  Voc√™ pode usar <em><code>__new __.__ defaults__</code></em> para criar objetos de tarefas sem especificar todos os campos.  O teste <em>test_defaults ()</em> tem como objetivo demonstrar e testar como os padr√µes funcionam. </p><br><p>  O teste <em><code>test_member_access()</code></em> deve demonstrar como acessar membros nomeados nd n√£o pelo √≠ndice, que √© um dos principais motivos para o uso dos nomeados. <br>  Vamos adicionar mais alguns testes ao segundo arquivo para demonstrar as <em><code>_asdict()</code></em> e <em><code>_replace()</code></em> </p><br><blockquote>  <strong>ch1 / tasks / test_four.py</strong> </blockquote><br><pre> <code class="plaintext hljs">"""   Task.""" from collections import namedtuple Task = namedtuple('Task', ['summary', 'owner', 'done', 'id']) Task.__new__.__defaults__ = (None, None, False, None) def test_asdict(): """_asdict()   .""" t_task = Task('do something', 'okken', True, 21) t_dict = t_task._asdict() expected = {'summary': 'do something', 'owner': 'okken', 'done': True, 'id': 21} assert t_dict == expected def test_replace(): """    fields.""" t_before = Task('finish book', 'brian', False) t_after = t_before._replace(id=10, done=True) t_expected = Task('finish book', 'brian', True, 10) assert t_after == t_expected</code> </pre> <br><p>  Para executar o pytest, voc√™ tem a op√ß√£o de especificar arquivos e diret√≥rios.  Se voc√™ n√£o especificar nenhum arquivo ou diret√≥rio, o pytest procurar√° testes no diret√≥rio de trabalho e nos subdiret√≥rios atuais.  Ele procura por arquivos come√ßando com test_ ou terminando com _test.  Se voc√™ executar pytest a partir do diret√≥rio ch1, sem comandos, executar√° testes para quatro arquivos: </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest ===================== test session starts ====================== collected 6 items test_one.py . test_two.py F tasks/test_four.py .. tasks/test_three.py .. =========================== FAILURES =========================== _________________________ test_failing _________________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Use -v to get the full diff test_two.py:2: AssertionError ============== 1 failed, 5 passed in 0.08 seconds ==============</code> </pre> <br><p><img src="https://habrastorage.org/webt/ut/2o/kw/ut2okwbdqprgbriqvfswsjd-7ti.png"></p><br><p>  Para executar apenas nossos novos testes de tarefas, voc√™ pode fornecer ao pytest todos os nomes de arquivos que deseja executar, ou um diret√≥rio, ou chamar pytest a partir do diret√≥rio em que nossos testes est√£o localizados: </p><br><pre> <code class="plaintext hljs">$ pytest tasks/test_three.py tasks/test_four.py ===================== test session starts ====================== collected 4 items tasks/test_three.py .. tasks/test_four.py .. =================== 4 passed in 0.02 seconds =================== $ pytest tasks ===================== test session starts ====================== collected 4 items tasks/test_four.py .. tasks/test_three.py .. =================== 4 passed in 0.03 seconds =================== $ cd /path/to/code/ch1/tasks $ pytest ===================== test session starts ====================== collected 4 items test_four.py .. test_three.py .. =================== 4 passed in 0.02 seconds ===================</code> </pre> <br><p><img src="https://habrastorage.org/webt/or/77/t4/or77t4go_qqok-v8qnenx5rxcjy.png"></p><br><p>  A parte de execu√ß√£o do pytest, onde o pytest passa e encontra os testes a serem executados, √© chamado de descoberta de teste.  O pytest conseguiu encontrar todos os testes que quer√≠amos executar, porque os nomeamos de acordo com as conven√ß√µes de nomenclatura do pytest. </p><br><p>  A seguir, √© apresentada uma breve vis√£o geral das conven√ß√µes de nomenclatura, para que seu c√≥digo de teste possa ser detectado usando o pytest: </p><br><ul><li>  Os arquivos de teste devem ter o nome <code>test_&lt;something&gt;.py</code> ou <code>&lt;something&gt;_test.py</code> . </li><li>  Os m√©todos e fun√ß√µes de teste devem ser chamados de <code>test_&lt;something&gt;</code> . </li><li>  As classes de teste devem ser chamadas de <code>Test&lt;Something&gt;</code> . </li></ul><br><p>  Como nossos arquivos e fun√ß√µes de teste come√ßam com <code>test_</code> , tudo est√° bem conosco.  Existem maneiras de alterar essas regras de descoberta se voc√™ tiver v√°rios testes com nomes diferentes. <br>  Vou abordar isso no Cap√≠tulo 6, ‚ÄúConfigura√ß√£o‚Äù na p√°gina 113. </p><br><p>  Vamos dar uma olhada no resultado da execu√ß√£o de apenas um arquivo: </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1/tasks $ pytest test_three.py ================= test session starts ================== platform darwin -- Python 3.6.2, pytest-3.2.1, py-1.4.34, pluggy-0.4.0 rootdir: /path/to/code/ch1/tasks, inifile: collected 2 items test_three.py .. =============== 2 passed in 0.01 seconds ===============</code> </pre> <br><p>  O resultado nos diz um pouco. </p><br><blockquote>  ===== sess√£o de teste inicia ==== </blockquote><p>  . </p><br><p>  O pytest fornece um separador elegante para iniciar uma sess√£o de teste.  Uma sess√£o √© uma √∫nica chamada pytest, incluindo todos os testes executados em v√°rios diret√≥rios.  Essa defini√ß√£o de sess√£o se torna importante quando falo sobre a √°rea da sess√£o em rela√ß√£o aos equipamentos pytest na defini√ß√£o da regi√£o do equipamento, na p√°gina 56. </p><br><p>  Plataforma Darwin - no meu Mac.  Em um computador Windows, a plataforma √© diferente.  A seguir, est√£o as vers√µes do Python e pytest, bem como as depend√™ncias dos pacotes pytest.  Tanto py quanto pluggy s√£o pacotes desenvolvidos pela equipe pytest para ajudar na implementa√ß√£o do pytest. </p><br><blockquote>  <strong>rootdir: / caminho / para / c√≥digo / ch1 / tarefas, inifile:</strong> </blockquote><p>  <code>rootdir</code> √© o diret√≥rio mais compartilhado entre todos os diret√≥rios nos quais o c√≥digo de teste √© pesquisado.  O <code>inifile</code> (vazio aqui) lista os arquivos de configura√ß√£o usados.  Os arquivos de configura√ß√£o podem ser <code>pytest.ini</code> , <code>tox.ini</code> ou <code>setup.cfg</code> .  Para obter mais informa√ß√µes sobre arquivos de configura√ß√£o, consulte o Cap√≠tulo 6, ‚ÄúConfigura√ß√£o‚Äù na p√°gina 113. </p><br><blockquote>  <strong>coletou 2 itens</strong> </blockquote><p>  Essas s√£o duas fun√ß√µes de teste em um arquivo. </p><br><blockquote>  <strong>test_three.py ..</strong> </blockquote><p>  <code>test_three.py</code> mostra o arquivo de teste.  H√° uma linha para cada arquivo de teste.  Dois pontos significam que os testes foram aprovados - um ponto para cada fun√ß√£o ou m√©todo de teste.  Os pontos s√£o destinados apenas para passar nos testes.  Falhas, erros, pulos, xfails e xpasses s√£o indicados com F, E, s, xe X, respectivamente.  Se voc√™ quiser ver mais pontos para passar nos testes, use a op√ß√£o <code>-v</code> ou <code>--verbose</code> . </p><br><blockquote>  == 2 passaram em 0,01 segundos == </blockquote><p>  Esta linha refere-se ao n√∫mero de testes aprovados e ao tempo gasto em toda a sess√£o de teste.  Se houver aprova√ß√£o nos testes, o n√∫mero de cada categoria tamb√©m ser√° mostrado aqui. </p><br><p>  Um resultado do teste √© a principal maneira pela qual um usu√°rio que realiza um teste ou exibe resultados pode entender o que aconteceu durante o teste.  No pytest, as fun√ß√µes de teste podem ter v√°rios resultados diferentes, n√£o apenas passar ou falhar.  Aqui est√£o os poss√≠veis resultados da fun√ß√£o de teste: </p><br><ul><li>  PASSADO (.): Teste conclu√≠do com sucesso. </li><li>  FAILED (F): Falha no teste (ou XPASS + estrito). </li><li>  SKIPPED (s): O teste foi pulado.  Voc√™ pode for√ßar o pytest a pular o teste usando os <code>@pytest.mark.skip()</code> ou <code>pytest.mark.skipif()</code> , discutidos na se√ß√£o pulando testes, na p√°gina 34. </li><li>  xfail (x): o teste n√£o deveria ter passado, foi iniciado e falhou.  Voc√™ pode for√ßar o pytest a instruir o teste a falhar usando o decorador <code>@pytest.mark.xfail()</code> , descrito nas marca√ß√µes de teste como expectativa de falha, na p√°gina 37. </li><li>  XPASS (X): O teste n√£o deveria ter passado, foi iniciado e passou! .. </li><li>  ERRO (E): Ocorreu uma exce√ß√£o fora da fun√ß√£o de teste, no equipamento, discutido no cap√≠tulo 3, Acess√≥rios pytest, na p√°gina 49, ou na fun√ß√£o hook, discutida no cap√≠tulo 5, Plugins, na p√°gina 95. </li></ul><br><h2 id="vypolnenie-tolko-odnogo-testa">  Executando apenas um teste </h2><br><p>  Talvez a primeira coisa que voc√™ queira fazer depois de come√ßar a escrever testes seja executar apenas um.  Especifique o arquivo diretamente e inclua o nome <code>::test_name</code> : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -v tasks/test_four.py::test_asdict =================== test session starts =================== collected 3 items tasks/test_four.py::test_asdict PASSED ================ 1 passed in 0.01 seconds =================</code> </pre> <br><p>  Agora vamos ver algumas op√ß√µes. </p><br><h2 id="ispolzovanie-opciy">  Usando Op√ß√µes </h2><br><p>  Usamos a op√ß√£o verbose, <code>-v</code> ou <code>--verbose</code> algumas vezes, mas h√° muitas outras op√ß√µes que vale a pena conhecer.  N√£o vamos us√°-los todos neste livro, apenas alguns.  Voc√™ pode visualizar a lista completa usando a op√ß√£o pytest <code>--help</code> . </p><br><p>  Abaixo est√£o algumas op√ß√µes que s√£o muito √∫teis ao trabalhar com pytest.  Esta n√£o √© uma lista completa, mas essas op√ß√µes s√£o suficientes para come√ßar. </p><br><pre> <code class="plaintext hljs">$ pytest --help usage: pytest [options] [file_or_dir] [file_or_dir] [...] ... subset of the list ... positional arguments: file_or_dir general: -k EXPRESSION only run tests which match the given substring expression. An expression is a python evaluatable expression where all names are substring-matched against test names and their parent classes. Example: -k 'test_method or test_other' matches all test functions and classes whose name contains 'test_method' or 'test_other', while -k 'not test_method' matches those that don't contain 'test_method' in their names. Additionally keywords are matched to classes and functions containing extra names in their 'extra_keyword_matches' set, as well as functions which have names assigned directly to them. -m MARKEXPR only run tests matching given mark expression. example: -m 'mark1 and not mark2'. --markers show markers (builtin, plugin and per-project ones). -x, --exitfirst exit instantly on first error or failed test. --maxfail=num exit after first num failures or errors. ... --capture=method per-test capturing method: one of fd|sys|no. -s shortcut for --capture=no. ... --lf, --last-failed rerun only the tests that failed at the last run (or all if none failed) --ff, --failed-first run all tests but run the last failures first. This may re-order tests and thus lead to repeated fixture setup/teardown ... reporting: -v, --verbose increase verbosity. -q, --quiet decrease verbosity. --verbosity=VERBOSE set verbosity ... -l, --showlocals show locals in tracebacks (disabled by default). --tb=style traceback print mode (auto/long/short/line/native/no). ... --durations=N show N slowest setup/test durations (N=0 for all). ... collection: --collect-only only collect tests, don't execute them. ... test session debugging and configuration: --basetemp=dir base temporary directory for this test run.(warning: this directory is removed if it exists) --version display pytest lib version and import information. -h, --help show help message and configuration info</code> </pre><br><h3 id="--collect-only">  --collect-only </h3><br><p>  A <code>--collect-only</code> indica quais testes ser√£o executados com os par√¢metros e configura√ß√µes fornecidos.  √â conveniente mostrar esse par√¢metro primeiro, para que a sa√≠da possa ser usada como refer√™ncia para outros exemplos.  Se voc√™ iniciar no diret√≥rio ch1, dever√° ver todas as fun√ß√µes de teste que procurou at√© agora neste cap√≠tulo: </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --collect-only =================== test session starts =================== collected 6 items &lt;Module 'test_one.py'&gt; &lt;Function 'test_passing'&gt; &lt;Module 'test_two.py'&gt; &lt;Function 'test_failing'&gt; &lt;Module 'tasks/test_four.py'&gt; &lt;Function 'test_asdict'&gt; &lt;Function 'test_replace'&gt; &lt;Module 'tasks/test_three.py'&gt; &lt;Function 'test_defaults'&gt; &lt;Function 'test_member_access'&gt; ============== no tests ran in 0.03 seconds ===============</code> </pre> <br><p>  A <code>--collect-only</code> √© √∫til para verificar se as outras op√ß√µes que selecionam testes antes da execu√ß√£o dos testes est√£o selecionadas corretamente.  Vamos us√°-lo novamente com <code>-k</code> para mostrar como isso funciona. </p><br><h3 id="-k-expression">  -k EXPRESS√ÉO </h3><br><p>  A <code>-k</code> permite que voc√™ use uma express√£o para definir fun√ß√µes de teste. </p><br><p>  Uma op√ß√£o muito poderosa!  Pode ser usado como um atalho para executar um teste separado, se o nome for exclusivo, ou executar um conjunto de testes que tenham um prefixo ou sufixo comum em seus nomes.  Suponha que voc√™ queira executar os testes <code>test_asdict()</code> e <code>test_defaults()</code> .  Voc√™ pode verificar o filtro com: <code>--collect-only</code> : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -k "asdict or defaults" --collect-only =================== test session starts =================== collected 6 items &lt;Module 'tasks/test_four.py'&gt; &lt;Function 'test_asdict'&gt; &lt;Module 'tasks/test_three.py'&gt; &lt;Function 'test_defaults'&gt; =================== 4 tests deselected ==================== ============== 4 deselected in 0.03 seconds ===============</code> </pre> <br><p>  Sim!  Isso √© semelhante ao que precisamos.  Agora voc√™ pode execut√°-los removendo <code>--collect-only</code> : </p><br><pre> <code class="plaintext hljs">$ pytest -k "asdict or defaults" =================== test session starts =================== collected 6 items tasks/test_four.py . tasks/test_three.py . =================== 4 tests deselected ==================== ========= 2 passed, 4 deselected in 0.03 seconds ==========</code> </pre> <br><p>  Opa!  Apenas pontos.  Ent√£o eles passaram.  Mas eles eram os testes certos?  Uma maneira de descobrir √© usar <code>-v</code> ou <code>--verbose</code> : </p><br><pre> <code class="plaintext hljs">$ pytest -v -k "asdict or defaults" =================== test session starts =================== collected 6 items tasks/test_four.py::test_asdict PASSED tasks/test_three.py::test_defaults PASSED =================== 4 tests deselected ==================== ========= 2 passed, 4 deselected in 0.02 seconds ==========</code> </pre> <br><p>  Sim!  Esses foram os testes certos. </p><br><h3 id="-m-markexpr">  -m MARKLEX </h3><br><p>  Os marcadores s√£o uma das melhores maneiras de marcar um subconjunto de recursos de teste para execu√ß√£o em conjunto.  Como exemplo, uma maneira de executar <code>test_replace()</code> e <code>test_member_access()</code> , mesmo que estejam em arquivos separados, √© marc√°-los.  Qualquer nome de marcador pode ser usado.  Digamos que voc√™ queira usar <code>run_these_please</code> .  Observe os testes usando o decorador <code>@pytest.mark.run_these_please</code> , assim: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest ... @pytest.mark.run_these_please <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_member_access</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ...</code> </pre> <br><p>  Agora o mesmo para <code>test_replace()</code> .  Ent√£o voc√™ pode executar todos os testes com o mesmo marcador com <code>pytest -m run_these_please</code> : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1/tasks $ pytest -v -m run_these_please ================== test session starts =================== collected 4 items test_four.py::test_replace PASSED test_three.py::test_member_access PASSED =================== 2 tests deselected =================== ========= 2 passed, 2 deselected in 0.02 seconds =========</code> </pre> <br><p>  A express√£o do marcador n√£o precisa ser um √∫nico marcador.  Voc√™ pode usar op√ß√µes como <code>-m "mark1 and mark2"</code> para testes com ambos os marcadores, <code>-m "mark1 and not mark2"</code> para testes que possuem o r√≥tulo 1, mas n√£o o r√≥tulo 2, <code>-m "mark1 or mark2"</code> para testes com um de etc., discutirei com mais detalhes os marcadores nos M√©todos de verifica√ß√£o de marca√ß√£o, na p√°gina 31. </p><br><h3 id="-x---exitfirst">  -x, --exitfirst </h3><br><p>  O comportamento normal do <em>pytest</em> √© executar todos os testes que encontrar.  Se a fun√ß√£o de teste detectar uma falha de <em>afirma√ß√£o</em> ou <em>exce√ß√£o</em> , esse teste ser√° interrompido e o teste falhar√°.  E ent√£o <em>pytest</em> executa o pr√≥ximo teste.  Para a maior parte, √© disso que voc√™ precisa.  No entanto, especialmente ao depurar um problema, ele interfere imediatamente com toda a sess√£o de teste quando o teste n√£o est√° correto.  √â isso que a op√ß√£o <code>-x</code> faz.  Vamos tentar isso nos seis testes que temos no momento: </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -x ====================== test session starts ==================== collected 6 items test_one.py . test_two.py F ============================ FAILURES ========================= __________________________ test_failing _______________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Use -v to get the full diff test_two.py:2: AssertionError =============== 1 failed, 1 passed in 0.38 seconds ============</code> </pre><br><p>  Na parte superior da sa√≠da, voc√™ v√™ que todos os seis testes (ou "itens") foram coletados e, na linha inferior, voc√™ v√™ que um teste falhou e outro passou, e o <em>pytest</em> exibiu a linha "Interrompido" para nos informar que ele est√° parado.  Sem <code>-x</code> todos os seis testes seriam executados.  Vamos repetir novamente sem <code>-x</code> .  Tamb√©m usamos <code>--tb=no</code> para desativar o rastreamento de pilha, pois voc√™ j√° o viu e n√£o precisa v√™-lo novamente: </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --tb=no =================== test session starts =================== collected 6 items test_one.py . test_two.py F tasks/test_four.py .. tasks/test_three.py .. =========== 1 failed, 5 passed in 0.09 seconds ============</code> </pre> <br><p>   ,   <code>-x</code> , pytest    <em>test_two.py</em>    . </p><br><h3 id="--maxfailnum"> --maxfail=num </h3><br><p>  <code>-x</code>       .   ,      ,    ,   <code>--maxfail</code> ,  ,    .            ,      .     ,    <code>--maxfail = 2</code> ,    ,  <code>--maxfail = 1</code>    ,  <code>-x</code> : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --maxfail=2 --tb=no =================== test session starts =================== collected 6 items test_one.py . test_two.py F tasks/test_four.py .. tasks/test_three.py .. =========== 1 failed, 5 passed in 0.08 seconds ============ $ pytest --maxfail=1 --tb=no =================== test session starts =================== collected 6 items test_one.py . test_two.py F !!!!!!!!! Interrupted: stopping after 1 failures !!!!!!!!!! =========== 1 failed, 1 passed in 0.19 seconds ============</code> </pre> <br><p> E    <code>--tb=no</code> ,   . </p><br><h3 id="-s-and---capturemethod"> -s and --capture=method </h3><br><p>  <code>-s</code>    ‚Äî    ,     <em>stdout</em> ,           .     <code>--capture=no</code> .   ,        .      ,      ,     ,      .  <code>-s</code>  <code>--capture=no</code>    .         <code>print()</code> ,       . </p><br><p>  ,           , <code>-l/--showlocals</code> ,      ,    . </p><br><p>     <code>--capture=fd</code>  <code>--capture=sys</code> . ‚Äî  <code>--capture=sys</code>  <code>sys.stdout/stderr</code>  mem-.  <code>--capture=fd</code>    1  2   . </p><br><p>    <code>sys</code>  <code>fd</code>  . ,  ,        .    <code>-s</code> .    ,   <code>-s</code> ,      . </p><br><p>          ;    .   ,       ,      . </p><br><h3 id="-lf---last-failed"> -lf, --last-failed </h3><br><p>              .   <code>--lf</code>     : </p><br><p>  ,     <code>--tb</code> ,    ,         . </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --lf =================== test session starts =================== run-last-failure: rerun last 1 failures collected 6 items test_two.py F ======================== FAILURES ========================= ______________________ test_failing _______________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Use -v to get the full diff test_two.py:2: AssertionError =================== 5 tests deselected ==================== ========= 1 failed, 5 deselected in 0.08 seconds ==========</code> </pre> <br><h3 id="ff---failed-first"> ‚Äìff, --failed-first </h3><br><p>  <code>--ff/--failed-first</code>     ,   <code>--last-failed</code> ,     ,    : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --ff --tb=no =================== test session starts =================== run-last-failure: rerun last 1 failures first collected 6 items test_two.py F test_one.py . tasks/test_four.py .. tasks/test_three.py .. =========== 1 failed, 5 passed in 0.09 seconds ============</code> </pre> <br><p>  <code>test_failing()</code>  <code>test\_two.py</code>   <code>test\_one.py</code> . ,  <code>test_failing()</code>     , <code>--ff</code>       </p><br><h3 id="-v---verbose"> -v, --verbose </h3><br><p>  <code>-v/--verbose</code>      .     ,       ,        . </p><br><p>      ,           <code>--ff</code>  <code>--tb=no</code> : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -v --ff --tb=no =================== test session starts =================== run-last-failure: rerun last 1 failures first collected 6 items test_two.py::test_failing FAILED test_one.py::test_passing PASSED tasks/test_four.py::test_asdict PASSED tasks/test_four.py::test_replace PASSED tasks/test_three.py::test_defaults PASSED tasks/test_three.py::test_member_access PASSED =========== 1 failed, 5 passed in 0.07 seconds ============</code> </pre> <br><p><img src="https://habrastorage.org/webt/bw/7f/_4/bw7f_4irv2astplpl5tobqp_xqs.png"></p><br><p>           FAILED   PASSED. </p><br><h3 id="-q---quiet"> -q, --quiet </h3><br><p>  <code>-q/--quiet</code>  <code>-v/--verbose</code> ;      .        <code>--tb=line</code> ,          . </p><br><p>  - <code>q</code> : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -q .F.... ======================== FAILURES ========================= ______________________ test_failing _______________________ def test_failing(): &gt; assert (1, 2, 3) == (3, 2, 1) E assert (1, 2, 3) == (3, 2, 1) E At index 0 diff: 1 != 3 E Full diff: E - (1, 2, 3) E ? ^ ^ E + (3, 2, 1) E ? ^ ^ test_two.py:2: AssertionError 1 failed, 5 passed in 0.08 seconds</code> </pre> <br><p>  <code>-q</code>    ,    .      <code>-q</code>     (  <code>--tb=no</code> ),    ,        . </p><br><h3 id="-l---showlocals"> -l, --showlocals </h3><br><p>    <code>-l/--showlocals</code>         <code>tracebacks</code>   . </p><br><p>            .     <code>test_replace()</code>   </p><br><pre> <code class="plaintext hljs">t_expected = Task('finish book', 'brian', True, 10)</code> </pre> <br><p>  em </p><br><pre> <code class="plaintext hljs">t_expected = Task('finish book', 'brian', True, 11)</code> </pre> <br><p> 10  11   .       .         <code>--l/--showlocals</code> : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest -l tasks =================== test session starts =================== collected 4 items tasks/test_four.py .F tasks/test_three.py .. ======================== FAILURES ========================= ______________________ test_replace _______________________ @pytest.mark.run_these_please def test_replace(): """replace() should change passed in fields.""" t_before = Task('finish book', 'brian', False) t_after = t_before._replace(id=10, done=True) t_expected = Task('finish book', 'brian', True, 11) &gt; assert t_after == t_expected E AssertionError: assert Task(summary=...e=True, id=10) == Task(summary='...e=True, id=11) E At index 3 diff: 10 != 11 E Use -v to get the full diff t_after = Task(summary='finish book', owner='brian', done=True, id=10) t_before = Task(summary='finish book', owner='brian', done=False, id=None) t_expected = Task(summary='finish book', owner='brian', done=True, id=11) tasks\test_four.py:28: AssertionError =========== 1 failed, 3 passed in 0.08 seconds ============</code> </pre> <br><p><img src="https://habrastorage.org/webt/c1/f_/vk/c1f_vkcnpoeplpn9arlb-fgj85a.png"></p><br><p>   <code>t_after</code> , <code>t_before</code>  <code>t_expected</code>      ,       assert-. </p><br><h3 id="--tbstyle"> --tb=style </h3><br><p>  <code>--tb=style</code>       .    pytest        ,    ,    .  <em>tracebacks</em>    ,  ,   .    <code>--tb=style</code> . ,    ,  short, line  no. <code>short</code>    <em>assert</em>   <strong>E</strong>  ; <code>line</code>     ; <em>no</em>   . </p><br><p>     <code>test_replace()</code> ,    ,       . <code>--tb=no</code>    </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --tb=no tasks =================== test session starts =================== collected 4 items tasks/test_four.py .F tasks/test_three.py .. =========== 1 failed, 3 passed in 0.04 seconds ============</code> </pre> <br><blockquote> --tb=line in many cases is enough to tell what's wrong. If you have a ton of failing tests, this option can help to show a pattern in the failures: </blockquote><p> <code>--tb=line</code>    ,  ,   .      ,        : </p><br><pre> <code class="plaintext hljs">$ pytest --tb=line tasks =================== test session starts =================== collected 4 items tasks/test_four.py .F tasks/test_three.py .. ======================== FAILURES ========================= /path/to/code/ch1/tasks/test_four.py:20: AssertionError: assert Task(summary=...e=True, id=10) == Task( summary='...e=True, id=11) =========== 1 failed, 3 passed in 0.05 seconds ============</code> </pre> <br><p>    verbose tracebacks <code>--tb=short</code> : </p><br><pre> <code class="plaintext hljs">$ pytest --tb=short tasks =================== test session starts =================== collected 4 items tasks/test_four.py .F tasks/test_three.py .. ======================== FAILURES ========================= ______________________ test_replace _______________________ tasks/test_four.py:20: in test_replace assert t_after == t_expected E AssertionError: assert Task(summary=...e=True, id=10) == Task( summary='...e=True, id=11) E At index 3 diff: 10 != 11 E Use -v to get the full diff =========== 1 failed, 3 passed in 0.04 seconds ============</code> </pre> <br><p>   ,   ,  . </p><br><p>     ,     . </p><br><p> pytest <code>--tb=long</code>       traceback. pytest <code>--tb=auto</code>         <em>tracebacks</em> ,      .    . pytest <code>--tb=native</code>     <em>traceback</em>   . </p><br><h3 id="--durationsn"> --durations=N </h3><br><p>  <code>--durations=N</code>  ,       .     ;    N  tests/setups/teardowns   .    <code>--durations=0</code> ,            . </p><br><p>      ,   <code>time.sleep(0.1)</code>    . , : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch1 $ pytest --durations=3 tasks ================= test session starts ================= collected 4 items tasks/test_four.py .. tasks/test_three.py .. ============== slowest 3 test durations =============== 0.10s call tasks/test_four.py::test_replace 0.00s setup tasks/test_three.py::test_defaults 0.00s teardown tasks/test_three.py::test_member_access ============== 4 passed in 0.13 seconds</code> </pre> <br><p>     <em>sleep</em>      ,      .        : call(), (setup)  (teardown).      ,                    ,  ,  ,  .       3, pytest Fixtures,  . 49. </p><br><h3 id="--version"> --version </h3><br><p>  <code>--version</code>   pytest  ,    : </p><br><pre> <code class="plaintext hljs">$ pytest --version This is pytest version 3.0.7, imported from /path/to/venv/lib/python3.5/site-packages/pytest.py</code> </pre> <br><p>    pytest   , pytest     site-packages   . </p><br><h3 id="-h---help"> -h, --help </h3><br><p>  <code>-h/--help</code>  ,   ,     pytest.     ,   stock- pytest,       ,      ,  . </p><br><p>  <code>-h</code> : </p><br><ul><li> : pytest [] [file_or_dir] [file_or_dir] [...] </li><li>      ,      </li><li>  ,   ini   ,        6, ,  . 113 </li><li>   ,      pytest (    6, ,  . 113) </li><li>   ,  pytest <code>--markers</code>      ,    2,   ,  . 23 </li><li>   ,  pytest <code>--fixtures</code>       ,    3,  pytest,  . 49 </li></ul><br><p>        : </p><br><pre> <code class="plaintext hljs">(shown according to specified file_or_dir or current dir if not specified)</code> </pre> <br><p>   ,  ,            .   ,         pytest    conftest.py,    - (hook functions),   ,     . </p><br><p>    pytest   conftest.py               .     conftest.py  ini,   pytest.ini   6 ¬´¬ª,   113. </p><br><h2 id="uprazhneniya">  Exerc√≠cios </h2><br><ol><li><p>    ,  <code>python -m virtualenv</code>  <code>python -m venv</code> .    ,        ,    ,       ,   ,      .      ,      .   1,  ,  . 155,     . </p><br></li><li><p>        . </p><br><pre> <code class="plaintext hljs">- $ source venv/bin/activate - $ deactivate On Windows: - C:\Users\okken\sandbox&gt;venv\scripts\activate.bat - C:\Users\okken\sandbox&gt;deactivate</code> </pre> <br></li><li><p>  pytest    . .  2, pip,   159,     .    ,      pytest,       ,     . </p><br></li><li><p>    .    ,          .  pytest   . </p><br></li><li><p>   assert.    assert something == something_else;   , : </p><br><ul><li> assert 1 in [2, 3, 4] </li><li> assert a &lt; b </li><li> assert 'fizz' not in 'fizzbuzz' </li></ul><br></li></ol><br><h2 id="chto-dalshe">  O que vem a seguir </h2><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neste cap√≠tulo, vimos onde obter o pytest e v√°rias maneiras de execut√°-lo. </font><font style="vertical-align: inherit;">No entanto, n√£o discutimos o que est√° inclu√≠do nas fun√ß√µes de teste. </font><font style="vertical-align: inherit;">No pr√≥ximo cap√≠tulo, consideraremos escrever fun√ß√µes de teste, parametriz√°-las para que elas sejam chamadas com dados diferentes e agrupar testes em classes, m√≥dulos e pacotes.</font></font></p><br><p><img src="https://habrastorage.org/webt/jl/jn/bb/jljnbbjr-ejh473xy_eccsmknpk.png">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Voltar</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pr√≥ximo</a> <img src="https://habrastorage.org/webt/rw/dy/-g/rwdy-grsvbpcetjttrmecdkxtlk.png"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt448782/">https://habr.com/ru/post/pt448782/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt448764/index.html">Rel√≥gios na ATtiny13</a></li>
<li><a href="../pt448766/index.html">Criar um monoreposit√≥rio com √°reas de trabalho lerna e fios</a></li>
<li><a href="../pt448768/index.html">Controle de ilumina√ß√£o em v√°rios n√≠veis: resili√™ncia de solu√ß√µes e produtos</a></li>
<li><a href="../pt448774/index.html">SQL para CSV usando DBMS_SQL</a></li>
<li><a href="../pt448776/index.html">RxVMS - Uma Arquitetura Pr√°tica para Aplica√ß√µes de Flutter</a></li>
<li><a href="../pt448784/index.html">Novos recursos para autores de extens√£o no Visual Studio 2019 vers√£o 16.1</a></li>
<li><a href="../pt448792/index.html">Teste de Python com pytest. Acess√≥rios Internos, Cap√≠tulo 4</a></li>
<li><a href="../pt448796/index.html">Teste de Python com pytest. Configura√ß√£o, CAP√çTULO 6</a></li>
<li><a href="../pt448798/index.html">Teste de Python com pytest. Usando pytest com outras ferramentas, CAP√çTULO 7</a></li>
<li><a href="../pt448802/index.html">Pensando em portais: criando portais no Unreal Engine 4</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>