<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🌾 🚝 🏐 Docker e Kubernetes em ambientes que exigem segurança 🐼 👩🏾‍✈️ 💢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nota perev. : O artigo original foi escrito por um engenheiro da Suécia, Christian Abdelmassih, apaixonado por arquitetura corporativa, segurança de T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Docker e Kubernetes em ambientes que exigem segurança</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/440504/"> <i><b>Nota</b></i>  <i><b>perev.</b></i>  <i>: O artigo original foi escrito por um engenheiro da Suécia, Christian Abdelmassih, apaixonado por arquitetura corporativa, segurança de TI e computação em nuvem.</i>  <i>Recentemente, ele fez mestrado em Ciência da Computação e tem pressa em compartilhar seu trabalho - uma tese de mestrado, ou melhor, parte dela, dedicada aos problemas de isolar um aplicativo em contêineres [e lançado no Kubernetes].</i>  <i>Como o "cliente" para quem essa pesquisa foi preparada, atua não menos que a polícia de sua terra natal.</i> <br><br><img src="https://habrastorage.org/webt/_8/ys/gr/_8ysgrs-atvkocc6r8jpzyzzu1g.jpeg"><br><br>  A orquestração de contêineres e a computação nativa da nuvem se tornaram muito populares nos últimos anos.  Sua adaptação atingiu um nível tal que até empresas financeiras, bancos e o setor público demonstram interesse neles.  Comparados a outras empresas, eles se distinguem por extensos requisitos no campo da segurança da informação e da TI. <a name="habracut"></a><br><br>  Um dos aspectos importantes é como os contêineres podem ser usados ​​em ambientes de produção e, ao mesmo tempo, a separação do sistema entre aplicativos pode ser mantida.  Como essas organizações usam ambientes de nuvem privada baseados na virtualização em cima do bare metal, a perda desse isolamento ao migrar para um ambiente com contêineres orquestrados é inaceitável.  Dadas essas limitações, minha dissertação foi escrita e a polícia sueca é considerada um cliente-alvo. <br><br>  A questão específica do estudo considerado na tese é: <br><br><blockquote>  Como a demarcação de aplicativo é suportada no Docker e no Kubernetes em comparação com as máquinas virtuais executadas no hipervisor ESXi em execução no bare metal? </blockquote><br>  Esse problema requer um estudo cuidadoso.  Para começar, observe o denominador comum - aplicativos. <br><br><h2>  Aplicativos da Web são confusos </h2><br>  Vulnerabilidades em aplicativos da Web - um verdadeiro zoológico de vetores de ataque.  Os riscos mais significativos são apresentados no OWASP Top 10 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2013</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2017</a> ).  Esses recursos ajudam a educar os desenvolvedores na redução de riscos típicos.  No entanto, mesmo que os desenvolvedores escrevam códigos sem falhas, o aplicativo ainda pode estar vulnerável - por exemplo, por meio de dependências de pacotes. <br><br>  David Gilbertson escreveu uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">história maravilhosa</a> sobre como você pode injetar código por meio de um pacote malicioso distribuído, por exemplo, como parte do NPM para aplicativos baseados em Node.js.  Para detectar vulnerabilidades, você pode usar scanners de dependência, mas eles apenas <i>reduzem o</i> risco, mas não o eliminam completamente. <br><br>  Mesmo se você criar aplicativos sem dependências de terceiros, ainda não é realista acreditar que o aplicativo nunca se tornará vulnerável. <br><br>  <b>Devido a esses riscos, não podemos dizer que os aplicativos da web são seguros.</b> <br><br>  Em vez disso, siga uma estratégia de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>defesa em profundidade</b></a> (DID).  Vamos dar uma olhada no próximo nível: contêineres e máquinas virtuais. <br><br><h2>  Contêineres versus máquinas virtuais - um conto de isolamento </h2><br>  Um contêiner é um ambiente isolado do espaço do usuário que geralmente é implementado usando os recursos do kernel.  Por exemplo, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Docker</a> usa os namespaces, cgroups e recursos do Linux para isso.  Nesse sentido, o isolamento dos contêineres do Docker é <b>muito diferente</b> das máquinas virtuais lançadas pelos hipervisores do tipo 1 <i>(ou seja, trabalhando diretamente no hardware; hipervisores bare-metal)</i> . <br><br>  A diferenciação para essas máquinas virtuais pode ser implementada em um nível tão baixo como no hardware real, por exemplo, através do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Intel VT</a> .  Os contêineres do Docker, por sua vez, contam com o kernel do Linux para demarcação.  Essa diferença é muito importante a considerar quando se trata de <i>ataques abaixo da camada</i> . <br><br>  Se um invasor conseguir executar o código em uma máquina ou contêiner virtual, ele poderá potencialmente chegar a um nível inferior executando um <i>ataque de escape</i> . <br><br><img src="https://habrastorage.org/webt/36/hl/_c/36hl_cjove9e7ufmr4g7f3vcq5q.png"><br>  <i>dependendo de contêineres ou máquinas virtuais serem usadas no hardware, a diferenciação é implementada em diferentes níveis de infraestrutura.</i> <br><br>  A possibilidade de tais ataques foi comprovada para o hipervisor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">VMware ESXi</a> durante o concurso de hackers Pwn2Own 2017, bem como o GeekPwn2018.  O resultado foi um par de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVEs</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2017–4902</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2018–6981</a> ) que podem ser usados ​​em ataques abaixo da camada para <b>sair de máquinas</b> <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">virtuais</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">escape de máquina virtual</a> )</i> .  Máquinas virtuais em servidores de ferro não garantem segurança absoluta, mesmo que usem tecnologia para diferenciar o nível de ferro. <br><br>  Por outro lado, se olharmos para os vetores de ataque em um hipervisor bare-metal versus o kernel Linux, é óbvio que este último possui uma superfície de ataque muito maior - devido ao seu tamanho [kernel Linux] e à variedade de recursos.  Uma superfície de ataque maior implica mais vetores de ataque em potencial para ambientes em nuvem usando isolamento de contêiner.  Isso se manifesta na crescente atenção aos <i>ataques de fuga de contêineres</i> , que foram possíveis graças a explorações do kernel (por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2016–5195</a> <i>[ie Dirty COW - approx. Transl.]</i> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2017–1000405</a> ) <br><br>  Módulos como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SELinux</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AppArmor</a> podem ser usados ​​para aumentar o isolamento <b>dentro do</b> contêiner.  Infelizmente, esses mecanismos de segurança no kernel não impedem ataques de escape no próprio kernel.  Eles limitarão as ações possíveis do atacante se <i>não</i> for <i>possível</i> ultrapassar os limites.  Se quisermos lidar com saídas fora do contêiner, <b>é</b> necessário um mecanismo de isolamento <b>fora do</b> contêiner ou mesmo o núcleo.  Por exemplo, uma caixa de areia <i>(sandbox)</i> ! <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O gVisor</a> é uma caixa de proteção para o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tempo de execução</a> do contêiner, cujo código foi aberto pelo Google e que adiciona um kernel adicional entre o contêiner e o kernel do sistema operacional.  Esse tipo de sandbox pode melhorar a situação com ataques de contêineres fora do limite que ocorrem <i>no nível do kernel</i> .  No entanto, as explorações principais são apenas uma das ferramentas do invasor. <br><br>  Para ver como outros ataques podem levar a resultados semelhantes, é necessário ter uma visão mais geral de como os contêineres são usados ​​na era nativa da nuvem. <br><br><h2>  O efeito da orquestração de contêiner no isolamento </h2><br>  Para gerenciar contêineres em execução em ambientes com muitos nós, eles introduzem a orquestração, na qual o Kubernetes assume o papel principal.  Acontece que os erros do orquestrador também podem afetar o isolamento do contêiner. <br><br>  Tim Allclair <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fez</a> uma apresentação maravilhosa no KubeCon 2018, na qual observou algumas superfícies de ataque.  Em seu relatório, ele <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">menciona</a> um exemplo ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2017-1002101</a> ), de como os erros de orquestração podem afetar o isolamento - nesse caso, através da capacidade de montar espaço em disco fora do pod.  Vulnerabilidades desse tipo são muito problemáticas, porque  pode ignorar a caixa de areia na qual o contêiner está embrulhado. <br><br>  Com a introdução do Kubernetes, expandimos a superfície de ataque.  Inclui sistemas hospedados no mestre Kubernetes.  Um deles é o servidor da API Kubernetes, onde eles descobriram recentemente uma vulnerabilidade que poderia permitir privilégios <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">excessivos</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2018–1002105</a> ).  Como a superfície de ataque do mestre Kubernetes está além do escopo da minha dissertação, essa vulnerabilidade específica não é levada em consideração. <br><br>  Por que os ataques de fuga são tão importantes?  Os contêineres forneceram a capacidade de executar muitos aplicativos co-hospedados no mesmo sistema operacional.  Portanto, havia um risco associado ao isolamento de aplicativos.  Se um aplicativo crítico para os negócios e outro aplicativo vulnerável estiverem em execução no mesmo host, um invasor poderá obter acesso a um aplicativo crítico por meio de um ataque a um aplicativo vulnerável. <br><br>  Dependendo do tipo de dados com o qual a organização está trabalhando, o vazamento pode prejudicar não apenas a própria organização, mas também indivíduos e todo o país.  Como você se lembra, estamos falando sobre o setor público, finanças, bancos ... - um vazamento pode afetar seriamente a vida das pessoas. <br><br>  Então, a orquestração de contêineres pode até ser usada nesses ambientes?  Antes de iniciar uma reflexão mais aprofundada, uma avaliação de risco deve ser realizada. <br><br><h2>  Que risco é aceitável? </h2><br>  Antes de introduzir medidas de segurança, é importante pensar sobre que tipo de informação a organização está realmente tentando proteger.  A decisão sobre se são necessárias etapas adicionais para evitar possíveis ataques de escape em contêineres depende dos dados com os quais a organização está trabalhando e dos serviços que fornece. <br><br>  A longo prazo, isso significa que, para obter a possibilidade de sair do contêiner em um host <i>configurado corretamente</i> protegido pela sandbox do contêiner, o invasor deve: <br><br><ol><li>  executar código em um contêiner, por exemplo, por injeção de código ou usando vulnerabilidades no código do aplicativo; </li><li>  tire vantagem de outra vulnerabilidade, dia zero, ou para a qual um patch ainda não foi aplicado para sair do contêiner, mesmo <i>que haja uma caixa de proteção</i> . </li></ol><br>  Como você pode imaginar, uma organização que não considera esse cenário válido deve trabalhar com dados ou oferecer serviços muito exigentes quanto à <b>confidencialidade</b> , <b>integridade</b> e / ou <b>acessibilidade</b> . <br><br>  Como a dissertação é dedicada apenas a esses clientes, a perda do isolamento do sistema saindo do contêiner não é permitida, pois  suas consequências são muito significativas.  Que medidas podem ser tomadas para melhorar o isolamento?  Para subir de nível na escada de isolamento, observe também as caixas de proteção nas quais o kernel do sistema operacional está agrupado, ou seja,  máquinas virtuais! <br><br>  As tecnologias de virtualização que usam hipervisores hospedados melhorarão a situação, mas queremos limitar <i>ainda mais a</i> superfície de ataque.  Portanto, vamos examinar os hipervisores instalados no ferro e ver o que eles nos levarão. <br><br><h2>  Hipervisores em ferro </h2><br>  Um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estudo da</a> Agência Sueca de Pesquisa de Defesa Sueca examinou os riscos da virtualização em relação às Forças Armadas Suecas.  Sua conclusão falou dos benefícios dessas tecnologias para os militares, mesmo com os rigorosos requisitos de segurança e riscos que a virtualização traz. <br><br>  Nesse sentido, podemos dizer que a virtualização é usada (até certo ponto) na indústria de defesa, pois carrega <b>riscos aceitáveis</b> .  Como as agências e empresas do setor de defesa são um dos clientes mais exigentes em segurança de TI, também podemos argumentar que o risco aceitável para eles significa que é aceitável para os clientes considerados na dissertação.  E tudo isso - apesar das saídas potenciais além da máquina virtual, discutidas acima. <br><br>  Se decidirmos usar esse tipo de sandbox para contêineres, há algumas coisas a considerar no contexto de detalhes nativos da nuvem. <br><br><h2>  Nós de sandbox para máquinas virtuais </h2><br>  A ideia é que os nós do cluster Kubernetes sejam máquinas virtuais que usam virtualização de hardware.  Como as máquinas virtuais desempenharão o papel de caixas de proteção de contêiner que são executadas em pods, cada nó pode ser considerado um ambiente protegido por caixa de proteção. <br><br>  Uma observação importante sobre essas caixas de proteção no contexto das caixas de proteção de contêineres já mencionadas: essa abordagem permite colocar muitos contêineres em uma caixa de proteção.  Essa flexibilidade permite reduzir a sobrecarga quando comparada com o caso em que cada contêiner possui sua própria caixa de proteção.  Como cada sandbox traz seu próprio sistema operacional, queremos reduzir seu número enquanto mantém o isolamento. <br><br><img src="https://habrastorage.org/webt/wg/2t/jr/wg2tjra8xh9y_i7vlyygm7vulzy.png"><br>  <i>Máquinas virtuais instaladas no hardware - nós do cluster - atuam como caixas de proteção para contêineres.</i>  <i>Os contêineres executados em diferentes VMs são delimitados com um nível de risco aceitável.</i>  <i>No entanto, isso não se aplica a contêineres em execução na mesma VM.</i> <br><br>  No entanto, como o Kubernetes é capaz de alterar a localização dos pods por vários motivos, o que pode <b>arruinar a ideia de usar caixas de areia</b> , será necessário adicionar restrições ao mecanismo de posicionamento conjunto dos pods.  Você pode alcançar o desejado de várias maneiras. <br><br>  No momento da redação deste artigo, o Kubernetes ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">v1.13</a> ) suporta três métodos principais para controlar o planejamento e / ou o lançamento de pods: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NodeSelector</a> &amp; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NodeAffinity</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Taints &amp; tolerations</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PodAffinity e PodAntiAffinity</a> . </li></ul><br>  Quais métodos usar dependem da aplicação da organização.  No entanto, é importante observar que os métodos diferem em sua capacidade de descartar os pods depois que eles entram no estágio de execução.  Agora, apenas manchas são capazes disso - através da ação <code>NoExecute</code> .  Se você não processar esse momento de maneira alguma e alguns rótulos mudarem, tudo poderá levar a uma localização indesejável. <br><br><h2>  Conformidade com os requisitos de co-localização </h2><br>  A dissertação propõe a idéia de usar um sistema de classificação que mostre como a sensibilidade é refletida na co-localização.  A idéia é usar o relacionamento 1: 1 entre o contêiner e o pod e determinar a localização dos pods com base na classificação de aplicativos em contêiner. <br><br>  Para simplificar e reutilizar, o seguinte sistema de classificação em três etapas é usado: <br><br><ul><li>  <b>Classe O</b> : O aplicativo não é sensível e não possui requisitos de isolamento.  Pode ser colocado em qualquer nó que não pertença a outras classes. </li><li>  <b>Classe PG</b> <i>(grupo privado)</i> : um aplicativo, juntamente com um conjunto de outros aplicativos, forma um grupo privado para o qual um nó dedicado é necessário.  Um aplicativo pode ser hospedado apenas em nós da classe PG que possuem o identificador de grupo privado correspondente. </li><li>  <b>Classe P</b> <i>(privada)</i> : um aplicativo requer um nó privado e separado e só pode ser colocado em nós vazios de sua classe (P). </li></ul><br>  Para atender aos requisitos de co-localização para muitos aplicativos classificados, são utilizadas restrições e tolerâncias, com as quais cada nó recebe uma classe, e o PodAffinity para aplicar restrições adicionais para pods com aplicativos da classe P ou PG. <br><br>  Este exemplo simplificado mostra como restrições e tolerâncias podem ser usadas para implementar o controle de co-localização: <br><br><img src="https://habrastorage.org/webt/ul/qj/ec/ulqjecbgz60kuw7upls5jyrxpik.gif"><br><br>  <i>Os pods 2 e 3 contêm aplicativos de um grupo privado, e o aplicativo no pod 1 é mais sensível e requer um nó dedicado.</i> <br><br>  No entanto, as classes P e PG exigirão regras adicionais de afinidade para garantir que as solicitações de demarcação sejam executadas à medida que o cluster e os aplicativos hospedados crescem.  Vamos ver como você pode implementar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">essas regras</a> para diferentes classes: <br><br><pre> <code class="plaintext hljs"># Class P affinity: podAntiAffinity: requiredDuringSchedulingIgnoredDuringExecution: - topologyKey: "kubernetes.io/hostname" namespaces: ["default"] labelSelector: matchExpressions: - key: non-existing-key operator: DoesNotExist</code> </pre> <br>  As regras de afinidade para aplicativos de classe P requerem nós dedicados.  Nesse caso, o pod não será agendado se o pod sair sem a chave <code>non-existing-key</code> .  Tudo funcionará até que um único pod tenha essa chave. <br><br><pre> <code class="plaintext hljs"># Class PG affinity: podAffinity: requiredDuringSchedulingIgnoredDuringExecution: - topologyKey: "kubernetes.io/hostname" labelSelector: matchLabels: class-pg-group-1: foobar podAntiAffinity: requiredDuringSchedulingIgnoredDuringExecution: - topologyKey: "kubernetes.io/hostname" labelSelector: matchExpressions: - key: class-pg-group-1 operator: DoesNotExist</code> </pre> <br>  Para aplicativos de classe PG, as regras de afinidade irão hospedar pods com um identificador de <code>class-pg-group-1</code> e em nós que possuem pods sem um identificador. <br><br>  Essa abordagem nos permitirá usar um sistema de classificação para delimitar contêineres com base nos requisitos relevantes de um aplicativo em contêiner. <br><br>  O que conseguimos? <br><br><h2>  Conclusão </h2><br>  Consideramos uma maneira de implementar sandboxes com base no hipervisor tipo 1 (ou seja, lançado no bare metal) para criar nós nos clusters Kubernetes e apresentamos um sistema de classificação que define os requisitos para a delimitação de aplicativos em contêiner.  Se compararmos essa abordagem com as outras soluções consideradas, ela apresenta vantagens em termos de garantir o isolamento do sistema. <br><br>  Uma conclusão importante é que a estratégia de isolamento <i>restringe a propagação de</i> ataques <i>de</i> escape para o contêiner.  <b>Em outras palavras, deixar o contêiner por si só não é impedido, mas seus efeitos são mitigados.</b>  Obviamente, junto com isso, surgem dificuldades adicionais que devem ser levadas em consideração ao fazer comparações semelhantes. <br><br>  Para usar o método especificado em um ambiente de nuvem e fornecer escalabilidade, requisitos adicionais serão impostos à automação.  Por exemplo, para automatizar a criação de máquinas virtuais e seu uso no cluster Kubernetes.  O mais importante será a implementação e verificação da <b>ampla</b> classificação de aplicativos. <br><br>  Isso faz parte da minha dissertação sobre o <b>isolamento de um aplicativo em contêiner</b> . <br><br>  Para evitar a possibilidade de um invasor que saiu do contêiner em um nó atacar os serviços de outros nós, é necessário considerar <i>ataques propagados pela rede</i> .  Para levar esses riscos em consideração, minha dissertação propõe a <b><i>segmentação da rede de cluster</i></b> e apresenta arquiteturas de nuvem, uma das quais com <b>firewall de hardware</b> . <br><br>  Quem desejar pode se familiarizar com o documento completo - o texto da dissertação é de acesso público: “ <a href="">Orquestração de contêineres em ambientes exigentes de segurança na Autoridade Policial Sueca</a> ”. <br><br><h2>  PS do tradutor </h2><br>  Leia também em nosso blog: <br><br><ul><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vulnerabilidade CVE-2019-5736 em runc, permitindo obter privilégios de root no host</a> "; </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">9 melhores práticas de segurança na Kubernetes</a> ”; </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">11 maneiras de (não) se tornar uma vítima do Kubernetes Hacking</a> ”; </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Entendendo o RBAC no Kubernetes</a> ”; </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OPA e SPIFFE - Dois novos projetos no CNCF para segurança de aplicativos em nuvem</a> ”; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vulnerable Docker VM - um jogo virtual de Docker e pentesting</a> ." </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt440504/">https://habr.com/ru/post/pt440504/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt440490/index.html">Biomodule 1-2</a></li>
<li><a href="../pt440492/index.html">Coréia do Sul abandonará carros elétricos e construção de novas usinas nucleares</a></li>
<li><a href="../pt440498/index.html">Polícia de Moscou receberá pontos com reconhecimento facial</a></li>
<li><a href="../pt440500/index.html">Primeiro</a></li>
<li><a href="../pt440502/index.html">Como iniciar seu podcast, um guia para iniciantes</a></li>
<li><a href="../pt440506/index.html">A sonda lunar orbital da NASA captou novas imagens da estação chinesa Chang'e-4 - mais perto e mais clara</a></li>
<li><a href="../pt440508/index.html">Como perder seu hobby e torná-lo um negócio on-line de sucesso nos EUA</a></li>
<li><a href="../pt440510/index.html">Quem desenvolve switches de 400GbE para data centers</a></li>
<li><a href="../pt440512/index.html">Fatoriais divisíveis</a></li>
<li><a href="../pt440514/index.html">Quem povoará a terra dos ciborgues? O status de desenvolvimento da empresa Motorika falou sobre o status futuro da Ilha Russky</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>