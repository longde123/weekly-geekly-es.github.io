<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçüåæ üöù üèê Docker e Kubernetes em ambientes que exigem seguran√ßa üêº üë©üèæ‚Äç‚úàÔ∏è üí¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nota perev. : O artigo original foi escrito por um engenheiro da Su√©cia, Christian Abdelmassih, apaixonado por arquitetura corporativa, seguran√ßa de T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Docker e Kubernetes em ambientes que exigem seguran√ßa</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/440504/"> <i><b>Nota</b></i>  <i><b>perev.</b></i>  <i>: O artigo original foi escrito por um engenheiro da Su√©cia, Christian Abdelmassih, apaixonado por arquitetura corporativa, seguran√ßa de TI e computa√ß√£o em nuvem.</i>  <i>Recentemente, ele fez mestrado em Ci√™ncia da Computa√ß√£o e tem pressa em compartilhar seu trabalho - uma tese de mestrado, ou melhor, parte dela, dedicada aos problemas de isolar um aplicativo em cont√™ineres [e lan√ßado no Kubernetes].</i>  <i>Como o "cliente" para quem essa pesquisa foi preparada, atua n√£o menos que a pol√≠cia de sua terra natal.</i> <br><br><img src="https://habrastorage.org/webt/_8/ys/gr/_8ysgrs-atvkocc6r8jpzyzzu1g.jpeg"><br><br>  A orquestra√ß√£o de cont√™ineres e a computa√ß√£o nativa da nuvem se tornaram muito populares nos √∫ltimos anos.  Sua adapta√ß√£o atingiu um n√≠vel tal que at√© empresas financeiras, bancos e o setor p√∫blico demonstram interesse neles.  Comparados a outras empresas, eles se distinguem por extensos requisitos no campo da seguran√ßa da informa√ß√£o e da TI. <a name="habracut"></a><br><br>  Um dos aspectos importantes √© como os cont√™ineres podem ser usados ‚Äã‚Äãem ambientes de produ√ß√£o e, ao mesmo tempo, a separa√ß√£o do sistema entre aplicativos pode ser mantida.  Como essas organiza√ß√µes usam ambientes de nuvem privada baseados na virtualiza√ß√£o em cima do bare metal, a perda desse isolamento ao migrar para um ambiente com cont√™ineres orquestrados √© inaceit√°vel.  Dadas essas limita√ß√µes, minha disserta√ß√£o foi escrita e a pol√≠cia sueca √© considerada um cliente-alvo. <br><br>  A quest√£o espec√≠fica do estudo considerado na tese √©: <br><br><blockquote>  Como a demarca√ß√£o de aplicativo √© suportada no Docker e no Kubernetes em compara√ß√£o com as m√°quinas virtuais executadas no hipervisor ESXi em execu√ß√£o no bare metal? </blockquote><br>  Esse problema requer um estudo cuidadoso.  Para come√ßar, observe o denominador comum - aplicativos. <br><br><h2>  Aplicativos da Web s√£o confusos </h2><br>  Vulnerabilidades em aplicativos da Web - um verdadeiro zool√≥gico de vetores de ataque.  Os riscos mais significativos s√£o apresentados no OWASP Top 10 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2013</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2017</a> ).  Esses recursos ajudam a educar os desenvolvedores na redu√ß√£o de riscos t√≠picos.  No entanto, mesmo que os desenvolvedores escrevam c√≥digos sem falhas, o aplicativo ainda pode estar vulner√°vel - por exemplo, por meio de depend√™ncias de pacotes. <br><br>  David Gilbertson escreveu uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">hist√≥ria maravilhosa</a> sobre como voc√™ pode injetar c√≥digo por meio de um pacote malicioso distribu√≠do, por exemplo, como parte do NPM para aplicativos baseados em Node.js.  Para detectar vulnerabilidades, voc√™ pode usar scanners de depend√™ncia, mas eles apenas <i>reduzem o</i> risco, mas n√£o o eliminam completamente. <br><br>  Mesmo se voc√™ criar aplicativos sem depend√™ncias de terceiros, ainda n√£o √© realista acreditar que o aplicativo nunca se tornar√° vulner√°vel. <br><br>  <b>Devido a esses riscos, n√£o podemos dizer que os aplicativos da web s√£o seguros.</b> <br><br>  Em vez disso, siga uma estrat√©gia de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>defesa em profundidade</b></a> (DID).  Vamos dar uma olhada no pr√≥ximo n√≠vel: cont√™ineres e m√°quinas virtuais. <br><br><h2>  Cont√™ineres versus m√°quinas virtuais - um conto de isolamento </h2><br>  Um cont√™iner √© um ambiente isolado do espa√ßo do usu√°rio que geralmente √© implementado usando os recursos do kernel.  Por exemplo, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Docker</a> usa os namespaces, cgroups e recursos do Linux para isso.  Nesse sentido, o isolamento dos cont√™ineres do Docker √© <b>muito diferente</b> das m√°quinas virtuais lan√ßadas pelos hipervisores do tipo 1 <i>(ou seja, trabalhando diretamente no hardware; hipervisores bare-metal)</i> . <br><br>  A diferencia√ß√£o para essas m√°quinas virtuais pode ser implementada em um n√≠vel t√£o baixo como no hardware real, por exemplo, atrav√©s do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Intel VT</a> .  Os cont√™ineres do Docker, por sua vez, contam com o kernel do Linux para demarca√ß√£o.  Essa diferen√ßa √© muito importante a considerar quando se trata de <i>ataques abaixo da camada</i> . <br><br>  Se um invasor conseguir executar o c√≥digo em uma m√°quina ou cont√™iner virtual, ele poder√° potencialmente chegar a um n√≠vel inferior executando um <i>ataque de escape</i> . <br><br><img src="https://habrastorage.org/webt/36/hl/_c/36hl_cjove9e7ufmr4g7f3vcq5q.png"><br>  <i>dependendo de cont√™ineres ou m√°quinas virtuais serem usadas no hardware, a diferencia√ß√£o √© implementada em diferentes n√≠veis de infraestrutura.</i> <br><br>  A possibilidade de tais ataques foi comprovada para o hipervisor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">VMware ESXi</a> durante o concurso de hackers Pwn2Own 2017, bem como o GeekPwn2018.  O resultado foi um par de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVEs</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2017‚Äì4902</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2018‚Äì6981</a> ) que podem ser usados ‚Äã‚Äãem ataques abaixo da camada para <b>sair de m√°quinas</b> <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">virtuais</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">escape de m√°quina virtual</a> )</i> .  M√°quinas virtuais em servidores de ferro n√£o garantem seguran√ßa absoluta, mesmo que usem tecnologia para diferenciar o n√≠vel de ferro. <br><br>  Por outro lado, se olharmos para os vetores de ataque em um hipervisor bare-metal versus o kernel Linux, √© √≥bvio que este √∫ltimo possui uma superf√≠cie de ataque muito maior - devido ao seu tamanho [kernel Linux] e √† variedade de recursos.  Uma superf√≠cie de ataque maior implica mais vetores de ataque em potencial para ambientes em nuvem usando isolamento de cont√™iner.  Isso se manifesta na crescente aten√ß√£o aos <i>ataques de fuga de cont√™ineres</i> , que foram poss√≠veis gra√ßas a explora√ß√µes do kernel (por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2016‚Äì5195</a> <i>[ie Dirty COW - approx. Transl.]</i> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2017‚Äì1000405</a> ) <br><br>  M√≥dulos como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SELinux</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AppArmor</a> podem ser usados ‚Äã‚Äãpara aumentar o isolamento <b>dentro do</b> cont√™iner.  Infelizmente, esses mecanismos de seguran√ßa no kernel n√£o impedem ataques de escape no pr√≥prio kernel.  Eles limitar√£o as a√ß√µes poss√≠veis do atacante se <i>n√£o</i> for <i>poss√≠vel</i> ultrapassar os limites.  Se quisermos lidar com sa√≠das fora do cont√™iner, <b>√©</b> necess√°rio um mecanismo de isolamento <b>fora do</b> cont√™iner ou mesmo o n√∫cleo.  Por exemplo, uma caixa de areia <i>(sandbox)</i> ! <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O gVisor</a> √© uma caixa de prote√ß√£o para o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tempo de execu√ß√£o</a> do cont√™iner, cujo c√≥digo foi aberto pelo Google e que adiciona um kernel adicional entre o cont√™iner e o kernel do sistema operacional.  Esse tipo de sandbox pode melhorar a situa√ß√£o com ataques de cont√™ineres fora do limite que ocorrem <i>no n√≠vel do kernel</i> .  No entanto, as explora√ß√µes principais s√£o apenas uma das ferramentas do invasor. <br><br>  Para ver como outros ataques podem levar a resultados semelhantes, √© necess√°rio ter uma vis√£o mais geral de como os cont√™ineres s√£o usados ‚Äã‚Äãna era nativa da nuvem. <br><br><h2>  O efeito da orquestra√ß√£o de cont√™iner no isolamento </h2><br>  Para gerenciar cont√™ineres em execu√ß√£o em ambientes com muitos n√≥s, eles introduzem a orquestra√ß√£o, na qual o Kubernetes assume o papel principal.  Acontece que os erros do orquestrador tamb√©m podem afetar o isolamento do cont√™iner. <br><br>  Tim Allclair <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fez</a> uma apresenta√ß√£o maravilhosa no KubeCon 2018, na qual observou algumas superf√≠cies de ataque.  Em seu relat√≥rio, ele <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">menciona</a> um exemplo ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2017-1002101</a> ), de como os erros de orquestra√ß√£o podem afetar o isolamento - nesse caso, atrav√©s da capacidade de montar espa√ßo em disco fora do pod.  Vulnerabilidades desse tipo s√£o muito problem√°ticas, porque  pode ignorar a caixa de areia na qual o cont√™iner est√° embrulhado. <br><br>  Com a introdu√ß√£o do Kubernetes, expandimos a superf√≠cie de ataque.  Inclui sistemas hospedados no mestre Kubernetes.  Um deles √© o servidor da API Kubernetes, onde eles descobriram recentemente uma vulnerabilidade que poderia permitir privil√©gios <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">excessivos</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE-2018‚Äì1002105</a> ).  Como a superf√≠cie de ataque do mestre Kubernetes est√° al√©m do escopo da minha disserta√ß√£o, essa vulnerabilidade espec√≠fica n√£o √© levada em considera√ß√£o. <br><br>  Por que os ataques de fuga s√£o t√£o importantes?  Os cont√™ineres forneceram a capacidade de executar muitos aplicativos co-hospedados no mesmo sistema operacional.  Portanto, havia um risco associado ao isolamento de aplicativos.  Se um aplicativo cr√≠tico para os neg√≥cios e outro aplicativo vulner√°vel estiverem em execu√ß√£o no mesmo host, um invasor poder√° obter acesso a um aplicativo cr√≠tico por meio de um ataque a um aplicativo vulner√°vel. <br><br>  Dependendo do tipo de dados com o qual a organiza√ß√£o est√° trabalhando, o vazamento pode prejudicar n√£o apenas a pr√≥pria organiza√ß√£o, mas tamb√©m indiv√≠duos e todo o pa√≠s.  Como voc√™ se lembra, estamos falando sobre o setor p√∫blico, finan√ßas, bancos ... - um vazamento pode afetar seriamente a vida das pessoas. <br><br>  Ent√£o, a orquestra√ß√£o de cont√™ineres pode at√© ser usada nesses ambientes?  Antes de iniciar uma reflex√£o mais aprofundada, uma avalia√ß√£o de risco deve ser realizada. <br><br><h2>  Que risco √© aceit√°vel? </h2><br>  Antes de introduzir medidas de seguran√ßa, √© importante pensar sobre que tipo de informa√ß√£o a organiza√ß√£o est√° realmente tentando proteger.  A decis√£o sobre se s√£o necess√°rias etapas adicionais para evitar poss√≠veis ataques de escape em cont√™ineres depende dos dados com os quais a organiza√ß√£o est√° trabalhando e dos servi√ßos que fornece. <br><br>  A longo prazo, isso significa que, para obter a possibilidade de sair do cont√™iner em um host <i>configurado corretamente</i> protegido pela sandbox do cont√™iner, o invasor deve: <br><br><ol><li>  executar c√≥digo em um cont√™iner, por exemplo, por inje√ß√£o de c√≥digo ou usando vulnerabilidades no c√≥digo do aplicativo; </li><li>  tire vantagem de outra vulnerabilidade, dia zero, ou para a qual um patch ainda n√£o foi aplicado para sair do cont√™iner, mesmo <i>que haja uma caixa de prote√ß√£o</i> . </li></ol><br>  Como voc√™ pode imaginar, uma organiza√ß√£o que n√£o considera esse cen√°rio v√°lido deve trabalhar com dados ou oferecer servi√ßos muito exigentes quanto √† <b>confidencialidade</b> , <b>integridade</b> e / ou <b>acessibilidade</b> . <br><br>  Como a disserta√ß√£o √© dedicada apenas a esses clientes, a perda do isolamento do sistema saindo do cont√™iner n√£o √© permitida, pois  suas consequ√™ncias s√£o muito significativas.  Que medidas podem ser tomadas para melhorar o isolamento?  Para subir de n√≠vel na escada de isolamento, observe tamb√©m as caixas de prote√ß√£o nas quais o kernel do sistema operacional est√° agrupado, ou seja,  m√°quinas virtuais! <br><br>  As tecnologias de virtualiza√ß√£o que usam hipervisores hospedados melhorar√£o a situa√ß√£o, mas queremos limitar <i>ainda mais a</i> superf√≠cie de ataque.  Portanto, vamos examinar os hipervisores instalados no ferro e ver o que eles nos levar√£o. <br><br><h2>  Hipervisores em ferro </h2><br>  Um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estudo da</a> Ag√™ncia Sueca de Pesquisa de Defesa Sueca examinou os riscos da virtualiza√ß√£o em rela√ß√£o √†s For√ßas Armadas Suecas.  Sua conclus√£o falou dos benef√≠cios dessas tecnologias para os militares, mesmo com os rigorosos requisitos de seguran√ßa e riscos que a virtualiza√ß√£o traz. <br><br>  Nesse sentido, podemos dizer que a virtualiza√ß√£o √© usada (at√© certo ponto) na ind√∫stria de defesa, pois carrega <b>riscos aceit√°veis</b> .  Como as ag√™ncias e empresas do setor de defesa s√£o um dos clientes mais exigentes em seguran√ßa de TI, tamb√©m podemos argumentar que o risco aceit√°vel para eles significa que √© aceit√°vel para os clientes considerados na disserta√ß√£o.  E tudo isso - apesar das sa√≠das potenciais al√©m da m√°quina virtual, discutidas acima. <br><br>  Se decidirmos usar esse tipo de sandbox para cont√™ineres, h√° algumas coisas a considerar no contexto de detalhes nativos da nuvem. <br><br><h2>  N√≥s de sandbox para m√°quinas virtuais </h2><br>  A ideia √© que os n√≥s do cluster Kubernetes sejam m√°quinas virtuais que usam virtualiza√ß√£o de hardware.  Como as m√°quinas virtuais desempenhar√£o o papel de caixas de prote√ß√£o de cont√™iner que s√£o executadas em pods, cada n√≥ pode ser considerado um ambiente protegido por caixa de prote√ß√£o. <br><br>  Uma observa√ß√£o importante sobre essas caixas de prote√ß√£o no contexto das caixas de prote√ß√£o de cont√™ineres j√° mencionadas: essa abordagem permite colocar muitos cont√™ineres em uma caixa de prote√ß√£o.  Essa flexibilidade permite reduzir a sobrecarga quando comparada com o caso em que cada cont√™iner possui sua pr√≥pria caixa de prote√ß√£o.  Como cada sandbox traz seu pr√≥prio sistema operacional, queremos reduzir seu n√∫mero enquanto mant√©m o isolamento. <br><br><img src="https://habrastorage.org/webt/wg/2t/jr/wg2tjra8xh9y_i7vlyygm7vulzy.png"><br>  <i>M√°quinas virtuais instaladas no hardware - n√≥s do cluster - atuam como caixas de prote√ß√£o para cont√™ineres.</i>  <i>Os cont√™ineres executados em diferentes VMs s√£o delimitados com um n√≠vel de risco aceit√°vel.</i>  <i>No entanto, isso n√£o se aplica a cont√™ineres em execu√ß√£o na mesma VM.</i> <br><br>  No entanto, como o Kubernetes √© capaz de alterar a localiza√ß√£o dos pods por v√°rios motivos, o que pode <b>arruinar a ideia de usar caixas de areia</b> , ser√° necess√°rio adicionar restri√ß√µes ao mecanismo de posicionamento conjunto dos pods.  Voc√™ pode alcan√ßar o desejado de v√°rias maneiras. <br><br>  No momento da reda√ß√£o deste artigo, o Kubernetes ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">v1.13</a> ) suporta tr√™s m√©todos principais para controlar o planejamento e / ou o lan√ßamento de pods: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NodeSelector</a> &amp; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NodeAffinity</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Taints &amp; tolerations</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PodAffinity e PodAntiAffinity</a> . </li></ul><br>  Quais m√©todos usar dependem da aplica√ß√£o da organiza√ß√£o.  No entanto, √© importante observar que os m√©todos diferem em sua capacidade de descartar os pods depois que eles entram no est√°gio de execu√ß√£o.  Agora, apenas manchas s√£o capazes disso - atrav√©s da a√ß√£o <code>NoExecute</code> .  Se voc√™ n√£o processar esse momento de maneira alguma e alguns r√≥tulos mudarem, tudo poder√° levar a uma localiza√ß√£o indesej√°vel. <br><br><h2>  Conformidade com os requisitos de co-localiza√ß√£o </h2><br>  A disserta√ß√£o prop√µe a id√©ia de usar um sistema de classifica√ß√£o que mostre como a sensibilidade √© refletida na co-localiza√ß√£o.  A id√©ia √© usar o relacionamento 1: 1 entre o cont√™iner e o pod e determinar a localiza√ß√£o dos pods com base na classifica√ß√£o de aplicativos em cont√™iner. <br><br>  Para simplificar e reutilizar, o seguinte sistema de classifica√ß√£o em tr√™s etapas √© usado: <br><br><ul><li>  <b>Classe O</b> : O aplicativo n√£o √© sens√≠vel e n√£o possui requisitos de isolamento.  Pode ser colocado em qualquer n√≥ que n√£o perten√ßa a outras classes. </li><li>  <b>Classe PG</b> <i>(grupo privado)</i> : um aplicativo, juntamente com um conjunto de outros aplicativos, forma um grupo privado para o qual um n√≥ dedicado √© necess√°rio.  Um aplicativo pode ser hospedado apenas em n√≥s da classe PG que possuem o identificador de grupo privado correspondente. </li><li>  <b>Classe P</b> <i>(privada)</i> : um aplicativo requer um n√≥ privado e separado e s√≥ pode ser colocado em n√≥s vazios de sua classe (P). </li></ul><br>  Para atender aos requisitos de co-localiza√ß√£o para muitos aplicativos classificados, s√£o utilizadas restri√ß√µes e toler√¢ncias, com as quais cada n√≥ recebe uma classe, e o PodAffinity para aplicar restri√ß√µes adicionais para pods com aplicativos da classe P ou PG. <br><br>  Este exemplo simplificado mostra como restri√ß√µes e toler√¢ncias podem ser usadas para implementar o controle de co-localiza√ß√£o: <br><br><img src="https://habrastorage.org/webt/ul/qj/ec/ulqjecbgz60kuw7upls5jyrxpik.gif"><br><br>  <i>Os pods 2 e 3 cont√™m aplicativos de um grupo privado, e o aplicativo no pod 1 √© mais sens√≠vel e requer um n√≥ dedicado.</i> <br><br>  No entanto, as classes P e PG exigir√£o regras adicionais de afinidade para garantir que as solicita√ß√µes de demarca√ß√£o sejam executadas √† medida que o cluster e os aplicativos hospedados crescem.  Vamos ver como voc√™ pode implementar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">essas regras</a> para diferentes classes: <br><br><pre> <code class="plaintext hljs"># Class P affinity: podAntiAffinity: requiredDuringSchedulingIgnoredDuringExecution: - topologyKey: "kubernetes.io/hostname" namespaces: ["default"] labelSelector: matchExpressions: - key: non-existing-key operator: DoesNotExist</code> </pre> <br>  As regras de afinidade para aplicativos de classe P requerem n√≥s dedicados.  Nesse caso, o pod n√£o ser√° agendado se o pod sair sem a chave <code>non-existing-key</code> .  Tudo funcionar√° at√© que um √∫nico pod tenha essa chave. <br><br><pre> <code class="plaintext hljs"># Class PG affinity: podAffinity: requiredDuringSchedulingIgnoredDuringExecution: - topologyKey: "kubernetes.io/hostname" labelSelector: matchLabels: class-pg-group-1: foobar podAntiAffinity: requiredDuringSchedulingIgnoredDuringExecution: - topologyKey: "kubernetes.io/hostname" labelSelector: matchExpressions: - key: class-pg-group-1 operator: DoesNotExist</code> </pre> <br>  Para aplicativos de classe PG, as regras de afinidade ir√£o hospedar pods com um identificador de <code>class-pg-group-1</code> e em n√≥s que possuem pods sem um identificador. <br><br>  Essa abordagem nos permitir√° usar um sistema de classifica√ß√£o para delimitar cont√™ineres com base nos requisitos relevantes de um aplicativo em cont√™iner. <br><br>  O que conseguimos? <br><br><h2>  Conclus√£o </h2><br>  Consideramos uma maneira de implementar sandboxes com base no hipervisor tipo 1 (ou seja, lan√ßado no bare metal) para criar n√≥s nos clusters Kubernetes e apresentamos um sistema de classifica√ß√£o que define os requisitos para a delimita√ß√£o de aplicativos em cont√™iner.  Se compararmos essa abordagem com as outras solu√ß√µes consideradas, ela apresenta vantagens em termos de garantir o isolamento do sistema. <br><br>  Uma conclus√£o importante √© que a estrat√©gia de isolamento <i>restringe a propaga√ß√£o de</i> ataques <i>de</i> escape para o cont√™iner.  <b>Em outras palavras, deixar o cont√™iner por si s√≥ n√£o √© impedido, mas seus efeitos s√£o mitigados.</b>  Obviamente, junto com isso, surgem dificuldades adicionais que devem ser levadas em considera√ß√£o ao fazer compara√ß√µes semelhantes. <br><br>  Para usar o m√©todo especificado em um ambiente de nuvem e fornecer escalabilidade, requisitos adicionais ser√£o impostos √† automa√ß√£o.  Por exemplo, para automatizar a cria√ß√£o de m√°quinas virtuais e seu uso no cluster Kubernetes.  O mais importante ser√° a implementa√ß√£o e verifica√ß√£o da <b>ampla</b> classifica√ß√£o de aplicativos. <br><br>  Isso faz parte da minha disserta√ß√£o sobre o <b>isolamento de um aplicativo em cont√™iner</b> . <br><br>  Para evitar a possibilidade de um invasor que saiu do cont√™iner em um n√≥ atacar os servi√ßos de outros n√≥s, √© necess√°rio considerar <i>ataques propagados pela rede</i> .  Para levar esses riscos em considera√ß√£o, minha disserta√ß√£o prop√µe a <b><i>segmenta√ß√£o da rede de cluster</i></b> e apresenta arquiteturas de nuvem, uma das quais com <b>firewall de hardware</b> . <br><br>  Quem desejar pode se familiarizar com o documento completo - o texto da disserta√ß√£o √© de acesso p√∫blico: ‚Äú <a href="">Orquestra√ß√£o de cont√™ineres em ambientes exigentes de seguran√ßa na Autoridade Policial Sueca</a> ‚Äù. <br><br><h2>  PS do tradutor </h2><br>  Leia tamb√©m em nosso blog: <br><br><ul><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vulnerabilidade CVE-2019-5736 em runc, permitindo obter privil√©gios de root no host</a> "; </li><li>  ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">9 melhores pr√°ticas de seguran√ßa na Kubernetes</a> ‚Äù; </li><li>  ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">11 maneiras de (n√£o) se tornar uma v√≠tima do Kubernetes Hacking</a> ‚Äù; </li><li>  ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Entendendo o RBAC no Kubernetes</a> ‚Äù; </li><li>  ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OPA e SPIFFE - Dois novos projetos no CNCF para seguran√ßa de aplicativos em nuvem</a> ‚Äù; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vulnerable Docker VM - um jogo virtual de Docker e pentesting</a> ." </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt440504/">https://habr.com/ru/post/pt440504/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt440490/index.html">Biomodule 1-2</a></li>
<li><a href="../pt440492/index.html">Cor√©ia do Sul abandonar√° carros el√©tricos e constru√ß√£o de novas usinas nucleares</a></li>
<li><a href="../pt440498/index.html">Pol√≠cia de Moscou receber√° pontos com reconhecimento facial</a></li>
<li><a href="../pt440500/index.html">Primeiro</a></li>
<li><a href="../pt440502/index.html">Como iniciar seu podcast, um guia para iniciantes</a></li>
<li><a href="../pt440506/index.html">A sonda lunar orbital da NASA captou novas imagens da esta√ß√£o chinesa Chang'e-4 - mais perto e mais clara</a></li>
<li><a href="../pt440508/index.html">Como perder seu hobby e torn√°-lo um neg√≥cio on-line de sucesso nos EUA</a></li>
<li><a href="../pt440510/index.html">Quem desenvolve switches de 400GbE para data centers</a></li>
<li><a href="../pt440512/index.html">Fatoriais divis√≠veis</a></li>
<li><a href="../pt440514/index.html">Quem povoar√° a terra dos ciborgues? O status de desenvolvimento da empresa Motorika falou sobre o status futuro da Ilha Russky</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>