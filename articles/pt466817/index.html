<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìê üî´ üë©‚Äç‚ù§Ô∏è‚Äçüë© Varonis descobriu um v√≠rus de minera√ß√£o de criptografia: nossa investiga√ß√£o üññüèæ üíç ‚õìÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nossa unidade de investiga√ß√£o de seguran√ßa recentemente conduziu um caso de uma rede de v√≠rus de minera√ß√£o de criptografia quase completamente em uma ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Varonis descobriu um v√≠rus de minera√ß√£o de criptografia: nossa investiga√ß√£o</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/466817/"><img src="https://habrastorage.org/webt/b3/fo/_5/b3fo_5ib64rlap_izdap4paolls.jpeg"><br><br>  Nossa unidade de investiga√ß√£o de seguran√ßa recentemente conduziu um caso de uma rede de v√≠rus de minera√ß√£o de criptografia quase completamente em uma das empresas de m√©dio porte.  An√°lise <br>  amostras de malware coletadas mostraram que uma nova modifica√ß√£o foi encontrada <br>  tais v√≠rus, chamados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Norman</a> , usando v√°rios m√©todos para ocultar sua presen√ßa.  Al√©m disso, foi descoberto um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">shell interativo da web</a> , que pode estar relacionado aos operadores de minera√ß√£o. <br><a name="habracut"></a><br><h2>  <font color="#D21927">Vis√£o geral do estudo</font> </h2><br><ul><li>  Varonis detectou uma infec√ß√£o em larga escala com cryptominers: quase todos os servidores e esta√ß√µes de trabalho da empresa foram infectados com esse software </li><li>  Desde a infec√ß√£o inicial que ocorreu h√° mais de um ano, o n√∫mero de modifica√ß√µes e dispositivos infectados aumentou constantemente </li><li>  O novo tipo de minerador de criptografia Monero (Norman) que descobrimos usa v√°rios m√©todos para ocult√°-lo da an√°lise por software de seguran√ßa, a fim de evitar a detec√ß√£o </li><li>  A maioria das variantes de malware usava o DuckDNS (servi√ßo DNS din√¢mico gratuito) para conectar-se ao centro de controle (servidores C&amp;C), al√©m de obter par√¢metros de configura√ß√£o ou enviar novos dados </li><li>  Norman - minerador de criptomoeda Monero de c√≥digo-fonte aberto de alto desempenho - XMRig </li><li>  N√£o temos evid√™ncias conclusivas da conex√£o de mineradores de criptografia com um shell PHP interativo.  No entanto, existem boas raz√µes para acreditar que sua origem √© o mesmo invasor.  Os pesquisadores coletam evid√™ncias adicionais para a presen√ßa ou aus√™ncia de tal relacionamento. </li><li>  Neste artigo, voc√™ pode encontrar recomenda√ß√µes da Varonis sobre prote√ß√£o contra shells remotos da Web e mineradores de criptografia. </li></ul><br><h2>  <font color="#D21927">Investiga√ß√£o</font> </h2><br>  A investiga√ß√£o come√ßou durante o pr√≥ximo projeto piloto da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Plataforma</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A ciberseguran√ßa da Varonis</a> (Varonis Data Security Platform), que permitiu identificar rapidamente v√°rios eventos an√¥malos suspeitos no n√≠vel da rede durante solicita√ß√µes da Internet (por meio de proxies da web) associados a a√ß√µes anormais no sistema de arquivos. <br>  O Cliente indicou imediatamente que os dispositivos identificados por nossa Plataforma, <br>  pertencia aos mesmos usu√°rios que relataram recentemente falhas de aplicativos e lentid√£o na rede. <br><br>  Nossa equipe examinou manualmente o ambiente do cliente, passando de uma esta√ß√£o infectada para outra, de acordo com os alertas gerados pela Plataforma Varonis.  A equipe de resposta a incidentes tamb√©m desenvolveu uma regra especial no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">m√≥dulo DatAlert</a> para detectar computadores que estavam minerando ativamente, o que ajudou a eliminar rapidamente a amea√ßa.  Amostras do malware coletado foram enviadas para as equipes dos departamentos forenses e de desenvolvimento, que disseram que era necess√°rio realizar pesquisas adicionais sobre as amostras. <br>  Os sites infectados foram descobertos atrav√©s do uso de <b>chamadas DuckDNS</b> , DNS din√¢mico, que permitem que seus usu√°rios criem seus pr√≥prios nomes de dom√≠nio e os <b>mapeiem</b> rapidamente para alterar os endere√ßos IP.  Como mencionado acima, a maior parte do malware no incidente foi para o DuckDNS para se conectar ao centro de controle (C&amp;C), o outro para obter par√¢metros de configura√ß√£o ou enviar novos dados. <br><br>  Quase todos os servidores e computadores foram infectados com malware.  Aplicado principalmente <br>  op√ß√µes comuns de minerador de criptografia.  Outros malwares inclu√≠am ferramentas de despejo de senhas, shells PHP e v√°rias ferramentas estavam em funcionamento h√° v√°rios anos. <br><br>  Fornecemos os resultados ao cliente, removemos o malware do ambiente e paramos mais infec√ß√µes. <br><br>  Entre todas as amostras descobertas de cripto-dominadores, uma se destacou.  N√≥s o chamamos de <strong>Norman</strong> . <br><br><h2>  <font color="#D21927">Me encontre!</font>  <font color="#D21927">Norman</font>  <font color="#D21927">Cryptominer</font> </h2><br>  Norman √© um minerador de criptomoeda Monero de alto desempenho baseado no c√≥digo XMRig.  Ao contr√°rio de outras amostras de mineradores encontradas, Norman usa m√©todos para ocult√°-lo da an√°lise com software de seguran√ßa para evitar a detec√ß√£o e impedir uma distribui√ß√£o posterior. <br><br>  √Ä primeira vista, esse malware √© um mineiro comum escondido sob o nome svchost.exe.  No entanto, o estudo mostrou que ele usa m√©todos mais interessantes de se esconder da detec√ß√£o e manuten√ß√£o do trabalho. <br><br>  O processo de implanta√ß√£o deste malware pode ser dividido em tr√™s est√°gios: <br><br><ul><li>  realiza√ß√£o; </li><li>  implementa√ß√£o; </li><li>  minera√ß√£o. </li></ul><br><h2>  <font color="#D21927">An√°lise passo a passo</font> </h2><br><h3>  Etapa 1. Execu√ß√£o </h3><br>  A primeira etapa come√ßa com o arquivo execut√°vel svchost.exe. <br><br>  O software malicioso √© compilado com o NSIS (Nullsoft Scriptable Install System), o que √© incomum.  O NSIS √© um sistema de c√≥digo aberto usado para criar instaladores do Windows.  Como o SFX, esse sistema cria um arquivo morto e um arquivo de script que s√£o executados durante o instalador.  O arquivo de script informa ao programa quais arquivos executar e pode interagir com outros arquivos no arquivo morto. <br><br>  <i><strong>Nota:</strong> Para obter o arquivo de script NSIS do arquivo execut√°vel, voc√™ deve usar o 7zip vers√£o 9.38, pois essa fun√ß√£o n√£o √© implementada nas vers√µes posteriores.</i> <br><br>  O malware arquivado pelo NSIS cont√©m os seguintes arquivos: <br><br><ul><li>  CallAnsiPlugin.dll, CLR.dll - m√≥dulos NSIS para chamar fun√ß√µes .NET DLL; </li><li>  5zmjbxUIOVQ58qPR.dll - a principal carga √∫til DLL; </li><li>  4jy4sobf.acz, es1qdxg2.5pk, OIM1iVhZ.txt - arquivos de carga √∫til; </li><li>  Retreat.mp3, Cropped_controller_config_controller_i_lb.png s√£o simplesmente arquivos que n√£o est√£o de forma alguma associados a atividade maliciosa adicional. </li></ul><br>  O comando do arquivo de script NSIS que executa a carga √∫til √© fornecido abaixo. <br><br><img src="https://habrastorage.org/webt/dc/ch/st/dcchst5kvffhufreb1smhmw3lzs.png"><br><br>  O software malicioso √© executado chamando a fun√ß√£o 5zmjbxUIOVQ58qPR.dll, que usa outros arquivos como par√¢metros. <br><br><h3>  Etapa 2. Implementa√ß√£o </h3><br>  O arquivo 5zmjbxUIOVQ58qPR.dll √© a carga √∫til principal, que segue o script NSIS acima.  Uma an√°lise r√°pida dos metadados mostrou que a DLL era originalmente chamada Norman.dll, e foi por isso que a chamamos. <br><br>  Arquivo DLL desenvolvido no .NET e protegido contra engenharia reversa por ofusca√ß√£o tripla <br>  usando o conhecido produto comercial Agile .NET Obfuscator. <br><br>  No curso da implementa√ß√£o, muitas opera√ß√µes de introdu√ß√£o da auto-introdu√ß√£o em seu pr√≥prio processo, bem como em outros processos, est√£o envolvidas.  Dependendo da profundidade de bits do sistema operacional, o malware ser√° <br>  escolha caminhos diferentes para pastas do sistema e inicie processos diferentes. <br><br><img src="https://habrastorage.org/webt/jp/sy/zn/jpsyzngdt-zv5qoswztui4odjrs.png"><br><br>  Com base no caminho para a pasta do sistema, o malware selecionar√° diferentes processos para iniciar. <br><br><img src="https://habrastorage.org/webt/wp/q9/jc/wpq9jcqxrvwvbfkgh9-wca2qmsi.png"><br><br>  A carga √∫til implementada possui duas fun√ß√µes principais: executar um minerador de criptografia e impedir a detec√ß√£o. <br><br><h4>  Se o sistema operacional for de 64 bits </h4><br>  Ao executar o arquivo de origem svchosts.exe (arquivo NSIS), ele cria um novo processo pr√≥prio e injeta a carga √∫til nele (1).  Logo depois, ele lan√ßa o notepad.exe ou o explorer.exe e injeta um cryptominer nele (2). <br><br><img src="https://habrastorage.org/webt/3n/rc/bt/3nrcbtfzkotbmjp_zqdvrzt9r_0.jpeg"><br><br>  Depois disso, o arquivo svchost.exe original √© encerrado e o novo arquivo svchost.exe √© usado como um programa que monitora a opera√ß√£o do processo do minerador. <br><br><img src="https://habrastorage.org/webt/ng/ze/bq/ngzebqxper1bhxzwrqxvygimlac.png"><br><br><h4>  Se o sistema operacional for de 32 bits </h4><br>  Durante a execu√ß√£o do arquivo svchosts.exe original (arquivo NSIS), ele duplica seu pr√≥prio processo e injeta uma carga √∫til nele, como na vers√£o de 64 bits. <br><br>  Nesse caso, o malware injeta a carga √∫til no processo do usu√°rio explorer.exe.  J√° a partir dele, o c√≥digo malicioso inicia um novo processo (wuapp.exe ou vchost.exe) e injeta o minerador nele. <br><br><img src="https://habrastorage.org/webt/kb/c3/2q/kbc32qdqrmcwqzciy5vhesry224.png"><br><br>  O software malicioso oculta o fato da implementa√ß√£o no explorer.exe, substituindo o c√≥digo implementado anteriormente por meio do wuapp.exe e dos valores vazios. <br><br><img src="https://habrastorage.org/webt/dz/uz/ct/dzuzct_donm4jroc54uj4bqzy2i.png"><br><br>  Como no caso da execu√ß√£o em um ambiente de 64 bits, o processo svchost.exe original √© encerrado e o segundo √© usado para injetar novamente o c√≥digo malicioso no explorer.exe se o processo for encerrado pelo usu√°rio. <br><br>  No final do algoritmo de execu√ß√£o, o malware sempre injeta o cryptominer em seu processo leg√≠timo. <br><br>  Ele foi projetado para impedir a detec√ß√£o desligando o mineiro quando o usu√°rio inicia o Gerenciador de Tarefas. <br><br>  Observe que, ap√≥s iniciar o Gerenciador de tarefas, o processo wuapp.exe termina. <br><br><img src="https://habrastorage.org/webt/nm/dw/y0/nmdwy02bz2qho6dgotsq_wprv6a.gif"><br><br>  Ap√≥s fechar o gerenciador de tarefas, o malware inicia o processo wuapp.exe repetidamente <br>  introduz um mineiro nele. <br><br><h3>  Etapa 3. Mineiro </h3><br>  Considere o minerador XMRig mencionado acima. <br><br>  O software malicioso injeta a vers√£o UPX disfar√ßada do minerador no bloco de notas, exe, explorer.exe, <br>  svchost.exe ou wuapp.exe, dependendo da profundidade de bits do sistema operacional e do est√°gio do algoritmo de execu√ß√£o. <br><br>  O cabe√ßalho do PE no minerador foi removido e, na captura de tela abaixo, podemos ver que ele est√° mascarado usando UPX. <br><br><img src="https://habrastorage.org/webt/u0/es/8g/u0es8g-pm5lpx7bov_hwarxv-ws.png"><br><br>  Ap√≥s criar um despejo e reconstruir o execut√°vel, conseguimos execut√°-lo: <br><br><img src="https://habrastorage.org/webt/il/nl/c-/ilnlc-lauzxcgsjrkg0pggo1wik.png"><br><br>  Deve-se notar que o acesso ao site XMR de destino √© proibido, o que neutraliza efetivamente esse mineiro. <br><br>  <strong>Configura√ß√£o do mineiro:</strong> <br><br><pre><code class="plaintext hljs">"url": "pool.minexmr.com:5555","user": "49WvfokdnuK6ojQePe6x2M3UCD59v3BQiBszkuTGE7wmNJuyAvHM9ojedgxMwNx9tZA33P84EeMLte7t6qZhxNHqHyfq9xA","pass":"x"</code> </pre> <br><h2>  <font color="#D21927">Misteriosa shell PHP transferindo dados para a C&amp;C</font> </h2><br>  No decorrer desta investiga√ß√£o, nossos especialistas forenses descobriram um arquivo XSL que chamou sua aten√ß√£o.  Ap√≥s an√°lise profunda da amostra, um novo shell PHP foi descoberto, constantemente conectado ao centro de controle (servidor C&amp;C). <br><br>  Em v√°rios servidores no ambiente do cliente, foi encontrado um arquivo XSL iniciado pelo conhecido execut√°vel Windows (mscorsv.exe) a partir de uma pasta no diret√≥rio sysWOW64. <br><br>  A pasta do malware foi chamada de AutoRecupera√ß√£o e continha <b>v√°rios arquivos:</b> <br><br><ul><li>  Arquivo XSL: xml.XSL </li><li>  nove arquivos dll </li></ul><br>  <b>Arquivos execut√°veis:</b> <br><ul><li>  Msscorsv.exe </li><li>  Wmiprvse.exe </li></ul><br><img src="https://habrastorage.org/webt/dr/bc/nv/drbcnvij4atirz8jn_tncb6ndkc.png"><br><br><h2>  <font color="#D21927">Arquivo XSL</font> </h2><br>  Arquivos XSL s√£o folhas de estilo semelhantes √†s tabelas usadas em CSS que descrevem como exibir um documento XML. <br><br>  Usando o bloco de notas, descobrimos que na verdade n√£o era um arquivo XSL, mas o c√≥digo PHP oculto do Zend Guard.  Este fato curioso sugeriu que este <br>  carga √∫til de malware com base em seu algoritmo de execu√ß√£o. <br><br><img src="https://habrastorage.org/webt/b9/gx/z5/b9gxz56io5zcmlgbtephvyuxyn8.png"><br><br><h2>  <font color="#D21927">Nove DLLs</font> </h2><br>  Uma an√°lise inicial do arquivo XSL nos levou a concluir que ter tantos <br>  DLLs fazem algum sentido.  A pasta principal cont√©m uma DLL chamada php.dll e tr√™s outras bibliotecas relacionadas ao SSL e MySQL.  Nas subpastas, os especialistas encontraram quatro bibliotecas PHP e uma biblioteca Zend Guard.  Todos eles s√£o leg√≠timos e s√£o obtidos no pacote de instala√ß√£o do PHP ou como dlls externos. <br><br>  Nesta fase, assumiu-se que o malware era baseado em PHP e ofuscado pelo Zend Guard. <br><br><h2>  <font color="#D21927">Execut√°veis</font> </h2><br>  Tamb√©m nesta pasta estavam dois arquivos execut√°veis: Mscorsv.exe e Wmiprvse.exe. <br><br>  Ap√≥s analisar o arquivo mscorsv.exe, descobrimos que ele n√£o foi assinado pela Microsoft, embora o par√¢metro ProductName tenha sido definido como ‚ÄúMicrosoft.  Estrutura de rede ". <br>  No come√ßo, parecia estranho, mas a an√°lise do Wmiprvse.exe tornou poss√≠vel entender melhor a situa√ß√£o. <br><br>  O arquivo Wmiprvse.exe tamb√©m n√£o foi assinado, mas continha o s√≠mbolo de direitos autorais do grupo PHP e o √≠cone PHP.  Durante uma varredura superficial, os comandos da ajuda do PHP foram encontrados em suas linhas.  Ao execut√°-lo com a op√ß√£o -version, descobriu-se que este √© um arquivo execut√°vel projetado para executar o Zend Guard. <br><br><img src="https://habrastorage.org/webt/9c/xw/ju/9cxwjuu7xoqggrzco-tgun7kpsw.png"><br><br>  Quando o mscorsv.exe foi iniciado da mesma maneira, os mesmos dados foram exibidos.  Comparamos os dados bin√°rios desses dois arquivos e vimos que eles s√£o id√™nticos, com exce√ß√£o dos metadados <br>  Copyright e nome da empresa / nome do produto. <br><br><img src="https://habrastorage.org/webt/mp/7y/qk/mp7yqkfz6uqusknzixm5vrwun9e.png"><br><br>  Com base nisso, concluiu-se que o arquivo XSL cont√©m c√≥digo PHP que √© executado usando o execut√°vel Zend Guard, oculto sob o nome mscorsv.exe. <br><br><h2>  <font color="#D21927">Analisando um arquivo XSL</font> </h2><br>  Usando a pesquisa na Internet, os especialistas rapidamente receberam uma ferramenta para desobstruir o Zend Guard e restauraram o arquivo xml.XSL original: <br><br><img src="https://habrastorage.org/webt/5a/ek/nj/5aeknjt7mwgxx96m3t5twger2h0.png"><br><br>  Verificou-se que o malware em si √© um shell PHP constantemente conectado ao centro de controle (servidor C&amp;C). <br><br>  Os comandos e a sa√≠da que ele envia e recebe s√£o criptografados.  Como recebemos o c√≥digo-fonte, t√≠nhamos uma chave de criptografia e comandos. <br><br>  Este malware cont√©m a seguinte funcionalidade interna: <br><br><ul><li>  Eval - normalmente usado para modificar vari√°veis ‚Äã‚Äãexistentes no c√≥digo </li><li>  Registro de arquivo local </li><li>  Recursos de banco de dados </li><li>  Recursos PSEXEC </li><li>  Execu√ß√£o oculta </li><li>  Mapeamento de Processo e Servi√ßo </li></ul><br>  A vari√°vel a seguir sugere que o malware possui v√°rias vers√µes. <br><br><img src="https://habrastorage.org/webt/al/id/bs/alidbstswyy1huff1onuh5ma7bg.png"><br><br>  Ao coletar amostras, as seguintes vers√µes foram descobertas: <br><br><ul><li>  0.5f </li><li>  0.4p </li><li>  0.4o </li></ul><br>  A √∫nica fun√ß√£o de garantir a presen√ßa constante de malware no sistema √© que, quando executado, ele cria um servi√ßo que se executa, e seu nome <br>  varia de vers√£o para vers√£o. <br><br>  Os especialistas tentaram encontrar amostras semelhantes na Internet e encontraram malware, <br>  que, na opini√£o deles, era a vers√£o anterior da amostra existente.  O conte√∫do da pasta era semelhante, mas o arquivo XSL era diferente e um n√∫mero de vers√£o diferente foi especificado nele. <br><br><h2>  <font color="#D21927">Parle Wu Malvare?</font> </h2><br>  Talvez o local de nascimento desse malware seja a Fran√ßa ou outro pa√≠s de l√≠ngua francesa: o arquivo SFX continha coment√°rios em franc√™s que indicam que o autor usou a vers√£o francesa do WinRAR para cri√°-lo. <br><br><img src="https://habrastorage.org/webt/xq/e2/cd/xqe2cddtfruhzwvz3mro0iqglpm.png"><br><br>  Al√©m disso, algumas vari√°veis ‚Äã‚Äãe fun√ß√µes no c√≥digo tamb√©m foram nomeadas em franc√™s. <br><br><img src="https://habrastorage.org/webt/vx/95/9d/vx959dqslson6ybxzoawqzzyvog.png"><br><br><img src="https://habrastorage.org/webt/sk/cv/rd/skcvrd_tj6ntrgghhjzl1fhpjy8.png"><br><br><h2>  <font color="#D21927">Monitorando a execu√ß√£o e aguardando novas equipes</font> </h2><br>  Os especialistas modificaram o c√≥digo do malware e lan√ßaram com seguran√ßa o j√° modificado <br>  vers√£o para coletar informa√ß√µes sobre as equipes que recebeu. <br><br><img src="https://habrastorage.org/webt/xv/tf/uf/xvtfufticasuciea8sfzqyrpppc.png"><br><br>  No final da primeira sess√£o de comunica√ß√£o, os especialistas viram que o malware recebeu um comando codificado com Base64 como argumento para a chave de inicializa√ß√£o EVAL64. <br>  Este comando √© decodificado e executado.  Ele altera v√°rias vari√°veis ‚Äã‚Äãinternas (o tamanho dos buffers de leitura e grava√ß√£o), ap√≥s o qual o malware entra no ciclo de trabalho de espera por comandos. <br><br>  Nenhuma nova equipe foi recebida no momento. <br><br><h2>  <font color="#D21927">Shell interativo PHP e minerador de criptografia: eles est√£o relacionados?</font> </h2><br>  Os especialistas da Varonis n√£o t√™m certeza se Norman est√° associado ao shell do PHP, pois h√° argumentos significativos a favor e contra essa suposi√ß√£o: <br><br><h3>  Por que eles podem estar relacionados </h3><br><ul><li>  Nenhuma das amostras de software malicioso de minera√ß√£o de criptografia teve a capacidade de distribuir independentemente para outros sistemas, apesar de terem sido encontradas em v√°rios dispositivos em diferentes segmentos de rede.  √â poss√≠vel que o invasor tenha infectado cada n√≥ separadamente (possivelmente usando o mesmo vetor de ataque que infectou o "paciente zero"), embora seja mais eficiente usar um shell PHP para se espalhar pela rede que foi o alvo do ataque. </li><li>  Campanhas automatizadas direcionadas em larga escala direcionadas a uma organiza√ß√£o espec√≠fica geralmente deixam artefatos t√©cnicos ou tra√ßos reconhec√≠veis de amea√ßas √† seguran√ßa cibern√©tica em sua implementa√ß√£o.  Nesse caso, nada desse tipo foi encontrado. </li><li>  Norman e o shell PHP usaram o servi√ßo DuckDNS. </li></ul><br><h3>  Por que eles podem n√£o estar relacionados </h3><br><ul><li>  N√£o h√° semelhan√ßas t√©cnicas entre as op√ß√µes de malware de minera√ß√£o de criptografia e o shell PHP.  O cryptominer malicioso foi criado em C ++ e o shell em PHP.  Al√©m disso, n√£o h√° semelhan√ßas na estrutura do c√≥digo e as fun√ß√µes de rede s√£o implementadas de maneira diferente. </li><li>  N√£o h√° intera√ß√£o direta entre as op√ß√µes de malware e o shell PHP para troca de dados. </li><li>  Eles n√£o t√™m coment√°rios gerais do desenvolvedor, arquivos, metadados ou impress√µes digitais. </li></ul><br><h3>  Tr√™s recomenda√ß√µes para prote√ß√£o contra cascas removidas </h3><br>  O software malicioso, que requer comandos do centro de controle (servidores C&amp;C), n√£o se parece com v√≠rus comuns.  Suas a√ß√µes n√£o s√£o t√£o previs√≠veis e se assemelham √†s a√ß√µes de um hacker ou pentester realizado sem ferramentas ou scripts automatizados.  Portanto, detectar esses ataques sem assinaturas de malware √© uma tarefa mais complexa do que as verifica√ß√µes antiv√≠rus convencionais. <br><br>  <strong>Abaixo est√£o tr√™s recomenda√ß√µes para proteger as empresas contra shells remotos:</strong> <br><ol><li>  <b>Mantenha todos os softwares atualizados</b> <br>  Os invasores costumam explorar vulnerabilidades em software e sistemas operacionais para se espalhar pela rede da organiza√ß√£o e procurar dados de interesse para <br>  roubo.  A instala√ß√£o oportuna de patches reduz significativamente o risco de tais amea√ßas. </li><li>  <b>Rastrear eventos anormais de acesso a dados</b> <br>  Provavelmente, os atacantes tentar√£o exibir os dados confidenciais da organiza√ß√£o em todo o per√≠metro.  O monitoramento de eventos anormais de acesso a esses dados permitir√° <br>  detectar usu√°rios comprometidos e todo o conjunto de pastas e arquivos que realmente podem cair nas m√£os dos atacantes, e n√£o considerar apenas todos os dados dispon√≠veis para esses usu√°rios. </li><li>  <b>Rastrear tr√°fego de rede</b> <br>  Gra√ßas ao uso de um firewall e / ou servidor proxy, √© poss√≠vel detectar e bloquear conex√µes maliciosas com centros de controle de malware (servidores C&amp;C), o que impedir√° que os invasores executem comandos e dificulta a tarefa de sa√≠da <br>  dados de per√≠metro. </li></ol><br>  <strong>Preocupado com a quest√£o da minera√ß√£o cinza?</strong>  <strong>Seis recomenda√ß√µes de prote√ß√£o:</strong> <br><br><ol><li>  <b>Mantenha todos os sistemas operacionais atualizados.</b> <br>  O gerenciamento de patches √© muito importante para evitar o uso indevido de recursos e a infec√ß√£o por malware. </li><li>  <b>Monitorar o tr√°fego de rede e proxies da Web</b> <br>  Fa√ßa isso para detectar alguns ataques e para impedir parte deles, voc√™ pode bloquear o tr√°fego com base em informa√ß√µes sobre dom√≠nios maliciosos ou limitar canais de transmiss√£o de dados desnecess√°rios. </li><li>  <b>Use e mantenha solu√ß√µes antiv√≠rus e sistemas de seguran√ßa de terminais</b> (mas em nenhum caso se limite a usar apenas essa camada de prote√ß√£o). <br>  Os produtos nos dispositivos finais permitem a detec√ß√£o de criptominadores conhecidos e a preven√ß√£o de infec√ß√µes antes que o desempenho dos sistemas e o uso de eletricidade sejam comprometidos.  Deve-se ter em mente que novas modifica√ß√µes ou novos m√©todos para impedir a detec√ß√£o podem fazer com que os recursos de seguran√ßa nos dispositivos finais n√£o detectem novas vers√µes do mesmo malware. </li><li>  <b>Monitorar a atividade da CPU do computador</b> <br>  Como regra, os mineradores de criptografia usam o processador central do computador para minera√ß√£o.  √â necess√°rio analisar todas as mensagens sobre a degrada√ß√£o do desempenho ("Meu computador come√ßou a ficar lento".). </li><li>  <b>Monitore o DNS para uso incomum de servi√ßos de DNS din√¢mico (como DuckDNS)</b> \ <br><br>  Apesar do fato de o DuckDNS e outros servi√ßos de DNS din√¢mico n√£o serem prejudiciais ao sistema, o uso do malware DuckDNS simplificou a detec√ß√£o de n√≥s infectados pelas equipes de especialistas envolvidas na investiga√ß√£o. </li><li>  <b>Desenvolver um plano de resposta a incidentes</b> <br>  Verifique se voc√™ possui os procedimentos necess√°rios descritos para esses incidentes que detectam, limitam e eliminam automaticamente a amea√ßa da minera√ß√£o de criptografia cinza. </li></ol><br>  <strong>Nota para os clientes da Varonis.</strong> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Varonis DatAlert</a> inclui modelos de amea√ßas que detectam malware para minera√ß√£o de criptografia.  Os clientes tamb√©m podem criar suas pr√≥prias regras para a descoberta direcionada de software com base em dom√≠nios candidatos √† lista negra.  Para garantir que voc√™ esteja usando a vers√£o mais recente do DatAlert e aplicando os modelos de amea√ßas apropriados, entre em contato com seu representante de vendas ou o suporte da Varonis. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt466817/">https://habr.com/ru/post/pt466817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt466807/index.html">Python, devorando o mundo: como um projeto paralelo de um desenvolvedor, tornou-se uma linguagem de programa√ß√£o popular</a></li>
<li><a href="../pt466809/index.html">O c√≠rculo est√° fechado. Como as mitaps me ajudaram a encontrar um emprego dos sonhos</a></li>
<li><a href="../pt466811/index.html">Hist√≥rico e alternativas √† plataforma .NET</a></li>
<li><a href="../pt466813/index.html">Posit-aritm√©tica: derrotar um ponto flutuante em seu pr√≥prio campo. Parte 2</a></li>
<li><a href="../pt466815/index.html">Vis√£o geral t√©cnica do NEC HYDRAstor HS8 e mais</a></li>
<li><a href="../pt466819/index.html">Implementa√ß√£o de ofertas promocionais no iOS. Como ganhar mais em assinaturas?</a></li>
<li><a href="../pt466821/index.html">Instale o 3CX no Amazon AWS Marketplace</a></li>
<li><a href="../pt466823/index.html">Como configuramos migra√ß√µes para processos de neg√≥cios no Bitrix24</a></li>
<li><a href="../pt466829/index.html">Alguns retoques no trabalho com bigint ids em R</a></li>
<li><a href="../pt466831/index.html">Desenvolvendo um sistema operacional monol√≠tico semelhante a Unix - Heap (4)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>