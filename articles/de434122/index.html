<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∑üèø üìù üñ®Ô∏è Drehbuch - Kein Seitenobjekt ü§ûüèº üõ£Ô∏è üêΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mit der Zeit wird es schwieriger, √Ñnderungen an einem Produkt vorzunehmen, und es besteht ein wachsendes Risiko, nicht nur neue Funktionen freizugeben...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Drehbuch - Kein Seitenobjekt</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/arcadia/blog/434122/"><p>  Mit der Zeit wird es schwieriger, √Ñnderungen an einem Produkt vorzunehmen, und es besteht ein wachsendes Risiko, nicht nur neue Funktionen freizugeben, sondern auch alte zu besch√§digen.  Anstatt das gesamte Projekt manuell zu √ºberpr√ºfen, versuchen sie h√§ufig, diesen Prozess zu automatisieren.  Wenn Sie mit Personen sprechen, die Schnittstellen testen und auf Konferenzen herumlaufen, wird deutlich, dass in der Welt des Webtests Selenium-Regeln und die √ºberwiegende Mehrheit Page Object als Organisation von Code verwenden. </p><br><p>  Aber f√ºr mich als Programmierer hat mir dieses Muster und der Code, den ich mit verschiedenen Teams gesehen habe, aus irgendeinem Grund nie gefallen - die Buchstaben SOLID klangen in meinem Kopf.  Aber ich war bereit, mich damit abzufinden, dass Tester Code nach Belieben schreiben, da es wie vor etwa einem Jahr bei Angular Connect keine Alternativen gab. Ich h√∂rte einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bericht</a> √ºber das Testen von Angular-Anwendungen anhand des Drehbuchmusters.  Jetzt m√∂chte ich teilen. </p><br><p><img src="https://habrastorage.org/webt/or/lk/kp/orlkkp4zbclrby1wg1sudwl64cm.jpeg"></p><a name="habracut"></a><br><h1 id="podopytnyy-krolik">  Experimentelles Kaninchen </h1><br><p>  Zun√§chst eine kurze Beschreibung der verwendeten Werkzeuge.  Als Beispiel f√ºr die Implementierung nehme ich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SerenityJS</a> aus dem Originalbericht mit TypeScript als Sprache f√ºr Testskripte. </p><br><p> Wir werden Experimente √ºber die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">TODO-Anwendung durchf√ºhren</a> - eine Anwendung zum Erstellen einer einfachen Liste von Aufgaben.  Als Beispiele verwenden wir den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Code</a> von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Jan Molak</a> , dem Ersteller der Bibliothek (TypeScript-Code, daher ging das Highlight ein wenig). </p><br><h1 id="nachnyom-v-2009-m-godu">  Beginnen wir 2009 </h1><br><p>  Zu diesem Zeitpunkt erschien Selenium WebDriver und die Leute begannen, es zu benutzen.  Leider ist es in vielen F√§llen aufgrund der Neuheit der Technologie und der mangelnden Programmiererfahrung falsch.  Die Tests erwiesen sich als vollst√§ndig kopiert, nicht unterst√ºtzt und "zerbrechlich". </p><br><p>  Das Ergebnis ist ein negatives Feedback und ein schlechter Ruf bei Autotests.  Am Ende antwortete Simon Stewart, Sch√∂pfer von Selenium WebDriver, in Abwesenheit in seinem Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Meine Selentests sind nicht stabil!</a>  .  Die allgemeine Botschaft: "Wenn Ihre Tests zerbrechlich sind und nicht gut funktionieren, liegt dies nicht an Selen, sondern daran, dass die Tests selbst nicht sehr gut geschrieben sind." </p><br><p>  Um zu verstehen, worum es geht, schauen wir uns das folgende Benutzerszenario an: </p><br><pre><code class="plaintext hljs">Feature: Add new items to the todo list In order to avoid having to remember things that need doing As a forgetful person I want to be able to record what I need to do in a place where I won't forget about them Scenario: Adding an item to a list with other items Given that James has a todo list containing Buy some cookies, Walk the dog When he adds Buy some cereal to his list Then his todo list should contain Buy some cookies, Walk the dog, Buy some cereal</code> </pre> <br><p>  Die naive Implementierung "auf der Stirn" sieht folgenderma√üen aus: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { browser, by, element, protractor } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">todoUserSteps</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Given(<span class="hljs-regexp"><span class="hljs-regexp">/^.*that (.*) has a todo list containing (.*)$/</span></span>, (name: string, <span class="hljs-attr"><span class="hljs-attr">items</span></span>: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { browser.get(<span class="hljs-string"><span class="hljs-string">'http://todomvc.com/examples/angularjs/'</span></span>); browser.driver.manage().window().maximize(); listOf(items).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> { element(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)).sendKeys(item, protractor.Key.ENTER); }); browser.driver.controlFlow().execute(callback); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.When(<span class="hljs-regexp"><span class="hljs-regexp">/^s?he adds (.*?) to (?:his|her) list$/</span></span>, (itemName: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { element(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)) .sendKeys(itemName, protractor.Key.ENTER) .then(callback); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Then(<span class="hljs-regexp"><span class="hljs-regexp">/^.* todo list should contain (.*?)$/</span></span>, (items: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { expect(element.all(by.repeater(<span class="hljs-string"><span class="hljs-string">'todo in todos'</span></span>)).getText()) .to.eventually.eql(listOf(items)) .and.notify(callback); }); };</code> </pre> <br><p>  Wie Sie sehen k√∂nnen, wird hier eine API auf niedriger Ebene verwendet, Manipulationen mit dem DOM, Kopieren und Einf√ºgen von CSS-Selektoren.  Es ist klar, dass Sie in Zukunft auch bei einer kleinen √Ñnderung der Benutzeroberfl√§che den Code an vielen Stellen √§ndern m√ºssen. </p><br><p>  Als L√∂sung musste Selen etwas bieten, das gut genug war, um solche Probleme zu beseitigen, und gleichzeitig Menschen zug√§nglich war, die wenig oder keine Erfahrung in der objektorientierten Programmierung hatten.  Eine solche L√∂sung war Page Object, ein Muster zum Organisieren von Code. </p><br><p>  Martin Fowler <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">beschreibt</a> es als ein Abstraktionsobjekt um eine HTML-Seite oder deren Fragment, mit dem Sie mit den Seitenelementen interagieren k√∂nnen, ohne den HTML-Code selbst zu ber√ºhren.  Idealerweise sollte ein solches Objekt es dem Client-Code erm√∂glichen, alles zu tun und zu sehen, was eine Person tun und sehen kann. <br><img src="https://habrastorage.org/getpro/habr/post_images/89d/8a5/9b0/89d8a59b079f3dff71831e7f758d4e8e.png"></p><br><p>  Nachdem wir unser Beispiel gem√§√ü diesem Muster umgeschrieben haben, haben wir Folgendes: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { browser, by, element, protractor } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TodoList</span></span></span><span class="hljs-class"> </span></span>{ What_Needs_To_Be_Done = element(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)); Items = element.all(by.repeater(<span class="hljs-string"><span class="hljs-string">'todo in todos'</span></span>)); addATodoItemCalled(itemName: string): PromiseLike&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.What_Needs_To_Be_Done.sendKeys(itemName, protractor.Key.ENTER); } displayedItems(): PromiseLike&lt;string[]&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Items.getText(); } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">todoUserSteps</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> todoList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TodoList(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Given(<span class="hljs-regexp"><span class="hljs-regexp">/^.*that (.*) has a todo list containing (.*)$/</span></span>, (name: string, <span class="hljs-attr"><span class="hljs-attr">items</span></span>: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { browser.get(<span class="hljs-string"><span class="hljs-string">'http://todomvc.com/examples/angularjs/'</span></span>); browser.driver.manage().window().maximize(); listOf(items).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> { todoList.addATodoItemCalled(item); }); browser.driver.controlFlow().execute(callback); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.When(<span class="hljs-regexp"><span class="hljs-regexp">/^s?he adds (.*?) to (?:his|her) list$/</span></span>, (itemName: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { todoList.addATodoItemCalled(itemName).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> callback()); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Then(<span class="hljs-regexp"><span class="hljs-regexp">/^.* todo list should contain (.*?)$/</span></span>, (items: string, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>) =&gt; { expect(todoList.displayedItems()) .to.eventually.eql(listOf(items)) .and.notify(callback); }); };</code> </pre> <br><p>  Auf den ersten Blick sieht es gut aus - wir haben die Vervielf√§ltigung beseitigt und die Kapselung hinzugef√ºgt.  Es gibt jedoch ein Problem: Sehr oft wachsen solche Klassen im Entwicklungsprozess zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">enormen</a> Gr√∂√üen. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/895/cea/563/895cea563685efb4c86613c9ee17d9f9.jpg"></p><br><p>  Sie k√∂nnen versuchen, diesen Code in unabh√§ngige Komponenten zu zerlegen. Wenn der Code jedoch einen solchen Zustand erreicht, ist er bereits so eng miteinander verbunden, dass er sehr schwierig sein kann und sowohl die Klasse selbst als auch den gesamten Clientcode (Testf√§lle), der diesen Code verwendet, neu schreiben muss das Objekt.  Tats√§chlich ist eine gro√üe Klasse keine Krankheit, sondern ein Symptom ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Codegeruch</a> ).  Das Hauptproblem ist die Verletzung des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einzelverantwortungsprinzips</a> und des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Open Closed-Prinzips</a> .  Das Seitenobjekt impliziert eine Beschreibung der Seite und aller Arten der Interaktion mit ihr in einer Entit√§t, die nicht erweitert werden kann, ohne den Code zu √§ndern. </p><br><p>  F√ºr unsere TODO-Anwendungen zur Klassenverantwortung gelten folgende (Bilder aus dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> ): <br><img src="https://habrastorage.org/getpro/habr/post_images/e10/92b/0d6/e1092b0d68097724e550dd2f271cf7a3.jpg" alt="Verantwortung"></p><br><p>  Wenn Sie versuchen, diese Klasse basierend auf den Prinzipien von SOLID zu trennen, erhalten Sie ungef√§hr Folgendes: <br><img src="https://habrastorage.org/getpro/habr/post_images/a86/9e3/d57/a869e3d571152689f7c4fd543b214057.jpg"></p><br><h1 id="domennaya-model">  Dom√§nenmodell </h1><br><p>  Das n√§chste Problem, das wir mit Page Object haben, ist, dass es auf Seiten ausgef√ºhrt wird.  Bei Abnahmetests werden h√§ufig User Stories verwendet.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Behavior Driven Development (BDD)</a> und die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gherkin-</a> Sprache passen perfekt zu diesem Modell.  Es versteht sich, dass der Pfad des Benutzers zum Ziel (Szenario) wichtiger ist als die spezifische Implementierung.  Wenn Sie beispielsweise in allen Tests ein Anmelde-Widget verwendet haben, m√ºssen Sie beim √Ñndern der Anmeldemethode (das Formular wurde verschoben und auf Single Sign On umgestellt) <em>alle</em> Tests √§ndern.  In besonders dynamischen Projekten kann dies zeitaufw√§ndig und zeitaufw√§ndig sein und das Team dazu ermutigen, Schreibtests zu verschieben, bis sich die Seiten stabilisiert haben (auch wenn bei Anwendungsf√§llen alles klar ist). </p><br><p>  Um dieses Problem zu l√∂sen, lohnt es sich, es von der anderen Seite zu betrachten.  Wir f√ºhren folgende Konzepte ein: </p><br><ol><li>  Rollen - f√ºr wen ist das alles? </li><li>  Ziele - warum sind sie (Benutzer) hier und was wollen sie erreichen? </li><li>  Aufgaben - Was m√ºssen sie tun, um diese Ziele zu erreichen? </li><li>  Aktionen - Wie genau sollte ein Benutzer mit einer Seite interagieren, um eine Aufgabe abzuschlie√üen? </li></ol><br><p>  Somit wird jedes Testskript de facto zu einem <em>Skript</em> f√ºr den Benutzer, das auf die Ausf√ºhrung einer bestimmten User Story abzielt.  Wenn Sie diesen Ansatz mit den oben beschriebenen Prinzipien der objektorientierten Programmierung kombinieren, entsteht ein <em>Drehbuchmuster</em> (oder <em>User Journey-</em> Muster).  Seine Ideen und Prinzipien wurden erstmals 2007 vor PageObject ge√§u√üert. </p><br><h1 id="screenplay">  Drehbuch </h1><br><p>  Wir schreiben unseren Code unter Verwendung der resultierenden Prinzipien neu. </p><br><p>  James ist der Schauspieler, der unseren Benutzer in diesem Szenario spielen wird.  Er wei√ü, wie man einen Browser benutzt. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> james = Actor.named(<span class="hljs-string"><span class="hljs-string">'James'</span></span>).whoCan(BrowseTheWeb.using(protractor.browser));</code> </pre> <br><p>  James 'Ziel ist es, den ersten Punkt zu seiner Liste hinzuzuf√ºgen: </p><br><pre> <code class="plaintext hljs"> Scenario: Adding an item to a list with other items</code> </pre> <br><p>  Um dieses Ziel zu erreichen, ben√∂tigt James Folgendes: </p><br><ol><li>  Beginnen Sie mit einer Liste mit mehreren Elementen. </li><li>  neuen Artikel hinzuf√ºgen. </li></ol><br><p>  Wir k√∂nnen dies in zwei Klassen unterteilen: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PerformsTasks, Task } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Open } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay-protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { AddATodoItem } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./add_a_todo_item'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Start</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Task</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> withATodoListContaining(items: string[]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Start(items); } performAs(actor: PerformsTasks) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> actor.attemptsTo( Open.browserOn(<span class="hljs-string"><span class="hljs-string">'/examples/angularjs/'</span></span>), ...this.addAll(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.items) ); } <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(private items: string[]) { } private addAll(items: string[]): Task[] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> items.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> AddATodoItem.called(item)); } }</code> </pre> <br><p>  F√ºr die <code>Task</code> Schnittstelle muss die <code>performAs</code> Methode definiert werden, an die der Akteur w√§hrend der Ausf√ºhrung √ºbertragen wird.  <code>attemptsTo</code> - Kombinatorfunktion, akzeptiert eine beliebige Anzahl von Mischvorg√§ngen.  Auf diese Weise k√∂nnen Sie eine Vielzahl von Sequenzen erstellen.  Tats√§chlich √∂ffnet diese Aufgabe lediglich einen Browser auf der gew√ºnschten Seite und f√ºgt dort Elemente hinzu.  Schauen wir uns nun die Aufgabe an, ein Element hinzuzuf√ºgen: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PerformsTasks, Task } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Enter } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay-protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { protractor } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { TodoList } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/todo_list'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddATodoItem</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Task</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> called(itemName: string) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AddATodoItem(itemName); } <span class="hljs-comment"><span class="hljs-comment">// required by the Task interface performAs(actor: PerformsTasks): PromiseLike&lt;void&gt; { // delegates the work to lower-level tasks return actor.attemptsTo( Enter.theValue(this.itemName) .into(TodoList.What_Needs_To_Be_Done) .thenHit(protractor.Key.ENTER) ); } constructor(private itemName: string) } }</span></span></code> </pre> <br><p>  Interessanter ist hier, dass Aktionen auf niedriger Ebene angezeigt werden. Geben Sie Text in das Seitenelement ein und dr√ºcken Sie die Eingabetaste.  <code>TodoList</code> ist alles, was vom "beschreibenden" Teil des <code>TodoList</code> √ºbrig bleibt. Hier haben wir CSS-Selektoren: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Target, Question, Text } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'serenity-js/lib/screenplay-protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { by } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'protractor'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TodoList</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> What_Needs_To_Be_Done = Target .the(<span class="hljs-string"><span class="hljs-string">'"What needs to be done?" input box'</span></span>) .located(by.id(<span class="hljs-string"><span class="hljs-string">'new-todo'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Items = Target .the(<span class="hljs-string"><span class="hljs-string">'List of Items'</span></span>) .located(by.repeater(<span class="hljs-string"><span class="hljs-string">'todo in todos'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Items_Displayed = Text.ofAll(TodoList.Items); }</code> </pre> <br><p>  Ok, es bleibt zu √ºberpr√ºfen, ob nach allen Manipulationen die richtigen Informationen angezeigt werden.  SerenityJS bietet die Schnittstelle <code>Question&lt;T&gt;</code> - eine Entit√§t, die einen angezeigten Wert oder eine Liste von Werten <code>Text.ofAll</code> ( <code>Text.ofAll</code> im obigen Beispiel).  Wie k√∂nnte man eine <em>Frage</em> implementieren, die den Text eines HTML-Elements zur√ºckgibt: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Text</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Question</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">&gt; </span></span>{ public <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span>(target: Target): Text { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Text(target); } answeredBy(actor: UsesAbilities): PromiseLike&lt;string[]&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> BrowseTheWeb.as(actor).locate(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.target).getText(); } <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(private target: Target) { } }</code> </pre> <br><p>  Was wichtig ist, ist die Browserbindung optional.  <code>BrowseTheWeb</code> ist nur eine <em>F√§higkeit</em> , mit der Sie mit dem Browser interagieren k√∂nnen.  Sie k√∂nnen beispielsweise die <code>RecieveEmails</code> implementieren, mit der der Schauspieler Briefe lesen kann (zur Registrierung auf der Website). </p><br><p>  Alles zusammen ergibt dieses Schema (von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Jan Molak</a> ): <br><img src="https://habrastorage.org/getpro/habr/post_images/c7c/1c1/ac3/c7c1c1ac30c645ca0d6987348274e419.png"></p><br><p>  und das folgende Szenario: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> actor: Actor; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Given(<span class="hljs-regexp"><span class="hljs-regexp">/^.*that (.*) has a todo list containing (.*)$/</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name: string, items: string</span></span></span><span class="hljs-function">) </span></span>{ actor = Actor.named(name).whoCan(BrowseTheWeb.using(protractor.browser)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> actor.attemptsTo( Start.withATodoListContaining(listOf(items)) ); }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.When(<span class="hljs-regexp"><span class="hljs-regexp">/^s?he adds (.*?) to (?:his|her) list$/</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">itemName: string</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> actor.attemptsTo( AddATodoItem.called(itemName) ) }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Then(<span class="hljs-regexp"><span class="hljs-regexp">/^.* todo list should contain (.*?)$/</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">items: string</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> expect(actor.toSee(TodoList.Items_Displayed)).eventually.deep.equal(listOf(items)) });</code> </pre> <br><p>  Das Ergebnis sieht zun√§chst etwas massiv aus, aber mit dem Wachstum des Systems nimmt die Menge des wiederverwendeten Codes zu, und Layout- und Seiten√§nderungen wirken sich nur auf CSS-Selektoren und Aufgaben / Fragen auf niedriger Ebene aus, sodass die Skripte und Aufgaben auf hoher Ebene praktisch unver√§ndert bleiben. </p><br><h2 id="realizacii">  Implementierungen </h2><br><p>  Wenn wir √ºber Bibliotheken sprechen und nicht √ºber Versuche in Kleinst√§dten, dieses Muster anzuwenden, ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Serenity BDD</a> f√ºr Java das beliebteste.  Javascript / TypeScript verwendet einen eigenen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SerenityJS-</a> Port.  Nach dem Auspacken wei√ü sie, wie man mit Gurken und Mokka arbeitet. </p><br><p>  Eine schnelle Suche <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ergab</a> auch eine Bibliothek f√ºr .NET - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">tranquire</a> .  Ich kann nichts √ºber sie sagen, da ich sie vorher noch nicht getroffen habe. </p><br><p>  Wenn Sie Serenity und SerenityJS verwenden, k√∂nnen Sie das Dienstprogramm zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Berichterstellung verwenden</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Bericht mit Bildern</b> <div class="spoiler_text"><p>  Nimm den Code mit Mokka: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'Finding things to do'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'James can'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'remove filters so that the list'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'shows all the items'</span></span>, () =&gt; Actor.named(<span class="hljs-string"><span class="hljs-string">'James'</span></span>).attemptsTo( Start.withATodoListContaining([ <span class="hljs-string"><span class="hljs-string">'Write some code'</span></span>, <span class="hljs-string"><span class="hljs-string">'Walk the dog'</span></span> ]), CompleteATodoItem.called(<span class="hljs-string"><span class="hljs-string">'Write some code'</span></span>), FilterItems.toShowOnly(<span class="hljs-string"><span class="hljs-string">'Active'</span></span>), FilterItems.toShowOnly(<span class="hljs-string"><span class="hljs-string">'All'</span></span>), Ensure.theListOnlyContains(<span class="hljs-string"><span class="hljs-string">'Write some code'</span></span>, <span class="hljs-string"><span class="hljs-string">'Walk the dog'</span></span>), )); }); }); });</code> </pre> <br><p>  Der Bericht enth√§lt als allgemeine Statistik: <br><img src="https://habrastorage.org/getpro/habr/post_images/dd0/8fa/f09/dd08faf09e56d3fc272d7fab91be3d8d.png"></p><br><p>  und eine Aufschl√ºsselung der Schritte mit Screenshots: <br><img src="https://habrastorage.org/getpro/habr/post_images/3c8/19f/c52/3c819fc528d5f1af31d969af7ebbbe6e.png"></p></div></div><br><h1 id="ssylki">  Referenzen </h1><br><p>  Einige verwandte Artikel: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úberarbeitete Seitenobjekte: FESTE Schritte zum Drehbuch- / Reisemuster</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Jenseits von Seitenobjekten: Testautomatisierung der n√§chsten Generation mit Gelassenheit und dem Drehbuchmuster</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Serenity BDD und das Drehbuchmuster</a> </li></ol><br><p>  Papiere: </p><br><ol><li><iframe width="560" height="315" src="https://www.youtube.com/embed/8f8tdZBvAbI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></li><li><iframe width="560" height="315" src="https://www.youtube.com/embed/CocG0FBFJLU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></li></ol><br><p>  Bibliotheken: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Serenity BDD</a> - Java </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Serenity JS</a> - JavaScript / TypeScript </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">beruhigen</a> - .NET </li></ol><br><p>  Bitte schreiben Sie in die Kommentare, wenn Sie andere Muster / Methoden zum Organisieren des Codes von Autotests verwenden. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de434122/">https://habr.com/ru/post/de434122/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de434112/index.html">Prinzipien der funktionalen Programmierung in JavaScript</a></li>
<li><a href="../de434114/index.html">19 Ideen f√ºr Node.js Entwickler, die 2019 √ºber sich selbst hinauswachsen wollen</a></li>
<li><a href="../de434116/index.html">Die Geschichte der unglaublichen Leichtigkeit, moderne Softwareentwicklungsinfrastruktur zu hacken</a></li>
<li><a href="../de434118/index.html">React Tutorial Teil 4: √úbergeordnete und untergeordnete Komponenten</a></li>
<li><a href="../de434120/index.html">React Tutorial, Teil 5: Erste Schritte mit einer TODO-Anwendung, Grundlagen des Stylings</a></li>
<li><a href="../de434124/index.html">Aktivieren Sie die GPU-Beschleunigung in Photoshop unter Wine</a></li>
<li><a href="../de434126/index.html">Spielen Sie Medien mit der VLCj-Bibliothek ab</a></li>
<li><a href="../de434128/index.html">PHP Digest Nr. 146 (10. - 24. Dezember 2018) + 2018 Ergebnisse</a></li>
<li><a href="../de434130/index.html">Reaktive Schnittstelle. Vortrag von Artyom Belov auf den FrontTalks 2018</a></li>
<li><a href="../de434132/index.html">Kaufen Sie einen Fernseher und rollen Sie ihn auf: LG plant, im kommenden Jahr mit dem Verkauf flexibler Fernseher zu beginnen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>