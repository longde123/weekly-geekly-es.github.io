<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úåüèº üçè üêÉ "Alice, allume la lumi√®re." Commande vocale d'une maison intelligente bas√©e sur openHAB. Sans programmation et SMS ü§üüèæ ‚ùå ‚¨áÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Novembre 2017, le nombre onze √©tait affich√© sur le calendrier. La vente sur Aliexpress battait son plein, ses mains se grattaient quelque chose √† ache...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>"Alice, allume la lumi√®re." Commande vocale d'une maison intelligente bas√©e sur openHAB. Sans programmation et SMS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412261/"><iframe width="560" height="315" src="https://www.youtube.com/embed/bTpH3pVVMG4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Novembre 2017, le nombre onze √©tait affich√© sur le calendrier.  La vente sur Aliexpress battait son plein, ses mains se grattaient quelque chose √† acheter.  Le choix s'est <i>port√©</i> sur la " <i>Lampe LED RGBW Mi-light AC86-265V T√©l√©commande Smart Lighting</i> ".  En cons√©quence, deux copies de la puissance maximale, √† 9 watts, et un contr√¥leur de concentrateur MiLight WiFi iBox ont √©t√© achet√©s.  La livraison depuis la Chine n'a pas tard√© √† venir, et apr√®s 4 mois, le 13 mars 2018, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la plate-forme Yandex.Dialogs a ouvert</a> (une plate-forme qui permet aux d√©veloppeurs tiers d'ajouter des comp√©tences √† l'assistant vocal "Alice").  Ensuite, Alice apprendra √† contr√¥ler l'√©clairage (et pas seulement) dans votre appartement, et nous l'aiderons avec cela, par √©tapes et sans une seule ligne de code. <br><a name="habracut"></a><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Configuration de la lampe intelligente Xiaomi</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Installez openHAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Contr√¥le de la lumi√®re via openHAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Acc√®s externe √† openHAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">IFTTT</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Alice</a> </li></ol><br><a name="xiaomi"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/n8/ev/wx/n8evwxli9dh4en3ahsny_kmzn-e.jpeg"></div><br><h3>  1. Configuration des lampes intelligentes de Xiaomi. </h3><br>  La premi√®re chose √† faire est de configurer le contr√¥le de la lampe, au moins en utilisant l'application de Xiaomi.  Si cette √©tape est franchie pour vous, n'h√©sitez pas √† poursuivre la mise en place d'un serveur domestique intelligent, ou encore plus loin, directement √† l'int√©gration d'Alice et openHAB.  Mais, tout d'abord.  Les lampes elles-m√™mes ne se connecteront pas √† votre routeur domestique, pour cela, vous avez besoin d'un concentrateur iBox qui peut contr√¥ler jusqu'√† quatre groupes de sources lumineuses.  Vous devez le connecter au r√©seau, puis y connecter les lampes. <br><br><ol><li>  Nous <b>alimentons</b> l' <b>iBox</b> en le connectant via USB, par exemple, √† un chargeur pour le t√©l√©phone. </li><li>  Lors de la premi√®re connexion, vous devez r√©initialiser le concentrateur, appuyez donc sur <b>RST</b> . </li><li>  Ensuite, installez l'application de <b>Xiaomi</b> pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">iOS</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Android</a> sur le t√©l√©phone.  Assurez-vous que le t√©l√©phone est connect√© au r√©seau Wi-Fi domestique. </li><li>  Ouvrez l'application <b>Mi-Light 3.0</b> , cliquez sur <b>+</b> .  Ici, nous sommes int√©ress√©s par l'onglet <b>Smart Link</b> . </li><li>  Saisissez le nom et le mot de passe du r√©seau Wi-Fi domestique auquel le t√©l√©phone est connect√© et il est pr√©vu de connecter l' <b>iBox</b> . </li><li>  Votre <b>iBox</b> doit maintenant √™tre connect√©e au r√©seau et les indicateurs <b>SYS</b> et <b>LINK</b> doivent clignoter, lentement et rapidement, respectivement.  Sinon, appuyez √† nouveau sur <b>RST</b> . </li><li>  Si les indicateurs clignotent, cliquez dans l'application <b>D√©marrer la configuration</b> , le processus de configuration de la connexion pour le concentrateur commencera. </li><li>  Apr√®s une dizaine de secondes, le clignotement s'arr√™te, puis <b>SYS</b> recommence √† clignoter lentement et <b>LINK</b> reste <b>allum√©</b> .  L'application affiche <b>Configur√©</b> .  Le concentrateur est connect√© au r√©seau.  S'il ne figure pas dans la <b>liste des appareils</b> , cliquez simplement sur <b>Rechercher un appareil</b> . </li></ol><br>  D√©j√†, vous pouvez contr√¥ler la couleur et la luminosit√© de l'iBox elle-m√™me, mais nous devons connecter les lampes.  Pour ce faire, liez les lampes √† l'une des quatre zones disponibles pour le contr√¥le du concentrateur. <br><br><ol><li>  Nous ouvrons dans l'application <b>Mi-Light 3.0</b> de la liste du hub <b>Mi-Light</b> .  Acc√©dez √† la section <b>Couleurs</b> . </li><li>  En haut de l'√©cran, s√©lectionnez l'une des zones, que ce soit <b>Zone1</b> .  Et cliquez sur l'ic√¥ne d'appairage des appareils dans le coin sup√©rieur droit.  L' <b>√©cran LINK / UNLINK</b> avec des instructions <b>appara√Æt</b> . </li><li>  Maintenant, nous configurons les lampes que nous voulons lier √† <b>Zone1</b> , leur gestion √† l'avenir se fera de mani√®re synchrone.  Pour contr√¥ler la luminosit√© et la couleur de chaque lampe individuellement, elles doivent √™tre affect√©es √† des zones distinctes.  Alors, allumez la lampe, et dans les trois premi√®res secondes, cliquez dans l'application <b>Link</b> .  Si la lampe clignote trois fois, alors tout va bien, la synchronisation a r√©ussi.  Vous pouvez contr√¥ler la lampe. </li></ol><br><div style="text-align:center;"><img height="400" src="https://habrastorage.org/webt/bj/gf/lj/bjgflj6c_5paymroxvyojr-7qpw.jpeg"></div><br>  Fondamentalement, √† ce stade, vous disposez d√©j√† d'une t√©l√©commande pour la t√©l√©commande de la lumi√®re.  De plus, vous pouvez √©crire votre propre syst√®me de contr√¥le d'√©clairage, car le protocole de communication avec le concentrateur est connu depuis longtemps (il √©tait auparavant disponible sur <i>limitlessled.com/dev</i> ).  Il existe des biblioth√®ques pr√™tes √† l'emploi en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">php</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">javascript</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">python</a> .  Mais la gestion n'est possible qu'√† partir du r√©seau local, ce qui n'est clairement pas suffisant pour Alice.  Essayons de r√©soudre ce probl√®me. <br><br><a name="openhab"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/hv/t3/5x/hvt35xyvexl22gkkyvfpef3_muw.jpeg"></div><br><h3>  2. Installez openHAB </h3><br>  En bref, ce qui est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">openHab</a> .  Il s'agit d'un serveur de gestion de maison intelligente open source.  D√©velopp√© par la communaut√©, prend en charge la gestion d'un grand nombre d'appareils.  Il y a un client mobile, il y a la possibilit√© de g√©rer Alexa d'Amazon et un assistant de Google.  √âcrit en java, bas√© sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">framework Eclipse SmartHome</a> .  Il peut donc √™tre install√© m√™me sur un r√©frig√©rateur, l'essentiel est que la machine virtuelle Java fonctionne sur ce r√©frig√©rateur.  Les instructions d'installation sont pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Linux</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Windows</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mac OS</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Raspberry Pi</a> , pour divers <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Synology de</a> stockage r√©seau et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">QNAP</a> .  Passez rapidement en revue la premi√®re option. <br><br><ol><li>  Ajouter des cl√©s de r√©f√©rentiel: <br><br><pre><code class="bash hljs">wget -qO - <span class="hljs-string"><span class="hljs-string">'https://bintray.com/user/downloadSubjectPublicKey?username=openhab'</span></span> | sudo apt-key add - sudo apt-get install apt-transport-https</code> </pre> </li><li>  Ajoutez le r√©f√©rentiel lui-m√™me: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'deb https://dl.bintray.com/openhab/apt-repo2 stable main'</span></span> | sudo tee /etc/apt/sources.list.d/openhab2.list</code> </pre> </li><li>  Nous mettons √† jour et installons le serveur avec les modules compl√©mentaires: <br><br><pre> <code class="bash hljs">sudo apt-get update sudo apt-get install openhab2 sudo apt-get install openhab2-addons sudo apt-get install openhab2-addons-legacy</code> </pre> </li><li>  Nous configurons le d√©marrage automatique du service apr√®s le red√©marrage de l'appareil et le d√©marrons: <br><br><pre> <code class="bash hljs">sudo systemctl start openhab2.service sudo systemctl status openhab2.service sudo systemctl daemon-reload sudo systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> openhab2.service</code> </pre> </li><li>  Maintenant, nous attendons dans les <b>15 √† 20 minutes</b> (ce n'est pas une exag√©ration, c'est une dure r√©alit√© avec des blagues sur la vitesse de Java), pendant qu'il <code>http://openhab-device:8080</code> interface Web appara√Æt √† l'adresse <code>http://openhab-device:8080</code> . </li><li>  Sur cette page, nous nous int√©ressons √† l'article <b>Paper UI</b> .  C'est avec ce type d'interface que nous travaillerons √† l'avenir. </li></ol><br><img src="https://habrastorage.org/webt/t7/7t/4n/t77t4n7ug5blggwf7yyfstz-wd0.png"><br><br><a name="binding"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/hv/t3/5x/hvt35xyvexl22gkkyvfpef3_muw.jpeg"></div><br><h3>  3. Contr√¥le de la lumi√®re via openHAB </h3><br>  Nous avons donc un serveur domestique intelligent et des lampes de Xiaomi en √©tat de marche avec possibilit√© de t√©l√©commande.  Il est n√©cessaire de les connecter.  openHAB prend en charge les classeurs (instructions pour contr√¥ler l'√©lectronique connect√©e) pour de nombreux appareils, y compris ces lampes. <br><br><ol><li>  Acc√©dez √† Module <b>compl√©mentaire</b> ‚Üí <b>Liaisons</b> . </li><li>  Installez la <b>liaison Milight</b> . </li><li>  Pour ajouter notre appareil, cliquez sur <b>+</b> dans la section <b>Configuration</b> ‚Üí <b>Things</b> . </li><li>  Nous s√©lectionnons <b>Milight Binding</b> , la recherche automatique de l'appareil commence. </li><li>  Je n‚Äôai rien trouv√© automatiquement, j‚Äôai donc ajout√© manuellement ¬´ <b>Ajouter manuellement</b> quelque <b>chose</b> ¬ª. </li><li>  Nous s√©lectionnons le hub <b>iBox / iBox2</b> √† ajouter. </li><li>  Sur la page qui s'ouvre, vous devez remplir les champs <b>IP</b> et <b>Bridge ID</b> (adresse mac de l'appareil connect√©), vous pouvez les trouver, par exemple, dans le panneau de contr√¥le du routeur (mon hub est enregistr√© sur le r√©seau avec le nom du module HF-LPB100 qui y est utilis√©).  Ajouter. </li><li>  <b>Tr√®s bien</b> , <b>iBox / iBox2</b> appara√Æt maintenant dans la liste des appareils avec l'inscription " <i>Online</i> ". </li><li>  <b>Cliquez</b> de nouveau sur <b>+</b> et s√©lectionnez <b>Milight Binding</b> , cette fois pour ajouter directement les lampes. </li><li>  Maintenant, vous n'avez plus besoin d'ajouter quoi que ce soit √† la main, s√©lectionnez simplement un groupe de lampes dans la liste (dans mon cas, il s'agit de l'article <b>Rgbww Color (Zone 1)</b> ). </li><li>  L'√©l√©ment s√©lectionn√© doit appara√Ætre dans la liste des choses avec l'inscription " <i>En ligne</i> ". <br><br><img src="https://habrastorage.org/webt/lo/1u/pf/lo1upfvlh54rsjnxqbgcuxu389i.png"></li><li>  Les appareils sont configur√©s, vous devez maintenant leur ajouter des contr√¥les.  Pour ce faire, cliquez sur l'√©l√©ment nouvellement ajout√©. </li><li>  Une liste des param√®tres de la lampe que nous pouvons contr√¥ler √† distance s'ouvre.  Cliquez sur le cercle bleu <b>Luminosit√©</b> . </li><li>  Ensuite, s√©lectionnez le contr√¥le auquel nous voulons associer le param√®tre de p√©riph√©rique, car  nous ne les avons pas encore, cliquez sur <b>Cr√©er un nouvel √©l√©ment</b> . </li><li>  D√©finissez un nom arbitraire, par exemple <b>Light_Switcher</b> , et changez le type de <b>Dimmer</b> en <b>Switch</b> , car  Je n'ai pas besoin de r√©gler la luminosit√© de la lampe, je veux juste l'allumer et l'√©teindre.  Nous modifions simplement la cat√©gorie en <b>Lumi√®re</b> pour que le contr√¥le s'affiche avec une ic√¥ne dans la section <b>Contr√¥le</b> .  Cliquez sur <b>Lien</b> . </li><li>  Acc√©dez √† la section <b>Contr√¥le</b> et profitez du fonctionnement du commutateur de <b>luminosit√©</b> sur l'appareil. </li></ol><br><br><a name="myopenhab"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/hv/t3/5x/hvt35xyvexl22gkkyvfpef3_muw.jpeg"></div><br><h3>  4. Acc√®s externe √† openHAB </h3><br>  Pour des raisons de s√©curit√©, apr√®s les manipulations d√©crites ci-dessus, la gestion du serveur domestique intelligent n'est possible qu'√† partir du r√©seau local.  Ce n'est clairement pas suffisant pour notre t√¢che.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Il existe plusieurs options de configuration</a> : configurer un VPN pour acc√©der √† partir d'Internet √† un r√©seau local, configurer un proxy inverse ou connecter votre serveur au service cloud myopenHAB sur myopenHAB.org.  √âtant donn√© qu'en Russie, le nombre d'employ√©s de Roskomnadzor est directement proportionnel au nombre d'utilisateurs de VPN et de serveurs proxy, nous utiliserons cette derni√®re option. <br><blockquote>  Ne multipliez pas les choses inutilement </blockquote><br><ol><li>  Nous nous enregistrons sur le site Web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">myopenHAB</a> , connectez-vous et acc√©dez √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://myopenhab.org/account</a> .  Sur cette page, nous nous int√©ressons √† deux domaines: <b>openHAB UUID</b> et <b>openHAB Secret</b> .  Ils vous permettent d'organiser une connexion serveur.  Voyons o√π les trouver. </li><li>  Nous allons au panneau de contr√¥le <b>PaperUI openHAB</b> . </li><li>  Ouvrez la section <b>Configuration</b> ‚Üí <b>Modules compl√©mentaires</b> ‚Üí <b>Divers</b> . </li><li>  Installez <b>openHAB Cloud Connector</b> . </li><li>  Dans <b>Configuration</b> ‚Üí <b>Services</b> , le module <b>openHAB Cloud</b> avec le mode " <i>Notifications et acc√®s √† distance</i> " devrait appara√Ætre. </li><li>  Dans <b>Configuration</b> ‚Üí <b>Syst√®me</b> ‚Üí <b>Gestion des</b> <i>modules compl√©mentaires</i> <b>, le</b> <i>commutateur</i> " <i>Acceess Remote Repository</i> " doit √™tre activ√©. </li><li>  Apr√®s avoir install√© l'addon, les donn√©es que nous <b>recherchons</b> seront dans les fichiers <b>/ var / lib / openhab2 / uuid</b> et <b>/ var / lib / openhab2 / openhabcloud / secret</b> ( <i>userdata / uuid</i> et <i>userdata / openhabcloud / secret</i> , si vous ne l'avez pas <i>install√©</i> √† partir du package).  Nous les entrons dans les param√®tres du compte sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">myopenHAB</a> et cliquez sur <b>Mettre √† jour</b> .  Si tout est correctement configur√©, le mot " <i>En ligne</i> " devrait appara√Ætre √† gauche de votre adresse e-mail.  Cela sugg√®re que l'acc√®s √† votre maison intelligente depuis Internet est ouvert, mais <b>Alice</b> ne pourra pas l'utiliser imm√©diatement.  Vous devez d'abord rendre le p√©riph√©rique pr√©c√©demment configur√© accessible de l'ext√©rieur. </li><li>  Acc√©dez √† <b>Configuration</b> ‚Üí <b>Services</b> ‚Üí <b>openHAB Cloud</b> ‚Üí <b>Configurer</b> . </li><li>  Dans la liste <i>√âl√©ments √† exposer aux applications telles que IFTTT,</i> activez la case √† cocher pour le contr√¥le de la luminosit√© et cliquez sur <b>Enregistrer</b> . </li><li>  Apr√®s un certain temps, nous v√©rifions que l'√©l√©ment s√©lectionn√© est r√©pertori√© sur la page <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">myopenhab.org/items</a> avec le statut " <i>ON</i> ". </li></ol><br><img src="https://habrastorage.org/webt/tf/-a/3g/tf-a3gan7vajtb4qjy_urvu0nim.png"><br><br>  Le contr√¥le des lampes est d√©sormais possible depuis Internet, via l'API openHAB Cloud, qui prend en charge l'autorisation OAuth2.  Mais, malheureusement, les clients sont pr√©d√©termin√©s √† l'avance, ce sont Alexa, Google Assistant et le service IFTTT.  Alice n'est pas encore dans cette liste.  Mais ce n'est pas un probl√®me! <br><br><a name="ifttt"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/3w/q5/0d/3wq50dhkw-rwzok-o3nghgq9ioe.jpeg"></div><br><h3>  5. IFTTT </h3><br><blockquote>  Si c'est le cas alors. </blockquote><br>  Un service qui vous permet de construire une cha√Æne d'actions √† partir de plusieurs services.  R√©pondez sous condition par une action dans un service si un d√©clencheur pour un √©v√©nement dans un autre service a fonctionn√©.  IFTTT prend en charge un grand nombre de services, y compris myopenHAB qui nous int√©resse.  Mais ne prend pas en charge Alice.  En g√©n√©ral, n'importe qui peut cr√©er un module pour son service l√†-bas, tout d'abord, vous devez contacter le service commercial et conna√Ætre le montant de votre paiement annuel en faveur de l'IFTTT.  Notre objectif est d'utiliser le service gratuitement afin de pouvoir rediriger les demandes d'Alice vers openHAB. <br><br><ol><li>  Nous nous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">inscrivons</a> sur le site Web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ifttt.com</a> et allons dans <b>Applets</b> ‚Üí <b>New Applet</b> . </li><li>  Apr√®s avoir cliqu√© sur <b>+ ceci</b> , vous devez s√©lectionner le service dans lequel l'√©v√©nement sera un d√©clencheur.  Parce que  <b>Le</b> service <b>d'Alice n'est pas</b> sur la liste, nous devons choisir quelque chose qui peut recevoir des commandes d'elle.  Il s'agit d'un service <b>Webhooks</b> .  Cliquez sur <b>Connecter</b> . </li><li>  Ensuite, s√©lectionnez le d√©clencheur " <i>recevoir la demande Web</i> " dans la liste avec un √©l√©ment. </li><li>  Sp√©cifiez le nom de l'√©v√©nement, par exemple <b>light_on</b> , puis cliquez sur <b>Cr√©er</b> . </li><li>  Maintenant, nous devons s√©lectionner la r√©ponse, cliquez sur <b>+ √ßa</b> .  Notre choix de <b>openHAB</b> , plug. </li><li>  Dans la fen√™tre qui s'ouvre, l'autorisation OAuth2 mentionn√©e pr√©c√©demment, cliquez sur <b>Autoriser</b> . </li><li>  La seule r√©ponse de <i>commande d'envoi</i> est disponible. </li><li>  Dans la liste d√©roulante, s√©lectionnez le contr√¥le de la lampe (par exemple, Light_Switcher), et comme commande pour allumer la lumi√®re, sp√©cifiez le mot " <i>ON</i> ".  Nous cr√©ons. </li></ol><br>  Pour v√©rifier, nous devons appeler un d√©clencheur sur le service Webhooks.  Comment faire  Envoyez une demande POST. <br><br><ol><li>  Nous <b>recherchons le</b> service <b>Webhooks</b> sur le <b>site Web</b> <b>IFTTT</b> et <b>acc√©dons</b> √† la documentation qui lui est associ√©e. </li><li>  Sur la page qui s'ouvre, il y a une commande que nous devons ex√©cuter, en rempla√ßant <b>{event}</b> par <b>light_on</b> . </li><li>  Apr√®s avoir cliqu√© sur <b>Test It</b> , votre lampe devrait s'allumer. </li></ol><br>  Il reste √† cr√©er une recette similaire pour l'√©v√©nement light_off, qui enverra la commande OFF √† la commande d'√©clairage.  Et puis apprenez √† Alice √† appeler ces d√©clencheurs √† notre demande. <br><br><img src="https://habrastorage.org/webt/ky/z8/yw/kyz8ywf2mn07hfnfjpzj4jy26i4.png"><br><br><a name="alice"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/ba/ta/tn/batatn8tse9dchznkvkvxqgn98s.jpeg"></div><br><h3>  6. Alice </h3><br>  Dans mon ordre, dans mon d√©sir, Alice allumera la lumi√®re si vous utilisez la plateforme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yandex.Dialogs</a> .  La plateforme a ouvert ses portes en mars de cette ann√©e et permet √† quiconque d'ajouter des comp√©tences √† Alice en √©crivant le code appropri√©.  √Ä l'heure actuelle, un grand nombre de comp√©tences sont d√©j√† pr√©sent√©es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans le catalogue</a> .  Le d√©veloppement des comp√©tences fait l'objet d'un article s√©par√© sur Habr√©, et nous avons ici ¬´ <i>sans une seule ligne de code</i> ¬ª.  Nous allons donc utiliser les d√©veloppements disponibles. <br><br><ol><li>  Nous installons la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">version b√™ta de l'application de recherche Yandex</a> , seule elle prend actuellement en charge <b>les comp√©tences des utilisateurs</b> . </li><li>  Nous disons <b>qu'Alice</b> " <i>active les sorts magiques</i> ".  C'est la capacit√© des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>sorts magiques</b> / <b>sorts</b> <b>magiques qui</b></a> nous permettra d'effectuer des requ√™tes POST aux serveurs <b>IFTTT</b> . </li><li>  Cliquez sur <b>Ajouter</b> et sp√©cifiez l'adresse pour allumer la lumi√®re du formulaire: <br><br><pre> <code class="bash hljs">https://maker.ifttt.com/trigger/light_on/with/key/{user_id}</code> </pre> </li><li>  L'√©tape suivante consiste √† prononcer une phrase ou un mot auquel Alice r√©pondra en remplissant une demande √† l'adresse sp√©cifi√©e (mon Alice r√©pond ¬´allume la lumi√®re¬ª). </li></ol><br>  Si vous cliquez maintenant sur le bouton correspondant ou exprimez la proposition, la demande des serveurs Yandex ira au serveur de comp√©tences, de l√† √† IFTTT, puis √† myopenHAB, qui transf√©rera les donn√©es √† votre instance locale avec un acc√®s direct au concentrateur de la lampe et la lumi√®re s'allumera.  Nous ajouterons imm√©diatement une commande similaire pour √©teindre l'√©clairage. <br><br><div style="text-align:center;"><img height="400" src="https://habrastorage.org/webt/xr/5e/nb/xr5enbudszmydm0msmidvavxl_g.jpeg"></div><br>  Vous devez comprendre que simplement allumer Alice et dire ¬´ <i>allumer la lumi√®re</i> ¬ª ne suffit pas.  Yandex ne sait rien de nos √©quipes pour les maisons intelligentes, les donn√©es les concernant sont stock√©es dans la base de donn√©es de la comp√©tence " <i>sorts magiques</i> ".  Par cons√©quent, vous devez d'abord appeler la comp√©tence en disant ¬´ <i>allumez les sorts magiques</i> ¬ª, puis seulement allumez et √©teignez la lumi√®re avec votre voix. <br><br><h3>  PS </h3><br>  L'approche avec l'int√©gration d'Alice et openHAB via IFTTT ne limite pas votre imagination.  Vous pouvez utiliser la capacit√© " <i>sorts magiques</i> " pour contr√¥ler n'importe quoi dans votre voix de maison intelligente.  Par exemple, openHAB a des classeurs pour Samsung SmartTV, qui vous permettent de contr√¥ler le son et les canaux du t√©l√©viseur.  L'interaction d'Alice et de Webhooks est la mise en ≈ìuvre d'une interface vocale pour tous les services IFTTT, des ¬´ <i>sorts magiques</i> ¬ª vous permettent d'ex√©cuter la commande de n'importe lequel d'entre eux.  Ou vous ne pouvez pas utiliser Alice du tout et √©crire votre interface, par exemple, une application mobile qui ex√©cutera les requ√™tes IFTTT via les m√™mes Webhooks.  Oui, et IFTTT n'est pas n√©cessaire pour utiliser, par analogie, vous pouvez configurer les " <i>sorts magiques</i> " pour r√©pondre aux demandes de votre serveur. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr412261/">https://habr.com/ru/post/fr412261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr412249/index.html">Le travail scientifique est d√©pass√©; ce qui nous attend ensuite</a></li>
<li><a href="../fr412251/index.html">√âchappez-vous de l'enfer. Pilote captif Devyatayev d√©tournant un avion de sous le nez de fus√©es allemandes</a></li>
<li><a href="../fr412253/index.html">Prot√©ger un programme via Vk.com</a></li>
<li><a href="../fr412255/index.html">En tant que photographies du nouveau Honor 10. Comparez avec Huawei P20 et iPhone 7 Plus</a></li>
<li><a href="../fr412259/index.html">Aux √âtats-Unis conna√Ætra une nouvelle m√©thode de mort: l'inhalation d'azote</a></li>
<li><a href="../fr412263/index.html">Fonctionnement du syst√®me de classement des citoyens chinois: crimes et sanctions</a></li>
<li><a href="../fr412265/index.html">Comment World of Tanks VR a √©t√© cr√©√© et pourquoi il s'est av√©r√© √™tre un jeu compl√®tement diff√©rent</a></li>
<li><a href="../fr412267/index.html">Oubli√© la console de jeu Apple</a></li>
<li><a href="../fr412269/index.html">Amazon Echo Dot contre. Google Home Mini - quel assistant est le meilleur?</a></li>
<li><a href="../fr412271/index.html">Le triomphe et la trag√©die de ¬´Bourane¬ª</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>