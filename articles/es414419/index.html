<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèê üîà üéÖ ESET ha estado preparando el spyware InvisiMole desde 2013 üë©üèø‚Äçü§ù‚Äçüë©üèº ‚ôÇÔ∏è üêõ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mantenga un registro de las v√≠ctimas de alto rango manteni√©ndose a la sombra. Este es el principio de funcionamiento de dos componentes maliciosos de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ESET ha estado preparando el spyware InvisiMole desde 2013</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/414419/">  Mantenga un registro de las v√≠ctimas de alto rango manteni√©ndose a la sombra.  Este es el principio de funcionamiento de dos componentes maliciosos de InvisiMole.  Convierten la computadora infectada en una c√°mara de video de los atacantes, lo que le permite ver y escuchar todo lo que sucede en la oficina o en cualquier otro lugar donde se encuentre el dispositivo.  Los operadores de InvisiMole se conectan f√°cilmente al sistema, monitorean las acciones de la v√≠ctima y roban sus secretos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qz/z_/0f/qzz_0fx62wvi_detfemzuckk0zs.jpeg"></div><br>  Seg√∫n la telemetr√≠a de ESET, los atacantes detr√°s de este <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">spyware</a> han estado activos desde al menos 2013.  Sin embargo, esta herramienta de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ciberespionaje</a> no solo no se estudi√≥, sino que no se detect√≥ hasta que fue detectada por los productos de ESET en computadoras infectadas en Rusia y Ucrania. <br><br>  La campa√±a est√° altamente dirigida, lo que explica el bajo nivel de infecci√≥n: solo unas pocas docenas de computadoras. <br><a name="habracut"></a><br>  InvisiMole tiene una arquitectura modular, comienza su viaje con una DLL de contenedor (DLL de contenedor), luego hay dos m√≥dulos integrados en sus recursos.  Ambos m√≥dulos son puertas traseras multifuncionales, lo que permite que el Malvari recopile la m√°xima informaci√≥n sobre el objetivo. <br><br>  Para desviar la atenci√≥n del usuario de la m√°quina infectada, se aplican medidas adicionales.  Esto permite que el programa malicioso permanezca en el sistema durante mucho tiempo.  Todav√≠a tenemos que establecer el vector de infecci√≥n: actualmente todas las opciones son posibles, incluida la instalaci√≥n manual con acceso f√≠sico a la m√°quina. <br><br><h3>  Instalaci√≥n y persistencia </h3><br>  La primera parte del malvari bajo investigaci√≥n es un contenedor DLL compilado usando el compilador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Free Pascal</a> .  De acuerdo con nuestros datos de telemetr√≠a, la DLL se coloca en la carpeta de Windows y se disfraza como un <code>mpr.dll</code> biblioteca <code>mpr.dll</code> leg√≠timo con informaci√≥n de versi√≥n falsa. <br><br><img src="https://habrastorage.org/webt/63/po/le/63polemyrko5n7gdyrzmenhgeva.png"><br>  <i>Figura 1. Contenedor DLL disfrazado como un archivo de biblioteca mpr.dll leg√≠timo, copiando el nombre y la informaci√≥n de la versi√≥n</i> <br><br>  No vimos muestras con otros nombres de contenedor, aunque hay indicaciones en el c√≥digo DLL de que el archivo tambi√©n puede llamarse <code>fxsst.dll</code> o <code>winmm.dll</code> . <br><br>  La primera forma de iniciar malvari es la t√©cnica de reemplazar las DLL (secuestro de DLL).  El contenedor DLL se coloca en la misma carpeta que <code>explorer.exe</code> y se carga al inicio de Windows junto con el proceso del Explorador de Windows en lugar de la biblioteca leg√≠tima ubicada en la <code>%windir%\system32</code> . <br><br>  Encontramos versiones de Malvari de 32 y 64 bits, que proporcionan persistencia en ambas arquitecturas. <br><br>  Como alternativa a la suplantaci√≥n de DLL, son posibles otros m√©todos de carga y persistencia.  El contenedor DLL exporta la funci√≥n <code>GetDataLength</code> .  Al llamar a esta funci√≥n, la DLL comprueba si fue cargada por el proceso <code>rundll32.exe</code> usando <code>explorer.exe</code> o <code>svchost.exe</code> como el proceso padre, y solo entonces inicia la carga √∫til.  Esto sugiere otros m√©todos posibles para garantizar la persistencia: agregar tareas al planificador (el proceso primario es <code>svchost.exe</code> ) o escribir en la clave de ejecuci√≥n autom√°tica en el registro (el proceso primario es <code>explorer.exe</code> ). <br><br>  Independientemente de c√≥mo se mantenga la persistencia, el comportamiento del malware y la carga √∫til en s√≠ es el mismo en todos los casos.  El contenedor DLL carga el m√≥dulo almacenado en los recursos bajo los nombres <code>RC2FM</code> y <code>RC2CL</code> y (si se usa la sustituci√≥n DLL) una biblioteca leg√≠tima en el proceso <code>explorer.exe</code> para no alterar el funcionamiento normal de la aplicaci√≥n y pasar desapercibido. <br><br><img src="https://habrastorage.org/webt/tf/-0/eh/tf-0ehnfccoxblcwcetgc7zcgq8.png"><br>  <i>Figura 2. Funciones de contenedor exportadas</i> <br><br><h2>  An√°lisis t√©cnico </h2><br>  Se desconoce la fecha exacta de la compilaci√≥n del malware: los autores modificaron las √∫ltimas muestras de contenedor DLL, las marcas de tiempo PE se restablecieron a cero manualmente.  Sin embargo, en el curso del estudio, encontramos una versi√≥n anterior con fecha del 13 de octubre de 2013, por lo que las nuevas versiones se compilan claramente m√°s tarde. <br><br><img src="https://habrastorage.org/webt/rg/ke/pn/rgkepn1sgdnddzbzmrfdij84cbu.png"><br>  <i>Figura 3. En todas las muestras posteriores, las marcas de tiempo se establecen en cero</i> <br><br><h3>  Cifrado y descifrado </h3><br>  Para disfrazarse de analistas de virus y administradores de sistemas, los autores del programa malicioso utilizan el cifrado de cadenas, archivos internos, datos de configuraci√≥n y comunicaciones de red.  Mientras que el m√≥dulo <code>RC2FM</code> utiliza cifrados personalizados, el contenedor DLL y el m√≥dulo <code>RC2CL</code> utilizan un procedimiento espec√≠fico para todos los fines, incluido el descifrado de otros m√≥dulos maliciosos integrados en el contenedor DLL. <br><br>  El script con el que puede extraer los <code>RC2CL</code> <code>RC2FM</code> y <code>RC2CL</code> del contenedor DLL est√° disponible en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el repositorio de ESET en GitHub</a> . <br><br><img src="https://habrastorage.org/webt/wx/qz/dm/wxqzdmpwpxazkzgym0u3n-zghmw.png"><br>  <i>Figura 4. Procedimiento de descifrado en varias muestras (descompiladas y desmontadas)</i> <br><br><h3>  M√≥dulo RC2FM </h3><br>  El primer m√≥dulo <code>RC2FM</code> m√°s <code>RC2FM</code> contiene una puerta trasera que admite 15 comandos.  Se ejecutan en la computadora infectada seg√∫n las instrucciones del atacante.  El m√≥dulo puede realizar varios cambios en el sistema y tambi√©n incluye herramientas para el ciberespionaje. <br><br>  Los archivos tienen la opci√≥n de iniciar sesi√≥n, pero el nombre del registro del sistema no se especifica en la muestra.  Esto sugiere que la funci√≥n se us√≥ solo en la etapa de desarrollo. <br><br><h4>  Comunicaci√≥n de red </h4><br>  Este m√≥dulo se comunica con los servidores de C&amp;C, que est√°n codificados en la muestra o luego los atacantes los agregan. <br><br>  Adem√°s, el m√≥dulo puede acceder al servidor C&amp;C incluso con el proxy configurado en la m√°quina infectada.  Si no se puede establecer una conexi√≥n directa, el m√≥dulo intenta conectarse a cualquiera de sus servidores de C&amp;C utilizando proxies configurados localmente o proxies configurados para diferentes navegadores (Firefox, Pale Moon y Opera). <br>  RC2FM puede incluso consultar la lista de aplicaciones utilizadas recientemente e intentar encontrar ejecutables de navegador port√°tiles: <br><br>  FirefoxPortable.exe <br>  OperaPortable.exe <br>  Ejecute waterfox.exe <br>  OperaAC.exe <br>  Palemoon-Portable.exe <br><br>  Si la v√≠ctima usa uno de estos navegadores port√°tiles <i>con el servidor proxy configurado</i> , el malware puede detectarlo en la configuraci√≥n del usuario y usarlo para comunicarse con sus servidores de C&amp;C. <br><br>  La comunicaci√≥n con el servidor C&amp;C es una serie de solicitudes HTTP GET y POST, como se muestra en la Figura 5. La solicitud encriptada contiene la identificaci√≥n de la PC y la marca de tiempo, as√≠ como otra informaci√≥n (opcional).  Es importante tener en cuenta que el m√≥dulo <code>RC2FM</code> utiliza varios m√©todos de cifrado (variantes del cifrado XOR simple), a diferencia de otros componentes de InvisiMole. <br><br><img src="https://habrastorage.org/webt/ml/ev/kx/mlevkxds5qah0qvlkocfgxsfplk.png"><br>  <i>Figura 5. Un ejemplo de una solicitud enviada a un servidor C&amp;C por el m√≥dulo RC2FM</i> <br><br>  Despu√©s de registrar con √©xito a la v√≠ctima en el servidor de C&amp;C, se carga informaci√≥n adicional en el sistema, que ser√° interpretada por el comando de puerta trasera. <br><br><h4>  Funcionalidad </h4><br>  <code>RC2FM</code> admite comandos para enumerar informaci√≥n b√°sica del sistema y realizar cambios simples en el sistema, as√≠ como varias funciones de spyware.  A pedido de los atacantes, el m√≥dulo puede encender de forma remota el micr√≥fono en una computadora comprometida y grabar audio.  El registro est√° codificado en formato MP3 utilizando la biblioteca leg√≠tima <code>lame.dll</code> , que es descargada y utilizada por malware. <br><br>  Otra herramienta para robar datos son las capturas de pantalla.  Uno de los comandos de puerta trasera est√° dise√±ado para tomar capturas de pantalla. <br><br>  Un programa malicioso monitorea todos los discos internos y externos que se muestran en el sistema local.  Cuando se conecta una nueva unidad, crea una lista con todos los archivos y la almacena en forma cifrada. <br><br>  La informaci√≥n recopilada se transmitir√° al atacante despu√©s de enviar el comando apropiado. <br><br><h4>  Equipos de puerta trasera </h4><br>  Los siguientes son los ID y las descripciones de los comandos admitidos.  La visualizaci√≥n de la funci√≥n de puerta trasera en el int√©rprete se muestra en la Figura 6. <br><br>  0 - Haga listas de discos mostrados, archivos en una carpeta, recursos compartidos de red <br>  2 - Crear, mover, renombrar, ejecutar o eliminar un archivo, eliminar un directorio utilizando la ruta especificada <br>  4 - Abra el archivo, configure el puntero al comienzo del archivo <br>  5 - Cerrar un archivo abierto previamente <br>  6 - Escribir datos en un archivo abierto previamente <br>  7 - Cambiar atributos de archivo de tiempo / eliminar archivo <br>  8 - Abra el archivo, configure el puntero al final del archivo <br>  10 - Cambiar atributos de archivo de tiempo / eliminar archivo <br>  12 - Buscar archivos por la m√°scara de archivo especificada en el directorio especificado <br>  13 - Toma una captura de pantalla <br>  14 - Carga o modifica archivos usando datos internos <br>  15 - Grabe sonido usando dispositivos de audio conectados, haga una lista de dispositivos disponibles, env√≠e grabaciones, cambie la configuraci√≥n <br>  16 - Verifica si hay archivos abiertos en el m√≥dulo <br>  17 - Actualizar la lista de servidores C y C <br>  19 - Crear, instalar, copiar, enumerar o eliminar claves o valores de registro especificados <br><br><img src="https://habrastorage.org/webt/41/kf/7v/41kf7vzsczihmuttbyyjrbtcybe.png"><br>  <i>Figura 6. La funci√≥n de puerta trasera en el int√©rprete (original y despu√©s de nuestro an√°lisis, modificado usando la funci√≥n de Nodos de Grupo en IDA Pro para facilitar la lectura)</i> <br><br><h3>  M√≥dulo RC2CL </h3><br>  El m√≥dulo <code>RC2CL</code> tambi√©n es una puerta trasera con una amplia gama de herramientas de espionaje.  Se inicia mediante un contenedor DLL al mismo tiempo que el m√≥dulo <code>RC2FM</code> .  Este es un m√≥dulo m√°s complejo, sus funciones est√°n m√°s orientadas a la recolecci√≥n m√°xima de informaci√≥n que a realizar cambios en el sistema. <br><br>  Curiosamente, el m√≥dulo <code>RC2CL</code> tiene la opci√≥n de desactivar la funcionalidad de puerta trasera y funcionar como un proxy.  En este caso, el malware cierra el firewall de Windows y crea un servidor que admite la comunicaci√≥n entre el cliente y el servidor C&amp;C o dos clientes. <br><br><h4>  Comunicaci√≥n de red </h4><br>  El malware se comunica con los servidores de C&amp;C a trav√©s de un socket TCP.  Los mensajes enviados por el cliente est√°n enmascarados bajo el protocolo HTTP, pero debe prestar atenci√≥n al m√©todo HTTP inv√°lido "OCULTAR" en el ejemplo de la Figura 7. <br><br>  Las solicitudes contienen el identificador del software comprometido, el tipo de solicitud e informaci√≥n cifrada que deben enviar los atacantes, es decir, el resultado de ejecutar comandos de puerta trasera o una solicitud de nuevas instrucciones. <br><br><img src="https://habrastorage.org/webt/jf/og/gu/jfoggu3qvtsjumjvxt6etxex9mw.png"><br>  <i>Figura 7. Un ejemplo de una solicitud enviada al servidor de comandos por el m√≥dulo RC2CL</i> <br><br><h4>  Funcionalidad </h4><br>  Dependiendo del comando recibido, la puerta trasera puede realizar varias operaciones en el sistema infectado.  Las puertas traseras regulares realizan manipulaciones con el sistema de archivos y las claves de registro, admiten la ejecuci√≥n de archivos y la activaci√≥n remota de shell.  Este spivar es compatible con todos estos equipos e incluso m√°s: 84 equipos permiten a los atacantes recopilar informaci√≥n completa sobre la v√≠ctima. <br><br>  Un programa malicioso escanea una computadora infectada y transfiere varios datos a los atacantes: informaci√≥n del sistema (lista de procesos activos, servicios en ejecuci√≥n, controladores cargados o discos disponibles), informaci√≥n de red (tabla de direcciones IP, velocidad de conexi√≥n a Internet). <br><br>  InvisiMole puede escanear redes inal√°mbricas disponibles en un sistema comprometido.  Spivar registra informaci√≥n como SSID y direcciones MAC de puntos de acceso Wi-Fi detectados.  Estos datos se pueden verificar con bases de datos p√∫blicas, lo que permite a los atacantes rastrear la geolocalizaci√≥n de la v√≠ctima. <br><br>  Otros comandos proporcionan informaci√≥n sobre los usuarios de la m√°quina comprometida, sus cuentas y sesiones anteriores. <br><br>  De particular inter√©s es el software instalado en una m√°quina comprometida.  ¬øQu√© programas est√°n instalados en el sistema?  ¬øCu√°l de ellos se inicia autom√°ticamente al iniciar el sistema o al iniciar sesi√≥n?  ¬øQu√© programas usa un usuario en particular?  Si los atacantes est√°n interesados ‚Äã‚Äãen algo, solo ingrese un comando para obtener los datos necesarios. <br><br>  El malware puede obtener un comando para buscar documentos abiertos recientemente y otros archivos interesantes.  Puede ver directorios espec√≠ficos y dispositivos externos, informar cambios y extraer archivos seleccionados por atacantes. <br><br>  El malware puede activar o desactivar el sistema de administraci√≥n de cuentas (UAC), o evitarlo y trabajar con archivos en directorios protegidos sin derechos de administrador (m√°s en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace</a> ).  Si el malware se ejecuta bajo el proceso <code>explorer.exe</code> , que obtiene derechos elevados autom√°ticamente, puede crear un objeto COM y usarlo para eliminar y mover archivos en √°reas que requieren derechos de administrador. <br><br>  Adem√°s, InvisiMole puede encender de forma remota la c√°mara web y el micr√≥fono de la v√≠ctima, espiar tomando fotos o grabando sonido.  Los atacantes pueden monitorear la actividad en el dispositivo tomando capturas de pantalla.  Lo que es especialmente interesante, InvisiMole le permite tomar capturas de pantalla no solo de toda la pantalla, sino tambi√©n de cada ventana abierta.  Esto permite a los atacantes recopilar informaci√≥n incluso cuando las ventanas se cierran entre s√≠. <br><br>  Uno de los comandos de puerta trasera le permite reemplazar el contenido de los controladores con los siguientes nombres: <br><br> <code>blbdrive.sys <br> compbatt.sys <br> secdrv.sys</code> <br> <br>  No observamos el uso de este comando por parte de los atacantes, pero podemos suponer que se usa para proporcionar persistencia adicional en sistemas de 32 bits. <br><br>  La puerta trasera puede interferir con el sistema (por ejemplo, iniciar sesi√≥n como usuario, completar el proceso o apagar el sistema), pero principalmente proporciona operaciones pasivas.  El programa intenta ocultar su actividad siempre que sea posible. <br><br>  Entonces, spivar explora lugares interesantes en el sistema, estudia documentos abiertos recientemente o cambia algunos archivos.  Estas acciones dejan huellas y pueden causar sospechas de la v√≠ctima, ya que despu√©s de cada operaci√≥n de este tipo, cambia el momento de la √∫ltima modificaci√≥n del archivo y / o el acceso al mismo.  Para evitar la detecci√≥n, el malware recupera la fecha del cambio anterior o la apertura del archivo para ocultar sus manipulaciones al usuario. <br><br>  Otro ejemplo de c√≥mo los autores de spayvari intentan evitar la detecci√≥n es trabajar con rastros que quedan en el disco.  Un programa malicioso recopila una gran cantidad de datos confidenciales que se almacenan en archivos durante alg√∫n tiempo y se eliminan despu√©s de una carga exitosa a los servidores C&amp;C.  El problema es que un administrador experimentado del sistema puede recuperar archivos borrados, lo que ayudar√° a investigar el ataque despu√©s de que la v√≠ctima se entere del compromiso.  Esto es posible porque queda algo de informaci√≥n en el disco incluso despu√©s de eliminar el archivo.  Para evitar esto, InvisiMole tiene la opci√≥n de eliminar de forma segura todos los archivos.  Esto significa que primero los datos se sobrescriben con cero o bytes aleatorios, y solo despu√©s de eso se elimina el archivo. <br><br><h4>  Memoria incorporada </h4><br>  La configuraci√≥n de puerta trasera y los datos recopilados se almacenan en dos direcciones: este es el directorio de trabajo y las claves de registro.  Una parte importante de los comandos de puerta trasera est√° dise√±ada para manipular estas ubicaciones de almacenamiento de datos y sus contenidos. <br><br>  La ubicaci√≥n del directorio de trabajo se determina mediante comandos de un servidor remoto.  El directorio se utiliza como almacenamiento temporal de archivos que contienen informaci√≥n recopilada de una computadora comprometida.  Estos archivos tienen un m√©todo de denominaci√≥n com√∫n, algoritmo de cifrado y estructura.  Est√°n encriptados con una versi√≥n simple del cifrado XOR, que se utiliza en los componentes de malvari.  El tipo de archivo puede obtenerse de la secuencia de control de 4 bytes ubicada al comienzo del archivo. <br><br>  Adem√°s de almacenar los datos recopilados, el directorio se utiliza como directorio de inicio para una copia de la aplicaci√≥n leg√≠tima WinRAR.exe.  Malvar lo copia y lo usa para archivar datos robados. <br><br>  El registro almacena datos de configuraci√≥n, as√≠ como una lista de archivos en el directorio de trabajo.  Los datos se empaquetan usando el procedimiento Zlib implementado en el archivo binario malvari, y se encriptan usando el mismo cifrado que los archivos internos. <br><br><img src="https://habrastorage.org/webt/ih/al/gw/ihalgw7xzb35fahkfx9rcmr3_l0.png"><br><br><h4>  Equipos de puerta trasera </h4><br>  M√°s de ochenta comandos de puerta trasera utilizan el directorio de trabajo y las claves de registro para almacenar resultados intermedios y datos de configuraci√≥n.  El gr√°fico con la puerta trasera en el int√©rprete se muestra en la Figura 8. <br><br>  Alrededor de un tercio de todos los comandos se relacionan con la lectura y actualizaci√≥n de los datos de configuraci√≥n almacenados en el registro.  Las ID y descripciones de los comandos restantes se enumeran a continuaci√≥n. <br><br>  4 - Haga una lista de informaci√≥n de archivo en el directorio <br>  6 - Descargar archivo <br>  20 - Lista de procesos activos <br>  22 - Finalizar el proceso por ID <br>  24 - Ejecutar archivo <br>  26 - Eliminar archivo <br>  28 - Obtener tabla de reenv√≠o de IP <br>  30 - Escribir datos en un archivo <br>  31 - Inacci√≥n <br>  38 - Haga una lista de cuentas <br>  40 - Haga una lista de servicios en el sistema <br>  42 - Haga una lista de controladores cargados <br>  43 - Recopilar informaci√≥n b√°sica del sistema (nombre de la computadora, versi√≥n del sistema operativo, estado de la memoria, hora local, informaci√≥n del disco, informaci√≥n sobre proxies configurados, pol√≠tica actual de prevenci√≥n de ejecuci√≥n de datos para el sistema y procesos, etc.) <br>  44 - Haga una lista de software instalado <br>  46 - Lista de usuarios locales e informaci√≥n de sesi√≥n <br>  48 - Haga una lista de aplicaciones utilizadas por los usuarios <br>  52 - Crear estructura de directorios <br>  78 - Crear Shell Remoto <br>  81 - Ejecute el comando a trav√©s del shell remoto <br>  91 - Activar / Desactivar Control de cuenta de usuario <br>  93 - Sesi√≥n de usuario final / apagado / reinicio del sistema <br>  101 - Seguimiento y registro de cambios en directorios especificados <br>  103 - Eliminar directorio <br>  109 - Enciende / apaga el monitor / activa el modo de espera <br>  120 - Tome una captura de pantalla de la pantalla / ventanas activas <br>  126 - Tome una captura de pantalla de la pantalla / ventanas activas y actualice los datos de configuraci√≥n <br>  130 - Lista de informaci√≥n de recursos en discos no asignados <br>  132 - Cambiar el nombre / mover el archivo, cambiar el tiempo de creaci√≥n / apertura / escritura del archivo al especificado <br>  134 - Lista de archivos abiertos recientemente <br>  152 - Desconectar unidades extra√≠bles (previamente conectadas) <br>  155 - Crear / eliminar clave de registro, establecer / eliminar valores de clave de registro o enumerar valores / claves / datos de registro <br>  159, 161: apague el enrutamiento / firewall, cree un servidor proxy en un puerto espec√≠fico <br>  172 - Repita el cuadro de di√°logo pidiendo reiniciar la computadora <br>  175 - Omitir el control de la cuenta de usuario para la manipulaci√≥n de archivos <br>  177 - Crear y escribir un archivo, establecer datos en el momento de la creaci√≥n / apertura / cambio <br>  181 - Eliminar todos los puntos de restauraci√≥n del sistema <br>  183 - Restablecer componente (leg√≠timo) de una aplicaci√≥n WinRAR <br>  185 - Agregar archivos al archivo protegido por contrase√±a (contrase√±a = "12KsNh92Dwd") <br>  187 - Descifrar, descomprimir y cargar la DLL, cargar archivos exe desde RC2CL, recursos RC2FM <br>  189 - Crear un punto de restauraci√≥n del sistema <br>  191 - Extraer archivo protegido por contrase√±a (12KsNh92Dwd) <br>  193 - Cambiar el archivo encriptado <br>  195 - Reiniciar despu√©s de completar el proceso principal <br>  197 - Enviar 198 bytes de datos codificados en un patr√≥n <br>  199 - Cambiar nombre / mover archivo <br>  206 - Descifrar, descomprimir y descargar la DLL, cargar archivos exe desde RC2CL, recursos de RC2FM <br>  211: descargue la informaci√≥n recopilada (capturas de pantalla, grabaciones de audio, etc.) <br>  213 - Haga una lista de ventanas activas <br>  218 - API para grabar audio desde dispositivos de entrada <br>  220 - API para tomar fotos desde una c√°mara web <br>  224 - Haga una lista de archivos ejecutados en cada inicio del sistema <br>  226 - Haga una lista de redes inal√°mbricas habilitadas (direcci√≥n MAC, SSID, intervalo de se√±alizaci√≥n) <br>  228 - Restablecer paquete comprimido de Zlib <br><br><img src="https://habrastorage.org/webt/jf/og/gu/jfoggu3qvtsjumjvxt6etxex9mw.png"><br>  <i>Figura 8. La funci√≥n de puerta trasera en el int√©rprete (original y modificada utilizando la funci√≥n Nodos de grupo en IDA Pro para facilitar la lectura)</i> <br><br><h2>  Conclusi√≥n </h2><br>  InvisiMole es un software esp√≠a con todas las funciones que ofrece amplias funciones que pueden competir con otras conocidas herramientas de espionaje cibern√©tico. <br><br>  Uno solo puede adivinar por qu√© los autores usan dos m√≥dulos con funciones duplicadas.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se podr√≠a suponer que el m√≥dulo m√°s peque√±o, se </font></font><code>RC2FM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utiliza en la primera etapa de reconocimiento, y el m√°s grande, se </font></font><code>RC2CL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ejecuta solo en m√°quinas que interesan a los operadores. </font><font style="vertical-align: inherit;">Pero esto no es as√≠: se lanzan dos m√≥dulos simult√°neamente. </font><font style="vertical-align: inherit;">La segunda explicaci√≥n posible: los m√≥dulos son ensamblados por diferentes autores y luego combinados para proporcionar a los operadores un m√°ximo de herramientas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvisiMole utiliza solo algunas t√©cnicas para evitar la detecci√≥n y el an√°lisis. </font><font style="vertical-align: inherit;">Sin embargo, dado que el spyware se utiliz√≥ en ataques contra un peque√±o n√∫mero de objetivos de alto rango, logr√≥ evitar la detecci√≥n durante al menos cinco a√±os.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Indicadores de compromiso (IoC) </font></font></h2><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Detecci√≥n de ESET </font></font></h3><br> <code>Win32/InvisiMole.A trojan <br> Win32/InvisiMole.B trojan <br> Win32/InvisiMole.C trojan <br> Win32/InvisiMole.D trojan <br> Win64/InvisiMole.B trojan <br> Win64/InvisiMole.C trojan <br> Win64/InvisiMole.D trojan</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1 hashes </font></font></h3><br> <code>5EE6E0410052029EAFA10D1669AE3AA04B508BF9 <br> 2FCC87AB226F4A1CC713B13A12421468C82CD586 <br> B6BA65A48FFEB800C29822265190B8EAEA3935B1 <br> C8C4B6BCB4B583BA69663EC3AED8E1E01F310F9F <br> A5A20BC333F22FD89C34A532680173CBCD287FF8</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nombres de dominio del servidor C y C </font></font></h3><br> <code>activationstate.sytes[.]net <br> advstatecheck.sytes[.]net <br> akamai.sytes[.]net <br> statbfnl.sytes[.]net <br> updchecking.sytes[.]net</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Direcciones IP de servidores C&amp;C y per√≠odo de actividad </font></font></h3><br> <code>2013-2014 - 46.165.231.85 <br> 2013-2014 - 213.239.220.41 <br> 2014-2017 - 46.165.241.129 <br> 2014-2016 - 46.165.241.153 <br> 2014-2018 - 78.46.35.74 <br> 2016-2016 - 95.215.111.109 <br> 2016-2018 - 185.118.66.163 <br> 2017-2017 - 185.118.67.233 <br> 2017-2018 - 185.156.173.92 <br> 2018-2018 - 46.165.230.241 <br> 2018-2018 - 194.187.249.157</code> <br> <br><h3>     </h3><br><h4> RC2FM </h4><br> <code>[HKEY_CURRENT_USER\Software\Microsoft\IE\Cache] <br> "Index"</code> <br> <br><h4> RC2CL </h4><br> <code>[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Console] <br> or [HKEY_CURRENT_USER\Software\Microsoft\Direct3D] <br> "Settings" <br> "Type" <br> [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\OLE] <br> or [HKEY_CURRENT_USER\Software\Microsoft\Direct3D] <br> "Common" <br> "Current" <br> "ENC" <br> "FFLT" <br> "Flag1" <br> "FlagLF" <br> "FlagLF2" <br> "IfData" <br> "INFO" <br> "InstallA" <br> "InstallB" <br> "LegacyImpersonationNumber" <br> "LM" <br> "MachineAccessStateData" <br> "MachineState 0" <br> "RPT" <br> "SP2" <br> "SP3" <br> "SettingsMC" <br> "SettingsSR1" <br> "SettingsSR2"</code> <br> <br><h3>    </h3><br><h4> RC2FM </h4><br> <code>%APPDATA%\Microsoft\Internet Explorer\Cache\AMB6HER8\ <br> %volumeSerialNumber%.dat <br> content.dat <br> cache.dat <br> index.dat <br> %APPDATA%\Microsoft\Internet Explorer\Cache\MX0ROSB1\ <br> content.dat <br> index.dat <br> %random%.%ext% <br> %APPDATA%\Microsoft\Internet Explorer\Cache\index0.dat</code> <br> <br><h4> RC2CL </h4><br> <code>Winrar\ <br> comment.txt <br> descript.ion <br> Default.SFX <br> WinRAR.exe <br> main.ico <br> fl_%timestamp%\strcn%num%\ <br> fdata.dat <br> index.dat <br> ~mrc_%random%.tmp <br> ~src_%random%.tmp <br> ~wbc_%random%.tmp <br> sc\~sc%random%.tmp <br> ~zlp\zdf_%random%.data <br> ~lcf\tfl_%random%</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es414419/">https://habr.com/ru/post/es414419/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es414405/index.html">Instalar certificado en el servidor HTTP Apache</a></li>
<li><a href="../es414411/index.html">Wiren Board 6: nuevamente en Habr√© con la nueva versi√≥n del controlador para automatizaci√≥n</a></li>
<li><a href="../es414413/index.html">Sinopsis y video de la historia sobre las redes en la industria del juego con el gamedev del festival</a></li>
<li><a href="../es414415/index.html">Conferencia de Tarantool 21 de junio - no solo sobre Tarantool, sino en general sobre la computaci√≥n en memoria</a></li>
<li><a href="../es414417/index.html">Eventos digitales en Mosc√∫ del 18 al 24 de junio.</a></li>
<li><a href="../es414423/index.html">Este d√≠a nos acercamos lo m√°s posible ... Se lanz√≥ una nueva versi√≥n de SBM 11.4</a></li>
<li><a href="../es414425/index.html">Algoritmo de reconocimiento de patrones de aprendizaje de una sola vez</a></li>
<li><a href="../es414427/index.html">¬øQu√© puede hacer una impresora 3D? Informe de la exposici√≥n Maker Faire Bay Area 2018</a></li>
<li><a href="../es414429/index.html">C√≥mo aprender un idioma extranjero sin un maestro. Parte 1. "Mi experiencia"</a></li>
<li><a href="../es414431/index.html">Mitap JavaJam. Debate javista, rafting, experimentos y microservicios.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>