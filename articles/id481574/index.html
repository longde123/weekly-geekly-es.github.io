<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥀 📧 🏇🏻 Hosting sendiri sumber daya pihak ketiga: baik, buruk, jahat ⏪ 🕶️ 👩🏽‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam beberapa tahun terakhir, semakin banyak platform untuk mengoptimalkan proyek front-end menawarkan peluang untuk hosting independen atau proksi s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hosting sendiri sumber daya pihak ketiga: baik, buruk, jahat</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/481574/">  Dalam beberapa tahun terakhir, semakin banyak platform untuk mengoptimalkan proyek front-end menawarkan peluang untuk hosting independen atau proksi sumber daya pihak ketiga.  Akamai memungkinkan Anda untuk mengatur <a href="https://community.akamai.com/customers/s/article/5-ways-to-prevent-slow-3rd-party-front-end-services%3Flanguage%3Den_US">parameter khusus</a> untuk URL yang dibuat sendiri.  Cloudflare memiliki teknologi Edge Workers.  Fasterzine dapat <a href="https-the-impact-on-your-loading-times/">menulis ulang</a> URL pada halaman sehingga mengarah ke sumber pihak ketiga yang terletak di domain utama situs. <br><br> <a href="https://habr.com/ru/company/ruvds/blog/481574/"><img src="https://habrastorage.org/webt/ak/ui/qp/akuiqpw02td9hovfkxqtbxgocck.png"></a> <br><br>  Jika Anda tahu bahwa layanan pihak ketiga yang digunakan dalam proyek Anda tidak terlalu sering berubah, dan bahwa proses pengiriman mereka kepada pelanggan dapat ditingkatkan, maka Anda mungkin berpikir tentang membuat proxy layanan tersebut.  Dengan pendekatan ini, Anda dapat "membawa" sumber daya ini lebih dekat ke pengguna dan mendapatkan kontrol lebih besar atas caching mereka di sisi klien.  Ini, di samping itu, memungkinkan Anda untuk melindungi pengguna dari masalah yang disebabkan oleh "jatuhnya" layanan pihak ketiga atau penurunan kinerjanya. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Bagus: peningkatan produktivitas</font> </h2><br>  Hosting sendiri sumber daya orang lain meningkatkan kinerja dengan cara yang sangat jelas.  Browser tidak perlu mengakses DNS lagi, tidak perlu membuat koneksi TCP dan melakukan jabat tangan TLS pada domain pihak ketiga.  Bagaimana hosting independen terhadap sumber daya orang lain memengaruhi kinerja dapat dilihat dengan membandingkan dua angka berikut. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/828/0d5/2dd/8280d52dd448afd4d0be39a19ef9dbdb.png"></div><br>  <i><font color="#999999">Sumber daya pihak ketiga diunduh dari sumber eksternal (diambil <a href="https://csswizardry.com/2019/05/self-host-your-static-assets/">dari sini</a> )</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8cb/fb0/da2/8cbfb0da2fc370ddd2da10630c0bc40b.png"></div><br>  <i><font color="#999999">Sumber daya pihak ketiga disimpan di tempat yang sama dengan sisa bahan situs (diambil <a href="https://csswizardry.com/2019/05/self-host-your-static-assets/">dari sini</a> )</font></i> <br><br>  Situasi ini juga ditingkatkan oleh fakta bahwa browser akan menggunakan kemampuan multiplexing dan memprioritaskan data koneksi HTTP / 2, yang sudah ditetapkan dengan domain utama. <br><br>  Jika Anda tidak meng-host sumber daya pihak ketiga, maka, karena mereka akan diunduh dari domain selain yang utama, mereka tidak dapat diprioritaskan.  Ini akan membuat mereka saling bersaing untuk mendapatkan bandwidth klien.  Hal ini dapat mengarah pada fakta bahwa waktu pemuatan material yang penting untuk pembentukan halaman akan jauh lebih lama daripada waktu yang dapat dicapai dalam kondisi keadaan ideal.  <a href="https://www.youtube.com/watch%3Fv%3DnOW-i6bbRdo">Berikut ini adalah</a> pembicaraan tentang prioritas HTTP / 2 yang menjelaskan semua ini dengan sangat baik. <br><br>  Dapat diasumsikan bahwa penggunaan atribut <code>preconnect</code> dalam tautan ke sumber daya eksternal akan membantu dalam menyelesaikan masalah.  Namun, jika ada terlalu banyak tautan ke berbagai domain, ini dapat, pada kenyataannya, membebani jalur komunikasi pada saat yang paling penting. <br><br>  Jika Anda meng-host sumber daya pihak ketiga sendiri, Anda dapat mengontrol bagaimana sumber daya ini diberikan kepada klien.  Yaitu, kita berbicara tentang hal berikut: <br><br><ul><li>  Anda dapat memastikan bahwa algoritma kompresi data yang paling cocok untuk setiap browser (Brotli / gzip) diterapkan. </li><li>  Anda dapat meningkatkan waktu caching sumber daya, yang biasanya tidak terlalu besar bahkan untuk penyedia paling terkenal (misalnya, nilai yang sesuai untuk tag GA diatur ke 30 menit). </li></ul><br>  Anda bahkan dapat memperpanjang TTL untuk sumber daya, misalnya, hingga satu tahun dengan memasukkan bahan yang sesuai dalam strategi manajemen caching Anda (hash URL, versi, dan sebagainya).  Kami akan membicarakan ini di bawah ini. <br><br><h3>  <font color="#3AC1EF">▍ Perlindungan terhadap gangguan dalam pengoperasian layanan pihak ketiga atau dari terputusnya mereka</font> </h3><br>  Aspek lain yang menarik dari hosting independen dari sumber daya pihak ketiga adalah bahwa ini memungkinkan Anda untuk mengurangi risiko yang terkait dengan gangguan dalam pengoperasian layanan pihak ketiga.  Misalkan solusi pihak ketiga Anda untuk pengujian A / B diimplementasikan sebagai skrip pemblokiran yang dimuat di bagian header halaman.  Script ini dimuat dengan lambat.  Jika skrip yang sesuai gagal dimuat, halaman akan kosong.  Jika butuh banyak waktu untuk memuatnya, halaman akan muncul dengan penundaan lama.  Atau, misalkan proyek menggunakan perpustakaan yang dimuat dari sumber daya CDN pihak ketiga.  Bayangkan bahwa sumber daya ini mogok atau diblokir di negara tertentu.  Situasi seperti itu akan menyebabkan pelanggaran terhadap logika situs. <br><br>  Untuk mengetahui cara kerja situs Anda dalam kondisi tidak dapat diaksesnya beberapa layanan eksternal, Anda dapat menggunakan bagian SPOF di <a href="https://www.webpagetest.org/">webpagetest.org</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bda/89e/935/bda89e935be22061d7f28f4833b00cac.png"></div><br>  <i><font color="#999999">Bagian SPOF di webpagetest.org</font></i> <br><br><h3>  <font color="#3AC1EF">▍ Bagaimana dengan masalah caching dengan browser?</font>  <font color="#3AC1EF">(petunjuk: ini adalah mitos)</font> </h3><br>  Anda mungkin berpikir bahwa menggunakan CDN yang tersedia untuk umum akan secara otomatis menghasilkan kinerja sumber daya yang lebih baik, karena layanan ini memiliki jaringan yang cukup baik dan didistribusikan di seluruh dunia.  Tetapi semuanya, pada kenyataannya, sedikit lebih rumit. <br><br>  Misalkan kita memiliki beberapa situs berbeda: website1.com, website2.com, website3.com.  Semua situs ini menggunakan perpustakaan jQuery.  Kami menghubungkannya dengan mereka menggunakan CDN, misalnya googleapis.com.  Anda dapat mengharapkan browser untuk mengunduh dan cache perpustakaan sekali, dan kemudian menggunakannya saat bekerja dengan ketiga situs.  Ini bisa mengurangi beban pada jaringan.  Mungkin ini akan menghemat uang di suatu tempat dan membantu meningkatkan produktivitas sumber daya.  Dari sudut pandang praktis, semuanya terlihat berbeda.  Misalnya, Safari mengimplementasikan fitur yang disebut <a href="https://webkit.org/blog/7675/intelligent-tracking-prevention/">Intelligent Tracking Prevention</a> : cache menggunakan kunci ganda berdasarkan sumber dokumen dan sumber daya pihak ketiga.  <a href="https://andydavies.me/blog/2018/09/06/safari-caching-and-3rd-party-resources/">Inilah</a> artikel bagus tentang topik ini. <br><br>  Penelitian <a href="https://yuiblog.com/blog/2007/01/04/performance-research-part-2/">Yahoo</a> dan <a href="https://code.facebook.com/posts/964122680272229/web-performance-cache-efficiency-exercise/">Facebook lama</a> , serta <a href="httparchive.org/t/analyzing-resource-age-by-content-type/1659">penelitian yang</a> lebih baru <a href="httparchive.org/t/analyzing-resource-age-by-content-type/1659">oleh</a> Paul Calvano, menunjukkan bahwa sumber daya tidak disimpan dalam cache peramban selama yang kita duga: “Ada kesenjangan serius antara waktu caching sumber daya proyek kami sendiri dan pihak ketiga.  Ini tentang CSS dan font web.  Yaitu, jangka waktu caching dari 95% dari font mereka sendiri melebihi seminggu, sedangkan jangka waktu caching dari 50% dari font pihak ketiga kurang dari seminggu!  Ini memberi pengembang web alasan yang bagus untuk meng-host file font sendiri! ” <br><br>  Akibatnya, jika Anda meng-host materi orang lain, Anda tidak akan melihat masalah kinerja yang disebabkan oleh caching browser. <br><br>  Sekarang kita telah memeriksa kekuatan sumber daya pihak ketiga yang dapat hosting sendiri, mari kita bicara tentang bagaimana membedakan implementasi yang baik dari pendekatan ini dari yang buruk. <br><br><h2>  <font color="#3AC1EF">Buruk: iblis ada di detail</font> </h2><br>  Memindahkan sumber daya pihak ketiga ke domain Anda sendiri tidak dapat dilakukan secara otomatis tanpa menjaga caching sumber daya tersebut dengan benar. <br><br>  Salah satu masalah utama di sini adalah waktu caching.  Sebagai contoh, informasi versi termasuk dalam nama skrip pihak ketiga seperti ini: <code>jquery-3.4.1.js</code> .  File seperti itu tidak akan berubah di masa depan, sebagai akibatnya, itu tidak akan menyebabkan masalah dengan cachingnya. <br><br>  Tetapi jika skema versi tertentu tidak diterapkan ketika bekerja dengan file, skrip cache, konten yang berubah ketika nama file tidak berubah, mungkin menjadi usang.  Ini bisa menjadi masalah serius, karena, misalnya, itu tidak memungkinkan secara otomatis memperkenalkan perbaikan keamanan ke dalam skrip yang harus diterima klien sesegera mungkin.  Pengembang harus berupaya memperbarui skrip tersebut dalam cache.  Selain itu, ini dapat menyebabkan aplikasi crash karena fakta bahwa kode yang digunakan pada klien dari cache berbeda dari versi terbaru dari kode yang merupakan bagian server dari proyek yang dirancang. <br><br>  Benar, jika kita berbicara tentang materi yang sering diperbarui (manajer tag, solusi untuk pengujian A / B), maka caching mereka menggunakan CDN adalah tugas yang dapat diselesaikan, tetapi itu sudah jauh lebih rumit.  Layanan seperti Commanders Act, solusi manajemen tag, menggunakan kait web untuk menerbitkan versi baru.  Ini memungkinkan untuk mengatur pembilasan cache pada CDN, atau, bahkan lebih baik, kemampuan untuk memanggil pembaruan hash atau versi URL. <br><br><h3>  <font color="#3AC1EF">▍ Pengiriman bahan yang adaptif kepada pelanggan</font> </h3><br>  Selain itu, ketika kita berbicara tentang caching, kita juga harus memperhitungkan fakta bahwa pengaturan caching yang digunakan pada CDN mungkin tidak cocok untuk beberapa sumber daya pihak ketiga.  Sebagai contoh, sumber daya tersebut dapat menggunakan teknologi menghirup agen pengguna, penyajian adaptif, untuk menyediakan versi materi yang dioptimalkan untuk browser tertentu untuk browser ini.  Teknologi ini, untuk mengetahui kemampuan browser, bergantung pada ekspresi reguler, atau pada database yang mengumpulkan informasi tentang header HTTP <code>User-Agent</code> .  Setelah mengetahui peramban mana yang mereka hadapi, mereka memberikan materi yang dirancang untuk itu. <br><br>  Di sini Anda dapat memanggil kembali dua layanan.  Yang pertama adalah googlefonts.com.  Yang kedua adalah polyfill.io.  Layanan Google Font menyediakan, untuk beberapa sumber daya, berbagai kode-CSS tergantung pada kemampuan peramban (memberikan tautan ke sumber daya woff2 menggunakan <code>unicode-range</code> ). <br><br>  Berikut adalah hasil dari beberapa permintaan Google Font yang dibuat dari berbagai browser. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c7/ecc/36a/4c7ecc36ad0cd11dcc1455f3b59f1ab0.png"></div><br>  <i><font color="#999999">Hasil Kueri Huruf Chrome</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d57/8b2/170/d578b2170268cd61bf608b7cc87120c4.png"></div><br>  <i><font color="#999999">Hasil permintaan Google Fonts dibuat dari IE10</font></i> <br><br>  Polyfill.io memberikan browser hanya polyfill yang dibutuhkannya.  Ini dilakukan karena alasan kinerja. <br><br>  Misalnya, lihat apa yang terjadi jika Anda menjalankan permintaan berikut dari browser yang berbeda: <a href="">https://polyfill.io/v3/polyfill.js?features=default</a> <br><br>  Menanggapi permintaan yang dibuat dari IE10, 34 Kb data akan datang.  Dan jawabannya, dibuat dari Chrome, akan kosong. <br><br><h2>  <font color="#3AC1EF">Marah: beberapa pertimbangan privasi</font> </h2><br>  Item ini terakhir dalam urutan, tetapi tidak penting.  Intinya adalah hosting independen dari sumber daya pihak ketiga pada domain utama proyek atau pada subdomainnya dapat membahayakan privasi pengguna dan mempengaruhi proyek web utama. <br><br>  Jika sistem CDN Anda tidak dikonfigurasikan dengan benar, mungkin berakhir mengirimkan cookie dari domain Anda ke layanan pihak ketiga.  Jika pemfilteran yang tepat tidak diatur pada tingkat CDN, maka cookie sesi Anda, yang dalam kondisi normal tidak dapat digunakan dalam JavaScript (dengan atribut <code>httponly</code> ), dapat dikirim ke host asing. <br><br>  Inilah yang bisa terjadi dengan pelacak seperti Eulerian atau Criteo.  Pelacak pihak ketiga dapat menetapkan pengidentifikasi unik dalam cookie.  Jika mereka adalah bagian dari materi situs, mereka dapat membaca pengidentifikasi atas kebijakan mereka selama pekerjaan pengguna dengan sumber daya web yang berbeda. <br><br>  Saat ini, sebagian besar browser menyertakan perlindungan terhadap perilaku pelacak tersebut.  Akibatnya, pelacak sekarang menggunakan teknologi <a href="https://medium.com/nextdns/cname-cloaking-the-dangerous-disguise-of-third-party-trackers-195205dc522a">CNAME Cloaking</a> , menyamar sebagai skrip mereka sendiri untuk berbagai proyek.  Yaitu, pelacak menawarkan pemilik situs untuk menambahkan CNAME ke pengaturan domain mereka untuk domain tertentu, yang alamatnya biasanya terlihat seperti kumpulan karakter acak. <br><br>  Meskipun tidak disarankan bahwa cookie situs web dapat diakses oleh semua subdomain (misalnya, * .website.com), banyak situs melakukan ini.  Dalam hal ini, cookie semacam itu secara otomatis dikirim ke pelacak pihak ketiga yang disamarkan.  Akibatnya, Anda tidak dapat lagi berbicara tentang privasi apa pun. <br><br>  Selain itu, hal yang sama terjadi dengan header HTTP <a href="https://developers.google.com/web/updates/2015/09/automating-resource-selection-with-client-hints">Client-Hints</a> , yang dikirim hanya ke domain utama, karena mereka dapat digunakan untuk membuat <a href="http-extensions/issues/767">sidik jari digital</a> pengguna.  Harap pastikan bahwa layanan CDN yang Anda gunakan dengan benar menyaring tajuk tersebut. <br><br><h2>  <font color="#3AC1EF">Ringkasan</font> </h2><br>  Jika Anda akan segera memperkenalkan hosting independen dari sumber pihak ketiga - izinkan saya memberi Anda beberapa tips: <br><br><ul><li>  Tuan rumah perpustakaan JS, font, dan file CSS Anda yang paling penting.  Ini akan mengurangi risiko kegagalan situs atau penurunan kinerjanya sebagai akibat dari kenyataan bahwa sumber daya vital untuk situs untuk bekerja tidak tersedia karena layanan pihak ketiga. </li><li>  Sebelum melakukan caching sumber daya pihak ketiga pada CDN, pastikan Anda menggunakan sistem versi saat menamai file mereka, atau bahwa Anda dapat mengontrol siklus hidup sumber daya ini dengan secara manual atau secara otomatis membilas cache CDN saat menerbitkan versi baru dari skrip. </li><li>  Berhati-hatilah dengan pengaturan untuk CDN, server proxy, cache.  Ini akan memungkinkan Anda untuk mencegah pengiriman cookie dari proyek Anda atau header <code>Client-Hints</code> ke layanan pihak ketiga. </li></ul><br>  <b>Pembaca yang budiman!</b>  Apakah Anda memposting materi orang lain di server Anda yang sangat penting untuk proyek Anda? <br><br><div style="text-align:center;"> <a href="https://ruvds.com/ru-rub"><img src="https://habrastorage.org/webt/u9/qa/nk/u9qankiogj61jowwkrc-v8c8rgm.png"></a> </div><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id481574/">https://habr.com/ru/post/id481574/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id481564/index.html">PHP Digest No. 170 (9-23 Desember 2019)</a></li>
<li><a href="../id481566/index.html">LED alamat berwarna-warni untuk tahun baru tanpa pemrograman dan solder</a></li>
<li><a href="../id481568/index.html">Acara digital di Moskow dari 23 hingga 29 Desember</a></li>
<li><a href="../id481570/index.html">Hari ini pukul 17:00 webinar DevOps: Tools and Numbers akan diadakan</a></li>
<li><a href="../id481572/index.html">Tumpukan teknologi web baru saya untuk tahun 2020</a></li>
<li><a href="../id481576/index.html">Frontend 2019: hasil tahun ini</a></li>
<li><a href="../id481578/index.html">Cepheids - "tonggak" bintang Semesta</a></li>
<li><a href="../id481580/index.html">Kontes NUC Tahun Baru. Subtotal dan Voting Penonton</a></li>
<li><a href="../id481582/index.html">kerja & bersenang-senang (damentals) # 2 Softskill bagus. Hanya seseorang yang salah mengerti mereka</a></li>
<li><a href="../id481584/index.html">Saat mengelola tim, patahkan semua aturan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>