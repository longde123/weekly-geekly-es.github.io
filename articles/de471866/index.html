<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ™ğŸ¿ ğŸ§‘ğŸ¾â€ğŸ¤â€ğŸ§‘ğŸ½ ğŸˆ´ PEG-Parser-Visualisierung ğŸ‘°ğŸ½ ğŸœ ğŸ‘ŠğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Letztes Mal haben wir einen einfachen PEG-Parser-Generator bekommen. Jetzt werde ich zeigen, was der generierte Parser beim Parsen des Programms tatsÃ¤...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PEG-Parser-Visualisierung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471866/"><p>  Letztes Mal haben wir einen einfachen PEG-Parser-Generator bekommen.  Jetzt werde ich zeigen, was der generierte Parser beim Parsen des Programms tatsÃ¤chlich tut.  Ich tauchte in die Retro-Welt der ASCII-Kunst ein, insbesondere in eine Bibliothek namens "curses", die in der Standard-Python-Distribution fÃ¼r Linux und Mac verfÃ¼gbar ist, sowie in ein Add-On fÃ¼r Windows. </p><br><div class="spoiler">  <b class="spoiler_title">Inhalt der Python PEG Parser-Serie</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Peg Parser</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PEG-Parser-Implementierung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PEG-Parser-Generierung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PEG-Parser-Visualisierung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Linke rekursive PEG-Grammatik</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">HinzufÃ¼gen von Aktionen zur PEG-Grammatik</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Meta-Grammatik fÃ¼r PEG-Parser</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Implementierung der verbleibenden Funktionen von PEG</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PEG auf Core Developer Sprint</a> </li></ul></div></div><br><p><img src="https://habrastorage.org/webt/fr/cj/o-/frcjo-fmvrqbs0ddzsesm--dg2w.png"></p><br><p>  &lt;Am Ende des Artikels wird unter dem Spoiler ein GIF angezeigt.  Es schien mir verstÃ¤ndlicher als ein statisches Bild </p><a name="habracut"></a><br><p> Schauen wir uns die Visualisierung an.  Der Bildschirm ist, wie in ASCII Ã¼blich, in drei Teile mit einem Bindestrich unterteilt: </p><br><ul><li>  Der obere Teil zeigt den Parser-Aufrufstapel, der, wie Sie sich erinnern, ein rekursiver Abstiegsanalysator mit unbegrenzter RÃ¼ckgabe ist.  Im Folgenden werde ich nÃ¤her erlÃ¤utern. </li><li>  Der einzeilige Abschnitt in der Mitte zeigt den Inhalt des Token-Puffers, wobei ein Cursor auf das Token zeigt, das als nÃ¤chstes analysiert wird. </li><li>  Im Folgenden wird der vom Packrat-Parser-Algorithmus verwendete Cache visualisiert.  Das Aufzeichnen seiner Elemente Ã¤hnelt in gewisser Weise einigen Elementen des Parser-Stacks (mit Ergebnissen). </li></ul><br><p>  Das Wichtigste, was Sie wissen mÃ¼ssen, um diese Visualisierung zu verstehen, ist, dass die EinrÃ¼ckung der Zeilen oben und unten dem Token-Puffer entspricht. </p><br><ul><li> Die ersten beiden Zeilen (beginnend mit <code>statement</code> und <code>assignment</code> ) zeigen die Aufrufe der entsprechenden Parser-Methoden, die gerade die Analyse durchfÃ¼hren.  Sie wurden aufgerufen, wenn sich der Tokenizer-Zeiger vor dem ersten Token befand ( <code>'aap'</code> ). </li><li>  Die nÃ¤chsten beiden Zeilen (beginnend mit <code>expr</code> und <code>term</code> ) sind am Anfang des <code>'cat'</code> <code>expr</code> <code>'cat'</code> Tokens ausgerichtet, wo die entsprechenden Parser-Methoden aufgerufen wurden. </li><li>  Die fÃ¼nfte und letzte Zeile des Stack-Renderings zeigt den zu <code>expect('/')</code> Aufruf <code>expect('/')</code> , der <code>None</code> zurÃ¼ckgibt.  Er meldete sich freiwillig bei der <code>'+'</code> Token-Position. </li></ul><br><p>  Das EinrÃ¼cken von Elementen im Cache entspricht auch einer Position im Token-Puffer.  Im unteren Bereich befinden sich beispielsweise negative EintrÃ¤ge im Cache, die beim Suchen nach den Regeln <code>'if'</code> und <code>if_statement</code> am Anfang des <code>if_statement</code> abgerufen wurden.  Wir finden auch erfolgreiche Cache-EintrÃ¤ge fÃ¼r das Token <code>'='</code> und fÃ¼r <code>NAME</code> (insbesondere <code>'cat'</code> ), die weiteren Eingabepositionen entsprechen. </p><br><p>  Sowohl im Analyzer-Stack-Block als auch im Cache-Block werden die zurÃ¼ckgegebenen Aufrufe als <code>function(args) -&gt; result</code> angezeigt.  Manchmal werden mehrere zurÃ¼ckgegebene Methoden auf dem Parser-Stapel angezeigt. Ich habe dies getan, um Textjitter durch hÃ¤ufige InhaltsÃ¤nderungen zu reduzieren. </p><br><p>  (Apropos Jitter: Die oberen Zeilen des Analysatorstapels werden nach oben verschoben, wenn ein Aufruf zum Stapel hinzugefÃ¼gt wird, und fallen ab, wenn er vom Stapel entfernt wird. Das heiÃŸt, jeder neue Aufruf wird ganz unten im Stapelvisualisierungsblock eingefÃ¼gt und verschiebt die vorhandenen Zeilen nach oben. Es scheint mir Das Betrachten dieses Teils des Bildschirms ist zumindest fÃ¼r mich kein Problem. Wahrscheinlich ist ein bedeutender Teil unseres Gehirns der Verfolgung sich bewegender Objekte gewidmet. :-) </p><br><p>  Der Cache wird als LRU gerendert, wobei hÃ¤ufig verwendete Elemente oben angezeigt werden.  seltenere gehen den Bildschirm runter.  (Der Prototyp des Packrat-Parsers, den ich in frÃ¼heren Artikeln gezeigt habe, verwendet keine LRU, aber es ist wahrscheinlich eine gute Idee, den Speicherverbrauch zu optimieren.) </p><br><p>  Schauen wir uns beim Rendern des Parsing-Stacks einige Details an.  Die oberen vier EintrÃ¤ge entsprechen den Parser-Methoden, die noch verarbeitet werden. Jede Zeile ist eine Zeile aus der Grammatik.  Das hervorgehobene Element hat die nÃ¤chste Herausforderung generiert. </p><br><p>  Das heiÃŸt,  Nach dem Screenshot zu urteilen, sind wir bei der zweiten Alternative fÃ¼r die <code>statement</code> , nÃ¤mlich der <code>assignment</code> .  In dieser Regel sind wir am dritten Punkt, nÃ¤mlich <code>expr</code> .  In der <code>expr</code> befinden wir uns nur im ersten Absatz der ersten Alternative ( <code>term '+' expr</code> );  und in der Regel fÃ¼r den <code>term</code> wir in der letzten Alternative ( <code>atom</code> ). </p><br><p>  Unten sehen wir das Ergebnis, das zum Scheitern der zweiten Alternative ( <code>atom '/' term</code> ) gefÃ¼hrt hat: <code>expect('/') -&gt; None</code> EinrÃ¼ckung mit dem Token <code>'+'</code> .  Im nÃ¤chsten Schritt werden wir sehen, wie es in den Cache gelangt. </p><br><p>  Aber sicherlich mÃ¶chten Sie die gesamte Animation lieber selbst sehen! </p><br><div class="spoiler">  <b class="spoiler_title">Ich habe eine vollstÃ¤ndige Analyse des kanonischen Beispielprogramms aufgezeichnet</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/xi/vm/5g/xivm5g5d640s54ni3urif6qsbl8.gif"></p></div></div><br><p>  Sie kÃ¶nnen auch mit vorgefertigtem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Code spielen</a> , aber denken Sie daran, dass dies kein Sport ist. </p><br><p>  Wenn Sie ein <a href="">aufgezeichnetes GIF</a> anzeigen, kann es etwas seltsam erscheinen, dass manchmal das nÃ¤chste Token nicht angezeigt wird (z. B. wÃ¤chst der Stapel zu Beginn um mehrere DatensÃ¤tze, bevor das <code>'aap'</code> Token erkannt wird).  Genau das sieht der Analysator: Der Token-Puffer wird trÃ¤ge gefÃ¼llt.  Tokens werden erst gescannt, wenn der Parser sie durch Aufrufen der Funktion <code>expect()</code> anfordert.  Sobald der Token in den Puffer gelangt, bleibt er dort, auch wenn der Analysator die Token-Sequenz zurÃ¼ckspult.  Die umgekehrte Verfolgung wird im Token-Puffer mit einem Cursor angezeigt, der nach links springt.  Es gibt viele solche Situationen in der Akte.  Sie kÃ¶nnen das BefÃ¼llen des Caches auch beobachten, wenn der Analysator keine zusÃ¤tzlichen rekursiven Aufrufe ausfÃ¼hrt.  (Ich muss hervorheben, wann dies passiert, aber ich hatte nicht genug Zeit.) </p><br><p>  NÃ¤chste Woche werde ich einen Parser entwickeln und vielleicht meine Perspektive auf die linken Regeln der rekursiven Grammatik hinzufÃ¼gen.  (Sie sind groÃŸartig!) </p><br><p>  Danksagung: FÃ¼r die Aufzeichnung habe ich <code>ttygif</code> von Ilya Choli und <code>ttyrec</code> von Matthew Jording verwendet. </p><br><p>  Lizenz fÃ¼r diesen Artikel und zitierten Code: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CC BY-NC-SA 4.0</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de471866/">https://habr.com/ru/post/de471866/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de471856/index.html">Wir lÃ¶sen alle 42 Versionen des Harry-Potter-Trank-Puzzles</a></li>
<li><a href="../de471858/index.html">RabbitMQ vs. Kafka: Failover und HochverfÃ¼gbarkeit in Clustern</a></li>
<li><a href="../de471860/index.html">Peg Parser</a></li>
<li><a href="../de471862/index.html">PEG-Parser-Implementierung</a></li>
<li><a href="../de471864/index.html">PEG-Parser-Generierung</a></li>
<li><a href="../de471868/index.html">Genetik der Liebe: Konflikt zwischen den Geschlechtern als Grundlage fÃ¼r die Zusammenarbeit bei Paaren monogamer VÃ¶gel</a></li>
<li><a href="../de471870/index.html">Effektive Nutzung von libdispatch</a></li>
<li><a href="../de471872/index.html">Schnittstellen in C # 8: GefÃ¤hrliche Annahmen in der Standardimplementierung</a></li>
<li><a href="../de471874/index.html">Wie wir die ÃœberprÃ¼fungsrichtlinien umgangen und einen Server auf dem Telefon gestartet haben</a></li>
<li><a href="../de471876/index.html">PDU und All-All-All: Rack-Stromverteilung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>