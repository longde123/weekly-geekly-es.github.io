<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóÑÔ∏è üàÅ üçÄ Ataques criptogr√°ficos: uma explica√ß√£o para mentes confusas üëâ üìå üßëüèø‚Äçü§ù‚Äçüßëüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Na palavra "criptografia", alguns se lembram da senha do Wi-Fi, um cadeado verde ao lado do endere√ßo do site favorito e o qu√£o dif√≠cil √© entrar no cor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ataques criptogr√°ficos: uma explica√ß√£o para mentes confusas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462437/">  Na palavra "criptografia", alguns se lembram da senha do Wi-Fi, um cadeado verde ao lado do endere√ßo do site favorito e o qu√£o dif√≠cil √© entrar no correio de outra pessoa.  Outros se lembram de uma s√©rie de vulnerabilidades dos √∫ltimos anos com abrevia√ß√µes de fala (DROWN, FREAK, POODLE ...), logotipos elegantes e um aviso atualizando urgentemente o navegador. <br><br>  A criptografia cobre tudo isso, mas a <i>ess√™ncia</i> √© diferente.  A linha inferior √© entre simples e complexo.  Algumas coisas s√£o f√°ceis de fazer, mas dif√≠ceis de recuperar: por exemplo, quebrar um ovo.  Outras coisas s√£o f√°ceis de fazer, mas dif√≠ceis de recuperar quando falta uma parte crucial crucial: por exemplo, abrir uma porta trancada quando a ‚Äúparte cr√≠tica‚Äù √© a chave.  A criptografia estuda essas situa√ß√µes e como us√°-las na pr√°tica. <br><br>  Nos √∫ltimos anos, a cole√ß√£o de ataques criptogr√°ficos se transformou em um zool√≥gico de logotipos chamativos cheios de f√≥rmulas de artigos cient√≠ficos e criou uma sensa√ß√£o sombria geral de que tudo est√° quebrado.  Mas, de fato, muitos dos ataques s√£o baseados em v√°rios princ√≠pios gerais, e as infinitas p√°ginas de f√≥rmulas geralmente se resumem a id√©ias f√°ceis de entender. <br><a name="habracut"></a><br>  Nesta s√©rie de artigos, examinaremos v√°rios tipos de ataques criptogr√°ficos, com √™nfase em princ√≠pios b√°sicos.  Em termos gerais e n√£o exatamente nessa ordem, mas informaremos o seguinte: <br><br><ul><li>  <b>Estrat√©gias b√°sicas:</b> for√ßa bruta, an√°lise de frequ√™ncia, interpola√ß√£o, downgrade e protocolos cruzados. <br></li><li>  <b>Vulnerabilidades da marca:</b> FREAK, CRIME, POODLE, DROWN, Logjam. <br></li><li>  <b>Estrat√©gias avan√ßadas:</b> ataques do Oracle (ataque de Woden, ataque de Kelsey);  m√©todo de encontro no meio (meet-in-the-middle), ataque de anivers√°rios, vi√©s estat√≠stico (criptoan√°lise diferencial, criptoan√°lise integral, etc.). <br></li><li>  <b>Ataques de terceiros</b> e seus parentes pr√≥ximos, m√©todos de an√°lise de falhas. <br></li><li>  <b>Ataques √† criptografia de chave p√∫blica:</b> raiz c√∫bica, Broadcast, mensagem relacionada, ataque de Coppersmith, algoritmo Polyg - Hellman, peneira num√©rica, ataque de Wiener, ataque de Bleichenbacher. </li></ul><br>  Este artigo em particular cobre o material acima at√© o ataque de Kelsey. <br><br><h1>  Estrat√©gias b√°sicas </h1><br>  Os seguintes ataques s√£o simples no sentido de que podem ser quase completamente explicados sem detalhes t√©cnicos especiais.  Explicamos cada tipo de ataque nos termos mais simples, sem nos aprofundarmos em exemplos complexos ou casos de uso avan√ßados. <br><br>  Alguns desses ataques perderam principalmente relev√¢ncia e n√£o s√£o usados ‚Äã‚Äãh√° muitos anos.  Outros s√£o veteranos, eles ainda se interessam regularmente por desenvolvedores de sistemas de criptografia desavisados ‚Äã‚Äãno s√©culo XXI.  Podemos assumir que a era da criptografia moderna come√ßou com o advento do IBM DES - a primeira cifra que resistiu a todos os ataques nesta lista. <br><br><h2>  For√ßa bruta simples </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/6f0/cab/445/6f0cab44522b473f2407720c1f67b1be.jpg" align="left" width="165">  O esquema de criptografia consiste em duas partes: 1) uma fun√ß√£o de criptografia que recebe uma mensagem (texto sem formata√ß√£o) em combina√ß√£o com uma chave e cria uma mensagem criptografada - texto cifrado;  2) uma fun√ß√£o de descriptografia que pega um texto cifrado e uma chave e cria texto sem formata√ß√£o.  Tanto a criptografia quanto a descriptografia devem ser f√°ceis de calcular com a chave - e dif√≠ceis sem ela. <br><br>  Suponha que vejamos o texto cifrado e tentemos descriptograf√°-lo sem nenhuma informa√ß√£o adicional (isso √© chamado de ataque apenas de texto cifrado).  Se, de alguma forma, encontrarmos a chave certa de forma m√°gica, podemos verificar facilmente se ela est√° realmente correta se o resultado for uma mensagem razo√°vel. <br><br>  Observe que existem duas suposi√ß√µes impl√≠citas.  Primeiramente, sabemos como executar a descriptografia, ou seja, como o sistema de criptografia funciona.  Essa √© uma suposi√ß√£o padr√£o ao discutir a criptografia.  Ocultar os detalhes da implementa√ß√£o da cifra dos invasores pode parecer uma medida de seguran√ßa adicional, mas assim que o invasor descobre esses detalhes, essa seguran√ßa extra √© invis√≠vel e irreversivelmente perdida.  Este √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">princ√≠pio de Kerchhoffs</a> : cair nas m√£os do inimigo n√£o deve causar transtornos. <br><br>  Em segundo lugar, assumimos que a chave correta √© a √∫nica chave que levar√° a uma descriptografia razo√°vel.  Essa tamb√©m √© uma suposi√ß√£o razo√°vel;  √© executado se o texto cifrado for muito maior que a chave e for bem lido.  Como regra, √© isso o que acontece no mundo real, com exce√ß√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">grandes chaves impratic√°veis</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">outras fraudes, que devem ser deixadas de lado</a> (se voc√™ n√£o gosta que descartamos as explica√ß√µes, consulte o Teorema 3.8 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> ). <br><br>  Diante do exposto, surge uma estrat√©gia: verifique todas as chaves poss√≠veis.  Isso √© chamado de for√ßa bruta, e esse ataque √© garantido para funcionar contra todas as cifras pr√°ticas - no final.  Por exemplo, for√ßa bruta √© suficiente para decifrar a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cifra de C√©sar</a> , uma cifra antiga, onde a chave √© uma letra do alfabeto, o que implica um pouco mais de 20 chaves poss√≠veis. <br><br>  Infelizmente para os criptoanalistas, aumentar o tamanho da chave protege contra a for√ßa bruta.  √Ä medida que o tamanho da chave aumenta, o n√∫mero de chaves poss√≠veis aumenta exponencialmente.  Com tamanhos de chave modernos, uma for√ßa bruta simples n√£o √© de todo pr√°tica.  Para entender o que queremos dizer, vamos usar o supercomputador mais r√°pido conhecido em meados de 2019: o IBM's <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Summit</a> , com desempenho m√°ximo da ordem de 10 <sup>17</sup> opera√ß√µes por segundo.  Hoje, um tamanho t√≠pico de chave √© de 128 bits, o que significa <sup>2.128</sup> combina√ß√µes poss√≠veis.  A enumera√ß√£o de todas as chaves exige que o supercomputador da Summit tome cerca de 7800 vezes a idade do universo. <br><br>  A for√ßa bruta deve ser considerada uma curiosidade hist√≥rica?  De maneira alguma: √© um ingrediente necess√°rio no livro de receitas da criptoan√°lise.  Raramente s√£o encontradas cifras t√£o fracas que podem ser quebradas apenas com um ataque inteligente, sem o uso da for√ßa em um grau ou outro.  Muitos hacks bem-sucedidos usam o m√©todo algor√≠tmico primeiro para enfraquecer a cifra de destino e depois executar a for√ßa bruta. <br><br><h2>  An√°lise de frequ√™ncia </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/cc5/441/be5/cc5441be52b0de71fc71bbe80b1a5c60.jpg" align="left" width="240">  A maioria dos textos n√£o √© sem sentido.  Por exemplo, nos textos em ingl√™s h√° muitas letras 'e' e artigos 'the';  em arquivos bin√°rios - muitos bytes nulos como espa√ßo reservado entre informa√ß√µes.  An√°lise de frequ√™ncia √© qualquer ataque que explora esse fato. <br><br>  Um exemplo can√¥nico de uma cifra vulner√°vel a esse ataque √© uma cifra de substitui√ß√£o simples.  Nesta cifra, a chave √© uma tabela com a substitui√ß√£o de todas as letras.  Por exemplo, 'g' √© substitu√≠do por 'h', 'o' por j; portanto, a palavra 'go' se transforma em 'hj'.  Essa cifra √© dif√≠cil √† for√ßa bruta simples, pois existem tantas tabelas de pesquisa poss√≠veis.  Se voc√™ estiver interessado em matem√°tica, o tamanho efetivo da chave √© de cerca de 88 bits: este <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">o</span><span class="MJXp-msubsup" id="MJXp-Span-4"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-8">26</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0.111em; margin-right: 0em;">!</span><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.765ex" height="2.66ex" viewBox="0 -832 3773.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMATHI-6F" x="298" y="0"></use><g transform="translate(784,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMATHI-67" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMAIN-32" x="675" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMAIN-28" x="1715" y="0"></use><g transform="translate(2104,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMAIN-21" x="3105" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMAIN-29" x="3384" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> log_2 (26!) </script>  .  Mas a an√°lise de frequ√™ncia geralmente faz o trabalho rapidamente. <br><br>  Considere o seguinte texto cifrado processado com uma cifra de substitui√ß√£o simples: <br><br><pre>  XDYLY ALY FEIA XDWNKE WN DYAJYN E YALXD DGLAXWG XDAN ALY FLYAUX GR WN OGQL ZDWBGEGZDO </pre><br>  Como <code>Y</code> √© comum, inclusive no final de muitas palavras, podemos assumir provisoriamente que esta √© a letra <code>e</code> : <br><br><pre>  XDeLe ALGL UGLe XDWNKE WN DEAJEN AND ALXD DGLAXWG XDAN ALe FLeAUX GR WN OGQL ZDWBGEGZDO </pre><br>  O par <code>XD</code> √© repetido no in√≠cio de algumas palavras.  Em particular, a combina√ß√£o de XDeLe implica explicitamente a palavra this or <code>there</code> , ent√£o continuamos: <br><br><pre>  O GLOBO MAIS VELHO DO MUNDO E GANHANDO DIREITO DA DGLAtWG DO QUE ALGUM FLUOU GR GR WN OGQL ZDWBGEGZDO </pre><br>  Al√©m disso, suponha que <code>L</code> corresponda a <code>r</code> , <code>A</code> - <code>a</code> e assim por diante.  Voc√™ provavelmente ter√° que fazer v√°rias tentativas, mas, comparado √† for√ßa bruta total, esse ataque restaura o texto de origem o mais r√°pido poss√≠vel: <br><br><pre>  h√° mais coisas no c√©u e na terra do que os sonhados em sua filosofia </pre><br>  Para alguns, a solu√ß√£o para esses "criptogramas" √© um hobby fascinante. <br><br>  A id√©ia da an√°lise de frequ√™ncia √© mais fundamental do que parece √† primeira vista.  E isso se aplica a cifras muito mais complexas.  Ao longo da hist√≥ria, v√°rios projetos de cifras tentaram resistir a esse ataque usando a "substitui√ß√£o polialfab√©tica".  Aqui, no processo de criptografia, a tabela de substitui√ß√£o de letras muda de maneiras complexas, mas previs√≠veis, que dependem da chave.  Todas essas cifras j√° foram consideradas dif√≠ceis de decifrar;  e, no entanto, uma an√°lise de frequ√™ncia modesta acabou derrotando todos eles. <br><br>  A cifra polialfab√©tica mais ambiciosa da hist√≥ria, e provavelmente a mais famosa, foi a cifra Enigma na Segunda Guerra Mundial.  Era relativamente complexo em compara√ß√£o com seus antecessores, mas como resultado de um trabalho longo e √°rduo, os criptoanalistas brit√¢nicos o decifraram usando an√°lise de frequ√™ncia.  Obviamente, eles n√£o conseguiram desenvolver um ataque elegante, como mostrado acima;  eles tiveram que comparar pares conhecidos de textos abertos e criptografados (o chamado "ataque de texto sem formata√ß√£o") e at√© mesmo instigar os usu√°rios do Enigma a criptografar determinadas mensagens com a an√°lise do resultado ("ataque baseado no texto sem formata√ß√£o selecionado").  Mas isso n√£o facilitou o destino dos ex√©rcitos derrotados de inimigos e submarinos afundados. <br><br>  Ap√≥s esse triunfo, a an√°lise de frequ√™ncia desapareceu da hist√≥ria da criptoan√°lise.  As cifras da era digital moderna s√£o projetadas para trabalhar com bits, n√£o com letras.  Mais importante, essas cifras s√£o projetadas com uma compreens√£o sombria do que mais tarde ficou conhecido como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">lei de Schneier</a> : qualquer pessoa pode criar um algoritmo de criptografia que ele pr√≥prio n√£o pode decifrar.  N√£o basta que o sistema de criptografia <i>pare√ßa</i> complicado: para provar seu valor, ele deve passar por uma an√°lise de seguran√ßa implac√°vel de muitos analistas de criptografia que far√£o todo o poss√≠vel para decifrar a cifra. <br><br><h2>  C√°lculos preliminares </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/f13/0a7/a34/f130a7a3431e084d1248dd428b013daa.gif" align="left" width="260">  Tome a cidade hipot√©tica de Precom Heights com uma popula√ß√£o de 200.000 habitantes.  Em cada casa da cidade, existem objetos de valor em m√©dia US $ 30.000, mas n√£o mais de US $ 50.000. O mercado de seguran√ßa em Precom foi monopolizado pela ACME Industries, que produz as lend√°rias fechaduras da classe Coyote (tm).  Segundo a an√°lise de especialistas, apenas uma m√°quina hipot√©tica muito complexa pode quebrar uma trava da classe Coyote, cuja cria√ß√£o requer cerca de cinco anos e investimento de US $ 50.000.  A cidade √© segura? <br><br>  Provavelmente n√£o.  No final, um criminoso bastante ambicioso aparecer√°.  Ele argumentar√° assim: ‚ÄúSim, incorrerei em grandes custos iniciais.  Cinco anos de expectativa do paciente e US $ 50.000, mas, depois de terminar o trabalho, terei acesso a <i>toda a riqueza desta cidade</i> .  Se eu jogar minhas cartas corretamente, esse investimento ser√° recompensado muitas vezes. ‚Äù <br><br>  Da mesma forma, na criptografia.  Os ataques contra uma cifra espec√≠fica est√£o sujeitos a uma an√°lise implac√°vel dos custos e benef√≠cios.  Se a propor√ß√£o for favor√°vel, o ataque n√£o ocorrer√°.  Mas os ataques que atacam imediatamente muitas v√≠timas em potencial quase sempre valem a pena e, nesse caso, a melhor pr√°tica de design √© assumir que eles come√ßaram desde o primeiro dia.  Temos essencialmente uma vers√£o criptogr√°fica da lei de Murphy: "Tudo o que pode realmente quebrar o sistema ir√° quebr√°-lo". <br><br>  O exemplo mais simples de um sistema de criptografia vulner√°vel a um ataque com c√°lculos preliminares √© uma cifra com um algoritmo constante sem o uso de uma chave.  Esse foi o caso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">da cifra de C√©sar</a> , que simplesmente desloca cada letra do alfabeto tr√™s letras para frente (a tabela est√° em loop, de modo que a √∫ltima letra do alfabeto √© criptografada com a terceira).  Aqui, novamente, o princ√≠pio de Kerchhoffs se manifesta: assim que o sistema √© invadido, ele √© invadido para sempre. <br><br>  O conceito √© simples.  Mesmo um desenvolvedor iniciante de sistema de criptografia provavelmente est√° ciente da amea√ßa e se prepara adequadamente.  Se voc√™ observar a evolu√ß√£o da criptografia, esses ataques n√£o s√£o adequados para a maioria das cifras, come√ßando com as primeiras vers√µes aprimoradas da cifra de C√©sar, at√© o decl√≠nio das cifras polialfab√©ticas.  Tais ataques retornaram apenas com o advento da era moderna da criptografia. <br><br>  Esse retorno √© devido a dois fatores.  Primeiramente, finalmente, surgiram sistemas de criptografia bastante complexos, onde a possibilidade de explora√ß√£o ap√≥s hackers n√£o era √≥bvia.  Em segundo lugar, a criptografia √© t√£o difundida que milh√µes de leigos tomam decis√µes todos os dias sobre onde e quais partes da criptografia ser√£o reutilizadas.  Demorou algum tempo at√© que os especialistas percebessem os riscos e disparassem o alarme. <br><br>  Lembre-se do ataque com pr√©-computa√ß√µes: no final do artigo, consideraremos dois exemplos criptogr√°ficos da vida real, onde desempenhou um papel importante. <br><br><h2>  Interpola√ß√£o </h2><br>  Aqui est√° o famoso detetive Sherlock Holmes, realizando um ataque com interpola√ß√£o ao infeliz Dr. Watson: <br><br><blockquote>  Eu imediatamente adivinhei que voc√™ veio do Afeganist√£o ... Meus pensamentos eram os seguintes: ‚ÄúEssa pessoa √© um m√©dico por tipo, mas tem uma influ√™ncia militar.  Ent√£o, um m√©dico militar.  Acabara de chegar dos tr√≥picos - seu rosto est√° escuro, mas esse n√£o √© um tom natural de sua pele, j√° que seus pulsos s√£o muito mais brancos.  O rosto emaciado, obviamente, sofreu muito e sofreu a doen√ßa.  Ele foi ferido na m√£o esquerda - ele a mant√©m im√≥vel e um pouco artificial.  Onde, sob os tr√≥picos, um m√©dico brit√¢nico poderia sofrer dificuldades e se machucar?  Claro, no Afeganist√£o. ‚Äù  Toda a linha de pensamento n√£o levou um segundo.  E ent√£o eu disse que voc√™ veio do Afeganist√£o e ficou surpreso. </blockquote><br>  De cada evid√™ncia individualmente, Holmes poderia extrair muito pouca informa√ß√£o.  Ele poderia chegar a sua conclus√£o apenas examinando-os todos juntos.  O ataque de interpola√ß√£o funciona da mesma forma, explorando os pares conhecidos de textos abertos e criptografados obtidos como resultado da aplica√ß√£o da mesma chave.  Observa√ß√µes separadas s√£o extra√≠das de cada par, o que nos permite tirar uma conclus√£o geral sobre a chave.  Todas essas conclus√µes s√£o vagas e in√∫teis at√© que subitamente atinjam uma massa cr√≠tica e levem √† √∫nica conclus√£o poss√≠vel: n√£o importa qu√£o incr√≠vel seja, deve ser verdade.  Depois disso, a chave √© aberta ou o processo de descriptografia se torna t√£o maduro que pode ser duplicado. <br><br>  Ilustramos com um exemplo simples como a interpola√ß√£o funciona.  Suponha que desejemos ler o di√°rio pessoal de nosso inimigo, Bob.  Ele criptografa todos os n√∫meros em seu di√°rio com a ajuda de um sistema criptogr√°fico simples, sobre o qual aprendeu com um an√∫ncio na revista "Mockery of cryptography".  O sistema funciona da seguinte maneira: Bob seleciona dois n√∫meros que ele gosta: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.057ex" viewBox="0 -780.1 1051.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMATHI-4D" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> M </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> N </script>  .  A partir de agora, para criptografar qualquer n√∫mero <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> x </script>  ele calcula <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">x</span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.676ex" height="2.178ex" viewBox="0 -780.1 3735.4 937.7" role="img" focusable="false" style="vertical-align: -0.366ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMATHI-78" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMAIN-2B" x="1846" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMATHI-4E" x="2846" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> Mx + N </script>  .  Por exemplo, se Bob escolheu <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-22"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">M</span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-25">3</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.703ex" height="2.057ex" viewBox="0 -780.1 2886.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMAIN-3D" x="1329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/462437/&amp;usg=ALkJrhjt4w1f_3xp9CF0kRsLM70_2Y0S3A#MJMAIN-33" x="2385" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> M = 3 </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">N</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-29">4</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> N = 4 </script>  ent√£o a figura <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-30"><span class="MJXp-mn" id="MJXp-Span-31">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> 2 </script>  criptografado como <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-32"><span class="MJXp-mn" id="MJXp-Span-33">3</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mn" id="MJXp-Span-35">2</span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-37">4</span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-39">10</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> 3 * 2 + 4 = 10 </script>  . <br><br>  Suponha que tenhamos notado em 28 de dezembro que Bob estava co√ßando algo em seu di√°rio.  Quando ele termina, n√≥s o pegamos em sil√™ncio e vemos a √∫ltima entrada: <br><br><blockquote>  Data: <code>235/520</code> <br><br>  Caro Di√°rio, <br><br>  Hoje foi um bom dia.  Ap√≥s <code>64</code> dias, tenho um encontro com Alice, que mora no apartamento <code>843</code> .  Eu realmente acho que ela pode ter <code>26</code> ! </blockquote><br>  Como pretendemos seguir seriamente Bob em seu encontro (nesse cen√°rio, temos 15 anos), √© fundamental descobrir a data e o endere√ßo de Alice.  Felizmente, percebemos que o sistema de criptografia de Bob √© vulner√°vel a um ataque de interpola√ß√£o.  Podemos n√£o saber <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> M </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-42"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> N </script>  , mas sabemos a data de hoje, por isso temos dois pares de "texto simples - texto cifrado".  Ou seja, sabemos que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-44"><span class="MJXp-mn" id="MJXp-Span-45">12</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> 12 </script>  criptografado em <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-46"><span class="MJXp-mn" id="MJXp-Span-47">235</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> 235 </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-48"><span class="MJXp-mn" id="MJXp-Span-49">27</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> 27 </script>  - em <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-50"><span class="MJXp-mn" id="MJXp-Span-51">520</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> 520 </script>  .  O que escrevemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-52"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">M</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mn" id="MJXp-Span-55">12</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">N</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-59">235</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> M ‚àó 12 + N = 235 </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-60"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">M</span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mn" id="MJXp-Span-63">27</span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">N</span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-67">520</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-17"> M ‚àó 27 + N = 520 </script></p><br>  Desde os 15 anos, j√° conhecemos o sistema de duas equa√ß√µes com duas inc√≥gnitas, o que nessa situa√ß√£o √© suficiente para encontrar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> M </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> N </script>  sem problemas.  Cada par "texto sem formata√ß√£o-texto cifrado" imp√µe uma restri√ß√£o √† chave de Bob, e duas restri√ß√µes juntas s√£o suficientes para restaurar completamente a chave.  No nosso exemplo, a resposta <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">M</span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-75">19</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> M = 19 </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">N</span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-79">7</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> N = 7 </script>  <font color="gray">(em</font> <math> </math><font color="gray"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mn" id="MJXp-Span-81">19</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">x</span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-84">7</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-86">26</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> 19x + 7 = 26 </script></font> <math> </math><font color="gray"><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-87"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">x</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-90">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> x = 1 </script></font>   <font color="gray">, ent√£o <code>26</code> no di√°rio corresponde √† palavra 'aquele', ou seja, ‚Äúo mesmo‚Äù - aprox.</font>  <font color="gray">por.)</font> . <br><br>  Os ataques de interpola√ß√£o, √© claro, n√£o se limitam a exemplos t√£o simples.  Cada sistema de criptografia, que se resume a um objeto matem√°tico bem conhecido e a uma lista de par√¢metros, corre o risco de um ataque de interpola√ß√£o - quanto mais compreens√≠vel o objeto, maior o risco. <br><br>  Os iniciantes costumam reclamar que a criptografia √© "a arte de projetar o mais feio poss√≠vel".  Os ataques de interpola√ß√£o provavelmente s√£o os principais culpados.  Bob pode usar um design matem√°tico elegante ou manter a confidencialidade de uma data com Alice - mas, infelizmente, geralmente voc√™ n√£o pode obter os dois.  Isso ficar√° muito claro quando finalmente passarmos ao t√≥pico de criptografia de chave p√∫blica. <br><br><h2>  Protocolo cruzado / downgrade </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/9d5/4b0/0f9/9d54b00f9d9424b1d12006822ca1f727.jpg" align="left" width="190">  No filme ‚ÄúA Ilus√£o da Decep√ß√£o‚Äù (2013), um grupo de ilusionistas tenta enganar todo o estado do magnata corrupto Arthur Tressler, do seguro.  Para obter acesso √† conta banc√°ria de Arthur, os ilusionistas devem fornecer seu nome de usu√°rio e senha ou faz√™-lo aparecer pessoalmente no banco e participar do esquema. <br><br>  Ambas as op√ß√µes s√£o muito dif√≠ceis;  os caras est√£o acostumados a se apresentar no palco, e n√£o a participar de opera√ß√µes de intelig√™ncia.  Portanto, eles escolhem a terceira op√ß√£o: o c√∫mplice liga para o banco e finge ser Arthur.  O banco faz v√°rias perguntas para verifica√ß√£o da identidade, como o nome do tio e o nome do primeiro animal de estima√ß√£o;  nossos her√≥is <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">recebem com facilidade essas informa√ß√µes de Arthur com a ajuda de engenharia social inteligente</a> .  A partir de agora, a excelente seguran√ßa da senha n√£o importa mais. <br><br>  (De acordo com uma lenda da cidade, que verificamos e confirmamos pessoalmente, o cript√≥grafo Eli Behem encontrou uma caixa de banco que insistia em fazer uma pergunta secreta. Quando o caixa perguntou o nome da av√≥ de sua m√£e, Beeham come√ßou a ditar: "Capital X, pequena, tr√™s ... "). <br><br>  √â o mesmo na criptografia, se dois protocolos criptogr√°ficos forem usados ‚Äã‚Äãem paralelo para proteger o mesmo ativo, enquanto um √© muito mais fraco que o outro.  O sistema resultante se torna vulner√°vel a um ataque de protocolo cruzado quando um protocolo mais fraco √© atacado para chegar ao pr√™mio sem tocar em um mais forte. <br><br>  Em alguns casos complexos, n√£o basta entrar em contato com o servidor usando um protocolo mais fraco, e √© necess√°ria a participa√ß√£o involunt√°ria de um cliente leg√≠timo.  Isso pode ser organizado usando o chamado ataque de downgrade.  Para entender esse ataque, suponha que nossos ilusionistas tenham uma tarefa mais dif√≠cil do que no filme.  Suponha que um funcion√°rio do banco (caixa) e Arthur tivessem algumas circunst√¢ncias imprevistas, como resultado do qual houve esse di√°logo: <br><br><blockquote>  <b>Ladr√£o:</b> Al√¥?  Este √© Arthur Tressler.  Gostaria de redefinir minha senha. <br><br>  <b>Caixa:</b> √ìtimo.  D√™ uma olhada no seu livro de c√≥digos secreto pessoal, p√°gina 28, palavra 3. Todas as seguintes mensagens ser√£o criptografadas com essa palavra em particular como chave.  PQJGH.  LOTJNAM PGGY MXVRL ZZLQ SRIU HHNMLPPPV ... <br><br>  <b>Cracker:</b> Ei, ei, espere um minuto.  Isso √© realmente necess√°rio?  N√£o podemos simplesmente conversar como pessoas normais? <br><br>  <b>Caixa:</b> Eu n√£o aconselho fazer isso. <br><br>  <b>Cracker:</b> Eu apenas ... escute, eu tive um dia ruim, ok?  Eu sou um cliente VIP e n√£o estou com vontade de me aprofundar nesses est√∫pidos livros de c√≥digos. <br><br>  <b>Caixa:</b> Bom.  Se voc√™ insiste, Sr. Tressler.  O que voce quer <br><br>  <b>Cracker:</b> Por favor, gostaria de transferir todo o meu dinheiro para o Fundo Nacional de V√≠timas Arthur Tressler. <br><br>  (Pausa) <br><br>  <b>Caixa:</b> Ok.  Forne√ßa seu c√≥digo PIN para grandes transa√ß√µes. <br><br>  <b>Cracker:</b> Meu o qu√™? <br><br>  <b>Caixa: a</b> seu pedido pessoal, transa√ß√µes desse tamanho requerem um PIN para grandes transa√ß√µes.  Este c√≥digo foi fornecido a voc√™ ao abrir uma conta. <br><br>  <b>Biscoito:</b> ... eu o perdi.  Isso √© realmente necess√°rio?  Voc√™ n√£o pode simplesmente aprovar o acordo? <br><br>  <b>Caixa:</b> Nenhum.  Sinto muito, Sr. Tressler.  Novamente, esta √© a medida de seguran√ßa que voc√™ solicitou.  Se desejar, podemos enviar um novo c√≥digo PIN para a caixa de correio. </blockquote><br>  Nossos her√≥is adiam a opera√ß√£o.  Eles ouvem v√°rias transa√ß√µes importantes da Tressler, esperando ouvir um c√≥digo PIN;  mas cada vez que a conversa se transforma em uma tagarelice criptografada antes que algo interessante soe l√°.  Finalmente, um dia o plano √© executado.  Eles esperam pacientemente o momento em que Tressler deve concluir uma grande transa√ß√£o por telefone, ele se conecta √† linha e ent√£o ... <br><br><blockquote>  <b>Thressler:</b> Ol√°.  Gostaria de emitir uma transa√ß√£o remota, por favor. <br><br>  <b>Caixa:</b> √ìtimo.  D√™ uma olhada no seu livro de c√≥digos secretos pessoais, na p√°gina ... <br><br>  (O cracker pressiona o bot√£o; a voz do caixa se transforma em um ru√≠do inaud√≠vel). <br><br>  <b>Caixa:</b> - # @ $ # @ $ # * @ $$ @ # * ser√£o criptografados com esta palavra como chave.  AAAYRR PLRQRZ MMNJK LOJBAN ... <br><br>  <b>Thressler:</b> Desculpe, eu n√£o entendi direito.  Mais uma vez  Qual p√°gina?  Qual √© a palavra? <br><br>  <b>Caixa:</b> Esta √© a p√°gina @ # $ @ # * $) # * # @ () # @ $ (# @ * $ (# @ *. <br><br>  <b>Thressler:</b> O que? <br><br>  <b>Caixa:</b> Palavra n√∫mero vinte @ $ # @ $ #% # $. <br><br>  <b>Thressler:</b> S√©rio!  J√° chega!  Voc√™ e seu protocolo de seguran√ßa s√£o algum tipo de circo.  Eu sei que voc√™ pode apenas falar normalmente comigo. <br><br>  <b>Caixa:</b> Eu n√£o aconselho ... <br><br>  <b>Thressler:</b> E eu n√£o aconselho voc√™ a perder meu tempo.  N√£o quero ouvir mais sobre isso at√© resolver os problemas com minha linha telef√¥nica.  Podemos organizar este acordo ou n√£o? <br><br>  <b>Caixa:</b> ... sim.  Bom  O que voce quer <br><br>  <b>Thressler:</b> Gostaria de transferir US $ 20.000 para a Lord Business Investments, n√∫mero da conta ... <br><br>  <b>Caixa:</b> S√≥ um momento, por favor.  Este √© um grande neg√≥cio.  Forne√ßa seu c√≥digo PIN para grandes transa√ß√µes. <br><br>  <b>Thressler:</b> O que?  Ah, com certeza.  1234 </blockquote><br>  Aqui est√° o ataque de queda.  O protocolo mais fraco, "apenas fale diretamente", foi concebido como <i>uma op√ß√£o</i> em caso de emerg√™ncia.  E ainda estamos aqui. <br><br>  Voc√™ pode fazer a pergunta de quem, em s√£ consci√™ncia, projetar√° um sistema real como "seguro at√© que seja solicitado o contr√°rio", descrito acima.  Mas, assim como um banco fict√≠cio corre riscos para salvar clientes que n√£o gostam de criptografia, tamb√©m os sistemas como um todo costumam atender a requisitos indiferentes ou at√© hostis √† seguran√ßa. <br><br>  Essa √© exatamente a hist√≥ria que aconteceu com o SSLv2 em 1995.  O governo dos EUA h√° muito tempo come√ßou a considerar a criptografia como uma arma mais bem mantida longe de inimigos externos e internos.  Os fragmentos de c√≥digo foram aprovados individualmente para exporta√ß√£o dos Estados Unidos, geralmente sujeitos a um enfraquecimento intencional do algoritmo.  O Netscape, o desenvolvedor do navegador mais popular, o Netscape Navigator, recebeu permiss√£o SSLv2 apenas com uma chave RSA inicialmente vulner√°vel de 512 bits (e 40 bits para RC4). <br><br>  No final do mil√™nio, as regras foram suavizadas e o acesso √† criptografia moderna tornou-se amplamente dispon√≠vel.  No entanto, por muitos anos, clientes e servidores suportam criptografia de "exporta√ß√£o" enfraquecida devido √† mesma in√©rcia que mant√©m o suporte a qualquer sistema desatualizado.  Os clientes pensaram que poderiam encontrar um servidor que n√£o suporta mais nada.  Servidores fizeram o mesmo.  Obviamente, o SSL determina que clientes e servidores nunca devem usar um protocolo fraco quando o melhor estiver dispon√≠vel.  Mas a mesma premissa era v√°lida para Tressler e seu banco. <br><br>  Essa teoria encontrou aplica√ß√£o em dois ataques de alto perfil que abalaram a seguran√ßa do protocolo SSL, um ap√≥s o outro em 2015, ambos descobertos por pesquisadores da Microsoft e do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">INRIA</a> .  Primeiro, em fevereiro, os detalhes do ataque FREAK foram revelados e, tr√™s meses depois, outro ataque semelhante chamado Logjam, que discutiremos em mais detalhes quando abordarmos ataques √† criptografia de chave p√∫blica. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3cb/8b2/9d4/3cb8b29d407d2a6e563d81f829bd1e20.png" align="left" width="250">  Vulnerabilidade O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">FREAK</a> (tamb√©m conhecido como "Smack TLS") apareceu quando os pesquisadores analisaram a implementa√ß√£o do TLS cliente / servidor e encontraram um erro curioso.  Nessas implementa√ß√µes, se o cliente nem solicitar uma criptografia de exporta√ß√£o fraca, mas o servidor ainda responder com essas chaves, o cliente diz "OK" e alterna para um conjunto fraco de cifras. <br><br>  Naquela √©poca, todos consideravam a criptografia de exporta√ß√£o desatualizada e proibida de usar, ent√£o o ataque foi um choque real e afetou muitos dom√≠nios importantes, incluindo os sites da Casa Branca, o escrit√≥rio de impostos dos EUA e a NSA.  Pior ainda, muitos servidores vulner√°veis ‚Äã‚Äãotimizavam o desempenho reutilizando as mesmas chaves em vez de criar novas para cada sess√£o.  Isso possibilitou, ap√≥s a redu√ß√£o do protocolo, realizar um ataque com pr√©-computa√ß√£o: hackear uma chave permaneceu relativamente caro (US $ 100 e 12 horas no momento da publica√ß√£o), mas o custo pr√°tico de atacar a conex√£o diminuiu significativamente.  Basta pegar a chave do servidor uma vez e decifrar as cifras para todas as conex√µes subseq√ºentes a partir de agora. <br><br><h4>  E antes de prosseguir, precisamos mencionar um ataque avan√ßado ... </h4><br><h2>  Ataque Oracle </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/576/320/dcc/576320dcc95c1752ebd1ee8e3759d701.png" align="left" width="175">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Moxie Marlinspike √©</a> mais conhecido como o pai do cross-platform Signal messenger;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mas, pessoalmente, gostamos de uma de suas inova√ß√µes menos conhecidas - o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">princ√≠pio da destrui√ß√£o criptogr√°fica</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Princ√≠pio da Perdi√ß√£o Criptogr√°fica). Parafraseando um pouco, podemos dizer o seguinte: "Se o protocolo executar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qualquer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> opera√ß√£o criptogr√°fica em uma mensagem de uma fonte potencialmente maliciosa e se comportar de maneira diferente dependendo do resultado, ele estar√° condenado". Ou de uma forma mais n√≠tida: "N√£o pegue as informa√ß√µes do inimigo para processamento e, se necess√°rio, pelo menos n√£o mostre o resultado". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deixe de lado estouros de buffer, inje√ß√µes de instru√ß√µes e similares; eles est√£o al√©m do escopo desta discuss√£o. A viola√ß√£o do "princ√≠pio da desgra√ßa" leva a uma s√©ria invas√£o da criptografia devido ao fato de o protocolo se comportar exatamente como deveria.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por exemplo, adote um design fict√≠cio com uma cifra de substitui√ß√£o vulner√°vel e demonstre um poss√≠vel ataque. Embora j√° tenhamos visto um ataque a uma cifra de substitui√ß√£o usando an√°lise de frequ√™ncia, essa n√£o √© apenas ‚Äúoutra maneira de quebrar a mesma cifra‚Äù. Por outro lado, os ataques oraculares s√£o uma inven√ß√£o muito mais moderna, aplic√°vel a muitas situa√ß√µes em que a an√°lise de frequ√™ncia falha, e veremos uma demonstra√ß√£o disso na pr√≥xima se√ß√£o. Aqui, uma cifra simples √© escolhida apenas para tornar o exemplo mais claro.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ent√£o, Alice e Bob se comunicam usando uma cifra de substitui√ß√£o simples usando uma chave conhecida apenas por eles. Eles s√£o muito rigorosos quanto ao tamanho das mensagens: o tamanho √© exatamente de 20 caracteres. Portanto, eles concordaram que, se algu√©m quiser enviar uma mensagem mais curta, dever√° adicionar algum texto fict√≠cio ao final da mensagem para que ele tenha exatamente 20 caracteres. Depois de alguma discuss√£o, eles decidiram que s√≥ aceitaria o seguinte texto fict√≠cio: </font></font><code>a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>bb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>ccc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>dddd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, etc. Assim, o conhecido texto fict√≠cio de qualquer comprimento desejado ...</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando Alice ou Bob recebem a mensagem, eles primeiro verificam se a mensagem tem o tamanho correto (20 caracteres) e o sufixo √© o texto fict√≠cio correto. Se n√£o for esse o caso, eles responder√£o com a mensagem de erro correspondente. Se o tamanho do texto e o texto fict√≠cio estiverem em ordem, o destinat√°rio l√™ a pr√≥pria mensagem e envia uma resposta criptografada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durante o ataque, o atacante finge ser Bob e envia mensagens falsas para Alice. Mensagens - absurdo completo - o atacante n√£o possui uma chave e, portanto, n√£o pode falsificar uma mensagem significativa. Mas como o protocolo viola o princ√≠pio da destrui√ß√£o, um invasor ainda pode prender Alice, para que ela revele informa√ß√µes sobre a chave, como mostrado abaixo.</font></font><br><br><blockquote> <b>:</b> <code>PREWF ZHJKL MMMN. LA</code> <br><br> <b>:</b>   . <br><br> <b>:</b> <code>PREWF ZHJKL MMMN. LB</code> <br><br> <b>:</b>   . <br><br> <b>:</b> <code>PREWF ZHJKL MMMN. LC</code> <br><br> <b>:</b> <code>ILCT? TLCT RUWO PUT KCAW CPS OWPOW!</code> </blockquote><br> <i>   ,     ,  ,   <code>C</code>   <code>a</code> ,     .</i> <br><br><blockquote> <b>:</b> <code>REWF ZHJKL MMMN. LAA</code> <br><br> <b>:</b>   . <br><br> <b>:</b> <code>REWF ZHJKL MMMN. LBB</code> <br><br> <b>:</b>   . <br><br> <i>  ‚Ä¶</i> <br><br> <b>:</b> <code>REWF ZHJKL MMMN. LGG</code> <br><br> <b>:</b>   . <br><br> <b>:</b> <code>REWF ZHJKL MMMN. LHH</code> <br><br> <b>:</b> <code>TLQO JWCRO FQAW SUY LCR C OWQXYJW. IW PWWR TU TCFA CHUYT TLQO JWFCTQUPOLQZ.</code> </blockquote><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais uma vez, o cracker n√£o faz ideia do que Alice acabou de dizer, mas observa que H deve corresponder a b porque Alice aceitou o texto fict√≠cio.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> E assim por diante, at√© o atacante descobrir o significado de cada personagem. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä primeira vista, o m√©todo se assemelha a um ataque com base no texto simples selecionado. No final, o atacante pega textos cifrados e o servidor os processa obedientemente. A principal diferen√ßa que torna esses ataques vi√°veis ‚Äã‚Äãno mundo real √© que o invasor n√£o precisa acessar a descriptografia real - apenas a resposta do servidor, mesmo t√£o inofensiva quanto o "Texto fict√≠cio errado", √© suficiente.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Embora esse ataque em particular seja instrutivo, n√£o se deve ficar muito focado nas especificidades do esquema de "texto fict√≠cio", no sistema de criptografia espec√≠fico usado ou na seq√º√™ncia exata de mensagens enviadas pelo invasor. A id√©ia principal √© como Alice reage de maneira diferente com base nas propriedades do texto sem formata√ß√£o e faz isso sem verificar se o texto criptografado correspondente √© realmente recebido de uma parte confi√°vel. Assim, Alice permite que um invasor extraia informa√ß√µes secretas de suas respostas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H√° muito o que mudar nesse cen√°rio. Os personagens aos quais Alice reage, ou a pr√≥pria diferen√ßa de comportamento, ou mesmo o sistema de criptografia usado. Mas o princ√≠pio permanecer√° o mesmo, e o ataque como um todo permanecer√° vi√°vel de uma forma ou de outra. A implementa√ß√£o b√°sica desse ataque ajudou a detectar v√°rios erros de seguran√ßa que abordaremos em breve; mas primeiro algumas li√ß√µes te√≥ricas devem ser aprendidas. Como usar esse "roteiro de Alice" fict√≠cio em um ataque capaz de trabalhar em uma cifra moderna moderna? Isso √© poss√≠vel, mesmo em teoria?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em 1998, o cript√≥grafo su√≠√ßo Daniel Bleichenbacher respondeu afirmativamente a essa pergunta. Ele demonstrou um ataque do oracle em um sistema de criptografia de chave p√∫blica RSA amplamente usado usando um esquema de mensagens espec√≠fico. Em algumas implementa√ß√µes de RSA, o servidor responde com diferentes mensagens de erro, dependendo se o texto sem formata√ß√£o corresponde ou n√£o ao esquema; isso foi suficiente para lan√ßar um ataque.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quatro anos depois, em 2002, o cript√≥grafo franc√™s Serge Vaudenay demonstrou um ataque do or√°culo, quase id√™ntico ao descrito no script de Alice acima - exceto que, em vez de uma cifra fict√≠cia, ele quebrou toda uma classe respeit√°vel de cifras modernas que as pessoas realmente use. Em particular, o ataque de Wodene tem como alvo cifras com um tamanho fixo de entrada ("cifras de bloco") quando usadas no chamado "modo de criptografia CBC" e com um certo esquema de preenchimento popular, basicamente equivalente ao do script de Alice. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tamb√©m em 2002, o cript√≥grafo americano John Kelsey, co-autor de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Twofish</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- prop√¥s v√°rios ataques oracle a sistemas que compactam mensagens e depois as criptografam. </font><font style="vertical-align: inherit;">O mais not√°vel entre eles foi o ataque, que usou o fato de que muitas vezes √© poss√≠vel derivar o tamanho original do texto sem formata√ß√£o do comprimento do texto cifrado. </font><font style="vertical-align: inherit;">Em teoria, isso permite um ataque do or√°culo que restaura partes do texto simples original. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A seguir, fornecemos uma descri√ß√£o mais detalhada dos ataques de Woden e Kelsey (forneceremos uma descri√ß√£o mais detalhada do ataque de Bleichenbacher quando passarmos para ataques √† criptografia de chave p√∫blica). </font><font style="vertical-align: inherit;">Apesar de todos os nossos esfor√ßos, o texto se torna um pouco t√©cnico; </font><font style="vertical-align: inherit;">portanto, se as op√ß√µes acima forem suficientes, pule as pr√≥ximas duas se√ß√µes.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ataque de Woden </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para entender o ataque Woden, primeiro voc√™ precisa falar um pouco mais sobre as cifras de bloco e os modos de criptografia. Uma ‚Äúcifra de bloco‚Äù √©, como j√° mencionado, uma cifra que aceita uma chave e insere um determinado comprimento fixo (‚Äúcomprimento do bloco‚Äù) e produz um bloco criptografado do mesmo comprimento. As cifras de bloco s√£o amplamente utilizadas e s√£o consideradas relativamente seguras. O DES agora aposentado, considerado a primeira cifra moderna, era irregular. Como mencionado acima, o mesmo se aplica √† AES, hoje amplamente utilizada.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infelizmente, as cifras de bloco t√™m uma fraqueza evidente. Um tamanho de bloco t√≠pico √© de 128 bits ou 16 caracteres. Obviamente, a criptografia moderna exige o trabalho com dados de entrada maiores, e √© a√≠ que os modos de criptografia aparecem. O modo de criptografia √© essencialmente um hack: √© uma maneira de aplicar de alguma forma uma cifra de bloco, que aceita dados de entrada de apenas um determinado tamanho, para inserir dados de comprimento arbitr√°rio. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O ataque Woden est√° focado no popular modo de opera√ß√£o CBC (Cipher Block Chaining, modo de acoplamento de bloco de texto cifrado). O ataque v√™ a cifra do bloco base como uma caixa preta m√°gica inexpugn√°vel e ignora completamente sua seguran√ßa. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui est√° um diagrama que mostra como o modo CBC funciona:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f05/257/c5f/f05257c5f1c94c3ee67bf81253166f8c.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b6/61c/1ec/1b661c1ec239b4400dcb7df7589ed8ea.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O sinal de mais circulado significa a opera√ß√£o XOR (OU exclusivo). </font><font style="vertical-align: inherit;">Por exemplo, o segundo bloco de texto cifrado √© recebido:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Executando uma opera√ß√£o XOR no segundo bloco de texto sem formata√ß√£o com o primeiro bloco de texto cifrado. </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Criptografe o bloco recebido usando uma cifra de bloco usando uma chave. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Como o CBC usa a opera√ß√£o bin√°ria do XOR de maneira t√£o intensa, vamos dedicar um momento para recuperar algumas de suas propriedades: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Idempot√™ncia: </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mn" id="MJXp-Span-94"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24">A \oplus 0 = A</script><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comutatividade: </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B </font></font></span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B </font></font></span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25">A \oplus B = B \oplus A</script><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Associatividade: </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mo" id="MJXp-Span-108" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B </font></font></span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B </font></font></span><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26">A \oplus (B \oplus C) = (A \oplus B) \oplus C</script><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Auto-reversibilidade: </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-126"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27">A \oplus A = 0</script><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Byte-byte: Byte n de </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-127"><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B </font></font></span><span class="MJXp-mo" id="MJXp-Span-132" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = (byte n de</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28">(A \oplus B)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> A </script>  ) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-135"><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (byte n de</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30">\oplus</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> B </script>  ) </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Normalmente, essas propriedades implicam que, se tivermos uma equa√ß√£o que inclua opera√ß√µes XOR e uma desconhecida, ela poder√° ser resolvida. </font><font style="vertical-align: inherit;">Por exemplo, se sabemos que</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com desconhecido</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32">A \oplus X = B</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e famoso</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33">X</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> A </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ent√£o podemos confiar nas propriedades acima para resolver a equa√ß√£o de</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> B </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36">X</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aplicando XOR em ambos os lados da equa√ß√£o com </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> temos</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> A </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38">X = A \oplus B</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em um momento, tudo isso se tornar√° muito relevante. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Existem duas pequenas diferen√ßas e uma grande diferen√ßa entre nosso script de Alice e o ataque de Woden. </font><font style="vertical-align: inherit;">Dois menores:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No cen√°rio de Alice esperar que a extremidade aberta no texto </font></font><code>a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>bb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>ccc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e assim por diante. </font><font style="vertical-align: inherit;">Em um ataque de Woden, a v√≠tima espera que o texto simples termine N vezes com o byte N (ou seja, hexadecimal 01 ou 02 02 ou 03 03 03 e assim por diante). </font><font style="vertical-align: inherit;">Esta √© uma diferen√ßa puramente cosm√©tica.</font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No roteiro de Alice, era f√°cil dizer se Alice havia recebido a mensagem em resposta a "Texto fict√≠cio errado". </font><font style="vertical-align: inherit;">No ataque de Woden, s√£o necess√°rias mais an√°lises e uma implementa√ß√£o precisa do lado da v√≠tima √© importante; </font><font style="vertical-align: inherit;">mas, por brevidade, tomamos como certo que essa an√°lise ainda √© poss√≠vel.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A principal diferen√ßa: </font></font><br><br><ul><li>         ,          (   ), ,  .             . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essa √© a principal diferen√ßa - a √∫ltima pe√ßa do quebra-cabe√ßa para entender o ataque de Woden, ent√£o vamos pensar por um momento sobre o porqu√™ e como voc√™ pode organizar um ataque de or√°culo na CBC. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suponha que um texto cifrado na CBC de 247 blocos seja fornecido e desejemos descriptograf√°-lo. </font><font style="vertical-align: inherit;">Podemos enviar mensagens falsas para o servidor, como antes, poder√≠amos enviar mensagens falsas para Alice. </font><font style="vertical-align: inherit;">O servidor descriptografar√° as mensagens para n√≥s, mas n√£o exibir√° a descriptografia - em vez disso, como no caso de Alice, o servidor reportar√° apenas um pouco de informa√ß√£o: em texto simples, o preenchimento √© v√°lido ou n√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observe que no cen√°rio de Alice, tivemos os seguintes relacionamentos:</font></font><br><br><p><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-161"><span class="MJXp-mtext" id="MJXp-Span-162"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIMPLE_SUBSTITUTION </font></font></span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-164"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">texto cifrado </font></font></span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mtext" id="MJXp-Span-166"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chave </font></font></span><span class="MJXp-mo" id="MJXp-Span-167" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mtext" id="MJXp-Span-169"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">texto sem formata√ß√£o</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex; mode=display" id="MathJax-Element-39">\text{SIMPLE_SUBSTITUTION}(\text{ciphertext},\text{key}) = \text{plaintext}</script> </math></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chamamos isso de equa√ß√£o de Alice. </font><font style="vertical-align: inherit;">N√≥s controlamos o texto cifrado; </font><font style="vertical-align: inherit;">o servidor (Alice) mesclou informa√ß√µes vagas sobre o texto simples recebido; </font><font style="vertical-align: inherit;">e isso nos permitiu exibir informa√ß√µes sobre o √∫ltimo fator - a chave. </font><font style="vertical-align: inherit;">Por analogia, se conseguirmos encontrar uma conex√£o para o script CBC, tamb√©m poderemos extrair algumas informa√ß√µes secretas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Felizmente, existem realmente relacionamentos que podemos usar. </font><font style="vertical-align: inherit;">Considere a sa√≠da da chamada final de descriptografia da cifra de bloco e designe esses dados como</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40">W</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tamb√©m denota blocos de texto sem formata√ß√£o </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-172"><span class="MJXp-msubsup" id="MJXp-Span-173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-175" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-179" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e blocos de texto cifrado</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41">P_1, P_2,...</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-184"><span class="MJXp-msubsup" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-187" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-191" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42">C_1,C_2,...</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> D√™ uma outra olhada na tabela da CBC e observe que ela aparece: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-196"><span class="MJXp-msubsup" id="MJXp-Span-197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-199" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-200"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">246</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W </font></font></span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-206" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-207"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">247</font></font></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-43">C_{246} \oplus W = P_{247}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chamamos isso de "equa√ß√£o CBC". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No cen√°rio de Alice, monitorando o texto cifrado e observando o vazamento de informa√ß√µes sobre o texto simples correspondente, conseguimos organizar um ataque que restaurou o terceiro termo da equa√ß√£o - a chave. </font><font style="vertical-align: inherit;">No cen√°rio da CBC, tamb√©m controlamos o texto cifrado e observamos o vazamento de informa√ß√µes no texto simples correspondente. </font><font style="vertical-align: inherit;">Se uma analogia se mantiver, podemos obter informa√ß√µes sobre</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44">W</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Suponha que realmente restauramos </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ent√£o o que? </font><font style="vertical-align: inherit;">Bem, podemos imprimir imediatamente todo o √∫ltimo bloco de texto sem formata√ß√£o (</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45">W</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-212"><span class="MJXp-msubsup" id="MJXp-Span-213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-215" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-216"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">247</font></font></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) simplesmente digitando</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46">P_{247}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-217"><span class="MJXp-msubsup" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-220" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-221"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">246</font></font></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (que possu√≠mos) e</font><font style="vertical-align: inherit;">recebemos</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47">C_{246}</script><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na equa√ß√£o CBC. </font><font style="vertical-align: inherit;">Portanto, estamos otimistas sobre o plano geral de ataque e √© hora de descobrir os detalhes. </font><font style="vertical-align: inherit;">Prestamos aten√ß√£o exatamente ao modo como o servidor vaza informa√ß√µes em texto simples. </font><font style="vertical-align: inherit;">No script de Alice, ocorreu um vazamento porque Alice respondeu a mensagem correta apenas se</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48">W</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-224"><span class="MJXp-mtext" id="MJXp-Span-225"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIMPLE_SUBSTITUTION </font></font></span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-227"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">texto cifrado </font></font></span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mtext" id="MJXp-Span-229"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chave </font></font></span><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49">\text{SIMPLE_SUBSTITUTION}(\text{ciphertext},\text{key})</script> </math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terminou com uma linha </font></font><code>a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ou </font></font><code>bb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assim por diante, mas as chances dessas condi√ß√µes serem acionadas acidentalmente eram muito pequenas). </font><font style="vertical-align: inherit;">Da mesma forma com o CBC, o servidor aceita preenchimento se e somente se</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-231"><span class="MJXp-msubsup" id="MJXp-Span-232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-234" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-235"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">246</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> termina em hexadecimal</font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ent√£o, vamos tentar o mesmo truque: enviar textos cifrados falsos com nossos pr√≥prios valores falsos</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50">C_{246} \oplus W</script><font style="vertical-align: inherit;"></font><code>01</code><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-238"><span class="MJXp-msubsup" id="MJXp-Span-239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-241" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-242"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">246</font></font></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at√© o servidor aceitar o preenchimento. </font><font style="vertical-align: inherit;">Quando o servidor aceita preenchimento para uma de nossas mensagens falsas, significa que:</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51">C_{246}</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-243"><span class="MJXp-msubsup" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-246" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-247"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">246</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚äï </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W </font></font></span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mtext" id="MJXp-Span-251"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dados de hexadecimal 01 na extremidade de</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-52">C_{246} \oplus W = \text{  hex 01  }</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Agora use a propriedade XOR byte: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-252"><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-254"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√∫ltimo byte de&nbsp; </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-257" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-258"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">246</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font></span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-262"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√∫ltimo byte de&nbsp; </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W </font></font></span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mtext" id="MJXp-Span-266"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hex 01</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-53">(\text{  } C_{246}) \oplus (\text{  }W) = \text{hex 01}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conhecemos o primeiro e o terceiro membro. </font><font style="vertical-align: inherit;">E j√° vimos que isso permite restaurar o membro restante - o √∫ltimo byte de</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54">W</script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-269"><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-271"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√∫ltimo byte de&nbsp; </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W </font></font></span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-276"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√∫ltimo byte de&nbsp; </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-279" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-280"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">246</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-281" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font></span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-284"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hex 01 </font></font></span><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-55">(\text{  } W) = (\text{  } C_{246}) \oplus (\text{hex 01})</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tamb√©m nos fornece o √∫ltimo byte do bloco final de texto sem formata√ß√£o atrav√©s da equa√ß√£o CBC e da propriedade byte. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poder√≠amos terminar com isso e ficar satisfeitos por atacarmos uma cifra teoricamente robusta. </font><font style="vertical-align: inherit;">Mas, de fato, podemos fazer muito mais: podemos realmente restaurar o texto inteiro. </font><font style="vertical-align: inherit;">Isso requer um certo truque, que n√£o estava no script original de Alice e n√£o est√° inclu√≠do nos pr√©-requisitos para um ataque do or√°culo, mas ainda vale a pena explorar o m√©todo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para entend√™-lo, observe primeiro que, como resultado da deriva√ß√£o do valor correto do √∫ltimo byte</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> temos uma nova habilidade. </font><font style="vertical-align: inherit;">Agora, ao falsificar textos cifrados, podemos controlar o √∫ltimo byte do texto simples correspondente. </font><font style="vertical-align: inherit;">Novamente, isso se deve √† equa√ß√£o CBC e √† propriedade byte:</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56">W</script><font style="vertical-align: inherit;"></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-288"><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-290"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√∫ltimo byte de&nbsp; </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-293" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-294"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">246</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font></span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-298"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√∫ltimo byte de&nbsp; </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W </font></font></span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mtext" id="MJXp-Span-302"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√öltimo byte de&nbsp; </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-305" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-306"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">247</font></font></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-57">(\text{  } C_{246}) \oplus (\text{  } W) = \text{  } P_{247}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como agora conhecemos o segundo termo, podemos usar nosso controle do primeiro para controlar o terceiro. </font><font style="vertical-align: inherit;">N√≥s apenas calculamos:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-307"><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-309"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√öltimo byte de </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-312" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-313"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">246</font></font></span></span></span><font style="vertical-align: inherit;"><span class="MJXp-mtext" id="MJXp-Span-309"><font style="vertical-align: inherit;"> falso&nbsp; </font></span></font><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-317"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√öltimo byte desejado de&nbsp; </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-320" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-321"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">247</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font></span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-325"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√öltimo byte de&nbsp; </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W </font></font></span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-58">(\text{   } C_{246}) = (\text{   } P_{247}) \oplus (\text{  } W)</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> N√£o pod√≠amos fazer isso antes, porque ainda n√£o t√≠nhamos o √∫ltimo byte </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59">W</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como isso nos ajudar√°? </font><font style="vertical-align: inherit;">Suponha agora que criaremos todos os textos cifrados para que nos textos simples correspondentes o √∫ltimo byte seja igual </font></font><code>02</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Agora, o servidor aceita preenchimento apenas se o texto sem formata√ß√£o terminar com </font></font><code>02 02</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Como corrigimos o √∫ltimo byte, isso acontecer√° apenas se o pen√∫ltimo byte de texto sem formata√ß√£o tamb√©m for 02. Continuamos a enviar blocos de texto cifrado falsos, alterando o pen√∫ltimo byte, at√© que o servidor aceite o preenchimento de um deles. </font><font style="vertical-align: inherit;">Neste momento temos:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-330"><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-332"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pen√∫ltimo byte de </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-335" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-336"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">246</font></font></span></span></span><font style="vertical-align: inherit;"><span class="MJXp-mtext" id="MJXp-Span-332"><font style="vertical-align: inherit;"> falso&nbsp; </font></span></font><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚äï </font></font></span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-340"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pen√∫ltimo byte de&nbsp; </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W </font></font></span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mtext" id="MJXp-Span-344"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hex 02</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-60">(\text{   } C_{246}) \oplus (\text{  } W) = \text{hex 02}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> E restauramos o pen√∫ltimo byte </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> exatamente o mesmo que restaurado por √∫ltimo. </font><font style="vertical-align: inherit;">Continuamos da mesma maneira: corrigimos os dois √∫ltimos bytes de texto sem formata√ß√£o</font><font style="vertical-align: inherit;">, repetimos esse ataque pelo terceiro byte a partir do final do byte e assim por diante, finalmente restaurando completamente</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61">W</script><font style="vertical-align: inherit;"></font><code>03 03</code><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62">W</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E o resto do texto? </font><font style="vertical-align: inherit;">Observe que o valor</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© realmente</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63">W</script><font style="vertical-align: inherit;"></font><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-351"><span class="MJXp-mtext" id="MJXp-Span-352"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLOCK_DECRYPT </font></font></span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-354"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tecla </font></font></span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-358" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-359"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">247</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64">\text{BLOCK_DECRYPT}(\text{key},C_{247})</script> </math>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Podemos colocar qualquer outro bloco </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-361"><span class="MJXp-msubsup" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-364" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-365"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">247</font></font></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e o ataque ainda ser√° bem sucedido. </font><font style="vertical-align: inherit;">De fato, podemos pedir ao servidor para fazer</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65">C_{247}</script><font style="vertical-align: inherit;"></font><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-366"><span class="MJXp-mtext" id="MJXp-Span-367"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLOCK_DECRYPT</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66">\text{BLOCK_DECRYPT}</script> </math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para qualquer dado. </font><font style="vertical-align: inherit;">Neste ponto, o jogo acabou - podemos descriptografar qualquer texto cifrado (mais uma vez, d√™ uma olhada no diagrama de descriptografia da CBC para ver isso; e observe que o vetor IV est√° dispon√≠vel ao p√∫blico). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este m√©todo em particular desempenha um papel crucial no ataque do or√°culo, que encontraremos mais adiante.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Attack kelsey </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">John Kelsey, de mente fechada, estabeleceu os princ√≠pios subjacentes a muitos ataques poss√≠veis, e n√£o apenas os detalhes de um ataque espec√≠fico a uma cifra espec√≠fica. Seu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo de 2002</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© um estudo de poss√≠veis ataques a dados compactados criptografados. Voc√™ pensou que, para realizar um ataque, apenas as informa√ß√µes n√£o eram suficientes, que os dados foram compactados antes da criptografia? Acontece o suficiente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este resultado surpreendente √© devido a dois princ√≠pios. Em primeiro lugar, existe uma forte correla√ß√£o entre o comprimento do texto simples e o comprimento do texto cifrado; para muitas cifras, igualdade exata. Em segundo lugar, quando a compacta√ß√£o √© executada, h√° tamb√©m uma forte correla√ß√£o entre o comprimento da mensagem compactada e o grau de "ru√≠do" do texto simples, ou seja, a propor√ß√£o de caracteres n√£o repetidos (o termo t√©cnico √© "entropia grande").</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para ver o princ√≠pio em a√ß√£o, considere dois textos simples: </font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texto n√£o criptografado 1: </font></font></b> <code>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</code> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texto n√£o criptografado 2:</font></font></b> <code>ATVXCAGTRSVPTVVULSJQHGEYCMQPCRQBGCYIXCFJGJ</code> </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suponha que ambos os textos simples sejam compactados e depois criptografados. </font><font style="vertical-align: inherit;">Voc√™ obt√©m dois textos cifrados resultantes e precisa adivinhar qual texto cifrado corresponde a qual texto simples:</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texto cifrado 1: </font></font></b> <code>PVOVEYBPJDPVANEAWVGCIUWAABCIYIKOOURMYDTA</code> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texto cifrado 2:</font></font></b> <code>DWKJZXYU</code> </blockquote><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A resposta √© clara. </font><font style="vertical-align: inherit;">Entre os textos simples, apenas o texto simples 1 pode ser compactado com o tamanho reduzido do segundo texto cifrado. </font><font style="vertical-align: inherit;">Descobrimos sem saber nada sobre o algoritmo de compacta√ß√£o, a chave de criptografia ou mesmo a pr√≥pria cifra. </font><font style="vertical-align: inherit;">Comparado √† hierarquia de poss√≠veis ataques criptogr√°ficos, esse √© um tipo de loucura. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kelsey indica ainda que, sob certas circunst√¢ncias incomuns, esse princ√≠pio tamb√©m pode ser usado para conduzir um ataque do or√°culo. </font><font style="vertical-align: inherit;">Em particular, ele descreve como um invasor pode recuperar texto sem formata√ß√£o secreto se for√ßar o servidor a criptografar dados de formul√°rio (texto sem formata√ß√£o, seguido por</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enquanto ele controla</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67">X</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e de alguma forma pode verificar a dura√ß√£o do resultado criptografado). </font><font style="vertical-align: inherit;">Novamente, como em outros ataques de or√°culos, temos a propor√ß√£o:</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68">X</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-372"><span class="MJXp-mtext" id="MJXp-Span-373"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criptografia </font></font></span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-375"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compacta√ß√£o </font></font></span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-377"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">texto n√£o </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mtext" id="MJXp-Span-373"><font style="vertical-align: inherit;">criptografado </font></span><span class="MJXp-mtext" id="MJXp-Span-377"><font style="vertical-align: inherit;">seguido de </font></span></font><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-380" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-381" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mtext" id="MJXp-Span-377"><font style="vertical-align: inherit;">texto </font></span></font><span class="MJXp-mtext" id="MJXp-Span-382"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cifrado</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-69">\text{}(\text{}(\text{ ,   } X)) = \text{}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Novamente, controlamos um membro ( </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), vemos um pequeno vazamento de informa√ß√µes sobre outro membro (texto cifrado) e tentamos restaurar o √∫ltimo (texto simples). Apesar da analogia, essa √© uma situa√ß√£o um tanto incomum em compara√ß√£o com outros ataques oraculares que vimos.</font><font style="vertical-align: inherit;">Para ilustrar como esse ataque pode funcionar, usamos o esquema de compress√£o fict√≠cio que acabamos de criar: TOYZIP. Ele procura por linhas de texto que j√° apareceram anteriormente no texto e as substitui por tr√™s bytes de espa√ßo reservado que indicam onde encontrar uma inst√¢ncia anterior da linha e quantas vezes ela aparece l√°. Por exemplo, uma string</font><font style="vertical-align: inherit;">pode ser compactada com um</font><font style="vertical-align: inherit;">comprimento de 13 bytes em compara√ß√£o com os 15 bytes originais.</font><font style="vertical-align: inherit;">Suponha que um invasor tente recuperar o texto sem formata√ß√£o de um formul√°rio</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70">X</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>helloworldhello</code><font style="vertical-align: inherit;"></font><code>helloworld[00][00][05]</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>password=...</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde a senha em si √© desconhecida. </font><font style="vertical-align: inherit;">De acordo com o modelo de ataque de Kelsey, um invasor pode pedir ao servidor para compactar e criptografar as mensagens de formul√°rio (texto sem formata√ß√£o, seguido por</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) onde</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71">X</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© texto livre. </font><font style="vertical-align: inherit;">Quando o servidor termina, ele relata a dura√ß√£o do resultado. </font><font style="vertical-align: inherit;">O ataque √© o seguinte:</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-72">X</script><font style="vertical-align: inherit;"></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cracker:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comprima e criptografe o texto sem formata√ß√£o. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comprimento do resultado 14. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cracker:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compactar e criptografar o texto sem formata√ß√£o ao qual voc√™ adicionou </font></font><code>password=a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comprimento do Resultado 18.</font></font></blockquote><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O cracker observa: [original 14] + [tr√™s bytes que substitu√≠ram </font></font><code>password=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] +</font></font><code>a</code></i> <br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cracker:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comprima e criptografe o texto sem formata√ß√£o ao qual voc√™ adicionou </font></font><code>password=b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comprimento do resultado 18. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cracker:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Por favor, comprima e criptografe o texto sem formata√ß√£o ao qual voc√™ adicionou </font></font><code>password=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dura√ß√£o do resultado 17.</font></font></blockquote><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O cracker observa: [original 14] + [tr√™s bytes que foram substitu√≠dos </font></font><code>password=c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]. </font><font style="vertical-align: inherit;">Isso pressup√µe que o texto sem formata√ß√£o original contenha uma sequ√™ncia </font></font><code>password=c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ou seja, a senha come√ßa com uma letra</font></font><code>c</code></i> <br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cracker:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comprima e criptografe o texto sem formata√ß√£o ao qual voc√™ adicionou </font></font><code>password=a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comprimento do Resultado 18.</font></font></blockquote><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O cracker observa: [original 14] + [tr√™s bytes que substitu√≠ram </font></font><code>password=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] +</font></font><code>a</code></i> <br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cracker:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comprima e criptografe o texto sem formata√ß√£o ao qual voc√™ adicionou </font></font><code>password=b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comprimento do Resultado 18.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (... algum tempo depois ...) </font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cracker:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comprima e criptografe o texto sem formata√ß√£o ao qual voc√™ adicionou </font></font><code>password=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dura√ß√£o do resultado 17.</font></font></blockquote><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O cracker observa: [original 14] + [tr√™s bytes que foram substitu√≠dos </font></font><code>password=co</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]. </font><font style="vertical-align: inherit;">Pela mesma l√≥gica, o cracker conclui que a senha come√ßa com as letras</font></font><code>co</code></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> E assim por diante at√© que toda a senha seja restaurada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O leitor √© perdoado por pensar que este √© um exerc√≠cio puramente acad√™mico e que esse cen√°rio de ataque nunca ocorrer√° no mundo real. </font><font style="vertical-align: inherit;">Infelizmente, como veremos em breve, na criptografia √© melhor n√£o prometer.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vulnerabilidades da marca: CRIME, POODLE, DROWN </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Finalmente, ap√≥s um estudo detalhado da teoria, podemos ver como esses m√©todos s√£o usados ‚Äã‚Äãem ataques criptogr√°ficos reais. </font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CRIME </font></font></h1><br><img src="https://habrastorage.org/getpro/habr/post_images/6fa/646/453/6fa64645390f300a136f09f5171d7257.png" align="left" width="230"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se o ataque atingir o navegador e a rede da v√≠tima, algo ser√° mais simples e algo mais complicado. Por exemplo, √© f√°cil ver o tr√°fego da v√≠tima: basta sentar com ela no mesmo caf√© com Wi-Fi. Por esse motivo, as v√≠timas em potencial (ou seja, todos) geralmente s√£o aconselhadas a usar uma conex√£o criptografada. Ser√° mais dif√≠cil, mas ainda √© poss√≠vel executar solicita√ß√µes HTTP em nome da v√≠tima para algum site de terceiros (por exemplo, Google). O invasor deve atrair a v√≠tima para uma p√°gina da web maliciosa com um script que far√° a solicita√ß√£o. O navegador da web fornecer√° automaticamente o cookie de sess√£o apropriado. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso parece incr√≠vel. Se Bob tiver feito login </font></font><code>evil.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o script neste site pode solicitar ao Google que envie por e-mail a senha de Bob para</font></font><code>attacker@evil.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? Bem, em teoria, sim, mas realmente n√£o. Esse cen√°rio √© chamado de ataque de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falsifica√ß√£o de solicita√ß√£o entre sites</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (CSRF) e era popular em meados dos anos 90. Hoje, se voc√™ </font></font><code>evil.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tentar este truque, Google (ou qualquer local que se preze) geralmente respondem: "Bem, mas o seu CSRF token para esta transa√ß√£o ser√° ... um ... </font></font><code>   </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Por favor, repita este n√∫mero. " Os navegadores modernos usam algo chamado pol√≠tica de mesma origem, segundo a qual os scripts no site A n√£o obt√™m acesso √†s informa√ß√µes enviadas pelo site B. Portanto, o script </font></font><code>evil.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o pode enviar solicita√ß√µes </font></font><code>google.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas n√£o pode ler as respostas ou realmente conclua a transa√ß√£o.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Devemos enfatizar que, se Bob n√£o usar uma conex√£o criptografada, todas essas prote√ß√µes n√£o ter√£o sentido. Um invasor pode simplesmente ler o tr√°fego de Bob e restaurar o cookie de sess√£o do Google. Com esse cookie, ele simplesmente abrir√° uma nova guia do Google sem sair de seu pr√≥prio navegador e personificar√° o Bob sem encontrar pol√≠ticas irritantes da mesma origem. Mas, infelizmente para o cracker, isso est√° se tornando menos comum. A Internet como um todo h√° muito declara guerra √†s conex√µes n√£o criptografadas, e o tr√°fego de sa√≠da de Bob provavelmente √© criptografado, quer ele goste ou n√£o. Al√©m disso, desde o in√≠cio da implementa√ß√£o do protocolo, o tr√°fego tamb√©m foi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compactado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> antes da criptografia; era pr√°tica comum reduzir a lat√™ncia. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â aqui que o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">CRIME</font></a><font style="vertical-align: inherit;"> entra em cena </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Taxa de compress√£o Infoleak Made Easy, vazamento simples atrav√©s da taxa de compress√£o). </font><font style="vertical-align: inherit;">A vulnerabilidade revelada em setembro de 2012 pelos pesquisadores de seguran√ßa Juliano Rizzo e Thai Duong. </font><font style="vertical-align: inherit;">J√° examinamos toda a base te√≥rica, o que nos permite entender o que eles fizeram e como. </font><font style="vertical-align: inherit;">Um invasor pode for√ßar o navegador de Bob a enviar solicita√ß√µes ao Google e, em seguida, ouvir respostas na rede local de forma compactada e criptografada. </font><font style="vertical-align: inherit;">Portanto, temos:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-389"><span class="MJXp-mtext" id="MJXp-Span-390"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tr√°fego da Web </font></font></span><span class="MJXp-mo" id="MJXp-Span-391" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mtext" id="MJXp-Span-392"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criptografia </font></font></span><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-394"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compacta√ß√£o </font></font></span><span class="MJXp-mo" id="MJXp-Span-395" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-396"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solicita√ß√£o e cookie </font></font></span><span class="MJXp-mo" id="MJXp-Span-397" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-73">\text{-} = \text{}(\text{}(\text{  }))</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui, o cracker controla a solicita√ß√£o e tem acesso ao sniffer de tr√°fego, incluindo o tamanho do pacote. </font><font style="vertical-align: inherit;">O cen√°rio fict√≠cio de Kelsey se tornou realidade. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entendendo a teoria, os autores do CRIME criaram uma explora√ß√£o que pode roubar cookies de sess√£o para uma ampla variedade de sites, incluindo Gmail, Twitter, Dropbox e Github. </font><font style="vertical-align: inherit;">A vulnerabilidade afetou a maioria dos navegadores da web modernos, como resultado dos patches lan√ßados que enterraram silenciosamente a fun√ß√£o de compacta√ß√£o no SSL, para que n√£o fosse mais usada. </font><font style="vertical-align: inherit;">O √∫nico protegido contra a vulnerabilidade foi o vener√°vel Internet Explorer, que nunca usou compacta√ß√£o SSL.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> POODLE </font></font></h2><br><img src="https://habrastorage.org/getpro/habr/post_images/9fd/2a3/4c2/9fd2a34c2c97b9a15bae645589e6dad7.jpg" align="left" width="230"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em outubro de 2014, a equipe de seguran√ßa do Google agitou a comunidade de seguran√ßa. Eles foram capazes de explorar a vulnerabilidade no protocolo SSL, corrigido h√° mais de dez anos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acontece que, embora os servidores executem o maravilhoso TLSv1.2, muitos deixaram o suporte ao SSLv3 obsoleto para compatibilidade com vers√µes anteriores do Internet Explorer 6. J√° falamos sobre ataques de downgrade, para que voc√™ possa imaginar o que est√° acontecendo. Sabotagem bem organizada do protocolo de handshake - e os servidores est√£o prontos para retornar ao bom e velho SSLv3, cancelando essencialmente os √∫ltimos 15 anos de pesquisa de seguran√ßa. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para o contexto hist√≥rico, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui est√° um breve resumo do hist√≥rico do SSL at√© a vers√£o 2 de Matthew Green</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><blockquote> Transport Layer Security (TLS) ‚Äî      . [..]   ,     ,   TLS. [..]  TLS    TLS.      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Netscape Communications</a>   "Secure Sockets Layer"  SSL.  ,    SSL   ,             -.  ,    SSL     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> SSL 2</a> .   ,  [..]     90-,      ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  </a> ¬ª.      ,     ,    .     SSLv2       ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  </a> ‚Äî      ,    SSLv2       . </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ap√≥s esses eventos, em 1996, a frustrada empresa Netscape redesenhou o SSL do zero. O resultado foi o SSL vers√£o 3, que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">corrigiu v√°rios problemas de seguran√ßa conhecidos de seu predecessor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Felizmente para os crackers, "poucos" n√£o significa "tudo". Em geral, o SSLv3 forneceu todos os componentes necess√°rios para iniciar o ataque Woden. O protocolo usava uma cifra de bloco no modo CBC e um esquema de preenchimento inseguro (isso foi corrigido no TLS; portanto, ocorreu um ataque de downgrade). Se voc√™ se lembra do padr√£o de preenchimento em nossa descri√ß√£o original do ataque Woden, o padr√£o SSLv3 √© muito semelhante.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas, infelizmente para os crackers, "similar" n√£o significa "id√™ntico". O esquema de preenchimento SSLv3 √© "N bytes arbitr√°rios seguidos pelo n√∫mero N". Nessas condi√ß√µes, tente escolher um bloco imagin√°rio de texto cifrado e percorra todos os est√°gios do esquema Wodene original: voc√™ descobrir√° que o ataque extrai com √™xito o √∫ltimo byte do bloco correspondente de texto sem formata√ß√£o, mas n√£o vai al√©m. Decifrar todos os 16 bytes de texto cifrado √© um grande truque, mas n√£o √© uma vit√≥ria.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diante do fracasso, a equipe do Google recorreu √† op√ß√£o extrema: eles mudaram para um modelo de amea√ßa mais poderoso - o usado no CRIME. Supondo que o invasor seja um script iniciado na guia do navegador da v√≠tima e possa extrair cookies de sess√£o, o ataque permanece impressionante de qualquer maneira. Embora o modelo mais amplo de amea√ßas seja menos realista, j√° vimos na se√ß√£o anterior que esse modelo espec√≠fico √© vi√°vel.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dadas essas capacidades mais poderosas do cracker, o ataque agora pode continuar. </font><font style="vertical-align: inherit;">Observe que o invasor sabe onde o cookie de sess√£o criptografado √© exibido no cabe√ßalho e controla o tamanho da solicita√ß√£o HTTP que o precede. </font><font style="vertical-align: inherit;">Portanto, ele pode manipular a solicita√ß√£o HTTP para alinhar o √∫ltimo byte do cookie de acordo com o final do bloco. </font><font style="vertical-align: inherit;">Agora, este byte √© adequado para descriptografia. </font><font style="vertical-align: inherit;">Voc√™ pode simplesmente adicionar um caractere √† solicita√ß√£o e o pen√∫ltimo byte de cookies permanecer√° no mesmo local e adequado para sele√ß√£o pelo mesmo m√©todo. </font><font style="vertical-align: inherit;">O ataque continua dessa maneira at√© que o cookie seja completamente restaurado. </font><font style="vertical-align: inherit;">Isso se chama POODLE: preenchendo o Oracle na criptografia herdada rebaixada, preenchendo o oracle com criptografia obsoleta reduzida.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Afogar </font></font></h2><br><img src="https://habrastorage.org/getpro/habr/post_images/c24/a6b/436/c24a6b43640c6a3ec7a7498fec486a82.png" align="left" width="205"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como j√° mencionamos, o SSLv3 apresentava falhas, mas era fundamentalmente diferente de seu antecessor, pois o SSLv2 com vazamento era um produto de uma √©poca diferente. L√° foi poss√≠vel interromper a mensagem no meio: </font></font><code>      </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">transformada em </font></font><code>  </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; o cliente e o servidor podiam se encontrar na Internet, estabelecer confian√ßa e trocar segredos diante dos olhos do atacante, que ent√£o fingia ser os dois com facilidade. H√° tamb√©m um problema com a criptografia de exporta√ß√£o, que mencionamos ao considerar o FREAK. Estes foram Sodoma criptogr√°fico e Gomorra.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em mar√ßo de 2016, uma equipe de pesquisadores de v√°rias √°reas t√©cnicas se reuniu e fez uma descoberta surpreendente: o SSLv2 ainda √© usado em sistemas de seguran√ßa. Sim, os invasores n√£o puderam mais fazer o downgrade das sess√µes TLS modernas para SSLv2, pois esse buraco foi fechado ap√≥s FREAK e POODLE, mas eles ainda podem se conectar aos servidores e iniciar sess√µes SSLv2 por conta pr√≥pria.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pergunta, o que nos importa o que eles fazem l√°? Eles t√™m uma sess√£o vulner√°vel, mas isso n√£o deve afetar outras sess√µes ou a seguran√ßa do servidor - certo? Bem, na verdade n√£o. Sim, √© assim que deve ser em teoria. Mas n√£o - porque a gera√ß√£o de certificados SSL imp√µe uma certa carga, como resultado de muitos servidores usarem os mesmos certificados e, como resultado, as mesmas chaves RSA para conex√µes TLS e SSLv2. Pior, devido ao bug do OpenSSL nesta popular implementa√ß√£o de SSL, a op√ß√£o "Desativar SSLv2" n√£o funcionou. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso possibilitou um ataque de protocolo cruzado ao TLS chamado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DROWN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Descriptografando o RSA com criptografia eletr√¥nica obsoleta e enfraquecida, descriptografando o RSA usando criptografia desatualizada e fraca). Lembre-se de que isso n√£o √© o mesmo que um ataque de queda; um invasor n√£o precisa agir como uma ‚Äúpessoa do meio‚Äù e n√£o precisa envolver um cliente para participar de uma sess√£o n√£o segura. Os invasores simplesmente iniciam uma sess√£o SSLv2 insegura com o pr√≥prio servidor, atacam um protocolo fraco e restauram a chave do servidor privado RSA. Essa chave tamb√©m √© v√°lida para conex√µes TLS e, a partir de agora, nenhuma seguran√ßa TLS a salvar√° de hackers.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas o hacking requer um ataque funcional contra o SSLv2, que permite restaurar n√£o apenas o tr√°fego espec√≠fico, mas tamb√©m a chave do servidor secreto RSA. Embora essa seja uma produ√ß√£o complicada, os pesquisadores podem escolher qualquer vulnerabilidade que foi completamente fechada ap√≥s o SSLv2. No final, eles encontraram uma op√ß√£o adequada: o ataque de Bleichenbacher, que mencionamos anteriormente e que ser√° explicado em detalhes no pr√≥ximo artigo. O SSL e o TLS est√£o protegidos contra esse ataque, mas algumas fun√ß√µes aleat√≥rias do SSL, combinadas com teclas de atalho na criptografia de exporta√ß√£o, possibilitaram uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implementa√ß√£o espec√≠fica do DROWN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No momento da publica√ß√£o da vulnerabilidade DROWN, 25% dos principais sites da Internet eram afetados, e o ataque podia ser realizado com recursos modestos dispon√≠veis, mesmo para hackers maliciosos. </font><font style="vertical-align: inherit;">Foram necess√°rias oito horas de computa√ß√£o e US $ 440 para recuperar a chave do servidor RSA, e o SSLv2 mudou seu status de "obsoleto" para "radioativo".</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Espere, e o Heartbleed? </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este n√£o √© um ataque criptogr√°fico no sentido descrito acima; </font><font style="vertical-align: inherit;">isso √© um estouro de buffer.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fa√ßa uma pausa </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Come√ßamos com alguns m√©todos b√°sicos: for√ßa bruta, interpola√ß√£o, downgrade, protocolo cruzado e pr√©-c√°lculo. Depois, examinaram uma t√©cnica avan√ßada, talvez o principal componente dos ataques criptogr√°ficos modernos: este √© o ataque do or√°culo. Lidamos com isso por algum tempo - e entendemos n√£o apenas o princ√≠pio central, mas tamb√©m os detalhes t√©cnicos de duas implementa√ß√µes espec√≠ficas: ataques de Wodene no modo de criptografia CBC e ataques de Kelsey em protocolos de criptografia com compress√£o preliminar. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao revisar ataques de downgrade e com c√°lculos preliminares, descrevemos brevemente o ataque FREAK, que usa os dois m√©todos, j√° que os sites de destino caem para chaves fracas e reutilizam as mesmas chaves. No pr√≥ximo artigo, deixamos um ataque (muito semelhante) ao Logjam, direcionado a algoritmos de chave p√∫blica.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em seguida, examinamos mais tr√™s exemplos da aplica√ß√£o desses princ√≠pios. Em primeiro lugar, o crime e POODLE: dois ataques, que contou com a habilidade de um atacante para introduzir texto simples arbitr√°ria ao lado do alvo em texto claro, e ent√£o aprender as respostas para o servidor e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, em seguida</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , utilizando a metodologia da Oracle ataque, usar essa informa√ß√£o escassa para a recupera√ß√£o parcial do texto simples. O CRIME seguiu o caminho do ataque de Kelsey √† compacta√ß√£o SSL, enquanto o POODLE usou o ataque de Woden na CBC com o mesmo efeito.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em seguida, voltamos nossa aten√ß√£o para o ataque DROWN de protocolo cruzado, que estabelece uma conex√£o com o servidor usando o protocolo SSLv2 desatualizado e, em seguida, restaura as chaves secretas do servidor usando o ataque Bleichenbacher. </font><font style="vertical-align: inherit;">Neste ponto, perdemos os detalhes t√©cnicos deste ataque; </font><font style="vertical-align: inherit;">como Logjam, ela ter√° que esperar at√© que estudemos minuciosamente os sistemas de criptografia de chave p√∫blica e suas vulnerabilidades. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No pr√≥ximo artigo, falaremos sobre ataques avan√ßados - como o m√©todo meet-in-the-middle, criptoan√°lise diferencial e o ataque de "anivers√°rio". </font><font style="vertical-align: inherit;">Faremos uma pequena incurs√£o em ataques por meio de canais de terceiros e, em seguida, enfrentaremos a coisa mais deliciosa - sistemas de criptografia com uma chave p√∫blica.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt462437/">https://habr.com/ru/post/pt462437/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt462423/index.html">Gerenciamento de Projetos</a></li>
<li><a href="../pt462429/index.html">VueJs + VueRouter + modal. Outra bicicleta</a></li>
<li><a href="../pt462431/index.html">O resumo de materiais interessantes para o desenvolvedor m√≥vel 309 (29 de julho a 4 de agosto)</a></li>
<li><a href="../pt462433/index.html">Programador para EPROM no Arduino</a></li>
<li><a href="../pt462435/index.html">Retrospectiva: Como os endere√ßos IPv4 diminu√≠ram</a></li>
<li><a href="../pt462439/index.html">Hist√≥rias do computador lunar. Parte 1</a></li>
<li><a href="../pt462441/index.html">WexLang - como criei um projeto de sonho para aprender ingl√™s</a></li>
<li><a href="../pt462443/index.html">Resident Evil 2 renderiza√ß√£o de quadro</a></li>
<li><a href="../pt462445/index.html">Earth Rumble: teorias da conspira√ß√£o e poss√≠veis explica√ß√µes</a></li>
<li><a href="../pt462447/index.html">Como os desenvolvedores juniores tornam meu projeto mais correto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>