<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õÑÔ∏è üìÆ üßîüèΩ C√≥mo detuvimos a jugadores comunes y para DDoS o nuestros servidores: una gu√≠a pr√°ctica üòû üåá üõ†Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hablar de nuevos proyectos es, por supuesto, bueno, pero no siempre todo sale como queremos. 

 En general, comenzaron a recordar fakap del pasado, cu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo detuvimos a jugadores comunes y para DDoS o nuestros servidores: una gu√≠a pr√°ctica</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pixonic/blog/417441/">  Hablar de nuevos proyectos es, por supuesto, bueno, pero no siempre todo sale como queremos. <br><br>  En general, comenzaron a recordar fakap del pasado, cuando la soluci√≥n a un problema agreg√≥ otros nuevos, se dej√≥ llevar y decidi√≥ compartir una pareja.  C√≥mo prohibir a jugadores inocentes, matar sus propios servidores, cometer un error en una carta y recibir toneladas de comentarios negativos de los usuarios, eso es todo lo que amamos. <br><br><img src="https://habrastorage.org/webt/ug/ah/u-/ugahu-bcho92pvjvqfqy46h26fa.jpeg"><br><a name="habracut"></a><br><h2>  Perdido - consigue una prohibici√≥n </h2><br>  Hubo un momento en que nuestro juego War Robots debido a fallas en la arquitectura fue atacado por los tramposos.  Hubo utilidades que aumentaron el suministro de salud a los valores c√≥smicos, lo que los hizo pr√°cticamente inmortales.  Como resultado, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cerramos la</a> tarea con tramposos, pero no de inmediato. <br><br>  Al principio, quer√≠amos resolver el problema maravillosamente a nivel t√©cnico: bloquear la capacidad de cambiar los par√°metros del robot en el cliente.  No logramos hacer esto (entonces, por supuesto, encontramos una manera).  Y luego, la primera soluci√≥n de trabajo fue un golpe de martillo que calcul√≥ a los tramposos de acuerdo con un esquema simple: <br><br><ol><li>  Cada robot despu√©s del partido fue probado por da√±os. </li><li>  Si el da√±o sufrido por el robot excedi√≥ el valor de su salud m√°xima, entonces el jugador fue reconocido como un tramposo y su cuenta fue bloqueada. </li></ol><br>  La soluci√≥n fue una muleta, pero efectiva.  Los problemas a causa de √©l comenzaron un poco m√°s tarde, pero primero tendr√°s que hablar un poco sobre otro error y las caracter√≠sticas del desarrollo de PvP m√≥vil s√≠ncrono. <br><br>  Cuando los jugadores tienen una conexi√≥n a Internet muy traviesa (lo cual es normal en los juegos m√≥viles), pueden ocurrir cosas absolutamente m√°gicas al intercambiar datos entre el cliente y los servidores.  Las solicitudes de los clientes llegan incompletas, fuera de servicio o con un fuerte retraso.  En general, un error del servidor permiti√≥ que si la conexi√≥n es deficiente, el cliente puede enviar los resultados de la batalla dos o incluso tres veces seguidas.  En consecuencia, los jugadores podr√≠an recibir 2-3 veces m√°s recompensas o gastar accidentalmente el doble de recursos en reparaciones. <br><br>  Resolvimos este problema bastante r√°pido: el perfil del servidor aprendi√≥ a ignorar los resultados de batalla innecesarios de un cliente.  Despu√©s de una prueba exitosa, lanzamos una nueva versi√≥n. <br><br>  Fue aqu√≠ que nos cubri√≥. <br><br>  Todos los d√≠as comenc√© a prohibir a un mont√≥n de jugadores con un martillo neum√°tico, del cual nos olvidamos con seguridad, porque  El problema de los robots indestructibles con un suministro infinito de salud era cosa del pasado.  Result√≥ que tan pronto como el cliente del jugador envi√≥ los resultados de una batalla en doble cantidad al servidor, el banhammer lo percibi√≥ de tal manera que cada robot muerto fue asesinado dos veces, es decir.  recibi√≥ da√±o dos veces su salud.  Y despu√©s de cada batalla, los jugadores volaron a la prohibici√≥n en lotes. <br><br>  Todos, por supuesto, no estaban dispuestos a pagar e incluso pagaron una compensaci√≥n, pero la situaci√≥n es regular, no es segura con seguridad. <br><br><img src="https://habrastorage.org/webt/rg/le/pc/rglepcj33omwpzwitdrmijjewkk.gif"><br><br>
<h2>  C√≥mo configurar DDoS por ti mismo </h2><br>  Ya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">escribimos</a> sobre la evoluci√≥n de nuestra infraestructura de servidores, y ahora hemos recordado un caso de esa √©poca. <br><br>  A finales de 2015, el lanzamiento de la caracter√≠stica tan esperada en War Robots: clanes.  Cuando sali√≥ la actualizaci√≥n (y era tarde en la noche), abrimos el champ√°n y todo estar√≠a bien.  Pero no tuve que alegrarme por mucho tiempo: los servidores de repente se sintieron mal.  Result√≥ que hicimos un ataque DDoS con nuestras propias manos. <br><br>  Como?  Muy simple  El cliente en la pantalla de resultados de la batalla, en un intento de obtener informaci√≥n sobre los clanes de los jugadores, hizo demasiadas solicitudes.  Y cuando el servidor respondi√≥ "d√©jame solo, error", el cliente regres√≥ al servidor sin tiempo de espera. <br><br>  Esa misma noche, lavamos la bandera (todav√≠a no ten√≠amos tiempo de cerrar la champa√±a), que se control√≥ desde el servidor de perfil, bloque√≥ completamente el funcionamiento de la API de Hangar Client.  Para los jugadores que ya se han unido a los clanes, dejamos esta bandera encendida, es decir, todo funcion√≥ para ellos, porque su n√∫mero no era suficiente para DDoS el servidor. <br><br>  Como resultado, comenzamos a procesar correctamente las respuestas del servidor en el juego y, en caso de error, aumentamos el tiempo de espera para volver a intentar la solicitud. <br><br><h2>  Calificaci√≥n "gratis" </h2><br>  Una historia separada es cuando la implementaci√≥n de baja calidad se encuentra con el factor humano.  Solo que ahora no prohibieron a nadie, sino que, por el contrario, entregaron la calificaci√≥n de izquierda a derecha.  En resumen, una noche nuestro monitoreo (y monitoreamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">todo</a> ) registr√≥ un crecimiento demasiado r√°pido en las calificaciones de los jugadores. <br><br>  Luego result√≥ que la implementaci√≥n misma de la calificaci√≥n en teor√≠a hizo posible duplicar datos.  Pero nadie le habr√≠a prestado atenci√≥n si el administrador de turno, debido a un error tipogr√°fico en una carta, reiniciara accidentalmente un servidor que no deb√≠a funcionar.  Fue √©l quien comenz√≥ a duplicar las calificaciones de los jugadores. <br><br>  Tuve que liberar urgentemente una soluci√≥n e ir a trav√©s de la base para eliminar todos los puntos extra que tuvieron tiempo de acumular.  Para evitar que esto suceda, en todos los servidores eliminamos el esquema anterior para calcular puntos y excluimos la posibilidad de un lanzamiento err√≥neo de servicios donde no deber√≠an funcionar.  Era necesario hacerlo desde el principio, por supuesto, pero ser√≠a demasiado aburrido. <br><br><h2>  Premio invaluable </h2><br>  Hubo otro fakap con un error tipogr√°fico, pero mucho m√°s serio. <br><br>  De alguna manera, en Halloween lanzamos una nueva gacha: una loter√≠a.  Si alguien no lo sabe, una gacha es la mec√°nica de obtener un elemento de varios diferentes al azar.  En la loter√≠a, el jugador ten√≠a un conjunto visible limitado de premios de diferentes valores.  Por cada apertura, el jugador recibi√≥ 1 premio, este premio se sac√≥ del conjunto y el precio de apertura aument√≥ cada vez.  Por lo tanto, el jugador seguramente podr√≠a comprar todos los premios de la loter√≠a, y los afortunados se llevaron los premios m√°s valiosos en las primeras aperturas (y, en consecuencia, los recibieron a un precio muy bajo). <br><br>  En general, luego con sangre eliminamos una caracter√≠stica del evento, la probamos y la presentamos.  Comenzamos, actualizamos los horarios ... ¬°Hurra!  ¬°Se apresuraron! ... Y al mismo tiempo, toneladas de negatividad en la comunidad caen sobre nosotros porque supuestamente estamos enga√±ando a nuestros jugadores. <br><br>  Dentro de media hora la loter√≠a tuvo que ser apagada.  S√≠, realmente enga√±amos a los jugadores.  Pero no fue una cuesti√≥n de posibilidades o premios, fue en una carta. <br><br>  La interfaz de la loter√≠a muestra el costo de la apertura actual (la que aument√≥ cada vez), por ejemplo, PRECIO: 100 de oro.  As√≠ es como se ve√≠a el concepto (tenga en cuenta que de acuerdo con la idea, cada tarjeta tambi√©n tiene un precio de apertura adicional): <br><br><img src="https://habrastorage.org/webt/ns/a6/xv/nsa6xvnjqudlstg_m2veg5-ohxm.jpeg"><br><br>  Y as√≠ es como lleg√≥ al final cuando, como resultado de una serie de "mejoras", el PRECIO (precio por participar en la loter√≠a) de repente se convirti√≥ en un PREMIO (premio) para el dise√±ador: <br><br><img src="https://habrastorage.org/webt/1u/s9/lh/1us9lhgsdyfunbhmvsfdfpji_d8.jpeg"><br><br>  Al mismo tiempo, debido a la confusi√≥n antes del lanzamiento y al mal cheque de cada tarjeta individual, se perdi√≥ el precio de apertura, lo que en conjunto confundi√≥ a los jugadores. <br><br>  Y presionaron reflexivamente el bot√≥n hasta que pasaron toda la dureza.  Bueno, qu√©, el "premio" aumenta con cada compra.  Y as√≠ fue en 18 idiomas.  Al mismo tiempo, tambi√©n ten√≠amos "configuraciones regionales" en el cliente, por lo que era posible corregir incluso una letra solo a trav√©s de una revisi√≥n. <br><br>  Como resultado, revelaron la situaci√≥n, introdujeron puntos de control adicionales, devolvieron el oro a los jugadores y guardaron las configuraciones regionales en el servidor para que nada de esto volviera a suceder. <br><br>  Es hora de presentar el hashtag <i># Kosyakinaprode</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es417441/">https://habr.com/ru/post/es417441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es417429/index.html">Establecimos un proyecto conveniente de npm para nosotros y para el equipo o un poco sobre herramientas modernas</a></li>
<li><a href="../es417431/index.html">Anti-entrevista</a></li>
<li><a href="../es417435/index.html">Se encontr√≥ un error tipogr√°fico en la configuraci√≥n de Aliens: Colonial Marines, debido a que la IA del juego estuvo defectuosa durante cuatro a√±os</a></li>
<li><a href="../es417437/index.html">Proyector vs panel plano. Nos probamos la bata de un oftalm√≥logo y descubrimos por qu√© el tama√±o importa</a></li>
<li><a href="../es417439/index.html">El Intel Core i7-8086K (parte 1)</a></li>
<li><a href="../es417443/index.html">Los compuestos org√°nicos en Marte podr√≠an descubrirse hace 40 a√±os si se usara un m√©todo de an√°lisis diferente</a></li>
<li><a href="../es417445/index.html">Optimizaci√≥n de la representaci√≥n de una escena de la caricatura de Disney "Moana". Parte 2</a></li>
<li><a href="../es417447/index.html">Expedici√≥n a los misteriosos c√≠rculos de hadas en el desierto de Namib</a></li>
<li><a href="../es417449/index.html">Mundo Jur√°sico: ¬øPodemos realmente resucitar dinosaurios?</a></li>
<li><a href="../es417451/index.html">Cinco errores comunes para principiantes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>