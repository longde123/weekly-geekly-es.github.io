<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äçüè´ üìì ‚úãüèΩ NCBI Genome Workbench: Endangered Research üíô ü§∞üèø üéÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Technologies informatiques modernes, solutions techniques et logicielles - tout cela facilite et acc√©l√®re consid√©rablement la mise en ≈ìuvre de diverse...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>NCBI Genome Workbench: Endangered Research</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/430476/"><img src="https://habrastorage.org/getpro/habr/post_images/9ce/9dc/792/9ce9dc792e9661eba72b3692521754be.png" align="left">  Technologies informatiques modernes, solutions techniques et logicielles - tout cela facilite et acc√©l√®re consid√©rablement la mise en ≈ìuvre de diverses recherches scientifiques.  Souvent, la simulation informatique est le seul moyen de tester de nombreuses th√©ories.  Le logiciel scientifique a ses propres caract√©ristiques.  Par exemple, ces logiciels sont souvent soumis √† des tests tr√®s pouss√©s, mais sont peu document√©s.  Cependant, les logiciels sont √©crits par des gens et les gens font des erreurs.  Des erreurs dans les programmes scientifiques peuvent mettre en doute toute la recherche.  Cet article r√©pertorie des dizaines de probl√®mes trouv√©s dans le code du progiciel NCBI Genome Workbench. <br><a name="habracut"></a><br><h2>  Pr√©sentation </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le NCBI Genome Workbench</a> offre aux chercheurs une large gamme d'outils pour √©tudier et analyser les donn√©es g√©n√©tiques.  Les utilisateurs peuvent rechercher et comparer des donn√©es provenant de plusieurs sources, y compris les bases de donn√©es NCBI (National Center for Biotechnology Information) ou leurs propres donn√©es personnelles. <br><br>  Comme mentionn√© pr√©c√©demment, les logiciels scientifiques sont g√©n√©ralement bien couverts par les tests unitaires.  Lors de la v√©rification de ce projet, 85 r√©pertoires contenant des fichiers de test ont √©t√© exclus de l'analyse.  C'est environ un millier de fichiers.  Cela est peut-√™tre d√ª aux exigences pour tester divers algorithmes complexes qui sont invent√©s pour diverses √©tudes.  Mais la qualit√© du reste du code (pas celui du test) n'est pas √† un niveau aussi √©lev√© que nous le souhaiterions.  Cependant, comme dans tout projet dans lequel ils n'ont pas encore pris en charge l'introduction d'outils d'analyse de code statique :). <br><br>  Les donn√©es pour la r√©vision (ou m√™me la recherche) du code ont √©t√© fournies par l'analyseur de code statique pour C / C ++ / C # / Java - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PVS-Studio</a> . <br><br><h2>  Juste deux chiffres qui ruinent votre projet </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dad/9f3/20b/dad9f320b84473428205cc1227a20fe6.png"></div><br><br>  Sur la base de notre base de donn√©es d'erreurs, qui repr√©sente actuellement plus de 12 000 exemples s√©lectionn√©s, nous remarquons et d√©crivons des mod√®les sp√©cifiques d'√©criture de code qui conduisent √† de nombreuses erreurs.  Par exemple, nous avons men√© les √©tudes suivantes: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'effet de la derni√®re ligne</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La fonction la plus dangereuse du monde du C / C ++</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Expressions logiques en C / C ++.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√Ä quel point les professionnels ont-ils tort</a> ? </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le mal vit dans des fonctions de comparaison</a> . </li></ol><br>  Ce projet a marqu√© le d√©but de la description du nouveau mod√®le.  Nous parlons des nombres <b>1</b> et <b>2</b> dans les noms des variables, par exemple, <i>fichier1</i> et <i>fichier2</i> , etc.  Il est tr√®s facile de confondre deux de ces variables.  Il s'agit d'un cas particulier de fautes de frappe dans le code, mais une telle erreur entra√Æne le d√©sir de travailler avec des variables du m√™me nom, qui ne diff√®rent que par les chiffres 1 et 2 √† la fin du nom. <br><br>  En regardant un peu plus loin, je dirai que toutes les √©tudes √©num√©r√©es ci-dessus ont √©t√© confirm√©es dans le code de ce projet: D. <br><br>  Prenons le premier exemple du projet Genome Workbench: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V501</a> Il existe des sous-expressions identiques '(! Loc1.IsInt () &amp;&amp;! Loc1.IsWhole ())' √† gauche et √† droite de '||'  op√©rateur.  nw_aligner.cpp 480 <br><br><pre><code class="cpp hljs">CRef&lt;CSeq_align&gt; CNWAligner::Run(CScope &amp;scope, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CSeq_loc &amp;loc1, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CSeq_loc &amp;loc2, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> trim_end_gaps) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((!loc1.IsInt() &amp;&amp; !loc1.IsWhole()) || (!loc1.IsInt() &amp;&amp; !loc1.IsWhole())) { NCBI_THROW(CException, eUnknown, <span class="hljs-string"><span class="hljs-string">"Only whole and interval locations supported"</span></span>); } .... }</code> </pre> <br>  Nous voyons deux variables nomm√©es <i>loc1</i> et <i>loc2</i> .  Et aussi une erreur dans le code: la variable <i>loc2 n'est</i> pas utilis√©e, car au lieu de cela <i>loc1</i> est utilis√© √† nouveau. <br><br>  Un autre exemple: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V560</a> Une partie de l'expression conditionnelle est toujours fausse: s1.IsSet ().  valid_biosource.cpp 3073 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s_PCRPrimerSetLess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> CPCRPrimerSet&amp; s1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> CPCRPrimerSet&amp; s2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!s1.IsSet() &amp;&amp; s1.IsSet()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s1.IsSet() &amp;&amp; !s2.IsSet()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!s1.IsSet() &amp;&amp; !s2.IsSet()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s1.Get().size() &lt; s2.Get().size()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s1.Get().size() &gt; s2.Get().size()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ..... }</code> </pre> <br>  La premi√®re ligne de code a m√©lang√© les variables <i>s1</i> et <i>s2</i> .  Bas√© sur le nom, il s'agit d'une fonction de comparaison.  Mais une telle erreur peut √™tre n'importe o√π, car en nommant les variables <i>Num√©ro 1</i> et <i>Num√©ro 2</i> , le programmeur fera certainement une erreur √† l'avenir.  Et plus il y a d'utilisations de ces noms dans une fonction, plus la probabilit√© d'erreur est √©lev√©e. <br><br><h2>  Autres fautes de frappe et copier-coller </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d5/d9f/f6b/6d5d9ff6bf8083922701b25273fa50b2.png"></div><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V501</a> Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '! =': Bd.bit_.bits [i]! = Bd.bit_.bits [i] bm.h 296 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compare_state</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> iterator_base&amp; ib)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;block_type_ == <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bd.bit_.ptr != ib_db.bit_.ptr) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bd.bit_.idx != ib_db.bit_.idx) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bd.bit_.cnt != ib_db.bit_.cnt) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bd.bit_.pos != ib_db.bit_.pos) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; bd.bit_.cnt; ++i) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bd.bit_.bits[i] != bd.bit_.bits[i]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } .... }</code> </pre> <br>  Je crois qu'apr√®s toutes les v√©rifications, les tailles des tableaux de <i>bits</i> des <i>objets</i> <i>bd.bit_</i> et <i>ib_db.bit_</i> sont √©gales.  Par cons√©quent, l'auteur du code a √©crit un cycle pour la comparaison √©l√©mentaire des tableaux de <i>bits</i> , mais a fait une faute de frappe au nom de l'un des objets compar√©s.  Par cons√©quent, les objets compar√©s peuvent √™tre consid√©r√©s √† tort comme √©gaux dans certaines situations. <br><br>  Cet exemple est digne de l'article ¬´Le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mal vit dans les fonctions de comparaison</a> ¬ª. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V501</a> Il existe des sous-expressions identiques ¬´CFieldHandler :: QualifierNamesAreEquivalent (field, kFieldTypeSeqId)¬ª √† gauche et √† droite de ¬´||¬ª  op√©rateur.  field_handler.cpp 152 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CFieldHandlerFactory::s_IsSequenceIDField(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&amp; field) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( CFieldHandler::QualifierNamesAreEquivalent(field, kFieldTypeSeqId) || CFieldHandler::QualifierNamesAreEquivalent(field, kFieldTypeSeqId)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre> <br>  Tr√®s probablement, l'un des contr√¥les est superflu.  Je n'ai pas trouv√© dans les variables de code similaires √† <i>kFieldTypeSeqId</i> .  N√©anmoins, un appel de fonction suppl√©mentaire est possible en raison de l'op√©rateur "||", ce qui d√©grade les performances. <br><br>  Quelques autres endroits du m√™me type avec un avertissement d'analyseur, n√©cessitant une v√©rification: <br><br><ul><li>  V501 Il existe des sous-expressions identiques ¬´uf-&gt; GetData (). IsBool ()¬ª √† gauche et √† droite de l'op√©rateur ¬´&amp;&amp;¬ª.  variation_utils.cpp 1711 </li><li>  V501 Il existe des sous-expressions identiques ¬´uf-&gt; GetData (). IsBool ()¬ª √† gauche et √† droite de l'op√©rateur ¬´&amp;&amp;¬ª.  variation_utils.cpp 1735 </li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V766</a> Un √©l√©ment avec la m√™me cl√© 'kArgRemote' a d√©j√† √©t√© ajout√©.  blast_args.cpp 3262 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CBlastAppArgs::x_IssueWarningsForIgnoredOptions(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CArgs&amp; args) { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; can_override; .... can_override.insert(kArgOutputFormat); can_override.insert(kArgNumDescriptions); can_override.insert(kArgNumAlignments); can_override.insert(kArgMaxTargetSequences); can_override.insert(kArgRemote); <span class="hljs-comment"><span class="hljs-comment">// &lt;= can_override.insert(kArgNumThreads); can_override.insert(kArgInputSearchStrategy); can_override.insert(kArgRemote); // &lt;= can_override.insert("remote_verbose"); can_override.insert("verbose"); .... }</span></span></code> </pre> <br>  L'analyseur a d√©tect√© l'ajout de 2 valeurs identiques dans le r√©cipient <i>d√©fini</i> .  Rappelez-vous que ce conteneur ne stocke que des valeurs uniques, donc les doublons n'y sont pas ajout√©s. <br><br>  Un code comme celui ci-dessus est souvent √©crit √† l'aide de la m√©thode copier-coller.  Il peut simplement y avoir une valeur suppl√©mentaire, ou peut-√™tre que l'auteur a oubli√© de renommer l'une des variables lors de la copie.  Lorsque vous supprimez un appel suppl√©mentaire √† <i>ins√©rer, le</i> code est l√©g√®rement optimis√©, ce qui n'est cependant pas significatif.  Plus important encore, une erreur grave peut √™tre cach√©e ici en raison d'un √©l√©ment manquant dans l'ensemble. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V523</a> L' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">instruction</a> 'then' est √©quivalente au fragment de code suivant.  vcf_reader.cpp 1105 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CVcfReader::xAssignFeatureLocationSet(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.m_SetType == CVcfData::ST_ALL_DEL) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.m_strRef.size() == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//deletion of a single base pFeat-&gt;SetLocation().SetPnt().SetPoint(data.m_iPos-1); pFeat-&gt;SetLocation().SetPnt().SetId(*pId); } else { pFeat-&gt;SetLocation().SetInt().SetFrom(data.m_iPos-1); //-1 for 0-based, //another -1 for inclusive end-point ( ie [], not [) ) pFeat-&gt;SetLocation().SetInt().SetTo( data.m_iPos -1 + data.m_strRef.length() - 1); pFeat-&gt;SetLocation().SetInt().SetId(*pId); } return true; } //default: For MNV's we will use the single starting point //NB: For references of size &gt;=2, this location will not //match the reference allele. Future Variation-ref //normalization code will address these issues, //and obviate the need for this code altogether. if (data.m_strRef.size() == 1) { //deletion of a single base pFeat-&gt;SetLocation().SetPnt().SetPoint(data.m_iPos-1); pFeat-&gt;SetLocation().SetPnt().SetId(*pId); } else { pFeat-&gt;SetLocation().SetInt().SetFrom(data.m_iPos-1); pFeat-&gt;SetLocation().SetInt().SetTo( data.m_iPos -1 + data.m_strRef.length() - 1); pFeat-&gt;SetLocation().SetInt().SetId(*pId); } return true; }</span></span></code> </pre> <br>  La fonction contient de gros fragments de code compl√®tement identiques.  Cependant, ils contiennent divers commentaires d'accompagnement.  Le code n'est pas √©crit de mani√®re optimale, source de confusion, et peut contenir une erreur. <br><br>  La liste compl√®te des endroits suspects avec l'instruction if-else ressemble √† ceci: <br><br><ul><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  blk.c 2142 </li><li>  V523 L'instruction 'then' est √©quivalente au fragment de code suivant.  odbc.c 379 </li><li>  V523 L'instruction 'then' est √©quivalente au fragment de code suivant.  odbc.c 1414 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  seqdbvol.cpp 1922 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  seqdb_demo.cpp 466 </li><li>  V523 L'instruction 'then' est √©quivalente au fragment de code suivant.  blast_engine.c 1917 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  blast_filter.c 420 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  blast_parameters.c 636 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  unordered_spliter.cpp 684 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  bme.cpp 333 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  gme.cpp 484 </li></ul><br><h2>  / * avec la s√©curit√© est pr√©f√©rable d'√™tre p√©dant * / </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/914/df5/670/914df5670813e7eb410e446f60a0ed5e.png"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V597</a> Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider le tampon 'passwd_buf'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 366 <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Crypt a given password using schema required for NTLMv1 authentication * @param passwd clear text domain password * @param challenge challenge data given by server * @param flags NTLM flags from server side * @param answer buffer where to store crypted password */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tds_answer_challenge</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MAX_PW_SZ 14 .... </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (ntlm_v == 1) { .... </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* with security is best be pedantic */</span></span></span><span class="hljs-meta"> memset(hash, 0, sizeof(hash)); memset(passwd_buf, 0, sizeof(passwd_buf)); memset(ntlm2_challenge, 0, sizeof(ntlm2_challenge)); } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { .... } }</span></span></code> </pre> <br>  Comme vous l'avez probablement d√©j√† devin√©, un commentaire amusant sur la s√©curit√© du code a √©t√© utilis√© dans le titre de la section. <br><br>  En bref, la fonction <i>memset</i> sera supprim√©e par le compilateur, car les tampons vid√©s ne sont plus utilis√©s.  Et les donn√©es comme <i>hash</i> ou <i>passwd_buf</i> ne seront pas r√©ellement des z√©ros.  Pour plus d'informations sur ce m√©canisme de compilation non √©vident, consultez l'article ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Effacement s√©curis√© des donn√©es priv√©es</a> ¬ª. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V597</a> Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'answer'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 561 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> TDSRET </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tds7_send_auth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-comment"><span class="hljs-comment">/* for security reason clear structure */</span></span> <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(&amp;answer, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(TDSANSWER)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tds_flush_packet(tds); }</code> </pre> <br>  Ce n'√©tait pas le seul exemple avec des commentaires sur la ¬´s√©curit√©¬ª.  √Ä en juger par les commentaires, on peut supposer que la s√©curit√© est vraiment importante pour le projet.  Par cons√©quent, je joins toute la liste non petite des probl√®mes identifi√©s: <br><br><ul><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'heap'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  ncbi_heapmgr.c 1300 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'context'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 167 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'ks'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 339 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'md5_ctx'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 353 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider le tampon 'hash'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 365 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'ks'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 406 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'ntlm_v2_response'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  login.c 795 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'answer'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  login.c 801 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider le tampon 'packet'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  numeric.c 256 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider le tampon 'packet'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  numeric.c 110 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider le tampon 'pwd'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  getpassarg.c 50 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'context'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 188 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider le tampon 'buf'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 243 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider le tampon 'ntlm_v2_hash'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 309 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'md5_ctx'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 354 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider le tampon 'passwd_buf'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 380 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'ks'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 393 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider le tampon 'hash'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 394 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider le tampon 'ntlm2_challenge'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 395 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'ks'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 419 </li><li>  V597 Le compilateur pourrait supprimer l'appel de fonction 'memset', qui est utilis√© pour vider l'objet 'ntlm_v2_response'.  La fonction memset_s () doit √™tre utilis√©e pour effacer les donn√©es priv√©es.  challenge.c 556 </li></ul><br><h2>  Cycles suspects </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8ac/c77/124/8acc77124e5a13a1d25926c95d9eb2cf.png"></div><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V534</a> Il est probable qu'une mauvaise variable soit compar√©e √† l'int√©rieur de l'op√©rateur 'for'.  Pensez √† revoir ¬´i¬ª.  taxFormat.cpp 569 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CTaxFormat::x_LoadTaxTree(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>) { .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; alignTaxids.size(); i++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tax_id = alignTaxids[i]; .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; taxInfo.seqInfoList.size(); j++) { SSeqInfo* seqInfo = taxInfo.seqInfoList[j]; seqInfo-&gt;taxid = newTaxid; } .... } .... }</code> </pre> <br>  Je pense que, dans l'√©tat de la boucle int√©rieure, la variable <i>je l'</i> ai obtenue au hasard.  Au lieu de cela, la variable <i>j</i> doit √™tre utilis√©e. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V535</a> La variable 'i' est utilis√©e pour cette boucle et pour la boucle externe.  V√©rifiez les lignes: 302, 309. sls_alp.cpp 309 <br><br><pre> <code class="cpp hljs">alp::~alp() { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(d_alp_states) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;=d_nalp;i++) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { if(i&lt;=d_alp_states-&gt;d_dim) { if(d_alp_states-&gt;d_elem[i]) { for(i=0;i&lt;=d_nalp;i++) // &lt;= { .... .... }</span></span></code> </pre> <br>  Deux cycles identiques imbriqu√©s, dans lesquels le compteur global est √©galement r√©initialis√©, semblent tr√®s suspects.  Les d√©veloppeurs doivent v√©rifier ce qui se passe ici. <br><br><h2>  Indexation de tableau anormale </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4a8/136/5b2/4a81365b2534c606f6d12df389841299.png"></div><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V520</a> L'op√©rateur virgule ',' dans l'expression d'index du tableau '[- i2, - k]'.  nw_spliced_aligner16.cpp 564 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CSplicedAligner16::x_DoBackTrace ( <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Uint2* backtrace_matrix, CNWAligner::SAlignInOut* data, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i_global_max, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j_global_max) { .... <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(intron_length &lt; m_IntronMinSize || (Key &amp; donor) == <span class="hljs-number"><span class="hljs-number">0</span></span>) { Key = backtrace_matrix[--i2, --k]; ++intron_length; data-&gt;m_transcript.push_back(eTS_Intron); } .... }</code> </pre> <br>  Je dois dire tout de suite qu'il ne semble pas y avoir d'erreur (pour l'instant, lol).  Consid√©rez la ligne suivante: <br><br><pre> <code class="cpp hljs">Key = backtrace_matrix[--i2, --k];</code> </pre> <br>  Le mot ¬´matrice¬ª et la double indexation peuvent sugg√©rer que le tableau est bidimensionnel, mais ce n'est pas le cas.  Il s'agit d'un pointeur r√©gulier vers un tableau d'entiers.  Mais les diagnostics du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V520</a> ne sont pas apparus.  Les programmeurs sont vraiment confus quant √† la fa√ßon d'indexer les tableaux bidimensionnels. <br><br>  Dans ce cas, l'auteur a simplement d√©cid√© d'√©conomiser sur une seule ligne de code, bien qu'il puisse √©crire comme ceci: <br><br><pre> <code class="cpp hljs">--i2; Key = backtrace_matrix[--k];</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V661</a> Une expression suspecte 'A [B == C]'.  Signifiait probablement ¬´A [B] == C¬ª.  ncbi_service_connector.c 180 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> EHTTP_HeaderParse </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s_ParseHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* header, ....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">sscanf</span></span>(header, <span class="hljs-string"><span class="hljs-string">"%u.%u.%u.%u%n"</span></span>, &amp;i1, &amp;i2, &amp;i3, &amp;i4, &amp;n) &lt; <span class="hljs-number"><span class="hljs-number">4</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">sscanf</span></span>(header + n, <span class="hljs-string"><span class="hljs-string">"%hu%x%n"</span></span>, &amp;uuu-&gt;port, &amp;tkt, &amp;m) &lt; <span class="hljs-number"><span class="hljs-number">2</span></span> || (header[m += n] &amp;&amp; !(header[m] == <span class="hljs-string"><span class="hljs-string">'$'</span></span>) &amp;&amp; !<span class="hljs-built_in"><span class="hljs-built_in">isspace</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)((header + m) [header[m] == <span class="hljs-string"><span class="hljs-string">'$'</span></span>])))) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span><span class="hljs-comment"><span class="hljs-comment">/*failed - unreadable connection info*/</span></span>; } .... }</code> </pre> <br>  Un autre exemple de code dans lequel j'ai pass√© beaucoup de temps √† essayer de comprendre ce qui se passait: D.  La fonction <i>isspace ()</i> v√©rifie le caract√®re avec l'index <i>m</i> , mais si ce caract√®re est '$', alors le caract√®re avec l'index <i>m + 1 est</i> pass√© √† la fonction.  De plus, la comparaison avec ¬´$¬ª √©tait d√©j√† en avance.  Il n'y a peut-√™tre pas d'erreur ici, mais le code peut certainement √™tre r√©√©crit plus clairement. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V557 Le</a> d√©passement de matrice est possible.  L'index ¬´ligne¬ª pointe au-del√† de la limite du tableau.  aln_reader.cpp 412 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CAlnReader::x_IsGap(TNumrow row, TSeqPos pos, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&amp; residue) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_MiddleSections.size() == <span class="hljs-number"><span class="hljs-number">0</span></span>) { x_CalculateMiddleSections(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (row &gt; m_MiddleSections.size()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pos &lt; m_MiddleSections[row].first) { .... } .... }</code> </pre> <br>  Ici, il y a une grave erreur.  La v√©rification d'index de <i>ligne</i> correcte doit √™tre comme ceci: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (row &gt;= m_MiddleSections.size()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br>  Sinon, il est possible d'acc√©der aux donn√©es en dehors du vecteur <i>MiddleSections</i> . <br><br>  Beaucoup plus de tels endroits: <br><br><ul><li>  V557 Le d√©passement de matrice est possible.  L'index ¬´i¬ª pointe au-del√† de la limite du tableau.  resource_pool.hpp 388 </li><li>  V557 Le d√©passement de matrice est possible.  L'index ¬´ligne¬ª pointe au-del√† de la limite du tableau.  aln_reader.cpp 418 </li><li>  V557 Le d√©passement de matrice est possible.  L'index 'fmt_idx' pointe au-del√† de la limite du tableau.  seq_writer.cpp 384 </li><li>  V557 Le d√©passement de matrice est possible.  L'index 'fmt_idx' pointe au-del√† de la limite du tableau.  blastdb_formatter.cpp 183 </li><li>  V557 Le d√©passement de matrice est possible.  L'index 'num' pointe au-del√† de la limite du tableau.  newcleanupp.cpp 13035 </li></ul><br><h2>  Comment se m√©fier des fonctions </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/147/029/c18/147029c18e4ccacc04f11f688084034f.png"></div><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V570</a> La variable 'm_onClickFunction' est assign√©e √† elle-m√™me.  alngraphic.hpp 103 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetOnClickFunctionName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> onClickFunction)</span></span></span><span class="hljs-function"> </span></span>{ m_onClickFunction = m_onClickFunction; }</code> </pre> <br>  Il n'y a m√™me rien √† commenter.  Vous ne pouvez sympathiser qu'avec la personne qui a cliqu√© sur quelque chose, cliqu√©, mais rien n'a chang√©. <br><br>  Deux autres cas d'attribution de variables √† moi-m√™me r√©sulteront en une liste: <br><br><ul><li>  V570 La variable 'iter-&gt; level' est assign√©e √† elle-m√™me.  align_format_util.cpp 189 </li><li>  V570 La variable 'd_elements_values ‚Äã‚Äã[ind]' est assign√©e √† elle-m√™me.  sls_alp_data.cpp 1416 </li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V763 Le</a> param√®tre 'w1' est toujours r√©√©crit dans le corps de la fonction avant d'√™tre utilis√©.  bmfunc.h 5363 <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/// Bit COUNT functor template&lt;typename W&gt; struct bit_COUNT { W operator()(W w1, W w2) { w1 = 0; BM_INCWORD_BITCOUNT(w1, w2); return w1; } };</span></span></code> </pre> <br>  Une fonction dans laquelle l'argument est effiloch√© d√®s son entr√©e dans la fonction peut √™tre trompeuse pour les d√©veloppeurs qui l'utilisent.  Le code doit √™tre rev√©rifi√©. <br><br><h2>  Erreurs de conception de classe </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/033/e75/06c/033e7506c36604696731f73024f57c78.png"></div><br><br>  V688 L'argument de la fonction 'm_qsrc' poss√®de le m√™me nom que l'un des membres de la classe, ce qui peut entra√Æner une confusion.  compart_matching.cpp 873 <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CElementaryMatching</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> CObject { .... ISequenceSource * m_qsrc; .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x_CreateIndex</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ISequenceSource *m_qsrc, EIndexMode index_more, ....)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x_CreateRemapData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ISequenceSource *m_qsrc, EIndexMode mode)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x_LoadRemapData</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ISequenceSource *m_qsrc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&amp; sdb)</span></span></span></span>; .... };</code> </pre> <br>  Imm√©diatement, 3 fonctions de classe contiennent des arguments dont les noms co√Øncident avec le champ de classe.  Cela peut entra√Æner des erreurs dans les corps de fonction: le programmeur peut penser qu'il travaille avec un membre de la classe, changeant en fait la valeur de la variable locale. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V614</a> Variable non initialis√©e 'm_BitSet' utilis√©e.  SnpBitAttributes.hpp 187 <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/// SNP bit attribute container. class CSnpBitAttributes { public: .... private: /// Internal storage for bits. Uint8 m_BitSet; }; inline CSnpBitAttributes::CSnpBitAttributes(Uint8 bits) : m_BitSet(bits) { } inline CSnpBitAttributes::CSnpBitAttributes(const vector&lt;char&gt;&amp; octet_string) { auto count = sizeof(m_BitSet); auto byte = octet_string.end(); do m_BitSet = (m_BitSet &lt;&lt; 8) | *--byte; while (--count &gt; 0); }</span></span></code> </pre> <br>  L'un des constructeurs fonctionne de mani√®re <i>b√¢cl√©e</i> avec la variable <i>m_BitSet</i> .  Le fait est que la variable n'est pas initialis√©e.  Sa valeur ¬´garbage¬ª est utilis√©e √† la premi√®re it√©ration de la boucle, apr√®s quoi l'initialisation a lieu.  Il s'agit d'une erreur tr√®s grave, conduisant √† un comportement de programme ind√©fini. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V603</a> L'objet a √©t√© cr√©√© mais il n'est pas utilis√©.  Si vous souhaitez appeler le constructeur, 'this-&gt; SIntervalComparisonResult :: SIntervalComparisonResult (....)' doit √™tre utilis√©.  compare_feats.hpp 100 <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//This struct keeps the result of comparison of two exons struct SIntervalComparisonResult : CObject { public: SIntervalComparisonResult(unsigned pos1, unsigned pos2, FCompareLocs result, int pos_comparison = 0) : m_exon_ordinal1(pos1), m_exon_ordinal2(pos2), m_result(result), m_position_comparison(pos_comparison) {} SIntervalComparisonResult() { SIntervalComparisonResult(0, 0, fCmp_Unknown, 0); } .... };</span></span></code> </pre> <br>  Il y a tr√®s longtemps, je n'ai pas rencontr√© de telles erreurs lors de la v√©rification des projets.  Mais le probl√®me est toujours d'actualit√©.  L'erreur est que l'appel du constructeur param√©tr√© de cette mani√®re cr√©e et supprime un objet temporaire.  Et les champs de classe restent non initialis√©s.  Un autre constructeur doit √™tre appel√© via la liste d'initialisation (voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">D√©l√©gation de constructeur</a> ). <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V591</a> La fonction non vide doit renvoyer une valeur.  bio_tree.hpp 266 <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/// Recursive assignment CBioNode&amp; operator=(const CBioNode&amp; tree) { TParent::operator=(tree); TBioTree* pt = (TBioTree*)tree.GetParentTree(); SetParentTree(pt); }</span></span></code> </pre> <br>  L'analyseur consid√®re que la ligne est manquante dans l'instruction surcharg√©e: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> *<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>;</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V670</a> Le membre de classe non initialis√© 'm_OutBlobIdOrData' est utilis√© pour initialiser le membre 'm_StdOut'.  N'oubliez pas que les membres sont initialis√©s dans l'ordre de leurs d√©clarations √† l'int√©rieur d'une classe.  remote_app.hpp 215 <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NCBI_XCONNECT_EXPORT</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CRemoteAppResult</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: CRemoteAppResult(CNetCacheAPI::TInstance netcache_api, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> max_inline_size = kMaxBlobInlineSize) : m_NetCacheAPI(netcache_api), m_RetCode(<span class="hljs-number"><span class="hljs-number">-1</span></span>), m_StdOut(netcache_api, m_OutBlobIdOrData, m_OutBlobSize), m_OutBlobSize(<span class="hljs-number"><span class="hljs-number">0</span></span>), m_StdErr(netcache_api, m_ErrBlobIdOrData, m_ErrBlobSize), m_ErrBlobSize(<span class="hljs-number"><span class="hljs-number">0</span></span>), m_StorageType(eBlobStorage), m_MaxInlineSize(max_inline_size) { } .... };</code> </pre> <br>  3 avertissements de l'analyseur sont imm√©diatement √©mis pour ce fragment de code.  Les champs de classe sont initialis√©s non dans l'ordre dans lequel ils sont r√©pertori√©s dans la liste d'initialisation, mais dans la mani√®re dont ils sont d√©clar√©s dans la classe.  La cause classique de l'erreur est que tous les programmeurs ne se souviennent pas ou ne connaissent pas cette r√®gle.  Ici et dans la liste d'initialisation est juste le mauvais ordre.  On a l'impression que la liste des champs a √©t√© saisie dans un ordre al√©atoire. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V746 D√©coupe d'</a> objets.  Une exception doit √™tre intercept√©e par r√©f√©rence plut√¥t que par valeur.  cobalt.cpp 247 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CMultiAligner::SetQueries(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt; CRef&lt;objects::CBioseq&gt; &gt;&amp; queries) { .... <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { seq_loc-&gt;SetId(*it-&gt;GetSeqId()); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (objects::CObjMgrException e) { NCBI_THROW(CMultiAlignerException, eInvalidInput, (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>)<span class="hljs-string"><span class="hljs-string">"Missing seq-id in bioseq. "</span></span> + e.GetMsg()); } m_tQueries.push_back(seq_loc); .... }</code> </pre> <br>  La capture d'exceptions par valeur peut entra√Æner la perte de certaines informations sur l'exception en raison de la cr√©ation d'un nouvel objet.  Il est beaucoup mieux et plus s√ªr d'attraper une exception par r√©f√©rence. <br><br>  Lieux similaires: <br><br><ul><li>  V746 D√©coupe d'objets.  Une exception doit √™tre intercept√©e par r√©f√©rence plut√¥t que par valeur.  agp_validate_reader.cpp 562 </li><li>  V746 D√©coupe d'objets.  Une exception doit √™tre intercept√©e par r√©f√©rence plut√¥t que par valeur.  aln_build_app.cpp 320 </li><li>  V746 D√©coupe d'objets.  Une exception doit √™tre intercept√©e par r√©f√©rence plut√¥t que par valeur.  aln_test_app.cpp 458 </li><li>  V746 D√©coupe d'objets.  Une exception doit √™tre intercept√©e par r√©f√©rence plut√¥t que par valeur.  cobalt.cpp 691 </li><li>  V746 D√©coupe d'objets.  Une exception doit √™tre intercept√©e par r√©f√©rence plut√¥t que par valeur.  cobalt.cpp 719 </li><li>  V746 D√©coupe d'objets.  Une exception doit √™tre intercept√©e par r√©f√©rence plut√¥t que par valeur.  cobalt.cpp 728 </li><li>  V746 D√©coupe d'objets.  Une exception doit √™tre intercept√©e par r√©f√©rence plut√¥t que par valeur.  cobalt.cpp 732 </li></ul><br><h2>  √Ä propos du code inaccessible et d'autres probl√®mes d'ex√©cution de code </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d1/8f5/263/1d18f52633776adc7ca32f92446c4b9f.png"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V779</a> Code inaccessible d√©tect√©.  Il est possible qu'une erreur soit pr√©sente.  merge_tree_core.cpp 627 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CMergeTree::x_FindBefores_Up_Iter(....) { .... FirstFrame-&gt;Curr = StartCurr; FirstFrame-&gt;Returned = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; FirstFrame-&gt;VisitCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; FrameStack.push_back(FirstFrame); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!FrameStack.empty()) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Rel == CEquivRange::eAfter) { Frame-&gt;Returned = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; FrameStack.pop_back(); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Rel == CEquivRange::eBefore) { .... <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Frame-&gt;VisitCount == <span class="hljs-number"><span class="hljs-number">0</span></span>) { .... <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } } Frame-&gt;Returned = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">// &lt;= FrameStack.pop_back(); continue; } // end stack loop FirstFrame-&gt;ChildFrames.clear(); return FirstFrame-&gt;Returned; }</span></span></code> </pre> <br>  Le code de l'instruction conditionnelle est √©crit de mani√®re √† ce que toutes les branches du code se terminent par l'instruction <i>continue</i> .  Cela a conduit √† la formation de plusieurs lignes de code inaccessible dans la <i>boucle while</i> .  Ces lignes semblent tr√®s suspectes.  Tr√®s probablement, ce probl√®me est survenu apr√®s la refactorisation du code, et maintenant il n√©cessite une r√©vision minutieuse du code. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V519</a> La variable 'interval_width' re√ßoit des valeurs successives deux fois.  C'est peut-√™tre une erreur.  V√©rifiez les lignes: 454, 456. aln_writer.cpp 456 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CAlnWriter::AddGaps(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(exon_chunk-&gt;Which()) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CSpliced_exon_chunk::e_Match: interval_width = exon_chunk-&gt;GetMatch(); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CSpliced_exon_chunk::e_Mismatch: interval_width = exon_chunk-&gt;GetMismatch(); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CSpliced_exon_chunk::e_Diag: interval_width = exon_chunk-&gt;GetDiag(); genomic_string.append(....); product_string.append(....); genomic_pos += interval_width; product_pos += interval_width/res_width; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; .... } .... }</code> </pre> <br>  La variable <i>interval_width est</i> √©cras√©e plusieurs fois, car  il n'y a aucune instruction <i>break</i> dans les branches de <i>cas</i> .  Bien qu'un classique, mais une tr√®s mauvaise erreur. <br><br>  Quelques endroits plus suspects: <br><br><ul><li>  V779 Code inaccessible d√©tect√©.  Il est possible qu'une erreur soit pr√©sente.  dbapi_driver_utils.cpp 351 </li><li>  V779 Code inaccessible d√©tect√©.  Il est possible qu'une erreur soit pr√©sente.  net.c 780 </li><li>  V779 Code inaccessible d√©tect√©.  Il est possible qu'une erreur soit pr√©sente.  bcp.c 1495 </li><li>  V779 Code inaccessible d√©tect√©.  Il est possible qu'une erreur soit pr√©sente.  remote_blast.cpp 1470 </li><li>  V779 Code inaccessible d√©tect√©.  Il est possible qu'une erreur soit pr√©sente.  remote_blast.cpp 1522 </li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V571 Contr√¥le</a> r√©current.  La condition 'if (m_QueryOpts-&gt; filtering_options)' a d√©j√† √©t√© v√©rifi√©e √† la ligne 703. blast_options_local_priv.hpp 713 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">inline</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CBlastOptionsLocal::SetFilterString(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* f) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_QueryOpts-&gt;filtering_options) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { SBlastFilterOptions* old_opts = m_QueryOpts-&gt;filtering_options; m_QueryOpts-&gt;filtering_options = NULL; SBlastFilterOptionsMerge(&amp;(m_QueryOpts-&gt;filtering_options), old_opts, new_opts); old_opts = SBlastFilterOptionsFree(old_opts); new_opts = SBlastFilterOptionsFree(new_opts); } else { if (m_QueryOpts-&gt;filtering_options) // &lt;= m_QueryOpts-&gt;filtering_options = SBlastFilterOptionsFree(m_QueryOpts-&gt;filtering_options); m_QueryOpts-&gt;filtering_options = new_opts; new_opts = NULL; } .... }</span></span></code> </pre> <br>  De toute √©vidence, la branche <i>else</i> n√©cessite une r√©√©criture.  J'ai quelques id√©es que je voulais faire avec le pointeur <i>m_QueryOpts-&gt; filtering_options</i> , mais le code est toujours confus.  J'en appelle aux auteurs du code. <br><br>  Eh bien, le probl√®me ne vient pas seul: <br><br><ul><li>  V571 Contr√¥le r√©current.  La condition ¬´if (sleep time)¬ª a d√©j√† √©t√© v√©rifi√©e √† la ligne 205. request_control.cpp 208 </li><li>  V571 Contr√¥le r√©current.  La condition ¬´if (assignValue.empty ())¬ª a d√©j√† √©t√© v√©rifi√©e √† la ligne 712. classstr.cpp 718 </li></ul><br><h2>  Erreurs de lecture des donn√©es </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/761/548/f6b/761548f6b44470fe7b64db8ce0b0eb11.png"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V739</a> EOF ne doit pas √™tre compar√© √† une valeur de type 'char'.  La 'linestring [0]' doit √™tre de type 'int'.  alnread.c 3509 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> EBool </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s_AfrpInitLineData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( .... </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* linestring = readfunc (pfile); .... </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">while</span></span></span></span><span class="hljs-function"><span class="hljs-params"> (linestring != </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">NULL</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &amp;&amp; linestring [</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">] != EOF) { s_TrimSpace (&amp;linestring); .... } .... }</span></span></span></span></code> </pre> <br>  Les caract√®res que vous pr√©voyez de comparer avec EOF ne doivent pas √™tre stock√©s dans des variables <i>char</i> .  Sinon, il existe un risque qu'un caract√®re avec la valeur 0xFF (255) se transforme en -1 et soit interpr√©t√© de la m√™me mani√®re que la fin d'un fichier (EOF).  Aussi (juste au cas o√π), il vaut la peine de v√©rifier l'impl√©mentation de la fonction <i>readfunc</i> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La</a> boucle infinie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V663</a> est possible.  La condition ¬´cin.eof ()¬ª est insuffisante pour rompre la boucle.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pensez √† ajouter l'appel de fonction 'cin.fail ()' √† l'expression conditionnelle. </font><font style="vertical-align: inherit;">ncbicgi.cpp 1564</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::istream CNcbiIstream; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CCgiRequest::Serialize(CNcbiOstream&amp; os) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { .... CNcbiIstream* istrm = GetInputStream(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (istrm) { <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf[<span class="hljs-number"><span class="hljs-number">1024</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!istrm-&gt;eof()) { istrm-&gt;read(buf, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(buf)); os.write(buf, istrm-&gt;gcount()); } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'analyseur a d√©tect√© une erreur potentielle √† cause de laquelle une boucle infinie peut se produire. </font><font style="vertical-align: inherit;">Si une d√©faillance se produit lors de la lecture des donn√©es, l'appel de la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eof ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> renvoie toujours </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pour terminer la boucle dans ce cas, une v√©rification suppl√©mentaire de la valeur retourn√©e par la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fail ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est n√©cessaire </font><font style="vertical-align: inherit;">.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erreurs diverses </font></font></h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/132/51d/701/13251d701a22cae67c852d1bed7d33a5.png"></div><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V502</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L'op√©rateur '?:' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Fonctionne</font></a><font style="vertical-align: inherit;"> peut-√™tre d'une mani√®re diff√©rente de celle attendue. </font><font style="vertical-align: inherit;">L'op√©rateur '?:' A une priorit√© plus faible que l'op√©rateur '&amp;&amp;'. </font><font style="vertical-align: inherit;">ncbi_connutil.c 1135</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x_ClientAddress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* client_host, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/*bool*/</span></span></span></span><span class="hljs-function"><span class="hljs-params"> local_host)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((client_host == c &amp;&amp; x_IsSufficientAddress(client_host)) || !(ip = *c &amp;&amp; !local_host ? SOCK_gethostbyname(c) : SOCK_GetLocalHostAddress(eDefault)) || SOCK_ntoa(ip, addr, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(addr)) != <span class="hljs-number"><span class="hljs-number">0</span></span> || !(s = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>*) <span class="hljs-built_in"><span class="hljs-built_in">malloc</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(client_host) + <span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(addr) + <span class="hljs-number"><span class="hljs-number">3</span></span>))) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> client_host<span class="hljs-comment"><span class="hljs-comment">/*least we can do :-/*/</span></span>; } .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Faites attention √† l'expression: </font></font><br><br><pre> <code class="cpp hljs">!local_host ? SOCK_gethostbyname(c) : SOCK_GetLocalHostAddress(eDefault)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il n'est pas calcul√© comme pr√©vu par le programmeur, car l'expression enti√®re ressemble √† ceci: </font></font><br><br><pre> <code class="cpp hljs">ip = *c &amp;&amp; !local_host ? SOCK_gethostbyname(c) : SOCK_GetLocalHostAddress(...)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La priorit√© de l'op√©rateur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&amp;&amp;</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><font style="vertical-align: inherit;">sup√©rieure √† </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">?:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pour cette raison, le code ne s'ex√©cute pas comme pr√©vu. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V561</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il vaut probablement mieux attribuer une valeur √† la variable 'seq' que de la d√©clarer √† nouveau. </font><font style="vertical-align: inherit;">D√©claration pr√©c√©dente: validator.cpp, ligne 490. validator.cpp 492</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CValidator::IsSeqLocCorrectlyOrdered(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CSeq_loc&amp; loc, CScope&amp; scope) { CBioseq_Handle seq; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { CBioseq_Handle seq = scope.GetBioseqHandle(loc); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CObjMgrException&amp; ) { <span class="hljs-comment"><span class="hljs-comment">// no way to tell return true; } catch (const exception&amp; ) { // no way to tell return true; } if (seq &amp;&amp; seq.GetInst_Topology() == CSeq_inst::eTopology_circular) { // no way to check if topology is circular return true; } return CheckConsecutiveIntervals(loc, scope, x_IsCorrectlyOrdered); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âtant donn√© que le programmeur a d√©clar√© une nouvelle variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans la section try / catch, une autre variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reste non initialis√©e et est utilis√©e ci-dessous dans le code. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V562</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il est √©trange de comparer une valeur de type </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">bool√©en</font></a><font style="vertical-align: inherit;"> avec une valeur de 0: (((status) &amp; 0x7f) == 0)! = 0. ncbi_process.cpp 111</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CProcess::CExitInfo::IsExited(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { EXIT_INFO_CHECK; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (state != eExitInfo_Terminated) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> defined(NCBI_OS_UNIX) return WIFEXITED(status) != 0; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">elif</span></span></span><span class="hljs-meta"> defined(NCBI_OS_MSWIN) </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// The process always terminates with exit code return true; #endif }</span></span></span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rien de mauvais augure, mais WIFEXITED s'est av√©r√© √™tre une macro ouverture de cette fa√ßon: </font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (((status) &amp; <span class="hljs-number"><span class="hljs-number">0x7f</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) != <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'av√®re que la fonction renvoie la valeur oppos√©e. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans le code, il y avait une autre fonction de ce type, qui a √©mis un avertissement:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V562 Il est √©trange de comparer une valeur de type bool√©en avec une valeur de 0. ncbi_process.cpp 126 </font></font></li></ul><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V595</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Le pointeur 'dst_len' a √©t√© utilis√© avant d'√™tre v√©rifi√© par rapport √† nullptr. </font><font style="vertical-align: inherit;">V√©rifiez les lignes: 309, 315. zlib.cpp 309</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CZipCompression::CompressBuffer( <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* src_buf, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> src_len, <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* dst_buf, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> dst_size, <span class="hljs-comment"><span class="hljs-comment">/* out */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>* dst_len) { *dst_len = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Check parameters if (!src_len &amp;&amp; !F_ISSET(fAllowEmptyData)) { src_buf = NULL; } if (!src_buf || !dst_buf || !dst_len) { SetError(Z_STREAM_ERROR, "bad argument"); ERR_COMPRESS(48, FormatErrorMessage("CZipCompression::CompressBuffer")); return false; } .... }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le pointeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dst_len est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©r√©f√©renc√© au tout d√©but de la fonction, tandis que plus loin dans le code est v√©rifi√© l'√©galit√© √† z√©ro. </font><font style="vertical-align: inherit;">Une erreur a √©t√© commise dans le code qui conduit √† un comportement non d√©fini si le pointeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dst_len</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nullptr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V590</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Envisagez d'inspecter l' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">expression</font></a><font style="vertical-align: inherit;"> 'ch! =' \ 0 '&amp;&amp; ch ==' ''. </font><font style="vertical-align: inherit;">L'expression est excessive ou contient une erreur d'impression. </font><font style="vertical-align: inherit;">cleanup_utils.cpp 580</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Asn2gnbkCompressSpaces</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&amp; val)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (ch != <span class="hljs-string"><span class="hljs-string">'\0'</span></span> &amp;&amp; ch == <span class="hljs-string"><span class="hljs-string">' '</span></span>) { ptr++; ch = *ptr; } .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La condition d'arr√™t de la boucle ne d√©pend que de si le caract√®re </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ch est un</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> espace ou non. </font><font style="vertical-align: inherit;">L'expression peut √™tre simplifi√©e comme suit:</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (ch == <span class="hljs-string"><span class="hljs-string">' '</span></span>) { .... }</code> </pre> <br><h2>  Conclusion </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisation de programmes informatiques dans la recherche scientifique aide et contribuera √† faire des d√©couvertes. </font><font style="vertical-align: inherit;">Esp√©rons que ceux qui sont particuli√®rement importants ne seront pas manqu√©s √† cause d'une faute de frappe. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'invite les d√©veloppeurs du projet NCBI Genome Workbench √† nous contacter et nous fournirons un rapport complet publi√© par l'analyseur PVS-Studio. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'esp√®re que cette petite recherche de code permet de corriger de nombreux bugs et d'am√©liorer g√©n√©ralement la fiabilit√© du projet. </font><font style="vertical-align: inherit;">Essayez d'ex√©cuter PVS-Studio sur le code de vos projets, si vous ne l'avez pas d√©j√† fait. </font><font style="vertical-align: inherit;">Vous pouvez l'aimer :).</font></font><br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Svyatoslav Razmyslov. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NCBI Genome Workbench: la recherche scientifique menac√©e</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr430476/">https://habr.com/ru/post/fr430476/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr430466/index.html">Mini AI Cup # 3: √âcrire un top bot</a></li>
<li><a href="../fr430468/index.html">Sensibiliser les citoyens</a></li>
<li><a href="../fr430470/index.html">Pourquoi maintenir le contexte sur le compte client - honn√™tement et de mani√®re rentable</a></li>
<li><a href="../fr430472/index.html">R√©seau DECT sans couture bricolage</a></li>
<li><a href="../fr430474/index.html">CephFS vs GlusterFS</a></li>
<li><a href="../fr430478/index.html">Trading de bots pour le march√© des crypto-monnaies. Par o√π commencer?</a></li>
<li><a href="../fr430480/index.html">Au moment o√π nous √©crivions l'application au hackathon du NASA Space Apps Challenge</a></li>
<li><a href="../fr430482/index.html">Le th√®me des plaques d'armure dans la culture de l'Est et de l'Ouest</a></li>
<li><a href="../fr430484/index.html">Sc√©narios d'impl√©mentation NGFW typiques</a></li>
<li><a href="../fr430486/index.html">Comment vivent les pigistes: d'un d√©veloppeur √† un r√©dacteur technique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>