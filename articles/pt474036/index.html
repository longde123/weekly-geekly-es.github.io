<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñïüèª ‚ñ∂Ô∏è üë®üèæ‚Äçüé® A edi√ß√£o de texto tamb√©m te odeia üéè üë®üèæ‚Äçüîß üë®‚Äçüî¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O artigo de Alexis Bingessner, ‚ÄúText Rendering Hates You‚Äù, publicado h√° um m√™s , √© muito pr√≥ximo a mim. 

 Em 2017, eu estava desenvolvendo um editor ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>A edi√ß√£o de texto tamb√©m te odeia</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474036/">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O</a> artigo de Alexis Bingessner, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">‚ÄúText Rendering Hates You‚Äù,</a> publicado h√° um m√™s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">, √©</a> muito pr√≥ximo a mim. <br><br>  Em 2017, eu estava desenvolvendo um editor de texto interativo em um navegador.  Insatisfeito com as bibliotecas ContentEditable existentes, pensei: ‚ÄúEi, redescobri a sele√ß√£o de texto!  Isso √© dif√≠cil?  Eu era jovem.  Ing√™nuo.  Imaginei que poderia lidar com isso em duas semanas.  De fato, uma tentativa de resolver esse problema levou v√°rios anos da minha vida, incluindo um ano de trabalho remunerado da manh√£ at√© a noite para desenvolver um editor de texto para o novo sistema operacional. <br><br>  No trabalho, tive a sorte de aprender muito com <abbr title="como sempre, gra√ßas a Raf Levien e Yokhey Yukawa, que me ensinaram tudo o que sei sobre digita√ß√£o">mentores com vasta experi√™ncia neste campo</abbr> .  Eu ouvi muitas, muitas hist√≥rias assustadoras.  Incluindo um engenheiro que deu suporte a um aplicativo Windows com uma implementa√ß√£o personalizada de um campo de texto - e queria mudar de uma API de entrada de texto desatualizada para uma nova vers√£o.  Aqui est√° uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">lista de interfaces de</a> entrada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">de</a> texto nesta nova vers√£o: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/905/ade/db0/905adedb0a3bd875236bfadd2c9f533d.png"><br><a name="habracut"></a><br>  √â isso mesmo, 128 interfaces para inserir texto.  Tenho quase certeza de que existem oito (8!) Tipos diferentes de bloqueios para corrigir problemas de simultaneidade, embora eu honestamente n√£o tenha lido a documenta√ß√£o deles, n√£o me cite sobre isso.  Esse engenheiro, um ano e meio (em tempo integral!), Modificou seu editor, mas no final falhou e permaneceu na API antiga. <br><br>  Digitar √© dif√≠cil. <br><br>  Alexis √†s vezes menciona a sele√ß√£o de texto, mas sua experi√™ncia pessoal est√° mais relacionada √† renderiza√ß√£o.  Como pessoa, por outro lado, posso acrescentar alguns pontos sobre a entrada. <br><br><h3>  Movimento vertical do cursor </h3><br>  Eu j√° cobri isso em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo anterior</a> , mas podemos repetir rapidamente aqui. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d7/dcb/be8/2d7dcbbe886a8da0e23abaf51f092ced.png"></div><br><br>  Neste exemplo, se voc√™ pressionar para cima, o cursor vai para o in√≠cio da linha, antes da palavra <i>hello</i> .  At√© agora, tudo √© bastante razo√°vel.  Mas se voc√™ pressionar para cima e depois para baixo, o cursor primeiro pular√° na frente do <i>ol√°</i> e depois permanecer√° depois de <i>alguns</i> . <br><br>  Isso pode n√£o parecer muito l√≥gico.  Voc√™ pergunta por que ele pula para a direita?  Bem, com movimentos verticais, cada cursor lembra a posi√ß√£o <i>x</i> em pixels e s√≥ √© atualizada quando pressionada √† esquerda ou √† direita, e n√£o para cima e para baixo.  O mesmo comportamento impede que os cursores se movam para a esquerda ao se mover verticalmente atrav√©s de linhas curtas. <br><br><h3>  Proximidade </h3><br>  Ok, agora sabemos que, quando selecionamos o texto, temos <i>duas</i> partes de estado: o byte offset dentro da linha e a coordenada <i>x</i> em pixels, mencionados acima.  O problema foi resolvido?  Bem, n√£o. <br><br>  Considere duas posi√ß√µes de cursor em uma linha muito longa: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf1/a02/0f5/bf1a020f5aa7512ad957b47717fd4bc2.png"></div><br><br>  Como <i>loooooooooong</i> √© uma palavra, duas posi√ß√µes do cursor t√™m <i>exatamente o mesmo deslocamento de bytes na string</i> .  N√£o h√° nova linha entre eles, pois a linha √© suavemente quebrada.  Nossos cursores precisam de um pouco mais que lhes diga para qual linha ir.  A maioria dos sistemas chama isso de afinidade de bit.  Tamb√©m √© usado em texto bidirecional misto, sobre o qual falaremos em breve. <br><br><h3>  Modificadores de Emoji </h3><br>  Suponha que eu envie uma mensagem para um amigo.  Para expressar meus sentimentos, quero adicionar um emoji engra√ßado.  Entro na √°rea de texto um polegar para cima, <code>a</code> letra e um emoji modificador para o tom de pele.  √â assim: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4fd/f6b/1e8/4fdf6b1e84ddd2774b68d335e8b597b8.png"></div><br><br>  Ah, eu n√£o queria escrever uma carta.  Defino o cursor ap√≥s ele e clique em Backspace.  O que vai acontecer?  Eu vi v√°rias op√ß√µes, dependendo do editor. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/237/c58/054/237c580542b2d5921a07adbdfb2d32c5.png"></div><br><br><ul><li>  <b>Mau # 1</b> pode <i>parecer</i> certo.  Mas √© assim que um editor de texto funciona com suporte √† renderiza√ß√£o de emoji herdada, por exemplo, Texto Sublime.  Isso √© ruim porque o emoji de dedo claro √© codificado como um dedo amarelo, seguido imediatamente por um modificador de tom de pele.  Eles n√£o s√£o combinados em um s√≠mbolo, conforme o esperado.  Mesmo se eu copiar o dedo leve de outro aplicativo, ele ainda n√£o ser√° exibido corretamente, como aqui. <br></li><li>  <b>Mau # 2</b> √© o que o Chrome 77 faz na barra de endere√ßos.  N√£o nas p√°ginas da web, mas apenas na barra de endere√ßo.  Isso n√£o √© um problema de renderiza√ß√£o, pois o emoji de copiar e colar com tons de pele funciona.  Em vez disso, o Chrome exclui a letra e, tendo notado o modificador ap√≥s a letra, tamb√©m a exclui.  Opa <br></li><li>  <b>O n√∫mero 3 ruim</b> corresponde √† especifica√ß√£o Unicode de como os emojis devem ser mesclados.  Mas isso √© incompreens√≠vel para os usu√°rios e, a prop√≥sito, voc√™ precisa mover o cursor para que ele n√£o fique preso no meio do emoji. </li></ul><br>  Todas as op√ß√µes s√£o ruins, ent√£o voc√™ pode assumir que provavelmente existe uma quarta op√ß√£o.  Existe!  Muitos editores, como o TextEdit, nem permitem que voc√™ coloque o cursor ap√≥s a letra, pois o modificador de tom de pele √© considerado uma unidade √∫nica com o caractere anterior.  Isso faz sentido no contexto de emoji e at√© funciona bem nesse caso, mas e se o modificador for indicado pelo primeiro caractere na string? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ef/a2e/3ad/2efa2e3ad0396bd2362cd08694c841fc.png"></div><br><br>  Agora o modificador altera o caractere de nova linha.  O TextEdit n√£o permitir√° que voc√™ coloque o cursor no in√≠cio da segunda linha!  Pessoalmente, considero esta decis√£o "tamb√©m ruim". <br><br>  Voc√™ tamb√©m deve ter notado que o polegar para cima se tornou o polegar para baixo.  Eu mesmo fiz isso para refletir meus sentimentos sobre toda a situa√ß√£o. <br><br>  A prop√≥sito, o TextEdit especificamente torna o cursor na primeira linha <i>muito</i> buggy.  Por exemplo, adivinhe o que acontece se eu pressionar <code>4</code> aqui? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c8/988/687/1c898868781c9461aba7ab1e7cb74255.png"></div><br><br>  Sim  Voc√™ tamb√©m pode pensar que h√° espa√ßos entre os n√∫meros.  Eles n√£o est√£o l√°. <br><br><h3>  Texto bidirecional </h3><br>  Alexis menciona sele√ß√µes divididas em texto bidirecional misto, como neste exemplo de TextEdit: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/14b/dd3/8c3/14bdd38c366451ff768fc4aa15dc17b3.png"></div><br><br>  Isso realmente faz sentido, j√° que o idioma √°rabe nas linhas √© codificado da direita para a esquerda, de modo que a sele√ß√£o parece ser dividida, mas bytes √© um intervalo cont√≠nuo. <br><br>  Portanto, √© um pouco surpreendente que possamos obter essa sele√ß√£o: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/53d/d86/9aa/53dd869aa064eb6ebc8cac8114147800.png"></div><br><br>  Sim, √© visualmente cont√≠nuo, mas separado por bytes.  Sim, √© ruim.  Alguns editores fazem isso se voc√™ selecionar texto com as teclas de seta em vez do mouse.  Uma alternativa √© trocar as teclas esquerda / direita dentro do texto pela dire√ß√£o da direita para a esquerda, o que tamb√©m √© ruim.  N√£o h√° boas op√ß√µes aqui. <br><br>  Como b√¥nus, tente entender o que est√° acontecendo aqui: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e88/2bb/b48/e882bbb480ea0a67812b862fc778d815.png"></div><br><br>  Senhor ... eu n√£o quero comentar sobre isso. <br><br><h3>  A coisa sobre m√©todos de entrada </h3><br>  O software que converte pressionamentos de teclas em entrada √© chamado de m√©todo de entrada ou editor de m√©todos de entrada.  Para o alfabeto latino, esse n√£o √© um software muito interessante, pois cada pressionamento de tecla est√° diretamente associado √† inser√ß√£o de um caractere.  Mas em muitos scripts, os caracteres n√£o se encaixam no teclado, ent√£o voc√™ precisa ser criativo.  Por exemplo, em alguns m√©todos de entrada para o idioma chin√™s, o usu√°rio digita sons - e obt√©m uma lista de caracteres semelhantes no som: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/257/4be/547/2574be547e63c1408db959a8bd107c90.png"></div><br><br>  √Äs vezes, esse campo √© chamado de regi√£o de composi√ß√£o e geralmente aparece <abbr title="√°rea de composi√ß√£o">acima do texto sublinhado</abbr> .  √Äs vezes, o m√©todo de entrada precisa estiliz√°-lo.  Por exemplo, o m√©todo de entrada japon√™s no Android usa a cor de fundo para criar uma √°rea de compartilhamento de frases: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b27/583/4c2/b275834c23880b9375d4da714632f1cc.png"></div><br>  <i><font color="gray">(Obrigado a Shae pela captura de tela!)</font></i> <br><br>  Todas essas sele√ß√µes e √°reas de composi√ß√£o interagem com o texto bidirecional?  N√£o vamos pensar sobre isso. <br><br>  Os m√©todos de entrada devem funcionar em qualquer lugar, <i>mesmo dentro do terminal</i> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/24d/b76/f54/24db76f544a936d70edb9143a36fdba0.png"></div><br><br>  Nada ir√° para o Vim at√© que um caractere chin√™s seja selecionado na lista.  Voc√™ provavelmente pensa: "Mas como isso funciona no modo de comando do Vim?"  N√£o √© muito bom.  √â por isso que, na Internet, a entrada de texto e as teclas s√£o eventos separados.  No console, eles se misturam, causando problemas. <br><br>  Este √© apenas um exemplo de muitos m√©todos diferentes de entrada de texto.  (N√£o se esque√ßa dos m√©todos de entrada sem teclado, como voz e escrita!) Felizmente, o sistema operacional fornece todos esses m√©todos.  Mas, infelizmente, sua caixa de texto deve falar o protocolo geral de entrada de texto usado por todos esses m√©todos.  Para Windows, essas s√£o as 128 interfaces listadas no in√≠cio do artigo.  Em outros sistemas operacionais, as interfaces s√£o mais simples, mas ainda s√£o dif√≠ceis de implementar. <br><br>  Voc√™ tamb√©m pode observar que o m√©todo de entrada √© um processo separado; portanto, o m√©todo de entrada e o aplicativo podem fazer altera√ß√µes no estado do campo de texto.  Este √© realmente um protocolo de edi√ß√£o paralela.  O Windows resolve o problema com oito (8!) Tipos de bloqueios.  Embora manter um bloqueio nos limites do processo possa parecer duvidoso, a maioria das outras plataformas tenta usar heur√≠sticas imperfeitas para corrigir problemas de simultaneidade.  Ou eles apenas esperam que a condi√ß√£o da corrida n√£o aconte√ßa.  Na minha experi√™ncia, a ora√ß√£o n√£o √© um primitivo muito eficaz do paralelismo. <br><br><h3>  Por que tudo √© t√£o complicado? </h3><br>  Jonathan Blow, em uma palestra sobre degrada√ß√£o de software, menciona o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">editor de texto Ken Thompson</a> , que ele escreveu em uma semana.  A maior parte do c√≥digo deste artigo √© introduzida aleatoriamente complexidade.  O Windows realmente precisa de 128 interfaces e 8 tipos de bloqueios para entrada de texto?  De jeito nenhum.  Os erros no TextEdit s√£o o resultado de um modelo de edi√ß√£o complexo?  Sim  A dispers√£o de bugs nos programas modernos √© algo com que se preocupar?  Pelo menos para mim √©. <br><br>  No entanto, o editor de Ken Thompson tamb√©m era muito, muito mais simples do que esperamos dos editores de texto modernos.  O Unicode suporta quase todas as l√≠nguas vivas do mundo (existem cerca de 7.000) e muitas outras est√£o mortas.  Existem scripts diferentes, instru√ß√µes de texto e m√©todos de entrada, cada um dos quais imp√µe restri√ß√µes complexas (e em alguns casos insol√∫veis) a qualquer editor.  Mas ele tamb√©m deve suportar leitores de tela. <br><br>  Uma enorme complexidade acumula-se <i>inevitavelmente</i> e, neste artigo, apenas a tocamos um pouco.  Este √© um verdadeiro milagre da programa√ß√£o: voc√™ pode simplesmente colocar <code>&lt;textarea&gt;</code> em uma p√°gina da web - e fornecer instantaneamente entrada de texto para todos os usu√°rios da Internet ao redor do mundo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt474036/">https://habr.com/ru/post/pt474036/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt474020/index.html">Como Methodius se tornou Anna: a experi√™ncia de desenvolver e lan√ßar classificadores de mensagens de voz. Parte 3</a></li>
<li><a href="../pt474024/index.html">Transformamos um rob√¥ aspirador de p√≥ em um soldado universal</a></li>
<li><a href="../pt474026/index.html">Hist√≥rias de consumidores, a Asos abandonando sua revista e o TikTok</a></li>
<li><a href="../pt474028/index.html">Quais habilidades sociais os desenvolvedores precisam? Opini√µes de Yandex</a></li>
<li><a href="../pt474032/index.html">Organizando c√©lulas padr√£o (notas de algu√©m de fora)</a></li>
<li><a href="../pt474038/index.html">Atualiza√ß√µes peri√≥dicas de dados</a></li>
<li><a href="../pt474040/index.html">Entrevista Playboy: Steve Jobs, Parte 1</a></li>
<li><a href="../pt474042/index.html">Competi√ß√£o! Hist√≥rias √† luz de servidores tr√™mulos ...</a></li>
<li><a href="../pt474046/index.html">Semin√°rios sobre servi√ßos em nuvem, IA, blockchain, Data Science, microsservi√ßos: agora em Moscou e S√£o Petersburgo</a></li>
<li><a href="../pt474048/index.html">HILDACRYPT: novo ransomware atinge sistemas de backup e solu√ß√µes antiv√≠rus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>