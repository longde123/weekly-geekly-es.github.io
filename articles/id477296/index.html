<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😤 🛍️ 👩‍🔧 Fungsi Buildargv dengan Ragel 🐇 🚶🏿 🤛🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Penggunaan menyenangkan Kompilator Mesin Negara Ragel untuk membuat fungsi parsing garis pada int argc, char * argv []. 


 Semuanya dimulai dengan fa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Fungsi Buildargv dengan Ragel</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477296/"><p>  Penggunaan menyenangkan Kompilator Mesin Negara Ragel untuk membuat fungsi parsing garis pada int argc, char * argv []. </p><br><p>  Semuanya dimulai dengan fakta bahwa fungsi buildargv diperlukan untuk mengurai string untuk transfer selanjutnya </p><br><pre><code class="plaintext hljs">int main (int argc, char *argv[]) { body }</code> </pre> <br><p>  Yah, saya pikir, tidak mungkin bahwa tidak mungkin untuk meminjam di mana pun, sekarang kita menemukan ... Dan saya tidak menemukan ... </p><br><p><img src="https://habrastorage.org/webt/ct/4-/9a/ct4-9akw_i6lf-noagjfsi2_h4q.png"></p><a name="habracut"></a><br><p>  Yah, bukannya saya tidak akan menemukannya sama sekali, misalnya, <a href="">https://github.com/gcc-mirror/gcc/blob/master/libiberty/argv.c</a> (GPLv2 selalu baik), saya langsung mengambil kewajiban seperti itu belum siap.  Pasti ada fungsi seperti itu di bash (GPLv3 bahkan lebih baik).  zsh?  - Pergi mencari (saya menemukan ... - Saya tidak mau). </p><br><p>  Secara umum, saya tidak menemukan apa yang saya inginkan, tetapi saya tidak menyukai apa yang saya temukan.  Ya, pada akhirnya saya punya hak untuk melakukannya, sama saja, saya membuat saya sendiri haus akan hiburan dalam prosesnya. </p><br><p>  Saya tidak ingin menulis kasus ini dengan cara konvensional dari kata sama sekali, saya bahkan kesal dengan alasan ini. </p><br><p>  Secara umum, kami bertemu Ragel State Machine Compiler. </p><br><h1>  Toolkit </h1><br><ul><li>  gcc;) </li><li>  kain perca </li><li>  membuat </li><li>  lcov </li><li>  libcheck </li></ul><br><p>  Proyek ini dapat ditemukan di sini: <a href="https://github.com/maquefel/cmdline">CMDLINE PARSER JOYFUL TERTULIS DI RAGEL</a> </p><br><h1>  Pernyataan masalah </h1><br><p>  Pada input, kami memiliki string dalam bentuk apa pun, tugasnya adalah mendapatkan dari argumen array yang dipisahkan oleh spasi atau tab, dengan: </p><br><ul><li>  Setiap karakter yang mengikuti karakter pelarian <code>\</code> harus diabaikan. </li><li>  Setiap karakter yang berada di antara dua ganda atau harus <br>  dianggap satu elemen </li><li>  Dalam hal <code>'</code> atau <code>'</code> tertutup, kesalahan akan dikembalikan </li></ul><br><p>  Secara umum, tidak ada banyak kondisi.  Dan Ragel sangat cocok untuk tugas ini. </p><br><h1>  Implementasi yang Dijelaskan </h1><br><p>  Mari mendeklarasikan mesin dengan nama "buildargv" dan meminta Ragel untuk menempatkan datanya di awal file (5.8.1 Tulis Data). </p><br><pre> <code class="plaintext hljs">%%{ machine buildargv; write data; }%%</code> </pre> <br><p>  Selanjutnya, kami mendeklarasikan mesin <code>lineElement</code> , yang pada gilirannya terdiri dari menggabungkan (2.5.1 Union) dua mesin: <code>arg</code> dan <code>whitespace</code> . </p><br><pre> <code class="plaintext hljs">lineElement = arg &gt;start_arg %end_arg | whitespace; main := blineElements**;</code> </pre> <br><p>  Pada input dan output dari mesin <code>arg</code> , masing-masing tindakan <code>start_arg</code> dan <code>end_arg</code> . </p><br><pre> <code class="plaintext hljs">action start_arg { argv_s = p; } action end_arg { nargv = (char**)realloc((*argv), (argc_ + 1)*sizeof(char*)); (*argv) = nargv; (*argv)[argc_] = strndup(argv_s, p - argv_s); argc_++; }</code> </pre> <br><p>  Selain itu, tugas <code>start_arg</code> untuk menyimpan posisi karakter pada input, dan tugas <code>end_arg</code> menambahkan elemen baru ke array <code>argv</code> , jika berhasil keluar dari mesin <code>arg</code> . </p><br><p>  Sekarang mari kita melihat lebih dekat pada <code>arg</code> . </p><br><pre> <code class="plaintext hljs">arg = '\''&gt; { fcall squote; } | '"'&gt;{ fcall dquote; } | ( '\\'&gt;{fcall skip;} | ^[ \t"'\\] )+;</code> </pre> <br><p>  Terdiri dari penyatuan tiga mesin <code>'</code> , <code>"</code> dan <code>(\ | ^[ \t"'\])</code> , yang terakhir pada gilirannya adalah penyatuan masing-masing dari <code>\</code> dan <code>^[ \t"'\]</code> . </p><br><p>  Ketika kita menemukan karakter <code>'</code> kita panggil <code>squote</code> , <code>'</code> kita sebut <code>squote</code> , atau jika karakter saat ini <code>\</code> sebut <code>skip</code> , yang melompati setiap karakter yang mengikutinya, dan karakter apa pun tidak <code>0x20</code> (spasi), <code>0x09</code> (tab), <code>'</code> , <code>"</code> atau <code>\</code> dianggap benar . </p><br><p>  Masih mempertimbangkan bagian yang sangat kecil: </p><br><pre> <code class="plaintext hljs">skip := any @{ fret; }; dquote := ( '\\'&gt;{ fcall skip; } | ^[\\] )+ :&gt; ["] @{ fret; } @err(dquote_err); squote := ( '\\'&gt;{ fcall skip; } | ^[\\] )+ :&gt; ['] @{ fret; } @err(squote_err);</code> </pre> <br><p>  Dengan <code>skip</code> kita sudah tahu apa yang harus dilakukan <code>^['\\]</code> juga tidak menimbulkan pertanyaan.  Dan di sini <code>:&gt;</code> ini adalah <code>Entry-Guarded Concatenation</code> (4.2 Operator yang dijaga yang merangkum Prioritas) artinya adalah mesin <code>( '\\'&gt;{ fcall skip; } | ^['\\] )+</code> menyelesaikan eksekusi ketika <code>["]</code> kembali ke keadaan awal. </p><br><p>  Dan akhirnya, dalam kasus kesalahan end-of-line dengan tanda kutip terbuka, <code>dquote_err</code> dan <code>squote_err</code> untuk menunjukkan dan mengatur kode kesalahan yang sesuai. </p><br><pre> <code class="plaintext hljs">action dquote_err { ret = -1; errsv = BUILDARGV_EDQUOTE; } action squote_err { ret = -1; errsv = BUILDARGV_ESQUOTE; }</code> </pre> <br><p>  Pembuatan kode dilakukan oleh perintah: </p><br><pre> <code class="plaintext hljs">ragel -e -L -F0 -o buildargv.c buildargv.rl</code> </pre> <br><p>  Daftar garis uji dapat ditemukan di <code>test_cmdline.c</code> . </p><br><h1>  Kesimpulan </h1><br><p>  Masalahnya terpecahkan. </p><br><p>  Apakah lebih cepat?  Saya meragukannya.  Lebih jelas?  Andai Anda seorang ahli Ragel. </p><br><p>  Saya tidak berpura-pura absolutisme, saya akan berterima kasih atas komentar konstruktif pada kode Ragel. </p><br><p>  Daftar bahan: </p><br><p>  [^ 1]: <a href="http://www.colm.net/files/ragel/ragel-guide-6.10.pdf">Adrian Thurston.</a>  <a href="http://www.colm.net/files/ragel/ragel-guide-6.10.pdf"><em>Kompiler Mesin Negara Ragel</em> .</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id477296/">https://habr.com/ru/post/id477296/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id477286/index.html">Aksioma atau Ambil: apa yang akan digunakan pada 2019?</a></li>
<li><a href="../id477288/index.html">John Lewis di 2018 Undoing Aging Conference</a></li>
<li><a href="../id477290/index.html">Acara digital di Moskow dari 25 November hingga 1 Desember</a></li>
<li><a href="../id477292/index.html">Acara digital di St. Petersburg dari 25 November hingga 1 Desember</a></li>
<li><a href="../id477294/index.html">Python untuk AI: Pertandingan yang dibuat di surga</a></li>
<li><a href="../id477298/index.html">Apa yang ada di dalam bandara: pusat kendali</a></li>
<li><a href="../id477300/index.html">Apa yang ada di dalam bandara regional terbaik di negara ini: layanan terminal</a></li>
<li><a href="../id477304/index.html">CDN Dinamis untuk Streaming WebRTC Latensi Rendah</a></li>
<li><a href="../id477306/index.html">Dari Produksi-Ke-Gaji ke Produksi-Ke-Pesanan. Urutan langkah-langkah dan contoh implementasi praktis</a></li>
<li><a href="../id477308/index.html">Clone Numpy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>