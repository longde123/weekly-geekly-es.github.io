<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåò üòü üë©üèº‚Äçü§ù‚Äçüë®üèæ Otimiza√ß√£o ou como n√£o dar um tiro no pr√≥prio p√© ü•® üèóÔ∏è üßëüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bom dia a todos. Hoje eu quero falar com voc√™ sobre otimiza√ß√£o. O que √©, por que √© necess√°rio e, o mais importante, como garantir que n√£o d√≥i dolorosa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Otimiza√ß√£o ou como n√£o dar um tiro no pr√≥prio p√©</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/469127/"><p>  Bom dia a todos.  Hoje eu quero falar com voc√™ sobre otimiza√ß√£o.  O que √©, por que √© necess√°rio e, o mais importante, como garantir que n√£o d√≥i dolorosamente ent√£o. </p><br><a name="habracut"></a><p>  Primeiro, entenderemos o que √© otimiza√ß√£o em geral e o que √© otimiza√ß√£o em JS.  Ent√£o, otimiza√ß√£o √© a melhoria de algo de acordo com alguma caracter√≠stica quantitativa.  JS identificou quatro caracter√≠sticas quantitativas para si: </p><br><p>  <b>A quantidade de c√≥digo</b> - geralmente √© aceito que quanto menos linhas de c√≥digo escritas, mais produtivo e melhor.  Minha opini√£o √© fundamentalmente diferente, porque, ao escrever uma linha de c√≥digo, voc√™ pode criar um vazamento de mem√≥ria ou ciclo perp√©tuo que o navegador simplesmente morre. </p><br><p>  <b>Velocidade (desempenho)</b> √© a chamada complexidade computacional, ou seja, o n√∫mero de a√ß√µes que o analisador precisar√° executar para executar a instru√ß√£o. </p><br><p>  <b>Velocidade de constru√ß√£o</b> - n√£o √© segredo que agora quase nenhum dos projetos pode ficar sem construtores como Webpack ou Gulp, portanto, esse recurso exibe a corre√ß√£o das configura√ß√µes do construtor de projetos.  Acredite, quando o servidor √© um pouco mais inteligente que o moedor de caf√©, isso se torna importante. </p><br><p>  <b>Reutiliza√ß√£o de c√≥digo</b> - essa caracter√≠stica mostra como a arquitetura para reutilizar fun√ß√µes, componentes e m√≥dulos √© constru√≠da. <br>  Considere cada uma das categorias com mais detalhes; analisaremos quais caracter√≠sticas ela inclui e do que depende. </p><br><p>  <b>Volume do c√≥digo:</b> <br><br></p><ul><li>  Dobragem.  Quanto c√≥digo do mesmo tipo foi escrito em lugares diferentes; </li><li>  Coment√°rios  Os coment√°rios no c√≥digo s√£o bons, mas me deparei com projetos nos quais havia mais coment√°rios do que c√≥digo; </li><li>  Falta de unifica√ß√£o.  Um bom exemplo desse problema s√£o fun√ß√µes semelhantes, que t√™m nuances dependendo de algumas propriedades. </li><li>  A presen√ßa de c√≥digo morto.  Frequentemente, em projetos, existem fun√ß√µes de depura√ß√£o ou fun√ß√µes que n√£o s√£o usadas. </li></ul><br><p>  <b>Desempenho:</b> </p><br><ul><li>  Usando o mecanismo de cache do navegador; </li><li>  Otimiza√ß√£o de c√≥digo com base nos ambientes em que ser√° executado; </li><li>  A presen√ßa de vazamentos de mem√≥ria; </li><li>  Usando trabalhadores da Web; </li><li>  Usando refer√™ncias a elementos da √°rvore DOM; </li><li>  Uso de vari√°veis ‚Äã‚Äãglobais; </li><li>  A presen√ßa de chamadas recursivas; </li><li>  Simplifica√ß√£o de c√°lculos matem√°ticos. </li></ul><br><p>  <b>Velocidade de constru√ß√£o:</b> </p><br><ul><li>  O n√∫mero de depend√™ncias externas; </li><li>  Convers√µes de c√≥digo.  Isso se refere ao n√∫mero de blocos e seu tamanho, convers√µes de css, colagem de arquivos, otimiza√ß√£o de gr√°ficos e muito mais. </li></ul><br><p>  <b>Reutiliza√ß√£o de c√≥digo:</b> </p><br><ul><li>  N√∫mero de componentes; </li><li>  Repetibilidade dos componentes </li><li>  Flexibilidade e personaliza√ß√£o. </li></ul><br><p>  Como dito nos artigos anteriores, para mudar alguma coisa, voc√™ precisa determinar o ponto de partida e descobrir como tudo est√° ruim.  Por onde come√ßar um processo t√£o volumoso?  Comece com a coisa mais simples: acelerar a montagem e reduzir o tempo de excesso do projeto.  Voc√™ pergunta por que vale a pena come√ßar com isso?  Devido ao fato de que eles dependem um do outro.  Reduzir a quantidade de c√≥digo aumentar√° a velocidade de compila√ß√£o e, consequentemente, aumentar√° sua produtividade. </p><br><p>  A otimiza√ß√£o do tempo de compila√ß√£o inevitavelmente nos apresenta o conceito de compila√ß√£o "Cold" - este √© o processo em que um projeto inicia do zero e at√© o ponto em que todas as depend√™ncias s√£o afetadas e o c√≥digo √© completamente recompilado.  N√£o confunda com Rebild - isso est√° reconstruindo o c√≥digo do cliente sem extrair depend√™ncias externas e outros enfeites. </p><br><p>  Aumentar a velocidade de compila√ß√£o ajudar√°: </p><br><ul><li>  Usando montadores modernos.  As tecnologias n√£o param e, se voc√™ tiver o primeiro pacote da web, quando passar para o quarto, ver√° um aumento agrad√°vel j√° sem fazer nada; </li><li>  Livrar-se de todos os v√≠cios mortos.  De tempos em tempos, os desenvolvedores, tentando encontrar a verdade na parte inferior da lata de √°cido sulf√∫rico, esquecem-se de limpar ap√≥s seus pr√≥prios experimentos. Meu colega perguntou uma vez: ‚ÄúFa√ßa depend√™ncias escritas no package.json, mas n√£o importadas em nenhum lugar do c√≥digo, entre no pacote o pacote? "  Sim, eles n√£o ser√£o inclu√≠dos na pr√≥pria montagem, mas a embalagem ser√° esvaziada.  A quest√£o √©, por qu√™? </li><li>  Divida a montagem em v√°rios perfis, dependendo de suas necessidades.  M√≠nimo dois: prod e dev.  Caso em quest√£o: ofusca√ß√£o do c√≥digo.  No prod, isso √© obrigat√≥rio, pois menos peso = carregamento mais r√°pido, mas no ofuscamento do desenvolvedor, apenas interfere e gasta o tempo de constru√ß√£o em manipula√ß√µes desnecess√°rias; </li><li>  Paraleliza√ß√£o de etapas individuais de montagem; </li><li>  Usando clientes npm que podem armazenar em cache. </li></ul><br><p>  Acelerar a reconstru√ß√£o e a compila√ß√£o "fria" exigir√° cortar coment√°rios desnecess√°rios e trechos de c√≥digo mortos.  No entanto, o que fazer se voc√™ tiver um projeto enorme e n√£o for poss√≠vel inspecion√°-lo?  Nesses casos, os analisadores de c√≥digo v√™m em socorro. </p><br><p>  Pessoalmente, uso periodicamente o <b>SonarQube</b> , n√£o o melhor, mas flex√≠vel.  Pode ser ensinado os recursos do projeto, se houver.  De tempos em tempos, ele faz coisas que ao menos permanecem, ao menos caem, mas, como qualquer instrumento, ele deve ser capaz de us√°-lo e n√£o se esque√ßa de ser c√©tico em rela√ß√£o a seus coment√°rios.  Apesar de todas as suas desvantagens, ele lida com a busca por c√≥digos mortos, coment√°rios, a presen√ßa de copiar e colar e pequenas coisas, como a falta de uma compara√ß√£o rigorosa. </p><br><p>  A principal diferen√ßa entre o SonarQube e o ESlint / TSLint / Prettier e outros semelhantes √© que ele verifica a qualidade do c√≥digo, isola a duplica√ß√£o, a complexidade do c√°lculo e tamb√©m fornece recomenda√ß√µes sobre as altera√ß√µes necess√°rias.  Os an√°logos simplesmente verificam o c√≥digo quanto a erros, sintaxe e formata√ß√£o. </p><br><p>  Na pr√°tica, me deparei com o <b>codacy</b> , um bom servi√ßo com uma assinatura gratuita e paga.  Ser√° √∫til se voc√™ precisar verificar algo ao lado, sem ter que implantar esse 'harvester' em casa.  Possui uma interface intuitiva, uma indica√ß√£o detalhada do que h√° de errado com o c√≥digo e muito mais. </p><br><p>  Neste artigo, n√£o abordarei o t√≥pico de configura√ß√£o da compila√ß√£o, partes e o restante, porque tudo depende das necessidades do projeto e do construtor instalado.  Talvez eu fale sobre isso em outros artigos. </p><br><p>  As manipula√ß√µes feitas ajudaram a acelerar a montagem - lucro, mas e depois?  Como os analisadores podem encontrar a duplica√ß√£o de c√≥digo, ser√° √∫til coloc√°-lo em m√≥dulos ou componentes separados, aumentando assim a reutiliza√ß√£o de c√≥digo. </p><br><p>  Havia apenas uma se√ß√£o em que n√£o tocamos - a velocidade do pr√≥prio c√≥digo.  O pr√≥prio mecanismo de gerar um senso de produtividade √© chamado por toda a odiada refatora√ß√£o de palavras.  Vamos dar uma olhada no que vale a pena fazer ao refatorar e no que n√£o √©. </p><br><p>  Regra de vida: se funcionar, n√£o toque, n√£o deve gui√°-lo nesse processo.  A primeira regra na TI: fa√ßa um backup e voc√™ agradecer√° a si mesmo.  Na frente, antes de fazer altera√ß√µes, fa√ßa testes para n√£o perder a funcionalidade no futuro.  Ent√£o pergunte a si mesmo - como determinar os tempos de carregamento e vazamentos de mem√≥ria? </p><br><p>  Isso ajudar√° o DevTool.  Ele n√£o apenas mostra um vazamento de mem√≥ria, informa o tempo de carregamento da p√°gina, a redu√ß√£o da anima√ß√£o e, se voc√™ tiver sorte, realizar√° uma auditoria para voc√™, mas isso n√£o √© exato.  O DevTools tamb√©m possui um recurso interessante, como limitar a velocidade de download, o que permitir√° prever a velocidade de carregamento da p√°gina com pouca Internet. </p><br><p>  Conseguimos identificar os problemas, agora vamos resolv√™-los! </p><br><p>  Para come√ßar, reduziremos o tempo de carregamento usando o mecanismo de cache do navegador.  O navegador pode armazenar em cache tudo e, posteriormente, fornecer ao usu√°rio os dados do cache.  Armazenamento local e armazenamento de sess√£o que ningu√©m tirou de voc√™.  Eles permitem que voc√™ armazene alguns dos dados que ajudam a acelerar o SPA durante downloads subsequentes e reduzir solicita√ß√µes desnecess√°rias do servidor. </p><br><p>  Considera-se necess√°rio otimizar o c√≥digo com base no ambiente em que ser√° executado, mas, como mostra a pr√°tica, consome muito tempo e esfor√ßo, sem gerar um aumento tang√≠vel.  Proponho considerar isso apenas como uma recomenda√ß√£o. <br>  √â naturalmente aconselh√°vel eliminar todos os vazamentos de mem√≥ria.  N√£o vou me concentrar nisso, acho que todo mundo sabe como elimin√°-los e, se n√£o, basta pesquisar no Google. </p><br><p>  Outro de nossos assistentes √© um webworker.  Trabalhadores da Web s√£o threads de propriedade do navegador que podem ser usados ‚Äã‚Äãpara executar o c√≥digo JS sem bloquear o loop de eventos.  Os trabalhadores da Web podem executar tarefas computacionalmente pesadas e demoradas sem bloquear o fluxo da interface do usu√°rio.  De fato, quando s√£o usados, os c√°lculos s√£o realizados em paralelo.  Antes de n√≥s √© real multithreading.  Existem tr√™s tipos de trabalhadores da Web: </p><br><ol><li>  Trabalhadores dedicados - Inst√¢ncias de trabalhadores da web dedicados s√£o criadas pelo processo principal.  Somente o pr√≥prio processo pode trocar dados com eles. </li><li>  Trabalhadores compartilhados (trabalhadores compartilhados) - O acesso a um trabalhador compartilhado pode ser obtido por qualquer processo que tenha a mesma origem do trabalhador (por exemplo, guias diferentes do navegador, iframe e outros trabalhadores compartilhados). </li><li>  Trabalhadores de servi√ßo s√£o trabalhadores controlados por eventos registrados usando sua origem e caminho.  Eles podem controlar a p√°gina da web √† qual est√£o vinculados, interceptando e modificando comandos de navega√ß√£o e solicita√ß√µes de recursos e armazenando em cache dados que podem ser controlados com muita precis√£o.  Tudo isso nos fornece excelentes ferramentas para controlar o comportamento do aplicativo em uma determinada situa√ß√£o (por exemplo, quando a rede est√° indispon√≠vel). </li></ol><br><p>  Como trabalhar com eles pode ser facilmente encontrado na Internet. </p><br><p>  N√≥s meio que descobrimos as abordagens e os elogios de terceiros, agora proponho falar sobre o pr√≥prio c√≥digo. </p><br><p>  Primeiro, tente se livrar das chamadas diretas para a √°rvore DOM, pois essa √© uma opera√ß√£o demorada.  Vamos imaginar que voc√™ esteja constantemente manipulando algum tipo de objeto no seu c√≥digo.  Em vez de trabalhar com esse objeto por refer√™ncia, voc√™ constantemente puxa a √°rvore DOM para procurar e trabalhar com esse elemento, e implementamos o padr√£o de cache no c√≥digo. </p><br><p>  O segundo passo √© livrar-se das vari√°veis ‚Äã‚Äãglobais.  O ES6 nos deu uma maravilhosa inven√ß√£o da humanidade chamada vari√°veis ‚Äã‚Äãde bloco (em termos simples, declara√ß√µes de vari√°veis ‚Äã‚Äãde <b>var</b> para <b>let</b> e <b>const</b> ). </p><br><p>  E, finalmente, o mais delicioso.  Infelizmente, aqui nem todos t√™m experi√™ncia suficiente para entender as nuances.  Sou contra o uso de fun√ß√µes recursivas.  Sim, eles reduzem a quantidade de c√≥digo escrito, mas isso n√£o ocorre sem problemas: geralmente essas fun√ß√µes recursivas n√£o t√™m condi√ß√µes de sa√≠da, s√£o simplesmente esquecidas.  Como no ditado "voc√™ pode quebrar um dedo com um martelo, mas isso n√£o √© um problema do martelo, mas um propriet√°rio do dedo" ou uma piada sobre gatos: fun√ß√µes recursivas n√£o s√£o ruins, voc√™ precisa ser capaz de cozinh√°-las. </p><br><p>  Apesar de todo o poder dos aplicativos front-end modernos, voc√™ n√£o deve esquecer o b√°sico.  Um exemplo claro de desperd√≠cio e irracionalidade √© a adi√ß√£o de novos elementos ao in√≠cio da matriz.  Quem sabe, ele entendeu, e quem n√£o sabe - agora vou contar.  Todo mundo sabe que os elementos da matriz t√™m seu pr√≥prio √≠ndice e, quando adicionarmos um novo elemento √† matriz, a sequ√™ncia de a√ß√µes ser√° a seguinte: </p><br><ol><li>  Defini√ß√£o do comprimento da matriz </li><li>  Numera√ß√£o de cada elemento. </li><li>  Mudan√ßa de cada elemento da matriz </li><li>  Inserir um novo item em uma matriz </li><li>  Reindexando elementos da matriz. </li></ol><br><p>  <b>Resumo:</b> </p><br><p>  Chegou a hora de encerrar e, para quem se sentir confort√°vel com o formato dos memorandos, mantenha uma lista de etapas, gra√ßas √†s quais voc√™ pode entender em que est√°gio de otimiza√ß√£o est√° agora e o que fazer em seguida: </p><br><ol><li>  Determinamos o quanto tudo √© bom / ruim, removemos as m√©tricas. </li><li>  Cortamos tudo o que √© desnecess√°rio: depend√™ncias n√£o utilizadas, c√≥digo morto, coment√°rios desnecess√°rios. </li><li>  Personalizamos e agilizamos o tempo de montagem, configuramos diferentes perfis para os contornos. </li><li>  Analisamos o c√≥digo e decidimos quais partes ser√£o otimizadas e reescritas. </li><li>  Estamos escrevendo testes para evitar a perda de funcionalidade. </li><li>  Come√ßamos a refatorar, nos livramos de vari√°veis ‚Äã‚Äãglobais, vazamentos de mem√≥ria, c√≥digo de dublagem e outros tipos de lixo e n√£o esquecemos o cache. </li><li>  Simplificamos a complexidade dos c√°lculos e levamos todo o poss√≠vel para o web worker. </li></ol><br><p>  Tudo n√£o √© t√£o complicado quanto parece √† primeira vista.  Sua sequ√™ncia provavelmente ser√° diferente da minha, apenas porque voc√™ tem a cabe√ßa nos ombros.  Voc√™ adiciona novos itens ou, ao contr√°rio, reduz o n√∫mero deles, mas a base da lista ser√° semelhante.  Descrevi especificamente a divis√£o para que essa atividade pudesse ser executada paralelamente ao trabalho principal.  Muitas vezes, o cliente n√£o est√° pronto para pagar pelo retrabalho, concorda? </p><br><p>  <b>E finalmente</b> </p><br><p>  Eu acredito em voc√™ e voc√™ ter√° sucesso.  Voc√™ acha que eu sou ing√™nuo?  Suponho que voc√™ ficar√° surpreso, mas desde que voc√™ encontrou este artigo, leia-o at√© o final, significa (tenho boas not√≠cias para voc√™) que voc√™ tem c√©rebro e est√° tentando desenvolv√™-lo.  Desejo-lhe sucesso em um empreendimento t√£o dif√≠cil como otimizar a frente! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt469127/">https://habr.com/ru/post/pt469127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt469111/index.html">Substitua Object por var: o que poderia dar errado?</a></li>
<li><a href="../pt469115/index.html">Guia Discovery.js: In√≠cio r√°pido</a></li>
<li><a href="../pt469117/index.html">Programa√ß√£o sob BC 0010 em 2019</a></li>
<li><a href="../pt469119/index.html">Os endere√ßos IPv4 no RIPE terminaram. Completamente terminado ...</a></li>
<li><a href="../pt469125/index.html">Tema sombrio do Thunderbird como um motivo para executar um analisador de c√≥digo</a></li>
<li><a href="../pt469129/index.html">Devido ao tema sombrio, o Thunderbird teve que executar um analisador de c√≥digo</a></li>
<li><a href="../pt469131/index.html">Genie</a></li>
<li><a href="../pt469133/index.html">Quais gadgets a Amazon introduziu em seu Hardware Event 2019</a></li>
<li><a href="../pt469135/index.html">Equ√≠vocos comuns sobre OOP</a></li>
<li><a href="../pt469137/index.html">O c√©rebro √© a √∫ltima fronteira da privacidade</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>