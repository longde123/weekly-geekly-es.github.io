<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëáüèº ü§öüèº üíÜüèº Impacto de la protecci√≥n Spectre, Meltdown y Foreshadow en el rendimiento de Linux 4.19 üë®‚Äçüé® üßëüèæ‚Äçü§ù‚Äçüßëüèæ ü§ù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Una de las preguntas m√°s comunes √∫ltimamente es c√≥mo la protecci√≥n contra Meltdown / Spectre, y ahora tambi√©n contra L1TF / Foreshadow, afecta el rend...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Impacto de la protecci√≥n Spectre, Meltdown y Foreshadow en el rendimiento de Linux 4.19</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421931/">  Una de las preguntas m√°s comunes √∫ltimamente es c√≥mo la protecci√≥n contra Meltdown / Spectre, y ahora tambi√©n contra L1TF / Foreshadow, afecta el rendimiento de Linux.  El inicio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">del</a> desarrollo del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">kernel de Linux 4.19</a> este mes agreg√≥ combustible al fuego no solo para x86_64, sino tambi√©n para POWER / s390 / ARM.  Para tener una idea general del efecto de los parches en el rendimiento, prob√© tres sistemas Intel Xeon y dos sistemas AMD EPYC, as√≠ como una m√°quina virtual en cada lado, para evaluar el rendimiento predeterminado del n√∫cleo Linux 4.19 con y sin los parches correspondientes. <br><br><img src="https://habrastorage.org/webt/ny/54/eb/ny54eb_sf-hbc3gnhnmicbijlus.jpeg"><br><a name="habracut"></a><br>  En todas las m√°quinas, se instal√≥ un sistema con el kernel de Linux 4.19-rc1 lanzado el pasado fin de semana.  En Intel, los parches correspondientes incluyen el aislamiento de la tabla de p√°ginas (PTI / KPTI) para Meltdown y varios parches Spectre contra la ejecuci√≥n especulativa de comandos, incluida la eliminaci√≥n del puntero __user, el uso de retpoline a trav√©s de IBPB IBRS_FW, el parche para la vulnerabilidad Speculative Store Bypass usando prctl y seccomp, y tambi√©n inversi√≥n de PTE y lavado de cach√© condicional en m√°quinas virtuales: esto es para L1TF / Foreshadow. <br><br>  De manera predeterminada, el kernel de Linux no proporciona protecci√≥n "completa" contra vulnerabilidades al deshabilitar la compatibilidad con Intel HT / SMT, as√≠ que tenga esto en cuenta si usa m√°quinas virtuales y proporciona c√≥digo no confiable o acceso de los usuarios a la VM.  Si selecciona protecci√≥n completa y deshabilita SMT, el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">impacto en el rendimiento es mucho m√°s notable</a> debido a la reducci√≥n a la mitad del n√∫mero de subprocesos disponibles.  Los proveedores de servicios en la nube parecen simplemente configurar planificadores para que los flujos SMT no pasen a trav√©s de los usuarios.  Esto evita el enorme costo obvio de deshabilitar Hyper Threading.  As√≠ que ahora solo estamos comparando la protecci√≥n del n√∫cleo stock / predeterminado. <br><br><img src="https://habrastorage.org/webt/kh/fe/dx/khfedx0pj97ldov-l55f4cidlwa.jpeg"><br><br>  AMD EPYC, de manera predeterminada, proporciona protecci√≥n solo para las vulnerabilidades correspondientes que les conciernen: esto es borrar el puntero de usuario __ para Spectre V1, AMD Retpoline IBPB para Spectre V2 y deshabilitar el Bypass de almacenamiento especulativo (SSBD) para Spectre V4. <br><br><img src="https://habrastorage.org/webt/cq/ms/lw/cqmslwmsupwjqmyrsd1dwoypby0.jpeg"><br><br>  Despu√©s de probar todas las configuraciones en el n√∫cleo de Linux 4.19-rc1, las pruebas se repitieron utilizando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">varios conmutadores de protecci√≥n en tiempo de ejecuci√≥n</a> .  Todos los sistemas fueron probados con Ubuntu 18.04.1 LTS x86_64 con Linux kernel 4.19-rc1 a trav√©s de Ubuntu Mainline Kernel PPA, el √∫ltimo microc√≥digo / BIOS, GCC 7.3 y el sistema de archivos EXT4. <br><br><img src="https://habrastorage.org/webt/ml/n5/ps/mln5psdiqvdrykijquh0shkve90.jpeg"><br><br>  Configuraciones del sistema en la prueba: <br><br><ul><li>  Intel Xeon E3-1280 v5 Skylake en la placa base MSI Z170A SLI PLUS, 16 GB DDR4 y 256 GB Toshiba RD400 NVMe SSD. </li><li>  Intel Xeon E5-2687W v3 Haswell en placa base MSI X299 SLI PLUS, 32 GB DDR4 y 80 GB Intel 530 SATA 3.0 SSD. </li><li>  Dos bastidores Intel Xeon Gold 6138 Tyan 1U con 96 GB de RAM y Samsung 970 EVO NVMe SSD de 256 GB. </li><li>  M√°quina virtual KVM en el mencionado servidor Xeon Gold de doble procesador.  Esta VM fue el √∫nico proceso activo en la m√°quina y se configur√≥ para acceder al 80% de los n√∫cleos / hilos de la CPU (64 hilos), 48 GB de RAM y un disco virtual de 118 GB.  Durante las pruebas, se deshabilit√≥ la protecci√≥n contra vulnerabilidades tanto en el host como en la VM. </li><li>  AMD EPYC 7601 en un servidor Tyan 2U con 128 GB de RAM y 280 GB Intel Optane 900p NVMe SSD. </li><li>  La m√°quina virtual KVM en el servidor AMD EPYC 7601 mencionado anteriormente. Tiene acceso al 80% de los n√∫cleos / hilos de la CPU (52 hilos), 48 GB de RAM y un disco virtual de 120 GB. </li><li>  Servidor AMD EPYC 7551 en una placa base Gigabyte MZ31-AR0 con 32 GB de RAM y Samsung 960 EVO 256GB NVMe SSD. </li></ul><br>  Obviamente, las configuraciones de las m√°quinas son diferentes y no est√°n destinadas a ser comparadas entre s√≠, es decir, para verificar la protecci√≥n de encendido / apagado contra las vulnerabilidades de los procesadores en el kernel Linux 4.19.  Por lo tanto, para mayor claridad, todos los datos se normalizan al rendimiento de cada sistema.  Todas las pruebas de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Phoronix Test Suite</a> . <br><br>  Para el art√≠culo, se seleccionaron pruebas relacionadas con Spectre / Meltdown, es decir, con intensas interacciones de entrada-salida o kernel.  La carga es solo en la CPU y no depende en gran medida de la memoria cach√© del procesador. <br><br><img src="https://habrastorage.org/webt/oo/vi/ba/oovibakv98wgg-0sby352zo6718.jpeg"><br><br>  El perfil CompileBench es probablemente la forma m√°s f√°cil de mostrar el impacto de Spectre / Meltdown.  En el n√∫cleo Linux 4.19, cuando la protecci√≥n est√° activada, los procesadores Intel muestran una disminuci√≥n del rendimiento del 7 al 16%, mientras que los procesadores AMD muestran una disminuci√≥n del 3 al 4%. <br><br><img src="https://habrastorage.org/webt/d3/n9/tp/d3n9tpig2tr9pxkzkhtkfoil-um.jpeg"><br><br>  Una situaci√≥n similar en las subpruebas con la lectura de un √°rbol compilado.  Los procesadores Intel tienen una ca√≠da de rendimiento del 14 al 15%, los procesadores AMD tienen una disminuci√≥n del 4 al 5%. <br><br><img src="https://habrastorage.org/webt/_y/u9/lz/_yu9lz69pephav9opkigeaxvtze.jpeg"><br><br>  En tareas reales como compilar el kernel de Linux, la diferencia de rendimiento ser√° de alrededor del 2%. <br><br><img src="https://habrastorage.org/webt/sv/-x/ha/sv-xha-gkgnrdkktyibfovq9t8g.jpeg"><br><br>  El punto de referencia del planificador de kernel de Hackbench tambi√©n sufre de activaci√≥n de seguridad.  En los procesadores Intel, el rendimiento se reduce en aproximadamente un 20%, a excepci√≥n de Xeon Gold.  Los sistemas AMD EPYC no hacen mucha diferencia. <br><br><img src="https://habrastorage.org/webt/04/06/kd/0406kdun9xswkjy0waknggdgj08.jpeg"><br><br>  El servidor de base de datos PostgreSQL es una de las aplicaciones reales que sufri√≥ una degradaci√≥n del rendimiento despu√©s de instalar la protecci√≥n en los procesadores.  En esta prueba en particular, la diferencia para los procesadores Intel fue de 5-8%, y para EPYC - 1%. <br><br><img src="https://habrastorage.org/webt/d7/ht/z5/d7htz5ce483cindrcyaoszxhknq.jpeg"><br><br><img src="https://habrastorage.org/webt/_r/g7/gw/_rg7gw5len0ay5jnsascpkopmq8.jpeg"><br><br><img src="https://habrastorage.org/webt/wo/ol/ar/woolarputb09q2zbz83vexnrl5i.jpeg"><br><br>  Otro programa real con degradaci√≥n del rendimiento debido a Specter / Meltdown es el editor gr√°fico GIMP.  La diferencia para Intel es 5-10%, para AMD - 0‚àí2%. <br><br><img src="https://habrastorage.org/webt/xc/q6/_w/xcq6_wirra5za2bncyixkzidug4.jpeg"><br><br>  Redis DBMS en el sistema Intel Skylake E3 v5 se ralentiza en un 11%, y en otros procesadores Intel, en un 5-7%, la diferencia entre los sistemas AMD EPYC es de 1-5%. <br><br><img src="https://habrastorage.org/webt/qm/s1/iu/qms1iupekz-mk2mbz4bvpcuj5nw.jpeg"><br><br>  El servidor web Nginx en sistemas Xeon probados en el kernel Linux 4.19 mostr√≥ una diferencia en el rendimiento de hasta un 20%, y en AMD EPYC: de 1-2% a 6%. <br><br><img src="https://habrastorage.org/webt/f2/gx/io/f2gxio7epg4idsah433z4owp-yo.jpeg"><br><br>  Del mismo modo, el servidor web Apache durante la instalaci√≥n predeterminada funciona mucho m√°s lento despu√©s de activar la protecci√≥n en los procesadores Intel y pr√°cticamente sin cambios en los procesadores AMD. <br><br><img src="https://habrastorage.org/webt/6x/az/ad/6xazadxauibjyqviwxdwesoex4s.jpeg"><br><br>  En la prueba de la velocidad de creaci√≥n de archivos OSBench, el sistema en Intel Xeon se ralentiza en un 13-16% y los sistemas EPYC en un 6-9%. <br><br><img src="https://habrastorage.org/webt/jz/vx/g8/jzvxg8ciylrguvqbtfdd_2oy6uy.jpeg"><br><br>  La prueba para crear subprocesos tambi√©n muestra una diferencia notable entre los procesadores Intel y AMD. <br><br><img src="https://habrastorage.org/webt/uc/ic/nw/ucicnw3c70sjdmflrbaccejf1v4.jpeg"><br><br><img src="https://habrastorage.org/webt/aq/ge/nf/aqgenf8s9z88j9mdzb35eq340e8.jpeg"><br><br>  Al iniciar programas y crear procesos, hay una diferencia menor pero notable en la operaci√≥n predeterminada del n√∫cleo Linux 4.19 en comparaci√≥n con la protecci√≥n deshabilitada. <br><br>  As√≠ son las cosas con el rendimiento de los procesadores en el kernel de Linux 4.19 despu√©s de instalar parches.  Tenga en cuenta que si su (s) sistema (s) est√° (n) abierto (s) a usuarios / c√≥digos poco confiables, especialmente en m√°quinas virtuales, entonces se pueden requerir acciones adicionales para la protecci√≥n, como l1tf = full, hasta deshabilitar SMT / HT o el vaciado obligatorio del cach√© L1, ¬øqu√© m√°s? disminuir√° m√°s el rendimiento del sistema.  El efecto de estas protecciones contra L1TF / Foreshadow se describe con m√°s detalle en un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo anterior</a> . <br><br>  Quiz√°s en el futuro ejecutaremos pruebas similares en Linux 4.19 con procesadores de escritorio y las cargas de trabajo correspondientes. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es421931/">https://habr.com/ru/post/es421931/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es421921/index.html">¬øPor qu√© deber√≠a un especialista en TI "saber lo que otros viven"?</a></li>
<li><a href="../es421923/index.html">Entendemos las profesiones de dise√±o.</a></li>
<li><a href="../es421925/index.html">Descripci√≥n general de la impresora 3D Raise 3D Pro 2 Plus</a></li>
<li><a href="../es421927/index.html">Descripci√≥n general del tel√©fono inteligente General Mobile GM8 Go: un empleado de presupuesto turco con Android 8.1 Oreo Go Edition</a></li>
<li><a href="../es421929/index.html">Un a√±o antes del Brexit: Gran Breta√±a resuelve el problema de la escasez de mano de obra a trav√©s de la rob√≥tica.</a></li>
<li><a href="../es421933/index.html">El estudio del sistema de archivos HDD del modelo DVR QCM-08DL</a></li>
<li><a href="../es421935/index.html">Primeras impresiones de la transici√≥n de Ubuntu 16.04 LTS a Ubuntu 18.04 LTS</a></li>
<li><a href="../es421937/index.html">Smart city inside: una mirada a Huawei</a></li>
<li><a href="../es421939/index.html">Usando SQL en Rails</a></li>
<li><a href="../es421945/index.html">Google y Mastercard concluyen un acuerdo secreto para rastrear compras en tiendas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>