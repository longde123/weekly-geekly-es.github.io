<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª‚Äç‚öïÔ∏è üë®üèª‚Äç‚öñÔ∏è üíØ La historia de la creaci√≥n de una nube dom√©stica. Parte 2. Crear un servidor - configurar LAMP en Debian üë®üèº‚Äçüíª üåú ‚è©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En el camino para crear nuestro propio servicio en la nube, nos acabamos de acostumbrar al sistema Debian . Ahora ha llegado el momento del siguiente ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La historia de la creaci√≥n de una nube dom√©stica. Parte 2. Crear un servidor - configurar LAMP en Debian</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409915/">  En el camino para crear nuestro propio servicio en la nube, nos acabamos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">acostumbrar al sistema Debian</a> .  Ahora ha llegado el momento del siguiente paso: la creaci√≥n y configuraci√≥n de un servidor web, sobre la base del cual se puede lanzar Nextcloud. <img src="https://habrastorage.org/webt/ke/r5/x8/ker5x8nlot-vrpcr5iuvyrauhvm.png"><a name="habracut"></a><br><hr><a name="chap0"></a><br><h3>  Tabla de contenidos </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Parte 1. Configurar su entorno Debian para el uso diario</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Parte 2. Crear un servidor - configurar LAMP en Debian</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Parte 3. Crear una nube personal: instalar y configurar Nextcloud</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Parte 4. Actualizaci√≥n 2018 - Debian 9 y Nextcloud 13</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 5. Actualizaci√≥n 2019 - PHP 7.2, MariaDB 10.4 y Nextcloud 17</a> <br><br><hr><br><h3>  Navegaci√≥n r√°pida de cap√≠tulos </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pr√≥logo</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Instalaci√≥n de software</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Configurar el servidor web Apache2 y acceder a √©l a trav√©s de los protocolos HTTP y HTTPS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ajuste de SQL</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Configuraci√≥n de PHP</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Configuraci√≥n de acceso SSH</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Protecci√≥n de acceso</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Referencia del servidor web</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Referencia de MySQL</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Material de referencia de Fail2ban</a> <br><br><hr><a name="chap1"></a><br><h3>  Pr√≥logo </h3><br>  La primera parte de esta historia mostr√≥ una de las posibles opciones para configurar la GUI de Debian para un uso conveniente y familiar (punto de vista exclusivamente subjetivo del autor) por parte de una persona que lleg√≥ a Linux desde Windows.  Y si solo utilic√© el sistema host para configurar la m√°quina virtual con Debian, entonces espec√≠ficamente trabaj√© solo en esta m√°quina virtual, buscando informaci√≥n en Internet, tomando notas en Notepadqq o gedit, escuchando m√∫sica a trav√©s de Audacious, abriendo archivos a trav√©s de LibreOffice y similares.  De esta manera, puede acostumbrarse y sentirse mucho m√°s profundo y apreciar trabajar con el sistema operativo y su entorno, que es bastante completo y funcional en el paquete est√°ndar de Debian. <br><br>  Por el momento, nuestro sistema est√° configurado de tal manera que en el futuro solo puede usar la l√≠nea de comandos con un editor de texto de consola, por ejemplo, nano o usar el administrador de archivos Double Commander con el editor Notepadqq integrado.  Es posible combinar estos dos m√©todos, por ejemplo, navegando en el sistema y editando archivos de configuraci√≥n a trav√©s del administrador de archivos, y todos los dem√°s comandos a trav√©s de la consola.  Todos los m√©todos son equivalentes para lograr el resultado final. <br><br>  El objetivo actual es crear un servidor, al que se dedicar√° esta parte.  El servidor se puede configurar con la instalaci√≥n y el uso de la interfaz gr√°fica, y sin √©l.  En el segundo caso, de la parte anterior, simplemente puede omitir las secciones relacionadas con la instalaci√≥n y configuraci√≥n de software para la interfaz gr√°fica y su configuraci√≥n, instalando paquetes de software gr√°fico y herramientas vmware. <br><br>  No veo nada de malo en usar la interfaz gr√°fica al crear un servidor: si es m√°s familiar, m√°s conveniente y c√≥modo para una persona crear su primer o segundo servidor con un entorno gr√°fico, ¬øpor qu√© no?  Al final, mi servidor web con una interfaz gr√°fica funcion√≥ durante un a√±o y funcionar√° tantos a√±os como sea necesario.  Sin embargo, debe tener en cuenta algunos puntos. <br><br>  Idealmente, una vez configurado, el sistema tendr√° que funcionar sin nuestra intervenci√≥n durante mucho tiempo.  Mi servidor en la versi√≥n "final" se configur√≥ en dos d√≠as y funcion√≥ sin intervenci√≥n durante casi un a√±o.  Esto significa que la interfaz gr√°fica se utiliz√≥ hasta el 0.05% de la existencia activa del servidor (la computadora solo funciona durante medio d√≠a) y al mismo tiempo consumi√≥ recursos: RAM, espacio en disco, tiempo de procesador.  Todos estos recursos se gastan mejor para garantizar el funcionamiento del servidor en s√≠: por ejemplo, aumentar el l√≠mite de memoria para PHP o almacenar m√°s datos de usuario en el disco duro.  Adem√°s, en caso de problemas y mal funcionamiento cuando se trabaja con un servidor remoto real, a menudo es mucho m√°s f√°cil usar el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">acceso SSH</a> .  En este contexto, la presencia de una interfaz gr√°fica no es deseable y es por eso que el segundo servidor en mi red ya era una m√°quina virtual sin un entorno gr√°fico en el que solo Midnight Commander se instal√≥ desde el software gr√°fico, que utilic√© para navegar el sistema de archivos y editar los archivos de configuraci√≥n a trav√©s de su editor de Mcedit .  Por lo tanto, la siguiente es una instrucci√≥n universal: los comandos dados con √©nfasis en el uso de la l√≠nea de comandos, sin embargo, se entiende que por primera vez el usuario configura la m√°quina con un entorno gr√°fico, lo que se debe al uso de un navegador para verificar localmente la disponibilidad de los sitios creados y algunas caracter√≠sticas de configuraci√≥n del programa de correo. <br><br>  En el proceso de creaci√≥n del servidor y al agregar nuevos sitios, acumul√© informaci√≥n de fondo que puede ser √∫til para un usuario novato.  Lo describ√≠ despu√©s del material sobre la instalaci√≥n y configuraci√≥n del servidor. <br><br>  <b>Nota</b> <br>  Al seguir leyendo en las construcciones del formulario http: // 127.0.0.1 (https: // 127.0.0.1), el espacio despu√©s de http: // (https: //) debe eliminarse al ingresar a la barra de direcciones del navegador.  Se insert√≥ un espacio al publicar este art√≠culo para evitar que el motor convierta autom√°ticamente el texto en enlaces. <br><br><hr><a name="chap2"></a><br><h3>  Instalaci√≥n de software </h3><br>  Apache y Nginx son un par de servidores web de c√≥digo abierto en los que se construyen alrededor del 55% de los servidores de todo el mundo.  Apache es el servidor web m√°s popular desde 1995 y lo eleg√≠ con la esperanza de una buena documentaci√≥n, popularidad y, por as√≠ decirlo, quer√≠a comenzar desde el principio.  Esto no significa que Nginx sea peor: Nginx es m√°s eficiente al consumir recursos y trabajar bajo carga.  En el segmento ruso de Internet, el servidor Nginx ocupa aproximadamente el 65%, mientras que Apache, aproximadamente el 18%.  Se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">publica</a> un buen art√≠culo comparativo de dos servidores <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">en el concentrador</a> <br><br>  Instalaci√≥n del servidor web Apache2: <br><br>  <b># apt-get install apache2 apache2-doc</b> <br><br>  Y eso es todo.  Unos veinte megabytes y un servidor web ya est√°n instalados.  No se necesitan reinicios ni configuraciones: el servidor ya sabe c√≥mo abrir p√°ginas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">HTML</a> .  Sin embargo, un sitio web moderno en Internet no es solo un conjunto de archivos est√°ticos, estilos, fuentes y similares, como hace veinte a√±os.  Un sitio moderno contiene scripts escritos en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">PHP</a> , y la informaci√≥n din√°mica (por ejemplo, contenido de texto, comentarios, perfiles de usuario) no se escribe en archivos al lado de archivos PHP, sino en una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">base de datos SQL</a> especial.  Para un servidor completo, debe proporcionar soporte para estas tecnolog√≠as.  Adem√°s, no es dif√≠cil: <br><br>  <b># apt-get install mysql-server mysql-client phpmyadmin</b> <br>  <b># apt-get install php5 php5-mysql libapache2-mod-php5</b> <br><br>  Durante la instalaci√≥n de MySQL, se le pedir√° que establezca la contrase√±a de superusuario de mysql y deber√° seleccionar el servidor apache2 para configurar autom√°ticamente el trabajo con mysql.  Al instalar el paquete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">phpmyadmin</a> , acept√© configurar autom√°ticamente el paquete y en todas partes ingres√© la contrase√±a de root de mysql.  La instalaci√≥n de PHP ocurre sin ninguna solicitud. <br><br>  No utilic√© PHP7 m√°s r√°pido o MariaDB gratis como un reemplazo abierto alternativo para SQL y decid√≠ construir mi servidor en el LAMP "can√≥nico" = Linux + Apache + MySQL + PHP, usando soluciones antiguas y probadas, en caso de problemas con los que pudiera r√°pidamente y encontrar f√°cilmente informaci√≥n en Internet. <br><br>  Tres equipos (que en realidad se pueden reducir a uno) y hemos instalado localmente un servidor moderno y completo.  Es muy simple! <br><br>  Pero la configuraci√≥n del servidor lleva mucho m√°s tiempo que la instalaci√≥n de sus componentes.  Inicialmente, en esta parte quer√≠a mostrar mis errores t√≠picos, las soluciones falsas a los problemas y los resultados a los que condujeron, pero result√≥ que muchas cosas se hab√≠an borrado de mi memoria en un a√±o, tuve que recuperar mucho de los registros, por lo que a continuaci√≥n solo establecer√© una instrucci√≥n de trabajo con peque√±os comentarios, lo que permite lograr un resultado de trabajo universal. <br><br><hr><a name="chap3"></a><br><h3>  Configurar el servidor web Apache2 </h3><br>  Primero debe asegurarse de que el servidor web est√© funcionando.  Para hacer esto, abra un navegador y marque la direcci√≥n http: // 127.0.0.1 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">localhost</a> ).  Deber√≠a abrirse una inscripci√≥n alentadora: ‚ÄúP√°gina predeterminada de Apache2 Debian.  ¬°Funciona!  El servidor realmente funciona.  Si tiene un conjunto de archivos de sitio para el a√±o 2000, puede colocarlo en el directorio / var / www / html y probablemente se abrir√° en nuestro servidor. <br><br><img src="https://habrastorage.org/webt/3t/q6/x-/3tq6x-2ahadvbbshmoxl2_3hfhc.png"><br><br>  Todas las configuraciones b√°sicas del servidor web se almacenan en la ruta / etc / apache2.  Si abre este directorio, puede ver el archivo de configuraci√≥n principal apache2.conf y los directorios conf-available, mod-available, sites-available.  Estos directorios contienen archivos preconfigurados con ajustes (los llamados fragmentos), que simplemente puede usar de forma predeterminada, con sus propias ediciones, o tomarlos como plantilla para crear sus propias configuraciones.  Por ejemplo, en el directorio de sitios disponibles se encuentra el archivo de configuraci√≥n de host predeterminado 000-default.conf.  Si lo abre y lo estudia, resulta que este archivo solo establece la ruta a lo largo de la cual se abre nuestro sitio web en la direcci√≥n http: // 127.0.0.1: ‚ÄúDocumentRoot / var / www / html‚Äù.  Adem√°s, la l√≠nea "&lt;VirtualHost *: 80&gt;" significa que si libero mi m√°quina en una red local y accedo a ella en el puerto 80 (puerto para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">HTTP</a> ), abrir√© un sitio ubicado en la ruta / var / www / html.  ¬øC√≥mo verificar esto? <br><br>  Primero debe averiguar la direcci√≥n IP que se asign√≥ a la m√°quina virtual despu√©s de cargarla.  Para ver la configuraci√≥n de los adaptadores de red, ejecute: <br><br>  <b># ifconfig</b> <br><br>  En la informaci√≥n que se muestra en la consola, es f√°cil determinar que la siguiente direcci√≥n est√° configurada para el adaptador eth0: <br><br> <code>inet addr:192.168.233.138</code> <br> <br>  Ahora en la m√°quina host, abro la direcci√≥n del navegador http: // 192.168.233.138 en el navegador y espero que se abra una p√°gina familiar.  Pero ... ella no abre.  Despu√©s de un tiempo, mi navegador escribe: "Se agot√≥ el tiempo de espera de la conexi√≥n".  Y √©l escribe correctamente.  De hecho, en la primera parte encend√≠ el firewall, ¬°pero el puerto 80 no se abri√≥!  Vamos a arreglar esto: <br><br>  <b># ufw permite 80</b> <br><br>  Nuevamente, intente abrir la direcci√≥n http: // 192.168.233.138 y aseg√∫rese de que se abra la p√°gina esperada.  El host virtual en la m√°quina virtual se abri√≥ desde afuera de toda esta virtualizaci√≥n.  Dimos un peque√±o paso en la construcci√≥n de nuestra propia peque√±a Internet virtual. <br><br>  Adem√°s de los directorios disponibles, tambi√©n hay directorios habilitados que contienen lo que actualmente est√° "incluido".  Si los mira, puede ver que estos directorios contienen enlaces a archivos ubicados en los directorios disponibles.  Actualmente solo hay un enlace en el directorio habilitado para sitios: el archivo /etc/apache2/sites-available/000-default.conf.  Esto es muy conveniente: podemos controlar los accesos directos dentro o fuera de los hosts sin editar sus archivos de configuraci√≥n.  Adem√°s, la fuente de la configuraci√≥n es si un archivo de configuraci√≥n se incluye de forma independiente o no ahora, y esto evita errores cuando algo se corrige en un archivo y se olvida en otro.  Para deshabilitar nuestro host, debe eliminar el acceso directo requerido y, para habilitarlo, crearlo.  Para no eliminar o crear accesos directos manualmente, es m√°s f√°cil y m√°s confiable utilizar utilidades especiales. <br><br>  Deshabilitar el host virtual: <br><br>  <b># a2dissite 000-default</b> <br><br>  Encienda el host virtual: <br><br>  <b># a2enssite 000-default</b> <br><br>  Despu√©s de cada cambio, debe reiniciar las configuraciones de host o reiniciar el servidor: <br><br>  <b># service apache2 reload</b> <br><br>  o <br><br>  <b># service apache2 restart</b> <br><br>  Por lo tanto, ahora est√° disponible una comprensi√≥n b√°sica de c√≥mo configurar hosts regulares en apache, y luego mostrar√© un ejemplo de c√≥mo configur√© mi servidor para trabajar sobre protocolos HTTP y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">HTTPS</a> . <br><br>  Debe comenzar con el hecho de que al desconectar el host virtual predeterminado de 000, la desconexi√≥n como tal no ocurre.  Es decir, el sitio se abre desde el interior y el exterior de la m√°quina virtual, y se abrir√° independientemente de si su configuraci√≥n est√° en la carpeta habilitada para sitios.  Esto fue inesperado y pas√© un tiempo relativamente largo para entender si hice todo bien o lo entend√≠.  Hasta el final, todav√≠a no entend√≠a esto, aparentemente esto se debe al hecho de que la ruta / var / www / html est√° configurada globalmente como el directorio predeterminado para DocumentRoot.  Como no quer√≠a que algo innecesario fuera incluido y accesible, decid√≠ deshacerme del directorio html y, para todos los anidados / var / www, denegar el acceso de forma predeterminada. <br><br>  Para configurar el host virtual predeterminado, edit√© su archivo de configuraci√≥n: <br><br>  <b># nano /etc/apache2/sites-available/000-default.conf</b> <br><br>  El contenido del archivo de configuraci√≥n es el siguiente: <br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;VirtualHost *:80&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">ServerName</span></span></span></span> localhost ServerAdmin user@localhost DocumentRoot /var/www &lt;Directory /var/www&gt; Options FollowSymLinks AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> Require <span class="hljs-literal"><span class="hljs-literal">all</span></span> denied &lt;/Directory&gt; ErrorLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/error.log CustomLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/access.log combined &lt;/VirtualHost&gt;</code> </pre> <br>  Con esta configuraci√≥n, restablec√≠ el directorio predeterminado a / var / www, permit√≠ que el servidor siguiera enlaces simb√≥licos en este directorio, permit√≠ al servidor ejecutar todas las directivas declaradas en los archivos .htaccess encontrados y denegu√© el acceso a este directorio.  La l√≥gica de estas acciones es que puedo controlar el acceso a este directorio sin acceder a la configuraci√≥n del servidor web y sin reiniciarlo.  Ahora necesita verificar esta soluci√≥n. <br>  Transfiere el archivo: <br><br>  <b># mv /var/www/html/index.html /var/www/index.html</b> <br><br>  Y elimine el directorio: <br><br>  <b># rm / var / www / html</b> <br><br>  Reiniciamos el servidor para que la nueva configuraci√≥n predeterminada del host virtual surta efecto: <br><br>  <b># service apache2 restart</b> <br><br>  Crea un archivo: <br><br>  <b># nano /var/www/.htaccess</b> <br><br>  En el que escribimos una l√≠nea (sin comillas): "Requerir todo otorgado". <br><br>  Para resumir.  Ahora no hay una ruta / var / www / html, pero el host est√° configurado de forma predeterminada en la ruta / var / www, donde se encuentra el archivo index.html, y de manera predeterminada, a nivel del servidor web, el acceso a este directorio est√° denegado, pero el contenido est√° permitido localmente el archivo .htaccess ubicado all√≠. <br><br>  Abra el navegador http: // 127.0.0.1 y vea la p√°gina ya familiar ‚ÄúP√°gina predeterminada de Apache2 Debian.  Es funciona ".  Ahora verifiquemos la operatividad del control de acceso "local": <br>  Elimine el archivo .htaccess: <br><br>  <b># rm /var/www/.htaccess</b> <br><br>  Y actualizamos la p√°gina abierta en el navegador: la p√°gina con el aviso de restricci√≥n de acceso (Prohibido) deber√≠a abrirse.  S√≠, todo esto funciona, por lo que todo se hace correctamente. <br><br>  En principio, estas configuraciones simples son suficientes para el funcionamiento sin complicaciones del servidor web.  Pero me pareci√≥ que no era suficiente.  Ahora nuestro servidor web solo puede funcionar utilizando el protocolo HTTP.  Pero, ¬øqu√© pasa con el protocolo HTTPS?  Despu√©s de todo, si en el futuro trae proyectos basados ‚Äã‚Äãen este servidor web a Internet, entonces la capacidad de trabajar en este protocolo es al menos deseable.  Y decid√≠ organizar el soporte HTTPS basado en la creaci√≥n de un certificado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">SSL</a> autofirmado. <br><br>  Primero debe obtener un certificado SSL que se instalar√° en nuestro servidor.  No tenemos ning√∫n dominio, y tampoco tenemos una direcci√≥n IP est√°tica.  Pero todo esto no importa, porque generar√© el certificado yo mismo, utilizando las herramientas de mi sistema. <br><br>  Atencion  Las instrucciones a continuaci√≥n suponen que el servidor est√° instalado en una m√°quina sin nombre.  Si hay una IP real o un nombre de dominio, deben especificarse en TRES lugares: &lt;IP / dominio de nombre com√∫n&gt;;  &lt;ServerName IP / Domain&gt;;  &lt;Redirigir "/" "https: // IP / Dominio /"&gt; - en las construcciones apropiadas, reemplace IP / Dominio con una direcci√≥n IP o nombre de dominio.  En el texto a continuaci√≥n, se utiliza localhost en lugar de IP / Dominio. <br><br>  Generar un certificado SSL: <br><br>  <b># openssl req -x509 -nodes -days 3650 -newkey rsa: 2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt</b> <br><br>  Este comando crear√° un certificado autofirmado del est√°ndar X.509 de inmediato durante 10 a√±os, omitiendo la opci√≥n de protecci√≥n del certificado con una frase de contrase√±a; esto es necesario para que al iniciar el servidor Apache pueda leer el archivo sin la intervenci√≥n del usuario, ya que al configurar una contrase√±a, deber√° ingresarlo despu√©s de cada arranque o reinicio servidor  Junto con el certificado, se crear√° una nueva clave RSA para 2048 bits, con la cual se firmar√° el certificado.  Las opciones ‚Äìkeyout y ‚Äìout indican las rutas a lo largo de las cuales OpenSSL debe generar la clave y el certificado. <br><br>  En el proceso de creaci√≥n del certificado, se har√°n preguntas, a las cuales indiqu√© los siguientes datos: <br><br><blockquote>  Nombre del pa√≠s = MW <br>  Nombre del estado o provincia = Sistema solar <br>  Nombre de localidad = Lunar <br>  Nombre de la organizaci√≥n = Hellium Inc. <br>  Nombre de la unidad organizativa = 2 <br>  Nombre com√∫n = localhost <br>  Direcci√≥n de correo electr√≥nico = usuario @ localhost </blockquote><br>  A continuaci√≥n, cree las claves Diffie-Hellman para proporcionar compatibilidad con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">PFS</a> : <br><br>  <b># openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048</b> <br><br>  Los puntos y las ventajas se ejecutar√°n en el terminal y despu√©s del final de la caricatura, puede crear el archivo ssl-params.conf en el que se definir√°n los par√°metros SSL para el servidor: <br><br>  <b># nano /etc/apache2/conf-available/ssl-params.conf</b> <br><br>  Para una configuraci√≥n segura y actualizada, utilic√© el c√≥digo generado en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">generador para configurar SSL en mozilla.github.io</a> .  En el generador, seleccion√© el servidor Apache2, el perfil Modern y configur√© correctamente las versiones del servidor y OpenSSL, que pueden reconocerse mediante los siguientes comandos: <br><br>  <b># apache2 -v</b> <b><br></b>  <b># versi√≥n openssl</b> <br><br>  Como resultado, recib√≠ el siguiente texto: <br><br><pre> <code class="apache hljs"><span class="hljs-comment"><span class="hljs-comment"># 14-01-2018 / for apache2 2.4.10 &amp; openssl 1.0.1t # from https://mozilla.github.io/server-side-tls/ssl-config-generator/ # parametrs help: https://raymii.org/s/tutorials/Strong_SSL_Security_On_Apache2.html # modern configuration, tweak to your needs SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1 SSLCipherSuite ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256 SSLHonorCipherOrder on SSLCompression off # OCSP Stapling, only in httpd 2.3.3 and later SSLUseStapling on SSLStaplingResponderTimeout 5 SSLStaplingReturnResponderErrors off SSLStaplingCache shmcb:/var/run/ocsp(128000)</span></span></code> </pre> <br>  Ahora configure el host virtual con soporte SSL: <br><br>  <b># nano /etc/apache2/sites-available/default-ssl.conf</b> <br><br>  Traje el texto de este archivo al siguiente formulario: <br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;IfModule mod_ssl.c&gt;</span></span> <span class="hljs-section"><span class="hljs-section">&lt;VirtualHost _default_:443&gt;</span></span> <span class="hljs-attribute"><span class="hljs-attribute">ServerAdmin</span></span> user@localhost ServerName localhost DocumentRoot /var/www &lt;Directory /var/www&gt; Options FollowSymLinks AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> Require <span class="hljs-literal"><span class="hljs-literal">all</span></span> denied &lt;/Directory&gt; # HSTS (mod_headers is required) (15768000 seconds = 6 months) Header always set Strict-Transport-Security <span class="hljs-string"><span class="hljs-string">"max-age=15768000"</span></span> ErrorLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/error.log CustomLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/access.log combined SSLEngine <span class="hljs-literal"><span class="hljs-literal">on</span></span> SSLCertificateFile /etc/ssl/certs/apache-selfsigned.crt SSLCertificateKeyFile /etc/ssl/private/apache-selfsigned.key &lt;FilesMatch <span class="hljs-string"><span class="hljs-string">"\.(cgi|shtml|phtml|php)$"</span></span>&gt; SSLOptions +StdEnvVars &lt;/FilesMatch&gt; &lt;Directory /usr/lib/cgi-bin&gt; SSLOptions +StdEnvVars &lt;/Directory&gt; BrowserMatch <span class="hljs-string"><span class="hljs-string">"MSIE [2-6]"</span></span> \ nokeepalive ssl-unclean-shutdown \ downgrade-1.0 force-response-1.0 BrowserMatch <span class="hljs-string"><span class="hljs-string">"MSIE [17-9]"</span></span> ssl-unclean-shutdown &lt;/VirtualHost&gt; &lt;/IfModule&gt;</code> </pre> <br>  De lo anterior se deduce que tambi√©n tenemos / var / www definido como el directorio DocumentRoot, cuyo acceso est√° configurado de manera similar a la configuraci√≥n anterior.  El mecanismo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">HSTS</a> est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">habilitado</a> , lo que ayuda a forzar la conexi√≥n a trav√©s del protocolo HTTPS.  El soporte SSL se incluye con el certificado y la clave utilizada, as√≠ como el soporte para procesar datos de certificados en scripts PHP y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">CGI</a> .  La √∫ltima secci√≥n est√° dise√±ada para proporcionar compatibilidad con versiones anteriores de Internet Explorer y, en general, no es necesaria. <br><br>  Ahora hagamos los toques finales. <br><br>  Abramos el puerto para SSL: <br><br>  <b># ufw permite 443</b> <br><br>  Habilite los m√≥dulos de apache para el soporte SSL y HSTS: <br><br>  <b># a2enmod ssl</b> <b><br></b>  <b># a2enmod encabezados</b> <br><br>  Habilitar configuraci√≥n SSL: <br><br>  <b># a2enconf ssl-params</b> <br><br>  Habilitar SSL habilitado host virtual: <br><br>  <b># a2ensite default-ssl</b> <br><br>  Reinicie el servidor para aceptar todas las configuraciones nuevas: <br><br>  <b># service apache2 restart</b> <br><br>  As√≠ que ha llegado el momento interesante: verificar la operatividad de la nueva funcionalidad del sistema configurado. <br><br>  Crea un archivo: <br><br>  <b># nano /var/www/.htaccess</b> <br><br>  En el que prescribimos una l√≠nea: "Requerir todo otorgado". <br><br>  Abrir en el navegador https: // 127.0.0.1.  Se debe abrir una p√°gina sobre un certificado desconocido, despu√©s de aceptarlo (permiso √∫nico o permanente), se abrir√° una p√°gina familiar con una notificaci√≥n sobre un servidor web en ejecuci√≥n. <br><br>  Elimine el archivo .htaccess: <br><br>  <b># rm /var/www/.htaccess</b> <br><br>  Y actualizamos la p√°gina abierta en el navegador: la p√°gina con el aviso de restricci√≥n de acceso (Prohibido) deber√≠a abrirse.  Todo funciona correctamente  Ahora nuestros sitios son accesibles a trav√©s de HTTP y HTTPS. <br><br>  El acceso HTTP se puede dejar habilitado, deshabilitado u obligado a redirigir a HTTPS. <br><br>  Para el acceso habilitado con HTTP, no es necesario hacer nada, ya que el servidor procesa las solicitudes de los puertos 80 y 443 individualmente y nuestro sitio en la carpeta / var / www se abrir√° a trav√©s de HTTP y HTTPS. <br><br>  Para deshabilitar el acceso HTTP, solo necesita deshabilitar el host virtual correspondiente y reiniciar el servidor web: <br><br>  <b># a2dissite 000-default</b> <b><br></b>  <b># service apache2 restart</b> <br><br>  Ahora, si abre http: // 127.0.0.1 en un navegador, se abrir√° una p√°gina con una notificaci√≥n sobre la ausencia de una p√°gina (No encontrado). <br><br>  La tercera opci√≥n m√°s interesante.  En este caso, HTTP permanece formalmente habilitado, pero el procesamiento de datos se redirigir√° a la fuerza a trav√©s de HTTPS. <br><br>  Para hacer esto, primero habilite el m√≥dulo de redirecci√≥n: <br><br>  <b># a2enmod reescribir</b> <br><br>  Ahora abra el archivo 000-default.conf: <br><br>  <b># nano /etc/apache2/sites-available/000-default.conf</b> <br><br>  Y antes de la etiqueta de cierre, agregue el siguiente texto: <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteEngine</span></span></span></span> <span class="hljs-literal"><span class="hljs-literal">On</span></span> RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{HTTPS}</span></span> <span class="hljs-literal"><span class="hljs-literal">off</span></span> RewriteRule (.*) https://<span class="hljs-variable"><span class="hljs-variable">%{HTTP_HOST}</span></span><span class="hljs-variable"><span class="hljs-variable">%{REQUEST_URI}</span></span><span class="hljs-meta"><span class="hljs-meta"> [NC,R=301,L]</span></span></code> </pre> <br>  Reinicie el servidor: <br><br>  <b># service apache2 restart</b> <br><br>  Crea un archivo: <br><br>  <b># nano /var/www/.htaccess</b> <br><br>  En el que prescribimos una l√≠nea: "Requerir todo otorgado". <br><br>  Ahora, si abre la direcci√≥n http: // 127.0.0.1 en un navegador, se nos redirigir√° autom√°ticamente a https: // 127.0.0.1 con una advertencia sobre un certificado desconocido (si no se agreg√≥ previamente a la lista de exclusi√≥n en el navegador), despu√©s de aceptarlo, se abrir√° uno ya familiar. p√°gina de notificaci√≥n del servidor web. <br><br><hr><a name="chap4"></a><br><h3>  Ajuste de SQL </h3><br>  Para la configuraci√≥n inicial de mysql, simplemente ejecute el siguiente comando: <br><br>  <b># mysql_secure_installation</b> <br><br>  Despu√©s de ingresar la contrase√±a de superusuario mysql, respond√≠ las preguntas formuladas en el siguiente orden: <br><br><ul><li>  se neg√≥ a cambiar la contrase√±a de root; </li><li>  confirm√≥ la eliminaci√≥n de usuarios an√≥nimos de la base de datos; </li><li>  Confirm√≥ el bloqueo de la conexi√≥n remota para root (por razones de seguridad, root solo est√° conectado localmente); </li><li>  confirm√≥ la eliminaci√≥n de las bases de datos de prueba; </li><li>  acord√≥ recargar tablas de privilegios. </li></ul><br>  Para verificar el estado de mysql, puede ejecutar el siguiente comando: <br><br>  <b># mysql -uroot -p</b> <br><br>  Despu√©s de ingresar la contrase√±a de superusuario mysql, vemos el mensaje mysql, significa que el servicio est√° en funcionamiento.  Puede salir del terminal mysql ingresando el comando de salida. <br><br>  Para verificar el rendimiento de phpmyadmin, abra la direcci√≥n http: // 127.0.0.1/phpmyadmin en el navegador.  Si se abre una p√°gina con una invitaci√≥n para ingresar a phpmyadmin, entonces el servicio est√° en funcionamiento. <br><br><hr><a name="chap5"></a><br><h3>  Configuraci√≥n de PHP </h3><br>  Despu√©s de instalar PHP, abr√≠ su archivo de configuraci√≥n: <br><br>  <b># nano /etc/php5/apache2/php.ini</b> <br><br>  Y trajo algunos par√°metros a la siguiente forma: <br><br><ul><li>  memoria_limit = 1024M </li><li>  default_charset = "UTF-8" </li><li>  upload_max_filesize = 256M </li><li>  sendmail_path = /usr/bin/fake_sendmail.sh </li></ul><br>  Usando el m√≥dulo PHP, puede proporcionar el almacenamiento en cach√© de datos en la memoria.  El almacenamiento en cach√© es √∫til en caso de alta carga del servidor para los datos, cuya generaci√≥n requiere una gran cantidad de recursos, por ejemplo, los resultados de consultas a la base de datos o el procesamiento de piezas "pesadas" de una plantilla de sitio.  Como servidor de almacenamiento en cach√©, eleg√≠ el m√≥dulo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">memcached</a> . <br><br>  Instalar memcache: <br><br>  <sup>[ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Este texto fue</a> escrito espec√≠ficamente para el sitio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">geektimes.ru</a> por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">AlexanderS</a> .</sup> <sup><br></sup>  <sup>El enlace a la fuente es opcional, ¬°pero su referencia es altamente deseable!</sup>  <sup>]</sup> <br><br>  <b># apt-get install memcached php5-memcached</b> <br><br>  Veamos los ajustes de configuraci√≥n del servicio: <br><br>  <b># nano /etc/memcached.conf</b> <br><br>  En la configuraci√≥n, aument√© el tama√±o de la memoria utilizada para el almacenamiento en cach√©: -m 64 -&gt; -m 256. Y verifiqu√© la disponibilidad del modo de operaci√≥n solo en la zona local: -l 127.0.0.1. <br><br>  Reiniciamos el servicio de almacenamiento en cach√© y el servidor web: <br><br>  <b># servicio memcached reiniciar</b> <b><br></b>  <b># service apache2 restart</b> <br><br>  Ahora debe asegurarse de que el servicio funcione.  Para hacer esto, cree un archivo: <br><br>  <b># nano /var/www/info.php</b> <br><br>  Y agregue el siguiente texto: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> phpinfo (); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  No olvide verificar la existencia del archivo .htaccess en el directorio / var / www con el contenido permisivo correspondiente, si no est√° all√≠, cr√©elo. <br><br>  Ahora puede abrir en su navegador http: // 127.0.0.1/info.php: se debe abrir una p√°gina con informaci√≥n sobre PHP, en la que debe verificar la secci√≥n memcached en ella.  Si aparece la tabla, PHP est√° funcionando. <br><br>  Puede verificar el servicio memcached en ejecuci√≥n de esta manera: <br><br>  <b>$ ps -aux |</b>  <b>grep memcached</b> <br><br>  El terminal debe devolver una cadena que contiene la configuraci√≥n de memcached. <br><br>  <b>Crear un trozo de correo para PHP</b> <br><br>  En la configuraci√≥n de PHP, se especific√≥ un script de shell como el par√°metro sendmail_path.  La funci√≥n de este script es guardar cartas enviadas a trav√©s de la funci√≥n php mail () est√°ndar en la m√°quina local, en una carpeta conveniente, y no enviarlas a ning√∫n lado. <br><br>  Crea un archivo: <br><br>  <b># nano /usr/bin/fake_semdmail.sh</b> <br><br>  Con los siguientes contenidos: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh prefix="/var/mail/sendmail/new" numPath="/var/mail/sendmail" if [ ! -f $numPath/num ]; then echo "0" &gt; $numPath/num fi num=`cat $numPath/num` num=$(($num + 1)) echo $num &gt; $numPath/num name="$prefix/letter_$num.txt" while read line do echo $line &gt;&gt; $name done chmod 777 $name /bin/true</span></span></code> </pre> <br>  Haga que este archivo sea ejecutable: <br><br>  <b># chmod + x /usr/bin/fake_semdmail.sh</b> <br><br>  Cree los directorios necesarios que pueda necesitar si configura la recopilaci√≥n de cartas por el programa de correo: <br><br>  <b># mkdir / var / mail / sendmail / var / mail / sendmail / cur / var / mail / sendmail / new / var / mail / sendmail / tmp</b> <br><br>  Y asignamos derechos para que el servidor pueda escribir archivos en esta carpeta: <br><br>  <b># chmod 777 -R / var / mail / sendmail</b> <br><br>  Ahora todo el correo saliente se agregar√° a / var / mail / sendmail.  Se pueden ver con un editor de texto o se pueden recopilar por programa de correo.  El software preinstalado de Debian viene con un cliente de correo electr√≥nico Evolution.  Cuando configure la cuenta, seleccione "Directorios de correo en formato Maildir" como tipo de servidor y especifique la ruta al directorio de correo (/ var / mail / sendmail), y seleccione "Sendmail" como el servidor. <br><br>  Eso es todo.  En general, hemos terminado con el servidor: se obtiene una m√°quina virtual universal, sobre la base de la cual puede construir sus servicios de red.  Dej√© los accesos HTTP y HTTPS.  Sin embargo, despu√©s de adquirir experiencia en la creaci√≥n y configuraci√≥n de un servidor, as√≠ como de agregar sitios (ver m√°s abajo), recomendar√≠a crear una nueva m√°quina virtual con un servidor sin una interfaz gr√°fica como el consumo de recursos m√°s √≥ptimo. <br><br><hr><a name="chap6"></a><br><h3>  Configuraci√≥n de acceso SSH </h3><br>  Un servidor no ser√≠a un servidor completo sin acceso a trav√©s de SSH.  El llamado "shell" le permite conectarse de forma r√°pida y segura a un servidor remoto, utilizando, por ejemplo, un peque√±o programa de masilla: en la computadora local tenemos acceso directo a la terminal del servidor remoto. <br><br>  Instalaci√≥n de servicio: <br><br>  <b># apt-get install ssh</b> <br><br>  Abramos el puerto para SSH (de hecho, el puerto predeterminado debe estar en el n√∫mero 22, pero a continuaci√≥n redefin√≠ el puerto en la configuraci√≥n SSH): <br><br>  <b># ufw permite 106</b> <br><br>  Para organizar el acceso de nuestro usuario, abra el archivo: <br><br>  <b># nano / etc / ssh / sshd_config</b> <br><br>  Y agregue la directiva al final del archivo: <br><br><blockquote>  Usuario de AllowUsers </blockquote><br>  Adem√°s, por razones de seguridad, realic√© los siguientes cambios en este archivo: <br><br><ul><li>  cambi√≥ el puerto de 22 a otro ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">lista de puertos</a> ): Puerto 22 -&gt; Puerto 106 </li><li>  deshabilit√≥ el protocolo heredado: Protocolo 2.1 -&gt; Protocolo 2 </li><li>  acceso remoto deshabilitado para root: PermitRootLogin s√≠ (o PermitRootLogin sin contrase√±a) -&gt; PermitRootLogin no </li></ul><br>  Luego reinicie el servicio: <br><br>  <b># service sshd restart</b> <br><br>  Ahora puedo ejecutar el programa de masilla en la m√°quina host y conectarme a mi servidor en modo consola ingresando la direcci√≥n de conexi√≥n 192.168.233.138, el puerto 106 y el nombre de usuario.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al conectarse, debe responder afirmativamente para aceptar las claves e ingresar la contrase√±a para el usuario usuario. </font><font style="vertical-align: inherit;">Si necesita ejecutar comandos desde el superusuario, puede usar el comando su ya conocido.</font></font><br><br><hr><a name="chap7"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Protecci√≥n de acceso </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No comenc√© a proteger el servidor web de DDoS, creyendo inicialmente que si est√° alojado en VPS / VDS, el alojamiento proporcionar√° una protecci√≥n efectiva, y si hace que su servidor se "quede" en Internet, este problema debe abordarse seriamente y este es un tema art√≠culo separado La protecci√≥n lenta HTTP DDoS es relativamente simple de acuerdo con numerosas instrucciones en Internet, pero no lo salvar√° de un ataque distribuido desde muchas direcciones IP diferentes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Con DDoS, nuestro servidor simplemente dejar√° de funcionar por un tiempo. Pero despu√©s de un ataque que no durar√° para siempre, el servidor se recuperar√°. Pero si alguien logra obtener acceso a trav√©s de SSH, entonces se perder√° el control sobre el servidor y los datos se ver√°n comprometidos, por lo que es una buena idea controlar el acceso al servidor a trav√©s de SSH.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lo m√°s simple y com√∫n que se puede hacer es cambiar el puerto est√°ndar, lo que hicimos al configurar SSH. Hace aproximadamente cinco a√±os, "introduje" el servidor reci√©n creado en Internet en una direcci√≥n IP real recientemente recibida y me sorprendi√≥ que durante la semana de existencia del servidor, de la que nadie sab√≠a nada todav√≠a, se acumul√≥ una gran cantidad de registros en los registros del sistema sobre intentos fallidos de autorizaci√≥n a trav√©s de SSH y FTP. Obviamente, en la Internet moderna, hay un n√∫mero considerable de servicios rob√≥ticos que buscan computadoras con puertos abiertos e intentan conectarse a ellas clasificando las contrase√±as utilizando la base de datos existente o utilizando el m√©todo de b√∫squeda exhaustivo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afortunadamente para nosotros, existe algo como fail2ban: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># apt-get install fail2ban</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inmediatamente despu√©s de la instalaci√≥n, la utilidad ya est√° configurada para proteger la mayor√≠a de los puertos y si aparecen m√°s de seis intentos fallidos de conexi√≥n en los registros del sistema en diez minutos, el intruso se bloquear√° durante diez minutos. El mecanismo de operaci√≥n de fail2ban es bastante simple: las llamadas c√°rceles que activan una acci√≥n dise√±ada para proteger la aplicaci√≥n son activadas por ciertos activadores. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los par√°metros de bloqueo se pueden configurar individualmente: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano /etc/fail2ban/jail.local</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En el archivo creado, es necesario prescribir las configuraciones que reemplazar√°n a las existentes por defecto. Un ejemplo del contenido de mi archivo:</font></font><br><br> <code>#   <br> [DEFAULT] <br> ignoreip = 127.0.0.1 <br> bantime = 2592000 <br> findtime = 43200 <br> maxretry = 6 <br> banaction = iptables-multiport <br> #      <br> destemail = user@localhost <br> sendername = Fail2Ban <br> mta = sendmail <br> action = %(action_mwl)s <br> <br> #  SSH <br> [ssh] <br> enabled = true <br> port = 106 <br> filter = sshd <br> logpath = /var/log/auth.log <br> <br> #      <br> [apache] <br> enabled = true <br> port = http,https <br> filter = apache-auth <br> logpath = /var/log/apache*/*error.log <br> <br> #        php  <br> [apache-noscript] <br> enabled = true <br> port = http,https <br> filter = apache-noscript <br> logpath = /var/log/apache*/*error.log <br> <br> #     <br> [apache-overflows] <br> enabled = true <br> port = http,https <br> filter = apache-overflows <br> logpath = /var/log/apache*/*error.log <br> maxretry = 2 <br> <br> #          <br> [apache-nohome] <br> enabled = true <br> port = http,https <br> filter = apache-nohome <br> logpath = /var/log/apache*/*error.log <br> maxretry = 2</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La configuraci√≥n anterior le permite no controlar el acceso local, y con seis intentos de inicio de sesi√≥n incorrectos dentro de las 12 horas, la direcci√≥n IP del atacante que usa iptables estar√° prohibida durante 30 d√≠as. </font><font style="vertical-align: inherit;">Controla no solo el acceso a los puertos para SSH, sino tambi√©n las acciones sospechosas destinadas a desestabilizar el funcionamiento del servidor web.</font></font><br><br><hr><a name="chap8"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Referencia del servidor web </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inicio, detenci√≥n y reinicio del servidor: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 start </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 stop </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 restart</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Recarga de las configuraciones del servidor: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 reload</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Encendido y apagado del </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">host de prueba</font></font><br><font style="vertical-align: inherit;"></font></b> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><b><font style="vertical-align: inherit;"># a2ensite test </font></b><b><font style="vertical-align: inherit;"># a2dissite test</font></b></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Encendido y apagado de la configuraci√≥n de prueba: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># a2enconf test </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># a2disconf prueba</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comprobaci√≥n de la sintaxis de los archivos (deber√≠a devolver: "Sintaxis </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correcta</font></font></b> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "): </font><b><font style="vertical-align: inherit;"># apache2ctl configtest </font></b></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opci√≥n para agregar un sitio con acceso HTTP o HTTPS utilizando un host virtual existente</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digamos que necesitamos agregar un nuevo sitio a nuestro servidor ubicado en el directorio de site.com ubicado en / home / user / www. Esto puede ser conveniente, ya que el usuario usuario no necesitar√° abandonar los l√≠mites de su directorio de inicio cuando trabaje con el sitio. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Establecemos los permisos para el directorio de usuarios (por si acaso): </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># chmod 755 / home / user</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cree un directorio para el sitio: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ mkdir / home / user / www /home/user/www/site.com Colocamos un</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enlace simb√≥lico al directorio del sitio: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># ln -s /home/user/www/site.com /var/www/site.com</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para agregar acceso a trav√©s de HTTP, abra el archivo: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano /etc/apache2/sites-available/000-default.conf</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O para agregar acceso a trav√©s de HTTPS abre el archivo:</font></font><br><br>  <b># nano /etc/apache2/sites-available/default-ssl.conf</b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y agregue el siguiente contenido al archivo abierto antes de la etiqueta de cierre / VirtualHost:</font></font><br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;Directory /var/www/site.com&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">Options</span></span></span></span> FollowSymLinks AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> Require <span class="hljs-literal"><span class="hljs-literal">all</span></span> granted &lt;/Directory&gt;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reiniciamos el servidor web: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 restart Revisamos</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la disponibilidad del sitio en http: // 127.0.0.1/site.com o https: // 127.0.0.1/site.com (m√©todo de verificaci√≥n - ver m√°s abajo). Cabe se√±alar que el sitio se abrir√° independientemente de la disponibilidad del archivo .htaccess, ya que la directiva: "Requerir todo lo otorgado" se establece para el directorio con el sitio. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opci√≥n para agregar un sitio con acceso HTTP o HTTPS utilizando un nuevo host virtual y configurar el acceso al sitio a trav√©s de su nombre de dominio, no IP.</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Las condiciones de la tarea son las mismas que las anteriores: supongamos que necesitamos agregar un nuevo sitio a nuestro servidor ubicado en el directorio del sitio .com ubicado en / home / user / www. Pero ahora todav√≠a quiero acceder al sitio ingresando solo su nombre de dominio en la l√≠nea del navegador.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Establecemos permisos para el directorio de usuarios (por si acaso): </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># chmod 755 / home / user</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cree un directorio para el sitio: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ mkdir /home/user/www/site.com Colocamos un</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enlace simb√≥lico al directorio del sitio: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># ln -s / home / user /www/site.com /var/www/site.com</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para agregar acceso a trav√©s de HTTP, cree un archivo: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano /etc/apache2/sites-available/site.com.conf</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y agregue los siguientes contenidos:</font></font><br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;VirtualHost *:80&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">ServerName</span></span></span></span> site.com ServerAlias www.site.com ServerAdmin user@localhost DocumentRoot /var/www/site.com &lt;Directory /var/www/site.com&gt; Options FollowSymLinks AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> Require <span class="hljs-literal"><span class="hljs-literal">all</span></span> granted &lt;/Directory&gt; # Redirect HTTP-&gt;HTTPS #RewriteEngine <span class="hljs-literal"><span class="hljs-literal">On</span></span> #RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{HTTPS}</span></span> <span class="hljs-literal"><span class="hljs-literal">off</span></span> #RewriteRule (.*) https://<span class="hljs-variable"><span class="hljs-variable">%{HTTP_HOST}</span></span><span class="hljs-variable"><span class="hljs-variable">%{REQUEST_URI}</span></span><span class="hljs-meta"><span class="hljs-meta"> [NC,R=301,L] ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined &lt;/VirtualHost&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O para agregar acceso a trav√©s de HTTPS, cree un archivo: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano /etc/apache2/sites-available/site.com-ssl.conf</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y agregue los siguientes contenidos:</font></font><br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;IfModule mod_ssl.c&gt;</span></span> <span class="hljs-section"><span class="hljs-section">&lt;VirtualHost _default_:443&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">ServerName</span></span></span></span> site.com ServerAlias www.site.com ServerAdmin user@localhost DocumentRoot /var/www/site.com &lt;Directory /var/www/site.com&gt; Options FollowSymLinks AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> Require <span class="hljs-literal"><span class="hljs-literal">all</span></span> granted &lt;/Directory&gt; # HSTS (mod_headers is required) (15768000 seconds = 6 months) Header always set Strict-Transport-Security <span class="hljs-string"><span class="hljs-string">"max-age=15768000"</span></span> ErrorLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/error.log CustomLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/access.log combined SSLEngine <span class="hljs-literal"><span class="hljs-literal">on</span></span> SSLCertificateFile /etc/ssl/certs/apache-selfsigned.crt SSLCertificateKeyFile /etc/ssl/private/apache-selfsigned.key &lt;FilesMatch <span class="hljs-string"><span class="hljs-string">"\.(cgi|shtml|phtml|php)$"</span></span>&gt; SSLOptions +StdEnvVars &lt;/FilesMatch&gt; &lt;Directory /usr/lib/cgi-bin&gt; SSLOptions +StdEnvVars &lt;/Directory&gt; BrowserMatch <span class="hljs-string"><span class="hljs-string">"MSIE [2-6]"</span></span> \ nokeepalive ssl-unclean-shutdown \ downgrade-1.0 force-response-1.0 BrowserMatch <span class="hljs-string"><span class="hljs-string">"MSIE [17-9]"</span></span> ssl-unclean-shutdown &lt;/VirtualHost&gt; &lt;/IfModule&gt;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agregue la l√≠nea "127.0.0.1 site.com" a </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / hosts</font></font></b> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><b><font style="vertical-align: inherit;"># echo &gt;&gt; / etc / hosts 127.0.0.1 site.com</font></b></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Active el host HTTP: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># a2ensite site.com.conf</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O active el host HTTPS: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># a2ensite site. com-ssl.conf Reiniciamos</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> el servidor web: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 restart</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verificamos la disponibilidad del sitio en http: // site.com o https: // site.com (m√©todo de verificaci√≥n - ver m√°s abajo). Cabe se√±alar que el sitio se abrir√° independientemente de la disponibilidad del archivo .htaccess, ya que la directiva: "Requerir todo lo otorgado" se establece para el directorio con el sitio. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todas las acciones se realizan dentro de la m√°quina virtual invitada. Ser√≠a interesante "abrir" el sitio en el navegador del sistema host.</font></font> No es dificil.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conocemos el nombre de dominio y la direcci√≥n IP de la m√°quina invitada. </font><font style="vertical-align: inherit;">Si el sistema host es Windows, debe abrir el archivo c: \ Windows \ System32 \ drivers \ etc \ hosts y agregar la siguiente l√≠nea al final:</font></font><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 192.168.233.138 site.com </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Despu√©s de este cambio, la computadora o el sistema host deber√°n reiniciarse. Ahora, cuando abra site.com en su navegador, el acceso a este ser√° redirigido a nuestra m√°quina virtual. De hecho, hicimos el enrutamiento m√°s simple en nuestro Internet personal en el nivel del sistema operativo host. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En caso de que necesite acceso al host virtual solo a trav√©s de HTTPS, pero no quiera perder conexiones a trav√©s de HTTP, puede configurar la redirecci√≥n: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- cree el archivo /etc/apache2/sites-available/site.com.conf de acuerdo con las instrucciones anteriores, si no se crea </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- en el archivo /etc/apache2/sites-available/site.com.conf, elimine el comentario de las tres l√≠neas RewriteEngine / RewriteCond / RewriteRule </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- active el host site.com.conf si no est√° activado</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- reinicie el servidor: # service apache2 restart </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verificaci√≥n del estado del sitio agregado</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La forma m√°s f√°cil de verificar la disponibilidad del sitio es colocar el archivo index.html con alg√∫n contenido en su directorio ra√≠z. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cree un archivo index.html: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ nano /home/user/www/site.com/index.html</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y agregue los siguientes contenidos:</font></font><br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>TEST OK<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>TEST OK<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Seg√∫n el m√©todo de agregar el sitio, abra en su navegador la direcci√≥n http: // 127.0.0.1/site.com (https: // 127.0.0.1/site.com) o http: // site.com (https: // site.com ): se debe abrir una p√°gina que contenga el texto "TEST OK". </font></font><br><br><hr><a name="chap9"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Referencia de MySQL </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creaci√≥n de usuario user123 con contrase√±a pass123 y base de datos db123 a trav√©s de la consola. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ingrese mysql ingresando la contrase√±a de superusuario mysql cuando se le solicite: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># mysql -u root -p</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Y cree una base de datos (no necesita escribir el prefijo "mysql&gt;", el punto y coma es obligatorio al final): </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; CREATE DATABASE `db123`;</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Crear usuario user123 con contrase√±a pass123: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; CREAR USUARIO 'user123' @ 'localhost' IDENTIFICADO POR 'pass123';</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Otorgue privilegios al usuario en la base de datos: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; OTORGUE TODOS LOS PRIVILEGIOS EN `db123`. * A 'user123' @ 'localhost';</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Actualizar tabla de privilegios: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; FLUSH PRIVILEGES;</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Salga de mysql: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; salir</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para verificar, abra la direcci√≥n http: // 127.0.0.1/phpmyadmin e inicie sesi√≥n con los detalles de acceso user123 / pass123. </font><font style="vertical-align: inherit;">Se debe abrir el acceso a la base de datos db123. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cambiar la contrase√±a para root mysql con pass123 a pass456: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># mysqladmin -uroot -ppass123 contrase√±a pass456</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cambiar la contrase√±a para user123 de pass123 a pass456: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># mysqladmin -uuser123 -ppass123 contrase√±a pass456</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eliminando user123: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; DROP USER 'user123' @ 'localhost' ; </font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eliminar la tabla db123: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; DROP DATABASE `db123`;</font></font></b> <br><br><hr><a name="chap10"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Material de referencia de Fail2ban </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reiniciando el servicio: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service fail2ban restart</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Revisando las reglas de ejecuci√≥n: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># fail2ban-client status</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Estad√≠sticas detalladas sobre la regla sshd: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># fail2ban-client status ssh</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Unbanning: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># fail2ban-client set ssh unbanip Banned_IP</font></font></b> <br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regrese </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">al principio, a la tabla de contenido</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><hr><br>  La historia de la creaci√≥n de una nube dom√©stica.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parte 2. Crear un servidor: configurar LAMP en Debian. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versi√≥n de texto: 1.0.1. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fecha de primera publicaci√≥n: 30/01/2018. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√öltima edici√≥n: 15/01/2020.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actualizar registro</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.0.1 [15-01-2020] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actualizaci√≥n de la tabla de contenido. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.0.0 [30-01-2018] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La primera versi√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Describe c√≥mo instalar y configurar LAMP en Debian 8.7.x.</font></font><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es409915/">https://habr.com/ru/post/es409915/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es409901/index.html">Todav√≠a puedes ingresar al mismo r√≠o dos veces</a></li>
<li><a href="../es409903/index.html">¬øPor qu√© las ecuaciones m√°s complejas de la f√≠sica son tan dif√≠ciles?</a></li>
<li><a href="../es409905/index.html">C√≥mo usar un tel√©fono inteligente para mejorar la salud</a></li>
<li><a href="../es409907/index.html">Ruleta rusa Ecola</a></li>
<li><a href="../es409911/index.html">Las nuevas revisiones de los m√≥dulos basados ‚Äã‚Äãen ESP8266 no pueden escribir en SPI Flash</a></li>
<li><a href="../es409917/index.html">Resultados de un estudio de 4 a√±os de arrecifes de coral: el pl√°stico mata a los corales</a></li>
<li><a href="../es409919/index.html">Preg√∫ntele a Ethan: ¬øQu√© tan cerca estamos de la teor√≠a de todo?</a></li>
<li><a href="../es409921/index.html">Informe de confiabilidad de HDD Backblaze: estad√≠sticas de 2013 a 2017</a></li>
<li><a href="../es409923/index.html">Los matem√°ticos han encontrado un problema en las famosas ecuaciones para la descripci√≥n de l√≠quidos.</a></li>
<li><a href="../es409925/index.html">Hacer trampa en vivo en el accidente de Ariane 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>