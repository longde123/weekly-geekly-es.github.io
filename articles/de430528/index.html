<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé§ üò® ‚òùüèª Programmieren mit PyUSB 1.0 üìì üêì üàπ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vom √úbersetzer : 
 Dies ist eine √úbersetzung des Handbuchs Programmieren mit PyUSB 1.0 
 Dieser Leitfaden wurde von den PyUSB-Entwicklern geschrieben,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programmieren mit PyUSB 1.0</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430528/">  <i><b>Vom √úbersetzer</b> :</i> <i><br></i>  <i>Dies ist eine √úbersetzung des <a href="">Handbuchs Programmieren mit PyUSB 1.0</a></i> <i><br></i>  <i>Dieser Leitfaden wurde von den PyUSB-Entwicklern geschrieben, aber ich glaube, dass <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">walac</a> der Hauptautor des Leitfadens ist.</i> <br><br><h2>  Darf ich mich vorstellen? </h2><br>  <b>PyUSB 1.0</b> ist eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Python-</a> Bibliothek, die einen einfachen Zugriff auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">USB</a> bietet.  PyUSB bietet verschiedene Funktionen: <br><br><ul><li>  <i><b>100% in Python geschrieben:</b></i> <br>  Im Gegensatz zu 0.x-Versionen, die in C geschrieben wurden, ist Version 1.0 in Python geschrieben.  Dadurch k√∂nnen Python-Programmierer ohne C-Erfahrung besser verstehen, wie PyUSB funktioniert. </li><li> <i><b>Plattformneutralit√§t:</b></i> <br>  Version 1.0 enth√§lt ein Front-End-Backend-Schema.  Es isoliert die API von systemspezifischen Implementierungsdetails.  Die <u>IBackend-</u> Schnittstelle verbindet diese beiden Schichten.  PyUSB verf√ºgt √ºber integrierte Backends f√ºr libusb 0.1, libusb 1.0 und OpenUSB.  Sie k√∂nnen Ihr Backend selbst schreiben, wenn Sie m√∂chten. </li><li>  <i><b>Portabilit√§t:</b></i> <br>  PyUSB sollte auf jeder Plattform mit Python&gt; = 2.4, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ctypes</a> und mindestens einem der unterst√ºtzten integrierten Backends ausgef√ºhrt werden. </li><li>  <i><b>Einfachheit:</b></i> <br>  Die Interaktion mit einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">USB-</a> Ger√§t war noch nie so einfach!  USB ist ein komplexes Protokoll, und PyUSB verf√ºgt √ºber gute Voreinstellungen f√ºr die g√§ngigsten Konfigurationen. </li><li>  <i><b>Isochrone Zahnradunterst√ºtzung:</b></i> <br>  PyUSB unterst√ºtzt isochrone √úbertragungen, wenn das zugrunde liegende Backend sie unterst√ºtzt. </li></ul><br>  Obwohl PyUSB die USB-Programmierung weniger schmerzhaft macht, wird in diesem Lernprogramm davon ausgegangen, dass Sie nur minimale Kenntnisse des USB-Protokolls haben.  Wenn Sie nichts √ºber USB wissen, empfehle ich Jan Axelsons <b>ausgezeichnetes USB Complete-</b> Buch. <br><a name="habracut"></a><br><h2>  Genug geredet, lasst uns den Code schreiben! </h2><br><h3>  Wer ist wer </h3><br>  Lassen Sie uns zun√§chst eine Beschreibung der PyUSB-Module geben.  Alle PyUSB-Module befinden sich unter <u>USB</u> mit den folgenden Modulen: <br><table><tbody><tr><th>  Modul </th><th>  Beschreibung </th></tr><tr><td>  Kern </td><td>  Das Haupt-USB-Modul. </td></tr><tr><td>  util </td><td>  Hilfsfunktionen. </td></tr><tr><td>  Kontrolle </td><td>  Standardverwaltungsanforderungen. </td></tr><tr><td>  Verm√§chtnis </td><td>  Kompatibilit√§tsschicht der Version 0.x. </td></tr><tr><td>  Backend </td><td>  Ein Unterpaket mit integrierten Backends. </td></tr></tbody></table><br>  Geben Sie beispielsweise Folgendes ein, um ein <u>Kernmodul</u> zu importieren: <br><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core &gt;&gt;&gt; dev = usb.core.find()</code> </pre> <br><h3>  Nun, fangen wir an </h3><br>  Das folgende Programm sendet die Zeichenfolge 'test' an die erste gefundene Datenquelle (Endpunkt OUT): <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.util <span class="hljs-comment"><span class="hljs-comment">#    dev = usb.core.find(idVendor=0xfffe, idProduct=0x0001) #   ? if dev is None: raise ValueError('Device not found') #   .  ,   #    dev.set_configuration() #    cfg = dev.get_active_configuration() intf = cfg[(0,0)] ep = usb.util.find_descriptor( intf, #     custom_match = \ lambda e: \ usb.util.endpoint_direction(e.bEndpointAddress) == \ usb.util.ENDPOINT_OUT) assert ep is not None #   ep.write('test')</span></span></code> </pre><br>  Die ersten beiden Zeilen importieren die PyUSB-Paketmodule.  <u>usb.core</u> ist das Hauptmodul und <u>usb.util</u> enth√§lt <u>Hilfsfunktionen</u> .  Der folgende Befehl sucht nach unserem Ger√§t und gibt eine Instanz des Objekts zur√ºck, wenn es gefunden wird.  Wenn nicht, wird <u>None zur√ºckgegeben</u> .  Als n√§chstes legen wir die Konfiguration fest, die wir verwenden werden.  Hinweis: Das Fehlen von Argumenten bedeutet, dass die gew√ºnschte Konfiguration standardm√§√üig festgelegt wurde.  Wie Sie sehen werden, haben viele PyUSB-Funktionen Standardeinstellungen f√ºr die meisten g√§ngigen Ger√§te.  In diesem Fall wird die erste gefundene Konfiguration festgelegt. <br><br>  Dann suchen wir nach dem Endpunkt, an dem wir interessiert sind.  Wir suchen es in der ersten Schnittstelle, die wir haben.  Nachdem wir diesen Punkt gefunden haben, senden wir Daten an ihn. <br><br>  Wenn wir die Endpunktadresse im Voraus kennen, k√∂nnen wir einfach die <u>Schreibfunktion</u> des Ger√§teobjekts aufrufen: <br><br><pre> <code class="python hljs">dev.write(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'test'</span></span>)</code> </pre><br>  Hier schreiben wir den String 'test' am Haltepunkt an Adresse <i>1</i> .  Alle diese Funktionen werden in den folgenden Abschnitten n√§her erl√§utert. <br><br><h3>  Was ist los? </h3><br>  Jede Funktion in PyUSB l√∂st im Fehlerfall eine Ausnahme aus.  Neben den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Standard-Python-Ausnahmen</a> definiert <u>PyUSB usb.core.USBError</u> f√ºr USB-bezogene Fehler. <br><br>  Sie k√∂nnen auch die PyUSB-Protokollfunktionen verwenden.  Es verwendet das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Protokollierungsmodul</a> .  Um es zu verwenden, definieren Sie die Umgebungsvariable <u>PYUSB_DEBUG</u> mit einer der folgenden Protokollierungsstufen: <u>kritisch</u> , <u>Fehler</u> , <u>Warnung</u> , <u>Info</u> oder <u>Debug</u> . <br><br>  Standardm√§√üig werden Nachrichten an <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sys.stderr</a> gesendet.  Wenn Sie m√∂chten, k√∂nnen Sie Protokollnachrichten in eine Datei umleiten, indem Sie die Umgebungsvariable <u>PYUSB_LOG_FILENAME definieren</u> .  Wenn der Wert der richtige Pfad zur Datei ist, werden dort Nachrichten geschrieben, andernfalls werden sie an <u>sys.stderr</u> gesendet. <br><br><h3>  Wo bist du? </h3><br>  Die Funktion <u>find ()</u> im Kernmodul wird verwendet, um an das System angeschlossene Ger√§te zu finden und zu nummerieren.  Angenommen, unser Ger√§t verf√ºgt √ºber eine Hersteller-ID mit dem Wert 0xfffe und einer Produkt-ID von 0x0001.  Wenn wir dieses Ger√§t finden m√ºssen, werden wir dies tun: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core dev = usb.core.find(idVendor=<span class="hljs-number"><span class="hljs-number">0xfffe</span></span>, idProduct=<span class="hljs-number"><span class="hljs-number">0x0001</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> dev <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> ValueError(<span class="hljs-string"><span class="hljs-string">'Our device is not connected'</span></span>)</code> </pre><br>  Das ist alles, die Funktion gibt das <u>usb.core.Device-</u> Objekt zur√ºck, das unser Ger√§t darstellt.  Wenn das Ger√§t nicht gefunden wird, wird <u>None zur√ºckgegeben</u> .  Tats√§chlich k√∂nnen Sie jedes gew√ºnschte Feld der Device <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Descriptor-</a> Klasse verwenden.  Was ist zum Beispiel, wenn wir herausfinden m√∂chten, ob ein USB-Drucker an das System angeschlossen ist?  Es ist sehr einfach: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      ,   if usb.core.find(bDeviceClass=7) is None: raise ValueError('No printer found')</span></span></code> </pre><br>  7 ist der Code f√ºr die Druckerklasse gem√§√ü der USB-Spezifikation.  Oh, warte, was ist, wenn ich alle verf√ºgbaren Drucker nummerieren m√∂chte?  Kein Problem: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     ... printers = usb.core.find(find_all=True, bDeviceClass=7) # Python 2, Python 3,     import sys sys.stdout.write('There are ' + len(printers) + ' in the system\n.')</span></span></code> </pre><br>  Was ist passiert?  Nun, Zeit f√ºr eine kleine Erkl√§rung ... <u>find</u> hat einen Parameter namens <u>find_all</u> und ist standardm√§√üig False.  Wenn es falsch ist <a name="orig1"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[1]</a> , <u>find</u> gibt das erste Ger√§t zur√ºck, das den angegebenen Kriterien entspricht (wir werden bald dar√ºber sprechen).  Wenn Sie dem Parameter einen <i>wahren</i> Wert √ºbergeben, gibt <u>find</u> stattdessen eine Liste aller Ger√§te zur√ºck, die den Kriterien entsprechen.  Das ist alles!  Einfach, richtig? <br><br>  Sind wir fertig?  Nein!  Ich habe noch nicht alles erz√§hlt: Viele Ger√§te legen ihre Klasseninformationen tats√§chlich im Interface <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Descriptor</a> anstelle des Device <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Descriptor ab</a> .  Um wirklich alle an das System angeschlossenen Drucker zu finden, m√ºssen wir alle Konfigurationen sowie alle Schnittstellen durchgehen und pr√ºfen, ob eine der Schnittstellen auf bInterfaceClass 7 eingestellt ist. Wenn Sie ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Programmierer</a> wie ich sind, fragen Sie sich m√∂glicherweise: Gibt es eine einfachere M√∂glichkeit, dies umzusetzen?  Antwort: Ja, das ist er.  Schauen wir uns zun√§chst den fertigen Code an, um alle angeschlossenen Drucker zu finden: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.util <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find_class</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, class_)</span></span></span><span class="hljs-function">:</span></span> self._class = class_ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__call__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, device)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#  ,   if device.bDeviceClass == self._class: return True # ,   ,   # ,     for cfg in device: # find_descriptor:  ? intf = usb.util.find_descriptor( cfg, bInterfaceClass=self._class ) if intf is not None: return True return False printers = usb.core.find(find_all=1, custom_match=find_class(7))</span></span></code> </pre><br>  Der Parameter <u>custom_match</u> akzeptiert jedes aufgerufene Objekt, das das Ger√§teobjekt empf√§ngt.  Es sollte true f√ºr ein geeignetes Ger√§t und false f√ºr ein unangemessenes Ger√§t zur√ºckgeben.  Sie k√∂nnen <u>custom_match auch</u> mit Ger√§tefeldern kombinieren, wenn Sie m√∂chten: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   ,    : printers = usb.core.find(find_all=1, custom_match=find_class(7), idVendor=0xfffe)</span></span></code> </pre><br>  Hier interessieren uns die Drucker des Lieferanten 0xfffe. <br><br><h3>  Beschreibe dich selbst </h3><br>  Ok, wir haben unser Ger√§t gefunden, aber bevor wir mit ihm interagieren, m√∂chten wir mehr dar√ºber erfahren.  Nun, Sie wissen, Konfigurationen, Schnittstellen, Endpunkte, Arten von Datenstr√∂men ... <br>  Wenn Sie ein Ger√§t haben, k√∂nnen Sie auf jedes Feld des Ger√§tedeskriptors als Objekteigenschaften zugreifen: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dev.bLength &gt;&gt;&gt; dev.bNumConfigurations &gt;&gt;&gt; dev.bDeviceClass &gt;&gt;&gt; <span class="hljs-comment"><span class="hljs-comment"># ...</span></span></code> </pre><br>  Um auf die verf√ºgbaren Konfigurationen im Ger√§t zuzugreifen, k√∂nnen Sie das Ger√§t iterieren: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cfg <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dev: sys.stdout.write(str(cfg.bConfigurationValue) + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>)</code> </pre><br>  Auf die gleiche Weise k√∂nnen Sie die Konfiguration f√ºr den Zugriff auf die Schnittstellen sowie die Schnittstellen f√ºr den Zugriff auf ihre Kontrollpunkte iterieren.  Jeder Objekttyp hat Felder des entsprechenden Deskriptors als Attribute.  Schauen Sie sich ein Beispiel an: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cfg <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dev: sys.stdout.write(str(cfg.bConfigurationValue) + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> intf <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cfg: sys.stdout.write(<span class="hljs-string"><span class="hljs-string">'\t'</span></span> + \ str(intf.bInterfaceNumber) + \ <span class="hljs-string"><span class="hljs-string">','</span></span> + \ str(intf.bAlternateSetting) + \ <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ep <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> intf: sys.stdout.write(<span class="hljs-string"><span class="hljs-string">'\t\t'</span></span> + \ str(ep.bEndpointAddress) + \ <span class="hljs-string"><span class="hljs-string">'\n'</span></span>)</code> </pre><br>  Sie k√∂nnen auch Indizes f√ºr den wahlfreien Zugriff auf Deskriptoren verwenden, wie hier: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-comment"><span class="hljs-comment">#      &gt;&gt;&gt; cfg = dev[1] &gt;&gt;&gt; #      &gt;&gt;&gt; intf = cfg[(0,0)] &gt;&gt;&gt; #    &gt;&gt;&gt; ep = intf[2]</span></span></code> </pre><br>  Wie Sie sehen k√∂nnen, werden die Indizes von 0 gez√§hlt. Aber warten Sie!  Die Art und Weise, wie ich auf die Schnittstelle zugreifen kann, ist etwas Seltsames ... Ja, Sie haben Recht, der Index f√ºr die Konfiguration besteht aus zwei Werten, von denen der erste der Schnittstellenindex und der zweite eine alternative Einstellung ist.  Um auf die erste Schnittstelle zuzugreifen, aber mit der zweiten Einstellung, schreiben wir im Allgemeinen <u>cfg [(0,1)]</u> . <br><br>  Jetzt ist es an der Zeit, eine leistungsstarke Methode zur Suche nach Deskriptoren zu erlernen - eine n√ºtzliche Funktion <u>find_descriptor</u> .  Wir haben es bereits im Beispiel f√ºr die Druckersuche gesehen.  <u>find_descriptor</u> funktioniert fast genauso wie <u>find</u> , mit zwei Ausnahmen: <br><br><ul><li>  <u>find_descriptor</u> erh√§lt als ersten Parameter den <u>Quelldeskriptor</u> , den Sie durchsuchen <u>m√∂chten</u> . </li><li>  Es gibt keinen <u>Backend-</u> Parameter <a name="orig2"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[2]</a> . </li></ul><br>  Wenn wir beispielsweise einen <u>cfg-</u> Konfigurationsdeskriptor haben und alle alternativen Einstellungen f√ºr Schnittstelle 1 finden m√∂chten, gehen wir folgenderma√üen vor: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.util alt = usb.util.find_descriptor(cfg, find_all=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, bInterfaceNumber=<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br>  Beachten Sie, dass sich <u>find_descriptor</u> im Modul <u>usb.util</u> befindet.  Es akzeptiert auch den <u>zuvor</u> beschriebenen Parameter <u>custom_match</u> . <br><br>  <b>Wir haben es mit mehreren identischen Ger√§ten zu tun</b> <br><br>  Manchmal k√∂nnen zwei identische Ger√§te an einen Computer angeschlossen sein.  Wie k√∂nnen Sie zwischen ihnen unterscheiden?  <u>Ger√§teobjekte</u> verf√ºgen √ºber zwei zus√§tzliche Attribute, die nicht Teil der USB-Spezifikation sind, aber sehr n√ºtzlich sind: die <u>Bus-</u> und <u>Adressattribute</u> .  Zun√§chst ist zu erw√§hnen, dass diese Attribute vom Backend stammen und vom Backend m√∂glicherweise nicht unterst√ºtzt werden. In diesem Fall sind sie auf <u>None festgelegt</u> .  Diese Attribute stellen jedoch die Nummer und Adresse des <u>Ger√§tebusses dar</u> und k√∂nnen, wie Sie vielleicht vermutet haben, verwendet werden, um zwischen zwei Ger√§ten mit denselben Attributwerten <u>idVendor</u> und <u>idProduct</u> zu unterscheiden. <br><br><h3>  Wie soll ich arbeiten? </h3><br>  Nach dem Anschlie√üen m√ºssen USB-Ger√§te mit einigen Standardabfragen konfiguriert werden.  Als ich anfing, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">USB-</a> Spezifikation zu studieren, war ich von den Deskriptoren, Konfigurationen, Schnittstellen, alternativen Einstellungen, √úbertragungstypen und all dem entmutigt ... Und das Schlimmste ist, dass Sie sie nicht einfach ignorieren k√∂nnen: Das Ger√§t funktioniert nicht, ohne die Konfiguration festzulegen, selbst wenn es eine ist!  PyUSB versucht, Ihr Leben so einfach wie m√∂glich zu gestalten.  Nachdem Sie beispielsweise Ihr Ger√§teobjekt empfangen haben, m√ºssen Sie zun√§chst vor der Interaktion mit ihm eine <u>set_configuration-</u> Anforderung senden.  Der Konfigurationsparameter f√ºr diese Abfrage, der Sie interessiert, ist <u>bConfigurationValue</u> .  Die meisten Ger√§te haben nicht mehr als eine Konfiguration, und das Verfolgen des zu verwendenden Konfigurationswerts ist √§rgerlich (obwohl der gr√∂√üte Teil des Codes, den ich gesehen habe, dies nur fest codiert hat).  Daher k√∂nnen Sie in PyUSB einfach eine <u>set_configuration-</u> Anforderung ohne Argumente senden.  In diesem Fall installiert er die erste gefundene Konfiguration (wenn Ihr Ger√§t nur eine hat, m√ºssen Sie sich √ºberhaupt nicht um den Konfigurationswert k√ºmmern).  Angenommen, Sie haben ein Ger√§t mit einem Konfigurationsdeskriptor und das Feld bConfigurationValue ist 5 <a name="orig3"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[3]</a> Nachfolgende Abfragen funktionieren genauso: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dev.set_configuration(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  &gt;&gt;&gt; dev.set_configuration() #  ,   5 -  #  &gt;&gt;&gt; cfg = util.find_descriptor(dev, bConfigurationValue=5) &gt;&gt;&gt; cfg.set() #  &gt;&gt;&gt; cfg = util.find_descriptor(dev, bConfigurationValue=5) &gt;&gt;&gt; dev.set_configuration(cfg)</span></span></code> </pre><br>  Wow!  Sie k√∂nnen das <u>Konfigurationsobjekt</u> als Parameter f√ºr <u>set_configuration verwenden</u> !  Ja, er hat auch eine <u>festgelegte</u> Methode, um sich in der aktuellen Konfiguration zu konfigurieren. <br><br>  Eine weitere Option, die Sie konfigurieren m√ºssen oder nicht konfigurieren m√ºssen, ist die Option zum √Ñndern von Schnittstellen.  Jedes Ger√§t kann jeweils nur eine aktivierte Konfiguration haben, und jede Konfiguration kann mehr als eine Schnittstelle haben, und Sie k√∂nnen alle Schnittstellen gleichzeitig verwenden.  Sie verstehen dieses Konzept besser, wenn Sie sich die Schnittstelle als logisches Ger√§t vorstellen.  Stellen wir uns zum Beispiel einen Multifunktionsdrucker vor, der gleichzeitig Drucker und Scanner ist.  Um nicht zu komplizieren (oder es zumindest so einfach wie m√∂glich zu machen), nehmen wir an, dass er nur eine Konfiguration hat.  Weil  Wir haben einen Drucker und einen Scanner. Die Konfiguration hat zwei Schnittstellen: eine f√ºr den Drucker und eine f√ºr den Scanner.  Ein Ger√§t mit mehr als einer Schnittstelle wird als zusammengesetztes Ger√§t bezeichnet.  Wenn Sie Ihren Multifunktionsdrucker an Ihren Computer anschlie√üen, l√§dt das Betriebssystem zwei verschiedene Treiber: einen f√ºr jedes ‚Äûlogische‚Äú Peripherieger√§t, √ºber das Sie verf√ºgen <a name="orig4"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[4]</a> . <br><br>  Was ist mit alternativen Schnittstelleneinstellungen?  Gut, dass du gefragt hast.  Eine Schnittstelle verf√ºgt √ºber eine oder mehrere alternative Einstellungen.  Eine Schnittstelle mit nur einer alternativen Einstellung hat keine alternativen Einstellungen <a name="orig5"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[5]</a> .  Alternative Einstellungen f√ºr Schnittstellen als Konfiguration f√ºr Ger√§te, dh f√ºr jede Schnittstelle k√∂nnen Sie nur eine aktive alternative Einstellung haben.  Beispielsweise legt die USB-Spezifikation nahe, dass ein Ger√§t in seiner prim√§ren alternativen Konfiguration keinen isochronen Pr√ºfpunkt haben kann <a name="orig6"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[6]</a> , so dass das Streaming-Ger√§t mindestens zwei alternative Einstellungen haben muss, wobei eine zweite Einstellung einen isochronen Pr√ºfpunkt hat.  Im Gegensatz zu Konfigurationen m√ºssen Schnittstellen mit nur einer alternativen Konfiguration jedoch nicht konfiguriert werden <a name="orig7"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[7]</a> .  Sie w√§hlen eine alternative Schnittstelleneinstellung mit der Funktion <u>set_interface_altsetting</u> aus: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dev.set_interface_altsetting(interface = <span class="hljs-number"><span class="hljs-number">0</span></span>, alternate_setting = <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre><br>  <b>Warnung</b> <br><br>  Die USB-Spezifikation besagt, dass das Ger√§t einen Fehler zur√ºckgeben darf, wenn es eine SET_INTERFACE-Anforderung f√ºr eine Schnittstelle empf√§ngt, die keine zus√§tzlichen alternativen Einstellungen hat.  Wenn Sie also nicht sicher sind, ob die Schnittstelle mehr als eine alternative Einstellung hat oder die SET_INTERFACE-Anforderung akzeptiert, ist es am sichersten, <u>set_interface_altsetting</u> innerhalb des Try- <u>Except</u> -Blocks <u>aufzurufen</u> , wie hier: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: dev.set_interface_altsetting(...) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> USBError: <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre><br>  Sie k√∂nnen das <u>Interface-</u> Objekt auch als Funktionsparameter verwenden. Die Parameter <u>interface</u> und <u>alternative_setting</u> werden automatisch von den <u>Feldern</u> <u>bInterfaceNumber</u> und <u>bAlternateSetting √ºbernommen</u> .  Ein Beispiel: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>intf = find_descriptor(...) &gt;&gt;&gt; dev.set_interface_altsetting(intf) &gt;&gt;&gt; intf.set_altsetting() <span class="hljs-comment"><span class="hljs-comment"># !       </span></span></code> </pre><br>  <b>Warnung</b> <br><br>  Das <u>Interface-</u> Objekt muss zum aktiven Konfigurationsdeskriptor geh√∂ren. <br><br><h3>  Sprich mit mir, Schatz </h3><br>  Und jetzt ist es Zeit f√ºr uns zu verstehen, wie man mit USB-Ger√§ten interagiert.  USB verf√ºgt √ºber vier Arten von Datenstr√∂men: Massen√ºbertragung, Interrupt-√úbertragung, isochrone √úbertragung und Steuerungs√ºbertragung.  Ich habe nicht vor, den Zweck jedes Threads und die Unterschiede zwischen ihnen zu erkl√§ren.  Daher gehe ich davon aus, dass Sie mindestens Grundkenntnisse in USB-Datenstr√∂men haben. <br><br>  Der Steuerdatenstrom ist der einzige Strom, dessen Struktur in der Spezifikation beschrieben ist, der Rest sendet und empf√§ngt einfach Rohdaten aus USB-Sicht.  Daher haben Sie verschiedene Funktionen zum Arbeiten mit Kontrollfl√ºssen, und der Rest der Fl√ºsse wird von denselben Funktionen verarbeitet. <br><br>  Sie k√∂nnen mit der Methode <u>ctrl_transfer</u> auf den Steuerdatenstrom <u>zugreifen</u> .  Es wird sowohl f√ºr ausgehende (OUT) als auch f√ºr eingehende (IN) Streams verwendet.  Die Durchflussrichtung wird durch den Parameter <u>bmRequestType</u> bestimmt. <br><br>  Die Parameter <u>ctrl_transfer</u> stimmen fast mit der Struktur der Steuerungsanforderung √ºberein.  Das folgende Beispiel zeigt, wie ein Steuerdatenstrom organisiert wird. <a name="orig8"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[8]</a> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>msg = <span class="hljs-string"><span class="hljs-string">'test'</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> dev.ctrl_transfer(<span class="hljs-number"><span class="hljs-number">0x40</span></span>, CTRL_LOOPBACK_WRITE, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, msg) == len(msg) &gt;&gt;&gt; ret = dev.ctrl_transfer(<span class="hljs-number"><span class="hljs-number">0xC0</span></span>, CTRL_LOOPBACK_READ, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, len(msg)) &gt;&gt;&gt; sret = <span class="hljs-string"><span class="hljs-string">''</span></span>.join([chr(x) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ret]) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sret == msg</code> </pre><br>  In diesem Beispiel wird davon ausgegangen, dass unser Ger√§t zwei Benutzersteuerungsanforderungen enth√§lt, die sich wie eine Loopback-Pipe verhalten.  Was Sie mit der Nachricht <u>CTRL_LOOPBACK_WRITE</u> schreiben, k√∂nnen Sie mit der Nachricht <u>CTRL_LOOPBACK_READ</u> lesen. <br><br>  Die ersten vier Parameter - <u>bmRequestType</u> , <u>bmRequest</u> , <u>wValue</u> und <u>wIndex</u> - sind die Felder der Standardstruktur des Steuerungsstroms.  Der f√ºnfte Parameter ist entweder die Daten√ºbertragung f√ºr den ausgehenden Datenstrom oder die Anzahl der Daten, die im eingehenden Datenstrom gelesen werden.  Die √ºbertragenen Daten k√∂nnen jede Art von Sequenz sein, die als Parameter in die Eingabe der <u>__init__</u> -Methode f√ºr das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Array</a> <u>eingespeist</u> werden kann.  Wenn keine Daten √ºbertragen werden, muss der Parameter auf <u>Keine gesetzt werden</u> (oder 0 bei einem eingehenden Datenstrom).  Es gibt einen weiteren optionalen Parameter, der das Betriebszeitlimit angibt.  Wenn Sie es nicht bestehen, wird das Standardzeitlimit verwendet (dazu sp√§ter mehr).  Im ausgehenden Datenstrom ist der R√ºckgabewert die Anzahl der tats√§chlich an das Ger√§t gesendeten Bytes.  Im eingehenden Stream ist der R√ºckgabewert ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Array</a> mit den gelesenen Daten. <br><br>  F√ºr andere Streams k√∂nnen Sie die <u>Schreib-</u> bzw. <u>Lesemethoden</u> zum Schreiben und Lesen von Daten verwenden.  Sie m√ºssen sich keine Gedanken √ºber die Art des Streams machen - er wird automatisch von der Adresse des Pr√ºfpunkts erkannt.  Hier ist unser Loopback-Beispiel, vorausgesetzt, wir haben eine Loopback-Pipe am Haltepunkt 1: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>msg = <span class="hljs-string"><span class="hljs-string">'test'</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> len(dev.write(<span class="hljs-number"><span class="hljs-number">1</span></span>, msg, <span class="hljs-number"><span class="hljs-number">100</span></span>)) == len(msg) &gt;&gt;&gt; ret = dev.read(<span class="hljs-number"><span class="hljs-number">0x81</span></span>, len(msg), <span class="hljs-number"><span class="hljs-number">100</span></span>) &gt;&gt;&gt; sret = <span class="hljs-string"><span class="hljs-string">''</span></span>.join([chr(x) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ret]) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sret == msg</code> </pre><br>  Der erste und der dritte Parameter sind f√ºr beide Methoden gleich - dies ist die Pr√ºfpunktadresse bzw. das Zeitlimit.  Der zweite Parameter sind die √ºbertragenen Daten (Schreiben) oder die Anzahl der zu lesenden Bytes (Lesen).  Die zur√ºckgegebenen Daten sind entweder eine Instanz eines <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Array-</a> Objekts f√ºr die <u>Lesemethode</u> oder die Anzahl der f√ºr die <u>Schreibmethode</u> geschriebenen Bytes. <br><br>  Bei Beta 2-Versionen k√∂nnen Sie anstelle der Anzahl der Bytes ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Array-</a> Objekt, zu dem Daten gelesen werden sollen, zum <u>Lesen</u> oder <u>Strg_transfer √ºbergeben</u> .  In diesem Fall entspricht die Anzahl der zu lesenden Bytes der L√§nge des Arrays mal dem Wert von <u>array.itemsize</u> . <br><br>  In <u>ctrl_transfer</u> ist der <u>Timeout-</u> Parameter optional.  Wenn das <u>Zeitlimit</u> weggelassen wird, wird die <u>Device.default_timeout-</u> Eigenschaft als Betriebszeitlimit verwendet. <br><br><h3>  Kontrolliere dich </h3><br>  Zus√§tzlich zu den Datenstromfunktionen bietet das <u>usb.control-</u> Modul Funktionen, die Standard-USB-Steuerungsanforderungen enthalten, und das <u>usb.util-</u> Modul verf√ºgt √ºber eine praktische <u>get_string-</u> Funktion <u>, die</u> speziell <u>Zeilendeskriptoren</u> anzeigt. <br><br><h2>  Zus√§tzliche Themen </h2><br><h3>  Hinter jeder gro√üen Abstraktion steht eine gro√üe Erkenntnis </h3><br>  Bisher gab es nur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">libusb</a> .  Dann kam libusb 1.0 und wir hatten libusb 0.1 und 1.0.  Danach haben wir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OpenUSB</a> erstellt und leben jetzt im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tower of Babel der</a> USB Library <a name="orig9"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[9]</a> .  Wie geht PyUSB damit um?  Nun, PyUSB ist eine demokratische Bibliothek. Sie k√∂nnen w√§hlen, welche Bibliothek Sie m√∂chten.  Tats√§chlich k√∂nnen Sie Ihre eigene USB-Bibliothek von Grund auf neu schreiben und PyUSB anweisen, sie zu verwenden. <br><br>  Die <u>Suchfunktion</u> hat einen anderen Parameter, von dem ich Ihnen nichts erz√§hlt habe.  Dies ist der <u>Backend-</u> Parameter.  Wenn Sie es nicht √ºbertragen, wird eines der integrierten Backends verwendet.  Ein Backend ist ein von <u>usb.backend.IBackend</u> geerbtes <u>Objekt</u> , das f√ºr die Einf√ºhrung betriebssystemspezifischer USB-Junk- <u>Dateien</u> verantwortlich ist.  Wie Sie vielleicht vermutet haben, sind die integrierten Funktionen libusb 0.1, libusb 1.0 und OpenUSB Backends. <br><br>  Sie k√∂nnen Ihr eigenes Backend schreiben und verwenden.  Erben <u>Sie</u> einfach von <u>IBackend</u> und aktivieren Sie die erforderlichen Methoden.  M√∂glicherweise m√ºssen Sie die Dokumentation zum <u>usb.backend lesen,</u> um zu verstehen, wie dies gemacht wird. <br><br><h3>  Sei nicht egoistisch </h3><br>  Python hat das, was wir <i>automatische Speicherverwaltung</i> nennen.  Dies bedeutet, dass die virtuelle Maschine entscheidet, wann Objekte aus dem Speicher entladen werden sollen.  Unter der Haube verwaltet PyUSB alle Ressourcen auf niedriger Ebene, mit denen Sie arbeiten m√ºssen (Genehmigen der Benutzeroberfl√§che, Anpassen des Ger√§ts usw.), und die meisten Benutzer m√ºssen sich dar√ºber keine Gedanken machen.  Aufgrund der Undefiniertheit der automatischen Zerst√∂rung von Objekten durch Python k√∂nnen Benutzer jedoch nicht vorhersagen, wann die zugewiesenen Ressourcen freigegeben werden.  Einige Anwendungen m√ºssen Ressourcen deterministisch zuweisen und freigeben.  F√ºr solche Anwendungen bietet das Modul <u>usb.util</u> Funktionen f√ºr die Interaktion mit dem Ressourcenmanagement. <br><br>  Wenn Sie Schnittstellen manuell anfordern und freigeben m√∂chten, k√∂nnen Sie die <u>Funktionen</u> <u>Claim_interface</u> und <u>Release_interface verwenden</u> .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Funktion </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Claim_Interface</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fordert die angegebene Schnittstelle an, wenn das Ger√§t dies noch nicht getan hat. Wenn das Ger√§t bereits eine Schnittstelle angefordert hat, f√ºhrt es nichts aus. Au√üerdem gibt </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">release_interface</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf </font><u><font style="vertical-align: inherit;">Anfrage</font></u><font style="vertical-align: inherit;"> die angegebene Schnittstelle frei. Wenn die Schnittstelle nicht angefordert wird, tut sie nichts. Sie k√∂nnen die manuelle Schnittstellenabfrage verwenden, um das in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libusb-</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dokumentation beschriebene </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bei der </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Konfigurationsauswahl</font></a><font style="vertical-align: inherit;"> zu l√∂sen </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie alle vom Ger√§teobjekt zugewiesenen Ressourcen (einschlie√ülich der angeforderten Schnittstellen) </font><u><font style="vertical-align: inherit;">freigeben m√∂chten</font></u><font style="vertical-align: inherit;"> , k√∂nnen Sie die Funktion </font><u><font style="vertical-align: inherit;">dispose_resources</font></u><font style="vertical-align: inherit;"> verwenden</font></font><u><font style="vertical-align: inherit;"></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Es gibt alle zugewiesenen Ressourcen frei und √ºbertr√§gt das Ger√§teobjekt (jedoch nicht an die Hardware des Ger√§ts selbst) in den Zustand, in dem es nach Verwendung der </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suchfunktion zur√ºckgegeben wurde</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Manuelle Bibliotheksdefinition </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im Allgemeinen ist ein Backend ein Wrapper √ºber eine gemeinsam genutzte Bibliothek, der eine API f√ºr den Zugriff auf USB implementiert. Standardm√§√üig verwendet das Backend die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ctypes-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktion </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find_library ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Unter Linux und anderen Unix-√§hnlichen Betriebssystemen </font><font style="vertical-align: inherit;">versucht </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find_library</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , externe Programme (wie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ sbin / ldconfig</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objdump</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><i><font style="vertical-align: inherit;">auszuf√ºhren</font></i><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">um die Bibliotheksdatei zu finden. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auf Systemen, auf denen diese Programme fehlen und / oder der Bibliothekscache deaktiviert ist, kann diese Funktion nicht verwendet werden. Um die Einschr√§nkungen zu √ºberwinden, k√∂nnen Sie mit PyUSB die benutzerdefinierte Funktion find_library () an das Backend senden. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Beispiel f√ºr ein solches Szenario w√§re:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.backend.libusb1 &gt;&gt;&gt; &gt;&gt;&gt; backend = usb.backend.libusb1.get_backend(find_library=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: <span class="hljs-string"><span class="hljs-string">"/usr/lib/libusb-1.0.so"</span></span>) &gt;&gt;&gt; dev = usb.core.find(..., backend=backend)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beachten Sie, dass find_library ein Argument f√ºr die Funktion get_backend () ist, in der Sie die Funktion angeben, die f√ºr das Finden der richtigen Bibliothek f√ºr das Backend verantwortlich ist. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Regeln der alten Schule </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie eine Anwendung mit den alten PyUSB-APIs (0. Something-There) schreiben, fragen Sie sich m√∂glicherweise, ob Sie Ihren Code aktualisieren m√ºssen, um die neue API zu verwenden. </font><font style="vertical-align: inherit;">Nun, Sie sollten es tun, aber es ist nicht notwendig. </font><font style="vertical-align: inherit;">PyUSB 1.0 wird mit dem Kompatibilit√§tsmodul </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usb.legacy geliefert</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es enth√§lt die alte API basierend auf der neuen API. </font><font style="vertical-align: inherit;">"Nun, sollte ich einfach meine </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Import-USB-</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Leitung </font><font style="vertical-align: inherit;">durch </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Import usb.legacy als USB</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ersetzen </font><font style="vertical-align: inherit;">, damit meine Anwendung funktioniert?", Fragen Sie. </font><font style="vertical-align: inherit;">Die Antwort ist ja, es wird funktionieren, aber es ist nicht notwendig. </font><font style="vertical-align: inherit;">Wenn Sie Ihre Anwendung unver√§ndert ausf√ºhren, funktioniert dies, da die </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USB-Importzeile</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> alle √∂ffentlichen Symbole aus </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usb.legacy importiert</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wenn Sie auf ein Problem sto√üen, haben Sie h√∂chstwahrscheinlich einen Fehler gefunden.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Helfen Sie mir bitte </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie Hilfe ben√∂tigen, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">schreiben Sie mir keine E-Mail</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , daf√ºr gibt es eine Mailingliste. </font><font style="vertical-align: inherit;">Anweisungen zum Abonnement finden Sie auf der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUSB-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Website </font><font style="vertical-align: inherit;">.</font></font><br><br><a name="prim"></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wenn ich Wahr oder Falsch (mit einem Gro√übuchstaben) schreibe, meine ich die entsprechenden Werte der Python-Sprache. Und wenn ich wahr (wahr) oder falsch (falsch) sage, meine ich jeden Python-Ausdruck, der als wahr oder falsch angesehen wird. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Diese √Ñhnlichkeit trat im Original auf und hilft, die Konzepte von wahr und falsch in der √úbersetzung zu verstehen. - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinweis.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[2]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Siehe die spezifische Dokumentation f√ºr das Backend. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[3]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Die USB-Spezifikation legt dem Konfigurationswert keinen bestimmten Wert fest. Gleiches gilt f√ºr Schnittstellennummern und alternative Einstellungen. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[4]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eigentlich ist alles etwas komplizierter, aber dies ist nur eine Erkl√§rung f√ºr uns. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[5]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ich wei√ü, das klingt komisch.</font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[6]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dies liegt daran, dass wenn w√§hrend der Ger√§tekonfiguration keine Bandbreite f√ºr isochrone Datenstr√∂me vorhanden ist, diese erfolgreich nummeriert werden kann. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[7]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dies geschieht nicht f√ºr die Konfiguration, da sich das Ger√§t in einem nicht konfigurierten Zustand befinden darf. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[8]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In PyUSB greifen Steuerdatenstr√∂me auf den Kontrollpunkt 0 zu. Sehr, sehr, sehr selten verf√ºgt ein Ger√§t √ºber einen alternativen Kontrollkontrollpunkt (ich habe ein solches Ger√§t noch nie getroffen). </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[9]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dies ist nur ein Witz, nimm es nicht ernst. </font><font style="vertical-align: inherit;">Gute Entscheidungen sind besser als keine Entscheidungen.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de430528/">https://habr.com/ru/post/de430528/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de430518/index.html">So rendern Sie den Rahmen von Mittelerde: Schatten von Mordor</a></li>
<li><a href="../de430520/index.html">Einf√ºhrung in Spring Data MongoDB</a></li>
<li><a href="../de430522/index.html">Ben√∂tigen Sie eine Unternehmenskultur in der IT? Gest√§ndnis des Markenmanagers des Krasnodar-Studios Plarium</a></li>
<li><a href="../de430524/index.html">Neuronale Netzwerkarchitektur</a></li>
<li><a href="../de430526/index.html">Spielautomaten: Woher kamen sie in der UdSSR und wie sind sie angeordnet?</a></li>
<li><a href="../de430530/index.html">Mock-Server f√ºr die mobile Testautomatisierung</a></li>
<li><a href="../de430532/index.html">Sicherheit in iOS-Apps</a></li>
<li><a href="../de430534/index.html">Erstellen einer Vorlage f√ºr Zabbix am Beispiel des DVR Trassir SDK</a></li>
<li><a href="../de430536/index.html">Entwerfen von Fensterfunktionen, die zu einer Einheit mit einem bestimmten √úberlappungsgrad zusammengefasst werden</a></li>
<li><a href="../de430538/index.html">Lesen Sie Scaladoc f√ºr ‚Äûoffensichtliche‚Äú Erfassungsmethoden? Oder warum Faulheit nicht immer gut ist</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>