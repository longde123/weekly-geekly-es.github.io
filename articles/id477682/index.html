<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍇 👨🏾‍🚀 🥅 Layanan lawas dalam infrastruktur Anda 😽 🆑 🏸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hai Nama saya Pasha Chernyak, saya adalah pengembang terkemuka di QIWI, dan hari ini saya ingin berbicara tentang hal yang tak terhindarkan. Tentang L...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Layanan lawas dalam infrastruktur Anda</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/qiwi/blog/477682/"> Hai  Nama saya Pasha Chernyak, saya adalah pengembang terkemuka di QIWI, dan hari ini saya ingin berbicara tentang hal yang tak terhindarkan.  Tentang Legacy <br><br>  Mari kita mulai dengan pertanyaan: apa itu layanan Legacy?  Apakah layanan Legacy adalah layanan yang belum disentuh pengembang selama seminggu / bulan / tahun?  Atau itu layanan yang ditulis oleh programmer yang kurang berpengalaman, misalnya, khusus oleh Anda, tetapi setahun yang lalu?  Dan sekarang Anda lebih keren dan lebih berpengalaman.  Atau, setelah semua, apakah layanan Legacy adalah layanan yang Anda putuskan untuk tidak pernah berkomitmen lagi dan secara perlahan mempersiapkan penggantinya?  Bagaimanapun, meninggalkan layanan ini tanpa pengawasan dan tidak memperbarui adalah bom waktu yang dapat meledak kemudian. <br><br> <a href="https://habr.com/ru/company/qiwi/blog/477682/"><img src="https://habrastorage.org/webt/p9/ln/rt/p9lnrt-etdgnk1bd6mkfrcsxoxk.jpeg"></a> <br><br>  Sebelum beralih ke cara kami bekerja dengan layanan Legacy kami di QIWI, saya akan memberi tahu Anda cara kami menertibkan layanan di Wallet.  Selama dua tahun sekarang saya bertanggung jawab atas kinerjanya.  Jika ada masalah, mereka selalu memanggil saya terlebih dahulu.  Saya biasanya tidak memiliki keberanian untuk menelepon orang lain pada pukul 11 ​​malam, jadi saya harus duduk dan memahami semua layanan dari domain kami. <br><br>  Tapi saya, seperti orang lain, suka tidur di malam hari, jadi saya mencoba menangani operasi: "Guys, mengapa Anda memanggil saya?"  Untuk itu ia menerima jawaban yang agak ringkas dari formulir "Siapa lagi?"  Karena saya sedang memperbaiki layanan, dan orang-orang tidak tahu siapa yang harus dihubungi. <br><br>  Oleh karena itu, dalam salah satu retrospektif dari tim backend Wallet, kami memutuskan bahwa kami perlu menyusun sebuah piring yang di dalamnya tertulis daftar layanan, layanan mikro dan monolit dompet kami, dan mereka yang bertanggung jawab untuk itu.  Tablet umumnya bermanfaat, sampai batas tertentu. <br><a name="habracut"></a><br>  Selain informasi tentang siapa yang bertanggung jawab atas apa, ada jawaban atas pertanyaan: siapa pemilik layanan, siapa yang bertanggung jawab atas pengembangannya, untuk arsitektur, dan siklus hidup.  Orang yang bertanggung jawab untuk layanan ini adalah orang yang dapat memperbaikinya jika terjadi sesuatu.  Pemilik layanan memiliki hak untuk meninggalkan +2 dalam komit, mereka yang bertanggung jawab juga harus hadir di ulasan sebelum layanan ini mengambil alih komit baru. <br><br>  Seiring berjalannya waktu, praktik-praktik baru mulai diterapkan, misalnya, migrasi ke Kubernetes, semua jenis checkstyle, spotbugs, ktlint, keberadaan log di kiban, layanan autodiscovery alih-alih menentukan alamat secara langsung dan hal-hal berguna lainnya.  Dan di mana pun meja kami memungkinkan kami untuk mempertahankan relevansi layanan kami.  Bagi kami, ini adalah daftar periksa yang mengatakan bahwa layanan ini tahu bagaimana melakukan ini, tetapi ini belum.Tapi kami melangkah lebih jauh, menyadari bahwa kami kekurangan informasi tentang layanan kami, di mana kami melacak di mana kode sumber layanan terletak , di mana tugas-tugas perakitan diluncurkan di TeamCity, bagaimana mereka digunakan, di mana kode sumber tes end2end disimpan, foto dari perawatan tentang arsitektur, tentang keputusan yang dibuat.  Idealnya, saya ingin semua informasi ini berada di suatu tempat dan siap ketika dibutuhkan.  Karena itu, piring kami telah menjadi titik keberangkatan untuk mencari informasi. <br><br>  Tapi QIWI, sambil mempertahankan semangat startup, adalah perusahaan besar.  Kami sudah berusia 12 tahun, dan tim berubah: orang-orang pergi, orang-orang datang, tim baru sedang dibentuk.  Dan kami menemukan beberapa layanan di domain kami yang kami warisi.  Sesuatu datang bersama pengembang dari tim lain, sesuatu yang entah bagaimana terkait secara tidak langsung dengan Dompet, sehingga layanannya sekarang ada di neraca kami.  Menangani apa dan bagaimana cara kerjanya - mengapa?  Layanan berfungsi, dan kami memiliki fitur produk yang harus dicuci. <br><br><h2>  Seperti yang terjadi </h2><br>  Tetapi pada suatu titik waktu, kami menemukan bahwa layanan berhenti untuk memenuhi fungsinya, sesuatu telah rusak - apa yang harus dilakukan dalam situasi ini?  Layanan baru saja berhenti bekerja.  Tentu saja  Dan kami belajar tentang ini, pertama, secara kebetulan, dan kedua, enam bulan kemudian.  Itu terjadi.  Satu-satunya hal yang kami ketahui adalah di mana mesin virtual yang digunakan layanan ini, tempat sumbernya berada, dan hanya itu.  Kami membuat git klon dan terjun ke pikiran orang yang menulis ini beberapa tahun yang lalu, tetapi apa yang kita lihat?  Tidak ada Spring Boot yang akrab bagi kita, meskipun kita terbiasa dengan segalanya, kita memiliki setumpuk penuh dan semua itu.  Mungkin ada Kerangka Pegas?  Tapi tidak. <br><br>  Orang yang menulis semua ini keras dan menulis semuanya di Jawa murni.  Tidak ada alat yang dikenal untuk pengembang, dan muncul ide - perlu untuk menulis ulang semuanya.  Kami juga memiliki layanan microser, dan dari masing-masing pemanggang kami mendengar "Teman, layanan microser yang Anda butuhkan!".  Jika tiba-tiba ada sesuatu yang salah, Anda akan dengan tenang mengambil bahasa apa pun dan semuanya akan baik-baik saja. <br><br>  Masalahnya adalah bahwa sekarang kita tidak memiliki pelanggan yang bertanggung jawab atas layanan ini.  Apa persyaratan bisnisnya, apa yang harus dilakukan layanan ini secara umum?  Dan layanan terintegrasi erat ke dalam proses bisnis Anda. <br><br>  Sekarang katakan, betapa mudahnya untuk menulis ulang layanan tanpa mengetahui persyaratan bisnisnya?  Layanan tidak jelas bagaimana cara login, apakah ada metrik tidak diketahui.  Apa itu, jika ada, semakin tidak diketahui.  Dan sementara dalam layanan sejumlah besar kelas logika bisnis tidak jelas.  Sesuatu termasuk dalam beberapa jenis basis data, yang tentangnya kami juga belum tahu apa-apa. <br><br><h2>  Di mana untuk memulai? </h2><br>  Dari yang paling logis - dengan ketersediaan tes.  Setidaknya beberapa jenis logika biasanya ditulis di sana dan kesimpulan dapat ditarik tentang apa yang terjadi.  Sekarang TDD modis, tetapi kita melihat bahwa 5 tahun yang lalu semuanya hampir sama seperti sekarang: hampir tidak ada tes unit, dan mereka tidak akan memberi tahu kita apa-apa.  Yah, kecuali mungkin semacam cek bagaimana beberapa xml ditandatangani dengan semacam sertifikat khusus. <br><br>  Kami tidak dapat memahami apa pun dengan kode tersebut, dan kami mengirim tampilan untuk melihat apa mesin virtual itu ada.  Kami membuka log layanan, menemukan kesalahan http-client di dalamnya, sertifikat yang ditandatangani sendiri yang dijahit ke sumber daya aplikasi, tanpa ampun busuk.  Kami menghubungi analis kami, mereka meminta sertifikat baru, mereka menerbitkannya kepada kami dan layanan berfungsi lagi.  Tampaknya hanya itu saja.  Atau tidak?  Namun, layanan tetap berfungsi, menjalankan beberapa fungsi yang dibutuhkan bisnis kami.  Kami memiliki beberapa standar pengembangan aplikasi yang kemungkinan besar Anda miliki.  Sebagai contoh, jangan menyimpan log pada node di folder, tetapi simpan di beberapa jenis penyimpanan, seperti elastis, lihat mereka di kiban.  Anda dapat mengingat metrik emas.  Artinya, beban pada layanan, jumlah permintaan untuk layanan, apakah dia masih hidup atau tidak, bagaimana HealthCheck-nya berjalan.  Paling tidak, metrik ini akan membantu Anda mencari tahu kapan itu dapat dinonaktifkan dan dilupakan seperti mimpi buruk dengan hati nurani yang jelas. <br><br><h2>  Apa yang harus dilakukan </h2><br>  Oleh karena itu, kami menambahkan layanan lama ke tablet, dan kemudian kami mencari sukarelawan dari antara pengembang yang akan mengurus layanan dan menertibkan: mereka akan menulis setidaknya beberapa informasi tentang layanan, menambahkan tautan ke dasbor di graphan, untuk tugas perakitan, dan memahami bagaimana Sebarkan aplikasi, jangan unggah file menggunakan ftp dengan tangan Anda. <br><br>  Yang utama adalah berapa banyak semua sukarelawan yang berguna ini akan mengambil?  Satu sprint untuk pengembang yang kurang lebih berpengalaman, misalnya, selama utang teknis 20%.  Dan berapa banyak waktu yang diperlukan untuk memahami semua logika yang mengakar dalam berkomunikasi dengan sistem negara tertentu dan membawanya ke teknologi yang lebih baru?  Saya tidak bisa menjamin ini, mungkin sebulan, atau mungkin dua tim bekerja.  Ini saya katakan dari pengalaman integrasi saat ini dengan beberapa layanan baru. <br><br>  Pada saat yang sama, tidak ada nilai bisnis yang habis.  Tentu saja  Untuk mengambil layanan dukungan dan menghabiskan sedikit waktu untuk itu adalah normal.  Tetapi setelah tarian standar kami dengan layanan, kami menambahkannya ke meja, menambahkan informasi tentang itu dan, mungkin, suatu hari kami akan menulis ulang.  Tapi sekarang memenuhi standar layanan kami. <br><br>  Sebagai hasilnya, saya ingin membawa rencana apa yang harus dilakukan dengan layanan Legacy. <br><br>  <b>Menulis ulang warisan dari awal adalah ide yang buruk</b> <br>  Serius, Anda bahkan tidak perlu memikirkannya.  Jelas bahwa kita ingin, dan beberapa keuntungan terlihat, tetapi biasanya ini tidak perlu bagi siapa pun, termasuk Anda sendiri. <br><br>  <b>Buku referensi</b> <br>  Gali kode sumber aplikasi Anda, buat direktori yang akan menunjukkan apa dan di mana letaknya dan cara kerjanya, masukkan deskripsi proyek di sana (readme.md bersyarat) untuk dengan cepat memahami di mana log dan metrik berada.  Pengembang yang akan menangani ini setelah Anda hanya akan mengucapkan terima kasih. <br><br>  <b>Pahami domainnya</b> <br>  Jika Anda memiliki domain, cobalah untuk menjaga jari Anda pada denyut nadi.  Kedengarannya klise, ya, tetapi tidak semua orang memastikan bahwa layanan berada dalam satu kunci.  Tetapi bekerja dalam satu standar sebenarnya jauh lebih mudah. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id477682/">https://habr.com/ru/post/id477682/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id477670/index.html">Apa yang memberi otomatisasi pengujian</a></li>
<li><a href="../id477672/index.html">Hak dan kewajiban anggota tim: aspek hukum dan budaya</a></li>
<li><a href="../id477674/index.html">Apakah AI berarti cinta?</a></li>
<li><a href="../id477678/index.html">Prospek untuk televisi digital di Rusia</a></li>
<li><a href="../id477680/index.html">Tangan kami bukan untuk kebosanan: memulihkan cluster Rook di K8s</a></li>
<li><a href="../id477684/index.html">Angular: Sahabat Bangunan Terbaik untuk aplikasi Interaktif</a></li>
<li><a href="../id477686/index.html">Kami di Konferensi Perjalanan AI</a></li>
<li><a href="../id477688/index.html">Desember Acara TI Digest</a></li>
<li><a href="../id477692/index.html">Pengalaman menggunakan ZGC dan Shenandoah GC dalam produksi</a></li>
<li><a href="../id477694/index.html">JavaScript tidak perlu diganti dengan apa pun - bahasa lain juga akan menghadapi masalah yang sama</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>