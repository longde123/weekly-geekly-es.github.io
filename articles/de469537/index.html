<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜô üëãüèæ üñï Swift mit Snake kennenlernen üîé üåó üí†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits! Im Vorgriff auf den Start des Kurses ‚ÄûiOS-Entwickler. Grundkurs ‚Äúhaben wir eine weitere offene Lektion organisiert . Dieses Webinar ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Swift mit Snake kennenlernen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/469537/"><img src="https://habrastorage.org/webt/go/ti/3z/goti3zbe-douszd51y8huhfg3ki.jpeg"><br><br>  Hallo allerseits!  Im Vorgriff auf den Start des Kurses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚ÄûiOS-Entwickler.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Grundkurs ‚Äúhaben</a> wir eine weitere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offene Lektion organisiert</a> .  Dieses Webinar richtet sich an Personen, die Erfahrung in der Entwicklung in beliebigen Sprachen und Plattformen haben, aber die Swift-Sprache lernen und die Entwicklung f√ºr iOS beherrschen m√∂chten.  In der Lektion haben wir die <b>Syntax und die Schl√ºsselkonstrukte der Swift-Sprache</b> eingehend untersucht und uns mit den wichtigsten Entwicklungswerkzeugen vertraut gemacht. <br><br><hr><a name="habracut"></a><br>  Die Teilnehmer des Webinars lernten: <br><br><ul><li>  Was ist die Swift-Sprache, was sind ihre Merkmale? </li><li>  Wie die Xcode-Entwicklungsumgebung Ihnen den Einstieg erleichtert </li><li>  wie man ein einfaches Spiel f√ºr iOS erstellt. </li></ul><br>  Das Webinar wurde von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Alexei Sobolevsky</a> , einem iOS-Entwickler bei Yandex, durchgef√ºhrt. <br><br><h3>  Mach es selbst Schlange </h3><br>  F√ºr die Arbeit haben wir die integrierte Entwicklungsumgebung <b>Xcode verwendet</b> .  Dies ist eine praktische, kostenlose und funktionale Umgebung, die von Apple erstellt wurde. <br><br>  Gleich zu Beginn haben wir ein neues Projekt erstellt und den Grundsatz der ‚ÄûSpiel‚Äú -Dateien ausgew√§hlt: <br><br><img src="https://habrastorage.org/webt/vs/lu/hg/vsluhgmqy_6rxlvmyqttv0filci.jpeg"><br><br>  Ohne weiteres nannten sie das Projekt ‚ÄûSnake‚Äú.  Alle Einstellungen wurden standardm√§√üig beibehalten, um sicherzustellen, dass sich SpriteKit in der Zeile Game Technology befindet. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Details zur Erstellung des Projekts.</a> <br><br>  Nachdem Sie die oben genannten Aktionen ausgef√ºhrt haben, wird im linken Teil des Fensters eine Liste der Dateien angezeigt, die automatisch f√ºr unser Projekt erstellt wurden.  Eine der wichtigsten Dateien ist <b>AppDelegate.swift</b> , mit deren Hilfe das System mit unserem Code kommunizieren kann, wenn wichtige Ereignisse f√ºr die Anwendung <b>vorliegen</b> (Starten, Dr√ºcken, Klicken auf den Link usw.).  Code dieser Datei: <br><br><pre><code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// // AppDelegate.swift // SnakeGame // // Created by Alexey Sobolevsky on 15/09/2019. // Copyright 2019 Alexey Sobolevsky. All rights reserved. // import UIKit @UIApplicationMain class AppDelegate: UIResponder, UIApplicationDelegate { var window: UIWindow? func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -&gt; Bool { // Override point for customization after application launch. return true } }</span></span></code> </pre> <br>  Ebenso wichtige Dateien sind <b>GameScene.swift</b> und <b>GameViewController.swift</b> .  Die GameScene-Klasse erstellt die Szene, und der GameViewController ist f√ºr einen Bildschirm der angezeigten Anwendung verantwortlich (ein Bildschirm - ein GameViewController).  Nat√ºrlich wird diese Regel nicht immer unterst√ºtzt, aber im Allgemeinen funktioniert sie.  Da unsere Anwendung recht einfach ist, haben wir nur einen GameViewController.  Beginnen wir mit ihm. <br><br><h3>  Schreiben eines GameViewControllers </h3><br>  Wir werden den Standardcode l√∂schen.  Der View Controller verf√ºgt √ºber verschiedene Methoden, die je nach Status des Bildschirms funktionieren.  Zum Beispiel wird <code>viewDidLoad()</code> ausgel√∂st, wenn alle Bildschirmelemente bereits geladen wurden und der Bildschirm <code>viewDidLoad()</code> auf dem Smartphone angezeigt wird.  Da wir ein Spiel haben, m√ºssen wir die Spielszene in unserem View Controller platzieren (hier l√§uft die Schlange und alle anderen Ereignisse des Spiels treten auf). <br><br>  Erstellen Sie eine Szene: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> scene = <span class="hljs-type"><span class="hljs-type">GameScene</span></span>(size: view.bounds.size)</code> </pre> <br>  <b>let</b> ist eine Konstante und ein Schl√ºsselwort.  Swift verwendet auch das Schl√ºsselwort var, das zum Definieren einer Variablen erforderlich ist.  Mit <b>var</b> k√∂nnen wir den Wert von Variablen viele Male √§ndern, w√§hrend das Programm ausgef√ºhrt wird.  Mit let k√∂nnen wir den Wert von Variablen nach der Initialisierung nicht √§ndern. <br><br>  Jetzt m√ºssen wir sicherstellen, dass die Ansicht, in der wir die erstellte Szene platzieren, dem gew√ºnschten Typ entspricht.  Verwenden Sie dazu das <b>Guard-</b> Konstrukt - dies ist dasselbe, als <code>if</code> , nur umgekehrt (falls nicht): <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> skView = view <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">SKView</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> }</code> </pre> <br>  Nachdem wir sichergestellt haben, dass das Bildschirmelement dem gew√ºnschten Typ entspricht, f√ºgen wir unsere Szene hinzu: <br><br><pre> <code class="swift hljs">skView.presentScene(scene)</code> </pre> <br>  Sie m√ºssen auch die Anzahl der Bilder pro Sekunde (FPS) anzeigen: <br><br><pre> <code class="swift hljs">skView.showsFPS = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br>  Zeigen Sie dann die Anzahl der Elemente aller Art in der Szene an: <br><br><pre> <code class="swift hljs"> skView.showsNodeCount = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br>  Lassen Sie die Elemente unabh√§ngig von ihrer Reihenfolge in der Hierarchie der Elemente auf dem Bildschirm angezeigt werden: <br><br><pre> <code class="swift hljs">skView.ignoresSiblingOrder = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br>  Und vergessen Sie nicht, dass unsere Szene auf die gesamte Bildschirmbreite ausgedehnt werden sollte: <br><br><pre> <code class="swift hljs">scene.scaleMode = .resizeFill</code> </pre> <br>  Hier ist der endg√ºltige Code f√ºr die Datei <b>GameViewController.swift</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SpriteKit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GameplayKit class GameViewController: UIViewController { override func viewWillLayoutSubviews() { super.viewWillLayoutSubviews() setup() } private func setup() { guard let skView = view as? SKView else { return } let scene = GameScene(size: view.bounds.size) skView.showsFPS = true skView.showsNodeCount = true skView.ignoresSiblingOrder = true scene.scaleMode = .resizeFill skView.presentScene(scene) } }</code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Details zum Erstellen der Datei GameViewController.swift.</a> <br><br>  Wir haben die Szene erstellt, aber sie ist leer. Wenn wir den Emulator jetzt ausf√ºhren, wird nur ein schwarzer Bildschirm angezeigt. <br><br><h3>  Eine GameScene schreiben </h3><br>  Wie beim letzten Mal l√∂schen wir den gr√∂√üten Teil des Codes und nehmen dann <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die erforderlichen Einstellungen f√ºr die Szene vor</a> .  Es hat auch seine eigenen Methoden.  Da wir beispielsweise unsere Szene zum ViewController hinzugef√ºgt haben, ben√∂tigen wir die <code>didMove()</code> -Methode: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">didMove</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to view: SKView)</span></span></span></span> { setup(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: view) }</code> </pre> <br>  Wenn das Spiel beginnt, wird die <code>Update()</code> -Methode f√ºr jeden Frame aufgerufen: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> currentTime: TimeInterval)</span></span></span></span> { snake?.move() }</code> </pre> <br>  Und wir brauchen auch einige Handler, um auf den Bildschirm zu tippen: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">touchesEnded</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> touches: Set&lt;UITouch&gt;, with event: UIEvent?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> touchedNode = findTouchedNode(with: touches) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> }</code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">touchesCancelled</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> touches: Set&lt;UITouch&gt;, with event: UIEvent?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> touchedNode = findTouchedNode(with: touches) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> }</code> </pre> <br>  Wie Sie wissen, ist Swift ber√ºhmt f√ºr das Vorhandensein von <b>syntaktischem Zucker</b> .  Syntaktischer Zucker - dies sind technische Aspekte, die das Leben des Entwicklers vereinfachen und das Schreiben von Code beschleunigen.  All dies hilft sehr beim Aufbau der Szene, was wir jetzt tun werden.  Stellen Sie zun√§chst die Farbe ein: <br><br><pre> <code class="swift hljs">backgroundColor = <span class="hljs-type"><span class="hljs-type">SKColor</span></span>.white</code> </pre> <br>  Da die Schlange in einem Flugzeug arbeitet, ben√∂tigen wir keine Physik, und Sie k√∂nnen sie ausschalten, damit die Schlange nicht aufgrund der Schwerkraft herunterf√§llt.  Au√üerdem brauchen wir das Spiel nicht zum Drehen usw.: <br><br><pre> <code class="swift hljs">physicsWorld.gravity = .zero physicsWorld.contactDelegate = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> physicsBody = <span class="hljs-type"><span class="hljs-type">SKPhysicsBody</span></span>(edgeLoopFrom: frame) physicsBody?.allowsRotation = <span class="hljs-literal"><span class="hljs-literal">false</span></span> physicsBody?.categoryBitMask = <span class="hljs-type"><span class="hljs-type">CollisionCategories</span></span>.edgeBody physicsBody?.collisionBitMask = <span class="hljs-type"><span class="hljs-type">CollisionCategories</span></span>.snake | <span class="hljs-type"><span class="hljs-type">CollisionCategories</span></span>.snakeHead view.showsPhysics = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br>  Erstellen Sie nun die Schaltfl√§chen: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> counterClockwiseButton = <span class="hljs-type"><span class="hljs-type">ControlsFactory</span></span>.makeButton(at: <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: scene.frame.minX + <span class="hljs-number"><span class="hljs-number">30</span></span>, y: scene.frame.minY + <span class="hljs-number"><span class="hljs-number">50</span></span>), name: .counterClockwiseButtonName) addChild(counterClockwiseButton) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> clockwiseButton = <span class="hljs-type"><span class="hljs-type">ControlsFactory</span></span>.makeButton(at: <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: scene.frame.maxX - <span class="hljs-number"><span class="hljs-number">90</span></span>, y: scene.frame.minY + <span class="hljs-number"><span class="hljs-number">50</span></span>), name: .clockwiseButtonName) addChild(clockwiseButton)</code> </pre> <br>  Wenn Sie einen Code geschrieben haben, sollten Sie √ºberlegen, ob der Code verbessert oder √ºberarbeitet werden kann, damit er in Zukunft <b>wiederverwendet</b> werden <b>kann</b> .  Schauen Sie, wir haben grunds√§tzlich zwei Schaltfl√§chen auf dem Bildschirm, f√ºr deren Erstellung derselbe Code verwendet wird.  Dieser Code kann also in einer separaten Funktion entfernt werden.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erstellen Sie dazu eine</a> neue Klasse und entsprechend die Datei <b>ControlsFactory.swift</b> mit dem folgenden Code: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SpriteKit final class ControlsFactory { static func makeButton(at position: CGPoint, name: String) -&gt; SKShapeNode { let button = SKShapeNode() button.path = UIBezierPath(ovalIn: CGRect(x: 0, y: 0, width: 45, height: 45)).cgPath button.position = position button.fillColor = .gray button.strokeColor = UIColor.lightGray.withAlphaComponent(0.7) button.lineWidth = 10 button.name = name return button } }</code> </pre> <br>  Um einen zuf√§lligen Apfel zu zeichnen, den unsere Schlange ‚Äûfrisst‚Äú, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erstellen Sie die Apple-Klasse</a> und die <b>Apple.swift-</b> Datei: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SpriteKit final class Apple: SKShapeNode { let diameter: CGFloat = 10 convenience init(at point: CGPoint) { self.init() path = UIBezierPath(ovalIn: CGRect(x: -diameter/2, y: -diameter/2, width: diameter, height: diameter)).cgPath fillColor = .red strokeColor = UIColor.red.withAlphaComponent(0.7) lineWidth = 5 position = point physicsBody = SKPhysicsBody(circleOfRadius: diameter / 2, center: .zero) physicsBody?.categoryBitMask = CollisionCategories.apple } }</code> </pre> <br>  Und wir beschreiben unseren Apfel mit der Funktion <code>createApple()</code> in <b>GameScene.swift</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createApple</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> padding: <span class="hljs-type"><span class="hljs-type">UInt32</span></span> = <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> randX = <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(arc4random_uniform(<span class="hljs-type"><span class="hljs-type">UInt32</span></span>(gameFrameRect.maxX) - padding) + padding) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> randY = <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(arc4random_uniform(<span class="hljs-type"><span class="hljs-type">UInt32</span></span>(gameFrameRect.maxY) - padding) + padding) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> apple = <span class="hljs-type"><span class="hljs-type">Apple</span></span>(at: <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: randX, y: randY).relative(to: gameFrameRect)) gameFrameView.addChild(apple) }</code> </pre> <br>  Nun, f√ºr die Schlange ist die Wende gekommen.  Es besteht aus zwei Teilen: dem K√∂rper ( <b>SnakeBodyPart.swift</b> ) und dem Kopf ( <b>SnakeHead.swift</b> ). <br><br>  <b>SnakeBodyPart.swift</b> Code: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SpriteKit class SnakeBodyPart: SKShapeNode { init(at point: CGPoint, diameter: CGFloat = 10.0) { super.init() path = UIBezierPath(ovalIn: CGRect(x: -diameter/2, y: -diameter/2, width: diameter, height: diameter)).cgPath fillColor = .green strokeColor = UIColor.green.withAlphaComponent(0.7) lineWidth = 5 position = point physicsBody = SKPhysicsBody(circleOfRadius: diameter - 4, center: .zero) physicsBody?.isDynamic = true physicsBody?.categoryBitMask = CollisionCategories.snake physicsBody?.contactTestBitMask = CollisionCategories.edgeBody | CollisionCategories.apple } required init?(coder aDecoder: NSCoder) { fatalError("init(coder:) has not been implemented") } }</code> </pre> <br>  <b>SnakeHead.swift</b> Code: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SpriteKit final class SnakeHead: SnakeBodyPart { init(at point: CGPoint) { super.init(at: point, diameter: 20) physicsBody?.categoryBitMask = CollisionCategories.snakeHead physicsBody?.contactTestBitMask = CollisionCategories.edgeBody | CollisionCategories.apple } required init?(coder aDecoder: NSCoder) { fatalError("init(coder:) has not been implemented") } }</code> </pre> <br>  Wir werden Sie jedoch nicht mit einer Beschreibung jeder Zeile <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">langweilen</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">da die Details zum Erstellen der GameScene.swift-Datei</a> und anderer Klassen im Video gut angezeigt werden.  Wir bieten nur den endg√ºltigen Code von <b>GameScene.swift an</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SpriteKit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GameplayKit class GameScene: SKScene { var gameFrameRect: CGRect = .zero var gameFrameView: SKShapeNode! var startButton: SKLabelNode! var stopButton: SKLabelNode! var snake: Snake? override func didMove(to view: SKView) { setup(in: view) } override func update(_ currentTime: TimeInterval) { snake?.move() } override func touchesBegan(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?) { guard let touchedNode = findTouchedNode(with: touches) else { return } if let shapeNode = touchedNode as? SKShapeNode, touchedNode.name == .counterClockwiseButtonName || touchedNode.name == .clockwiseButtonName { shapeNode.fillColor = .green if touchedNode.name == .counterClockwiseButtonName { snake?.moveCounterClockwise() } else if touchedNode.name == .clockwiseButtonName { snake?.moveClockwise() } } else if touchedNode.name == .startButtonName { start() } else if touchedNode.name == .stopButtonName { stop() } } override func touchesEnded(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?) { guard let touchedNode = findTouchedNode(with: touches) else { return } if let shapeNode = touchedNode as? SKShapeNode, touchedNode.name == .counterClockwiseButtonName || touchedNode.name == .clockwiseButtonName { shapeNode.fillColor = .gray } } override func touchesCancelled(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?) { guard let touchedNode = findTouchedNode(with: touches) else { return } if let shapeNode = touchedNode as? SKShapeNode, touchedNode.name == .counterClockwiseButtonName || touchedNode.name == .clockwiseButtonName { shapeNode.fillColor = .gray } } <span class="hljs-comment"><span class="hljs-comment">// MARK: - private func start() { guard let scene = scene else { return } snake = Snake(at: CGPoint(x: scene.frame.midX, y: scene.frame.midY)) gameFrameView.addChild(snake!) createApple() startButton.isHidden = true stopButton.isHidden = false } private func stop() { snake = nil gameFrameView.removeAllChildren() startButton.isHidden = false stopButton.isHidden = true } private func setup(in view: SKView) { backgroundColor = SKColor.white physicsWorld.gravity = .zero physicsWorld.contactDelegate = self physicsBody = SKPhysicsBody(edgeLoopFrom: frame) physicsBody?.allowsRotation = false physicsBody?.categoryBitMask = CollisionCategories.edgeBody physicsBody?.collisionBitMask = CollisionCategories.snake | CollisionCategories.snakeHead view.showsPhysics = true let margin: CGFloat = 20 let gameFrame = frame.inset(by: view.safeAreaInsets) gameFrameRect = CGRect(x: margin, y: margin + view.safeAreaInsets.top + 55, width: gameFrame.width - margin * 2, height: gameFrame.height - margin * 2 - 55) drawGameFrame() guard let scene = view.scene else { return } let counterClockwiseButton = ControlsFactory.makeButton(at: CGPoint(x: scene.frame.minX + 30, y: scene.frame.minY + 50), name: .counterClockwiseButtonName) addChild(counterClockwiseButton) let clockwiseButton = ControlsFactory.makeButton(at: CGPoint(x: scene.frame.maxX - 90, y: scene.frame.minY + 50), name: .clockwiseButtonName) addChild(clockwiseButton) startButton = SKLabelNode(text: "START") startButton.position = CGPoint(x: scene.frame.midX, y: 55) startButton.fontSize = 40 startButton.fontColor = .green startButton.name = .startButtonName addChild(startButton) stopButton = SKLabelNode(text: "STOP") stopButton.position = CGPoint(x: scene.frame.midX, y: 55) stopButton.fontSize = 40 stopButton.fontColor = .red stopButton.name = .stopButtonName stopButton.isHidden = true addChild(stopButton) } final func drawGameFrame() { gameFrameView = SKShapeNode(rect: gameFrameRect) gameFrameView.fillColor = .lightGray gameFrameView.lineWidth = 2 gameFrameView.strokeColor = .green addChild(gameFrameView) } private func findTouchedNode(with touches: Set&lt;UITouch&gt;) -&gt; SKNode? { return touches.map { [unowned self] touch in touch.location(in: self) } .map { atPoint($0) } .first } private func createApple() { let padding: UInt32 = 15 let randX = CGFloat(arc4random_uniform(UInt32(gameFrameRect.maxX) - padding) + padding) let randY = CGFloat(arc4random_uniform(UInt32(gameFrameRect.maxY) - padding) + padding) let apple = Apple(at: CGPoint(x: randX, y: randY).relative(to: gameFrameRect)) gameFrameView.addChild(apple) } } // MARK: - SKPhysicsContactDelegate extension GameScene: SKPhysicsContactDelegate { func didBegin(_ contact: SKPhysicsContact) { var contactMask = contact.bodyA.categoryBitMask | contact.bodyB.categoryBitMask contactMask ^= CollisionCategories.snakeHead switch contactMask { case CollisionCategories.apple: let apple = contact.bodyA.node is Apple ? contact.bodyA.node : contact.bodyB.node snake?.addBodyPart() apple?.removeFromParent() createApple() case CollisionCategories.edgeBody: stop() break default: break } } } private extension String { static let counterClockwiseButtonName = "counterClockwiseButton" static let clockwiseButtonName = "clockwiseButton" static let startButtonName = "startButton" static let stopButtonName = "stopButton" }</span></span></code> </pre> <br>  Das Ergebnis war das einfachste Snake-Spiel: <br><br><img src="https://habrastorage.org/webt/x7/i7/wt/x7i7wtj2zk-1y-xb-hkj4z-prg0.jpeg"><br><br>  Wir haben ungef√§hr anderthalb Stunden gebraucht, um das Spiel zu schreiben.  Wenn Sie Programmierkenntnisse in Swift erwerben m√∂chten, wiederholen Sie alle Schritte selbst.  √úbrigens erhalten Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> vollen Zugriff auf alle Codedateien, die in diesem Projekt verwendet wurden. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de469537/">https://habr.com/ru/post/de469537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de469525/index.html">Automatisiertes Steuerungssystem f√ºr einen Bergbaubagger</a></li>
<li><a href="../de469527/index.html">Ist die Gegensprechanlage ein Spionageohr?</a></li>
<li><a href="../de469529/index.html">Text-Rendering hasst dich</a></li>
<li><a href="../de469531/index.html">"Programmiersprachen besser und schlechter zu vergleichen, ist eine v√∂llig idiotische Besch√§ftigung."</a></li>
<li><a href="../de469533/index.html">Probleme und Bedrohungen der biometrischen Identifizierung</a></li>
<li><a href="../de469541/index.html">Zusammenstellung und Bereitstellung derselben Microservices mit werf und GitLab CI</a></li>
<li><a href="../de469543/index.html">Redis-Skalierung und Failover f√ºr DirectumRX-Dienste</a></li>
<li><a href="../de469545/index.html">Was ist neu im Linux-Kernel 5.3 - Grafiktreiber, Virtualisierung und √Ñnderungen im Netzwerksubsystem</a></li>
<li><a href="../de469549/index.html">Wie haben wir den Tarif f√ºr Windows VPS f√ºr 99 Rubel gemacht?</a></li>
<li><a href="../de469551/index.html">VDS mit Grafikkarte - wir wissen viel √ºber Perversionen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>