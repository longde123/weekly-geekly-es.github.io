<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§ ğŸ’¶ ğŸ‘¹ Optimalisasi Persatuan: bagaimana hierarki adegan mencuri Anda ğŸ’± ğŸ¤´ğŸ» ğŸ‘¨ğŸ»â€ğŸ¤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jadi, Anda telah mengoptimalkan bagian paling jelas dari gim Anda. Namun, ini sebenarnya bukan masalahnya. Anda melewatkan poin rumit, tidak terlalu m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Optimalisasi Persatuan: bagaimana hierarki adegan mencuri Anda</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/481510/"> <em>Jadi, Anda telah mengoptimalkan bagian paling jelas dari gim Anda.</em>  <em>Namun, ini sebenarnya bukan masalahnya.</em>  <em>Anda melewatkan poin rumit, tidak terlalu mencolok: mengoptimalkan hierarki adegan Persatuan.</em> <br><br>  Dan apa yang salah dengan hierarki?  Mari saya tunjukkan sesuatu. <br><br>  Luncurkan Unity dan buka proyek game Anda.  Kemudian jalankan game di perangkat target <br>  dan hubungkan Unity Profiler ke sana.  Rekam beberapa bingkai selama bermain game. <br><br>  Di Unity Profiler, cari <strong>penanda profiler</strong> jahat berikut: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7f/ne/0u/7fne0utbubx4brfwo8fadtq1aeq.png"></div><br>  Tidak menemukan?  Terus mencari, saya yakin setidaknya ada satu. <br><br>  Itu bisa <em>UpdateRendererBoundingVolumes</em> , <em>Physics.SyncColliderTransform</em> atau <em>TransformChangedDispatch</em> . <br><br>  Mereka akan muncul ketika Anda siap untuk menyerah.  Itu akan terjadi saat Anda mengarahkan kursor ke tombol tutup Profiler. <br><br>  Apakah kamu sudah menemukan?  Jika demikian, Anda beruntung.  Saya juga menemukannya di salah satu proyek saya sebelumnya dan menemukan cara untuk benar-benar menyingkirkannya.  Saya menyadari kejahatan apa yang tersembunyi di dalamnya ... <br><br>  Ingin mempelajari <strong>rahasia kinerja hierarki scene Unity</strong> ? <br><a name="habracut"></a><br><h2>  Level 1 Pengembang: Hierarki Adegan Adegan Khas </h2><br>  Saya masih ingat proyek Unity pertama yang saya kerjakan lebih dari sepuluh tahun yang lalu. <br><br>  Saya masih tidak benar-benar tahu perbedaan antara objek dan komponen game. <br><br>  Tapi itu tidak masalah, saya masih membuat game. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c16/5c6/15b/c165c615b2ac5e9287f9f29d80b1cc66.png" alt="gambar"></div><br>  Apakah hierarki persatuan kacau seperti itu akrab bagi saya?  Sebenarnya ya, karena kadang-kadang jauh lebih buruk.  Namun, aneh bahwa lebih sering daripada tidak, hirarki semacam ini dapat ditiadakan.  Tetapi Anda akan menderita.  Anda harus membayarnya nanti. <br><br>  Untungnya, sebelum saya mulai mengembangkan game secara profesional, saya belajar untuk menghargai hierarki yang lebih terstruktur. <br><br>  Struktur kualitas hierarki adegan dapat menjadi teman terbaik Anda.  Struktur ini sangat menyederhanakan pengembangan dan kolaborasi. <br><br>  Tidak harus sempurna, apa pun artinya itu.  Cukup baginya untuk menjadi baik.  Tapi hati-hati.  <strong>Ini penting.</strong> <br><br>  Hirarki adegan sampah berbahaya, itu akan menyebabkan masalah bagi Anda, karena sangat kecil kemungkinan Anda akan langsung melihat efek sampingnya. <br><br>  Hantu yang menakutkan akan menghantui Anda, memperlambat Anda, dan menarik Anda kembali.  Terkadang Anda akan melihat ke belakang, tetapi tidak ada yang tertinggal.  Karena itu, Anda akan terbiasa bergerak perlahan. <br><br>  Selama bertahun-tahun, saya telah belajar untuk mendiagnosis efek samping ini.  Masalah utama adalah bahwa efek samping dari hirarki kacau tidak begitu mudah dilacak. <br><br>  Anda akan melihat profiler, tetapi Anda tidak akan tahu apa artinya penanda.  Nama-nama mereka seringkali misterius ... rahasia apa yang mereka simpan?  Hanya ada satu hal yang harus dipastikan: penanda misterius memberi tahu kita sesuatu yang perlu ditelusuri. <br><br>  Ketika kami membahas memperbaiki struktur adegan, kami biasanya berarti meningkatkan pemahaman dan menurunkan biaya dukungan.  Tetapi semua orang lupa tentang kinerja. <br><br>  Mari kita menganalisis hierarki adegan yang ditunjukkan di atas.  Ini berisi <strong>2.000 bola berputar satu bersarang ke yang lain</strong> . <br><br>  Apa yang akan profiler katakan tentang ini?  Ayo lihat. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a8a/e9d/529/a8ae9d529ff633997adba0411f78b7bf.png" alt="gambar"></div><br>  <i>Optimalisasi hierarki adegan kesatuan: gambaran umum hierarki profiler</i> <br><br>  Performa yang sangat buruk untuk prefab sederhana dan skrip rotasi diterapkan pada bola biasa.  Seperti yang Anda lihat, <em>Physics.SyncColliderTransform</em> dan <em>UpdateRendererBoundingVolumes</em> mengambil bagian besar dari anggaran waktu bingkai.  Tapi mari kita tidak menyelesaikan analisis ini, karena saya sangat ingin tahu tentang kasus ini. <br><br>  Mari kita lebih dalam. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ca1/4a5/94f/ca14a594f3d5ab80a8fc80153f743d2a.png"></div><br>  <i>Rincian Profil Hirarki</i> <br><br>  <strong>Inilah jawaban untuk pertanyaan artikel.</strong> <br><br>  Hirarki yang tidak dioptimalkan menyebabkan dua masalah BESAR di Unity. <br><br><ul><li>  Hirarki yang dalam mencegah sistem kerja dari bekerja secara efisien secara paralel </li><li>  Hirarki bersarang memicu kemacetan di beberapa subsistem Unity. </li></ul><br>  Jangan lupa, karena <strong>ini berlaku untuk semua jenis objek dinamis</strong> , dan terutama untuk antarmuka pengguna. <br><br>  Untuk referensi: Saya mengerjakan Threadripper dengan 16 core fisik dan 32 thread.  Apakah Anda tahu berapa banyak dari mereka yang bekerja secara efektif dalam proyek ini?  Hanya satu. <br><br>  Tidak perlu dikatakan, kinerja game menderita dari ini.  Dan jika Anda mencoba untuk memperbaiki situasi dengan memahami semua nama-nama misterius ini, maka menjadi tua sebelum waktunya. <br><br>  <strong>Apa yang akan dilakukan pengembang level 2 dengan 2.000 objek?</strong> <br><br><h2>  Pengembang Level 2: Hirarki Adegan Dioptimalkan </h2><br>  Pengembang Unity level 2 tahu bahwa transformasi anak dikenakan biaya.  Dia juga tahu bahwa harga dalam hal ini adalah milidetik dari waktu CPU.  Atau jam kerja ekstra yang dihabiskan oleh pengembang untuk menyelesaikan masalah ini. <br><br>  Tanyakan pada diri Anda: apakah anggaran waktu CPU cukup untuk membayar hierarki yang sedemikian luas? <br><br>  Dari area mana gim Anda ambil milidetik ini? <br><br>  Apakah ini harus mengurangi jumlah partikel yang indah?  Atau jumlah monster yang harus dilawan pemain?  Saya harap Anda tidak harus melakukan semua ini, tetapi lebih baik ... <br><br>  Buat hierarki adegan yang efektif dan hancurkan yang suboptimal. <br><br>  Alasan mengapa kompleks bersarang benda anak mencuri sumber daya permainan itu sederhana: <strong>setiap perubahan untuk mengubah memengaruhi anak-anak, dan mungkin orang tua dengan saudara kandung.</strong> <br><br>  Ketika Anda mengubah posisi, rotasi, atau skala suatu objek, Unity menceritakan banyak aspek.  Mesin melakukan ini sendiri sehingga Anda dapat fokus pada gim.  Ini bagus, tetapi jika Anda tidak mengetahuinya, maka harganya bisa menjadi sangat besar. <br><br>  Apa solusinya?  Buat segala sesuatunya sederhana dan tetap berpegang pada aturan emas dari hierarki scene Unity yang bersih: <br><br><ul><li>  Total tidak lebih dari <a href="http://es-from-the-spotlight-team-optimizing-the-hierarchy/">50</a> anak per objek game </li><li>  Tidak lebih dari 4 level bersarang pada objek game apa pun. </li></ul><br>  Bukankah itu mudah?  Pengembang Level 2 menciptakan hirarki datar adegan persatuan sebanyak mungkin. <br><br>  Lihatlah gambar di bawah ini.  Jumlah objek yang sama, tetapi kali ini disusun menjadi hierarki datar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf1/679/15e/cf167915e7a234e6fedf5195ac4361d5.png"></div><br>  Penghematan sangat besar. <br><br>  Tapi lebih mudah diucapkan daripada dilakukan, bukan?  Pemisahan dan penghancuran hubungan antara objek sangat melelahkan, rawan kesalahan dan kerja panjang. <br><br>  Apa yang akan dilakukan pengembang level 3? <br><br><h2>  Pengembang Level 3: Alat Hirarki FAP </h2><br>  Pengembang Unity yang baik melakukan tugasnya.  Pengembang Unity yang <strong>hebat</strong> melakukan pekerjaan lebih cepat dan lebih akurat.  Tetapi bagaimana dia berhasil?  Dengan bantuan alat.  Karena satu-satunya hierarki murah adalah hierarki kosong, untuk mengevaluasi permainan, Anda perlu menjawab pertanyaan berikut ... <br><br>  <strong>Seberapa rumit hierarki Anda?</strong> <br><br>  Pertanyaan ini dapat dijawab dengan menganalisis hierarki secara metodis dan memberi mereka peringkat numerik. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ls/dj/uw/lsdjuwi6l0nz8msasaku8fbhyya.png"></div><br>  Rumus matematika apa yang diperlukan untuk menghitung taksiran ini?  Untungnya tidak ada.  Saya melakukan segalanya untuk Anda.  Saya menulis alat prototipe untuk secara otomatis menganalisis dan mengenali hambatan dalam hierarki Anda berdasarkan aturan emas di atas. <br><br>  Saya menyebut <strong>Alat Hierarki Penentuan Profil Luar Biasa</strong> ini.  Luncurkan game.  Dapatkan momen yang menarik.  Buka alat dan biarkan ia melakukan sisanya. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f3b/65c/4d8/f3b65c4d8a22f7da546e3b5f38fc3f06.png"></div><br>  Alat ini akan memberi Anda peringkat integer.  Begitu Anda tahu skornya, Anda akan tahu apa yang harus dilakukan ... Atau tidak? <br><br>  Karena saya memberi Anda tidak hanya alat ini, tetapi juga skrip tambahan yang memungkinkan Anda untuk memperkuat kemampuan Anda untuk menghilangkan masalah dengan hierarki.  Saya memberi Anda kekuatan skrip <em>DetachGameObject.cs</em> sederhana. <br><br>  Sangat jarang menemukan skrip 27 baris, yang memungkinkan peningkatan kinerja dalam waktu singkat.  Kerjanya sederhana: selama eksekusi program, ia memindahkan objek game yang berat dan tertanam ke akar hierarki adegan.  Karena itu, Anda memanfaatkan <strong>hierarki terstruktur pada waktu desain</strong> dan mendapatkan <strong>keuntungan kinerja luar biasa saat runtime</strong> . <br><br>  Ada kemungkinan besar bahwa Anda dapat melakukan ini untuk sebagian besar hierarki Anda, yang untuk penataan memiliki banyak sarang. <br><br>  Anda dapat mengunduh alat dan skrip di akhir <a href="https://thegamedev.guru/unity-performance/scene-hierarchy-optimization/">artikel asli</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id481510/">https://habr.com/ru/post/id481510/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id481490/index.html">Vitamin D. Wisata Singkat</a></li>
<li><a href="../id481492/index.html">Kami mengumpulkan musik berwarna untuk Tahun Baru</a></li>
<li><a href="../id481500/index.html">Programmer fanatik. Bagian abstrak 3 + tabel abstrak. Perencanaan dan kerikil dalam seember air</a></li>
<li><a href="../id481502/index.html">Pengantar Tindakan GitHub</a></li>
<li><a href="../id481506/index.html">Intisari materi menarik untuk pengembang seluler # 327 (pada 16 - 22 Desember)</a></li>
<li><a href="../id481516/index.html">Kompleksitas berolahraga pesawat ruang angkasa</a></li>
<li><a href="../id481518/index.html">Profesional Manajemen Proyek (PMP): Edisi 6 Apa? Mengapa dan mengapa?</a></li>
<li><a href="../id481522/index.html">Di bar yang lebih rendah, atau melawan anggapan kewarasan</a></li>
<li><a href="../id481524/index.html">Audit Serentak Selama Voting Elektronik</a></li>
<li><a href="../id481528/index.html">Bagaimana tes dapat membantu Anda dalam membuat UI-kit Anda sendiri</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>