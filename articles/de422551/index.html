<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💇🏿 👍🏼 🙅🏻 So stehlen Sie Geld von einer kontaktlosen Karte und Apple Pay 🧝🏾 👦🏼 👩🏼‍🎤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Artikel untersucht beliebte Mythen und Szenarien des kontaktlosen Zahlungsbetrugs am Beispiel eines echten POS-Terminals, PayPass / PayWave-Karten...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So stehlen Sie Geld von einer kontaktlosen Karte und Apple Pay</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422551/"><img alt="Wie kann man Geld von einer kontaktlosen Karte aus der Tasche stehlen? Wie sicher ist PayPass und Apple Pay?" src="https://habrastorage.org/webt/gb/2f/ry/gb2frybl-08fyn1a0w1xxjap9f0.jpeg"><br><br>  Der Artikel untersucht beliebte Mythen und Szenarien des kontaktlosen Zahlungsbetrugs am Beispiel eines echten POS-Terminals, PayPass / PayWave-Karten und Telefone mit der Google Pay / Apple Pay-Funktion. <br><br>  Behandelte Themen: <br><br><ul><li>  <b>Ist es wirklich möglich, Geld zu stehlen, indem ich mein POS-Terminal in die Tasche lehne?</b>  - Wir werden versuchen, dieses Betrugsszenario von Anfang bis Ende vollständig zu reproduzieren, indem wir ein echtes POS-Terminal und Zahlungskarten unter realen Bedingungen verwenden. </li><li>  <b>Was ist der Unterschied zwischen physischen und virtuellen Apple Pay-Karten?</b>  - wie die physische Karte und das Apple Pay-Token miteinander verbunden sind und warum Apple Pay viel sicherer ist als eine normale Karte. </li><li>  <b>Wir verwenden einen Hardware-NFC-Sniffer (ISO 14443A)</b> - wir verwenden ein HydraNFC-Gerät, um Daten zwischen dem POS-Terminal und der Karte abzufangen.  Überlegen Sie, welche vertraulichen Daten aus abgefangenem Datenverkehr extrahiert werden können. </li><li>  <b>Wir analysieren das EMV-Protokoll</b> - welche Daten die Karte mit dem POS-Terminal austauscht, welches Anforderungsformat verwendet wird, welche Mechanismen zum Schutz vor Betrug und Wiederholungsangriffen verwendet werden. </li><li>  <b>Wir untersuchen Operationen ohne Karte (CNP, MO / TO)</b> - in welchen Fällen (!) Können Sie Geld von der Karte stehlen, indem Sie nur die Details ohne Kontakt lesen lassen und in denen dies unmöglich ist. </li></ul><br>  <font color="red"><b>Achtung!</b></font> <br><br>  Der Artikel beschreibt detailliert das hypothetische Schema des Betrugs von Anfang bis Ende mit den Augen eines Betrügers, um alle Aspekte abzudecken, in denen Mythen und Fehler gepflegt werden.  Trotz des provokanten Titels ist die Hauptschlussfolgerung des Artikels, dass <b>kontaktlose Zahlungen ziemlich sicher sind und Angriffe auf sie zeitaufwändig und unrentabel sind</b> . <br><br>  <font color="red">Die Materialien im Artikel dienen nur zu Informationszwecken.</font>  <font color="red">Alle Betrugsszenen werden mit Zustimmung der beteiligten Parteien inszeniert und ausgeführt.</font>  <font color="red">Das gesamte von den Karten abgezogene Geld wurde an ihre Besitzer zurückgegeben.</font>  <font color="red">Der Diebstahl von Kartengeldern ist strafbar und strafbar.</font> <a name="habracut"></a><br><h1>  Wie funktioniert es </h1><br>  Betrachten Sie zunächst die Grundkonzepte: Jede Bewegung von Geld mit Zahlungskarten ist nur über Vermittler möglich, die mit dem Zahlungssystem verbunden sind, wie z. B. VISA oder MasterCard.  Im Gegensatz zu Überweisungen zwischen Einzelpersonen steht die Abbuchung von Geld von der Karte nur einer juristischen Person (Händler) mit einer Erwerbsvereinbarung mit einer Bank zur Verfügung. <br><br><img src="https://habrastorage.org/webt/d5/1w/ce/d51wcetyqo_5ppr5467wwknaaus.png"><br>  <i><font color="99999">Transaktionsphasen beim Bezahlen über ein POS-Terminal</font></i> <br><br>  Die obige Abbildung zeigt das klassische Zahlungsschema über ein POS-Terminal.  Diese Abfolge von Aktionen tritt auf, wenn Sie nach der Zahlung an der Kasse auf eine Bestätigung am Terminal warten. <br><br><ol><li>  Der Käufer beantragt / hält / steckt die Karte in das POS-Terminal ein; </li><li>  Ein POS-Terminal überträgt Daten über das Internet an eine erwerbende Bank. </li><li>  Die erwerbende Bank über das internationale Zahlungssystem (MPS) kontaktiert die ausstellende Bank und fragt, ob ein bestimmter Karteninhaber den Kauf bezahlen kann. </li><li>  Die ausstellende Bank bestätigt oder lehnt den Kauf ab, woraufhin ein Beleg gedruckt wird (zweiter Scheck). </li></ol><br>  Es gibt Ausnahmen von diesem Schema, zum Beispiel Offline-Transaktionen, wir werden sie weiter betrachten.  Wenn die erwerbende Bank und die ausstellende Bank dieselbe Bank sind, werden die Schritte 2 und 4 innerhalb derselben Bank ausgeführt. <br><br>  <b>Verkäufer</b> (Händler) - eine Person oder Organisation, die Waren oder Dienstleistungen anbietet <br><br>  Die übernehmende Bank ist eine Bank, die dem Verkäufer Zahlungsakzeptanzdienste über Bankkarten anbietet.  In dieser Bank gibt es normalerweise ein Bankkonto des Verkäufers, auf dem das von der Karte abgebuchte Geld gutgeschrieben wird. <br><br>  <b>Ausstellende</b> Bank - die Bank, die die Karte ausgestellt hat.  Es enthält das Konto des Karteninhabers, von dem Geld abgebucht wird. <br><br>  <b>Das International Payment System</b> (MPS) ist ein internationales Vermittlungssystem zwischen Banken auf der ganzen Welt, das es Banken ermöglicht, Abrechnungen untereinander vorzunehmen, ohne eine Vereinbarung mit jeder Bank separat abzuschließen.  Alle mit dem Eisenbahnministerium verbundenen Banken verpflichten sich, nach denselben Regeln zu arbeiten, was die Interaktion erheblich vereinfacht.  Zum Beispiel Visa, MasterCard, UnionPay, American Express, <s>MIR</s> (nein, MIR funktioniert nicht im Ausland). <br><br>  <b>Karteninhaber</b> - eine Person, die mit der ausstellenden Bank einen Kartendienstvertrag abgeschlossen hat. <br><br><h1>  Was ist der Unterschied zwischen einer normalen Karte von Apple Pay oder Google Pay? </h1><br>  Das Verfahren zum Verknüpfen einer Bankkarte mit dem Apple Pay- oder Google Pay-System aufgrund der Unverständlichkeit des Prozesses führt selbst unter IT-Fachleuten häufig zu Missverständnissen.  Ich habe viele verschiedene Mythen über diese Technologie gehört. <br><br><h4>  Beliebte Apple Pay Mythen </h4><br><ul><li>  <b><font color="D13CB8">Die Karte wird auf das Telefon kopiert</font></b> <br>  Dies ist nicht der Fall. Die Mikroprozessorkarte enthält einen geschützten Speicherbereich mit kryptografischen Informationen, die nach der Ausgabe der Karte nicht extrahiert werden können.  Aus diesem Grund kann eine Chipkarte in keiner Weise kopiert werden.  <i><font color="99999">Fairerweise muss gesagt werden, dass solche Angriffe möglich sind, aber ihre Kosten übersteigen den Gesamtbetrag, den die meisten Leser dieses Artikels in ihrem gesamten Leben ausgeben werden.</font></i> </li><li>  <b><font color="D13CB8">Jedes Mal, wenn das Telefon während der Zahlung eine Verbindung zum Internet herstellt</font></b> <br>  Google Pay / Apple Pay stellen während der Zahlung über ein POS-Terminal keine Verbindung zum Internet her.  Alle erforderlichen Informationen werden lokal auf dem Telefon gespeichert. </li><li>  <b><font color="D13CB8">Für jede Zahlung wird eine neue Kartennummer (PAN) generiert</font></b> <br>  Dies scheint der Fall zu sein, wenn Sie Apples Pressemitteilungen zur Apple Pay-Technologie lesen.  Dies ist jedoch eine fehlerhafte Interpretation des Token-Konzepts.  Tatsächlich bleiben die Details der virtuellen Karte für lange Zeit unverändert. Sie können dies bei der Bezahlung von Einkäufen anhand der letzten Ziffern der Kartennummer im Beleg (Bankscheck) überprüfen. </li><li>  <b><font color="D13CB8">Bei Zahlung über Apple Pay / Google Pay wird eine zusätzliche Gebühr erhoben</font></b> <br>  Dies ist nicht der Fall. Sie zahlen genau so viel, wie auf dem Preisschild angegeben, und gemäß den Bestimmungen Ihrer Vereinbarung mit der ausstellenden Bank, deren Karte Sie verknüpft haben. </li><li>  <b><font color="D13CB8">Geld kann zweimal belastet werden</font></b> <br>  Dieser Mythos gilt nicht nur für Google Pay / Apple Pay, sondern auch für normale Bankkarten.  Ich glaube, dass dies auf Zahlungssysteme für öffentliche Verkehrsmittel zurückzuführen ist, bei denen das Terminal bei jeder Vorlage Geld vom Ticket abzieht, sodass Sie zwei oder mehr Mal abbuchen können, wenn Sie die Karte falsch mitbringen.  Bei POS-Terminals besteht dieses Risiko nicht, da das Terminal den Austausch mit der Karte beendet, sobald es die erforderlichen Daten erhält. </li></ul><br><br><img src="https://habrastorage.org/webt/z5/mt/og/z5mtogccxmh5picpde0ng_nmnnk.png"><br>  <i><font color="99999">Verknüpfen einer physischen Karte mit einem Token im Telefon</font></i> <br><br>  Systeme wie Apple Pay werden von der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">EMV Payment Tokenization Specification unterstützt</a> .  Das Verfahren zum Zuordnen einer physischen Karte und eines Telefons zu Apple Pay wurde nicht öffentlich beschrieben. Daher werden wir den Prozess anhand bekannter Daten analysieren: <br><br><ol><li>  Der Anbieter (Google, Apple, Samsung) erhält Karteninformationen. </li><li>  Über das MPS fragt der Anbieter an, ob diese Karte (diese ausstellende Bank) die EMV-Tokenisierung unterstützt. </li><li>  Auf der MPS-Seite wird eine virtuelle Karte (Token) generiert, die in den sicheren Speicher des Telefons heruntergeladen wird.  <i><font color="99999">Ich weiß nicht, wo genau der private Schlüssel von der virtuellen Karte generiert wird, ob er über das Internet übertragen oder lokal am Telefon generiert wird. In diesem Fall spielt dies keine Rolle.</font></i> </li><li>  Auf dem Telefon wird eine generierte virtuelle Token-Karte angezeigt. Dies sind die Vorgänge, bei denen die ausstellende Bank Vorgänge auf der ersten physischen Karte interpretiert.  Im Falle des Blockierens der physischen Karte wird auch der Token blockiert. </li></ol><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterstützt kein HTML5-Video. <source src="https://zhovner.com/forever/applepay_different_pan.mp4" type="video/mp4"></video></div></div></div><br>  <i><font color="99999">Mit Apple Pay können Sie die Details einer virtuellen Karte lesen.</font></i>  <i><font color="99999">PAN-Nummer und Ablaufdatum unterscheiden sich von der verknüpften Karte der russischen Alfa-Bank.</font></i>  <i><font color="99999">Die BIN der virtuellen Karte (480099) wird von der MBNA AMERICA BANK festgelegt.</font></i> <br><br>  Beim Bezahlen per Telefon sieht das POS-Terminal ein reguläres VISA oder eine MasterCard und kommuniziert mit diesem auf die gleiche Weise wie mit einer physischen Karte.  Eine virtuelle Token-Karte enthält alle Attribute einer regulären Karte: PAN-Nummer, Ablaufdatum usw.  Gleichzeitig unterscheiden sich die Nummer der virtuellen Karte und die Gültigkeitsdauer von der beigefügten Originalkarte. <br><br><h2>  Szenario 1 - reguläres POS-Terminal </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fw/jz/mj/fwjzmjgmj7beldkf8bh4hdwmlay.jpeg"></div><br>  <i><font color="99999">Betrüger am POS-Terminal</font></i> <br><br>  Die beliebteste Betrugshandlung in den Köpfen gewöhnlicher Menschen: Ein Betrüger mit eingeschaltetem Terminal wird in der Menge gegen sie gedrückt und schreibt Geld ab.  Wir werden versuchen, dieses Szenario in der Realität zu reproduzieren. <br><br>  <b>Die Bedingungen sind wie folgt</b> : <br><br><ul><li>  Der Betrüger verfügt über ein voll funktionsfähiges <b>normales POS-Terminal, das</b> mit einer übernehmenden Bank verbunden ist, genau wie in Geschäften und Kurieren.  Die Firmware des Terminals wird nicht geändert.  In unserem Fall - Ingenico iWL250.  Dies ist ein tragbares POS-Terminal mit einem GPRS-Modem, das kontaktloses Bezahlen unterstützt, mit Batteriestrom betrieben wird und vollständig mobil ist. </li><li>  Der Betrüger verwendet keine zusätzlichen technischen Mittel, sondern nur ein POS-Terminal </li><li>  Die abgebuchten Gelder werden gemäß allen Regeln der Bankensysteme dem Girokonto des Betrügers gutgeschrieben </li></ul><br><h3>  Juristische Person </h3><br><img src="https://habrastorage.org/webt/do/f_/qs/dof_qscba68g-7za5caz02pszqi.jpeg"><br><br>  Erstens brauchen wir eine juristische Person mit einem Girokonto und Erwerb verbunden.  Wir werden, wie echte Betrüger, nichts in unserem Namen erkennen, sondern versuchen, eine vorgefertigte juristische Person zu kaufen.  die Person auf der Website für die gleichen Betrüger.  Schauen Sie sich dazu die Anzeigen auf der ersten Seite von Google für "buy ip" und "buy ooo" an. <br><br> <a href=""><img src="https://habrastorage.org/webt/lu/7v/yc/lu7vycgengac_zvziy7cltrjl-k.png"></a> <br>  <i><font color="99999">Angebote zum Verkauf von vorgefertigten Unternehmen von Betrügern (anklickbar)</font></i> <br><br>  Der Preis eines Unternehmens auf dem Schwarzmarkt mit einem Girokonto liegt zwischen 20 und 300 Tausend Rubel.  Es gelang mir, mehrere Angebote von LLC mit einem POS-Terminal aus 200 Tausend Rubel zu finden.  Solche Unternehmen werden von Dummies eingerahmt, und der Käufer erhält das gesamte Dokumentenpaket zusammen mit einer „Cache-Karte“ - dies ist eine Bankkarte, die an das Abrechnungskonto des Dummy-Unternehmens gebunden ist.  Mit einer solchen Karte kann ein Betrüger Geld an einem Geldautomaten auszahlen. <br><br><blockquote>  Der Einfachheit halber gehen wir davon aus, dass LLC + Bankkonto + Erwerb und ein POS-Terminal den Betrüger <b>100.000 Rubel</b> kosten werden.  Eigentlich mehr, aber wir werden das Leben unseres hypothetischen Betrügers vereinfachen und die Angriffskosten senken.  Denn je niedriger die Angriffskosten sind, desto einfacher ist die Implementierung. </blockquote><br><h2>  Lass uns Geld stehlen </h2><br>  Der Betrüger hat also ein POS-Terminal und ist bereit, an einen überfüllten Ort zu gehen, um sich an die Opfer zu lehnen und Geld aus seinen Taschen zu stehlen.  In unserem Experiment wurden alle Opfer vorab über unsere Absichten unterrichtet, und alle Versuche, Geld abzuschreiben, wurden mit ihrer Zustimmung unternommen.  In Fällen, in denen die Probanden keine eigenen kontaktlosen Bankkarten hatten, wurden sie gebeten, unsere Karte in ihre Brieftasche zu stecken.  Zuvor fanden die Probanden genau heraus, wo und wie sie ihre Karten aufbewahren, sodass der Betrüger im Voraus wusste, wo sich die kontaktlose Karte in der Tasche befindet. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterstützt kein HTML5-Video. <source src="https://zhovner.com/forever/nfc_fraud_in_public.mp4" type="video/mp4"></video></div></div></div><br>  <i><font color="99999">Video: Ein Betrüger tobte in einem Einkaufszentrum</font></i> <br><br>  Im Falle einer erfolgreichen Abschreibung wurde die Transaktion über das Terminalmenü abgebrochen und das Geld auf das Konto der Probanden zurückerstattet.  Während der gesamten Dauer des Experiments haben wir versucht, 20 Probanden im Gebäude des Einkaufszentrums und auf der Straße Geld zu „stehlen“.  Das Testergebnis wird unten beschrieben. <br><br><h1>  Problem: Transaktionslimit ohne PIN </h1><br>  Das Limit für den maximalen Transaktionsbetrag ohne Bestätigung mit einem PIN-Code kann sowohl am POS-Terminal selbst (CVM Required Limit) als auch auf der Bankseite festgelegt werden.  In Russland beträgt diese Beschränkung 1000 Rubel. <br><br><hr><br>  <font color="99999"><i><b>UPD</b> In den Karteneinstellungen kann die Art der Autorisierung Karteninhaber-Überprüfungsmethoden (CVMs) als Signatur für den Scheck festgelegt werden.</i></font>  <font color="99999"><i>In diesem Fall findet eine kontaktlose Transaktion für einen beliebigen Betrag ohne PIN-Code statt.</i></font> <br><br><hr><br>  Unser Betrüger beschließt, jeweils 999,99 Rubel abzuschreiben.  Wenn Sie aufgefordert werden, den Betrag unterhalb des Grenzwerts in kurzer Zeit erneut abzuschreiben, werden Sie auch aufgefordert, den PIN-Code einzugeben. In den meisten Fällen ist es nicht möglich, 999,99 Rubel mehrmals hintereinander abzuschreiben.  Daher ist die optimalste Strategie nicht mehr als eine Ladung von einer Karte. <br><br><div style="text-align:center;"><img width="300" alt="POS-Terminal mit einem Betrag von 999,99" src="https://habrastorage.org/webt/at/kg/lt/atkgltocfv4dmqiutgb-8rbcej8.png"></div><br>  <i><font color="99999">In Russland beträgt der maximale Betrag, der ohne PIN-Code belastet wird, 1000 Rubel.</font></i> <br><br>  Tatsächlich können viele Abschreibungen mit einem Betrag von 999,99 Rubel in kurzer Zeit ein Betrugsbekämpfungssystem auf der Seite der übernehmenden Bank auslösen, sodass diese Strategie für einen Betrüger nicht optimal ist.  Im wirklichen Leben müsste er also unterschiedlichere Beträge wählen, um das potenzielle Einkommen zu verringern. <br><br>  Übrigens sagen viele Artikel zu diesem Thema in russischer Sprache, dass Sie Ihr eigenes Limit für kontaktlose Transaktionen ohne PIN-Code manuell festlegen können.  Ich konnte eine solche Option bei den wichtigsten russischen Banken nicht finden.  Vielleicht kennen Sie diese Möglichkeit?  Es geht um kontaktloses Bezahlen und nicht um Chip &amp; Pin-Transaktionen. <br><br><h2>  Problem: Mehrere Karten in der Brieftasche </h2><br>  Dies ist ein wichtiger Punkt in diesem Angriffsszenario, da in Wirklichkeit fast niemand <b>eine einzige Karte</b> in der Tasche hat.  In den meisten Fällen wird die Karte zusammen mit anderen kontaktlosen Karten, wie z. B. Reisetickets oder anderen Bankkarten, in der Brieftasche aufbewahrt. <br><br><div style="text-align:center;"><img width="300" src="https://habrastorage.org/webt/im/x5/j1/imx5j1sci8ml-89qidz1_w8tdow.png" alt="Kartengeschwollene Brieftasche"></div><br>  Insbesondere gibt mein Igenico iWL250-Terminal einen Fehler zurück, wenn es mehr als eine Karte im Aktionsfeld mit einem SAK erkennt, das die Unterstützung des 14443-4-Protokolls anzeigt: "Eine Karte präsentieren". <br><br>  Dies tun jedoch nicht alle Terminals.  Beispielsweise wählen VeriFone Sberbank POS-Terminals eine zufällige Karte aus mehreren aus.  Einige Terminals ignorieren einfach alle Karten, wenn es mehr als eine gibt, ohne dass Fehlermeldungen angezeigt werden. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterstützt kein HTML5-Video. <source src="https://zhovner.com/forever/pos_terminal_declines_few_cards.mp4" type="video/mp4"></video></div></div></div><br>  <i><font color="99999">Der Versuch, mehrere Karten in einer Brieftasche zu lesen.</font></i>  <i><font color="99999">Das POS-Terminal gibt einen Fehler zurück.</font></i> <br><br><h3>  Antikollisions-ISO 14443-3 </h3><br>  Das Lesen einer bestimmten Karte aus mehreren ist auf physischer Ebene keine leichte Aufgabe.  Um dieses Problem zu lösen, gibt es einen Antikollisionsmechanismus.  Sie können eine Karte auswählen, wenn eine Antwort von mehreren Karten gleichzeitig empfangen wurde.  Dies ist der allererste Schritt beim Herstellen eines Kontakts mit einer kontaktlosen Karte im ISO-14443A-Protokoll.  Zu diesem Zeitpunkt kann der Leser nicht herausfinden, welche der vorgestellten Karten Bankgeschäfte sind.  Die einzige Möglichkeit besteht darin, eine Bankkarte zu wählen, die mehr oder weniger einer Bankkarte ähnelt, basierend auf der Antwort von SAK (Select Acknowledge). <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/_k/ie/yz/_kieyz-qmexulctjyhmfnjyvff8.png"></div>  <i><font color="99999">Bitwert in der SAK-Antwort</font></i> <br><br>  So hat beispielsweise die im öffentlichen Verkehr in Moskau verwendete Troika-Karte (Mifare-Standard) den Wert <b>SAK = 0x08 (b00001000)</b> , wobei das sechste Bit Null ist.  Während für alle Bankkarten in den SAK-Antworten das sechste Bit 1 ist, bedeutet dies, dass das ISO 14443-4-Protokoll unterstützt wird. <br><br>  Daher kann das Terminal bei gleichzeitiger Erkennung mehrerer Karten nur Karten ausschließen, die ISO 14443-4 nicht unterstützen, und eine Karte auswählen, die der Bank ähnelt.  Die Unterstützung des ISO 14443-4-Protokolls garantiert übrigens nicht, dass es sich bei dieser Karte um eine Bankkarte handelt. In der Brieftasche eines normalen Menschen gibt es jedoch höchstwahrscheinlich keine anderen Kartentypen, die ISO 14443-4 unterstützen. <br><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/4l/q0/e_/4lq0e_bzubjholfmtdiu29fmlxe.png"></div><br>  <i><font color="99999">Flussdiagramm des Antikollisionsprotokolls</font></i> <br><br>  Aus persönlicher Erfahrung: Trotz des Vorhandenseins eines Protokolls gegen Kollisionen ist es <b><font color="red">EXTREM</font></b> schwierig, die gewünschte Karte <b><font color="red">erfolgreich</font></b> zu lesen, wenn sich mindestens drei kontaktlose Karten in Ihrer Brieftasche befinden.  Die meisten Versuche führen zu Lesefehlern.  Es ist noch schwieriger, dies auf der Flucht zu tun, indem man sich an die Taschen und Taschen anderer klammert. <br><br>  Wir werden jedoch davon ausgehen, dass unser Betrüger sehr viel Glück hat und diese Einschränkung ihn nicht stört. <br><br><h2>  Offline vs Online-Transaktionen </h2><br>  In erschreckenden Nachrichten sprechen sie über Betrüger mit POS-Terminals in U-Bahn-Wagen, die gleich unterwegs Geld aus der Tasche schreiben.  In diesen Geschichten wird nicht erwähnt, woher der Betrüger im U-Bahn-Wagen mobiles Internet hat.  Vielleicht unterstützt sein Terminal Offline-Transaktionen? <br><br>  EMV-Spezifikationen ermöglichen Offline-Transaktionen.  In diesem Modus erfolgt die Abbuchung ohne Online-Bestätigung durch die ausstellende Bank.  Dies funktioniert beispielsweise im öffentlichen Verkehr in Moskau und St. Petersburg.  Um sich am Eingang des Busses nicht anzustellen, lassen Sie das Terminal, während es die Online-Bestätigung ausfüllt, sofort ein, ohne zu prüfen, ob Sie genug Geld auf Ihrem Konto haben, um den Fahrpreis zu bezahlen.  Am Ende des Tages, wenn das Internet auf dem Terminal angezeigt wird, werden signierte Transaktionen an die ausstellende Bank gesendet.  Wenn sich herausstellt, dass Sie zu diesem Zeitpunkt kein Geld haben, um den Fahrpreis zu bezahlen, wird die Karte an allen Terminals in der Stadt zur Stoppliste hinzugefügt.  Sie können die Schulden über Ihr persönliches Konto mit der Kartennummer abbezahlen.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lesen Sie mehr</a> über das Bezahlen des Busses in St. Petersburg. <br><br>  Persönlich konnte ich kein POS-Terminal erhalten, das diese Funktion unterstützt. In dem Szenario mit dem üblichen „zivilen“ POS-Terminal wird die Möglichkeit einer Offline-Belastung nicht in Betracht gezogen.  Dies ändert nichts, außer dass der Angreifer das Internet am Terminal benötigt, sodass der Angriff beispielsweise in der U-Bahn viel komplizierter ist. <br>  Es gibt Terminalmodelle, die WiFi unterstützen, und theoretisch könnte unser Betrüger WiFi in der U-Bahn verwenden, nachdem er sich zuvor darum gekümmert hatte, werbefreien Zugang für die MAC-Adresse seines POS-Terminals zu kaufen, sodass die Authentifizierung nicht über das Captive-Portal erfolgen müsste, da dies am POS der Fall ist Das Terminal kann dies nicht tun. <br><br><h2>  Gewinn berechnen </h2><br>  In unserem Szenario betrugen die Kosten des Angriffs 100.000 Rubel.  Dies bedeutet, dass unser Held mindestens 100 Transaktionen mit jeweils 1.000 Rubel abschließen muss, um die Investitionen zumindest zurückzuzahlen.  Stellen Sie sich vor, er war agil genug und rannte den ganzen Tag durch die Stadt, klammerte sich an alle hintereinander, so dass er am Ende des Tages 120 erfolgreiche Abschreibungen machte.  Wir werden die Erwerbsprovision (durchschnittlich 2%), die Einlösungsprovision (4-10%) und andere Provisionen nicht berücksichtigen. <br><br>  Kann er erfolgreich Geld mit einer Karte auszahlen, die an ein Girokonto gebunden ist? <br><br>  In Wirklichkeit ist nicht alles so einfach.  <b>Geld wird dem Konto des Betrügers erst in wenigen Tagen gutgeschrieben!</b>  Während dieser Zeit sollte unser Betrüger hoffen, dass keines der 120 Opfer die Transaktion anfechten wird, was äußerst unwahrscheinlich ist.  In Wirklichkeit wird das Konto des Betrügers daher gesperrt, noch bevor ihm Geld gutgeschrieben wird. <br><br><blockquote>  <i>Wenn eine Person bemerkt, dass auf ihrer Karte ein Kauf getätigt wurde, den sie nicht getätigt hat, sollte sie sich an die ausstellende Bank wenden und eine Klage einreichen.</i>  <i>Es dauert bis zu 30 Tage, um umstrittene Operationen in Russland zu berücksichtigen, und bis zu 60 Tage für Transaktionen im Ausland.</i> <i>   -   -,   -     ,          .</i> <br><br> <b> ,           ()</b> <br></blockquote><br><h2>  Fazit </h2><br>      — 100 000.  ,      ,        ,   . <br><br>        999.99 , ,  ,         -.       . <br><br>     ,      .       -   ,  ,  ,  . ,   -      ,          ,        . <br><br>  20         ,   15%    .     ,       .        ,   .    ,        ,   , ,  . ,     ,     ,       ,         .  ,        10%   . <br><br><blockquote> ,   ,      ,         .    -   ,     . <br></blockquote><br><h2>  2 —  POS- </h2><br> ,            POS-.   ,       , ,   ,       . <br><br>   ,     ,       POS-.         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">EMV Contactless Specifications</a> ,           HydraNFC. <br><br>     EMV-  MasterCard PayPass  Visa payWave.        .     . <br><br><h2> NFC- </h2><br><img src="https://habrastorage.org/webt/bs/sx/oy/bssxoy5b-wmgyab33hakrihmfyc.png"><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">HydraNFC</a> —     ISO-14443A,    APDU-  SD-.       ,      . <br><br> → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  HydraBus   HydraNFC</a> <br> → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Ihr Browser unterstützt kein HTML5-Video. <source src="https://zhovner.com/forever/hydranfc_pos_terminal_sniff.mp4" type="video/mp4"></video></div></div></div><br> <i><font color="99999">    POS-    Apple Pay</font></i> <br><br>  ,  ,            .  POS-    VISA. ,    ,   ,    , . <br><br><h2>   EMV </h2><br>              142.98    Apple Pay: <br><br><div class="spoiler"> <b class="spoiler_title"> ,    ( )</b> <div class="spoiler_text"><a href=""><img width="200" src="https://habrastorage.org/webt/ia/by/xg/iabyxg1ocokwqruiq9ew3qmwqws.png"></a><br>
<i><font color="99999">      ()</font></i><br>
<br>
<b>R (READER)</b> — POS-<br>
<b>T (TAG)</b> —  (   )<br>
<code>R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
T&lt;&lt; 04 00<br>
R&gt;&gt; 93 20 <br>
T&lt;&lt; 08 fe e4 ec fe <br>
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e <br>
T&lt;&lt; 20 fc 70 <br>
R&gt;&gt; 50 00 57 cd <br>
R&gt;&gt; 26 <br>
R&gt;&gt; 52 <br>
T&lt;&lt; 04 00 <br>
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e <br>
T&lt;&lt; 20 fc 70 <br>
R&gt;&gt; e0 80 31 73 <br>
T&lt;&lt; 05 78 80 70 02 a5 46 <br>
R&gt;&gt; 02 00 a4 04 00 0e 32 50 41 59 2e 53 59 53 2e 44 44 46 30 31 00 e0 42 <br>
T&lt;&lt; 02 6f 23 84 0e 32 50 41 59 2e 53 59 53 2e 44 44 46 30 31 a5 11 bf 0c 0e 61 0c 4f 07 a0 00 00 00 03 10 10 87 01 01 90 00 4b b3 <br>
R&gt;&gt; 03 00 a4 04 00 07 a0 00 00 00 03 10 10 00 bc 41 <br>
T&lt;&lt; 03 6f 31 84 07 a0 00 00 00 03 10 10 a5 26 9f 38 18 9f 66 04 9f 02 06 9f 03 06 9f 1a 02 95 05 5f 2a 02 9a 03 9c 01 9f 37 04 bf 0c 08 9f 5a 05 60 08 40 06 43 90 00 1d 66 <br>
R&gt;&gt; 02 80 a8 00 00 23 83 21 36 a0 40 00 00 00 00 01 42 98 00 00 00 00 00 00 06 43 00 00 00 00 00 06 43 18 09 18 00 e0 11 01 03 00 f9 14 <br>
T&lt;&lt; 02 77 62 82 02 00 40 94 04 18 01 01 00 9f 36 02 02 06 9f 26 08 d6 f5 6b 8a be d7 8f 23 9f 10 20 1f 4a ff 32 a0 00 00 00 00 10 03 02 73 00 00 00 00 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9f 6c 02 00 80 57 13 48 00 99 72 50 51 17 56 d2 31 22 01 00 00 05 20 99 99 5f 9f 6e 04 23 88 00 00 9f 27 01 80 90 00 af c8 <br>
R&gt;&gt; 03 00 b2 01 1c 00 c9 05 <br>
T&lt;&lt; 03 70 37 5f 28 02 06 43 9f 07 02 c0 00 9f 19 06 04 00 10 03 02 73 5f 34 01 00 9f 24 1d 56 30 30 31 30 30 31 34 36 31 38 30 34 30 31 37 37 31 30 31 33 39 36 31 36 37 36 32 35 90 00 a7 7b <br>
</code><br>
</div></div><br>
        . <br>
<br>
<b>R&gt;&gt; — ,  POS- </b><br>
<b>T&gt;&gt; — ,   (     Apple Pay) </b><br>
<br>
<h3>14443-A Select</h3><br>
          .  ,       OSI,        L2,  UID (Unique Identifier)   MAC- . <br>
<br>
<blockquote>   ISO-14443:<br>
<b>PCD</b> (proximity coupling device) —  ,     POS-<br>
<b>PICC</b> (proximity integrated circuit card) — ,        <br>
</blockquote><br>
      Apple Pay  ,              .      ,     ,     ,     .        ,     ,     .<br>
<br>
<pre><code class="plaintext">R&gt;&gt; 52 // WUPA (wake up)<font></font>
R&gt;&gt; 52 // WUPA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
T&lt;&lt; 04 00 // ATQA (Answer To Request type A) <font></font>
R&gt;&gt; 93 20 // Select cascade 1 (Anti Collision CL1 SEL)<font></font>
T&lt;&lt; 08 fe e4 ec fe // UID (4 bytes) + BCC (Bit Count Check)<font></font>
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e // SEL (select tag 0x9370) + UID + CRC16<font></font>
T&lt;&lt; 20 fc 70  // SAK (Select Acknowledge 0x20) + CRC16 <font></font>
R&gt;&gt; 50 00 57 cd // HALT (Disable communocaion 0x5000) + CRC16<font></font>
R&gt;&gt; 26 // REQA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
T&lt;&lt; 04 00 // ATQA<font></font>
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e // SELECT<font></font>
T&lt;&lt; 20 fc 70 // SAK<font></font>
R&gt;&gt; e0 80 31 73 // RATS (Request Answer to Select 0xE080) + CRC16<font></font>
T&lt;&lt; 05 78 80 70 02 a5 46 // ATS (Answer to select response)<font></font>
</code></pre><br>
    <b>0x52</b> Wake-up (WUPA),        ,    Answer To Request type A (ATQA),     <b>0x04 0x00</b>.  ATQA       . <br>
<br>
  ATQA,     ,  ,        .  <b>0x93 0x20</b> Select cascade level 1 (SEL CL1)             UID.<br>
<br>
  <b>0x08 0xFE 0xE4 0xEC 0xFE</b>,    — UID   Apple Pay    <b>0xFE</b> Bit Count Check (BCC)  .<br>
<br>
  ,       <b>0x93 0x70</b> (SELECT).    UID  <b>0x08 0xfe 0xe4 0xec</b> + <b>0xfe</b> BCC + <b>0xdd 0x6e</b> CRC16.<br>
<br>
  <b>0x20</b> Select Acknowledge (SAK) + <b>0xfc 0x70</b> CRC16.<br>
<br>
       SAK,     UID   SELECT,     . ,   ,  POS-  ,      ,      .<br>
<br>
<blockquote> UID   4, 7  10 .    ,   ,      Apple Pay, UID   4 . ,  Apple Pay   UID   ,     ,  UID  . ,     ,         ,       UID     . <br>
</blockquote><br>
   <b>0x50 0x00</b> HALT + <b>0x57 0xcd</b> CRC16.    .<br>
<br>
   ,     (WUPA),     ,   SELECT.    —  , ,  -     .<br>
<br>
       <b>0xE0 0x80</b> Request Answer to Select (RATS) + <b>0x31 0x73 </b>CRC16.<br>
<br>
  <b>0x05 0x78 0x80 0x70 0x02</b> Answer to select response (ATS) + <b>0xA5 0x46</b> CRC16. <br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Answer to select</a></b> —   Answer To Reset (ATR)   .            . <br>
<br>
   «»  ,       ,    ,   .  SELECT       ISO 14443A,    NFC-,    ,  .. <br>
<br>
<h4>   — SELECT PPSE</h4><br>
<font color="grey"> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">EMV Contactless Specifications — PPSE and Application Management for Secure Element</a></font><br>
<br>
   EMV-     PPSE (Payment System Environment).    ,      . <br>
<br>
    ,     — VISA.       , ,          .        ,      ,    .       JCB  UnionPay.    . <br>
<br>
<b>APDU- SELECT PPSE</b><br>
<br>
<pre><code class="cpp">'00 A4 04 00 0E 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 00'<font></font>
  00 A4 04 00 //  select <font></font>
   0E //  command data (14 )<font></font>
    32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 // command data 2PAY.SYS.DDF01<font></font>
    00 //  <font></font>
</code></pre><br>
<b>  SELECT PPSE</b><br>
<br>
<pre><code class="cpp">'6F 23 84 0E 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 A5 11 BF 0C 0E 61 0C 4F 07 A0 00 00 00 03 10 10 87 01 01 90 00'</code></pre><br>
      -  TVL <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">iso8583.info/lib/EMV/TLVs</a>.   ,  :<br>
<br>
<img width="900" alt="EMV SELECT PPSE VISA RESPONE parsed" src="https://habrastorage.org/webt/yi/x_/_y/yix__y6me7kqdg9inwi05eyk1yq.png"><br>
         (AID).   ,   <b>A0000000031010</b>,  Visa International. <br>
<br>
AID   <b>4F</b>.       ,   .   ,   AID    5  16 ,      7 . <br>
<br>
  AID: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eftlab.co.uk/knowledge-base/211-emv-aid-rid-pix</a><br>
<br>
  AID<br>
<br>
<pre><code class="plaintext">A0000000031010 Visa International<font></font>
A0000000032020 Visa International<font></font>
A0000000041010 Mastercard International<font></font>
A0000000043060 Mastercard International United States Maestro (Debit)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anwendungsprioritätsanzeige - Zeigt die Priorität von Zahlungsanträgen an. </font><font style="vertical-align: inherit;">In Cobaging-Karten von MIR, in denen sich mehrere Zahlungsanwendungen befinden, gibt dieses Feld beispielsweise an, welche der beiden Anwendungen priorisiert ist. </font><font style="vertical-align: inherit;">Da wir nur einen Antrag von Visa International haben, weist dieser darauf hin und es gibt keine Priorität. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zahlungsanwendung starten - AID AUSWÄHLEN</font></font></b><br>
<br>
<pre><code class="cpp">'00 A4 04 00 07 A0 00 00 00 03 10 10'<font></font>
  00 A4 04 00 //  select <font></font>
   07 //  command data (7 )<font></font>
    A0 00 00 00 03 10 10 // AID Visa International<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem Sie die erforderliche Zahlungsanwendung ausgewählt haben, startet das Terminal sie. </font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PDOL (Verarbeitungsoptionen Datenobjektliste)</font></font></h4><br>
<pre><code class="cpp">'6f 31 84 07 a0 00 00 00 03 10 10 a5 26 9f 38 18 9f 66 04 9f 02 06 9f 03 06 9f 1a 02 95 05 5f 2a 02 9a 03 9c 01 9f 37 04 bf 0c 08 9f 5a 05 60 08 40 06 43 90 00'
</code></pre><br>
  <br>
<br>
<img src="https://habrastorage.org/webt/lo/jr/dh/lojrdhsptl6kkauc02a5c0qwnme.png"><br>
         ,      — PDOL (Processing Options Data Object List).         . <br>
<br>
PDOL     .    PDOL —  .    PDOL   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>.<br>
<br>
 PDOL . ,    —         .       .<br>
<br>
  PDOL:<br>
<br>
<pre><code class="cpp">9F 38 18 //   PDOL.  18 (24 ) <font></font>
 9F 66 ( 04) // Terminal Transaction Qualifiers (TTQ).    . <font></font>
  9F 02 ( 06) //  <font></font>
   9F 03 ( 06) //  <font></font>
   9F 1A ( 02) //     ISO3166-1<font></font>
   95 ( 05) // Terminal Verification Results<font></font>
    5F 2A ( 02) //  ,    ,   ISO4217<font></font>
     9A ( 03) //    YYMMDD<font></font>
      9C ( 01) //   <font></font>
       9F 37 ( 04) //   <font></font>
</code></pre><br>
            .<br>
<br>
<h4>    — GET PROCESSING OPTIONS </h4><br>
<pre><code class="cpp">'80A8000023832136A0400000000001429800000000000006430000000000064318091800E011010300'<font></font>
 80 A8 00 00 //  GET PROCESSING OPTIONS (GPO)<font></font>
  23 //    (35 )<font></font>
   83 //  PDOL-<font></font>
    21 //  PDOL- (33 )<font></font>
     36 A0 40 00 // Terminal Transaction Qualifiers (TTQ)<font></font>
      00 00 00 01 42 98 //   (142,98 )<font></font>
       00 00 00 00 00 00 //   <font></font>
        06 43 //    (643 - )<font></font>
         00 00 00 00 00 // Terminal Verification Results (TVR)<font></font>
          06 43 //  (643 - russian ruble) <font></font>
           18 09 18 //  (18  2018 )<font></font>
            00 //  <font></font>
             E0 11 01 03 //   <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Antwort zeigt deutlich, wie das in Russland befindliche Terminal eine Belastung von der Karte in Höhe von 142,98 Rubel beantragt. </font><font style="vertical-align: inherit;">Wir machen auf die Zufallszahl am Ende aufmerksam (E0110103). </font><font style="vertical-align: inherit;">Dies ist der Parameter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F37 Unvorhersehbare Nummer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dies ist die erste Erwähnung der Kryptographie. </font><font style="vertical-align: inherit;">In Zukunft muss diese Nummer zusammen mit den Transaktionsdaten die Karte mit einer kryptografischen Signatur signieren. </font><font style="vertical-align: inherit;">Dies gibt dem Terminal die Kontrolle über die Relevanz der Signatur von der Karte und schützt vor Wiederholungsangriffen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kartenantwort auf GET PROCESSING OPTIONS </font></font></h4><br>
<pre><code class="cpp">'7762820200409404180101009F360202069F2608D6F56B8ABED78F239F10201F4AFF32A00000000010030273000000004000000000000000000000000000009F6C02008057134800997250511756D23122010000052099995F9F6E04238800009F2701809000'
</code></pre><br>
      VISA  ,     c  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VISA Contactless Payment Specification (VCSP)</a>.<br>
<br>
<img width="600" src="https://habrastorage.org/webt/n-/b0/la/n-b0laaskytjo0ahyyvlo6e7js0.png"><br>
<br>
Application Interchange Profile (AIP) —      .    AIP  <b>00 40</b>.      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">EMV 4.3 Book 3</a>. <br>
<br>
<div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/rp/tc/ya/rptcyalvdwd6oaycintkbt02krq.png"></div><br>
        , ,    , Reserved For Future Use (RFU).   ,       Apple Pay,   .<br>
<br>
 AIP        (SDA,CDA,DDA) .          —   .<br>
<br>
Application File Locator (AFL) —      (SFI range of records)   AID.        READ RECORD.<br>
<br>
  AFL :<br>
<br>
Short File Identifier (SFI)  0x18.       .   0x18 (b00011000)   b00000011,   0x3.<br>
First record = 1<br>
Last record = 1<br>
..  «» №3    1  1,    .<br>
<br>
Application Transaction Counter (ATC) —   ,         GET PROCESSING OPTIONS.    0xFFFF  0x7FFF,    . ,          .    ,     Apple Pay     518 (0x206) .<br>
<br>
Application Cryptogram (AC) —  ,        .        -,       .       ( )   ,      .<br>
 <br>
Issuer Application Data (IAD) —   ,   VISA. <i><font color="99999">     , .</font></i><br>
<br>
Card Transaction Qualifiers (CTQ) —   VISA c   . ,            ,      .<br>
<br>
<img align="right" width="200" src="https://habrastorage.org/webt/vd/aw/ny/vdawnyz0tkkjbs-rradkbk0loiy.png">Track 2 Equivalent Data — <font color="red">!</font>        expiration date,      .<br>
<br>
Form Facto Indicator (FFI) —   VISA .  -    .    ,    .<br>
<br>
Cryptogram Information Data (CID) — <i><font color="99999">     , .</font></i><br>
<br>
<h4> READ DATA RECORD</h4><br>
<pre><code class="cpp">'00 b2 01 1c 00'
</code></pre><br>
     ,   AFL:<br>
<br>
<img src="https://habrastorage.org/webt/od/jw/mv/odjwmvemclc5gd4q6dhvlcmqfjy.png"><br>
  ,    <b>0x1C</b>     ,      0x18 (b000011),   SFI,      0x04 (d100),    .<br>
<br>
<h2>  READ RECORD</h2><br>
<pre><code class="cpp">'70375F280206439F0702C0009F19060400100302735F3401009F241D5630303130303134363138303430313737313031333936313637363235'
</code></pre><br>
<img src="https://habrastorage.org/webt/x9/ke/vv/x9kevvho_se85wg6vlgkwrd4jtw.png"><br>
<br>
Application Usage Control (AUC) — ,     ,    .<br>
<br>
<i><font color="99999">9F19 — - ,    —  Dynamic Data Authentication Data Object List (DDOL)</font></i><br>
<br>
EMV Tokenisation, Payment Account Reference (PAR) —    ()  . <i><font color="99999">     , .</font></i><br>
<br>
<h1>     ?</h1><br>
         Apple Pay c   VISA.  MasterCard  ,    .   ,    ,     replay-.<i><font color="99999">        Magnetic Stripe (MSD),      replay-,         ,  ,   ,      ,   .</font><br>
</i><br>
<img src="https://habrastorage.org/webt/ys/kk/8_/yskk8_eztdatvwiziqusnqsa2ee.png"><br>
<i><font color="99999">       (PAN)    (expiration date) </font></i><br>
<br>
 ,          expiration date.  CVV     ,         -.       ,      <b>  PAN   ,     !</b><br>
<br>
<h2>    CVV (CNP, MO/TO)</h2><br>
    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">« Apple Pay        »</a>     Apple Pay    , ,     10     .          ,    expiration date.    ,       .  ,   .<br>
<br>
<img src="https://habrastorage.org/webt/ue/-q/wt/ue-qwtah0au0uftojwdu8qsrs3m.png"><br>
<i><font color="99999">    Amazon   CVV</font></i><br>
<br>
    ,      ,    Apple Pay      Client Present (CP),      .             Card not present (CNP),      . - ! <br>
<br>
<font color="r">    , ,       Apple Pay         ,    .      5  .     :)<br>
<br>
<h2> Apple Pay   </h2><br>
<div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/jz/cn/2n/jzcn2ndu1pfw-znat4mxtab6k8k.png"></div><br>
<i><font color="99999">Apple Pay vs   </font></i><br>
<br>
<ul>
<li> <b>Apple Pay   (  )    .</b>            POS-.  , «»        ,       ,   ,     ,   ,   .  Apple Pay  ,            ,       .</li>
<li><b>     </b> —    Apple Pay      (13,56 ),   ,           .       .     Apple Pay     ,     .</li>
<li><b>       </b> —         Card not present (CNP),      ,    ..     Apple Pay    . </li>
<li><b>   </b> —        (Cardholder name)    .   ,   ,    .  Apple Pay    . </li>
</ul><br>
<h2></h2><br>
     .     ,         .         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a>.<br>
<br>
  , Apple Pay     .      CNP- (  )    ,         .<br>
<br>
<hr><br>
 :<br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unternehmen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tehpos.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für die Hardware.</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ural Bank für Wiederaufbau und Entwicklung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und persönlich an Alexander Paderin (Geschäftsführer des Informationssicherheitszentrums) für Konsultationen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speichern </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aj.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Bereitstellen iPhones zum Testen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Valeria </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aquamine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für Illustrationen zum Artikel.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gleb </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JRun</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von Digital Security für technische Beratung.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexander </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AlexGre</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für Konsultationen zum EMV-Protokoll.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Habrauser- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Form</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für einen hervorragenden EMV-Parser: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iso8583.info</font></font></a></li>
</ul></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de422551/">https://habr.com/ru/post/de422551/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de422541/index.html">Das Drama der Löcher in der Union verwandelte sich in eine Phantasmagorie</a></li>
<li><a href="../de422543/index.html">Denken Sie wie ein Programmierer. Tutorial zur Problemlösung</a></li>
<li><a href="../de422545/index.html">Möglichkeiten zum Synchronisieren von Browser-Registerkarten</a></li>
<li><a href="../de422547/index.html">Um Spectre und Meltdown zu eliminieren, müssen Sie möglicherweise einen völlig neuen Prozessortyp erstellen</a></li>
<li><a href="../de422549/index.html">Corda: Kotlin</a></li>
<li><a href="../de422553/index.html">Die offizielle Mega-Browser-Erweiterung stiehlt Dateifreigabedaten und Kryptowährung</a></li>
<li><a href="../de422555/index.html">Android-Multimodul-Architektur. Von A bis Z.</a></li>
<li><a href="../de422561/index.html">Wie Yandex Computer Vision einsetzte, um die Qualität von Videosendungen zu verbessern. DeepHD-Technologie</a></li>
<li><a href="../de422565/index.html">Skillbox Friday Webinars: Alles für Programmierer und Designer</a></li>
<li><a href="../de422569/index.html">Stündliche Zeiterfassungs-App</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>