<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚ÄçüöÄ üë®üèº‚Äç‚öñÔ∏è üç≠ Gerador de masmorra de n√≥ gr√°fico üë®üèª‚Äçüéì ‚ô¶Ô∏è üíáüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neste post, descreverei o algoritmo para gera√ß√£o procedural de n√≠veis de uma masmorra bidimensional com uma estrutura predeterminada. Na primeira part...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gerador de masmorra de n√≥ gr√°fico</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436198/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/pt/uh/r0/ptuhr0jo9giaq3dkb15uiqlfp30.png" alt="imagem"></div><br>  Neste post, descreverei o algoritmo para gera√ß√£o procedural de n√≠veis de uma masmorra bidimensional com uma estrutura predeterminada.  Na primeira parte, ser√° apresentada uma descri√ß√£o geral e, na segunda, a implementa√ß√£o do algoritmo. <br><br><h2>  1. Introdu√ß√£o </h2><br>  O algoritmo foi escrito como parte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">de um trabalho de bacharelado</a> e √© baseado em um artigo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ma et al (2014)</a> .  O objetivo do trabalho era acelerar o algoritmo e complement√°-lo com novas fun√ß√µes.  Estou muito feliz com o resultado, porque fizemos o algoritmo r√°pido o suficiente para us√°-lo durante a execu√ß√£o do jogo.  Depois de concluir o trabalho do bacharel, decidimos transform√°-lo em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um artigo</a> e envi√°-lo para a confer√™ncia Game-ON 2018. <br><br><h2>  Algoritmo </h2><br>  Para criar um n√≠vel de jogo, o algoritmo recebe como entrada um conjunto de blocos de constru√ß√£o poligonais e um gr√°fico de conectividade de n√≠vel (topologia de n√≠vel).  Os n√≥s do gr√°fico indicam as salas e as bordas determinam as conex√µes entre elas.  O objetivo do algoritmo √© atribuir a cada n√≥ do gr√°fico a forma e a localiza√ß√£o da sala, para que n√£o haja duas formas de divis√£o, e cada par de salas vizinhas possa ser conectado por portas. <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/41f/ed9/68f/41fed968fc3150ffb6285e660ff2ec5c.png"></div><br>  a) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/96a/68a/302/96a68a302c5af7bc046644a659f0cc81.png"></div><br>  b) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fc1/79e/c88/fc179ec88afc1fa1889937a2df25c029.png"></div><br>  c) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d9f/898/224/d9f8982240071dcb3d9205207912a46f.png"></div><br>  d) <br><br>  As figuras (c) e (d) mostram os diagramas gerados a partir do gr√°fico de entrada (a) e dos blocos de constru√ß√£o (b). <br><br>  Usando o gr√°fico de conectividade, um designer de jogos pode controlar facilmente o fluxo da jogabilidade.  Voc√™ precisa de um caminho comum para a sala dos chefes com v√°rios caminhos laterais opcionais?  Comece com o gr√°fico do caminho e especifique alguns n√≥s nos quais o jogador pode escolher: ou siga o caminho principal ou explore o caminho lateral, com poss√≠veis tesouros e / ou monstros esperando por ele.  Voc√™ precisa cortar o caminho?  Basta selecionar os dois n√≥s no gr√°fico e adicionar uma estrada curta conectando-os.  As possibilidades deste esquema s√£o infinitas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/619/044/41a/61904441a82fd281642664a0e784513d.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9fe/b4e/65e/9feb4e65e116328e42b3e9638911fae5.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/83c/fd9/d63/83cfd9d6388c784f88c818e7bc6c9513.png"></div><br>  <i>Exemplos de gr√°ficos de entrada.</i>  <i>O caminho principal √© mostrado em vermelho, os caminhos auxiliares s√£o azuis, o caminho curto √© laranja.</i> <br><br>  O algoritmo n√£o apenas permite que os designers de jogos gerenciem a estrutura de alto n√≠vel dos mapas gerados, mas tamb√©m fornece a capacidade de controlar a apar√™ncia de salas individuais e como conect√°-las umas √†s outras. <br><br><h3>  Formas diferentes para salas diferentes </h3><br>  Eu mencionei a sala dos chefes no final do n√≠vel.  N√£o queremos que a sala dos chefes pare√ßa com nenhuma outra sala comum, certo?  O algoritmo permite definir formul√°rios para cada sala.  Por exemplo, podemos criar uma sala no in√≠cio do n√≠vel e uma sala de chefe, que deve ter seus pr√≥prios conjuntos de formas de sala e um conjunto comum para todas as outras salas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e1f/988/e05/e1f988e05bf84eea4209c128ac0b9e60.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f97/b39/b15/f97b39b15661d51ad7cf3a30a4e9b80a.png"></div><br>  Dois circuitos gerados a partir do gr√°fico de entrada, nos quais uma forma especial de salas est√° associada ao n√∫mero da sala 8. <br><br><h3>  Posi√ß√µes explicitamente indicadas da porta </h3><br>  Imagine que voc√™ tenha um script de reuni√£o de chefia de alta qualidade e que precisamos que o jogador entre na sala do chefe a partir de um bloco espec√≠fico.  Ou podemos ter um modelo de sala em que alguns ladrilhos s√£o reservados para paredes e outros obst√°culos.  O algoritmo permite que os projetistas definam explicitamente poss√≠veis posi√ß√µes da porta para formatos de salas individuais. <br><br>  Mas, √†s vezes, o objetivo pode ser o oposto.  Podemos criar modelos de sala de forma que as portas para eles possam estar em quase qualquer lugar.  Devido a isso, impomos menos restri√ß√µes ao algoritmo; portanto, ele geralmente roda mais r√°pido, e os esquemas gerados podem parecer menos mon√≥tonos e mais org√¢nicos.  Para tais situa√ß√µes, √© poss√≠vel simplesmente indicar o comprimento das portas e a que dist√¢ncia elas devem estar dos cantos.  A dist√¢ncia dos cantos √© uma esp√©cie de compromisso entre o arranjo manual de todas as portas e a presen√ßa de portas em qualquer lugar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/13d/cf8/05f/13dcf805f54ce10ad637ce1c6e298b28.png"></div><br>  a) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7be/e9f/51e/7bee9f51e10cda43d07163e27f7ff1dd.png"></div><br>  b) <br><br>  A Figura (a) ilustra os diferentes tipos de localiza√ß√£o das portas - uma sala quadrada possui 8 posi√ß√µes de porta claramente definidas e uma sala retangular usa comprimento e dist√¢ncia dos cantos.  A Figura (b) mostra um diagrama simples gerado com as formas das salas na Figura (a). <br><br><h3>  Corredores entre quartos </h3><br>  Quando falamos sobre os n√≠veis das masmorras, muitas vezes imaginamos salas conectadas por corredores estreitos.  Gostaria de assumir que as conex√µes no gr√°fico de entrada indicam os corredores, mas n√£o s√£o.  Eles simplesmente garantem que todos os n√≥s vizinhos sejam conectados diretamente por portas.  Se queremos que as salas sejam conectadas por corredores, precisamos inserir um novo n√≥ entre todos os pares de salas vizinhas e fingir que essas s√£o salas de corredor (com certas formas de salas e posi√ß√µes de portas especificadas). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b59/56a/2b3/b5956a2b30f27882272fa44fe540f0bb.png"></div><br>  a) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbc/91d/b4e/fbc91db4e3beec215ad06cc7799cc56a.png"></div><br>  b) <br><br>  Uma ilustra√ß√£o de como podemos modificar o gr√°fico de entrada para adicionar corredores entre salas.  A figura (a) mostra o gr√°fico de entrada antes de adicionar as salas do corredor.  A Figura (b) mostra o gr√°fico de entrada criado a partir de (a) adicionando novas salas entre todas as salas adjacentes do gr√°fico original. <br><br>  Infelizmente, isso complica muito a tarefa do algoritmo, porque muitas vezes o n√∫mero de n√≥s dobra.  Portanto, implementei uma vers√£o do algoritmo que leva em considera√ß√£o os corredores, o que permite reduzir a diminui√ß√£o no desempenho ao organizar as salas dos corredores.  No momento, o algoritmo suporta corredores entre todas as salas ou a completa aus√™ncia de corredores, mas no futuro pretendo torn√°-lo mais flex√≠vel. <br><br><h2>  Exemplos </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b01/c4c/b17/b01c4cb173e0b315ce81c842a617e32c.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a2b/5a0/5aa/a2b5a05aa014d12b0fc70d23a540997d.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/305/5b7/de6/3055b7de654c62dc96c1e83ad510e199.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/80e/d9e/b26/80ed9eb26994f6b395e9fa2af34b6dce.png"></div><br>  <i>V√°rios esquemas gerados a partir de diferentes conjuntos de blocos de constru√ß√£o e com corredores ligados.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/738/8a4/a44/7388a4a4466fe32fc9b9975e71473936.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c1e/1ed/95b/c1e1ed95b4a9236c02fc11ed1bb33ed9.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/628/f19/025/628f19025acf78eed8aa199347804f9e.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa7/7e5/03d/aa77e503dbb791e78189777bc875e2cd.png"></div><br>  <i>V√°rios esquemas gerados a partir de diferentes conjuntos de blocos de constru√ß√£o com corredores ligados e desligados.</i> <br><br>  Na segunda parte do post, falarei sobre a opera√ß√£o interna do algoritmo. <br><br>  Tamb√©m estou trabalhando em um plugin do Unity para gera√ß√£o de masmorras procedurais, que incluir√° esse algoritmo.  Fa√ßo isso porque, apesar da possibilidade de usar esse algoritmo diretamente no Unity (est√° escrito em C #), a conveni√™ncia de trabalhar com ele est√° longe de ser ideal.  Leva muito tempo para criar modelos de sala sem uma GUI e √© necess√°rio muito c√≥digo para converter a sa√≠da do algoritmo na representa√ß√£o usada dentro do jogo. <br><br>  Como eu pr√≥prio n√£o sou desenvolvedor de jogos, meu objetivo √© tornar o plug-in suficientemente bom para que outras pessoas o usem.  Se tudo correr bem, tentarei publicar atualiza√ß√µes quando tiver algo interessante a dizer.  Eu j√° tenho algumas id√©ias sobre o gerador em si e sobre o teste de seus recursos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d12/43f/2c0/d1243f2c05e18826eb3d97a30b6f743c.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7ed/34f/05c/7ed34f05ca19aa127aae0938e26d63ec.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad4/d48/39f/ad4d4839f9ca1c333c2fbb3e0333989e.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c0e/805/121/c0e805121b2cda153980875d780d5f9b.png"></div><br>  <i>Capturas de tela do plugin Unity (o projeto est√° em desenvolvimento)</i> <br><br><h2>  Parte 2. Implementa√ß√£o do algoritmo </h2><br>  Nesta parte, falarei sobre as id√©ias b√°sicas estabelecidas na base do algoritmo descrito na primeira parte do post.  Inicialmente, eu queria descrever os conceitos b√°sicos, juntamente com as principais melhorias necess√°rias para que o algoritmo fosse r√°pido o suficiente.  No entanto, como se viu, mesmo os conceitos b√°sicos s√£o mais que suficientes para este post.  Portanto, decidi revelar melhorias de desempenho em um artigo futuro. <br><br><h2>  Motiva√ß√£o </h2><br>  Antes de prosseguir para a implementa√ß√£o, quero mostrar o resultado do que faremos.  O v√≠deo abaixo mostra 30 circuitos diferentes gerados a partir de um gr√°fico de entrada e de um conjunto de blocos de constru√ß√£o.  O algoritmo sempre para por 500 ms ap√≥s a gera√ß√£o do circuito e, em seguida, tenta gerar o pr√≥ximo. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Seu navegador n√£o suporta v√≠deo HTML5. <source src="https://ondra.nepozitek.cz/blog/wp-content/uploads/2019/01/GeneratorWindow-12_01_2019-23_48_40.mp4" type="video/mp4"></video></div></div></div><br><h2>  Como isso funciona </h2><br>  O objetivo do algoritmo √© atribuir a forma e a posi√ß√£o da sala a cada n√≥ no gr√°fico, de modo que n√£o haja duas salas que se cruzem e as salas vizinhas sejam conectadas por portas. <br><br>  Uma maneira de conseguir isso √© tentar todas as combina√ß√µes poss√≠veis de formas de salas e suas posi√ß√µes.  No entanto, como voc√™ pode imaginar, isso ser√° muito ineficiente e provavelmente n√£o conseguiremos gerar circuitos, mesmo com base em gr√°ficos de entrada muito simples. <br><br>  Em vez de procurar todas as combina√ß√µes poss√≠veis, o algoritmo calcula como conectar corretamente todas as salas individuais (os chamados espa√ßos de configura√ß√£o) e usa essas informa√ß√µes para direcionar a pesquisa.  Infelizmente, mesmo com essas informa√ß√µes, ainda √© bastante dif√≠cil encontrar o esquema certo.  Portanto, para um estudo efetivo do espa√ßo de pesquisa, usamos uma t√©cnica de otimiza√ß√£o probabil√≠stica (neste caso, simula√ß√£o de recozimento).  E para acelerar ainda mais a otimiza√ß√£o, dividimos a tarefa de entrada em subtarefas menores e mais f√°ceis de resolver.  Isso √© feito dividindo o gr√°fico em partes menores (chamadas cadeias) com a cria√ß√£o subsequente de esquemas para cada uma delas em ordem. <br><br><h2>  Espa√ßos de configura√ß√£o </h2><br>  Para um par de pol√≠gonos em que um √© fixado no lugar e o outro pode se mover livremente, o espa√ßo de configura√ß√£o √© o conjunto de posi√ß√µes de um pol√≠gono livre no qual dois pol√≠gonos n√£o se cruzam e podem ser conectados por portas.  Ao trabalhar com pol√≠gonos, cada espa√ßo de configura√ß√£o pode ser representado como um conjunto de linhas possivelmente vazio e calculado por ferramentas geom√©tricas simples. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/134/823/45e/13482345ed98c982677a10e53ddaec2d.png"></div><br>  a) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b8c/1eb/62c/b8c1eb62c2f6d8f166670781dfe35336.png"></div><br>  b) <br><br>  Configura√ß√µes de espa√ßo.  A Figura (a) mostra o espa√ßo de configura√ß√£o (linhas vermelhas) de um ret√¢ngulo livre em rela√ß√£o a um pol√≠gono fixo em forma de L.  Ele determina todos os locais do centro da pra√ßa em que os dois blocos n√£o se cruzam e se tocam.  A Figura (b) mostra a interse√ß√£o (pontos amarelos) dos espa√ßos de configura√ß√£o de um quadrado m√≥vel em rela√ß√£o a dois ret√¢ngulos fixos. <br><br>  O algoritmo a seguir √© usado para calcular o espa√ßo de configura√ß√£o de um bloco fixo e um bloco livre.  Selecionamos um ponto de refer√™ncia no bloco m√≥vel e consideramos todos os locais no <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>R</mi></mrow><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.843ex" height="2.539ex" viewBox="0 -987.6 4668.4 1093.4" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-62" x="3025" y="0"></use><g transform="translate(3455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMAIN-32" x="1074" y="581"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msup><mrow class="MJX-TeXAtom-ORD"><mi>R</mi></mrow><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ mathbb {R} ^ 2 </script>  , de modo que, ao mover o pol√≠gono para que seu ponto de refer√™ncia esteja localizado nesse local, os blocos m√≥veis e os blocos fixos se tocam, mas n√£o se cruzam.  O conjunto de todos esses pontos forma o espa√ßo de configura√ß√£o de dois blocos (Figura (a) acima).  Para obter o espa√ßo das configura√ß√µes do bloco m√≥vel em rela√ß√£o a dois ou mais blocos fixos, √© calculada a interse√ß√£o dos espa√ßos de configura√ß√£o individuais (Figura (b) acima). <br><br>  O algoritmo usa espa√ßos de configura√ß√£o de duas maneiras.  Primeiro, em vez de tentar as posi√ß√µes aleat√≥rias de salas individuais, usamos espa√ßos de configura√ß√£o para procurar posi√ß√µes que levam ao maior n√∫mero poss√≠vel de salas adjacentes conectadas pelas portas.  Para fazer isso, precisamos obter a interse√ß√£o n√£o vazia m√°xima dos espa√ßos de configura√ß√£o dos vizinhos.  Em segundo lugar, usamos espa√ßos de configura√ß√£o para verificar se todos os pares de salas vizinhas podem ser conectados com portas.  Isso √© feito verificando se a posi√ß√£o da sala est√° dentro do espa√ßo de configura√ß√£o de todos os seus vizinhos. <br><br>  Como as formas das salas n√£o mudam durante a execu√ß√£o do jogo, podemos pr√©-calcular os espa√ßos de configura√ß√£o de todos os pares de formas de salas antes do in√≠cio do algoritmo.  Gra√ßas a isso, todo o algoritmo √© significativamente acelerado. <br><br><h2>  Esquema incremental </h2><br>  Ao resolver um problema complexo, uma das abordagens poss√≠veis √© dividi-lo em subtarefas menores e mais simples e resolv√™-las.  √â exatamente isso que faremos com a tarefa de colocar quartos individuais.  Em vez de organizar todas as salas de uma vez, dividimos o gr√°fico de entrada em subgr√°ficos menores e tentamos criar diagramas a partir deles, um por um.  Os autores do algoritmo original chamam esses subgr√°ficos de "cadeias" por causa do pr√≥prio princ√≠pio desses gr√°ficos, em que cada n√≥ n√£o tem mais que dois vizinhos e, portanto, √© bastante simples criar seu esquema. <br><br>  O circuito de sa√≠da final √© sempre um componente conectado; portanto, n√£o faz sentido conectar os componentes individuais ao circuito e tentar combin√°-los, porque o processo de combina√ß√£o pode ser bastante complicado.  Portanto, ap√≥s a coloca√ß√£o da corrente, a pr√≥xima corrente conectada ser√° sempre aquela que estiver conectada aos v√©rtices j√° alinhados no circuito. <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-function">Layout </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateLayout</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">inputGraph</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> emptyLayout = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Layout(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stack = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Stack&lt;Layout&gt;(); stack.Push(emptyLayout); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!stack.Empty()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> layout = stack.Pop(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> nextChain = GetNextChain(layout, inputGraph); Layout[] partialLayouts = AddChain(layout, nextChain); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!partialLayouts.Empty()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (IsFullLayout(partialLayouts[<span class="hljs-number"><span class="hljs-number">0</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> partialLayouts[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { stack.Push(partialLayouts); } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br>  <i>Pseudo-c√≥digo mostrando uma abordagem incremental para encontrar o esquema certo.</i> <br><br>  O pseudo-c√≥digo mostrado acima demonstra a implementa√ß√£o de um esquema incremental.  A cada itera√ß√£o do algoritmo (linhas 6-18), primeiro pegamos o √∫ltimo circuito da pilha (linha 7) e calculamos qual cadeia adicionar em seguida (linha 8).  Isso pode ser feito simplesmente armazenando o n√∫mero do √∫ltimo circuito adicionado a cada circuito parcial.  No pr√≥ximo passo, adicionamos a seguinte cadeia ao circuito (linha 9), gerando v√°rios circuitos detalhados e os salvamos.  Se a fase de expans√£o falhar, mas nenhum novo esquema parcial for adicionado √† pilha, e o algoritmo precisar√° continuar com o √∫ltimo esquema parcial salvo.  Chamamos essa situa√ß√£o de pesquisa de retorno porque o algoritmo n√£o pode estender o esquema parcial atual e deve voltar e continuar com outro esquema salvo.  Isso geralmente √© necess√°rio quando n√£o h√° espa√ßo suficiente para conectar circuitos adicionais aos v√©rtices j√° compostos no circuito.  Al√©m disso, uma pesquisa de retorno √© o motivo pelo qual sempre tentamos gerar v√°rios esquemas avan√ßados (linha 9).  Caso contr√°rio, n√£o ter√≠amos nada para retornar.  O processo termina quando geramos um circuito completo ou a pilha est√° vazia. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/90e/909/ca4/90e909ca4640401cf869e4ad2e558d32.png"></div><br>  a) Gr√°fico de entrada <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8ca/736/f69/8ca736f69ce1ba31910d12c49f0546a4.png"></div><br>  b) Diagrama parcial <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d0e/74f/284/d0e74f2846ea5cdd8351bd1a20561704.png"></div><br>  c) Diagrama parcial <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2c4/708/d35/2c4708d351e2b4a13a98cffa9a090a58.png"></div><br>  (d) Descri√ß√£o completa <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b3b/13b/796/b3b13b796d79dd8587d23d82cee6da52.png"></div><br>  (e) Descri√ß√£o completa <br><br>  Esquema incremental.  As figuras (b) e (c) mostram dois diagramas parciais ap√≥s o planejamento do primeiro circuito.  A figura (d) mostra o circuito completo ap√≥s a expans√£o (b) por um segundo circuito.  A figura (e) mostra o circuito completo ap√≥s a expans√£o (c) por um segundo circuito. <br><br>  Para dividir o gr√°fico em partes, √© necess√°rio encontrar uma incorpora√ß√£o plana do gr√°fico de entrada, ou seja, um desenho no plano no qual as arestas se cruzam apenas nos pontos finais.  Esse anexo √© usado para obter todas as faces do gr√°fico.  A id√©ia principal da decomposi√ß√£o √© que √© mais dif√≠cil criar um circuito a partir de ciclos, porque seus n√≥s t√™m mais restri√ß√µes.  Portanto, estamos tentando organizar os ciclos no in√≠cio da decomposi√ß√£o, para que sejam processados ‚Äã‚Äão mais cedo poss√≠vel e reduza a probabilidade da necessidade de voltar nos est√°gios subsequentes.  A primeira cadeia de decomposi√ß√£o √© formada pela menor face do anexo e as faces subsequentes s√£o adicionadas na ordem da primeira pesquisa de largura.  Se houver outras faces que possam ser selecionadas, a menor delas ser√° usada.  Quando n√£o h√° faces restantes, os componentes n√£o c√≠clicos restantes s√£o adicionados.  A Figura 4 mostra um exemplo de decomposi√ß√£o em uma cadeia, que foi obtida de acordo com estas etapas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e0f/c57/c57/e0fc57c571633c5f70b818c412e8d80c.png"></div><br>  a) <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4bb/02c/950/4bb02c950ef9309be5df082e0c630ec3.png"></div><br>  b) <br><br>  Decomposi√ß√£o em cadeias.  A figura (b) mostra um exemplo de como colocar a figura (a) em um circuito.  Cada cor representa uma cadeia separada.  Os n√∫meros indicam a ordem em que as cadeias s√£o criadas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f0c/ad3/554/f0cad3554aa63d7cc46e5d9dae334209.png"></div><br>  c) Bom design parcial <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d00/839/114/d0083911404026fa33a26f529d1db1a0.png"></div>  (d) Descri√ß√£o completa <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b27/f99/ed2/b27f99ed239d73e25a14e3f785ba5bd2.png"></div><br>  a) Gr√°fico de entrada <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/85c/60c/13b/85c60c13b6479b643855f71f5138f738.png"></div><br>  b) Gr√°fico parcial incorreto <br><br>  Pesquise com retorno.  A Figura (b) mostra um exemplo de um circuito parcial ruim, porque n√£o h√° espa√ßo suficiente para conectar os n√≥s 0 e 9. Para gerar o circuito completo (d), √© necess√°rio um retorno a outro circuito parcial (c). <br><br><h2>  Recozimento simulado </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O algoritmo de simula√ß√£o de recozimento</a> √© uma t√©cnica de otimiza√ß√£o probabil√≠stica cujo objetivo √© estudar o espa√ßo de poss√≠veis circuitos.  Foi escolhido pelos autores do artigo original por se mostrar √∫til em situa√ß√µes semelhantes no passado.  Ao implementar o algoritmo, decidi usar o mesmo m√©todo, porque queria come√ßar com o que j√° provou sua efic√°cia na solu√ß√£o desse problema.  No entanto, acho que ele pode ser substitu√≠do por outro m√©todo e minha biblioteca √© escrita de tal maneira que o processo de substitui√ß√£o do m√©todo √© bastante simples. <br><br>  O algoritmo de simula√ß√£o de recozimento avalia iterativamente pequenas altera√ß√µes na configura√ß√£o atual ou no circuito.  Isso significa que criamos uma nova configura√ß√£o selecionando aleatoriamente um n√≥ e alterando sua posi√ß√£o ou forma.  Se a nova configura√ß√£o melhorar a fun√ß√£o de energia, ela sempre ser√° aceita.  Caso contr√°rio, h√° pouca chance de aceitar a configura√ß√£o de qualquer maneira.  A probabilidade de tomar decis√µes piores diminui com o tempo.  A fun√ß√£o de energia √© projetada de maneira a impor grandes multas aos n√≥s que se cruzam e aos n√≥s adjacentes que n√£o se tocam. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>E</mi><mo>=</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>A</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><mi>a</mi></mrow></mrow></msup><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><mi>a</mi></mrow></mrow></msup><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.209ex" height="2.66ex" viewBox="0 -987.6 13867.5 1145.2" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-45" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMAIN-3D" x="1042" y="0"></use><g transform="translate(2098,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-66" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-72" x="904" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-61" x="1355" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-63" x="1885" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-41" x="2318" y="0"></use><g transform="translate(2170,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-6F" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-6D" x="839" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-65" x="1717" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-67" x="2184" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-61" x="2664" y="0"></use></g></g></g><g transform="translate(7093,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-66" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-72" x="904" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-61" x="1355" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-63" x="1885" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-44" x="2318" y="0"></use><g transform="translate(2225,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-6F" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-6D" x="839" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-65" x="1717" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-67" x="2184" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-61" x="2664" y="0"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMAIN-2212" x="12366" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMAIN-31" x="13367" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>E</mi><mo>=</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>A</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><mi>a</mi></mrow></mrow></msup><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>D</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><mi>a</mi></mrow></mrow></msup><mo>‚àí</mo><mn>1</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> E = e ^ {\ frac {A} {\ omega}} e ^ {\ frac {D} {\ omega}} - 1 </script></p><br>  A √© a √°rea total de interse√ß√£o entre todos os pares de blocos no diagrama.  D √© a soma dos quadrados das dist√¢ncias entre os centros dos pares de blocos no gr√°fico de entrada que s√£o vizinhos, mas n√£o se tocam.  Valor <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.178ex" height="1.817ex" viewBox="0 -520.7 3090.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-6F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-6D" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-65" x="1614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-67" x="2080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/436198/&amp;usg=ALkJrhjKGodOWVutxZcEckpdUgP0S0wiWg#MJMATHI-61" x="2561" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> \ omega </script>  afeta a probabilidade de que o recozimento simulado possa ir para a pior configura√ß√£o;  esse par√¢metro √© calculado a partir da √°rea m√©dia dos blocos de constru√ß√£o. <br><br>  Depois de selecionar um n√≥ para alterar, alteramos sua forma ou posi√ß√£o.  Como escolhemos uma nova posi√ß√£o?  Voc√™ pode escolh√™-lo aleatoriamente, mas isso frequentemente degradar√° a fun√ß√£o de energia e o algoritmo convergir√° muito lentamente.  Podemos escolher uma posi√ß√£o com maior probabilidade de aumentar a fun√ß√£o de energia?  Veja o que estou levando?  Usamos espa√ßos de configura√ß√£o para selecionar uma posi√ß√£o que satisfa√ßa os limites do maior n√∫mero de salas vizinhas. <br><br>  Em seguida, para alterar a forma, basta selecionar uma das formas de sala dispon√≠veis.  Embora o algoritmo n√£o tente decidir qual formul√°rio provavelmente nos levar√° ao esquema correto.  No entanto, seria interessante tentar esse recurso e ver se ele acelera o algoritmo. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">List&lt;Layout&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddChain</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">chain, layout</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> currentLayout = GetInitialLayout(layout, chain); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> generatedLayouts = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Layout&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= n, i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-comment"><span class="hljs-comment">/*       */</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">1</span></span>; j &lt;= m, j++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newLayout = PerturbLayout(currentLayout, chain); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (IsValid(newLayout)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DifferentEnough(newLayout, generatedLayouts)) { generatedLayouts.Add(newLayout); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-comment"><span class="hljs-comment">/* newLayout ,  currentLayout */</span></span>) { currentLayout = newLayout; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-comment"><span class="hljs-comment">/* ,   ,    newLayout */</span></span>) { currentLayout = newLayout; } } <span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> generatedLayouts; }</code> </pre> <br>  Este √© o pseudo-c√≥digo do m√©todo respons√°vel pela cria√ß√£o de um circuito de circuito separado, simulando o recozimento. <br><br>  Para acelerar todo o processo, tentaremos encontrar a configura√ß√£o inicial de baixa energia.  Para fazer isso, organizaremos os n√≥s na cadeia atual para uma pesquisa abrangente, come√ßando por aqueles que s√£o adjacentes aos n√≥s j√° inclu√≠dos no esquema.  Em seguida, os n√≥s ordenados s√£o colocados um de cada vez e, para eles, a posi√ß√£o com a menor energia √© selecionada no espa√ßo de configura√ß√£o.  Aqui n√£o estamos fazendo nenhum retorno - este √© um processo simples e ganancioso. <br><br><h2>  V√≠deo b√¥nus </h2><br>  O v√≠deo abaixo mostra os diagramas gerados a partir do mesmo gr√°fico de entrada que no primeiro v√≠deo.  No entanto, desta vez, uma abordagem incremental √© mostrada.  Voc√™ pode perceber que o algoritmo adiciona cadeias de n√≥s, uma de cada vez.  Tamb√©m √© visto que, √†s vezes, existem dois circuitos parciais consecutivos com o mesmo n√∫mero de n√≥s.  Isso acontece quando o algoritmo retorna.  Se a primeira tentativa de adicionar outro circuito √† primeira falha parcial do circuito, o algoritmo tentar√° outro circuito parcial. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Seu navegador n√£o suporta v√≠deo HTML5. <source src="https://ondra.nepozitek.cz/blog/wp-content/uploads/2019/01/GeneratorWindow-13_01_2019-23_23_30.mp4" type="video/mp4"></video></div></div></div><br><h2>  Materiais para download </h2><br>  A implementa√ß√£o do algoritmo no .NET pode ser encontrada no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">meu github</a> .  O reposit√≥rio cont√©m a DLL .NET e o aplicativo WinForms GUI, controlado pelos arquivos de configura√ß√£o YAML. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt436198/">https://habr.com/ru/post/pt436198/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt436186/index.html">O que pensar durante a entrevista do NALSD</a></li>
<li><a href="../pt436188/index.html">Liberdade para voar ao seu alcance com o DJI Smart Controller</a></li>
<li><a href="../pt436192/index.html">Simula√ß√£o do navegador de f√≠sica</a></li>
<li><a href="../pt436194/index.html">Como o sistema de vigil√¢ncia por v√≠deo Ivideon funciona: vis√£o geral do aplicativo m√≥vel</a></li>
<li><a href="../pt436196/index.html">Testador de voyeurismo: como espionar as pessoas corretamente e por que √© necess√°rio</a></li>
<li><a href="../pt436200/index.html">Decis√£o judicial dos EUA: as autoridades n√£o t√™m o direito de for√ßar uma pessoa a desbloquear o telefone com um dedo ou rosto</a></li>
<li><a href="../pt436202/index.html">Perdi a f√© no desenvolvimento, queimei-me, mas o culto √† ferramenta me salvou</a></li>
<li><a href="../pt436206/index.html">Como unir arte sem dor com Java, JavaScript e gr√°ficos ou a hist√≥ria por tr√°s da cria√ß√£o de uma produ√ß√£o interativa de teatro</a></li>
<li><a href="../pt436208/index.html">Novos torrents n√£o aparecem mais no The Pirate Bay</a></li>
<li><a href="../pt436210/index.html">Biquaternions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>