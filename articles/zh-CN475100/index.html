<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘§ğŸ¾ ğŸ§œğŸ¿ ğŸ™ å¦‚ä½•ä½¿ç”¨åŠ å¯†è´§å¸åˆ›å»ºâ€œå…¬å…±ç‰©å“â€è€Œä¸ç»™æŠ•èµ„è€…å¸¦æ¥é£é™© ğŸ‘¨ğŸ¿â€ğŸ¨ â—½ï¸ ğŸ™ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è®¨è®ºä»€ä¹ˆæ˜¯ä¿è¯åˆåŒï¼Œä¹Ÿè¢«ç§°ä¸ºæä¾›å…¬å…±åˆ©ç›Šå’Œå›¢ä½“åˆ©ç›Šçš„æœºåˆ¶ï¼Œæˆ‘ä»¬å°†å…±åŒåœ¨Obyteå¹³å°ä¸Šç¼–å†™åŸºäºè‡ªä¸»ä»£ç†çš„ä¼—ç­¹å®æ–½æ–¹æ¡ˆã€‚ 

 ä¿è¯åˆåŒæ˜¯ä¸€ç§ç”¨äºåˆ›å»ºæ–°å…¬å…±ç‰©å“çš„æœ‰ç»„ç»‡çš„ç­¹æ¬¾æœºåˆ¶ã€‚ ä½¿ç”¨æ­¤ç±»åˆåŒçš„ä¸€ä¸ªå…¸å‹ç¤ºä¾‹å¯èƒ½æ˜¯ä»¥ä¸‹æƒ…å†µï¼šå¤å­£åˆä½œç¤¾çš„å‚ä¸è€…å†³å®šä¿®å»ºä¸€æ¡é“è·¯ï¼Œä»¥æ–¹ä¾¿å‰å¾€å¤å­£å°å±‹ã€‚ ä¸ºæ­¤ï¼Œ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å¦‚ä½•ä½¿ç”¨åŠ å¯†è´§å¸åˆ›å»ºâ€œå…¬å…±ç‰©å“â€è€Œä¸ç»™æŠ•èµ„è€…å¸¦æ¥é£é™©</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/obyte/blog/475100/"><img src="https://habrastorage.org/webt/0w/dj/zj/0wdjzjdbzig68hpnpunqbd6nsao.gif"><br><br> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è®¨è®ºä»€ä¹ˆæ˜¯ä¿è¯åˆåŒï¼Œä¹Ÿè¢«ç§°ä¸ºæä¾›å…¬å…±åˆ©ç›Šå’Œå›¢ä½“åˆ©ç›Šçš„æœºåˆ¶ï¼Œæˆ‘ä»¬å°†å…±åŒåœ¨Obyteå¹³å°ä¸Šç¼–å†™åŸºäºè‡ªä¸»ä»£ç†çš„ä¼—ç­¹å®æ–½æ–¹æ¡ˆã€‚ <br><a name="habracut"></a><br> ä¿è¯åˆåŒæ˜¯ä¸€ç§ç”¨äºåˆ›å»ºæ–°å…¬å…±ç‰©å“çš„æœ‰ç»„ç»‡çš„ç­¹æ¬¾æœºåˆ¶ã€‚ ä½¿ç”¨æ­¤ç±»åˆåŒçš„ä¸€ä¸ªå…¸å‹ç¤ºä¾‹å¯èƒ½æ˜¯ä»¥ä¸‹æƒ…å†µï¼šå¤å­£åˆä½œç¤¾çš„å‚ä¸è€…å†³å®šä¿®å»ºä¸€æ¡é“è·¯ï¼Œä»¥æ–¹ä¾¿å‰å¾€å¤å­£å°å±‹ã€‚ ä¸ºæ­¤ï¼Œæ”¶é›†é‡‘é¢Nå¹¶å°†å…¶è½¬ç§»ç»™æ‰¿åŒ…å•†ä»¥ä¿®å»ºé“è·¯ã€‚ å‡ºç°äº†è®¸å¤šé—®é¢˜ï¼šåœ¨å“ªé‡Œæ‰¾åˆ°ä¸€ä¸ªæ¯ä¸ªäººéƒ½ä¼šä¿¡ä»»å¹¶æ”¶è´¹çš„äººï¼›å¦‚ä½•ä½¿é“è·¯çš„æ‰€æœ‰æ½œåœ¨ç”¨æˆ·æŠ•èµ„äºé“è·¯å»ºè®¾ï¼›å¦‚æœæ”¶é›†åˆ°çš„é’±ä¸è¶³ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ <br><br> ä¿è¯åˆåŒçš„å«ä¹‰ä¸ä¼—ç­¹éå¸¸ç›¸ä¼¼ï¼Œåªæœ‰æŠ•èµ„è€…æ²¡æœ‰é£é™©ï¼Œå°±åƒæŠ•èµ„é£é™©ä¼ä¸šçš„æŠ•èµ„è€…ä¸€æ ·ã€‚ è¿™æ ·çš„åˆåŒä»¥åŠä¼—ç­¹ä¹Ÿå¯ä»¥æœ‰ä¸¤ä¸ªç»“æœ-æˆåŠŸå’Œä¸æˆåŠŸï¼Œè¿™å–å†³äºæ‰€æ”¶é›†é‡‘é¢ç›®æ ‡çš„å®ç°ã€‚ æˆåŠŸæ”¶æ¬¾çš„ç»“æœå°†æ˜¯æŠ•èµ„è€…ï¼ˆä½†æœ‰æ—¶ä¸ä»…æ˜¯æŠ•èµ„è€…ï¼‰æ”¶åˆ°ä¸€ç§æ–°çš„å…¬å…±ç‰©å“ã€‚ ä¸‡ä¸€å‘ç”Ÿæ•…éšœï¼Œé’±åªä¼šé€€è¿˜ç»™å‚¨æˆ·ã€‚ <br><br> å› æ­¤ï¼Œå¯¹äºåˆå­¦è€…ï¼Œæˆ‘ä»¬é‡å¤ä¸€ä¸‹åŸºæœ¬æ¡ä»¶ã€‚ ä¼—ç­¹çš„æœ¬è´¨æ˜¯ä»¥ç»™å®šçš„æœ€ç»ˆé‡‘é¢ï¼ˆä¸ä¸€å®šæ˜¯å›ºå®šçš„ï¼Œå¯ä»¥æ˜¯åŠ¨æ€çš„ï¼‰å’Œç»“æŸæ—¥æœŸï¼ˆä¹Ÿå¹¶éæ€»æ˜¯ï¼Œä½†æ˜¯é€šå¸¸ï¼‰ä¸ºé¢„å®šç›®æ ‡â€œåœ¨äººç¾¤ä¸­â€ç­¹é›†èµ„é‡‘ã€‚ å½“è¾¾åˆ°æ­¤é‡‘é¢æ—¶ï¼Œå°±è®¤ä¸ºè¯¥è½®èèµ„æˆåŠŸå¹¶ä¸”åœæ­¢äº†ç­¹æ¬¾ï¼Œæ‰€æœ‰èµ„é‡‘éƒ½è¢«åˆ†é…ç”¨äºå®ç°ç›®æ ‡ã€‚ ä¸‡ä¸€å¤±è´¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æˆªæ­¢æ—¥æœŸå‰ä¸”ç­¹é›†çš„èµ„é‡‘ä¸è¶³ï¼Œæ‰€æœ‰èµ„é‡‘å°†é€€è¿˜ç»™æåŠ©è€…ã€‚ <br><br> åŠ å¯†è´§å¸ä¼—ç­¹è§£å†³äº†å“ªäº›é—®é¢˜ï¼Ÿ é¦–å…ˆï¼Œå®ƒä½¿æŠ•èµ„è€…ä¸å¿…ä¿¡ä»»å’ŒéªŒè¯æ±‡æ¬¾äººã€‚ è‡ªä¸»å‹Ÿé›†ä»£ç†çš„ä»£ç æ˜¯å…¬å¼€çš„ï¼Œæ¯ä¸ªæŠ•èµ„è€…éƒ½å¯ä»¥ç¡®ä¿è‡ªå·±å¯ä»¥éšæ—¶æå–ææ¬¾ï¼Œç›´åˆ°è¾¾åˆ°æœ€ç»ˆé‡‘é¢ï¼Œè€Œä¸”æ‰€æœ‰èµ„é‡‘éƒ½å°†è¢«å‘é€åˆ°é¢„å…ˆé€‰å®šçš„åœ°å€ä»¥åˆ›å»ºå•†å“ã€‚ å…¶æ¬¡ï¼Œå¯¹æ‰€æœ‰ç­¹é›†èµ„é‡‘çš„é€æ˜æ ¸ç®—æœ‰åŠ©äºæŒ‰ç›®æ ‡å®ç°æ‰€åˆ†é…çš„è´¡çŒ®æ¥åˆ†é…å®ç°ç›®æ ‡çš„æœªæ¥æ”¶ç›Šã€‚ <br><br> ä¿è¯åˆåŒå¯ä»¥è§£å†³çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯åè°ƒé—®é¢˜ã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬å°†è¡¥å……æœ‰å…³<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¸¸æˆâ€œ Attack 51ï¼…â€çš„</a>ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°†è§£å†³æ­¤é—®é¢˜ã€‚ å¦‚æœä¸ä½¿ç”¨AAï¼Œæ¸¸æˆä¸­çš„å‚ä¸è€…å°†ç”±äºç¼ºä¹åè°ƒè€Œå¤„äºâ€œç¼ºä¹â€æ‰€æ”¶é›†é‡‘é¢çš„é£é™©ä¸­ã€‚ ç„¶åï¼Œé‚£äº›å·²ç»æˆåŠŸè¿›è¡ŒæŠ•èµ„çš„äººåªä¼šå› ä¸ºå…¶ä»–å‚ä¸è€…æ²¡æœ‰è¡¨ç°å‡ºå…´è¶£ï¼Œæˆ–è€…åªæ˜¯æ²¡æœ‰æ—¶é—´å»åšè€Œå¤±å»è‡ªå·±çš„é’±ï¼ˆè¯·è®°ä½ï¼Œå¯¹ç«‹çš„å›¢é˜Ÿåªæœ‰24å°æ—¶å¯ä»¥æŒ‘æˆ˜ç°ä»»é¢†å¯¼äººï¼‰ã€‚ é€šè¿‡ä¿è¯åˆåŒæ”¶å–æ¬¾é¡¹ï¼Œç©å®¶å°†å¯ä»¥éšæ—¶æå–æ¬¾é¡¹ï¼Œç›´åˆ°æ”¶é›†åˆ°å¿…è¦çš„é‡‘é¢ä¸ºæ­¢ã€‚ <br><br> åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ä¸é€‚ç”¨ï¼Œä½†æ˜¯æ­¤ç±»åˆåŒçš„å¦ä¸€ä¸ªæœ‰ç”¨åŠŸèƒ½æ˜¯å‡å°‘â€œæ­ä¾¿è½¦æ•ˆåº”â€æˆ–â€œæ­ä¾¿è½¦é—®é¢˜â€çš„å½±å“ã€‚ ç”±äºå…¬å…±åˆ©ç›Šï¼Œå³ä¸å¯å‰¥å¤ºæˆ–éš¾ä»¥æ§åˆ¶çš„è·å–ï¼Œå› æ­¤ï¼Œæ­ä¾¿è½¦é—®é¢˜æ˜¯å…¬å…±ç‰©å“ç»„ç»‡ä¸­çš„ä¸»è¦é—®é¢˜ã€‚ äººä»¬ä¸å¸Œæœ›æŠ•èµ„äºä»–äººå¯ä»¥å…è´¹ä½¿ç”¨çš„ä¸œè¥¿ï¼Œä¹Ÿä¸æƒ³æŠ•èµ„äºæŠ•èµ„è€…æœ¬äººï¼Œä»–ä»¬åšæŒç»å¯¹åˆç†çš„ç»æµè¡Œä¸ºï¼Œå¹¶é€‰æ‹©äº†â€œéæŠ•èµ„â€ç­–ç•¥ï¼ˆå¦‚æœæˆåŠŸæ”¶é›†ï¼‰ï¼Œå¾ˆå¯èƒ½èƒ½å¤Ÿä½¿ç”¨æ‰€åˆ›é€ çš„å•†å“ã€‚ <br><br> æˆ‘è¿˜å°†è®¨è®ºä¼˜åŒ–æ‹…ä¿åˆåŒçš„é€‰æ‹©ï¼Œå®ƒå¢åŠ äº†æˆåŠŸç­¹é›†èµ„é‡‘çš„æœºä¼šï¼Œå› ä¸º å‚ä¸è€…çš„ç†æ€§è¡Œä¸ºå·²ç»æ˜¯æŠ•èµ„ç­–ç•¥çš„é€‰æ‹©ï¼Œè€Œä¸æ˜¯æ— è§†ã€‚ <br><br><h2> æˆ‘ä»¬é›†ä½“ç©æ¸¸æˆ </h2><br> å¯¹äºæˆ‘ä»¬çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸Šä¸€ç¯‡æ–‡ç« ä¸­</a>å·²çŸ¥çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¸¸æˆâ€œ Attack 51ï¼…â€ã€‚</a> <br> åœ¨å½“å‰çš„å®æ–½æ–¹å¼ä¸­ï¼Œæ¸¸æˆå‚ä¸è€…å°†é’±è½¬è‡³æ¸¸æˆçš„AAåœ°å€ã€‚ ä½†æ˜¯å¯ä»¥æ”¹è¿›ç®—æ³•ï¼Œå¹¶ä¸”å¯ä»¥å‡å°‘å‚ä¸è€…åœ¨å¤±å»å›¢é˜Ÿçš„æƒ…å†µä¸‹èµ”é’±çš„æœºä¼šã€‚ <br> ä¸ºæ­¤ï¼Œä»»ä½•å›¢é˜Ÿæˆå‘˜éƒ½å¯ä»¥ç»„ç»‡åŠ¨æ€ç›®æ ‡è‡³å°‘ç­‰äºæ¸¸æˆæ€»æ± æ•°51ï¼…çš„ä¼—ç­¹ã€‚ éšç€èµ„é‡‘æ± çš„å¢é•¿ï¼Œæœ€ç»ˆçš„ä¼—ç­¹ç›®æ ‡ä¹Ÿå°†å‘ç”Ÿå˜åŒ–ã€‚ è€Œä¸”åªæœ‰æˆåŠŸäº†ï¼Œè¿™ç¬”é’±æ‰ä¼šè¢«å‘é€åˆ°æ¸¸æˆçš„AAåœ°å€ï¼Œå›¢é˜Ÿå°†ç«‹å³æˆä¸ºå½“å‰çš„é¢†å¯¼è€…ã€‚ å¦‚æœä»æœªå‘ç”Ÿè¿‡è¿™æ ·çš„äº‹ä»¶ï¼Œé‚£ä¹ˆå‚ä¸è€…å°†ä¸ä¼šæŸå¤±ä»–ä»¬çš„é’±ï¼Œç™½ç™½æµªè´¹æ¸¸æˆæ± ï¼Œè€Œåªæ˜¯ä»ç­¹é›†AAçš„èµ„é‡‘ä¸­æ‹¿èµ°é’±ã€‚ <br><br> ä¸¤ç§ç‹¬ç«‹ä»£ç†çš„åŸä»¶å§‹ç»ˆå¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨çº¿Oscriptä»£ç ç¼–è¾‘å™¨</a>ä¸­ä»¥æ¨¡æ¿çš„å½¢å¼è·å¾—ï¼Œåªéœ€ä»ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©â€œ 51ï¼… <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Attack</a> gameâ€å’Œâ€œ Fundraising proxyâ€å³å¯ã€‚ <br><br> åœ¨æ‚¨å¼€å§‹ç”¨Oscriptç¼–å†™AAä¹‹å‰ï¼Œå¼ºçƒˆå»ºè®®æ‚¨é˜…è¯»æˆ‘ä»¬æ–‡æ¡£ä¸­çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…¥é—¨æŒ‡å—</a> ï¼ˆengï¼‰ï¼Œä»¥å¿«é€Ÿç†Ÿæ‚‰ç¼–å†™AAçš„åŸºæœ¬åŸç†ã€‚ <br><br><h2> ç¼–å†™ä»£ç  </h2><br> é¦–å…ˆï¼Œæˆ‘ä»¬ç¼–å†™ç®—æ³•ï¼šæ–½ä¸»å°†å­—èŠ‚å‘é€åˆ°AAåœ°å€ï¼Œä»¥1ï¼š1çš„æ¯”ä¾‹è¿”å›ä¼—ç­¹ä»¤ç‰Œã€‚åœ¨ä»»ä½•æ—¶å€™ï¼Œä»–éƒ½å¯ä»¥å°†è¿™äº›ä»¤ç‰Œäº¤æ¢å›å­—èŠ‚ã€‚ æ”¶åˆ°å­—èŠ‚åï¼Œæœºç®¡å±€ä¼šæ£€æŸ¥æˆ‘ä»¬æ˜¯å¦å·²è¾¾åˆ°ç­¹é›†èµ„é‡‘çš„ç›®æ ‡ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°†æ‰€æœ‰å­—èŠ‚å‘é€åˆ°æ¸¸æˆæœºç®¡å±€çš„åœ°å€å¹¶ä½œä¸ºå›æŠ¥æ¥æ”¶æ¸¸æˆä»¤ç‰Œï¼ˆå›¢é˜Ÿä»¤ç‰Œï¼‰ã€‚ æçŒ®è€…ç°åœ¨å¯ä»¥å°†å…¶ä¼—ç­¹ä»£å¸äº¤æ¢ä¸ºæ¸¸æˆä»£å¸ï¼Œå¦‚æœå›¢é˜Ÿè·èƒœï¼Œå°†æ¥å¯ä»¥é€šè¿‡AAæ¸¸æˆå°†å…¶äº¤æ¢ä¸ºå­—èŠ‚ï¼Œä»åŸå§‹æ¸¸æˆä¸­æœ€å¤šæ¥æ”¶2å­—èŠ‚ã€‚ <br><br> å› æ­¤ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ã€‚ <br><br> æ–°ç­¹æ¬¾æœŸé—´çš„å¯åŠ¨å¤„ç†å•å…ƒã€‚ æ”¶åˆ°ä¼ å…¥æ•°æ®æ¶ˆæ¯ä¸­åˆ°è¾¾AAåœ°å€çš„â€œå¼€å§‹â€å­—æ®µåï¼Œæˆ‘ä»¬å°†å‘è¡Œä¼—ç­¹ä»¤ç‰Œå¹¶å°†å…¶å†™å…¥çŠ¶æ€ï¼Œè¿˜å°†å…¶ä½œä¸ºå“åº”è¿”å›ç»™è°ƒç”¨æ–¹ã€‚ <br><br><pre><code class="javascript hljs">{ <span class="hljs-comment"><span class="hljs-comment">// start a new fundraising period if: `{trigger.data.start AND !$asset}`, messages: [ { app: 'asset', payload: { is_private: false, is_transferrable: true, auto_destroy: false, fixed_denominations: false, issued_by_definer_only: true, cosigned_by_definer: false, spender_attested: false } }, { app: 'state', state: `{ var[response_unit || '_status'] = 'open'; var['asset'] = response_unit; response['asset'] = response_unit; }` } ] },</span></span></code> </pre> <br> å¤„ç†æåŠ©è€…çš„å­˜æ¬¾ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬è¿‡æ»¤æ‰éå¸¸å°‘é‡çš„åƒåœ¾äº¤æ˜“ï¼Œå³ä½¿æ˜¯ä½£é‡‘ä¹Ÿä¸å¤Ÿã€‚ æ¥ä¸‹æ¥ï¼Œæ£€æŸ¥æ¸¸æˆæœªå®Œæˆä¸”å¯ä»¥æ”¶é›†çš„åŸºæœ¬æ¡ä»¶ã€‚ å®Œæ•´çš„æ¸…å•æ¸…å•ï¼š <br><br><pre> <code class="javascript hljs">{ <span class="hljs-comment"><span class="hljs-comment">// contribute if: `{trigger.output[[asset=base]] &gt;= 1e5 AND $asset}`, init: `{ if (var[$destination_aa]['finished']) bounce('game over'); $amount = trigger.output[[asset=base]] - 2000; // to account for fees we need to respond now and to refund bytes or pay shares later $total_raised = var['total_raised'] + $amount; $missing_amount = ceil((balance[$destination_aa][base] + $total_raised)*0.51) - var[$destination_aa]['team_' || $team || '_amount']; $bDone = ($total_raised &gt; $missing_amount); }`, messages: [ { app: 'payment', payload: { asset: "{$asset}", outputs: [{address: "{trigger.address}", amount: "{$amount}"}] } }, { if: `{$bDone}`, app: 'payment', payload: { asset: "base", outputs: [{address: "{$destination_aa}", amount: "{$total_raised}"}] } }, { if: `{$bDone}`, app: 'data', payload: { team: "{$team}" } }, { app: 'state', state: `{ if ($bDone) var[$asset || '_status'] = 'raised'; else var['total_raised'] = $total_raised; }` } ] },</span></span></code> </pre> <br> åˆæ­¥æ£€æŸ¥åï¼Œæˆ‘ä»¬æœºç®¡å±€çš„ä¸»è¦é€»è¾‘ç«‹å³å˜ä¸ºï¼š <br><br> <code>$total_raised = var['total_raised'] + $amount;</code>  -åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†åˆšæ”¶åˆ°çš„é‡‘é¢æ€»ç»“ä¸ºä»£ç†å•†çš„èµ„é‡‘æ€»é¢ã€‚ <br><br> <code>$missing_amount = ceil((balance[$destination_aa][base] + $total_raised)*0.51) - var[$destination_aa]['team_' || $team || '_amount'];</code>  -æ£€æŸ¥æ–°ç­¹é›†çš„èµ„é‡‘è¶³ä»¥èµ¢å¾—æ¯”èµ›ã€‚ è¯·æ³¨æ„å¯¹å¦ä¸€ä¸ªAAå˜é‡çš„ä½™é¢å’ŒçŠ¶æ€çš„å¼•ç”¨ï¼š <code>balance[$destination_aa][base]</code>å’Œ<code>var[$destination_aa]['team_' || $team || '_amount']</code> <code>var[$destination_aa]['team_' || $team || '_amount']</code>  <code>var[$destination_aa]['team_' || $team || '_amount']</code> ã€‚ <br><br> æˆ‘ä»¬åœ¨<code>init</code>å—ä¸­å®Œæˆæ‰€æœ‰è¿™äº›æ“ä½œï¼Œè¯¥<code>init</code>å—åœ¨æ¯æ¬¡å¤„ç†äº‹åŠ¡æ¶ˆæ¯ä¹‹å‰éƒ½ä¼šè¢«è°ƒç”¨ã€‚ æ˜¾ç„¶ï¼Œå¯¹ä¼ å…¥äº‹åŠ¡çš„ç­”æ¡ˆæ˜¯ç›¸å¯¹äºæ¥æ”¶åˆ°çš„å­—èŠ‚ï¼ˆ <i>æ¶ˆæ¯</i>æ•°ç»„çš„ç¬¬ä¸€å—ï¼‰ä»¥ä¸€å¯¹ä¸€çš„æ¯”ç‡å‘é€AAä»¤ç‰Œã€‚ ä»…å½“å±€éƒ¨å˜é‡<i>$ bDone</i>è®¾ç½®ä¸º<i>true</i> ï¼ˆåœ¨<i>init</i>å—ä¸­è®¾ç½®ï¼‰æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œç¬¬äºŒå’Œç¬¬ä¸‰å—ã€‚ åœ¨å…¶ä¸­ï¼Œæˆ‘ä»¬ä¼šå°†æ‰€æœ‰èµ„é‡‘ä»è¯¥AAåœ°å€å‘é€åˆ°AAæ¸¸æˆåœ°å€ï¼Œä»¥æ¥æ”¶æ¸¸æˆä»£å¸ã€‚ åœ¨æ¶ˆæ¯çš„æœ€åä¸€å—ä¸­ï¼Œæˆ‘ä»¬ä»…æ›´æ–°çŠ¶æ€ï¼Œè®¾ç½®å¿…è¦çš„çŠ¶æ€å’Œæ”¶é›†çš„æ•°é‡ã€‚ <br><br> å¤„ç†æ¥è‡ªAAæ¸¸æˆçš„å·²æ¥æ”¶ä»¤ç‰Œï¼Œå®ƒä»¬å·²ç»ä½äºæˆ‘ä»¬AAçš„ä½™é¢ä¸Šï¼Œæˆ‘ä»¬åªéœ€è¦æ›´æ”¹ä»£ç†çš„çŠ¶æ€å³å¯ï¼š <br><br><pre> <code class="javascript hljs">{ <span class="hljs-comment"><span class="hljs-comment">// received team asset if: `{trigger.output[[asset=var[$destination_aa]['team_' || $team || '_asset']]] AND $asset}`, messages: [ { app: 'state', state: `{ var[$asset || '_status'] = 'done'; var['asset'] = false; var['total_raised'] = false; }` } ] },</span></span></code> </pre> <br> ç©å®¶æŠ•èµ„çš„æ‹’ç»ã€‚ æˆ‘ä»¬å…è®¸æ‚¨éšæ—¶æ‹’ç»å‚åŠ å¹¶æ”¶å›æ‚¨çš„å­—èŠ‚æ•°ã€‚ ä¸ºæ­¤ï¼Œç©å®¶å‘é€æ­¤AAçš„ä»¤ç‰Œï¼Œç„¶åæˆ‘ä»¬åœ¨è¿”å›äº¤æ˜“ä¸­å‘ä»–å‘é€ç›¸åŒçš„å­—èŠ‚ï¼š <br><br><pre> <code class="javascript hljs">{ <span class="hljs-comment"><span class="hljs-comment">// refund if: `{$asset AND trigger.output[[asset=$asset]] &gt; 0}`, init: `{ $amount = trigger.output[[asset=$asset]]; }`, messages: [ { app: 'payment', payload: { asset: "base", outputs: [{address: "{trigger.address}", amount: "{$amount}"}] } }, { app: 'state', state: `{ var['total_raised'] -= $amount; }` } ] },</span></span></code> </pre> <br> å°†æˆ‘ä»¬çš„AAä»¤ç‰Œäº¤æ¢ä¸ºæ¸¸æˆä»¤ç‰Œã€‚ æˆ‘ä»¬åªå‘é€ä¸æˆ‘ä»¬çš„AAä½™é¢ï¼ˆå¦‚æœé€šè¿‡ifå—çš„æƒ…å†µä¸‹ï¼‰ç›¸ç­‰çš„æ¸¸æˆä»£å¸ï¼Œå…¶æ•°é‡ç­‰äºæ”¶åˆ°çš„â€œæˆ‘ä»¬çš„â€ä»£å¸çš„æ•°é‡ã€‚ <br><br><pre> <code class="javascript hljs">{ <span class="hljs-comment"><span class="hljs-comment">// pay the obtained team asset in exchange for the issued asset if: `{ $in_asset = trigger.output[[asset!=base]].asset; var[$in_asset || '_status'] == 'done' }`, messages: [ { app: 'payment', payload: { asset: "{var[$destination_aa]['team_' || $team || '_asset']}", outputs: [{address: "{trigger.address}", amount: "{trigger.output[[asset=$in_asset]]}"}] } }, ] }</span></span></code> </pre> <br> ä»£ç†ä»£ç å·²å‡†å¤‡å°±ç»ªï¼Œä¸‹é¢æ˜¯å®ƒçš„å®Œæ•´åˆ—è¡¨ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">å®Œæ•´çš„ä»£ç†å•†ä»£ç </b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-comment"><span class="hljs-comment">/* This is a fundraising proxy AA. It allows to raise money up to a specific target. If the target is reached, the money is forwarded to another AA, otherwise the money is refunded. This specific example raises money for challenging the current candidate winner in 51% attack game. The target is a moving target as other teams may be adding contributions at the same time. Contributors get shares of the proxy in exchange for Bytes. They can exchange the shares back to the same amount of Bytes any time before the target is reached. As soon as the target is reached, the raised funds are forwarded to the game and the proxy receives the shares of the team in exchange. Then, the contributors can exchange the shares of the proxy for the shares of the team. */</span></span> init: <span class="hljs-string"><span class="hljs-string">`{ $asset = var['asset']; $destination_aa = 'WWHEN5NDHBI2UF4CLJ7LQ7VAW2QELMD7'; $team = 'VF5UVKDSOXPMITMDGYXEIGUJSQBRAMMN'; }`</span></span>, <span class="hljs-attr"><span class="hljs-attr">messages</span></span>: { <span class="hljs-attr"><span class="hljs-attr">cases</span></span>: [ { <span class="hljs-comment"><span class="hljs-comment">// start a new fundraising period if: `{trigger.data.start AND !$asset}`, messages: [ { app: 'asset', payload: { is_private: false, is_transferrable: true, auto_destroy: false, fixed_denominations: false, issued_by_definer_only: true, cosigned_by_definer: false, spender_attested: false } }, { app: 'state', state: `{ var[response_unit || '_status'] = 'open'; var['asset'] = response_unit; response['asset'] = response_unit; }` } ] }, { // contribute if: `{trigger.output[[asset=base]] &gt;= 1e5 AND $asset}`, init: `{ if (var[$destination_aa]['finished']) bounce('game over'); $amount = trigger.output[[asset=base]] - 2000; // to account for fees we need to respond now and to refund bytes or pay shares later $total_raised = var['total_raised'] + $amount; $missing_amount = ceil((balance[$destination_aa][base] + $total_raised)*0.51) - var[$destination_aa]['team_' || $team || '_amount']; $bDone = ($total_raised &gt; $missing_amount); }`, messages: [ { app: 'payment', payload: { asset: "{$asset}", outputs: [{address: "{trigger.address}", amount: "{$amount}"}] } }, { if: `{$bDone}`, app: 'payment', payload: { asset: "base", outputs: [{address: "{$destination_aa}", amount: "{$total_raised}"}] } }, { if: `{$bDone}`, app: 'data', payload: { team: "{$team}" } }, { app: 'state', state: `{ if ($bDone) var[$asset || '_status'] = 'raised'; else var['total_raised'] = $total_raised; }` } ] }, { // received team asset if: `{trigger.output[[asset=var[$destination_aa]['team_' || $team || '_asset']]] AND $asset}`, messages: [ { app: 'state', state: `{ var[$asset || '_status'] = 'done'; var['asset'] = false; var['total_raised'] = false; }` } ] }, { // refund if: `{$asset AND trigger.output[[asset=$asset]] &gt; 0}`, init: `{ $amount = trigger.output[[asset=$asset]]; }`, messages: [ { app: 'payment', payload: { asset: "base", outputs: [{address: "{trigger.address}", amount: "{$amount}"}] } }, { app: 'state', state: `{ var['total_raised'] -= $amount; }` } ] }, { // pay the obtained team asset in exchange for the issued asset if: `{ $in_asset = trigger.output[[asset!=base]].asset; var[$in_asset || '_status'] == 'done' }`, messages: [ { app: 'payment', payload: { asset: "{var[$destination_aa]['team_' || $team || '_asset']}", outputs: [{address: "{trigger.address}", amount: "{trigger.output[[asset=$in_asset]]}"}] } }, ] } ] } }</span></span></code> </pre><br></div></div><br> æˆ‘ä»¬æ²¡æœ‰å®ç°æœ€ç®€å•çš„ç®—æ³•ï¼Œå› ä¸º æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åŠ¨æ€çš„ï¼Œè¿™ä¸æ˜¯å…¸å‹çš„ä¿è¯åˆåŒæ‰€ç‰¹æœ‰çš„ã€‚ åœ¨è¿™äº›æ–‡ä»¶ä¸­ï¼Œæœ€å¸¸è§çš„æ˜¯ç›®æ ‡æ•°é‡ä»¥åŠæœ€åæœŸé™æ˜¯å›ºå®šçš„ã€‚ è¿™ä¸éœ€è¦å¯¹ä»£ç è¿›è¡Œé‡å¤§æ›´æ”¹ï¼Œå› æ­¤è®©æˆ‘ä»¬å°†å…¶ä½œä¸ºç»ƒä¹ ç•™ç»™è¯»è€…ã€‚ <br><br><h2> æœ€å¥½çš„ç­–ç•¥æ˜¯æŠ•èµ„ï¼ </h2><br> ç°åœ¨å›åˆ°æ­ä¾¿è½¦çš„é—®é¢˜ã€‚ å°±æ¸¸æˆè€Œè¨€ï¼Œæˆ‘ä»¬æ²¡æœ‰è¿™æ ·çš„é—®é¢˜ï¼Œå› ä¸º åªæœ‰ä¼—ç­¹ä»£å¸æŒæœ‰è€…æ‰èƒ½èµ¢ã€‚ ä½†æ˜¯ï¼Œè§£å†³æ­ä¾¿è½¦é—®é¢˜å°†å¯¹æ¸¸æˆæœ‰å¸®åŠ©ã€‚ æˆ‘ä»¬å¯ä»¥â€œåˆºæ¿€â€äººä»¬è¿›è¡ŒæŠ•èµ„ã€‚ ä¸ºæ­¤ï¼Œç­¹æ¬¾æ´»åŠ¨çš„ç»„ç»‡è€…ï¼ˆä¹Ÿæ˜¯AAçš„åˆ›å»ºè€…ï¼‰å¯ä»¥æ‹¨å‡ºå°‘é‡è¡¥å¿é‡‘ï¼Œå¦‚æœæ— æ³•è¾¾åˆ°æ”¶é›†ç›®çš„ï¼Œä»–å°†è‡ªæè…°åŒ…æ”¯ä»˜ã€‚ åœ¨æˆåŠŸæ”¶é›†çš„æƒ…å†µä¸‹ï¼Œç»„ç»‡è€…å°†å å¾ˆå°çš„æ¯”ä¾‹ã€‚ å°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ä¸ªç¬¬ä¸‰æ–¹ï¼Œä¸ºäº†è·å¾—åˆ©ç›Šï¼Œå®ƒå°†æ‰¿æ‹…æ”¶æ¬¾ä¸æˆåŠŸçš„é£é™©ã€‚ <br><br> åº”ç”¨è¿™ç§â€œä¼˜åŒ–çš„ä¼—ç­¹â€ï¼Œä»¥å‰â€œéæŠ•èµ„â€çš„ç†æ€§è¡Œä¸ºï¼ˆé€šå¸¸ï¼Œä»»ä½•å…¬å…±ç‰©å“æ­ä¾¿è½¦éƒ½æ˜¯æœ€ç»æµçš„è·åˆ©ç­–ç•¥ï¼‰å¯èƒ½å˜å¾—ä¸å¦‚æŠ•èµ„ç†æ€§ã€‚ åœ¨åˆ›å»ºæ¶‰åŠç‰¹å®šäººå‘˜åœˆå­çš„é›†ä½“å•†å“çš„æƒ…å†µä¸‹ï¼Œè¿™å¯èƒ½å°¤å…¶ç›¸å…³ã€‚ è¿™ä¸èƒ½å®Œå…¨æ¶ˆé™¤å·æ¸¡é—®é¢˜ï¼Œä½†å¯ä»¥ä½¿å‚ä¸æˆä¸ºä¸€ç§ç†æ€§è¡Œä¸ºã€‚ <br><br> å®æ–½â€œä¼˜åŒ–ä¿è¯åˆåŒâ€çš„ä»£ç å¯¹äºé‚£äº›å¸Œæœ›çš„äººä¹Ÿå°†æ˜¯ä¸€ä¸ªæœ‰è¶£çš„ç»ƒä¹ ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN475100/">https://habr.com/ru/post/zh-CN475100/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN475082/index.html">Habræ¯å‘¨ï¼ƒ26 /æ¯å‘¨å·¥ä½œå››å¤©ï¼ŒGitLabå‚æ”¿ï¼ŒYandexæ­£åœ¨æµ‹è¯•Roveré€è´§æœºå™¨äºº</a></li>
<li><a href="../zh-CN475086/index.html">é¢å‘å‰ç«¯å¼€å‘äººå‘˜çš„REST APIç±»å‹</a></li>
<li><a href="../zh-CN475092/index.html">â€œæˆ‘ç¨åå†è¯»â€ï¼šè„±æœºæ”¶é›†ç½‘é¡µçš„è‰°éš¾å‘½è¿</a></li>
<li><a href="../zh-CN475096/index.html">å®£å¸ƒ.NET Core 3.1é¢„è§ˆç‰ˆ2</a></li>
<li><a href="../zh-CN475098/index.html">åœ¨çº¿ç”µå½±æµ·æŠ¥é‡‡è´­çš„è‡ªåŠ¨åŒ–</a></li>
<li><a href="../zh-CN475104/index.html">æˆ‘ä»¬æµè§ˆä»¥ä¸‹æ¨¡å—ï¼šä½¿ç”¨Jetpackåœ¨å¤šæ¨¡å—åº”ç”¨ç¨‹åºä¸­å¯¼èˆª</a></li>
<li><a href="../zh-CN475106/index.html">Microsoft Ignite 2019å¤§ä¼šçš„ä¸»è¦å…¬å‘Š</a></li>
<li><a href="../zh-CN475110/index.html">.NET Coreå’ŒJupyterç¬”è®°æœ¬-é¢„è§ˆ1</a></li>
<li><a href="../zh-CN475112/index.html">éªŒè¯æˆ‘çš„èº«ä»½ã€‚ å¦‚æœå¯ä»¥...</a></li>
<li><a href="../zh-CN475114/index.html">.NET Core 3.1é¢„è§ˆç‰ˆ2ç®€ä»‹</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>