<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🍳 🤢 👩‍🚒 Vektorproduktansichten oder eine andere Verwendung des Word2Vec-Modells ⛹🏾 😐 🚴🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jeden Tag suchen eineinhalb Millionen Menschen in Ozon nach einer Vielzahl von Produkten, und für jedes von ihnen sollte der Dienst ähnliche (wenn der...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vektorproduktansichten oder eine andere Verwendung des Word2Vec-Modells</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ozontech/blog/432760/"><img src="https://habrastorage.org/webt/w4/qo/hx/w4qohxd9gujf6kayzuow0bww9dc.png" alt="Bild"><br><br><p>  Jeden Tag suchen eineinhalb Millionen Menschen in Ozon nach einer Vielzahl von Produkten, und für jedes von ihnen sollte der Dienst ähnliche (wenn der Staubsauger noch einen leistungsstärkeren benötigt) oder verwandte Produkte (wenn für den singenden Dinosaurier Batterien benötigt werden) auswählen.  Wenn es viele Arten von Waren gibt, hilft das Word2Vec-Modell, das Problem zu lösen.  Wir verstehen, wie es funktioniert und wie man Vektordarstellungen für beliebige Objekte erstellt. </p><a name="habracut"></a><br><h3>  Motivation </h3><br><p> Um das Modell zu erstellen und zu trainieren, verwenden wir die Einbettungstechnik, die für maschinelles Lernen Standard ist, wenn sich jedes Objekt in einen Vektor fester Länge verwandelt und enge Vektoren geschlossenen Objekten entsprechen.  Fast alle bekannten Modelle erfordern, dass die Eingabedaten eine feste Länge haben, und ein Satz von Vektoren ist eine einfache Möglichkeit, sie in diese Form zu bringen. </p><br><p>  Eine der ersten Einbettungsmethoden ist word2vec.  Wir haben diese Methode für unsere Aufgabe angepasst, wir verwenden Produkte als Wörter und Benutzersitzungen als Sätze.  Wenn Ihnen alles klar ist, können Sie die Ergebnisse durchblättern. </p><br><p>  Als nächstes werde ich über die Architektur des Modells und dessen Funktionsweise sprechen.  Da es sich um Waren handelt, müssen wir lernen, wie man solche Beschreibungen erstellt, die einerseits genügend Informationen enthalten und andererseits für den Algorithmus des maschinellen Lernens verständlich sind. </p><br><img src="https://habrastorage.org/webt/y0/pj/fz/y0pjfzmvk5o-aulmjygpnjrphji.png" alt="Bild"><br><p>  Auf der Website hat jedes Produkt eine Karte.  Es besteht aus einem Titel, einer Textbeschreibung, Spezifikationen und Fotos.  Zu unserer Verfügung stehen auch Daten zur Interaktion der Benutzer mit dem Produkt: Ansichten, Hinzufügen zum Warenkorb oder Favoriten werden in den Protokollen gespeichert. </p><br><p>  Es gibt zwei grundlegend verschiedene Möglichkeiten, eine Vektorbeschreibung eines Produkts zu erstellen: </p><br><p>  - Verwendung von Inhalten - Faltungs-Neuronale Netze zum Extrahieren von Merkmalen aus Fotos, wiederkehrenden Netzen oder einer Wortsammlung zur Analyse einer Textbeschreibung; <br>  - Verwendung von Daten zu Benutzerinteraktionen mit dem Produkt: Welche Produkte und wie oft sie zusammen mit den Daten in den Warenkorb schauen / hinzufügen. </p><br><p>  Wir werden uns auf die zweite Methode konzentrieren. </p><br><h3>  Daten für das Prod2Vec-Modell </h3><br><p>  Lassen Sie uns zunächst herausfinden, welche Daten wir verwenden.  Wir verfügen über alle Klicks von Benutzern auf der Website, sie können in Benutzersitzungen unterteilt werden - Sequenzen von Klicks mit Intervallen von nicht mehr als 30 Minuten zwischen benachbarten Klicks.  Zum Trainieren des Modells verwenden wir Daten aus etwa 100 Millionen Benutzersitzungen, in denen wir jeweils nur Produkte anzeigen und dem Warenkorb hinzufügen möchten. </p><br><p>  Ein Beispiel für eine echte Benutzersitzung: </p><br><img src="https://habrastorage.org/webt/q5/ov/fe/q5ovfeg-qfqarxgzxyzcfq5vssk.png" alt="Bild"><br><p>  Jedes Produkt in der Sitzung entspricht seinem Kontext - alle Produkte, die der Benutzer in dieser Sitzung zum Warenkorb hinzugefügt hat, sowie Produkte, die damit angezeigt werden.  Das prod2vec-Modell basiert auf der Annahme, dass ähnliche Produkte meist ähnliche Kontexte haben. </p><br><p>  Zum Beispiel: </p><br><img src="https://habrastorage.org/webt/ch/_m/tp/ch_mtpiawhaak2ddrks2pjxvgae.png" alt="Bild"><br><p>  Wenn die Annahme zutrifft, haben beispielsweise Fälle für dasselbe Telefonmodell ähnliche Kontexte (dasselbe Telefon).  Wir werden diese Hypothese testen, indem wir Produktvektoren konstruieren. </p><br><h3>  Modell Prod2Vec </h3><br><p>  Wenn wir die Konzepte eines Produkts und seinen Kontext vorstellen, beschreiben wir das Modell selbst.  Dies ist ein neuronales Netzwerk mit zwei vollständig verbundenen Schichten.  Die Anzahl der Eingaben der ersten Schicht entspricht der Anzahl der Produkte, für die wir Vektoren erstellen möchten.  Jedes Produkt am Eingang wird durch einen Vektor von Nullen mit einer einzelnen Einheit codiert - der Stelle dieses Produkts im Wörterbuch. </p><br><p>  Die Anzahl der Neuronen am Ausgang der ersten Schicht entspricht der Dimension der Vektoren, die wir erhalten möchten, zum Beispiel 64. Am Ausgang der letzten Schicht gibt es wiederum eine Anzahl von Neuronen, die der Anzahl der Waren entspricht. </p><br><img src="https://habrastorage.org/webt/nf/0i/bf/nf0ibftkdqs3bkun8jn_qkwodfo.jpeg" alt="Bild"><br><br><p>  Wir werden das Modell trainieren, um den Kontext vorherzusagen und das Produkt zu kennen.  Diese Architektur heißt Skip-Gramm (ihre Alternative ist CBOW, wo wir das Produkt entsprechend seinem Kontext vorhersagen).  Während des Trainings werden Waren an den Eingang geliefert, und es wird erwartet, dass Waren aus ihrem Kontext ausgegeben werden (ein Vektor von Nullen mit einer Einheit an der entsprechenden Stelle). </p><br><p>  Im Wesentlichen handelt es sich hierbei um eine Klassifizierung mit mehreren Klassen, und der Verlust der Kreuzentropie kann zum Trainieren des Modells verwendet werden.  Für ein Wort-Wort-Paar aus dem Kontext wird wie folgt geschrieben: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">L</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-4" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-7" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-9">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">g</span><span class="MJXp-mtext" id="MJXp-Span-13">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">u</span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-18"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">i</span><span class="MJXp-mo" id="MJXp-Span-20">=</span><span class="MJXp-mn" id="MJXp-Span-21">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">p</span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-29" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> L = -p_c + \ log \ sum_ {i = 1} ^ V exp (p_i) </script></p><br><p>  wo <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-msubsup" id="MJXp-Span-32"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-34" style="vertical-align: -0.4em;">c</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-2"> p_c </script>  - Netzwerkvorhersage für das Produkt aus dem Kontext, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">V</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-3"> V </script>  - die Gesamtzahl der Waren <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-msubsup" id="MJXp-Span-38"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-40" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-4"> p_i </script>  - Netzwerkvorhersage für das Produkt <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-5"> i </script>  . </p><br><p>  Nach dem Training des Modells können wir die zweite Schicht verwerfen - es wird nicht benötigt, um Vektoren zu erhalten.  Die Gewichtsmatrix der ersten Schicht (Größe der Anzahl der Waren x 64) ist ein Wörterbuch der Warenvektoren.  Jedes Produkt entspricht einer Zeile einer Matrix der Länge 64 - dies ist der dem Produkt entsprechende Vektor, der in anderen Algorithmen verwendet werden kann. </p><br><p>  Dieses Verfahren funktioniert jedoch nicht für eine große Anzahl von Produkten.  Und wir haben sie, erinnern Sie sich, eineinhalb Millionen. </p><br><p>  Warum Prod2Vec nicht funktioniert </p><br><p>  - Die Verlustfunktion enthält viele Operationen zum Aufnehmen des Exponenten - dies ist eine lange und instabile rechnerische. <br>  - Infolgedessen werden Gradienten für alle Netzwerkgewichte berücksichtigt - und es können zig Millionen sein. </p><br><p>  Um diese Probleme zu lösen, ist die negative Stichprobenmethode geeignet, mit der wir dem Netzwerk beibringen, nicht nur den Kontext für das Produkt vorherzusagen, sondern auch nicht die Produkte vorherzusagen, die nicht genau im Kontext sind.  Dazu müssen wir negative Beispiele generieren - wählen Sie für jedes Produkt diejenigen aus, die nicht vorhergesagt werden müssen.  Und hier hilft uns die Verfügbarkeit einer großen Menge an Waren.  Wenn wir ein zufälliges Paar für ein Produkt auswählen, haben wir eine sehr geringe Wahrscheinlichkeit, dass es sich als Produkt aus dem Kontext herausstellt. </p><br><p>  Als Ergebnis generieren wir für jedes Produkt im Kontext zufällig 5-10 Produkte, die nicht im Kontext enthalten sind.  Darüber hinaus werden die Waren nicht gleichmäßig verteilt, sondern proportional zur Häufigkeit ihres Auftretens. </p><br><p>  Die Verlustfunktion ähnelt jetzt der bei der binären Klassifizierung verwendeten.  Für ein Wort-Wort-Paar aus dem Kontext sieht es so aus: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">L</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-47">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">g</span><span class="MJXp-mtext" id="MJXp-Span-51">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">a</span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-58"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59" style="margin-right: 0.05em;">u</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-60"><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-63" style="vertical-align: -0.4em;">O</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-70" style="vertical-align: -0.4em;">I</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-73">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">u</span><span class="MJXp-msubsup" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-78" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-82">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">g</span><span class="MJXp-mtext" id="MJXp-Span-86">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">a</span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-94"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95" style="margin-right: 0.05em;">u</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-96"><span class="MJXp-msubsup" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-99" style="vertical-align: -0.4em;">n</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-103" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-106" style="vertical-align: -0.4em;">I</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> L = - \ log \ sigma (u_ {w_O} ^ T v_ {w_I}) - \ sum_ {w_n} \ log \ sigma (-u_ {w_n} ^ T v_ {w_I}) </script></p><br><p>  In dieser Notation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-108"><span class="MJXp-msubsup" id="MJXp-Span-109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-111" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-114" style="vertical-align: -0.4em;">O</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> u_ {w_O} </script>  bezeichnet eine Spalte der Gewichtsmatrix der zweiten Schicht, die dem Produkt aus dem Kontext entspricht, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-115"><span class="MJXp-msubsup" id="MJXp-Span-116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-118" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-121" style="vertical-align: -0.4em;">n</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> u_ {w_n} </script>  - das gleiche für ein zufällig ausgewähltes Produkt, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-122"><span class="MJXp-msubsup" id="MJXp-Span-123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-125" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-128" style="vertical-align: -0.4em;">I</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> v_ {w_I} </script>  - die Zeile der Gewichtsmatrix der ersten Schicht, die dem Hauptprodukt entspricht (dies ist genau der Vektor, den wir dafür erstellen).  Funktion <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-129"><span class="MJXp-mtext" id="MJXp-Span-130">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">a</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">x</span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-140">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">c</span><span class="MJXp-mrow" id="MJXp-Span-145"><span class="MJXp-mn" id="MJXp-Span-146">1</span></span><span class="MJXp-mrow" id="MJXp-Span-147"><span class="MJXp-mn" id="MJXp-Span-148">1</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">p</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">x</span><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> \ sigma (x) = \ frac {1} {1 + exp (-x)} </script>  . </p><br><p>  Der Unterschied zur vorherigen Version besteht darin, dass nicht alle Netzwerkgewichte bei jeder Iteration aktualisiert werden müssen, sondern nur diejenigen, die einer kleinen Anzahl von Produkten entsprechen (das erste Produkt ist dasjenige, für das wir eine Vorhersage treffen, der Rest ist entweder ein Produkt aus seinem Kontext oder zufällig ausgewählt )  Gleichzeitig haben wir bei jeder Iteration eine große Anzahl exponentieller Captures entfernt. </p><br><p>  Eine andere Technik, die wiederum die Qualität des resultierenden Modells verbessert, ist die Unterabtastung.  In diesem Fall nehmen wir absichtlich weniger häufig gefundene Waren zum Training, um das beste Ergebnis für seltene Waren zu erzielen. </p><br><h3>  Ergebnisse </h3><br><h4>  Verwandte Produkte </h4><br><p>  Wir haben also gelernt, wie man Vektoren für Waren erhält. Jetzt müssen wir die Angemessenheit und Anwendbarkeit unseres Modells überprüfen. </p><br><p>  Das folgende Bild zeigt das Produkt und seine nächsten Nachbarn im Kosinusmaß der Nähe. </p><br><img src="https://habrastorage.org/webt/n7/rp/ja/n7rpjaf-eyfsmq7mtmd6womojfw.jpeg" alt="Bild"><br><p>  Das Ergebnis sieht gut aus, aber Sie müssen numerisch überprüfen, wie gut unser Modell ist.  Zu diesem Zweck haben wir es auf die Aufgabe der Produktempfehlungen angewendet.  Für jedes Produkt empfehlen wir, in einem konstruierten Vektorraum zu kommen.  Wir haben das prod2vec-Modell mit einem viel einfacheren Modell verglichen, basierend auf Statistiken gemeinsamer Ansichten und dem Hinzufügen von Artikeln zum Warenkorb.  Für jedes Produkt in der Sitzung wurde eine Liste mit 7 Empfehlungen erstellt.  Die Kombination aller empfohlenen Produkte in der Sitzung wurde mit dem verglichen, was eine Person tatsächlich zum Warenkorb hinzugefügt hat.  Mit prod2vec haben wir in mehr als 40% der Sitzungen mindestens ein Produkt empfohlen, das dann in den Warenkorb gelegt wurde.  Zum Vergleich zeigt ein einfacherer Algorithmus eine Qualität von 34%. </p><br><p>  Die resultierende Vektorbeschreibung ermöglicht es uns nicht nur, nach den nächsten zu suchen (was durch ein einfacheres Modell erfolgen kann, wenn auch mit schlechterer Qualität).  Wir können überlegen, welche interessanten Nebenwirkungen mit unserem Modell gezeigt werden können. </p><br><h3>  Vektorarithmetik </h3><br><p>  Um zu veranschaulichen, dass die Vektoren die wahre Bedeutung von Waren tragen, können wir versuchen, Vektorarithmetik für sie zu verwenden.  Wie im Lehrbuchbeispiel zu word2vec (König - Mann + Frau = Königin) können wir uns beispielsweise fragen, welches Produkt ungefähr so ​​weit vom Drucker entfernt ist wie der Staubbeutel vom Staubsauger.  Der gesunde Menschenverstand schreibt vor, dass es sich um eine Art Verbrauchsmaterial handeln sollte, nämlich eine Patrone.  Unser Modell kann solche Muster erfassen: </p><br><img src="https://habrastorage.org/webt/m1/j5/ac/m1j5aca_jsyjupowx9yapcorpmo.png" alt="Bild"><br><br><h3>  Visualisierung des Produktraums </h3><br><p>  Um die Ergebnisse besser zu verstehen, können wir den Vektorraum von Waren in der Ebene visualisieren und die Dimension auf zwei reduzieren (in diesem Beispiel haben wir t-SNE verwendet). </p><br><img src="https://habrastorage.org/webt/_d/v8/m1/_dv8m1fmgufpknn_l1klly2wqwi.png" alt="Bild"><br><br>  Es ist deutlich zu sehen, dass verwandte Produkte Cluster bilden.  Zum Beispiel sind Cluster mit Textilien für das Schlafzimmer, männliche und weibliche Kleidung, Schuhe deutlich sichtbar.  Wir stellen erneut fest, dass dieses Modell nur auf der Grundlage der Geschichte der Benutzerinteraktionen mit Waren erstellt wurde. Wir haben beim Training nicht die Ähnlichkeit von Bildern oder Textbeschreibungen verwendet. <br><p>  Anhand der Abbildung des Raums können Sie auch sehen, wie Sie mithilfe des Modells Zubehör für Waren auswählen können.  Dazu müssen Sie Waren aus dem nächstgelegenen Cluster entnehmen, z. B. Sportartikel für T-Shirts und Mützen für warme Pullover empfehlen. </p><br><h3>  Pläne </h3><br><p>  Wir führen jetzt das Modell prod2vec in der Produktion ein, um Produktempfehlungen zu berechnen.  Die erhaltenen Vektoren können auch als Merkmale für andere Algorithmen für maschinelles Lernen verwendet werden, an denen unser Team beteiligt ist (Prognose der Nachfrage nach Waren, Rangfolge in Suche und Katalogen, persönliche Empfehlungen). </p><br><p>  In Zukunft planen wir, die auf der Site erhaltenen Einbettungen in Echtzeit zu implementieren.  Für alle angesehenen Waren befinden sich die nächsten in der Sitzung, was sich sofort in der personalisierten Lieferung widerspiegelt.  Wir planen auch, die Bildanalyse und Ähnlichkeitsanalyse gemäß der Vektorbeschreibung in unser Modell zu integrieren, wodurch die Qualität der resultierenden Vektoren erheblich verbessert wird. </p><br><p>  Wenn Sie wissen, wie man das am besten macht (oder neu macht), kommen Sie zu Besuch (und arbeiten Sie noch besser). </p><br><p>  <b>Referenzen:</b> </p><br><ol><li>  Mikolov, Tomas et al.  "Verteilte Darstellungen von Wörtern und Phrasen und deren Zusammensetzung."  Fortschritte in neuronalen Informationsverarbeitungssystemen.  2013. </li><li>  Grbovic, Mihajlo et al.  "E-Commerce in Ihrem Posteingang: Produktempfehlungen im Maßstab."  Tagungsband der 21. ACM SIGKDD International Conference on Knowledge Discovery und Data Mining.  ACM, 2015. </li><li>  Grbovic, Mihajlo und Haibin Cheng.  "Personalisierung in Echtzeit mithilfe von Einbettungen für das Suchranking bei Airbnb."  Vorträge der 24. Internationalen ACM SIGKDD-Konferenz zu Knowledge Discovery &amp; Data Mining.  ACM, 2018. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de432760/">https://habr.com/ru/post/de432760/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de432748/index.html">Tipps und Tricks von Kubernetes: Knotenzuweisung und Laden von Webanwendungen</a></li>
<li><a href="../de432750/index.html">Die Freude von Haxe. Ein Roman mit einer vernachlässigten Programmiersprache</a></li>
<li><a href="../de432752/index.html">Ameisenhügel oder Festung? Ich baue ein Haus zum Preis einer Wohnung. 3 Teil. Stromversorgung</a></li>
<li><a href="../de432754/index.html">Datenspeicherung In-Memory und On-Disk werden der Öffentlichkeit zugänglich gemacht</a></li>
<li><a href="../de432756/index.html">Wir implementieren Barrierefreiheitsunterstützung, ohne die visuelle Komponente der mobilen Anwendung zu ändern</a></li>
<li><a href="../de432762/index.html">Ein KI-Lügendetektor kann erkennen, wann eine Person liegt</a></li>
<li><a href="../de432764/index.html">UDB. Was ist das</a></li>
<li><a href="../de432766/index.html">So codieren Sie eine geheime Nachricht in einen Fingerabdruck</a></li>
<li><a href="../de432768/index.html">Drahtlose Kopfhörer für "Serienmarathons": In Dolby werden sie für 599 US-Dollar angeboten</a></li>
<li><a href="../de432770/index.html">Botnets und ihre Typen: Was ist 2018 bekannt?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>