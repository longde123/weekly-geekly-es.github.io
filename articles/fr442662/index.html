<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔷 😥 👨🏻‍🎓 Comment regarder SDDL et ne pas casser les yeux sur les points-virgules 🖐🏾 🤘🏽 ⛵️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mon chemin vers la sécurité de l'information a commencé par une découverte surprenante: «cryptée en toute sécurité». Cette déclaration semble maintena...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment regarder SDDL et ne pas casser les yeux sur les points-virgules</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pm/blog/442662/"><img src="https://habrastorage.org/webt/an/hd/to/anhdtognmb0n09yu9hgh1cyducg.png"><br><br>  Mon chemin vers la sécurité de l'information a commencé par une découverte surprenante: «cryptée en toute sécurité».  Cette déclaration semble maintenant simple et évidente, et au cours de la première année, la prise de conscience de ce fait a produit un effet comparable à la bombe atomique mentale.  La sécurité de l'information a été attaquée en étendant les limites du domaine: il s'est avéré que la cryptographie n'est qu'une ligne de défense, et il y a aussi au final juridique, organisationnelle et simplement physique.  L'un des aspects théoriques était "Tous les problèmes de sécurité de l'information sont décrits par l'accès des sujets aux objets."  Il a mémorisé, dessiné les modèles d'identification et d'accès discrétionnaire, raconté, réussi et oublié. <br><br>  Je me spécialise dans l'analyse de sécurité des applications Windows.  Assez souvent, l'étude de droits d'accès précisément différents occupe une part importante de l'étude.  Pour automatiser le processus de recherche de droits d'accès étranges ou incorrects, j'ai dû comprendre le SDDL (Security Descriptor Definition Language).  Qui souhaite apprendre à lire les droits sous forme de SDDL (par exemple, quelque chose comme <b>O: SYG: SYD: (A ;; CCLCSWLOCRRC ;;; IU) (A ;; CCLCSWLOCRRC ;;; SU) (A ;; CCLCSWRPWPDTLOCRRC ;;; SY) (A ;; CCDCLCSWRPWPDTLOCRSDRCWDWO ;;; BA)</b> ) et familiarisez-vous avec mon utilitaire pour travailler avec des descripteurs dans ce format, bienvenue à cat. <br><a name="habracut"></a><br><h2>  <font color="orange">Format SDDL</font> </h2><br>  SDDL est une chaîne avec des descriptions des droits d'accès sous forme de texte.  Le plus souvent, il se compose de 3 parties: propriétaire, groupe et droits d'accès DACL.  Parfois, la partie SACL est ajoutée - la partie audit (si les actions avec l'objet correspondent aux règles SACL, un événement système sera créé qui sera facile à suivre par divers systèmes).  Le descripteur ressemble à ceci: <br><br>  O: &lt;propriétaire&gt; G: &lt;groupe&gt; D: &lt;règles d'accès DACL&gt; S: &lt;règles d'audit SACL&gt; <br><br><img src="https://habrastorage.org/webt/wn/vg/oj/wnvgojdxtm7uz3qpq_tqwebbxuu.png"><br><br>  Ainsi, l'exemple ci-dessus peut être décomposé comme suit: <br><ul><li>  O: SY </li><li>  G: SY </li><li>  D: (A ;; CCLCSWLOCRRC ;;; IU) (A ;; CCLCSWLOCRRC ;;; SU) (A ;; CCLCSWRPWPDTLOCRRC ;;; SY) (A ;; CCDCLCSWRPWPDTLOCRSDRCWDWO ;;; BA) </li></ul><br>  Le propriétaire et le groupe peuvent être indiqués comme le SID de l'utilisateur ou du groupe de l'OS, ou comme abréviations spéciales.  Par exemple, dans ce cas, le propriétaire et le groupe SY sont le compte système local (NT AUTHORITY \ SYSTEM).  La liste des abréviations (malheureusement non exhaustive) se trouve <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Les règles d'accès consistent en une énumération des drapeaux DACL et des chaînes ACE (Access Control Entries).  Une analyse détaillée de l'ACE est présentée <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> , nous considérerons les plus importantes.  Chaque ligne ACE est placée entre parenthèses dans lesquelles les données sont séparées par un point-virgule. <br>  Les premier, troisième et dernier groupes sont les plus intéressants.  Il s'agit du type d'accès (autorisé «A», interdit «D»), d'une liste d'actions et du nom du sujet d'accès.  La première règle DACL de l'exemple ci-dessus: (A ;; CCLCSWLOCRRC ;;; IU), nous allons l'examiner en détail. <br><br><img src="https://habrastorage.org/webt/7d/__/o6/7d__o6fgbxas7azzzqmu24ou27k.png"><br><br><ul><li>  «A» - la règle autorise des actions au sujet; </li><li>  «CC», «LC», «SW», «LO», «CR», «RC» - une liste d'actions autorisées; </li><li>  «IU» - cette abréviation signifie le groupe d'utilisateurs connectés interactifs. </li></ul><br>  Reste à comprendre ce qui est exactement autorisé.  Que signifient ces mystérieux «CC», «LC», «SW», «LO», «CR», «RC»? <br><br>  Ici, nous attendons un autre écueil - il n'est pas toujours possible d'indiquer précisément l'action par réduction.  Ils sont, pour ainsi dire, spécifiques au contexte.  Par exemple, si nous parlons des droits de travailler avec des services, alors WP signifie «arrêter le service», s'il s'agit de fichiers, puis «exécution», et s'il s'agit de dossiers, puis «traverser» (accès aux fichiers dans un dossier par nom, si ce n'est pas possible liste des contenus).  Certaines descriptions sont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> , d'autres <a href="">ici</a> , avec le monde sur un fil. <br><br><div class="spoiler">  <b class="spoiler_title">Hé, vous avez tellement manqué sur les drapeaux DACL, les drapeaux ACE, l'héritage</b> <div class="spoiler_text">  Oui, c'est vrai, tout cela est très important et intéressant, mais ce n'est pas si courant.  Je me concentre sur la masse.  Dans le cas de manifestations uniques de drapeaux inhabituels, il sera plus facile à comprendre en mode manuel. <br></div></div><br><h2>  <font color="orange">Automatisation</font> </h2><br>  Les utilitaires Sysinternals m'aident vraiment, à savoir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Process Monitor</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Access Check</a> (également connu sous le nom de procmon et accesschk).  Le premier vous permet de consulter les accès aux fichiers et au registre en temps réel, et le second vous permet de collecter des informations du système d'exploitation sur les descripteurs de sécurité. <br><br>  Soit dit en passant, dans le système d'exploitation lui-même, la fenêtre avec les droits ressemble à ceci si quelqu'un n'a pas vu: <br><br><img src="https://habrastorage.org/webt/ft/9t/vz/ft9tvzevuox0vy0yia5vta812k8.png"><br><br>  Malheureusement, la sortie d’accesschk ne peut pas être filtrée en restreignant la demande de droits sur des actions spécifiques.  Process Monitor affiche uniquement les appels réels à un moment donné et vous obtenez une demande trop précise qui n'est pas directement affectée.  De plus, j'aimerais avoir un mémo sur quel type de groupe d'utilisateurs est <abbr title="Opérateurs de réseau">NO</abbr> ou <abbr title="Compte de service réseau">NS</abbr> , et quels types d'actions sont cachés derrière CC et RC. <br><br>  Un utilitaire simple est donc né pour visualiser et filtrer les enregistrements SDDL. <br><br><h2>  <font color="orange">Comment utiliser</font> </h2><br>  Travailler avec l'utilitaire est simple, en seulement trois étapes: <br><br><ol><li>  Obtenez des enregistrements SDDL. </li><li>  Définissez des filtres de règles. </li><li>  Afficher le rapport. </li></ol><br><img src="https://habrastorage.org/webt/ly/ul/kd/lyulkdqjevgwn8iqpejwekonkia.png"><br><br>  En savoir plus sur chaque étape. <br><br>  Obtenir SDDL.  Pour obtenir des enregistrements SDDL, vous pouvez utiliser les fonctions intégrées à l'utilitaire (boutons 1, 2, 3 ou 4), ou télécharger la liste que vous avez reçue précédemment (bouton 5).  Veuillez noter que la demande de droits d'accès est faite au nom de l'utilisateur qui a lancé SDDL Viewer, donc dans certaines situations, il vaut la peine d'exécuter le programme non seulement en tant qu'utilisateur normal, mais également en tant qu'administrateur.  Eh bien, en général, le champ lui-même avec des lignes SDDL est modifiable - vous pouvez au moins le réécrire manuellement. <br><br>  Le filtrage s'effectue selon deux paramètres: les groupes d'utilisateurs et les droits d'accès.  La liste des groupes et des utilisateurs est basée sur tous les utilisateurs mentionnés dans le SDDL.  Faites attention à la case à cocher Traduire les SID (6) - si elle est installée, les SID des utilisateurs et des groupes seront, si possible, traduits en noms relatifs à l'ordinateur actuel.  La liste des droits est un peu plus délicate - vous devez sélectionner la catégorie de droits (si le SDDL est rempli avec l'utilitaire lui-même, alors la catégorie nécessaire est automatiquement sélectionnée) De plus, les droits présents dans le SDDL sont plus clairement mis en évidence dans la liste des droits. <br><br>  Le rapport est simplement le résultat du décryptage de SDDL et de l'application de filtres.  Vous pouvez trouver des informations plus détaillées sur chaque ligne si vous la sélectionnez dans la liste (oui, c'est avec cette fonction que j'ai eu un gag, ce qui a donné lieu à une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">petite recherche sur les internes .NET</a> ). <br><br><h2>  <font color="orange">Résumé</font> </h2><br>  Le code source est disponible sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> .  Les fichiers binaires sont également dans la section <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Release</a> . <br><br>  Mes plans d'utilité: <br><br><ol><li>  Ajoutez une recherche aux champs de saisie de SDDL - le filtrage ne suffit toujours pas. </li><li>  Ajoutez des paramètres de lancement qui permettraient de créer des rapports sans partie visuelle. </li><li>  Peut-être devriez-vous ajouter un remplissage SDDL à partir des processus, des dossiers partagés et des imprimantes? </li></ol><br>  Je serai heureux d'entendre des suggestions dans les commentaires. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr442662/">https://habr.com/ru/post/fr442662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr442650/index.html">Analyse et optimisation des applications React</a></li>
<li><a href="../fr442652/index.html">Utilisation de Fastify et de Preact pour prototyper rapidement des applications Web</a></li>
<li><a href="../fr442654/index.html">Passer à Next.js et accélérer 7,5 fois le chargement de la page d'accueil de manifold.co</a></li>
<li><a href="../fr442658/index.html">8 astuces pour travailler avec CSS: parallaxe, pied de page collant et autres</a></li>
<li><a href="../fr442660/index.html">Mathématiques réconciliant Newton avec le monde quantique</a></li>
<li><a href="../fr442664/index.html">QIWI Kitchen 6 février - comment c'était + présentations des conférenciers</a></li>
<li><a href="../fr442666/index.html">Post-post, méta-méta. Nous apprenons à écrire sur Habr</a></li>
<li><a href="../fr442668/index.html">Carte Intel SGX. Chaque serveur mérite son SGX</a></li>
<li><a href="../fr442670/index.html">Carsten Zero se produira aux PHDays 9</a></li>
<li><a href="../fr442672/index.html">Comment donner votre avis: 9 règles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>