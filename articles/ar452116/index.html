<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คด๐พ ๐ ๐ฉ๐ฝโ๐คโ๐จ๐ป ููุงุฑุณ ูู ุจูุณุชุฌุฑุณ - 8 (ุฑู) โช๏ธ ๐ถ โบ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฏ ูุงูุดูุง ุจุงููุนู ูุญุฑู ููุฑุณุฉ PostgreSQL ุ ููุงุฌูุฉ ุทุฑู ุงููุตูู ุ ูุทุฑู ุงููุตูู ุงูุฑุฆูุณูุฉ ุ ูุซู: ููุงุฑุณ ุงูุชุฌุฒุฆุฉ ุ ู B- tree ุ ู GiST ุ ู SP-GiST ุ ู GIN . ูู ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููุงุฑุณ ูู ุจูุณุชุฌุฑุณ - 8 (ุฑู)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/452116/" style=";text-align:right;direction:rtl">  ููุฏ ูุงูุดูุง ุจุงููุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญุฑู ููุฑุณุฉ</a> PostgreSQL ุ ููุงุฌูุฉ ุทุฑู ุงููุตูู ุ ูุทุฑู ุงููุตูู ุงูุฑุฆูุณูุฉ ุ ูุซู: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุฑุณ ุงูุชุฌุฒุฆุฉ</a> ุ ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">B-</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">tree</a> ุ ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GiST</a> ุ ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SP-GiST</a> ุ ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GIN</a> .  ูู ูุฐู ุงูููุงูุฉ ุ ุณูุฑุงูุจ ููู ูุชุญูู ุงูุฌู ุฅูู ุฑู. <br><br><h1 style=";text-align:right;direction:rtl">  ุฑู </h1><br>  ุนูู ุงูุฑุบู ูู ุฃู ุงููุคูููู ูุฏุนูู ุฃู ุงูุฌู ูู ุฌูู ููู ุ ุฅูุง ุฃู ููุฑุฉ ุงููุดุฑูุจุงุช ูุฏ ูุงุฒุช ูู ุงูููุงูุฉ: ุฃุทูู ุนูู ุงูุฌูู ุงูุชุงูู ูู GIN ุงุณู ุฑู. <br><br>  ุชุนูู ุทุฑููุฉ ุงููุตูู ูุฐู ุนูู ุชูุณูุน ุงูููููู ุงูุฐู ูููู ุนููู GIN ูุชููููุง ูู ุฅุฌุฑุงุก ุงูุจุญุซ ุนู ุงููุต ุงููุงูู ุจุดูู ุฃุณุฑุน.  ูู ูุฐู ุงูุณูุณูุฉ ูู ุงูููุงูุงุช ุ ูุฐู ูู ุงูุทุฑููุฉ ุงููุญูุฏุฉ ุงูุชู ูู ูุชู ุชุถููููุง ูู ุชุณููู PostgreSQL ุงูููุงุณู ููู ุงูุชุฏุงุฏ ุฎุงุฑุฌู.  ุชุชููุฑ ุงูุนุฏูุฏ ูู ุฎูุงุฑุงุช ุงูุชุซุจูุช ูุฐูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฎุฐ ุญุฒูุฉ "yum" ุฃู "apt" ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณุชูุฏุน PGDG</a> .  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ููุช ุจุชุซุจูุช PostgreSQL ูู ุญุฒูุฉ "postgresql-10" ุ ููู ุฃูุถูุง ุจุชุซุจูุช "postgresql-10-rum". </li><li style=";text-align:right;direction:rtl">  ุจูุงุก ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุดูุฑุฉ ุงููุตุฏุฑ ุนูู ุฌูุซุจ</a> ูุชุซุจูุช ุจููุณู (ุงูุชุนูููุงุช ููุงู ุฃูุถุง). </li><li style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏู ูุฌุฒุก ูู Postgres Pro Enterprise (ุฃู ุนูู ุงูุฃูู ูุฑุงุกุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> ูู ููุงู). </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุญุฏูุฏ ุงูุฌู </h2><br>  ูุง ูู ูููุฏ GIN ุงูุชู ููููููุง RUM ูู ุชุฌุงูุฒูุงุ <br><br>  ุฃููุงู ุ ูุง ูุญุชูู ููุน ุงูุจูุงูุงุช "tsvector" ุนูู ูุนุฌู ููุท ุ ุจู ูุญุชูู ุฃูุถูุง ุนูู ูุนูููุงุช ุญูู ููุงุถุนูุง ุฏุงุฎู ุงููุณุชูุฏ.  ููุง ูุงุญุธูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ุงููุฑุฉ ุงูุฃุฎูุฑุฉ</a> ุ ูุง ูุฎุฒู ูุคุดุฑ GIN ูุฐู ุงููุนูููุงุช.  ููุฐุง ุงูุณุจุจ ุ ูุฅู ุนูููุงุช ุงูุจุญุซ ุนู ุงูุนุจุงุฑุงุช ุ ุงูุชู ุธูุฑุช ูู ุงูุฅุตุฏุงุฑ 9.6 ุ ูุฏุนููุฉ ูู ูุจู ููุฑุณ GIN ุจุดูู ุบูุฑ ูุนุงู ูุนูููุง ุงููุตูู ุฅูู ุงูุจูุงูุงุช ุงูุฃุตููุฉ ูุฅุนุงุฏุฉ ุงููุญุต. <br><br>  ุซุงููุงู ุ ุชููู ุฃูุธูุฉ ุงูุจุญุซ ุนุงุฏุฉู ุจุฅุฑุฌุงุน ุงููุชุงุฆุฌ ูุฑุชุจุฉ ุญุณุจ ุงูุตูุฉ (ูููุง ูุงู ุฐูู ูุนูู).  ูููููุง ุงุณุชุฎุฏุงู ุฏุงูุงุช ุงูุชุตููู "ts_rank" ู "ts_rank_cd" ูุชุญููู ูุฐู ุงูุบุงูุฉ ุ ูููู ูุฌุจ ุญุณุงุจูุง ููู ุตู ูู ุงููุชูุฌุฉ ุ ููู ุจุทูุก ุจุงูุชุฃููุฏ. <br><br>  ุจุงููุณุจุฉ ููุชูุฑูุจ ุงูุฃูู ุ ูููู ุงุนุชุจุงุฑ ุทุฑููุฉ ุงููุตูู ุฅูู RUM ุจูุซุงุจุฉ GIN ุงูุชู ุชุฎุฒู ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ูุนูููุงุช ุงููููุน ููููู ุฃู ุชุนุฑุถ ุงููุชุงุฆุฌ ุจุงูุชุฑุชูุจ ุงููุทููุจ (ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GiST</a> ููููู ุฅุฑุฌุงุน ุฃูุฑุจ ุงูุฌูุฑุงู).  ุฏุนูุง ููุชูู ุฎุทูุฉ ุจุฎุทูุฉ. <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ุงูุจุญุซ ุนู ุงูุนุจุงุฑุงุช </h2><br>  ูููู ุฃู ูุญุชูู ุงุณุชุนูุงู ุจุญุซ ุงููุต ุงููุงูู ุนูู ุนูุงูู ุชุดุบูู ุฎุงุตุฉ ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุงููุณุงูุฉ ุจูู lexemes.  ุนูู ุณุจูู ุงููุซุงู ุ ูููููุง ุงูุนุซูุฑ ุนูู ุงููุณุชูุฏุงุช ุงูุชู ูุชู ูููุง ูุตู "ุงููุฏ" ุนู "ุงููุฎุฐ" ุจูููุชูู ุฃุฎุฑููู: <br><br><pre style=";text-align:right;direction:rtl"><code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> to_tsvector(<span class="hljs-string"><span class="hljs-string">'Clap your hands, slap your thigh'</span></span>) @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'hand &lt;3&gt; thigh'</span></span>);</code> </pre> <pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ?column? ---------- t (1 row)</code> </pre><br>  ุฃู ูููููุง ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุงููููุงุช ูุฌุจ ุฃู ุชููู ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> to_tsvector(<span class="hljs-string"><span class="hljs-string">'Clap your hands, slap your thigh'</span></span>) @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'hand &lt;-&gt; slap'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ?column? ---------- t (1 row)</code> </pre><br>  ูููู ูููุฑุณ GIN ุงููุนุชุงุฏ ุฅุฑุฌุงุน ุงููุณุชูุฏุงุช ุงูุชู ุชุญุชูู ุนูู ููุง ุงููุบุชูู ุ ููู ูุง ูููููุง ุงูุชุญูู ูู ุงููุณุงูุฉ ุจููููุง ุฅูุง ูู ุฎูุงู ุงูุจุญุซ ูู tsvector: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> to_tsvector(<span class="hljs-string"><span class="hljs-string">'Clap your hands, slap your thigh'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> to_tsvector -------------------------------------- 'clap':1 'hand':3 'slap':4 'thigh':6 (1 row)</code> </pre><br>  ูู ููุฑุณ RUM ุ ูุง ูุดูุฑ ูู lexeme ููุท ุฅูู ุตููู ุงูุฌุฏูู: ูุชู ุชุฒููุฏ ูู TID ุจูุงุฆูุฉ ุงูููุงุถุน ุงูุชู ูุญุฏุซ ูููุง lexeme ูู ุงููุณุชูุฏ.  ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ูููููุง ุจูุง ุชุตูุฑ ุงูููุฑุณ ุงูุฐู ุชู ุฅูุดุงุคู ุนูู ุฌุฏูู "slit-sheet" ุ ููู ุจุงููุนู ูุฃููู ูุฏููุง (ูุชู ุงุณุชุฎุฏุงู ูุฆุฉ ูุดุบู "rum_tsvector_ops" ูู tsvector ุงูุชุฑุงุถููุง): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">extension</span></span> rum; postgres=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ts <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> rum(doc_tsv);</code> </pre><br><br><img src="https://habrastorage.org/webt/k0/up/gn/k0upgnbhka1wfwq6oozy9qo24ka.png"><br><br>  ุงููุฑุจุนุงุช ุงูุฑูุงุฏูุฉ ูู ุงูุดูู ุชุญุชูู ุนูู ูุนูููุงุช ุงููููุน ุงููุถุงูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> ctid, left(doc,<span class="hljs-number"><span class="hljs-number">20</span></span>), doc_tsv <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ctid | left | doc_tsv -------+----------------------+--------------------------------------------------------- (0,1) | Can a sheet slitter | 'sheet':3,6 'slit':5 'slitter':4 (0,2) | How many sheets coul | 'could':4 'mani':2 'sheet':3,6 'slit':8 'slitter':7 (0,3) | I slit a sheet, a sh | 'sheet':4,6 'slit':2,8 (1,1) | Upon a slitted sheet | 'sheet':4 'sit':6 'slit':3 'upon':1 (1,2) | Whoever slit the she | 'good':7 'sheet':4,8 'slit':2 'slitter':9 'whoever':1 (1,3) | I am a sheet slitter | 'sheet':4 'slitter':5 (2,1) | I slit sheets. | 'sheet':3 'slit':2 (2,2) | I am the sleekest sh | 'ever':8 'sheet':5,10 'sleekest':4 'slit':9 'slitter':6 (2,3) | She slits the sheet | 'sheet':4 'sit':6 'slit':2 (9 rows)</code> </pre><br>  ูููุฑ GIN ุฃูุถูุง ุงูุฅุฏุฑุงุฌ ุงููุคุฌู ุนูุฏ ุชุญุฏูุฏ ูุนููุฉ "fastupdate" ุ  ุชุชู ุฅุฒุงูุฉ ูุฐู ุงููุธููุฉ ูู RUM. <br><br>  ููุฑู ููู ูุนูู ุงูููุฑุณ ุนูู ุงูุจูุงูุงุช ุงูุญูุฉ ุ ุฏุนูุง ูุณุชุฎุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฑุดูู</a> ุงููุฃููู ููุงุฆูุฉ ุจุฑูุฏ ุงููุงูุฑุฒ pgsql. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> tsv <span class="hljs-type"><span class="hljs-type">tsvector</span></span>; fts=# <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> default_text_search_config = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; fts=# <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> tsv = to_tsvector(body_plain);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">... UPDATE 356125</code> </pre><br>  ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ูุชู ุจูุง ุชูููุฐ ุงุณุชุนูุงู ูุณุชุฎุฏู ุงูุจุญุซ ุนู ุงูุนุจุงุฑุงุช ุจุงุณุชุฎุฏุงู ููุฑุณ GIN: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> tsv_gin <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> gin(tsv); fts=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'hello &lt;-&gt; hackers'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN --------------------------------------------------------------------------------- Bitmap Heap Scan on mail_messages (actual time=2.490..18.088 rows=259 loops=1) Recheck Cond: (tsv @@ to_tsquery('hello &lt;-&gt; hackers'::text)) Rows Removed by Index Recheck: 1517 Heap Blocks: exact=1503 -&gt; Bitmap Index Scan on tsv_gin (actual time=2.204..2.204 rows=1776 loops=1) Index Cond: (tsv @@ to_tsquery('hello &lt;-&gt; hackers'::text)) Planning time: 0.266 ms Execution time: 18.151 ms (8 rows)</code> </pre><br>  ููุง ูุฑู ูู ุงูุฎุทุฉ ุ ูุชู ุงุณุชุฎุฏุงู ูุคุดุฑ GIN ุ ูููู ููุฑุฌุน 1776 ูู ุงูุชุทุงุจูุงุช ุงููุญุชููุฉ ุ ูููุง 259 ุชุฑูุช ู 1517 ูุชู ุฅุณูุงุทูุง ูู ูุฑุญูุฉ ุฅุนุงุฏุฉ ุงููุญุต. <br><br>  ุฏุนูุง ูุญุฐู ูุคุดุฑ GIN ููุจูู RUM. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> tsv_gin; fts=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> tsv_rum <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> rum(tsv);</code> </pre><br>  ูุญุชูู ุงูููุฑุณ ุงูุขู ุนูู ุฌููุน ุงููุนูููุงุช ุงููุงุฒูุฉ ุ ููุชู ุฅุฌุฑุงุก ุงูุจุญุซ ุจุฏูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'hello &lt;-&gt; hackers'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN -------------------------------------------------------------------------------- Bitmap Heap Scan on mail_messages (actual time=2.798..3.015 rows=259 loops=1) Recheck Cond: (tsv @@ to_tsquery('hello &lt;-&gt; hackers'::text)) Heap Blocks: exact=250 -&gt; Bitmap Index Scan on tsv_rum (actual time=2.768..2.768 rows=259 loops=1) Index Cond: (tsv @@ to_tsquery('hello &lt;-&gt; hackers'::text)) Planning time: 0.245 ms Execution time: 3.053 ms (7 rows)</code> </pre><br><h2 style=";text-align:right;direction:rtl">  ุงูุชุฑุชูุจ ุญุณุจ ุงูุตูุฉ </h2><br>  ูุฅุฑุฌุงุน ุงููุณุชูุฏุงุช ุจุณูููุฉ ุจุงูุชุฑุชูุจ ุงููุทููุจ ุ ูุฏุนู ููุฑุณ RUM ุนูุงูู ุชุดุบูู ุงูุทูุจูุฉ ุ ูุงูุชู ูุงูุดูุงูุง ูู ููุงูุฉ ูุชุนููุฉ ุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GiST</a> .  ููุนุฑูู ุงูุชุฏุงุฏ RUM ูุซู ูุฐุง ุงููุดุบู ุ <code>&lt;=&gt;</code> ุ ูุงูุฐู ููุฑุฌุน ูุณุงูุฉ ูุง ุจูู ุงููุณุชูุฏ ("tsvector") ูุงูุงุณุชุนูุงู ("tsquery").  ุนูู ุณุจูู ุงููุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> to_tsvector(<span class="hljs-string"><span class="hljs-string">'Can a sheet slitter slit sheets?'</span></span>) &lt;=&amp;gtl to_tsquery(<span class="hljs-string"><span class="hljs-string">'slit'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ?column? ---------- 16.4493 (1 row)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> to_tsvector(<span class="hljs-string"><span class="hljs-string">'Can a sheet slitter slit sheets?'</span></span>) &lt;=&gt; to_tsquery(<span class="hljs-string"><span class="hljs-string">'sheet'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ?column? ---------- 13.1595 (1 row)</code> </pre><br>  ูุจุฏู ุฃู ุงููุณุชูุฏ ุฃูุซุฑ ุตูุฉ ุจุงูุงุณุชุนูุงู ุงูุฃูู ููู ููุงุณุชุนูุงู ุงูุซุงูู: ูููุง ุชุญุฏุซุช ุงููููุฉ ูุซูุฑูุง ุ ูููุง ูุงูุช "ุงููููุฉ" ุฃูู. <br><br>  ุฏุนููุง ูุญุงูู ูุฑุฉ ุฃุฎุฑู ููุงุฑูุฉ GIN ู RUM ุจุญุฌู ุจูุงูุงุช ูุจูุฑ ูุณุจููุง: ุณูุฎุชุงุฑ ุนุดุฑุฉ ูุณุชูุฏุงุช ุฐุงุช ุตูุฉ ุชุญุชูู ุนูู "hello" ู "hackers". <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'hello &amp; hackers'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> ts_rank(tsv,to_tsquery(<span class="hljs-string"><span class="hljs-string">'hello &amp; hackers'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN --------------------------------------------------------------------------------------------- Limit (actual time=27.076..27.078 rows=10 loops=1) -&gt; Sort (actual time=27.075..27.076 rows=10 loops=1) Sort Key: (ts_rank(tsv, to_tsquery('hello &amp; hackers'::text))) Sort Method: top-N heapsort Memory: 29kB -&gt; Bitmap Heap Scan on mail_messages (actual ... rows=1776 loops=1) Recheck Cond: (tsv @@ to_tsquery('hello &amp; hackers'::text)) Heap Blocks: exact=1503 -&gt; Bitmap Index Scan on tsv_gin (actual ... rows=1776 loops=1) Index Cond: (tsv @@ to_tsquery('hello &amp; hackers'::text)) Planning time: 0.276 ms Execution time: 27.121 ms (11 rows)</code> </pre><br>  ููุฑุฌุน ูุคุดุฑ GIN 1776 ูู ุงูุชุทุงุจูุงุช ุ ูุงูุชู ูุชู ุชุตููููุง ูุฎุทูุฉ ูููุตูุฉ ูุชุญุฏูุฏ ุฃูุถู 10 ูุชุงุฆุฌ. <br><br>  ุจุงุณุชุฎุฏุงู ููุฑุณ RUM ุ ูุชู ุชูููุฐ ุงูุงุณุชุนูุงู ุจุงุณุชุฎุฏุงู ูุณุญ ููุฑุณ ุจุณูุท: ูุง ูุชู ูุญุต ุฃู ูุณุชูุฏุงุช ุฅุถุงููุฉ ุ ููุง ููุฒู ุฅุฌุฑุงุก ูุฑุฒ ูููุตู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'hello &amp; hackers'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> tsv &lt;=&gt; to_tsquery(<span class="hljs-string"><span class="hljs-string">'hello &amp; hackers'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN -------------------------------------------------------------------------------------------- Limit (actual time=5.083..5.171 rows=10 loops=1) -&gt; Index Scan using tsv_rum on mail_messages (actual ... rows=10 loops=1) Index Cond: (tsv @@ to_tsquery('hello &amp; hackers'::text)) Order By: (tsv &lt;=&gt; to_tsquery('hello &amp; hackers'::text)) Planning time: 0.244 ms Execution time: 5.207 ms (6 rows)</code> </pre><br><h2 style=";text-align:right;direction:rtl">  ูุนูููุงุช ุงุถุงููุฉ </h2><br>  ูููู ุจูุงุก ููุฑุณ RUM ุ ููุฐูู GIN ุ ุนูู ุนุฏุฉ ุญููู.  ูููู ุจูููุง ุชุฎุฒู GIN lexemes ูู ูู ุนููุฏ ุจุดูู ูุณุชูู ุนู ุชูู ุงูููุฌูุฏุฉ ูู ุนููุฏ ุขุฎุฑ ุ ูุฅู RUM ุชููููุง ูู "ุฑุจุท" ุงูุญูู ุงูุฑุฆูุณู ("tsvector" ูู ูุฐู ุงูุญุงูุฉ) ุจุญูู ุฅุถุงูู.  ููููุงู ุจุฐูู ุ ูุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ูุฆุฉ ูุดุบู ูุชุฎุตุตุฉ "rum_tsvector_addon_ops": <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> rum(tsv RUM_TSVECTOR_ADDON_OPS, sent) <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (ATTACH=<span class="hljs-string"><span class="hljs-string">'sent'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">TO</span></span>=<span class="hljs-string"><span class="hljs-string">'tsv'</span></span>);</code> </pre><br>  ูููููุง ุงุณุชุฎุฏุงู ูุฐุง ุงูููุฑุณ ูุฅุฑุฌุงุน ุงููุชุงุฆุฌ ุงููุตููุฉ ูู ุงูุญูู ุงูุฅุถุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> id, sent, sent &lt;=&gt; <span class="hljs-string"><span class="hljs-string">'2017-01-01 15:00:00'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'hello'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> sent &lt;=&gt; <span class="hljs-string"><span class="hljs-string">'2017-01-01 15:00:00'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> id | sent | ?column? ---------+---------------------+---------- 2298548 | 2017-01-01 15:03:22 | 202 2298547 | 2017-01-01 14:53:13 | 407 2298545 | 2017-01-01 13:28:12 | 5508 2298554 | 2017-01-01 18:30:45 | 12645 2298530 | 2016-12-31 20:28:48 | 66672 2298587 | 2017-01-02 12:39:26 | 77966 2298588 | 2017-01-02 12:43:22 | 78202 2298597 | 2017-01-02 13:48:02 | 82082 2298606 | 2017-01-02 15:50:50 | 89450 2298628 | 2017-01-02 18:55:49 | 100549 (10 rows)</code> </pre><br>  ูุญู ููุง ูุจุญุซ ุนู ูุทุงุจูุฉ ุงูุตููู ูุชููู ุฃูุฑุจ ููุช ูููู ูู ุงูุชุงุฑูุฎ ุงููุญุฏุฏ ุ ุจุบุถ ุงููุธุฑ ูู ููุช ุณุงุจู ุฃู ูู ููุช ูุงุญู.  ููุญุตูู ุนูู ุงููุชุงุฆุฌ ุงูุชู ุชุณุจู (ุฃู ุชุชุจุน) ุงูุชุงุฑูุฎ ุงููุญุฏุฏ ุจุฏูุฉ ุ ูุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู <code>&lt;=|</code>  (ุฃู <code>|=&gt;</code> ) ุงููุดุบู. <br><br>  ููุง ูู ูุชููุน ุ ูุชู ุชูููุฐ ุงูุงุณุชุนูุงู ููุท ุนู ุทุฑูู ูุณุญ ููุฑุณ ุจุณูุท: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">ts=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> id, sent, sent &lt;=&gt; <span class="hljs-string"><span class="hljs-string">'2017-01-01 15:00:00'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'hello'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> sent &lt;=&gt; <span class="hljs-string"><span class="hljs-string">'2017-01-01 15:00:00'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN --------------------------------------------------------------------------------- Limit -&gt; Index Scan using mail_messages_tsv_sent_idx on mail_messages Index Cond: (tsv @@ to_tsquery('hello'::text)) Order By: (sent &lt;=&gt; '2017-01-01 15:00:00'::timestamp without time zone) (4 rows)</code> </pre><br>  ุฅุฐุง ุฃูุดุฃูุง ุงูููุฑุณ ุจุฏูู ูุนูููุงุช ุฅุถุงููุฉ ุญูู ุงูุชุฑุงู ุงูุญูู ุ ููุงุณุชุนูุงู ุงูููุงุซู ุ ูุณูุถุทุฑ ุฅูู ูุฑุฒ ุฌููุน ูุชุงุฆุฌ ูุณุญ ุงูููุฑุณ. <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุงูุชุงุฑูุฎ ุ ูููููุง ุจุงูุชุฃููุฏ ุฅุถุงูุฉ ุญููู ุฃููุงุน ุงูุจูุงูุงุช ุงูุฃุฎุฑู ุฅูู ููุฑุณ RUM.  ุชูุฑูุจุง ุฌููุน ุฃููุงุน ุงูููุงุนุฏ ูุฏุนููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูููู ููุชุฌุฑ ุนูู ุงูุฅูุชุฑูุช ุนุฑุถ ุงูุจุถุงุฆุน ุจุณุฑุนุฉ ุญุณุจ ุงูุฌุฏุฉ (ุงูุชุงุฑูุฎ) ุ ูุงูุณุนุฑ (ุฑููู) ุ ูุดุนุจูุฉ ุฃู ูููุฉ ุงูุฎุตู (ุนุฏุฏ ุตุญูุญ ุฃู ููุทุฉ ุนุงุฆูุฉ). <br><br><h2 style=";text-align:right;direction:rtl">  ูุฆุงุช ุงููุดุบููู ุงูุฃุฎุฑู </h2><br>  ูุฅููุงู ุงูุตูุฑุฉ ุ ููุจุบู ุฃู ูุฐูุฑ ูุฆุงุช ุงููุดุบููู ุงูุฃุฎุฑู ุงููุชุงุญุฉ. <br><br>  ููุจุฏุฃ ุจู <strong>"rum_tsvector_hash_ops"</strong> ู <strong>"rum_tsvector_hash_addon_ops"</strong> .  ุฅููุง ุชุดุจู "rum_tsvector_ops" ุงูุฐู ุชูุช ููุงูุดุชู ุจุงููุนู ู "rum_tsvector_addon_ops" ุ ููู ุงูููุฑุณ ูุฎุฒู ุฑูุฒ ุดูุฑุฉ lexeme ุจุฏูุงู ูู lexeme ููุณู.  ูููู ุฃู ูููู ูุฐุง ุญุฌู ุงูููุฑุณ ุ ูููู ุจุงูุทุจุน ุ ูุตุจุญ ุงูุจุญุซ ุฃูู ุฏูุฉ ููุชุทูุจ ุฅุนุงุฏุฉ ุงููุญุต.  ุฅูู ุฌุงูุจ ุฐูู ุ ูู ูุนุฏ ุงูููุฑุณ ูุฏุนู ุงูุจุญุซ ุนู ุงูุชุทุงุจู ุงูุฌุฒุฆู. <br><br>  ูู ุงููุซูุฑ ููุงูุชูุงู ุฃู ููุธุฑ ุฅูู ูุฆุฉ ูุดุบู <strong>"rum_tsquery_ops"</strong> .  ุฅููุง ุชููููุง ูู ุญู ูุดููุฉ "ูุนููุณุฉ": ุงูุนุซูุฑ ุนูู ุงุณุชุนูุงูุงุช ุชุทุงุจู ุงููุณุชูุฏ.  ููุงุฐุง ูููู ุฃู ุชููู ููุงู ุญุงุฌุฉ ููุฐุงุ  ุนูู ุณุจูู ุงููุซุงู ุ ูุงุดุชุฑุงู ุงููุณุชุฎุฏู ูู ุณูุน ุฌุฏูุฏุฉ ููููุง ููุฑุดุญู ุฃู ูุชุตููู ุงููุณุชูุฏุงุช ุงูุฌุฏูุฏุฉ ุชููุงุฆููุง.  ุงูุธุฑ ุฅูู ูุฐุง ุงููุซุงู ุงูุจุณูุท: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> categories(query <span class="hljs-type"><span class="hljs-type">tsquery</span></span>, category <span class="hljs-type"><span class="hljs-type">text</span></span>); fts=# <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> categories <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (to_tsquery(<span class="hljs-string"><span class="hljs-string">'vacuum | autovacuum | freeze'</span></span>), <span class="hljs-string"><span class="hljs-string">'vacuum'</span></span>), (to_tsquery(<span class="hljs-string"><span class="hljs-string">'xmin | xmax | snapshot | isolation'</span></span>), <span class="hljs-string"><span class="hljs-string">'mvcc'</span></span>), (to_tsquery(<span class="hljs-string"><span class="hljs-string">'wal | (write &amp; ahead &amp; log) | durability'</span></span>), <span class="hljs-string"><span class="hljs-string">'wal'</span></span>); fts=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> categories <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> rum(query); fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> array_agg(category) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> categories <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> to_tsvector( <span class="hljs-string"><span class="hljs-string">'Hello hackers, the attached patch greatly improves performance of tuple freezing and also reduces size of generated write-ahead logs.'</span></span> ) @@ query;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> array_agg -------------- {vacuum,wal} (1 row)</code> </pre><br>  ุชู ุชุตููู ูุฆุงุช ุงููุดุบููู ุงููุชุจููุฉ <strong>"rum_anyarray_ops"</strong> ู <strong>"rum_anyarray_addon_ops"</strong> ููุนุงูุฌุฉ ุงููุตูููุงุช ุจุฏูุงู ูู "tsvector".  ูููุด ูุฐุง ุจุงููุนู ูู ุฃุฌู GIN <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ุงููุฑุฉ ุงูุฃุฎูุฑุฉ</a> ููุง ูุญุชุงุฌ ุฅูู ุชูุฑุงุฑ. <br><br><h2 style=";text-align:right;direction:rtl">  ุฃุญุฌุงู ุงูููุฑุณ ูุณุฌู ุงููุชุงุจุฉ (WAL) </h2><br>  ูู ุงููุงุถุญ ุฃูู ูุธุฑูุง ูุฃู RUM ูุฎุฒู ูุนูููุงุช ุฃูุซุฑ ูู GIN ุ ููุฌุจ ุฃู ูููู ุญุฌูู ุฃูุจุฑ.  ููุง ููุงุฑู ุฃุญุฌุงู ุงูููุงุฑุณ ุงููุฎุชููุฉ ูู ุงููุฑุฉ ุงูุฃุฎูุฑุฉ.  ุฏุนูุง ูุถูู RUM ุฅูู ูุฐุง ุงูุฌุฏูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> rum | gin | gist | btree --------+--------+--------+-------- 457 MB | 179 MB | 125 MB | 546 MB</code> </pre><br>  ููุง ูุฑู ุ ููุง ุงูุญุฌู ุจุดูู ูุจูุฑ ุ ููู ูุง ููุซู ุชูููุฉ ุงูุจุญุซ ุงูุณุฑูุน. <br><br>  ูุฌุฏุฑ ุงูุงูุชุจุงู ุฅูู ููุทุฉ ุฃุฎุฑู ุบูุฑ ูุงุถุญุฉ: RUM ุนุจุงุฑุฉ ุนู ุงูุชุฏุงุฏ ุ ุฃู ุฃูู ูููู ุชุซุจูุชู ุฏูู ุฃู ุชุนุฏููุงุช ุนูู ุฌููุฑ ุงููุธุงู.  ุชู ุชูููู ูุฐุง ูู ุงูุฅุตุฏุงุฑ 9.6 ุจูุถู ุชุตุญูุญ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃููุณูุฏุฑ ููุฑูุชููู</a> .  ูุงุญุฏุฉ ูู ุงููุดุงูู ุงูุชู ูุงู ูุง ุจุฏ ูู ุญููุง ููุฐู ุงูุบุงูุฉ ูู ุฅูุดุงุก ุณุฌูุงุช ุงูุณุฌู.  ูุฌุจ ุฃู ุชููู ุชูููุฉ ุชุณุฌูู ุงูุนูููุงุช ููุซููุฉ ุชูุงููุง ุ ูุจุงูุชุงูู ุ ูุง ูููู ุชุฑู ุงูุชุฏุงุฏ ููุฐุง ุงููุทุจุฎ.  ุจุฏูุงู ูู ุงูุณูุงุญ ููุงูุชุฏุงุฏ ุจุฅูุดุงุก ุฃููุงุน ุณุฌูุงุช ุงูุณุฌู ุงูุฎุงุตุฉ ุจู ุ ูุชู ุชูููุฐ ูุง ููู: ุฑูุฒ ุงูุงูุชุฏุงุฏ ูุจูุบ ุนู ุนุฒูู ุนูู ุชุนุฏูู ุงูุตูุญุฉ ูุฅุฌุฑุงุก ุฃู ุชุบููุฑุงุช ุนูููุง ูุงูุฅุดุงุฑุงุช ุฅูู ุงูุฅููุงู ููู ุฌููุฑ ุงููุธุงู ุ ุงูุฐู ููุงุฑู ุงูุฅุตุฏุงุฑุงุช ุงููุฏููุฉ ูุงูุฌุฏูุฏุฉ ูู ุงูุตูุญุฉ ููููุฏ ุณุฌูุงุช ุณุฌู ููุญุฏุฉ ูุทููุจุฉ. <br><br>  ุชููู ุฎูุงุฑุฒููุฉ ุฅูุดุงุก ุงูุณุฌู ุงูุญุงููุฉ ุจููุงุฑูุฉ ุจุงูุชุงุช ุงูุจุงูุช ุ ูุงููุดู ุนู ุงูุฃุฌุฒุงุก ุงููุญุฏูุซุฉ ุ ูุชุณุฌูู ูู ูู ูุฐู ุงูุฃุฌุฒุงุก ุ ูุน ุฅุฒุงุญุชูุง ูู ุจุฏุงูุฉ ุงูุตูุญุฉ.  ูุฐุง ูุนูู ุจุดูู ุฌูุฏ ุนูุฏ ุชุญุฏูุซ ุนุฏุฉ ุจุงูุช ููุท ุฃู ุงูุตูุญุฉ ุจุฃููููุง.  ูููู ุฅุฐุง ุฃุถููุง ุฌุฒุกูุง ูู ุงูุตูุญุฉ ุ ูููู ุจุงูู ุงููุญุชูู ูุฃุณูู (ุฃู ุงูุนูุณ ุ ุฃุฒู ุฌุฒุกูุง ุ ูููู ุงููุญุชูู ูุฃุนูู) ุ ูุณูุชุบูุฑ ุนุฏุฏ ุงูุจุงูุชุงุช ุจุดูู ููุญูุธ ุฃูุซุฑ ููุง ุชูุช ุฅุถุงูุชู ุฃู ุฅุฒุงูุชู ุจุงููุนู. <br><br>  ููุฐุง ุงูุณุจุจ ุ ูุฏ ูุคุฏู ุชุบููุฑ ููุฑุณ RUM ุจุดูู ููุซู ุฅูู ุฅูุดุงุก ุณุฌูุงุช ุณุฌู ุฐุงุช ุญุฌู ุฃูุจุฑ ุจูุซูุฑ ูู GIN (ูุงูุชู ุ ููููุง ููุณุช ุงูุชุฏุงุฏูุง ุ ูููู ุฌุฒุกูุง ูู ุงูุฃุณุงุณ ุ ุชุฏูุฑ ุงูุณุฌู ูู ุชููุงุก ููุณู).  ูุนุชูุฏ ูุฏู ูุฐุง ุงูุชุฃุซูุฑ ุงููุฒุนุฌ ุฅูู ุญุฏ ูุจูุฑ ุนูู ุนุจุก ุงูุนูู ุงููุนูู ุ ูููู ููุญุตูู ุนูู ูุธุฑุฉ ุซุงูุจุฉ ููุฐู ุงููุดููุฉ ุ ุฏุนููุง ูุญุงูู ุฅุฒุงูุฉ ูุฅุถุงูุฉ ุนุฏุฏ ูู ุงูุตููู ุนุฏุฉ ูุฑุงุช ุ ุชุดุงุจู ูุฐู ุงูุนูููุงุช ูุน "ูุฑุงุบ".  ูููููุง ุชูููู ุญุฌู ุณุฌูุงุช ุงูุณุฌู ุนูู ุงููุญู ุงูุชุงูู: ูู ุงูุจุฏุงูุฉ ูุงูููุงูุฉ ุ ุชุฐูุฑ ุงูููุถุน ูู ุงูุณุฌู ุจุงุณุชุฎุฏุงู ูุธููุฉ "pg_current_wal_location" ("pg_current_xlog_location" ูู ุงูุฅุตุฏุงุฑุงุช ุงูุฃูุฏู ูู ุนุดุฑุฉ) ุซู ุงูุธุฑ ุงููุฑู. <br><br>  ูููู ุจุงูุทุจุน ุ ูุฌุจ ุนูููุง ุงููุธุฑ ูู ุงููุซูุฑ ูู ุงูุฌูุงูุจ ููุง.  ูุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุฃู ูุณุชุฎุฏููุง ูุงุญุฏูุง ููุท ูุนูู ูุน ุงููุธุงู (ูุฅูุง ุ ุณูุชู ุฃุฎุฐ ุงูุณุฌูุงุช "ุงูุฅุถุงููุฉ" ูู ุงูุงุนุชุจุงุฑ).  ุญุชู ุฅุฐุง ูุงู ุงูุฃูุฑ ูุฐูู ุ ููุญู ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ููุณ ููุท RUM ุ ูููู ุฃูุถูุง ุชุญุฏูุซุงุช ุงูุฌุฏูู ููุณู ูุงูููุฑุณ ุงูุฐู ูุฏุนู ุงูููุชุงุญ ุงูุฃุณุงุณู.  ุชุคุซุฑ ููู ูุนููุงุช ุงูุชูููู ุฃูุถูุง ุนูู ุงูุญุฌู (ุชู ุงุณุชุฎุฏุงู ูุณุชูู ุงูุณุฌู "ุงููุชูุงุซูุฉ" ุ ุฏูู ุถุบุท ุ ููุง).  ูููู ุฏุนููุง ูุญุงูู ุนูู ุฃู ุญุงู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> pg_current_wal_location() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> start_lsn \gset</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> mail_messages(parent_id, sent, subject, author, body_plain, tsv) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> parent_id, sent, subject, author, body_plain, tsv <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> id % <span class="hljs-number"><span class="hljs-number">100</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">INSERT 0 3576</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> id % <span class="hljs-number"><span class="hljs-number">100</span></span> = <span class="hljs-number"><span class="hljs-number">99</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">DELETE 3590</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">vacuum</span></span> mail_messages;</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> mail_messages(parent_id, sent, subject, author, body_plain, tsv) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> parent_id, sent, subject, author, body_plain, tsv <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> id % <span class="hljs-number"><span class="hljs-number">100</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">INSERT 0 3605</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> id % <span class="hljs-number"><span class="hljs-number">100</span></span> = <span class="hljs-number"><span class="hljs-number">98</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">DELETE 3637</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">vacuum</span></span> mail_messages;</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> mail_messages(parent_id, sent, subject, author, body_plain, tsv) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> parent_id, sent, subject, author, body_plain, tsv <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> id % <span class="hljs-number"><span class="hljs-number">100</span></span> = <span class="hljs-number"><span class="hljs-number">2</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">INSERT 0 3625</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> id % <span class="hljs-number"><span class="hljs-number">100</span></span> = <span class="hljs-number"><span class="hljs-number">97</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">DELETE 3668</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">vacuum</span></span> mail_messages;</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> pg_current_wal_location() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> end_lsn \gset fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> pg_size_pretty(:<span class="hljs-string"><span class="hljs-string">'end_lsn'</span></span>::pg_lsn - :<span class="hljs-string"><span class="hljs-string">'start_lsn'</span></span>::pg_lsn);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> pg_size_pretty ---------------- 3114 MB (1 row)</code> </pre><br>  ูุฐูู ุ ูุญุตู ุนูู ุญูุงูู 3 ุบูุบุงุจุงูุช.  ูููู ุฅุฐุง ูุฑุฑูุง ููุณ ุงูุชุฌุฑุจุฉ ูุน ููุฑุณ GIN ุ ูุฅู ูุฐุง ูู ูุคุฏู ุฅูุง ุฅูู ุญูุงูู 700 ููุฌุงุจุงูุช. <br><br>  ูุฐูู ุ ูู ุงููุณุชุญุณู ุฃู ูููู ูุฏูู ุฎูุงุฑุฒููุฉ ูุฎุชููุฉ ุ ูุงูุชู ุณูู ุชุฌุฏ ุงูุญุฏ ุงูุฃุฏูู ูู ุนูููุงุช ุงูุฅุฏุฑุงุฌ ูุงูุญุฐู ุงูุชู ูููู ุฃู ุชุญูู ุญุงูุฉ ุงูุตูุญุฉ ุฅูู ุฃุฎุฑู.  ุชุนูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ "Diff" ุจุทุฑููุฉ ููุงุซูุฉ.  ููุฏ ููุฐ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃูููุบ ุฅููุงููู</a> ุจุงููุนู ูุซู ูุฐู ุงูุฎูุงุฑุฒููุฉ ุ ูุชุฌุฑู ููุงูุดุฉ ุชุตุญูุญู.  ูู ุงููุซุงู ุฃุนูุงู ุ ูุชูุญ ููุง ูุฐุง ุงูุชุตุญูุญ ุชูููู ุญุฌู ุณุฌูุงุช ุงูุณุฌู ุจููุฏุงุฑ 1.5 ูุฑุฉ ุ ุฅูู 1900 ููุฌุงุจุงูุช ุ ุนูู ุญุณุงุจ ุชุจุงุทุค ุจุณูุท. <br><br><blockquote style=";text-align:right;direction:rtl">  ูุณูุก ุงูุญุธ ุ ุชู ุชุนููู ุงูุชุตุญูุญ ููู ููู ููุงู ุฃู ูุดุงุท ุญููู. <br></blockquote><br><h2 style=";text-align:right;direction:rtl">  ุฎุตุงุฆุต </h2><br>  ูุงูุนุงุฏุฉ ุ ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุฎุตุงุฆุต ุทุฑููุฉ ุงููุตูู ุฅูู RUM ุ ูุน ุงูุงูุชุจุงู ุฅูู ุงูุงุฎุชูุงูุงุช ูู GIN ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชู ุชูุฏูู</a> ุงูุงุณุชุนูุงูุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุงููุนู</a> ). <br><br>  ูููุง ููู ุฎุตุงุฆุต ุทุฑููุฉ ุงููุตูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> amname | name | pg_indexam_has_property --------+---------------+------------------------- rum | can_order | f rum | can_unique | f rum | can_multi_col | t rum | can_exclude | t -- f for gin</code> </pre><br>  ุชุชููุฑ ุฎุตุงุฆุต ุทุจูุฉ ุงูููุฑุณ ุงูุชุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> name | pg_index_has_property ---------------+----------------------- clusterable | f index_scan | t -- f for gin bitmap_scan | t backward_scan | f</code> </pre><br>  ูุงุญุธ ุฃูู ุ ุนูู ุนูุณ GIN ุ ูุฏุนู RUM ูุญุต ุงูููุฑุณ - ูุฅูุง ุ ููู ูููู ูู ุงููููู ุฅุฑุฌุงุน ุงูุนุฏุฏ ุงููุทููุจ ูู ุงููุชุงุฆุฌ ูู ุงูุงุณุชุนูุงูุงุช ูุน ุฌููุฉ "ุงูุญุฏ" ุจุงูุถุจุท.  ููุณุช ููุงู ุญุงุฌุฉ ููุธูุฑ ุงููุนููุฉ "gin_fuzzy_search_limit" ููููุง ูุฐูู.  ููุชูุฌุฉ ูุฐูู ุ ูููู ุงุณุชุฎุฏุงู ุงูููุฑุณ ูุฏุนู ูููุฏ ุงูุงุณุชุจุนุงุฏ. <br><br>  ูููุง ููู ุฎุตุงุฆุต ุทุจูุฉ ุงูุนููุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> name | pg_index_column_has_property --------------------+------------------------------ asc | f desc | f nulls_first | f nulls_last | f orderable | f distance_orderable | t -- f for gin returnable | f search_array | f search_nulls | f</code> </pre><br>  ุงููุฑู ููุง ูู ุฃู RUM ูุฏุนู ูุดุบูู ุงูุทูุจุงุช.  ููุน ุฐูู ุ ูุง ููุทุจู ุฐูู ุนูู ุฌููุน ูุฆุงุช ุงููุดุบููู: ุนูู ุณุจูู ุงููุซุงู ุ ูุฐุง ุบูุฑ ุตุญูุญ ูู "tsquery_ops". <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑุฃ ุนูู</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar452116/">https://habr.com/ru/post/ar452116/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar452106/index.html">ูุฏุนู ุงููุชุญุฏุซูู ุฅูู ุงูุงุฌุชูุงุน ุงูุตููู DIY ูู 16 ููููู 2019</a></li>
<li><a href="../ar452108/index.html">ุนุงูู ุงููููุงุก: ูุตูุญุฉ ุบูุฑ ุถุงุฑุฉ</a></li>
<li><a href="../ar452110/index.html">ุฃุชูุชุฉ ุงุณุชุจุฏุงู ุงููุฑุต ูุน Ansible</a></li>
<li><a href="../ar452112/index.html">CRM ++</a></li>
<li><a href="../ar452114/index.html">HolyJS 2019: ุงุณุชุฎูุงุต ุงููุนูููุงุช ูู SEMrush (ุงูุฌุฒุก 1)</a></li>
<li><a href="../ar452118/index.html">ุนุงูู ููุณุฑ ุฑูุฒ ุงููุฎุทูุท ุงูุบุงูุถ ููููููุชุด</a></li>
<li><a href="../ar452122/index.html">"ุญุจูุจ ููุน ุงูุญูู ูู ุดูุทุงู" ูู ุงูุญุฑูุฉ</a></li>
<li><a href="../ar452124/index.html">"ูุญู ุจุญุงุฌุฉ ุฅูู ุงูุฌูุน ูููุนุฑูุฉ ูุงูุฅูุฌุงุฒุงุช" - ููู ูููู ุงุฎุชุจุงุฑ ูู Alfa-Bank</a></li>
<li><a href="../ar452128/index.html">ุงูููุงููู ุงูุฎุงุทุฆุฉ ุงูุดุงุฆุนุฉ ุญูู ููุงููุฉ ุงูุฅุดุนุงุน ูู ุงูุฏูุงุฆุฑ ุงูุฏูููุฉ</a></li>
<li><a href="../ar452130/index.html">ุงูููุฑ ูุชููุต ุ ูุณุจุจ ุงูุฒูุงุฒู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>