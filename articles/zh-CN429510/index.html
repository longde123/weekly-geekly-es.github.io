<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚩 👨🏻‍🎨 🚁 适用于初学者的ArduPilot。 在BeagleBone Blue上安装和配置 🚍 📟 🎻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我们与来自哈勃（Habr）志趣相投的团队（ 您可以加入 ）一起开发了一种机器人，用于在练习场上收集高尔夫球 。 这是一个高度专业化的服务机器人，因此，我们计划同时开发一个软件和硬件复合体，以后可将其用作其他服务机器人和UGV的基础。 



 在上一篇文章中，我们描述了为什么我们停止使用该软件。 在...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>适用于初学者的ArduPilot。 在BeagleBone Blue上安装和配置</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/robogazon/blog/429510/">我们与来自哈勃（Habr）志趣相投的团队（ <b>您可以加入</b> ）一起开发了一种<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">机器人，用于</a>在练习<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">场上收集高尔夫球</a> 。 这是一个高度专业化的服务机器人，因此，我们计划同时开发一个软件和硬件复合体，以后可将其用作其他服务机器人和<b>UGV</b>的基础。 <br><br><img src="https://habrastorage.org/webt/3x/wy/of/3xwyof39bhwkwbvvqoyjqmxdmay.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在上一篇文章中，</a>我们描述了为什么我们停止使用该软件。 在设置项目时，我们使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了文章中</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">信息</a> 。 实际上，在这里，我们将提供此简要指南的翻译，也许对某人有用，它可以帮助您制造第一个或下一个机器人。 <br><a name="habracut"></a><br> 在开始之前，我想强调一点，值得使用BeagleBone Blue（它仍然是蓝色）。 通常，我们将连接很多与导航相关的外围设备，如果没有足够的功能，它们将无法正常工作。 <br><br><h2> 第1部分。准备BeagleBone </h2><br> 转到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://rcn-ee.net/rootfs/bb.org/testing/</a>并选择具有最新日期的目录。 然后打开<b>stretch-console</b>子目录。 在这里，您将看到几个文件。 下载名为<b>“ bone-debian-VV-console-armhf-20YY-MM-DD-1gb.img.xz”的文件</b> 。 这是仅包含必需品的最小Debian发行版。 另一种方法是IoT映像（IoT =物联网），它附带有其他软件，如果您不熟悉Linux，可以使工作更舒适。 可从同一站点获得。 <br><br> 我们使用： <a href="">https</a> : <a href="">//rcn-ee.net/rootfs/bb.org/testing/2018-10-07/stretch-console/bone-debian-9.5-console-armhf-2018-10-07-1gb.img .xz</a> 。 <br><br> 接下来，您将需要在microSD卡上刷新图像。 无论您使用Linux还是Windows，我都强烈建议您使用一个名为Etcher的程序来完成此任务（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://etcher.io/</a> ）。 <br><br> 现在，您可以从microSD卡下载BeagleBone Blue。 这超出了本文档的范围，无法详细描述所有交互方法，但是通常可以通过微型USB电缆或SSH（连接到“ debian@192.168.7.2”，密码“ temppwd”）或通过COM-port（将Debian用户'，密码'temppwd）插入minicom或PuTTY之类的程序中。 通过COM端口到Linux控制台的此连接。  BBB构建中的UART1始终绑定到控制台，首先绑定到U-boot，然后绑定到Linux。 可以在这里找到更多信息： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">//beagleboard.org/blue</a> <br><br>  Windows 10附带BeagleBone驱动程序。在Linux中，可能无法选择BBB作为通用USB COM端口。 如果您遇到问题，请尝试： <br><br><pre><code class="bash hljs">sudo -s cat &gt;/etc/udev/rules.d/73-beaglebone.rules &lt;&lt;EOF ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span>, SUBSYSTEM==<span class="hljs-string"><span class="hljs-string">"usb"</span></span>, ENV{DEVTYPE}==<span class="hljs-string"><span class="hljs-string">"usb_interface"</span></span>, ATTRS{idVendor}==<span class="hljs-string"><span class="hljs-string">"0403"</span></span>, ATTRS{idProduct}==<span class="hljs-string"><span class="hljs-string">"a6d0"</span></span>, DRIVER==<span class="hljs-string"><span class="hljs-string">""</span></span>, RUN+=<span class="hljs-string"><span class="hljs-string">"/sbin/modprobe -b ftdi_sio"</span></span> ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span>, SUBSYSTEM==<span class="hljs-string"><span class="hljs-string">"drivers"</span></span>, ENV{DEVPATH}==<span class="hljs-string"><span class="hljs-string">"/bus/usb-serial/drivers/ftdi_sio"</span></span>, ATTR{new_id}=<span class="hljs-string"><span class="hljs-string">"0403 a6d0"</span></span> ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span>, KERNEL==<span class="hljs-string"><span class="hljs-string">"ttyUSB*"</span></span>, ATTRS{interface}==<span class="hljs-string"><span class="hljs-string">"BeagleBone"</span></span>, ATTRS{bInterfaceNumber}==<span class="hljs-string"><span class="hljs-string">"00"</span></span>, SYMLINK+=<span class="hljs-string"><span class="hljs-string">"beaglebone-jtag"</span></span> ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span>, KERNEL==<span class="hljs-string"><span class="hljs-string">"ttyUSB*"</span></span>, ATTRS{interface}==<span class="hljs-string"><span class="hljs-string">"BeagleBone"</span></span>, ATTRS{bInterfaceNumber}==<span class="hljs-string"><span class="hljs-string">"01"</span></span>, SYMLINK+=<span class="hljs-string"><span class="hljs-string">"beaglebone-serial"</span></span> EOF udevadm control --reload-rules <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span></code> </pre> <br> 希望您现在已登录到命令行。 我们将从允许debian用户执行sudo开始，而不必每次（随后）输入密码： <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"debian ALL=(ALL) NOPASSWD: ALL"</span></span> | sudo tee -a /etc/sudoers.d/debian &gt;/dev/null</code> </pre><br> 下一项工作是使用可负担的互联网连接来更新和安装软件，因此该设置connman进行Wi-Fi接入了。 我这样做是因为它将为将来的工作提供便利。 首先，记下路由器的SSID和WiFi密码。 然后输入以下内容： <br><br><pre> <code class="bash hljs"> sudo -s connmanctl services | grep <span class="hljs-string"><span class="hljs-string">'&lt;your SSID&gt;'</span></span> | grep -Po <span class="hljs-string"><span class="hljs-string">'wifi_[^ ]+'</span></span></code> </pre><br> 答案将类似于以下内容：“ wifi_38d279e099a8_4254487562142d4355434b_managed_psk”。 如果您看不到任何内容，请重试-您可能输入了错字。 <br><br> 现在，使用此网络ID，我们将使用cat直接从键盘（stdin）输入文件，一次一行： <br><br><pre> <code class="bash hljs"> cat &gt;/var/lib/connman/wifi.config [service_&lt;your <span class="hljs-built_in"><span class="hljs-built_in">hash</span></span>&gt;] Type = wifi Security = wpa2 Name = &lt;your SSID&gt; Passphrase = &lt;your WiFi password&gt;</code> </pre><br> 重要！ 在按Ctrl + C之前，请确保按Enter，否则整个当前行将丢失。 <br> 按Ctrl-C退出，然后键入：exit <br><br> 可见的绿色LED指示灯将点亮，表示Wi-Fi已开启。  BBBlue已连接到路由器，您的Wi-Fi网络上的IP地址可以使用以下方式找到： <br><br><pre> <code class="bash hljs">ip addr show wlan0</code> </pre><br> 如果由于某种原因您不能直接请求BBBlue，请使用其他实用程序，例如nmap（sudo nmap 192.168.0.0/24）或登录到路由器并以其他方式查找那里的IP地址。 <br><br> 现在，尝试使用SSH的Wi-Fi IP地址通过SSH连接。 请记住，192.168.7.2也可以使用。 <br><br> 如果无法使WiFi与connman一起使用，或者只是不想使用connman，则可以使用以下方法。 首先，键入：sudo systemctl disable connman。 然后，使用您的SSID和WiFi密码，编辑/ etc / network / interfaces <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># The loopback network interface. auto lo iface lo inet loopback # WiFi w/ onboard device (dynamic IP). auto wlan0 iface wlan0 inet dhcp wpa-ssid "&lt;your SSID&gt;" wpa-psk "&lt;your WiFi password&gt;" dns-nameservers 8.8.8.8 1.1.1.1 # Ethernet/RNDIS gadget (g_ether). # Used by: /opt/scripts/boot/autoconfigure_usb0.sh iface usb0 inet static address 192.168.7.2 netmask 255.255.255.252 network 192.168.7.0 gateway 192.168.7.1</span></span></code> </pre><br> 现在使用以下<b>命令重新</b>加载BBBlue： <b>sudo reboot</b> <br><br> 登录后，输入：sudo ifup wlan0。 绿色LED应该点亮。 <br><br> 如果希望BB具有静态IP（例如192.168.0.99），请更改“＃WiFi w /板载设备（动态IP）。”部分/ etc / network / interface读取为： <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># WiFi w/ onboard device (static IP). auto wlan0 iface wlan0 inet static wpa-ssid "&lt;your SSID&gt;" wpa-psk "&lt;your WiFi password&gt;" address 192.168.0.99 # &lt;--- The desired static IP address of the BBBlue. netmask 255.255.255.0 gateway 192.168.0.1 # &lt;--- The address of your router. dns-nameservers 8.8.8.8 1.1.1.1</span></span></code> </pre><br> 更新和安装所有必要的支持程序： <br><br><pre> <code class="bash hljs">sudo apt-get -y update sudo apt-get -y dist-upgrade sudo apt-get install -y cpufrequtils git</code> </pre><br> 更新脚本：cd / opt /脚本＆＆git pull <br><br>  <b>实时内核当前包含错误！</b>  <b>使用以下修复程序：指定Ti实时内核4_4。</b>  <b>不要使用4_14。</b> <br><br><pre> <code class="bash hljs">sudo /opt/scripts/tools/update_kernel.sh --ti-rt-channel --lts-4_4 sudo sed -i <span class="hljs-string"><span class="hljs-string">'s|uboot_overlay_pru=/lib/firmware/AM335X-PRU-RPROC-4-14-TI-00A0.dtbo|#uboot_overlay_pru=/lib/firmware/AM335X-PRU-RPROC-4-14-TI-00A0.dtbo|g'</span></span> /boot/uEnv.txt sudo sed -i <span class="hljs-string"><span class="hljs-string">'s|#uboot_overlay_pru=/lib/firmware/AM335X-PRU-RPROC-4-4-TI-00A0.dtbo|uboot_overlay_pru=/lib/firmware/AM335X-PRU-RPROC-4-4-TI-00A0.dtbo|g'</span></span> /boot/uEnv.txt</code> </pre><br> 最后，将am335x-bone blue.dtb（从此存储库中的bin目录复制）复制到/boot/dtbs/4.4.113-ti-rt-r149 <br><br> 在自动运行时安装脚本 <br><br><pre> <code class="bash hljs">sudo sed -i <span class="hljs-string"><span class="hljs-string">'s/#dtb=/dtb=am335x-boneblue.dtb/g'</span></span> /boot/uEnv.txt</code> </pre><br> 设定频率 <br><br><pre> <code class="bash hljs">sudo sed -i <span class="hljs-string"><span class="hljs-string">'s/GOVERNOR="ondemand"/GOVERNOR="performance"/g'</span></span> /etc/init.d/cpufrequtils</code> </pre><br> 配置bb-wl18xx-wlan0.service <br><br><pre> <code class="bash hljs">sudo sed -i <span class="hljs-string"><span class="hljs-string">'s/RestartSec=5/RestartSec=1/g'</span></span> /lib/systemd/system/bb-wl18xx-wlan0.service</code> </pre><br> 配置bb-wl18xx-wlan0.service <br><br><pre> <code class="bash hljs">sudo sed -i <span class="hljs-string"><span class="hljs-string">'s/RestartSec=5/RestartSec=1/g'</span></span> /lib/systemd/system/bb-wl18xx-wlan0.service</code> </pre><br> 禁用蓝牙（可选） <br><br><pre> <code class="bash hljs">sudo systemctl <span class="hljs-built_in"><span class="hljs-built_in">disable</span></span> bb-wl18xx-bluetooth.service</code> </pre><br> 扩展现有的microSD卡分区（/ dev / mmcblk0p1）： <br><br><pre> <code class="bash hljs">sudo /opt/scripts/tools/grow_partition.sh</code> </pre><br> 立即重启： <br><br><pre> <code class="bash hljs">sudo reboot</code> </pre><br><h2> 第2部分。在BeagleBone上安装ArduPilot </h2><br> 当BeagleBone重新启动时，我们需要创建一些文本文件。 首先，完善环境配置文件，/ etc / default / ardupilot： <br>  <i>（提示：输入sudoedit / etc / default / ardupilot并插入您自己的目标IP地址，例如192.168.0.13）</i> <br><br><pre> <code class="bash hljs">TELEM1=<span class="hljs-string"><span class="hljs-string">"-C /dev/ttyO1"</span></span> TELEM2=<span class="hljs-string"><span class="hljs-string">"-A udp:&lt;target IP address&gt;:14550"</span></span> GPS=<span class="hljs-string"><span class="hljs-string">"-B /dev/ttyS2"</span></span></code> </pre><br> 这是相当典型的配置。 <br><br> 这是启动参数-C为BBBlue中的UART1映射ArduPilot的“ Telem1”串行端口（SERIAL1，默认为57600）。 例如，我有一个868x RFDesign无线电连接到UART1。 这是我的无人机的双向数据通道。 它向基站发送各种遥测数据，并从基站接收RTK命令和差分校正。 <br><br> 这是启动参数-A映射ArduPilot的“控制台”串行端口（SERIAL0，默认为115200），协议，目标IP地址和可选端口号。 例如，这使我可以通过Wi-Fi接收MAVLink数据以进行测试。 真的很有用，特别是因为数据可以立即转到Mission Planner和QGroundControl。 <br><br><img src="https://habrastorage.org/webt/3d/d7/m1/3dd7m1ilxlbkd3elqxnddq_1rcm.jpeg" alt="图片"><br><br> 这是启动参数-B映射ArduPilot的“ GPS”串行端口（SERIAL3，默认为57600）与Uart2 BBBlue（UART，在板上本身标记为“ GPS”）。 例如，我有一个连接到UART2的U-blox NEO-M8P。 <br><br> 还有其他可能性-还有其他启动选项，具有预定义的端口速度和端口本身： <br><br><pre> <code class="bash hljs">Switch -A --&gt; <span class="hljs-string"><span class="hljs-string">"Console"</span></span>, SERIAL0, default 115200 Switch -B --&gt; <span class="hljs-string"><span class="hljs-string">"GPS"</span></span>, SERIAL3, default 57600 Switch -C --&gt; <span class="hljs-string"><span class="hljs-string">"Telem1"</span></span>, SERIAL1, default 57600 Switch -D --&gt; <span class="hljs-string"><span class="hljs-string">"Telem2"</span></span>, SERIAL2, default 38400 Switch -E --&gt; Unnamed, SERIAL4, default 38400 Switch -F --&gt; Unnamed, SERIAL5, default 57600</code> </pre><br> 有关各种串行端口的更多信息，请参见ArduPilot官方文档： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http</a> ://ardupilot.org/plane/docs/parameters.html?highlight=parameters <br><br> 接下来，我们将创建ArduPilot systemd服务文件，其中一个用于ArduCopter，即/lib/systemd/system/arducopter.service： <br><br><pre> <code class="bash hljs">[Unit] Description=ArduCopter Service After=networking.service StartLimitIntervalSec=0 Conflicts=arduplane.service ardurover.service antennatracker.service [Service] EnvironmentFile=/etc/default/ardupilot ExecStartPre=/usr/bin/ardupilot/aphw ExecStart=/usr/bin/ardupilot/arducopter <span class="hljs-variable"><span class="hljs-variable">$TELEM1</span></span> <span class="hljs-variable"><span class="hljs-variable">$TELEM2</span></span> <span class="hljs-variable"><span class="hljs-variable">$GPS</span></span> Restart=on-failure RestartSec=1 [Install] WantedBy=multi-user.target</code> </pre><br> 一个用于ArduPlane的/lib/systemd/system/arduplane.service： <br><br><pre> <code class="bash hljs">[Unit] Description=ArduPlane Service After=networking.service StartLimitIntervalSec=0 Conflicts=arducopter.service ardurover.service antennatracker.service [Service] EnvironmentFile=/etc/default/ardupilot ExecStartPre=/usr/bin/ardupilot/aphw ExecStart=/usr/bin/ardupilot/arduplane <span class="hljs-variable"><span class="hljs-variable">$TELEM1</span></span> <span class="hljs-variable"><span class="hljs-variable">$TELEM2</span></span> <span class="hljs-variable"><span class="hljs-variable">$GPS</span></span> Restart=on-failure RestartSec=1 [Install] WantedBy=multi-user.target</code> </pre><br> 一个用于ArduRover的/lib/systemd/system/ardurover.service： <br><br><pre> <code class="bash hljs">[Unit] Description=ArduRover Service After=networking.service StartLimitIntervalSec=0 Conflicts=arducopter.service arduplane.service antennatracker.service [Service] EnvironmentFile=/etc/default/ardupilot ExecStartPre=/usr/bin/ardupilot/aphw ExecStart=/usr/bin/ardupilot/ardurover <span class="hljs-variable"><span class="hljs-variable">$TELEM1</span></span> <span class="hljs-variable"><span class="hljs-variable">$TELEM2</span></span> <span class="hljs-variable"><span class="hljs-variable">$GPS</span></span> Restart=on-failure RestartSec=1 [Install] WantedBy=multi-user.target</code> </pre><br> 那AntennaTracker呢？ 创建/lib/systemd/system/antennatracker.service： <br><br><pre> <code class="bash hljs">[Unit] Description=AntennaTracker Service After=networking.service StartLimitIntervalSec=0 Conflicts=arducopter.service arduplane.service ardurover.service [Service] EnvironmentFile=/etc/default/ardupilot ExecStartPre=/usr/bin/ardupilot/aphw ExecStart=/usr/bin/ardupilot/antennatracker <span class="hljs-variable"><span class="hljs-variable">$TELEM1</span></span> <span class="hljs-variable"><span class="hljs-variable">$TELEM2</span></span> <span class="hljs-variable"><span class="hljs-variable">$GPS</span></span> Restart=on-failure RestartSec=1 [Install] WantedBy=multi-user.target</code> </pre><br> 我们去sudo文件夹mkdir -p / usr / bin / ardupilot <br><br> 为ArduPilot创建一个铁配置文件，/ usr / bin / ardupilot / aphw，该文件在可执行文件之前运行。 <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # aphw # ArduPilot hardware configuration. /bin/echo 80 &gt;/sys/class/gpio/export /bin/echo out &gt;/sys/class/gpio/gpio80/direction /bin/echo 1 &gt;/sys/class/gpio/gpio80/value /bin/echo pruecapin_pu &gt;/sys/devices/platform/ocp/ocp:P8_15_pinmux/state</span></span></code> </pre><br>  5-7行包括BBBlue + 5V伺服电源，即使用伺服器时。  ESC不需要。 <br><br> 第8行包括PRU。 <br><br> 使用sudo chmod 0755 / usr / bin / ardupilot / aphw设置此文件的权限。 <br><br> 差不多发生了！ 现在，您应该获得专门为Arm BBBlue体系结构创建的最新ArduCopter，ArduPlane等可执行文件，并将它们放在/ usr / bin / ardupilot目录中。  Mirko Denecke将它们上传到他的网站上： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http</a> ://bbbmini.org/download/blue/ <br><br> 复制到此存储库： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">//github.com/imfatant/test/blob/master/bin/</a> <br><br> 不要忘记设置权限：sudo chmod 0755 / usr / bin / ardupilot / a * <br><br> 如果您发现需要从源代码进行编译，请不要害怕-并不是那么困难。 此外，这意味着您可以创建自己的ArduPilot软件。 <br><br> 在BBBlue本身上收集它们将花费太多时间。  Patrick Poirier在他的网站上解释了BBBMINI（基于黑色BeagleBone）的过程。 这是特定于BBBlue的过程，假定您已经完成了所有步骤，并且位于/ home / debian目录中： <br><br><pre> <code class="bash hljs">sudo apt-get install g++ make pkg-config python python-dev python-lxml python-pip sudo pip install future git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/ArduPilot/ardupilot <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ardupilot git checkout Copter-3.6 <span class="hljs-comment"><span class="hljs-comment"># &lt;-- For ArduCopter. git submodule update --init --recursive ./waf configure --board=blue # &lt;-- BeagleBone Blue. ./waf sudo cp ./build/blue/bin/a* /usr/bin/ardupilot</span></span></code> </pre><br>  Patrick还提供了在Ubuntu中相对强大的x64台式PC上交叉编译它们的说明，这要快得多。 <br><br> 根据您需要的软件选项 <br>  sudo systemctl启用arducopter.service <br> 或 <br>  sudo systemctl启用arduplane.service <br> 或 <br>  sudo systemctl启用ardurover.service <br> 或 <br>  sudo systemctl启用Antennatracker.service <br><br> 重新启动后，您的ArduPilot应该会自动启动。 您将看到闪烁的红色LED！ <br><br> 您可以签出systemctl（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.freedesktop.org/software/systemd/man/systemctl.html</a> ）。 一些有用的示例命令： <br><br><pre> <code class="bash hljs">sudo systemctl <span class="hljs-built_in"><span class="hljs-built_in">disable</span></span> ... sudo systemctl start ... sudo systemctl stop ...</code> </pre><br><h3> 第3部分。连接外围设备 </h3><br><img src="https://habrastorage.org/webt/fx/xo/ae/fxxoaey0otck_4ti6yl0p1dzbgu.jpeg" alt="图片"><br><br> 基本的最低配置可能包括： <br><br><ul><li>  R / C接收器。 </li><li>  GPS接收器（带或不带集成指南针）。 </li><li> 用于双向数据通道的无线电调制解调器，尤其是在长距离上。 </li><li>  （如果可用2.4 GHz，则内置WiFi BBBlue非常适合在近距离进行调试和测试，但对于更有趣的事情，建议使用专用的双向数据信道。也请记住使用所有这些元素的天线的类型和位置。 ） </li></ul><br> 关于所需的连接器，电缆和工具的几句话。 我将提供一些建议，否则，如果您是初学者，则可以花费很多时间，精力和金钱。 最常用的连接器类型是JST-SH 1.0 mm。 您必须购买4位和6位尺寸和压接触点的多个母连接器。 然后获得几米不同颜色的电线。 <br><br> 因此，回到连接外围设备： <br><br><img src="https://habrastorage.org/webt/h4/mq/7k/h4mq7kn51qxgbc4orkk4ghmluoo.jpeg"><br><br> 遥控接收器：可以在任何+ 5V触点和GND处关闭。 剩下的就是将接收器的SBUS输出，DSM输出或PPM输出连接到图中标记的两个SBUS引脚之一。 以下接收器已经过测试并且正在运行： <br><br>  FrSky（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.frsky-rc.com/</a> ）：R-XSR，XR4SB，X6R，X8R，R9 Slim和R9 Mini（欧盟LBT 868 MHz和通用915 MHz固件）。 <br><br>  Spektrum（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.spektrumrc.com/</a> ）：带有PPM / SRXL / Remote Rx的AR7700 DSMX。 <br><br>  TBS（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://team-blacksheep.com/</a> ）：带有Nano Rx的“完全”交火（Rx设置为SBUS模式）。 <br><br> 顺便说一下，他们谈论了很多有关“倒置SBUS”的问题。 实际上，SBUS只是Futaba发明并由FrSky复制的串行数据传输协议。 与“标准” UART相比，它是颠倒的。 幸运的是，Ardupilot Blue希望此SBUS信号反相，因此不需要信号反相器。 <br><br>  GPS接收器：大多数人都使用u-blox接收器，尤其是NEO-M8N和NEO-M8P。  NEO-M8N价格低廉，通常以磁盘形式从HobbyKing等中国公司获得。 方便地，它们包含接收器本身，一个非常小的陶瓷贴片天线，并且通常包括一个指南针。 尽管BBBlue已经具有内置指南针（AKM AK8963），但可以将ArduPilot配置为使用此“外部”指南针而不是其自身，以防止干扰。 <br><br>  NEO-M8P是NEO-M8N的（更）昂贵的替代方案。 该接收器支持一种称为“ RTK”或实时运动学的工作模式，可以实时实现几厘米的定位精度。 但是，这种演示的价格是NEO-M8N的10倍左右，而且没有基站。 在手册的后面，我将对M8P进行专门的说明。 <br><br>  I2C ArduPilot配置文件：/var/APM/{ArduCopter.stg,ArduPlane.stg,APMrover2.stg,AntennaTracker.stg} <br><br><pre> <code class="bash hljs">sudo apt-get install i2c-tools sudo i2cdetect -r -y 0 sudo i2cdetect -r -y 1 sudo i2cdetect -r -y 2</code> </pre><br><pre> <code class="bash hljs">$ sudo i2cdetect -r -y 2 0 1 2 3 4 5 6 7 8 9 abcdef 00: -- -- -- -- -- -- -- -- -- 0c -- -- -- 10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 60: -- -- -- -- -- -- -- -- 68 -- -- -- -- -- -- -- 70: -- -- -- -- -- -- 76 --</code> </pre><br>  68 = InvenSense MPU-9250 IMU（板载），0c = AKM AK8963指南针（板载），76 = Bosch BMP280气压计（板载）。 <br><br><pre> <code class="bash hljs">$ sudo i2cdetect -r -y 1 0 1 2 3 4 5 6 7 8 9 abcdef 00: -- -- -- -- -- -- -- -- -- -- -- -- -- 10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- 1e -- 20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 70: -- -- -- -- -- -- -- --</code> </pre><br>  1e =霍尼韦尔HMC5843指南针（外部）-通常集成到基于u-blox NEO-M8N的GPS模块中。 <br><br><h2> 地面控制站（GCS）软件入门 </h2><br> 下载适用于Windows的任何任务计划程序（http://firmware.ardupilot.org/Tools/MissionPlanner/MissionPlanner-latest.msi）或适用于Linux和Windows的QGroundControl（http://qgroundcontrol.com/）。 这两个程序都将连接到通过网络（例如，通过UDP端口14550）或COM端口进入的MAVLink数据流。 <br><br><h2> 选配 </h2><br> 给基于无人机的bbblue配备蓝牙扬声器会很有趣，前提是蓝牙RF传输不会干扰任何其他系统。  BlueZ / PulseAudio / ALSA上有大量信息，但是幸运的是，它归结为非常简单的内容。 <br><br>  a）首先安装必要的软件（使用控制台或IoT映像）： <br><br><pre> <code class="bash hljs"> sudo apt-get install -y bluetooth pulseaudio pulseaudio-module-bluetooth alsa-utils</code> </pre><br>  b）启用蓝牙（如果禁用）：sudo systemctl启用bb-wl18xx-bluetooth.service <br><br>  c）编辑/etc/pulse/default.pa： <br><pre> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment">### Automatically suspend sinks/sources that become idle for too long # load-module module-suspend-on-idle</span></span></code> </pre><br>  d）重新启动：sudo重新启动 <br><br>  e）加载BBBlue之后，以连接模式打开Bluetooth列： <br><br><pre> <code class="bash hljs"> bluetoothctl scan on agent on default-agent pair &lt;Bluetooth speaker<span class="hljs-string"><span class="hljs-string">'s MAC address&gt; # &lt;--- eg AB:58:EC:5C:0C:03 connect &lt;Bluetooth speaker'</span></span>s MAC address&gt; <span class="hljs-comment"><span class="hljs-comment"># &lt;--- Sometimes unnecessary. trust &lt;Bluetooth speaker's MAC address&gt; scan off exit</span></span></code> </pre><br>  f）最后： <br><br><pre> <code class="bash hljs"> pulseaudio --start <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"connect &lt;Bluetooth speaker's MAC address&gt;"</span></span> | bluetoothctl pactl list <span class="hljs-comment"><span class="hljs-comment"># &lt;--- Use this to check that your Bluetooth speaker has been picked up by PulseAudio. pacmd set-card-profile 0 a2dp_sink aplay /usr/share/sounds/alsa/Front_Center.wav</span></span></code> </pre><br> 仅此而已！ 顺便说一句，如果您要使用语音合成器，我建议您使用Festival。 <br><br> 如果您想提供帮助-请在LAN或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">VK</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FB中</a>给我写信。 <br><br><img src="https://habrastorage.org/webt/mt/lh/91/mtlh91x8jag1t-ibt_np3uayuke.jpeg" alt="图片">  <a href="">habrastorage.org/webt/mt/lh/91/mtlh91x8jag1t-ibt_np3uayuke.jpeg</a> <br><br> 感谢您的阅读，询问和完全批评我们。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN429510/">https://habr.com/ru/post/zh-CN429510/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN429500/index.html">“做生意的时间”终于飞逝</a></li>
<li><a href="../zh-CN429502/index.html">发展交叉竞争力是否值得</a></li>
<li><a href="../zh-CN429504/index.html">如何调用音频vk方法</a></li>
<li><a href="../zh-CN429506/index.html">我们着眼于新版Gmail</a></li>
<li><a href="../zh-CN429508/index.html">报告摘要“如何成为数据库专家”（HL2018，Data Egret，Ilya Kosmodemyansky）</a></li>
<li><a href="../zh-CN429512/index.html">11月12日至18日在莫斯科举行的数字活动</a></li>
<li><a href="../zh-CN429514/index.html">微软告诉用户如何通过泄漏的硬件加密解决SSD上的数据安全性问题</a></li>
<li><a href="../zh-CN429522/index.html">设计服务机器人。 问题陈述，解决方案架构</a></li>
<li><a href="../zh-CN429524/index.html">正确的JSON API或JSON RPC</a></li>
<li><a href="../zh-CN429528/index.html">上周第338天（2018年11月5日至11日）的前端世界摘要</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>