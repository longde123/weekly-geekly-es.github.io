<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💆🏿 👌🏽 🌖 Dokumen sebagai Kode. Bagian 1: mengotomatiskan pembaruan 🤖 😕 ☔️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam proyek-proyek besar, yang terdiri dari puluhan dan ratusan layanan yang saling berinteraksi, pendekatan terhadap dokumentasi sebagai kode - doku...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dokumen sebagai Kode. Bagian 1: mengotomatiskan pembaruan</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/youla/blog/459640/"><p><img src="https://habrastorage.org/webt/cw/mu/zp/cwmuzpbeunmmybhxtwlffemf01k.gif"></p><br><p>  Dalam proyek-proyek besar, yang terdiri dari puluhan dan ratusan layanan yang saling berinteraksi, pendekatan terhadap dokumentasi sebagai kode - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumen sebagai kode</a> - menjadi semakin wajib. </p><br><p>  Saya akan menunjukkan bagaimana Anda dapat menerapkan filosofi ini dalam realitas layanan rahasia, atau lebih tepatnya, saya akan mulai dari tahap pertama implementasinya: otomatisasi memperbarui data dalam dokumentasi. </p><a name="habracut"></a><br><h2 id="nabor-instrumentov">  Tool kit </h2><br><p>  Prinsip "dokumentasi sebagai kode" menyiratkan penggunaan alat yang sama saat menulis dokumentasi seperti ketika membuat kode: bahasa markup teks, sistem kontrol versi, tinjauan kode dan pengujian otomatis.  Tujuan utama: untuk menciptakan kondisi bagi seluruh tim untuk bekerja bersama pada hasil akhir - basis pengetahuan yang lengkap dan instruksi tentang penggunaan layanan produk individual.  Selanjutnya, saya akan berbicara tentang alat khusus yang kami pilih untuk menyelesaikan masalah ini. </p><br><p>  Sebagai bahasa markup teks, kami memutuskan untuk menggunakan yang paling universal - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">reStructuredText</a> .  Selain sejumlah besar arahan yang menyediakan semua fungsi dasar untuk penataan teks, bahasa ini mendukung format final utama, termasuk HTML yang diperlukan untuk proyek kami. </p><br><p>  File dikonversi dari .rst ke .html menggunakan generator dokumentasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sphinx</a> .  Ini memungkinkan Anda membuat situs statis yang dapat Anda buat sendiri atau gunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tema yang sudah jadi</a> .  Proyek kami menggunakan dua tema yang sudah jadi - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">stanford-theme</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bootstrap-theme</a> .  Yang kedua berisi subtopik yang memungkinkan Anda untuk mengatur skema warna yang berbeda untuk elemen antarmuka utama. </p><br><p>  Untuk akses yang mudah dan cepat ke versi dokumentasi saat ini, kami menggunakan situs statis yang dihosting oleh mesin virtual yang dapat diakses dari jaringan area lokal dari tim pengembangan. </p><br><p>  File sumber proyek disimpan dalam repositori Bitbucket, dan situs ini dihasilkan hanya dari file yang ada di cabang master.  Memperbarui data di dalamnya hanya dimungkinkan melalui pull-request, yang memungkinkan Anda untuk memeriksa semua bagian baru dari dokumentasi sebelum dipublikasikan di domain publik. </p><br><p>  Karena antara penyelesaian bagian baru dari dokumentasi dan pengirimannya ke situs itu perlu untuk memeriksa isinya, proses kunci dalam seluruh rantai adalah proses membangun situs dan memperbarui data pada host.  Prosedur ini harus diulang setiap kali setelah permintaan tarik dengan pembaruan bergabung dengan cabang utama proyek. </p><br><p><img src="https://habrastorage.org/webt/z3/ua/e9/z3uae9eyv-lj3sipqmirpbpoony.png"></p><br><p>  Untuk mengimplementasikan logika ini memungkinkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> - sistem integrasi pengembangan yang berkelanjutan, dalam kasus kami - dokumentasi.  Saya akan memberi tahu Anda lebih banyak tentang pengaturan di bagian: </p><br><ol><li>  <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Menambahkan Node Baru ke Jenkins</a></em> </li><li>  <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Deskripsi Jenkinsfile</a></em> </li><li>  <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Integrasi Jenkins dan Bitbucket</a></em> </li></ol><br><h2 id="dobavlenie-novogo-uzla-v-jenkins">  Menambahkan Node Baru ke Jenkins </h2><br><p>  Untuk membuat dan memperbarui dokumentasi di situs, Anda harus mendaftarkan mesin yang disiapkan sebelumnya sebagai agen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> untuk ini. </p><br><h4 id="podgotovka-mashiny">  Persiapan mesin </h4><br><p> Menurut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">persyaratan Jenkins</a> , semua komponen yang termasuk dalam sistem, termasuk mesin master dan semua node agen terdaftar, harus memiliki JDK atau JRE yang diinstal.  Dalam kasus kami, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">JDK 8</a> akan digunakan, untuk instalasi yang cukup untuk menjalankan perintah: </p><br><pre><code class="plaintext hljs">sudo apt-get -y install java-1.8.0-openjdk git</code> </pre> <br><p>  Mesin master akan terhubung ke agen untuk melakukan tugas yang ditugaskan di atasnya.  Untuk melakukan ini, Anda perlu membuat pengguna di agen yang di dalamnya semua operasi akan dilakukan, dan di mana semua file yang dihasilkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> akan disimpan dalam folder rumah.  Pada sistem Linux, jalankan saja perintah: </p><br><pre> <code class="plaintext hljs">sudo adduser jenkins \--shell /bin/bash su jenkins</code> </pre> <br><p>  Untuk membuat koneksi antara mesin master dan agen, Anda harus mengkonfigurasi SSH dan menambahkan kunci otorisasi yang diperlukan.  Kami akan menghasilkan kunci pada agen, setelah itu kami <em>akan</em> menambahkan kunci publik ke file <code>authorized_keys</code> untuk pengguna <em>jenkins</em> . </p><br><p>  Kami akan membangun situs dengan dokumentasi dalam wadah Docker menggunakan gambar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">python yang sudah jadi: 3.7</a> .  Ikuti instruksi dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi resmi</a> untuk menginstal Docker pada agen.  Untuk menyelesaikan proses instalasi, Anda harus menyambung kembali ke agen.  Verifikasi pemasangan dengan menjalankan perintah yang memuat gambar uji: </p><br><pre> <code class="plaintext hljs">docker run hello-world</code> </pre> <br><p>  Agar tidak harus menjalankan perintah Docker atas nama pengguna super (sudo), cukup menambahkan grup pengguna docker yang dibuat pada tahap instalasi, atas nama yang perintahnya akan dieksekusi. </p><br><pre> <code class="plaintext hljs">sudo usermod -aG docker $USER</code> </pre> <br><h4 id="konfiguraciya-novogo-uzla-v-jenkins">  Jenkins Konfigurasi Node Baru </h4><br><p>  Karena menghubungkan ke agen memerlukan otorisasi, Anda harus menambahkan kredensial yang sesuai dalam pengaturan Jenkins.  Petunjuk terperinci tentang cara melakukan ini pada mesin Windows disediakan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi Jenkins resmi</a> . </p><br><blockquote>  PENTING: Pengidentifikasi yang ditentukan di bagian <em>Konfigurasi Jenkins</em> -&gt; <em>Kelola lingkungan build</em> -&gt; <strong>Nama Node</strong> -&gt; <em>Konfigurasikan</em> dalam parameter <strong>Tag</strong> digunakan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkinsfile</a> untuk menunjukkan agen tempat semua operasi akan dilakukan. </blockquote><br><h2 id="opisanie-jenkinsfile">  Deskripsi Jenkinsfile </h2><br><p>  Akar repositori proyek berisi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkinsfile</a> , yang berisi instruksi untuk: </p><br><ul><li>  Mempersiapkan lingkungan build dan menginstal dependensi </li><li>  Buat situs menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sphinx</a> </li><li>  memperbarui informasi host. </li></ul><br><p>  Petunjuk ditetapkan menggunakan arahan khusus, aplikasi yang akan kami pertimbangkan lebih lanjut pada contoh file yang digunakan dalam proyek. </p><br><h4 id="ukazanie-agenta">  Indikasi Agen </h4><br><p>  Pada awal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkinsfile,</a> tentukan label agen di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> , yang akan melakukan semua operasi.  Untuk melakukan ini, gunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">arahan agen</a> : </p><br><pre> <code class="plaintext hljs">agent { label '-' }</code> </pre> <br><h4 id="podgotovka-sredy">  Persiapan lingkungan </h4><br><p>  Untuk menjalankan perintah build situs sphinx-build, Anda perlu mengatur variabel lingkungan di mana jalur data aktual akan disimpan.  Juga, untuk memperbarui informasi pada host, Anda harus menentukan terlebih dahulu jalur tempat data situs dengan dokumentasi disimpan.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Arahan lingkungan</a> memungkinkan Anda untuk menetapkan nilai-nilai ini ke variabel: </p><br><pre> <code class="plaintext hljs">environment { SPHINX_DIR = '.' //,    Sphinx BUILD_DIR = 'project_home_built' //    SOURCE_DIR = 'project_home_source' //   .rst  .md  DEPLOY_HOST = 'username@127.1.1.0:/var/www/html/' //@IP__:__ }</code> </pre> <br><h4 id="osnovnye-deystviya">  Tindakan utama </h4><br><p>  Instruksi utama yang akan dieksekusi di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkinsfile</a> terkandung dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">arahan tahap</a> , yang terdiri dari langkah-langkah yang berbeda yang dijelaskan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">oleh arahan panggung</a> .  Contoh sederhana dari pipa CI tiga tahap: </p><br><pre> <code class="plaintext hljs">pipeline { agent any stages { stage('Build') { steps { echo 'Building..' } } stage('Test') { steps { echo 'Testing..' } } stage('Deploy') { steps { echo 'Deploying....' } } } }</code> </pre> <br><h4 id="zapusk-konteynera-docker-i-ustanovka-zavisimostey">  Luncurkan wadah Docker dan instal dependensi </h4><br><p>  Pertama, jalankan wadah Docker dengan gambar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">python yang sudah</a> jadi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">: 3.7</a> .  Untuk melakukan ini, gunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">perintah run docker</a> dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">flag --rm</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">-i</a> .  Kemudian secara berurutan lakukan hal berikut: </p><br><ul><li>  instal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">python virtualenv</a> ; </li><li>  membuat dan mengaktifkan lingkungan virtual baru; </li><li>  instal di dalamnya semua dependensi yang diperlukan tercantum dalam file <br>  requirement.txt, yang disimpan di root repositori proyek. </li></ul><br><pre> <code class="plaintext hljs">stage('Install Dependencies') { steps { sh ''' docker run --rm -i python:3.7 python3 -m pip install --user --upgrade pip python3 -m pip install --user virtualenv python3 -m virtualenv pyenv . pyenv/bin/activate pip install -r \${SPHINX\_DIR}/requirements.txt ''' } }</code> </pre> <br><h4 id="sborka-sayta-s-dokumentaciey">  Bangun situs dengan dokumentasi </h4><br><p>  Sekarang mari kita membangun situs.  Untuk melakukan ini, jalankan perintah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sphinx-build</a> dengan flag berikut: </p><br><p>  <code>-q</code> : hanya peringatan dan kesalahan log; <br>  <code>-w</code> : menulis log ke file yang ditentukan setelah flag; <br>  <code>-b</code> : nama pembuat situs; <br>  <code>-d</code> : tentukan direktori untuk menyimpan file yang di-cache - acar doktree. </p><br><p>  Sebelum memulai perakitan, menggunakan perintah <code>rm -rf</code> hapus perakitan dan log situs sebelumnya.  Jika terjadi kesalahan pada salah satu tahapan, log eksekusi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sphinx-build</a> akan muncul di konsol <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> . </p><br><pre> <code class="plaintext hljs">stage('Build') { steps { // clear out old files sh 'rm -rf ${BUILD_DIR}' sh 'rm -f ${SPHINX_DIR}/sphinx-build.log' sh ''' ${WORKSPACE}/pyenv/bin/sphinx-build -q -w ${SPHINX_DIR}/sphinx-build.log \ -b html \ -d ${BUILD_DIR}/doctrees ${SOURCE\_DIR} ${BUILD\_DIR} ''' } post { failure { sh 'cat ${SPHINX_DIR}sphinx-build.log' } } }</code> </pre> <br><h4 id="obnovlenie-sayta-na-hoste">  Host pembaruan situs </h4><br><p>  Dan akhirnya, kami akan memperbarui informasi tentang host yang melayani situs dengan dokumentasi produk yang tersedia di lingkungan lokal.  Dalam implementasi saat ini, host adalah mesin virtual yang sama yang terdaftar sebagai agen Jenkins untuk tugas merakit dan memperbarui dokumentasi. </p><br><p>  Sebagai alat sinkronisasi, kami menggunakan utilitas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rsync</a> .  Agar berfungsi dengan benar, perlu untuk mengkonfigurasi koneksi SSH antara wadah Docker, di mana situs dengan dokumentasi itu pergi, dan tuan rumah. </p><br><p>  Untuk mengkonfigurasi koneksi SSH menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkinsfile</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">plugin berikut ini</a> harus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diinstal</a> di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> : </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Plugin SSH Agent</a> - memungkinkan Anda untuk menggunakan langkah <code>sshagent</code> dalam skrip untuk memberikan kredensial dari form <em>nama pengguna / kunci</em> . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Plugin SSH Credentials</a> - memungkinkan Anda untuk menyimpan kredensial form <em>username / key</em> di pengaturan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> . </li></ol><br><p>  Setelah menginstal plugin, Anda harus menentukan kredensial saat ini untuk menghubungkan ke host dengan mengisi formulir di bagian <strong>Kredensial</strong> : </p><br><ul><li>  <strong>ID</strong> : pengidentifikasi yang akan digunakan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkinsfile</a> dalam langkah <code>sshagent</code> untuk menunjukkan kredensial tertentu ( <code>docs-deployer</code> ); </li><li>  <strong>Nama pengguna</strong> : nama pengguna di mana operasi pembaruan data situs akan dilakukan (pengguna harus memiliki <strong><em>akses tulis ke</em></strong> folder <code>/var/html</code> host); </li><li>  <strong>Kunci Pribadi</strong> : kunci pribadi untuk mengakses host; </li><li>  <strong>Passphrase</strong> : kata sandi untuk kunci, jika ditetapkan pada tahap pembuatan. </li></ul><br><p>  Di bawah ini adalah kode skrip yang menghubungkan melalui SSH dan memperbarui informasi pada host menggunakan variabel sistem yang ditentukan pada tahap mempersiapkan lingkungan dengan jalur ke data yang diperlukan.  Hasil dari perintah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rsync</a> ditulis ke log, yang akan ditampilkan di konsol <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> jika terjadi kesalahan sinkronisasi. </p><br><pre> <code class="plaintext hljs">stage('Deploy') { steps { sshagent(credentials: ['docs-deployer']) { sh ''' #!/bin/bash rm -f ${SPHINX_DIR}/rsync.log RSYNCOPT=(-aze 'ssh -o StrictHostKeyChecking=no') rsync "${RSYNCOPT[@]}" \ --delete \ ${BUILD_DIR_CI} ${DEPLOY_HOST}/ ''' } } post { failure { sh 'cat ${SPHINX_DIR}/rsync.log' } } }</code> </pre> <br><h2 id="integraciya-jenkins-i-bitbucket">  Integrasi Jenkins dan Bitbucket </h2><br><p>  Ada banyak cara untuk mengatur interaksi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bitbucket</a> , tetapi dalam proyek kami kami memutuskan untuk menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Parameterized Builds untuk</a> plugin <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> .  Dokumentasi resmi berisi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">instruksi</a> terperinci <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">untuk menginstal</a> plugin, serta pengaturan yang harus ditentukan untuk kedua sistem.  Untuk bekerja dengan plugin ini, Anda perlu membuat pengguna <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> dan menghasilkan token khusus untuknya yang akan memungkinkan pengguna ini untuk masuk ke sistem. </p><br><h4 id="sozdanie-polzovatelya-i-api-tokena">  Membuat token pengguna dan API </h4><br><p>  Untuk membuat pengguna baru di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> , buka <em>Pengaturan Jenkins</em> -&gt; <em>Manajemen Pengguna</em> -&gt; <em>Buat Pengguna</em> , dan isi semua kredensial yang diperlukan dalam formulir. </p><br><p>  Mekanisme otentikasi yang memungkinkan skrip atau aplikasi pihak ketiga untuk menggunakan Jenkins API tanpa benar-benar mentransmisikan kata sandi pengguna adalah token API khusus yang dapat dihasilkan untuk setiap pengguna <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> .  Untuk melakukan ini: </p><br><ul><li>  masuk ke konsol manajemen menggunakan detail pengguna yang dibuat sebelumnya; </li><li>  pergi ke <em>Konfigurasi Jenkins</em> -&gt; <em>Manajemen Pengguna</em> ; </li><li>  klik pada ikon roda gigi di sebelah kanan nama pengguna di mana mereka diizinkan dalam sistem; </li><li>  temukan <em>API Token</em> dalam daftar parameter dan klik tombol <em>Tambahkan Token baru</em> ; </li><li>  di bidang yang muncul, tentukan pengenal token API dan klik tombol <em>Generate</em> ; </li><li>  mengikuti prompt di layar, salin dan simpan token API yang dihasilkan. </li></ul><br><p>  Sekarang dalam pengaturan server <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bitbucket</a> , Anda dapat menentukan pengguna default untuk terhubung ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenkins</a> . </p><br><h2 id="zaklyuchenie">  Kesimpulan </h2><br><p>  Jika sebelumnya proses terdiri dari beberapa langkah: </p><br><ul><li>  Unduh pembaruan ke repositori </li><li>  menunggu konfirmasi kebenaran; </li><li>  menyusun situs web dengan dokumentasi; </li><li>  memperbarui informasi tentang tuan rumah; </li></ul><br><p>  sekarang cukup klik satu tombol Gabung di Bitbucket.  Jika setelah memeriksanya tidak diperlukan untuk membuat perubahan pada file sumber, versi dokumentasi saat ini diperbarui segera setelah mengkonfirmasi kebenaran data. </p><br><p>  Ini sangat menyederhanakan tugas penulis teknis, menyelamatkannya dari sejumlah besar tindakan manual, dan manajer proyek mendapatkan alat yang mudah untuk melacak tambahan dokumentasi dan umpan balik. </p><br><p>  Mengotomatiskan proses ini adalah langkah pertama dalam membangun infrastruktur manajemen dokumentasi.  Di masa depan, kami berencana untuk menambahkan tes otomatis yang akan memeriksa kebenaran tautan eksternal yang digunakan dalam dokumentasi, dan juga ingin membuat objek antarmuka interaktif yang dibangun ke dalam tema siap pakai untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sphinx</a> . </p><br><p>  Terima kasih kepada mereka yang membaca ini untuk perhatian, segera kami akan terus berbagi detail membuat dokumentasi di proyek kami! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id459640/">https://habr.com/ru/post/id459640/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id459624/index.html">Drone militer</a></li>
<li><a href="../id459626/index.html">Windows Notification Facility: permukaan serangan paling tidak berdokumen</a></li>
<li><a href="../id459628/index.html">Open Invention Network memiliki lebih dari tiga ribu pemegang lisensi - apa artinya untuk perangkat lunak open source</a></li>
<li><a href="../id459630/index.html">Tic Tac Toe Bagian 2: Stateless Undo / Redo</a></li>
<li><a href="../id459638/index.html">Menciptakan basis pengetahuan global tentang baterai</a></li>
<li><a href="../id459642/index.html">Akses aman untuk mendaftarkan bidang dalam C ++ tanpa mengorbankan efisiensi (menggunakan CortexM sebagai contoh)</a></li>
<li><a href="../id459644/index.html">Dimmer LED</a></li>
<li><a href="../id459648/index.html">Semuanya harus baik-baik saja dalam penganalisa: fungsionalitas dan antarmuka ... Kami sedang mengeksplorasi antarmuka appScreener 3.1 baru Solar</a></li>
<li><a href="../id459650/index.html">Bagaimana tidak kehilangan uang di kotak hitam: metode pengujian penagihan</a></li>
<li><a href="../id459652/index.html">Pendekatan pengujian regresi otomatis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>