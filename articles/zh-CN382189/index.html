<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👌🏽 👎🏽 👩🏿‍🚒 Smart.js-（不仅仅是）ESP8266的新固件 🤽🏾 🕥 🔔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="几乎没有文章发表过有关基于流行ESP8266芯片的各种项目的文章，所以我不会自己谈论它。
 
 自下而上：我们为该设备开发了新固件，可以使用Javascript进行开发。但是，Smart.js不仅是JS解释器固件，还是用于设备和云基础架构的不同“套件”。
 
 
 
 有关详细信息-请在目录下。
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Smart.js-（不仅仅是）ESP8266的新固件</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/382189/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">几乎没有文章发表过有关基于流行ESP8266芯片的各种项目的文章，所以我不会自己谈论它。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自下而上：我们为该设备开发了新固件，可以使用Javascript进行开发。</font><font style="vertical-align: inherit;">但是，Smart.js不仅是JS解释器固件，还是用于设备和云基础架构的不同“套件”。</font></font><br>
<br>
<img src="https://habrastorage.org/files/d0c/4c1/ca4/d0c4c1ca4a2b453faf77decff24d5b13.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有关详细信息-请在目录下。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我必须马上说这篇文章是一篇评论文章，在其中我将尝试谈论Smart.js可以做什么，并且我将很少涉及到这一切如何工作。如果您有兴趣了解其工作原理，那么这可能是下一篇文章的主题（您也可以参阅</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参考资料</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
那么我们到底有什么呢？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，它是</font><font style="vertical-align: inherit;">由Cesanta开发的</font><font style="vertical-align: inherit;">称为</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V7</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的JS引擎</font><font style="vertical-align: inherit;">。在此不作赘述，我只注意到该引擎最初是为嵌入式平台开发的，因此它的特点是体积小，内存消耗低，可移植性出色以及可配置性高。但是，ESP8266上的JS解释器本身就是一个东西，因此Smart.js可以与外界通信。</font></font><br>
<ul>
<li>I2C.  API    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>,      «»  (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">EEPROM</a>). I2C   bit-bang,      ; </li>
<li>SPI. ESP   SPI ,       SPI  HSPI,  HSPI,  ,  Hardware SPI. «» SPI       ,     .     bit-bang',      ,   HSPI (,     ESP,      SPI, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>).   API  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>;</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无线上网。</font><font style="vertical-align: inherit;">不支持WiFi会很奇怪。</font><font style="vertical-align: inherit;">因此我们</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件系统。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基于SPIFFS；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有一个用于</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPIO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和简单</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://github.com/cesanta/smart.js/blob/master/README.md&amp;usg=ALkJrhj6ZQB5jbIzNsSNpIhph1s-7HvE-g#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP客户端</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的API </font><font style="vertical-align: inherit;">;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...以及一系列</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">辅助功能</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常，如果很有趣-请阅读</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自述文件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，我们尝试描述所有内容。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在介绍一下快速入门。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flash'n'Chips</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存档中下载</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Flash'n'chips是“专有”闪存驱动器。</font><font style="vertical-align: inherit;">您可以使用任何设备，但Flash'n'chips会立即生成连接到云所需的设备ID和密码。</font><font style="vertical-align: inherit;">有适用于OS X和Windows的版本。</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和Linux。</font></font></b><div class="spoiler_text"> Linux    ,   ,    .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了更新程序本身之外，归档文件还包含“发行版”（即Alpha）固件。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们将ESP8266连接到USB，启动Flash'n'chips，我们看到类似这样的内容：</font></font><br>
<br>
<img src="https://habrastorage.org/files/ad9/a25/fd9/ad9a25fd9fcf452f9e3066080d20a87a.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
单击“加载固件”，固件将下载到设备中。</font><font style="vertical-align: inherit;">根据您的ESP，可能需要其他身体运动。</font><font style="vertical-align: inherit;">例如，我使用最简单的ESP01，因此在闪烁之前，我需要将GPIO0连接到GND。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们通过终端连接。</font><font style="vertical-align: inherit;">（还有一个内置的Flash'N'Chips，我对picocom较为熟悉，但这并不重要）。</font><font style="vertical-align: inherit;">速度-115200</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们看到控制台。</font></font></b><div class="spoiler_text">    ,     .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在此控制台中，您可以立即键入JS代码。 （“ Smartjs NNN / MM $”是命令行提示符，NNN是可用内存量，MM是当前由解释器直接消耗的内存量）。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它看起来像一个普通的控制台。</font></font><br>
<br>
<img src="https://habrastorage.org/files/afa/c9c/7d3/afac9c7d37e24b7f8b007648dcb37783.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当您按Enter键时，命令将被执行，其结果将显示在控制台中，即您无需太多“打印”就可以做到。编写和运行JS代码的另一种方法是在您喜欢的编辑器中键入它，将其保存到文件中，然后将其下载到您的设备中。最简单的方法是使用相同的Flash'n'Chip-在“选择操作”组合框中，选择“上传文件”。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，可以通过在控制台中键入以下命令，使用File.load命令（“文件名”）执行该文件，或将其添加到init.js文件中（然后，该文件将在设备启动时自动执行）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ESP8266 Smart.js的固件没有限制。如我上面所写，仍然有一片云，您可以在其中从设备发送数据，将数据存储在此处，从那里获取数据，或者只是查看图表。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附有</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于将数据发送到云的API </font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了快速入门，我们录制了一个简短的视频：</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://www.youtube.com/embed/6DYfGsqQzCg%3Ffeature%3Doembed&amp;usg=ALkJrhjt5745SS5s-8HL84wjmWL12a7VLw" frameborder="0" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
那些。例如，如果您需要监视公寓中的温度，则几乎无需执行任何操作。将温度传感器连接到ESP，在JS上编写“驱动程序”（或准备好一个驱动程序），在云中注册，编写一个读取温度并将其发送到云的小脚本就足够了。然后转到该站点并查看图表。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然，固件可以在没有云的情况下运行。但是使用云计算更方便，因为一部分日常工作已被切断。在github上有一个到</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">云</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的链接</font><font style="vertical-align: inherit;">，如果您有github或G +帐户，则只需单击几下即可在其中进行注册。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
好吧，如果您缺少某些功能，那么您始终可以使用C。您可以简单地用C编写新功能，而不必将其与JS关联。同时，仍然可以使用几乎所有的API（在大多数情况下，JS API是syshny函数的精简包装），此外，您可以使用ESP SDK函数。</font><font style="vertical-align: inherit;">由于泊坞窗映像的存在，</font><font style="vertical-align: inherit;">从源代码组装固件</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并不难</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以展开JS。为此，我们用C编写了必要的功能，然后使其在JS中可用。这也</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不难</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于那些使用ESP8266的人来说，Smart.js看起来类似于NodeMCU。我不会争论-虽然看起来如此。但是我们为Smart.js的开发以及向其他设备的移植制定了宏伟的计划，因此，随着时间的流逝，我认为相似性将会减少。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
说到我们的计划。现在Smart.js的状态为ALPHA1。下一个版本计划于秋季发布（当然，它不会干扰那些希望以任何频率从源收集固件的人）。到秋天，我们将增加用户可用的内存量，从云端更新脚本（也就是说，从理论上讲，根本不可能将ESP8266完全连接到计算机），将端口连接到其他平台等。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，获取反馈对我们很重要。你喜欢它吗？有什么不见了？什么是多余的？一切都很有趣！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所以-下载固件-试试吧，我们会很高兴的。</font><font style="vertical-align: inherit;">双重许可证，适用于所有参与者的GPLv2，适用于没有GPL和/或需要支持的人员的商业许可证。</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN382189/">https://habr.com/ru/post/zh-CN382189/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN382179/index.html">适用于Android OS的辐射防护房将于8月13日发布</a></li>
<li><a href="../zh-CN382181/index.html">JiT-JiS SCM或“汽车如何做到”</a></li>
<li><a href="../zh-CN382183/index.html">Apple получила патент на биометрический пульт для умного дома</a></li>
<li><a href="../zh-CN382185/index.html">4种有助于拯救海洋的技术</a></li>
<li><a href="../zh-CN382187/index.html">EIZO Foris FS2434无框显示器评测</a></li>
<li><a href="../zh-CN382191/index.html">开普勒452b。天鹅座地球的另一个“双重”。第一个被认为是存在的系外行星</a></li>
<li><a href="../zh-CN382193/index.html">中国又为北斗系统投放了两颗导航卫星</a></li>
<li><a href="../zh-CN382195/index.html">机器人记者：算法更是工具，而非威胁</a></li>
<li><a href="../zh-CN382199/index.html">为什么NA​​SA的系外行星不是一件好事</a></li>
<li><a href="../zh-CN382201/index.html">7个最佳四轴飞行器论坛，博客和YouTube频道</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>