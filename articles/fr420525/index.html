<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚Äçüíª üêÖ ü§∂ Des r√©seaux pour les plus aguerris. Quinzi√®me partie. QoS ‚ôøÔ∏è üßöüèΩ üë®‚Äçüè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SDSM-15. √Ä propos de la QoS. Maintenant, avec la possibilit√© de tirer des demandes . 

 Et nous sommes donc arriv√©s au sujet de la QoS. 

 Savez-vous ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Des r√©seaux pour les plus aguerris. Quinzi√®me partie. QoS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420525/">  SDSM-15.  √Ä propos de la QoS.  Maintenant, avec la possibilit√© de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tirer des demandes</a> . <br><br>  Et nous sommes donc arriv√©s au sujet de la QoS. <br><br>  Savez-vous pourquoi seulement maintenant et pourquoi ce sera l'article de cl√¥ture de l'ensemble du cours SDSM?  Parce que la QoS est inhabituellement complexe.  La chose la plus difficile qui √©tait avant dans le cycle. <br><br>  Ce n'est pas une sorte d'archiveur magique qui comprime intelligemment le trafic √† la vol√©e et pousse votre gigabit dans une liaison montante de cent m√©gabits.  La QoS consiste √† sacrifier quelque chose d'inutile, en poussant le non comestible dans le cadre du permis. <br><br>  La QoS est tellement enchev√™tr√©e dans l'aura du chamanisme et de l'inaccessibilit√© que tous les jeunes (et pas seulement) ing√©nieurs essaient d'ignorer soigneusement son existence, estimant qu'il suffit de jeter des probl√®mes avec de l'argent et d'√©largir les liens √† l'infini.  Certes, jusqu'√† ce qu'ils r√©alisent qu'avec cette approche, l'√©chec les attendra in√©vitablement.  Soit l'entreprise commencera √† poser des questions inconfortables, soit il y aura beaucoup de probl√®mes qui ne sont presque pas li√©s √† la largeur du canal, mais d√©pendent directement de l'efficacit√© de son utilisation.  Oui, la VoIP agite activement un stylo dans les coulisses et le trafic de multidiffusion vous caresse malicieusement dans le dos. <br><br>  Par cons√©quent, r√©alisons simplement que la QoS est obligatoire, vous devrez le savoir d'une mani√®re ou d'une autre, et pour une raison quelconque, ne commencez pas maintenant, dans une atmosph√®re d√©tendue. <br><br><img src="https://habrastorage.org/webt/sc/of/k6/scofk6lx2y49bzisp0pwsnrsywg.jpeg"><a name="habracut"></a><br><hr><br><h1>  Table des mati√®res </h1><br>  1. <b>Qu'est-ce qui d√©termine la QoS?</b> <br><br><ul><li>  Perte </li><li>  Retards </li><li>  Jitter </li></ul><br>  2. <b>Trois mod√®les de QoS</b> <br><br><ul><li>  Meilleurs effets </li><li>  Services int√©gr√©s </li><li>  Services diff√©renci√©s </li></ul><br>  3. <b>M√©canismes DiffServ</b> <br><br>  4. <b>Classification et √©tiquetage</b> <br><br><ul><li>  Agr√©gation de comportements </li><li>  Multi-domaines </li><li>  Bas√© sur l'interface </li></ul><br>  5. <b>Files d'attente</b> <br><br>  6. <b>√âvitement de la congestion</b> <br><br><ul><li>  Chute de queue et chute de t√™te </li><li>  Rouge </li><li>  Wred </li></ul><br>  7. <b>Gestion de la congestion</b> <br><br><ul><li>  Premier entr√©, premier sorti </li><li>  File d'attente prioritaire </li><li>  File d'attente √©quitable </li><li>  Tournoi √† la ronde </li></ul><br>  8. <b>Limite de vitesse</b> <br><br><ul><li>  Fa√ßonner </li><li>  Police </li><li>  Seau qui fuit et seau √† jetons </li></ul><br>  9. <b>Impl√©mentation mat√©rielle de QoS</b> <br><hr><br><blockquote>  Avant que le lecteur ne plonge dans ce trou, je vais y d√©finir trois param√®tres: <br><br><ul><li>  Tous les probl√®mes ne peuvent pas √™tre r√©solus en √©largissant la bande. </li><li>  QoS n'√©tend pas la bande. </li><li>  QoS sur la gestion des ressources limit√©es. </li></ul></blockquote><br><h1>  1. Qu'est-ce qui d√©termine la QoS? </h1><br>  L'entreprise s'attend √† ce que la pile r√©seau remplisse tr√®s bien sa fonction simple: fournir un flux binaire d'un h√¥te √† un autre: sans perte et dans un d√©lai pr√©visible. <br><br>  √Ä partir de cette courte phrase, toutes les m√©triques de qualit√© du r√©seau peuvent √™tre d√©riv√©es: <br><br><ul><li>  Perte </li><li>  Retards </li><li>  Jitter </li></ul><br>  Ces trois caract√©ristiques d√©terminent la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">qualit√© du r√©seau</a> quelle que soit sa nature: paquet, canal, IP, MPLS, radio, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pigeons</a> . <br><br><h2>  Perte </h2><br>  Cette m√©trique vous indique combien de paquets envoy√©s par la source ont atteint la destination. <br>  La cause de la perte peut √™tre un probl√®me d'interface / c√¢ble, une congestion du r√©seau, des erreurs de bit qui bloquent les r√®gles ACL. <br><br>  Ce qu'il faut faire en cas de perte est d√©cid√© par l'application.  Il peut les ignorer, comme dans le cas d'une conversation t√©l√©phonique, o√π un paquet en retard n'est plus n√©cessaire, ou le renvoyer - c'est ce que TCP fait pour garantir une livraison pr√©cise des donn√©es source. <br><br><img src="https://habrastorage.org/webt/s9/vc/jj/s9vcjjwjb494cyrx19oby8ykvms.png" width="600"><br><br>  Comment g√©rer les pertes, si elles sont in√©vitables, dans le chapitre Gestion de la congestion. <br><br>  Comment profiter des pertes dans le chapitre Pr√©vention de la congestion. <br><br><h2>  Retards </h2><br>  C'est le temps que les donn√©es doivent passer de la source √† la destination. <br><br><img src="https://habrastorage.org/webt/m6/xo/qa/m6xoqapl9y6v422k8c4d--xtmvm.png" width="600"><br><br>  Le retard cumul√© se compose des √©l√©ments suivants. <br><br><ul><li>  <b>D√©lai de s√©rialisation</b> - le temps qu'il <b>faut</b> √† un n≈ìud pour d√©composer un paquet en bits et √©tablir une liaison avec le n≈ìud suivant.  Elle est d√©termin√©e par la vitesse de l'interface.  Ainsi, par exemple, le transfert d'un paquet de 1500 octets de taille via une interface de 100 Mb / s prendra 0,0001 s, et pour 56 Kb / s - 0,2 s. </li><li>  <b>Le d√©lai de propagation</b> est le r√©sultat de la fameuse limitation de la vitesse de propagation des ondes √©lectromagn√©tiques.  La physique ne vous permet pas de vous rendre de New York √† Tomsk √† la surface de la plan√®te plus rapidement qu'en 30 ms (en fait, environ 70 ms). </li><li>  <b>Les retards introduits par la QoS</b> sont la langueur des paquets dans les files d'attente ( <b>Queuing Delay</b> ) et les cons√©quences de la mise en forme ( <b>Shaping Delay</b> ).  Nous en parlerons beaucoup aujourd'hui dans le chapitre Contr√¥le de vitesse. </li><li>  <b>Retard dans le traitement des paquets</b> ( <b>d√©lai de traitement</b> ) - le temps de d√©cider quoi faire avec le paquet: recherche, ACL, NAT, DPI - et le livrer de l'interface d'entr√©e √† la sortie.  Mais le jour o√π Juniper a s√©par√© le contr√¥le et le plan de donn√©es dans son M40, les retards de traitement pourraient √™tre n√©glig√©s. </li></ul><br>  Les retards ne sont pas si mauvais pour les applications o√π il n'y a pas lieu de se pr√©cipiter: partage de fichiers, surf, VoD, stations de radio Internet, etc.  Inversement, ils sont critiques pour les interactifs: 200 ms est d√©j√† d√©sagr√©able √† l'oreille lors d'une conversation t√©l√©phonique. <br><br>  Un terme li√© au retard qui n'est pas synonyme de <b>RTT</b> ( <b>Round Trip Time</b> ) est l'aller-retour.  Lors du ping et du tra√ßage, vous voyez exactement RTT, et non un d√©lai unidirectionnel, bien que les valeurs aient une corr√©lation. <br><br><h2>  Jitter </h2><br>  La diff√©rence de d√©lais entre la livraison de paquets cons√©cutifs est appel√©e gigue. <br><br><img src="https://habrastorage.org/webt/hv/-j/9z/hv-j9zu-h0eyuzkf9eaupcputhe.png" width="600"><br><br>  Comme la latence, la gigue n'a pas d'importance pour de nombreuses applications.  Et m√™me, il semblerait, quelle est la diff√©rence - le colis a √©t√© livr√©, alors quoi de plus? <br><br>  Cependant, pour les services interactifs, c'est important. <br><br>  Prenons la m√™me t√©l√©phonie comme exemple.  En fait, il s'agit d'une num√©risation de signaux analogiques avec une division en blocs de donn√©es s√©par√©s.  La sortie est un flux de paquets assez uniforme.  Du c√¥t√© de la r√©ception, il y a un petit tampon d'une taille fixe dans lequel les paquets qui arrivent s√©quentiellement s'ins√®rent.  Pour restaurer le signal analogique, un certain nombre d'entre eux est n√©cessaire.  Dans des conditions de retards flottants, le prochain bloc de donn√©es peut ne pas arriver √† l'heure, ce qui √©quivaut √† une perte, et le signal ne peut pas √™tre restaur√©. <br><br>  La plus grande contribution √† la variabilit√© des retards est apport√©e par la seule QoS.  C'est aussi beaucoup et fastidieux dans les m√™mes chapitres Speed ‚Äã‚ÄãLimit. <br><br><hr><br>  Ce sont les trois principales caract√©ristiques de la qualit√© du r√©seau, mais il y en a deux autres qui jouent √©galement un r√¥le important. <br><br><h2>  Livraison al√©atoire </h2><br>  Un certain nombre d'applications, telles que la t√©l√©phonie, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">NAS</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CES, sont</a> extr√™mement sensibles √† la livraison al√©atoire de paquets lorsqu'ils arrivent chez le destinataire dans le mauvais ordre dans lequel ils ont √©t√© envoy√©s.  Cela peut entra√Æner une perte de connectivit√©, des erreurs, des dommages au syst√®me de fichiers. <br><br>  Bien que la livraison al√©atoire ne soit pas une fonction QoS formelle, elle fait d√©finitivement r√©f√©rence √† la qualit√© du r√©seau. <br><br>  M√™me avec TCP tol√©rant ce type de probl√®me, des ACK et des retransmissions en double se produisent. <br><br><img src="https://habrastorage.org/webt/yu/51/63/yu5163hdbesjbypr34w4w5puhbo.png" width="600"><br><br><h2>  Bande passante </h2><br>  Il ne se distingue pas comme une mesure de la qualit√© du r√©seau, car en fait son inconv√©nient se traduit par les trois ci-dessus.  Cependant, dans nos r√©alit√©s, quand il devrait √™tre garanti pour certaines applications ou, au contraire, il devrait √™tre limit√© par contrat, par exemple, MPLS TE le r√©serve tout au long du LSP, il convient de le mentionner, au moins comme une m√©trique faible. <br>  Les m√©canismes de contr√¥le de la vitesse seront abord√©s dans les chapitres Limite de vitesse. <br><br><hr><br>  Pourquoi les sp√©cifications peuvent-elles mal tourner? <br><br>  Ainsi, nous commen√ßons avec une id√©e tr√®s primitive qu'un p√©riph√©rique r√©seau (qu'il s'agisse d'un commutateur, d'un routeur, d'un pare-feu, peu importe) n'est qu'un autre morceau de tuyau appel√© canal de communication, comme un fil de cuivre ou un c√¢ble optique. <br><br><img src="https://habrastorage.org/webt/r2/yh/hr/r2yhhr2urldnn3t6mqhhk6erz-u.png" width="600"><br><br>  Ensuite, tous les paquets transitent dans le m√™me ordre dans lequel ils sont arriv√©s et ne subissent aucun retard suppl√©mentaire - il n'y a nulle part o√π s'attarder. <br><br>  Mais en fait, chaque routeur restaure les bits et les paquets du signal, fait quelque chose avec eux (nous n'y pensons pas encore) puis reconvertit les paquets en signal. <br><br>  Un d√©lai de s√©rialisation appara√Æt.  Mais en g√©n√©ral, ce n'est pas effrayant car c'est constant.  Pas effrayant tant que la largeur de l'interface de sortie est sup√©rieure √† l'entr√©e. <br><br>  Par exemple, √† l'entr√©e de l'appareil se trouve un port gigabit et √† la sortie une ligne de relais radio de 620 Mb / s connect√©e au m√™me port gigabit? <br><br>  Personne n'interdira les balles via le trafic gigabit de liaison formellement gigabit. <br>  Il n'y a rien √† faire - 380 Mb / s se d√©verseront sur le sol. <br><br>  Les voici: des pertes. <br><br>  Mais en m√™me temps, j'aimerais beaucoup que la pire partie soit perdue - une vid√©o de YouTube, et la conversation t√©l√©phonique du directeur ex√©cutif avec le directeur de l'usine n'a pas interrompu ni m√™me coass√©. <br><br>  J'aimerais que la voix ait une ligne d√©di√©e. <br><br>  Ou il y a cinq interfaces d'entr√©e, mais une sortie, et en m√™me temps, cinq n≈ìuds ont commenc√© √† essayer d'injecter du trafic vers un destinataire. <br><br>  Ajoutez une pinc√©e de th√©orie VoIP (un article sur lequel personne n'a √©crit) - il est tr√®s sensible aux retards et √† leurs variations. <br><br>  Si pour un flux TCP de vid√©o √† partir de YouTube (au moment de la r√©daction de l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">QUIC</a> - cela reste encore une exp√©rience), les retards, m√™me en quelques secondes, sont totalement sans valeur en raison de la mise en m√©moire tampon, alors le directeur apr√®s la premi√®re conversation de ce type avec le Kamchatka appellera le chef du service technique. <br>  Autrefois, lorsque l'auteur du cycle faisait toujours ses devoirs le soir, le probl√®me √©tait particuli√®rement aigu.  Les connexions par modem avaient une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vitesse de 56k</a> . <br><br>  Et lorsqu'un paquet de 1,5 K est entr√© dans une telle connexion, il a occup√© toute la ligne pendant 200 ms.  Personne d'autre ne pouvait passer en ce moment.  Une voix?  Non, je n'ai pas entendu. <br><br>  Par cons√©quent, la question MTU est si importante - le paquet ne devrait pas occuper l'interface trop longtemps.  Plus la vitesse est faible, plus le MTU est bas. <br><br>  Les voici - des retards. <br><br>  Maintenant, la cha√Æne est gratuite et le d√©lai est faible, apr√®s une seconde, quelqu'un a commenc√© √† t√©l√©charger un gros fichier et les d√©lais ont augment√©.  Le voici - la gigue. <br><br>  Ainsi, il est n√©cessaire que les paquets vocaux volent √† travers le tuyau avec des d√©lais minimaux, et YouTube attendra. <br><br>  Les 620 Mb / s disponibles doivent √™tre utilis√©s pour la voix, la vid√©o et pour les clients B2B achetant des VPN.  J'aimerais qu'un trafic n'oppose pas l'autre, nous avons donc besoin d'une garantie de bande. <br><br><hr><br>  Toutes les caract√©ristiques ci-dessus sont universelles en ce qui concerne la nature du r√©seau.  Cependant, il existe trois approches diff√©rentes de leur fourniture. <br><br><h1>  2. Trois mod√®les de QoS </h1><br><ul><li>  Meilleur effort - aucune garantie de qualit√©.  Tous sont √©gaux. </li><li>  IntServ est une garantie de qualit√© pour chaque flux.  R√©server des ressources de la source √† la destination. </li><li>  DiffServ - Il n'y a pas de r√©servation.  Chaque n≈ìud d√©termine lui-m√™me comment garantir la bonne qualit√©. </li></ul><br><h2>  Meilleur effort (BE) </h2><br>  <i>Aucune garantie.</i> <br><br>  L'approche la plus simple pour impl√©menter la QoS, √† partir de laquelle les r√©seaux IP ont commenc√© et est toujours pratiqu√©e √† ce jour - parfois parce qu'elle est suffisante, mais le plus souvent parce que personne n'a pens√© √† la QoS. <br><br>  Soit dit en passant, lorsque vous envoyez du trafic vers Internet, il y sera trait√© comme BestEffort.  Par cons√©quent, via un VPN d√©ploy√© sur Internet (par opposition √† un VPN fourni par le fournisseur), le trafic important, comme une conversation t√©l√©phonique, peut ne pas √™tre tr√®s confiant. <br><br>  Dans le cas de BE, toutes les cat√©gories de trafic sont √©gales, aucune pr√©f√©rence n'est donn√©e √† aucune.  En cons√©quence, il n'y a aucune garantie de retard / gigue ou bande. <br><br>  Cette approche a un nom quelque peu contre-intuitif - Best Effort, que le nouveau venu induit en erreur avec le mot ¬´best¬ª. <br><br>  Cependant, l'expression ¬´je ferai de mon mieux¬ª signifie que l'orateur essaiera de faire tout ce qui peut, mais ne garantit rien. <br><br>  Rien n'est requis pour impl√©menter BE - c'est le comportement par d√©faut.  La fabrication est bon march√©, le personnel n'a pas besoin de connaissances sp√©cifiques approfondies, la qualit√© de service dans ce cas ne peut pas √™tre personnalis√©e. <br><br>  Cependant, cette simplicit√© et cette statique ne conduisent pas au fait que l'approche Best Effort n'est utilis√©e nulle part.  Il trouve une application dans les r√©seaux √† large bande passante et sans congestion et rafales. <br><br>  Par exemple, sur les lignes transcontinentales ou dans les r√©seaux de certains centres de donn√©es o√π il n'y a pas de sursouscription. <br>  En d'autres termes, dans les r√©seaux sans congestion et o√π il n'est pas n√©cessaire de se rapporter √† un trafic (par exemple, la t√©l√©phonie) d'une mani√®re sp√©ciale, BE est tout √† fait appropri√©. <br><br><h2>  Interv. </h2><br>  <i>R√©servation pr√©alable des ressources pour le flux de la source √† la destination.</i> <br><br>  Les p√®res des r√©seaux MIT, Xerox et ISI ont d√©cid√© d'ajouter l'√©l√©ment de pr√©visibilit√© √† l'Internet al√©atoire grandissant, tout en maintenant son op√©rabilit√© et sa flexibilit√©. <br><br>  Ainsi, en 1994, l'id√©e d'IntServ est n√©e en r√©ponse √† la croissance rapide du trafic en temps r√©el et au d√©veloppement de la multidiffusion.  Il a ensuite √©t√© r√©duit √† IS. <br><br>  Le nom refl√®te la volont√© du m√™me r√©seau de fournir simultan√©ment des services pour les types de trafic en temps r√©el et non en temps r√©el, offrant le droit prioritaire d'utiliser les ressources par la r√©servation de la bande.  La possibilit√© de r√©utiliser le groupe sur lequel tout le monde gagne de l'argent, et gr√¢ce √† laquelle la prise de vue IP, a √©t√© pr√©serv√©e. <br><br>  La mission de sauvegarde a √©t√© attribu√©e au protocole RSVP, qui pour <b>chaque</b> flux r√©serve une bande sur <b>chaque</b> p√©riph√©rique r√©seau. <br><br>  En gros, avant de configurer une session Single Rate Three Color MarkerP ou de commencer l'√©change de donn√©es, les h√¥tes finaux envoient le chemin RSVP avec la bande passante requise.  Et si les deux ont renvoy√© RSVP Resv - ils peuvent commencer √† communiquer.  En m√™me temps, s'il n'y a pas de ressources disponibles, RSVP renvoie une erreur et les h√¥tes ne peuvent pas communiquer ou suivre BE. <br><br>  Laissons maintenant les lecteurs les plus courageux imaginer qu'une cha√Æne sera signal√©e √† l'avance pour <b>n'importe quel</b> flux sur Internet aujourd'hui.  √âtant donn√© que cela n√©cessite des co√ªts de processeur et de m√©moire non nuls √† <b>chaque</b> n≈ìud de transit, retarde l'interaction r√©elle pendant un certain temps, il devient clair pourquoi IntServ s'est av√©r√© √™tre une id√©e pratiquement morte - une √©volutivit√© nulle. <br><br>  Dans un sens, l'incarnation moderne d'IntServ est MPLS TE avec une version d'√©tiquetage adapt√©e de RSVP - RSVP TE.  Bien qu'ici, bien s√ªr, pas de bout en bout et non par flux. <br><br>  IntServ est d√©crit dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 1633</a> . <br>  Le document est, en principe, curieux d'√©valuer √† quel point vous pouvez √™tre na√Øf dans les pr√©visions. <br><br><h2>  Diffserv </h2><br>  <i>DiffServ est compliqu√©.</i> <br><br>  Lorsqu'il est devenu clair √† la fin des ann√©es 90 que l'approche IP IntServ de bout en bout a √©chou√©, l'IETF a convoqu√© le groupe de travail sur les services diff√©renci√©s en 1997, qui a √©labor√© les exigences suivantes pour le nouveau mod√®le de QoS: <br><br><ul><li>  Pas de signalisation (Adjos, RSVP!). </li><li>  Bas√© sur une classification de trafic agr√©g√©e, au lieu de se concentrer sur les flux, les clients, etc. </li><li>  Il dispose d'un ensemble d'actions limit√© et d√©terministe pour le traitement du trafic de donn√©es des classes. </li></ul><br>  En cons√©quence, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 2474</a> ( <i>D√©finition du champ des services diff√©renci√©s (champ DS) dans les en-t√™tes IPv4 et IPv6</i> ) et le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 2475</a> ( <i>Une architecture pour les services diff√©renci√©s</i> ) sont n√©s en 1998. <br><br>  Et plus loin, nous ne parlerons que de DiffServ. <br><br><blockquote>  Il convient de noter que le nom DiffServ n'est pas l'antith√®se d'IntServ.  Cela signifie que nous diff√©rencions les services fournis par diverses applications, ou plut√¥t leur trafic, en d'autres termes, nous partageons / diff√©rencions ces types de trafic. <br>  IntServ fait de m√™me - il distingue les types de trafic BE et en temps r√©el, transmis sur le m√™me r√©seau.  Les deux: et IntServ et DiffServ - font r√©f√©rence aux fa√ßons de diff√©rencier les services. </blockquote><br><hr><br><h1>  3. M√©canismes DiffServ </h1><br>  Qu'est-ce que DiffServ et pourquoi bat-il IntServ? <br><br>  Si c'est tr√®s simple, le trafic est divis√© en classes.  Un package √† l'entr√©e de chaque n≈ìud est class√© et un ensemble d'outils lui est appliqu√©, qui traite les packages de diff√©rentes classes de diff√©rentes mani√®res, leur fournissant ainsi un niveau de service diff√©rent. <br><br>  Mais ce ne <a href="">sera</a> tout simplement <a href="">pas</a> . <br><br>  Au c≈ìur de DiffServ se trouve le concept IP IP <b>PHB</b> parfaitement assaisonn√© <b>- Comportement par bond</b> .  Chaque n≈ìud sur le chemin de trafic prend ind√©pendamment une d√©cision sur la fa√ßon de se comporter par rapport au paquet entrant, en fonction de ses en-t√™tes. <br><br>  Les actions du routeur de paquets seront appel√©es le mod√®le de comportement.  Le nombre de ces mod√®les est d√©terministe et limit√©.  Sur diff√©rents appareils, les mod√®les de comportement par rapport au m√™me trafic <i>peuvent</i> diff√©rer, ils sont donc par saut. <br><br>  <i>Les concepts de <b>comportement</b> et de <b>PHB</b> que j'utiliserai dans l'article comme synonymes.</i> <br><blockquote>  Il y a une l√©g√®re confusion.  PHB est, d'une part, le concept g√©n√©ral de comportement ind√©pendant de chaque n≈ìud, et d'autre part, un mod√®le sp√©cifique sur un n≈ìud particulier.  Avec cela, nous allons le d√©couvrir. <br></blockquote><img src="https://habrastorage.org/webt/8w/jq/kq/8wjqkqc9e4jwrm1lokdaahlnod8.png" width="600"><br><br>  Le mod√®le de comportement est d√©termin√© par un ensemble d'outils et leurs param√®tres: maintien de l'ordre, suppression, mise en file d'attente, planification, mise en forme. <br><br>  En utilisant les mod√®les de comportement disponibles, le r√©seau peut fournir diff√©rentes classes de service ( <b>classe de service</b> ). <br><br>  C'est-√†-dire que diff√©rentes cat√©gories de trafic peuvent recevoir diff√©rents niveaux de service sur le r√©seau en leur appliquant diff√©rents PHB. <br><br>  En cons√©quence, tout d'abord, vous devez d√©terminer √† quelle classe de trafic de service se r√©f√®re - <b>Classification</b> . <br><br>  Chaque n≈ìud classe ind√©pendamment les paquets entrants. <br><br><img src="https://habrastorage.org/webt/_o/lp/jm/_olpjmv8pc3bclzzg9qtvh1_vke.png" width="700"><br><br>  Apr√®s la classification, une mesure se produit ( <b>mesure</b> ) - combien de bits / octets de trafic de cette classe sont arriv√©s au routeur. <br><br>  Sur la base des r√©sultats, les emballages peuvent √™tre peints ( <b>coloration</b> ): vert (dans la limite √©tablie), jaune (hors de la limite), rouge (compl√®tement s√©duit la c√¥te). <br><br><img src="https://habrastorage.org/webt/3h/6g/xi/3h6gxiq2g_7lejnvonvxtft9pys.png" width="700"><br><br>  Si n√©cessaire, la <b>police</b> a lieu (d√©sol√© pour un tel calque, il y a une meilleure option - √©crivez, je vais changer).  Un polisseur bas√© sur la couleur d'un paquet attribue une action au paquet - transmettre, √©liminer ou re-marquer. <br><br><img src="https://habrastorage.org/webt/ft/gk/2k/ftgk2klys-yvgdicuzs1i8zg3lo.png" width="700"><br><br>  Apr√®s cela, le paquet devrait tomber dans l'une des files d'attente ( <b>file d'attente</b> ).  Une file d'attente distincte est allou√©e pour chaque classe de service, ce qui permet de les diff√©rencier √† l'aide de PHB diff√©rents. <br><br>  Mais avant m√™me que le paquet n'entre dans la file d'attente, il peut √™tre supprim√© ( <b>Dropper</b> ) si la file d'attente est pleine. <br><br>  S'il est vert, il passera, s'il est jaune, il sera probablement rejet√© si la ligne est pleine et si le rouge est un kamikaze s√ªr.  Conditionnellement, la probabilit√© de chute d√©pend de la couleur du paquet et de la pl√©nitude de la file d'attente o√π il va se rendre. <br><br><img src="https://habrastorage.org/webt/er/q2/ks/erq2ksivfaq7yj2gch6ihcbezts.png" width="700"><br><br>  √Ä la sortie de la file d'attente, un <b>Shaper</b> fonctionne, dont la t√¢che est tr√®s similaire √† la t√¢che du polyser - pour limiter le trafic √† une valeur donn√©e. <br><br>  Vous pouvez configurer des shapers arbitraires pour des files d'attente individuelles, ou m√™me au sein de files d'attente. <br>  Sur la diff√©rence entre un shaper et un polyser dans le chapitre Speed ‚Äã‚ÄãLimit. <br><br>  Toutes les files d'attente devraient finalement fusionner en une seule interface de sortie. <br><br>  Rappelez-vous la situation lorsque sur la route 8 voies fusionnent en 3. Sans contr√¥leur de circulation, cela se transforme en chaos.  La s√©paration √† son tour n'aurait pas de sens si nous avions la m√™me sortie que l'entr√©e. <br><br>  Par cons√©quent, il existe un r√©partiteur sp√©cial ( <b>Scheduler</b> ), qui supprime cycliquement les paquets de diff√©rentes files d'attente et les envoie √† l'interface ( <b>Scheduling</b> ). <br><br>  En fait, une combinaison d'un ensemble de files d'attente et d'un r√©partiteur est le m√©canisme de QoS le plus important qui vous permet d'appliquer diff√©rentes r√®gles √† diff√©rentes classes de trafic, l'une offrant une large bande passante, l'autre une faible latence, le troisi√®me manque de pertes. <br><br>  Ensuite, les paquets vont d√©j√† √† l'interface, o√π les paquets sont convertis en un flux binaire - s√©rialisation ( <b>s√©rialisation</b> ) puis le signal d'environnement. <br><br><img src="https://habrastorage.org/webt/dy/i2/pk/dyi2pkpat1havyiz3ps3dmret-y.png" width="700"><br><br>  Dans DiffServ, le comportement de chaque n≈ìud est ind√©pendant des autres; il n'y a aucun protocole de signalisation qui indiquerait quelle politique de QoS se trouve sur le r√©seau.  Dans le m√™me temps, au sein du r√©seau, je souhaite que le trafic soit g√©r√© de la m√™me mani√®re.  Si un seul n≈ìud se comporte diff√©remment, l'int√©gralit√© de la politique de QoS est perdue. <br><br>  Pour cela, d'une part, sur tous les routeurs, les m√™mes classes et PHB sont configur√©s pour eux, et d'autre part, le <b>Marquage du</b> paquet est utilis√© - son appartenance √† une classe particuli√®re est enregistr√©e dans l'en-t√™te (IP, MPLS, 802.1q). <br><br>  Et la beaut√© de DiffServ est que le n≈ìud suivant peut s'appuyer sur cette √©tiquette pour la classification. <br><br>  Une telle zone de confiance, dans laquelle les m√™mes r√®gles de classification du trafic et les m√™mes comportements s'appliquent, est appel√©e le domaine <b>DiffServ</b> ( <b>DiffServ-Domain</b> ). <br><br><img src="https://habrastorage.org/webt/8o/7d/ex/8o7dexwfq0xawzyhsuix7-viewi.png" width="700"><br><br>  Ainsi, √† l'entr√©e du domaine DiffServ, nous pouvons classer un package bas√© sur 5-Tuple ou une interface, le marquer ( <b>Remark / Rewrite</b> ) selon les r√®gles du domaine, et d'autres n≈ìuds feront confiance √† ce marquage et ne feront pas de classification complexe. <br>  Autrement dit, il n'y a pas de signalisation explicite dans DiffServ, mais le n≈ìud peut indiquer √† tous les √©l√©ments suivants quelle classe ce paquet doit √™tre fourni, en attendant qu'il soit approuv√©. <br><br>  Aux jonctions entre les domaines DiffServ, vous devez n√©gocier (ou non) des politiques de QoS. <br><br>  L'image enti√®re ressemblera √† ceci: <br><br><img src="https://habrastorage.org/webt/_-/7v/nt/_-7vntuvn9r1ugem7yenmxoj9fw.png" width="1000"><br><blockquote>  Pour que ce soit clair, je vais donner un analogue de la vie r√©elle. <br>  Vol en avion (pas Victoire). <br>  Il existe trois classes de services (CoS): √âconomie, Affaires, Premi√®re. <br>  Lors de l'achat d'un billet, la classification a lieu - le passager re√ßoit une certaine classe de service en fonction du prix. <br>  √Ä l'a√©roport, il y a un marquage (Remarque) - un billet est √©mis indiquant la classe. <br>  Il existe deux comportements (PHB): Best Effort et Premium. <br>  Il existe des m√©canismes qui mettent en ≈ìuvre des comportements: une salle d'attente commune ou un salon VIP, un minibus ou un bus partag√©, de grands si√®ges confortables ou des rang√©es √©troites, le nombre de passagers par agent de bord, la possibilit√© de commander de l'alcool. <br>  Selon la classe, des mod√®les de comportement sont attribu√©s - √† l'√©conomie Best Effort, √† Business - Premium Basic et √† First - Premium SUPER-POWER-NINJA-TURBO-NEO-ULTRA-HYPER-MEGA-MULTI-ALPHA-META-EXTRA-UBER-PREFIX! <br>  En m√™me temps, deux primes diff√®rent en ce que, dans l'une, elles donnent un verre de demi-sucr√©, et dans l'autre, elles ont un Bacardi illimit√©. <br><br>  Puis, √† l'arriv√©e √† l'a√©roport, tout le monde passe par une porte.  Ceux qui ont essay√© d'apporter des armes avec eux ou qui n'ont pas de ticket ne sont pas autoris√©s (Drop).  Les affaires et l'√©conomie entrent dans des salles d'attente et des transports diff√©rents (Queuing).  D'abord, ils ont laiss√© la First Class √† bord, puis les affaires, puis l'√©conomie (la planification), puis ils ont tous vol√© vers leur destination avec un seul avion (interface). <br><br>  Dans le m√™me exemple, un vol en avion est un retard de propagation, l'atterrissage est un retard de s√©rialisation, l'attente d'un avion dans les couloirs est en file d'attente et le contr√¥le des passeports est en cours de traitement.  Notez qu'ici, le d√©lai de traitement est g√©n√©ralement n√©gligeable en termes de temps total. <br><br>  Le prochain a√©roport peut traiter les passagers d'une mani√®re compl√®tement diff√©rente - son PHB est diff√©rent.  Mais en m√™me temps, si le passager ne change pas de compagnie a√©rienne, l'attitude envers lui ne changera probablement pas, car une entreprise est un domaine DiffServ. <br></blockquote>  Comme vous l'avez peut-√™tre remarqu√©, DiffServ est extr√™mement (ou infiniment) complexe.  Mais nous analyserons tout ce qui est d√©crit ci-dessus.  Dans le m√™me temps, dans l'article je n'entrerai pas dans les nuances de l'impl√©mentation physique (elles peuvent diff√©rer m√™me sur deux cartes du m√™me routeur), je ne parlerai pas de HQoS et MPLS DS-TE. <br><br>  Le seuil pour entrer dans le cercle des ing√©nieurs qui comprennent la technologie de QoS est beaucoup plus √©lev√© que pour les protocoles de routage, MPLS ou, pardonnez-moi, Radya, STP. <br><br>  Malgr√© cela, DiffServ a gagn√© la reconnaissance et la mise en ≈ìuvre sur les r√©seaux du monde entier, car, comme on dit, tr√®s √©volutif. <br><br>  Dans le reste de cet article, je n'analyserai que DiffServ. <br><br>  Ci-dessous, nous analyserons tous les outils et processus indiqu√©s dans l'illustration. <br><br><img src="https://habrastorage.org/webt/qb/21/kg/qb21kgaqnsm6-pi2qwe0rdniqq4.png" width="600"><br><br><hr><br>  Au cours de l'√©largissement du sujet, je montrerai certaines choses dans la pratique. <br>  Nous travaillerons avec un tel r√©seau: <br><br><img src="https://habrastorage.org/webt/zc/0o/zn/zc0ozndb8nmrqajljkf98pp79tk.png" width="900"><br><br>  Trisolarans est un client fournisseur de liens avec deux points de connexion. <br><br>  La zone jaune est le domaine DiffServ du r√©seau linkmeup, o√π une seule politique QoS est en vigueur. <br>  Linkmeup_R1 est un appareil CPE g√©r√© par le fournisseur, et donc dans une zone de confiance.  OSPF est soulev√© avec lui et l'interaction a lieu via une IP propre. <br><br>  Au c≈ìur du r√©seau se trouvent MPLS + LDP + MP-BGP avec L3VPN, √©tir√© de Linkmeup_R2 √† Linkmeup_R4. <br>  Je ferai tous les autres commentaires n√©cessaires. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le fichier de configuration initial</a> . <br><br><hr><br><h1>  4. Classification et √©tiquetage </h1><br>  Au sein de son r√©seau, l'administrateur d√©finit les classes de service auxquelles il peut fournir du trafic. <br><br>  Par cons√©quent, la premi√®re chose que fait chaque n≈ìud lorsqu'il re√ßoit un paquet est de le classer. <br><br>  Il existe trois fa√ßons: <br><br><ol><li>  <b>Agr√©gat de comportement</b> ( <b>BA</b> ) <br>  Faites simplement confiance √† l'√©tiquette de package existante dans son en-t√™te.  Par exemple, le champ IP DSCP. <br>  Il est appel√© ainsi car sous la m√™me √©tiquette dans le champ DSCP, diverses cat√©gories de trafic sont agr√©g√©es qui attendent le m√™me comportement par rapport √† elles-m√™mes.  Par exemple, toutes les sessions SIP seront regroup√©es en une seule classe. <br><br>  Le nombre de classes de service possibles, et donc les mod√®les de comportement, est limit√©.  En cons√©quence, il est impossible pour chaque cat√©gorie (ou plus encore pour le flux) de s√©parer une classe distincte - il est n√©cessaire de l'agr√©ger. </li><li>  <b>Bas√© sur l'interface</b> <br>  Tout ce qui vient √† une interface particuli√®re doit √™tre plac√© dans une classe de trafic.  Par exemple, nous savons avec certitude que le serveur de base de donn√©es est connect√© √† ce port et rien de plus.  Et dans un autre poste de travail des employ√©s. </li><li>  <b>MultiField</b> ( <b>MF</b> ) <br>  Analysez les champs d'en-t√™te de paquet - adresses IP, ports, adresses MAC.  De mani√®re g√©n√©rale, des champs arbitraires. <br><br>  Par exemple, tout le trafic qui va vers le sous-r√©seau 10.127.721.0/24 sur le port 5000 doit √™tre marqu√© comme trafic, n√©cessitant conditionnellement la 5e classe de service. </li></ol><br>  L'administrateur d√©termine l'ensemble des classes de service que le r√©seau peut fournir et leur mappe une valeur num√©rique. <br><br>  A l'entr√©e du domaine DS, nous ne faisons confiance √† personne, le classement s'effectue donc de la deuxi√®me ou troisi√®me mani√®re: en fonction des adresses, protocoles ou interfaces, la classe de service et la valeur num√©rique correspondante sont d√©termin√©es. <br><br>  √Ä la sortie du premier n≈ìud, ce chiffre est cod√© dans le champ DSCP de l'en-t√™te IP (ou un autre champ de la classe de trafic: classe de trafic MPLS, classe de trafic IPv6, Ethernet 802.1p) - une remarque se produit. <br><br>  Il est habituel de faire confiance √† cet √©tiquetage √† l'int√©rieur du domaine DS, par cons√©quent, les n≈ìuds de transit utilisent la premi√®re m√©thode de classification (BA) - la plus simple.  Aucune analyse de cap compliqu√©e, il suffit de regarder le nombre enregistr√©. <br><br>  √Ä la jonction de deux domaines, vous pouvez classer en fonction d'une interface ou MF, comme je l'ai d√©crit ci-dessus, ou vous pouvez faire confiance au marquage BA avec des r√©serves. <br><br>  Par exemple, faites confiance √† toutes les valeurs √† l'exception de 6 et 7 et r√©affectez 6 et 7 √† 5. <br><br>  Cette situation est possible lorsque le fournisseur connecte une entit√© juridique qui a sa propre politique d'√©tiquetage.  Le fournisseur n'a pas d'objection √† l'enregistrer, mais ne souhaite pas que le trafic tombe dans la classe dans laquelle il re√ßoit les paquets de protocole r√©seau. <br><br><img src="https://habrastorage.org/webt/8o/7d/ex/8o7dexwfq0xawzyhsuix7-viewi.png" width="900"><br><br><h2>  Agr√©gation de comportements </h2><br>  BA utilise une classification tr√®s simple - je vois un nombre - je comprends la classe. <br>  Alors quel est le chiffre?  Et dans quel domaine est-il enregistr√©? <br><br><ul><li>  Classe de trafic IPv6 </li><li>  Classe de trafic MPLS </li><li>  Ethernet 802.1p </li></ul><br>  La classification est principalement bas√©e sur l'en-t√™te de commutation. <br><br>  <i>J'appelle un en-t√™te de navettage sur la base duquel l'appareil d√©termine o√π envoyer le paquet afin qu'il se rapproche du destinataire.</i> <br>  Autrement dit, si un paquet IP arrive sur le routeur, l'en-t√™te IP et le champ DSCP sont analys√©s.  Si MPLS arrive, il est analys√© - MPLS Traffic Class. <br><br>  Si un paquet Ethernet + VLAN + MPLS + IP est arriv√© √† un commutateur L2 normal, alors 802.1p sera analys√© (bien que cela puisse √™tre modifi√©). <br><br><h3>  IPv4 TOS </h3><br>  Le champ QoS nous accompagne exactement autant que l'IP.  Le champ TOS √† huit bits - Type de service - √©tait cens√© porter la priorit√© du paquet. <br><br>  M√™me avant l'av√®nement de DiffServ, la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 791</a> ( <i>INTERNET PROTOCOL</i> ) d√©crivait le domaine comme ceci: <br><br>  Priorit√© IP (IPP) + DTR + 00. <br><br><img src="https://habrastorage.org/webt/fw/fe/of/fwfeofy_xr9dbft1vbap2djoszm.png" width="700"><br><br>  Autrement dit, la priorit√© du package va, puis les bits d'exactitude au d√©lai, au d√©bit, √† la fiabilit√© (0 - sans exigences, 1 - avec exigences). <br><br>  Les deux derniers bits doivent √™tre nuls. <br><br><div class="spoiler">  <b class="spoiler_title">La priorit√© a d√©termin√© les valeurs suivantes ...</b> <div class="spoiler_text">  111 - Contr√¥le du r√©seau <br>  110 - Contr√¥le interr√©seau <br>  101 - CRITIQUE / ECP <br>  100 - Contournement du flash <br>  011 - Flash <br>  010 - Imm√©diat <br>  001 - Priorit√© <br>  000 - Routine <br></div></div><br>  Plus tard dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 1349</a> ( <i>Type de service dans Internet Protocol Suite</i> ), le champ TOS a √©t√© l√©g√®rement red√©fini: <br><br><img src="https://habrastorage.org/webt/95/dz/pm/95dzpm400ckireeowdta1q_7lvg.png" width="700"><br><br>  Les trois bits de gauche sont rest√©s IP Precedence, les quatre suivants se sont transform√©s en TOS apr√®s avoir ajout√© le bit Cost. <br><br>  Voici comment lire les unit√©s dans ces bits TOS: <br><br><ul><li>  D - ¬´minimiser le d√©lai¬ª, </li><li>  T - "maximiser le d√©bit", </li><li>  R - "maximiser la fiabilit√©", </li><li>  C - ¬´minimiser les co√ªts¬ª. </li></ul><br>  Les descriptions floues n'ont pas contribu√© √† la popularit√© de cette approche. <br><br>  Il n'y avait pas d'approche syst√©matique de la QoS tout au long du chemin, il n'y avait pas de recommandations claires sur la fa√ßon d'utiliser le champ prioritaire, la description des bits de retard, de d√©bit et de fiabilit√© √©tait extr√™mement vague. <br><br>  Par cons√©quent, dans le contexte de DiffServ, le champ TOS a de nouveau √©t√© red√©fini dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 2474</a> ( <i>D√©finition du champ Services diff√©renci√©s (champ DS) dans les en-t√™tes IPv4 et IPv6</i> ): <br><br><img src="https://habrastorage.org/webt/n_/ie/zm/n_iezmmdhv2tg7qlbxqad7c_4_m.png" width="700"><br><br>  Au lieu des bits IPP et DTRC, le champ DSCP √† six bits - <b>Point de code des services diff√©renci√©s a √©t√©</b> introduit, les deux bits de droite n'ont pas √©t√© utilis√©s. <br><br>  √Ä partir de ce moment, c'est le champ DSCP qui aurait d√ª devenir le marquage principal de DiffServ: une certaine valeur (code) y est √©crite, qui, dans le domaine DS, caract√©rise la classe de service sp√©cifique requise par le package et sa priorit√© de suppression.  C'est le m√™me chiffre. <br><br>  L'administrateur peut utiliser les 6 bits de DSCP comme bon lui semble, partageant jusqu'√† un maximum de 64 classes de service. <br><br>  Cependant, dans un souci de compatibilit√© avec la priorit√© IP, ils ont conserv√© le r√¥le de s√©lecteur de classe pour les trois premiers bits. <br><br>  Autrement dit, comme dans IPP, 3 bits de s√©lecteur de classe vous permettent de d√©finir 8 classes. <br><br><img src="https://habrastorage.org/webt/fw/vl/p0/fwvlp0wanilpj7_lrp8bxj7blqe.png" width="700"><br><br>  Cependant, ce n'est rien de plus qu'un arrangement que, dans les limites de son domaine DS, l'administrateur peut facilement ignorer et utiliser les 6 bits √† sa discr√©tion. <br><br>  De plus, je note √©galement que selon les recommandations de l'IETF, plus la valeur enregistr√©e dans le CS est √©lev√©e, plus ce trafic vers le service est exigeant. <br><br>  Mais cela ne doit pas √™tre consid√©r√© comme une v√©rit√© ind√©niable. <br><br>  Si les trois premiers bits d√©finissent la classe de trafic, les trois suivants sont utilis√©s pour indiquer la priorit√© de suppression de paquets (priorit√© de suppression ou <b>priorit√© de perte de paquets - PLP</b> ). <br><blockquote>  Huit classes - est-ce beaucoup ou peu?  √Ä premi√®re vue, ce n'est pas suffisant - apr√®s tout, il y a tellement de trafic diff√©rent sur le r√©seau que l'on veut distinguer chaque protocole par classe.  Cependant, il s'av√®re que huit suffisent pour tous les sc√©narios possibles. <br>  Pour chaque classe, vous devez d√©finir un PHB qui le g√©rera diff√©remment des autres classes. <br>  Et avec une augmentation du diviseur, le dividende (ressource) n'augmente pas. <br>  Je ne parle pas d√©lib√©r√©ment des valeurs exactes de la classe de trafic qu'ils d√©crivent, car il n'y a pas de normes et vous pouvez les utiliser officiellement √† votre discr√©tion.  Ci-dessous, je vous dirai quelles classes et leurs valeurs correspondantes sont recommand√©es. <br></blockquote><div class="spoiler">  <b class="spoiler_title">Bits ECN ...</b> <div class="spoiler_text">  Le champ ECN √† deux bits n'apparaissait que dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 3168</a> ( <i>Explicit Congestion Notification</i> ).  Le champ a √©t√© d√©fini dans le bon but d'informer explicitement les h√¥tes finaux que quelqu'un rencontrait de la congestion en cours de route. <br>  Par exemple, lorsque les paquets sont retard√©s pendant longtemps dans les files d'attente du routeur et les remplissent, par exemple, de 85%, il modifie la valeur ECN, indiquant √† l'h√¥te final ce qui doit √™tre plus lent - quelque chose comme Pause Frames on Ethernet. <br><br>  Dans ce cas, l'exp√©diteur doit r√©duire le d√©bit de transmission et r√©duire la charge sur le n≈ìud souffrant. <br><br>  En m√™me temps, th√©oriquement, la prise en charge de ce champ par tous les n≈ìuds de transit n'est pas requise.  Autrement dit, l'utilisation d'ECN ne rompt pas le r√©seau qui ne le prend pas en charge. <br><br>  Le but est bon, mais avant application dans la vie ECN n'est pas particuli√®rement trouv√©.  De nos jours, les m√©ga et hyperscales regardent ces deux bits avec un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nouvel int√©r√™t</a> . <br><br>  ECN est l'un des m√©canismes d'√©vitement de la congestion d√©crits ci-dessous. <br></div></div><br><hr><br><h4>  Pratique de classification DSCP </h4><br>  √áa ne fait pas mal un peu de pratique. <br><br>  Le sch√©ma est le m√™me. <br><br><img src="https://habrastorage.org/webt/zc/0o/zn/zc0ozndb8nmrqajljkf98pp79tk.png" width="900"><br><br>  Pour commencer, envoyez simplement une demande ICMP: <br><br><pre><code class="hljs pgsql">Linkmeup_R1#ping ip <span class="hljs-number"><span class="hljs-number">172.16</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> source <span class="hljs-number"><span class="hljs-number">172.16</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">escape</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abort</span></span>. Sending <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>-byte ICMP Echos <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">172.16</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>, timeout <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> seconds: Packet sent <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> a source address <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">172.16</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> !!!!! Success rate <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> percent (<span class="hljs-number"><span class="hljs-number">5</span></span>/<span class="hljs-number"><span class="hljs-number">5</span></span>), round-trip min/avg/max = <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span> ms</code> </pre> <br>  <i>Linkmeup_R1.</i>  <i>E0 / 0.</i> <br><br><img src="https://habrastorage.org/webt/6g/zl/lp/6gzllpyfrbtsvqjd3sqn-rljc8g.png" width="600"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pcapng</a></i> <br><br>  Et maintenant avec la valeur DSCP d√©finie. <br><br><pre> <code class="hljs pgsql"> Linkmeup_R1#ping ip <span class="hljs-number"><span class="hljs-number">172.16</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> source <span class="hljs-number"><span class="hljs-number">172.16</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> tos <span class="hljs-number"><span class="hljs-number">184</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">escape</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abort</span></span>. Sending <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>-byte ICMP Echos <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">172.16</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>, timeout <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> seconds: Packet sent <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> a source address <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">172.16</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> !!!!! Success rate <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> percent (<span class="hljs-number"><span class="hljs-number">5</span></span>/<span class="hljs-number"><span class="hljs-number">5</span></span>), round-trip min/avg/max = <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span> ms</code> </pre> <br>  La valeur 184 est la repr√©sentation d√©cimale du binaire 10111000. Parmi ceux-ci, les 6 premiers bits sont 101110, c'est-√†-dire d√©cimal 46, et c'est la classe EF. <br><br><div class="spoiler">  <b class="spoiler_title">Tableau des valeurs TOS standard pour un popingushki pratique ...</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/z5/fx/ij/z5fxijhtpv24gndpefezlypbdju.png" width="500"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Plus de d√©tails</a></i> <br>  Ci-dessous dans le texte du chapitre de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">recommandation</a> de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">IETF,</a> je vais vous dire d'o√π viennent ces num√©ros et noms. <br></div></div><br>  <i>Linkmeup_R2.</i>  <i>E0 / 0</i> <br><br><img src="https://habrastorage.org/webt/y_/fn/gn/y_fngnyvicccbvsesftdw5lawrc.png" width="600"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pcapng</a></i> <br><br>  Remarque curieuse: la destination de pingushka dans la r√©ponse ICMP Echo d√©finit la m√™me valeur de classe que dans Echo Request.  C'est logique - si l'exp√©diteur a envoy√© un paquet avec un certain niveau d'importance, il veut √©videmment le recevoir en retour. <br><br>  <i>Linkmeup_R2.</i>  <i>E0 / 0</i> <br><br><img src="https://habrastorage.org/webt/wk/uu/ea/wkuueaujq2oqgrgd6cu960kqezu.png" width="600"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fichier de configuration de la classification DSCP.</a> <br><br><h3>  Classe de trafic IPv6 </h3><br>  IPv6 n'est pas tr√®s diff√©rent en termes de QoS que IPv4.  Le champ de huit bits, appel√© classe de trafic, est √©galement divis√© en deux parties.  Les 6 premiers bits - DSCP - jouent exactement le m√™me r√¥le. <br><br><img src="https://habrastorage.org/webt/cu/xd/nf/cuxdnfexzlj8ls4zjd3qxwh8oa8.png" width="700"><br><br>  Oui, Flow Label est apparu.  Ils disent qu'il pourrait √™tre utilis√© pour une diff√©renciation suppl√©mentaire des classes.  Mais cette id√©e n'a pas encore √©t√© appliqu√©e dans la vie. <br><br><h3>  Classe de trafic MPLS </h3><br>  Le concept de DiffServ √©tait ax√© sur les r√©seaux IP avec routage d'en-t√™te IP.  C'est juste de la malchance - apr√®s 3 ans, ils ont publi√© la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 3031</a> ( <i>Multiprotocol Label Switching Architecture</i> ).  Et MPLS a commenc√© √† reprendre les fournisseurs de r√©seau. <br><br>  DiffServ n'a pas pu lui √™tre √©tendu. <br><br>  Par une heureuse co√Øncidence, un champ EXP de trois bits a √©t√© plac√© dans MPLS pour tout cas exp√©rimental.  Et malgr√© le fait qu'il y a longtemps dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 5462</a> (le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">champ</a> <i>¬´EXP¬ª renomm√© en champ ¬´Traffic Class¬ª</i> ) est devenu officiellement le champ Traffic Class, par inertie, il est appel√© IExPi. <br><br>  Il y a un probl√®me: sa longueur est de trois bits, ce qui limite le nombre de valeurs possibles √† 9. Ce n'est pas seulement petit, c'est 3 ordres binaires de moins que DSCP. <br><br><img src="https://habrastorage.org/webt/is/r0/tc/isr0tc7unhhkxs-bjevcbipjq6k.png" width="700"><br><br>  √âtant donn√© que la classe de trafic MPLS est souvent h√©rit√©e du paquet IP DSCP, nous avons l'archivage avec perte.  Ou ... Non, vous ne voulez pas savoir √ßa ... <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L-LSP</a> .  Utilise une combinaison de classe de trafic + valeur d'√©tiquette. <br><blockquote>  G√©n√©ralement, la situation est √©trange - MPLS a √©t√© con√ßu comme une aide IP pour une prise de d√©cision rapide - le label MPLS est instantan√©ment d√©tect√© dans CAM par Full Match, au lieu du traditionnel Longest Prefix Match.  Autrement dit, ils connaissaient IP et participaient au changement, mais ne pr√©voyaient pas de champ de priorit√© normal. <br></blockquote>  En fait, nous avons d√©j√† vu ci-dessus que seuls les trois premiers bits de DSCP sont utilis√©s pour d√©terminer la classe de trafic, et les trois autres bits sont Drop Precedence (ou PLP - Packet Loss Priority). <br><br>  Par cons√©quent, en termes de classes de service, nous avons toujours une correspondance 1: 1, ne perdant que des informations sur Drop Precedence. <br><br>  Dans le cas de MPLS, la classification comme dans IP peut √™tre bas√©e sur l'interface, MF, IP DSCP ou Traffic Class MPLS. <br><br>  L'√©tiquetage signifie √©crire une valeur dans le champ Classe de trafic de l'en-t√™te MPLS. <br><br>  Un paquet peut contenir plusieurs en-t√™tes MPLS.  Aux fins de DiffServ, seul le haut est utilis√©. <br><br>  Il existe trois sc√©narios de re-marquage diff√©rents lors du d√©placement d'un paquet d'un segment IP pur √† un autre via le domaine MPLS: (ce n'est qu'un extrait de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> ). <br><br><ol><li>  Mode uniforme </li><li>  Mode tuyau </li><li>  Mode tuyau court </li></ol><br><div class="spoiler">  <b class="spoiler_title">Modes de fonctionnement ...</b> <div class="spoiler_text"><br><h3>  Mode uniforme </h3><br>  Il s'agit d'un mod√®le plat de bout en bout. <br><br><img src="https://habrastorage.org/web/e50/932/53b/e5093253bcf94dc091f88500be2b6f9d.png" width="1000"><br><br>  Chez Ingress PE, nous faisons confiance √† IP DSCP et copions (√† <i>proprement parler, affichons, mais pour simplifier, nous dirons ¬´copier¬ª</i> ) sa valeur dans MPLS EXP (tunnel et en-t√™tes VPN).  √Ä la sortie d'Ingress PE, le paquet est d√©j√† trait√© conform√©ment √† la valeur du champ EXP de l'en-t√™te MPLS sup√©rieur. <br><br>  Chaque transit P traite √©galement des paquets en fonction de l'EXP sup√©rieur.  Mais en m√™me temps, il peut le changer si l'op√©rateur le veut. <br><br>  L'avant-dernier n≈ìud supprime l'√©tiquette de transport (PHP) et copie la valeur EXP dans l'en-t√™te VPN.  Peu importe ce qui se trouvait l√† - en mode uniforme, la copie a lieu. <br><br>  Egress PE, en supprimant l'√©tiquette VPN, copie √©galement la valeur EXP dans IP DSCP, m√™me si quelque chose d'autre y est √©crit. <br><br>  Autrement dit, si quelque part au milieu la valeur de l'√©tiquette EXP dans l'en-t√™te du tunnel a chang√©, alors cette modification sera h√©rit√©e par le paquet IP. <br><br><h3>  Mode tuyau </h3><br><img src="https://habrastorage.org/web/5a1/f9a/a46/5a1f9aa46bb94ed88d62185535f5b41e.png" width="1000"><br><br>  Si sur Ingress PE, nous avons d√©cid√© de ne pas faire confiance √† la valeur DSCP, la valeur EXP souhait√©e par l'op√©rateur est ins√©r√©e dans les en-t√™tes MPLS. <br><br>  Mais il est acceptable de copier ceux qui √©taient dans DSCP.  Par exemple, vous pouvez red√©finir les valeurs - copiez tout jusqu'√† EF et mappez CS6 et CS7 √† EF. <br><br>  Chaque transit P ne regarde que l'EXP de l'en-t√™te MPLS sup√©rieur. <br><br>  L'avant-dernier n≈ìud supprime l'√©tiquette de transport (PHP) et <b>copie</b> la valeur EXP dans l'en-t√™te VPN. <br><br>  Egress PE traite d'abord le paquet en fonction du champ EXP dans l'en-t√™te MPLS, puis le supprime uniquement, <b>sans copier la</b> valeur dans DSCP. <br><br>  Autrement dit, ind√©pendamment de ce qui est arriv√© au champ EXP dans les en-t√™tes MPLS, l'IP DSCP reste inchang√©. <br><br>  Un tel sc√©nario peut √™tre utilis√© lorsque l'op√©rateur a son propre domaine Diff-Serv et qu'il ne veut pas que le trafic client l'influence d'une mani√®re ou d'une autre. <br><br><h3>  Mode tuyau court </h3><br><img src="https://habrastorage.org/web/f80/1c8/e2d/f801c8e2dac84ff1b376a5f68824d93e.png" width="1000"><br><br>  Vous pouvez consid√©rer ce mode comme une variante du mode Pipe.  La seule diff√©rence est qu'√† la sortie du r√©seau MPLS, le paquet est trait√© conform√©ment √† son champ IP DSCP, et non √† MPLS EXP. <br><br>  Cela signifie que la priorit√© du paquet √† la sortie est d√©termin√©e par le client, pas par l'op√©rateur. <br>  Ingress PE ne fait pas confiance aux paquets entrants IP DSCP <br>  Transit Ps regarde dans le champ EXP de l'en-t√™te sup√©rieur. <br>  L'avant-dernier P supprime l'√©tiquette de transport et copie la valeur dans l'√©tiquette VPN. <br>  Egress PE supprime d'abord l'√©tiquette MPLS, puis traite le paquet dans les files d'attente. <br><br>  Explication de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cisco</a> . <br></div></div><br><hr><br><h4>  Pratique de classification MPLS Traffic Class </h4><br>  Le sch√©ma est le m√™me: <br><br><img src="https://habrastorage.org/webt/zc/0o/zn/zc0ozndb8nmrqajljkf98pp79tk.png" width="900"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le fichier de configuration est le m√™me.</a> <br><br>  Dans le diagramme de r√©seau Linkmeup, il y a une transition de IP √† MPLS √† Linkmeup_R2. <br>  Voyons ce qui se passe avec le marquage lors du ping <b>ping de l'IP 172.16.2.2 source 172.16.1.1 tos 184</b> . <br><br>  <i>Linkmeup_R2.</i>  <i>E0 / 0.</i> <br><img src="https://habrastorage.org/webt/lj/at/14/ljat14wahqfc91ojgigmlrwayzo.png" width="600"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pcapng</a></i> <br><br>  Ainsi, nous voyons que l'√©tiquette EF d'origine dans IP DSCP a √©t√© transform√©e en la valeur 5 du champ EXP MPLS (c'est aussi la classe de trafic, rappelez-vous ceci) √† la fois de l'en-t√™te VPN et de l'en-t√™te de transport. <br>  Nous assistons ici au mode de fonctionnement uniforme. <br><br><hr><br><h3>  Ethernet 802.1p </h3><br>  L'absence de champ prioritaire dans 802.3 (Ethernet) s'explique par le fait qu'Ethernet √©tait initialement pr√©vu exclusivement comme une solution pour le segment LAN.  Pour un argent modeste, vous pouvez obtenir une bande passante excessive, et la liaison montante sera toujours un goulot d'√©tranglement - il n'y a rien √† craindre de prioriser. <br><br>  Cependant, il est vite devenu clair que l'attractivit√© financi√®re d'Ethernet + IP porte ce bundle aux niveaux de la dorsale et du WAN.  Et la cohabitation dans un segment LAN de torrents et de t√©l√©phonie doit √™tre r√©solue. <br><br>  Heureusement, 802.1q (VLAN) est arriv√© √† temps pour cela, dans lequel un champ 3 bits (√† nouveau) a √©t√© allou√© pour les priorit√©s. <br><br>  Dans le plan DiffServ, ce champ vous permet de d√©finir les 8 m√™mes classes de trafic. <br><br><img src="https://habrastorage.org/webt/oh/_i/1l/oh_i1l1omqt1rk8agowdenx6x7o.png" width="600"><br><br><hr><br>  Lors de la r√©ception d'un paquet, le p√©riph√©rique r√©seau du domaine DS prend dans la plupart des cas en compte l'en-t√™te qu'il utilise pour la commutation: <br><br><ul><li>  Commutateur Ethernet - 802.1p </li><li>  Noeud MPLS - Classe de trafic MPLS </li><li>  Routeur IP - IP DSCP </li></ul><br>  Bien que ce comportement puisse √™tre modifi√©: classification bas√©e sur l'interface et multi-champs.  Et vous pouvez parfois m√™me explicitement dire dans le champ CoS quel en-t√™te regarder. <br><br><hr><br><h2>  Bas√© sur l'interface </h2><br>  C'est le moyen le plus simple de classer les packages sur le front.  Tout ce qui est vers√© dans l'interface sp√©cifi√©e est marqu√© d'une certaine classe. <br><br>  Dans certains cas, cette granularit√© est suffisante, donc bas√©e sur l'interface est utilis√©e dans la vie. <br><br><h4>  Pratique de classification bas√©e sur l'interface </h4><br>  Le sch√©ma est le m√™me: <br><br><img src="https://habrastorage.org/webt/zc/0o/zn/zc0ozndb8nmrqajljkf98pp79tk.png" width="900"><br><br>  La configuration des politiques de QoS dans l'√©quipement de la plupart des fournisseurs est divis√©e en √©tapes. <br><br><ol><li>  Tout d'abord, un classificateur est d√©fini: <br> <code>class-map match-all TRISOLARANS_INTERFACE_CM <br> match input-interface Ethernet0/2</code> <br>  Tout ce qui vient √† l'interface Ethernet0 / 2. <br></li><li>  Ensuite, une strat√©gie est cr√©√©e dans laquelle le classificateur et l'action n√©cessaire sont associ√©s. <br><br><pre> <code class="hljs pgsql"> <span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-map TRISOLARANS_REMARK <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> TRISOLARANS_INTERFACE_CM <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ip dscp cs7</code> </pre> <br>  Si le paquet rencontre le classificateur TRISOLARANS_INTERFACE_CM, √©crivez CS7 dans le champ DSCP. <br><blockquote>  Ici, je devance moi-m√™me en utilisant l'obscur CS7, puis EF, AF.  Vous trouverez ci-dessous des informations sur ces abr√©viations et accords accept√©s.  En attendant, il suffit de savoir que ce sont des classes diff√©rentes avec des niveaux de service diff√©rents. <br></blockquote></li><li>  Et la derni√®re √©tape consiste √† appliquer la strat√©gie √† l'interface: <br><br><pre> <code class="hljs pgsql"> interface Ethernet0/<span class="hljs-number"><span class="hljs-number">2</span></span> service-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> TRISOLARANS_REMARK</code> </pre> <br><blockquote>  Ici, le classificateur est un peu redondant, ce qui v√©rifiera que le paquet est arriv√© √† l'interface e0 / 2, o√π nous appliquons ensuite la politique.  On pourrait √©crire n'importe quel match: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-map match-<span class="hljs-keyword"><span class="hljs-keyword">all</span></span> TRISOLARANS_INTERFACE_CM match <span class="hljs-keyword"><span class="hljs-keyword">any</span></span></code> </pre> <br>  Cependant, la politique peut r√©ellement √™tre appliqu√©e sur vlanif ou sur l'interface de sortie, donc c'est possible. <br></blockquote><br></li></ol><br>  Ex√©cutez le ping habituel sur 172.16.2.2 (Trisolaran2) avec Trisolaran1: <br><br><img src="https://habrastorage.org/webt/sm/gh/5j/smgh5j3nxjmen6yspkxl8tu9so8.png" width="400"><br><br>  Et dans le vidage entre Linkmeup_R1 et Linkmeup_R2, nous verrons ce qui suit: <br><br><img src="https://habrastorage.org/webt/rh/qe/6z/rhqe6z4z98dxmkcrygfpb7zboee.png" width="600"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pcapng</a></i> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Classification bas√©e sur l'interface du fichier de configuration.</a> <br><br><h2>  Multi-domaines </h2><br>  Le type de classification le plus courant √† l'entr√©e du domaine DS.  Nous ne faisons pas confiance √† l'√©tiquetage existant, et sur la base des en-t√™tes de package, nous attribuons une classe. <br><br>  Il s'agit souvent d'un moyen ¬´d'activer¬ª la qualit√© de service, dans le cas o√π les exp√©diteurs ne marquent pas. <br><br>  Un outil assez flexible, mais en m√™me temps lourd - vous devez cr√©er des r√®gles difficiles pour chaque classe.  Par cons√©quent, dans le domaine DS, BA est plus pertinent. <br><br><h4>  Pratique de classification MF </h4><br>  Le sch√©ma est le m√™me: <br><br><img src="https://habrastorage.org/webt/zc/0o/zn/zc0ozndb8nmrqajljkf98pp79tk.png" width="900"><br><br>  √Ä partir des exemples pratiques ci-dessus, on peut voir que les p√©riph√©riques r√©seau approuvent par d√©faut l'√©tiquetage des paquets entrants. <br><br>  C'est bien √† l'int√©rieur du domaine DS, mais pas acceptable au point d'entr√©e. <br><br>  Et maintenant, ne faisons pas confiance aveugl√©ment?  Sur <b>Linkmeup_R2,</b> ICMP sera √©tiquet√© comme EF (par exemple uniquement), TCP comme AF12, et tout le reste est CS0. <br>  Ce sera la classification MF (Multi-Field). <br><br><ol><li>  La proc√©dure est la m√™me, mais maintenant nous allons faire correspondre les ACL qui d√©crochaient les cat√©gories de trafic n√©cessaires, donc nous les cr√©ons d'abord. <br><br>  Sur Linkmeup_R2: <br><br><pre> <code class="hljs pgsql"> ip <span class="hljs-keyword"><span class="hljs-keyword">access</span></span>-list extended TRISOLARANS_ICMP_ACL permit icmp <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> ip <span class="hljs-keyword"><span class="hljs-keyword">access</span></span>-list extended TRISOLARANS_TCP_ACL permit tcp <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> ip <span class="hljs-keyword"><span class="hljs-keyword">access</span></span>-list extended TRISOLARANS_OTHER_ACL permit ip <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span></code> </pre> <br></li><li>  Ensuite, nous d√©finissons les classificateurs: <br><br><pre> <code class="hljs pgsql"> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-map match-<span class="hljs-keyword"><span class="hljs-keyword">all</span></span> TRISOLARANS_TCP_CM match <span class="hljs-keyword"><span class="hljs-keyword">access</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> TRISOLARANS_TCP_ACL <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-map match-<span class="hljs-keyword"><span class="hljs-keyword">all</span></span> TRISOLARANS_OTHER_CM match <span class="hljs-keyword"><span class="hljs-keyword">access</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> TRISOLARANS_OTHER_ACL <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-map match-<span class="hljs-keyword"><span class="hljs-keyword">all</span></span> TRISOLARANS_ICMP_CM match <span class="hljs-keyword"><span class="hljs-keyword">access</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> TRISOLARANS_ICMP_ACL</code> </pre> <br></li><li>  Et maintenant nous d√©finissons les r√®gles du remarking en politique: <br><br><pre> <code class="hljs pgsql"> <span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-map TRISOLARANS_ADMISSION_CONTROL <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> TRISOLARANS_ICMP_CM <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ip dscp ef <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> TRISOLARANS_TCP_CM <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ip dscp af11 <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> TRISOLARANS_OTHER_CM <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ip dscp <span class="hljs-keyword"><span class="hljs-keyword">default</span></span></code> </pre> <br></li><li>  Et nous suspendons la politique sur l'interface.  En entr√©e, respectivement, car la d√©cision doit √™tre prise √† l'entr√©e du r√©seau. <br><br><pre> <code class="hljs pgsql"> interface Ethernet0/<span class="hljs-number"><span class="hljs-number">1</span></span> service-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> TRISOLARANS_ADMISSION_CONTROL</code> </pre> <br></li></ol><br>  Test ICMP de l'h√¥te final Trisolaran1.  Nous ne sp√©cifions pas sciemment la classe - la valeur par d√©faut est 0. <br><br>  <b>J'ai d√©j√† supprim√© la strat√©gie avec Linkmeup_R1, donc le trafic vient avec le marquage CS0, pas CS7.</b> <br><br><img src="https://habrastorage.org/webt/_f/si/90/_fsi9012_fo5a8z1x14fdtxqz0m.png" width="400"><br><br>  Voici deux vidages √† proximit√©, avec Linkmeup_R1 et Linkmeup_R2: <br><br>  <i>Linkmeup_R1.</i>  <i>E0 / 0.</i> <br><img src="https://habrastorage.org/webt/cp/t5/ge/cpt5gersxbcrhjsba4lz8t-5z-i.png" width="600"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pcapng</a></i> <br><br>  <i>Linkmeup_R2.</i>  <i>E0 / 0.</i> <br><img src="https://habrastorage.org/webt/9x/0w/j7/9x0wj7gkztleiock6vnax33m-7c.png" width="600"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pcapng</a></i> <br><br>  On peut voir qu'apr√®s les classificateurs et le r√©√©tiquetage sur Linkmeup_R2 sur les paquets ICMP, non seulement DSCP est devenu EF, mais MPLS Traffic Class est devenu √©gal √† 5. <br><br>  Un test similaire avec telnet 172.16.2.2.  80 - v√©rifiez donc TCP: <br><br><img src="https://habrastorage.org/webt/rd/f1/xo/rdf1xovczuma9nuziqbawyyuqji.png" width="400"><br><br>  <i>Linkmeup_R1.</i>  <i>E0 / 0.</i> <br><img src="https://habrastorage.org/webt/-i/nr/gj/-inrgjtler0zsvt2y3hq3cxvd8m.png" width="600"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pcapng</a></i> <br><br>  <i>Linkmeup_R2.</i>  <i>E0 / 0.</i> <br><img src="https://habrastorage.org/webt/mk/z_/qz/mkz_qz44dywl9kr5uw3ohauu9qa.png" width="600"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pcapng</a></i> <br><br>  LIRE - √Ä quoi et √† quoi s'attendre.  TCP est transmis comme AF11. <br><br>  Le prochain test testera UDP, qui devrait aller √† CS0 selon nos classificateurs.  Nous utiliserons iperf pour cela (apportez-le √† Linux Tiny Core via les applications).  Sur le c√¥t√© distant <b>iperf3 -s</b> - d√©marrez le serveur, sur le <b>iperf3</b> local <b>-c -u -t1</b> - client ( <b>-c</b> ), protocole UDP ( <b>-u</b> ), testez 1 seconde ( <b>-t1</b> ). <br><br><img src="https://habrastorage.org/webt/zw/gu/sb/zwgusb4bqnq7prgq_yw5ue44pqo.png" width="400"><br><br>  <i>Linkmeup_R1.</i>  <i>E0 / 0.</i> <br><img src="https://habrastorage.org/webt/rm/sx/pq/rmsxpqgca2wmuhhcu5mcnvcth7y.png" width="600"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pcapng</a></i> <br><br>  <i>Linkmeup_R2.</i>  <i>E0 / 0</i> <br><img src="https://habrastorage.org/webt/yt/9q/gv/yt9qgv2qcqun9rpr8me4nuyghym.png" width="600"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pcapng</a></i> <br><br>  D√©sormais, tout ce qui arrive √† cette interface sera class√© selon les r√®gles configur√©es. <br><br><hr><br><h2>  Marquage √† l'int√©rieur de l'appareil </h2><br>  Encore une fois: √† l'entr√©e de la classification du domaine DS peut se produire MF, Interface-based ou BA. <br>  Entre les n≈ìuds du domaine DS, le paquet dans l'en-t√™te porte un signe sur la classe de service requise et est class√© par BA. <br><br>  Quelle que soit la m√©thode de classification, apr√®s celle-ci, le package se voit attribuer une classe interne au sein de l'appareil, en fonction de laquelle il est trait√©.  L'en-t√™te est supprim√© et le paquet nu (non) se d√©place vers la sortie. <br>  Et √† la sortie, la classe interne est convertie dans le champ CoS du nouvel en-t√™te. <br><br>  C'est-√†-dire, rubrique 1 ‚áí Classification ‚áí Classe de service interne ‚áí Rubrique 2. <br><br>  Dans certains cas, vous devez afficher le champ d'en-t√™te d'un protocole dans le champ d'en-t√™te d'un autre, par exemple, DSCP dans la classe de trafic. <br><br>  Cela se produit uniquement via le marquage interne interm√©diaire. <br><br>  Par exemple, En-t√™te DSCP ‚áí Classification ‚áí Classe de service interne ‚áí En-t√™te de classe de trafic. <br><br>  Formellement, les classes internes peuvent √™tre appel√©es comme vous le souhaitez, ou simplement num√©rot√©es, et elles ne disposent que d'une certaine file d'attente. <br><br>  √Ä la profondeur √† laquelle nous plongeons dans cet article, peu importe comment ils sont appel√©s, il est important qu'un mod√®le de comportement sp√©cifique soit associ√© √† des valeurs sp√©cifiques des champs QoS. <br><br>  Si nous parlons d'impl√©mentations QoS sp√©cifiques, le nombre de classes de service que le p√©riph√©rique peut fournir n'est pas sup√©rieur au nombre de files d'attente disponibles.  Il y en a souvent huit (soit sous l'influence d'IPP, soit parfois par accord non √©crit).  Cependant, selon le fournisseur, le p√©riph√©rique, la carte, ils peuvent √™tre plus ou moins. <br><br>  Autrement dit, s'il y a 4 files d'attente, les classes de service n'ont tout simplement pas de sens d'en faire plus de quatre. <br><br>  Parlons de cela plus en d√©tail dans le chapitre mat√©riel. <br><br><div class="spoiler">  <b class="spoiler_title">Si vous voulez toujours vraiment un peu de sp√©cificit√© ...</b> <div class="spoiler_text"><blockquote>  Les tableaux ci-dessous peuvent sembler pratiques √† premi√®re vue quant √† la relation entre les champs QoS et les classes internes, mais ils sont quelque peu trompeurs lors de l'appel des noms de classes PHB.  Pourtant, PHB est le type de mod√®le de comportement attribu√© au trafic d'une certaine classe, dont le nom, en gros, est arbitraire. <br><br>  Par cons√©quent, reportez-vous aux tableaux ci-dessous avec une part de scepticisme (donc, sous le spoiler). </blockquote><br>  <i>Sur l'exemple de Huawei</i> .  Ici, Service-Class est la classe tr√®s interne du package. <br><br>  Autrement dit, si BA est class√© √† l'entr√©e, les valeurs DSCP seront traduites en valeurs de classe de service et de couleur correspondantes. <br><br><img src="https://habrastorage.org/webt/h-/xh/sp/h-xhspe0wg3zymljrw4fdcd8v-u.png" width="500"><br><br>  Il convient de pr√™ter attention au fait que de nombreuses valeurs DSCP ne sont pas utilis√©es et que les paquets avec de tels marquages ‚Äã‚Äãsont en fait trait√©s comme BE. <br><br>  Voici un tableau de correspondance en arri√®re qui montre quelles valeurs DSCP seront d√©finies pour le trafic lorsque la sortie est re-marqu√©e. <br><br><img src="https://habrastorage.org/webt/as/t4/49/ast449vrq3tmkbo_xhxoqmvayjm.png" width="500"><br><br>  Notez que seul AF a une gradation de couleur.  BE, EF, CS6, CS7 - tout simplement vert. <br><br>  Il s'agit d'un tableau de conversion des champs IPP, MPLS Traffic Class et 802.1p Ethernet en classes de service internes. <br><br><img src="https://habrastorage.org/webt/d7/nz/up/d7nzupuudz6mpvapmunecfol43a.png" width="500"><br><br>  Et de retour. <br><br><img src="https://habrastorage.org/webt/nc/qz/zr/ncqzzr58m-3acsu1gid9xkowfxy.png" width="500"><br><br>  Notez que toute information sur la priorit√© de suppression est g√©n√©ralement perdue ici. <br><br>  Il doit √™tre r√©p√©t√© - ce n'est qu'un exemple sp√©cifique de correspondances par d√©faut d'un fournisseur s√©lectionn√© <i>au hasard</i> .  Pour d'autres, cela peut √™tre diff√©rent.  Les administrateurs peuvent configurer des classes de services et des PHB compl√®tement diff√©rentes sur leur r√©seau. <br><br></div></div><br>  En termes de PHB, il n'y a absolument aucune diff√©rence ce qui est utilis√© pour la classification - DSCP, Traffic Class, 802.1p. <br><br>  √Ä l'int√©rieur de l'appareil, ils se transforment en classes de trafic d√©finies par l'administrateur r√©seau. <br>  Autrement dit, tous ces marquages ‚Äã‚Äãsont un moyen de dire aux voisins quelle classe de service ils doivent attribuer √† ce package.  C'est √† peu pr√®s comme la communaut√© BGP, qui ne signifie rien en soi, jusqu'√† ce que la politique d'interpr√©tation soit d√©finie sur le r√©seau. <br><br><hr><br><h2>  Recommandations de l'IETF (cat√©gories de trafic, classes de service et comportements) </h2><br>  Les normes ne normalisent pas du tout quelles classes de service particuli√®res devraient exister, comment les classer et les √©tiqueter, et quel PHB leur appliquer. <br><br>  Ceci est √† la merci des fournisseurs et des administrateurs r√©seau. <br><br>  Nous n'avons que 3 bits - nous utilisons comme nous voulons. <br><br>  C'est bien: <br><br><ul><li>  Chaque morceau de fer (fournisseur) choisit ind√©pendamment les m√©canismes √† utiliser pour PHB - pas de signalisation, pas de probl√®mes de compatibilit√©. </li><li>  L'administrateur de chaque r√©seau peut r√©partir le trafic de mani√®re flexible entre diff√©rentes classes, choisir les classes elles-m√™mes et le PHB correspondant. </li></ul><br>  C'est mauvais: <br><br><ul><li>  Aux limites des domaines DS, des probl√®mes de conversion se posent. </li><li>  Dans des conditions de totale libert√© d'action - certains sont dans la for√™t, certains sont des d√©mons. </li></ul><br>  Par cons√©quent, l'IETF en 2006 a publi√© un manuel de formation sur la fa√ßon d'aborder la diff√©renciation des services: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 4594</a> ( <i>directives de configuration pour les classes de service DiffServ</i> ). <br><br>  Ce qui suit est un bref r√©sum√© de ce RFC. <br><br><h3>  Mod√®les de comportement (PHB) </h3><br>  <b>DF - Transfert par d√©faut</b> <br>  <i>Envoi standard.</i> <br>  Si un mod√®le de trafic n'est pas sp√©cifiquement affect√© √† un mod√®le de comportement, il sera trait√© √† l'aide du transfert par d√©faut. <br><br>  C'est le meilleur effort - l'appareil fera tout son possible, mais ne garantit rien.  Des baisses, des d√©sordres, des retards impr√©visibles et une gigue flottante sont possibles, mais ce n'est pas exact. <br><br>  Ce mod√®le convient aux applications peu exigeantes, telles que les t√©l√©chargements de courrier ou de fichiers. <br>  Soit dit en passant, il y a du PHB et encore moins d√©fini - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un effort</a> moindre. <br><br>  <b>AF - Transfert assur√©</b> <br>  <i>Envoi garanti.</i> <br>  Il s'agit d'un BE am√©lior√©.  Certaines garanties apparaissent ici, par exemple, les bandes.  Des baisses et des retards flottants sont toujours possibles, mais dans une bien moindre mesure. <br><br>  Le mod√®le convient au multim√©dia: streaming, vid√©oconf√©rence, jeux en ligne. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 2597</a> ( <i>groupe PHB de transfert assur√©</i> ). <br><br>  <b>EF - Exp√©dition acc√©l√©r√©e</b> <br>  <i>Envoi d'urgence.</i> <br>  Toutes les ressources et priorit√©s se pr√©cipitent ici.  C'est un mod√®le pour les applications qui n'ont pas besoin de pertes, de courts d√©lais, d'une gigue stable, mais elles ne sont pas gourmandes pour la bande.  Comme, par exemple, la t√©l√©phonie ou un service d'√©mulation de fil (CES - Circuit Emulation Service). <br><br>  Les pertes, les d√©sordres et les retards flottants dans EF sont extr√™mement improbables. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 3246</a> ( <i>un PHB de transfert acc√©l√©r√©</i> ). <br><br>  <b>CS - S√©lecteur de classe</b> <br>  Il s'agit de comportements con√ßus pour maintenir la compatibilit√© descendante avec la priorit√© IP dans les r√©seaux capables de DS. <br><br>  Les classes suivantes existent dans IPP: CS0, CS1, CS2, CS3, CS4, CS5, CS6, CS7. <br>  Pas toujours pour chacun d'eux il y a un PHB s√©par√©, g√©n√©ralement il y en a deux ou trois, et les autres sont simplement traduits dans la classe DSCP la plus proche et obtiennent le PHB correspondant. <br>  Ainsi, par exemple, un paquet √©tiquet√© CS 011000 peut √™tre class√© comme 011010. <br><br>  Parmi les CS, seuls CS6, CS7, qui sont recommand√©s pour NCP - Network Control Protocol et n√©cessitent un PHB distinct, sont s√ªrement conserv√©s dans l'√©quipement. <br><br>  Comme EF, PHB CS6.7 est con√ßu pour les classes qui ont des exigences de latence et de perte tr√®s √©lev√©es, mais sont quelque peu tol√©rantes √† la discrimination de bande. <br>  La t√¢che de PHB pour CS6.7 est de fournir un niveau de service qui √©limine les chutes et les retards, m√™me en cas de surcharge extr√™me de l'interface, de la puce et des files d'attente. <br><hr><br><br>  Il est important de comprendre que le PHB est un concept abstrait - et en fait, il est mis en ≈ìuvre par le biais de m√©canismes disponibles sur un √©quipement r√©el. <br><br>  Ainsi, le m√™me PHB d√©fini dans le domaine DS peut diff√©rer sur Juniper et Huawei. <br><br>  De plus, un seul PHB n'est pas un ensemble statique d'actions; par exemple, un PHB AF peut se composer de plusieurs options qui diff√®rent par le niveau de garanties (bande, retards acceptables). <br><br><hr><br><h3>  Classes de service </h3><br>  L'IETF a pris en charge les administrateurs et identifi√© les principales cat√©gories d'applications et leurs classes de service. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je ne serai pas verbeux ici, ins√©rez simplement quelques plaques de cette directive RFC. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cat√©gories d'application: </font></font><br><br><img src="https://habrastorage.org/webt/an/hr/np/anhrnppkfmebfm7vaoarb1xv7s0.png" width="600"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exigences pour les caract√©ristiques du r√©seau: </font></font><br><br><img src="https://habrastorage.org/webt/ih/5r/z2/ih5rz2jw4ifygst1mjgte9a_vc0.png" width="560"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et enfin, les noms de classe recommand√©s et les valeurs DSCP correspondantes: </font></font><br><br><img src="https://habrastorage.org/webt/jg/rp/4k/jgrp4kzhhhvz1-zygrsiexieeyy.png" width="560"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En combinant les classes ci-dessus de diff√©rentes mani√®res (pour tenir dans les 8 disponibles), vous pouvez obtenir des solutions QoS pour diff√©rents r√©seaux. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le plus courant est peut-√™tre celui-ci: la </font></font><br><br><img src="https://habrastorage.org/webt/su/ft/ed/suftedkuzswznewqbj3uslcncru.png" width="560"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe DF (ou BE) marque un trafic absolument peu exigeant - il re√ßoit une attention r√©siduelle. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHB AF dessert les classes AF1, AF2, AF3, AF4. Ils ont tous besoin de fournir une voie, au d√©triment des retards et des pertes. Les pertes sont contr√¥l√©es par les bits Drop Precedence, c'est pourquoi ils sont appel√©s AFxy, o√π x est la classe de service et y est Drop Precedence.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EF a besoin d'une sorte de garantie de bande minimale, mais plus important encore - une garantie de retards, de gigue et de perte. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS6, CS7 n√©cessitent encore moins de bande passante, car il s'agit d'un filet de packages de services dans lesquels des rafales sont toujours possibles (BGP Update, par exemple), mais les pertes et les retards sont inacceptables - √† quoi sert BFD avec un minuteur de 10 ms si Hello se bloque dans Files d'attente de 100 ms? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, 4 classes sur 8 disponibles ont √©t√© donn√©es sous AF. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et malgr√© le fait qu'ils le font habituellement, je r√©p√®te que ce ne sont que des recommandations, et rien n'emp√™che trois classes de votre domaine DS d'attribuer EF et seulement deux √† AF.</font></font><br><br><hr><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> R√©sum√© de la classification </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A l'entr√©e d'un n≈ìud, un package est class√© en fonction d'une interface, MF, ou de son √©tiquetage (BA). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'√©tiquetage est la valeur des champs DSCP dans IPv4, la classe de trafic dans IPv6 et dans MPLS ou 802.1p dans 802.1q. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il existe 8 classes de service qui regroupent diff√©rentes cat√©gories de trafic. Chaque classe se voit attribuer son propre PHB, satisfaisant aux exigences de la classe. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selon les recommandations de l'IETF, les classes de service suivantes sont distingu√©es: CS1, CS0, AF11, AF12, AF13, AF21, CS2, AF22, AF23, CS3, AF31, AF32, AF33, CS4, AF41, AF42, AF43, CS5, EF, CS6, CS7 en importance croissante du trafic. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parmi eux, vous pouvez choisir une combinaison de 8, qui peuvent en fait √™tre encod√©s dans des champs CoS. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La combinaison la plus courante: CS0, AF1, AF2, AF3, AF4, EF, CS6, CS7 avec 3 d√©grad√©s de couleurs pour AF.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque classe se voit attribuer un PHB, dont il existe 3 - Transfert par d√©faut, Transfert assur√©, Transfert acc√©l√©r√© dans un ordre croissant de gravit√©. </font><font style="vertical-align: inherit;">Un peu √† c√¥t√© est le s√©lecteur de classe PHB. </font><font style="vertical-align: inherit;">Chaque PHB peut varier selon les param√®tres de l'outil, mais plus √† ce sujet plus tard.</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sur un r√©seau d√©charg√©, la QoS n'est pas n√©cessaire, ont-ils d√©clar√©. </font><font style="vertical-align: inherit;">Tous les probl√®mes de QoS sont r√©solus en d√©veloppant les liens, ont-ils d√©clar√©. </font><font style="vertical-align: inherit;">Avec Ethernet et DWDM, nous ne rencontrons jamais de congestion de ligne, ont-ils d√©clar√©. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce sont ceux qui ne comprennent pas ce qu'est la QoS. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais la r√©alit√© frappe VPN sur ILV.</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pas partout, il y a de l'optique. </font><font style="vertical-align: inherit;">RRL est notre r√©alit√©. </font><font style="vertical-align: inherit;">Parfois, au moment de l'accident (et pas seulement) dans la liaison radio √©troite veut explorer tout le trafic r√©seau.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les explosions de trafic sont notre r√©alit√©. </font><font style="vertical-align: inherit;">Les rafales de trafic √† court terme se mettent facilement en file d'attente, for√ßant √† supprimer les paquets tr√®s n√©cessaires.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La t√©l√©phonie, la visioconf√©rence, les jeux en ligne sont notre r√©alit√©. </font><font style="vertical-align: inherit;">Si la file d'attente est au moins quelque peu occup√©e, les retards commencent √† danser.</font></font></li></ol><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans ma pratique, il y avait des exemples o√π la t√©l√©phonie se transformait en code Morse sur un r√©seau charg√© √† 40% au maximum. </font><font style="vertical-align: inherit;">Le simple re-marquage dans EF a r√©solu momentan√©ment le probl√®me.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il est temps de g√©rer des outils qui vous permettent de fournir diff√©rents services √† diff√©rentes classes. </font></font><br><br><hr><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Outils PHB </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il n'y a en fait que trois groupes d'outils QoS qui manipulent activement les packages: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √âvitement de la congestion - que faire pour ne pas √™tre mauvais. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gestion de la congestion - que faire quand c'est d√©j√† mauvais. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rate Limiting - comment ne pas mettre plus sur le r√©seau qu'il ne devrait l'√™tre, et ne pas lib√©rer autant qu'ils ne peuvent pas accepter. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mais tous, dans l'ensemble, seraient inutiles sans la file d'attente. </font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5. Files d'attente </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans le parc d'attractions, vous ne pouvez pas donner la priorit√© √† quelqu'un si vous n'organisez pas de file d'attente s√©par√©e pour ceux qui ont pay√© plus. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√™me situation dans les r√©seaux. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si tout le trafic est dans une file d'attente, vous ne pourrez pas extraire les paquets importants de son milieu pour leur donner la priorit√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est pourquoi, apr√®s classification, les paquets sont plac√©s dans la file d'attente correspondant √† cette classe. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et puis une file d'attente (avec des donn√©es vocales) se d√©placera rapidement, mais avec une bande limit√©e, une autre plus lente (streaming), mais avec une large bande, et certaines ressources iront selon le principe r√©siduel. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais dans les limites de chaque file d'attente distincte, la m√™me r√®gle s'applique - vous ne pouvez pas extraire un paquet du milieu - uniquement de sa t√™te.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque file d'attente a une certaine longueur limit√©e. D'une part, cela est dict√© par des limitations mat√©rielles, et d'autre part, cela n'a aucun sens de garder les paquets dans la file d'attente trop longtemps. Un paquet VoIP n'est pas n√©cessaire s'il est retard√© de 200 ms. TCP demandera le transfert, conditionnellement, apr√®s l'expiration du RTT (configur√© dans sysctl). Par cons√©quent, l'abandon n'est pas toujours mauvais. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les d√©veloppeurs et les concepteurs d'√©quipements r√©seau doivent trouver un compromis entre les tentatives de sauvegarde du package le plus longtemps possible et, au contraire, d'√©viter le gaspillage de bande passante, en essayant de fournir le package qui n'est plus n√©cessaire. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans une situation normale, lorsque l'interface / la puce n'est pas surcharg√©e, l'utilisation du tampon est proche de z√©ro. Ils absorbent des √©clats √† court terme, mais cela ne provoque pas leur remplissage prolong√©.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'il y a plus de trafic que la puce de commutation ou l'interface de sortie ne peut en g√©rer, les files d'attente commencent √† se remplir. </font><font style="vertical-align: inherit;">Et une utilisation chronique sup√©rieure √† 20-30% est d√©j√† une situation √† laquelle il faut rem√©dier.</font></font><br><br><hr><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6. √âvitement de la congestion </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la vie de n'importe quel routeur, il arrive un moment o√π la file d'attente est pleine. </font><font style="vertical-align: inherit;">O√π mettre le paquet, s'il n'y a vraiment nulle part o√π le mettre - c'est tout, le tampon est termin√©, il ne sera pas l√†, m√™me s'il est beau √† regarder, m√™me si vous payez un suppl√©ment. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a deux fa√ßons: soit de jeter ce paquet, soit celles qui ont d√©j√† marqu√© le tour. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si ceux-ci sont d√©j√† dans la file d'attente, consid√©rez ce qui manque. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et si celui-ci, alors consid√©rez qu'il n'est pas venu. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ces deux approches sont appel√©es </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tail Drop</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Head Drop</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chute de queue et chute de t√™te </font></font></h2><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tail Drop</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - le m√©canisme de gestion de file d'attente le plus simple - √©limine tous les nouveaux paquets qui ne rentrent pas dans le tampon. </font></font><br><br><img src="https://habrastorage.org/webt/gu/qu/lv/guqulvedyuzoyytzzbybxrzua9g.png" width="500"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Head Drop</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> supprime les paquets mis en file d'attente depuis tr√®s longtemps. Il vaut mieux les jeter que de les sauver, car ils sont tr√®s probablement inutiles. Mais les paquets les plus pertinents arriv√©s √† la fin de la file d'attente auront plus de chances d'arriver √† temps. De plus, Head Drop vous permet de ne pas charger le r√©seau avec des packages inutiles. Naturellement, les packages les plus anciens sont ceux qui sont en t√™te de file d'attente, d'o√π le nom de l'approche.</font></font><br><br><img src="https://habrastorage.org/webt/6h/0d/rq/6h0drqorglxgq9mjocqjm_bpwby.png" width="500"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Head Drop pr√©sente un autre avantage non √©vident: si vous supprimez le paquet au d√©but de la file d'attente, le destinataire sera rapidement inform√© de l'encombrement du r√©seau et informera l'exp√©diteur. Dans le cas de Tail Drop, les informations sur le paquet abandonn√© atteindront, peut-√™tre, des centaines de millisecondes plus tard - jusqu'√† ce qu'elles parviennent de la queue de la ligne √† sa t√™te. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les deux m√©canismes fonctionnent tour √† tour avec diff√©renciation. Autrement dit, il n'est pas n√©cessaire que la totalit√© du tampon soit pleine. Si la deuxi√®me file d'attente est vide, et celle du z√©ro aux globes oculaires, alors seuls les paquets du z√©ro seront rejet√©s. </font></font><br><br><img src="https://habrastorage.org/webt/as/nl/l7/asnll7xgflrxk_mvdxgmglgf2fm.png" width="400"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tail Drop et Head Drop peuvent fonctionner simultan√©ment.</font></font><br><br><img src="https://habrastorage.org/webt/bn/n1/wv/bnn1wvl9qene8f4xysetig6hemg.png" width="500"><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La chute de la queue et de la t√™te est un ¬´front¬ª pour √©viter la congestion. Vous pouvez m√™me dire - c'est son absence. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous ne faisons rien tant que la file d'attente n'est pas pleine √† 100%. Et apr√®s cela, nous commen√ßons √† √©liminer tous les paquets nouvellement arriv√©s (ou retard√©s pendant longtemps). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous n'avez rien √† faire pour atteindre l'objectif, quelque part il y a une nuance. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et cette nuance est TCP. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rappelez-vous ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plus profond√©ment</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extr√™mement profond√©ment</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) comment TCP fonctionne - nous parlons d'impl√©mentations modernes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il existe une fen√™tre coulissante (fen√™tre coulissante ou </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rwnd -</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fen√™tre </font><b><font style="vertical-align: inherit;">annonc√©e</font></b><font style="vertical-align: inherit;"> du destinataire), que le destinataire contr√¥le, indiquant √† l'exp√©diteur le montant qui peut √™tre envoy√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et il y a une fen√™tre de surcharge ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CWND - Congestion Window</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), qui r√©pond aux probl√®mes de r√©seau et est contr√¥l√© par l'exp√©diteur. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le processus de transfert de donn√©es commence par un d√©marrage lent (d√©marrage </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lent</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) avec une augmentation exponentielle de CWND. Avec chaque segment confirm√©, 1 taille MSS est ajout√©e au CWND, c'est-√†-dire qu'il double en un temps √©gal √† RTT (donn√©es l√†-bas, retour ACK) (Discours sur Reno / NewReno). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, </font></font><br><br><img src="https://habrastorage.org/webt/5n/5a/nd/5n5andpbm8lvmyeaio0i565c_ek.png" width="200"><br><br> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> croissance </font><u><font style="vertical-align: inherit;">exponentielle</font></u><font style="vertical-align: inherit;"> continue jusqu'√† une valeur appel√©e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssthreshold</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (seuil de d√©marrage lent), qui est sp√©cifi√©e dans la configuration TCP sur l'h√¥te. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commence ensuite le </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lin√©aire</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une augmentation de 1 / CWND pour chaque segment confirm√© jusqu'√† ce qu'il repose sur RWND ou que les pertes commencent (la perte est confirm√©e par une confirmation r√©p√©t√©e (ACK dupliqu√©) ou aucune confirmation du tout). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√®s qu'une perte de segment est d√©tect√©e, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP Backoff</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se produit </font><font style="vertical-align: inherit;">- TCP r√©duit consid√©rablement la fen√™tre, r√©duisant en fait la vitesse d'envoi - et le m√©canisme de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©cup√©ration rapide</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©marre </font><font style="vertical-align: inherit;">:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> envoyer des segments perdus (Retransmission rapide), </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la fen√™tre est doubl√©e, </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La valeur ssthreshold devient √©galement √©gale √† la moiti√© de la fen√™tre atteinte, </font></font></li><li><font style="vertical-align: inherit;"></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> croissance </font><u><font style="vertical-align: inherit;">lin√©aire</font></u><font style="vertical-align: inherit;"> recommence </font><font style="vertical-align: inherit;">jusqu'√† la premi√®re perte,</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> R√©p√©tez. </font></font></li></ol><br><img src="https://habrastorage.org/webt/of/0p/ar/of0park6tnishwa25_v_dgzwaya.png" width="700"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La perte peut signifier soit l'effondrement complet d'un segment de r√©seau, puis consid√©rer qu'il est perdu, ou une congestion sur la ligne (lire le d√©passement de tampon et rejeter un segment de cette session). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'agit de la m√©thode TCP permettant de maximiser l'utilisation de la bande passante disponible et de g√©rer la congestion. </font><font style="vertical-align: inherit;">Et c'est assez efficace. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais √† quoi m√®ne Tail Drop?</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disons que via un routeur se trouve le chemin de milliers de sessions TCP. </font><font style="vertical-align: inherit;">√Ä un moment donn√©, le trafic de session a atteint 1,1 Gb / s, la vitesse de l'interface de sortie - 1 Gb / s.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le trafic est plus rapide que les feuilles, les tampons sont remplis </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vsklyan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tail Drop est activ√© jusqu'√† ce que le r√©partiteur retire quelques paquets de la file d'attente. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dans le m√™me temps, des dizaines ou des centaines de sessions enregistrent des pertes et passent √† Fast Recovery (ou m√™me Slow Start). </font></font></li><li>    ,  , Tail Drop . </li><li>   TCP-  ,          . </li><li>  . </li><li> Fast Recovery/Slow Start. </li><li> . </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En savoir plus sur les modifications apport√©es aux m√©canismes TCP dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC 2001</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©marrage lent TCP, √©vitement de congestion, retransmission rapide et algorithmes de r√©cup√©ration rapide</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'agit d'une illustration typique d'une situation appel√©e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Global TCP Synchronization</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/wr/co/oq/wrcooqd2fjrix9jbimh-8si97h4.png" width="500"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Global</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> car de nombreuses sessions √©tablies via ce n≈ìud souffrent. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Synchronisation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car ils souffrent en m√™me temps. Et la situation se r√©p√©tera jusqu'√† ce qu'il y ait une surcharge. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - car UDP, qui ne dispose pas de m√©canismes de contr√¥le de congestion, n'est pas affect√© par celui-ci.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rien de mal ne se serait produit dans cette situation si elle n'avait pas caus√© l'utilisation sous-optimale de la bande - les √©carts entre les dents de scie - l'argent gaspill√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le deuxi√®me probl√®me est </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCP Starvation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - TCP depletion. Alors que TCP ralentit pour r√©duire la charge (ne soyons pas rus√©s - tout d'abord, afin de transmettre s√ªrement nos donn√©es), UDP, toute cette souffrance morale en g√©n√©ral par le datagramme - en envoie le plus possible. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainsi, la quantit√© de trafic TCP est r√©duite et UDP augmente (√©ventuellement), le prochain cycle de perte - r√©cup√©ration rapide se produit √† un seuil inf√©rieur. UDP prend de la place. La quantit√© totale de trafic TCP diminue.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment r√©soudre le probl√®me, il vaut mieux l'√©viter. </font><font style="vertical-align: inherit;">Essayons de r√©duire la charge avant qu'elle ne remplisse la file d'attente √† l'aide du Fast Recovery / Slow Start, qui √©tait juste contre nous.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ROUGE - D√©tection pr√©coce al√©atoire </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais que se passe-t-il si nous prenons et enduisons des gouttes sur une partie du tampon? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relativement parlant, commencez √† supprimer des paquets al√©atoires lorsque la file d'attente est pleine √† 80%, for√ßant certaines sessions TCP √† r√©duire la fen√™tre et, par cons√©quent, la vitesse. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et si la file d'attente est pleine √† 90%, nous commen√ßons √† supprimer al√©atoirement 50% des paquets. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90% - la probabilit√© augmente jusqu'√† Tail Drop (100% des nouveaux paquets sont rejet√©s). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les m√©canismes qui impl√©mentent une telle gestion de file d'attente sont appel√©s </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AQM - Adaptive (or Active) Queue Management,</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> c'est ainsi que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RED</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonctionne </font><font style="vertical-align: inherit;">. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©tection pr√©coce</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - correction d'une surcharge potentielle; </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al√©atoire</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - √©liminer les paquets au hasard.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parfois, ils d√©codent RED (√† mon avis, s√©mantiquement plus correctement), comme Random Early Discard. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graphiquement, cela ressemble √† ceci: </font></font><br><br><img src="https://habrastorage.org/webt/1n/zs/5v/1nzs5vsexsokkaepdxe_mo-klsg.png" width="600"><br><br><img src="https://habrastorage.org/webt/lp/rl/m7/lprlm7iiurfwklhdnun20iqdoci.png" width="500"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tant que le tampon n'est pas rempli √† 80%, les paquets ne sont pas du tout rejet√©s - la probabilit√© est de 0%. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De 80 √† 100 paquets commencent √† √™tre rejet√©s et plus le remplissage de la file d'attente est √©lev√©. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le pourcentage passe donc de 0 √† 30. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un effet secondaire de RED est que les sessions TCP agressives sont plus susceptibles de ralentir, simplement parce qu'il y a beaucoup de paquets et qu'ils sont plus susceptibles d'√™tre abandonn√©s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'inefficacit√© de l'utilisation de la bande ROUGE se r√©sout en √©moussant une partie beaucoup plus petite des s√©ances sans provoquer un rabattement aussi grave entre les dents. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exactement pour la m√™me raison, UDP ne peut pas tout occuper.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WRED - D√©tection pr√©coce al√©atoire pond√©r√©e </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais √† l'audience de tous, probablement, toujours </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WRED</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Le lecteur astucieux de linkmeup a d√©j√† sugg√©r√© qu'il s'agit du m√™me ROUGE, mais pond√©r√© √† tour de r√¥le. Et il n'avait pas tout √† fait raison. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RED op√®re dans la m√™me file d'attente. Cela n'a aucun sens de revenir sur EF si le BE est plein. Par cons√©quent, le pesage √† son tour n'apportera rien. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ici, Drop Precedence fonctionne. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et dans la m√™me file d'attente, les paquets avec une priorit√© de suppression diff√©rente auront des courbes diff√©rentes. Plus la priorit√© est basse, plus il est probable qu'elle soit critiqu√©e. </font></font><br><br><img src="https://habrastorage.org/webt/ef/rg/_v/efrg_vx4xacb4uwjrkvcdutemho.png" width="600"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a trois courbes ici: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rouge - moins de trafic prioritaire (en termes de baisse), jaune - plus, vert - maximum.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le trafic rouge commence √† √™tre rejet√© lorsque le tampon est plein √† 20%, de 20 √† 40 il descend √† 20%, puis √† Tail Drop. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le jaune commence plus tard - de 30 √† 50, il est d√©fauss√© jusqu'√† 10%, puis - Tail Drop. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le vert est le moins sensible: de 50 √† 100, il cro√Æt en douceur √† 5%. Vient ensuite Tail Drop. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans le cas du DSCP, ce pourrait √™tre AF11, AF12 et AF13, respectivement vert, jaune et rouge. </font></font><br><br><img src="https://habrastorage.org/webt/jv/jm/9q/jvjm9qul8wyhrhncvx8iylnbl5s.png" width="600"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est tr√®s important ici qu'il fonctionne avec TCP et qu'il ne s'applique absolument pas √† UDP. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ou une application utilisant UDP ignore les pertes, comme dans le cas de la t√©l√©phonie ou du streaming vid√©o, et cela affecte n√©gativement ce que l'utilisateur voit.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ou l'application elle-m√™me contr√¥le la livraison et vous demande de renvoyer le m√™me package. Cependant, il n'est pas n√©cessaire de demander √† la source d'abaisser le d√©bit de transmission. Et au lieu de r√©duire la charge, une augmentation est due aux retransmissions. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est pourquoi seul Tail Drop est utilis√© pour EF. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour CS6, CS7, Tail Drop est √©galement utilis√©, car aucune vitesse √©lev√©e n'est suppos√©e et WRED ne r√©soudra rien. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour AF, WRED est appliqu√©. AFxy, o√π x est la classe du service, c'est-√†-dire la file d'attente dans laquelle il tombe, et y est la priorit√© de suppression - la m√™me couleur. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour BE, la d√©cision est prise en fonction du trafic en vigueur dans cette file d'attente.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au sein d'un m√™me routeur, un √©tiquetage interne sp√©cial des paquets est utilis√©, diff√©rent de celui qui porte les en-t√™tes. Par cons√©quent, MPLS et 802.1q, o√π il n'est pas possible de coder la priorit√© de suppression, peuvent √™tre trait√©s dans des files d'attente avec diff√©rentes priorit√©s de suppression. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, un paquet MPLS est arriv√© √† un n≈ìud, il ne porte pas d'√©tiquetage Drop Precedence, cependant, selon les r√©sultats du polissage, il s'est av√©r√© √™tre jaune et peut √™tre jet√© avant d'√™tre plac√© dans la file d'attente (ce qui peut √™tre d√©termin√© par le champ Classe de trafic). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il convient de rappeler que tout cet arc-en-ciel n'existe qu'√† l'int√©rieur du n≈ìud. Il n'y a pas de concept de couleur dans la ligne entre voisins. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bien qu'il soit possible, bien s√ªr, de coder la couleur dans la partie Drop Precedence de DSCP.</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les gouttes peuvent √©galement appara√Ætre dans un r√©seau non charg√©, o√π il semblerait qu'aucun d√©bordement de file d'attente ne devrait se produire. </font><font style="vertical-align: inherit;">Comment? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La raison peut en √™tre de courtes rafales - des rafales - de trafic. </font><font style="vertical-align: inherit;">L'exemple le plus simple - 5 applications en m√™me temps ont d√©cid√© de transf√©rer le trafic vers un h√¥te final. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un exemple est plus compliqu√© - l'exp√©diteur est connect√© via l'interface 10 Gb / s et le r√©cepteur est de 1 Gb / s. </font><font style="vertical-align: inherit;">L'environnement lui-m√™me vous permet de cr√©er des packages plus rapidement sur l'exp√©diteur. </font><font style="vertical-align: inherit;">Le contr√¥le de flux Ethernet du r√©cepteur demande √† l'h√¥te le plus proche de ralentir et les paquets commencent √† s'accumuler dans les tampons.</font></font><br></blockquote><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eh bien, que faire quand tout empire? </font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7. Gestion de la congestion </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque tout va mal, la priorit√© de traitement doit √™tre donn√©e √† un trafic plus important. L'importance de chaque colis est d√©termin√©e au stade de la classification. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais qu'est-ce qui est mauvais? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tous les tampons ne doivent pas √™tre obstru√©s pour que les applications commencent √† rencontrer des probl√®mes. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'exemple le plus simple est les paquets vocaux, qui se rassemblent autour de grands paquets de gros paquets d'une application t√©l√©chargeant un fichier. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela augmentera le d√©lai, ruinera la gigue et provoquera √©ventuellement des chutes. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, nous avons des probl√®mes √† fournir des services de qualit√© en l'absence de congestion r√©elle. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce probl√®me est con√ßu pour r√©soudre le m√©canisme de gestion de la congestion. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le trafic des diff√©rentes applications est divis√© en files d'attente, comme nous l'avons vu plus haut.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais seulement en cons√©quence, tout devrait √† nouveau fusionner en une seule interface. </font><font style="vertical-align: inherit;">La s√©rialisation se produit toujours de mani√®re s√©quentielle. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment diff√©rentes files d'attente parviennent-elles √† fournir diff√©rents niveaux de services? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supprimez les paquets de diff√©rentes files d'attente de diff√©rentes mani√®res. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le r√©partiteur s'y est engag√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous consid√©rerons aujourd'hui la majorit√© des r√©partiteurs, en commen√ßant par le plus simple:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> FIFO - une seule ligne, tout en BE, C - injustice. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PQ - la route des oligarques, les laquais c√®dent la place. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> FQ - tous sont √©gaux. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DWRR - tous sont √©gaux, mais certains sont plus √©gaux. </font></font></li></ul><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> FIFO - Premier entr√©, premier sorti </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le cas le plus simple, en fait l'absence de QoS, est que tout le trafic est trait√© de la m√™me mani√®re - dans une file d'attente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les paquets quittent la file d'attente exactement dans l'ordre dans lequel ils sont arriv√©s, d'o√π le nom: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">premi√®re entr√©e - premi√®re et gauche</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIFO n'est ni un r√©partiteur au sens plein du terme, ni un m√©canisme DiffServ en g√©n√©ral, car il ne s√©pare pas r√©ellement les classes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si la file d'attente commence √† se remplir, les retards et la gigue commencent √† augmenter, vous ne pouvez pas les g√©rer, car vous ne pouvez pas extraire un paquet important du milieu de la file d'attente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des sessions TCP agressives avec une taille de paquet de 1 500 octets peuvent occuper toute la file d'attente, ce qui fait souffrir les petits paquets vocaux. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans FIFO, toutes les classes fusionnent dans CS0.</font></font><br><br><img src="https://habrastorage.org/webt/am/-w/0k/am-w0kosnvx3ucg3qpdbnou1blk.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, malgr√© toutes ces lacunes, c'est ainsi que fonctionne Internet aujourd'hui. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La plupart des fournisseurs FIFO sont d√©sormais le r√©partiteur par d√©faut avec une file d'attente pour tout le trafic de transit et une autre pour les paquets de service g√©n√©r√©s localement. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est simple, c'est extr√™mement bon march√©. Si les canaux sont larges et qu'il y a peu de trafic, tout va bien. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La quintessence de l'id√©e que la QoS - pour les pauvres - √©largit la bande, et les clients seront satisfaits, et votre salaire augmentera de plusieurs fois. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce n'est que de cette fa√ßon que l'√©quipement de r√©seau fonctionnait autrefois. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais tr√®s vite, le monde a √©t√© confront√© au fait que cela ne fonctionnerait tout simplement pas.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avec la tendance aux r√©seaux convergents, il est devenu clair que les diff√©rents types de trafic (service, voix, multim√©dia, navigation sur Internet, partage de fichiers) ont des exigences de r√©seau fondamentalement diff√©rentes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIFO ne suffisait pas, ils ont donc cr√©√© plusieurs files d'attente et commenc√© √† produire des sch√©mas de planification du trafic. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, FIFO ne quitte jamais nos vies: √† l'int√©rieur de chacune des files d'attente, les paquets sont toujours trait√©s selon le principe FIFO.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PQ - Mise en file d'attente prioritaire </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le deuxi√®me m√©canisme le plus compliqu√© et la tentative de division du service en classes est une </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">file d'attente prioritaire</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le trafic est d√©sormais dispos√© dans plusieurs files d'attente en fonction de sa priorit√© de classe (par exemple, bien que pas n√©cessairement, le m√™me BE, AF1-4, EF, CS6-7). Le r√©partiteur parcourt une file d'attente apr√®s l'autre. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout d'abord, il ignore tous les paquets de la file d'attente de priorit√© la plus √©lev√©e, puis de moins, puis de moins.</font></font> Et donc en cercle. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le r√©partiteur ne commence pas √† r√©cup√©rer les paquets de faible priorit√© tant que la file d'attente de haute priorit√© n'est pas vide. </font></font><br><br><img src="https://habrastorage.org/webt/4g/l0/sl/4gl0slzp0q6kybjw14xpvvs5xt0.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si, au moment du traitement des paquets de faible priorit√©, un paquet arrive dans une file d'attente de priorit√© plus √©lev√©e, le r√©partiteur y bascule et ce n'est qu'apr√®s avoir √©t√© vid√© qu'il revient aux autres. </font></font><br><br><img src="https://habrastorage.org/webt/xm/qk/v1/xmqkv1cbt_uidd4yj1nntt2jehq.gif"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PQ fonctionne presque aussi bien que FIFO. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est id√©al pour des types de trafic tels que les paquets de protocole et la voix, o√π les retards sont critiques et le volume total n'est pas tr√®s √©lev√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eh bien, vous devez admettre, vous ne devriez pas garder BFD Bonjour, car plusieurs gros morceaux vid√©o de YouTube sont venus? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais l√† r√©side le manque de PQ - si la file d'attente prioritaire est charg√©e de trafic, le r√©partiteur ne basculera jamais du tout vers les autres.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et si un docteur mal√©fique, √† la recherche de m√©thodes de conqu√™te du monde, d√©cide de marquer tout son trafic crapuleux avec la plus haute marque noire, tous les autres attendront consciencieusement et seront ensuite jet√©s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'est pas non plus n√©cessaire de parler d'une voie garantie pour chaque ligne. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les files d'attente de haute priorit√© peuvent √™tre r√©duites par la vitesse du trafic qui y est trait√©. </font><font style="vertical-align: inherit;">Ensuite, d'autres ne mourront pas de faim. </font><font style="vertical-align: inherit;">Cependant, contr√¥ler cela n'est pas facile.</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les m√©canismes suivants parcourent tour √† tour toutes les files d'attente, en leur pr√©levant une certaine quantit√© de donn√©es, offrant ainsi des conditions plus honn√™tes. </font><font style="vertical-align: inherit;">Mais ils le font diff√©remment.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> FQ-Fair Queuing </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le prochain candidat au r√¥le de r√©partiteur id√©al est celui </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des m√©canismes de file d'attente √©quitables</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> FQ - Fair Queuing </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Son histoire a commenc√© en 1985, lorsque John Nagle a sugg√©r√© de cr√©er une file d'attente pour chaque flux de donn√©es. En esprit, cela est proche de l'approche IntServ et s'explique facilement par le fait que l'id√©e de classes de service, comme DiffServ, n'existait pas √† l'√©poque. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FQ a extrait la m√™me quantit√© de donn√©es de chaque file d'attente dans l'ordre. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'honn√™tet√© r√©side dans le fait que le r√©partiteur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonctionne </font><b><font style="vertical-align: inherit;">pas</font></b><font style="vertical-align: inherit;"> avec le nombre de </font><b><font style="vertical-align: inherit;">paquets, mais avec le nombre de bits</font></b><font style="vertical-align: inherit;"> pouvant √™tre transmis depuis chaque file d'attente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un flux TCP agressif ne peut donc pas inonder l'interface, et tout le monde b√©n√©ficie de l'√©galit√© des chances. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En th√©orie. FQ n'a jamais √©t√© impl√©ment√© dans la pratique comme m√©canisme de r√©partition des files d'attente dans les √©quipements r√©seau. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a trois inconv√©nients:</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La premi√®re - √©vidente - c'est tr√®s co√ªteux - pour d√©marrer une file d'attente pour chaque flux, compter le poids de chaque paquet et toujours se soucier des bits √† sauter et de la taille du paquet. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La seconde - moins √©vidente - tous les threads b√©n√©ficient de chances √©gales en termes de bande passante. Et si je veux in√©gale? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le troisi√®me - non √©vident - l'honn√™tet√© FQ est absolue: tout le monde a des retards √©gaux, mais il y a des threads qui sont plus importants que le retard que le groupe. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, parmi 256 flux, il y en a des vocaux, ce qui signifie que chacun d'eux n'atteindra que 256 threads. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et que faire avec eux n'est pas clair. </font></font><br><br><img src="https://habrastorage.org/webt/o_/cg/au/o_cgau4ggmorq1cj28jn3hf26iq.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ici, vous pouvez voir qu'en raison de la grande taille du paquet dans la 3√®me √©tape, au cours des deux premiers cycles, nous avons trait√© un paquet des deux premiers.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La description des m√©canismes bit √† bit de Round Robin et GPS d√©passe d√©j√† le cadre de cet article, et je renvoie le lecteur √† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une √©tude ind√©pendante</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WFQ - File d'attente √©quitable pond√©r√©e </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les deuxi√®me et partiellement troisi√®me failles du FQ ont tent√© de fermer le WFQ, publi√© en 1989. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque file d'attente √©tait dot√©e d'un poids et, par cons√©quent, du droit de donner du trafic en multiples de poids pour un cycle. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le poids a √©t√© calcul√© sur la base de deux param√®tres: toujours pertinent, puis la priorit√© IP et la longueur du paquet. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans le contexte de WFQ, plus il y a de poids, pire c'est. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par cons√©quent, plus la priorit√© IP est √©lev√©e, plus le poids du paquet est faible. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plus la taille de l'emballage est petite, plus son poids est petit. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainsi, les petits paquets √† haute priorit√© obtiennent le plus de ressources, tandis que les g√©ants √† faible priorit√© attendent.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans l'illustration ci-dessous, les paquets ont re√ßu des poids tels qu'au premier un paquet de la premi√®re file d'attente est ignor√©, puis deux du deuxi√®me, √† nouveau de la premi√®re et seulement ensuite le troisi√®me est trait√©. Ainsi, par exemple, cela pourrait se produire si la taille des paquets dans la deuxi√®me √©tape est relativement petite. </font></font><br><br><img src="https://habrastorage.org/webt/dd/z9/v7/ddz9v7nahrtmewfrul4mbflc5b0.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä propos de la dure ing√©nierie de WFQ, avec son temps de fin de paquet, son temps virtuel et le th√©or√®me de la perruque, vous pouvez lire dans un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">document couleur curieux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, cela n'a pas r√©solu les premier et troisi√®me probl√®mes. L'approche bas√©e sur les flux √©tait tout aussi g√™nante, et les flux qui n√©cessitaient de courts d√©lais et une gigue stable ne les recevaient pas.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, cela n'a pas emp√™ch√© WFQ d'√™tre utilis√© dans certains appareils Cisco (pour la plupart anciens). </font><font style="vertical-align: inherit;">Il y avait jusqu'√† 256 files d'attente dans lesquelles les threads √©taient plac√©s en fonction du hachage de leurs en-t√™tes. </font><font style="vertical-align: inherit;">Un compromis entre le paradigme Flow-Based et des ressources limit√©es.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CBWFQ - WFQ bas√© sur les classes </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CBWFQ a fait l'approche du probl√®me de complexit√© avec l'av√®nement de DiffServ. Behavior Aggregate a class√© toutes les cat√©gories de trafic en 8 classes et, par cons√©quent, les files d'attente. Cela lui a donn√© un nom et a consid√©rablement simplifi√© les files d'attente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le poids dans CBWFQ a acquis une signification diff√©rente. Le poids a √©t√© attribu√© aux </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (pas aux threads) manuellement dans la configuration √† la demande de l'administrateur, car le champ DSCP √©tait d√©j√† utilis√© pour la classification. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, DSCP a d√©termin√© la file d'attente √† mettre en place et le poids configur√© - combien de voies sont disponibles pour cette file d'attente.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plus important encore, cela a indirectement rendu la vie un peu plus facile et les flux √† faible latence, qui √©taient maintenant regroup√©s dans une (deux-trois- ...) files d'attente et recevaient leurs points forts beaucoup plus souvent. </font><font style="vertical-align: inherit;">La vie est devenue meilleure, mais toujours pas bonne - il n'y a aucune garantie - en g√©n√©ral, √† WFQ tout est toujours √©gal en termes de retards. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et la n√©cessit√© d'une surveillance constante de la taille des paquets, de leur fragmentation et de leur d√©fragmentation, n'a pas disparu.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CBWFQ + LLQ - File d'attente √† faible latence </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'approche finale, point culminant d'une approche bit par bit, est l'union de CBWFQ avec PQ. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'une des files d'attente devient la soi-disant </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LLQ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (file d'attente √† faible latence), et tandis que toutes les autres files d'attente sont trait√©es par le gestionnaire CBWFQ, le gestionnaire PQ s'ex√©cute entre les LLQ et les autres. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, alors qu'il y a des paquets dans LLQ, les files d'attente restantes attendent, leurs d√©lais augmentent. </font><font style="vertical-align: inherit;">D√®s que les paquets dans LLQ se sont √©puis√©s, nous sommes all√©s traiter le reste. </font><font style="vertical-align: inherit;">Des paquets sont apparus dans LLQ - ils ont oubli√© le reste, y sont retourn√©s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIFO fonctionne √©galement √† l'int√©rieur de LLQ, vous ne devez donc pas tout pousser sans y arriver, augmentant l'utilisation du tampon et le retard en m√™me temps. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√©anmoins, pour que les files d'attente non prioritaires ne meurent pas de faim, il convient de d√©finir une limite de bande passante dans LLQ. </font></font><br><br><img src="https://habrastorage.org/webt/c6/4m/vt/c64mvts-kr2ij0o_zf2kfxy2cbu.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainsi, les moutons sont pleins et les loups sont en s√©curit√©.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RR - Round-Robin </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Main dans la main avec FQ marcha et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'un √©tait honn√™te, mais pas simple. </font><font style="vertical-align: inherit;">L'autre est tout √† fait le contraire. </font></font><br><br><img src="https://habrastorage.org/webt/8p/nh/de/8pnhdeko9l5nkiss6mbtxbg9jvk.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RR a parcouru les files d'attente, en extrayant un nombre √©gal de paquets. </font><font style="vertical-align: inherit;">L'approche est plus primitive que FQ, et donc malhonn√™te par rapport aux diff√©rents flux. </font><font style="vertical-align: inherit;">Des sources agressives pourraient facilement inonder la bande de paquets de 1 500 octets. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, il √©tait tr√®s simple √† impl√©menter - vous n'avez pas besoin de conna√Ætre la taille du paquet dans la file d'attente, de le fragmenter, puis de le r√©cup√©rer. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, son injustice dans l'attribution de la bande a bloqu√© son chemin vers le monde - dans le monde des r√©seaux, le Round-Robin pur n'a pas √©t√© mis en ≈ìuvre.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WRR - Round Robin pond√©r√© </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le m√™me sort est avec WRR, qui a ajout√© du poids aux files d'attente en fonction de la priorit√© IP. </font><font style="vertical-align: inherit;">Dans WRR, pas un nombre √©gal de paquets a √©t√© retir√©, mais un multiple du poids de la file d'attente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il serait possible de donner plus de poids aux files d'attente avec des paquets plus petits, mais cela n'√©tait pas possible de mani√®re dynamique.</font></font><br><br><img src="https://habrastorage.org/webt/lx/4b/an/lx4bancel1tl9stwbeay0s6n1ma.png" width="800"><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DWRR - Round Robin pond√©r√© en fonction du d√©ficit </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et tout √† coup, une approche extr√™mement curieuse en 1995 a √©t√© propos√©e par M. Shreedhar et G. Varghese. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque ligne a une </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ligne de cr√©dit</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> distincte </font><font style="vertical-align: inherit;">en bits. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lors du passage de la file d'attente, autant de packages sont √©mis qu'il y a suffisamment de cr√©dit. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La taille du colis en t√™te de file d'attente est d√©duite du montant du pr√™t. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si la diff√©rence est sup√©rieure √† z√©ro, ce paquet est supprim√© et le suivant est v√©rifi√©. Donc, jusqu'√† ce que la diff√©rence soit inf√©rieure √† z√©ro. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si m√™me le premier colis n'a pas assez de cr√©dit, enfin, h√©las, les coul√©es de boue, il reste dans la file d'attente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avant le prochain passage, le cr√©dit de chaque ligne est augment√© d'un certain montant, appel√© </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quantum</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour diff√©rentes files d'attente, le quantum est diff√©rent - plus la bande que vous devez donner est grande, plus le quantum est grand. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainsi, toutes les files d'attente re√ßoivent une bande passante garantie, quelle que soit la taille des paquets qu'elle contient. </font></font><br><br><img src="https://habrastorage.org/webt/vr/hv/vk/vrhvvk-1opimw_vofynmrkosbv8.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D'apr√®s l'explication ci-dessus, il ne serait pas clair pour moi comment cela fonctionne.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trouvons les √©tapes ...</font></font></b> <div class="spoiler_text">   : <br><br><ul><li> DRR ( W), </li><li> 4 , </li><li>  0-    500 , </li><li>  1- ‚Äî  1000, </li><li>  2-  1500, </li><li>   3-     4000, </li><li>  ‚Äî 1600 . </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/64d/911/64e/64d91164edc5867e9009f54de10a50da.png"><br><br><h5>  1 </h5><br> <b> 1.  0</b> <br>   ,     1600  () <br>    0- .  : <br>      ‚Äî  (1600 ‚Äî 500 = 1100). <br>  ‚Äî  ‚Äî  (1100 ‚Äî 500 = 600). <br>  ‚Äî  ‚Äî  (600 ‚Äî 500 = 100). <br>  ‚Äî    (100 ‚Äî 500 = -400).    . <br>   ‚Äî 100 . <br><br><img src="https://habrastorage.org/webt/9y/4x/al/9y4xalhqrwwayufvjfcxlfevl20.png"><br><br> <b> 1.  1</b> <br>    ‚Äî  (1600 ‚Äî 1000 = 600). <br>    (600 ‚Äî 1000 = -400).    . <br>   ‚Äî 600 . <br><br><img src="https://habrastorage.org/webt/yw/mr/qh/ywmrqhm_deusdb04dez-3gjermc.png"><br><br> <b> 1.  2</b> <br>    ‚Äî  (1600 ‚Äî 1500 = 100). <br>    (100 ‚Äî 1000 = -900).    . <br>   ‚Äî 100 . <br><br><img src="https://habrastorage.org/webt/aj/el/k6/ajelk6xd9tpkl70r5hgt6q9q2u0.png"><br><br> <b> 1.  3</b> <br>     . (1600 ‚Äî 4000 = -2400). <br>    . <br>   ‚Äî   1600 . <br><br><img src="https://habrastorage.org/webt/jw/fo/3e/jwfo3eobllx5--quzb9qqt3zt0c.png"><br><br> ,       : <br><br><ul><li>  0 ‚Äî 1500 </li><li>  1 ‚Äî 1000 </li><li>  2 ‚Äî 1500 </li><li>  3 ‚Äî 0 </li></ul><br>  : <br><br><ul><li>  0 ‚Äî 100 </li><li>  1 ‚Äî 600 </li><li>  2 ‚Äî 100 </li><li>  3 ‚Äî 1600 </li></ul><br><h5>  2 </h5><br>          ‚Äî   1600 . <br><br> <b> 2.  0</b> <br>    1700 (100 + 1600). <br>       ‚Äî   (1700 ‚Äî 3*500 = 200). <br>     . <br>   ‚Äî 200 . <br><br><img src="https://habrastorage.org/webt/4z/di/2s/4zdi2se_gcciq1rbfkqqzzrumsa.png"><br><br> <b> 2.  1</b> <br>    2200 (600 + 1600). <br>       ‚Äî   (2200 ‚Äî 2*1000 = 200). <br>    . <br>   ‚Äî 200 . <br><img src="https://habrastorage.org/webt/9e/1z/sl/9e1zsl63ko7jxqjjuv4snupl6kw.png"><br><br> <b> 2.  2</b> <br>    1700 (100 + 1600). <br>      ‚Äî   (2200 ‚Äî 1500 = 200). <br>   ‚Äî  . <br>   ‚Äî 200 . <br><br><img src="https://habrastorage.org/webt/xf/v5/ni/xfv5nifo1wqvxfrhjqlfoygdk1w.png"><br><br> <b> 2.  3</b> <br>    3200 (1600 + 1600). <br>       (3200 ‚Äî 4000 = -800) <br>   ‚Äî 3200 . <br><img src="https://habrastorage.org/webt/wn/wj/pe/wnwjpenhub6ir2d8vi69oxan8-s.png"><br><br> ,       : <br><br><ul><li>  0 ‚Äî 3000 </li><li>  1 ‚Äî 3000 </li><li>  2 ‚Äî 3000 </li><li>  3 ‚Äî 0 </li></ul><br>  : <br><br><ul><li>  0 ‚Äî 200 </li><li>  1 ‚Äî 200 </li><li>  2 ‚Äî 200 </li><li>  3 ‚Äî 3200 </li></ul><br><h5>  3 </h5><br>          ‚Äî 1600 . <br><br> <b> 3.  0</b> <br>    1800 (200 + 1600). <br>        ‚Äî   (1800 ‚Äî 3*500 = 300). <br>     . <br>   ‚Äî 300 . <br><br><img src="https://habrastorage.org/webt/lk/sk/tq/lksktqj1g_7q6m2p8jwq0olnfuw.png"><br><br> <b> 3.  1</b> <br>    1800 (200 + 1600). <br>    ‚Äî  (1800 ‚Äî 1000 = 800). <br>   ‚Äî 800 . <br><br><img src="https://habrastorage.org/webt/fg/bd/jd/fgbdjdmydatamvpzxome7reb5pc.png"><br><br> <b> 3.  2</b> <br>    1800 (200 + 1600). <br>    ‚Äî  (1800 ‚Äî 1500 = 300). <br>   ‚Äî 300 . <br><br><img src="https://habrastorage.org/webt/s1/a7/iv/s1a7iv6mpfy1kesgzuazx9hsgkk.png"><br><br> <b> 3.  3</b> <br>    3-  ! <br>    4800 (3200 + 1600). <br>    ‚Äî  (4800 ‚Äî 4000 = 800). <br>   ‚Äî 800 . <br><br><img src="https://habrastorage.org/webt/fm/fh/tn/fmfhtnvh1utrr0yovddsambv_fe.png"><br><br> ,       : <br><br><ul><li>  0 ‚Äî 4500 </li><li>  1 ‚Äî 4000 </li><li>  2 ‚Äî 4500 </li><li>  3 ‚Äî 4000 </li></ul><br>  : <br><br><ul><li>  0 ‚Äî 300 </li><li>  1 ‚Äî 800 </li><li>  2 ‚Äî 300 </li><li>  3 ‚Äî 800 </li></ul><br><img src="https://habrastorage.org/webt/q5/q9/pj/q5q9pjzqa1be-uluk_eucxwga9w.png"><br><br>     DRR.          . <br><br>    ,  . <br><br><img src="https://habrastorage.org/webt/5l/6o/nd/5l6onduvx4djvafmxj7bhsoxwwm.gif"><br><br>  DWRR  DRR   ,        ,   ,     . <br><br><hr><br>     DRR,        ‚Äî    ,   . <br><br>     :  ,     .           . <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avec DWRR, la question demeure avec la garantie des retards et de la gigue - le poids ne le r√©sout en aucune fa√ßon. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Th√©oriquement, vous pouvez faire la m√™me chose qu'avec CB-WFQ, en ajoutant LLQ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, ce n'est qu'un des sc√©narios possibles de la popularit√© croissante d'aujourd'hui.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PB-DWRR - DWRR √† priorit√© </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En fait, le courant dominant aujourd'hui devient PB-DWRR - Round Based Weighted Deficit Weighted Round Robin. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est le m√™me vieux DWRR mal√©fique, dans lequel une autre file d'attente est ajout√©e - priorit√©, dans laquelle les paquets sont trait√©s avec une priorit√© plus √©lev√©e. </font><font style="vertical-align: inherit;">Cela ne signifie pas qu'elle se voit attribuer une bande plus grande, mais que les colis en seront retir√©s plus souvent. </font></font><br><br><img src="https://habrastorage.org/webt/wg/6g/ui/wg6guiijtoscyckwdwr49gkp0fq.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il existe plusieurs approches pour mettre en ≈ìuvre le PB-DWRR. </font><font style="vertical-align: inherit;">Dans certains d'entre eux, comme dans PQ, tout paquet arrivant dans la file d'attente prioritaire est imm√©diatement supprim√©. </font><font style="vertical-align: inherit;">Dans d'autres, il est accessible √† chaque fois que le r√©partiteur se d√©place entre les files d'attente. </font><font style="vertical-align: inherit;">Troisi√®mement, un cr√©dit et un quantum sont introduits pour cela, de sorte que la file d'attente prioritaire ne peut pas comprimer la bande enti√®re. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bien s√ªr, nous ne les analyserons pas.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Un bref r√©sum√© sur les m√©canismes de r√©partition </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depuis des d√©cennies, l'humanit√© essaie de r√©soudre le probl√®me le plus difficile d'assurer le bon niveau de service et une distribution √©quitable de la bande. Les files d'attente √©taient l'outil principal; la seule question √©tait de savoir comment obtenir les paquets des files d'attente, en essayant de les pousser dans une seule interface. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A partir du FIFO, il a invent√© le PQ - la voix a pu coexister avec le surf, mais il n'√©tait pas question de garantir le groupe. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plusieurs monstrueux FQ, WFQ sont apparus, qui ont fonctionn√© sinon par flux, puis presque comme √ßa. CB-WFQ est venu dans la soci√©t√© de classe, mais cela n'a pas √©t√© plus facile. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme alternative, il a d√©velopp√© RR. Il est devenu un WRR, puis un DWRR. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et dans les profondeurs de chacun des r√©partiteurs habite FIFO.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, comme vous pouvez le voir, il n'y a pas de r√©partiteur universel qui g√®re toutes les classes selon leurs besoins. </font><font style="vertical-align: inherit;">C'est toujours une combinaison de r√©partiteurs, dont l'un r√©sout le probl√®me de garantir les retards, la gigue et l'absence de pertes, et l'autre alloue une bande. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CBWFQ + LLQ ou PB-WDRR ou WDRR + PQ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sur un √©quipement r√©el, vous pouvez sp√©cifier les files d'attente √† traiter avec quel r√©partiteur. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CBWFQ, WDRR et leurs d√©riv√©s sont les favoris d'aujourd'hui. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PQ, FQ, WFQ, RR, WRR - nous ne pleurons pas et ne nous souvenons pas (√† moins, bien s√ªr, que nous nous pr√©parions pour CCIE Clipper).</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ainsi, les r√©partiteurs sont en mesure de garantir la vitesse, mais comment la limiter par le haut? </font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8. Limite de vitesse </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La n√©cessit√© de limiter la vitesse du trafic √† premi√®re vue est √©vidente - ne laissez pas le client sortir de sa bande conform√©ment √† l'accord. </font></font><br><br>  Oui  Mais pas seulement √ßa.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supposons qu'il existe une plage RRL d'une largeur de 620 Mb / s connect√©e via un port 1 Gb / s. Si vous y tirez tout le gigabit, puis quelque part sur le RRL, qui, tr√®s probablement, n'a aucune id√©e des files d'attente et de la qualit√© de service, des baisses monstrueuses de nature al√©atoire commenceront, sans lien avec les v√©ritables priorit√©s du trafic. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, si vous activez la mise en forme jusqu'√† 600 Mb / s sur le routeur, EF, CS6, CS7 ne seront pas supprim√©s du tout, et dans BE, AFx, la bande et les gouttes seront distribu√©es en fonction de leurs poids. Le RRL atteindra 600 Mb / s et nous obtiendrons une image pr√©visible. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un autre exemple est le contr√¥le d'admission. Par exemple, deux op√©rateurs ont accept√© de se faire mutuellement confiance, √† l'exception de CS7 - si quelque chose arrivait dans CS7 - √† jeter. Pour CS6 et EF - donnez une file d'attente s√©par√©e avec une garantie de retard et aucune perte.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais, que se passe-t-il si le partenaire rus√© a commenc√© √† verser des torrents dans ces lignes? </font><font style="vertical-align: inherit;">Au revoir la t√©l√©phonie. </font><font style="vertical-align: inherit;">Et les protocoles s'effondreront tr√®s probablement. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est logique dans ce cas de s'entendre avec un partenaire sur la bande. </font><font style="vertical-align: inherit;">Tout ce qui rentre dans le contrat est ignor√©. </font><font style="vertical-align: inherit;">Ce qui ne convient pas - jeter ou transf√©rer dans une autre file d'attente - BE, par exemple. </font><font style="vertical-align: inherit;">Ainsi, nous prot√©geons notre r√©seau et nos services. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il existe deux approches fondamentalement diff√©rentes pour limiter la vitesse: le polissage et la mise en forme. </font><font style="vertical-align: inherit;">Ils r√©solvent un probl√®me, mais de diff√©rentes mani√®res. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consid√©rez la diff√©rence en utilisant un exemple d'un tel profil de trafic:</font></font><br><br><img src="https://habrastorage.org/webt/5b/sj/st/5bsjstoglxkg7dspcxjrphdjsye.png" width="500"><br><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Police de la circulation </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le maintien de l'ordre limite la vitesse en supprimant le trafic excessif. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout ce qui d√©passe la valeur r√©gl√©e, le polyser coupe et jette. </font></font><br><br><img src="https://habrastorage.org/webt/a3/dl/xa/a3dlxapkcptfnfejftde0qxycjc.png" width="500"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce qui est coup√© est oubli√©. L'image montre que le paquet rouge n'est pas dans le trafic apr√®s le polyser. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et voici √† quoi ressemblera le profil s√©lectionn√© apr√®s le polyser: en </font></font><br><br><img src="https://habrastorage.org/webt/jb/rw/52/jbrw52md7mynstgrt9-o1a1mo1s.png" width="500"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">raison de la gravit√© des mesures prises, cela s'appelle </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hard Policing</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, il existe d'autres actions possibles. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le policier travaille g√©n√©ralement avec un compteur de trafic. Le m√®tre colore les sacs, vous vous en souvenez, en vert, jaune ou rouge. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et sur la base de cette couleur d√©j√†, le polyser peut ne pas jeter le paquet, mais le placer dans une autre classe. Ce sont des mesures douces - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">police douce</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il peut √™tre appliqu√© √† la fois au trafic entrant et au trafic sortant. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une caract√©ristique distinctive du polyser est la capacit√© d'absorber les rafales de trafic et de d√©terminer la vitesse maximale autoris√©e gr√¢ce au m√©canisme Token Bucket. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, tout ce qui n'est pas au-dessus de la valeur d√©finie n'est pas coup√© - il est permis d'aller un peu au-del√† - les courtes rafales ou les petits exc√®s de la bande allou√©e sont ignor√©s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le nom ¬´Police¬ª est dict√© par le rapport assez strict de l'outil au trafic excessif - rejet ou r√©trogradation vers une classe inf√©rieure.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mise en forme du trafic </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La mise en forme limite la vitesse en tamponnant le trafic exc√©dentaire. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout le trafic entrant passe par le tampon. Un shaper supprime les paquets de ce tampon √† une vitesse constante. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le taux d'arriv√©e des paquets vers le tampon est inf√©rieur √† la sortie, ils ne sont pas retard√©s dans le tampon - ils volent de part en part. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et si le taux d'arriv√©e est sup√©rieur √† la sortie, ils commencent √† s'accumuler. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La vitesse de sortie est toujours la m√™me. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainsi, des rafales de trafic sont ajout√©es au tampon et seront envoy√©es lorsqu'elles atteindront la file d'attente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par cons√©quent, avec la planification dans les files d'attente, la mise en forme est le deuxi√®me outil qui </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contribue au retard total</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/webt/in/gc/vh/ingcvhgya0fzfiw2sxbeiix7hfw.png" width="500"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'illustration montre clairement comment le paquet arrivant au moment t2 du tampon arrive au moment t3 en sortie. </font><font style="vertical-align: inherit;">t3-t2 est le retard introduit par le shaper. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shaper est g√©n√©ralement appliqu√© au trafic sortant. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici √† quoi ressemble le profil du shaper. </font></font><br><br><img src="https://habrastorage.org/webt/iv/b7/sl/ivb7slyamvreja97npdjyr3ctwk.png" width="500"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le nom ¬´Shaping¬ª indique que l'outil donne une forme au profil de trafic, le lissant. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le principal avantage de cette approche est l'utilisation optimale de la bande existante - au lieu de laisser tomber un trafic excessif, nous la reportons. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'inconv√©nient principal est un d√©lai impr√©visible - lorsque le tampon est plein, les paquets y languissent pendant longtemps. </font><font style="vertical-align: inherit;">Par cons√©quent, la mise en forme ne convient pas √† tous les types de trafic. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La mise en forme utilise le m√©canisme Leaky Bucket.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fa√ßonner contre polir </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le travail du polyser est similaire √† un couteau qui, se d√©pla√ßant le long de la surface de l'huile, coupe le c√¥t√© tranchant du tubercule. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le travail d'un shaper est similaire √† un rouleau, qui lisse les tubercules, les r√©partissant uniform√©ment sur la surface. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shaper essaie de ne pas laisser tomber les paquets pendant qu'ils sont mis en m√©moire tampon au prix d'un retard accru. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le polisseur n'introduit pas de retards, mais jette plus facilement les paquets. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les applications insensibles aux retards, mais pour lesquelles la perte n'est pas souhaitable, doivent √™tre limit√©es √† un shaper. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour ceux pour qui un paquet tardif est identique √† un paquet perdu, il est pr√©f√©rable de le d√©poser imm√©diatement - puis de le polir.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un shaper n'affecte pas les en-t√™tes de paquets et leur sort en dehors du n≈ìud, tandis qu'apr√®s le polissage, le p√©riph√©rique peut reclasser la classe dans l'en-t√™te. </font><font style="vertical-align: inherit;">Par exemple, √† l'entr√©e, le paquet avait la classe AF11, la mesure l'a peint en jaune √† l'int√©rieur de l'appareil, √† la sortie, il a re-marqu√© sa classe sur AF12 - sur le n≈ìud suivant, il aura une probabilit√© plus √©lev√©e de tomber.</font></font><br><br><img src="https://habrastorage.org/webt/za/y6/kh/zay6khb7cgviroz-zbumfppdtz8.png" width="600"><br><br><hr><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pratiquer le polissage et le fa√ßonnage </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le sch√©ma est le m√™me: </font></font><br><br><img src="https://habrastorage.org/webt/zc/0o/zn/zc0ozndb8nmrqajljkf98pp79tk.png" width="900"><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fichier de configuration. </font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">observons cette image sans appliquer de restrictions: </font></font><br><br><img src="https://habrastorage.org/webt/mg/nz/mv/mgnzmvc_36gtmgf5t3vi0wob1uk.png" width="900"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous proc√©derons comme suit:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sur l'interface d'entr√©e Linkmeup_R2 (e0 / 1), nous allons configurer le polissage - ce sera le contr√¥le d'entr√©e. </font><font style="vertical-align: inherit;">Selon l'accord, nous donnons 10 Mb / s.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sur l'interface de sortie Linkmeup_R4 (e0 / 2), configurez la mise en forme √† 20 Mb / s. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commen√ßons par le shaper sur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linkmeup_R4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faites correspondre tout:</font></font><br><br><pre> <code class="hljs pgsql"> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-map match-<span class="hljs-keyword"><span class="hljs-keyword">all</span></span> TRISOLARANS_ALL_CM match <span class="hljs-keyword"><span class="hljs-keyword">any</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Forme jusqu'√† 20 Mo / s: </font></font><br><br><pre> <code class="hljs swift"> policy-<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> <span class="hljs-type"><span class="hljs-type">TRISOLARANS_SHAPING</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TRISOLARANS_ALL_CM</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">shape</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">average</span></span></span><span class="hljs-class"> 20000000</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Appliquer √† l'interface de sortie: </font></font><br><br><pre> <code class="hljs kotlin"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Ethernet0</span></span></span><span class="hljs-class">/2 </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">service</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">policy</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">output</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TRISOLARANS_SHAPING</span></span></span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout ce qui doit sortir (sortir) de l'interface Ethernet0 / 2, forme jusqu'√† 20 Mb / s. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fichier de configuration du Shaper. </font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et voici le r√©sultat: </font></font><br><br><img src="https://habrastorage.org/webt/tz/1i/sr/tz1isrb6mnjnirkxe46wbzed2yu.png" width="900"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il se r√©v√®le une ligne assez plate de d√©bit total et de graphiques d√©chir√©s pour chaque flux individuel. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le fait est que nous limitons le shaper au groupe g√©n√©ral. </font><font style="vertical-align: inherit;">Cependant, selon la plate-forme, les flux individuels peuvent √©galement √™tre configur√©s individuellement, gagnant ainsi des opportunit√©s √©gales.</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurez maintenant le polissage sur Linkmeup_R2. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous ajouterons un polyser √† la politique existante.</font></font><br><br><pre> <code class="hljs pgsql"> <span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-map TRISOLARANS_ADMISSION_CONTROL <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> TRISOLARANS_TCP_CM police cir <span class="hljs-number"><span class="hljs-number">10000000</span></span> bc <span class="hljs-number"><span class="hljs-number">1875000</span></span> conform-action transmit exceed-action <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La politique a d√©j√† √©t√© appliqu√©e √† l'interface: </font></font><br><br><pre> <code class="hljs pgsql"> interface Ethernet0/<span class="hljs-number"><span class="hljs-number">1</span></span> service-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> TRISOLARANS_ADMISSION_CONTROL</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ici, nous indiquons la vitesse moyenne autoris√©e CIR (10 Mo / s) et la rafale autoris√©e Bc (1 875 000 octets, environ 14,6 Mo). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plus tard, expliquant comment fonctionne le polyser, je vous dirai ce que sont le CIR et le Bc et comment d√©terminer ces valeurs. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fichier de configuration du polyser. </font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cette image est observ√©e avec polysing. </font><font style="vertical-align: inherit;">Des changements soudains du niveau de vitesse sont imm√©diatement apparents:</font></font><br><br><img src="https://habrastorage.org/webt/wg/vb/iv/wgvbiv6biiv27f99npxfupqjdla.png" width="900"><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mais une image aussi int√©ressante est obtenue si nous rendons la taille de rafale autoris√©e trop petite, par exemple 10 000 octets. </font></font><br><br><pre> <code class="hljs powershell"> police cir <span class="hljs-number"><span class="hljs-number">10000000</span></span> bc <span class="hljs-number"><span class="hljs-number">10000</span></span> conform<span class="hljs-literal"><span class="hljs-literal">-action</span></span> transmit exceed<span class="hljs-literal"><span class="hljs-literal">-action</span></span> drop</code> </pre> <br><img src="https://habrastorage.org/webt/3a/cn/l0/3acnl01957rqgxcsonokebamdim.png" width="900"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La vitesse globale a imm√©diatement chut√© √† environ 2 Mo / s. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention au r√©glage des rafales :) </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Table de test.</font></font></a> <br><br><hr><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Seau qui fuit et seau √† jetons </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela semble simple et clair. Mais comment cela fonctionne-t-il dans la pratique et est-il impl√©ment√© dans le mat√©riel? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un exemple. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La limite de 400 Mb / s est-elle beaucoup (ou un peu)? En moyenne, un client n'en utilise que 320. Mais parfois, il passe √† 410 pendant 5 minutes. Et parfois jusqu'√† 460 par minute. Et parfois jusqu'√† 500 pendant une demi-seconde. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme le peut dire le lien du fournisseur contractuel - 400 et c'est tout! Si vous en voulez plus, connectez-vous au tarif de 1Gb / s + 27 cha√Ænes anime. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et nous pouvons augmenter la fid√©lit√© des clients si cela n'interf√®re pas avec les autres en autorisant de telles surtensions. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment autoriser 460 Mb / s pour seulement une minute, et non 30 ou pour toujours? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment autoriser 500 Mb / s, si la bande est gratuite, et pousser √† 400, si d'autres consommateurs sont apparus? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, faites une pause, versez un seau de fort.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Commen√ßons par le m√©canisme plus simple utilis√© par le shaper - un seau qui fuit. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Algorithme de seau qui fuit </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leaky Bucket est un seau qui fuit. </font></font><br><br><img src="https://habrastorage.org/webt/te/qj/jv/teqjjvam2gz-gwlvfcfr1osqj5q.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons un seau avec un trou d'une taille donn√©e en bas. </font><font style="vertical-align: inherit;">Les sacs sont vers√©s / vers√©s dans ce seau par le haut. </font><font style="vertical-align: inherit;">Et d'en bas, ils coulent √† un d√©bit constant. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque le seau est plein, de nouveaux paquets commencent √† √™tre jet√©s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La taille du trou est d√©termin√©e par la limite de vitesse sp√©cifi√©e, qui pour Leaky Bucket est mesur√©e en bits par seconde. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le volume du godet, sa pl√©nitude et sa vitesse de sortie d√©terminent le retard introduit par le shaper. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour plus de commodit√©, le volume du godet est g√©n√©ralement mesur√© en ms ou Œºs. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En termes d'impl√©mentation, Leaky Bucket est un tampon r√©gulier bas√© sur SD-RAM.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√™me si la mise en forme n'est pas explicitement configur√©e, en pr√©sence de rafales qui ne passent pas dans l'interface, les paquets sont temporairement mis en m√©moire tampon et transmis lorsque l'interface est lib√©r√©e. </font><font style="vertical-align: inherit;">Cela fa√ßonne √©galement. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le seau qui fuit est utilis√© uniquement pour le fa√ßonnage et ne convient pas au polissage.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Algorithme de seau √† jetons </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beaucoup de gens pensent que le seau √† jetons et le seau qui fuit sont la m√™me chose. </font><font style="vertical-align: inherit;">Seul Einstein se trompait beaucoup plus, ajoutant une constante cosmologique. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les puces de commutation ne comprennent pas vraiment l'heure, elles aggravent encore le nombre de bits qu'elles ont transmis par unit√© de temps. </font><font style="vertical-align: inherit;">Leur travail consiste √† battre. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Est-ce que le bit approchant est 400 000 000 bits par seconde, ou d√©j√† 400 000 001? </font></font><br><br><img src="https://habrastorage.org/webt/kh/pu/i6/khpui6xw0sle9wconrc6ouoeedg.png" width="400"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les d√©veloppeurs d'ASIC avaient un d√©fi d'ing√©nierie non trivial. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il √©tait divis√© en deux sous-t√¢ches:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitant r√©ellement la vitesse en jetant les paquets inutiles sur la base d'une condition tr√®s simple. </font><font style="vertical-align: inherit;">Effectu√© sur les puces de commutation.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cr√©er cette condition simple, qui traite d'une puce plus complexe (plus sp√©cialis√©e), en gardant une trace du temps. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'algorithme qui r√©sout le deuxi√®me probl√®me est appel√© le seau √† jetons. </font><font style="vertical-align: inherit;">Son id√©e est √©l√©gante et simple (non). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La t√¢che de Token Bucket est de faire passer le trafic s'il rel√®ve de la restriction et de le rejeter / peindre en rouge sinon. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est important d'autoriser les rafales de trafic, car cela est normal. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et si dans Leaky Bucket les rafales √©taient tamponn√©es, le Token Bucket ne met rien en m√©moire tampon.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tarif unique - Marquage bicolore </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour l'instant, ne faites pas attention au nom =) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons un seau dans lequel les pi√®ces tombent √† vitesse constante - 400 m√©gamonets par seconde, par exemple. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le volume du seau est de 600 millions de pi√®ces. Autrement dit, il est rempli en une seconde et demie. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A proximit√© se trouvent deux tapis roulants: l'un livre les colis, le second enl√®ve. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour arriver au convoyeur, le colis doit payer. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour cela, il prend des pi√®ces dans un seau en fonction de sa taille. En gros - combien de bits - tant de pi√®ces. </font></font><br><br><img src="https://habrastorage.org/webt/2m/lh/kz/2mlhkzj9j1vezkils69vlszdgc0.png" width="800"><br><br><img src="https://habrastorage.org/webt/hj/o5/nn/hjo5nn2u7omtuighgtohqpx1y1k.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le seau est vide et qu'il n'y a pas assez de pi√®ces dans le sac, il est peint en rouge et jet√©. H√©las, Selyava. Dans ce cas, les pi√®ces ne sont pas retir√©es du seau.</font></font><br><br><img src="https://habrastorage.org/webt/d-/bf/q9/d-bfq9l2tnj90-58kvi38zl3ufy.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le prochain paquet de pi√®ces peut d√©j√† √™tre suffisant - premi√®rement, le paquet peut √™tre plus petit et, deuxi√®mement, il attaque plus de pi√®ces pendant ce temps. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le seau est d√©j√† plein, toutes les nouvelles pi√®ces seront jet√©es. </font></font><br><br><img src="https://habrastorage.org/webt/cs/yn/yq/csynyq7ig1pfozdswqkxt59dt2e.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout d√©pend du taux d'arriv√©e des paquets et de leur taille. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'il est stable ou inf√©rieur √† 400 Mo par seconde, il y aura toujours suffisamment de pi√®ces. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'il est sup√©rieur, certains des paquets seront perdus.</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Un exemple plus pr√©cis avec des gifs, comme nous aimons tous. </font></font><br><br><img src="https://habrastorage.org/webt/o1/ds/ek/o1dsekpsi9nhg-plchkoivxrwm4.gif"><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a un seau d'une capacit√© de 2500 octets. </font><font style="vertical-align: inherit;">Au d√©part, il contient 550 jetons. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a trois paquets de 1000 octets sur le pipeline qui veulent √™tre envoy√©s √† l'interface. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä chaque intervalle de temps, 500 octets tombent dans le compartiment (500 * 8 = 4000 bits / intervalle de temps - limite de polyser).</font></font></li><li>         500 .       .   1000 ,    1050  ‚Äî <b></b> .       . 1000    . <br>    50 . </li><li>          500  ‚Äî  550.     ‚Äî 1000 ‚Äî <b> </b> . <br>     ,   . </li><li>         500  ‚Äî  1050.    ‚Äî 1000 ‚Äî <b></b> . <br>      ,    . </li></ul><br>    2500   ,             2500  ‚Äî      .        MTU    ,      ,  ,  1,5-2 . <br><br>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> : <br><br> CBS = CIR (  )*1,5 ()/8 (  ) <br><br>       ,     (Bc),   ,     (1 875 000 )    .    (10 000 ),   ,     MTU,           . <br></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi un volume de godet? Le train de bits n'est pas toujours uniforme, c'est √©vident. Une limite de 400 Mb / s n'est pas une asymptote - le trafic peut la traverser. Le volume des pi√®ces stock√©es permet aux petites rafales de survoler sans √™tre jet√©es, mais conserve la vitesse moyenne √† 400 Mo / s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, un flux stable de 399 Mb / s en 600 secondes permettra au godet de se remplir √† ras bord. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, le trafic peut atteindre 1000Mb / s et rester √† ce niveau pendant 1 seconde - 600 Mm (Megamonet) de stock et 400 Mm / s de bande garantie. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ou, le trafic peut aller jusqu'√† 410 Mb / s et le rester pendant 60 secondes. </font></font><br><br><img src="https://habrastorage.org/webt/hq/yl/ib/hqylibyhmxkhepdt9mcf04m7rnk.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, la fourniture de pi√®ces vous permet d'aller l√©g√®rement au-del√† de la restriction pendant une longue p√©riode ou de lancer une surtension courte mais √©lev√©e. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passons maintenant √† la terminologie.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le taux de r√©ception des pi√®ces dans le seau - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CIR - Taux d'Information Engag√©</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Vitesse moyenne garantie). Mesur√© en bits par seconde. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le nombre de pi√®ces pouvant √™tre stock√©es dans le seau - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CBS - Committed Burst Size</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Taille de rafale maximale autoris√©e. Mesur√© en octets. Parfois, comme vous l'avez peut-√™tre remarqu√©, cela s'appelle </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Le nombre de pi√®ces (Token) dans le compartiment </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (CBS) pour le moment.</font></font><br><br><img src="https://habrastorage.org/webt/nm/rr/iv/nmrrivc2sdktqp4cfyhwfayjuze.png" width="600"><br><blockquote>      " <b>Tc</b> ",  ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 2697</a> ( <i>A Single Rate Three Color Marker</i> ). <br>     Tc,    ,       . <br>    . <br>    ,    ,     Token Bucket,    <b>TDM</b> (Time-Division Multiplexing) ‚Äî         . <br>          ‚Äî  , , . <br>          CIR .    . <br>   ,    ‚Äî   ,  ‚Äî   ,  ‚Äî   . <br>         ,      . <br>      (    Cisco) <b>Tc</b> ,     ‚Äî <b>Bc</b> .   <b>Bc = CIR*Tc</b> . <br>       Tc    Bc . <br></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est le sc√©nario le plus simple. </font><font style="vertical-align: inherit;">Il est appel√© </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Single Rate - Two Color</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le taux unique</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> signifie qu'il n'y a qu'une seule vitesse moyenne autoris√©e et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux couleurs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - que vous pouvez colorer le trafic dans l'une des deux couleurs: vert ou rouge.</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le nombre de pi√®ces (bits) disponibles dans le compartiment </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sup√©rieur au nombre de bits qui doivent √™tre ignor√©s pour le moment, le paquet est color√© en vert - une faible probabilit√© de chute √† l'avenir. </font><font style="vertical-align: inherit;">Les pi√®ces </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sont retir√©es</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> du seau.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sinon, l'emballage est peint en rouge - une forte probabilit√© de chute (ou, plus souvent, une chute momentan√©e). </font><font style="vertical-align: inherit;">Pi√®ces de </font><font style="vertical-align: inherit;">monnaie seaux ainsi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C est retir√©</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilis√© pour le polissage dans PHB CS et EF, o√π une acc√©l√©ration n'est pas attendue, mais si cela se produit, il est pr√©f√©rable de le jeter imm√©diatement. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, nous consid√©rerons plus difficile: Taux unique - Trois couleurs.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tarif unique - Marquage tricolore </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'inconv√©nient du sch√©ma pr√©c√©dent est qu'il n'y a que deux couleurs. Et si nous ne voulons pas tout laisser tomber au-dessus de la vitesse moyenne autoris√©e, mais que nous voulons √™tre encore plus fid√®les? </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCM-sr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">taux unique - les trois plus </font><font style="vertical-align: inherit;">la couleur de </font><font style="vertical-align: inherit;">marquage</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) entre dans le deuxi√®me seau - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A cette √©poque, les pi√®ces ne sont pas plac√©s dans un seau rempli de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sont vers√©s dans </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><b><font style="vertical-align: inherit;">EBS est</font></b></font><br><br><img src="https://habrastorage.org/webt/xq/wq/fb/xqwqfblgko9sadvpv_zg2khhoma.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ajout√© √† CIR et CBS </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Excess Burst Size</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><b><font style="vertical-align: inherit;">Taille de</font></b><font style="vertical-align: inherit;"> rafale autoris√©e pendant les pics. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Te</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - le nombre de pi√®ces dans un seau </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><img src="https://habrastorage.org/webt/un/tb/1v/untb1vhnskpben6jqecdqinvx4q.png" width="600"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disons qu'un paquet de taille </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est arriv√© le long du pipeline.</font></font> Alors <br><br><ol><li>     <b>C</b> ,      .   <b>C</b>  <b>B</b>  (: Tc ‚Äî B). </li><li>     <b>C</b>  ,   <b>E</b> .     ,     (  ),   <b>E</b>  <b>B</b> . <br><br><img src="https://habrastorage.org/webt/oi/my/if/oimyif_nplc0auqsknrlbtatqe0.png" width="800"><br></li><li>     <b>E</b>   ,     ,    . <br><br><img src="https://habrastorage.org/webt/tn/44/ct/tn44ctwmh8zxmekxrr9y6sv4avm.png" width="800"><br></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notez que pour un package sp√©cifique, Tc et Te </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont </font><b><font style="vertical-align: inherit;">pas cumulatifs</font></b><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, un paquet de 8000 octets de taille ne passera pas, m√™me s'il </font><font style="vertical-align: inherit;">y a 3000 pi√®ces </font><font style="vertical-align: inherit;">dans le seau </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et dans </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 7000 </font><font style="vertical-align: inherit;">pi√®ces </font><font style="vertical-align: inherit;">. En </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ce n'est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pas suffisant, en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E ce n'est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pas suffisant - nous mettons une marque rouge - shuruy d'ici. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'agit d'un design tr√®s √©l√©gant. Tout le trafic qui tombe dans la restriction CIR + CBS moyenne (l'auteur sait qu'il est impossible d'ajouter des bits / s et des octets si directement) - passe au vert. Aux heures de pointe, lorsque le client n'a plus de pi√®ces dans le compartiment </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il a encore du stock de Te dans le compartiment </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> accumul√© pendant les temps d'arr√™t </font><font style="vertical-align: inherit;">.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, vous pouvez sauter un peu plus, mais en cas de congestion, ils sont plus susceptibles d'√™tre jet√©s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sr-TCM est d√©crit dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC 2697</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilis√© pour le polissage dans PHB AF. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eh bien, le dernier syst√®me est le plus flexible et donc le plus complexe - deux taux - trois couleurs.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Deux taux - trois couleurs de marquage </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le mod√®le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tr-TCM</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est n√© de l'id√©e que ce n'est pas au d√©triment des autres utilisateurs et types de trafic, pourquoi ne pas donner au client des opportunit√©s un peu plus agr√©ables, ou mieux vendre. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disons-lui qu'il est garanti 400 Mb / s, et s'il y a des ressources libres, alors 500. √ätes-vous pr√™t √† payer 30 roubles de plus? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un autre seau </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ajout√© </font><font style="vertical-align: inherit;">.</font></font><br><br>  De cette fa√ßon: <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CIR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - vitesse moyenne garantie. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CBS a</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la m√™me taille d'√©claboussure autoris√©e (volume de compartiment </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PIR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Peak Information Rate - vitesse moyenne maximale. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EBS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - taille de rafale autoris√©e pendant les pics (Bucket Volume </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contrairement √† sr-TCM, dans tr-TCM, les pi√®ces sont d√©sormais livr√©es ind√©pendamment aux deux compartiments. </font><font style="vertical-align: inherit;">En </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - avec la vitesse du CIR, en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - PIR. </font></font><br><br><img src="https://habrastorage.org/webt/xd/gk/_d/xdgk_dfz6sd-mw6lsw_adkipcve.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelles sont les r√®gles? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un paquet de taille </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> octets </font><font style="vertical-align: inherit;">arrive </font><font style="vertical-align: inherit;">.</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'il n'y a </font><font style="vertical-align: inherit;">pas assez de </font><font style="vertical-align: inherit;">pi√®ces dans le seau </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , le paquet est marqu√© en rouge. </font><font style="vertical-align: inherit;">Les pi√®ces </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont </font><b><font style="vertical-align: inherit;">pas retir√©es</font></b><font style="vertical-align: inherit;"> .</font></font> Sinon: </li><li>     <b>C</b>   ‚Äî   ,    <b>P  B</b> .  Sinon: </li><li>      <b>   B</b> . </li></ol><br><img src="https://habrastorage.org/webt/xz/ac/xl/xzacxlryw2kkvf1ms-nkgufteba.png" width="800"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, les r√®gles de tr-TCM sont diff√©rentes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tant que le trafic reste dans la vitesse garantie, les pi√®ces sont retir√©es des deux compartiments. </font><font style="vertical-align: inherit;">Gr√¢ce √† cela, lorsque les </font><font style="vertical-align: inherit;">pi√®ces s'√©puisent </font><font style="vertical-align: inherit;">dans le seau </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , elles resteront dans </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais juste assez pour ne pas d√©passer le PIR (si elles n'√©taient retir√©es que de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alors </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se remplirait plus et donnerait une vitesse beaucoup plus √©lev√©e). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En cons√©quence, si elle est sup√©rieure √† la garantie, mais inf√©rieure au pic, les pi√®ces ne sont retir√©es que de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> il n'y a d√©j√† rien. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tr-TCM surveille non seulement les rafales, mais √©galement une vitesse de pointe constante. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tr-TCM est d√©crit dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFC 2698</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √âgalement utilis√© pour le polissage en PHB AF. </font></font><br><br><hr><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> R√©sum√© de la limite de vitesse </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alors que la mise en forme diff√®re le trafic lorsqu'il est d√©pass√©, le polissage le rejette. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La mise en forme n'est pas adapt√©e aux applications sensibles √† la latence et √† la gigue. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour impl√©menter le polissage dans le mat√©riel, l'algorithme Token Bucket est utilis√©, pour la mise en forme - Leaky Bucket. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le seau √† jetons peut √™tre:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avec un seau - Tarif unique - Marquage bicolore. </font><font style="vertical-align: inherit;">Permet des rafales valides.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avec deux godets - Taux unique - Marquage tricolore (sr-TCM). </font><font style="vertical-align: inherit;">L'exc√©dent du godet C (CBS) est vers√© dans le godet E. Permet des surtensions autoris√©es et redondantes.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avec deux seaux - Deux taux - Marquage tricolore (tr-TCM). </font><font style="vertical-align: inherit;">Les godets C et P (PBS) se r√©g√©n√®rent ind√©pendamment √† diff√©rentes vitesses. </font><font style="vertical-align: inherit;">Permet une vitesse de pointe et des rafales autoris√©es et excessives.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sr-TCM se concentre sur la quantit√© de trafic au-del√† de la limite. tr-TCM - √† la vitesse √† laquelle il arrive. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le polissage peut √™tre utilis√© √† l'entr√©e et √† la sortie de l'appareil. La mise en forme se fait principalement √† la sortie. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour PHB CS et EF, le marquage bicolore √† taux unique est utilis√©. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour AF, sr-TCM ou tr-TCM. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour une meilleure compr√©hension, je recommande de se r√©f√©rer √† la RFC originale ou de lire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><blockquote>  Token Bucket     . ,       ,   ,       ,       . <br>     ,         ‚Äî ,  .   ,    ,       ,    ‚Äî  . <br>      ,     .          ‚Äî   .         . <br></blockquote><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ci-dessus, j'ai d√©crit tous les m√©canismes de base de la QoS, sinon approfondir la QoS hi√©rarchique. </font><font style="vertical-align: inherit;">Un syst√®me sophistiqu√© avec de nombreuses pi√®ces mobiles. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout allait bien (non?) Sonn√© jusqu'√† pr√©sent, mais que se passe-t-il sous le panneau externe vanille du routeur? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au fil des ans, les fournisseurs ont ajout√© de plus en plus de contours, d√©velopp√© des puces sophistiqu√©es, √©largi les tampons, d'une part, pour suivre le volume croissant du trafic et de ses nouvelles cat√©gories, et d'autre part, pour r√©soudre les probl√®mes croissants caus√©s par le premier paragraphe. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La course en cours. </font><font style="vertical-align: inherit;">Les paquets ne doivent pas √™tre perdus si le concurrent ne les perd pas. </font><font style="vertical-align: inherit;">Vous ne pouvez pas refuser la fonctionnalit√© si un adversaire se tient √† ses c√¥t√©s sous les portes du client. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ida dans l'antre de la propri√©t√©!</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9. Impl√©mentation mat√©rielle de QoS </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans ce chapitre, j'entreprends la t√¢che ingrate. Si vous le d√©crivez le plus simplement possible, il y aura toujours ceux qui disent que tout n'est pas ainsi en r√©alit√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous le d√©crivez tel quel, le lecteur laissera tomber l'article car il se transformera en dessin sous-marin, plus pr√©cis√©ment, des dessins de trois bateaux avec des crayons de couleurs diff√©rentes sur une seule feuille. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En g√©n√©ral, je ferai une mise en garde qu'en r√©alit√© tout n'est pas le m√™me qu'en r√©alit√©, et j'irai selon la version d'une simple pr√©sentation. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pardonnez-moi mon coll√®gue perfectionniste. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce qui contr√¥le le comportement du n≈ìud et d√©clenche les m√©canismes appropri√©s par rapport au package? La priorit√© qu'il porte dans l'une des rubriques? Oui et non. </font></font><br><br><img src="https://habrastorage.org/webt/th/ie/l1/thiel1p000d6rgwchs-xo1hl4ys.png" width="250"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme mentionn√© ci-dessus, au sein d'un p√©riph√©rique r√©seau, l'en-t√™te de commutation standard cesse g√©n√©ralement d'exister.</font></font><br><br><img src="https://habrastorage.org/webt/nj/h5/aq/njh5aquhoyypydjzrdttbespgr4.png" width="1000"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√®s qu'un paquet arrive sur la puce de commutation, les en-t√™tes en sont supprim√©s et envoy√©s pour analyse, et la charge utile languit dans une sorte de tampon temporaire. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sur la base des en-t√™tes, une classification (BA ou MF) a lieu et une d√©cision est prise concernant la redirection. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apr√®s un moment, un en-t√™te interne avec des m√©tadonn√©es sur le package est suspendu sur le package. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ces m√©tadonn√©es contiennent de nombreuses informations importantes - l'adresse de l'exp√©diteur et du destinataire, la puce de sortie, le num√©ro de s√©rie de la cellule, s'il y a eu fragmentation du paquet et le marquage de classe (CoS) et la priorit√© de suppression sont obligatoires. Marquage uniquement au format interne - il peut co√Øncider avec le DSCP ou non. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En principe, √† l'int√©rieur de la bo√Æte, vous pouvez d√©finir une longueur de marquage arbitraire sans √™tre li√© aux normes et d√©finir des actions tr√®s flexibles avec le package.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chez Cisco, le marquage interne est appel√© QoS Group, chez Juniper - Forwarding Class, Huawei n'a pas d√©cid√©: quelque part il appelle les priorit√©s internes, quelque part les priorit√©s locales, quelque part la classe de service et quelque part juste CoS. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajoutez des noms pour d'autres fournisseurs dans les commentaires - j'ajouterai.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ce marquage interne est attribu√© en fonction de la classification effectu√©e par le n≈ìud. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est important que, sauf indication contraire, l'√©tiquetage interne ne fonctionne qu'√† l'int√©rieur du n≈ìud, mais n'apparaisse pas sur l'√©tiquette dans les en-t√™tes du paquet qui sera envoy√© √† partir du n≈ìud - il restera le m√™me.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, √† l'entr√©e du domaine DS apr√®s la classification, il y a g√©n√©ralement un nouveau marquage dans une certaine classe de service accept√©e dans ce r√©seau. Ensuite, l'√©tiquetage interne est converti en la valeur accept√©e pour cette classe sur le r√©seau et est enregistr√© dans l'en-t√™te du paquet envoy√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'√©tiquetage interne CoS et Drop Precedence d√©finit le comportement uniquement au sein d'un n≈ìud donn√© et n'est pas explicitement transmis aux voisins, √† l'exception du r√©-√©tiquetage des en-t√™tes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CoS et Drop Precedence d√©finissent le PHB, ses m√©canismes et param√®tres: pr√©vention des encombrements, gestion des encombrements, ordonnancement et r√©√©tiquetage.</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quels cercles les paquets passent-ils entre les interfaces d'entr√©e et de sortie? J'ai pass√© en revue dans un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article pr√©c√©dent</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">En fait, cela s'est av√©r√© impr√©vu, car √† un moment donn√©, il est devenu √©vident que sans comprendre l'architecture, il √©tait pr√©matur√© de parler de QoS. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, r√©p√©tons.</font></font><br><br><img src="https://habrastorage.org/webt/3k/s1/3e/3ks13e4uzagzrbopm5juuyun4j8.png" width="1000"><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le signal frappe l'interface d'entr√©e physique et sa puce (PIC). </font><font style="vertical-align: inherit;">Un flux de bits en d√©coule, puis un paquet avec tous les en-t√™tes.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä c√¥t√© de la puce de commutation d'entr√©e (FE), o√π les en-t√™tes sont s√©par√©s du corps du paquet. </font><font style="vertical-align: inherit;">La classification se produit et il est d√©termin√© o√π le paquet doit √™tre envoy√© plus loin.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä c√¥t√© de la file d'attente d'entr√©e (TM / VOQ). </font><font style="vertical-align: inherit;">D√©j√† ici, les packages sont dispos√©s dans diff√©rentes files d'attente en fonction de leur classe.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Suite √† l'usine de commutation (le cas √©ch√©ant). </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √Ä c√¥t√© de la file d'attente de sortie (TM). </font></font></li><li>      (FE),    . </li><li>     (,    ) (PIC). </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans ce cas, le routeur doit r√©soudre une √©quation complexe. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©veloppez tout en classes, offrez √† quelqu'un une large bande, quelqu'un √† faible latence, quelqu'un n'assure aucune perte. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et en m√™me temps, ayez le temps de sauter tout le trafic si possible. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, vous devez faire du fa√ßonnage, √©ventuellement du polissage. </font><font style="vertical-align: inherit;">Si une surcharge se produit soudainement, faites-y face. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et cela ne compte pas les recherches, le traitement ACL, le comptage des statistiques. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part peu enviable. </font><font style="vertical-align: inherit;">Mais les robots injectent, pas un homme. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En fait, il n'y a que deux endroits o√π les m√©canismes QoS fonctionnent - une puce de commutation et une puce / file d'attente de gestion du trafic. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans le m√™me temps, des op√©rations sur la puce de commutation n√©cessitent une analyse ou des actions avec des en-t√™tes.</font></font><br><br><ul><li>  Classification </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Polissage </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> R√©√©tiquetage </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TM s'occupe du reste. </font><font style="vertical-align: inherit;">Fondamentalement, ce sont des op√©rations de routine avec un algorithme pr√©d√©fini et des param√®tres personnalis√©s:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pr√©vention de la congestion </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gestion de la congestion </font></font></li><li>  Fa√ßonner </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TM est un tampon intelligent, g√©n√©ralement bas√© sur SD-RAM. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est intelligent parce que, a) programmable, b) il peut faire toutes sortes de choses d√©licates avec des files d'attente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est souvent distribu√© - des puces SD-RAM sont situ√©es sur chaque carte d'interface, et ensemble, elles sont combin√©es en VOQ (Virtual Output Queue), ce qui r√©sout le probl√®me de blocage de la t√™te de ligne. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le fait est que si la puce de commutation ou l'interface de sortie est obstru√©e, ils demandent √† la puce d'entr√©e de ralentir et de ne pas envoyer de trafic pendant un certain temps. S'il n'y a qu'une seule file d'attente dans toutes les directions, il est tr√®s d√©cevant que toutes les autres souffrent d'une seule interface de sortie. Il s'agit du Head of Line Blocking. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VOQ, sur la carte d'interface d'entr√©e, cr√©e plusieurs files d'attente de sortie virtuelles pour chaque interface de sortie existante.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, ces lignes dans des √©quipements modernes prennent en compte l'√©tiquetage de l'emballage. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä propos de VOQ est d√©crit suffisamment en d√©tail dans une s√©rie de notes </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soit dit en passant, ils sont vraiment plac√©s dans la file d'attente, ils sont promus, ce ne sont pas les paquets eux-m√™mes qui sont saisis, etc., mais uniquement les enregistrements les concernant. Cela n'a aucun sens de faire autant de gestes avec de grands tableaux de bits. Pendant que la QoS se moque des enregistrements, les paquets sont parfaitement dans leur m√©moire et sont r√©cup√©r√©s √† partir de l√† √† l'adresse. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VOQ est une file d'attente logicielle (le terme anglais Software Queue est plus pr√©cis). Apr√®s cela, juste avant l'interface, il y a aussi une file d'attente mat√©rielle, qui fonctionne toujours strictement selon FIFO. Il est presque impossible de contr√¥ler aucun de ses param√®tres (par exemple, Cisco vous permet de configurer uniquement la profondeur avec la commande tx-ring-limit).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Juste entre les files d'attente logicielles et mat√©rielles, vous pouvez ex√©cuter des r√©partiteurs arbitraires. C'est dans la file d'attente du programme que fonctionnent Head / Tail-drop et AQM, le polissage et le fa√ßonnage. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La taille de la file d'attente mat√©rielle est tr√®s petite (unit√©s de paquets), car le r√©partiteur fait tout le travail d'empilement du d√©bit de ligne. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malheureusement, ici, vous pouvez faire de nombreuses r√©servations, et en fait tout biffer avec un stylo rouge et dire "le vendeur X ne le fait pas".</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je voudrais faire une derni√®re remarque sur les packages de services. Ils sont trait√©s diff√©remment des paquets d'utilisateurs de transit. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âtant g√©n√©r√©s localement, leur conformit√© aux r√®gles ACL et aux limites de vitesse n'est pas v√©rifi√©e. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les paquets de l'ext√©rieur destin√©s au processeur de la puce de commutation de sortie tombent dans d'autres files d'attente - vers le processeur - en fonction du type de protocole. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, BFD a la priorit√© la plus √©lev√©e, OSPF peut attendre plus longtemps et ICMP n'a g√©n√©ralement pas peur de tomber. C'est-√†-dire que plus le paquet est important pour que le r√©seau fonctionne, plus sa classe de service est √©lev√©e lors de l'envoi vers le CPU. C'est pourquoi il est normal de voir des retards variables sur le transit hop dans le ping ou le tra√ßage - ICMP n'est pas un trafic prioritaire pour le CPU. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, des paquets de protocole sont appliqu√©s</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CoPP - Control Plane Protection</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ou Policing) - limitation de vitesse pour √©viter une utilisation √©lev√©e du processeur - encore une fois, de meilleures baisses pr√©visibles dans les files d'attente √† faible priorit√© avant le d√©but des probl√®mes. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CoPP aidera √† la fois √† partir d'un DoS cibl√© et d'un comportement anormal du r√©seau (par exemple, des boucles) lorsqu'un volume de trafic de diffusion commence √† arriver sur l'appareil.</font></font><br><br><hr><br><h1>  Liens utiles </h1><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le meilleur livre sur la th√©orie et la philosophie de la QoS: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QS-Enabled Networks: Tools and Foundations</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Certains extraits peuvent √™tre lus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais je recommanderais de le lire de et vers, de ne pas √©changer.</font></font></li><li>         QoS  Huawei: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Special Edition QoS(v6.0)</a> .        PHB   . </li><li>    sr-TCM  tr-TCM  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Understanding Single-Rate and Dual-Rate Traffic Policing</a> . </li><li>  VOQ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">What is VOQ and why you should care?</a> </li><li>  QoS  MPLS: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MPLS and Quality of Service</a> . </li><li>     QoS   Juniper: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Juniper CoS notes</a> . </li><li>   QoS       TCP  UDP.       : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">The TCP/IP Guide</a> </li><li>    ,          ,       : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">         TCP</a> . </li><li>    ,        FQ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Queuing and Scheduling</a> . <br>      ,     ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">An Introduction to Computer Networks</a> ,  ,     Introduction,      .    . <br></li><li>  WFQ  ,    , , ,   ,    : Weighted Fair Queueing: a packetized approximation for FFS/GP. <br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a aussi le m√©canisme LFI, que je n'ai pas abord√©, car il est difficile dans nos r√©alit√©s d'interfaces de cent gigaoctets √©galement, mais il pourrait √™tre int√©ressant de se familiariser: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fragmentation de lien et entrelacement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et bien s√ªr, la suite RFC ...</font></font></b> <div class="spoiler_text"><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc791</a> ( <i>INTERNET PROTOCOL</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc1349</a> ( <i>Type of Service in the Internet Protocol Suite</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc1633</a> ( <i>Integrated Services in the Internet Architecture: an Overview</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc2474</a> ( <i>Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc2475</a> ( <i>An Architecture for Differentiated Services</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc2597</a> ( <i>Assured Forwarding PHB Group</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc2697</a> ( <i>A Single Rate Three Color Marker</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc2698</a> ( <i>A Two Rate Three Color Marker</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc3031</a> ( <i>Multiprotocol Label Switching Architecture</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc3168</a> ( <i>The Addition of Explicit Congestion Notification (ECN) to IP</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc3246</a> ( <i>An Expedited Forwarding PHB (Per-Hop Behavior)</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc3260</a> ( <i>New Terminology and Clarifications for Diffserv</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc3662</a> ( <i>A Lower Effort Per-Domain Behavior (PDB) for Differentiated Services</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc4594</a> ( <i>Configuration Guidelines for DiffServ Service Classes</i> ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc5462</a> ( <i>Multiprotocol Label Switching (MPLS) Label Stack Entry: ¬´EXP¬ª Field Renamed to ¬´Traffic Class¬ª Field</i> ) </li></ul><br></div></div><br><h1>  Conclusion </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cette version a eu de nombreux critiques. </font></font><br>  Je vous remercie <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexander </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fatin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;">LoxmatiyMamont</font></a><font style="vertical-align: inherit;"> ) pour un mot d'introduction et de pr√©cieux conseils sur l'expressivit√© et la clart√© du texte. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexander Clipper (@ metallicat20) pour sa revue par les pairs. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexander Klimenko (@ v00lk) pour les critiques s√©v√®res et les changements les plus massifs de ces derniers jours. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrey Glazkov (@glazgoo) pour des commentaires sur la structure, la terminologie et les virgules. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artyom Chernobay pour KDPV. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anton Klochkov (@NAT_GTX) pour les contacts avec Miran. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Miran (miran.ru) pour avoir organis√© un serveur avec Eva et diffus√©. </font><font style="vertical-align: inherit;">Traditionnellement, ma famille, qui, cette fois, a le moins souffert en raison de son absence pr√®s des moments les plus difficiles.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr420525/">https://habr.com/ru/post/fr420525/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr420515/index.html">Diarisation bas√©e sur le mod√®le GMM-UBM et l'algorithme d'adaptation MAP</a></li>
<li><a href="../fr420517/index.html">Impl√©mentation FPGA de la FFT enti√®re</a></li>
<li><a href="../fr420519/index.html">Vulgarisation de la science</a></li>
<li><a href="../fr420521/index.html">Maintenant officiellement: TLS 1.3 reconnu comme standard</a></li>
<li><a href="../fr420523/index.html">Analyse des graphiques d'options binaires ou comment je me suis encore une fois prouv√© que les cadeaux n'existent pas</a></li>
<li><a href="../fr420527/index.html">Un sourire peut retentir et c'est contagieux</a></li>
<li><a href="../fr420529/index.html">Utilisation avanc√©e de Geeta ou comment prendre sa retraite six mois plus t√¥t?</a></li>
<li><a href="../fr420533/index.html">√âmulation de litt√©raux de propri√©t√© avec la r√©f√©rence de m√©thode Java 8</a></li>
<li><a href="../fr420537/index.html">Un autre conte sur la fa√ßon dont l'argent est relativement honn√™tement pris sur un m√©gaphone</a></li>
<li><a href="../fr420539/index.html">Approche personnalis√©e pour normaliser et r√©initialiser les styles (custom-reset.css)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>