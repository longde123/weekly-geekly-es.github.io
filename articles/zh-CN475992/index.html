<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🤝‍👨🏾 🤞🏿 🖖🏼 编写用于学习英语的VLC插件 🚨 ✂️ 🛌🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在本文中，我将讨论如何在C中为VLC媒体播放器编写插件。 我写了我的插件来简化用英语观看电视节目和电影的过程。 在创建想法和查找解决方案部分中介绍了创建此插件的想法。 插件实现的技术细节在Hello World插件和实现部分中提供。 最后的结果以及如何使用它可以在最后一部分Result中找到 。 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>编写用于学习英语的VLC插件</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475992/"><img src="https://habrastorage.org/webt/nl/nj/r4/nlnjr4lpomher2u_r87vvsjeptc.png" alt="图片"><br><br> 在本文中，我将讨论如何在C中为VLC媒体播放器编写插件。 我写了我的插件来简化用英语观看电视节目和电影的过程。 在创建<b>想法</b>和<b>查找解决方案</b>部分中介绍了创建此插件的想法。 插件实现的技术细节在<b>Hello World插件</b>和<b>实现</b>部分中提供。 最后的结果以及如何使用它可以在最后一部分<b>Result中找到</b> 。 <br><br> 该项目的源代码可在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub</a>上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">找到</a> 。 <br><a name="habracut"></a><br><h1> 主意 </h1><br> 在观看我最喜欢的电视剧时学习外语的想法并不是什么新鲜事，但是我个人一直在实现它方面遇到问题。 如果您听不懂他们说的一半，就很难看连续剧或电影。 当然，您可以打开字幕，但是如果语音中遇到陌生的单词或表达，将很难被文字复制。 而且我根本不喜欢看带有俄文字幕的电视剧-大脑切换到母语，并且不再能听外国语言。 我读过某个地方，首先您需要看俄语的系列节目，然后才看原始版本。 但是这种方法也不适合我。 首先，在哪里花那么多时间去看几次相同的东西，其次，再去看第二遍不再那么有趣了-失去了动力。 <br><br> 尽管在观看外国电视节目时遇到了种种困难，但我可以很好地阅读英文技术文档，文章和书籍。 我喜欢在Kindle电子阅读器上阅读书籍，因为词典功能很酷，您只需触摸一下屏幕，就可以找到不熟悉的单词的翻译。 通过在浏览器中安装用于翻译的特殊扩展名，可以方便地阅读英语文章和网站-我使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Yandex.Translation</a>扩展名。 这种方法使您可以阅读和理解英语文本，而不会因为搜索陌生单词而分心。 <br><br> 我想，为什么不采用相同的方法观看电视节目-一旦发现一个难以理解的词组，我们便以英语打开该系列节目，切换到俄语音轨并向后退​​一点。 接下来，我们继续观看英语系列赛。 <br><br><h1> 寻找解决方案 </h1><br> 实际上，我所需的所有功能已经在许多流行的媒体播放器中提供。 我想在几秒钟前单击一下按钮来切换音轨和倒带视频。 如果在翻译了一个令人费解的片段之后，媒体播放器本身将音轨切换回英语，那也很好。 好吧，能够在英语轨道上重复以前翻译的片段会很好。 <br><br> 也就是说，我需要一个可以为其编写插件的媒体播放器。 还希望它是跨平台的，因为我在Windows下使用PC，在Linux下使用笔记本电脑。 我的选择立即落在了VLC上。 在habr上，我什至发现<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了一篇文章</a> ，其中<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Idunno</a>讲述了如何在LUA上编写VLC扩展。 顺便说一下，他还写了这个扩展程序来学习英语。不幸的是，这个扩展程序在最新版本的VLC（低于2.0.5）中不起作用。 由于操作不稳定，因此从LUA API中删除了添加回调函数的功能，通过该函数可以处理LUA扩展中的键盘事件。 在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">README中</a> ，指向讨论此问题的VLC开发人员的邮件列表的链接导致其在GitHub <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Idunno</a>上的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">扩展</a> 。 <br><br> 因此，要实现我的想法，对LUA的扩展不起作用，您需要用C编写一个插件。尽管大约7年前我上大学时最后一次用C编写了东西，但我还是决定尝试一下。 <br><br><h1> 你好世界插件 </h1><br> 值得注意的是，VLC媒体播放器具有非常好的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文档</a> 。 我从中了解到，媒体播放器的开发使用模块化方法。  VLC包含几个实现某些功能的独立模块，以及管理这些模块的内核（ <b>libVLCCore</b> ）。 模块有两种类型：内部（ <i>树内</i> ）和外部（ <i>树外</i> ）。 内部模块的源代码与内核代码一起存储在一个存储库中。 外部模块的开发和组装独立于VLC媒体播放器。 实际上，后者就是所谓的插件。 <br><br> 该文档还包含有关如何使用C语言编写插件（模块）的文章。本文提供了一个简单插件的源代码，该插件在VLC启动时向控制台显示欢迎消息“ <i>Hello，&lt;name&gt;</i> ”（采用值&lt;name&gt;从插件设置）。 向前走一点，我会说在上面的示例中，在<code>set_category(CAT_INTERFACE)</code>之后添加以下行： <br><br><pre> <code class="cpp hljs">set_subcategory( SUBCAT_INTERFACE_CONTROL )</code> </pre> <br> 好吧，剩下的就是组装插件并测试其运行了。 还有一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关</a>构建外部插件的说明。 这里值得关注<b>国际化</b>部分，该部分描述了本地化在VLC中的工作方式。 简而言之，对于外部插件，您需要定义宏<code>N_()</code> <code>_()</code> ， <code>_()</code> ： <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DOMAIN </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"vlc-myplugin"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _(str) dgettext(DOMAIN, str) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> N_(str) (str)</span></span></code> </pre> <br> 对于组装，建议使用良好的旧Makefile或Autotools。 我决定采用简单的方法，并选择了Makefile。 在Makefile中，您需要记住定义<b><code>MODULE_STRING</code></b>变量-这是我们插件的标识符。 我还对目录进行了一些调整-现在它们是通过<i>pkg-config</i>定义的。 结果是以下文件： <br><br><div class="spoiler">  <b class="spoiler_title">你好</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/** * @file hello.c * @brief Hello world interface VLC module example */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> HAVE_CONFIG_H # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"config.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DOMAIN </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"vlc-myplugin"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _(str) dgettext(DOMAIN, str) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> N_(str) (str) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdlib.h&gt; /* VLC core API headers */ #include &lt;vlc_common.h&gt; #include &lt;vlc_plugin.h&gt; #include &lt;vlc_interface.h&gt; /* Forward declarations */ static int Open(vlc_object_t *); static void Close(vlc_object_t *); /* Module descriptor */ vlc_module_begin() set_shortname(N_("Hello")) set_description(N_("Hello interface")) set_capability("interface", 0) set_callbacks(Open, Close) set_category(CAT_INTERFACE) set_subcategory( SUBCAT_INTERFACE_CONTROL ) add_string("hello-who", "world", "Target", "Whom to say hello to.", false) vlc_module_end () /* Internal state for an instance of the module */ struct intf_sys_t { char *who; }; /** * Starts our example interface. */ static int Open(vlc_object_t *obj) { intf_thread_t *intf = (intf_thread_t *)obj; /* Allocate internal state */ intf_sys_t *sys = malloc(sizeof (*sys)); if (unlikely(sys == NULL)) return VLC_ENOMEM; intf-&gt;p_sys = sys; /* Read settings */ char *who = var_InheritString(intf, "hello-who"); if (who == NULL) { msg_Err(intf, "Nobody to say hello to!"); goto error; } sys-&gt;who = who; msg_Info(intf, "Hello %s!", who); return VLC_SUCCESS; error: free(sys); return VLC_EGENERIC; } /** * Stops the interface. */ static void Close(vlc_object_t *obj) { intf_thread_t *intf = (intf_thread_t *)obj; intf_sys_t *sys = intf-&gt;p_sys; msg_Info(intf, "Good bye %s!", sys-&gt;who); /* Free internal state */ free(sys-&gt;who); free(sys); }</span></span></span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">生成文件</b> <div class="spoiler_text"><pre> <code class="smalltalk hljs"><span class="hljs-type"><span class="hljs-type">LD</span></span> = ld <span class="hljs-type"><span class="hljs-type">CC</span></span> = cc <span class="hljs-type"><span class="hljs-type">PKG_CONFIG</span></span> = pkg-config <span class="hljs-type"><span class="hljs-type">INSTALL</span></span> = install <span class="hljs-type"><span class="hljs-type">CFLAGS</span></span> = -g -<span class="hljs-type"><span class="hljs-type">O2</span></span> -<span class="hljs-type"><span class="hljs-type">Wall</span></span> -<span class="hljs-type"><span class="hljs-type">Wextra</span></span> <span class="hljs-type"><span class="hljs-type">LDFLAGS</span></span> = <span class="hljs-type"><span class="hljs-type">LIBS</span></span> = <span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_CFLAGS</span></span> := <span class="hljs-string"><span class="hljs-string">$(</span></span>shell <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">PKG_CONFIG</span></span>) --cflags vlc-plugin) <span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_LIBS</span></span> := <span class="hljs-string"><span class="hljs-string">$(</span></span>shell <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">PKG_CONFIG</span></span>) --libs vlc-plugin) <span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_DIR</span></span> := <span class="hljs-string"><span class="hljs-string">$(</span></span>shell <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">PKG_CONFIG</span></span>) --variable=pluginsdir vlc-plugin) plugindir = <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_DIR</span></span>)/misc override <span class="hljs-type"><span class="hljs-type">CC</span></span> += -std=gnu99 override <span class="hljs-type"><span class="hljs-type">CPPFLAGS</span></span> += -<span class="hljs-type"><span class="hljs-type">DPIC</span></span> -<span class="hljs-type"><span class="hljs-type">I</span></span>. -<span class="hljs-type"><span class="hljs-type">Isrc</span></span> override <span class="hljs-type"><span class="hljs-type">CFLAGS</span></span> += -fPIC override <span class="hljs-type"><span class="hljs-type">LDFLAGS</span></span> += -<span class="hljs-type"><span class="hljs-type">Wl</span></span>,-no-undefined,-z,defs override <span class="hljs-type"><span class="hljs-type">CPPFLAGS</span></span> += -<span class="hljs-type"><span class="hljs-type">DMODULE_STRING</span></span>=\<span class="hljs-comment"><span class="hljs-comment">"hello\"</span></span> override <span class="hljs-type"><span class="hljs-type">CFLAGS</span></span> += <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_CFLAGS</span></span>) override <span class="hljs-type"><span class="hljs-type">LIBS</span></span> += <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_LIBS</span></span>) all: libhello_plugin.so install: all mkdir -p -- <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">DESTDIR</span></span>)<span class="hljs-string"><span class="hljs-string">$(</span></span>plugindir) <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">INSTALL</span></span>) --mode <span class="hljs-number"><span class="hljs-number">0755</span></span> libhello_plugin.so <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">DESTDIR</span></span>)<span class="hljs-string"><span class="hljs-string">$(</span></span>plugindir) install-strip: <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">MAKE</span></span>) install <span class="hljs-type"><span class="hljs-type">INSTALL</span></span>=<span class="hljs-comment"><span class="hljs-comment">"$(INSTALL) -s"</span></span> uninstall: rm -f <span class="hljs-string"><span class="hljs-string">$(</span></span>plugindir)/libhello_plugin.so clean: rm -f -- libhello_plugin.so src/*.o mostlyclean: clean <span class="hljs-type"><span class="hljs-type">SOURCES</span></span> = hello.c <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">SOURCES</span></span>:%.c=src/%.o): <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">SOURCES</span></span>:%.c=src/%.c) libhello_plugin.so: <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">SOURCES</span></span>:%.c=src/%.o) <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">CC</span></span>) <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">LDFLAGS</span></span>) -shared -o <span class="hljs-string"><span class="hljs-string">$@</span></span> <span class="hljs-string"><span class="hljs-string">$^</span></span> <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">LIBS</span></span>) .<span class="hljs-type"><span class="hljs-type">PHONY</span></span>: all install install-strip uninstall clean mostlyclean</code> </pre></div></div><br> 为Linux构建插件的最简单方法。 为此，实际上，您需要安装VLC媒体播放器本身以及构建插件所需的文件和工具。 在Debian / Ubuntu上，可以使用以下命令完成此操作： <br><br><pre> <code class="bash hljs">sudo apt-get install vlc libvlc-dev libvlccore-dev gcc make pkg-config</code> </pre> <br> 实际上，一切就绪，我们使用以下命令收集并安装插件： <br><br><pre> <code class="bash hljs">sudo make install</code> </pre> <br> 要测试插件，请同时从控制台运行VLC： <br><br><pre> <code class="bash hljs">vlc</code> </pre> <br> 不幸的是，我们没有看到任何“ <i>Hello world</i> ”。 问题是必须首先启用该插件。 为此，请打开设置（“ <b>工具”</b> &gt; <b>“首选项”</b> ），切换到高级视图（在“ <b>显示设置”</b>组中选择“ <b>全部</b> ”），然后在左面板的树中找到“ <b>接口”</b> &gt;“ <b>控制接口”</b> -选中“ <b>Hello接口</b>插件”旁边的复选框。 <br><br> <a href=""><img src="https://habrastorage.org/webt/fi/wr/ey/fiwreyqdhfd4ncbgzc2g8z1z3y8.png"></a> <br><br> 我们保存设置并重新启动VLC。 <br><br> <a href=""><img src="https://habrastorage.org/webt/g3/-n/h3/g3-nh3qc7k37kzwpbfywtow8msa.png"></a> <br><br><h1> 为Windows构建插件 </h1><br> 使用Windows，事情要复杂一些。 要构建插件，您需要下载sdk，其中包含VLC的库，头文件和配置文件。 以前，SDK是常规VLC程序集的一部分，可以在程序安装文件夹中找到。 现在，它作为一个单独的媒体播放器组件出现。 例如，对于VLC版本3.0.8，可以从<a href="">ftp://ftp.videolan.org/pub/videolan/vlc/3.0.8/win64/vlc-3.0.8-win64.7z</a>下载此程序集（重要的是下载7z -存档）。 <br><br> 将存档的内容复制到一个文件夹，例如，复制到<i>C：\ Projects</i> 。 除sdk外，归档文件还包含媒体播放器本身，可用于测试和调试插件。 <br><br> 为了使我们的Makefile可以用于构建和安装插件，您需要修复文件<i>C：\ Projects \ vlc-3.0.8 \ sdk \ lib \ pkgconfig \ vlc-plugin.pc</i> ，在<b>前缀</b>和<b>pluginsdir</b>变量中指示<b>sdk</b>文件夹的正确路径。和<b>插件</b> ： <br><br><pre> <code class="bash hljs">prefix=/c/Projects/vlc-3.0.8/sdk pluginsdir=/c/Projects/vlc-3.0.8/plugins</code> </pre> <br> 要在Windows下构建，我们还需要安装编译器和其他实用程序。 通过安装<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MSYS2</a>环境可以获得所有必需的软件。 项目网站上有详细的安装说明。 简而言之，安装后，您需要立即打开控制台（ <i>C：\ msys64 \ msys2.exe</i> ）并使用以下命令更新MSYS2软件包： <br><br><pre> <code class="bash hljs">pacman -Syu</code> </pre> <br> 接下来，关闭MSYS2终端窗口，然后再次打开并运行命令 <br><br><pre> <code class="bash hljs">pacman -Su</code> </pre> <br> 更新所有软件包后，您需要安装工具链： <br><br><pre> <code class="bash hljs">pacman -S base-devel mingw-w64-x86_64-toolchain</code> </pre> <br> 现在已经安装了所有必需的软件包，您可以开始构建插件。 我对Makefile做了一些修改，以便可以在Linux和Windows下构建该插件。 另外，我必须删除一些不受支持的MinGW构建参数，因此Makefile开始看起来像这样： <br><br><div class="spoiler">  <b class="spoiler_title">Windows的Makefile</b> <div class="spoiler_text"><pre> <code class="smalltalk hljs"><span class="hljs-type"><span class="hljs-type">LD</span></span> = ld <span class="hljs-type"><span class="hljs-type">CC</span></span> = cc <span class="hljs-type"><span class="hljs-type">PKG_CONFIG</span></span> = pkg-config <span class="hljs-type"><span class="hljs-type">INSTALL</span></span> = install <span class="hljs-type"><span class="hljs-type">CFLAGS</span></span> = -g -<span class="hljs-type"><span class="hljs-type">O2</span></span> -<span class="hljs-type"><span class="hljs-type">Wall</span></span> -<span class="hljs-type"><span class="hljs-type">Wextra</span></span> <span class="hljs-type"><span class="hljs-type">LDFLAGS</span></span> = <span class="hljs-type"><span class="hljs-type">LIBS</span></span> = <span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_CFLAGS</span></span> := <span class="hljs-string"><span class="hljs-string">$(</span></span>shell <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">PKG_CONFIG</span></span>) --cflags vlc-plugin) <span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_LIBS</span></span> := <span class="hljs-string"><span class="hljs-string">$(</span></span>shell <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">PKG_CONFIG</span></span>) --libs vlc-plugin) <span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_DIR</span></span> := <span class="hljs-string"><span class="hljs-string">$(</span></span>shell <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">PKG_CONFIG</span></span>) --variable=pluginsdir vlc-plugin) plugindir = <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_DIR</span></span>)/misc override <span class="hljs-type"><span class="hljs-type">CC</span></span> += -std=gnu99 override <span class="hljs-type"><span class="hljs-type">CPPFLAGS</span></span> += -<span class="hljs-type"><span class="hljs-type">DPIC</span></span> -<span class="hljs-type"><span class="hljs-type">I</span></span>. -<span class="hljs-type"><span class="hljs-type">Isrc</span></span> override <span class="hljs-type"><span class="hljs-type">CFLAGS</span></span> += -fPIC override <span class="hljs-type"><span class="hljs-type">LDFLAGS</span></span> += -<span class="hljs-type"><span class="hljs-type">Wl</span></span>,-no-undefined override <span class="hljs-type"><span class="hljs-type">CPPFLAGS</span></span> += -<span class="hljs-type"><span class="hljs-type">DMODULE_STRING</span></span>=\<span class="hljs-comment"><span class="hljs-comment">"hello\"</span></span> override <span class="hljs-type"><span class="hljs-type">CFLAGS</span></span> += <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_CFLAGS</span></span>) override <span class="hljs-type"><span class="hljs-type">LIBS</span></span> += <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">VLC_PLUGIN_LIBS</span></span>) <span class="hljs-type"><span class="hljs-type">SUFFIX</span></span> := so ifeq (<span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">OS</span></span>),<span class="hljs-type"><span class="hljs-type">Windows_NT</span></span>) <span class="hljs-type"><span class="hljs-type">SUFFIX</span></span> := dll endif all: libhello_plugin.<span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">SUFFIX</span></span>) install: all mkdir -p -- <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">DESTDIR</span></span>)<span class="hljs-string"><span class="hljs-string">$(</span></span>plugindir) <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">INSTALL</span></span>) --mode <span class="hljs-number"><span class="hljs-number">0755</span></span> libhello_plugin.<span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">SUFFIX</span></span>) <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">DESTDIR</span></span>)<span class="hljs-string"><span class="hljs-string">$(</span></span>plugindir) install-strip: <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">MAKE</span></span>) install <span class="hljs-type"><span class="hljs-type">INSTALL</span></span>=<span class="hljs-comment"><span class="hljs-comment">"$(INSTALL) -s"</span></span> uninstall: rm -f <span class="hljs-string"><span class="hljs-string">$(</span></span>plugindir)/libhello_plugin.<span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">SUFFIX</span></span>) clean: rm -f -- libhello_plugin.<span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">SUFFIX</span></span>) src/*.o mostlyclean: clean <span class="hljs-type"><span class="hljs-type">SOURCES</span></span> = hello.c <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">SOURCES</span></span>:%.c=src/%.o): <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">SOURCES</span></span>:%.c=src/%.c) libhello_plugin.<span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">SUFFIX</span></span>): <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">SOURCES</span></span>:%.c=src/%.o) <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">CC</span></span>) <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">LDFLAGS</span></span>) -shared -o <span class="hljs-string"><span class="hljs-string">$@</span></span> <span class="hljs-string"><span class="hljs-string">$^</span></span> <span class="hljs-string"><span class="hljs-string">$(</span></span><span class="hljs-type"><span class="hljs-type">LIBS</span></span>) .<span class="hljs-type"><span class="hljs-type">PHONY</span></span>: all install install-strip uninstall clean mostlyclean</code> </pre></div></div><br> 由于MSYS2对VLC的sdk一无所知，因此在构建之前，有必要将该sdk中<b>pkgconfig</b>文件夹的路径添加到<b>PKG_CONFIG_PATH</b>环境<b>变量中</b> 。 打开MinGW控制台（ <i>C：\ msys64 \ mingw64.exec</i> ）并执行以下命令： <br><br><pre> <code class="plaintext hljs">export PKG_CONFIG_PATH=/c/projects/vlc-3.0.8/sdk/lib/pkgconfig:$PKG_CONFIG_PATH make install</code> </pre> <br> 要测试插件，请同时从控制台运行VLC： <br><br><pre> <code class="plaintext hljs">/c/projects/vlc-3.0.8/vlc</code> </pre> <br> 与Linux一样，转到设置并打开我们的插件。 我们保存设置并重新启动VLC。 <br><br><h1> 插件实现 </h1><br> 要实现我的插件，我需要了解如何控制媒体播放器（更改音轨，倒带）以及如何处理键盘按键事件。 为了理解所有这些，我转向了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文档</a> 。 同样在Internet上，我发现了一些有趣的文章，它们阐明了媒体播放器<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://web.archive.org/web/20141204234622/">的体系结构：VLC媒体框架的体系结构</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">VLC媒体播放器API文档</a> 。 <br><br>  VLC包含大量独立模块（400+）。 每个模块都应提供有关其实现的功能类型以及初始化/完成功能的信息。 使用<b>set_capability（）</b>和<b>set_callbacks（）</b>宏在<b>vlc_module_begin（）</b> - <b>vlc_module_end（）</b>块中描述了此信息。 模块的初始化/完成函数（通常称为<b>Open</b>和<b>Close</b> ）具有以下签名： <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Open</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">vlc_object_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Close</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">vlc_object_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *)</span></span></span></span></code> </pre> <br>  <b>vlc_object_t</b>是在VLC中表示数据的基本类型，所有其他数据都将继承自该类型（请参阅文章<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Object_Management</a> ）。 必须根据模块实现的功能将指向<b>vlc_object_t</b>的指针转换为特定的数据类型。 为了控制媒体播放器，我在<b>set_capability（）</b>宏中<b>设置了</b> <b><i>接口</i></b>值。 因此，在<b>打开</b>和<b>关闭</b>函数中，我需要将<b>vlc_object_t强制转换</b>为<b>intf_thread_t</b> 。 <br><br> 模块之间的交互基于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">观察者</a>设计模式。  VLC提供了一种<i>“对象变量”</i>机制（请参见<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Variables</a> ），您可以使用该机制将变量添加到<b>vlc_object_t</b>类型及其实例的实例中。 模块可以通过这些变量交换数据。 您还可以将回调函数附加到该变量，该变量的值更改时将调用该函数。 <br><br> 例如，考虑负责处理热键事件的<b>热键</b>模块（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">modules / control / hotkeys.c</a> ）。 在Open函数中， <b>ActionEvent</b>回调函数挂在<b>key-action</b> <b>变量上</b> ： <br><br><pre> <code class="cpp hljs">var_AddCallback( p_intf-&gt;obj.libvlc, <span class="hljs-string"><span class="hljs-string">"key-action"</span></span>, ActionEvent, p_intf );</code> </pre> <br> 指向<b>vlc_object_t</b>的指针，变量名，回调函数和指向void的指针传递给<b>var_AddCallback</b>函数以传递任意数据，然后将其转发给指定的回调函数。 回调函数的签名如下所示。 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ActionEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">vlc_object_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">vlc_value_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">vlc_value_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *)</span></span></span></span></code> </pre> <br> 指向<b>vlc_object_t</b>的指针，变量名称，该变量的旧值和新值（在这种情况下，是该操作对应的按下的热键组合的标识符）以及添加回调函数时指定的任何其他数据的指针，将传递给回调函数。 <br><br> 热键事件的直接处理在<b>PutAction</b>函数中执行，该函数在<b>ActionEvent</b>回调函数中调用。  <b>PutAction</b>函数接受按下热键组合（ <b>i_action</b> ）的事件的标识符，并在切换操作符的帮助下执行相应的动作。 <br><br> 例如，倒带事件对应于<b><code>ACTIONID_JUMP_BACKWARD_SHORT</code></b> 。 要执行相应的操作，请从VLC设置（从变量<b>short-jump-size</b> ）获取倒带间隔： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">mtime_t</span></span> it = var_InheritInteger( p_input, varname );</code> </pre> <br> 要倒带正在播放的文件，只需将<b>time-offset</b>变量设置为与您要转换播放的时间对应的值（以微秒为单位）： <br><br><pre> <code class="cpp hljs">var_SetInteger( p_input, <span class="hljs-string"><span class="hljs-string">"time-offset"</span></span>, it * sign * CLOCK_FREQ );</code> </pre> <br> 对于快进，您需要指定一个正值，对于快退，则需要指定-负值。  <b>CLOCK_FREQ常数</b>用于将秒转换为微秒。 <br><br> 同样，音轨也会发生变化（ <b><code>ACTIONID_AUDIO_TRACK</code></b>事件）。 只有负责音轨的<b>audio-es</b>变量才能接受有限的一组值（根据正在播放的文件中可用的音轨）。 您可以使用<b>var_Change（）</b>函数获取变量的可能值的列表： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">vlc_value_t</span></span> <span class="hljs-built_in"><span class="hljs-built_in">list</span></span>, list2; var_Change( p_input, <span class="hljs-string"><span class="hljs-string">"audio-es"</span></span>, VLC_VAR_GETCHOICES, &amp;<span class="hljs-built_in"><span class="hljs-built_in">list</span></span>, &amp;list2 );</code> </pre> <br> 除了值列表之外，此功能还允许您获取这些值的描述列表（在本例中为音轨的名称）。 现在我们可以使用<b>var_Set（）</b>函数更改音轨： <br><br><pre> <code class="cpp hljs">var_Set( p_input, <span class="hljs-string"><span class="hljs-string">"audio-es"</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">list</span></span>.p_list-&gt;p_values[i] );</code> </pre> <br> 弄清楚如何管理媒体播放器，还有待学习如何处理键盘事件。 不幸的是，我无法添加新的热键。 所有热键都硬编码在VLC内核代码（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">src / misc / actions.c</a> ）中。 因此，我为低级键盘按键事件添加了一个处理程序，挂起了我的回调函数来更改<b>按键</b>变量： <br><br><pre> <code class="cpp hljs">var_AddCallback( p_intf-&gt;obj.libvlc, <span class="hljs-string"><span class="hljs-string">"key-pressed"</span></span>, KeyboardEvent, p_intf );</code> </pre> <br>  <b>按下按键的</b>变量存储与最后按下的按键相对应的字符代码（Unicode）。 例如，当您按下带有数字<b>“ 1”</b>的<b>按键时，按键</b>变量将被分配值为<b><i>49</i></b> （在第16个数字系统中为0x00000031）。 您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">unicode-table.com上</a>查看其他字符代码。 此外， <b>按键</b>变量的值考虑了修改键的按下，为它们分配了第四个有效字节。 因此，例如，当按下“ <b>Ctrl + 1</b> ”组合<b>键时，按键</b>变量将被赋予值0x <b>04</b> 000031（00000 <b>1</b> 00 00000000 00000000 00110001 <sub>2</sub> ）。 为了清楚起见，下表显示了各种组合键的含义： <br><div class="scrollable-table"><table><tbody><tr><th> 键盘快捷键 </th><th> 价值 </th></tr><tr><td>  Ctrl + 1 </td><td>  00000 <b>1</b> 00 00000000 00000000 00110001 <sub>2</sub> </td></tr><tr><td>  Alt + 1 </td><td>  0000000 <b>1</b> 00000000 00000000 00110001 <sub>2</sub> </td></tr><tr><td>  Ctrl + Alt + 1 </td><td>  00000 <b>1</b> 0 <b>1</b> 00000000 00000000 00110001 <sub>2</sub> </td></tr><tr><td>  Shift + 1 </td><td>  000000 <b>1</b> 0 00000000 00000000 <b>00100001</b> <sub>2</sub> </td></tr></tbody></table></div> 按下“ <b>Shift + 1</b> ”组合<b>键</b>时请注意该值。 由于在这种情况下，“ <b>！</b>  “，那么第一个字节的值将对应于Unicode（0x00000021）中此字符的代码。 <br><br><h1> 结果 </h1><br> 我将我的<b>TIP</b>插件称为“请翻译”的缩写，也可以将提示翻译为“提示”。 该插件的源代码发布在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub上</a> ，您还可以在其中下载适用于Windows和Linux的现成插件程序集。 <br><br> 要安装插件，您需要将文件<b>libtip_plugin.dll</b> （对于Linux为libtip_plugin.so）复制到<i>&lt;path-to-vlc&gt; / plugins</i>文件夹。 在Windows上，VLC通常安装在<i>C：\ Program Files \ VideoLAN \ VLC</i>文件夹中。 在Linux上，可以使用以下命令找到安装文件夹： <br><br><pre> <code class="plaintext hljs">whereis vlc</code> </pre> <br> 例如，在Ubuntu中，VLC安装在<i>/ usr / lib / x86_64-linux-gnu / vlc中</i> 。 <br><br> 接下来，您将需要重新启动VLC，然后在主菜单中打开`` <b>工具''</b> &gt; <b>``首选项''</b> ，切换到高级视图（在<b>``显示设置''</b>组中选择<b>`</b> ` <b>全部''</b> ），转到左侧面板的<b>``</b> <b>界面''</b> &gt; <b>`</b> <b>`</b> <b>控制''</b>部分，然后选中<b>``提示''</b>旁边的框<b>（请翻译）</b> 。 然后再次需要重新启动VLC。 <br><br> <a href=""><img src="https://habrastorage.org/webt/df/06/qk/df06qkcl2vbiatwq7j_8uw4m_ey.png"></a> <br><br> 在插件设置中，您可以指定主要和辅助（用于翻译）音轨的编号，以及插件倒带与辅助音轨重复播放的时间（以秒为单位）。 <br><br> <a href=""><img src="https://habrastorage.org/webt/mv/9-/vu/mv9-vuo9mfzicqyiqpsopnevrpu.png"></a> <br><br> 为了控制插件，我添加了以下键盘快捷键： <br><br><ul><li>  “ <b>/</b> ”用于翻译 </li><li>  “ <b>Shift + /</b> ”重复以前翻译的视频片段和主要音轨 </li></ul><br> 在执行翻译和重试命令期间，该插件分别在左上角显示消息<i>“提示：翻译”</i>和<i>“提示：重复”</i> 。 <br><br><img src="https://habrastorage.org/webt/4z/bu/1p/4zbu1p5mwskebq8vpbiny_oayr4.png"><br><br> 根据我使用插件的经验，我可以说总体上我对结果感到满意。 最主要的是选择正确的内容，如果至少能理解那里使用的外国语音的一半，则该插件将有助于翻译其余内容。 否则，该插件将可能无用。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN475992/">https://habr.com/ru/post/zh-CN475992/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN475980/index.html">低连通性，架构和团队组织</a></li>
<li><a href="../zh-CN475982/index.html">如何学习外语</a></li>
<li><a href="../zh-CN475986/index.html">PocketBook 740 Pro阅读器概述：7.8英寸，音频和IPX8保护</a></li>
<li><a href="../zh-CN475988/index.html">ML.NET模型构建器更新</a></li>
<li><a href="../zh-CN475990/index.html">使用Pulumi和.NET Core构建现代云应用程序</a></li>
<li><a href="../zh-CN475994/index.html">Cool WSL（Linux的Windows子系统）提示和技巧</a></li>
<li><a href="../zh-CN475996/index.html">将Quartz添加到Spring Boot</a></li>
<li><a href="../zh-CN475998/index.html">RPA在科学和工程计算中的应用</a></li>
<li><a href="../zh-CN476000/index.html">ML.NET模型构建器更新</a></li>
<li><a href="../zh-CN476002/index.html">在德国找到博士生职位的经验</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>