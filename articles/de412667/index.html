<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>„ÄΩÔ∏è üö∂üèΩ üõ¢Ô∏è Cybergroup Turla verwendet Metasploit in der Moskitokampagne ü§¥ ‚ùáÔ∏è üßì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Turla ist eine bekannte Cyber-Spionagegruppe, die seit mindestens zehn Jahren t√§tig ist. Die erste Erw√§hnung der Gruppe stammt aus dem Jahr 2008 und s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cybergroup Turla verwendet Metasploit in der Moskitokampagne</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/412667/"> Turla ist eine bekannte Cyber-Spionagegruppe, die seit mindestens zehn Jahren t√§tig ist.  Die erste Erw√§hnung der Gruppe stammt aus dem Jahr 2008 und steht im Zusammenhang mit dem Hack <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">des US-Verteidigungsministeriums</a> .  In der Folge wurden Turla zahlreiche Vorf√§lle im Bereich der Informationssicherheit zugeschrieben - Angriffe auf Regierungs- und strategische Industrien, einschlie√ülich der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Verteidigungsindustrie</a> . <br><br><img src="https://habrastorage.org/webt/ap/0v/ol/ap0vol968enwh-o3wzpmde0pily.jpeg"><br><br>  Im Januar 2018 ver√∂ffentlichten wir den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ersten Bericht</a> √ºber die neue Turla Mosquito Backdoor-Vertriebskampagne und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Infektionsindikatoren</a> .  Die Kampagne ist noch aktiv.  Angreifer √§nderten die Taktik, um nicht entdeckt zu werden. <br><br>  Seit M√§rz 2018 haben wir bedeutende √Ñnderungen in dieser Kampagne gesehen - jetzt verwendet Turla das Open-Source-Metasploit-Framework, um Mosquito zu vertreiben.  Dies ist nicht das erste Mal, dass Turla seine eigenen Tools aufgibt. Zuvor wurden Dienstprogramme zum Extrahieren von Anmeldeinformationen verwendet (Mimikatz).  Bemerkenswert ist jedoch, dass Turla Metasploit zum ersten Mal als Hintert√ºr f√ºr die erste Phase des Angriffs anstelle seiner Entwicklungen wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skipper verwendet</a> . <br><br><a name="habracut"></a><h3>  Verteilung </h3><br>  Wie in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">fr√ºheren Bericht beschrieben</a> , ist der Infektionsvektor f√ºr das Zielger√§t in der aktuellen Turla-Kampagne ein gef√§lschtes Installationsprogramm, das eine der Hintert√ºren der Gruppe zusammen mit dem legitimen Adobe Flash Player herunterl√§dt.  Vorrangige Ziele sind Konsulate und Botschaften der osteurop√§ischen L√§nder. <br><br>  Ein Kompromiss tritt auf, wenn ein Benutzer das Flash-Installationsprogramm von get.adobe.com √ºber HTTP herunterl√§dt.  Der Datenverkehr wird zwischen dem Endger√§t und den Adobe-Servern abgefangen, sodass Turla-Betreiber die legitime Datei durch eine trojanisierte Version ersetzen k√∂nnen.  Die folgende Abbildung zeigt die Punkte, an denen es <b>theoretisch</b> m√∂glich ist, den Verkehr abzufangen.  <b>Bitte beachten Sie, dass das f√ºnfte Szenario - die Gef√§hrdung von Adobe / Akamai - ausgeschlossen ist.</b>  <b>Angreifer verwendeten die Marke Adobe nur, um Benutzer zu t√§uschen.</b> <br><br><img src="https://habrastorage.org/webt/nf/m7/1e/nfm71ehwwthy_sowqybn2xmnpbg.png"><br><br>  Wir haben keinen <code>flashplayer28_xa_install.exe</code> Datenverkehr festgelegt, aber eine neue ausf√ºhrbare Datei gefunden, die ein legitimes Flash-Installationsprogramm namens <code>flashplayer28_xa_install.exe</code> .  Daher wird die urspr√ºngliche Kompromissmethode immer noch verwendet. <br><br><h3>  Analyse </h3><br>  Anfang M√§rz 2018 stellten wir im Rahmen der Turla-Aktivit√§ten zur Verfolgung von Aktivit√§ten √Ñnderungen in der Moskito-Vertriebskampagne fest.  Trotz der Tatsache, dass die Gruppe keine innovativen Tools verwendet, ist dies eine wesentliche √Ñnderung ihrer Taktiken, Techniken und Verfahren (TTR). <br><br>  Zuvor enthielt die Kompromisskette ein gef√§lschtes Flash-Installationsprogramm, das den Bootloader und die Haupt-Backdoor zur√ºcksetzte (siehe Abbildung unten). <br><br><img src="https://habrastorage.org/webt/pn/3p/jf/pn3pjfskupo5civ_zdc_rsrsxg4.png"><br><br>  K√ºrzlich haben wir gesehen, dass sich die Art und Weise, die letzte Hintert√ºr zur√ºckzusetzen, ge√§ndert hat.  Das gef√§lschte Installationsprogramm von Flash ist weiterhin an der Kampagne beteiligt. Anstatt zwei sch√§dliche DLLs direkt zu l√∂schen, f√ºhrt es den Metasploit-Shellcode aus und setzt ein legitimes Installationsprogramm von Google Drive zur√ºck oder l√§dt es herunter.  Der Shellcode l√§dt dann Meterpreter, eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">typische Metasploit-Nutzlast</a> , indem ein Angreifer dem Zugriff auf ein gef√§hrdetes System ausgesetzt wird.  Schlie√ülich wird eine Moskito-Hintert√ºr auf der Workstation installiert.  Das neue Schema ist in der folgenden Abbildung dargestellt. <br><br><img src="https://habrastorage.org/webt/3b/wq/lb/3bwqlbedx5jju5brj7kssskdz0a.png"><br><br>  Im Zusammenhang mit der Verwendung von Metasploit k√∂nnen wir davon ausgehen, dass der Bediener den Prozess manuell steuert.  Die Dauer des Angriffs ist relativ kurz - die letzte Hintert√ºr wurde innerhalb von 30 Minuten nach Beginn des Kompromissversuchs zur√ºckgesetzt. <br><br>  Der verwendete Shellcode ist typisch f√ºr Metasploit.  Es wird durch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Encoder shikata_ga_nai</a> mit sieben Iterationen gesch√ºtzt.  Die folgenden Screenshots zeigen die verschl√ºsselten und entschl√ºsselten Nutzdaten. <br><br><img src="https://habrastorage.org/webt/1o/mi/bq/1omibquibw80gy63_0ycbiw8ing.png"><br><br><img src="https://habrastorage.org/webt/b0/et/l0/b0etl0zvxhzpqaho624c2lebvui.png"><br><br>  Nach der Entschl√ºsselung kommuniziert der Shellcode unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">209.239.115</a> [.] 91 / 6OHEJ mit dem C &amp; C-Server, der das Laden von zus√§tzlichem Shellcode steuert.  Laut ESET-Telemetrie besteht der n√§chste Schritt darin, Meterpreter zu laden.  Diese IP-Adresse entspricht der Psychologie-blog.ezua [.] Com-Domain, die seit Oktober 2017 in der Moskito-Kampagne verwendet wird. <br><br>  Als N√§chstes l√§dt das gef√§lschte Flash-Installationsprogramm das legitime Adobe-Installationsprogramm von einer Google Drive-URL herunter und f√ºhrt es aus, damit der Benutzer nichts ahnt. <br><br><h3>  Zus√§tzliche Werkzeuge </h3><br>  Zus√§tzlich zum neuen gef√§lschten Installationsprogramm und Meterpreter haben wir festgestellt, dass Turla zus√§tzliche Tools verwendet: <br><br><ul><li>  Eine benutzerdefinierte ausf√ºhrbare Datei, die nur den Metasploit-Shellcode enth√§lt.  Wird verwendet, um den Zugriff auf eine Meterpreter-Sitzung aufrechtzuerhalten.  Gespeichert in <pre>  C: \ Benutzer \ &lt;Benutzername&gt; \ AppData \ Roaming \ Microsoft \ Windows \ Startmen√º \ Programme \ Startup \ msupdateconf.exe </pre>  das sorgt f√ºr Ausdauer. </li><li>  Eine weitere benutzerdefinierte ausf√ºhrbare Datei zum Ausf√ºhren von PowerShell-Skripten. </li><li>  Moskito-JScript-Backdoor mit Google Apps Script als C &amp; C-Server. </li><li>  Eskalation von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Berechtigungen</a> mithilfe des Metasploit-Moduls <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ext_server_priv.x86.dll</a> . </li></ul><br><h3>  Schlussfolgerungen </h3><br>  Der Beitrag beschreibt die Entwicklung der Turla Mosquito-Vertriebskampagne in den letzten Monaten.  Die wichtigste √Ñnderung ist die Verwendung von Metasploit, einem beliebten Penetrationstest-Framework, als ersten Schritt in der benutzerdefinierten Moskito-Hintert√ºr. <br><br><h3>  Kompromissindikatoren </h3><br><img src="https://habrastorage.org/webt/z5/0b/nm/z50bnmvydvbo9msk392rv6z47p8.png"><br><br>  C &amp; C. <br><br>  ‚Ä¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">209.239.115</a> [.] 91 / 6OHEJ <br>  ‚Ä¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">70.32.39</a> [.] 219 / n2DE3 <br><br>  Link zu einem legitimen Flash-Installationsprogramm <br><br>  ‚Ä¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">drive.google</a> [.] Com / uc? Authuser = 0 &amp; id = 1s4kyrwa7gCH8I5Z1EU1IZ_JaR48A7UeP &amp; export = download </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de412667/">https://habr.com/ru/post/de412667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de412655/index.html">Multi-Signed Wallet Hierarchy (Vertrauenssystem)</a></li>
<li><a href="../de412657/index.html">Versorger-Token oder Aktien: Was wird die Zukunft von ICO sein?</a></li>
<li><a href="../de412661/index.html">Englisch f√ºr die Arbeit auf einem ausl√§ndischen Markt: Wor√ºber Lehrb√ºcher nicht sprechen</a></li>
<li><a href="../de412663/index.html">AI verkauft Pizza oder wie Voximplant sich mit Dialogflow anfreundet</a></li>
<li><a href="../de412665/index.html">Wochenplan-Editor</a></li>
<li><a href="../de412669/index.html">Zeitmanagement ist nicht be√§ngstigend: wie man mehr macht</a></li>
<li><a href="../de412671/index.html">BLE-Konsole: Eine v√∂llig neue Art der Interaktion mit BLE-Ger√§ten</a></li>
<li><a href="../de412675/index.html">Multisig-Vertr√§ge und -Adressen in Bitcoin und Ethereum</a></li>
<li><a href="../de412677/index.html">R√ºckverfolgbarkeitsmatrix</a></li>
<li><a href="../de412679/index.html">Erstellen einer Android-Anwendung zur Texterkennung in 10 Minuten. Mobile Vision CodeLab</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>