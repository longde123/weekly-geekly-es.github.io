<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤶🏽 💪 🥨 Kettenreplikation: Aufbau eines effizienten KV-Repositorys (Teil 2/2) 🏂 👴🏻 🐢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir betrachten weiterhin Beispiele für die Verwendung der Kettenreplikation. Grundlegende Definitionen und Architekturen wurden im ersten Teil angegeb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kettenreplikation: Aufbau eines effizienten KV-Repositorys (Teil 2/2)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432020/"><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/ou/4j/jl/ou4jjlsyjknckeriwguidrfcqqs.jpeg"></div><br>  Wir betrachten weiterhin Beispiele für die Verwendung der Kettenreplikation.  Grundlegende Definitionen und Architekturen wurden im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ersten Teil angegeben</a> . Ich empfehle, dass Sie sich damit vertraut machen, bevor Sie den zweiten Teil lesen. <br><a name="habracut"></a><br>  In diesem Artikel werden wir die folgenden Systeme untersuchen: <br><br><ul><li>  Hibari ist ein verteiltes fehlertolerantes Repository, das in erlang geschrieben wurde. </li><li>  HyperDex - verteilter Schlüsselwertspeicher mit Unterstützung für die schnelle Suche nach sekundären Attributen und die Bereichssuche. </li><li>  ChainReaction - Kausal + Konsistenz und Geo-Replikation. </li><li>  Aufbau eines verteilten Systems ohne zusätzliche externe Überwachungs- / Rekonfigurationsprozesse. </li></ul><br><h1>  5. Hibari </h1><br>  Hibari ist ein verteiltes fehlertolerantes KV-Repository, das in erlang geschrieben wurde.  Verwendet die Kettenreplikation (grundlegender Ansatz), d.h.  erreicht strenge Konsistenz.  In Tests zeigt Hibari eine hohe Leistung - mehrere tausend Updates pro Sekunde werden auf Servern mit zwei Einheiten (1-KB-Anforderungen) erzielt. <br><br><h3>  5.1 Architektur </h3><br>  Konsistentes Hashing wird zum Platzieren von Daten verwendet.  Die Basis der Speicherung sind physische und logische Blöcke.  Der <i>physische Baustein</i> ist ein Server mit Linux, möglicherweise eine EC2-Instanz und im Allgemeinen die VM als Ganzes.  Ein <i>logischer</i> Baustein ist eine Speicherinstanz, mit der die Hauptprozesse des Clusters arbeiten, und jeder Block ist ein Knoten in <b>einer</b> Kette.  Im folgenden Beispiel ist der Cluster mit 2 logischen Blöcken auf jedem physischen Block und einer Kettenlänge von 2 konfiguriert. Beachten Sie, dass die Knoten der Kette über den physischen Blöcken „verschmiert“ sind, um die Zuverlässigkeit zu erhöhen. <br><br>  Der Master-Prozess (siehe Definition im ersten Teil) wird als <i>Admin-Server bezeichnet</i> . <br><br>  Daten werden in „Tabellen“ gespeichert, die einfach in Namespaces unterteilt sind, jede Tabelle wird in mindestens einer Kette gespeichert und jede Kette speichert Daten in nur einer Tabelle. <br><br>  Der Hibari-Client erhält vom Admin-Server Aktualisierungen mit einer Liste aller Kopf- und Endpunkte aller Ketten (und aller Tabellen).  Somit wissen Kunden sofort, an welchen logischen Knoten die Anforderung gesendet werden soll. <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/k1/nh/yg/k1nhygstpeqkgzv5vyuwwsjoffm.png"></div><br><br><h3>  5.2 Hashing </h3><br>  Hibari benutzt ein Paar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="noError" id="MJXp-Span-2" style="display: inline-block;">\&nbsp;{T,&nbsp;K&nbsp;\}</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><span class="noError" style="display: inline-block;">\&nbsp;{T,&nbsp;K&nbsp;\}</span></span><script type="math/tex" id="MathJax-Element-1"> \ {T, K \} </script>  um den Namen der Kette zu bestimmen, in der der Schlüssel gespeichert ist <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">K</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMATHI-4B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> K </script>  in der Tabelle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.057ex" viewBox="0 -780.1 704.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMATHI-54" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> T </script>  : Schlüssel <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">K</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMATHI-4B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> K </script>  dem Intervall zugeordnet <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-11">0.1</span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-13">1.0</span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.529ex" height="2.66ex" viewBox="0 -832 3672.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-31" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-2C" x="1558" y="0"></use><g transform="translate(2003,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-30" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-29" x="3282" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> [0.1, 1.0) </script>  (unter Verwendung von MD5), das in Abschnitte unterteilt ist, für die eine Kette verantwortlich ist.  Die Abschnitte können je nach "Gewicht" der Kette unterschiedlich breit sein, zum Beispiel: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kt/hy/hq/kthyhqgqi5bn5xthknmw4f5sjou.png"></div><br><br>  Wenn also einige physische Blöcke sehr mächtig sind, können die darauf befindlichen Ketten breitere Abschnitte erhalten (dann fallen mehr Schlüssel auf sie). <br><br><h1>  6. HyperDex </h1><br>  Ziel dieses Projekts war es, ein verteiltes Schlüsselwert-Repository zu erstellen, das im Gegensatz zu anderen gängigen Lösungen (BigTable, Cassandra, Dynamo) eine schnelle Suche nach sekundären Attributen unterstützt und schnell eine Bereichssuche durchführen kann.  Um beispielsweise in den zuvor betrachteten Systemen nach allen Werten in einem bestimmten Bereich zu suchen, müssen Sie alle Server durchlaufen, was natürlich nicht akzeptabel ist.  HyperDex löst dieses Problem mithilfe von <i>Hyperspace Hashing</i> . <br><br><h3>  6.1 Architektur </h3><br>  Die Idee des Hyperraum-Hashing ist zu bauen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> n </script>  -dimensionaler Raum, in dem jedes Attribut einer Koordinatenachse entspricht.  Beispielsweise kann für Objekte (Vorname, Nachname, Telefonnummer) das Leerzeichen folgendermaßen aussehen: <br><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/zf/be/hu/zfbehu3mpmbsb1bwdfpofn_xywa.png"></div><br><br>  Die graue Hyperebene durchläuft alle Schlüssel, wobei Nachname = Smith, gelb - über alle Schlüssel, wobei Vorname = John.  Der Schnittpunkt dieser Ebenen bildet eine Antwort auf die Telefonnummern der Suchanfragen von Personen mit dem Namen John und dem Nachnamen Smith.  Also die Anfrage nach <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMATHI-6B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> k </script>  Attribute gibt zurück <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">n</span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">k</span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.256ex" height="2.66ex" viewBox="0 -832 3123.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMATHI-6E" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-2212" x="1212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMATHI-6B" x="2212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-29" x="2734" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> (n-k) </script>  -dimensionaler Unterraum. <br><br>  Der Suchraum ist unterteilt in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> n </script>  -dimensionale disjunkte Regionen, und jede Region ist einem einzelnen Server zugeordnet.  Ein Objekt mit Koordinaten aus einer Region wird auf dem Server dieser Region gespeichert.  Somit wird ein Hash zwischen Objekten und Servern erstellt. <br><br>  Eine Suchabfrage (nach Bereich) bestimmt die Regionen, die in der resultierenden Hyperebene enthalten sind, und reduziert somit die Anzahl der abgefragten Server auf ein Minimum. <br><br>  Bei diesem Ansatz gibt es ein Problem: Die Anzahl der erforderlichen Server wächst exponentiell von der Anzahl der Attribute, d. H.  wenn Attribute <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMATHI-6B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> k </script>  dann brauchst du <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">O</span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-32"><span class="MJXp-mn" id="MJXp-Span-33" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-34" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.834ex" height="3.021ex" viewBox="0 -987.6 2511.8 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-28" x="763" y="0"></use><g transform="translate(1153,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-32" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMATHI-6B" x="707" y="557"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhgN4LKvXwKe-NgX3z5EobWff1vW6Q#MJMAIN-29" x="2122" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> O (2 ^ k) </script>  Server.  Um dieses Problem zu lösen, wendet HyperDex eine Partition des Hyperraums in Unterräume (mit einer niedrigeren Dimension) mit jeweils einer Teilmenge von Attributen an: <br><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/s1/nf/tk/s1nftktukf2qd4e9ljjuzsgj_b0.png"></div><br><h3>  6.2 Replikation </h3><br>  Um eine strikte Konsistenz zu gewährleisten, entwickelten die Autoren einen speziellen Ansatz, der auf einer kettenreplikationswertabhängigen <i>Verkettung</i> basiert, wobei jeder nachfolgende Knoten durch Hashing des entsprechenden Attributs bestimmt wird.  Zum Beispiel der Schlüssel <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-36"><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0.333em; margin-right: 0.333em;">"</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">J</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">n</span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0.333em; margin-right: 0.333em;">"</span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.333em; margin-right: 0.333em;">"</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">h</span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0.333em; margin-right: 0.333em;">"</span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> ("John", "Smith") </script>  Zuerst wird es in den Schlüsselraum gehasht (wir erhalten die Kopfkette, auch <i>Punktführer genannt</i> ), dann den Hash von <math> </math> $ inline $ "John" $ inline $   auf die Koordinate auf der entsprechenden Achse und so weiter.  (Ein Beispiel für ein Update finden Sie in der Abbildung unten. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-60"><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-63" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> u_1 </script>  ) <br><br>  Alle Aktualisierungen durchlaufen einen Punkteführer, der Anforderungen anordnet (Linearisierbarkeit). <br><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/qp/ab/z4/qpabz4f0rpxaybrtt5pzhegrrqk.png"></div><br><br>  Wenn das Update zu einer Änderung in der Region führt, wird zuerst die neue Version unmittelbar nach der alten geschrieben (siehe Update <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-64"><span class="MJXp-msubsup" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> u_2 </script>  ), und nach dem Empfang der ACK von tail wird der Link zur alten Version vom vorherigen Server geändert.  Zu gleichzeitigen Anforderungen (z. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-msubsup" id="MJXp-Span-69"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-71" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> u_2 </script>  und <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-msubsup" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-75" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> u_3 </script>  ) hat nicht gegen den Konsistenzpunkt-Leader verstoßen. Wenn er empfangen wird, werden dem Server Versionsverwaltung und andere Metainformationen hinzugefügt <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-msubsup" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-79" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> u_3 </script>  vorher <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-msubsup" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-83" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> u_2 </script>  könnte feststellen, dass die Bestellung fehlerhaft ist und Sie warten müssen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-msubsup" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-87" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> u_2 </script>  . <br><br><h1>  7. Kettenreaktion </h1><br>  Es wird ein Kausal + Konvergenz-Modell verwendet, das die Bedingung für konfliktfreie Konvergenz zur kausalen (kausalen) Konvergenz hinzufügt.  Um die kausale Konvergenz zu gewährleisten, werden jeder Anforderung Metadaten hinzugefügt, die die Versionen aller kausal abhängigen Schlüssel angeben.  ChainReaction ermöglicht die Georeplikation in mehreren Rechenzentren und ist eine Weiterentwicklung der CRAQ-Idee. <br><br><h3>  7.1 Architektur </h3><br>  Die Architektur von FAWN wird mit geringfügigen Änderungen verwendet - jeder DC besteht aus <i>Datenservern</i> - Backends (Datenspeicherung, Replikation, Bildung eines DHT-Rings) und <i>Client-Proxys</i> - Frontends (Senden einer Anforderung an einen bestimmten Knoten).  Jeder Schlüssel wird auf R aufeinanderfolgende Knoten repliziert und bildet eine Kette.  Leseanforderungen werden vom Ende und Schreiben vom Kopf verarbeitet. <br><br><div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/xz/lv/ei/xzlveipiopeqi4enyao1b_fuehw.png"></div><br><h3>  7.2 Ein Rechenzentrum </h3><br>  Wir stellen eine wichtige Eigenschaft fest, die sich aus der Kettenreplikation ergibt - wenn der Knoten <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-88"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> k </script>  kausal konsistent mit einigen Client-Operationen, dann auch mit allen vorherigen Knoten.  Also wenn die Operation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-90"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> Op </script>  wurde zuletzt von uns auf der Seite gesehen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-93"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">j</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> j </script>  , dann alle kausalabhängig (von <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> Op </script>  ) Leseoperationen können nur an Knoten von Kopf bis ausgeführt werden <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">j</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> j </script>  .  Sobald <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> Op </script>  wird am Ende ausgeführt - es gibt keine Leseeinschränkungen.  Bezeichnen Sie die Schreibvorgänge, die von tail im DC ausgeführt wurden <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> d </script>  wie <b>DC-Write-Stable (d)</b> . <br><br>  Jeder Client speichert eine Liste (Metadaten) aller vom Client angeforderten Schlüssel im Format (Schlüssel, Version, chainIndex), wobei chainIndex die Position des Knotens in der Kette ist, der die letzte Anforderung für den Schlüsselschlüssel beantwortet hat.  <b>Metadaten werden nur für Schlüssel gespeichert, von denen der Client nicht weiß, ob sie DC-Write-Stable (d) sind oder nicht</b> . <br><br><h4>  7.2.1 Schreibvorgang </h4><br>  Beachten Sie, dass keine Leseanforderung frühere Versionen lesen kann, sobald die Operation DC-Write-Stable (d) geworden ist. <br><br>  Für jede Schreibanforderung wird eine Liste aller Schlüssel hinzugefügt, für die Lesevorgänge ausgeführt wurden, bevor der letzte Schreibvorgang ausgeführt wurde.  Sobald der Client-Proxy die Anforderung empfängt, führt er blockierende Lesevorgänge an den Endpunkten aller Schlüssel aus den Metadaten durch (wir warten auf die Bestätigung des Vorhandenseins derselben oder einer neueren Version, dh wir erfüllen die Bedingung der kausalen Konsistenz).  Sobald Bestätigungen eingegangen sind, wird eine Schreibanforderung an den Kopf der entsprechenden Kette gesendet. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l2/qo/k_/l2qok_yldb0_aaqjcfmzj2ap_gk.png"></div><br><br>  Sobald der neue Wert gespeichert ist <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> k </script>  Knoten der Kette wird eine Benachrichtigung an den Client gesendet (mit dem Index des letzten Knotens).  Der Client aktualisiert den chainIndex und entfernt die Metadaten der gesendeten Schlüssel als  es wurde über sie bekannt, dass sie DC-Write-Stable sind (d).  Parallel dazu setzt sich die Aufnahme fort - <i>träge Ausbreitung</i> .  Daher wird dem Schreiben von Operationen am ersten Vorrang eingeräumt <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> k </script>  Knoten.  Sobald Tail die neue Version des Schlüssels speichert, wird eine Benachrichtigung an den Client gesendet und an alle Knoten der Kette gesendet, damit diese den Schlüssel als stabil markieren. <br><br><h4>  7.2.2 Lesevorgang </h4><br>  Der Client-Proxy sendet eine Leseanforderung an <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">x</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">d</span><span class="MJXp-mo" id="MJXp-Span-120" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-121">1</span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">x</span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> index: = rand (1, chainIndex) </script>  Knoten in der Schaltung, während die Last verteilt wird.  Als Antwort sendet der Knoten den Wert und die Version dieses Werts.  Die Antwort wird an den Client gesendet, während: <br><br><ul><li>  Wenn die Version stabil ist, entspricht der neue chainIndex der Größe der Kette. </li><li>  Wenn die Version neuer ist, ist der neue chainIndex = index. </li><li>  Andernfalls ändert sich chainIndex nicht. </li></ul><br><h4>  7.2.3 Knoten-Failover </h4><br>  Es ist fast vollständig identisch mit dem grundlegenden Ansatz, mit einigen Unterschieden in der Tatsache, dass chainIndex auf dem Client in einigen Fällen ungültig wird - dies kann leicht festgestellt werden, wenn Anforderungen ausgeführt werden (es gibt keinen Schlüssel in dieser Version) und die Anforderung wird an den Kopf der Kette umgeleitet, um nach dem Knoten mit der gewünschten Version zu suchen. <br><br><h3>  7.3 Mehrere ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> N </script>  ) Rechenzentren (Geo-Replikation) </h3><br>  Wir verwenden Algorithmen aus einer Single-Server-Architektur als Basis und passen sie auf ein Minimum an.  Für den Anfang benötigen wir in Metadaten anstelle von Versions- und ChainIndex-Werten versionierte Vektoren mit N Dimensionen. <br><br>  Wir definieren Global-Write-Stable auf ähnliche Weise wie DC-Write-Stable (d) - die Schreiboperation wird als Global-Write-Stable betrachtet, wenn sie in allen DCs an Schwänzen ausgeführt wurde. <br><br>  In jedem DC - <i>remote_proxy</i> wird eine neue Komponente <i>angezeigt</i> . Ihre Aufgabe besteht darin, Aktualisierungen von anderen DCs zu empfangen / zu senden. <br><br><h4>  7.3.1 Ausführen eines Schreibvorgangs (auf dem Server) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> i </script>  ) </h4><br>  Der Anfang ähnelt einer Single-Server-Architektur - wir führen blockierende Lesevorgänge durch und schreiben in den ersten <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> k </script>  Knoten einer Kette.  Zu diesem Zeitpunkt sendet der Client-Proxy dem Client einen neuen chainIndex-Vektor, in dem bis auf die Position überall Nullen stehen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> i </script>  - Es gibt eine Bedeutung <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> k </script>  .  Weiter - wie immer.  Eine zusätzliche Operation ganz am Ende - das Update wird an remote_proxy gesendet, das mehrere Anforderungen sammelt und dann alles sendet. <br><br>  Hier treten zwei Probleme auf: <br><br><ul><li>  Wie kann man Abhängigkeiten zwischen verschiedenen Updates von verschiedenen DCs sicherstellen? <br><br>  Jeder remote_proxy speichert einen lokalen Versionsvektor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> rvp </script>  Abmessungen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> N </script>  , speichert die Anzahl der gesendeten und empfangenen Updates und sendet sie in jedem Update.  Wenn also ein Update von einem anderen DC empfangen wird, überprüft remote_proxy die Zähler, und wenn der lokale Zähler kleiner ist, wird die Operation blockiert, bis das entsprechende Update empfangen wird. </li><li>  Wie können Abhängigkeiten für diesen Vorgang in anderen Domänencontrollern bereitgestellt werden? <br><br>  Dies wird mit einem Bloom-Filter erreicht.  Wenn Schreib- / Lesevorgänge vom Client-Proxy ausgeführt werden, wird zusätzlich zu den Metadaten für jeden Schlüssel ein Bloom-Filter gesendet (sogenannte Antwortfilter).  Diese Filter werden in der <i>AccessedObjects-</i> Liste gespeichert. Wenn Sie Schreib- / Lesevorgänge anfordern, senden die Metadaten auch gesendete Schlüssel ODER-Filter (als Abhängigkeitsfilter bezeichnet).  In ähnlicher Weise werden nach dem Schreibvorgang die entsprechenden Filter gelöscht.  Beim Senden einer Schreiboperation an einen anderen DC werden auch ein Abhängigkeitsfilter und ein Antwortfilter für diese Anforderung gesendet. <br><br>  Ferner prüft der entfernte Gleichstrom, nachdem er alle diese Informationen empfangen hat, ob solche Operationen möglicherweise zufällig abhängig sind, wenn die gesetzten Bits des Antwortfilters mit den gesetzten Bits mehrerer Abfragefilter übereinstimmen.  Potenziell - weil ein Blütenfilter. </li></ul><br><h4>  7.3.2 Lesevorgang </h4><br>  Ähnlich wie bei einer Einzelserver-Architektur, angepasst an die Verwendung des chainIndex-Vektors anstelle eines Skalars und die Möglichkeit des Fehlens eines Schlüssels im Domänencontroller (da Aktualisierungen asynchron sind), warten Sie entweder oder leiten Sie die Anforderung an einen anderen Domänencontroller weiter. <br><br><h4>  7.3.3 Konfliktlösung </h4><br>  Dank der Metadaten werden kausalabhängige Operationen immer in der richtigen Reihenfolge ausgeführt (manchmal müssen Sie den Prozess dafür blockieren).  Wettbewerbsänderungen in verschiedenen DCs können jedoch zu Konflikten führen.  Um solche Situationen zu lösen, wird Last Write Wins verwendet, für die in jeder Aktualisierungsoperation ein Paar vorhanden ist <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-150"><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">U</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">r</span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">s</span><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> (Uhr, s) </script>  wo <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">c</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> c </script>  - Stunden auf Proxy und <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> s </script>  - ID von DC. <br><br><h4>  7.3.4 Behandlung von Knotenfehlern </h4><br>  Ähnlich der Single-Server-Architektur. <br><br><h1>  8. Nutzung von Sharding beim Entwurf skalierbarer Replikationsprotokolle </h1><br>  Ziel der Studie ist es, ein verteiltes System mit Shards und Replikation zu erstellen, ohne einen externen Masterprozess zum Neukonfigurieren / Überwachen des Clusters zu verwenden. <br><br>  In den wichtigsten aktuellen Ansätzen sehen die Autoren die folgenden Nachteile: <br><br>  Replikation: <br><br><ul><li>  Primär / Sicherung - führt zu einer Diskrepanz im Status, wenn Primär fälschlicherweise als fehlgeschlagen identifiziert wurde. </li><li>  Quorum Intersection - kann zu einer Statusdiskrepanz während der Cluster-Rekonfiguration führen. </li></ul><br>  Strikte Konsistenz: <br><br><ul><li>  Protokolle basieren bei Bedarf auf Mehrheitsabstimmungsalgorithmen (z. B. Paxos) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-162"><span class="MJXp-mn" id="MJXp-Span-163">2</span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">N</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-167">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> 2 * N + 1 </script>  Knoten fallen lassen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> N </script>  Knoten. </li></ul><br>  Erkennung von Knotenfehlern: <br><br><ul><li>  P / B und CR implizieren das Vorhandensein einer perfekten Erkennung fehlerhafter Knoten mit einem Fail-Stop-Modell, das in der Praxis nicht erreichbar ist und Sie müssen ein geeignetes Scanintervall auswählen. </li><li>  ZooKeeper unterliegt denselben Problemen: Bei einer großen Anzahl von Clients ist eine erhebliche Zeit (&gt; 1 Sekunde) erforderlich, um die Konfiguration zu aktualisieren. </li></ul><br>  Der von den Autoren vorgeschlagene Ansatz, <i>Elastic Replication genannt</i> , weist diese Mängel nicht auf und weist die folgenden Merkmale auf: <br><br><ul><li>  Strikte Konsistenz. </li><li>  Fallen standhalten <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> N </script>  Knoten müssen haben <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">N</span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-175">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> N + 1 </script>  Knoten. </li><li>  Neukonfiguration ohne Konsistenzverlust. </li><li>  Es sind keine Konsensprotokolle erforderlich, die auf einer Mehrheitsentscheidung beruhen. </li></ul><br>  Zusammenfassungsschild: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/nh/yf/alnhyf9vzquirk-ztizoplkeypa.png"></div><br><h3>  8.1 Organisation von Replikaten </h3><br>  Jeder Shard definiert eine Folge von Konfigurationen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-176"><span class="MJXp-mtext" id="MJXp-Span-177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">l</span><span class="MJXp-mrow" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">C</span></span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-190" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0.111em; margin-right: 0.167em;">::</span><span class="MJXp-msubsup" id="MJXp-Span-192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-194" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0.111em; margin-right: 0.167em;">::</span><span class="MJXp-msubsup" id="MJXp-Span-196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-198" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mtext" id="MJXp-Span-199">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> \ mathcal {C} = C_1 :: C_2 :: C_3 \ dots </script>  Beispielsweise enthält die neue Konfiguration keine heruntergefallene Replik <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-204"><span class="MJXp-mtext" id="MJXp-Span-205">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">l</span><span class="MJXp-mrow" id="MJXp-Span-213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">C</span></span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-216">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">l</span><span class="MJXp-mrow" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">C</span></span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0.111em; margin-right: 0.167em;">:::</span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">e</span><span class="MJXp-mtext" id="MJXp-Span-237">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">s</span><span class="MJXp-msubsup" id="MJXp-Span-246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-248" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> \ mathcal {C} = \ mathcal {C} :::( Replikate \ setminus R_j) </script><br><br>  Jedes Element der Konfigurationssequenz besteht aus: <br><br><ul><li>  Replikate - eine Reihe von Replikaten. </li><li>  <i>Bestellnummer</i> eines Replikats mit einer besonderen Rolle (siehe unten). </li></ul><br>  Jeder Splitter wird durch eine Reihe von Repliken dargestellt (nach Konstruktion - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> N </script>  ), d.h.  Wir teilen die Rollen von "Shard" und "Replica" nicht auf. <br><br>  Jedes Replikat speichert die folgenden Daten: <br><br><ul><li>  Konfidenz der Konfiguration, zu der dieses Replikat gehört. </li><li>  Besteller - Welches Replikat ist der Besteller dieser Konfiguration? </li><li>  Modus - Replikationsmodus, einer von drei: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">G</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> PENDING </script>  (alle Repliken von Nicht- <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-260"><span class="MJXp-msubsup" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-263" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> C_1 </script>  ), <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> ACTIVE </script>  (alle Repliken von <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-271"><span class="MJXp-msubsup" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-274" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> C_1 </script>  ), <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">U</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> IMMUTABLE </script>  . </li><li>  Verlauf - Abfolge von Vorgängen für die tatsächlichen Replikatdaten <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">o</span><span class="MJXp-msubsup" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-289" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0.111em; margin-right: 0.167em;">::</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">o</span><span class="MJXp-msubsup" id="MJXp-Span-292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-294" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0.111em; margin-right: 0.167em;">::</span><span class="MJXp-mtext" id="MJXp-Span-296">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> op_1 :: op_2 :: \ dots </script>  (oder nur eine Bedingung). </li><li>  Stable - Die maximale Länge des Verlaufspräfixes, die von diesem Replikat festgelegt wird.  Offensichtlich <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-301"><span class="MJXp-mn" id="MJXp-Span-302">0</span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">l</span><span class="MJXp-mo" id="MJXp-Span-310" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">L</span><span class="MJXp-mrow" id="MJXp-Span-312"><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0em; margin-right: 0em;">ä</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">e</span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">f</span><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> 0 <= stabil <= Länge (Verlauf) </script>  . </li></ul><br>  Das Hauptziel eines Replikatbestellers besteht darin, Anforderungen an die übrigen Replikate zu senden und das größte Verlaufspräfix beizubehalten: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7_/hk/lo/7_hklowfxczcx0tjd5grugrw9a8.png"></div><br><h3>  8.2 Organisation von Scherben </h3><br>  Scherben werden zu Ringen kombiniert, die als <i>Gummibänder bezeichnet werden</i> .  Jeder Splitter gehört nur zu einem Ring.  Der Vorläufer jeder Scherbe <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> X </script>  spielt eine besondere Rolle - er ist ein <i>Sequenzer</i> für ihn.  Die Aufgabe des Sequenzers besteht darin, seinem Nachfolger bei Replikationsfehlern eine neue Konfiguration zu geben. <br><br><div style="text-align:center;"><img width="300" src="https://habrastorage.org/webt/sc/8g/se/sc8gsegolx8iarmilhrkeftetfo.png"></div><br>  Zwei Bedingungen sind erforderlich: <br><br><ul><li>  Jedes Gummiband hat mindestens eine Scherbe und eine funktionierende Nachbildung. </li><li>  Jedes Gummiband hat mindestens eine Scherbe, in der alle Repliken funktionieren. </li></ul><br>  Die zweite Bedingung scheint zu streng, entspricht jedoch der „traditionellen“ Bedingung, dass der Master-Prozess niemals abfällt. <br><br><h3>  8.3 Verwenden der Kettenreplikation </h3><br>  Wie Sie vielleicht erraten haben, sind die Repliken als Kette organisiert (grundlegender Ansatz) - der Besteller wird mit geringfügigen Unterschieden der Kopf sein: <br><br><ul><li>  Bei einem Fehler in CR wird der Knoten aus der Kette geworfen (und durch einen neuen ersetzt). In ER wird eine neue Kette erstellt. </li><li>  Leseanforderungen in CR werden von Tail verarbeitet, in ER durchlaufen sie die gesamte Kette auf die gleiche Weise wie Schreibanforderungen. </li></ul><br><h3>  8.5 Neukonfiguration im Fehlerfall </h3><br><ul><li>  Replikate werden sowohl von Replikaten Ihres Shards als auch von Replikaten eines Sequenzer-Shards überwacht. </li><li>  Sobald ein Fehler erkannt wird, senden Replikate einen Befehl dazu. </li><li>  Der Sequenzer sendet eine neue Konfiguration (ohne ein fehlgeschlagenes Replikat). </li><li>  Es wird eine neue Replik erstellt, die ihren Zustand mit dem Gummiband synchronisiert. </li><li>  Danach sendet der Sequenzer die neue Konfiguration mit dem hinzugefügten Replikat. </li></ul><br><h1>  Referenzen </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://">Hibari</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hyperdex.orgerdex.org</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">HyperDex: Ein verteilter, durchsuchbarer Schlüsselwertspeicher</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kettenreaktion</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nutzung von Sharding beim Entwurf skalierbarer Replikationsprotokolle</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de432020/">https://habr.com/ru/post/de432020/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de432006/index.html">Die Geschichte, wie ich zum Thema Frauengesundheit gekommen bin</a></li>
<li><a href="../de432008/index.html">Jagd nach Webstandards</a></li>
<li><a href="../de432012/index.html">So testen Sie intelligente Verträge</a></li>
<li><a href="../de432014/index.html">Kali Linux für Anfänger</a></li>
<li><a href="../de432016/index.html">Wie Musik und Zeichnen mir das Programmieren beigebracht haben</a></li>
<li><a href="../de432022/index.html">Forkney it: 8 Gehen Sie Projekte, die interessant sind, um in den Quellcode zu graben</a></li>
<li><a href="../de432024/index.html">Gradle 5.0 - was ist neu</a></li>
<li><a href="../de432030/index.html">Der Weg zu einem kontaktlosen Lügendetektor oder Wie man einen Hackathon mit maximaler Geschwindigkeit organisiert</a></li>
<li><a href="../de432032/index.html">Wir beenden das genagelte Google-Suchfeld</a></li>
<li><a href="../de432034/index.html">Das Buch „Elektrizität Schritt für Schritt“ von Rudolf Svoren</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>