<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👦🏿 📪 🛒 Detox und Appium: Automatisierter Schnittstellentest in React Native 👨🏻‍⚕️ 👈🏽 🤜🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unbekannte mobile Umgebung 
 Vielleicht bin ich wie Sie als JavaScript-Entwickler zu React Native gekommen und nicht als Entwickler nativer mobiler An...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Detox und Appium: Automatisierter Schnittstellentest in React Native</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434816/"><img src="https://habrastorage.org/webt/xx/gv/pp/xxgvpps9vbr5q2jkamchgmd-quk.jpeg"><br><br><h3>  Unbekannte mobile Umgebung </h3><br>  Vielleicht bin ich wie Sie als JavaScript-Entwickler zu React Native gekommen und nicht als Entwickler nativer mobiler Anwendungen.  Eine völlig neue Welt mit eigenen Nuancen und Tricks. <br><br>  Eines der wichtigsten zu untersuchenden Themen wird das Testen sein.  Was tun mit Schnittstellentests und End-to-End-Tests, wenn bei Unit-Tests alles mehr oder weniger klar ist?  iOS  Android  Es gibt eine Mischung verschiedener Arten von Geräten auf dem Markt. <br><br>  Trotz der Tatsache, dass die Technologie selbst relativ neu ist, handelt es sich immer noch um eine mobile Umgebung, und viele müssen sich von der einheimischen Seite ausleihen und lernen. <br><br>  Ich werde kurz auf zwei Frameworks eingehen, die es wert sind, beachtet zu werden, um mir als Entwickler das Leben zu erleichtern. <br><a name="habracut"></a><br><h3>  Appium </h3><br>  Appium verwendet Selenium WebDriver hinter den Kulissen und ist ein leistungsstarkes Framework mit einer großen Community von Entwicklern nativer mobiler Anwendungen.  Vor React.js veröffentlicht, ist es führend und seinesgleichen. <br><br>  Der Einstieg in Appium ist ziemlich einfach.  Mit npm installieren wir die Pakete "Appium" und "Appium-Doctor", wir können global, wir können als Teil des Projekts.  Das „Appium-Doctor“ -Team teilt uns mit, was vor Arbeitsbeginn noch installiert und konfiguriert werden muss, und hilft, wenn möglich, Fehler zu beheben.  Wenn alles entschieden ist, die Pakete installiert sind und die Jest-Konfiguration vorhanden ist, können wir den Appium-Server ausführen und testen. <br><br>  Ich werde nicht auf die Details der Konfiguration eingehen, aber hier ist, wie ein einfacher Test mit der Konfiguration aussieht (Kommentare hinzugefügt): <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/*  selenium webdriver  node */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> wd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'wd'</span></span> <span class="hljs-comment"><span class="hljs-comment">/* 60  ,    ,   */</span></span> jasmine.DEFAULT_TIMEOUT_INTERVAL = <span class="hljs-number"><span class="hljs-number">60000</span></span> <span class="hljs-comment"><span class="hljs-comment">/*   Appium.    ,  localhost */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> URL = <span class="hljs-string"><span class="hljs-string">'localhost'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PORT = <span class="hljs-number"><span class="hljs-number">4723</span></span> <span class="hljs-comment"><span class="hljs-comment">/*   webdriver */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> driver = wd.promiseChainRemote(URL, PORT) <span class="hljs-comment"><span class="hljs-comment">/*  . *    Appium, *   ,   . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> capabilities = { <span class="hljs-attr"><span class="hljs-attr">platformName</span></span>: <span class="hljs-string"><span class="hljs-string">'iOS'</span></span>, <span class="hljs-comment"><span class="hljs-comment">//  Android platformVersion: '12.1', //   deviceName: 'iPhone 8', //  “Android Emulator”     automationName: 'XCUITest', //   (UIAutomator2  Android) app: '/path/to/.app' //   .app ( Android  .apk) } beforeAll(async () =&gt; { try { //  ,    await driver.init(capabilities) //   await driver.sleep(4000) //  ,       ,   ! } catch(err) { console.log(err) //  ,   ,    } }) afterAll(async () =&gt; { try { await driver.quit() //   } catch(err) { console.error(err) } }); /* Jest,   ,   Appium! *     ,    * 'topLabel'  'subLabel'  *       Appium */ describe("Home Screen landing", () =&gt; { test("render search screen", async () =&gt; { let topLabel = await driver.elementById('topLabel') let subLabel = await driver.elementById('subLabel') expect(await topLabel.text()).toBe("OK") expect(await subLabel.text()).toBe(" ") }) })</span></span></code> </pre> <br>  Der Test selbst, dies sind die letzten Zeilen, die prüfen, ob der Text „OK“ und „Hauptbildschirm“ auf dem Bildschirm angezeigt werden.  Wie Sie sehen können, nichts Besonderes im Test, der gleiche Scherz.  Die Dokumentation auf der Appium-Website beschreibt alle Funktionen des Frameworks, einschließlich JavaScript-Beispiele. <br><br>  Abneigung nur <code>await driver.sleep(4000)</code> .  Leider haben Tests keine Ahnung, was in der Anwendung vor sich geht.  Die sogenannte "Black Box" oder Blackbox.  Stellen Sie sich vor, Sie schreiben Code auf Node und stellen vor der http-Anforderung einen Timer ein, anstatt Versprechen oder Rückruf zu verwenden.  Hier ist es, die Fragilität von UI-Tests. <br><br>  In diesem einfachen Test warten wir 4 Sekunden, um die Anwendung zu starten.  Mit der Zeit und mit zunehmender Anzahl von Tests werden wir häufiger Timer einstellen - http-Anfragen, Animation, React Native selbst - die Brücke zwischen nativem Code und JavaScript erschwert die Situation nur. <br><br>  <i>"Black Box" haben wir die Montage der Anwendung ohne Zugriff auf interne Strukturen.</i> <br><img src="https://habrastorage.org/webt/pt/zs/cp/ptzscp_jlpii4ltt8ahqzhghtyq.png"><br><br>  <b>Was magst du an Appium?</b> <br><br><ul><li>  Über 7 Jahre in der Branche. </li><li>  Umfangreiche API-Funktionen. </li><li>  Leicht zu findende Hilfe (dies ist auch ein Minus, die Liste unten) </li><li>  Unterstützung für verschiedene Sprachen, einschließlich JavaScript. </li><li>  Eine vertraute JavaScript-Entwicklerumgebung für Jest. </li><li>  Wird für End-to-End-Tests in MS AppCenter, BrowserStack und AWS DeviceFarm verwendet. </li><li>  Die Fähigkeit, auf realen Geräten zu testen. </li></ul><br>  <b>Was ich an Appium nicht mag</b> <br><br><ul><li>  Websuchen geben Ergebnisse für verschiedene Programmiersprachen zurück, die meisten davon Java. </li><li>  Black-Box-Tests (Tests kennen die Prozesse in der Anwendung nicht). </li><li>  Es gibt keine Synchronisation mit der Anwendung, Fragilität, React Native verursacht noch mehr Probleme. </li><li>  testID funktioniert aus irgendeinem Grund nicht unter Android. </li></ul><br><br>  <i>Beachten Sie drei Registerkarten: Appium-Serverprotokolle, Metro Bundler und den Test selbst.</i> <br><img src="https://habrastorage.org/webt/ap/n-/pm/apn-pmr1nkmzno2m728ljq39tb8.png"><br><br><h3>  Detox </h3><br>  Wix 'Detox funktioniert ähnlich wie Appium.  Der Hauptunterschied besteht in der Prüfung nach der „Gray Box“ -Strategie.  Eine der Aufgaben der Detox-Entwickler bestand darin, Probleme mit der Fragilität zu lösen. Die Aufgabe in der Anwendung wird erst gestartet, wenn die vorherige beendet ist und die Anwendung kostenlos ist.  Möglich wurde dies durch ein anderes Framework, das unter dem Namen EarlGrey erstellt wurde. <br><br>  Wie bei Appium stellen wir die Einstellungen ein. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/*     package.json,   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> detox = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"detox"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> config = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"./package.json"</span></span>).detox; <span class="hljs-comment"><span class="hljs-comment">/*  Jest */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> adapter = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"detox/runners/jest/adapter"</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* , *   Jest */</span></span> jest.setTimeout(<span class="hljs-number"><span class="hljs-number">120000</span></span>); jasmine.getEnv().addReporter(adapter); beforeAll(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> detox.init(config); }); <span class="hljs-comment"><span class="hljs-comment">/* beforeEach  afterEach   Detox, *   Jest *    */</span></span> beforeEach(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> adapter.beforeEach(); }); afterAll(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> adapter.afterAll(); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> detox.cleanup(); });</code> </pre><br>  Und Einstellung in package.json: <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">"detox"</span></span>: { <span class="hljs-string"><span class="hljs-string">"configurations"</span></span>: { <span class="hljs-string"><span class="hljs-string">"ios.detox"</span></span>: { <span class="hljs-comment"><span class="hljs-comment">//   iOS (  detox test -c ios.detox) "binaryPath": "path/to/.app", "build": "xcodebuild -workspace ios/app.xcworkspace -scheme scheme -configuration Debug -sdk iphonesimulator -derivedDataPath ios/build", //  workspace  project.      debug  production (release). "type": "ios.simulator", "name": "iPhone 8" //   }, "android.detox": { //   Android (  detox test -c android.detox) "binaryPath": "path/to/.apk", "build": "cd android &amp;&amp; ./gradlew assembleDebug assembleAndroidTest -DtestBuildType=debug &amp;&amp; cd ..", //      debug  production (release). "type": "android.emulator", "name": "Pixel_2_API_28" //  . “adb devices”     Android } }, "test-runner": "jest", "runner-config": { "setupTestFrameworkScriptFile" : "./detox.init.js", //   "testEnvironment": "node", "testRegex": "(.*|\\.(ui))\\.(ts|tsx)$" //  ,     } "specs": "./__tests__/" //    }</span></span></code> </pre><br>  Das Schreiben von Tests ist so einfach wie das Schreiben von Appium, verwendet jedoch Detox-Funktionen und -Einschränkungen. <br><br>  <i>"Gray Box" haben wir die Montage der Anwendung und Zugriff auf interne Strukturen.</i> <br><img src="https://habrastorage.org/webt/wb/eo/ox/wbeooxh72x0szw2op-lbixoeiow.png"><br><br>  <b>Was ich an Detox mag</b> <br><br><ul><li>  Erstellt von Wix für React Native. </li><li>  Konzentriert sich auf JavaScript. </li><li>  Testen Sie die Strategie der "grauen Box". </li><li>  Es funktioniert synchron mit der Anwendung. </li></ul><br>  <b>Was Sie an Detox nicht mögen</b> <br><br><ul><li>  Die Möglichkeiten sind nicht so groß wie die von Appium. </li><li>  Kleine Gemeinde. </li></ul><br><h3>  Zerbrechlichkeit </h3><br>  Obwohl Detox das "Gray Box" -Prinzip verwendet, ist die Fragilität immer noch vorhanden.  Der Test mit Texteingabe und Wischen funktionierte in 1 von 10 Fällen nicht ordnungsgemäß. Sie können bei den Schnittstellentests nicht 100% sicher sein. <br><br><h3>  Geschwindigkeit </h3><br>  Appium "verlangsamt" die manuell eingestellten ".sleep" -Timer, Detox gewinnt in diesem Fall, da alles synchron ist.  Im Allgemeinen würde ich meinerseits keine Schlussfolgerungen ziehen, da ich nicht auf beiden Plattformen eine große Anzahl identischer Tests geschrieben habe.  In den 30-Sekunden-Tests und dem für diesen Artikel erstellten einfachen Test führte Detox Sekunden schneller durch.  Wenn Sie sich zwei verschiedene Plattformen ansehen, iOS und Android, dauerten die Tests gleichzeitig + -.  Das Wichtigste ist, dass Schnittstellentests erheblich länger dauern. <br><br><h3>  Was zu wählen </h3><br>  Ich studiere immer noch beide Frameworks und es wird einige Zeit dauern, bis ich alle ihre Vorteile verstanden habe. Als JavaScript-Entwickler entscheide ich mich jedoch vorerst für Detox. <br><br>  Probieren Sie beide aus, zum Glück gibt es nur zwei.  Es hängt alles von der Anwendung ab, an der Sie arbeiten, und vom Team. <br><br>  Schnittstellentests im Entwicklungsteam - für Entwickler versuchen Sie Detox.  Komplexere End-to-End-Tests - Am besten sehen Sie sich Appium mit seinen umfangreichen API-Funktionen und der Unterstützung auf den Plattformen BrowserStack, MS AppCenter und AWS DeviceFarm genauer an. <br><br><h3>  Referenzen </h3><br>  Es gibt viele nützliche Ressourcen und Artikel, aber leider auf Englisch.  Das erste was ich empfehle.  Websites. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Appium</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Detox</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de434816/">https://habr.com/ru/post/de434816/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de434802/index.html">"Ich werde keinen Stein geben" oder wie die Ressourcen des Spiels "Cursed Lands" angeordnet sind</a></li>
<li><a href="../de434804/index.html">Das Fintech-Startup Robinhood konnte kein Analogon von Bankkonten starten</a></li>
<li><a href="../de434806/index.html">Neujahrsabbau mit einem Kanu</a></li>
<li><a href="../de434810/index.html">Starter für die Arbeit mit Spring Cloud</a></li>
<li><a href="../de434812/index.html">Projektzeitmanagement</a></li>
<li><a href="../de434818/index.html">Ein Unfall im CenturyLink Data Center verursachte 911 Service-Ausfälle</a></li>
<li><a href="../de434822/index.html">PRC-Programm "Autos mit neuen Energiequellen." Was 2019 zu erwarten ist</a></li>
<li><a href="../de434824/index.html">Polit-Elektrotechnik. Modellierung gesellschaftspolitischer Prozesse durch Stromkreise</a></li>
<li><a href="../de434826/index.html">Das Bettfeld pünktlich oder 5 Anzeichen von versteckten Problemen im Team</a></li>
<li><a href="../de434828/index.html">Werde ein Profi. Nützliche Gewohnheiten von UX-Designern</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>