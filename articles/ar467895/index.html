<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ฅ ๐ฉ๐ผโโ๏ธ ูุง ูู ุงูุฃููุงุท ุงูุชู ุชุฌุฏูุง ุงูุดุจูุงุช ุงูุนุตุจูุฉุ ๐ ๐ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ูุฐุง ุงูููุดูุฑ ุฃุฑูุฏ ุฃู ุฃุชุญุฏุซ ุนู ุงูุฃููุงุท ุงูุชู ูููู ุฃู ุชุฌุฏูุง ุงูุดุจูุงุช ุงูุนุตุจูุฉ. ุชุฑูุฒ ุงูุนุฏูุฏ ูู ุฃุฏูุฉ ุงููุจุชุฏุฆูู ุนูู ุฃุณููุจ ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ููุดุจูุงุช ุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุง ูู ุงูุฃููุงุท ุงูุชู ุชุฌุฏูุง ุงูุดุจูุงุช ุงูุนุตุจูุฉุ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467895/" style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูููุดูุฑ ุฃุฑูุฏ ุฃู ุฃุชุญุฏุซ ุนู ุงูุฃููุงุท ุงูุชู ูููู ุฃู ุชุฌุฏูุง ุงูุดุจูุงุช ุงูุนุตุจูุฉ.  ุชุฑูุฒ ุงูุนุฏูุฏ ูู ุฃุฏูุฉ ุงููุจุชุฏุฆูู ุนูู ุฃุณููุจ ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ููุดุจูุงุช ุงูุนุตุจูุฉ ุ ูู ุญูู ุฃู ุฃุณุฆูุฉ "ุงูููุทู" (ูุง ูููู ุฃู ุงูุดุจูุงุช ุงูุนุตุจูุฉุ ุฃู ุจููุงุช ูู ุงูุฃูุณุจ ูุฃูุฉ ููุงู ูููุงุฐุงุ) ุบุงูุจุง ูุง ุชุจูู ุนูู ุงููุงูุด.  ุขูู ุฃู ูุณุงุนุฏ ููุดูุฑู ุงููุจุชุฏุฆูู ุนูู ููู ูุฏุฑุงุช ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุจุดูู ุฃูุถู.  ููููุงู ุจุฐูู ุ ุณูุญุงูู ูุนุฑูุฉ ููููุฉ ุชุนุงูููู ูุน ุจุนุถ ุงูููุงู ุงููููุฐุฌูุฉ.  ุณูุชู ุชูููุฑ ูููุฐุฌ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ุจูุซูู ุจุงุณุชุฎุฏุงู ููุชุจุฉ keras. <br><br>  <b>ุงููููุฉ 1.</b> ููุจุฏุฃ ูุน ูุงุญุฏ ุจุณูุท.  ูุญู ูุจูู ุดุจูุฉ ุนุตุจูุฉ ุชูุงุฑุจ ุงูุฌูุจ. <br><br><pre style=";text-align:right;direction:rtl"><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Sequential <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.layers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Dense <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_X_y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span><span class="hljs-function">:</span></span> X = np.random.uniform(<span class="hljs-number"><span class="hljs-number">0</span></span>, np.pi, n) y = np.sin(X) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> X, y n = <span class="hljs-number"><span class="hljs-number">40</span></span> X, y = get_X_y(n) print(<span class="hljs-string"><span class="hljs-string">"X shape:"</span></span>, X.shape) model = Sequential() model.add(Dense(<span class="hljs-number"><span class="hljs-number">6</span></span>, input_dim=<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)) model.add(Dense(<span class="hljs-number"><span class="hljs-number">4</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)) model.add(Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'sigmoid'</span></span>)) model.compile(loss=<span class="hljs-string"><span class="hljs-string">'mean_squared_error'</span></span>, optimizer=<span class="hljs-string"><span class="hljs-string">'adam'</span></span>, metrics=[<span class="hljs-string"><span class="hljs-string">'mean_squared_error'</span></span>]) model.fit(X, y, epochs=<span class="hljs-number"><span class="hljs-number">1000</span></span>, batch_size=<span class="hljs-number"><span class="hljs-number">4</span></span>) X_test = np.linspace(start=<span class="hljs-number"><span class="hljs-number">0</span></span>, stop=np.pi, num=<span class="hljs-number"><span class="hljs-number">500</span></span>) print(<span class="hljs-string"><span class="hljs-string">"X test shape:"</span></span>, X_test.shape) y_test = model.predict(X_test) font = {<span class="hljs-string"><span class="hljs-string">'weight'</span></span>: <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'size'</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>} matplotlib.rc(<span class="hljs-string"><span class="hljs-string">'font'</span></span>, **font) axes = plt.gca() axes.set_ylim(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) plt.plot(X_test, y_test, c=<span class="hljs-string"><span class="hljs-string">'green'</span></span>, marker=<span class="hljs-string"><span class="hljs-string">'o'</span></span>, markersize=<span class="hljs-number"><span class="hljs-number">5</span></span>) plt.title(<span class="hljs-string"><span class="hljs-string">"Sinus approximated by neural network"</span></span>) plt.yticks(np.arange(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>)) plt.grid() plt.show()</code> </pre> <br>  ูุญุตู ุนูู ุงูุฑุณู ุงูุจูุงูู ุงูุชุงูู: <br><br><img src="https://habrastorage.org/webt/t3/xv/_o/t3xv_ocq-o9m8yupmxxdrfxqgai.png" width="500" height="500"><br><br>  ููุง ุชุฑูู ุ ุชุนุงููุช ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุจูุฌุงุญ ูุน ูููุฉ ุชูุฑูุจ ูุธููุฉ ุจุณูุทุฉ. <br><a name="habracut"></a><br>  <b>ุงููููุฉ 2.</b> ููุฑู ููู ุณุชุชุนุงูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูุน ูููุฉ ุฃูุซุฑ ุชุนููุฏูุง.  ุณูููู ุจุฅุฏุฎุงู ููู x ููุฒุนุฉ ุจุดูู ููุญุฏ ุนูู ุงููุงุตู ุงูุฒููู [0 ุ 1] ุ ูุณูุชู ุชุนููู y ุนุดูุงุฆููุง: ุจุงููุณุจุฉ ุฅูู x &lt;0.6 ุ ุณุชููู y ุนุจุงุฑุฉ ุนู ูุชุบูุฑ ุนุดูุงุฆู ูุฃุฎุฐ ุงููููุฉ 0 ุจุงุญุชูุงู 0.75 ู 1 ุจุงุญุชูุงู 0.25 (ุฃู ุ ูููุฉ ุนุดูุงุฆูุฉ ุฐุงุช ุงูุญุฏูู ูุน ุน = 0.25).  ุจุงููุณุจุฉ ุฅูู x&gt; 0.6 ุ ุณูููู y ูุชุบูุฑูุง ุนุดูุงุฆููุง ูุฃุฎุฐ ุงููููุฉ 0 ูุน ุงูุงุญุชูุงู 0.3 ูุงููููุฉ 1 ูุน ุงูุงุญุชูุงู 0.7.  ูุฏุงูุฉ ูุญุณููุฉ ุ ูุฃุฎุฐ ุงูุฎุทุฃ ุงูููุงุณู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Sequential <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.layers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Dense <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_X_y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span><span class="hljs-function">:</span></span> X = np.random.uniform(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, n) y0 = np.random.binomial(size=n, n=<span class="hljs-number"><span class="hljs-number">1</span></span>, p=<span class="hljs-number"><span class="hljs-number">0.25</span></span>) y1 = np.random.binomial(size=n, n=<span class="hljs-number"><span class="hljs-number">1</span></span>, p=<span class="hljs-number"><span class="hljs-number">0.7</span></span>) y = np.where(X &lt; <span class="hljs-number"><span class="hljs-number">0.6</span></span>, y0, y1) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> X, y n_inputs = <span class="hljs-number"><span class="hljs-number">1</span></span> n_hidden1 = <span class="hljs-number"><span class="hljs-number">100</span></span> n_hidden2 = <span class="hljs-number"><span class="hljs-number">50</span></span> n_outputs = <span class="hljs-number"><span class="hljs-number">1</span></span> n = <span class="hljs-number"><span class="hljs-number">2000</span></span> X, y = get_X_y(n) print(<span class="hljs-string"><span class="hljs-string">"X shape:"</span></span>, X.shape) model = Sequential() model.add(Dense(n_hidden1, input_dim=<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)) model.add(Dense(n_hidden2, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)) model.add(Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'sigmoid'</span></span>)) model.compile(loss=<span class="hljs-string"><span class="hljs-string">'mean_squared_error'</span></span>, optimizer=<span class="hljs-string"><span class="hljs-string">'adam'</span></span>, metrics=[<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>]) model.fit(X, y, epochs=<span class="hljs-number"><span class="hljs-number">200</span></span>, batch_size=<span class="hljs-number"><span class="hljs-number">100</span></span>) X_test = np.linspace(start=<span class="hljs-number"><span class="hljs-number">0</span></span>, stop=<span class="hljs-number"><span class="hljs-number">1</span></span>, num=<span class="hljs-number"><span class="hljs-number">100</span></span>) print(<span class="hljs-string"><span class="hljs-string">"X test shape:"</span></span>, X_test.shape) y_test = model.predict(X_test) font = {<span class="hljs-string"><span class="hljs-string">'weight'</span></span>: <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'size'</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>} matplotlib.rc(<span class="hljs-string"><span class="hljs-string">'font'</span></span>, **font) axes = plt.gca() axes.set_ylim(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) plt.plot(X_test, y_test, c=<span class="hljs-string"><span class="hljs-string">'green'</span></span>, marker=<span class="hljs-string"><span class="hljs-string">'o'</span></span>, markersize=<span class="hljs-number"><span class="hljs-number">5</span></span>) plt.title(<span class="hljs-string"><span class="hljs-string">"Binomial distribution approximated by neural network"</span></span>) plt.yticks(np.arange(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>)) plt.grid() plt.show()</code> </pre><br>  ูุญุตู ุนูู ุงูุฑุณู ุงูุจูุงูู ุงูุชุงูู ูุดุจูุฉ ุนุตุจูุฉ ุฏุงูุฉ ุชูุฑูุจูุฉ: <br><br><img src="https://habrastorage.org/webt/y_/rp/lo/y_rplovhyaxioena0tb8iueed9m.png" width="500" height="500"><br><br>  ููุง ุชุฑูู ุ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุชูุงุฑุจ ุงูุชููุน ุงูุฑูุงุถู ููุชุบูุฑูุง ุงูุนุดูุงุฆู y.  ูุฐูู ุ ูููู ููุดุจูุงุช ุงูุนุตุจูุฉ (ูู ุญูุซ ุงููุจุฏุฃ) ุชูุฑูุจ ูุชูุณุท โโููู ุงููุชุบูุฑุงุช ุงูุนุดูุงุฆูุฉ ุงูุชู ุชุนุชูุฏ ุนูู ุงููุนููุงุช.  ุนูู ุณุจูู ุงููุซุงู ุ ูููููุง ุฃู ูุชููุน ูููู ุญู ุงููุดููุฉ ุงูุชุงููุฉ: ุงูุฃุดุฎุงุต ุงูุฐูู ูุตู ุฏุฎููู ุฅูู 1000 ุฏููุงุฑ ูู ูู ุงููุชูุณุท โโุบูุฑ ุฑุงุถูู ุ ูุงูุฃุดุฎุงุต ุงูุฐูู ูุฒูุฏ ุฏุฎููู ุนู 1000 ุฏููุงุฑ ูู ุงููุชูุณุท โโุณุนุฏุงุก ุ  ูุฌุจ ุนูู ุงููุฑุก ุฃู ูุชุนูู ุงูุชูุจุค "ุจูุณุชูู ุงูุณุนุงุฏุฉ" ุญุณุจ ุงูุฏุฎู.  ุณูู ุชููู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูุงุฏุฑุฉ ุนูู ุงูุนุซูุฑ ุนูู ุงุนุชูุงุฏ ูุชูุณุท โโูุณุชูู ุงูุณุนุงุฏุฉ ุนูู ุงูุฏุฎู ุ ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃู ุงูุฃุดุฎุงุต ุงูุฐูู ูุฏููู ุฃู ูุณุชูู ุฏุฎู ูููููู ุณุนุฏุงุก ูุบูุฑ ุณุนุฏุงุก. <br><br>  <b>ุงููุดููุฉ 3.</b> ุงูุขู ููุชูู ุฅูู ุงูุชูุจุค ุจุงูุชุณูุณูุงุช.  ุณููุธุฑ ูู ุชุชุงุจุนุงุช 0 ู 1 ุงููุนุฑููุฉ ูู ุงููุงุนุฏุฉ ุงูุชุงููุฉ: 10 ุฃุนุถุงุก ุชุณุงูู 0 ุฃู 1 ุ ูุงูุญุงุฏู ุนุดุฑ ุชุณุงูู 1 ุฅุฐุง ูุงูุช ุงููุฏุฉ ุงูุณุงุจูุฉ ุชุณุงูู 0 ุ ูุชุณุงูู 0 ุฃู 1 ุฅุฐุง ูุงู ุงูุญุฏ ุงูุณุงุจู ูู 1. ุณูููู ุจุฅูุดุงุก ุชุณูุณูุงุช ุทูููุง 11 (10 ุฅุฏุฎุงู ุฃุนุถุงุก ุงูุชุณูุณู ููุงุญุฏ ุ ูุงูุฃุฎูุฑ ุ ููุญู ูุชููุน) ูุชุฏุฑูุจูู ุนูู ุดุจูุชูุง ุงูุนุตุจูุฉ ุงููุชูุฑุฑุฉ.  ูุจุนุฏ ุงูุชุฏุฑูุจ ุ ุฏุนููุง ูุชุญูู ูู ููููุฉ ุชุนุงูููุง ูุน ุงูุชูุจุค ุจุงูุชุณูุณูุงุช ุงูุฌุฏูุฏุฉ (ุงูุทูู 11 ุฃูุถูุง). <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Sequential <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.layers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LSTM, Dense <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_X_y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(m, n)</span></span></span><span class="hljs-function">:</span></span> X = np.random.binomial(size=(m,n), n=<span class="hljs-number"><span class="hljs-number">1</span></span>, p=<span class="hljs-number"><span class="hljs-number">0.5</span></span>) y0 = np.ones(m) y1 = np.random.binomial(size=m, n=<span class="hljs-number"><span class="hljs-number">1</span></span>, p=<span class="hljs-number"><span class="hljs-number">0.5</span></span>) y = np.where(X[:, n<span class="hljs-number"><span class="hljs-number">-1</span></span>]==<span class="hljs-number"><span class="hljs-number">0</span></span>, y0, y1) X = np.reshape(X, (X.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>], X.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> X, y model = Sequential() model.add(LSTM(units=<span class="hljs-number"><span class="hljs-number">50</span></span>)) model.add(Dense(units=<span class="hljs-number"><span class="hljs-number">1</span></span>)) model.compile(optimizer = <span class="hljs-string"><span class="hljs-string">'adam'</span></span>, loss = <span class="hljs-string"><span class="hljs-string">'mean_squared_error'</span></span>) X_train, y_train = get_X_y(<span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) model.fit(X_train, y_train, epochs = <span class="hljs-number"><span class="hljs-number">20</span></span>, batch_size = <span class="hljs-number"><span class="hljs-number">32</span></span>) m_test = <span class="hljs-number"><span class="hljs-number">12</span></span> n_test = <span class="hljs-number"><span class="hljs-number">10</span></span> X_test, y_test = get_X_y(m_test, n_test) y_predicted = model.predict(X_test) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(m_test): print(<span class="hljs-string"><span class="hljs-string">"x_last="</span></span>, X_test[i, n_test<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-string"><span class="hljs-string">"y_predicted="</span></span>, y_predicted[i, <span class="hljs-number"><span class="hljs-number">0</span></span>])</code> </pre><br>  ุฏุนููุง ูุฑู ูุง ุชูุจุฆ ุจู ุดุจูุชูุง ุงูุนุตุจูุฉ ุนูู ุงูุชุณูุณูุงุช ุงููุฎุชุจุฑุฉ (ุณุชููู ูุชุงุฆุฌู ูุฎุชููุฉ ุ ุญูุซ ุชูุฌุฏ ุงูุนุดูุงุฆูุฉ ููุง ูู ุงุฎุชูุงุฑ ุงูุชุณูุณูุงุช ููู ุชุฏุฑูุจ ุงูุดุจูุฉ ุงูุนุตุจูุฉ). <br><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><th>  ุฑูู ุงูุชุณูุณู </th><th>  ุนุถู ูุง ูุจู ุงูุฃุฎูุฑ ูู ุงูุชุณูุณู </th><th>  ุงููููุฉ ุงููุชููุนุฉ </th></tr><tr><td>  1 </td><td>  0 </td><td>  0.96 </td></tr><tr><td>  2 </td><td>  0 </td><td>  0.95 </td></tr><tr><td>  3 </td><td>  0 </td><td>  0.97 </td></tr><tr><td>  4 </td><td>  0 </td><td>  0.96 </td></tr><tr><td>  5 </td><td>  0 </td><td>  0.96 </td></tr><tr><td>  6 </td><td>  1 </td><td>  0.45 </td></tr><tr><td>  7 </td><td>  0 </td><td>  0.94 </td></tr><tr><td>  8 </td><td>  1 </td><td>  0.50 </td></tr><tr><td>  9 </td><td>  0 </td><td>  0.96 </td></tr><tr><td>  10 </td><td>  1 </td><td>  0.42 </td></tr><tr><td>  11 </td><td>  1 </td><td>  0.44 </td></tr><tr><td>  12 </td><td>  0 </td><td>  0.92 </td></tr></tbody></table></div><br><br>  ููุง ุชุฑูู ุ ุฅุฐุง ูุงู ุงูุนุถู ูุจู ุงูุฃุฎูุฑ ูู ุงูุชุณูุณู ูู 0 ุ ูุฅู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุชุชูุจุฃ ุจูููุฉ ูุฑูุจุฉ ูู 1 ุ ูุฅุฐุง ูุงูุช 1 ุ ูุณุชููู ุงููููุฉ ูุฑูุจุฉ ูู 0.5.  ูุฐุง ูุฑูุจ ูู ุงูุชููุนุงุช ุงููุซูู.  ูุซุงู ููุงุซู ูู "ุงูุญูุงุฉ" ูููู ุฃู ูุจุฏู ูุงูุชุงูู: "ุฅุฐุง ุฐูุจุช ุฅูู ุงูุณูููุง ุงูููู ุ ูุนูุฏุฆุฐ ุณุฃุชูุงูู ุบุฏูุง ูู ูุทุนู ุ  ุฅุฐุง ููุช ุฐุงูุจ ุฅูู ุงููุณุฑุญ ุงูููู ุ ูุนูุฏุฆุฐ ุณุฃุชูุงูู ุบุฏูุง ูู ุฃู ููุงู ".  ููุง ุฑุฃููุง ุ ูููู ูุดุจูุฉ ุนุตุจูุฉ ุงูุชูุงุท ุฃููุงุท ูู ูุฐุง ุงูููุน ูุงูุชูุจุค ุจุฑุญูุฉ ุฅูู ูุทุนู ุจุงูุฐูุงุจ ุฅูู ุงูุณูููุง (ูุงูุฐูุงุจ ุฅูู ุงููุณุฑุญ ููุชูุจุค "ุจุดูุก ูุง"). <br><br>  <b>ุงููููุฉ 4.</b> ูุญู ุชุนููุฏ ูููุฉ ุงูุดุจูุฉ ุงูุนุตุจูุฉ.  ุงุฌุนู ูู ุดูุก ููุง ูู ุงููุซุงู ุงูุณุงุจู ุ ุณูุชู ุชุญุฏูุฏ ุงูุนุถู ุงูุญุงุฏู ุนุดุฑ ููุท ูู ุงูุชุณูุณู ุ ููุณ ุจูุงุณุทุฉ ุงูุณุงุจู ุ ูููู ุจูุงุณุทุฉ ุงูุนุถู ุงูุซุงูู ูู ุงูุชุณูุณู (ููููุง ูููุณ ุงููุงุนุฏุฉ).  ูู ูุนุทู ุงูุฑูุฒ ููุง ุ ูุฃูู ูุง ูุฎุชูู ุนูููุงู ุนู ุงูููุฏ ุงูุณุงุจู.  ุฃูุถุญุช ุชุฌุฑุจุชู ุฃู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูุง ุชุฒุงู ุชุฌุฏ ููุทูุง ุ ููู ููุฒูุฏ ูู ุงูููุช (ุงุถุทุฑุฑุช ุฅูู ุงุณุชุฎุฏุงู 100 ุนุตุฑ ุจุฏูุงู ูู 20 ููุชุฏุฑูุจ). <br>  ูุจุงูุชุงูู ุ ูููู ููุดุจูุงุช ุงูุนุตุจูุฉ (ูุฑุฉ ุฃุฎุฑู ุ ูู ุญูุซ ุงููุจุฏุฃ ุ ุงูุชูุถูุญ) ุงูุชูุงุท ุงูุชุจุนูุงุช ุทูููุฉ ุงูุฃุฌู ุฅูู ุญุฏ ูุง (ูู "ูุซุงู ุญูุงุชูุง" ุ ูููููู ุงูุชูุงุท ุฃููุงุท ูุซู "ุฃุฐูุจ ุฅูู ูุทุนู ุงูููู ุฅุฐุง ููุช ูู ูููู ูุจู ุฃุณุจูุน"). <br><br>  <b>ุงููููุฉ 5.</b> ููุฑู ููู ุชุณุชุฎุฏู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงููุนูููุงุช ุงููุชุงุญุฉ ููุชูุจุค. <br>  ููููุงู ุจุฐูู ุ ุณูุฌุฑู ุชุฏุฑูุจุงุช ุนูู ูุชูุงููุงุช ุงูุทูู 4. ูู ุงููุฌููุน ุ ุณูููู ูุฏููุง 3 ูุชูุงููุงุช ูุฎุชููุฉ ูุญุชููุฉ ุจุงูุชุณุงูู: <br><br> <code>0, 0, 1, 1 <br> 0, 1, 0, 1 <br> 0, 1, 1, 0</code> <br> <br>  ูุจุงูุชุงูู ุ ุจุนุฏ ุงูุฌูุน ุงูุฃููู ุจูู 0 ู 0 ุ ููุชูู ุฏุงุฆููุง ุจูุญุฏุชูู ุ ูุจุนุฏ ุงูุฌูุน ุจูู 0 ุ 1 ูู ุงููุญุชูู ุฃู ููุชูู 0 ุฃู 1 ุ ููููุง ูุนุฑู ุงูุฑูู ุงูุฃุฎูุฑ ุจุงูุชุฃููุฏ.  ุณูุทูุจ ุงูุขู ูู ุดุจูุชูุง ุงูุนุตุจูุฉ ุฅุฑุฌุงุน ุงูุชุชุงุจุนุงุช ุนู ุทุฑูู ุชุนููู return_sequences = True.  ูุชุณูุณูุงุช ูุชููุนุฉ ุ ูุฃุฎุฐ ููุณ ุงูุชุณูุณูุงุช ุงูุฎุงุตุฉ ุจูุง ุฎุทูุฉ ุจุฎุทูุฉ ููููููุง ุตูุฑ ุนูู ุงููููู.  ุงูุขู ูููููุง ุฃู ููุชุฑุถ ุจุงููุนู ูุง ุณูุญุฏุซ: ูู ุงูุฎุทูุฉ ุงูุฃููู ุ ุณุชูุชุฌ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุนุฏุฏูุง ูุฑูุจูุง ูู 2/3 (ูุธุฑูุง ูุงุญุชูุงู 2/3 ุงููุตุทูุญ ุงูุซุงูู ูู 1) ุ ููู ุฃุฌู ูุฌููุนุฉ ูู 0 ุ ุณุชูุชุฌ ุฑูููู ูุฑูุจูู ูู ูุญุฏุฉ ุ ูููู ุจุงููุณุจุฉ ุฅูู 0 ุ 1 ุฃููุงู ุ ุณุชุนุทู ุนุฏุฏูุง ูุฑูุจูุง ูู 0.5 ุ ุซู ุชุนุทู ุฑูููุง ูุฑูุจูุง ูู 0 ุฃู 1 ุ ููุฐุง ูุชููู ุนูู ูุง ุฅุฐุง ููุง ูุฏ ุญุตููุง ุนูู ุงูุชุณูุณู 0 ุฃู 1 ุฃู 0 ุฃู 0 ุ 1 ุ 1. ูู ููุงูุฉ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุณุชูุชุฌ ุฏุงุฆููุง ุฑูููุง ูุฑูุจูุง ูู 0. ุงูุชุญูู ูู ุงูููุฏ ุงูุชุงูู ููุถุญ ุฃู ุงูุชุฑุงุถุงุชูุง ุตุญูุญุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Sequential <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.layers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LSTM, Dense <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_X_y</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span><span class="hljs-function">:</span></span> X = np.zeros((n, <span class="hljs-number"><span class="hljs-number">4</span></span>)) z = np.array([random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(n)]) X[z == <span class="hljs-number"><span class="hljs-number">0</span></span>, :] = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] X[z == <span class="hljs-number"><span class="hljs-number">1</span></span>, :] = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] X[z == <span class="hljs-number"><span class="hljs-number">2</span></span>, :] = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>] y = np.zeros((n, <span class="hljs-number"><span class="hljs-number">4</span></span>)) y[:, :<span class="hljs-number"><span class="hljs-number">3</span></span>] = X[:, <span class="hljs-number"><span class="hljs-number">1</span></span>:] X = np.reshape(X, (X.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>], X.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-number"><span class="hljs-number">1</span></span>)) y = np.reshape(y, (y.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>], y.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> X, y model = Sequential() model.add(LSTM(units=<span class="hljs-number"><span class="hljs-number">20</span></span>, return_sequences=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)) model.add(Dense(units=<span class="hljs-number"><span class="hljs-number">1</span></span>)) model.compile(optimizer = <span class="hljs-string"><span class="hljs-string">'adam'</span></span>, loss = <span class="hljs-string"><span class="hljs-string">'mean_squared_error'</span></span>) X_train, y_train = get_X_y(<span class="hljs-number"><span class="hljs-number">1000</span></span>) model.fit(X_train, y_train, epochs = <span class="hljs-number"><span class="hljs-number">100</span></span>, batch_size = <span class="hljs-number"><span class="hljs-number">32</span></span>) X_test = np.zeros((<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)) X_test[<span class="hljs-number"><span class="hljs-number">0</span></span>, :] = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] X_test[<span class="hljs-number"><span class="hljs-number">1</span></span>, :] = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] X_test[<span class="hljs-number"><span class="hljs-number">2</span></span>, :] = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>] X_test = np.reshape(X_test, (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)) y_predicted = model.predict(X_test) print(y_predicted)</code> </pre><br><br>  ูู ูุฐุง ุงููุซุงู ุ ูุฑู ุฃู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูููููุง ุชุบููุฑ ุงูุชูุจุค ุฏููุงูููููุง ููููุง ูููุนูููุงุช ุงููุงุฑุฏุฉ.  ุณููุนู ููุณ ุงูุดูุก ุ ูู ูุญุงููุฉ ููุชูุจุค ุจุชุณูุณู ูุนูู: ุนูุฏูุง ุชุณูุญ ููุง ุงููุนูููุงุช ุงููุชุงุญุฉ ุจุชูุฏูุฑ ุงุญุชูุงูุงุช ุงููุชุงุฆุฌ ูู ุงูุฎุทูุฉ ุงูุชุงููุฉ ุ ูุฅููุง ูุชููุน ุงุณุชูุงุฏูุง ุฅูู ูุฐู ุงููุนูููุงุช ุ  ูููู ุนูุฏูุง ููุชุดู ูุนูููุงุช ุฅุถุงููุฉ ูู ุงูุฎุทูุฉ ุงูุชุงููุฉ ุ ูุฅููุง ูุบูุฑ ุงูุชููุนุงุช ุงุนุชูุงุฏูุง ุนูููุง. <br>  ูุฐูู ุ ุฅุฐุง ุฑุฃููุง ุฃู ููุงู ุดุฎุตูุง ูุงุฏู ุฅูููุง ูู ุงูุธูุงู ุ ูุญููุฆุฐู ูููู "ูุฐุง ุดุฎุต ุ ูุง ูุนุฑู ุจูุฒูุฏ ูู ุงูุชูุงุตูู" ุ  ุนูุฏูุง ูุจุฏุฃ ูู ุงูุชูููุฒ ุจูู ุงูุดุนุฑ ุงูุทููู ูู ุงูุธูุงู ุ ูููู "ุฑุจูุง ูุฐู ุงูุฑุฃุฉ".  ููู ุฅุฐุง ุงุนุชุจุฑูุง ุจุนุฏ ุฐูู ุฃู ุงูุดุฎุต ูุตุงุจ ุจุดุงุฑุจ ุ ูุฅููุง ูููู ุฃูู ูู ุงููุญุชูู ุฃู ูููู ุฑุฌูุงู (ูุฅู ูุงู ุจุดุนุฑ ุทููู).  ููุง ุฑุฃููุง ุ ุชุนูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุจุดูู ูุดุงุจู ุ ุจุงุณุชุฎุฏุงู ุงููุนูููุงุช ุงููุชููุฑุฉ ุญุงูููุง ููุชูุจุค. <br><br>  ูุฐูู ุ ูุธุฑูุง ูู ุฃูุซูุฉ ุจุณูุทุฉ ุนู ููููุฉ ุนูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ูุงูุฃููุงุท ุงูุชู ูููู ุฃู ุชุฌุฏูุง.  ุจุดูู ุนุงู ุ ุฑุฃููุง ุฃู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุบุงูุจูุง ูุง ุชุชุตุฑู "ุจุดูู ูุนููู" ุ ููุง ูุฌุนู ุงูุชูุจุคุงุช ูุฑูุจุฉ ูู ุชูู ุงูุชู ูุฏ ูููู ุจูุง ุงูุดุฎุต.  ุนูู ุงูุฑุบู ูู ุฃูู ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูู ุฃุฌู ุงูุชูุงุท ุฃููุงุท ุจุณูุทุฉ ุ ูุฅููุง ุชุญุชุงุฌ ุฅูู ุจูุงูุงุช ุฃูุซุฑ ุจูุซูุฑ ูู ุงููุงุณ. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar467895/">https://habr.com/ru/post/ar467895/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar467883/index.html">Kubernetes 1.16 - ููููุฉ ุงูุชุฑููุฉ ูููุณ ูุณุฑ ุฃู ุดูุก</a></li>
<li><a href="../ar467885/index.html">ููุงุฌู ุงูููุชุฌุงุช ูุงููุทุงุนุงุช</a></li>
<li><a href="../ar467887/index.html">ุชุฃููุงุช ูุงููุฉ ูุงูุนูุฉ</a></li>
<li><a href="../ar467891/index.html">ุงูุชุนูููุงุช ุญูู ุณุญุงุจุฉ [ุงูุฅููุชุฑูููุฉ] ุงูุชูููุน</a></li>
<li><a href="../ar467893/index.html">ูุฌุฑุฏ ุงูุชูุงู ููู ุชู ุขุฎุฑ ู gRPC ู protobuf</a></li>
<li><a href="../ar467897/index.html">ุฃุฏูุงุช ุงูุงุฎุชุจุงุฑ ุงูุชููุงุฆู ุ ูุชูุงูู Yandex Mapkit 3 ุ ูุงูุชุตููู ุงูุฑุงุฆุน ุ ูููุฌ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุนูู ุงูุฎุงุฏู - ุฅุนูุงู Android mitap</a></li>
<li><a href="../ar467901/index.html">ุฏุญุถ ุฃุฑุจุนุฉ ููุงูุจ ููุทูุฉ ุนู ูุบุฉ ุจุฑูุฌุฉ ุงูุตุฏุฃ</a></li>
<li><a href="../ar467903/index.html">ุฃูุถู 20 ููุฒุฉ ููุชููู ูู IntelliJ IDEA. ุงูุฌุฒุก 1</a></li>
<li><a href="../ar467905/index.html">ููู ุญูููุง ุนูุงูุฉ ูุงุฑูุฉ ูู Cloud Mail.ru ุ ูููุงุฐุง</a></li>
<li><a href="../ar467907/index.html">ุฅูุฌุงุจูุงุช ูุณูุจูุงุช ุงูุงุณุชุนุงูุฉ ุจูุตุงุฏุฑ ุฎุงุฑุฌูุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>