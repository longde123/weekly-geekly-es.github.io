<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✊🏼 ⛱️ 🌼 Rendre votre filtrage d'appels Google basé sur Voximplant et Dialogflow 🥃 🙏🏻 👩‍👩‍👧‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vous avez peut-être entendu parler de la fonction de filtrage d'appels que Google a déployée pour ses téléphones Pixel aux États-Unis ou en a lu. L'id...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rendre votre filtrage d'appels Google basé sur Voximplant et Dialogflow</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/Voximplant/blog/468725/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/vw/-r/19/vw-r19phrw9n5inmek0ntdxd0eo.png"></div><br>  Vous avez peut-être entendu parler de la fonction de filtrage d'appels que Google a déployée pour ses téléphones Pixel aux États-Unis ou en a lu.  L'idée est excellente - lorsque vous recevez un appel entrant, l'assistant virtuel commence à communiquer, pendant que vous voyez cette conversation sous la forme d'un chat et à tout moment, vous pouvez commencer à parler à la place d'un assistant.  C'est très utile de nos jours, lorsque près de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">moitié des appels sont du spam</a> , mais que vous ne voulez pas manquer des appels importants d'une personne en dehors de votre liste de contacts.  Le seul hic, c'est que cette fonctionnalité n'est disponible que sur le téléphone Pixel et uniquement aux États-Unis.  Eh bien, des obstacles existent pour les surmonter, non?  Par conséquent, nous avons décidé de dire comment prendre une telle décision en utilisant Voximplant et Dialogflow.  Je demande un chat. <br><a name="habracut"></a><br><h2>  L'architecture </h2><br>  Je suggère de ne pas perdre de temps à expliquer comment fonctionnent Voximplant et Dialogflow, si vous le souhaitez, vous pouvez facilement trouver des informations sur Internet.  Alors familiarisons-nous avec le concept même de notre filtrage d'appels. <br><br>  Supposons que vous ayez déjà un numéro de téléphone que vous utilisez tous les jours et auquel vous recevez des appels importants.  Dans ce cas, nous avons besoin d'un deuxième numéro, qui sera indiqué partout - par la poste, sur une carte de visite, lorsque vous remplissez des formulaires en ligne, etc.  Ce numéro sera connecté au système de traitement du langage naturel (dans notre cas, Dialogflow) et ne transfèrera les appels vers votre numéro principal que si vous le souhaitez.  Sous la forme d'un diagramme, il ressemble à ceci (l'image est cliquable): <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/et/kf/qf/etkfqfpoxq2bwlgicp2bd0kqges.png"></div><br>  Comprendre l'architecture, nous pouvons prendre en charge la mise en œuvre, mais avec une mise en garde: nous ne ferons pas une application <b>mobile</b> pour afficher un dialogue entre Dialogflow et un abonné entrant, nous allons créer une application <b>Web</b> simple avec un moteur de dialogue pour montrer visuellement comment fonctionne le filtrage d'appels.  Dans cette application, il y aura un bouton Intervenir, en appuyant sur lequel Voximplant connectera l'abonné entrant à l'abonné composé, si ce dernier a décidé de parler seul. <br><br><h2>  Implémentation </h2><br>  Connectez-vous à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">votre compte Voximplant</a> et créez une nouvelle application, par exemple, le filtrage: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/19/ah/ur/19ahurbifa0izkqvcmjlzghfaz8.jpeg" width="500"></div><br>  Ouvrez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la section "Numéros"</a> et achetez un numéro qui servira d'intermédiaire: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8l/vy/jp/8lvyjpmjd53b3bfcp4uk9otd6yu.jpeg" width="600"></div><br>  Ensuite, accédez à l'application de filtrage, dans la section "Numéros", l'onglet "Disponible".  Ici, vous verrez le numéro que vous venez d'acheter.  Attachez-le à l'application en utilisant le bouton "Attach" - dans la fenêtre qui apparaît, laissez toutes les valeurs par défaut et cliquez sur "Attach". <br><br>  À l'intérieur de l'application, accédez à l'onglet Scripts et créez un script de masquage - nous y utilisons le code de l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment utiliser Dialogflow Connector</a> .  Dans ce cas, le code sera légèrement modifié, car nous devons «voir» le dialogue entre l'appelant et l'assistant;  tout le code peut être <a href="">pris ici</a> . <br><br>  ATTENTION: vous devrez remplacer la valeur de la variable serveur par le nom de votre serveur ngrok (les détails sur ngrok seront un peu inférieurs).  Remplacez également vos valeurs à la ligne 31, où votre numéro de téléphone est votre numéro principal (par exemple, votre numéro de mobile personnel) et le numéro voximplant est le numéro que vous avez récemment acheté. <br><br><pre><code class="javascript hljs">outbound_call = VoxEngine.callPSTN(“YOUR PHONE NUMBER”, “VOXIMPLANT NUMBER”)</code> </pre> <br>  Un appel callPSTN aura lieu au moment où vous décidez d'interrompre la conversation et de discuter personnellement avec l'abonné entrant. <br><br>  Après avoir enregistré le script, vous devez le lier au numéro acheté.  Pour ce faire, tout en restant dans votre application, allez dans l'onglet «Routage» pour créer une nouvelle règle - le bouton «Nouvelle règle» dans le coin supérieur droit.  Spécifiez un nom (par exemple, tous les appels), laissez le masque par défaut (. * - ce qui signifie que tous les appels entrants seront traités par les scripts sélectionnés pour cette règle) et spécifiez le script myscreening. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pj/ph/vi/pjphvix6tz0bdkvws287hqrhly4.jpeg" width="600"></div><br>  Enregistrez la règle. <br><br>  Désormais, le numéro de téléphone est lié au script.  La dernière chose à faire est d'attacher le bot à l'application.  Pour ce faire, allez dans l'onglet «Dialogflow Connector», cliquez sur le bouton «Ajouter Dialogflow Agent» dans le coin supérieur droit et téléchargez le fichier JSON de votre agent Dialogflow. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/au/6m/78/au6m78kmtwelulba2huvqhrt4rc.jpeg" width="500"></div><br>  Si vous avez besoin d'un agent par exemple / testing, vous pouvez prendre le nôtre à ce lien: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/aylarov/callscreening/tree/master/dialogflow</a> .  Ne lui demandez pas grand-chose, ce n'est qu'un exemple que vous êtes libre de refaire comme vous le souhaitez et de partager les résultats avec audace :) <br><br><h2>  Backend simple sur NodeJS </h2><br>  Déployons un simple backend sur un nœud, par exemple, ceci: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/aylarov/callscreening/tree/master/nodejs</a> <br><br>  Il s'agit d'une application normale qui ne nécessite que deux commandes pour s'exécuter: <br><br><pre> <code class="bash hljs">npm install node index.js</code> </pre><br>  Le serveur démarrera sur le port 3000 de votre machine, donc pour le connecter au cloud Voximplant, nous utilisons l'utilitaire ngrok.  Lorsque vous installez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ngrok</a> , exécutez-le avec la commande: <br><br><pre> <code class="bash hljs">ngrok http 3000</code> </pre> <br>  Vous verrez le nom de domaine que ngrok a généré pour votre serveur local - copiez-le et remplacez-le dans la variable serveur. <br><br><h2>  Client </h2><br>  L'application client ressemble à un simple chat que vous pouvez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">récupérer à partir d'ici</a> . <br><br>  Copiez simplement tous les fichiers dans un répertoire de votre serveur Web et cela fonctionnera.  Dans le fichier script.js, remplacez la variable serveur par le nom de domaine ngrok et la variable appelée par le numéro que vous avez acheté.  Enregistrez le fichier et lancez l'application dans un navigateur.  Si tout est en ordre, vous verrez une connexion WebSocket dans le panneau du développeur. <br><br><h2>  Démo </h2><br>  Vous pouvez voir l'application en action sur cette vidéo: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/i9jz0fChNeM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  PS Si vous cliquez sur le bouton Intervenir, l'appelant sera dirigé vers mon numéro de téléphone, et si vous cliquez sur Déconnecter, ce sera ...?  Certes, l'appel sera déconnecté. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr468725/">https://habr.com/ru/post/fr468725/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr468713/index.html">Projet d'échange légal de crypto-monnaie</a></li>
<li><a href="../fr468715/index.html">Expérience de développement de test React pour Aviasales</a></li>
<li><a href="../fr468719/index.html">Développement de système d'exploitation de type Unix - Shell. Conclusion (9)</a></li>
<li><a href="../fr468721/index.html">Retentioneering: comment nous avons écrit les outils d'analyse de produits open-source en Python et Pandas</a></li>
<li><a href="../fr468723/index.html">JS Design Patterns: Patterns de création d'objets</a></li>
<li><a href="../fr468727/index.html">Lenovo ThinkShield: une puissante suite d'options et de services protège la sécurité des PC d'entreprise</a></li>
<li><a href="../fr468729/index.html">Nous appliquons les actions github pour CI et la publication automatique sur npm</a></li>
<li><a href="../fr468731/index.html">Excellente FAQ sur l'excellence quantique par Scott Aaronson</a></li>
<li><a href="../fr468733/index.html">Apprenez Bootstrap rapidement avec ces 10 conseils utiles</a></li>
<li><a href="../fr468735/index.html">Télécharger de la musique VKontakte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>