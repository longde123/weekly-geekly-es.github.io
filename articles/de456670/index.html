<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍⚕️ 👁️ 👨🏿‍💻 Über die Spionageauthentifizierungsmethode 👩🏽‍🤝‍👩🏼 😚 📺</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Also schicken wir die Super-Geheimagenten Alice und Bob in ein verdecktes feindliches Land. Während der Mission müssen sie Kontakt aufnehmen und zusam...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Über die Spionageauthentifizierungsmethode</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456670/"><p> Also schicken wir die Super-Geheimagenten Alice und Bob in ein verdecktes feindliches Land.  Während der Mission müssen sie Kontakt aufnehmen und zusammenarbeiten, Informationen austauschen, gewöhnliche Spionageangelegenheiten.  All dies muss natürlich unter Einhaltung aller möglichen Regeln und Sicherheitsverfahren erfolgen. </p><br><p>  In der letzten Runde wollen wir sie aufdecken: Sowohl die Mission selbst als auch die Agenten selbst und die gesamte nationale Sicherheit sind gefährdet.  Daher liegt es in unserem Interesse, Spionen die minimal notwendigen Informationen zu geben.  Insbesondere, je weniger sie voneinander und von den Kommunikationstechniken wissen, desto besser. </p><br><p>  Aber wie werden sie dann ihren Kameraden im Hauptquartier identifizieren? </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ceb/454/721/ceb4547217be4972a9e5f8fe323cf257.gif" alt="KDPV"></p><br><p>  TL; DR - Erfindung eines Benutzerauthentifizierungsmechanismus unter Verwendung der Steganographie für eine imaginäre dreistellige Agentur eines nicht existierenden Landes. </p><a name="habracut"></a><br><h2 id="o-volkah-i-ovechih-shkurah">  Über Wölfe und Schafsfelle </h2><br><p>  Ein Cover ist ein Cover, daher sollten weder Alice noch Bob durch eine ihrer Handlungen Verdacht erregen.  Eine ordnungsgemäße Planung impliziert Paranoia hinsichtlich der ständigen Überwachung auf allen möglichen Ebenen.  Dieser Beitrag befasst sich nicht mit der Aufgabe des direkten Informationsaustauschs (er verdient eine eigene Reihe), sondern nur mit einer Möglichkeit, sicherzustellen, dass er von denjenigen, die ihn benötigen, an jeden weitergegeben wird, der ihn benötigt. </p><br><p>  Höchstwahrscheinlich werden beide Spione eine Geschichte im Format gewöhnlicher Bürger haben, die in keiner Weise miteinander verbunden ist.  Daher müssen Sie sofort ein Veto gegen die Verwendung klassischer kryptografischer Tools und sicherer Kanäle einlegen - jeder Spionageabwehragent weiß, dass ehrliche Menschen, die keine enge Beziehung haben, nichts zu verbergen haben. </p><br><h2 id="chto-delat">  Was zu tun ist? </h2><br><p>  Natürlich ist eine solche Aufgabe nicht neu, sie existierte glücklich und wurde lange vor dem Aufkommen dieser in Ihrem Internet gelöst.  Und es wurde nicht nur entschieden, so dass einige Entscheidungen in der Kultur gestärkt wurden und immer noch in Büchern, Filmen und Spielen zu finden sind. </p><br><p>  Schauen wir uns eine solche Szene an: Zwei Menschen in langen Mänteln kommen an einem öffentlichen Ort zusammen und tauschen sehr seltsame Sätze aus.  Wenn der einleitende Satz und die Antwort korrekt sind, war die Authentifizierung erfolgreich, und die Benutzer tauschen Ordner mit der Bezeichnung "Top Secret" aus und weichen in unbekannte Richtungen ab. </p><br><p>  Der Nachteil eines solchen Schemas liegt auf der Hand - Phrasen müssen geheim gehalten und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">oft geändert werden</a> , was im feindlichen Gebiet nicht sehr einfach ist.  Gleichzeitig werden sie, um nicht zufällig ausgesprochen zu werden und nicht zum Fall von KDPV zu führen, ziemlich prominent und zufällig, was bedeutet, dass sie Agenten ausgeben können, die sie aussprechen. </p><br><p><img src="https://habrastorage.org/webt/pl/pe/sh/plpeshe7ifcmijrxlaziosekgey.png"></p><br><p>  Im Zeitalter der digitalen Technologie mögen wir diese Methode nicht.  Vor allem, wenn Sie sich daran erinnern, dass fast alle Kommunikationskanäle von jemandem gesteuert werden und sowohl für gute als auch für schlechte Motive genutzt werden.  Und egal, was sie uns versichern, das Leben der Menschen sollte in der Datenschutzrichtlinie von Facebook nicht als vertrauenswürdig eingestuft werden. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/984/c5d/c5d/984c5dc5dae5cba450b58907693ceed6.png"></p><br><h2 id="steganografiya-opyat">  Steganographie (schon wieder?) </h2><br><p>  Igel es ist klar, dass die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fähigkeit, sich in einer</a> solchen Situation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zu verstecken,</a> attraktiver als je zuvor aussieht.  Tatsächlich handelt es sich bei der beschriebenen Methode sogar um die Unterart - Codephrasen können als Container mit nur einer Information betrachtet werden. </p><br><p>  Das gleiche Säugetier der Insektenfresser-Abteilung versteht, dass es nicht nur darum geht, Stegocontainer gegeneinander zu werfen.  Ein solcher Austausch wird fast mehr Verdacht erregen als eine übliche PGP-Verschlüsselung, daher sind wir nicht interessiert. </p><br><h3 id="a-o-chem-togda">  Was ist dann? </h3><br><p>  Im Gegensatz zu Kryptogrammen haben Stegocontainer einen offensichtlichen Vorteil - den Anwendungskontext.  Jeder Text, jedes Bild, jede Audiodatei usw. bietet neben dem offensichtlichen Inhalt auch die Möglichkeit einer <strong>natürlichen</strong> Diskussion und kann nicht nur aus der Bucht gesendet werden, sondern auch während eines Dialogs, der keinen Verdacht erregt. </p><br><p>  Mit genau diesen Ideen können wir bereits ein einfaches steganografisches Authentifizierungsprotokoll erstellen, das auf einem gemeinsamen Schlüssel basiert: </p><br><ul><li>  A -&gt; B: eine hübsche Nachricht, die einen steganografischen Container mit bestimmten Parametern anfordert; </li><li>  B: wählt Container <em>C aus</em> , der dem angeforderten Kontext und den angeforderten Parametern entspricht; </li><li>  B: erzeugt auf ähnliche Weise eine Nachricht <em>M</em> ; </li><li>  B -&gt; A: <em>C '= Einbetten (C, M, K)</em> ; </li><li>  A: Überprüft <em>C '</em> auf Übereinstimmung mit den eingestellten Parametern; </li><li>  A -&gt; B: <em>M '= Extrakt (C', K)</em> ; </li><li>  B: Überprüft, ob <em>M</em> und <em>M '</em> übereinstimmen. </li></ul><br><p>  Ein solches Protokoll hat offensichtliche Nachteile - Alice und Bob müssen sowohl einen gemeinsamen Schlüssel als auch Einbettungs- und Extraktionsfunktionen haben.  Ihr Kompromiss kann zu einer detaillierten Analyse der Authentifizierungsmethode des Feindes führen und sowohl andere Benutzer als auch das Hauptquartier gefährden.  Es muss etwas repariert werden. </p><br><h2 id="ispolnitel-ne-cherepashka">  Der Künstler ist kein Käfer </h2><br><p>  Wenn der Leser nach dem Aufkommen des Computerunterrichts zur Schule ging, sollte er sich daran erinnern, die Grundlagen der Algorithmusisierung mit dem Darsteller einer Schildkröte, einer Ameise und dergleichen gelernt zu haben.  Ihre Idee war es, die Möglichkeiten der Optimierung einer großen Anzahl manueller Einzelaktionen durch die Erstellung einfacher Programme aufzuzeigen.  Um unser Problem zu lösen, müssen wir in die entgegengesetzte Richtung gehen. </p><br><p><img src="https://habrastorage.org/webt/nc/lo/lo/nclolotljunb2zzbkgr2-4qo0ri.png" alt="Ist es nicht süß?"></p><br><p>  Da wir das Schreiben des endgültigen Algorithmus von der Abfolge der Schritte bis zu ihrer prozeduralen Beschreibung gemäß den angegebenen Parametern vereinfachen können, können wir den inversen Prozess ausführen.  Wenn Sie sich einen Container als Array einiger seiner Komponenten vorstellen, kann das Einbetten einer Nachricht per Schlüssel als geordnete Folge von Operationen an Containerelementen an bestimmten Indizes mit verschiedenen konstanten Parametern geschrieben werden. </p><br><p>  Hier beginnt die Nichtmathematik, daher bitte ich die Schüchternen, einfach durch die schwierig aussehenden Absätze zum Operationsabschnitt oder sogar ein wenig weiter zu blättern.  Ich verspreche, dass nichts Schreckliches passieren wird. </p><br><p>  Um die Daten einzubetten, benötigen wir eine Folge der Form: <em>(f1, S1, i, D1), (f2, S2, j, D2) ...</em> , wobei: </p><br><ul><li>  <em>Di</em> - ein Teil der eingebetteten Daten; </li><li>  <em>i, j</em> sind die Indizes der Elemente des Containers; </li><li>  <em>fi: (Zustand, Element, D) -&gt; (Zustand, Element)</em> - Einbettungsfunktion; </li><li>  <em>Si</em> ist ein bestimmter Zustand, der Kontext der Operation <em>(El ', S [i + 1]) = fi (Si, El, Di)</em> . </li></ul><br><p>  Um es zu extrahieren, müssen Sie keine Teile der Daten (K.O.) speichern, daher gibt es genügend Tripel: <em>(g1, S1, I1), (g2, S2, I2) ...</em> mit denselben Werten, nur <em>gi: (State, Element) -&gt; (Staat, D)</em> . </p><br><p>  All dies kann durch das folgende symmetrische Diagramm dargestellt werden.  Wenn ich es aus irgendeinem Grund nicht geschafft habe, Klarheit zu erreichen, ist es nicht beängstigend, lesen Sie einfach weiter. </p><br><p><img src="https://habrastorage.org/webt/l7/yk/pk/l7ykpkwfi8sfkcebwxryswzo1r0.png" alt="Gut oder nicht mehr"></p><br><p>  Es ist ersichtlich, dass die Einbettungsfunktion eine größere Anzahl von Freiheitsgraden aufweist.  Im Gegensatz zu ihrer Schwester ändert sie den Container auf der Grundlage von zwei unabhängigen Elementen - eingebetteten Daten und dem Element.  Dank oder genauer gesagt aus diesem Grund sind zwei globale Ansätze zur Implementierung des Steganographiealgorithmus durch ein solches System möglich: </p><br><ol><li>  Wählen Sie die am besten geeigneten Indizes der Elemente aus, die entsprechend der Einbettungsfunktion geändert werden sollen (am wenigsten wahrnehmbar oder überhaupt nicht erforderlich), und übertragen Sie die gebildete Sequenz, die an einen bestimmten Container gebunden ist.  Bei diesem Ansatz müssen sie voneinander isoliert werden, bevor die Einbettung mit klassischen Methoden wie Verschlüsselung und anderen sicheren Medien erforderlich wird. </li><li>  Finden Sie eine solche Methode zum Teilen des Containers in Elemente und die Einbettungsfunktion, dass jede erwartete Änderung durch ihn gleichermaßen unsichtbar ist.  In diesem Fall ist die Sequenz unabhängig vom Container und kann sogar von einem vollständig zufälligen Generator erstellt werden.  Weniger Flexibilität und mangelnde Kontrolle über den schlimmsten Fall gehen.  Auf der anderen Seite ist dieser Ansatz einfacher und bequemer, wenn er vor Ort angewendet wird. Im Folgenden werde ich ihn daher verwenden. </li></ol><br><p>  Wenn der Status für den Algorithmus nicht erforderlich ist, bleibt alles oben Genannte gültig, einfach ohne einen einzelnen Buchstaben und Block im Diagramm.  Ohne das ist es sogar noch einfacher. </p><br><h2 id="i-zachem-ono-nam">  Und warum brauchen wir das? </h2><br><p>  Wenn Sie jetzt im Voraus wissen, welche Container mit welchen Nachrichten und Schlüsseln verwendet werden, können Sie Agenten zur Verwendung nur solcher Sequenzen und einen Interpreter für diese generieren und angeben, anstatt die Teile des Algorithmus vollständig zu enthüllen.  Na gut, natürlich nicht nur geben, sondern später mehr dazu. </p><br><h3 id="dobavlyaem-asimmetrichnost">  Asymmetrie hinzufügen </h3><br><p>  Sogar ein Schildkrötenkünstler kann ein Quadrat auf Hunderte von verschiedenen Arten zeichnen, indem er einfach die Reihenfolge der Operationen ändert und neue hinzufügt.  Dies bedeutet, dass uns niemand stört und dasselbe mit den beschriebenen Sequenzen für feste Eingabedaten tut. </p><br><p>  Das heißt, wir können die Einbettungssequenz übernehmen, neue Operationen hinzufügen, alles mischen und so, dass das Ergebnis gleich bleibt.  Es sei denn, bei Vorhandensein eines Zustands muss dieser verfolgt und die erforderlichen Änderungen an der Sequenz separat hinzugefügt werden.  Deshalb ist es ohne einfacher einfacher, ja. </p><br><p>  Auf die eine oder andere Weise kann selbst der Einbettungskünstler nach einem solchen Kneten und Rauschen nicht mehr verstehen, was er tatsächlich einbettet: Jede Folge von <em>N</em> Operationen repräsentiert <em>N!</em>  potenziell eingebettete Nachrichten - eine für jede Permutation der eingebetteten Teile.  Gleichzeitig ist <em>N</em> selbst eine große Frage.  Daher kann man solche Sequenzen als offen bezeichnen - sie liefern weder Informationen über die eingebettete Nachricht noch über den verwendeten Algorithmus und Schlüssel. </p><br><p>  Beim Extrahieren von Informationen ist es für uns sowohl die Reihenfolge (um die gleiche korrekte Nachricht von allen möglichen wiederherzustellen) als auch die Anzahl der zu extrahierenden Teile sehr wichtig, damit die Extraktionssequenzen vom Moment der Geburt an unverändert bleiben.  Da sie implizit Informationen über den verwendeten Schlüssel, Generator und Algorithmus enthalten, müssen sie wie Tiere aus dem Roten Buch gespeichert und geschützt werden.  Und halte es geheim. </p><br><p>  Was hat Asymmetrie damit zu tun?  Tatsache ist, dass jetzt jede Extraktionssequenz einer unendlichen Anzahl von Einbettern zugeordnet ist.  Und das Wiederherstellen voneinander ist im Allgemeinen eine unlösbare Aufgabe. </p><br><h3 id="ekspluatiruem">  Wir operieren </h3><br><p>  Wir vergessen jede mathematische Nähe und kehren zur ursprünglichen Aufgabe zurück - wie können wir Alice und Bob in feindliches Gebiet schicken, um: </p><br><ul><li>  Sie kannten sich nicht </li><li>  hatte keine geheimen Algorithmen zur Hand </li><li>  Aber könnten Sie sich gegenseitig verifizieren, während Sie auf einem offenen Kanal kommunizieren? </li></ul><br><p>  Nun, mit dem ersten Absatz ist alles klar, wir geben ihnen nur keine expliziten Informationen über einander, keine gemeinsamen Schlüssel.  Für den zweiten müssen Sie sich die Beschreibung des obigen Protokolls merken.  Jetzt können wir die <em>Einbettungs-</em> und <em>Extraktionsalgorithmen</em> , die potenzielle Zustandsgeheimnisse darstellen, und all das direkt ausschließen.  Und unter Berücksichtigung dessen ist es für das dritte möglich, das folgende zweistufige Protokoll zu erstellen. </p><br><p>  Generierung von Authentifizierungsinformationen <strong>vor Beginn der Mission</strong> mit Hauptsitz als vertrauenswürdige Partei von Trient: </p><br><ul><li>  T: wählt den geheimen Algorithmus und den geheimen Schlüssel K aus, erstellt mit deren Hilfe: <br><ul><li>  Sequenz extrahieren <em>Bsp</em> .; </li><li>  geeignet zur Authentifizierung (unten) <em>Ctx-</em> Kontext; </li></ul></li><li>  T -&gt; A: <em>Ctx, Ex</em> ; </li><li>  T: Mit <em>Ex</em> und dem erstellten Kontext wird Folgendes generiert: <br><ul><li>  Nachricht <em>M</em> , die zuvor für die ausgewählten Agenten aus den Teilen <em>| Ex | nicht verwendet wurde</em>  ;; </li><li>  eine einmalige Folge von <em>Em</em> , die es wie oben beschrieben öffnet; </li></ul></li><li>  T -&gt; B: <em>Em, h (M) erzeugt</em> , falls gewünscht, zusätzliche Mengen. </li></ul><br><p>  Somit hat Alice nur eine Sequenz für alle Gelegenheiten und den Kontext des zukünftigen Kontakts, und Bob wird der glückliche Besitzer einer Reihe von einmaligen Sequenzen und Nachrichten-Hashes, die sie einbetten. </p><br><p>  Das Authentifizierungsprotokoll bereits <strong>während der Mission</strong> sieht folgendermaßen aus: </p><br><ul><li>  A -&gt; B: eine initiierende <em>IM-</em> Nachricht basierend auf dem <em>Ctx-</em> Kontext mit einer Beschreibung des Containers; </li><li>  B: wählt das geeignete <em>C ~ IM aus</em> ; </li><li>  B -&gt; A: <em>C '= Em (C)</em> ; </li><li>  A: prüft die Einhaltung von <em>C '~ IM</em> (da die Änderungen unsichtbar sind, sollten sie gespeichert werden); </li><li>  A -&gt; B: <em>M '= Ex (C')</em> , markiert M 'als verwendet; </li><li>  B: prüft, <em>h (M ') == h (M)</em> , zerstört <em>Em, h (M)</em> . </li></ul><br><p>  Ein aufmerksamer Leser wird feststellen, dass Alice und Bob vor dem Protokoll nur eine Reihe von Informationen haben, die an sich weder für sie noch für einen potenziellen Gegner etwas bedeuten, und zwar nur während des "Spiels mit Farben". </p><br><p>  Jeder offene Satz von Bob wird nur einmal verwendet, was durch den vorletzten Schritt von Alice gesteuert wird.  Wenn sie ein zuvor verwendetes <em>M</em> (und daher <em>von</em> ihr unsichtbares <em>Em</em> ) einer anderen Person trifft, stellt sie fest, dass einer ihrer "Mitarbeiter" eine Fälschung ist. </p><br><p>  Die wiederholte Verwendung durch dieselbe Person sagt ihr, dass sie sich der Feinheiten des Protokolls nicht bewusst ist und sicherlich nicht diejenige ist, mit der sie Kontakt aufnehmen musste.  Besser spät als nie. </p><br><p><img src="https://habrastorage.org/webt/bv/6v/0h/bv6v0hcim8kmzndrvn5__thsp1y.png"></p><br><p>  Okay, so sieht alles zu kompliziert und unverständlich aus.  Hat jemand hier? </p><br><p>  Lassen Sie es uns in der Praxis besser demonstrieren, denn selbst die Spione selbst müssen die Details des Protokolls nicht kennen, geschweige denn arme Leser.  Zunächst nur ein wenig darüber, wie alles umgesetzt wurde. </p><br><h2 id="vysokie-tehnologii">  Hightech </h2><br><p>  Es bleibt also nur alles zu schreiben, was für das Protokoll notwendig ist.  Du machst nicht alles mit deinen Händen (obwohl du kannst).  Und heute wird das Opfer meines Codes ... <em>das Glücksrad drehen</em> ... Java?  Okay, zur gleichen Zeit wird alles in STL sein, Sie müssen nichts suchen. </p><br><p>  Beginnen wir mit der erforderlichen API.  Um zu arbeiten, müssen Sie nur die Klasse des Arrays von Containerelementen bestimmen, die Elemente nach Index empfangen und ändern können: </p><br><pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyContainer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StegoContainer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyElement</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> MyElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  i-  } public void set(int i, MyElement v) { //  i-  } public int size() { //    } }</span></span></code> </pre> <br><p>  Die weitere Verwendung beschränkt sich darauf, einen Wrapper eines steganografischen Automaten über dem erforderlichen Container zu erstellen und die Funktionen zum Einbetten und Extrahieren seiner Eingabe bereitzustellen: </p><br><pre> <code class="java hljs">StegoMachine&lt;MyState, MyElement&gt; myMachine = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StegoMachine( initialState, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyContainer&lt;MyElement&gt;(<span class="hljs-comment"><span class="hljs-comment">/*   */</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> StegoEmbed myEmbed = (st, el, dp) -&gt; { <span class="hljs-comment"><span class="hljs-comment">//    dp   el   st }; final StegoExtract myExtract = (st, el) -&gt; { //     el   st return dp; }; //    MyDataPart part = /*    */; myMachine.exec(1337, myEmbed, part); //... //    /,   //      State currState = myMachine.getState(); //... //    part = myMachine.exec(80085, myExtract); //... //        MyContainer container = (MyContainer) myMachine.getContainer();</span></span></code> </pre> <br><p>  Klassen mit dem Suffix Stateless werden auf die gleiche Weise verwendet, wenn für die Implementierung des Algorithmus der interne Status nicht beibehalten werden muss. </p><br><p>  Sequenzgeneratoren können nach Belieben arbeiten und haben keine gemeinsame API.  Im allgemeinen Fall kann alles Teil der Daten im Allgemeinen sein, von Einzelbits bis hin zu Felszeichnungen in einer separaten Codierung. </p><br><h3 id="primer-realizacii">  Implementierungsbeispiel </h3><br><h4 id="o-metode">  Über Methode </h4><br><p>  Als Beispiel für die Implementierung habe ich unter Verwendung der erstellten Schnittstellen einen einfachen Algorithmus aus der LSB-Familie für Bitmap-Bilder mit verlustfreier Komprimierung implementiert.  Ihre Elemente sind Pixel, die keine Nachbarn im niedrigstwertigen Bit aller RGB-Komponenten haben.  Die Einbettungsfunktion arbeitet mit einzelnen Bits der Quelldaten und ändert einfach das niederwertige Bit des Werts einer der Komponenten (auf den der Index verweist). </p><br><p>  Es ist recht einfach, aber es eignet sich hervorragend für die Implementierung des Protokolls, da das Ändern eines Elements je nach Auswahl gleichermaßen nicht wahrnehmbar ist. Generieren Sie daher Indizes der zu ändernden Elemente mithilfe eines Zufallsgenerators.  Im Fall von Java wird mithilfe von <em>SecureRandom</em> , falls gewünscht, leicht die Entropiequelle geändert. </p><br><p>  <em>Trotzdem ist dies eine sehr einfache Methode, die ich echten Spionen nicht empfehlen kann.</em> </p><br><h4 id="o-heshah">  Über Hashes </h4><br><p>  Da der Text abhängig von der simulierten Identität des Agenten tendenziell verzerrt ist (einige setzen keine Großbuchstaben, andere setzen gerne Emoticons usw., andere sind im Allgemeinen Analphabeten), empfehle ich die Verwendung von sha256 zur Berechnung des Hashs, jedoch nur aus gedruckten Wörtern, die in Kleinbuchstaben geschrieben sind: </p><br><pre> <code class="plaintext hljs">h("Hello world?...") == h("hello, world!11")</code> </pre> <br><h4 id="ob-interfeyse">  Über die Schnittstelle </h4><br><p>  Das Softwarepaket besteht aus zwei Teilen - einem zum Generieren von Sequenzen und anderen Hashes für Trent, dem anderen zum Einbetten und Überprüfen empfangener Nachrichten auf Konformität. </p><br><p>  Die Arbeit mit beiden erfolgt über die Befehlszeile über ihre Argumente und Eingabe-Ausgabe-Streams, es wurden keine anderen Schnittstellen bereitgestellt (Angst und Entsetzen).  Um dieser Angestellte des Hauptquartiers zu sein, bedeutet der Spion dennoch, eine Qualifikation zu haben.  Wenn nicht, werde ich noch ein Beispiel zeigen. </p><br><div class="spoiler">  <b class="spoiler_title">Hier ist eine Hilfe</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/yx/1m/ge/yx1mge8ligshzbsv7hxi3olw__g.png" alt="Screenshothot der Nutzungsung"></p><br></div></div><br><h3 id="chto-im-vsem-delat-to">  Was machen sie alle? </h3><br><p>  Zunächst muss Trent im Hauptquartier Authentifizierungsinformationen ausarbeiten.  Insbesondere, um im Voraus über eine Situation nachzudenken, in der Agenten arbeiten werden. </p><br><p>  Lassen Sie Bob zum Beispiel Grafik-Freiberufler und Alice seine Kundin sein.  Die Authentifizierung erfolgt unter dem Deckmantel eines Auftrags zum Erstellen von Grafiken / Design / etwas anderem. </p><br><p>  Wir melden diese nützlichen Informationen an beide und kehren zum Protokoll selbst zurück.  Wir werden im <em>Voraus</em> eine geeignete eingebettete <em>M.txt-</em> Nachricht vorbereiten, um die Anzahl der darin enthaltenen Zeichen zu minimieren: "Es passt mir gut, wohin ich Geld überweisen soll."  Generieren Sie <em>Em</em> und <em>Ex</em> mit dem Dienstprogramm für Trent: </p><br><pre> <code class="bash hljs">Trent@HQWorkstation:~$ java -jar HQUtil.jar -ex $(<span class="hljs-built_in"><span class="hljs-built_in">stat</span></span> -c%s <span class="hljs-string"><span class="hljs-string">"M.txt"</span></span>) 4096 &gt; Ex.txt Trent@HQWorkstation:~$ cat Ex.txt | java -jar HQUtil.jar -em <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$(cat M.txt)</span></span></span><span class="hljs-string">"</span></span> 0.25 4096 &gt; Em.txt Trent@HQWorkstation:~$ cat M.txt | java -jar HQUtil.jar -h &gt; hash.bin</code> </pre> <br><p>  Hier gibt <code>$(stat -c%s "M.txt")</code> die Größe der Nachricht in Bytes und 4096 die Einschränkung des Bereichs der generierten Indizes zurück (um die Verwendung kleinerer Container zu ermöglichen).  In ähnlicher Weise wird <code>$(cat M.txt)</code> verwendet, um die Nachricht selbst an den Befehlszeilenparameter zu übergeben.  Im Prinzip können Sie auf die Bash verzichten, indem Sie Ihre eigene Handarbeit leisten, für wen es jedoch bequemer ist. </p><br><p>  <em>Ex.txt</em> wird an Alice, <em>Em.txt</em> und <em>hash.bin</em> an Bob übergeben.  Stellen Sie sich nun vor, dass die Agenten erfolgreich bereitgestellt wurden und miteinander kommunizieren möchten - wir fahren mit der Ausführung des Protokolls fort.  Bob stellt seinen Lebenslauf oder sein Stellenangebot auf einen Austausch und Alice beginnt mit der Kommunikation: </p><br><pre> <code class="plaintext hljs">: ,     %_% :        ,   .  ? : ,   </code> </pre> <br><p>  Bob sucht nach einem Bild eines Regenschirms, zeichnet es vielleicht sogar selbst, wenn die Seele kreativ ist, ein Wasserzeichen ein wenig komprimiert / auferlegt (oder was Freiberufler dort gerade tun) und tut: </p><br><pre> <code class="bash hljs">Bob@PC:~$ cat Em.txt | java -jar SpyUtil.jar -e umbrella.png</code> </pre> <br><p>  Nachdem er eine Weile gewartet hat und so getan hat, als würde er arbeiten, schickt er Alice natürlich den empfangenen Container, wobei er den Kontext berücksichtigt: </p><br><pre> <code class="plaintext hljs">: ,  ,     </code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Überträgt einen Regenschirm mit einer Nachricht, 670kb</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/qw/nk/in/qwnkinuhpppynf6ve9gkrmpnehm.png"></p></div></div><br><p>  Dadurch wird die intern gespeicherte Nachricht abgerufen: </p><br><pre> <code class="bash hljs">Alice@PC:~$ cat Ex.txt | java -jar SpyUtil.jar -e umbrella.png      </code> </pre> <br><p>  Verwandelt eine Reihe von Wörtern in einen normalen Satz und sendet ihn an Bob: </p><br><pre> <code class="plaintext hljs">: ,  ,   ?</code> </pre><br><p>  Er überprüft die Richtigkeit der Nachricht: </p><br><pre> <code class="java hljs">Bob<span class="hljs-meta"><span class="hljs-meta">@PC</span></span>:~$ java -jar SpyUtil.jar -c hash.bin <span class="hljs-string"><span class="hljs-string">",  ,   ?"</span></span> ,  ,   ? - Correct</code> </pre><br><p>  Und weiterhin einfache Kommunikation, wenn alles in Ordnung ist.  Der gesamte Dialog des Beobachters sieht ungefähr so ​​aus: </p><br><div class="spoiler">  <b class="spoiler_title">500 Kilobyte gif</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ff/ye/he/ffyeheonv4qo9dxdjygalg8kvtq.gif"></p></div></div><br><p>  Es ist klar, dass die Spionageabwehr bei all dem Abfangen nichts Verdächtiges finden wird.  Tatsächlich werden selbst die Methoden der Stegoanalyse in diesem Fall nicht immer angewendet - nun, jemand hat ein Bild eines Regenschirms für 5 Dollar bestellt und herausgefunden, wie man das Internet überrascht.  Rechenressourcen und Mitarbeiter sind nicht endlos, um jede solche Situation zu überprüfen.  Die Authentifizierung war erfolgreich, der Vorhang. </p><br><p>  -&gt; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456670/">https://habr.com/ru/post/de456670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456658/index.html">Wachstum: wie wir Fähigkeiten in einem Team bewerten</a></li>
<li><a href="../de456662/index.html">So sparen Sie mit einer testgetriebenen Entwicklung Geld für einen Therapeuten</a></li>
<li><a href="../de456664/index.html">Wen Sie verklagen müssen, wenn ein Roboter Ihr Geld verliert</a></li>
<li><a href="../de456666/index.html">WebTotem oder wie wir das Internet sicherer machen wollen</a></li>
<li><a href="../de456668/index.html">Microsoft ML Spark: Eine Spark-Erweiterung, die SparkML humaner und LightGBM als Bonus macht</a></li>
<li><a href="../de456672/index.html">Nginx-Rezepte: Asynchrone Benachrichtigungen von PostgreSQL an den Websocket</a></li>
<li><a href="../de456674/index.html">Neue Werbemöglichkeiten auf Facebook, von denen Sie nichts wussten</a></li>
<li><a href="../de456676/index.html">Anmelden in einer verteilten PHP-Anwendung</a></li>
<li><a href="../de456678/index.html">Der elektronische Zustand der Zukunft. Teil 4</a></li>
<li><a href="../de456680/index.html">Acht Namensgesetze im UX-Design (Teil 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>