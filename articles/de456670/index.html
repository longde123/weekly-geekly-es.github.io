<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äç‚öïÔ∏è üëÅÔ∏è üë®üèø‚Äçüíª √úber die Spionageauthentifizierungsmethode üë©üèΩ‚Äçü§ù‚Äçüë©üèº üòö üì∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Also schicken wir die Super-Geheimagenten Alice und Bob in ein verdecktes feindliches Land. W√§hrend der Mission m√ºssen sie Kontakt aufnehmen und zusam...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√úber die Spionageauthentifizierungsmethode</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456670/"><p> Also schicken wir die Super-Geheimagenten Alice und Bob in ein verdecktes feindliches Land.  W√§hrend der Mission m√ºssen sie Kontakt aufnehmen und zusammenarbeiten, Informationen austauschen, gew√∂hnliche Spionageangelegenheiten.  All dies muss nat√ºrlich unter Einhaltung aller m√∂glichen Regeln und Sicherheitsverfahren erfolgen. </p><br><p>  In der letzten Runde wollen wir sie aufdecken: Sowohl die Mission selbst als auch die Agenten selbst und die gesamte nationale Sicherheit sind gef√§hrdet.  Daher liegt es in unserem Interesse, Spionen die minimal notwendigen Informationen zu geben.  Insbesondere, je weniger sie voneinander und von den Kommunikationstechniken wissen, desto besser. </p><br><p>  Aber wie werden sie dann ihren Kameraden im Hauptquartier identifizieren? </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ceb/454/721/ceb4547217be4972a9e5f8fe323cf257.gif" alt="KDPV"></p><br><p>  TL; DR - Erfindung eines Benutzerauthentifizierungsmechanismus unter Verwendung der Steganographie f√ºr eine imagin√§re dreistellige Agentur eines nicht existierenden Landes. </p><a name="habracut"></a><br><h2 id="o-volkah-i-ovechih-shkurah">  √úber W√∂lfe und Schafsfelle </h2><br><p>  Ein Cover ist ein Cover, daher sollten weder Alice noch Bob durch eine ihrer Handlungen Verdacht erregen.  Eine ordnungsgem√§√üe Planung impliziert Paranoia hinsichtlich der st√§ndigen √úberwachung auf allen m√∂glichen Ebenen.  Dieser Beitrag befasst sich nicht mit der Aufgabe des direkten Informationsaustauschs (er verdient eine eigene Reihe), sondern nur mit einer M√∂glichkeit, sicherzustellen, dass er von denjenigen, die ihn ben√∂tigen, an jeden weitergegeben wird, der ihn ben√∂tigt. </p><br><p>  H√∂chstwahrscheinlich werden beide Spione eine Geschichte im Format gew√∂hnlicher B√ºrger haben, die in keiner Weise miteinander verbunden ist.  Daher m√ºssen Sie sofort ein Veto gegen die Verwendung klassischer kryptografischer Tools und sicherer Kan√§le einlegen - jeder Spionageabwehragent wei√ü, dass ehrliche Menschen, die keine enge Beziehung haben, nichts zu verbergen haben. </p><br><h2 id="chto-delat">  Was zu tun ist? </h2><br><p>  Nat√ºrlich ist eine solche Aufgabe nicht neu, sie existierte gl√ºcklich und wurde lange vor dem Aufkommen dieser in Ihrem Internet gel√∂st.  Und es wurde nicht nur entschieden, so dass einige Entscheidungen in der Kultur gest√§rkt wurden und immer noch in B√ºchern, Filmen und Spielen zu finden sind. </p><br><p>  Schauen wir uns eine solche Szene an: Zwei Menschen in langen M√§nteln kommen an einem √∂ffentlichen Ort zusammen und tauschen sehr seltsame S√§tze aus.  Wenn der einleitende Satz und die Antwort korrekt sind, war die Authentifizierung erfolgreich, und die Benutzer tauschen Ordner mit der Bezeichnung "Top Secret" aus und weichen in unbekannte Richtungen ab. </p><br><p>  Der Nachteil eines solchen Schemas liegt auf der Hand - Phrasen m√ºssen geheim gehalten und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">oft ge√§ndert werden</a> , was im feindlichen Gebiet nicht sehr einfach ist.  Gleichzeitig werden sie, um nicht zuf√§llig ausgesprochen zu werden und nicht zum Fall von KDPV zu f√ºhren, ziemlich prominent und zuf√§llig, was bedeutet, dass sie Agenten ausgeben k√∂nnen, die sie aussprechen. </p><br><p><img src="https://habrastorage.org/webt/pl/pe/sh/plpeshe7ifcmijrxlaziosekgey.png"></p><br><p>  Im Zeitalter der digitalen Technologie m√∂gen wir diese Methode nicht.  Vor allem, wenn Sie sich daran erinnern, dass fast alle Kommunikationskan√§le von jemandem gesteuert werden und sowohl f√ºr gute als auch f√ºr schlechte Motive genutzt werden.  Und egal, was sie uns versichern, das Leben der Menschen sollte in der Datenschutzrichtlinie von Facebook nicht als vertrauensw√ºrdig eingestuft werden. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/984/c5d/c5d/984c5dc5dae5cba450b58907693ceed6.png"></p><br><h2 id="steganografiya-opyat">  Steganographie (schon wieder?) </h2><br><p>  Igel es ist klar, dass die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">F√§higkeit, sich in einer</a> solchen Situation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zu verstecken,</a> attraktiver als je zuvor aussieht.  Tats√§chlich handelt es sich bei der beschriebenen Methode sogar um die Unterart - Codephrasen k√∂nnen als Container mit nur einer Information betrachtet werden. </p><br><p>  Das gleiche S√§ugetier der Insektenfresser-Abteilung versteht, dass es nicht nur darum geht, Stegocontainer gegeneinander zu werfen.  Ein solcher Austausch wird fast mehr Verdacht erregen als eine √ºbliche PGP-Verschl√ºsselung, daher sind wir nicht interessiert. </p><br><h3 id="a-o-chem-togda">  Was ist dann? </h3><br><p>  Im Gegensatz zu Kryptogrammen haben Stegocontainer einen offensichtlichen Vorteil - den Anwendungskontext.  Jeder Text, jedes Bild, jede Audiodatei usw. bietet neben dem offensichtlichen Inhalt auch die M√∂glichkeit einer <strong>nat√ºrlichen</strong> Diskussion und kann nicht nur aus der Bucht gesendet werden, sondern auch w√§hrend eines Dialogs, der keinen Verdacht erregt. </p><br><p>  Mit genau diesen Ideen k√∂nnen wir bereits ein einfaches steganografisches Authentifizierungsprotokoll erstellen, das auf einem gemeinsamen Schl√ºssel basiert: </p><br><ul><li>  A -&gt; B: eine h√ºbsche Nachricht, die einen steganografischen Container mit bestimmten Parametern anfordert; </li><li>  B: w√§hlt Container <em>C aus</em> , der dem angeforderten Kontext und den angeforderten Parametern entspricht; </li><li>  B: erzeugt auf √§hnliche Weise eine Nachricht <em>M</em> ; </li><li>  B -&gt; A: <em>C '= Einbetten (C, M, K)</em> ; </li><li>  A: √úberpr√ºft <em>C '</em> auf √úbereinstimmung mit den eingestellten Parametern; </li><li>  A -&gt; B: <em>M '= Extrakt (C', K)</em> ; </li><li>  B: √úberpr√ºft, ob <em>M</em> und <em>M '</em> √ºbereinstimmen. </li></ul><br><p>  Ein solches Protokoll hat offensichtliche Nachteile - Alice und Bob m√ºssen sowohl einen gemeinsamen Schl√ºssel als auch Einbettungs- und Extraktionsfunktionen haben.  Ihr Kompromiss kann zu einer detaillierten Analyse der Authentifizierungsmethode des Feindes f√ºhren und sowohl andere Benutzer als auch das Hauptquartier gef√§hrden.  Es muss etwas repariert werden. </p><br><h2 id="ispolnitel-ne-cherepashka">  Der K√ºnstler ist kein K√§fer </h2><br><p>  Wenn der Leser nach dem Aufkommen des Computerunterrichts zur Schule ging, sollte er sich daran erinnern, die Grundlagen der Algorithmusisierung mit dem Darsteller einer Schildkr√∂te, einer Ameise und dergleichen gelernt zu haben.  Ihre Idee war es, die M√∂glichkeiten der Optimierung einer gro√üen Anzahl manueller Einzelaktionen durch die Erstellung einfacher Programme aufzuzeigen.  Um unser Problem zu l√∂sen, m√ºssen wir in die entgegengesetzte Richtung gehen. </p><br><p><img src="https://habrastorage.org/webt/nc/lo/lo/nclolotljunb2zzbkgr2-4qo0ri.png" alt="Ist es nicht s√º√ü?"></p><br><p>  Da wir das Schreiben des endg√ºltigen Algorithmus von der Abfolge der Schritte bis zu ihrer prozeduralen Beschreibung gem√§√ü den angegebenen Parametern vereinfachen k√∂nnen, k√∂nnen wir den inversen Prozess ausf√ºhren.  Wenn Sie sich einen Container als Array einiger seiner Komponenten vorstellen, kann das Einbetten einer Nachricht per Schl√ºssel als geordnete Folge von Operationen an Containerelementen an bestimmten Indizes mit verschiedenen konstanten Parametern geschrieben werden. </p><br><p>  Hier beginnt die Nichtmathematik, daher bitte ich die Sch√ºchternen, einfach durch die schwierig aussehenden Abs√§tze zum Operationsabschnitt oder sogar ein wenig weiter zu bl√§ttern.  Ich verspreche, dass nichts Schreckliches passieren wird. </p><br><p>  Um die Daten einzubetten, ben√∂tigen wir eine Folge der Form: <em>(f1, S1, i, D1), (f2, S2, j, D2) ...</em> , wobei: </p><br><ul><li>  <em>Di</em> - ein Teil der eingebetteten Daten; </li><li>  <em>i, j</em> sind die Indizes der Elemente des Containers; </li><li>  <em>fi: (Zustand, Element, D) -&gt; (Zustand, Element)</em> - Einbettungsfunktion; </li><li>  <em>Si</em> ist ein bestimmter Zustand, der Kontext der Operation <em>(El ', S [i + 1]) = fi (Si, El, Di)</em> . </li></ul><br><p>  Um es zu extrahieren, m√ºssen Sie keine Teile der Daten (K.O.) speichern, daher gibt es gen√ºgend Tripel: <em>(g1, S1, I1), (g2, S2, I2) ...</em> mit denselben Werten, nur <em>gi: (State, Element) -&gt; (Staat, D)</em> . </p><br><p>  All dies kann durch das folgende symmetrische Diagramm dargestellt werden.  Wenn ich es aus irgendeinem Grund nicht geschafft habe, Klarheit zu erreichen, ist es nicht be√§ngstigend, lesen Sie einfach weiter. </p><br><p><img src="https://habrastorage.org/webt/l7/yk/pk/l7ykpkwfi8sfkcebwxryswzo1r0.png" alt="Gut oder nicht mehr"></p><br><p>  Es ist ersichtlich, dass die Einbettungsfunktion eine gr√∂√üere Anzahl von Freiheitsgraden aufweist.  Im Gegensatz zu ihrer Schwester √§ndert sie den Container auf der Grundlage von zwei unabh√§ngigen Elementen - eingebetteten Daten und dem Element.  Dank oder genauer gesagt aus diesem Grund sind zwei globale Ans√§tze zur Implementierung des Steganographiealgorithmus durch ein solches System m√∂glich: </p><br><ol><li>  W√§hlen Sie die am besten geeigneten Indizes der Elemente aus, die entsprechend der Einbettungsfunktion ge√§ndert werden sollen (am wenigsten wahrnehmbar oder √ºberhaupt nicht erforderlich), und √ºbertragen Sie die gebildete Sequenz, die an einen bestimmten Container gebunden ist.  Bei diesem Ansatz m√ºssen sie voneinander isoliert werden, bevor die Einbettung mit klassischen Methoden wie Verschl√ºsselung und anderen sicheren Medien erforderlich wird. </li><li>  Finden Sie eine solche Methode zum Teilen des Containers in Elemente und die Einbettungsfunktion, dass jede erwartete √Ñnderung durch ihn gleicherma√üen unsichtbar ist.  In diesem Fall ist die Sequenz unabh√§ngig vom Container und kann sogar von einem vollst√§ndig zuf√§lligen Generator erstellt werden.  Weniger Flexibilit√§t und mangelnde Kontrolle √ºber den schlimmsten Fall gehen.  Auf der anderen Seite ist dieser Ansatz einfacher und bequemer, wenn er vor Ort angewendet wird. Im Folgenden werde ich ihn daher verwenden. </li></ol><br><p>  Wenn der Status f√ºr den Algorithmus nicht erforderlich ist, bleibt alles oben Genannte g√ºltig, einfach ohne einen einzelnen Buchstaben und Block im Diagramm.  Ohne das ist es sogar noch einfacher. </p><br><h2 id="i-zachem-ono-nam">  Und warum brauchen wir das? </h2><br><p>  Wenn Sie jetzt im Voraus wissen, welche Container mit welchen Nachrichten und Schl√ºsseln verwendet werden, k√∂nnen Sie Agenten zur Verwendung nur solcher Sequenzen und einen Interpreter f√ºr diese generieren und angeben, anstatt die Teile des Algorithmus vollst√§ndig zu enth√ºllen.  Na gut, nat√ºrlich nicht nur geben, sondern sp√§ter mehr dazu. </p><br><h3 id="dobavlyaem-asimmetrichnost">  Asymmetrie hinzuf√ºgen </h3><br><p>  Sogar ein Schildkr√∂tenk√ºnstler kann ein Quadrat auf Hunderte von verschiedenen Arten zeichnen, indem er einfach die Reihenfolge der Operationen √§ndert und neue hinzuf√ºgt.  Dies bedeutet, dass uns niemand st√∂rt und dasselbe mit den beschriebenen Sequenzen f√ºr feste Eingabedaten tut. </p><br><p>  Das hei√üt, wir k√∂nnen die Einbettungssequenz √ºbernehmen, neue Operationen hinzuf√ºgen, alles mischen und so, dass das Ergebnis gleich bleibt.  Es sei denn, bei Vorhandensein eines Zustands muss dieser verfolgt und die erforderlichen √Ñnderungen an der Sequenz separat hinzugef√ºgt werden.  Deshalb ist es ohne einfacher einfacher, ja. </p><br><p>  Auf die eine oder andere Weise kann selbst der Einbettungsk√ºnstler nach einem solchen Kneten und Rauschen nicht mehr verstehen, was er tats√§chlich einbettet: Jede Folge von <em>N</em> Operationen repr√§sentiert <em>N!</em>  potenziell eingebettete Nachrichten - eine f√ºr jede Permutation der eingebetteten Teile.  Gleichzeitig ist <em>N</em> selbst eine gro√üe Frage.  Daher kann man solche Sequenzen als offen bezeichnen - sie liefern weder Informationen √ºber die eingebettete Nachricht noch √ºber den verwendeten Algorithmus und Schl√ºssel. </p><br><p>  Beim Extrahieren von Informationen ist es f√ºr uns sowohl die Reihenfolge (um die gleiche korrekte Nachricht von allen m√∂glichen wiederherzustellen) als auch die Anzahl der zu extrahierenden Teile sehr wichtig, damit die Extraktionssequenzen vom Moment der Geburt an unver√§ndert bleiben.  Da sie implizit Informationen √ºber den verwendeten Schl√ºssel, Generator und Algorithmus enthalten, m√ºssen sie wie Tiere aus dem Roten Buch gespeichert und gesch√ºtzt werden.  Und halte es geheim. </p><br><p>  Was hat Asymmetrie damit zu tun?  Tatsache ist, dass jetzt jede Extraktionssequenz einer unendlichen Anzahl von Einbettern zugeordnet ist.  Und das Wiederherstellen voneinander ist im Allgemeinen eine unl√∂sbare Aufgabe. </p><br><h3 id="ekspluatiruem">  Wir operieren </h3><br><p>  Wir vergessen jede mathematische N√§he und kehren zur urspr√ºnglichen Aufgabe zur√ºck - wie k√∂nnen wir Alice und Bob in feindliches Gebiet schicken, um: </p><br><ul><li>  Sie kannten sich nicht </li><li>  hatte keine geheimen Algorithmen zur Hand </li><li>  Aber k√∂nnten Sie sich gegenseitig verifizieren, w√§hrend Sie auf einem offenen Kanal kommunizieren? </li></ul><br><p>  Nun, mit dem ersten Absatz ist alles klar, wir geben ihnen nur keine expliziten Informationen √ºber einander, keine gemeinsamen Schl√ºssel.  F√ºr den zweiten m√ºssen Sie sich die Beschreibung des obigen Protokolls merken.  Jetzt k√∂nnen wir die <em>Einbettungs-</em> und <em>Extraktionsalgorithmen</em> , die potenzielle Zustandsgeheimnisse darstellen, und all das direkt ausschlie√üen.  Und unter Ber√ºcksichtigung dessen ist es f√ºr das dritte m√∂glich, das folgende zweistufige Protokoll zu erstellen. </p><br><p>  Generierung von Authentifizierungsinformationen <strong>vor Beginn der Mission</strong> mit Hauptsitz als vertrauensw√ºrdige Partei von Trient: </p><br><ul><li>  T: w√§hlt den geheimen Algorithmus und den geheimen Schl√ºssel K aus, erstellt mit deren Hilfe: <br><ul><li>  Sequenz extrahieren <em>Bsp</em> .; </li><li>  geeignet zur Authentifizierung (unten) <em>Ctx-</em> Kontext; </li></ul></li><li>  T -&gt; A: <em>Ctx, Ex</em> ; </li><li>  T: Mit <em>Ex</em> und dem erstellten Kontext wird Folgendes generiert: <br><ul><li>  Nachricht <em>M</em> , die zuvor f√ºr die ausgew√§hlten Agenten aus den Teilen <em>| Ex | nicht verwendet wurde</em>  ;; </li><li>  eine einmalige Folge von <em>Em</em> , die es wie oben beschrieben √∂ffnet; </li></ul></li><li>  T -&gt; B: <em>Em, h (M) erzeugt</em> , falls gew√ºnscht, zus√§tzliche Mengen. </li></ul><br><p>  Somit hat Alice nur eine Sequenz f√ºr alle Gelegenheiten und den Kontext des zuk√ºnftigen Kontakts, und Bob wird der gl√ºckliche Besitzer einer Reihe von einmaligen Sequenzen und Nachrichten-Hashes, die sie einbetten. </p><br><p>  Das Authentifizierungsprotokoll bereits <strong>w√§hrend der Mission</strong> sieht folgenderma√üen aus: </p><br><ul><li>  A -&gt; B: eine initiierende <em>IM-</em> Nachricht basierend auf dem <em>Ctx-</em> Kontext mit einer Beschreibung des Containers; </li><li>  B: w√§hlt das geeignete <em>C ~ IM aus</em> ; </li><li>  B -&gt; A: <em>C '= Em (C)</em> ; </li><li>  A: pr√ºft die Einhaltung von <em>C '~ IM</em> (da die √Ñnderungen unsichtbar sind, sollten sie gespeichert werden); </li><li>  A -&gt; B: <em>M '= Ex (C')</em> , markiert M 'als verwendet; </li><li>  B: pr√ºft, <em>h (M ') == h (M)</em> , zerst√∂rt <em>Em, h (M)</em> . </li></ul><br><p>  Ein aufmerksamer Leser wird feststellen, dass Alice und Bob vor dem Protokoll nur eine Reihe von Informationen haben, die an sich weder f√ºr sie noch f√ºr einen potenziellen Gegner etwas bedeuten, und zwar nur w√§hrend des "Spiels mit Farben". </p><br><p>  Jeder offene Satz von Bob wird nur einmal verwendet, was durch den vorletzten Schritt von Alice gesteuert wird.  Wenn sie ein zuvor verwendetes <em>M</em> (und daher <em>von</em> ihr unsichtbares <em>Em</em> ) einer anderen Person trifft, stellt sie fest, dass einer ihrer "Mitarbeiter" eine F√§lschung ist. </p><br><p>  Die wiederholte Verwendung durch dieselbe Person sagt ihr, dass sie sich der Feinheiten des Protokolls nicht bewusst ist und sicherlich nicht diejenige ist, mit der sie Kontakt aufnehmen musste.  Besser sp√§t als nie. </p><br><p><img src="https://habrastorage.org/webt/bv/6v/0h/bv6v0hcim8kmzndrvn5__thsp1y.png"></p><br><p>  Okay, so sieht alles zu kompliziert und unverst√§ndlich aus.  Hat jemand hier? </p><br><p>  Lassen Sie es uns in der Praxis besser demonstrieren, denn selbst die Spione selbst m√ºssen die Details des Protokolls nicht kennen, geschweige denn arme Leser.  Zun√§chst nur ein wenig dar√ºber, wie alles umgesetzt wurde. </p><br><h2 id="vysokie-tehnologii">  Hightech </h2><br><p>  Es bleibt also nur alles zu schreiben, was f√ºr das Protokoll notwendig ist.  Du machst nicht alles mit deinen H√§nden (obwohl du kannst).  Und heute wird das Opfer meines Codes ... <em>das Gl√ºcksrad drehen</em> ... Java?  Okay, zur gleichen Zeit wird alles in STL sein, Sie m√ºssen nichts suchen. </p><br><p>  Beginnen wir mit der erforderlichen API.  Um zu arbeiten, m√ºssen Sie nur die Klasse des Arrays von Containerelementen bestimmen, die Elemente nach Index empfangen und √§ndern k√∂nnen: </p><br><pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyContainer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StegoContainer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyElement</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> MyElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  i-  } public void set(int i, MyElement v) { //  i-  } public int size() { //    } }</span></span></code> </pre> <br><p>  Die weitere Verwendung beschr√§nkt sich darauf, einen Wrapper eines steganografischen Automaten √ºber dem erforderlichen Container zu erstellen und die Funktionen zum Einbetten und Extrahieren seiner Eingabe bereitzustellen: </p><br><pre> <code class="java hljs">StegoMachine&lt;MyState, MyElement&gt; myMachine = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StegoMachine( initialState, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyContainer&lt;MyElement&gt;(<span class="hljs-comment"><span class="hljs-comment">/*   */</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> StegoEmbed myEmbed = (st, el, dp) -&gt; { <span class="hljs-comment"><span class="hljs-comment">//    dp   el   st }; final StegoExtract myExtract = (st, el) -&gt; { //     el   st return dp; }; //    MyDataPart part = /*    */; myMachine.exec(1337, myEmbed, part); //... //    /,   //      State currState = myMachine.getState(); //... //    part = myMachine.exec(80085, myExtract); //... //        MyContainer container = (MyContainer) myMachine.getContainer();</span></span></code> </pre> <br><p>  Klassen mit dem Suffix Stateless werden auf die gleiche Weise verwendet, wenn f√ºr die Implementierung des Algorithmus der interne Status nicht beibehalten werden muss. </p><br><p>  Sequenzgeneratoren k√∂nnen nach Belieben arbeiten und haben keine gemeinsame API.  Im allgemeinen Fall kann alles Teil der Daten im Allgemeinen sein, von Einzelbits bis hin zu Felszeichnungen in einer separaten Codierung. </p><br><h3 id="primer-realizacii">  Implementierungsbeispiel </h3><br><h4 id="o-metode">  √úber Methode </h4><br><p>  Als Beispiel f√ºr die Implementierung habe ich unter Verwendung der erstellten Schnittstellen einen einfachen Algorithmus aus der LSB-Familie f√ºr Bitmap-Bilder mit verlustfreier Komprimierung implementiert.  Ihre Elemente sind Pixel, die keine Nachbarn im niedrigstwertigen Bit aller RGB-Komponenten haben.  Die Einbettungsfunktion arbeitet mit einzelnen Bits der Quelldaten und √§ndert einfach das niederwertige Bit des Werts einer der Komponenten (auf den der Index verweist). </p><br><p>  Es ist recht einfach, aber es eignet sich hervorragend f√ºr die Implementierung des Protokolls, da das √Ñndern eines Elements je nach Auswahl gleicherma√üen nicht wahrnehmbar ist. Generieren Sie daher Indizes der zu √§ndernden Elemente mithilfe eines Zufallsgenerators.  Im Fall von Java wird mithilfe von <em>SecureRandom</em> , falls gew√ºnscht, leicht die Entropiequelle ge√§ndert. </p><br><p>  <em>Trotzdem ist dies eine sehr einfache Methode, die ich echten Spionen nicht empfehlen kann.</em> </p><br><h4 id="o-heshah">  √úber Hashes </h4><br><p>  Da der Text abh√§ngig von der simulierten Identit√§t des Agenten tendenziell verzerrt ist (einige setzen keine Gro√übuchstaben, andere setzen gerne Emoticons usw., andere sind im Allgemeinen Analphabeten), empfehle ich die Verwendung von sha256 zur Berechnung des Hashs, jedoch nur aus gedruckten W√∂rtern, die in Kleinbuchstaben geschrieben sind: </p><br><pre> <code class="plaintext hljs">h("Hello world?...") == h("hello, world!11")</code> </pre> <br><h4 id="ob-interfeyse">  √úber die Schnittstelle </h4><br><p>  Das Softwarepaket besteht aus zwei Teilen - einem zum Generieren von Sequenzen und anderen Hashes f√ºr Trent, dem anderen zum Einbetten und √úberpr√ºfen empfangener Nachrichten auf Konformit√§t. </p><br><p>  Die Arbeit mit beiden erfolgt √ºber die Befehlszeile √ºber ihre Argumente und Eingabe-Ausgabe-Streams, es wurden keine anderen Schnittstellen bereitgestellt (Angst und Entsetzen).  Um dieser Angestellte des Hauptquartiers zu sein, bedeutet der Spion dennoch, eine Qualifikation zu haben.  Wenn nicht, werde ich noch ein Beispiel zeigen. </p><br><div class="spoiler">  <b class="spoiler_title">Hier ist eine Hilfe</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/yx/1m/ge/yx1mge8ligshzbsv7hxi3olw__g.png" alt="Screenshothot der Nutzungsung"></p><br></div></div><br><h3 id="chto-im-vsem-delat-to">  Was machen sie alle? </h3><br><p>  Zun√§chst muss Trent im Hauptquartier Authentifizierungsinformationen ausarbeiten.  Insbesondere, um im Voraus √ºber eine Situation nachzudenken, in der Agenten arbeiten werden. </p><br><p>  Lassen Sie Bob zum Beispiel Grafik-Freiberufler und Alice seine Kundin sein.  Die Authentifizierung erfolgt unter dem Deckmantel eines Auftrags zum Erstellen von Grafiken / Design / etwas anderem. </p><br><p>  Wir melden diese n√ºtzlichen Informationen an beide und kehren zum Protokoll selbst zur√ºck.  Wir werden im <em>Voraus</em> eine geeignete eingebettete <em>M.txt-</em> Nachricht vorbereiten, um die Anzahl der darin enthaltenen Zeichen zu minimieren: "Es passt mir gut, wohin ich Geld √ºberweisen soll."  Generieren Sie <em>Em</em> und <em>Ex</em> mit dem Dienstprogramm f√ºr Trent: </p><br><pre> <code class="bash hljs">Trent@HQWorkstation:~$ java -jar HQUtil.jar -ex $(<span class="hljs-built_in"><span class="hljs-built_in">stat</span></span> -c%s <span class="hljs-string"><span class="hljs-string">"M.txt"</span></span>) 4096 &gt; Ex.txt Trent@HQWorkstation:~$ cat Ex.txt | java -jar HQUtil.jar -em <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$(cat M.txt)</span></span></span><span class="hljs-string">"</span></span> 0.25 4096 &gt; Em.txt Trent@HQWorkstation:~$ cat M.txt | java -jar HQUtil.jar -h &gt; hash.bin</code> </pre> <br><p>  Hier gibt <code>$(stat -c%s "M.txt")</code> die Gr√∂√üe der Nachricht in Bytes und 4096 die Einschr√§nkung des Bereichs der generierten Indizes zur√ºck (um die Verwendung kleinerer Container zu erm√∂glichen).  In √§hnlicher Weise wird <code>$(cat M.txt)</code> verwendet, um die Nachricht selbst an den Befehlszeilenparameter zu √ºbergeben.  Im Prinzip k√∂nnen Sie auf die Bash verzichten, indem Sie Ihre eigene Handarbeit leisten, f√ºr wen es jedoch bequemer ist. </p><br><p>  <em>Ex.txt</em> wird an Alice, <em>Em.txt</em> und <em>hash.bin</em> an Bob √ºbergeben.  Stellen Sie sich nun vor, dass die Agenten erfolgreich bereitgestellt wurden und miteinander kommunizieren m√∂chten - wir fahren mit der Ausf√ºhrung des Protokolls fort.  Bob stellt seinen Lebenslauf oder sein Stellenangebot auf einen Austausch und Alice beginnt mit der Kommunikation: </p><br><pre> <code class="plaintext hljs">: ,     %_% :        ,   .  ? : ,   </code> </pre> <br><p>  Bob sucht nach einem Bild eines Regenschirms, zeichnet es vielleicht sogar selbst, wenn die Seele kreativ ist, ein Wasserzeichen ein wenig komprimiert / auferlegt (oder was Freiberufler dort gerade tun) und tut: </p><br><pre> <code class="bash hljs">Bob@PC:~$ cat Em.txt | java -jar SpyUtil.jar -e umbrella.png</code> </pre> <br><p>  Nachdem er eine Weile gewartet hat und so getan hat, als w√ºrde er arbeiten, schickt er Alice nat√ºrlich den empfangenen Container, wobei er den Kontext ber√ºcksichtigt: </p><br><pre> <code class="plaintext hljs">: ,  ,     </code> </pre> <br><div class="spoiler">  <b class="spoiler_title">√úbertr√§gt einen Regenschirm mit einer Nachricht, 670kb</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/qw/nk/in/qwnkinuhpppynf6ve9gkrmpnehm.png"></p></div></div><br><p>  Dadurch wird die intern gespeicherte Nachricht abgerufen: </p><br><pre> <code class="bash hljs">Alice@PC:~$ cat Ex.txt | java -jar SpyUtil.jar -e umbrella.png      </code> </pre> <br><p>  Verwandelt eine Reihe von W√∂rtern in einen normalen Satz und sendet ihn an Bob: </p><br><pre> <code class="plaintext hljs">: ,  ,   ?</code> </pre><br><p>  Er √ºberpr√ºft die Richtigkeit der Nachricht: </p><br><pre> <code class="java hljs">Bob<span class="hljs-meta"><span class="hljs-meta">@PC</span></span>:~$ java -jar SpyUtil.jar -c hash.bin <span class="hljs-string"><span class="hljs-string">",  ,   ?"</span></span> ,  ,   ? - Correct</code> </pre><br><p>  Und weiterhin einfache Kommunikation, wenn alles in Ordnung ist.  Der gesamte Dialog des Beobachters sieht ungef√§hr so ‚Äã‚Äãaus: </p><br><div class="spoiler">  <b class="spoiler_title">500 Kilobyte gif</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ff/ye/he/ffyeheonv4qo9dxdjygalg8kvtq.gif"></p></div></div><br><p>  Es ist klar, dass die Spionageabwehr bei all dem Abfangen nichts Verd√§chtiges finden wird.  Tats√§chlich werden selbst die Methoden der Stegoanalyse in diesem Fall nicht immer angewendet - nun, jemand hat ein Bild eines Regenschirms f√ºr 5 Dollar bestellt und herausgefunden, wie man das Internet √ºberrascht.  Rechenressourcen und Mitarbeiter sind nicht endlos, um jede solche Situation zu √ºberpr√ºfen.  Die Authentifizierung war erfolgreich, der Vorhang. </p><br><p>  -&gt; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456670/">https://habr.com/ru/post/de456670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456658/index.html">Wachstum: wie wir F√§higkeiten in einem Team bewerten</a></li>
<li><a href="../de456662/index.html">So sparen Sie mit einer testgetriebenen Entwicklung Geld f√ºr einen Therapeuten</a></li>
<li><a href="../de456664/index.html">Wen Sie verklagen m√ºssen, wenn ein Roboter Ihr Geld verliert</a></li>
<li><a href="../de456666/index.html">WebTotem oder wie wir das Internet sicherer machen wollen</a></li>
<li><a href="../de456668/index.html">Microsoft ML Spark: Eine Spark-Erweiterung, die SparkML humaner und LightGBM als Bonus macht</a></li>
<li><a href="../de456672/index.html">Nginx-Rezepte: Asynchrone Benachrichtigungen von PostgreSQL an den Websocket</a></li>
<li><a href="../de456674/index.html">Neue Werbem√∂glichkeiten auf Facebook, von denen Sie nichts wussten</a></li>
<li><a href="../de456676/index.html">Anmelden in einer verteilten PHP-Anwendung</a></li>
<li><a href="../de456678/index.html">Der elektronische Zustand der Zukunft. Teil 4</a></li>
<li><a href="../de456680/index.html">Acht Namensgesetze im UX-Design (Teil 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>