<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§πüèø ‚úäüèº üîß Matem√°ticas en Gamedev es simple. Curvas y ondas de unidad para efecto lluvia ü•ï üêì üêë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos! Mi nombre es Grisha y soy el fundador de CGDevs. Sigamos hablando de matem√°ticas o algo as√≠. Quiz√°s la aplicaci√≥n principal de las matem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Matem√°ticas en Gamedev es simple. Curvas y ondas de unidad para efecto lluvia</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435828/"> Hola a todos!  Mi nombre es Grisha y soy el fundador de CGDevs.  Sigamos hablando de matem√°ticas o algo as√≠.  Quiz√°s la aplicaci√≥n principal de las matem√°ticas en el desarrollo de juegos y gr√°ficos de computadora en general es VFX.  As√≠ que hablemos de uno de esos efectos: lluvia, o m√°s bien de su parte principal, que requiere matem√°ticas, ondas en la superficie.  Sucesivamente escriba un sombreador para las ondas en la superficie y analice sus matem√°ticas.  Si est√° interesado, bienvenido a cat.  Proyecto Github adjunto. <br><br><img src="https://habrastorage.org/webt/15/5m/zm/155mzmadkwqhsef6lpvb7us1kbe.png"><br><a name="habracut"></a><br>  A veces llega un momento en la vida cuando un programador tiene que agarrar una pandereta y pedir lluvia.  En general, el tema del modelado de lluvia en s√≠ mismo es muy profundo.  Hay muchos trabajos matem√°ticos sobre diferentes partes de este proceso, desde la ca√≠da de gotas y los efectos asociados con esto hasta la distribuci√≥n de gotas en volumen.  Analizaremos solo un aspecto: el sombreador, que nos permitir√° crear un efecto similar a la onda de una gota ca√≠da.  ¬°Es hora de tomar una pandereta! <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/K5ISaIAx3-o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <b>Ola matem√°tica</b> <br><br>  Al buscar en Internet, encontrar√° muchas expresiones matem√°ticas divertidas para generar ondas.  A menudo consisten en alg√∫n tipo de n√∫meros "m√°gicos" y funciones peri√≥dicas sin justificaci√≥n.  Pero en general, la matem√°tica de este efecto es bastante simple. <br><br>  Solo necesitamos una ecuaci√≥n de onda plana en el caso unidimensional.  ¬øPor qu√© analizaremos plano y unidimensional un poco m√°s tarde? <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La ecuaci√≥n de onda plana</a> en nuestro caso se puede escribir como: <br><br>  <i>Aresult = A * cos (2 * PI * (x / waveLength - t * frecuencia));</i> <br>  Donde: <br>  <i>Aresult</i> - amplitud en el punto x, en el tiempo t <br>  <i>A</i> es la amplitud m√°xima <br>  <i>longitud de onda</i> - longitud de onda <br>  <i>frecuencia</i> - frecuencia de onda <br>  <i>PI</i> - n√∫mero <i>PI</i> = 3.14159 (flotante) <br><br>  <b>Shader</b> <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Su navegador no admite video HTML5. <source src="https://media.giphy.com/media/2ywmKSvq53ptEXK60f/giphy.mp4" type="video/mp4"></video></div></div></div><br>  Juguemos con los sombreadores.  Para el "top" ser√° responsable de la coordenada -Z.  Esto es m√°s conveniente en el caso 2D en Unity.  Si lo desea, el sombreador no ser√° dif√≠cil de reescribir en Y. <br><br>  Lo primero que necesitamos es la ecuaci√≥n de un c√≠rculo.  La onda de nuestro sombreador ser√° sim√©trica sobre el centro.  La ecuaci√≥n del c√≠rculo en el segundo caso se describe como: <br><br>  <i>r ^ 2 = x ^ 2 + y ^ 2</i> <br><br>  necesitamos un radio, entonces la ecuaci√≥n toma la forma: <br><br>  <i>r = sqrt (x ^ 2 + y ^ 2)</i> <br><br>  y esto nos dar√° simetr√≠a sobre el punto (0, 0) en la malla, lo que reducir√° todo al caso unidimensional de una onda plana. <br><br>  Ahora escribamos un sombreador.  No analizar√© cada paso de escribir un sombreador, ya que este no es el prop√≥sito del art√≠culo, pero la base se toma del Sombreador de superficie est√°ndar de Unity, cuya plantilla se puede obtener a trav√©s de Crear-&gt; Sombreador-&gt; Sombreador de superficie est√°ndar. <br><br>  Adem√°s, se <i>agregan</i> las propiedades necesarias para la ecuaci√≥n de onda: <i>_Frequency</i> , <i>_WaveLength</i> y <i>_WaveHeight</i> .  Propiedad <i>_Timer</i> (ser√≠a posible utilizar el tiempo con gpu, pero durante el desarrollo y la animaci√≥n posterior es m√°s conveniente controlarlo manualmente. <br><br>  Escribimos la funci√≥n getHeight para obtener la altura (ahora esta es la coordenada Z) sustituyendo la ecuaci√≥n circular en la ecuaci√≥n de onda <br><br>  Al escribir un sombreador con nuestra ecuaci√≥n de onda y la ecuaci√≥n circular, obtenemos este efecto. <br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo de sombreador</b> <div class="spoiler_text"><pre><code class="cpp hljs">Shader <span class="hljs-string"><span class="hljs-string">"CGDevs/Rain/RainRipple"</span></span> { Properties { _WaveHeight(<span class="hljs-string"><span class="hljs-string">"Wave Height"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _WaveLength(<span class="hljs-string"><span class="hljs-string">"Wave Length"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Frequency(<span class="hljs-string"><span class="hljs-string">"Frequency"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Timer(<span class="hljs-string"><span class="hljs-string">"Timer"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> _Color (<span class="hljs-string"><span class="hljs-string">"Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) _MainTex (<span class="hljs-string"><span class="hljs-string">"Albedo (RGB)"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Glossiness (<span class="hljs-string"><span class="hljs-string">"Smoothness"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> _Metallic (<span class="hljs-string"><span class="hljs-string">"Metallic"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0.0</span></span> } SubShader { Tags { <span class="hljs-string"><span class="hljs-string">"RenderType"</span></span>= <span class="hljs-string"><span class="hljs-string">"Opaque"</span></span> } LOD <span class="hljs-number"><span class="hljs-number">200</span></span> CGPROGRAM #pragma surface surf Standard fullforwardshadows vertex:vert #pragma target <span class="hljs-number"><span class="hljs-number">3.0</span></span> sampler2D _MainTex; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> {</span></span> float2 uv_MainTex; }; half _Glossiness, _Metallic, _Frequency, _Timer, _WaveLength, _WaveHeight; fixed4 _Color; <span class="hljs-function"><span class="hljs-function">half </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHeight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(half x, half y)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> PI = <span class="hljs-number"><span class="hljs-number">3.14159</span></span>; half rad = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(x * x + y * y); half wavefunc = _WaveHeight * <span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span> * PI * (_Frequency * _Timer - rad / _WaveLength)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> wavefunc; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vert</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inout appdata_full v)</span></span></span><span class="hljs-function"> </span></span>{ v.vertex.z -= getHeight(v.vertex.x, v.vertex.y); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">surf</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Input IN, inout SurfaceOutputStandard o)</span></span></span><span class="hljs-function"> </span></span>{ fixed4 c = tex2D (_MainTex, IN.uv_MainTex) * _Color; o.Albedo = c.rgb; o.Metallic = _Metallic; o.Smoothness = _Glossiness; o.Alpha = _Color.a; } ENDCG } FallBack <span class="hljs-string"><span class="hljs-string">"Diffuse"</span></span> }</code> </pre> <br></div></div><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Su navegador no admite video HTML5. <source src="https://media.giphy.com/media/kvPWJaw0nqhZU0v3eV/giphy.mp4" type="video/mp4"></video></div></div></div><br>  Hay olas  Pero quiero que la animaci√≥n comience y termine con un avi√≥n.  La funci√≥n seno nos ayudar√° con esto.  Multiplicando la amplitud por sin (_Timer * PI), obtenemos una apariencia suave y la desaparici√≥n de las ondas.  Como _Timer toma valores de 0 a 1, y el seno en cero y en PI es cero, esto es exactamente lo que necesita. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Su navegador no admite video HTML5. <source src="https://media.giphy.com/media/5zotyAkAgtISUCoB0o/giphy.mp4" type="video/mp4"></video></div></div></div><br>  Si bien no es como una gota cayendo.  El problema es que la energ√≠a de las olas se pierde de manera uniforme.  Agregue la propiedad _Radius, que ser√° responsable del radio del efecto.  Y multiplicamos la amplitud de la pinza (_Radius - rad, 0, 1) y obtenemos ya un efecto m√°s parecido a la verdad. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Su navegador no admite video HTML5. <source src="https://media.giphy.com/media/7i9kpPPHDJWUNJXeuV/giphy.mp4" type="video/mp4"></video></div></div></div><br>  Bueno, el paso final.  El hecho de que la amplitud en cada punto individual alcance su m√°ximo en un tiempo igual a 0.5 no es del todo cierto, es mejor reemplazar esta funci√≥n. <br><br><img src="https://habrastorage.org/webt/bn/9h/dy/bn9hdyvxobu313uitppdz4j68ik.png"><br><br>  Luego me sent√≠ un poco flojo para contar, y simplemente multipliqu√© el seno por (1 - _Timer) y obtuve esa curva. <br><br><img src="https://habrastorage.org/webt/xp/nu/f2/xpnuf2rrjiqtxj7f_g_q5luq7h0.png"><br><br>  Pero en general, desde el punto de vista de las matem√°ticas, aqu√≠ tambi√©n puede seleccionar la curva deseada en funci√≥n de la l√≥gica en qu√© momento desea un pico y una forma aproximada, y luego construir la interpolaci√≥n en estos puntos. <br><br>  El resultado es tal sombreador y efecto. <br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo de sombreador</b> <div class="spoiler_text"><pre> <code class="cpp hljs">Shader <span class="hljs-string"><span class="hljs-string">"CGDevs/Rain/RainRipple"</span></span> { Properties { _WaveHeight(<span class="hljs-string"><span class="hljs-string">"Wave Height"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _WaveLength(<span class="hljs-string"><span class="hljs-string">"Wave Length"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Frequency(<span class="hljs-string"><span class="hljs-string">"Frequency"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Radius(<span class="hljs-string"><span class="hljs-string">"Radius"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Timer(<span class="hljs-string"><span class="hljs-string">"Timer"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> _Color (<span class="hljs-string"><span class="hljs-string">"Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) _MainTex (<span class="hljs-string"><span class="hljs-string">"Albedo (RGB)"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Glossiness (<span class="hljs-string"><span class="hljs-string">"Smoothness"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> _Metallic (<span class="hljs-string"><span class="hljs-string">"Metallic"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0.0</span></span> } SubShader { Tags { <span class="hljs-string"><span class="hljs-string">"RenderType"</span></span>= <span class="hljs-string"><span class="hljs-string">"Opaque"</span></span> } LOD <span class="hljs-number"><span class="hljs-number">200</span></span> CGPROGRAM #pragma surface surf Standard fullforwardshadows vertex:vert #pragma target <span class="hljs-number"><span class="hljs-number">3.0</span></span> sampler2D _MainTex; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> {</span></span> float2 uv_MainTex; }; half _Glossiness, _Metallic, _Frequency, _Timer, _WaveLength, _WaveHeight, _Radius; fixed4 _Color; <span class="hljs-function"><span class="hljs-function">half </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHeight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(half x, half y)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> PI = <span class="hljs-number"><span class="hljs-number">3.14159</span></span>; half rad = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(x * x + y * y); half wavefunc = _WaveHeight * <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(_Timer * PI) * (<span class="hljs-number"><span class="hljs-number">1</span></span> - _Timer) * clamp(_Radius - rad, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) * <span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span> * PI * (_Frequency * _Timer - rad / _WaveLength)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> wavefunc; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vert</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inout appdata_full v)</span></span></span><span class="hljs-function"> </span></span>{ v.vertex.z -= getHeight(v.vertex.x, v.vertex.y); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">surf</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Input IN, inout SurfaceOutputStandard o)</span></span></span><span class="hljs-function"> </span></span>{ fixed4 c = tex2D (_MainTex, IN.uv_MainTex) * _Color; o.Albedo = c.rgb; o.Metallic = _Metallic; o.Smoothness = _Glossiness; o.Alpha = _Color.a; } ENDCG } FallBack <span class="hljs-string"><span class="hljs-string">"Diffuse"</span></span> }</code> </pre><br></div></div><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Su navegador no admite video HTML5. <source src="https://media.giphy.com/media/pOwf43ETsackhG30CA/giphy.mp4" type="video/mp4"></video></div></div></div><br>  <b>Malla de malla es importante</b> <br><br>  Volviendo un poco al tema del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo anterior</a> .  El sombreador de v√©rtices implementa las ondas, por lo que la malla de la malla juega un papel bastante importante.  Dado que se conoce la naturaleza del movimiento, la tarea se simplifica, pero en general, la imagen final depende de la forma de la cuadr√≠cula.  La diferencia se vuelve insignificante con una alta poligonalidad, pero para el rendimiento, cuantos menos pol√≠gonos, mejor.  A continuaci√≥n se muestran im√°genes que ilustran la diferencia entre cuadr√≠culas y elementos visuales. <br><br>  <b>Correctamente:</b> <br><br><img src="https://habrastorage.org/webt/xw/tt/r5/xwttr5ikn3utin3bk8zovtafiuk.png"><br><br>  <b>Equivocado:</b> <br><br><img src="https://habrastorage.org/webt/mt/kn/jz/mtknjzazxsvlolfild-i_pspsrw.png"><br><br>  Incluso con el doble de pol√≠gonos, la segunda malla da una imagen incorrecta (ambas mallas se generaron usando Triangle.Net, solo usando diferentes algoritmos). <br><br>  <b>Visual final</b> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/rb7DolTp6Hc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  En una versi√≥n diferente del sombreador, se ha agregado una parte especial para crear ondas no estrictamente en el centro, sino en varios puntos.  C√≥mo se implementa esto y c√≥mo puede pasar tales par√°metros, puedo decir en los siguientes art√≠culos, si el tema es interesante. <br><br>  Aqu√≠ est√° el sombreador en s√≠: <br><br><div class="spoiler">  <b class="spoiler_title">V√©rtice ondulado con poste</b> <div class="spoiler_text"><pre> <code class="cpp hljs">Shader <span class="hljs-string"><span class="hljs-string">"CGDevs/Rain/Ripple Vertex with Pole"</span></span> { Properties { _MainTex (<span class="hljs-string"><span class="hljs-string">"Albedo (RGB)"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Normal (<span class="hljs-string"><span class="hljs-string">"Bump Map"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Roughness (<span class="hljs-string"><span class="hljs-string">"Metallic"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Occlusion (<span class="hljs-string"><span class="hljs-string">"Occlusion"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _PoleTexture(<span class="hljs-string"><span class="hljs-string">"PoleTexture"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Color (<span class="hljs-string"><span class="hljs-string">"Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) _Glossiness (<span class="hljs-string"><span class="hljs-string">"Smoothness"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> _WaveMaxHeight(<span class="hljs-string"><span class="hljs-string">"Wave Max Height"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _WaveMaxLength(<span class="hljs-string"><span class="hljs-string">"Wave Length"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Frequency(<span class="hljs-string"><span class="hljs-string">"Frequency"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) = <span class="hljs-number"><span class="hljs-number">1</span></span> _Timer(<span class="hljs-string"><span class="hljs-string">"Timer"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span> } SubShader { Tags { <span class="hljs-string"><span class="hljs-string">"IgnoreProjector"</span></span> = <span class="hljs-string"><span class="hljs-string">"True"</span></span> <span class="hljs-string"><span class="hljs-string">"RenderType"</span></span> = <span class="hljs-string"><span class="hljs-string">"Opaque"</span></span>} LOD <span class="hljs-number"><span class="hljs-number">200</span></span> CGPROGRAM #pragma surface surf Standard fullforwardshadows vertex:vert #pragma target <span class="hljs-number"><span class="hljs-number">3.0</span></span> sampler2D _PoleTexture, _MainTex, _Normal, _Roughness, _Occlusion; half _Glossiness, _WaveMaxHeight, _Frequency, _Timer, _WaveMaxLength, _RefractionK; fixed4 _Color; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> {</span></span> float2 uv_MainTex; }; <span class="hljs-function"><span class="hljs-function">half </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHeight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(half x, half y, half offetX, half offetY, half radius, half phase)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> PI = <span class="hljs-number"><span class="hljs-number">3.14159</span></span>; half timer = _Timer + phase; half rad = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>((x - offetX) * (x - offetX) + (y - offetY) * (y - offetY)); half A = _WaveMaxHeight * <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(_Timer * PI) * (<span class="hljs-number"><span class="hljs-number">1</span></span> - _Timer) * (<span class="hljs-number"><span class="hljs-number">1</span></span> - timer) * radius; half wavefunc = <span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span> * PI * (_Frequency * timer - rad / _WaveMaxLength)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> A * wavefunc; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vert</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inout appdata_full v)</span></span></span><span class="hljs-function"> </span></span>{ float4 poleParams = tex2Dlod (_PoleTexture, float4(v.texcoord.xy, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)); v.vertex.z += getHeight(v.vertex.x, v.vertex.y, (poleParams.r - <span class="hljs-number"><span class="hljs-number">0.5</span></span>) * <span class="hljs-number"><span class="hljs-number">2</span></span>, (poleParams.g - <span class="hljs-number"><span class="hljs-number">0.5</span></span>) * <span class="hljs-number"><span class="hljs-number">2</span></span>, poleParams.b , poleParams.a); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">surf</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Input IN, inout SurfaceOutputStandard o)</span></span></span><span class="hljs-function"> </span></span>{ o.Albedo = tex2D(_MainTex, IN.uv_MainTex).rgb * _Color.rgb; o.Normal = UnpackNormal(tex2D(_Normal, IN.uv_MainTex)); o.Metallic = tex2D(_Roughness, IN.uv_MainTex).rgb; o.Occlusion = tex2D(_Occlusion, IN.uv_MainTex).rgb; o.Smoothness = _Glossiness; o.Alpha = _Color.a; } ENDCG } FallBack <span class="hljs-string"><span class="hljs-string">"Diffuse"</span></span> }</code> </pre><br></div></div><br>  El proyecto en su conjunto y c√≥mo funciona se puede encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> .  Es cierto que parte de los recursos tuvieron que eliminarse debido a las limitaciones de peso del github (hdr skybox y car). <br><br>  Gracias por su atencion!  Espero que el art√≠culo sea √∫til para alguien, y se hizo un poco m√°s claro por qu√© la trigonometr√≠a, la geometr√≠a anal√≠tica (todo lo relacionado con las curvas) y otras disciplinas matem√°ticas pueden ser necesarias. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es435828/">https://habr.com/ru/post/es435828/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es435814/index.html">[The Old New Thing] ¬øPuedo usar mi stack como me plazca?</a></li>
<li><a href="../es435816/index.html">Massachusetts Hospital y DeepMind abrieron de forma independiente la caja negra de IA en medicina</a></li>
<li><a href="../es435822/index.html">C√≥mo controlar el hardware en un centro de datos usando sonido</a></li>
<li><a href="../es435824/index.html">Lo que necesita saber antes de comenzar una carrera en la industria del audio</a></li>
<li><a href="../es435826/index.html">5 mandamientos de un negociador y socio exitoso</a></li>
<li><a href="../es435830/index.html">OMEGA - Automatizaci√≥n del tiempo de eventos deportivos.</a></li>
<li><a href="../es435834/index.html">EXAMEN - M√©todo de clasificaci√≥n de texto de vanguardia</a></li>
<li><a href="../es435836/index.html">Las firmas m√°s grandes de Wall Street acuerdan lanzar un nuevo intercambio para competir con Nasdaq y NYSE</a></li>
<li><a href="../es435838/index.html">Funciones perezosas de JavaScript</a></li>
<li><a href="../es435840/index.html">Una peque√±a descripci√≥n de SIMD en .NET / C #</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>