<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîü ü§Ωüèæ üë©üèº‚Äçüç≥ Es wurde eine Formel f√ºr einen schmerzlosen √úbergang zu .Net Core gefunden üóìÔ∏è üßóüèø üöå</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="F√ºr alles √ºber alles reichen 50 Tassen Kaffee. 


 Zus√§tzlich zu der oben beschriebenen Faustregel ver√∂ffentlichen wir eine kurze Anmerkung zu den Pun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Es wurde eine Formel f√ºr einen schmerzlosen √úbergang zu .Net Core gefunden</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/true_engineering/blog/422441/"><p>  F√ºr alles √ºber alles reichen 50 Tassen Kaffee. </p><br><p>  Zus√§tzlich zu der oben beschriebenen Faustregel ver√∂ffentlichen wir eine kurze Anmerkung zu den Punkten, die genau beachtet werden m√ºssen, damit im Kampf und in den Prozessen nichts kaputt geht.  Die Notiz wurde gemacht, um die Ver√∂ffentlichung eines mobilen Dienstes zu verfolgen, der vollst√§ndig auf .Net Core migriert wurde (der Anfang wurde <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> gelegt).  Wir haben es geschafft, diesen Vorgang vom Kunden unbemerkt durchzuf√ºhren, fast ohne den Hauptentwicklungsprozess anzuhalten. </p><br><p>  Unten ist ein vorgefertigter Aktionsplan, es wird eine sehr umfangreiche Testliste geben, dieses Bild wird hier f√ºr die Stimmung sein: </p><br><p><img src="https://habrastorage.org/webt/pt/yp/6s/ptyp6szarkzymkgf34tz0ide3r8.jpeg"></p><a name="habracut"></a><br><h3 id="itak-po-shagam">  Also in Schritten: </h3><br><h4 id="1-zaplanirovat-dlinnyy-sprint-s-bolshimi-fichami-iili-regressom">  1. Planen Sie einen langen Sprint mit gro√üen Funktionen und / oder Regression </h4><br><p>  Bei grundlegenden Code-Umschreibungen ben√∂tigt der Service Zeit, um so lange wie m√∂glich darauf zu bestehen, um Zeit zu haben, um alle Fehler in der Testumgebung zu beheben. </p><br><h4 id="2-v-akkurat-k-sprintu-perepisat-kod-na-net-core">  2. Schreiben Sie im genauen Sprint den Code auf .Net Core neu </h4><br><p>  Warum ist es wichtig, dieses Gesch√§ft nicht im Voraus zu starten?  Weil Sie mit dem neuen und dem alten .net zwei Codezweige ziehen m√ºssen, weil jederzeit ein Dringlichkeitsvogel einfliegen kann oder Sie eine Demo neuer Funktionen durchf√ºhren m√ºssen und dann √Ñnderungen am alten stabilen Zweig vornehmen m√ºssen.  Um diesbez√ºglich nur minimale Bedenken zu haben, ist es besser, den Moment des √úbergangszustands zu verk√ºrzen. </p><br><p>  √úbrigens kamen wir bei der Arbeit mit dem Code schnell zu dem Schluss, dass es bequemer ist, zwei Kopien des Repositorys lokal aufzubewahren.  Es ist einfacher und bequemer als zwei massive Zweige zu wechseln. </p><br><ul><li>  Wenn m√∂glich, schreiben Sie WCF-Schnittstellen in Webapi in den verwendeten Diensten neu </li></ul><br><p>  Die .Net Core-Implementierung des WCF-Clients ist noch lange nicht ideal.  Trotz der Tatsache, dass die alten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wunden</a> in irgendeiner Weise behoben sind, m√ºssen Sie in den neuen Versionen immer noch die Problemumgehung verwenden ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2</a> ). </p><br><blockquote>  F√ºr die Geschichte: Unter .Net Core 2.0 ist die stabile Arbeitsversion von WCF 4.4.2 aus dem Myget-Repository.  Sie hat zum Beispiel keine Probleme mit einer fr√ºhen Auszeit </blockquote><p>  Zu Beginn der Migration haben wir die Version von .Net Core 2.0 verwendet.  Inzwischen hat Microsoft .Net Core 2.1 ver√∂ffentlicht.  Wer die Erfolge der Redmond-Leute bei der Optimierung der Plattform bewundern m√∂chte, sollte lesen, welche Fortschritte die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bing-</a> Suchmaschine beim Upgrade auf die neue Version gemacht hat (Spoiler: latensi um 34% gefallen!) </p><br><p>  Wir haben auch ein Upgrade auf .Net Core 2.1 und WCF 4.5.3 durchgef√ºhrt.  Und wir haben nicht vergessen, in der Docker-Datei ein neues Basis-Microsoft / Dotnet-Image anzugeben: 2.1-Aspnetcore-Laufzeit.  Was war die √úberraschung, als sie anstelle von 1,4 GB eine Bildgr√∂√üe von 0,5 GB sahen (wir sprechen von einem Windows-Bild, wenn auch pl√∂tzlich). </p><br><h4 id="3-zadeploit-na-test-i-demo">  3. Machen Sie sich bereit f√ºr einen Test und eine Demo </h4><br><p>  Wir haben zwei Umgebungen zur Verf√ºgung.  Wir haben die Demo mit der alten Version als Referenz verlassen.  In der Testumgebung wurde ein neuer Dienst bereitgestellt - ein Lauf f√ºr Entwickler und Tester. </p><br><p> Es gab einige Verwirrung aufgrund der Tatsache, dass Entwickler normalerweise mit dem Test arbeiten und Tester haupts√§chlich mit einer Demo.  Wenn der alte Dienst aktualisiert werden musste, war die Situation genau das Gegenteil von normal.  Daher war eine Diskussion und ein Spickzettel n√ºtzlich, wo und wonach gesucht werden sollte. </p><br><ul><li>  Konfigurieren Sie IIS </li></ul><br><p>  Um den .Net Core-Dienst in IIS auszuf√ºhren, m√ºssen Sie das mit der Laufzeit gelieferte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Modul</a> installieren. </p><br><p>  AppPool wechselt zu CLR Runtime = No Managed Code. </p><br><p>  Bei der L√∂sung in der Standard- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">web.config ist</a> es wichtig, nicht zu vergessen, das gew√ºnschte requestTimeout festzulegen und das WebDAV-Modul zu deaktivieren, wenn DELETE-Methoden vorhanden sind. </p><br><p>  Dar√ºber hinaus gibt es zwei M√∂glichkeiten, einen Dienst in IIS zu ver√∂ffentlichen: </p><br><ul><li>  Sie f√ºhren die MSDeploy-Synchronisierung durch. Dies bedeutet, dass Sie zus√§tzlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den</a> Schalter -enableRule ben√∂tigen: AppOffline </li><li>  Sie ver√∂ffentlichen Dateien - dies bedeutet, dass Sie die Datei app_offline.htm genau vor der Ver√∂ffentlichung im Dienstverzeichnis ablegen und nach der Ver√∂ffentlichung l√∂schen m√ºssen </li></ul><br><p>  Sowohl das als auch ein anderes erm√∂glichen es, einen Arbeitsprozess zu stoppen und ausf√ºhrbare Dateien zu √∂ffnen.  Andernfalls tritt ein Fehler auf, dass die Dateien nicht zum √úberschreiben verf√ºgbar sind. </p><br><blockquote>  Wir haben die Protokollierung √ºber Nlog zugunsten von Serilog abgelehnt und die automatische Komprimierung von Protokollen verloren - in Serilog gibt es einfach keine solche Funktion.  In diesem Fall k√∂nnen Sie mit normalen Windows-Tools gespeichert und die NTFS-Komprimierung in den Verzeichniseigenschaften installiert werden. </blockquote><br><h4 id="4-protestirovat">  4. Testen </h4><br><p>  Hier ist die am meisten geschrumpfte Checkliste f√ºr die fragilsten Orte: </p><br><ul><li>  √úberpr√ºfen Sie die R√ºckgabe von Statuscodes. Ung√ºltige Anforderung, Nicht autorisiert, Nicht ge√§ndert, Nicht gefunden - alles, was die API geben kann </li><li>  √úberpr√ºfen Sie die Anforderungsprotokollierung auf alle Statuscodes </li><li>  Erstellen Sie ein Diagramm der externen Abh√§ngigkeiten.  Alle notwendigen Informationen befinden sich in der Regel in Appsettings <br><ul><li>  verbannen Methoden, die ihre Arbeit beeinflussen </li><li>  √úberpr√ºfen Sie die Protokollierung externer Anforderungen </li></ul></li><li>  √úberpr√ºfen Sie die Funktion der Einstellungen f√ºr die App-Einstellungsparameter.  Versuchen Sie, sie gegen hei√ü auszutauschen </li><li>  √úberpr√ºfen Sie das http-Caching auf positive und negative Statuscodes <br><ul><li>  ETag-Header </li><li>  Header-Cache-Steuerung </li></ul></li><li>  √úberpr√ºfen Sie lange Anfragen und Zeit√ºberschreitungen </li><li>  √úberpr√ºfen Sie Anfragen mit einer leeren Antwort </li><li>  √úberpr√ºfen Sie die DELETE-Methoden (WebDAV ist deaktiviert oder nicht). </li><li>  √úberpr√ºfen Sie die Arbeit mit Rohinhalten <br><ul><li>  Laden Sie eine / mehrere Dateien hoch und laden Sie sie herunter </li><li>  Laden Sie Dateien mit einer Gr√∂√üe √ºber dem Grenzwert hoch </li><li>  Header-Layout Inhaltsdisposition </li></ul></li><li>  √úberpr√ºfen Sie alle anderen Header.  Es ist ziemlich einfach, sie alle im Code zusammenzuf√ºgen </li><li> √úberpr√ºfen Sie die bedingte Codeausf√ºhrung beim Wechseln der Umgebung, <code>if (env.IsDevelopment())</code> </li><li>  √úberpr√ºfen Sie die Trennung von Client und Server </li><li>  Vergleiche mit dem Standard swagger.json - hilft dabei, den Unterschied in den √ºbertragenen Feldern zu erkennen <br><blockquote>  Unsere mobile Anwendung verwendet einen Codegenerator, um mit der API basierend auf der Beschreibung von swagger.json zu arbeiten. Daher war es wichtig, dass der Unterschied zur urspr√ºnglichen Beschreibung minimal war.  In der neuesten Version von Swashbuckle.AspNetCore haben sich die Benutzeroberfl√§che und die generierte Datei swagger.json stark ver√§ndert.  Ich musste auf die sch√§bige Version von Swashbuckle.AspNetCore 1.2.0 zur√ºckgreifen und ein paar Filter hinzuf√ºgen. <br></blockquote></li></ul><br><h4 id="5-zadeploit-na-boy-popivaya-kofeek">  5. Machen Sie einen Kampf, w√§hrend Sie Kaffee trinken </h4><br><p>  In unserem Fall besteht die Kampfumgebung aus zwei Knoten: aktiv und passiv. <br>  Damit der Wechsel zum neuen Dienst unbemerkt bleibt, haben wir den Pool und die Site auf jedem Knoten dupliziert und ein Skript geschrieben, um die Bindung zwischen der alten und der neuen Site zu wechseln. </p><br><p>  So konnten wir im Notfall schnell auf die alte Version umsteigen. </p><br><p>  Nach dem Einsatz in der Schlacht waren wir innerhalb einer Woche von der Realisierbarkeit des Dienstes √ºberzeugt und haben gr√ºnes Licht f√ºr die Ver√∂ffentlichung der mobilen Anwendung gegeben.  Das Leben im Projekt kehrte sicher zu seinem vorherigen Kurs zur√ºck. </p><br><h3 id="promezhutochnyy-itog">  Zwischensumme </h3><br><p>  Jetzt ist unser Service vollst√§ndig bereit, einen Docker-Container f√ºr die Lieferung an den Cluster zu erweitern.  Wir sind bereit f√ºr die Bereitstellung in Kubernetes und Service Fabric. </p><br><p>  Jetzt laufen die Vorbereitungen f√ºr die Pr√§sentation der neuen Infrastruktur beim Kunden.  Wir werden in der n√§chsten Serie √ºber unsere Erfolge berichten, bleiben Sie am Puls der Zeit;) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de422441/">https://habr.com/ru/post/de422441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de422431/index.html">Japanische Feen zeigen Master-Slave-Trigger in neuem Manga auf digitaler Elektronik</a></li>
<li><a href="../de422433/index.html">Sonnenkollektoren und Asphaltstra√üen. Symbiose der Technologie</a></li>
<li><a href="../de422435/index.html">Timer - Start</a></li>
<li><a href="../de422437/index.html">User Experience-Spiele sowie Website- und Anwendungsgeschwindigkeit</a></li>
<li><a href="../de422439/index.html">Der Kampf mit Yandex: Wie ich mehr als ein Jahr damit verbracht habe, die Seite an die Spitze zu bringen</a></li>
<li><a href="../de422443/index.html">Corona SDK Pr√§ziser Timer</a></li>
<li><a href="../de422445/index.html">BottomAppBar-Implementierung. Teil 3: Verhalten f√ºr Android</a></li>
<li><a href="../de422447/index.html">bytes.Buffer in Go: Optimierungen, die nicht funktionieren</a></li>
<li><a href="../de422449/index.html">Senatoren gegen Amazon: Was ein Online-Shop getan hat</a></li>
<li><a href="../de422451/index.html">H√∂ren Sie sich das Spielemarketing und den Platz eines Drehbuchautors in der Spielebranche an.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>