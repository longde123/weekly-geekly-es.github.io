<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤵🏻 👴🏽 👩‍🍳 Sebuah kisah hacking dari game Dendy atau Contra klasik dengan spreadgan di awal 👃 🦗 👈🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sejak artikel terakhir saya, sangat mengejutkan saya, membuat Anda tertarik. Saya memutuskan untuk menambah hasilnya, versi yang diretas dari permaina...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sebuah kisah hacking dari game Dendy atau Contra klasik dengan spreadgan di awal</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447990/"><p>  Sejak <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel</a> terakhir saya, sangat mengejutkan saya, membuat Anda tertarik.  Saya memutuskan untuk menambah hasilnya, versi yang diretas dari permainan "Contra (J) [T + Rus_Chronix]", dengan sedikit fungsionalitas, pada saat yang sama menampilkan "injeksi kode" pada NES.  Kali ini saya akan membuat para pemain memulai permainan dengan Spreadgun yang dipompa, untuk mendapatkannya dalam permainan Anda harus memilih ikon "S", diikuti oleh "R". </p><br><p><img src="https://habrastorage.org/webt/nd/lc/4a/ndlc4arnoooy49jv50nfqggzdey.png"></p><br><p>  Semua tertarik selamat datang di bawah kucing. <a name="habracut"></a></p><br><p>  Secara tradisional: </p><br><div class="spoiler">  <b class="spoiler_title">rekaman video proses yang membosankan dan menjemukan</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/6QTlZS0Gl9A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><p>  Dan kami secara tradisional merencanakan urutan tindakan. </p><br><ol><li>  Temukan Alamat </li><li>  Cari tahu nilai Spreadgun yang dipompa </li><li>  Cari tahu apa yang dia tulis ke alamat-alamat ini di awal permainan </li><li>  Tulis ulang ROM <br><ul><li>  Easyway - ubah nilai senjata dasar menjadi spreadgan yang dipompa </li><li>  Hardway - gunakan injeksi kode lengkap jika cara mudah gagal </li></ul></li><li>  simpan hasilnya ke file baru </li></ol><br><p>  Untuk mencari alamat, kami menggunakan metode yang dijelaskan sebelumnya, tetapi mengingat bahwa nyawa berada di alamat tetangga, kami hanya akan mencari senjata dari pemain pertama dengan harapan bahwa pemain kedua akan berada di dekatnya.  Membuka jendela "Ram watch" setelah dimulainya level pertama, kami mencari nilai yang tidak diketahui.  Saya percaya senjata dasar diatur ke 0, tapi saya tidak tahu pasti. <br>  Kami berlari di sepanjang level tanpa berlari ke depan, menembak ke segala arah dan menyingkirkan nilai yang berubah.  Senjata itu belum berubah. </p><br><p>  Mari kita gunakan opsi jendela lain, atau lebih tepatnya, di bidang "Bandingkan dengan / Dengan", menyoroti frekuensi radio "Jumlah Perubahan", masukkan dalam bidang 0. Jenis perbandingan tentu saja "Setara dengan".  Senjata itu masih tidak berubah. </p><br><p>  Jadi melompat dari opsi "sama dengan nilai sebelumnya", ke opsi "jumlah perubahan adalah 0", Anda dapat mencapai sekitar 10.000 alamat.  Ketika skrining lebih lanjut akan mengurangi daftar alamat terlalu sedikit atau tidak sama sekali, seseorang dapat maju cukup jauh untuk merobohkan senjata pertama. </p><br><p>  Setelah mengambilnya, kami segera menggunakan metode pencarian "tidak sama dengan nilai sebelumnya", dan selanjutnya mengurangi daftar dengan mencari "jumlah perubahan adalah 1", senjata berubah tepat sekali. </p><br><p>  Di tempat kami mengambil senjata pertama kami, penguat senjata juga muncul.  Setelah memilih dan mengambilnya, Anda dapat mengurangi jumlah alamat menjadi 1, tetapi jika itu tidak berhasil, bunuh saja karakter Anda dan ubah senjatanya lagi.  (Jangan lupa tentang pencarian setelah setiap perubahan). </p><br><p>  Dengan penguat senjata, ada beberapa risiko bahwa itu tidak akan mengubah nilai senjata itu sendiri, tetapi bendera di tempat lain dalam memori, tetapi mari kita berharap bahwa penulis permainan menyimpan memori dan instruksi.  Dan, saya beruntung bonus "R" mengubah nilai senjata dan alamatnya berada di koordinat AA <sub>16</sub> .  (Saya bisa saja salah, tetapi saya berulang kali memonitor senjata pahlawan di berbagai versi permainan Contra, seperti di mana-mana alamat ini adalah AA <sub>16</sub> ). </p><br><p>  Saya juga memperhatikan bahwa bonus "R" meningkatkan nilai dalam alamat dengan 16 <sub>10</sub> atau 10 <sub>16</sub> , yaitu, meningkat 1 digit pertama dari angka heksadesimal. </p><br><p>  Setelah restart di jendela "Ram watch", dapat dilihat bahwa nilai dasarnya benar-benar 00 <sub>16</sub> , bonus "M" meningkatkan digit kedua sebesar 1, dan bonus "R" yang pertama. </p><br><p>  Anda bisa menggunakan spreadgan, pasti akan bertemu di level ini, atau Anda dapat mengubah nilai alamat untuk melihat angka apa, senjata apa yang mereka buat.  Secara empiris, saya menemukan bahwa, 01 <sub>16</sub> adalah "Machinegun", 02 <sub>16</sub> adalah "Fire", 03 <sub>16</sub> adalah "Spreadgun", dan 04 <sub>16</sub> adalah "Laser".  Ketika Anda memasukkan nilai-nilai lain di digit kedua, berbagai gangguan terjadi. </p><br><p>  Setelah mengatur ulang permainan dan memasukkan nilai 1x <sub>16</sub> , (di mana "x" adalah salah satu opsi yang dapat diterima) sebelum memilih bonus "Cepat", Anda dapat mengetahui bahwa memilih kembali bonus tidak mengubah apa pun. </p><br><p>  Sekarang Anda dapat memulai kembali gim, memulai gim untuk dua dan mencoba mengubah alamat yang berdekatan dengan AA <sub>16</sub> .  (Ada dua dari mereka, pencarian tidak akan lama) Setelah menembak pemain kedua, saya dengan cepat menemukan bahwa senjata pemain kedua benar-benar disimpan di dekat alamat <sub>16</sub> AB.  Dan sekarang kita tahu alamat yang menarik bagi kita dan nilai yang harus diletakkan di sana, saatnya untuk mencari tahu apa yang dia tulis ke alamat ini. </p><br><p>  Melempar breakpoint pada catatan alamat ini, saya menemukan bahwa rekaman terjadi di sana beberapa kali dan salah satunya setelah splash screen.  Kode berikut membuat entri ini: </p><br><table><thead><tr><th>  Alamat </th><th>  Opcode </th><th>  Mnemonik </th><th>  Argumen </th><th>  A </th><th>  X </th></tr></thead><tbody><tr><td>  C307 </td><td>  A2 28 </td><td>  LDX </td><td>  # $ 28 </td><td>  ?? </td><td>  ?? </td></tr><tr><td>  C309 </td><td>  A9 00 </td><td>  Lda </td><td>  # $ 00 </td><td>  ?? </td><td>  28 atau 29 atau ... atau F0 </td></tr><tr><td>  C30B </td><td>  95 00 </td><td>  STA </td><td>  $ 00, X </td><td>  00 </td><td>  28 atau 29 atau ... atau F0 </td></tr><tr><td>  C30d </td><td>  E8 </td><td>  Inx </td><td></td><td>  00 </td><td>  28 atau 29 atau ... atau F0 </td></tr><tr><td>  C30e </td><td>  E0 F0 </td><td>  CPX </td><td>  # $ F0 </td><td>  00 </td><td>  29 atau 30 atau ... atau F0 </td></tr><tr><td>  C310 </td><td>  D0 F9 </td><td>  Bne </td><td>  $ C30B </td><td>  00 </td><td>  29 atau 30 atau ... atau F0 </td></tr></tbody></table><br><p>  Jika Anda dengan cermat membaca game di sini nol rentang rentang alamat dari 0028 <sub>16</sub> hingga 00F0 <sub>16</sub> , jelas kedua alamat yang menarik bagi kami dalam kisaran.  Jadi tidak akan ada cara mudah.  Saya harus menggunakan "Kode Injeksi" dan solusi paling sederhana yang saya lihat untuk mencari tahu dari mana kita dapatkan dari sini, mengarahkan ulang eksekusi ke suatu tempat yang bebas dari kode dan data dalam memori, menulis di sana versi saya loop yang menempati seluruh jajaran kecuali alamat 00AA <sub>16</sub> dan 00AB <sub>16</sub> dan mengembalikan kereta eksekusi kembali.  Omong-omong, ini adalah versi injeksi paling klasik.  Anda juga dapat berasumsi bahwa kita sampai di sini dari instruksi JSR (Jump to SubRoutine), ini mudah untuk diperiksa dengan stack. </p><br><div class="spoiler">  <b class="spoiler_title">Bagaimana cara kerja tumpukan?</b> <div class="spoiler_text"><p>  Dalam 6502 prosesor, tumpukan selalu berada di kisaran alamat 0100 <sub>16</sub> - 01FF <sub>16</sub> untuk semua komputer yang didasarkan pada prosesor ini, dan tumbuh dari alamat yang lebih besar ke yang lebih kecil.  Ada register terpisah yang menunjuk ke atas tumpukan, awalnya itu sama dengan FF <sub>16</sub> karena byte yang lebih signifikan tidak pernah berubah.  Register itu sendiri selalu menunjukkan byte tertinggi tidak dihuni dengan data yang berguna. </p></div></div><br><p>  Emulator debugger tidak menunjukkan nilai register "Stack Pointer", melainkan menunjukkan alamat yang dirujuk register dan saat ini adalah 01F2 <sub>16</sub> , perhitungan sederhana menunjukkan bahwa data terakhir pada stack adalah C3 <sub>16</sub> dan C2 <sub>16</sub> , yang dapat menyebabkan Saya berpikir tentang alamat C3C2 <sub>16</sub> tetapi 6502 adalah prosesor tipe "Little Endian", dan karena itu, ketika menjalankan instruksi dan menyimpan alamat dalam memori atau di stack, byte yang kurang signifikan ditulis terlebih dahulu.  Dan jika alamatnya benar-benar ada di atas tumpukan, ini adalah alamat C2C3 <sub>16</sub> .  Dan ini adalah alamat dari argumen terakhir dari instruksi JSR, jika lagi, ini adalah alamatnya.  Sangat mudah untuk memeriksa, lihat saja apa yang ditulis dua byte di atas alamat C2C3 <sub>16</sub> . </p><br><table><thead><tr><th>  Alamat </th><th>  Opcode </th><th>  Mnemonik </th><th>  Argumen </th></tr></thead><tbody><tr><td>  C2C1 </td><td>  20 07 C3 </td><td>  Jsr </td><td>  $ C307 </td></tr></tbody></table><br><p>  Seperti yang Anda lihat, ini adalah instruksi JSR ke C307 <sub>16</sub> , yang berarti asumsi subrutin benar. </p><br><p>  Sekarang Anda perlu menulis kode injeksi dengan benar, menemukan tempat yang cocok untuk itu, menulisnya ke tempat ini dan mengarahkan instruksi JSR ke injeksi ini. </p><br><div class="spoiler">  <b class="spoiler_title">Situs Bantuan</b> <div class="spoiler_text"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Opcode</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">instruksi</a> , banyak informasi tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">perakitan 6502</a> . </p></div></div><br><p>  Untuk ini, sangat nyaman menggunakan notepad, saya punya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Visual Studio Code</a> untuk itu.  Setiap orang memiliki gaya penulisan mereka sendiri, secara pribadi, saya adalah orang pertama yang menulis instruksi JSR dengan alamatnya, untuk mengetahui di mana harus berubah dan opcode lengkap, untuk mengetahui apa yang harus diubah. </p><br><p>  Setelah beberapa indentasi, saya menduplikasi kode loop, itu sudah dapat digunakan tanpa alamat, tetapi sangat berguna untuk melihat mnemonik dengan argumen selain opcode, dan berguna untuk mengambil instruksi mengikuti loop ini bersama dengan alamat untuk mengetahui di mana harus kembali dari injeksi. </p><br><pre><code class="plaintext hljs">C2C1:20 07 C3 JSR $C307 A2 28 LDX #$28 A9 00 LDA #$00 95 00 STA $00,X E8 INX E0 F0 CPX #$F0 D0 F9 BNE $C30B C312:A2 07 LDX #$07</code> </pre> <br><p>  Beberapa indentasi di bawah ini Anda dapat menulis kode injeksi itu sendiri, sebenarnya itu adalah duplikat dari siklus itu sendiri dengan beberapa tambahan. </p><br><pre> <code class="plaintext hljs">C312:A2 07 LDX #$07 A2 28 LDX #$28 A9 00 LDA #$00 95 00 STA $00,X E8 INX E0 AA CPX #$AA D0 F9 BNE -7 A9 13 LDA #$13 95 00 STA $00,X E8 INX E0 AC CPX #$AC D0 F9 BNE -7 A9 00 LDA #$00 95 00 STA $00,X E8 INX E0 F0 CPX #$F0 D0 F9 BNE -7</code> </pre> <br><p>  Untuk lebih jelasnya, saya menunjukkan indentasi alih-alih alamat lokasi lompat. </p><br><div class="spoiler">  <b class="spoiler_title">Jika Anda tidak dapat membaca kode ini</b> <div class="spoiler_text"><p>  Berikut ini adalah siklus yang sama, tetapi dibagi menjadi tiga bagian, pada siklus pertama kami membandingkan register X dengan nilai AA <sub>16</sub> , karena kita perlu nol semua alamat ke alamat 00AA <sub>16</sub> , setelah kita memasukkan 13 <sub>16</sub> di register A, nilai spreadgan yang dipompa dan tulis siklus kedua ke alamat 00AC <sub>16</sub> mulai dari yang sisa rentang harus di-nolkan lagi.  Kami kembali untuk mendaftarkan A nol dan nol sisa rentang. </p></div></div><br><p>  Sangat penting untuk menyelesaikan instruksi pengembalian injeksi di akhir. </p><br><pre> <code class="plaintext hljs">E0 F0 CPX #$F0 D0 F9 BNE -7 4C 12 C3 JMP $C312</code> </pre> <br><p>  Sekarang, untuk kenyamanan, saya lebih suka menulis opcodes di bawah dalam file. </p><br><pre> <code class="plaintext hljs">4C 12 C3 JMP $C312 A2 28 A9 00 95 00 E8 E0 AA D0 F9 A9 13 95 00 E8 E0 AC D0 F9 A9 00 95 00 E8 E0 F0 D0 F9 4C 12 C3</code> </pre> <br><p>  Dan setelah menghitung opcodes, mudah untuk mengetahui bahwa ada 32 dari mereka.  Oleh karena itu, Anda perlu menemukan 20 <sub>16</sub> alamat kosong di ROM.  Sebagai aturan, alamat yang tidak dihuni adalah ruang besar dengan nilai yang sama, paling sering nol atau FF <sub>16.</sub> Itu hanya bagian besar yang perlu ditemukan, harus setidaknya 35 <sub>10</sub> alamat sehingga ada beberapa margin. </p><br><p>  Dalam "Hex Editor" saya menemukan kisaran seperti itu di B29E <sub>16</sub> -BFFF <sub>16</sub> .  Menggunakan awal situs gratis semacam itu untuk injeksi bisa berbahaya, oleh karena itu saya menyarankan Anda untuk menulis kode injeksi di akhir.  Alamat yang paling nyaman untuk memulai injeksi adalah BFE0 <sub>16</sub> , tetapi ini adalah alamat di memori konsol, untuk mencari tahu di mana ia berada dalam file ROM, klik kanan padanya dan pilih "Go Here In ROM File". </p><br><p>  Sekarang Anda dapat menyalin-tempel seluruh opcode di sini (32 nilai).  Petunjuk perubahan sentuhan akhir </p><br><pre> <code class="plaintext hljs">C2C1:20 07 C3 JSR $C307</code> </pre> <br><p>  untuk melompat ke alamat injeksi yang saya miliki adalah BFE0 <sub>16</sub> . </p><br><pre> <code class="plaintext hljs">C2C1:20 E0 BF JSR $BFE0</code> </pre> <br><p>  Tentu saja, menemukan tempat pengajaran yang benar pada ROM. </p><br><div class="spoiler">  <b class="spoiler_title">Jawaban atas pertanyaan para profesional yang lalai.</b> <div class="spoiler_text"><p>  Alamat instruksi JSR berada di tumpukan, oleh karena itu, terlepas dari tempat lompatan, alamat pengirim yang sama akan ada di sana, dan dari injeksi kami kembali ke kode dengan instruksi JMP yang tidak mempengaruhi tumpukan dengan cara apa pun.  Dengan demikian, instruksi RTS bekerja di tempat yang sama tanpa injeksi, dan kembali ke tempat yang sama tanpa injeksi.  Akibatnya, injeksi ini tidak mematahkan tumpukan. </p></div></div><br><p>  PS Untuk selamanya, Anda masih perlu memastikan bahwa setelah kematian karakter-karakter tersebut terlahir kembali dengan spread yang dipompa, tetapi saya yakin dengan pengetahuan yang Anda dapat tangani sendiri.  Saya akan mengalihkan pandangan saya ke hal lain.  Mesin persatuan misalnya. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id447990/">https://habr.com/ru/post/id447990/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id447976/index.html">Pengembangan dan perakitan lampu foto</a></li>
<li><a href="../id447980/index.html">Mengapa sangat penting untuk Berinvestasi dan Mengembangkan aplikasi Taksi bermerek untuk usaha Anda?</a></li>
<li><a href="../id447982/index.html">Intisari: 10 materi tentang layar dan proyektor untuk home theater</a></li>
<li><a href="../id447984/index.html">Uber telah mengajukan dokumen untuk IPO</a></li>
<li><a href="../id447986/index.html">Sebuah cerita yang sangat matematis dari kombinasi warna yang sempurna</a></li>
<li><a href="../id447992/index.html">Cari tahu usia pengguna VK atau apa lagi yang bisa diketahui oleh grafik sosial</a></li>
<li><a href="../id447994/index.html">Perjalanan panjang ke Tox-rs. Bagian 1</a></li>
<li><a href="../id447996/index.html">Bagaimana para ilmuwan mempelajari gen yang mengendalikan regenerasi tubuh lengkap</a></li>
<li><a href="../id447998/index.html">Debugging Perjalanan Waktu di Visual Studio Enterprise 2019</a></li>
<li><a href="../id448000/index.html">Cara cepat mencoba CQRS / ES di Laravel atau menulis bank dalam PHP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>