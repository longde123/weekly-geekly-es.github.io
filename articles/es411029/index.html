<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦃 📳 🌿 Cómo usar interfaces en Go ⚛️ 📳 🙌🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En su tiempo libre del trabajo principal, el autor del material consulta en Go y analiza el código. Naturalmente, en el curso de tal actividad, lee mu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cómo usar interfaces en Go</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/wirex/blog/411029/"><img src="https://habrastorage.org/webt/3r/a6/gf/3ra6gfzzmia3bmlydkdkqbmpl6a.jpeg"><br><br>  <i>En su tiempo libre del trabajo principal, el autor del material consulta en Go y analiza el código.</i>  <i>Naturalmente, en el curso de tal actividad, lee mucho código escrito por otras personas.</i>  <i>Recientemente, el autor de este artículo tiene la impresión (sí, la impresión, sin estadísticas) de que los programadores tienen más probabilidades de trabajar con interfaces en el "estilo Java".</i> <i><br><br></i>  <i>Esta publicación contiene recomendaciones del autor sobre el uso óptimo de las interfaces en Go, en función de su experiencia en la escritura de código.</i> <br><br>  En los ejemplos de este post usaremos dos paquetes <code>animal</code> y <code>circus</code> .  Muchas cosas en esta publicación describen el trabajo con código que limita con el uso regular de paquetes. <br><br><h3>  Como no hacer </h3><br>  Un fenómeno muy común que observo: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> animals <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Animal <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Speaks() <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-comment"><span class="hljs-comment">//  Animal type Dog struct{} func (a Dog) Speaks() string { return "woof" }</span></span></code> </pre> <a name="habracut"></a><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> circus <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"animals"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Perform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a animal.Animal)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a.Speaks() }</code> </pre> <br>  Este es el llamado uso de interfaces de estilo Java.  Se puede caracterizar por los siguientes pasos: <br><br><ol><li>  Definir una interfaz. </li><li>  Defina un tipo que satisfaga el comportamiento de la interfaz. </li><li>  Definir métodos que satisfagan la implementación de la interfaz. </li></ol><br>  En resumen, estamos tratando con "tipos de escritura que satisfacen las interfaces".  Este código tiene su propio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">olor</a> distintivo, lo que sugiere los siguientes pensamientos: <br><br><ul><li>  Solo un tipo satisface la interfaz, sin ninguna intención de expandirla aún más. </li><li>  Las funciones generalmente toman tipos concretos en lugar de tipos de interfaz. </li></ul><br><h3>  ¿Cómo hacer en su lugar </h3><br>  Las interfaces en Go fomentan un enfoque perezoso, lo cual es bueno.  En lugar de escribir tipos que satisfagan las interfaces, debe escribir interfaces que cumplan requisitos prácticos reales. <br><br>  Lo que significa: en lugar de definir <code>Animal</code> en el paquete de <code>animals</code> , defínalo en el punto de uso, es decir, el paquete de <code>circus</code> <abbr title="Podría, por supuesto, definirlo en una firma de función, pero este es un enfoque demasiado descuidado">*</abbr> . <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> animals <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Dog <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a Dog)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Speaks</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"woof"</span></span> }</code> </pre> <br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> circus <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Speaker <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Speaks() <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Perform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a Speaker)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a.Speaks() }</code> </pre> <br>  Una forma más natural de hacer esto es así: <br><br><ol><li>  Definir tipos </li><li>  Defina la interfaz en el punto de uso. </li></ol><br>  Este enfoque reduce la dependencia de los componentes del paquete de <code>animals</code> .  Reducir las dependencias es la forma correcta de construir software tolerante a fallas. <br><br><h3>  Ley de la cama </h3><br>  Hay un buen principio para escribir un buen software.  Esta es la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ley de Postel</a> , que a menudo se formula de la siguiente manera: <br><blockquote>  "Sea conservador sobre lo que refiere y liberal sobre lo que acepta" </blockquote>  En términos de Go, la ley es: <br><br><blockquote>  "Aceptar interfaces, devolver estructuras" </blockquote><br>  En general, esta es una regla muy buena para diseñar cosas estables y tolerantes a fallas <abbr title="Por supuesto, hay matices que omito. Por ejemplo, en casos con código sensible al contexto, será muy útil aceptar y dar interfaces)">*</abbr> .  La unidad principal de código en Go es una función.  Al diseñar funciones y métodos, es útil cumplir con el siguiente patrón: <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">funcName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a INTERFACETYPE)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CONCRETETYPE</span></span></span></span></code> </pre> <br>  Aquí aceptamos todo lo que implementa una interfaz que puede ser cualquier cosa, incluida una vacía.  Se sugiere un valor de un tipo específico.  Por supuesto, limitar lo que puede ser tiene sentido.  Como dice un proverbio Go: <br><br><blockquote>  "La interfaz vacía no dice nada", <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Rob Pike</a> </blockquote><br>  Por lo tanto, es muy recomendable evitar que las funciones acepten la <code>interface{}</code> . <br><br><h3>  Ejemplo de aplicación: imitación </h3><br>  Un ejemplo sorprendente de los beneficios de aplicar la ley Postel son los casos de prueba.  Digamos que tiene una función que se ve así: <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Takes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db Database)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span></code> </pre> <br>  Si la <code>Database</code> es una interfaz, en el código de prueba simplemente puede proporcionar una imitación de la implementación de la <code>Database</code> de <code>Database</code> sin la necesidad de pasar un objeto DB real. <br><br><h3>  Cuando la definición de una interfaz por adelantado es aceptable </h3><br>  A decir verdad, la programación es una forma bastante libre de expresar ideas.  No hay reglas inquebrantables.  Por supuesto, siempre puede definir interfaces de antemano, sin temor a ser arrestado por el código policial.  En el contexto de muchos paquetes, si conoce sus funciones y tiene la intención de aceptar una interfaz específica dentro del paquete, hágalo. <br><br>  La definición de una interfaz generalmente huele a ingeniería excesiva, pero hay situaciones en las que obviamente debería hacer exactamente eso.  En particular, me vienen a la mente los siguientes ejemplos: <br><br><ul><li>  Interfaces selladas </li><li>  Tipos de datos abstractos </li><li>  Interfaces recursivas </li></ul><br>  A continuación, consideramos brevemente cada uno de ellos. <br><br><h3>  Interfaces selladas </h3><br>  Las interfaces selladas solo pueden discutirse en el contexto de múltiples paquetes.  Una interfaz sellada es una interfaz con métodos no exportados.  Esto significa que los usuarios fuera de este paquete no pueden crear tipos que satisfagan esta interfaz.  Esto es útil para emular un tipo de variante para buscar exhaustivamente tipos que satisfagan la interfaz. <br><br>  Si ha definido algo como esto: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Fooer <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Foo() sealed() }</code> </pre> <br>  Solo el paquete definido por <code>Fooer</code> puede usarlo y crear algo de valor a partir de él.  Esto le permite crear operadores de interruptor de fuerza bruta para tipos. <br><br>  La interfaz sellada también permite que las herramientas de análisis recojan fácilmente cualquier coincidencia de patrones sin colisión.  El paquete sumtypes de BurntSushi tiene como objetivo resolver este problema. <br><br><h3>  Tipos de datos abstractos </h3><br>  Otro caso de definir una interfaz por adelantado implica crear tipos de datos abstractos.  Pueden ser sellados o no sellados. <br><br>  Un buen ejemplo de esto es el paquete de <code>sort</code> , que forma parte de la biblioteca estándar.  Define una colección ordenable de la siguiente manera <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Interface <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Len —    . Len() int // Less      //   i     j. Less(i, j int) bool // Swap     i  j. Swap(i, j int) }</span></span></code> </pre> <br>  Este fragmento de código molestó a mucha gente, porque si desea utilizar el paquete de <code>sort</code> , deberá implementar métodos para la interfaz.  A muchos no les gusta la necesidad de agregar tres líneas de código adicionales. <br><br>  Sin embargo, creo que esta es una forma muy elegante de genéricos en Go.  Su uso debe fomentarse con mayor frecuencia. <br><br>  Las opciones de diseño alternativas y al mismo tiempo elegantes requerirán tipos de orden superiores.  En este post no los consideraremos. <br><br><h3>  Interfaces recursivas </h3><br>  Este es probablemente otro ejemplo de código con un stock, pero a veces es simplemente imposible evitar usarlo.  Manipulaciones simples le permiten obtener algo como <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Fooer <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Foo() Fooer }</code> </pre> <br>  Un patrón de interfaz recursivo obviamente requerirá su definición por adelantado.  La recomendación de definición de interfaz de punto de uso no es aplicable aquí. <br><br>  Este patrón es útil para crear contextos con trabajo posterior en ellos.  El código cargado por el contexto generalmente se encierra dentro del paquete con la exportación de solo los contextos (ala el paquete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tensorial</a> ), por lo que en la práctica no veo este caso con tanta frecuencia.  Puedo decirte algo más sobre patrones contextuales, pero déjalo para otra publicación. <br><br><h3>  Conclusión </h3><br>  A pesar de que uno de los encabezados de la publicación dice "Cómo no hacerlo", de ninguna manera estoy tratando de prohibir nada.  Más bien, quiero que los lectores piensen más a menudo sobre las condiciones fronterizas, ya que es en tales casos que surgen varias situaciones de emergencia. <br><br>  El principio de declaración de punto de uso me parece extremadamente útil.  Como resultado de su aplicación en la práctica, no encuentro problemas que surgen si lo descuido. <br><br>  Sin embargo, ocasionalmente también escribo ocasionalmente interfaces de estilo Java.  Por lo general, esto sucede si, poco antes, escribí mucho código en Java o Python.  El deseo de complicar demasiado y "representar todo en forma de clases" a veces es muy fuerte, especialmente si escribe código Go después de escribir mucho código orientado a objetos. <br><br>  Por lo tanto, esta publicación también sirve como un recordatorio para uno mismo sobre cómo se ve el camino para escribir código que, posteriormente, no causará dolor de cabeza.  Esperando sus comentarios! <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/files/4bd/bf6/597/4bdbf659775744b1bdbb4d8a00a0a980.png" alt="imagen"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es411029/">https://habr.com/ru/post/es411029/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es411017/index.html">La soledad de los nacidos. Desarrollo a través del vuelo. Camino duro para ti</a></li>
<li><a href="../es411019/index.html">Para salir de Rusia y buscar trabajo en el extranjero: nos estamos preparando para una entrevista en inglés</a></li>
<li><a href="../es411021/index.html">Sunlike - la nueva generación de luz LED</a></li>
<li><a href="../es411023/index.html">Antropoceno africano</a></li>
<li><a href="../es411027/index.html">Juegos Olímpicos escolares: Jedi Sword, Jetpack y Teleport hasta 2035</a></li>
<li><a href="../es411031/index.html">El primer escáner MEG portátil del mundo</a></li>
<li><a href="../es411033/index.html">“Hacer”, “entender”, “estar de acuerdo”: sinónimos en inglés</a></li>
<li><a href="../es411035/index.html">¿O tal vez estás durmiendo ahora?</a></li>
<li><a href="../es411037/index.html">Sochi.Camera: cómo un proveedor regional creó un sitio de transmisión de video con una visita de 500,000 personas al mes</a></li>
<li><a href="../es411039/index.html">El segundo contacto, o en lugar del epílogo.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>