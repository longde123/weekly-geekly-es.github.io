<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äçüé® üê¨ üíé Event Tracing f√ºr Windows ist auf der b√∂sen Seite. Das ist aber nicht sicher üíà üë®üèª‚Äç‚öïÔ∏è üëó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In fr√ºheren Artikeln √ºber den PowerShell-Sniffer und das Sammeln von Startdaten von einem Remote-Server habe ich bereits ein wenig √ºber die ETW-Funkti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Event Tracing f√ºr Windows ist auf der b√∂sen Seite. Das ist aber nicht sicher</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pc-administrator/blog/418787/"><p><img src="https://habrastorage.org/webt/ii/h9/zh/iih9zhmwsn9nofzy8rkouzp4yry.jpeg"></p><br><p>  In fr√ºheren Artikeln √ºber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den PowerShell-Sniffer</a> und das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sammeln von Startdaten von einem Remote-Server habe</a> ich bereits ein wenig √ºber die ETW-Funktionen (Event Tracing f√ºr Windows) geschrieben.  Heute m√∂chte ich mehr √ºber diese Technologie sprechen. </p><br><p>  Gleichzeitig werde ich die Verwendung von HTTPS und das Erstellen eines Keyloggers in PowerShell als Beispiel daf√ºr demonstrieren, wie es f√ºr immer verwendet werden kann.  Oder nicht wirklich zum Guten. <a name="habracut"></a></p><br><h1 id="rabota-s-etw">  Arbeite mit ETW </h1><br><p>  Die Ereignisverfolgung f√ºr Windows sammelt und sendet Nachrichten von Windows-Systemkomponenten und Anwendungen von Drittanbietern.  Es erschien in den Tagen von Windows 2000, aber wenn es damals mehrere Dutzend Systemanbieter gab, liegt ihre Punktzahl jetzt bereits bei Hunderten.  Nachrichten werden bequem verwendet, um Fehler zu diagnostizieren und Software-Leistungsprobleme zu l√∂sen. </p><br><p> Einige Systemanbieter schreiben bereits standardm√§√üig in das Windows-Ereignisprotokoll, andere sind separat enthalten.  Selbst wenn Sie nicht √ºber ETW Bescheid wissen, verwenden Sie es wahrscheinlich.  Sie k√∂nnen sich mit den Protokollen vertraut machen und einige davon bei Bedarf in der Standardereignisanzeige in den Anwendungs- und Dienstprotokollen aktivieren.  Ein wenig √ºber das Magazin und die Arbeit damit finden Sie im Artikel " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wir drehen die Protokolle nach Belieben - Analyse von Protokollen in Windows-Systemen</a> ". </p><br><p>  <strong>Sie k√∂nnen die Liste der vorhandenen Anbieter anzeigen, die</strong> uns nur gerne mit dem Befehl <strong>logman query provider</strong> mitteilen, was mit ihnen geschieht. </p><br><p><img src="https://habrastorage.org/webt/l1/pj/bk/l1pjbkjfufxvyqp5ro4xv4qjyne.jpeg"></p><br><p>  <em>ETW-Anbieter.</em> </p><br><p>  Sie k√∂nnen die Liste der Anbieter anzeigen, die mit einem bestimmten Windows-Prozess verbunden sind (und daher etwas dar√ºber erfahren), indem Sie den <strong>Befehl -pid &lt;process PID&gt; von logman query provider verwenden.</strong> </p><br><p><img src="https://habrastorage.org/webt/f2/q3/is/f2q3is7egt-nmq70kkeoijqvrp0.jpeg"></p><br><p>  <em>Liste der Anbieter, die mit einem normalen Notebook verbunden sind.</em> </p><br><p>  <strong>Sie</strong> k√∂nnen das <strong>Abonnement f√ºr Ereignisse eines</strong> bestimmten Anbieters oder die Ablaufverfolgung √ºber PowerShell mithilfe des <strong>Cmdlets New-NetEventSession aktivieren</strong> .  Sie k√∂nnen sogar mit der Maus auf den Pfad "Computerverwaltung" - "Leistung" - "Gruppe von Datensammlern" klicken.  Hier k√∂nnen Sie in den Ereignisverfolgungssitzungen sehen, welche Traces ausgef√ºhrt werden, und auf Wunsch einen eigenen Collector erstellen. </p><br><p><img src="https://habrastorage.org/webt/gh/bx/qe/ghbxqepwh2ilmzzul7khowlivgo.jpeg"></p><br><p>  <em>Spuren laufen lassen.</em> </p><br><p>  <strong>Sie k√∂nnen das Ergebnis</strong> mit Dienstprogrammen und Dienstprogrammen wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Microsoft Message Analyzer</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Windows Performance Toolkit</a> oder sogar dem PowerShell <strong>-Cmdlet Get-WinEvent anzeigen</strong> . </p><br><p>  Ich empfehle, dass Sie die Funktionen von ETW in der Microsoft-Dokumentation lesen. Beginnen Sie mit dem Abschnitt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationen</a> zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ereignisverfolgung</a> .  Ich kann auch gutes Material empfehlen: ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wir studieren ETW und ziehen Gewinne heraus</a> ‚Äú. </p><br><p>  Da ETW auf Kernel-Ebene arbeitet, zeichnet es sich durch die Geschwindigkeit der Nachrichten√ºbertragung und das Fehlen der Notwendigkeit aus, Treiber oder Injects in Anwendungen zu installieren.  In der Regel werden ETWs verwendet, um Leistungs- und Anwendungsprobleme zu diagnostizieren.  Im Artikel ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beschleunigen des Windows-Starts f√ºr Spa√ü und Gewinn</a> ‚Äú werden beispielsweise Faktoren analysiert, die die Verlangsamung des Ladens beeinflussen. In dem Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">24-Core-CPU k√∂nnen ich meine Maus nicht bewegen</a> - die Gr√ºnde f√ºr die Verlangsamung von Windows bei normalen Vorg√§ngen.  Lassen Sie mich ein Beispiel geben - die Analyse der Ausf√ºhrung von PowerShell-Cmdlets. </p><br><h1 id="sledim-za-powershell">  PowerShell ansehen </h1><br><p>  Angenommen, Sie stellen auf irgendeine Weise (z. B. durch eine Pr√ºfung von Prozessstarts) fest, dass verwaschene Prozesse und PowerShell-Skripts auf Ihrem Computer ausgef√ºhrt werden.  Eine Technik wird darin bestehen, ETWs zu verwenden, um ihre Aktivit√§t zu analysieren.  Schauen Sie sich beispielsweise den PowerShell-Anbieter an.  Aktivieren Sie die Ablaufverfolgung mit dem folgenden Befehl: </p><br><pre><code class="bash hljs">logman start pstrace -p Microsoft-Windows-PowerShell -oc:\temp\pstrace.etl -ets</code> </pre> <br><p>  Warten wir nun, bis die unverst√§ndlichen Skripte funktionieren, und stoppen Sie die Ablaufverfolgung mit dem folgenden Befehl: </p><br><pre> <code class="bash hljs">logman stop pstrace -ets</code> </pre><br><p>  Jetzt k√∂nnen Sie die Ablaufverfolgung beispielsweise √ºber Microsoft Message Analyzer anzeigen. </p><br><p><img src="https://habrastorage.org/webt/3i/3j/7u/3i3j7uamctkk9-pd23lmtizdjcs.jpeg"></p><br><p>  <em>Verd√§chtige clean.ps1 sucht offensichtlich nach etwas und l√∂scht es.</em> </p><br><p>  Wenn Sie die gew√ºnschte Zeile ausw√§hlen, werden im unteren Bereich erweiterte Informationen zum Ereignis angezeigt. </p><br><p><img src="https://habrastorage.org/webt/xk/tx/3t/xktx3thdkpitn0bueqhlaqmfx1k.jpeg"></p><br><p>  <em>Ah, dies ist das gleiche Skript zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">L√∂schen des</a> 1C-Cache!</em> </p><br><p>  Diesmal stellte sich heraus, dass alles banal war.  In komplexeren F√§llen k√∂nnen Sie jedoch eine Ablaufverfolgung ausf√ºhren, um andere Aktivit√§ten zu √ºberpr√ºfen: </p><br><ul><li>  Netzwerkaktivit√§t; </li><li>  DNS-Aufl√∂sung </li><li>  Festplattenzugriff; </li><li>  mit dem Ged√§chtnis arbeiten; </li><li>  WMI-Aktivit√§t </li><li>  und vieles mehr. </li></ul><br><p>  Auf diese Weise kann ETW helfen, Malware zu erkennen und die Funktionsweise von Anwendungen zu verstehen.  An einigen Stellen ist dies informativer als der √ºbliche <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Prozessmonitor</a> .  Zus√§tzlich zu guten Taten hat der Mechanismus eine ‚Äûdunkle‚Äú Seite. </p><br><blockquote>  Nat√ºrlich k√∂nnen Sie mit einem Hammer t√∂ten und mit einer Waffe sparen.  Nat√ºrlich werde ich keine moralische Bewertung der Mechanismen vornehmen, aber auf jeden Fall er√∂ffnen sich interessante M√∂glichkeiten. </blockquote><p>  Ich werde einige Beispiele als Proof-of-Concept nennen </p><br><h1 id="s--znachit-beeezopasno">  S bedeutet sicher </h1><br><p>  In diesem Beispiel werde ich zeigen, wie einfach es ist, herauszufinden, wonach ein Benutzer im Internet sucht, auch √ºber HTTPS.  Sie k√∂nnen es ohne PowerShell sehen - nur eine Maus, nur Hardcore.  In unserer Aufgabe gibt es einen Benutzer, Windows, Internet Explorer und ein Ereignisprotokoll. </p><br><p>  Beginnen wir mit dem Aktivieren des Wininet-Ereignisprotokolls.  Dies geschieht wie folgt: √ñffnen Sie das Ereignisprotokoll auf der Registerkarte ‚ÄûAnsicht‚Äú und aktivieren Sie die Anzeige von Analyse- und Debugprotokollen. </p><br><p><img src="https://habrastorage.org/webt/fu/de/q0/fudeq02mmzhunyyw1cwib0ou8pm.jpeg"></p><br><p>  <em>F√ºgen Sie die Anzeige der gew√ºnschten Protokolle hinzu.</em> </p><br><p>  Aktivieren Sie danach UsageLog im Kontextmen√º. Dies reicht aus, um die erforderlichen Informationen abzurufen.  Verwenden wir den IE und sehen uns das Protokoll an: </p><br><p><img src="https://habrastorage.org/webt/pj/mu/ja/pjmujaesudek77i77sv0vtnnnjc.jpeg"></p><br><p>  <em>WinInet Magazine.</em> </p><br><p>  Tats√§chlich sind in den Magazink√∂pfen und einer direkten Anfrage an die Suchmaschine sichtbar. </p><br><p>  Zus√§tzlich zu den Headern k√∂nnen Sie das Logbuch auch zum Abrufen von Cookies verwenden und gleichzeitig POST-Anforderungen anzeigen, z. B. zum Abrufen von Anmeldeinformationen.  Die Technik funktioniert in allen Anwendungen, die wininet.dll verwenden, um mit dem Internet zu arbeiten.  Zum Beispiel der Edge-Browser. </p><br><p>  Dasselbe l√§sst sich problemlos in PowerShell und sogar in cmd implementieren.  Ich werde zuletzt ein Beispiel f√ºr die Implementierung geben. </p><br><p>  Erstellen Sie zun√§chst eine Ablaufverfolgung: </p><br><pre> <code class="bash hljs">logman start CookieStealer -p Microsoft-Windows-WinInet -oc:\temp\cookiesteal.etl -ets</code> </pre><br><p>  Lassen Sie uns nun im Browser arbeiten und die E-Mails √ºberpr√ºfen.  Die Ablaufverfolgung kann dann mit dem folgenden Befehl gestoppt werden: </p><br><pre> <code class="bash hljs">logman stop CookieStealer -ets</code> </pre><br><p>  Die einfachste Analyse kann mit dem <strong>Befehlsdienstprogramm wevtutil.exe durchgef√ºhrt werden</strong> .  Zum Anzeigen von POST-Anforderungen lautet der Befehl beispielsweise: </p><br><pre> <code class="bash hljs">wevtutil qe c:\temp\cookiesteal.etl /lf:<span class="hljs-literal"><span class="hljs-literal">true</span></span> /f:Text | find /i <span class="hljs-string"><span class="hljs-string">"POST"</span></span></code> </pre><br><p>  Sie k√∂nnen sogar zuf√§llig versuchen, nach dem Wort <em>Passwort</em> zu suchen und das Ergebnis zu erhalten. </p><br><p><img src="https://habrastorage.org/webt/yg/yk/gd/ygykgdj9vmqmlp7aobfcz5fyyiu.jpeg"></p><br><p>  <em>Passw√∂rter im Klartext.</em>  <em>Sehr nervig.</em> </p><br><p>  Es ist erw√§hnenswert, dass das Antivirus gleichzeitig still war.  Dies ist in der Tat ein normaler Verfolgungsprozess. </p><br><p>  Nat√ºrlich k√∂nnen WinInet-Ereignisse auch verwendet werden, um Probleme wie "Warum diese Site nicht ge√∂ffnet wird und was √ºberhaupt passiert" zu diagnostizieren.  Trotzdem sind die M√∂glichkeiten sehr interessant.  Ich wende mich einem noch verdrehteren Beispiel zu. </p><br><h1 id="keylogger-na-powershell-potomu-chto-mogu">  Keylogger auf PowerShell.  Weil ich kann. </h1><br><p>  Unter Windows gibt es zwei interessante ETW-Anbieter: </p><br><ul><li><p>  <strong>Microsoft-Windows-USB-UCX</strong> (36DA592D-E43A-4E28-AF6F-4BC57C5A11E8) - funktioniert mit USB 2.0. </p><br></li><li><p>  <strong>Microsoft-Windows-USB-USBPORT</strong> (C88A4EF5-D048-4013-9408-E04B7DB2814A) - funktioniert mit USB 3.0. </p><br></li></ul><br><p>  Mit ihrer Hilfe k√∂nnen Sie die HID-Daten abrufen, die ein USB-Ger√§t wie eine Tastatur oder eine Maus √ºbertr√§gt.  Daten werden roh erfasst, k√∂nnen aber dank <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der</a> HID- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spezifikation</a> leicht gelesen werden. </p><br><p>  F√ºhren Sie zum Starten der Ablaufverfolgung einfach die folgenden Befehle aus: </p><br><pre> <code class="bash hljs">logman start <span class="hljs-string"><span class="hljs-string">"usbtrace"</span></span> -p <span class="hljs-string"><span class="hljs-string">"microsoft-windows-usb-usbport"</span></span> -o <span class="hljs-string"><span class="hljs-string">"c:\temp\usbtrace.etl"</span></span> -ets</code> </pre><br><p>  Die Daten k√∂nnen mit dem PowerShell-Cmdlet abgerufen werden: </p><br><pre> <code class="hljs mel">$Input=get-winevent ‚Äìpath <span class="hljs-string"><span class="hljs-string">"c:\temp\usbtrace.etl"</span></span> ‚Äìoldest | where {$_.message ‚Äì<span class="hljs-keyword"><span class="hljs-keyword">match</span></span> <span class="hljs-string"><span class="hljs-string">"Data"</span></span>}</code> </pre><br><p>  Ich werde ein Beispiel f√ºr ein einfaches Skript geben, das Trace-Daten liest und sie in lesbare Werte konvertiert.  Die Konvertierung erfolgt nur f√ºr englische Buchstaben und ausschlie√ülich in Gro√übuchstaben. </p><br><div class="spoiler">  <b class="spoiler_title">Vollst√§ndige Auflistung des Skripts unter dem Spoiler.</b> <div class="spoiler_text"><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$source</span></span> = <span class="hljs-string"><span class="hljs-string">"C:\temp\trace.etl"</span></span> <span class="hljs-variable"><span class="hljs-variable">$destination</span></span>= <span class="hljs-string"><span class="hljs-string">"C:\temp\Output.txt"</span></span> <span class="hljs-variable"><span class="hljs-variable">$tracetime</span></span> = <span class="hljs-string"><span class="hljs-string">"10"</span></span> logman start usbtrace <span class="hljs-literal"><span class="hljs-literal">-p</span></span> microsoft<span class="hljs-literal"><span class="hljs-literal">-windows</span></span><span class="hljs-literal"><span class="hljs-literal">-usb</span></span><span class="hljs-literal"><span class="hljs-literal">-usbport</span></span> <span class="hljs-literal"><span class="hljs-literal">-o</span></span> <span class="hljs-variable"><span class="hljs-variable">$source</span></span> <span class="hljs-literal"><span class="hljs-literal">-ets</span></span> sleep <span class="hljs-variable"><span class="hljs-variable">$TraceTime</span></span> logman stop usbtrace <span class="hljs-literal"><span class="hljs-literal">-ets</span></span> <span class="hljs-variable"><span class="hljs-variable">$Input</span></span>=<span class="hljs-built_in"><span class="hljs-built_in">get-winevent</span></span> ‚Äìpath <span class="hljs-variable"><span class="hljs-variable">$Source</span></span> ‚Äìoldest | where {<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.message ‚Äìmatch <span class="hljs-string"><span class="hljs-string">"Data"</span></span>} <span class="hljs-variable"><span class="hljs-variable">$HID</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">Foreach</span></span> (<span class="hljs-variable"><span class="hljs-variable">$I</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-variable"><span class="hljs-variable">$Input</span></span>) {(<span class="hljs-string"><span class="hljs-string">'{0:x}'</span></span> <span class="hljs-operator"><span class="hljs-operator">-f</span></span> (<span class="hljs-variable"><span class="hljs-variable">$I</span></span>.properties.value[<span class="hljs-number"><span class="hljs-number">5</span></span>]))} <span class="hljs-variable"><span class="hljs-variable">$Data</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (<span class="hljs-variable"><span class="hljs-variable">$HID</span></span>) { <span class="hljs-number"><span class="hljs-number">4</span></span> {<span class="hljs-string"><span class="hljs-string">"A"</span></span>} <span class="hljs-number"><span class="hljs-number">5</span></span> {<span class="hljs-string"><span class="hljs-string">"B"</span></span>} <span class="hljs-number"><span class="hljs-number">6</span></span> {<span class="hljs-string"><span class="hljs-string">"C"</span></span>} <span class="hljs-number"><span class="hljs-number">7</span></span> {<span class="hljs-string"><span class="hljs-string">"D"</span></span>} <span class="hljs-number"><span class="hljs-number">8</span></span> {<span class="hljs-string"><span class="hljs-string">"E"</span></span>} <span class="hljs-number"><span class="hljs-number">9</span></span> {<span class="hljs-string"><span class="hljs-string">"F"</span></span>} A {<span class="hljs-string"><span class="hljs-string">"G"</span></span>} B {<span class="hljs-string"><span class="hljs-string">"H"</span></span>} C {<span class="hljs-string"><span class="hljs-string">"I"</span></span>} D {<span class="hljs-string"><span class="hljs-string">"J"</span></span>} E {<span class="hljs-string"><span class="hljs-string">"K"</span></span>} F {<span class="hljs-string"><span class="hljs-string">"L"</span></span>} <span class="hljs-number"><span class="hljs-number">10</span></span> {<span class="hljs-string"><span class="hljs-string">"M"</span></span>} <span class="hljs-number"><span class="hljs-number">11</span></span> {<span class="hljs-string"><span class="hljs-string">"N"</span></span>} <span class="hljs-number"><span class="hljs-number">12</span></span> {<span class="hljs-string"><span class="hljs-string">"O"</span></span>} <span class="hljs-number"><span class="hljs-number">13</span></span> {<span class="hljs-string"><span class="hljs-string">"P"</span></span>} <span class="hljs-number"><span class="hljs-number">14</span></span> {<span class="hljs-string"><span class="hljs-string">"Q"</span></span>} <span class="hljs-number"><span class="hljs-number">15</span></span> {<span class="hljs-string"><span class="hljs-string">"R"</span></span>} <span class="hljs-number"><span class="hljs-number">16</span></span> {<span class="hljs-string"><span class="hljs-string">"S"</span></span>} <span class="hljs-number"><span class="hljs-number">17</span></span> {<span class="hljs-string"><span class="hljs-string">"T"</span></span>} <span class="hljs-number"><span class="hljs-number">18</span></span> {<span class="hljs-string"><span class="hljs-string">"U"</span></span>} <span class="hljs-number"><span class="hljs-number">19</span></span> {<span class="hljs-string"><span class="hljs-string">"V"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>A {<span class="hljs-string"><span class="hljs-string">"W"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>B {<span class="hljs-string"><span class="hljs-string">"X"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>C {<span class="hljs-string"><span class="hljs-string">"Y"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>D {<span class="hljs-string"><span class="hljs-string">"Z"</span></span>} } <span class="hljs-variable"><span class="hljs-variable">$Data</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">out-file</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Destination</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">get-content</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Destination</span></span></span><span class="hljs-string">"</span></span> del <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$source</span></span></span><span class="hljs-string">"</span></span> del <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Destination</span></span></span><span class="hljs-string">"</span></span></code> </pre> </div></div><br><p>  Beim Start aktiviert das Skript die Ablaufverfolgung f√ºr 10 Sekunden und zeigt dann das Ergebnis an. </p><br><p><img src="https://habrastorage.org/webt/w1/kg/ag/w1kgag36huygrqilju8ngooidx8.jpeg"></p><br><p>  <em>Das Ergebnis des Skripts.</em> </p><br><p>  Nachdem Sie die HID-Daten verstanden haben, k√∂nnen Sie das Skript nat√ºrlich zu einem vollst√§ndigen Keylogger verfeinern, der Daten von Tastatur und Maus aufzeichnet.  Es ist erw√§hnenswert, welche Einschr√§nkungen dieser Mechanismus aufweist: </p><br><ul><li>  funktioniert nur mit USB und PS \ 2 (wie es manchmal in Laptops zu finden ist) wird nicht unterst√ºtzt; </li><li>  USB 3.0-Unterst√ºtzung wird nur in Windows 8 und h√∂her angek√ºndigt. </li><li>  Administratorrechte (UAC) erforderlich. </li></ul><br><p>  Aber keine Fahrer und Abfangj√§ger.  Nat√ºrlich kann ein solcher Keylogger zus√§tzlich zur b√∂swilligen Verwendung helfen, Probleme mit der Tastatur zu diagnostizieren.  Theoretisch. </p><br><h1 id="nuzhno-li-boyatsya">  Muss ich Angst haben? </h1><br><p>  Sogar die eingebauten Mechanismen in den H√§nden des B√∂sewichts k√∂nnen Probleme verursachen.  Die Schutzmethoden bleiben unver√§ndert: Blockieren Sie ausf√ºhrbare Dateien, die nicht aus Systemverzeichnissen stammen, arbeiten Sie nicht als Benutzer mit Administratorrechten, und deaktivieren Sie die Benutzerkontensteuerung zumindest nicht, wenn sie funktionieren.  Und nat√ºrlich werfen die integrierten Windows-Browser in Bezug auf die Sicherheit Fragen auf. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de418787/">https://habr.com/ru/post/de418787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de418777/index.html">‚ÄûHier gibt es keinen Chef‚Äú: √úber die Arbeit mit Open Source und Apache Ignite in Sberbank Technologies</a></li>
<li><a href="../de418779/index.html">Kassierer auf der Basis des Tablets: Warum Netzwerkh√§ndler es brauchen (wir sagen am Beispiel unseres Kassierers)</a></li>
<li><a href="../de418781/index.html">F√ºgen Sie Zimbra E-Mail-Verschl√ºsselung und elektronische Signatur hinzu</a></li>
<li><a href="../de418783/index.html">"Wer gestern ein Monopolriese war, kann morgen nichts werden." Interview mit Evgeny Chereshnev von Biolink.Tech</a></li>
<li><a href="../de418785/index.html">Amigo alles. Jetzt ist es offiziell</a></li>
<li><a href="../de418789/index.html">Uber h√∂rt auf, unbemannte Lastwagen zu entwickeln</a></li>
<li><a href="../de418791/index.html">Orakel, oder warum haben intelligente Vertr√§ge die Welt immer noch nicht ver√§ndert?</a></li>
<li><a href="../de418793/index.html">EXpert PDU - Experte f√ºr Energieverteilung</a></li>
<li><a href="../de418795/index.html">Bewertung ASUS ROG GM501 Zephyrus M.</a></li>
<li><a href="../de418797/index.html">Linksh√§nder Fehler von IT-Projekten beim Markteintritt in den USA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>