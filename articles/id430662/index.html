<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â¬‡ï¸ ğŸ‘©ğŸ¼â€ğŸ“ ğŸ½ï¸ Memantau server Windows pada MS SQL murni, dan bagaimana saya diam-diam mengimplementasikannya ğŸ³ ğŸ¤™ğŸ½ ğŸ‘¨ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Suatu ketika, di galaksi yang jauh, jauh, ada perusahaan yang telah lama tumbuh dari startup, tetapi masih tetap sangat kompak dan efisien. Perusahaan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Memantau server Windows pada MS SQL murni, dan bagaimana saya diam-diam mengimplementasikannya</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430662/">  Suatu ketika, di galaksi yang jauh, jauh, ada perusahaan yang telah lama tumbuh dari startup, tetapi masih tetap sangat kompak dan efisien.  Perusahaan ini meng-host (pada perangkat kerasnya) ratusan server Windows, dan ini harus dipantau.  Bahkan sebelum saya sampai di sana, NetIQ dipilih sebagai solusinya. <br><br>  Saya diperintahkan untuk mengatur NetIQ, dan orang yang melakukan ini sebelum saya tidak mengatakan sepatah kata pun tentang itu.  Dicetak  Saya segera menyadari mengapa.  Steve Jobs mungkin berputar di kubur, melihat antarmuka yang serupa: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wv/cq/kj/wvcqkjtunh0raiwt14rvhpbn-pw.png" alt="gambar"></div><br>  Dalam satu baris, logika "burung" positif (acara Angkat).  Di negatif lain (Jangan angkat acara).  Bagaimana "Hanya memunculkan peristiwa saat" bekerja dengan sekumpulan kotak centang yang berbeda, saya umumnya hanya memahami secara eksperimental (dan sudah lupa). <br><a name="habracut"></a><br>  Namun, fitur NetIQ yang jauh lebih buruk adalah kerapuhannya.  Agennya, yang diinstal pada setiap server, secara signifikan lebih rentan daripada Windows itu sendiri.  Memori tidak cukup?  Agen terbang keluar.  CPU 100%?  Agen tidak merespons.  0 byte tersisa di disk - apa yang akan Anda pikirkan?  Untuk mengirim pesan, agen pertama-tama harus membuatnya di disk, sebagai file ... Ya, Anda mengerti. <br><br>  Namun demikian, mereka entah bagaimana hidup dengannya sampai perusahaan dibeli oleh perusahaan bahkan lebih.  Ketika monster memakan firma kecil, firma itu larut seperti setetes air di laut.  Dalam kasus kami, kami sendiri, menurut standar TI, hanya sedikit lebih sedikit daripada mereka yang membeli kami, dan segera jelas bahwa proses merger akan sangat sulit.  Sangat rumit sehingga untuk beberapa waktu kami tidak tersentuh sama sekali dan secara internal semua proses tetap sama.  Keadaan ini mirip dengan saat Cincin Mahakuasa jatuh di lava, tetapi belum mulai mencair: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qf/--/cy/qf--cyd5ehkjz_5zjhmogmwekcw.jpeg"></div><br>  Sementara itu, saya memutakhirkan NetIQ dari versi 7 ke 8 dan kemudian ke 9, ketika masalah kami mulai.  NetIQ memantau hanya beberapa hal: ketersediaan server itu sendiri, memori, CPU, disk, dan yang paling penting - layanan.  Jika layanan yang kami tulis sendiri dalam Otomatis, maka mereka seharusnya bekerja.  Seharusnya tidak seperti ini: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/45/fz/1h/45fz1ho3t3mxx6ka8yjlhg-_yjs.jpeg"></div><br>  Peristiwa ini dalam banyak kasus dan berhenti memantau NetIQ.  Setelah satu minggu percobaan dan satu minggu bekerja dengan dukungan, kami menemukan bahwa "ini bukan bug, ini adalah fitur" dan bahwa peringatan hanya dihasilkan dengan kode keluar tertentu.  Dan layanan kami terkadang jatuh dengan kode apa pun. <br><br>  Banyak waktu berlalu dan sudah terlambat untuk mundur.  Seperti yang Anda pahami, setelah menemukan bahwa infrastruktur kritis kami tidak dipantau, kami segera ... eh ... tidak melakukan apa-apa.  Karena pada saat ini, "pembubaran" perusahaan kami di sebagian besar telah memasuki fase aktif, dan itu terlihat seperti ini: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cq/y3/zk/cqy3zk1iyhts4aijbhx0umtxab8.jpeg"></div><br>  Gemuruh guntur, teriakan, kilat mencapai kejauhan, dan sepertinya nasib dunia sedang diputuskan, dan saya mendaki dengan semacam masalah teknis kecil ... Tapi saya tidak bisa tidur dengan damai, mengetahui bahwa pemantauan kami setengah buta. <br><br>  Menyadari bahwa tidak ada tempat untuk menunggu bantuan, saya memutuskan untuk dengan cepat menulis pemindai layanan yang akan mem-bypass semua server dan mengirim email jika ada sesuatu yang tidak seperti yang dilakukan NetIQ.  Anda mungkin berpikir saya menggunakan Powershell?  Tidak.  Jika Anda memiliki palu di tangan Anda, maka semuanya adalah paku, dan jika Anda telah menggunakan DBA dan bekerja dengan SQL sejak versi 6.0, maka ... Kutipan singkat dari kode sehingga Anda dapat memahami tentang apa itu: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zt/bb/3h/ztbb3hzjroe6t_bzlsj1atrulbi.png"></div><br>  Saya melakukannya dalam beberapa jam.  Selama beberapa hari berikutnya, ada audit terhadap pesan, parameter, dan barang lainnya.  Setelah membaca tentang perintah WMIC, saya tidak bisa berhenti.  Kemudian beberapa minggu dalam kabut.  Saya terbangun ketika semua yang kami gunakan di NetIQ ditulis ulang dan bekerja dengan keras. <br><br>  Fungsionalitas tidak hanya disalin - saya menyadari semua fantasi saya, semua yang saya inginkan dari sistem seperti itu.  LOWDISK - Anda juga mendapatkan grafik tentang bagaimana ruang kosong pada disk berperilaku akhir-akhir ini - apakah pertumbuhan ini normal atau ada yang salah.  Tidak ada cukup memori - ini adalah jadwal, dan daftar proses dan berapa banyak yang mereka ambil, dan untuk w3wp.exe kita akan menyelesaikan nama kumpulan aplikasi, pengingat cerdas dan banyak lagi.  Omong-omong, sistem dapat mengambil daftar server sendiri dari VMware.  Satu pandangan cepat pada subjek peringatan di telepon sudah cukup untuk memahami apa yang terjadi: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ps/cq/fk/pscqfkh5qb23_oujl6zyjmeexzy.png"></div><br>  Programmer modern sangat terbiasa berpikir secara abstrak sehingga mereka tidak dapat menulis sistem pemantauan selain 'untuk server kami menjalankan serangkaian skrip pemantauan abstrak, dan kami tidak peduli apa yang ada di dalamnya', sambil memantau setiap negara bagian - disk, memori, CPU, layanan - dengan caranya sendiri unik.  Menyadari hal ini "secara abstrak", Anda melakukan hal yang sama buruknya untuk setiap kasus, dan inilah yang terjadi: (Ini adalah tangkapan layar dari email dari SCOM. Tentunya dilakukan secara ketat sesuai dengan TOR) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wm/3m/ut/wm3mutentcltlmpobwyjutqm0me.png"></div><br>  Kelebihan besar dari sistem baru adalah bahwa itu tanpa agen, masing-masing, tidak ada masalah dengan menginstal agen, crash-nya - tidak ada yang jatuh di sana.  Sistemnya sederhana dan dapat diandalkan seperti palu. <br><br>  Beberapa bulan berikutnya saya datang untuk bekerja di pagi hari, berdiri di depan gagasan saya, seperti seorang seniman di depan kanvas, dan menerapkan beberapa pukulan, membuatnya bahkan lebih ideal.  Karena saya tidak memiliki tenggat waktu, hutang teknis diminimalkan.  Pada titik tertentu, saya masih memaksakan diri untuk berhenti. <br><br>  NetIQ masih berfungsi, tetapi semua orang lebih menyukai peringatan jenis baru, dan secara bertahap saya memindahkan semua orang ke peringatan dari sistem baru, tanpa mematikan yang lama.  Sementara itu, proses "fusi" telah memasuki tahap akhir: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8j/sy/da/8jsydazfbheft25w9ugymimk_hi.jpeg"></div><br>  Nah, dongeng itu seharusnya berakhir.  Saya sendiri terkejut bahwa saya bisa bersenang-senang di perusahaan birokrasi besar.  Setelah satu bulan persiapan, mereka memberi tahu saya bahwa dalam seminggu, kami memadamkan NetIQ, dan kami beralih ke SCOM.  Saya mematikan NetIQ (saya akui, saya sangat membencinya sehingga saya sangat senang) dan mulai menunggu SCOM.  Tetapi pada waktu yang ditentukan dia tidak ada di sana.  Tidak setelah satu minggu, dan setelah satu bulan. <br><br>  SCOM muncul hanya enam bulan kemudian - seseorang lupa berapa banyak server yang kami miliki dan berapa banyak lisensi yang kami butuhkan untuk SCOM.  Dalam enam bulan, begitu banyak sistem mulai bergantung pada sistem saya, yang mulai menyimpan inventaris, metrik, dan banyak lagi, yang diam-diam tetap nomor dua - tidak resmi.  Untuk auditor, ada SCOM, dan semua yang benar-benar berguna ada di sistem kedua. <br><br>  Terkadang manajer dari berbagai tingkatan bertanya-tanya - dari mana datangnya email otomatis ini?  Saya baru-baru ini menjelaskan secara rinci kepada mereka kisah yang saya sampaikan di artikel ini, dan mereka tertawa riang.  Meskipun kadang-kadang masih sangat lucu bagi saya, bagaimana di sebuah perusahaan birokrasi besar Anda dapat "menyeret ke dalam glander yang sunyi" banyak hal.  Ya, dan senang menulis kode, seperti di masa lalu yang indah. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id430662/">https://habr.com/ru/post/id430662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id430650/index.html">Seks adalah penjual game arcade klasik. Dan siapa pembelinya?</a></li>
<li><a href="../id430654/index.html">pertemuan devleads: kami membentuk tim yang efektif, mengoptimalkan pengembangan, mendiskusikan masalah saat ini</a></li>
<li><a href="../id430656/index.html">Program SAFeÂ® Bersertifikat</a></li>
<li><a href="../id430658/index.html">Bagaimana Memulainya - Kelahiran Game Video</a></li>
<li><a href="../id430660/index.html">Beralih ke Androidx atau petualangan menyapu yang menyenangkan</a></li>
<li><a href="../id430664/index.html">Peran pemimpin tim dalam merekrut</a></li>
<li><a href="../id430666/index.html">Cara mengevaluasi kinerja tim</a></li>
<li><a href="../id430668/index.html">Sendiri di lapangan bukan seorang pejuang. Jalan menuju kerja tim yang efektif</a></li>
<li><a href="../id430670/index.html">Manajemen pengaturan</a></li>
<li><a href="../id430672/index.html">Versi teks dari laporan "Aktor vs CSP vs Tugas ..." dengan C ++ CoreHard Musim Gugur 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>