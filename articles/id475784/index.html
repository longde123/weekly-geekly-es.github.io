<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîü üçó üôåüèΩ Mengukur kualitas kode aplikasi Android dengan Sonarqube dan Jacoco pada tahun 2019 ‚ôìÔ∏è ‚ôéÔ∏è ü§öüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo, Habr! 


 Nama saya Artyom Dobrovinsky, saya bekerja sebagai pengembang Android di FINCH . 


 Suatu hari, setelah beberapa gelas bir dengan seo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mengukur kualitas kode aplikasi Android dengan Sonarqube dan Jacoco pada tahun 2019</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475784/"><p><img src="https://habrastorage.org/webt/hy/hs/hf/hyhshf-j1xpd1xyijiaxido1e-q.png"></p><br><p>  Halo, Habr! </p><br><p>  Nama saya Artyom Dobrovinsky, saya bekerja sebagai pengembang Android di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">FINCH</a> . </p><br><p>  Suatu hari, setelah beberapa gelas bir dengan seorang kolega dari sebuah perusahaan yang memasang iklan untuk menjual MIG dan nyamuk bernama Igor, kami mulai membahas penganalisa kode statis di CI (dan apa lagi yang harus didiskusikan).  Gagasan itu disuarakan bahwa mereka keren untuk digunakan - tetapi hanya setelah ada kepercayaan pada keandalan logis dari kode.  Dengan kata lain, Anda dapat memikirkan gaya kode hanya setelah semua tes ditulis. </p><br><p>  Saya memutuskan untuk mendengarkan rekan saya dan berpikir tentang bagaimana menghitung skala bencana untuk aplikasi improvisasi.  Pandangan jatuh pada Sonarqube dan Jacoco.  Proses menghubungkan mereka untuk proyek hello-world adalah dasar.  Menghubungkan mereka ke proyek Android, dipecah menjadi modul, sudah lebih sulit.  Untuk membantu mereka yang tertarik, artikel ini ditulis. </p><a name="habracut"></a><br><p> Habr√© sudah memiliki terjemahan yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sangat baik dari</a> tutorial tentang cara menggunakan Sonarqube - tetapi dari 2016, ada sesuatu yang sudah ketinggalan zaman di sana, tidak ada kotlin dan hanya saya menemukan pelaporan generasi untuk semua redundansi buildType. </p><br><p>  Sedikit tentang perpustakaan, bagi mereka yang tidak terbiasa dengannya. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sonarqube</a> adalah platform sumber terbuka untuk inspeksi dan pengukuran kualitas kode berkelanjutan.  Ini memungkinkan Anda untuk melacak pertarungan melawan utang teknis dari waktu ke waktu (itu keren untuk melihat bahwa utang teknis menang, dan Anda tidak dapat melakukan apa-apa).  Sonar juga memonitor kode duplikat, potensi kerentanan, dan kompleksitas fungsi yang berlebihan. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jacoco</a> adalah perpustakaan gratis untuk menghitung cakupan pengujian suatu proyek di Jawa.  Tapi dengan Kotlin kita akan berteman dengannya. </p><br><h3 id="kak-podklyuchit-sonarqube-i-jacoco">  Bagaimana menghubungkan Sonarqube dan Jacoco </h3><br><p>  Di build.gradle dari modul root, tambahkan kode berikut: </p><br><pre><code class="plaintext hljs">apply plugin: 'android.application' apply plugin: 'org.sonarqube' sonarqube { properties { property "sonar.host.url", "%url   sonarqube%" property "sonar.login", "%%" property "sonar.projectName", "% %" property "sonar.projectKey", "%  %" property "sonar.reportPath", "${project.buildDir}/sonarqube/test.exec" property "sonar.projectBaseDir", "$rootDir" property "sonar.sources", "." property "sonar.tests", "" property "sonar.coverage.exclusions", "**/src/androidTest/**, **/src/test/**" property "sonar.coverage.jacoco.xmlReportPaths", fileTree(include: ['*/*/jacoco*.xml'], dir: "$rootDir/app/build/reports/jacoco").collect() } }</code> </pre> <br><p>  <code>sonar.reportPath</code> - menunjukkan di mana Sonar harus meletakkan laporan untuk analisis lebih lanjut. <br>  <code>sonar.projectBaseDir</code> menentukan folder tempat analisis akan dimulai pada awalnya;  dalam kasus kami, ini adalah $ rootDir - folder root proyek. <br>  <code>sonar.coverage.exclusions</code> mencantumkan pengecualian untuk menghitung cakupan, di mana ** adalah folder apa pun, a * adalah nama file atau resolusi apa pun. <br>  <code>sonar.sources</code> adalah folder sumber. <br>  <code>sonar.tests</code> adalah baris kosong di sini sehingga tes juga dapat dianalisis oleh Sonarqube. <br>  <code>sonar.coverage.exclusions</code> - kami mengecualikan tes dari analisis cakupan tes. <br>  <code>sonar.coverage.jacoco.xmlReportPaths</code> - menggunakan <code>collect()</code> mengumpulkan laporan Jacoco untuk menghitung cakupan pengujian. </p><br><p>  Untuk mengaktifkan Jacoco, lebih baik membuat file <code>jacoco.gradle</code> dan menulis semua logika yang diperlukan di sana.  Ini akan membantu untuk menghindari kekacauan build.gradle lainnya. </p><br><p>  Agar tidak mendaftarkan Jacoco di build.gradle masing-masing subproyek, kami meresepkan inisialisasi dalam penutupan subproyek.  Dalam <code>reportsDirPath</code> untuk submodules, tentukan folder root.  Dari sana, Sonar akan mengambil semua laporan Jacoco. </p><br><pre> <code class="plaintext hljs">subprojects { apply plugin: 'jacoco' jacoco { toolVersion = '0.8.5' def reportsDirPath = "${project.rootDir}/app/build/reports/jacoco/${project.name}" reportsDir = file(reportsDirPath) } }</code> </pre> <br><p>  Dalam file yang sama, kami menulis fungsi untuk mengkonfigurasi Jacoco. <br>  Fungsi ini hebat, jadi pertama saya akan membawanya - dan kemudian saya akan menjelaskan apa yang terjadi di dalamnya. </p><br><pre> <code class="plaintext hljs">def configureJacoco = { project -&gt; def variantName = project.name project.tasks.create(name: "getJacocoReports", type: JacocoReport) { group = "Reporting" description = "Generate Jacoco coverage reports for the $variantName build." reports { html.enabled = true xml.enabled = true } def excludes = [ '**/R.class', '**/R$*.class', '**/BuildConfig.*', '**/Manifest*.*', '**/AndroidManifest.xml', '**/*Test*.*', 'android/**/*.*', 'androidx/**/*.*', '**/*Fragment.*', '**/*Activity.*', '**/*Api.*', '**/injection/**/*.class', '**/ui/**/*.class', %  build- % ] def javaClasses = fileTree(dir: "${project.buildDir}/intermediates/javac", excludes: excludes) def kotlinClasses = fileTree(dir: "${project.buildDir}/tmp/kotlin-classes", excludes: excludes) classDirectories = files([javaClasses, kotlinClasses]) sourceDirectories = files([ "${project.projectDir}/src/main/java", "${project.projectDir}/src/main/kotlin", ]) executionData = files(fileTree(include: ['*.exec'], dir: "${project.buildDir}/jacoco").files) } }</code> </pre> <br><p>  Kami menciptakan tugas <code>getJacocoReports</code> , grup "Pelaporan".  Laporan akan diberikan dalam format html dan xml.  Semua file kecuali yang termasuk dalam array yang dikecualikan akan dianalisis.  Selain file Androyd yang dihasilkan, saya memutuskan untuk mengecualikan dari analisis semua fragmen dan aktivitas, antarmuka Retrofit, paket dengan DI, tampilan khusus dan kode perpustakaan. <br>  Mungkin daftar ini akan berubah seiring waktu. </p><br><p>  <code>classDirectories</code> - indikasi tempat mencari kode untuk analisis.  Kami menyertakan file java dan kotlin di sini. <br>  <code>sourceDirectories</code> - tentukan di mana Jacoco mencari file sumber. <br>  <code>executionData</code> - seperti dalam kasus Sonar, indikasi di mana laporan akan dihasilkan untuk menghitung cakupan. </p><br><p>  Juga di jacoco.gradle Anda perlu menambahkan konfigurasinya untuk semua modul menggunakan fungsi di atas: </p><br><pre> <code class="plaintext hljs">allprojects { project -&gt; configureJacoco(project) project.tasks.withType(Test) { enabled = true jacoco.includeNoLocationClasses = true } }</code> </pre> <br><p>  Dan tugas untuk mengumpulkan laporan yang dihasilkan: </p><br><pre> <code class="plaintext hljs">task getJacocoReports() { group = "Reporting" subprojects.forEach { subproject -&gt; subproject.tasks.withType(JacocoReport).forEach { task -&gt; dependsOn task } } }</code> </pre> <br><h3 id="zapusk-sonarqube-cherez-komandnuyu-stroku">  Menjalankan Sonarqube melalui baris perintah </h3><br><p>  Ini <code>./gradlew %    % &amp;&amp; ./gradlew jacocoAggregateReports &amp;&amp; ./gradlew sonarqube</code> sederhana: <code>./gradlew %    % &amp;&amp; ./gradlew jacocoAggregateReports &amp;&amp; ./gradlew sonarqube</code> .  Perintah dijalankan melalui <code>&amp;&amp;</code> , karena eksekusi harus terganggu jika langkah sebelumnya tidak berhasil. </p><br><p>  Apa yang terjadi pada perintah di atas: </p><br><ol><li>  Pertama, jalankan tes (pada saat yang sama kami menghasilkan semua file yang diperlukan dalam folder build). </li><li>  Buat laporan Jacoco. </li><li>  Luncurkan Sonarqube. </li></ol><br><p>  Selanjutnya Anda harus pergi ke situs, gagal dalam proyek dan melihat skala bencana.  Halaman proyek menunjukkan hasil pemeriksaan terakhir. </p><br><p>  Dengan Sonarqube, gagasan tentang keadaan proyek menjadi jauh lebih lengkap.  Lebih mudah untuk menyesuaikan tumpukan utang teknis, daripada mengambil pengembang pemula (di setiap berdalih Sonarqube memberikan argumen mengapa tidak diterima untuk menulis seperti itu - membaca penjelasan ini bisa sangat berguna), dan hanya - <strong>pengetahuan adalah kekuatan</strong> . </p><br><h3 id="thats-all-folks">  Itu saja, semuanya! </h3><br><p>  Pertanyaan kepada pembaca - apa yang Anda gunakan untuk menganalisis kode dan mengukur cakupan tes?  Apakah Anda melihat intinya sama sekali? </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id475784/">https://habr.com/ru/post/id475784/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id475774/index.html">"Ini adalah aturan konyol yang mengganggu semua orang": diskusi tentang praktik bidang kata sandi</a></li>
<li><a href="../id475776/index.html">Do-it-yourself berdiri untuk tiga gitar</a></li>
<li><a href="../id475778/index.html">WebAssembly: apa dan bagaimana</a></li>
<li><a href="../id475780/index.html">Cyrillic Decoder dari dikutip-cetak</a></li>
<li><a href="../id475782/index.html">Tes tautologis, baik dan buruk</a></li>
<li><a href="../id475788/index.html">"Rupanya, ada pertempuran besar di depan." Apa yang menanti industri TI dalam waktu dekat</a></li>
<li><a href="../id475790/index.html">Startup yang bisa mengejutkan</a></li>
<li><a href="../id475796/index.html">Stack Overflow Mengubah Kebijakan Reputasi untuk Masalah</a></li>
<li><a href="../id475802/index.html">Bagaimana membuat Harian / Stand-up tidak terlihat seperti pertemuan status?</a></li>
<li><a href="../id475804/index.html">Impor laporan panggilan terjadwal dari CoMagic ke BigQuery pada jadwal menggunakan Google Cloud Functions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>