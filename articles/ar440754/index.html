<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โน๐ฝ ๐จ๐ผโ๐ค ๐ง๐ฝ ูุงุฆุฏุฉ ุนุจุฑ ููุตุฉ ุงูุฅูุฌููุฒูุฉ ูุนุฑุถ ุดูุงุฏุงุช ุงููุคูููู ุงูุฑูุณูุฉ X509 โฎ๏ธ ๐๐ฝ ๐๐พ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงูููู ุ ุฃุตุจุญ ุงุณุชุฎุฏุงู ุงูุดูุงุฏุงุช ุงูุฑูููุฉ X509 v.3 ุดุงุฆุนูุง. ูุณุชุฎุฏููู ุงููุฒูุฏ ูุงููุฒูุฏ ูู ุงูุฃุดุฎุงุต ูููุตูู ุฅูู ูููุน ููุจ ุฎุฏูุฉ ุงูุฏููุฉ ุ ุฏุงุฆุฑุฉ ุงูุถุฑุงุฆุจ ุงูููุฏุฑุงููุฉ ุ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุงุฆุฏุฉ ุนุจุฑ ููุตุฉ ุงูุฅูุฌููุฒูุฉ ูุนุฑุถ ุดูุงุฏุงุช ุงููุคูููู ุงูุฑูุณูุฉ X509</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440754/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/tj/bp/mp/tjbpmpejv6ig2dqs8r22x1zcmzw.png" alt="ุงูุตูุฑุฉ" align="left">  ุงูููู ุ ุฃุตุจุญ ุงุณุชุฎุฏุงู ุงูุดูุงุฏุงุช ุงูุฑูููุฉ X509 v.3 ุดุงุฆุนูุง.  ูุณุชุฎุฏููู ุงููุฒูุฏ ูุงููุฒูุฏ ูู ุงูุฃุดุฎุงุต ูููุตูู ุฅูู ูููุน ููุจ ุฎุฏูุฉ ุงูุฏููุฉ ุ ุฏุงุฆุฑุฉ ุงูุถุฑุงุฆุจ ุงูููุฏุฑุงููุฉ ุ ุงููุฒุงูุฏุฉ ุงูุฅููุชุฑูููุฉ ุ ุฅูุฎ.  ูุงููุฒูุฏ ูุงููุฒูุฏ ูู ุงููุงุณ ูุฑูุฏูู ุฃู ูุนุฑููุง ูุง ูู ููุฌูุฏ ูู ูุฐู ุงูุดูุงุฏุฉ ุงูุชู ุชุณูู "ุงูุตุฏุฑ".  ูุฅุฐุง ูุงูุช ุงูุดูุงุฏุฉ ุชูุงุซููุฉ ูุฌูุงุฒ ุงูุณูุฑ ุ ูููู ูููู ูุฑุงุกุชูุง / ุนุฑุถูุง.  ูุนู ุ ูู ุฃูุธูุฉ ุงูุชุดุบูู ููุงู ุงูุนุฏูุฏ ูู ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ ููุนุฑุถ.  ููููู ุณูู ููุฏููู ุงููููู ููููุงุทู ุงูุนุงุฏู.  ุฎุฐ ุนูู ุณุจูู ุงููุซุงู ุ ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ gcr-viewer ุ ูุงูุชู ุ ูู ุงููุงูุน ุ ูู ุงูุฃุฏุงุฉ ุงูููุงุณูุฉ ููุนุฑุถ ูู ุฃูุธูุฉ Linux ุ ูุจุงูุชุงูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃูุธูุฉ ุงูุชุดุบูู ุงููุญููุฉ</a> : <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/lf/7g/nf/lf7gnfqkvwpo2cuhy_mcvulf_a8.png"><br><br><h3 style=";text-align:right;direction:rtl">  ุงููุดุงูุฏ ุงูููุงุณูุฉ </h3><br>  ุงูุฃุฏุงุฉ ุฌูุฏุฉ ุงูุตูุน ููุฑูุญุฉ.  ุจุดูู ุนุงู ุ ูููุตุฏ ุจู ุฃู ูููู ุฃุฏุงุฉ ูุณุงุนุฏุฉ ุนุงูุฉ ูุนุฑุถ ุงููููุงุช ุงูุชู ุชุญุชูู ุนูู ุจูุงูุงุช ุจุชูุณููุงุช ุชุดููุฑ ูุฎุชููุฉ (ุดูุงุฏุงุช ุ ุทูุจุงุช ุ ุชูููุนุงุช ุฅููุชุฑูููุฉ / PKCS # 7 ุ ุญุงููุงุช ูุญููุฉ PKCS # 12 ุ ุฅูุฎ).  ูููู ุ ูุณูุก ุงูุญุธ ุ ุชู ุชุตูููู ููุชุดููุฑ ุงูุบุฑุจู ููุง ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุงููุณุงุนุฏุงุช ุงูุชู ูุชู ุฅุฏุฎุงููุง ูู ุจูุฏู.  ูุฅุฐุง ูุธุฑุช ุฅูู ููุทุฉ ุงูุดุงุดุฉ ุ ูุนูุฏูุง ูุชู ุนุฑุถ ุงููุนูููุงุช ุญูู ุตุงุญุจ ุงูุดูุงุฏุฉ ุ ุชุธูุฑ ุฃุญุฑู ุบูุฑ ูููููุฉ.  ุนูู ุงููุณุงุฑ ูู oid s ุ ูุนูู ุงููููู ูู ุงููููุฐุฌ ุงูุณุงุฏุณ ุนุดุฑ ุ ุงููููู asn1 ุจูููู.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุฐู ูู OGRN (1.2.643.100.1) ู SNILS (1.2.643.100.3) ู TIN (1.2.643.3.131.1.1).  ููุฐู ูู ุงูุทุฑููุฉ ุงูุชู ูุฌุจ ุนูู ุงูููุงุทู ุงูุนุงุฏู ุงูุชุฃูุฏ ูู ุฃู ูุฐู ูู ุจูุงูุงุชู.  ูุง ุชุนุชูุฏ ุฃู ูุฐุง ููุฌูุฏ ููุท ุนูู ูุธุงู Linux ุ ุจู ูู ููุฒุฉ ุดุงุฆุนุฉ ูุฃู ุนุงุฑุถ ุดูุงุฏุงุช.  ูุฅุฐุง ูุธุฑุช ุฅูู ุฃุจุนุฏ ูู ุฐูู ุ ูุตุจุญ ูู ุดูุก ุบูุฑ ููููู: <br><br><img src="https://habrastorage.org/webt/55/6s/ib/556sib6y76f81ohud2laq0knsho.png"><br><br>  ุชุธูุฑ ุจุนุถ ุงูููุญูุงุช ูุงููุนุฑูุงุช ูุงูููู.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุฎูู oid om 1.2.643.100.111 ุงุณู ุดูุงุฏุฉ ุญูุงูุฉ ูุนูููุงุช ุงูุชุดููุฑ ุ ูุงูุชู ุงุณุชุฎุฏููุง ุงููุณุชุฎุฏู ูุฅูุดุงุก ุฒูุฌ ุงูููุงุชูุญ ุ ูุงูููุชุงุญ ุงูุฎุงุต ุงูุฐู ุงุณุชุฎุฏู ููู ูุชูููุน ุทูุจ ุงูุดูุงุฏุฉ ุ ูุงูููุชุงุญ ุงูุนุงู ุงูุฐู ุชูุฌุฏ ููู ุงูุดูุงุฏุฉ: <br><br><img src="https://habrastorage.org/webt/yv/yx/uu/yvyxuu6hjoasxtytu7foy-s1o20.png"><br><br>  ูููุง ุ ูููู ุงููููู ูู ูุจู ุตุงุญุจ ุงูุดูุงุฏุฉ.  ุฅูู ูุง ูููู ุญุชู ุงูุฎูุงุฑุฒููุฉ ุงููุณุชุฎุฏูุฉ ูุฅูุดุงุก ุงูููุชุงุญ ุ ุฅูุง GOST R 34.10-2001 ุ ุฃู GOST R 34.10-2012 ูุจุฃู ุทูู ููุชุงุญ. <br><br>  ููููู ุงูุงุณุชูุฑุงุฑ ูู ุฅุนุทุงุก ุฃูุซูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงูุช ุตูุงุญูุฉ ุงูุดูุงุฏุฉ ูุงุถุญุฉ ุ ูุฃูู ุงูููุชุงุญุ <br><br>  ููุงู ุณุคุงูุงู ุขุฎุฑุงู ูุฑุบุจ ุฃุตุญุงุจ ุงูุดูุงุฏุงุช ูู ุงูุญุตูู ุนูู ุฅุฌุงุจุฉ ูููุง: ุฃูู ูููููู ุงูุญุตูู ุนูู ุณูุณูุฉ ุดูุงุฏุงุช ุงูุฌุฐุฑ (ุฃู ุญุชู ุงูุญุตูู ุนูู ุฃูุถู ูููุง ููุท) ูุณุคุงู ููุงุซู ูู ูุงุฆูุฉ ุงูุดูุงุฏุงุช ุงูููุบุงุฉ. <br><br>  ูุฃุฎูุฑูุง ุ ุฃุฑุบุจ ูู ุงูุญุตูู ุนูู ุฃุฏุงุฉ ูุณุงุนุฏุฉ ุนุงูููุฉ ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ููุฒุงุช PKI / PKI ุงูุฑูุณูุฉ ุ ูุงูุชู ุชุนุฏ ุจุงููุนู ููุตุฉ ูุดุชุฑูุฉ ูุชุนูู ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃูุธูุฉ</a> ุชุดุบูู ูุญููุฉ ูุบูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญููุฉ</a> .  ูุง ูุชุทููุฑุ  ุจุงูุทุจุน ูู ูุบุฉ ุงูุจุฑูุฌุฉ ุงููุตูุฉ ุ ุฅุฐุง ูุงู ุฐูู ููุท ุจุณุจุจ ุทุจูุนุชูุง ุนุจุฑ ููุตุฉ. <br><br>  ุซู ุชุฐูุฑุช ุฃู ูุบุฉ ุงููุต ุงูุจุฑูุฌู ุงูุฌูููุฉ Tcl (ูุบุฉ ุฃูุงูุฑ ุงูุฃุฏุงุฉ) ูุฏ ุงุญุชููุช ูุคุฎุฑูุง ุจูุฑูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">30 ุนุงููุง ุนูู ุชุฃุณูุณูุง</a> .  ุฅูู ููู ุฏูุงุนู ุณุฑูุฑู ุฃู ุงูุจุฑูุงูุฌ ุนูู ุฐูู.  ูุญุชูู ุนูู ุนุฏุฏ ูุจูุฑ ูู ุงูููุญูุงุช (ุงูุญุฒูุฉ) ุงูุชู ุชุณูุญ ุจูู ุดูุก ุชูุฑูุจูุง.  ูุฐูู ุ ููุนูู ูุน ASN- ุงูููุงูู ููุงู ุญุฒูุฉ asn.  ุนูุงูุฉ ุนูู ุฐูู ุ ููุนูู ูุน ุงูุดูุงุฏุงุช (ูุญู ููุชููู ุจุชูุฒูุนูุง ูู ูุฐู ุงูุญุงูุฉ) ููุงู ุญุฒูุฉ pki.  ููุชุทููุฑ ูุงุฌูุฉ ุฑุณูููุฉ ุ ููุงู ุญุฒูุฉ Tk. <br><br>  ูููู ููู ููุณ ุงูุดูุก ุนู ุจูุชูู ูุน ุชูููุชุฑ ุ ูุนู ุจูุฑู ูุนู ุฑูุจู.  ูููู ููุฌููุน ุงุฎุชูุงุฑ ูููุง ูุฐูููู.  ูุชููู ุนูุฏ ุญููุฉ ูู Tcl / Tk. <br><br>  ุณูุณุชุนูุฑ ุชุตููู ุงูุฑุณูู ููุฃุฏุงุฉ ูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ gcr-viewer.  ูุดุฑุท ูุงุญุฏ ุขุฎุฑ. <br><br>  ูุธุฑูุง ูุฃู ูุฏู Habr ุฅุตุฏุงุฑูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ</a> ุ ููุฏ ุฃุฑุฏุช ุงูุฃุฏุงุฉ ุฃู ูููู ููุง ูุงุฌูุงุช ูุฎุชููุฉ (ุงูุฑูุณูุฉ / ุงูุฅูุฌููุฒูุฉ).  ูููู ูุฐุง ููุณ ุงูุณุจุจ ุงูุฑุฆูุณู.  ูุงูุฃูู ูู ุฐูู ุ ุฃู ุงููุฒูุฏ ูุงููุฒูุฏ ูู ููุงุทูู ุงูุนุงูู ุงูุบุฑุจู ุฃุตุจุญูุง ููุงุทููู ูู ุงูุงุชุญุงุฏ ุงูุฑูุณู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุงูููุซู ุงูุนุงููู ุงูุดููุฑ ุฏูุจุงุฑุฏูู.  ูุฏ ูุนุชุฑุถูู: ุฅูู ูุฑูุณู.  ููููู ุฃูุถูุง ูุชุฑุฌู ุนุณูุฑู ูู ุงููุฑูุณูุฉ: <br><br><img src="https://habrastorage.org/webt/ma/xr/4d/maxr4dvthbpwapmxmodkjceujh4.png"><br><br>  ูุฐูู ูู ุงูุณูู ุฅุถุงูุฉ ูุงุฌูุฉ ูุฑูุณูุฉ.  ููููู ุฃุนุชูุฏ ุฃู Depardieu ูุง ููุฌุฏ ูุฏูู ูุดุงูู ูุน ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ.  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูุฅู ุจูุฏูุง ูุชุนุฏุฏ ุงูุฌูุณูุงุช ูุณูููู ูู ุงูุฑุงุฆุน ุฃู ูููู ูุฏู ุงูุจุฑูุงูุฌ ุงููุญูู ููุธุงู ุงูุชุดุบูู ุงููุญูู ุนุฏุฉ ูุงุฌูุงุช ูุทููุฉ ุนูู ุงูุฃูู. <br>  ูุน ุงูุชูุฏู ููููุงู ุ ูุฐุง ูุง ุฌุงุก ููู: <br><br><img src="https://habrastorage.org/webt/-e/d8/df/-ed8dfn1in3wl7iwa2wmf-w0w-w.png"><br><br><h3 style=";text-align:right;direction:rtl">  ูุญู ูุฏุนู ูุชุฑุฌู </h3><br>  ูุฐูู ุ ููุจุฏุฃ ุจู "ุงููุชุฑุฌู".  ูู ููุทุฉ ุงูุดุงุดุฉ ุ ูุฎุชุจุฆ ุชุญุช ุงูุนูู ุงููุทูู.  ุงูุดุฑุท ุงูุฑุฆูุณู ูููุชุฑุฌู ูู ุชุฒุงูู ุงูุชุฑุฌูุฉ ุ ุฃู  ุงููุฏุฑุฉ ุนูู ุงูุชุญูู ุฅูู ูุบุฉ ุฃุฎุฑู ูู ุฃู ููุช.  ูุชู ุชูููุฐ ูุธุงุฆู ุงููุชุฑุฌู ูู Tcl / Tk ุจูุงุณุทุฉ ุญุฒูุฉ msgcat: <br><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">package require msgcat</code> </pre> <br>  ูุชุนููู ุงููุบุฉ ุงูุญุงููุฉ ุ ุงุณุชุฎุฏู ุงูุฃูุฑ ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">msgcat::mclocale ru</code> </pre> <br>  ูุชู ุชุฎุฒูู ููุฑุฏุงุช "ุงููุชุฑุฌู" ูู ููู ru.msg ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#  msgcat::mcset      #     mcset namespace import -force msgcat::mcset #     mcset ru "Language" "" โฆ</code> </pre> <br>  ูุง ููู ูู ูุต ุงูุงุฎุชุจุงุฑ <div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุตู ูุน ุงููุชุฑุฌู:</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#!/usr/bin/wish -f #  msgcat package require msgcat #   ru msgcat::mclocale ru #  ::msgcat::mc      #     mc namespace import msgcat::mc #    [msgcat::mclocale].msg. #       . msgcat::mcload [file join [file dirname [info script]]] #  image create photo rf_32x21_f -file rf_32x21.png image create photo gb_32x21_f -file gb_32x21.png #,      label .lab -text "[mc Language]: " -relief flat -bd 0 โbg snow -anchor sw -width 10 button .but_lang -image rf_32x21_f -command ::changelang -relief flat -bd 0 pack .lab -side left -pady {2 0} pack .but_lang -side left #      proc ::changelang {} { #     #    if {[msgcat::mclocale] == "ru"} { msgcat::mclocale en .but_lang configure -image gb_32x21_f } else { msgcat::mclocale ru .but_lang configure -image rf_32x21_f } #  .lab configure -text "[mc Language]: " }</code> </pre> <br></div></div><br>  ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู ุ ูุนูู ุงูุฅุฌุฑุงุก :: changelang ููุชุฑุฌู ุ ูุงูุฐู ูุชู ุงุณุชุฏุนุงุคู ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ .but_lang ูุน ุงูุนูู. <br><br>  ุฅุฐุง ููุช ุจุชุดุบูู ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู ุ ูุณุชุฑู ุจูุถูุญ ููู ูุนูู ุงููุชุฑุฌู: <br><br><img src="https://habrastorage.org/webt/hs/4y/e6/hs4ye6p49e5soy4ud6aje91-e2i.png"><br><br><h3 style=";text-align:right;direction:rtl">  ุงูุญุตูู ุนูู ุงูููุชุงุญ ุงูุนูููู </h3><br>  ุงูุขู ูุจุนุฏ ุฃู ูุฑุฑูุง ูุฌูุฏ ูุชุฑุฌู ุ ุฏุนูุง ููุงุตู ุชุญููู ุงูุดูุงุฏุฉ.  ููููุงู ุจุฐูู ุ ูุญุชุงุฌ ุฅูู ุญุฒูุฉ pki: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">package require pki).</code> </pre> <br>  ุชู ุชุตููู ุญุฒูุฉ pki ููุนูู ูุน ููุงุชูุญ ูุดูุงุฏุงุช ุฎูุงุฑุฒููุฉ RSA.  ุฅุฐุง ุชู ุฅูุดุงุก ุงูุดูุงุฏุฉ (proc :: pki :: x509 :: parse_cert) ุจููุน ูุฎุชูู ูู ุงูููุชุงุญ ุ ููู ูุชููู ูุนูููุงุช ุญูู ูุฐุง ุงูููุชุงุญ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># Handle RSA public keys by extracting N and E switch -- $ret(pubkey_algo) { "rsaEncryption" { set pubkey [binary format B* $pubkey] binary scan $pubkey H* ret(pubkey) ::asn::asnGetSequence pubkey pubkey_parts ::asn::asnGetBigInteger pubkey_parts ret(n) ::asn::asnGetBigInteger pubkey_parts ret(e) set ret(n) [::math::bignum::tostr $ret(n)] set ret(e) [::math::bignum::tostr $ret(e)] set ret(l) [expr {int([::pki::_bits $ret(n)] / 8.0000 + 0.5) * 8}] set ret(type) rsa } }</code> </pre> <br>  ูุงููุซูุฑ ููุฏูุดุฉ ุฃู ุฎูุงุฑุฒููุฉ ุงูููุชุงุญ ุงูุนุงู ูุง ุฒุงูุช ุชูุฑุฌุน (ret (pubkey_algo)) <br>  ุงููููู ูู ููุณู ุนูุฏ ุชุญููู ุทูุจ ุงูุดูุงุฏุฉ (proc :: pki :: pkcs :: parse_csr): <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># Parse public key, based on type switch -- $pubkey_type { "rsaEncryption" { set pubkey [binary format B* $pubkey] ::asn::asnGetSequence pubkey pubkey_parts ::asn::asnGetBigInteger pubkey_parts key(n) ::asn::asnGetBigInteger pubkey_parts key(e) set key(n) [::math::bignum::tostr $key(n)] set key(e) [::math::bignum::tostr $key(e)] set key(l) [expr {2**int(ceil(log([::pki::_bits $key(n)])/log(2)))}] set key(type) rsa } default { return -code error "Unsupported key type: $pubkey_type" } }</code> </pre> <br>  ูููู ููุง ูุนูุฏ ุญุชู ูุนูููุงุช ุนู ุงูุฎุทุฃ.  ูููู ุงูููู ุ ุจุงูุฅุถุงูุฉ ุฅูู RSA ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุชู ุงุณุชุฎุฏุงู ููุงุชูุญ ุงูููุญููุงุช ุงูุฅููููุฌูุฉ ููุงุชุญุงุฏ ุงูุฃูุฑูุจู ุ ุจูุง ูู ุฐูู GOST R 34.10-2012 (GOST R 34.10-2001 ุฃูุถูุง ูู ุงูููุช ุงูุญุงูู) ุ. <br><br>  ูููู ูููู ุจุดูู ุงูุชุฑุงุถู ุฅุฑุฌุงุน ุจููุฉ ASN ููููุชุงุญ ุงูุนูููู ุงูููุฌูุฏุฉ ูู ุงูุดูุงุฏุฉ ุฃู ุงูุทูุจ ุ ูุณูุนูู ุงููุณุชุฎุฏู ููุณู ุนูู ุชุญููู ุงูููุชุงุญ ุงูุนูููู ููููุง ูููุน ุงูููุชุงุญ.  ููููุงู ุจุฐูู ุ ูุง ุนููู ุณูู ุฅุถุงูุฉ ุจููุฉ ASN ููููุชุงุญ ุงูุนุงู ูู ุงูููู ุงูุณุฏุงุณูุฉ ุนุดุฑูุฉ ุฅูู ุงูููู ุงูุชู ูุชู ุฅุฑุฌุงุนูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">proc ::pki::x509::parse_cert {cert} { . . . ::asn::asnGetSequence cert subject ::asn::asnGetSequence cert pubkeyinfo #    ASN-  . binary scan $pubkeyinfo H* ret(pubkey_pubkeyinfo) . . . }</code> </pre> <br>  ูู ุดูุก ุ ูุง ุดูุก ุขุฎุฑ ููููุงู ุจู.  ูุจูุฐู ุงูุทุฑููุฉ ุ ูููู ุงูุฅุฌุฑุงุก :: pki :: x509 :: parse_cert ุจุฅุฑุฌุงุน ูุนุธู ููุญูุงุช ุงูุดูุงุฏุฉ ูุณุจุจ ุจุณูุท ูู ุฃูู ูุง ูุนุฑู ููููุฉ ุชุญููููุง (ุนูู ุณุจูู ุงููุซุงู ุ topicSignTool ุจุดูุงุฏุงุชูุง ุงููุคููุฉ) ุ ุฃู  ูุนุทู ุญุณุจ ุชูุฏูุฑ ุงููุณุชุฎุฏู. <br><br>  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ููุฑุฌุน ุงูุฅุฌุฑุงุก :: pki :: x509 :: parse_cert ุฅุญุฏู ูุชุงุฆุฌ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุดูุงุฏุฉ tbs</a> ุงูุชู ุชุญุชูู ุนูู ูุงูุฉ ุงููุนูููุงุช ูู ุงูุดูุงุฏุฉ ุ ุจุงุณุชุซูุงุก ุชูููุนูุง (ุชูููุน) ูููุน ุงูุชูููุน (signature_algo): <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#    set fd [open ยซcert.pemยป r] chan configure โtranslation binary set datacert [read $fd] close $fd #  array set cert_parse [::pki::x509::parse_cert $datacert] # tbs- set cert_tbs_hex $cert_parse(cert)</code> </pre> <br>  ููุชุจ ุงูุฅุฌุฑุงุก ุงูุฎุงุต ุจุงุณุชุฎุฑุงุฌ ูุนูููุงุช ุงูููุชุงุญ ุงูุนุงู ูู ุดูุงุฏุฉ tbs: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">proc ::pki::x509::parse_cert_pubkeyinfo {cert_tbs_hex} { array set ret [list] set wholething [binary format H* $cert_tbs_hex] ::asn::asnGetSequence wholething cert ::asn::asnPeekByte cert peek_tag if {$peek_tag != 0x02} { # Version number is optional, if missing assumed to be value of 0 ::asn::asnGetContext cert - asn_version ::asn::asnGetInteger asn_version ret(version) } ::asn::asnGetBigInteger cert ret(serial_number) ::asn::asnGetSequence cert data_signature_algo_seq ::asn::asnGetObjectIdentifier data_signature_algo_seq ret(data_signature_algo) ::asn::asnGetSequence cert issuer ::asn::asnGetSequence cert validity ::asn::asnGetUTCTime validity ret(notBefore) ::asn::asnGetUTCTime validity ret(notAfter) ::asn::asnGetSequence cert subject ::asn::asnGetSequence cert pubkeyinfo #    hex asn-   binary scan $pubkeyinfo H* ret(pubkeyinfo) return $ret(pubkeyinfo) }</code> </pre> <br>  ููุฃููุง ููุชููู ุจุงูุชุดููุฑ ุงูุฑูุณู ุ ูุณููุชุจ ุนูู ุงูููุฑ ุฅุฌุฑุงุก ุชุญููู ุงูููุชุงุญ ุงูุนูููู GOST: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">proc parse_key_gost {pubkeyinfo_hex} { array set ret [list] set pubkeyinfo [binary format H* $pubkeyinfo_hex] ::asn::asnGetSequence pubkeyinfo pubkey_algoid ::asn::asnGetObjectIdentifier pubkey_algoid ret(pubkey_algo) #,   - if {[string first "1 2 643 " $ret(pubkey_algo)] == -1} { return [array get ret] } ::asn::asnGetBitString pubkeyinfo pubkey set pubkey [binary format B* $pubkey] #   binary scan $pubkey H* ret(pubkey) ::asn::asnGetSequence pubkey_algoid pubalgost #OID -  ::asn::asnGetObjectIdentifier pubalgost ret(paramkey) #OID -   ::asn::asnGetObjectIdentifier pubalgost ret(hashkey) #puts "ret(paramkey)=$ret(paramkey)\n" #puts "ret(hashkey)=$ret(hashkey)\n" #parray ret #  :  ,     return [array get ret] }</code> </pre><br>  ูุนู ุ ูุงุชูู ุฐูู ุชูุฑูุจูุง: ุจุนุฏ ุชุญููู ุญุฒูุฉ pki ุ ุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ุฅูู ุตููู :: pki :: oids oids ุงูุชู ุชููุฒ GOST ูุดูุงุฏุฉ ูุคููุฉ ุฃู ุจุจุณุงุทุฉ ุบุงุฆุจุฉ ูู ูุฐุง ุงูุตููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">package require pki # oid- set ::pki::oids(1.2.643.100.1) "OGRN" set ::pki::oids(1.2.643.100.5) "OGRNIP" set ::pki::oids(1.2.643.3.131.1.1) "INN" set ::pki::oids(1.2.643.100.3) "SNILS" set ::pki::oids(1.2.643.2.2.19) "GOST R 34.10-2001" set ::pki::oids(1.2.643.7.1.1.1.1) "GOST R 34.10-2012-256" set ::pki::oids(1.2.643.7.1.1.1.2) "GOST R 34.10-2012-512" set ::pki::oids(1.2.643.2.2.3) "GOST R 34.10-2001 with GOST R 34.11-94" set ::pki::oids(1.2.643.7.1.1.3.2) "GOST R 34.10-2012-256 with GOSTR 34.11-2012-256" set ::pki::oids(1.2.643.7.1.1.3.3) "GOST R 34.10-2012-512 with GOSTR 34.11-2012-512" set ::pki::oids(1.2.643.100.113.1) "KC1 Class Sign Tool" set ::pki::oids(1.2.643.100.113.2) "KC2 Class Sign Tool" . . .</code> </pre> <br>  ููููู ุฃูุถูุง ุชุฌุฏูุฏ ููุฑุฏุงุช ุงููุชุฑุฌู ุนู ุทุฑูู ุงูุฅุถุงูุฉ ุฅูู ููู ru.msg: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">mcset ru "GOST R 34.10-2001" "  34.10-2001" mcset ru "GOST R 34.10-2012-256" "  34.10-2012-256" mcset ru "GOST R 34.10-2012-512" "  34.10-2012-512" mcset ru "GOST R 34.10-2001 with GOST R 34.11-94" "  34.10-2001    34.11-94" mcset ru "GOST R 34.10-2012-256 with GOSTR 34.11-2012-256" "  34.10-2012-256    34.11-2012-256" mcset ru "GOST R 34.10-2012-512 with GOSTR 34.11-2012-512" "  34.10-2012-512    34.11-2012-512" . . .</code> </pre>  : <br><img src="https://habrastorage.org/webt/am/gu/td/amgutdxuj-xkszh1qpmeaa-hf1g.png"><br><br><h3 style=";text-align:right;direction:rtl">  ุณูุณูุฉ ุดูุงุฏุฉ ุงูุฌุฐุฑ ููุงุฆูุฉ ุฅุจุทุงู ุงูุดูุงุฏุงุช </h3><br>  ููุฏ ุชูุช ููุงูุดุฉ ููููุฉ ุงูุญุตูู ุนูู ุณูุณูุฉ ูู ุดูุงุฏุงุช ุงูุฌุฐุฑ ูุณุจููุง.  ุนู ุทุฑูู ุงูููุงุณ ุ ูุชู ูุชุงุจุฉ ุงูุฅุฌุฑุงุก ููุญุตูู ุนูู ูุงุฆูุฉ ุดูุงุฏุงุช COS / CRL ุงูููุบุงุฉ.  ูููู ุงูุนุซูุฑ ุนูู ุงูููุฏ ุงููุตุฏุฑู ููุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ูุชูุฒูุนุงุชูุง ููุธุงูู ุงูุชุดุบูู Linux ู OS X (macOS) ู MS Windows <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุง</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="">ุดูุฑุฉ ุงููุตุฏุฑ</a> </li><li style=";text-align:right;direction:rtl">  <a href="">Linux32</a> </li><li style=";text-align:right;direction:rtl">  <a href="">Linux64</a> </li><li style=";text-align:right;direction:rtl">  <a href="">OS X</a> </li><li style=";text-align:right;direction:rtl">  <a href="">WIN32</a> </li><li style=";text-align:right;direction:rtl">  <a href="">WIN64</a> </li></ul><br></div></div><br>  ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุตุฏุฑ ุ ููููู ุงูุนุซูุฑ ุนูู ุฌููุน ุงูุฅุฌุฑุงุกุงุช ุงูุฎุงุตุฉ ุจุชุญููู ููุญูุงุช ุงูุดูุงุฏุฉ. <br>  ููุนุงุฑุถู Tk (Tcl / Tk ุ Python / Tkinter ุ ููุง ุฅูู ุฐูู) ุ ุฃูุชุฑุญ ุฅูุฌุงุฏ ุ ููุง ูููููู ุ 10 (ุนุดุฑุฉ) ุงุฎุชูุงูุงุช ุจูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ุงุซููู: ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ gcr-viewer ุงูููุชูุจุฉ ุจู gtk ูุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ certViewer ุงููุทูุฑุฉ ูู Tk: <br><br><img src="https://habrastorage.org/webt/pq/k5/a5/pqk5a5yrh7fbjhlrfipmdvu5tyg.png"><br><br><h3 style=";text-align:right;direction:rtl">  PKCS # 11 ุงูุฑููุฒ / ุงูุจุทุงูุฉ ุงูุฐููุฉ ุงูุดูุงุฏุงุช </h3><br>  ุชุญุฏุซูุง ุฃุนูุงู ุนู ุงูุนูู ูุน ุงูุดูุงุฏุงุช (ุงูุชุตูุญ ุ ุงูุญุตูู ุนูู ุณูุณูุฉ ุดูุงุฏุงุช ุงูุฌุฐุฑ ุ ููุงุฆู ุงูุดูุงุฏุงุช ุงูููุบุงุฉ ุ ุจุตูุงุช ุงูุฃุตุงุจุน ุจูุงุณุทุฉ sha1 ู sha256 ุ ุฅูุฎ) ุงููุฎุฒูุฉ ูู ุงููููุงุช.  ูููู ูุง ุชุฒุงู ููุงู ุดูุงุฏุงุช ูุฎุฒูุฉ ุนูู ุงูุฑููุฒ PKCS # 11 / ุงูุจุทุงูุงุช ุงูุฐููุฉ.  ูุงูุฑุบุจุฉ ุงูุทุจูุนูุฉ ููุณุช ููุท ูุฑุคูุชูู ุ ุซู ุงูุชุตุฏูุฑ ุฅูู ููู.  ููููุฉ ุงูููุงู ุจุฐูู ุ ุณูู ููุถุญ ูู ุงูููุงูุฉ ุงูุชุงููุฉ: <br><br><img src="https://habrastorage.org/webt/vx/25/cu/vx25culnj3anfl_jwbkgd-t8nk4.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar440754/">https://habr.com/ru/post/ar440754/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar440742/index.html">ุตูุญุงุช AMP ู Turbo: ุฅูุฌุงุจูุงุช ูุณูุจูุงุช ููุชุงุฆุฌ ุงูุชูููุฐ</a></li>
<li><a href="../ar440744/index.html">PHP ูููุจุชุฏุฆูู. ุฎุทุฃ ูู ุงูุชุนุงูู</a></li>
<li><a href="../ar440746/index.html">ุฏูุฑุงุช Gartner ูุชูููููุฌูุง ุฅุฏุงุฑุฉ ุงููุนุฑูุฉ ุจุงุณุชุฎุฏุงู ุฏุฑุงุณุงุช ุงูุญุงูุฉ ูู KnowledgeConf</a></li>
<li><a href="../ar440748/index.html">ุฃุณุฑุน ุญุงุณูุจ ุนููุงู ูู ุงูุนุงูู ูุญุทู ุงูุฑูู ุงูููุงุณู ูููุธูุฉ ุงูุนูู ุงูุฏูููุฉ</a></li>
<li><a href="../ar440752/index.html">ุงุฎุชูุงุฑ ุงููุณุชุฎุฏู ุทูุจ ุงูุฃููููุฉ</a></li>
<li><a href="../ar440756/index.html">Serverless CI / CD ุนูู AWS</a></li>
<li><a href="../ar440758/index.html">ุงูุฐูุงุจ ููุชูุจ ูู ุฃูุฑูููุณ! (ููุณูู ุ ููุชุฒ ุจุงุฑู)</a></li>
<li><a href="../ar440760/index.html">ุงูุนุตุฑ ุงูุฐูุจู ุงูุฌุฏูุฏ ูููุฏุณุฉ ุงูููุจููุชุฑ</a></li>
<li><a href="../ar440762/index.html">ูุฑุงุฌุนุงุช ุตุงุญุจ ุงูุนูู: ุทุจูุนุฉ ูุนุฏู ูุฌูุฏ ูุฑุงุฌุนุงุช ูู ุงููุฌููููู</a></li>
<li><a href="../ar440766/index.html">ูู ุงููููุณูู ุฅูู ุงููููุณูู: ูุฏุงูุง ูู 23 ูุจุฑุงูุฑ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>