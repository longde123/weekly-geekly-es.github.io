<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé∂ ‚ôêÔ∏è ‚úçüèæ Dart Streams Basics ü§úüèæ üëÖ ‚òπÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Voici la deuxi√®me partie de ma s√©rie sur Flutter Architecture: 


- Pr√©sentation 
- Dart Streams Basics (cet article) 
- RxDart: transformations magiq...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dart Streams Basics</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450950/"><p>  Voici la deuxi√®me partie de ma s√©rie sur Flutter Architecture: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pr√©sentation</a> </li><li>  <strong>Dart Streams Basics (cet article)</strong> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RxDart: transformations magiques des flux</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Principes de base de RxVMS: RxCommand et GetIt</a> </li><li>  RxVMS: Services et gestionnaires </li><li>  RxVMS: widgets autonomes </li><li>  Authentification utilisateur avec RxVMS </li></ul><br><p>  Les flux sont le principal √©l√©ment constitutif de <strong>RxVMS</strong> , leur compr√©hension est absolument n√©cessaire pour travailler avec cette biblioth√®que, nous allons donc nous attarder sur eux plus en d√©tail dans cet article. </p><br><p>  Il s'est av√©r√© que l'inclusion de Rx dans ce post le rendrait trop long, donc je l'ai divis√© en deux parties. </p><br><h2 id="pust-techet">  Laisse couler </h2><br><p>  J'ai lu beaucoup de commentaires qui disent que les flux, et en particulier Rx, sont trop compliqu√©s √† comprendre et, par cons√©quent, √† utiliser. </p><br><p> J'aimerais que vous sachiez que je ne me consid√®re pas comme un gourou de Rx.  Exploiter tout son pouvoir n'est pas facile, et j'avoue que je continue √† √©tudier.  Mais permettez-moi de corriger une erreur d√®s le d√©but: <strong>vous n'avez pas besoin d'√™tre un assistant Rx pour commencer √† tirer une tonne d'avantages de l'utilisation des threads et de cette technologie</strong> .  Je mettrai tout en ≈ìuvre pour vous expliquer les flux de la mani√®re la plus accessible. </p><a name="habracut"></a><br><h2 id="chto-takoe-potoki">  Quels sont les fils? </h2><br><p>  √Ä mon avis, la meilleure analogie avec les fils est la bande transporteuse.  Vous pouvez mettre quelque chose √† une extr√©mit√© et ce ¬´quelque chose¬ª sera automatiquement transf√©r√© √† l'autre.  Contrairement au pipeline physique, les threads manipulent les objets de donn√©es, les transf√©rant automatiquement depuis le d√©but - mais o√π?  Comme dans le vrai pipeline, s'il n'y a rien qui attrape les donn√©es √† l'autre bout, elles vont simplement ¬´tomber¬ª et dispara√Ætre (ce n'est bien s√ªr pas tout √† fait vrai pour Dart Streams, mais il est pr√©f√©rable de g√©rer les flux comme si c'√©tait le cas) . </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/266/3a1/04f/2663a104fc0e4c1ad735881ef36fe32c.gif"></p><br><p>  Pour √©viter la perte de donn√©es, vous pouvez d√©finir un "pi√®ge" sur la sortie du flux.  De cette fa√ßon, vous pouvez capturer des donn√©es et effectuer les manipulations n√©cessaires avec elles chaque fois que des objets de donn√©es atteignent la fin du flux. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/dd3/331/b2f/dd3331b2fa9036bee28628d563f3ceb7.gif"></p><br><p>  <strong>N'oubliez pas:</strong> </p><br><ul><li>  Si le pi√®ge n'est pas d√©fini, les donn√©es dispara√Ætront tout simplement pour toujours et il n'y aura aucun moyen de les r√©cup√©rer (encore une fois, pas exactement avec Dart Streams, mais vous feriez mieux de pr√©tendre que c'est le cas) </li><li>  Apr√®s avoir envoy√© des donn√©es au flux, vous n'avez pas besoin de suspendre le programme et d'attendre qu'il atteigne la fin, tout cela se passe en arri√®re-plan. </li><li>  Le pi√®ge peut recevoir des donn√©es √† tout moment, ce n'est pas n√©cessaire imm√©diatement apr√®s l'envoi (mais ne vous inqui√©tez pas, les flux sont en fait tr√®s rapides).  Imaginez que vous ne savez pas √† quelle vitesse ou combien de temps la bande transporteuse se d√©place.  Cela signifie que placer quelque chose dans le flux est compl√®tement s√©par√© de la r√©action √† l'√©l√©ment √† l'autre extr√©mit√©.  Votre pi√®ge fonctionnera et attrapera l'article quand il y arrivera.  (Certains d'entre vous r√©alisent peut-√™tre d√©j√† que cela correspond bien √† la fa√ßon r√©active dont Flutter met √† jour ses widgets) </li><li>  Vous pouvez d√©finir un pi√®ge bien avant le d√©but du travail et le premier √©l√©ment appara√Æt </li><li>  Le flux fonctionne sur le principe FIFO.  Les donn√©es viennent toujours dans l'ordre dans lequel elles sont plac√©es dans le flux. </li></ul><br><h2 id="a-chto-takoe-rx">  Qu'est-ce que Rx? </h2><br><p>  Rx, abr√©viation de Reactive Extensions, sont des flux de st√©ro√Ødes.  Il s'agit d'un concept tr√®s similaire √† Streams, qui a √©t√© invent√© pour le framework .Net par l'√©quipe Microsoft.  √âtant donn√© que .Net avait d√©j√† le type Stream, qui est utilis√© pour les E / S de fichiers, ils ont appel√© les flux Rx <strong>Observables</strong> et cr√©√© de nombreuses fonctions pour manipuler les donn√©es qui les traversent.  Dart int√®gre des flux dans sa sp√©cification de langage qui offrent d√©j√† la plupart de ces fonctionnalit√©s, mais pas toutes.  C'est pourquoi le package RxDart a √©t√© d√©velopp√©;  Il est bas√© sur Dart Streams, mais √©tend leurs fonctionnalit√©s.  Je couvrirai Rx et RxDart dans la prochaine partie de cette s√©rie. </p><br><h2 id="nemnogo-terminov">  Quelques termes </h2><br><p>  Dart Streams et Rx utilisent une terminologie qui peut sembler effrayante, alors voici la traduction.  Vient d'abord le terme Dart, puis Rx. </p><br><ul><li>  <strong>Stream / Observable</strong> .  Il s'agit du "pipeline" d√©crit pr√©c√©demment.  Le flux peut √™tre converti en observable et partout o√π le flux est attendu, vous pouvez attribuer un observable.  Alors ne vous embrouillez pas si je m√©lange ces termes en expliquant </li><li>  <strong>√©couter / s'abonner</strong> - d√©finir le pi√®ge de l' <strong>auditeur</strong> </li><li>  <strong>StreamController / Subject</strong> .  Le c√¥t√© "gauche" de la bande transporteuse o√π vous placez les donn√©es dans le Stream.  Ils diff√®rent l√©g√®rement dans leurs propri√©t√©s et caract√©ristiques, mais servent le m√™me but. </li><li>  <strong>Emission d'un √©l√©ment / de donn√©es</strong> .  Le moment o√π les donn√©es apparaissent √† la sortie du "pipeline" </li></ul><br><h2 id="sozdanie-potoka">  Cr√©ation de flux </h2><br><p>  Si vous avez l'intention de continuer √† √©tudier le sujet, veuillez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cloner ce projet</a> avec des exemples.  J'utiliserai le syst√®me de test Dart / Flutter. </p><br><p>  Pour cr√©er un flux, vous cr√©ez un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">StreamController</a> </p><br><pre><code class="cpp hljs">var controller = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamController&lt;String&gt;(); controller.add(<span class="hljs-string"><span class="hljs-string">"Item1"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     </span></span></code> </pre> <br><p>  Le type de mod√®le (dans ce cas, String) transmis lors de la cr√©ation de StreamController d√©termine le type d'objets que nous pouvons envoyer au flux.  Cela peut √™tre N'IMPORTE QUEL type!  Vous pouvez cr√©er un <code>StreamController&lt;List&lt;MyObject&gt;&gt;()</code> si vous le souhaitez et le flux transf√©rera la feuille enti√®re au lieu d'un seul objet. </p><br><h2 id="ustanovka-lovushki">  R√©glage du pi√®ge </h2><br><p>  Si vous avez ex√©cut√© le test sp√©cifi√©, vous ne pouviez rien voir, car rien n'a attrap√© notre ligne √† la sortie du flux.  Maintenant, posez le pi√®ge: </p><br><pre> <code class="cpp hljs">var controller = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamController&lt;String&gt;(); controller.stream.listen((item) =&gt; print(item)); <span class="hljs-comment"><span class="hljs-comment">//  controller.add("Item1"); controller.add("Item2"); controller.add("Item3");</span></span></code> </pre> <br><p>  Le pi√®ge est maintenant d√©fini √† l'aide de la m√©thode <code>.listen()</code> .  L'enregistrement ressemble √† <code>controller.stream.listen</code> , mais si vous le faites d√©filer vers l'arri√®re, comme une sorte d'album des ann√©es 60, alors le vrai sens de ce qui est √©crit appara√Ætra: "√©couter le flux de ce contr√¥leur" </p><br><p>  Vous devez passer une certaine fonction √† la m√©thode <code>.listen()</code> afin de manipuler en quelque sorte les donn√©es entrantes.  La fonction doit accepter un param√®tre du type sp√©cifi√© lors de la cr√©ation du StreamController, dans ce cas, String. </p><br><p>  Si vous ex√©cutez le code ci-dessus, vous verrez </p><br><pre> <code class="cpp hljs">Item1 Item2 Item3</code> </pre> <br><p>  √Ä mon avis, le plus gros probl√®me pour les nouveaux arrivants dans Streams est que vous pouvez d√©terminer la r√©action de l'√©l√©ment √©mis bien avant que le premier √©l√©ment ne soit mis dans le flux, d√©clenchant un appel √† cette r√©action. </p><br><h2 id="zavershenie-proslushivaniya">  Fin de l'√©coute </h2><br><p>  Le code ci-dessus a manqu√© la petite mais importante partie.  <code>listen()</code> renvoie un <code>StreamSubscription</code> - un objet d'abonnement √† un flux.  Un appel √† sa m√©thode <code>.cancel()</code> met fin √† l'abonnement, lib√©rant des ressources et emp√™chant votre fonction d'√©coute d'√™tre appel√©e lorsqu'elle devient inutile. </p><br><pre> <code class="cpp hljs">var controller = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamController&lt;String&gt;(); StreamSubscription subscription = controller.stream.listen((item) =&gt; print(item)); <span class="hljs-comment"><span class="hljs-comment">// This is the Trap controller.add("Item1"); controller.add("Item2"); controller.add("Item3"); //    ,        //  ,     Stream   await Future.delayed(Duration(milliseconds: 500)); subscription.cancel;</span></span></code> </pre> <br><h2 id="podrobnosti-o-slushatelyah">  D√©tails de l'auditeur </h2><br><p>  La fonction pour <code>listen()</code> peut √™tre soit une fonction lambda soit une simple fonction. </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myPrint</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String message)</span></span></span><span class="hljs-function"> </span></span>{ print(message); } StreamSubscription subscription = controller.stream.listen((item) =&gt; print(item)); <span class="hljs-comment"><span class="hljs-comment">//  - StreamSubscription subscription2 = controller.stream.listen(myPrint); //    StreamSubscription subscription3 = controller.stream.listen((item) { print(item); print(item.toUpperCase); }); // -</span></span></code> </pre> <br><p>  <strong>Remarque importante: la plupart des flux Dart n'autorisent qu'un abonnement unique, c'est-√†-dire qu'ils ne peuvent pas √™tre r√©inscrits une fois l'abonnement termin√© - cela l√®vera une exception.</strong>  <strong>C'est leur diff√©rence par rapport aux autres impl√©mentations Rx.</strong> </p><br><p>  La signature compl√®te de <code>listen()</code> ressemble √† ceci: </p><br><pre> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">/* excerpt from the API doc * The [onError] callback must be of type `void onError(error)` or * `void onError(error, StackTrace stackTrace)`. If [onError] accepts * two arguments it is called with the error object and the stack trace * (which could be `null` if the stream itself received an error without * stack trace). * Otherwise it is called with just the error object. * If [onError] is omitted, any errors on the stream are considered unhandled, * and will be passed to the current [Zone]'s error handler. * By default unhandled async errors are treated * as if they were uncaught top-level errors. * * If this stream closes and sends a done event, the [onDone] handler is * called. If [onDone] is `null`, nothing happens. * * If [cancelOnError] is true, the subscription is automatically canceled * when the first error event is delivered. The default is `false`. */</span></span> StreamSubscription&lt;T&gt; listen(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> onData(T event), {Function onError, <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> onDone(), <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> cancelOnError});</code> </pre> <br><p>  Cela signifie que vous pouvez faire plus que simplement passer un gestionnaire pour les donn√©es envoy√©es.  Vous pouvez √©galement avoir un gestionnaire d'erreurs et un autre pour fermer le flux c√¥t√© contr√¥leur ( <code>onDone</code> ).  Les exceptions <code>onError()</code> depuis le Stream <code>onError()</code> si vous le fournissez, <strong>sinon elles sont simplement aval√©es et vous ne saurez jamais que quelque chose s'est mal pass√©.</strong> </p><br><h2 id="primer-flutter-potokov">  Exemple de fil de flottement </h2><br><p>  <em>Pour faciliter la compr√©hension des chapitres suivants, j'ai cr√©√© une branche de r√©f√©rentiel distincte.</em> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Veuillez la cloner</a> </p><br><p>  Comme premier exemple, j'ai pris l'application de comptage bien connue que vous obtenez lors de la cr√©ation d'un nouveau projet Flutter, et l'ai un peu r√©organis√©.  J'ai ajout√© une classe de mod√®le pour contenir l'√©tat de l'application, qui est essentiellement une contre-valeur: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Model</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _counter = <span class="hljs-number"><span class="hljs-number">0</span></span>; StreamController _streamController = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamController&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(); Stream&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; get counterUpdates =&gt; _streamController.stream; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">incrementCounter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ _counter++; _streamController.add(_counter); } }</code> </pre> <br><p>  ici, vous pouvez voir un mod√®le tr√®s typique: au lieu de publier l'int√©gralit√© de StreamController, nous publions simplement sa propri√©t√© Stream. </p><br><p>  Pour rendre le mod√®le disponible pour l'interface utilisateur, je l'ai fait un champ statique dans l'objet App parce que je ne voulais pas entrer InheritedWidget ou ServiceLocator.  Pour un exemple simple, cela va s'en tirer, mais je ne le ferais pas dans cette application! </p><br><p>  Ajoutez √† <code>main.dart</code> : </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyHomePageState</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">State</span></span></span><span class="hljs-class">&lt;MyHomePage&gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _counter = <span class="hljs-number"><span class="hljs-number">0</span></span>; StreamSubscription streamSubscription; @<span class="hljs-function"><span class="hljs-function">override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ streamSubscription = MyApp.model.counterUpdates.listen((newVal) =&gt; setState(() { _counter = newVal; })); super.initState(); } <span class="hljs-comment"><span class="hljs-comment">//   State   ,   , //       @override void dispose() { streamSubscription?.cancel(); super.dispose(); }</span></span></code> </pre> <br><p>  <code>initState()</code> bon endroit pour d√©finir l'auditeur, et en tant que bons citoyens de Darts, nous <code>initState()</code> toujours l'abonnement dans <code>dispose()</code> , non? </p><br><p>  Dans l'arborescence des widgets, il suffit d'adapter le gestionnaire onPressed du bouton FAB (bouton avec une action flottante). </p><br><pre> <code class="cpp hljs">floatingActionButton: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FloatingActionButton( onPressed: MyApp.model.incrementCounter, tooltip: <span class="hljs-string"><span class="hljs-string">'Increment'</span></span>, child: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Icon(Icons.add), ),</code> </pre> <br><p>  De cette fa√ßon, nous avons cr√©√© une s√©paration nette entre la vue et le mod√®le √† l'aide de Stream. </p><br><h2 id="primenyaem-streambuilder">  Appliquer StreamBuilder </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Source</a> </p><br><p>  Au lieu d'utiliser <code>initState()</code> et <code>setState()</code> pour nos besoins, Flutter est livr√© avec un widget <code>StreamBuilder</code> pratique.  Comme vous l'avez peut-√™tre devin√©, il faut une fonction Stream et une m√©thode constructeur qui est appel√©e chaque fois que Stream renvoie une nouvelle valeur.  Et maintenant, nous n'avons pas besoin d'une initialisation et d'une lib√©ration explicites: </p><br><pre> <code class="cpp hljs">body: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Center( child: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Column( mainAxisAlignment: MainAxisAlignment.center, children: &lt;Widget&gt;[ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Text( <span class="hljs-string"><span class="hljs-string">'You have pushed the button this many times:'</span></span>, ), StreamBuilder&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;( initialData: <span class="hljs-number"><span class="hljs-number">0</span></span>, stream: MyApp.model.counterUpdates, builder: (context, snappShot) { String valueAsString = <span class="hljs-string"><span class="hljs-string">'NoData'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (snappShot != null &amp;&amp; snappShot.hasData) { valueAsString = snappShot.data.toString(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Text( valueAsString, style: Theme.of(context).textTheme.display1, ); }), ], ), ),</code> </pre> <br><p>  Nous avons presque termin√©, je le promets.  Voici trois choses que vous devez savoir: </p><br><ul><li>  Le gros avantage de l'utilisation de StreamBuilder par rapport √† la premi√®re solution est que l'appel de <code>setState()</code> dans <code>listen()</code> r√©organise toujours la page enti√®re, tandis que StreamBuilder n'appellera que son <code>builder</code> </li><li>  La variable <code>snapShot</code> contient les donn√©es les plus r√©centes re√ßues de Stream.  V√©rifiez toujours qu'il contient des donn√©es valides avant de l'utiliser. </li><li><p>  Bas√© sur les principes d'initialisation pendant, StreamBuilder ne peut pas obtenir de valeur pendant la toute premi√®re trame.  Pour contourner ce <code>initialData</code> , nous transmettons la valeur de <code>initialData</code> , qui est utilis√©e pour le premier assemblage, c'est-√†-dire pour la premi√®re image de l'√©cran.  Si nous ne transmettons pas <code>initialData</code> , notre constructeur sera appel√© pour la premi√®re fois avec des donn√©es invalides.  Une alternative √† l'utilisation de <code>initialData</code> consiste √† renvoyer un widget d'espace r√©serv√© si <code>snapShot</code> pas valide, qui s'affiche jusqu'√† ce que nous obtenions des donn√©es valides, par exemple: </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// ,           StreamBuilder&lt;int&gt;( stream: MyApp.model.databaseUpdates, builder: (context, snappShot) { if (snappShot != null &amp;&amp; snappShot.hasData) { return Text( snappShot.data.toString(), style: Theme.of(context).textTheme.display1, ); } //      ,   Spinner return CircularProgressIndicator (); })</span></span></code> </pre> <br></li></ul><br><p>  Dans le prochain article, nous verrons comment convertir les donn√©es dans nos flux et le faire √† la vol√©e.  Un grand merci √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Scott Stoll</a> pour la lecture des √©preuves et des commentaires importants. </p><br><hr></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr450950/">https://habr.com/ru/post/fr450950/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr450938/index.html">Linux Install Fest 05.19 √† Nizhny Novgorod 18 mai 2019</a></li>
<li><a href="../fr450940/index.html">Vivaldi 2.5 - Macrocosme attrayant</a></li>
<li><a href="../fr450942/index.html">Sidecar pour un fractionnement de code</a></li>
<li><a href="../fr450946/index.html">Disque cellulaire sur LPC810</a></li>
<li><a href="../fr450948/index.html">MU-MIMO: l'un des algorithmes d'impl√©mentation</a></li>
<li><a href="../fr450952/index.html">Indice moyen et antibank</a></li>
<li><a href="../fr450954/index.html">Comment nous avons appris √† exploiter Java dans Docker</a></li>
<li><a href="../fr450956/index.html">Comparaison des COB industriels: ISIM vs. Kics</a></li>
<li><a href="../fr450958/index.html">AnyStub, biblioth√®que de stub de connexion Java</a></li>
<li><a href="../fr450962/index.html">Pompes √† insuline, micropuces inviolables et radio d√©finie par logiciel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>