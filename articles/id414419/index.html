<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÜóÔ∏è üéÇ üë®üèæ‚Äçü§ù‚Äçüë®üèº ESET telah menyiapkan spyware InvisiMole sejak 2013 üëèüèΩ üîâ üßñüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Melacak korban peringkat tinggi dengan tetap berada di tempat teduh. Ini adalah prinsip pengoperasian dua komponen berbahaya InvisiMole. Mereka mengub...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ESET telah menyiapkan spyware InvisiMole sejak 2013</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/414419/">  Melacak korban peringkat tinggi dengan tetap berada di tempat teduh.  Ini adalah prinsip pengoperasian dua komponen berbahaya InvisiMole.  Mereka mengubah komputer yang terinfeksi menjadi kamera video penyerang, yang memungkinkan Anda untuk melihat dan mendengar segala sesuatu yang terjadi di kantor atau di tempat lain di mana perangkat berada.  Operator InvisiMole mudah terhubung ke sistem, memantau tindakan korban dan mencuri rahasianya. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qz/z_/0f/qzz_0fx62wvi_detfemzuckk0zs.jpeg"></div><br>  Menurut telemetri ESET, para penyerang di balik <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">spyware</a> ini telah aktif sejak setidaknya 2013.  Namun, alat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">spionase maya</a> ini tidak hanya tidak dipelajari, tetapi tidak terdeteksi hingga terdeteksi oleh produk ESET pada komputer yang terinfeksi di Rusia dan Ukraina. <br><br>  Kampanye ini sangat bertarget, yang menjelaskan tingkat infeksi yang rendah - hanya beberapa komputer. <br><a name="habracut"></a><br>  InvisiMole memiliki arsitektur modular, memulai perjalanannya dengan pembungkus DLL (wrapper DLL), kemudian ada dua modul yang dibangun menjadi sumber dayanya.  Kedua modul adalah backdoor multifungsi, yang memungkinkan Malvari untuk mengumpulkan informasi maksimum tentang target. <br><br>  Untuk mengalihkan perhatian pengguna dari mesin yang terinfeksi, langkah-langkah tambahan diterapkan.  Ini memungkinkan program jahat tetap berada di sistem untuk waktu yang lama.  Kami belum menetapkan vektor infeksi - saat ini semua opsi dimungkinkan, termasuk instalasi manual dengan akses fisik ke mesin. <br><br><h3>  Instalasi dan Kegigihan </h3><br>  Bagian pertama dari malvari yang sedang diselidiki adalah pembungkus DLL yang dikompilasi menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Free Pascal</a> Compiler.  Menurut data telemetri kami, DLL ditempatkan di folder Windows dan menyamar sebagai <code>mpr.dll</code> pustaka <code>mpr.dll</code> sah dengan informasi versi palsu. <br><br><img src="https://habrastorage.org/webt/63/po/le/63polemyrko5n7gdyrzmenhgeva.png"><br>  <i>Gambar 1. Pembungkus DLL yang disamarkan sebagai file pustaka mpr.dll yang sah, menyalin informasi nama dan versi</i> <br><br>  Kami tidak melihat sampel dengan nama pembungkus lain, meskipun ada indikasi dalam kode DLL bahwa file tersebut juga dapat disebut <code>fxsst.dll</code> atau <code>winmm.dll</code> . <br><br>  Cara pertama untuk meluncurkan malvari adalah teknik mengganti DLL (pembajakan DLL).  Pembungkus DLL ditempatkan di folder yang sama dengan <code>explorer.exe</code> dan dimuat pada startup Windows bersama dengan proses Windows Explorer bukannya perpustakaan yang sah yang terletak di <code>%windir%\system32</code> . <br><br>  Kami menemukan Malvari versi 32 dan 64-bit, yang memberikan ketekunan dalam kedua arsitektur. <br><br>  Sebagai alternatif untuk menipu DLL, pemuatan dan metode kegigihan lainnya dimungkinkan.  DLL wrapper mengekspor fungsi <code>GetDataLength</code> .  Saat memanggil fungsi ini, DLL memeriksa untuk melihat apakah itu dimuat oleh proses <code>rundll32.exe</code> menggunakan <code>explorer.exe</code> atau <code>svchost.exe</code> sebagai proses induk, dan hanya kemudian meluncurkan payload.  Ini menyarankan metode lain yang mungkin untuk memastikan ketekunan - menambahkan tugas ke penjadwal (proses induk adalah <code>svchost.exe</code> ) atau menulis ke kunci autorun di registri (proses induknya adalah <code>explorer.exe</code> ). <br><br>  Terlepas dari bagaimana kegigihan dipertahankan, perilaku malware dan payload itu sendiri sama dalam semua kasus.  <code>RC2FM</code> DLL memuat modul yang disimpan dalam sumber daya dengan nama <code>RC2FM</code> dan <code>RC2CL</code> , dan (jika substitusi DLL digunakan) pustaka yang sah ke dalam proses <code>explorer.exe</code> agar tidak mengganggu operasi normal aplikasi dan tidak diperhatikan. <br><br><img src="https://habrastorage.org/webt/tf/-0/eh/tf-0ehnfccoxblcwcetgc7zcgq8.png"><br>  <i>Gambar 2. Fungsi wrapper yang diekspor</i> <br><br><h2>  Analisis teknis </h2><br>  Tanggal pasti kompilasi malware tidak diketahui - sampel pembungkus DLL terbaru diubah oleh penulis, stempel waktu PE diatur ulang ke nol secara manual.  Namun, dalam perjalanan penelitian, kami menemukan versi sebelumnya bertanggal 13 Oktober 2013, sehingga versi-versi baru tersebut dikompilasi dengan jelas nanti. <br><br><img src="https://habrastorage.org/webt/rg/ke/pn/rgkepn1sgdnddzbzmrfdij84cbu.png"><br>  <i>Gambar 3. Dalam semua sampel kemudian, cap waktu diatur ke nol</i> <br><br><h3>  Enkripsi dan dekripsi </h3><br>  Untuk menyamarkan diri mereka dari analis virus dan administrator sistem, penulis program jahat menggunakan enkripsi string, file internal, data konfigurasi, dan komunikasi jaringan.  Sementara modul <code>RC2FM</code> menggunakan cipher kustom, pembungkus DLL dan modul <code>RC2CL</code> menggunakan satu prosedur khusus untuk semua tujuan, termasuk mendekripsi modul berbahaya lainnya yang dibangun ke dalam pembungkus DLL. <br><br>  Skrip yang dengannya Anda dapat mengekstrak <code>RC2CL</code> dan <code>RC2CL</code> built-in dari pembungkus DLL tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori ESET di GitHub</a> . <br><br><img src="https://habrastorage.org/webt/wx/qz/dm/wxqzdmpwpxazkzgym0u3n-zghmw.png"><br>  <i>Gambar 4. Prosedur dekripsi dalam berbagai sampel (didekompilasi dan dibongkar)</i> <br><br><h3>  Modul RC2FM </h3><br>  Modul <code>RC2FM</code> pertama yang lebih kecil berisi backdoor yang mendukung 15 perintah.  Mereka dieksekusi di komputer yang terinfeksi seperti yang diarahkan oleh penyerang.  Modul ini dapat membuat berbagai perubahan pada sistem, dan juga termasuk alat untuk spionase cyber. <br><br>  File-file tersebut memiliki opsi logging, tetapi nama log sistem tidak ditentukan dalam sampel.  Ini menunjukkan bahwa fungsi tersebut hanya digunakan pada tahap pengembangan. <br><br><h4>  Komunikasi jaringan </h4><br>  Modul ini berkomunikasi dengan server C&amp;C, yang dimasukkan ke dalam hardcode dalam sampel atau ditambahkan oleh penyerang. <br><br>  Selain itu, modul ini dapat mengakses server C&amp;C bahkan dengan proxy yang dikonfigurasi pada mesin yang terinfeksi.  Jika koneksi langsung tidak dapat dibangun, modul mencoba untuk terhubung ke server C&amp;C-nya menggunakan proxy yang dikonfigurasi secara lokal atau proxy yang dikonfigurasi untuk browser yang berbeda (Firefox, Pale Moon dan Opera). <br>  RC2FM bahkan dapat memeriksa daftar aplikasi yang baru saja digunakan dan mencoba menemukan executable browser portabel: <br><br>  FirefoxPortable.exe <br>  OperaPortable.exe <br>  Jalankan waterfox.exe <br>  OperaAC.exe <br>  Palemoon-Portable.exe <br><br>  Jika korban menggunakan salah satu browser portabel ini <i>dengan server proxy yang dikonfigurasikan</i> , malware dapat mendeteksinya dalam pengaturan pengguna dan menggunakannya untuk berkomunikasi dengan server C&amp;C-nya. <br><br>  Komunikasi dengan server C&amp;C adalah serangkaian permintaan GET dan POST HTTP, seperti yang ditunjukkan pada Gambar 5. Permintaan terenkripsi berisi ID PC dan cap waktu, serta beberapa informasi lain (opsional).  Penting untuk dicatat bahwa modul <code>RC2FM</code> menggunakan beberapa metode enkripsi (varian enkripsi XOR sederhana), tidak seperti komponen InvisiMole lainnya. <br><br><img src="https://habrastorage.org/webt/ml/ev/kx/mlevkxds5qah0qvlkocfgxsfplk.png"><br>  <i>Gambar 5. Contoh permintaan yang dikirim ke server C&amp;C oleh modul RC2FM</i> <br><br>  Setelah pendaftaran sukses korban di server C&amp;C, informasi tambahan dimuat ke dalam sistem, yang akan ditafsirkan oleh perintah backdoor. <br><br><h4>  Fungsionalitas </h4><br>  <code>RC2FM</code> mendukung perintah untuk mendaftar informasi sistem dasar dan membuat perubahan sederhana pada sistem, serta beberapa fitur spyware.  Atas permintaan penyerang, modul tersebut dapat menyalakan mikrofon dari jarak jauh pada komputer yang rusak dan merekam audio.  Catatan ini dikodekan dalam format MP3 menggunakan <code>lame.dll</code> library yang sah, yang diunduh dan digunakan oleh malware. <br><br>  Alat lain untuk mencuri data adalah tangkapan layar.  Salah satu perintah backdoor dirancang untuk mengambil tangkapan layar. <br><br>  Program jahat memonitor semua disk internal dan eksternal yang ditampilkan pada sistem lokal.  Ketika drive baru terhubung, itu membuat daftar dengan semua file dan menyimpannya dalam bentuk terenkripsi. <br><br>  Informasi yang dikumpulkan akan dikirim ke penyerang setelah mengirim perintah yang sesuai. <br><br><h4>  Tim pintu belakang </h4><br>  Berikut ini adalah ID dan deskripsi dari perintah yang didukung.  Visualisasi fungsi backdoor pada juru bahasa ditunjukkan pada Gambar 6. <br><br>  0 - Buat daftar disk yang ditampilkan, file dalam folder, jaringan berbagi <br>  2 - Membuat, memindahkan, mengganti nama, mengeksekusi atau menghapus file, menghapus direktori menggunakan jalur yang ditentukan <br>  4 - Buka file, atur pointer ke awal file <br>  5 - Tutup file yang sebelumnya dibuka <br>  6 - Tulis data ke file yang sebelumnya dibuka <br>  7 - Mengubah atribut file waktu / menghapus file <br>  8 - Buka file, atur pointer ke akhir file <br>  10 - Mengubah atribut file waktu / menghapus file <br>  12 - Temukan file dengan mask file yang ditentukan di direktori yang ditentukan <br>  13 - Ambil tangkapan layar <br>  14 - Unggah atau modifikasi file menggunakan data internal <br>  15 - Rekam suara menggunakan perangkat audio yang terhubung, buat daftar perangkat yang tersedia, kirim rekaman, ubah konfigurasi <br>  16 - Periksa file yang terbuka di modul <br>  17 - Perbarui daftar server C &amp; C <br>  19 - Membuat, menginstal, menyalin, mendaftar, atau menghapus kunci atau nilai registri yang ditentukan <br><br><img src="https://habrastorage.org/webt/41/kf/7v/41kf7vzsczihmuttbyyjrbtcybe.png"><br>  <i>Gambar 6. Fungsi backdoor di interpreter (asli dan setelah analisis kami, dimodifikasi menggunakan fungsi Group Nodes di IDA Pro untuk keterbacaan)</i> <br><br><h3>  Modul RC2CL </h3><br>  Modul <code>RC2CL</code> juga merupakan pintu belakang dengan berbagai alat spionase.  Ini diluncurkan oleh pembungkus DLL pada saat yang sama dengan modul <code>RC2FM</code> .  Ini adalah modul yang lebih kompleks, fungsinya lebih cenderung ditujukan pada pengumpulan informasi maksimum daripada membuat perubahan pada sistem. <br><br>  Menariknya, modul <code>RC2CL</code> memiliki opsi untuk mematikan fungsi backdoor dan bekerja sebagai proxy.  Dalam hal ini, malware mematikan firewall Windows dan membuat server yang mendukung komunikasi antara klien dan server C&amp;C atau dua klien. <br><br><h4>  Komunikasi jaringan </h4><br>  Malware berkomunikasi dengan server C&amp;C melalui soket TCP.  Pesan yang dikirim oleh klien ditutupi di bawah protokol HTTP, tetapi Anda harus memperhatikan metode HTTP yang tidak valid "HIDE" pada contoh pada Gambar 7. <br><br>  Permintaan tersebut berisi pengidentifikasi perangkat lunak yang dikompromikan, jenis permintaan, dan informasi terenkripsi yang harus dikirim oleh penyerang, yaitu, hasil dari mengeksekusi perintah backdoor atau permintaan untuk instruksi baru. <br><br><img src="https://habrastorage.org/webt/jf/og/gu/jfoggu3qvtsjumjvxt6etxex9mw.png"><br>  <i>Gambar 7. Contoh permintaan yang dikirim ke server perintah oleh modul RC2CL</i> <br><br><h4>  Fungsionalitas </h4><br>  Tergantung pada perintah yang diterima, backdoor dapat melakukan berbagai operasi pada sistem yang terinfeksi.  Backdoors biasa melakukan manipulasi dengan sistem file dan kunci registri, mendukung eksekusi file, dan aktivasi shell jarak jauh.  Spivar ini mendukung semua tim ini dan bahkan lebih - 84 tim memungkinkan penyerang mengumpulkan informasi komprehensif tentang korban. <br><br>  Program jahat memindai komputer yang terinfeksi dan mentransfer berbagai data ke penyerang: informasi sistem (daftar proses aktif, menjalankan layanan, driver yang dimuat atau disk yang tersedia), informasi jaringan (tabel alamat IP, kecepatan koneksi Internet). <br><br>  InvisiMole dapat memindai jaringan nirkabel yang tersedia pada sistem yang dikompromikan.  Spivar mencatat informasi seperti alamat SSID dan MAC dari titik akses Wi-Fi yang terdeteksi.  Data ini kemudian dapat diverifikasi dengan database publik, yang memungkinkan penyerang untuk melacak geolokasi korban. <br><br>  Perintah lain memberikan informasi tentang pengguna mesin yang dikompromikan, akun mereka dan sesi sebelumnya. <br><br>  Yang menarik adalah perangkat lunak yang diinstal pada mesin yang dikompromikan.  Program apa yang diinstal di sistem?  Manakah dari mereka yang secara otomatis mulai pada startup sistem atau login pengguna?  Program apa yang digunakan pengguna tertentu?  Jika penyerang tertarik pada sesuatu, cukup masukkan satu perintah untuk mendapatkan data yang diperlukan. <br><br>  Malware dapat memperoleh perintah untuk mencari dokumen yang baru dibuka dan file menarik lainnya.  Itu dapat melihat direktori tertentu dan perangkat eksternal, melaporkan perubahan dan mengekstrak file yang dipilih oleh penyerang. <br><br>  Malware dapat menghidupkan atau mematikan sistem manajemen akun (UAC), atau memotongnya dan bekerja dengan file dalam direktori yang dilindungi tanpa hak administrator (lebih lanjut tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tautan</a> ).  Jika malware tersebut berjalan di bawah proses <code>explorer.exe</code> , yang secara otomatis mendapatkan hak yang ditinggikan, ia dapat membuat objek COM dan menggunakannya untuk menghapus dan memindahkan file di area yang memerlukan hak administrator. <br><br>  Selain itu, InvisiMole dapat menyalakan webcam dan mikrofon korban dari jarak jauh, memata-matai dengan mengambil gambar atau merekam suara.  Penyerang dapat memantau aktivitas pada perangkat dengan mengambil tangkapan layar.  Yang sangat menarik, InvisiMole memungkinkan Anda mengambil tangkapan layar tidak hanya seluruh layar, tetapi juga setiap jendela yang terbuka.  Ini memungkinkan penyerang untuk mengumpulkan informasi bahkan ketika windows saling menutup. <br><br>  Salah satu perintah backdoor memungkinkan Anda untuk mengganti konten driver dengan nama-nama berikut: <br><br> <code>blbdrive.sys <br> compbatt.sys <br> secdrv.sys</code> <br> <br>  Kami tidak mengamati penggunaan perintah ini oleh penyerang, tetapi kami dapat mengasumsikan bahwa perintah ini digunakan untuk memberikan ketekunan tambahan pada sistem 32-bit. <br><br>  Backdoor dapat mengganggu sistem (misalnya, masuk sebagai pengguna, menyelesaikan proses atau mematikan sistem), tetapi terutama menyediakan operasi pasif.  Program mencoba menyembunyikan aktivitasnya jika memungkinkan. <br><br>  Jadi, spivar menjelajahi tempat-tempat menarik dalam sistem, mempelajari dokumen yang baru dibuka atau mengubah beberapa file.  Tindakan ini meninggalkan jejak dan dapat menyebabkan kecurigaan terhadap korban, karena setelah setiap operasi tersebut waktu modifikasi terakhir dari file dan / atau akses ke sana berubah.  Untuk mencegah deteksi, malware memulihkan tanggal perubahan atau pembukaan file sebelumnya untuk menyembunyikan manipulasinya dari pengguna. <br><br>  Contoh lain tentang bagaimana penulis spayvari mencoba menghindari deteksi bekerja dengan jejak yang tertinggal di disk.  Program jahat mengumpulkan sejumlah besar data rahasia yang disimpan dalam file selama beberapa waktu dan dihapus setelah berhasil mengunggah ke server C&amp;C.  Masalahnya adalah administrator sistem yang berpengalaman dapat memulihkan file yang dihapus, yang akan membantu dalam menyelidiki serangan setelah korban mengetahui tentang kompromi.  Ini dimungkinkan karena beberapa informasi tetap ada di disk bahkan setelah menghapus file.  Untuk mencegah hal ini, InvisiMole memiliki opsi untuk menghapus semua file dengan aman.  Ini berarti bahwa data yang pertama ditimpa dengan nol atau byte acak, dan hanya setelah itu file dihapus. <br><br><h4>  Memori internal </h4><br>  Konfigurasi backdoor dan data yang dikumpulkan disimpan di dua alamat - ini adalah direktori kerja dan kunci registri.  Sebagian besar perintah backdoor dirancang untuk memanipulasi lokasi penyimpanan data ini dan kontennya. <br><br>  Lokasi direktori kerja ditentukan menggunakan perintah dari server jauh.  Direktori ini digunakan sebagai penyimpanan sementara file yang berisi informasi yang dikumpulkan dari komputer yang dikompromikan.  File-file ini memiliki metode penamaan yang umum, algoritma dan struktur enkripsi.  Mereka dienkripsi dengan versi sederhana dari cipher XOR, yang digunakan dalam komponen malvari.  Jenis file dapat diperoleh dari urutan kontrol 4-byte yang terletak di awal file. <br><br>  Selain menyimpan data yang dikumpulkan, direktori ini digunakan sebagai direktori home untuk salinan aplikasi WinRAR.exe yang sah.  Malvar menyalinnya dan menggunakannya untuk mengarsipkan data yang dicuri. <br><br>  Registri menyimpan data konfigurasi, serta daftar file di direktori kerja.  Data dikemas menggunakan prosedur Zlib yang diimplementasikan dalam malvari file biner, dan dienkripsi menggunakan cipher yang sama dengan file internal. <br><br><img src="https://habrastorage.org/webt/ih/al/gw/ihalgw7xzb35fahkfx9rcmr3_l0.png"><br><br><h4>  Tim pintu belakang </h4><br>  Lebih dari delapan puluh perintah backdoor menggunakan direktori kerja dan kunci registri untuk menyimpan hasil antara dan data konfigurasi.  Grafik dengan pintu belakang dalam juru bahasa ditunjukkan pada Gambar 8. <br><br>  Sekitar sepertiga dari semua perintah terkait dengan membaca dan memperbarui data konfigurasi yang disimpan dalam registri.  ID dan deskripsi perintah yang tersisa tercantum di bawah ini. <br><br>  4 - Buat daftar informasi file di direktori <br>  6 - Unduh file <br>  20 - Daftar proses aktif <br>  22 - Akhiri proses dengan ID <br>  24 - Jalankan file <br>  26 - Hapus file <br>  28 - Dapatkan Tabel Penerusan IP <br>  30 - Menulis data ke file <br>  31 - Tidak ada tindakan <br>  38 - Buat daftar akun <br>  40 - Buat daftar layanan dalam sistem <br>  42 - Buat daftar driver yang dimuat <br>  43 - Kumpulkan informasi sistem dasar (nama komputer, versi OS, status memori, waktu setempat, informasi disk, informasi tentang proxy yang dikonfigurasi, kebijakan pencegahan eksekusi data saat ini untuk sistem dan proses, dll.) <br>  44 - Buat daftar perangkat lunak yang diinstal <br>  46 - Daftar pengguna lokal dan informasi sesi <br>  48 - Buat daftar aplikasi yang digunakan oleh pengguna <br>  52 - Buat struktur direktori <br>  78 - Buat Remote Shell <br>  81 - Jalankan perintah melalui shell jarak jauh <br>  91 - Mengaktifkan / Menonaktifkan Kontrol Akun Pengguna <br>  93 - Sesi pengguna akhir / shut down / restart sistem <br>  101 - Lacak dan rekam perubahan ke direktori yang ditentukan <br>  103 - Hapus direktori <br>  109 - Nyalakan / matikan monitor / aktifkan siaga <br>  120 - Ambil tangkapan layar tampilan / jendela aktif <br>  126 - Ambil tangkapan layar tampilan / jendela aktif dan perbarui data konfigurasi <br>  130 - Daftar informasi sumber daya pada disk yang tidak terisi <br>  132 - Ubah nama / pindahkan file, ubah waktu pembuatan / pembukaan / penulisan file ke yang ditentukan <br>  134 - Daftar file yang baru dibuka <br>  152 - Putuskan sambungan (sebelumnya terhubung) drive yang dapat dilepas <br>  155 - Membuat / menghapus kunci registri, mengatur / menghapus nilai kunci registri, atau mendaftar nilai / kunci / data registri <br>  159, 161 - Matikan routing / firewall, buat server proxy pada port tertentu <br>  172 - Ulangi kotak dialog yang meminta untuk me-restart komputer <br>  175 - Lewati kontrol akun pengguna untuk manipulasi file <br>  177 - Membuat dan menulis file, mengatur data pada saat pembuatan / pembukaan / perubahan <br>  181 - Hapus semua titik pengembalian sistem <br>  183 - Reset komponen (sah) dari aplikasi WinRAR <br>  185 - Tambahkan file ke arsip yang dilindungi kata sandi (password = "12KsNh92Dwd") <br>  187 - Dekripsi, unzip dan muat DLL, muat file exe dari RC2CL, sumber daya RC2FM <br>  189 - Buat titik pemulihan sistem <br>  191 - Ekstrak arsip yang dilindungi kata sandi (12KsNh92Dwd) <br>  193 - Ubah file terenkripsi <br>  195 - Restart setelah selesainya proses utama <br>  197 - Kirim 198 byte data hard-kode dalam suatu pola <br>  199 - Ganti nama / pindahkan file <br>  206 - Dekripsi, unzip dan unduh DLL, muat file exe dari RC2CL, sumber daya RC2FM <br>  211 - Unduh informasi yang dikumpulkan (tangkapan layar, rekaman audio, dll.) <br>  213 - Buat daftar windows yang aktif <br>  218 - API untuk merekam audio dari perangkat input <br>  220 - API untuk mengambil foto dari webcam <br>  224 - Buat daftar file yang dijalankan pada setiap startup sistem <br>  226 - Buat daftar jaringan nirkabel yang diaktifkan (alamat MAC, SSID, interval pensinyalan) <br>  228 - Reset paket Zlib terkompresi <br><br><img src="https://habrastorage.org/webt/jf/og/gu/jfoggu3qvtsjumjvxt6etxex9mw.png"><br>  <i>Gambar 8. Fungsi backdoor di interpreter (asli dan dimodifikasi menggunakan fungsi Group Nodes di IDA Pro untuk keterbacaan)</i> <br><br><h2>  Kesimpulan </h2><br>  InvisiMole adalah perangkat lunak spyware berfitur lengkap yang menawarkan fitur luas yang dapat bersaing dengan alat spionase maya terkenal lainnya. <br><br>  Kita hanya bisa menebak mengapa penulis menggunakan dua modul dengan fungsi duplikat.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dapat diasumsikan bahwa modul yang lebih kecil ,, </font></font><code>RC2FM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">digunakan pada tahap pertama pengintaian, dan yang lebih besar, </font></font><code>RC2CL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berjalan hanya pada mesin yang menarik minat operator. </font><font style="vertical-align: inherit;">Namun tidak demikian - dua modul diluncurkan secara bersamaan. </font><font style="vertical-align: inherit;">Penjelasan kedua yang mungkin: modul-modul tersebut dirakit oleh penulis yang berbeda dan kemudian dikombinasikan untuk memberikan alat yang maksimal kepada operator. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvisiMole hanya menggunakan beberapa teknik untuk menghindari deteksi dan analisis. </font><font style="vertical-align: inherit;">Namun, karena spyware digunakan dalam serangan terhadap sejumlah kecil target berpangkat tinggi, dia berhasil menghindari deteksi setidaknya selama lima tahun.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Indikator Kompromi (IoC) </font></font></h2><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Deteksi ESET </font></font></h3><br> <code>Win32/InvisiMole.A trojan <br> Win32/InvisiMole.B trojan <br> Win32/InvisiMole.C trojan <br> Win32/InvisiMole.D trojan <br> Win64/InvisiMole.B trojan <br> Win64/InvisiMole.C trojan <br> Win64/InvisiMole.D trojan</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hash SHA-1 </font></font></h3><br> <code>5EE6E0410052029EAFA10D1669AE3AA04B508BF9 <br> 2FCC87AB226F4A1CC713B13A12421468C82CD586 <br> B6BA65A48FFEB800C29822265190B8EAEA3935B1 <br> C8C4B6BCB4B583BA69663EC3AED8E1E01F310F9F <br> A5A20BC333F22FD89C34A532680173CBCD287FF8</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nama Domain C &amp; C Server </font></font></h3><br> <code>activationstate.sytes[.]net <br> advstatecheck.sytes[.]net <br> akamai.sytes[.]net <br> statbfnl.sytes[.]net <br> updchecking.sytes[.]net</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alamat IP server C&amp;C dan periode aktivitas </font></font></h3><br> <code>2013-2014 - 46.165.231.85 <br> 2013-2014 - 213.239.220.41 <br> 2014-2017 - 46.165.241.129 <br> 2014-2016 - 46.165.241.153 <br> 2014-2018 - 78.46.35.74 <br> 2016-2016 - 95.215.111.109 <br> 2016-2018 - 185.118.66.163 <br> 2017-2017 - 185.118.67.233 <br> 2017-2018 - 185.156.173.92 <br> 2018-2018 - 46.165.230.241 <br> 2018-2018 - 194.187.249.157</code> <br> <br><h3>     </h3><br><h4> RC2FM </h4><br> <code>[HKEY_CURRENT_USER\Software\Microsoft\IE\Cache] <br> "Index"</code> <br> <br><h4> RC2CL </h4><br> <code>[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Console] <br> or [HKEY_CURRENT_USER\Software\Microsoft\Direct3D] <br> "Settings" <br> "Type" <br> [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\OLE] <br> or [HKEY_CURRENT_USER\Software\Microsoft\Direct3D] <br> "Common" <br> "Current" <br> "ENC" <br> "FFLT" <br> "Flag1" <br> "FlagLF" <br> "FlagLF2" <br> "IfData" <br> "INFO" <br> "InstallA" <br> "InstallB" <br> "LegacyImpersonationNumber" <br> "LM" <br> "MachineAccessStateData" <br> "MachineState 0" <br> "RPT" <br> "SP2" <br> "SP3" <br> "SettingsMC" <br> "SettingsSR1" <br> "SettingsSR2"</code> <br> <br><h3>    </h3><br><h4> RC2FM </h4><br> <code>%APPDATA%\Microsoft\Internet Explorer\Cache\AMB6HER8\ <br> %volumeSerialNumber%.dat <br> content.dat <br> cache.dat <br> index.dat <br> %APPDATA%\Microsoft\Internet Explorer\Cache\MX0ROSB1\ <br> content.dat <br> index.dat <br> %random%.%ext% <br> %APPDATA%\Microsoft\Internet Explorer\Cache\index0.dat</code> <br> <br><h4> RC2CL </h4><br> <code>Winrar\ <br> comment.txt <br> descript.ion <br> Default.SFX <br> WinRAR.exe <br> main.ico <br> fl_%timestamp%\strcn%num%\ <br> fdata.dat <br> index.dat <br> ~mrc_%random%.tmp <br> ~src_%random%.tmp <br> ~wbc_%random%.tmp <br> sc\~sc%random%.tmp <br> ~zlp\zdf_%random%.data <br> ~lcf\tfl_%random%</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id414419/">https://habr.com/ru/post/id414419/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id414405/index.html">Instal sertifikat di server HTTP Apache</a></li>
<li><a href="../id414411/index.html">Wiren Board 6: lagi di Habr√© dengan versi baru controller untuk otomatisasi</a></li>
<li><a href="../id414413/index.html">Sinopsis dan video cerita tentang jaringan di industri game dengan gamedev festival</a></li>
<li><a href="../id414415/index.html">Tarantool Conference 21 Juni - tidak hanya tentang Tarantool, tetapi secara umum tentang komputasi dalam memori</a></li>
<li><a href="../id414417/index.html">Acara digital di Moskow dari 18 hingga 24 Juni</a></li>
<li><a href="../id414423/index.html">Hari ini kami membawa sedekat mungkin ... Versi baru SBM 11.4 dirilis</a></li>
<li><a href="../id414425/index.html">Algoritma pengenalan pola pembelajaran sekali pakai</a></li>
<li><a href="../id414427/index.html">Apa yang bisa dilakukan oleh printer 3D? Laporan dari pembuat pameran Faire Bay Area 2018</a></li>
<li><a href="../id414429/index.html">Cara belajar bahasa asing tanpa guru. Bagian 1. "Pengalaman saya"</a></li>
<li><a href="../id414431/index.html">Mitap JavaJam. Javista berdebat, arung jeram, eksperimen dan layanan mikro</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>