<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úçÔ∏è üë©üèΩ‚Äçü§ù‚Äçüë®üèª üëàüèª Gu√≠a completa para configurar encabezados HTTP para seguridad üóëÔ∏è ü§Ωüèº üëø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Las empresas que venden cuadros de mandos de seguridad est√°n en aumento, su influencia en las ventas corporativas est√° creciendo. Adem√°s, hay quienes ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gu√≠a completa para configurar encabezados HTTP para seguridad</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/471746/"><p><img src="https://habrastorage.org/webt/df/rj/xf/dfrjxfp4ydkkf7al1royc4wnufs.jpeg"></p><br><p>  Las empresas que venden cuadros de mandos de seguridad est√°n en aumento, su influencia en las ventas corporativas est√° creciendo.  Adem√°s, hay quienes est√°n confundidos por la baja calificaci√≥n de seguridad de los vendedores, y aquellos que al menos una vez, al mirar la calificaci√≥n, se negaron a comprar, habl√© con esas personas. </p><br><p>  Observ√© c√≥mo estas compa√±√≠as calculan el desempe√±o de seguridad de otras compa√±√≠as.  Result√≥ que estaban buscando una combinaci√≥n de usar el encabezado HTTP por seguridad y la reputaci√≥n de las direcciones IP. </p><br><p>  La reputaci√≥n de una direcci√≥n IP se basa en la lista negra y los datos de la lista de spammers combinados con informaci√≥n sobre el propietario de la direcci√≥n IP p√∫blica.  En principio, deber√≠a estar limpio si su empresa no env√≠a spam y puede identificar r√°pidamente y detener la implementaci√≥n maliciosa.  El uso del encabezado de seguridad HTTP se calcula de la misma manera que funciona <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el Observatorio de Mozilla</a> . </p><br><p>  Por lo tanto, la calificaci√≥n de la mayor√≠a de las empresas est√° determinada principalmente por los t√≠tulos incluidos en los sitios web p√∫blicos para la seguridad. </p><a name="habracut"></a><br><p>  Establecer el t√≠tulo correctamente no es largo (no se requiere verificaci√≥n seria), pero mejorar√° la seguridad del sitio y ayudar√° a no perder clientes para quienes la seguridad no es una frase vac√≠a </p><br><p>  Dudo del valor de la metodolog√≠a de verificaci√≥n mencionada; adem√°s, el precio del servicio es exorbitante.  Es poco probable que los proveedores de este servicio puedan determinar la seguridad de un recurso con la precisi√≥n indicada.  Sin embargo, la situaci√≥n enfatiza una vez m√°s lo importante que es sentarse y tomarse el tiempo para encender y configurar los encabezados correctos. </p><br><p> En este art√≠culo hablar√© sobre los encabezados que se verifican con m√°s frecuencia, para cada uno de ellos informar√© los valores de seguridad y dar√© un ejemplo de configuraci√≥n.  Al final dar√© ejemplos de configuraciones para aplicaciones comunes y servidores web. </p><br><h2 id="vazhnye-zagolovki-dlya-bezopasnosti">  Cabeceras de seguridad importantes </h2><br><h3 id="content-security-policy">  Pol√≠tica de seguridad de contenido </h3><br><p>  CSP se utiliza para evitar la creaci√≥n de secuencias de comandos entre sitios, determinando qu√© recursos se pueden descargar.  De la lista completa, este encabezado tomar√° m√°s tiempo que el resto para crear y soportar adecuadamente, y a√∫n m√°s otros est√°n en riesgo.  Cuando desarrolle un CSP, verif√≠quelo cuidadosamente: si bloquea repentinamente la fuente que est√° utilizando, interrumpa la funcionalidad de su propio sitio. </p><br><p>  Para la versi√≥n preliminar, puede usar una herramienta maravillosa: una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">extensi√≥n para el navegador Mozilla, Laboratorio CSP</a> .  Inst√°lelo en un navegador, estudie cuidadosamente el sitio para el que desea crear un CSP y luego use el CSP generado en su sitio.  Idealmente, a√∫n necesita volver a trabajar JavaScript para poder eliminar la directiva insegura en l√≠nea. </p><br><p>  El CSP puede parecer complicado y confuso, por lo que si desea profundizar en el tema, visite el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sitio web oficial</a> . </p><br><p>  Puedes preconfigurar CSP de esta manera (en un sitio de combate, lo m√°s probable es que requiera muchas modificaciones).  Agregue dominios a cada secci√≥n de su sitio. </p><br><pre><code class="plaintext hljs"># Default to only allow content from the current site # Allow images from current site and imgur.com # Don't allow objects such as Flash and Java # Only allow scripts from the current site # Only allow styles from the current site # Only allow frames from the current site # Restrict URL's in the &lt;base&gt; tag to current site # Allow forms to submit only to the current site Content-Security-Policy: default-src 'self'; img-src 'self' https://i.imgur.com; object-src 'none'; script-src 'self'; style-src 'self'; frame-ancestors 'self'; base-uri 'self'; form-action 'self';</code> </pre> <br><h3 id="strict-transport-security">  Seguridad de transporte estricta </h3><br><p>  Este encabezado le dice al navegador que solo puede ingresar al sitio usando el protocolo HTTPS; siempre habil√≠telo si HTTPS est√° activado en su sitio.  Incl√∫yalo en todos los subdominios utilizados, si los hay. </p><br><pre> <code class="plaintext hljs">Strict-Transport-Security: max-age=3600; includeSubDomains</code> </pre> <br><h3 id="x-content-type-options">  Opciones de tipo de contenido X </h3><br><p>  Gracias a este encabezado, los navegadores se adhieren a los tipos MIME instalados por la aplicaci√≥n, lo que ayuda a prevenir algunos ataques de secuencias de comandos entre sitios. </p><br><p>  Tambi√©n reduce el riesgo de un comportamiento inesperado de la aplicaci√≥n cuando el navegador "adivina" incorrectamente el tipo de contenido en el sitio, por ejemplo, si el desarrollador designa una p√°gina "HTML" y el navegador ve JavaScript e intenta representar la p√°gina en consecuencia.  Adem√°s, gracias a este encabezado, el navegador siempre mantiene los tipos MIME instalados por el servidor. </p><br><pre> <code class="plaintext hljs">X-Content-Type-Options: nosniff</code> </pre> <br><h3 id="cache-control">  Control de cach√© </h3><br><p>  Este ser√° m√°s pobre que los dem√°s, porque para diferentes tipos de contenido probablemente necesite diferentes pol√≠ticas de almacenamiento en cach√©. </p><br><p>  No se debe almacenar en cach√© ninguna informaci√≥n confidencial, como la p√°gina de un usuario o la p√°gina de pago del producto.  Una de las razones de esto es que otro usuario de la computadora no presiona el bot√≥n Atr√°s, no lee el historial y no ve los datos personales de otro usuario. </p><br><p>  Sin embargo, puede y debe almacenar en cach√© aquellas p√°ginas que rara vez se actualizan, como los recursos est√°ticos (im√°genes, archivos CSS y JS).  El almacenamiento en cach√© se puede configurar p√°gina por p√°gina o utilizando expresiones regulares en la configuraci√≥n del servidor. </p><br><pre> <code class="plaintext hljs"># Don't cache by default Header set Cache-Control no-cache # Cache static assets for 1 day &lt;filesMatch ".(css|jpg|jpeg|png|gif|js|ico)$"&gt; Header set Cache-Control "max-age=86400, public" &lt;/filesMatch&gt;</code> </pre> <br><h3 id="expires">  Expira </h3><br><p>  Este encabezado establece el tiempo que la solicitud actual se almacena en cach√©.  Se ignora si el encabezado Cache-Control max-age est√° habilitado, por lo que solo lo habilitamos en caso de que un simple esc√°ner lo verifique, excluyendo los controles de almacenamiento en cach√©. </p><br><p>  Suponemos que, por razones de seguridad, el navegador no almacena nada en cach√©, por lo que la fecha en el encabezado siempre estar√° en el pasado. </p><br><pre> <code class="plaintext hljs">Expires: 0</code> </pre> <br><h3 id="x-frame-options">  Opciones de marco X </h3><br><p>  Este encabezado permite la visualizaci√≥n del sitio en un iFrame. </p><br><p>  Al colocar su sitio web en un iFrame, un recurso malicioso tiene la oportunidad de realizar un ataque de clickjacking, al lanzar alg√∫n tipo de JavaScript que enga√±a al usuario para que haga clic en el iFrame, y luego comienza a interactuar con el recurso desde su nombre de usuario (es decir, una persona hace clic en un enlace o bot√≥n malicioso) sin siquiera saberlo! </p><br><p>  Este encabezado siempre debe configurarse para fallar, con la excepci√≥n si usa marcos intencionalmente.  Entonces el encabezado debe establecerse en la misma fuente.  Si utiliza marcos con un sitio diferente de forma predeterminada, incluya en la lista blanca el dominio de terceros. </p><br><p>  Tambi√©n se debe tener en cuenta que este encabezado se reemplaza por la directiva CSP frame-ancestors.  Recomiendo encenderlo por ahora, pero solo para cerrar las herramientas para verificar los encabezados, lo m√°s probable es que lo eliminen en el futuro. </p><br><pre> <code class="plaintext hljs">X-Frame-Options: deny</code> </pre> <br><h3 id="access-control-allow-origin">  Acceso-Control-Permitir-Origen </h3><br><p>  Este encabezado le dice al navegador qu√© c√≥digo externo de qu√© sitios de terceros tiene derecho a realizar solicitudes a una p√°gina espec√≠fica.  La configuraci√≥n predeterminada suele ser correcta, pero puede cambiarla si es necesario. </p><br><p>  Por ejemplo, el sitio A contiene alg√∫n tipo de JavaScript que desea realizar una solicitud al sitio B. El sitio B debe responder a esta solicitud, si el encabezado permite que el sitio A realice una solicitud.  Si necesita configurar muchas fuentes, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">consulte los detalles en la p√°gina MDN</a> . </p><br><p>  Aqu√≠ puede confundirse un poco, as√≠ que hice un diagrama para ilustrar c√≥mo funciona este encabezado: </p><br><p><img src="https://habrastorage.org/webt/97/g9/iy/97g9iyhqou03xiinwuind3gqwbs.png"><br>  <em>Flujo de datos con acceso-control-permitir-origen</em> </p><br><pre> <code class="plaintext hljs">Access-Control-Allow-Origin: http://www.one.site.com</code> </pre> <br><h3 id="set-cookie">  Establecer cookie </h3><br><p>  Aseg√∫rese de que sus cookies est√©n configuradas solo a trav√©s del protocolo HTTPS (con encriptaci√≥n) y que no sean accesibles a trav√©s de JavaScript.  Estos archivos solo se pueden enviar si su sitio tambi√©n es compatible con HTTPS, como deber√≠a ser.  Siempre necesita establecer estas banderas: </p><br><ul><li>  Seguro </li><li>  HTTPOnly </li></ul><br><p>  Ejemplo de definici√≥n de cookie: </p><br><pre> <code class="plaintext hljs">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;; Secure; HttpOnly</code> </pre> <br><p>  Lea m√°s en la excelente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n de cookies de Mozilla</a> . </p><br><h3 id="x-xss-protection">  Protecci√≥n X-XSS </h3><br><p>  Este encabezado le dice al navegador que cancele los ataques de secuencias de comandos entre sitios detectados.  Al encenderlo, no se arriesga mucho, pero pru√©belo antes de lanzarlo al entorno de producci√≥n. </p><br><pre> <code class="plaintext hljs">X-XSS-Protection: 1; mode=block</code> </pre> <br><h3 id="primer-nastroek-veb-servera">  Ejemplo de configuraci√≥n del servidor web </h3><br><p>  En general, en la configuraci√≥n del servidor, es mejor agregar encabezados a todo el sitio.  Las cookies son una excepci√≥n, ya que se definen en la propia aplicaci√≥n. </p><br><p>  Le aconsejo que, antes de agregar encabezados al sitio, primero verifique con el Observatorio o mire manualmente los encabezados; verifique cu√°les ya est√°n instalados.  Algunos motores de sitios y servidores instalar√°n todo por su cuenta, as√≠ que solo implemente los encabezados que necesita o cambie los que lo necesitan. </p><br><h3 id="konfiguraciya-apache">  Configuraci√≥n de Apache </h3><br><p>  Ejemplo de configuraci√≥n de Apache en .htaccess: </p><br><pre> <code class="plaintext hljs">&lt;IfModule mod_headers.c&gt; ## CSP Header set Content-Security-Policy: default-src 'self'; img-src 'self' https://i.imgur.com; object-src 'none'; script-src 'self'; style-src 'self'; frame-ancestors 'self'; base-uri 'self'; form-action 'self'; ## General Security Headers Header set X-XSS-Protection: 1; mode=block Header set Access-Control-Allow-Origin: http://www.one.site.com Header set X-Frame-Options: deny Header set X-Content-Type-Options: nosniff Header set Strict-Transport-Security: max-age=3600; includeSubDomains ## Caching rules # Don't cache by default Header set Cache-Control no-cache Header set Expires: 0 # Cache static assets for 1 day &lt;filesMatch ".(ico|css|js|gif|jpeg|jpg|png|svg|woff|ttf|eot)$"&gt; Header set Cache-Control "max-age=86400, public" &lt;/filesMatch&gt; &lt;/IfModule&gt;</code> </pre> <br><h3 id="konfiguraciya-nginx">  Configuraci√≥n de Nginx </h3><br><pre> <code class="plaintext hljs">## CSP add_header Content-Security-Policy: default-src 'self'; img-src 'self' https://i.imgur.com; object-src 'none'; script-src 'self'; style-src 'self'; frame-ancestors 'self'; base-uri 'self'; form-action 'self'; ## General Security Headers add_header X-XSS-Protection: 1; mode=block; add_header Access-Control-Allow-Origin: http://www.one.site.com; add_header X-Frame-Options: deny; add_header X-Content-Type-Options: nosniff; add_header Strict-Transport-Security: max-age=3600; includeSubDomains; ## Caching rules # Don't cache by default add_header Cache-Control no-cache; add_header Expires: 0; # Cache static assets for 1 day location ~* \.(?:ico|css|js|gif|jpe?g|png|svg|woff|ttf|eot)$ { try_files $uri @rewriteapp; add_header Cache-Control "max-age=86400, public"; }</code> </pre> <br><h3 id="nastroyka-zagolovka-urovnya-prilozheniya">  Configuraci√≥n de encabezado de nivel de aplicaci√≥n </h3><br><p>  Si no tiene acceso al servidor web o los requisitos para configurar los encabezados son complejos, entonces probablemente tendr√° que configurarlos en la propia aplicaci√≥n.  Por lo general, para todo el sitio, esto se realiza mediante middleware o se basa en una configuraci√≥n √∫nica de encabezados para cada solicitud. </p><br><p>  Por brevedad, inclu√≠ solo un encabezado en cada ejemplo.  Agrega de la misma manera todo lo que se necesita. </p><br><p>  Nodo y expreso: </p><br><p>  Agregar ruta de montaje global: </p><br><pre> <code class="plaintext hljs">app.use(function(req, res, next) { res.header('X-XSS-Protection', 1; mode=block); next(); });</code> </pre> <br><h3 id="java-i-spring">  Java y primavera </h3><br><p>  Tengo poca experiencia con Spring, pero <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Baeldung</a> tiene una excelente gu√≠a para configurar encabezados en Spring. </p><br><h3 id="php">  Php </h3><br><p>  No estoy familiarizado con varios entornos PHP.  Busque middleware para consultas.  Para una sola solicitud, todo es simple. </p><br><pre> <code class="plaintext hljs">header("X-XSS-Protection: 1; mode=block");</code> </pre> <br><h3 id="python--django">  Python / Django </h3><br><p>  Django incluye <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">middleware de seguridad</a> personalizable que har√° todo esto por usted.  Act√≠valos primero. </p><br><p>  Las respuestas de algunas p√°ginas pueden interpretarse como un diccionario.  Django tiene una forma especial de trabajar con el almacenamiento en cach√©, y si desea configurar los encabezados de almacenamiento en cach√© de esta manera, debe familiarizarse con √©l. </p><br><pre> <code class="plaintext hljs">response = HttpResponse() response["X-XSS-Protection"] = "1; mode=block"</code> </pre> <br><h3 id="vyvody">  Conclusiones </h3><br><p>  La configuraci√≥n de encabezados es un proceso relativamente simple y r√°pido, pero aumenta el nivel de seguridad del sitio, en t√©rminos de protecci√≥n de datos, de secuencias de comandos entre sitios y clics. </p><br><p>  En el futuro, se proteger√° del fracaso de las transacciones, porque su calificaci√≥n de seguridad se mantendr√° en el nivel.  La pr√°ctica de evaluarlo en funci√≥n de los par√°metros que he examinado est√° ganando impulso, y me parece que su papel en los pr√≥ximos a√±os en el campo de las ventas solo aumentar√°. </p><br><p>  ¬°Av√≠seme si me perd√≠ alg√∫n titular importante! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/471746/">https://habr.com/ru/post/471746/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../471736/index.html">Sensor Ethernet sin contacto</a></li>
<li><a href="../471738/index.html">Una breve historia sobre c√≥mo la conveniencia a veces se dispara en la rodilla</a></li>
<li><a href="../471740/index.html">Servicio de cach√© inteligente basado en ZeroMQ y Tarantool</a></li>
<li><a href="../471742/index.html">Sberbank AI Journey. C√≥mo ense√±amos a una red neuronal a tomar un examen</a></li>
<li><a href="../471744/index.html">Tarantool Data Grid: arquitectura y caracter√≠sticas</a></li>
<li><a href="../471748/index.html">Optimizaci√≥n de farmacia: lo que hicimos con las matem√°ticas</a></li>
<li><a href="../471750/index.html">Gesti√≥n de acceso privilegiado como tarea prioritaria en seguridad de la informaci√≥n (por ejemplo, Fudo PAM)</a></li>
<li><a href="../471756/index.html">C√≥mo se inicia el servidor</a></li>
<li><a href="../471758/index.html">¬øC√≥mo traducir texto a un idioma diferente?</a></li>
<li><a href="../471760/index.html">Edward Snowden: El campo de batalla - Cifrado</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>