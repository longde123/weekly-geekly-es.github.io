<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëàüèæ üë©üèΩ‚Äçüéì üéÖüèæ Treffen Sie Ransomware Nemty von einer gef√§lschten PayPal-Website üè∞ üôå üßòüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im Netzwerk ist eine neue Nemty-Ransomware erschienen, die angeblich der Nachfolger von GrandCrab oder Buran ist. Sch√§dliche Software wird haupts√§chli...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Treffen Sie Ransomware Nemty von einer gef√§lschten PayPal-Website</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acronis/blog/471968/"> Im Netzwerk ist eine neue Nemty-Ransomware erschienen, die angeblich der Nachfolger von GrandCrab oder Buran ist.  Sch√§dliche Software wird haupts√§chlich von einer gef√§lschten PayPal-Site verbreitet und bietet eine Reihe interessanter Funktionen.  Details zum Betrieb dieser Ransomware - unter dem Schnitt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ad/322/52f/1ad32252f734b7c2f70ca706636719d4.jpg" alt="Bild"><br><a name="habracut"></a><br>  Die neue Nemty-Ransomware wurde am 7. September 2019 vom Benutzer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nao_sec</a> entdeckt.  Sch√§dliche Software wurde √ºber eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">als PayPal getarnte</a> Site verbreitet. Es besteht auch die M√∂glichkeit, dass Ransomware √ºber das Exploit-Kit RIG in einen Computer eindringt.  Die Angreifer entschieden sich f√ºr Social-Engineering-Methoden, um den Benutzer zu zwingen, die Datei cashback.exe auszuf√ºhren, die er angeblich von der PayPal-Website erh√§lt. Es ist auch merkw√ºrdig, dass Nemty den falschen Port f√ºr den lokalen Proxy-Dienst von Tor angegeben hat, wodurch verhindert wird, dass Malware Daten an den Server sendet.  Daher muss der Benutzer die verschl√ºsselten Dateien selbst in das Tor-Netzwerk hochladen, wenn er das L√∂segeld bezahlen und auf die Entschl√ºsselung durch die Angreifer warten m√∂chte. <br><br>  Einige interessante Fakten √ºber Nemty deuten darauf hin, dass es von denselben Personen oder Cyberkriminellen entwickelt wurde, die mit Buran und GrandCrab in Verbindung stehen. <br><br><ul><li>  Wie GandCrab hat Nemty ein Osterei - einen Link zu einem Foto des russischen Pr√§sidenten Wladimir Putin mit einem obsz√∂nen Witz.  Die alte GandCrab-Ransomware hatte ein Bild mit demselben Text. </li><li>  Sprachartefakte beider Programme weisen auf dieselben russischsprachigen Autoren hin. </li><li>  Dies ist der erste Verschl√ºsseler, der den 8092-Bit-RSA-Schl√ºssel verwendet.  Obwohl es keinen Sinn macht: Ein 1024-Bit-Schl√ºssel zum Schutz vor Hacking reicht aus. </li><li>  Wie Buran ist der Verschl√ºsseler in Object Pascal geschrieben und in Borland Delphi kompiliert. </li></ul><br><h3>  Statische Analyse </h3><br>  Die Ausf√ºhrung von Schadcode erfolgt in vier Schritten.  Der erste Schritt besteht darin, cashback.exe auszuf√ºhren, eine PE32-ausf√ºhrbare Datei unter MS Windows mit einer Gr√∂√üe von 1198936 Byte.  Der Code wurde in Visual C ++ geschrieben und am 14. Oktober 2013 kompiliert.  Es enth√§lt ein Archiv, das beim Start von cashback.exe automatisch entpackt wird.  Die Software verwendet die Cabinet.dll-Bibliothek und ihre Funktionen FDICreate (), FDIDestroy () und andere, um Dateien aus dem CAB-Archiv abzurufen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/942/09b/a38/94209ba38048a2ecc035eeeb84e3779e.png" alt="Bild"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/77a/2db/85d/77a2db85d1eec59dc707bbbf57e45d53.png" alt="Bild"></div><br>  SHA-256: A127323192ABED93AED53648D03CA84DE3B5B006B641033EB46A520B7A3C16FC <br><br>  Nach dem Entpacken des Archivs werden drei Dateien angezeigt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/460/969/886/460969886773b893df30da7d1b21f6d1.png" alt="Bild"></div><br>  Als N√§chstes wird temp.exe gestartet, eine PE32-ausf√ºhrbare Datei unter MS Windows mit einer Gr√∂√üe von 307200 Byte.  Der Code ist in Visual C ++ geschrieben und wird vom MPRESS-Packer gepackt, einem UPX-√§hnlichen Packer. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b0e/f3f/a7c/b0ef3fa7c3226b0fa4f87867e994c742.png" alt="Bild"></div><br>  SHA-256: EBDBA4B1D1DE65A1C6B14012B674E7FA7F8C5F5A8A5A2A9C3C338F02DD726AAD <br><br>  Der n√§chste Schritt ist ironman.exe.  Nach dem Ausf√ºhren von temp.exe werden die eingebetteten Daten in temp entschl√ºsselt und in ironman.exe umbenannt, eine PE32-ausf√ºhrbare Datei mit einer Gr√∂√üe von 544768 Byte.  Code in Borland Delphi zusammengestellt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f27/524/300/f27524300e0dbb36c826870281dce049.png" alt="Bild"></div><br>  SHA-256: 2C41B93ADD9AC5080A12BF93966470F8AB3BDE003001492A10F63758867F2A88 <br><br>  Der letzte Schritt besteht darin, die Datei ironman.exe neu zu starten.  Zur Laufzeit konvertiert es seinen Code und f√ºhrt sich selbst aus dem Speicher aus.  Diese Version von ironman.exe ist b√∂sartig und f√ºr die Verschl√ºsselung verantwortlich. <br><br><h3>  Angriffsvektor </h3><br>  Derzeit wird Nemty Ransomware √ºber pp-back.info vertrieben. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7e3/6f2/369/7e36f236961bc0a666d5f0181cf2c509.png" alt="Bild"><br><br>  Die vollst√§ndige Infektionskette kann auf der Sandbox <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">app.any.run</a> eingesehen werden. <br><br><h3>  Installation </h3><br>  Cashback.exe - der Beginn des Angriffs.  Wie bereits erw√§hnt, entpackt cashback.exe die darin enthaltene CAB-Datei.  Anschlie√üend erstellt er einen Ordner TMP4351 $ .TMP in der Form% TEMP% \ IXxxx.TMP, wobei xxx eine Zahl von 001 bis 999 ist. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df8/42f/1ea/df842f1eabffae6ee11679ef588029b5.png" alt="Bild"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b9/fc3/f1e/6b9fc3f1e6a5aa7e33ea27276884e5c9.png" alt="Bild"></div><br>  Als n√§chstes wird ein Registrierungsschl√ºssel installiert, der folgenderma√üen aussieht: <br><br>  [HKLM \ SOFTWARE \ WOW6432Node \ Microsoft \ Windows \ CurrentVersion \ RunOnce \ wextract_cleanup0] <br>  "Rundll32.exe" "C: \ Windows \ system32 \ advpack.dll, DelNodeRunDLL32" C: \ Benutzer \ MALWAR ~ 1 \ AppData \ Local \ Temp \ IXPxxx.TMP \ "" <br><br>  Es wird verwendet, um entpackte Dateien zu l√∂schen.  Schlie√ülich startet cashback.exe den Prozess temp.exe. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b5e/3fc/25e/b5e3fc25e123fa6e703a3a4cfd9aa2ca.png" alt="Bild"></div><br>  Temp.exe - die zweite Stufe in der Infektionskette <br><br>  Dies ist der Prozess, der von cashback.exe gestartet wird, dem zweiten Schritt bei der Ausf√ºhrung des Virus.  Er versucht, AutoHotKey - ein Tool zum Ausf√ºhren von Skripten unter Windows - herunterzuladen und das Skript WindowSpy.ahk auszuf√ºhren, das sich im Ressourcenbereich der PE-Datei befindet. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4e3/e59/2cc/4e3e592cc9982dc634ea9e640f043414.png" alt="Bild"></div><br>  Das Skript WindowSpy.ahk entschl√ºsselt die tempor√§re Datei in ironman.exe mithilfe des RC4-Algorithmus und des IwantAcake-Kennworts.  Der Schl√ºssel aus dem Passwort wird mit dem MD5-Hash-Algorithmus abgerufen. <br><br>  Dann ruft temp.exe den Prozess ironman.exe auf. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cea/d24/0c7/cead240c70b478ec5aaca50747345292.png" alt="Bild"></div><br>  Ironman.exe - der dritte Schritt <br><br>  Ironman.exe liest den Inhalt der Datei iron.bmp und erstellt eine iron.txt-Datei mit einem Crypto-Locker, die wie folgt beginnt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/804/ea2/6e1/804ea26e1e809deeaad2de358dc28bcc.png" alt="Bild"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/775/320/a3e/775320a3e91acf2399d1862398ea35e2.png" alt="Bild"></div><br>  Danach l√§dt der Virus iron.txt in den Speicher und startet ihn als ironman.exe neu.  Danach wird iron.txt gel√∂scht. <br><br>  ironman.exe ist der Hauptteil der NEMTY-Ransomware, die Dateien auf dem betroffenen Computer verschl√ºsselt.  Sch√§dliche Software erzeugt einen Mutex namens Hass. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/082/939/daf/082939dafc9172d0b4a7336fd21465a6.png" alt="Bild"></div><br>  Zun√§chst bestimmt er den geografischen Standort des Computers.  Nemty √∂ffnet einen Browser und erkennt die IP unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://api.ipify.org</a> .  Auf der Website <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">api.db-ip.com/v2/free</a> [IP] / countryName wird das Land durch die empfangene IP bestimmt. Befindet sich der Computer in einer der unten aufgef√ºhrten Regionen, wird die Ausf√ºhrung des Malware-Codes gestoppt: <br><br><ul><li>  Russland </li><li>  Wei√ürussland </li><li>  Ukraine </li><li>  Kasachstan </li><li>  Tadschikistan </li></ul><br>  H√∂chstwahrscheinlich m√∂chten die Entwickler die Aufmerksamkeit der Strafverfolgungsbeh√∂rden in ihren Wohnsitzl√§ndern nicht auf sich ziehen und verschl√ºsseln daher keine Dateien in ihren "einheimischen" Gerichtsbarkeiten. <br><br>  Wenn die IP-Adresse des Opfers nicht zur obigen Liste geh√∂rt, verschl√ºsselt der Virus die Benutzerinformationen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/03a/c78/50e/03ac7850eab9fb3b8e382d05ea915e17.png" alt="Bild"><br><br>  Um die Wiederherstellung von Dateien zu verhindern, werden ihre Schattenkopien gel√∂scht: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1b7/b6f/c49/1b7b6fc49ef43257feeac39926f2555d.png" alt="Bild"></div><br>  Anschlie√üend wird eine Liste der Dateien und Ordner erstellt, die nicht verschl√ºsselt werden, sowie eine Liste der Dateierweiterungen. <br><br><ul><li>  Fenster </li><li>  $ RECYCLE.BIN </li><li>  rsa </li><li>  NTDETECT.COM </li><li>  ntldr </li><li>  MSDOS.SYS </li><li>  IO.SYS </li><li>  boot.ini AUTOEXEC.BAT ntuser.dat </li><li>  desktop.ini </li><li>  CONFIG.SYS </li><li>  BOOTSECT.BAK </li><li>  bootmgr </li><li>  Programmdaten </li><li>  appdata </li><li>  osoft </li><li>  Gemeinsame Dateien </li></ul><br><pre><code class="plaintext hljs">log LOG CAB cab CMD cmd COM com cpl CPL exe EXE ini INI dll DDL lnk LNK url URL ttf TTF DECRYPT.txt NEMTY</code> </pre> <br><h3>  Verschleierung </h3><br>  Um URLs und eingebettete Konfigurationsdaten auszublenden, verwendet Nemty einen Base64- und RC4-Codierungsalgorithmus mit dem Schl√ºsselwort fuckav. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b7a/cbe/422/b7acbe422f5f388d9a30a7c6e154186d.png" alt="Bild"></div><br>  Der Entschl√ºsselungsprozess mit CryptStringToBinary ist wie folgt <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4e4/f54/2bc/4e4f542bca33b2fbf95105f270ad264e.png" alt="Bild"></div><br><h3>  Verschl√ºsselung </h3><br>  Nemty verwendet eine dreischichtige Verschl√ºsselung: <br><br><ul><li>  AES-128-CBC f√ºr Dateien.  Ein 128-Bit-AES-Schl√ºssel wird zuf√§llig generiert und f√ºr alle Dateien gleich verwendet.  Es wird in der Konfigurationsdatei auf dem Computer des Benutzers gespeichert.  IV wird zuf√§llig f√ºr jede Datei generiert und in einer verschl√ºsselten Datei gespeichert. </li><li>  RSA-2048 f√ºr Dateiverschl√ºsselung IV.  F√ºr die Sitzung wird ein Schl√ºsselpaar generiert.  Der private Schl√ºssel f√ºr die Sitzung wird in der Konfigurationsdatei auf dem Computer des Benutzers gespeichert. </li><li>  RSA-8192.  Der √∂ffentliche Hauptschl√ºssel ist in das Programm integriert und wird zum Verschl√ºsseln der Konfigurationsdatei verwendet, in der der AES-Schl√ºssel und der geheime Schl√ºssel f√ºr die RSA-2048-Sitzung gespeichert sind. </li><li>  Nemty generiert zuerst 32 Bytes zuf√§lliger Daten.  Die ersten 16 Bytes werden als AES-128-CBC-Schl√ºssel verwendet. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0f1/83b/f33/0f183bf33f1d420b6f978322fc60a7e6.png" alt="Bild"></div><br>  Der zweite Verschl√ºsselungsalgorithmus ist RSA-2048.  Das Schl√ºsselpaar wird von der Funktion CryptGenKey () generiert und von der Funktion CryptImportKey () importiert. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ecd/b48/535/ecdb48535873a4cad5215173d8145588.png" alt="Bild"></div><br>  Nachdem das Schl√ºsselpaar f√ºr die Sitzung generiert wurde, wird der √∂ffentliche Schl√ºssel in den MS Cryptographic Service Provider importiert. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/011/ec6/078/011ec6078fcf2900c79320879ab53e77.png" alt="Bild"></div><br>  Ein Beispiel f√ºr einen generierten √∂ffentlichen Schl√ºssel f√ºr eine Sitzung: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff2/578/c1c/ff2578c1cb5d94f58bfcd2ef1b7830e8.png" alt="Bild"></div><br>  Als n√§chstes wird der private Schl√ºssel in den CSP importiert. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0a8/5d5/d0d/0a85d5d0db5188e243fdc27136a9cbee.png" alt="Bild"></div><br>  Ein Beispiel f√ºr einen generierten privaten Schl√ºssel f√ºr eine Sitzung: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/efe/54c/4b3/efe54c4b3a9314a8fa2d871d44c09ca6.png" alt="Bild"></div><br>  Und der letzte ist der RSA-8192.  Der √∂ffentliche Hauptschl√ºssel wird in verschl√ºsselter Form (Base64 + RC4) im Abschnitt .data der PE-Datei gespeichert. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ac/8df/55b/1ac8df55bcd053ecb2a8ae74b3aea402.png" alt="Bild"></div><br>  Der RSA-8192-Schl√ºssel nach dem Dekodieren von base64 und dem Entschl√ºsseln von RC4 mit dem Passwort fuckav sieht folgenderma√üen aus. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/28f/391/52a/28f39152afd386a8d167a45b1acb1e0b.png" alt="Bild"></div><br>  Infolgedessen ist der gesamte Verschl√ºsselungsprozess wie folgt: <br><br><ul><li>  Generierung eines 128-Bit-AES-Schl√ºssels, mit dem alle Dateien verschl√ºsselt werden. </li><li>  Erstellen Sie IV f√ºr jede Datei. </li><li>  Erstellen eines Schl√ºsselpaars f√ºr eine RSA-2048-Sitzung. </li><li>  Entschl√ºsselung eines vorhandenen RSA-8192-Schl√ºssels mit base64 und RC4. </li><li>  Verschl√ºsseln Sie den Dateiinhalt mit dem AES-128-CBC-Algorithmus ab dem ersten Schritt. </li><li>  Verschl√ºsselung IV mit dem √∂ffentlichen Schl√ºssel RSA-2048 und Codierung in base64. </li><li>  Hinzuf√ºgen von verschl√ºsselter IV am Ende jeder verschl√ºsselten Datei. </li><li>  Hinzuf√ºgen des AES-Schl√ºssels und des privaten RSA-2048-Sitzungsschl√ºssels zur Konfiguration. </li><li>  Die im Abschnitt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sammeln von Informationen</a> √ºber einen infizierten Computer beschriebenen Konfigurationsdaten werden mit dem √∂ffentlichen Prim√§rschl√ºssel RSA-8192 verschl√ºsselt. </li><li>  Die verschl√ºsselte Datei lautet wie folgt: </li></ul><br>  Beispiel f√ºr verschl√ºsselte Dateien: <br><br><h3>  Sammeln von Informationen √ºber einen infizierten Computer </h3><br>  Die Ransomware sammelt Schl√ºssel zum Entschl√ºsseln infizierter Dateien, sodass ein Angreifer tats√§chlich einen Entschl√ºsseler erstellen kann.  Dar√ºber hinaus sammelt Nemty Benutzerdaten wie Benutzername, Computername und Hardwareprofil. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/54e/bce/cef/54ebcecef4b2b83158b96286067c2749.png" alt="Bild"></div><br>  Es ruft die Funktionen GetLogicalDrives (), GetFreeSpace () und GetDriveType () auf, um Informationen √ºber die Festplatten des infizierten Computers zu sammeln. <br><br>  Die gesammelten Informationen werden in einer Konfigurationsdatei gespeichert.  Nachdem wir die Zeile dekodiert haben, erhalten wir eine Liste der Parameter in der Konfigurationsdatei: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ea8/9a6/ce1/ea89a6ce141ae197211e4777230d77d4.png" alt="Bild"></div><br>  Beispielkonfiguration eines infizierten Computers: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ea8/9a6/ce1/ea89a6ce141ae197211e4777230d77d4.png" alt="Bild"></div><br>  Die Konfigurationsvorlage kann wie folgt dargestellt werden: <br><br>  {"Allgemein": {"IP": "[IP]", "Land": "[Land]", "Computername": "[Computername]", "Benutzername": "[Benutzername]", "Betriebssystem": "[OS]", "isRU": false, "version": "1.4", "CompID": "{[CompID]}", "FileID": "_ NEMTY_ [FileID] _", "UserID": "[ UserID] "," key ":" [key] "," pr_key ":" [pr_key] <br><br>  Nemty speichert die gesammelten Daten im JSON-Format in der Datei% USER% / _ NEMTY_.nemty.  Eine Datei-ID mit einer L√§nge von 7 Zeichen wird zuf√§llig generiert.  Zum Beispiel: _NEMTY_tgdLYrd_.nemty.  Die Datei-ID wird auch an das Ende der verschl√ºsselten Datei angeh√§ngt. <br><br><h3>  Abschottungsnachricht </h3><br>  Nach dem Verschl√ºsseln der Dateien auf dem Desktop wird die Datei _NEMTY_ [FileID] -DECRYPT.txt wie folgt angezeigt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f68/286/0fc/f682860fc423590dd6c46d41f130277c.png" alt="Bild"></div><br>  Am Ende der Datei befinden sich verschl√ºsselte Informationen √ºber den infizierten Computer. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/397/233/cca/397233cca003e199f312bbc2ce79e197.png" alt="Bild"></div><br><h3>  Netzwerkkommunikation </h3><br>  Der Prozess ironman.exe l√§dt die Tor-Browser-Distribution von der Adresse <a href="">https://dist.torproject.org/torbrowser/8.5.4/tor-win32-0.4.0.5.zip</a> herunter und versucht, sie zu installieren. <br><br>  Nemty versucht dann, Konfigurationsdaten an 127.0.0.1:9050 zu senden, wo erwartet wird, dass ein funktionierender Tor-Browser-Proxy gefunden wird.  Standardm√§√üig √ºberwacht der Tor-Proxy jedoch Port 9150, und Port 9050 verwendet den Tor-Daemon unter Linux oder das Expert Bundle unter Windows.  Daher werden keine Daten an den Angreifer-Server gesendet.  Stattdessen kann der Benutzer die Konfigurationsdatei manuell herunterladen, indem er den Tor-Entschl√ºsselungsdienst unter dem in der L√∂segeldnachricht angegebenen Link aufruft. <br><br>  Verbindung zum Tor-Proxy: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e1f/349/300/e1f349300c72c9a760a69fa63c182893.png" alt="Bild"><br><img src="https://habrastorage.org/getpro/habr/post_images/cea/9a2/e8d/cea9a2e8d5a6571c9e95f183861c4277.png" alt="Bild"><br><br>  HTTP GET erstellt eine Anforderung unter 127.0.0.1:9050/public/gate?data= <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6f7/884/d28/6f7884d28aa6b3e769a3d4a460320b80.png" alt="Bild"></div><br>  Hier sehen Sie die offenen TCP-Ports, die vom TORlocal-Proxy verwendet werden: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5e9/394/d26/5e9394d265cb6403add24b040aa2569d.png" alt="Bild"></div><br>  Nemty-Entschl√ºsselungsdienst im Tor-Netzwerk: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/597/303/351/59730335151d25d50e8065a9f7252e0a.png" alt="Bild"></div><br>  Sie k√∂nnen ein verschl√ºsseltes Foto (jpg, png, bmp) hochladen, um den Entschl√ºsselungsdienst zu testen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/597/303/351/59730335151d25d50e8065a9f7252e0a.png" alt="Bild"></div><br>  Danach fordert der Angreifer ein L√∂segeld.  Bei Nichtzahlung verdoppelt sich der Preis. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/009/6a4/633/0096a46333473867e25380350c54d4a2.png" alt="Bild"></div><br><h3>  Fazit </h3><br>  Derzeit ist es nicht m√∂glich, von Nemty verschl√ºsselte Dateien zu entschl√ºsseln, ohne ein L√∂segeld zu zahlen.  Diese Version von Ransomware hat √Ñhnlichkeiten mit Buran Ransomware und Legacy GandCrab: Kompilierung auf Borland Delphi und Bildern mit demselben Text.  Dar√ºber hinaus ist dies der erste Verschl√ºsseler, der den 8092-Bit-RSA-Schl√ºssel verwendet, was wiederum keinen Sinn ergibt, da ein 1024-Bit-Schl√ºssel f√ºr den Schutz v√∂llig ausreichend ist.  Schlie√ülich versucht er seltsamerweise, den falschen Port f√ºr Tors lokalen Proxy-Service zu verwenden. <br><br>  Mit den L√∂sungen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Acronis Backup</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Acronis True Image</a> kann Nemty Ransomware jedoch keine Benutzer-PCs und -Daten verwenden, und Anbieter k√∂nnen ihre Kunden mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Acronis Backup Cloud</a> sch√ºtzen.  Full <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cyber ‚Äã‚ÄãDefense</a> bietet nicht nur Backups, sondern auch Schutz mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Acronis Active Protection</a> , einer speziellen Technologie, die auf k√ºnstlicher Intelligenz und Verhaltensheuristiken basiert und selbst unbekannte Malware neutralisieren kann. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de471968/">https://habr.com/ru/post/de471968/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de471956/index.html">Animiertes Zustandsdiagramm</a></li>
<li><a href="../de471958/index.html">Amazon EX Windows in GA mit Fehlern, aber schneller als jeder andere</a></li>
<li><a href="../de471960/index.html">Operation TA505, Teil 2: Erlernen der ServHelper-Hintert√ºr mit NetSupport RAT</a></li>
<li><a href="../de471962/index.html">Aufstieg des Orakels</a></li>
<li><a href="../de471964/index.html">Orakel kommen zur Rettung</a></li>
<li><a href="../de471974/index.html">Wie zwei Kapit√§ne zu Gener√§len wurden: wei√ü und rot</a></li>
<li><a href="../de471976/index.html">Wie bekommt ein IT-Spezialist einen Job im Ausland?</a></li>
<li><a href="../de471978/index.html">Wir k√∂nnen KI-Systemen nicht vertrauen, die allein auf tiefem Lernen basieren</a></li>
<li><a href="../de471980/index.html">Telefonbetr√ºger. Vierter Akt, Finale ...</a></li>
<li><a href="../de471982/index.html">Die Zukunft von PHP diskutieren</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>