<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🆚 👩🏾‍🤝‍👩🏼 👨🏼‍💻 RESS - Nova arquitetura para aplicativos móveis 👵🏻 💚 🚡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ao contrário do título provocativo, essa não é uma arquitetura nova, mas uma tentativa de traduzir práticas simples e testadas pelo tempo no Newspeak,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>RESS - Nova arquitetura para aplicativos móveis</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424081/"><img src="https://habrastorage.org/webt/l5/ii/jr/l5iijromy0mesbjmvf1wqqn9bvc.png"><br><br><blockquote>  Ao contrário do título provocativo, essa não é uma arquitetura nova, mas uma tentativa de traduzir práticas simples e testadas pelo tempo no Newspeak, falado pela moderna comunidade Android </blockquote><h2>  1. Introdução </h2><br>  Recentemente, tornou-se doloroso observar o que está acontecendo no mundo do desenvolvimento de plataformas móveis.  A astronáutica arquitetônica está prosperando, cada hipster considera seu dever criar uma nova arquitetura e resolver uma tarefa simples, em vez de duas linhas, inserir várias estruturas da moda. <br><br>  Esses sites preencheram tutoriais sobre estruturas modernas e arquiteturas sofisticadas, mas não existe uma prática recomendada para os clientes REST do Android.  Embora este seja um dos casos de aplicação mais frequentes.  Quero que a abordagem normal do desenvolvimento também vá para as massas.  Portanto, estou escrevendo este artigo <br><a name="habracut"></a><br><h2>  Por que as soluções existentes são ruins? </h2><br>  Em geral, o problema do MVP, VIPER e outros semelhantes, é exatamente o mesmo, seus autores não sabem como projetar.  E seus seguidores - ainda mais.  E, portanto, eles não entendem coisas importantes e óbvias.  E eles estão envolvidos em <b>excesso de engenharia</b> convencional. <br><br><h4>  1. A arquitetura deve ser simples </h4><br>  Quanto mais simples, melhor.  Isso facilita a compreensão, é mais confiável e mais flexível.  Qualquer tolo pode se complicar e fazer um monte de abstrações, mas, para simplificar, é preciso pensar com cuidado. <br><br><h4>  2. O excesso de engenharia é ruim </h4><br>  Você precisa adicionar um novo nível de abstração apenas quando o antigo não resolve problemas.  Depois de adicionar um novo nível, o sistema deve se tornar <i>mais fácil</i> de entender e com <i>menos</i> código.  Se, por exemplo, depois disso, você tinha três em vez de um arquivo, e o sistema ficou mais complicado, você cometeu um erro e, de uma maneira simples, <i>escreveu lixo</i> . <br><br>  Os fãs do MVP, por exemplo, em seus artigos escrevem em texto simples que o MVP estupidamente leva a uma <i>complicação</i> significativa <i>do</i> sistema.  E eles justificam isso pelo fato de ser tão <i>flexível</i> e <i>fácil de manter</i> .  Mas, como sabemos do parágrafo número 1, essas são coisas mutuamente exclusivas. <br><br>  Agora, sobre o VIPER, basta olhar, por exemplo, o diagrama <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">deste</a> artigo. <br><br><div class="spoiler">  <b class="spoiler_title">Esquema</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hq/zy/cf/hqzycfexvow0y3tvihtwgqllz-u.jpeg" alt="imagem"><br></div></div><br>  E isso é para todas as telas!  Isso machuca meus olhos.  Eu particularmente simpatizo com aqueles que no trabalho têm que lidar com isso contra sua vontade.  Para aqueles que o apresentaram, simpatizo com razões <i>ligeiramente diferentes</i> . <br><br><h2>  Nova abordagem </h2><br>  <i>Ei, eu também quero um nome na moda</i> .  Portanto, a arquitetura proposta é chamada de <b>RESS</b> - <b>R</b> equest, <b>E</b> vent, Sreen, <b>S</b> torage.  As letras e os nomes são detalhados de maneira estúpida para obter uma palavra legível.  Bem, para não criar confusão com os nomes já usados.  Bem, com o REST em sintonia. <br><br>  Faça uma reserva imediatamente, essa arquitetura é para clientes REST.  Para outros tipos de aplicativos, provavelmente não funcionará. <br><br><img src="https://habrastorage.org/webt/ub/vd/jz/ubvdjz6pzobholewp2ecloxgski.png"><br><br><h3>  1. Armazenamento </h3><br>  Data Warehouse (em outros termos, Modelo, Repositório).  Essa classe armazena dados e os processa (salva, carrega, adiciona ao banco de dados, etc.), bem como todos os dados do serviço REST chegam aqui, analisados ​​e armazenados aqui. <br><br><h3>  2. Tela </h3><br>  A tela do aplicativo, no caso do Android, é sua Atividade.  Em outros termos, é um ViewController regular como o MVC da Apple. <br><br><h3>  3. Pedido </h3><br>  A classe responsável por enviar solicitações ao serviço REST, além de receber respostas e notificar sobre a resposta de outros componentes do sistema. <br><br><h3>  4. Evento </h3><br>  O link entre os outros componentes.  Por exemplo, a Solicitação envia um evento sobre a resposta do servidor para aqueles que se inscrevem.  E o Storage envia um evento sobre alterações de dados. <br><br>  A seguir, é apresentado um exemplo de implementação simplificada.  O código foi escrito com suposições e não foi verificado, portanto, pode haver erros de sintaxe e erros de digitação <br><br><div class="spoiler">  <b class="spoiler_title">Pedido</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Request</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RequestListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">default</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onApiMethod1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Json answer)</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">default</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onApiMethod2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Json answer)</span></span></span><span class="hljs-function"> </span></span>{} } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RequestTask</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AsyncTask</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestTask</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String methodName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.methodName = methodName; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String methodName; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doInBackground</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Void ... params)</span></span></span><span class="hljs-function"> </span></span>{ URL url = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URL(Request.serverUrl + <span class="hljs-string"><span class="hljs-string">"/"</span></span> + methodName); HttpURLConnection httpConnection = (HttpURLConnection)url.openConnection(); <span class="hljs-comment"><span class="hljs-comment">// ... //      // ... return result; } @Override protected void onPostExecute(String result) { // ... //  JSON  result // ... Requestr.onHandleAnswer(methodName, json); } } private static String serverUrl = "myserver.com"; private static List&lt;OnCompleteListener&gt; listeners = new ArrayList&lt;&gt;(); private static void onHandleAnswer(String methodName, Json json) { for(RequestListener listener : listeners) { if(methodName.equals("api/method1")) listener.onApiMethod1(json); else if(methodName.equals("api/method2")) listener.onApiMethod2(json); } } private static void makeRequest(String methodName) { new RequestTask(methodName).executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR); } public static void registerListener(RequestListener listener) { listeners.add(listener); } public static void unregisterListener(RequestListener listener) { listeners.remove(listener); } public static void apiMethod1() { makeRequest("api/method1"); } public static void onApiMethod2() { makeRequest("api/method2"); } }</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Armazenamento</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataStorage</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">default</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onData1Changed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">default</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onData2Changed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> MyObject1 myObject1 = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> List&lt;MyObject2&gt; myObjects2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerListener</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DataListener listener)</span></span></span><span class="hljs-function"> </span></span>{ listeners.add(listener); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unregisterListener</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DataListener listener)</span></span></span><span class="hljs-function"> </span></span>{ listeners.remove(listener); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMyObject1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> myObject1; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> List&lt;MyObject2&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMyObjects2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> myObjects2; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Request.RequestListener listener = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Request.RequestListener() { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> T fromJson&lt;T&gt;(Json answer) { <span class="hljs-comment"><span class="hljs-comment">// ... //    JSON // ... return objectT; } @Override public void onApiMethod1(Json answer) { myObject1 = fromJson(answer); for(RequestListener listener : listeners) listener.data1Changed(); } @Override public void onApiMethod2(Json answer) { myObject2 = fromJson(myObjects2); for(RequestListener listener : listeners) listener.data2Changed(); } }; }</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Ecrã</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataStorage</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button button1; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button button2; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); button1.setOnClickListener((View) -&gt; { Request.apiMethod1(); }); button2.setOnClickListener((View) -&gt; { Request.apiMethod2(); }); updateViews(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onPause</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onPause(); DataStorage.unregisterListener(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResume</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onResume(); DataStorage.registerListener(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); updateViews(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateViews</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ updateView1(); updateView2(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateView1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Object1 data = DataStorage.getObject1(); <span class="hljs-comment"><span class="hljs-comment">// ... //     // ... } private void updateView2() { List&lt;Object2&gt; data = DataStorage.getObjects2(); // ... //     // ... } @Override public void onData1Changed() { updateView1(); } @Override public void onData2Changed() { updateView2(); } }</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">O aplicativo</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyApp</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(); Request.registerListener(DataStorage.listener); } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">O mesmo shemka, mas em termos de RESS, para entender</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/4o/g-/rz/4og-rzew3vn1ggqdykmdxgzsnx0.png"><br></div></div><br>  Funciona assim: Quando você clica no botão, o método desejado para Solicitação está se contraindo, a Solicitação envia uma solicitação ao servidor, processa a resposta e notifica o DataStorage primeiro.  DataStorage analisa a resposta e armazena em cache os dados em casa.  A solicitação notifica a tela ativa no momento, a tela pega os dados do DataStorage e atualiza a interface do usuário. <br><br>  Sinais de tela e cancelamentos de inscrição de mediocridade em onResume e onPause, respectivamente.  Ele também atualiza a interface do usuário, além do onResume.  O que isso dá?  As notificações vêm apenas na Atividade ativa atual, sem problemas com o processamento da solicitação em segundo plano ou com a ativação da Atividade.  A atividade estará sempre atualizada.  A notificação não alcançará a atividade em segundo plano e, ao retornar ao estado ativo, os dados serão obtidos do DataStorage.  Como resultado, não há problemas ao girar a tela e recriar a atividade. <br><br>  E por tudo isso, a API padrão do SDK do Android é suficiente. <br><br><h2>  Perguntas e respostas para críticas futuras </h2><br><h4>  1. Qual é o lucro? </h4><br>  Simplicidade real, flexibilidade, capacidade de manutenção, escalabilidade e um mínimo de dependências.  Você sempre pode complicar uma certa parte do sistema, se precisar.  Muitos dados?  Quebre delicadamente o DataStorage em vários.  API REST de serviço enorme?  Faça alguns pedidos.  Listering é muito simples, desajeitado e fora de moda?  Pegue o EventBus.  Olhando de soslaio para uma barbearia no HttpConnection?  Bem, faça o Retrofit.  Atividade ousada com um monte de fragmentos?  Apenas considere que cada fragmento é Screen ou divida-o em subclasses. <br><br><h4>  2. O AsyncTask é um homem mau, faça pelo menos o Retrofit! </h4><br>  Hein?  E que problemas isso causa neste código?  Vazamentos de memória?  Não, aqui o AsyncTask não armazena links para ativações, mas apenas um link para um método estático.  A resposta está perdida?  Não, a resposta sempre vem para o DataStorage estático até que o aplicativo seja morto.  Tentando atualizar a atividade em pausa?  Não, as notificações só vêm na Atividade ativa. <br><br>  E como o Retrofit pode ajudar aqui?  Apenas olhe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  O autor pegou RxJava, Retrofit e ainda esculpe muletas para resolver um problema que o RESS simplesmente não possui. <br><br><h4>  3. A tela é a mesma do ViewController!  Precisa separar lógica e apresentação, arrr! </h4><br>  Largue esse mantra já.  Um cliente típico para um serviço REST é uma grande visão para o lado do servidor.  Toda a sua lógica de negócios é definir o estado correto para um botão ou campo de texto.  O que você vai compartilhar lá?  Diga que será mais fácil de manter?  Manter 3 arquivos com 3 toneladas de código, em vez de 1 arquivo com 1 tonelada mais fácil?  Ok  E se tivermos atividade com 5 fragmentos?  Já são 3 x (5 + 1) = 18 arquivos. <br><br>  A separação entre Controller e View nesses casos simplesmente produz um monte de código sem sentido, é hora de admitir.  Adicionar funcionalidade a um projeto com MVP é especialmente divertido: você deseja adicionar um manipulador de botão?  Ok, corrija a interface do Presenter, Activity e View.  No RESS, para isso, escreverei algumas linhas de código em um único arquivo. <br><br>  Mas em grandes projetos, o ViewController cresce muito?  Então você não viu grandes projetos.  Seu cliente REST para o próximo site com 5 mil linhas é um projeto pequeno e 5 mil linhas apenas porque existem 5 classes em cada tela.  Projetos realmente grandes no RESS com mais de 100 telas e várias equipes de 10 pessoas se sentem bem.  Basta fazer alguns pedidos e armazenamento.  E Tela para telas em negrito contém Tela adicional para elementos grandes da interface do usuário, por exemplo, os mesmos fragmentos.  Um projeto em um MVP da mesma escala simplesmente se afogará em vários apresentadores, interfaces, ativações, fragmentos e conexões não óbvias.  E a transição para o VIPER geralmente fará com que toda a equipe saia um dia. <br><br><h2>  Conclusão </h2><br>  Espero que este artigo incentive muitos desenvolvedores a reconsiderar seus pontos de vista sobre arquitetura, não para produzir abstrações e procurar soluções mais simples e testadas pelo tempo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt424081/">https://habr.com/ru/post/pt424081/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt424065/index.html">O Firefox instala extensões nos seus dispositivos para coletar dados sem o seu conhecimento ... novamente</a></li>
<li><a href="../pt424069/index.html">iFixit: iPhone XS e XS Max - cópias quase exatas do iPhone X com capacidade de manutenção 6 em 10</a></li>
<li><a href="../pt424071/index.html">Teoria da felicidade. Termodinâmica da desigualdade de classe</a></li>
<li><a href="../pt424073/index.html">Execução remota de código no Mecanismo de Banco de Dados Microsoft JET</a></li>
<li><a href="../pt424077/index.html">A França exige tornar global o “direito ao esquecimento” - o que pode afetar</a></li>
<li><a href="../pt424083/index.html">Um serviço de negociação na bolsa Robinhood foi acusado de vender dados sobre aplicativos de usuários a traders de alta frequência</a></li>
<li><a href="../pt424085/index.html">Estamos desenvolvendo o módulo do processador NIOS II para o IDA Pro</a></li>
<li><a href="../pt424087/index.html">Dispositivo Android controlado por Bluetooth controlado por Arduino - ciclo completo (parte 1)</a></li>
<li><a href="../pt424089/index.html">Conferências são más. Ou bom?</a></li>
<li><a href="../pt424091/index.html">WiX.Py: coletamos o pacote MSI "em três linhas"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>