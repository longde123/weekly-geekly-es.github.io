<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍✈️ 🏴󠁧󠁢󠁷󠁬󠁳󠁿 👪 Serverless CI / CD على AWS ♟️ 👩🏻‍🔧 🥨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="سيكون من الرائع أن يكون نشر نسخ اللصق شيئًا من الماضي ، ولكن ، للأسف ، كانت الأمور مختلفة. يحدث أن المطورين يفضلون طريقة التسليم هذه. على الرغم من الآ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Serverless CI / CD على AWS</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/440756/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/pr/ok/p2/prokp20fn2bwrkeqzq4ojxzx9gi.jpeg"><br><br>  سيكون من الرائع أن يكون نشر نسخ اللصق شيئًا من الماضي ، ولكن ، للأسف ، كانت الأمور مختلفة.  يحدث أن المطورين يفضلون طريقة التسليم هذه.  على الرغم من الآن اكتب مقالًا عن سبب عدم هذا الأمر ، لكنك تعرف كل شيء بدوني.  مع الاتجاه نحو هندسة بدون خادم ، تلعب خطوط أنابيب CI / CD دورًا مهمًا في تسليم التطبيق.  كتبت أيضًا عنهم في المقال " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">3 أفضل النصائح لمشروعك بدون خادم التالي</a> ." </p><br><p style=";text-align:right;direction:rtl">  لقد كنت مهتمًا بموضوع CI و CD منذ فترة طويلة ، ولأول مرة التقيت به منذ عدة سنوات - بفضل TeamCity.  حاليًا ، لا يزال TeamCity يستخدم لمعظم خطوط أنابيب CI / CD الخاصة بنا.  TeamCity يعمل بشكل رائع ، ليس لدي أي شيء ضده ، لكنني دائماً أسعى لتحسين العمل.  على سبيل المثال ، سيكون من الجيد جمع خطوط أنابيب في شكل كود - وهذا أحد المجالات التي ليست فيها TeamCity جيدة. </p><br><p style=";text-align:right;direction:rtl">  لقد تعلمت أدوات التكامل والتسليم في AWS منذ بعض الوقت ، وعلى الرغم من أننا نستخدم CodeDeploy لمشروع آخر يعمل على EC2 ، إلا أنني لم أقم بنشر مشروع بدون خادم معهم.  بعد مراجعة الأدوات مرة أخرى ، لاحظت هذا: الآن هناك وظيفة تكامل مضمنة لنشر CloudFormation و Lambda ، بناءً على SAM AWS ؛  نستخدم <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">إطار عمل</a> بدون خادم - يقوم بإنشاء قوالب CloudFormation ، لكنه لا يعمل خارج الصندوق باستخدام أدوات AWS. </p><a name="habracut"></a><br><h3 id="podgotovka" style=";text-align:right;direction:rtl">  التحضير </h3><br><p style=";text-align:right;direction:rtl">  يمكنني استخدام خدمات AWS التالية: EC2 ، Docker ، ECR ، S3 ، IAM ، CodeBuild ، CodePipeline ، CloudWatch ، CloudTrail.  من أجل مواكبة ذلك ، عليك أن تفهم على الأقل مستوى أساسي ما تقوم به كل من هذه الخدمات. </p><br><p style=";text-align:right;direction:rtl">  بشكل أساسي ، أكتب الرمز الجانبي للخادم في .NET ، ويعتمد هذا الدليل أيضًا على هذا النظام الأساسي.  لا تحتوي أي من صور CodeBuild مسبقة الصنع على وقت تشغيل .NET و NodeJS في نفس الوقت (هناك حاجة إلى NodeJS لإطار عمل بدون خادم).  إذا كانت وظائف Lambda مكتوبة في NodeJS ، فإن تكوين خط أنابيب النشر أبسط بكثير ، لأن هذه هي بيئة التشغيل الوحيدة المطلوبة للتثبيت في صورة Docker (إذا كانت قضيتك ، لا تتردد في تخطي معظم الدليل).  للمرة الثانية ، كانت هذه أول تجربة لي مع الحاويات ، وأنا سعيد بتعلم شيء جديد. </p><br><p style=";text-align:right;direction:rtl">  أجرؤ على افتراض أن الرمز الخاص بك في مستودع معين ، على سبيل المثال ، بوابة.  للحصول على إرشادات ، نقوم ببساطة بتحميل ملف يحتوي على حزمة من التعليمات البرمجية للنشر إلى S3 ؛  كيف تحصل عليه الأمر متروك لك.  بأخذ عملي كأساس ، يمكنك دائمًا المضي قدمًا من خلال توصيل خط الأنابيب الخاص بك بمستودعات مثل github أو CodeCommit. </p><br><h3 id="1-sozdayte-ekzemplyar-ec2-i-ustanovite-docker" style=";text-align:right;direction:rtl">  1. إنشاء مثيل EC2 وتثبيت Docker </h3><br><p style=";text-align:right;direction:rtl">  قم بتشغيل مثيل قياسي لـ AWS Linux 2 EC2 - يجب أن يكون هذا واضحًا دون توضيح.  تسجيل الدخول وتثبيت Docker باستخدام الأوامر: </p><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">sudo yum update -y sudo amazon-linux-extras install docker sudo service docker start</code> </pre> <br><p style=";text-align:right;direction:rtl">  تحتاج أيضًا إلى إضافة ec2 للمستخدم إلى مجموعة عامل ميناء لتنفيذ أوامر Docker دون استخدام sudo: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">sudo usermod -a -G docker ec2-user</code> </pre> <br><p style=";text-align:right;direction:rtl">  عند اكتمال الأمر ، قم بتسجيل الخروج ثم تسجيل الدخول مرة أخرى إلى مثيل EC2 الخاص بك بحيث يتلقى مستخدم ec2 أذونات جديدة.  تأكد من قيام مستخدم ec2 بتشغيل أوامر Docker دون sudo: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">docker info</code> </pre> <br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/i-/aq/r_/i-aqr_g3enpgmdd4clpawaaykmu.png"></a> <br>  <em><code>docker info</code> إخراج <code>docker info</code></em> </p><br><h3 id="2-sozdayte-obraz-docker-i-pomestite-v-ecr" style=";text-align:right;direction:rtl">  2. إنشاء صورة عامل الميناء ووضعه في ECR </h3><br><p style=";text-align:right;direction:rtl">  افترض أن الخطوة السابقة ناجحة ؛  الخطوة التالية هي إنشاء صورة Docker تناسبها في ECR.  تقدم AWS الصور الأساسية لـ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CodeBuild على github</a> ، وهذا يجعل من السهل إنشاء صورتك الخاصة. </p><br><p style=";text-align:right;direction:rtl">  لقد نشرت الصورة أيضًا على github - في حالة عدم رغبتك في اتباع هذه الخطوات لإنشاء الخاصة بك: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://github.com/effectivedigital/serverless-deployment-image</a> </p><br><p style=";text-align:right;direction:rtl">  انسخ الصور وانتقل إلى دليل .NET Core 2.1: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">git clone https://github.com/aws/aws-codebuild-docker-images.git cd aws-codebuild-docker-images cd ubuntu/dot-net/core-2.1/</code> </pre> <br><p style=";text-align:right;direction:rtl">  افتح Dockerfile في محرر النصوص المفضل لديك: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">nano Dockerfile</code> </pre> <br><p style=";text-align:right;direction:rtl">  أضف الأوامر لتثبيت NodeJS والإطار بدون خادم في نهاية الأوامر الأخرى المتوفرة بالفعل في Dockerfile.  حصلت على معظم هذه الأوامر من صورة NodeJS Docker في نفس مستودع AWS: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># Install Node Dependencies ENV NODE_VERSION="10.14.1" # gpg keys listed at https://github.com/nodejs/node#release-team RUN set -ex \ &amp;&amp; for key in \ 94AE36675C464D64BAFA68DD7434390BDBE9B9C5 \ B9AE9905FFD7803F25714661B63B535A4C206CA9 \ 77984A986EBC2AA786BC0F66B01FBB92821C587A \ 56730D5401028683275BD23C23EFEFE93C4CFFFE \ 71DCFD284A79C3B38668286BC97EC7A07EDE3FC1 \ FD3A5288F042B6850C66B31F09FE44734EB7990E \ 8FCCA13FEF1D0C2E91008E09770F7A9A5AE15600 \ C4F0DFFF4E8C1A8236409D08E73BC641CC11F4C8 \ DD8F2338BAE7501E3DD5AC78C273792F7D83545D \ 4ED778F539E3634C779C87C6D7062848A1AB005C \ A48C2BEE680E841632CD4E44F07496B3EB3C1762 \ ; do \ gpg - keyserver hkp://p80.pool.sks-keyservers.net:80 - recv-keys "$key" || \ gpg - keyserver hkp://ipv4.pool.sks-keyservers.net - recv-keys "$key" || \ gpg - keyserver hkp://pgp.mit.edu:80 - recv-keys "$key" ; \ done RUN set -ex \ &amp;&amp; wget "https://nodejs.org/download/release/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.gz" -O node-v$NODE_VER$ &amp;&amp; wget "https://nodejs.org/download/release/v$NODE_VERSION/SHASUMS256.txt.asc" -O SHASUMS256.txt.asc \ &amp;&amp; gpg - batch - decrypt - output SHASUMS256.txt SHASUMS256.txt.asc \ &amp;&amp; grep " node-v$NODE_VERSION-linux-x64.tar.gz\$" SHASUMS256.txt | sha256sum -c - \ &amp;&amp; tar -xzf "node-v$NODE_VERSION-linux-x64.tar.gz" -C /usr/local - strip-components=1 \ &amp;&amp; rm "node-v$NODE_VERSION-linux-x64.tar.gz" SHASUMS256.txt.asc SHASUMS256.txt \ &amp;&amp; ln -s /usr/local/bin/node /usr/local/bin/nodejs \ &amp;&amp; rm -fr /var/lib/apt/lists/* /tmp/* /var/tmp/* RUN npm set unsafe-perm true CMD [ "node" ] # Install Serverless Framework RUN set -ex \ &amp;&amp; npm install -g serverless</code> </pre> <br><p style=";text-align:right;direction:rtl">  الآن نقوم بجمع وتمييز الصورة: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">docker build -t aws/codebuild/dot-net .</code> </pre> <br><p style=";text-align:right;direction:rtl">  بعد الانتهاء من التجميع ، قم بتشغيل الصورة - تأكد من أن كل شيء يعمل وأنه تم تثبيت الإطار بدون خادم بشكل صحيح: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">docker run -it --entrypoint sh aws/codebuild/dot-net -c bash sls -v</code> </pre> <br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/ji/vh/da/jivhda2vzvu3vwc4uyltgyz0mza.png"></a> <br>  <em>تشغيل <code>sls -v</code> داخل حاوية جديدة</em> </p><br><p style=";text-align:right;direction:rtl">  ثم قم بإنشاء المستودع في ECR باستخدام AWS CLI.  بعد تشغيل الأمر ، سيتم عرض مستودع التخزين الجديد في وحدة التحكم AWS: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">aws ecr create-repository --repository-name codebuild-dotnet-node</code> </pre> <br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/qc/bq/-g/qcbq-gsw-afhdbp2q9meo1nsqrk.png"></a> <br>  <em>استجابة AWS CLI لإنشاء مستودع في ECR</em> </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/2q/sf/_v/2qsf_v-jbgorara_qbzwi2lavoc.png"></a> </p><br><p style=";text-align:right;direction:rtl">  الآن قم بتمييز صورة <em>aws / codebuild / dot-net التي</em> تم إنشاؤها سابقًا <em>باستخدام</em> repositoryUri من الخطوة السابقة: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">docker tag aws/codebuild/dot-net &lt;ACCOUNTID&gt;.dkr.ecr.ap-southeast-2.amazonaws.com/codebuild-dotnet-node</code> </pre> <br><p style=";text-align:right;direction:rtl">  قم بتشغيل الأمر get-login للحصول على سطر أوامر مصادقة تسجيل الدخول إلى عامل ميناء سجل الحاوية: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">aws ecr get-login --no-include-email</code> </pre> <br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/6l/w9/2d/6lw92dgbv2c7fvicbjvoz-afxwo.png"></a> </p><br><p style=";text-align:right;direction:rtl">  قم بتشغيل أمر تسجيل دخول عامل ميناء صادر عن الأمر get-login أثناء الخطوة الأخيرة. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">docker login -u AWS -p eyJwYXlsb2FkIjoiNGZnd0dSaXM1L2svWWRLMmhJT1c0WWpOZEcxamJFeFJOK2VvT0Y5[...] https://&lt;ACCOUNTID&gt;.dkr.ecr.ap-southeast-2.amazonaws.com</code> </pre> <br><p style=";text-align:right;direction:rtl">  إذا نجح تسجيل الدخول ، فضع صورة عامل النقل في المستودع الذي تم إنشاؤه في ECR.  قد يستغرق هذا عدة دقائق (حسب حجم الصورة المكتملة). </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">docker push &lt;ACCOUNTID&gt;.dkr.ecr.ap-southeast-2.amazonaws.com/codebuild-dotnet-node</code> </pre> <br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/qc/bq/-g/qcbq-gsw-afhdbp2q9meo1nsqrk.png"></a> <br>  <em>عامل الميناء على EC2 يخلق صورتنا</em> </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/k-/me/2l/k-me2lgrhindh4_2p9tl24e0qau.png"></a> <br>  <em>صورة عامل الميناء في ECR</em> </p><br><p style=";text-align:right;direction:rtl">  ثم يمكننا فتح الوصول إلى الصورة من ECR لأي شخص.  يجب حظر الإذن في بيئة العمل ، ولكن في هذا المثال سنفتحه.  انتقل إلى علامة تبويب الأذونات في وحدة التحكم AWS ، حدد "تغيير سياسة JSON" وأدخل العنصر التالي في السياسة: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">{ "Version": "2008-10-17", "Statement": [ { "Sid": "EnableAccountAccess", "Effect": "Allow", "Principal": "*", "Action": [ "ecr:BatchCheckLayerAvailability", "ecr:BatchGetImage", "ecr:DescribeImages", "ecr:DescribeRepositories", "ecr:GetAuthorizationToken", "ecr:GetDownloadUrlForLayer", "ecr:GetRepositoryPolicy", "ecr:ListImages" ] } ] }</code> </pre> <br><h3 id="3-sozdayte-payplayn" style=";text-align:right;direction:rtl">  3. إنشاء خط أنابيب </h3><br><p style=";text-align:right;direction:rtl">  لقد حان الوقت لجمع الأنابيب.  لتبسيط العملية ، وجعلها متعددة النشر ، والتمسك بالشكل الكارثي للهندسة المعمارية بدون خادم ، قمت ببناء خط أنابيب باستخدام إطار عمل بدون خادم.  يمكنك تحقيق نفس النتيجة من خلال البناء في CloudFormation. </p><br><p style=";text-align:right;direction:rtl">  لن أنسخ المصدر بالكامل من ملف serverless.yml - انسخه من github: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://github.com/effectivedigital/serverless-deployment-pipeline</a> </p><br><p style=";text-align:right;direction:rtl">  تحقق من القالب بدون خادم لمعرفة ما الذي ستفعله بالضبط ، ولكن باختصار ، يقوم بإعداد العناصر التالية: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  3 شرائح S3 </li><li style=";text-align:right;direction:rtl">  سياسة الجزء 1 </li><li style=";text-align:right;direction:rtl">  3 أدوار IAM </li><li style=";text-align:right;direction:rtl">  1 مشروع CodeBuild </li><li style=";text-align:right;direction:rtl">  1 خط أنابيب CodePipeline </li><li style=";text-align:right;direction:rtl">  حدث CloudWatch واحد </li><li style=";text-align:right;direction:rtl">  1 تتبع CloudTrail </li></ul><br><p style=";text-align:right;direction:rtl">  ثم قم بتحديث <em>DockerImageArn لصورتك</em> في ECR.  إذا كنت ترغب في إنشاء حزم نشر باسم غير <em>Deployment.zip</em> ، فعليك أيضًا تحديث <em>DeploymentFilename</em> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">DockerImageArn: &lt;ACCOUNTID&gt;.dkr.ecr.ap-southeast-2.amazonaws.com/codebuild-dotnet-node:latest DeploymentFilename: Deployment.zip</code> </pre> <br><p style=";text-align:right;direction:rtl">  هذا كل شيء ، خط الأنابيب جاهز للنشر.  قم بتشغيل أمر النشر بدون خادم وانتظر حتى يتم تكوينه: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">sls deploy -v</code> </pre> <br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/hi/wk/ys/hiwkysbgka2zessqrdqkb4nir1g.png"></a> <br>  <em>خلق إطار serverless كومة CloudFormation</em> </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/hc/r6/yr/hcr6yrezormgpobpu2bdu-_tvj4.png"></a> <br>  <em>التي أنشأتها خادم خط أنابيب الإطار CodePipeline</em> </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/ef/ax/ad/efaxaddb_yspsbdxrl1azf5e1oo.png"></a> <br>  <em>التي أنشأتها مشروع إطار serverless مشروع CodeBuild</em> </p><br><h3 id="4-dobavte-buildspecyml-v-svoe-prilozhenie" style=";text-align:right;direction:rtl">  4. إضافة buildSpec.yml إلى التطبيق الخاص بك </h3><br><p style=";text-align:right;direction:rtl">  عندما يكتشف CodePipeline تغييرًا في ملف النشر في S3 ، فإنه يخبر CodeBuild أن يبدأ ويحاول إنشاء التطبيق ونشره.  ومع ذلك ، يجب أن يعرف CodeBuild أيضًا الأوامر التي يجب تنفيذها لإنشاء التطبيق ونشره ، ويحتوي buildSpec.yml على إرشادات سيتبعها CodeBuild. </p><br><p style=";text-align:right;direction:rtl">  لقد قمت بإنشاء تطبيق "Hello world" بسيط للغاية يتضمن مثالاً على ملف buildSpec.yml الذي يمكنك استخدامه: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://github.com/effectivedigital/serverless-deployment-app</a> <br>  أو قم بإنشاء ملف buildSpec.yml في التطبيقات الحالية واملأه وفقًا للتعليمات التالية: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">version: 0.2 phases: pre_build: commands: - chmod a+x * build: commands: - ./build.sh post_build: commands: - sls deploy -v -s $STAGE</code> </pre> <br><h3 id="5-proverka-payplayna" style=";text-align:right;direction:rtl">  5. فحص خطوط الأنابيب </h3><br><p style=";text-align:right;direction:rtl">  كل شيء جاهز الآن للإطلاق الأول لخط الأنابيب الخاص بك.  قم بإنشاء حزمة تسمى <em>Deployment.zip</em> ، ويجب أن تتضمن جميع الملفات الخاصة بالتطبيق بدون خادم وملف buildSpec.yml. </p><br><p style=";text-align:right;direction:rtl">  بعد لحظات قليلة ، يجب على CloudTrail تسجيل حدث PutObject وتنشيط قاعدة حدث CloudWatch ، التي تقوم بعد ذلك بتنشيط مشغل CodePipeline. </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/zg/r4/ii/zgr4iikop3ujbabsgtsfbyjex4o.png"></a> <br>  <em>تم نشر Deployment.zip في S3</em> </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/ak/xd/iz/akxdizdzjomaespfhmnygedoqia.png"></a> <br>  <em>أطلقت CodePipeline ، بناء على</em> </p><br><p style=";text-align:right;direction:rtl">  إذا انتقلنا إلى تفاصيل خطوة AWS CodeBuild ، فيمكننا رؤية عملية الإنشاء والنشر: </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/gv/sx/cb/gvsxcbcpmbcnj18k9rwbqbm_bhu.png"></a> <br>  <em>ستتلقى CodeBuild الإخراج من البنية ونشر صورة Docker</em> </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/l3/ec/xm/l3ecxm5cjedmhtpxne0nklzdzlm.png"></a> <br>  <em>نشر ناجح!</em> </p><br><p style=";text-align:right;direction:rtl">  يظهر التطبيق الجديد الذي تم نشره بواسطة خط الأنابيب لدينا في CloudFormation: </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/r6/2s/xl/r62sxlivtmrg8vn3yze2xe0ez3y.png"></a> </p><br><p style=";text-align:right;direction:rtl">  يمكنك اختبار نقطة نهاية واجهة برمجة التطبيقات التي تم إنشاؤها في تطبيقنا البسيط (عنوان URL في إخراج CodeBuild أو في واجهة برمجة تطبيقات البوابة) والتأكد من أن التطبيق يعمل بنجاح: </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/h4/s3/gh/h4s3ghrxxwlpxaf3ssdwhfx30sy.png"></a> <br>  <em>ساعي البريد للاتصال API</em> </p><br><h3 id="kratkie-vyvody" style=";text-align:right;direction:rtl">  استنتاجات موجزة </h3><br><p style=";text-align:right;direction:rtl">  يسمح لك CodePipeline بإنشاء خط أنابيب CI / CD قابل للتطوير ومرن وغير مكلف ، ويساعد في حل بعض المشكلات المرتبطة بخطوط الأنابيب التقليدية التي تم إنشاؤها على الخوادم. <br>  أرغب في المضي قدمًا وإضافة اختبار الوحدة بعد النشر إلى المزيج ، لكن الموضوع يستحق مقالة منفصلة - وهذه مناسبة لقراءتنا في المستقبل! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar440756/">https://habr.com/ru/post/ar440756/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar440744/index.html">PHP للمبتدئين. خطأ في التعامل</a></li>
<li><a href="../ar440746/index.html">دورات Gartner لتكنولوجيا إدارة المعرفة باستخدام دراسات الحالة في KnowledgeConf</a></li>
<li><a href="../ar440748/index.html">أسرع حاسوب عملاق في العالم يحطم الرقم القياسي لمنظمة العفو الدولية</a></li>
<li><a href="../ar440752/index.html">اختيار المستخدم طلب الأولوية</a></li>
<li><a href="../ar440754/index.html">فائدة عبر منصة الإنجليزية لعرض شهادات المؤهلين الروسية X509</a></li>
<li><a href="../ar440758/index.html">الذهاب ميتوب في أكرونيس! (موسكو ، فيتز بارك)</a></li>
<li><a href="../ar440760/index.html">العصر الذهبي الجديد لهندسة الكمبيوتر</a></li>
<li><a href="../ar440762/index.html">مراجعات صاحب العمل: طبيعة وعدم وجود مراجعات من المجهولين</a></li>
<li><a href="../ar440766/index.html">من المهوسون إلى المهوسون: هدايا في 23 فبراير</a></li>
<li><a href="../ar440772/index.html">تصميم يحركه المجال: وصفة لالبراغماتية</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>