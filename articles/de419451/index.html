<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèø‚Äçü§ù‚ÄçüßëüèΩ üßî ‚úãüèª Erstellen Sie Schritt f√ºr Schritt ein Bundle f√ºr Symfony 4 üöò üõãÔ∏è üë®‚Äçüé®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor etwa einem Jahr war unser Unternehmen auf dem Weg zur Trennung des riesigen Monolithen auf Magento 1 in Microservices. Als Basis w√§hlten sie nur S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erstellen Sie Schritt f√ºr Schritt ein Bundle f√ºr Symfony 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419451/"><p>  Vor etwa einem Jahr war unser Unternehmen auf dem Weg zur Trennung des riesigen Monolithen auf Magento 1 in Microservices.  Als Basis w√§hlten sie nur Symfony 4, das in der Version ver√∂ffentlicht wurde. W√§hrend dieser Zeit entwickelte ich mehrere Projekte auf diesem Framework, aber ich fand es besonders interessant, Bundles zu entwickeln und Komponenten f√ºr Symfony wiederzuverwenden.  Unter der Katze eine Schritt-f√ºr-Schritt-Anleitung zur Entwicklung des HealthCheck-Bundles zur Ermittlung des Status / der Gesundheit eines Microservices unter Syfmony 4.1, in der ich versuchte, die interessantesten und komplexesten (f√ºr mich einmal) Momente zu ber√ºhren. </p><a name="habracut"></a><br><p>  In unserem Unternehmen wird dieses Bundle beispielsweise verwendet, um den Status eines Produkt-Neuindex in ElasticSearch abzurufen - wie viele Produkte sind in Elastic mit aktuellen Daten enthalten und wie viele m√ºssen indiziert werden. </p><br><h1 id="sozdanie-skeleta-bandla">  Erstellen Sie ein B√ºndelskelett </h1><br><p> In Symfony 3 gab es ein praktisches Bundle zum Generieren von Bundle-Skeletten, in Symfony 4 wird es jedoch nicht mehr unterst√ºtzt und daher m√ºssen Sie das Skelett selbst erstellen.  Ich beginne die Entwicklung jedes neuen Projekts mit der Gr√ºndung eines Teams </p><br><pre><code class="hljs sql">composer <span class="hljs-keyword"><span class="hljs-keyword">create</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">project</span></span> symfony/skeleton health-<span class="hljs-keyword"><span class="hljs-keyword">check</span></span></code> </pre> <br><p>  Bitte beachten Sie, dass Symfony 4 PHP 7.1+ unterst√ºtzt. Wenn Sie diesen Befehl in der folgenden Version ausf√ºhren, erhalten Sie das Projektskelett f√ºr Symfony 3. </p><br><p>  Dieser Befehl erstellt ein neues Symfony 4.1-Projekt mit der folgenden Struktur: </p><br><p><img src="https://habrastorage.org/webt/_c/hl/yb/_chlybmekt9jh4dmo-exscc_kfi.png" alt="Bild"></p><br><p>  Im Prinzip ist dies nicht erforderlich, da wir am Ende nicht so viel Dateien erstellen, aber es ist f√ºr mich bequemer, alles zu reinigen, was nicht ben√∂tigt wird, als das Notwendige mit meinen H√§nden zu erstellen. </p><br><h1 id="composerjson">  composer.json </h1><br><p>  Der n√§chste Schritt besteht darin, <code>composer.json</code> an unsere Bed√ºrfnisse anzupassen.  Zun√§chst m√ºssen Sie den Typ des Projekttyps in <code>symfony-bundle</code> diese Weise kann <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Symfony Flex</a> beim Hinzuf√ºgen eines Bundles zum Projekt feststellen, dass es sich tats√§chlich um ein Symfony-Bundle handelt, es automatisch verbinden und das Rezept installieren (dazu sp√§ter mehr).  Stellen Sie als N√§chstes sicher, dass Sie die Felder <code>name</code> und <code>description</code> hinzuf√ºgen.  <code>name</code> ist auch wichtig, da er bestimmt, in welchem ‚Äã‚ÄãOrdner innerhalb des <code>vendor</code> Bundle abgelegt wird. </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"niklesh/health-check"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Health check bundle"</span></span>,</code> </pre> <br><p>  Der n√§chste wichtige Schritt ist das Bearbeiten des <code>autoload</code> Abschnitts, der f√ºr das Laden der Bundle-Klassen verantwortlich ist.  <code>autoload</code> f√ºr die Arbeitsumgebung, <code>autoload-dev</code> f√ºr die Arbeitsumgebung. </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"autoload"</span></span>: { <span class="hljs-string"><span class="hljs-string">"psr-4"</span></span>: { <span class="hljs-string"><span class="hljs-string">"niklesh\\HealthCheckBundle\\"</span></span>: <span class="hljs-string"><span class="hljs-string">"src"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"autoload-dev"</span></span>: { <span class="hljs-string"><span class="hljs-string">"psr-4"</span></span>: { <span class="hljs-string"><span class="hljs-string">"niklesh\\HealthCheckBundle\\Tests\\"</span></span>: <span class="hljs-string"><span class="hljs-string">"tests"</span></span> } },</code> </pre> <br><p>  Der <code>scripts</code> kann gel√∂scht werden.  Es enth√§lt Skripte zum Zusammenstellen von Assets und zum L√∂schen des Caches nach Ausf√ºhrung der <code>composer install</code> und <code>composer update</code> Befehle. Unser Bundle enth√§lt jedoch keine Assets oder Caches. Daher sind diese Befehle unbrauchbar. </p><br><p>  Der letzte Schritt besteht darin, die Abschnitte <code>require</code> und <code>require-dev</code> zu bearbeiten.  Als Ergebnis erhalten wir Folgendes: </p><br><pre> <code class="hljs perl"><span class="hljs-string"><span class="hljs-string">"require"</span></span>: { <span class="hljs-string"><span class="hljs-string">"php"</span></span>: <span class="hljs-string"><span class="hljs-string">"^7.1.3"</span></span>, <span class="hljs-string"><span class="hljs-string">"ext-ctype"</span></span>: <span class="hljs-string"><span class="hljs-string">"*"</span></span>, <span class="hljs-string"><span class="hljs-string">"ext-iconv"</span></span>: <span class="hljs-string"><span class="hljs-string">"*"</span></span>, <span class="hljs-string"><span class="hljs-string">"symfony/flex"</span></span>: <span class="hljs-string"><span class="hljs-string">"^1.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"symfony/framework-bundle"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1"</span></span>, <span class="hljs-string"><span class="hljs-string">"sensio/framework-extra-bundle"</span></span>: <span class="hljs-string"><span class="hljs-string">"^5.2"</span></span>, <span class="hljs-string"><span class="hljs-string">"symfony/lts"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4@dev"</span></span>, <span class="hljs-string"><span class="hljs-string">"symfony/yaml"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1"</span></span> }</code> </pre> <br><p>  Ich stelle fest, dass die Abh√§ngigkeiten von <code>require</code> installiert werden, wenn das Bundle mit dem Arbeitsentwurf verbunden ist. </p><br><p>  Wir starten das <code>composer update</code> - Abh√§ngigkeiten sind installiert. </p><br><h1 id="chistka-ne-nuzhnogo">  Unn√∂tige Reinigung </h1><br><p>  Aus den empfangenen Dateien k√∂nnen Sie also die folgenden Ordner sicher l√∂schen: </p><br><ul><li>  bin - enth√§lt die <code>console</code> , die zum Ausf√ºhren von Symfony-Befehlen erforderlich ist </li><li>  config - enth√§lt Konfigurationsdateien f√ºr das Routing, verbundene Bundles, <br>  Dienstleistungen usw. </li><li>  public - enth√§lt <code>index.php</code> - Einstiegspunkt in die Anwendung </li><li>  Hier werden Var - Logs und <code>cache</code> gespeichert </li></ul><br><p>  Wir l√∂schen auch die <code>.env.dist</code> <code>src/Kernel.php</code> , <code>.env</code> , <code>.env.dist</code> <br>  Wir brauchen das alles nicht, weil wir ein Bundle entwickeln, keine Anwendung. </p><br><h1 id="sozdanie-struktury-bandla">  B√ºndelstruktur erstellen </h1><br><p>  Also haben wir die notwendigen Abh√§ngigkeiten hinzugef√ºgt und alles, was nicht ben√∂tigt wurde, aus unserem Bundle entfernt.  Es ist Zeit, die erforderlichen Dateien und Ordner zu erstellen, um das Bundle erfolgreich mit dem Projekt zu verbinden. </p><br><p>  Erstellen Sie zun√§chst im Ordner <code>src</code> die Datei <code>HealthCheckBundle.php</code> mit folgendem Inhalt: </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">HttpKernel</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthCheckBundle</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bundle</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br><p>  Eine solche Klasse sollte in jedem von Ihnen erstellten Bundle enthalten sein.  Er wird in die <code>config/bundles.php</code> Hauptprojekts aufgenommen.  Au√üerdem kann er den "Build" des Bundles beeinflussen. </p><br><p>  Die n√§chste ben√∂tigte Bundle-Komponente ist der Abschnitt <code>DependencyInjection</code> .  Erstellen Sie den gleichnamigen Ordner mit 2 Dateien: </p><br><ul><li> <code>src/DependencyInjection/Configuration.php</code> </li> </ul><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Config</span></span>\<span class="hljs-title"><span class="hljs-title">Definition</span></span>\<span class="hljs-title"><span class="hljs-title">Builder</span></span>\<span class="hljs-title"><span class="hljs-title">TreeBuilder</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Config</span></span>\<span class="hljs-title"><span class="hljs-title">Definition</span></span>\<span class="hljs-title"><span class="hljs-title">ConfigurationInterface</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Configuration</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConfigurationInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConfigTreeBuilder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $treeBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeBuilder(); $treeBuilder-&gt;root(<span class="hljs-string"><span class="hljs-string">'health_check'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $treeBuilder; } }</code> </pre> <br><p>  Diese Datei ist f√ºr das Parsen und √úberpr√ºfen der Bundle-Konfiguration aus Yaml- oder XML-Dateien verantwortlich.  Wir werden es sp√§ter √§ndern. </p><br><ul><li> <code>src/DependencyInjection/HealthCheckExtension.php</code> </li> </ul><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Config</span></span>\<span class="hljs-title"><span class="hljs-title">FileLocator</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">ContainerBuilder</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">HttpKernel</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Extension</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Loader</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthCheckExtension</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Extension</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment">} */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $configs, ContainerBuilder $container)</span></span></span><span class="hljs-function"> </span></span>{ $configuration = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Configuration(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;processConfiguration($configuration, $configs); $loader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Loader\YamlFileLoader($container, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileLocator(<span class="hljs-keyword"><span class="hljs-keyword">__DIR__</span></span> . <span class="hljs-string"><span class="hljs-string">'/../Resources/config'</span></span>)); $loader-&gt;load(<span class="hljs-string"><span class="hljs-string">'services.yaml'</span></span>); } }</code> </pre> <br><p>  Diese Datei ist f√ºr das Laden von Bundle-Konfigurationsdateien, das Erstellen und Registrieren von "Definitions" -Diensten, das Laden von Parametern in einen Container usw. verantwortlich. </p><br><p>  Der letzte Schritt in dieser Phase ist das Hinzuf√ºgen der Datei <code>src/Resources/services.yaml</code> , die eine Beschreibung der Dienste unseres Bundles enth√§lt.  Lass es jetzt leer. </p><br><h1 id="healthinterface">  HealthInterface </h1><br><p>  Die Hauptaufgabe unseres Bundles besteht darin, Daten √ºber das Projekt zur√ºckzugeben, in dem es verwendet wird.  Das Sammeln von Informationen ist jedoch die Arbeit des Dienstes selbst. Unser Paket kann nur das Format der Informationen angeben, die der Dienst an ihn senden soll, und die Methode, mit der diese Informationen empfangen werden.  In meiner Implementierung sollten alle Dienste (und m√∂glicherweise mehrere), die Informationen sammeln, die <code>HealthInterface</code> Schnittstelle mit zwei Methoden <code>getName</code> : <code>getName</code> und <code>getHealthInfo</code> .  Letzteres sollte ein Objekt zur√ºckgeben, das die <code>HealthDataInterface</code> Schnittstelle implementiert. </p><br><p>  Erstellen Sie zun√§chst die Datenschnittstelle <code>src/Entity/HealthDataInterface.php</code> : </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthDataInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> STATUS_OK = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> STATUS_WARNING = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> STATUS_DANGER = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> STATUS_CRITICAL = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getStatus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAdditionalInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array</span></span></span></span>; }</code> </pre> <br><p>  Die Daten m√ºssen einen ganzzahligen Status und zus√§tzliche Informationen enthalten (die √ºbrigens leer sein k√∂nnen). </p><br><p>  Da die Implementierung dieser Schnittstelle h√∂chstwahrscheinlich f√ºr die meisten Nachkommen typisch ist, habe ich beschlossen, sie dem <code>src/Entity/CommonHealthData.php</code> : </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CommonHealthData</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthDataInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $status; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $additionalInfo = []; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $status)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;status = $status; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setStatus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $status)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;status = $status; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAdditionalInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $additionalInfo)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;additionalInfo = $additionalInfo; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getStatus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;status; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAdditionalInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;additionalInfo; } }</code> </pre> <br><p>  F√ºgen Sie abschlie√üend die Schnittstelle f√ºr die Datenerfassungsdienste <code>src/Service/HealthInterface.php</code> : </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>\<span class="hljs-title"><span class="hljs-title">HealthDataInterface</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHealthInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HealthDataInterface</span></span></span></span>; }</code> </pre> <br><h1 id="controller">  Controller </h1><br><p>  Der Controller gibt Daten √ºber das Projekt auf nur einer Route weiter.  Diese Route ist jedoch f√ºr alle Projekte, die dieses Bundle verwenden, gleich: <code>/health</code> </p><br><p>  Die Aufgabe unseres Controllers besteht jedoch nicht nur darin, Daten <code>HealthInterface</code> , sondern sie auch aus den Diensten herauszuholen, die <code>HealthInterface</code> implementieren. <code>HealthInterface</code> muss der Controller Links zu jedem dieser Dienste speichern.  Die <code>addHealthService</code> Methode ist f√ºr das Hinzuf√ºgen von Diensten zum Controller verantwortlich </p><br><p>  F√ºgen Sie den Controller <code>src/Controller/HealthController.php</code> : </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Controller</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>\<span class="hljs-title"><span class="hljs-title">HealthInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>\<span class="hljs-title"><span class="hljs-title">FrameworkBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Controller</span></span>\<span class="hljs-title"><span class="hljs-title">AbstractController</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">HttpFoundation</span></span>\<span class="hljs-title"><span class="hljs-title">JsonResponse</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Routing</span></span>\<span class="hljs-title"><span class="hljs-title">Annotation</span></span>\<span class="hljs-title"><span class="hljs-title">Route</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> HealthInterface[] */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $healthServices = []; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addHealthService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HealthInterface $healthService)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;healthServices[] = $healthService; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Route</span></span></span><span class="hljs-comment">("/health") * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> JsonResponse */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHealth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">JsonResponse</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;json(array_map(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HealthInterface $healthService)</span></span></span><span class="hljs-function"> </span></span>{ $info = $healthService-&gt;getHealthInfo(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; $healthService-&gt;getName(), <span class="hljs-string"><span class="hljs-string">'info'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'status'</span></span> =&gt; $info-&gt;getStatus(), <span class="hljs-string"><span class="hljs-string">'additional_info'</span></span> =&gt; $info-&gt;getAdditionalInfo() ] ]; }, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;healthServices)); } }</code> </pre> <br><h1 id="kompilyaciya">  Zusammenstellung </h1><br><p>  Symfony kann bestimmte Aktionen mit Diensten ausf√ºhren, die eine bestimmte Schnittstelle implementieren.  Sie k√∂nnen eine bestimmte Methode aufrufen, ein Tag hinzuf√ºgen, aber nicht alle diese Dienste in einen anderen Dienst (den Controller) √ºbernehmen und einf√ºgen.  Dieses Problem wird in 4 Schritten gel√∂st: </p><br><p>  <em>Wir f√ºgen jedem unserer <code>HealthInterface</code> das <code>HealthInterface</code> Tag hinzu.</em> </p><br><p>  F√ºgen Sie der Schnittstelle die <code>TAG</code> Konstante hinzu: </p><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> TAG = <span class="hljs-string"><span class="hljs-string">'health.service'</span></span>; }</code> </pre> <br><p>  Als N√§chstes m√ºssen Sie dieses Tag jedem Dienst hinzuf√ºgen.  Bei der Projektkonfiguration kann dies sein <br>  Implementieren Sie in der Datei <code>config/services.yaml</code> im Abschnitt <code>_instanceof</code> .  In unserem Fall dies <br>  Der Eintrag w√ºrde folgenderma√üen aussehen: </p><br><pre> <code class="hljs tex">serivces: _instanceof: niklesh<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HealthCheckBundle</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Service</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HealthInterface</span></span></span></span>: tags: - !php/const niklesh<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HealthCheckBundle</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Service</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HealthInterface</span></span></span></span>::TAG</code> </pre> <br><p>  Wenn Sie dem Benutzer die Konfiguration des Bundles zuweisen, funktioniert dies im Prinzip. Meiner Meinung nach ist dies jedoch nicht der richtige Ansatz. Das Bundle selbst muss beim Hinzuf√ºgen zum Projekt korrekt verbunden und mit minimalem Benutzereingriff konfiguriert werden.  Jemand k√∂nnte sich daran erinnern, dass wir unsere eigenen <code>services.yaml</code> im Bundle haben, aber nein, es wird uns nicht helfen.  Diese Einstellung funktioniert nur, wenn sie sich in der Projektdatei befindet, nicht im Bundle. <br>  Ich wei√ü nicht, ob dies ein Fehler oder eine Funktion ist, aber jetzt haben wir das, was wir haben.  Daher m√ºssen wir den Bundle-Kompilierungsprozess infiltrieren. </p><br><p>  <code>src/HealthCheckBundle.php</code> und definieren Sie die <code>build</code> neu: </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>\<span class="hljs-title"><span class="hljs-title">HealthInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">ContainerBuilder</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">HttpKernel</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthCheckBundle</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bundle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerBuilder $container)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::build($container); $container-&gt;registerForAutoconfiguration(HealthInterface::class)-&gt;addTag(HealthInterface::TAG); } }</code> </pre> <br><p>  Jetzt wird jede Klasse, die <code>HealthInterface</code> implementiert, mit Tags versehen. </p><br><p>  <em>Registrieren des Controllers als Dienst</em> </p><br><p>  Im n√§chsten Schritt m√ºssen wir den Controller als Service kontaktieren, w√§hrend wir das Bundle kompilieren.  Bei der Arbeit mit dem Projekt werden dort standardm√§√üig alle Klassen als Dienste registriert. Bei der Arbeit mit dem Bundle m√ºssen wir jedoch explizit festlegen, welche Klassen Dienste sein sollen, Argumente f√ºr sie angeben und angeben, ob sie √∂ffentlich sein werden. </p><br><p>  √ñffnen Sie die Datei <code>src/Resources/config/services.yaml</code> und f√ºgen Sie den folgenden Inhalt hinzu </p><br><pre> <code class="hljs tex">services: niklesh<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HealthCheckBundle</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Controller</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HealthController</span></span></span></span>: autoconfigure: true</code> </pre> <br><p>  Wir haben den Controller explizit als Service registriert, jetzt kann in der Kompilierungsphase darauf zugegriffen werden. </p><br><p>  <em>Hinzuf√ºgen von Diensten zum Controller.</em> </p><br><p>  In der Phase der Kompilierung des Containers und der Bundles k√∂nnen wir nur mit Service-Definitionen arbeiten.  In diesem Stadium m√ºssen wir die Definition des <code>HealthController</code> und angeben, dass nach seiner Erstellung alle mit unserem Tag gekennzeichneten Dienste hinzugef√ºgt werden m√ºssen.  F√ºr solche Operationen in Bundles sind Klassen verantwortlich, die die Schnittstelle implementieren <br> <code>Symfony\Component\DependencyInjection\Compiler\CompilerPassInterface</code> </p> <br><p>  Erstellen Sie die folgende <code>src/DependencyInjection/Compiler/HealthServicePath.php</code> : </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Compiler</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Controller</span></span>\<span class="hljs-title"><span class="hljs-title">HealthController</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>\<span class="hljs-title"><span class="hljs-title">HealthInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Compiler</span></span>\<span class="hljs-title"><span class="hljs-title">CompilerPassInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">ContainerBuilder</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Reference</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthServicesPath</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CompilerPassInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerBuilder $container)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$container-&gt;has(HealthController::class)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } $controller = $container-&gt;findDefinition(HealthController::class); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (array_keys($container-&gt;findTaggedServiceIds(HealthInterface::TAG)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $serviceId) { $controller-&gt;addMethodCall(<span class="hljs-string"><span class="hljs-string">'addHealthService'</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Reference($serviceId)]); } } }</code> </pre> <br><p>  Wie Sie sehen k√∂nnen, verwenden wir zuerst die <code>findDefinition</code> Methode <code>findDefinition</code> um den Controller <code>findDefinition</code> √ºbernehmen, dann - alle Dienste nach Tag und f√ºgen dann in einer Schleife jedem gefundenen Dienst einen Aufruf der <code>addHealthService</code> Methode hinzu, wobei wir den Link zu diesem Dienst √ºbergeben. </p><br><p>  <em><code>CompilerPath</code></em> </p><br><p>  Der letzte Schritt besteht darin, unseren <code>HealthServicePath</code> zum Bundle-Kompilierungsprozess hinzuzuf√ºgen.  <code>HealthCheckBundle</code> wir zur <code>HealthCheckBundle</code> Klasse zur√ºck und √§ndern die <code>build</code> etwas weiter.  Als Ergebnis erhalten wir: </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Compiler</span></span>\<span class="hljs-title"><span class="hljs-title">HealthServicesPath</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>\<span class="hljs-title"><span class="hljs-title">HealthInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">ContainerBuilder</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">HttpKernel</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthCheckBundle</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bundle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerBuilder $container)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::build($container); $container-&gt;addCompilerPass(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HealthServicesPath()); $container-&gt;registerForAutoconfiguration(HealthInterface::class)-&gt;addTag(HealthInterface::TAG); } }</code> </pre> <br><p>  Grunds√§tzlich ist unser Bundle zu diesem Zeitpunkt einsatzbereit.  Es kann Informationssammlungsdienste finden, mit ihnen arbeiten und bei Kontaktaufnahme <code>/health</code> eine Antwort geben (Sie m√ºssen nur Routing-Einstellungen hinzuf√ºgen, wenn Sie eine Verbindung herstellen), aber ich habe beschlossen, die M√∂glichkeit einzubauen, Informationen nicht nur auf Anfrage zu senden, sondern auch diese Informationen an zu senden oder beispielsweise mithilfe einer POST-Anforderung oder √ºber einen Warteschlangenmanager. </p><br><h1 id="healthsenderinterface">  HealthSenderInterface </h1><br><p>  Diese Schnittstelle soll die Klassen beschreiben, die f√ºr das Senden von Daten an einen Ort verantwortlich sind.  Erstellen Sie es in <code>src/Service/HealthSenderInterface</code> </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>\<span class="hljs-title"><span class="hljs-title">HealthDataInterface</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthSenderInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> HealthDataInterface[] $data */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $data)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDescription</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span>; }</code> </pre> <br><p>  Wie Sie sehen k√∂nnen, verarbeitet die <code>send</code> Methode das empfangene Datenarray von allen Klassen, die <code>HealthInterface</code> implementieren, und sendet es dann an den gew√ºnschten Ort. <br>  Die <code>getName</code> <code>getDescription</code> und <code>getName</code> werden lediglich ben√∂tigt, um Informationen anzuzeigen, wenn ein Konsolenbefehl ausgef√ºhrt wird. </p><br><h1 id="senddatacommand">  Senddatacommand </h1><br><p>  Starten Sie das Senden von Daten an Ressourcen von Drittanbietern mit dem Konsolenbefehl <code>SendDataCommand</code> .  Seine Aufgabe besteht darin, Daten f√ºr die Verteilung zu sammeln und dann die <code>send</code> f√ºr jeden der Verteilungsdienste aufzurufen.  Offensichtlich wiederholt dieser Befehl teilweise die Logik der Steuerung, aber nicht in allem. </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Command</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>\<span class="hljs-title"><span class="hljs-title">HealthDataInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>\<span class="hljs-title"><span class="hljs-title">HealthInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>\<span class="hljs-title"><span class="hljs-title">HealthSenderInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Command</span></span>\<span class="hljs-title"><span class="hljs-title">Command</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Input</span></span>\<span class="hljs-title"><span class="hljs-title">InputInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Output</span></span>\<span class="hljs-title"><span class="hljs-title">OutputInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Style</span></span>\<span class="hljs-title"><span class="hljs-title">SymfonyStyle</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Throwable</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SendDataCommand</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Command</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> COMMAND_NAME = <span class="hljs-string"><span class="hljs-string">'health:send-info'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $senders; <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> HealthInterface[] */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $healthServices; <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> SymfonyStyle */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $io; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HealthSenderInterface... $senders)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::__construct(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::COMMAND_NAME); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;senders = $senders; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addHealthService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HealthInterface $healthService)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;healthServices[] = $healthService; } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::configure(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;setDescription(<span class="hljs-string"><span class="hljs-string">'Send health data by senders'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputInterface $input, OutputInterface $output)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::initialize($input, $output); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;io = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SymfonyStyle($input, $output); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputInterface $input, OutputInterface $output)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;io-&gt;title(<span class="hljs-string"><span class="hljs-string">'Sending health info'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { $data = array_map(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HealthInterface $service)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HealthDataInterface</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $service-&gt;getHealthInfo(); }, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;healthServices); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;senders <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $sender) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;outputInfo($sender); $sender-&gt;send($data); } <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;io-&gt;success(<span class="hljs-string"><span class="hljs-string">'Data is sent by all senders'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Throwable $exception) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;io-&gt;error(<span class="hljs-string"><span class="hljs-string">'Exception occurred: '</span></span> . $exception-&gt;getMessage()); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;io-&gt;text($exception-&gt;getTraceAsString()); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">outputInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HealthSenderInterface $sender)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($name = $sender-&gt;getName()) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;io-&gt;writeln($name); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($description = $sender-&gt;getDescription()) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;io-&gt;writeln($description); } } }</code> </pre> <br><p>  <code>HealthServicesPath</code> und schreiben dem Team zus√§tzliche Datenerfassungsdienste. </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Compiler</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Command</span></span>\<span class="hljs-title"><span class="hljs-title">SendDataCommand</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Controller</span></span>\<span class="hljs-title"><span class="hljs-title">HealthController</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>\<span class="hljs-title"><span class="hljs-title">HealthInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Compiler</span></span>\<span class="hljs-title"><span class="hljs-title">CompilerPassInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">ContainerBuilder</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Reference</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthServicesPath</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CompilerPassInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerBuilder $container)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$container-&gt;has(HealthController::class)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } $controller = $container-&gt;findDefinition(HealthController::class); $commandDefinition = $container-&gt;findDefinition(SendDataCommand::class); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (array_keys($container-&gt;findTaggedServiceIds(HealthInterface::TAG)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $serviceId) { $controller-&gt;addMethodCall(<span class="hljs-string"><span class="hljs-string">'addHealthService'</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Reference($serviceId)]); $commandDefinition-&gt;addMethodCall(<span class="hljs-string"><span class="hljs-string">'addHealthService'</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Reference($serviceId)]); } } }</code> </pre> <br><p>  Wie Sie sehen k√∂nnen, akzeptiert der Befehl im Konstruktor ein Array von Absendern.  In diesem Fall k√∂nnen Sie die Funktion zur automatischen Bindung von Abh√§ngigkeiten nicht verwenden. Wir m√ºssen selbst ein Team erstellen und registrieren.  Die Frage ist nur, welche Absenderdienste diesem Befehl hinzugef√ºgt werden sollen.  Wir werden ihre ID in der Bundle-Konfiguration wie folgt angeben: </p><br><pre> <code class="hljs cs">health_check: senders: - <span class="hljs-string"><span class="hljs-string">'@sender.service1'</span></span> - <span class="hljs-string"><span class="hljs-string">'@sender.service2'</span></span></code> </pre> <br><p>  Unser Bundle wei√ü immer noch nicht, wie man mit solchen Konfigurationen umgeht, wir werden es lehren.  Gehen Sie zu <code>Configuration.php</code> und f√ºgen Sie den Konfigurationsbaum hinzu: </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Config</span></span>\<span class="hljs-title"><span class="hljs-title">Definition</span></span>\<span class="hljs-title"><span class="hljs-title">Builder</span></span>\<span class="hljs-title"><span class="hljs-title">TreeBuilder</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Config</span></span>\<span class="hljs-title"><span class="hljs-title">Definition</span></span>\<span class="hljs-title"><span class="hljs-title">ConfigurationInterface</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Configuration</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConfigurationInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConfigTreeBuilder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $treeBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeBuilder(); $rootNode = $treeBuilder-&gt;root(<span class="hljs-string"><span class="hljs-string">'health_check'</span></span>); $rootNode -&gt;children() -&gt;arrayNode(<span class="hljs-string"><span class="hljs-string">'senders'</span></span>) -&gt;scalarPrototype()-&gt;end() -&gt;end() -&gt;end() ; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $treeBuilder; } }</code> </pre> <br><p>  Dieser Code bestimmt, dass der <code>health_check</code> der <code>health_check</code> Knoten ist, der den <code>senders</code> Array- <code>senders</code> , der wiederum eine bestimmte Anzahl von Zeilen enth√§lt.  Das war's, jetzt wei√ü unser Bundle, wie man mit der oben beschriebenen Konfiguration umgeht.  Es ist Zeit, das Team zu registrieren.  Gehen Sie dazu zu <code>HealthCheckExtension</code> und f√ºgen Sie den folgenden Code hinzu: </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Command</span></span>\<span class="hljs-title"><span class="hljs-title">SendDataCommand</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Config</span></span>\<span class="hljs-title"><span class="hljs-title">FileLocator</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">ContainerBuilder</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Definition</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">HttpKernel</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Extension</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Loader</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Reference</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthCheckExtension</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Extension</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment">} */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $configs, ContainerBuilder $container)</span></span></span><span class="hljs-function"> </span></span>{ $configuration = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Configuration(); $config = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;processConfiguration($configuration, $configs); $loader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Loader\YamlFileLoader($container, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileLocator(<span class="hljs-keyword"><span class="hljs-keyword">__DIR__</span></span> . <span class="hljs-string"><span class="hljs-string">'/../Resources/config'</span></span>)); $loader-&gt;load(<span class="hljs-string"><span class="hljs-string">'services.yaml'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    $commandDefinition = new Definition(SendDataCommand::class); //        foreach ($config['senders'] as $serviceId) { $commandDefinition-&gt;addArgument(new Reference($serviceId)); } //       $commandDefinition-&gt;addTag('console.command', ['command' =&gt; SendDataCommand::COMMAND_NAME]); //     $container-&gt;setDefinition(SendDataCommand::class, $commandDefinition); } }</span></span></code> </pre> <br><p>  Das war's, unser Team ist entschlossen.  Jetzt nach dem Hinzuf√ºgen des Bundles zum Projekt, wenn aufgerufen <br>  <code>bin/console</code> Wir sehen eine Liste von Befehlen, einschlie√ülich unserer: <code>health:send-info</code> , Sie k√∂nnen es genauso nennen: <code>bin/console health:send-info</code> </p><br><p>  Unser Bundle ist fertig.  Es ist Zeit, es am Projekt zu testen.  Erstellen Sie ein leeres Projekt: </p><br><pre> <code class="hljs sql">composer <span class="hljs-keyword"><span class="hljs-keyword">create</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">project</span></span> symfony/skeleton health-<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">project</span></span></code> </pre> <br><p>  F√ºgen Sie unser frisch gebackenes Bundle hinzu. Dazu f√ºgen wir den Abschnitt <code>repositories</code> in <code>composer.json</code> : </p><br><pre> <code class="hljs powershell"><span class="hljs-string"><span class="hljs-string">"repositories"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"vcs"</span></span>, <span class="hljs-string"><span class="hljs-string">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://github.com/HEKET313/health-check"</span></span> } ]</code> </pre> <br><p>  Und f√ºhren Sie den Befehl aus: </p><br><pre> <code class="hljs pgsql">composer require niklesh/health-<span class="hljs-keyword"><span class="hljs-keyword">check</span></span></code> </pre> <br><p>  F√ºgen Sie unserem Projekt f√ºr den schnellsten Start einen Symphony-Server hinzu: </p><br><pre> <code class="hljs pgsql">composer req <span class="hljs-comment"><span class="hljs-comment">--dev server</span></span></code> </pre> <br><p>  Das Bundle ist verbunden, Symfony Flex verbindet es automatisch mit <code>config/bundles.php</code> jedoch automatisch Konfigurationsdateien zu erstellen, m√ºssen Sie ein Rezept erstellen.  √úber Rezepte wird in einem anderen Artikel hier wundersch√∂n gemalt: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://habr.com/post/345382/</a> - also malen Sie, wie man Rezepte usw. erstellt.  Ich werde nicht hier sein und es gibt noch kein Rezept f√ºr dieses Bundle. </p><br><p>  Trotzdem werden Konfigurationsdateien ben√∂tigt, also erstellen Sie sie mit Handles: </p><br><ul><li> <code>config/routes/niklesh_health.yaml</code> </li> </ul><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">health_check</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">resource</span></span>: "@<span class="hljs-keyword"><span class="hljs-keyword">HealthCheckBundle</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">Controller</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">HealthController</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">php</span></span>" prefix: / type: annotation</code> </pre> <br><ul><li> <code>config/packages/hiklesh_health.yaml</code> </li> </ul><br><pre> <code class="hljs tex">health_check: senders: - 'App<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Service</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Sender</span></span></span></span>'</code> </pre> <br><p>  Jetzt m√ºssen Sie die Informationssendeklassen f√ºr das Team und die Informationssammelklasse implementieren </p><br><ul><li> <code>src/Service/DataCollector.php</code> </li> </ul><br><p>  Hier ist alles sehr einfach. </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>\<span class="hljs-title"><span class="hljs-title">CommonHealthData</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>\<span class="hljs-title"><span class="hljs-title">HealthDataInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>\<span class="hljs-title"><span class="hljs-title">HealthInterface</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataCollector</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Data collector'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHealthInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HealthDataInterface</span></span></span><span class="hljs-function"> </span></span>{ $data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CommonHealthData(HealthDataInterface::STATUS_OK); $data-&gt;setAdditionalInfo([<span class="hljs-string"><span class="hljs-string">'some_data'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'some_value'</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $data; } }</code> </pre> <br><ul><li> <code>src/Service/Sender.php</code> </li> </ul><br><p>  Und hier ist es noch einfacher </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>\<span class="hljs-title"><span class="hljs-title">HealthDataInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">niklesh</span></span>\<span class="hljs-title"><span class="hljs-title">HealthCheckBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Service</span></span>\<span class="hljs-title"><span class="hljs-title">HealthSenderInterface</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sender</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthSenderInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> HealthDataInterface[] $data */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $data)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Data sent\n"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDescription</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Sender description'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Sender name'</span></span>; } }</code> </pre> <br><p>  Fertig!  Leeren Sie den Cache und starten Sie den Server </p><br><pre> <code class="hljs sql">bin/console <span class="hljs-keyword"><span class="hljs-keyword">cache</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">clear</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bin</span></span>/console <span class="hljs-keyword"><span class="hljs-keyword">server</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">start</span></span></code> </pre> <br><p>  Jetzt k√∂nnen Sie unser Team ausprobieren: </p><br><pre> <code class="hljs pgsql">bin/console health:send-<span class="hljs-keyword"><span class="hljs-keyword">info</span></span></code> </pre> <br><p>  Wir bekommen so ein sch√∂nes Fazit: </p><br><p><img src="https://habrastorage.org/webt/ch/ar/gl/charglyrhdjzuiye04ks1jgu4jm.png" alt="Bild"></p><br><p>  Schlie√ülich klopfen wir auf unserer Route <code>http://127.0.0.1:8000/health</code> und bekommen eine weniger sch√∂ne, aber auch Schlussfolgerung: </p><br><pre> <code class="hljs json">[{<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Data collector"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"info"</span></span>:{<span class="hljs-attr"><span class="hljs-attr">"status"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">"additional_info"</span></span>:{<span class="hljs-attr"><span class="hljs-attr">"some_data"</span></span>:<span class="hljs-string"><span class="hljs-string">"some_value"</span></span>}}}]</code> </pre> <br><p>  Das ist alles!  Ich hoffe, dieses einfache Tutorial hilft jemandem, die Grundlagen des Schreibens von Bundles f√ºr Symfony 4 zu verstehen. </p><br><p>  PS- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellcode finden Sie hier</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de419451/">https://habr.com/ru/post/de419451/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de419439/index.html">Wie E-Commerce gro√ü angelegte Werbeaktionen √ºberlebt. Vorbereitung auf Spitzenlasten im Web [Teil 2]</a></li>
<li><a href="../de419441/index.html">SpaceX verwendet heute erstmals die Rakete Falcon 9 Block 5</a></li>
<li><a href="../de419443/index.html">Die NASA wird wieder zum Mond fliegen und alle Elemente des Flugzeugs herstellen</a></li>
<li><a href="../de419445/index.html">Unit-Tests f√ºr Arduino-Projekte</a></li>
<li><a href="../de419449/index.html">Redux vs. React Context API</a></li>
<li><a href="../de419453/index.html">Numerische Methoden zur L√∂sung nichtlinearer Gleichungssysteme</a></li>
<li><a href="../de419457/index.html">RabbitMQ - SQL Server</a></li>
<li><a href="../de419459/index.html">Blei-S√§ure-Batterien: Pulsladungsalphabet</a></li>
<li><a href="../de419461/index.html">Waschrauml√ºftung</a></li>
<li><a href="../de419467/index.html">Von einer Gl√ºhbirne √ºber einen Staubsauger bis hin zu einer Drohne - wie wir Alice beigebracht haben, Hunderte von Ger√§ten zu verwalten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>