<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ñ´Ô∏è üóÉÔ∏è üçô Die 10 h√§ufigsten Fehler bei der Arbeit mit der Spring-Plattform. Teil 2 üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø üèæ üç´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gru√ü, Chabrowsk. Die √úbersetzung des zweiten Teils eines Artikels, der speziell f√ºr Studenten des Kurses "Developer on the Spring Framework" erstellt ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Die 10 h√§ufigsten Fehler bei der Arbeit mit der Spring-Plattform. Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/465063/">  <i>Gru√ü, Chabrowsk.</i>  <i>Die √úbersetzung des zweiten Teils eines Artikels, der speziell f√ºr Studenten des Kurses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Developer on the Spring Framework" erstellt wurde,</a> kam also rechtzeitig an.</i>  <i>Der erste Teil kann hier gelesen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> .</i> <br><br><img src="https://habrastorage.org/webt/-i/va/66/-iva66o8uvrummnptqda3getv_i.png"><br><br><p>  <font color="gray">Spring ist vielleicht eine der beliebtesten Java-Entwicklungsplattformen.</font>  <font color="gray">Dies ist ein m√§chtiges, aber ziemlich schwer zu erlernendes Werkzeug.</font>  <font color="gray">Die grundlegenden Konzepte sind relativ einfach zu verstehen und zu erlernen, aber es erfordert Zeit und M√ºhe, ein erfahrener Spring-Entwickler zu werden.</font> <font color="gray"><br><br></font>  <font color="gray">In diesem Artikel werden einige der h√§ufigsten Fehler bei der Arbeit in Spring behandelt, die sich insbesondere auf die Entwicklung von Webanwendungen und die Verwendung der Spring Boot-Plattform beziehen.</font>  <font color="gray">Wie auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Spring Boot-Website erw√§hnt</a> , verfolgt Spring Boot einen <i>standardisierten</i> Ansatz zum Erstellen gebrauchsfertiger Anwendungen. Dieser Artikel folgt diesem Ansatz.</font>  <font color="gray">Es enth√§lt eine Reihe von Empfehlungen, die bei der Entwicklung von Standard-Webanwendungen auf Basis von Spring Boot effektiv verwendet werden k√∂nnen.</font> <font color="gray"><br><br></font>  <font color="gray">Falls Sie mit der Spring Boot-Plattform nicht sehr vertraut sind, aber mit den Beispielen in diesem Artikel experimentieren m√∂chten, habe ich ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub-Repository mit zus√§tzlichen Materialien f√ºr diesen Artikel erstellt</a> .</font>  <font color="gray">Wenn Sie beim Lesen dieses Artikels irgendwann etwas verwirrt sind, empfehle ich Ihnen, einen Klon dieses Repositorys zu erstellen und mit dem Code auf Ihrem Computer zu experimentieren.</font> </p><a name="habracut"></a><br><hr><br><h2>  H√§ufiger Fehler Nr. 6: Keine annotationsbasierte Datenvalidierung verwenden </h2><br>  Stellen wir uns vor, unser TopTalent-Service aus den vorherigen Beispielen ben√∂tigt einen Endpunkt, um neue TopTalent-Daten hinzuzuf√ºgen.  Nehmen wir au√üerdem an, dass aus einem wirklich wichtigen Grund jeder Name, den Sie hinzuf√ºgen, genau 10 Zeichen lang sein muss.  Dies kann beispielsweise wie folgt implementiert werden: <br><br><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/put"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@RequestBody TopTalentData topTalentData)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> nameNonExistentOrHasInvalidLength = Optional.ofNullable(topTalentData) .map(TopTalentData::getName) .map(name -&gt; name.length() == <span class="hljs-number"><span class="hljs-number">10</span></span>) .orElse(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nameNonExistentOrInvalidLength) { <span class="hljs-comment"><span class="hljs-comment">//   } topTalentService.addTopTalent(topTalentData); }</span></span></code> </pre> <br>  Der obige Code ist jedoch nicht nur schlecht strukturiert, sondern auch keine ‚Äûsaubere‚Äú L√∂sung.  Wir f√ºhren verschiedene Arten der Daten√ºberpr√ºfung durch ( <code>TopTalentData</code> wir √ºberpr√ºfen, ob das <code>TopTalentData</code> Objekt nicht null ist, ob der Wert des Felds TopTalentData.name nicht null ist und ob die L√§nge des <code>TopTalentData.name</code> 10 Zeichen betr√§gt) und <code>TopTalentData.name</code> auch eine Ausnahme aus, wenn die Daten falsch sind. <br><br>  All dies kann mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hibernate-Validator</a> im Fr√ºhjahr genauer durchgef√ºhrt werden.  <code>addTopTalent</code> wir zun√§chst die <code>addTopTalent</code> Methode neu und unterst√ºtzen die Datenvalidierung: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/put"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Valid @NotNull @RequestBody TopTalentData topTalentData)</span></span></span><span class="hljs-function"> </span></span>{ topTalentService.addTopTalent(topTalentData); } <span class="hljs-meta"><span class="hljs-meta">@ExceptionHandler</span></span> <span class="hljs-meta"><span class="hljs-meta">@ResponseStatus</span></span>(HttpStatus.BAD_REQUEST) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ErrorResponse </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleInvalidTopTalentDataException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MethodArgumentNotValidException methodArgumentNotValidException)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    }</span></span></code> </pre> <br>  Dar√ºber hinaus m√ºssen wir angeben, welche Eigenschafts√ºberpr√ºfung in der <code>TopTalentData</code> Klasse durchgef√ºhrt werden soll: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Length</span></span>(min = <span class="hljs-number"><span class="hljs-number">10</span></span>, max = <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; }</code> </pre> <br>  Spring f√§ngt jetzt die Anforderung ab und √ºberpr√ºft sie, bevor die Methode aufgerufen wird, sodass keine zus√§tzlichen manuellen √úberpr√ºfungen erforderlich sind. <br><br>  Das gew√ºnschte Ziel kann auch erreicht werden, indem Sie Ihre eigenen Anmerkungen erstellen.  Unter realen Bedingungen ist es normalerweise sinnvoll, eigene Anmerkungen nur dann zu verwenden, wenn Ihre Anforderungen die Funktionen der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">integrierten Einschr√§nkungen</a> f√ºr den <code>@Length</code> Stellen <code>@Length</code> diesem Beispiel jedoch vor, dass <code>@Length</code> Anmerkungen nicht vorhanden sind.  Sie k√∂nnen einen Datenvalidator erstellen, der die L√§nge einer Zeichenfolge √ºberpr√ºft, indem Sie zwei zus√§tzliche Klassen erstellen: eine zur Validierung und eine zum Kommentieren von Eigenschaften: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Target</span></span>({ElementType.METHOD, ElementType.FIELD, ElementType.PARAMETER}) <span class="hljs-meta"><span class="hljs-meta">@Retention</span></span>(RetentionPolicy.RUNTIME) <span class="hljs-meta"><span class="hljs-meta">@Documented</span></span> <span class="hljs-meta"><span class="hljs-meta">@Constraint</span></span>(validatedBy = { MyAnnotationValidator.class }) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-meta"><span class="hljs-meta">@interface</span></span> MyAnnotation { <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">default</span></span></span><span class="hljs-function"> "String length does not match expected"</span></span>; Class&lt;?&gt;[] groups() <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> {}; Class&lt;? extends Payload&gt;[] payload() <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> {}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyAnnotationValidator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConstraintValidator</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyAnnotation</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> expectedLength; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MyAnnotation myAnnotation)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.expectedLength = myAnnotation.value(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isValid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s, ConstraintValidatorContext constraintValidatorContext)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || s.length() == <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.expectedLength; } }</code> </pre> <br><br>  Bitte beachten Sie, dass in diesen F√§llen f√ºr die korrekte Anwendung des Grundsatzes der Aufgabentrennung die Eigenschaft als g√ºltig markiert werden muss, wenn ihr Wert null ist <code>(s == null</code> in der <code>isValid</code> Methode), und dann die Annotation <code>@NotNull</code> wenn dies f√ºr diese Eigenschaft zus√§tzlich erforderlich ist: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@MyAnnotation</span></span>(value = <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; }</code> </pre> <br><h2>  H√§ufiger Fehler Nr. 7: Verwenden √§lterer XML-basierter Konfigurationen </h2><br>  Die Verwendung von XML war eine Notwendigkeit bei der Arbeit mit fr√ºheren Versionen von Spring, aber jetzt k√∂nnen die meisten Konfigurationsaufgaben mithilfe von Java-Code und Anmerkungen implementiert werden.  XML-Konfigurationen fungieren jetzt als zus√§tzlicher und optionaler Vorlagencode. <br><br>  In diesem Artikel (und auch in den zugeh√∂rigen GitHub-Repository-Materialien) werden Annotationen zum Konfigurieren von Spring verwendet, und Spring wei√ü, welche JavaBean-Komponenten gebunden werden m√ºssen, da das Root-Paket mithilfe der zusammengesetzten Annotation @SpringBootApplication mit Annotationen versehen wird - wie folgt: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@SpringBootApplication</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ SpringApplication.run(Application.class, args); } }</code> </pre> <br>  Diese zusammengesetzte Anmerkung (weitere Informationen hierzu finden Sie in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spring-Dokumentation</a> ) teilt der Spring-Plattform lediglich mit, welche Pakete gescannt werden m√ºssen, um die JavaBean-Komponenten zu extrahieren.  In unserem speziellen Fall bedeutet dies, dass die folgenden co.kukurin-Unterpakete zum Binden verwendet werden: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Komponente</a> (TopTalentConverter, MyAnnotationValidator) </li><li>  @ RestController (TopTalentController) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Repository</a> (TopTalentRepository) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Service-</a> Klassen (TopTalentService) </li></ul><br>  Wenn wir zus√§tzliche Klassen mit der Annotation <code>@Configuration</code> , werden diese auch auf Java-Konfiguration √ºberpr√ºft. <br><br><h2>  H√§ufiger Fehler Nr. 8: Keine Verwendung von Konfigurationsprofilen </h2><br>  Bei der Entwicklung von Serversystemen besteht ein h√§ufiges Problem darin, zwischen verschiedenen Konfigurationen zu wechseln (dies sind in der Regel Konfigurationen f√ºr die Betriebs- und Entwicklungsumgebung).  Anstatt verschiedene Parameter bei jedem √úbergang zwischen Test- und Betriebsmodus manuell zu √§ndern, ist es effizienter, Konfigurationsprofile zu verwenden. <br><br>  Stellen Sie sich den Fall vor, wenn Sie in der lokalen Entwicklungsumgebung die Datenbank im RAM verwenden und in der Umgebung des tats√§chlichen Betriebs Ihrer Anwendung die MySQL-Datenbank verwendet wird.  Dies bedeutet im Wesentlichen, dass Sie unterschiedliche URLs und vermutlich unterschiedliche Anmeldeinformationen verwenden, um auf jede dieser Datenbanken zuzugreifen.  Mal sehen, wie dies mit zwei Konfigurationsdateien implementiert werden kann: <br><br>  <b>DATEI ANWENDUNG.YAML</b> <br><br><pre> <code class="java hljs"># set <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> profile to <span class="hljs-string"><span class="hljs-string">'dev'</span></span> spring.profiles.active: dev # production database details spring.datasource.url: <span class="hljs-string"><span class="hljs-string">'jdbc:mysql://localhost:3306/toptal'</span></span> spring.datasource.username: root spring.datasource.password:</code> </pre> <br><br>  <b>DATEI ANWENDUNG-DEV.YAML</b> <br><br><pre> <code class="java hljs">spring.datasource.url: <span class="hljs-string"><span class="hljs-string">'jdbc:h2:mem:'</span></span> spring.datasource.platform: h2</code> </pre> <br><br>  Es muss davon ausgegangen werden, dass Sie beim Arbeiten mit Code keine zuf√§lligen Aktionen mit einer f√ºr die Betriebsumgebung bestimmten Datenbank ausf√ºhren m√∂chten. Daher ist es sinnvoll, das Profil f√ºr die Entwicklungsumgebung (DEV) als Standardprofil auszuw√§hlen.  Anschlie√üend k√∂nnen Sie das Konfigurationsprofil auf dem Server manuell √ºberschreiben, indem Sie <code>-Dspring.profiles.active=prod</code> f√ºr die JVM <code>-Dspring.profiles.active=prod</code> .  Dar√ºber hinaus kann das Standardkonfigurationsprofil in der Umgebungsvariablen des Betriebssystems angegeben werden. <br><br><h2>  H√§ufiger Fehler Nummer 9. Fehler beim Verwenden des Abh√§ngigkeitsinjektionsmechanismus </h2><br>  Durch die ordnungsgem√§√üe Verwendung des Abh√§ngigkeitsinjektionsmechanismus in Spring kann Spring alle Ihre Objekte binden, indem alle erforderlichen Konfigurationsklassen gescannt werden.  Dies ist n√ºtzlich, um Abh√§ngigkeiten zu l√∂sen, und erleichtert das Testen erheblich.  Anstatt Klassen eng miteinander zu verkn√ºpfen, gilt Folgendes: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentService topTalentService; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.topTalentService = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TopTalentService(); } }</code> </pre> <br>  ... wir lassen die Spring-Plattform binden: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentService topTalentService; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TopTalentService topTalentService)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.topTalentService = topTalentService; } }</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">In Mishko Heverys Vortrag auf dem Google Tech Talks-Kanal wird</a> ausf√ºhrlich erkl√§rt, warum die Abh√§ngigkeitsinjektion verwendet werden sollte. Hier sehen wir jedoch, wie dieser Mechanismus in der Praxis angewendet wird.  In der Aufteilung der Verantwortung (‚ÄûCommon Mistake # 3‚Äú) haben wir die Service- und Controller-Klassen erstellt.  Angenommen, wir m√∂chten einen Controller testen, vorausgesetzt, die <code>TopTalentService</code> Klasse funktioniert ordnungsgem√§√ü.  Wir k√∂nnen ein Simulatorobjekt anstelle der aktuellen Service-Implementierung einf√ºgen, indem wir eine separate Konfigurationsklasse erstellen: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SampleUnitTestConfig</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> TopTalentService </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">topTalentService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ TopTalentService topTalentService = Mockito.mock(TopTalentService.class); Mockito.when(topTalentService.getTopTalent()).thenReturn( Stream.of(<span class="hljs-string"><span class="hljs-string">"Mary"</span></span>, <span class="hljs-string"><span class="hljs-string">"Joel"</span></span>).map(TopTalentData::<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>).collect(Collectors.toList())); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentService; } }</code> </pre> <br>  Danach k√∂nnen wir das Simulatorobjekt implementieren, <code>SampleUnitTestConfig</code> wir <code>SampleUnitTestConfig</code> Spring-Plattform <code>SampleUnitTestConfig</code> dass wir <code>SampleUnitTestConfig</code> als Konfigurationsquelle verwenden m√ºssen: <br> <code>@ContextConfiguration(classes = { SampleUnitTestConfig.class })</code> <br> <br>  Anschlie√üend k√∂nnen wir die kontextbezogene Konfiguration verwenden, um die benutzerdefinierte JavaBean-Komponente in einen Komponententest einzubetten. <br><br><h2>  H√§ufiger Fehler Nummer 10. Fehlende oder falsche Tests </h2><br>  Trotz der Tatsache, dass die Idee des Unit-Tests keineswegs neu ist, scheinen viele Entwickler sie entweder zu "vergessen" (insbesondere wenn sie <i>nicht obligatorisch sind</i> ) oder sie zu sp√§t auszugeben.  Dies ist offensichtlich falsch, da Sie mit den Tests nicht nur die korrekte Funktionsweise des Codes √ºberpr√ºfen k√∂nnen, sondern auch als Dokumentation dienen, die zeigt, wie sich die Anwendung in verschiedenen Situationen verhalten sollte. <br>  Beim Testen von Webdiensten f√ºhren Sie selten au√üergew√∂hnlich ‚Äûsaubere‚Äú Komponententests durch, da Sie f√ºr eine HTTP-Verbindung normalerweise das Spring <code>DispatcherServlet</code> Servlet verwenden m√ºssen, um zu sehen, was passiert, wenn Sie eine echte <code>HttpServletRequest</code> Anforderung erhalten ( <code>HttpServletRequest</code> es handelt sich um einen <i>Integrationstest</i> , der verwendet wird Validierung, Serialisierung usw.).  Eine elegante und bew√§hrte L√∂sung ist die Verwendung von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">REST Assured</a> , einer Java-Bibliothek zum bequemen Testen von REST-Diensten mit MockMVC.  Betrachten Sie das folgende Codefragment mit Abh√§ngigkeitsinjektion: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith</span></span>(SpringJUnit4ClassRunner.class) <span class="hljs-meta"><span class="hljs-meta">@ContextConfiguration</span></span>(classes = { Application.class, SampleUnitTestConfig.class }) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RestAssuredTestDemonstration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TopTalentController topTalentController; <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shouldGetMaryAndJoel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// given MockMvcRequestSpecification givenRestAssuredSpecification = RestAssuredMockMvc.given() .standaloneSetup(topTalentController); // when MockMvcResponse response = givenRestAssuredSpecification.when().get("/toptal/get"); // then response.then().statusCode(200); response.then().body("name", hasItems("Mary", "Joel")); } }</span></span></code> </pre> <br>  <code>SampleUnitTestConfig</code> bindet die <code>TopTalentService</code> der <code>TopTalentService</code> Klasse an den <code>TopTalentController</code> , und alle anderen Klassen werden unter Verwendung der Standardkonfiguration gebunden, die durch das Scannen von Paketen basierend auf dem Paket der Application-Klasse erhalten wird.  <code>RestAssuredMockMvc</code> einfach verwendet, um eine <code>RestAssuredMockMvc</code> Umgebung einzurichten und eine <code>GET</code> Anforderung an den <code>/toptal/get</code> senden. <br><br><h3>  Verwenden Sie Spring professionell </h3><br>  Spring ist eine leistungsstarke Plattform, mit der man leicht anfangen kann, die jedoch Zeit und M√ºhe ben√∂tigt, um sie vollst√§ndig zu beherrschen.  Wenn Sie sich die Zeit nehmen, sich mit dieser Plattform vertraut zu machen, wird dies zweifellos die Effizienz Ihrer Arbeit steigern, Ihnen helfen, saubereren Code zu erstellen und Ihre Qualifikationen als Entwickler zu verbessern. <br><br>  Ich empfehle Ihnen, auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spring In Action zu</a> achten - dies ist ein gutes, anwendungsorientiertes Buch, in dem viele wichtige Themen im Zusammenhang mit der Spring-Plattform behandelt werden. <br><br>  Zu diesem Zeitpunkt wurde die √úbersetzung dieses Artikels beendet. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lesen Sie den ersten Teil</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de465063/">https://habr.com/ru/post/de465063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de465049/index.html">10 B√ºcher √ºber agiles Projektmanagement, die es wert sind, 2020 mitgenommen zu werden</a></li>
<li><a href="../de465055/index.html">Sechs F√§higkeiten, um Ihre Data Science-Karriere auf die n√§chste Stufe zu bringen.</a></li>
<li><a href="../de465057/index.html">Container und Windows. Von Hello World zu Kubernetes. Erster Teil, Einf√ºhrung</a></li>
<li><a href="../de465059/index.html">PoE in einer Entfernung von mehr als 200 Metern. √úberwachung und automatischer Neustart von PoE-Clients</a></li>
<li><a href="../de465061/index.html">Warum ist es besser, anstelle einer viert√§gigen Arbeitswoche an einen sechsst√ºndigen Arbeitstag zu denken?</a></li>
<li><a href="../de465069/index.html">Neu in Hadoop: Lernen Sie die verschiedenen Dateiformate in Hadoop kennen</a></li>
<li><a href="../de465071/index.html">TechTrain 2019 IT Festival: Wie JUG.ru, JUGNsk und JUG.MSK daran teilnahmen</a></li>
<li><a href="../de465073/index.html">Nicht auftauchen! Unterbrechbare √úberg√§nge in iOS</a></li>
<li><a href="../de465075/index.html">In der Fahrerkabine</a></li>
<li><a href="../de465077/index.html">Unsafe.AsSpan: Span <T> Wie werden Zeiger ersetzt?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>