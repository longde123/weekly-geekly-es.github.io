<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé∫ üçï ‚¨ÖÔ∏è D√©tection de visages sur vid√©o: Raspberry Pi et Neural Compute Stick üëµ ü§¥ üòî</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a environ un an, Intel Movidius a publi√© un appareil permettant une inf√©rence efficace des r√©seaux de neurones convolutifs - Movidius Neural Comp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√©tection de visages sur vid√©o: Raspberry Pi et Neural Compute Stick</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424973/">  Il y a environ un an, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Intel Movidius a</a> publi√© un appareil permettant une inf√©rence efficace des r√©seaux de neurones convolutifs - Movidius Neural Compute Stick (NCS).  Ce dispositif permet l'utilisation de r√©seaux de neurones pour la reconnaissance ou la d√©tection d'objets dans des conditions de consommation √©nerg√©tique limit√©e, y compris dans des t√¢ches de robotique.  NCS a une interface USB et ne consomme pas plus de 1 watt.  Dans cet article, je parlerai de l'exp√©rience de l'utilisation de NCS avec le Raspberry Pi pour d√©tecter des visages en vid√©o, y compris √† la fois former le d√©tecteur Mobilenet-SSD et le lancer sur Raspberry. <br><br>  Tout le code se trouve dans mes deux r√©f√©rentiels: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">formation aux d√©tecteurs</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©mos de d√©tection de visages</a> . <br><br><img src="https://habrastorage.org/webt/qu/b_/tj/qub_tj1u6ztw9irfy9ivtaaidcc.jpeg"><br><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dans mon premier article,</a> j'avais d√©j√† √©crit sur la d√©tection des visages √† l'aide de NCS: on parlait alors d'un d√©tecteur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">YOLOv2</a> , que j'ai converti du format <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Darknet au</a> format <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Caffe</a> , puis lanc√© sur NCS.  Le processus de conversion s'est av√©r√© non trivial: √©tant donn√© que ces deux formats d√©finissent la derni√®re couche du d√©tecteur de diff√©rentes mani√®res, la sortie du r√©seau neuronal a d√ª √™tre analys√©e s√©par√©ment, sur le CPU, √† l'aide d'un morceau de code de Darknet.  De plus, ce d√©tecteur ne m'a pas satisfait √† la fois en vitesse (jusqu'√† 5,1 FPS sur mon ordinateur portable) et en pr√©cision - plus tard, j'ai √©t√© convaincu qu'en raison de sa sensibilit√© √† la qualit√© d'image, il √©tait difficile d'obtenir un bon r√©sultat sur Raspberry Pi. <br><br>  Finalement, j'ai d√©cid√© de former mon d√©tecteur.  Le choix s'est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">port√©</a> sur le d√©tecteur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SSD</a> avec encodeur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mobilenet</a> : la convolution l√©g√®re de Mobilenet vous permet d'atteindre une vitesse √©lev√©e sans aucune perte de qualit√©, et le d√©tecteur SSD n'est pas inf√©rieur √† YOLO et fonctionne sur le NCS d√®s le d√©part. <br><br><div class="spoiler">  <b class="spoiler_title">Fonctionnement du d√©tecteur Mobilenet-SSD</b> <div class="spoiler_text">  Commen√ßons par Mobilenet.  Dans cette architecture est compl√®te <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>3</mn><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>3</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.205ex" height="2.486ex" viewBox="0 -772.3 3102 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-33" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-66" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-6F" x="1301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-69" x="1786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="2132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-33" x="2601" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-1"> 3 \ fois 3 </script>  la convolution (sur tous les canaux) est remplac√©e par deux convolutions l√©g√®res: d'abord <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>3</mn><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>3</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.205ex" height="2.486ex" viewBox="0 -772.3 3102 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-33" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-66" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-6F" x="1301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-69" x="1786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="2132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-33" x="2601" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-2"> 3 \ fois 3 </script>  s√©par√©ment pour chaque canal, puis terminer <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.205ex" height="2.486ex" viewBox="0 -772.3 3102 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-66" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-6F" x="1301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-69" x="1786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="2132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-31" x="2601" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-3"> 1 \ fois 1 </script>  convolution.  Apr√®s chaque convolution, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BatchNorm</a> et Non- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">linearity</a> (ReLU) sont utilis√©s.  La toute premi√®re convolution du r√©seau recevant une image en entr√©e est g√©n√©ralement laiss√©e compl√®te.  Cette architecture peut r√©duire consid√©rablement la complexit√© des calculs en raison d'une l√©g√®re diminution de la qualit√© des pr√©visions.  Il existe une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">option plus avanc√©e</a> , mais je ne l'ai pas encore essay√©e. <br><br>  Le SSD (Single Shot Detector) fonctionne comme ceci: sur les sorties de plusieurs encodeurs √† convolution sont accroch√©s en deux <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.205ex" height="2.486ex" viewBox="0 -772.3 3102 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-66" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-6F" x="1301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-69" x="1786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="2132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-31" x="2601" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-4"> 1 \ fois 1 </script>  couche convolutionnelle: l'une pr√©dit les probabilit√©s des classes, l'autre - les coordonn√©es de la bo√Æte englobante.  Il y a un troisi√®me calque qui donne les coordonn√©es et les positions des images par d√©faut au niveau actuel.  La signification est: la sortie de n'importe quelle couche est naturellement divis√©e en cellules;  plus pr√®s de la fin du r√©seau neuronal, ils deviennent plus petits (dans ce cas, en raison de la convolution avec <code>stride=2</code> ), et le champ de vision de chaque cellule augmente.  Pour chaque cellule de chacune des couches s√©lectionn√©es, nous d√©finissons plusieurs images par d√©faut de diff√©rentes tailles et avec diff√©rents rapports d'aspect, et utilisons des couches convolutionnelles suppl√©mentaires pour corriger les coordonn√©es et pr√©dire les probabilit√©s de classe pour chacune de ces images.  Par cons√©quent, un d√©tecteur SSD (comme YOLO) consid√®re toujours le m√™me nombre de trames.  Le m√™me objet peut √™tre d√©tect√© sur diff√©rentes couches: pendant l'entra√Ænement, le signal est envoy√© √† toutes les trames qui se croisent assez fortement avec l'objet, et pendant l'application, les d√©tections sont combin√©es en utilisant la suppression non maximale (NMS).  La couche finale combine les d√©tections de toutes les couches, consid√®re leurs coordonn√©es compl√®tes, coupe le seuil de probabilit√© et produit le NMS. <br></div></div><br><h2>  Formation des d√©tecteurs </h2><br><h3>  L'architecture </h3><br>  Le code pour la formation du d√©tecteur se trouve <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  J'ai d√©cid√© d'utiliser le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©tecteur Mobilenet-SSD pr√™t √†</a> l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">emploi</a> form√© sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PASCAL VOC0712</a> et de l'entra√Æner √† d√©tecter les visages.  Premi√®rement, cela aide √† entra√Æner le filet beaucoup plus rapidement, et deuxi√®mement, vous n‚Äôavez pas √† r√©inventer la roue. <br><br>  Le projet d'origine comprenait le script <code>gen.py</code> , qui collectait litt√©ralement le fichier de mod√®le <code>.prototxt</code> , en rempla√ßant les param√®tres d'entr√©e.  Je l'ai transf√©r√© √† mon projet, √©tendant un peu la fonctionnalit√©.  Ce script vous permet de g√©n√©rer quatre types de fichiers de configuration: <br><br><ul><li>  <b>train</b> : √† l'entr√©e - une base de formation LMDB, √† la sortie - une couche avec le calcul de la fonction de perte et de ses gradients, il y a BatchNorm </li><li>  <b>test</b> : en entr√©e - la base de test LMDB, en sortie - la couche avec le calcul de qualit√© (pr√©cision moyenne moyenne), il y a BatchNorm </li><li>  <b>d√©ployer</b> : √† l'entr√©e - l'image, √† la sortie - la couche avec pr√©dictions, BatchNorm est manquant </li><li>  <b>deploy_bn</b> : √† l'entr√©e - l'image, √† la sortie - la couche avec pr√©dictions, il y a BatchNorm </li></ul><br>  J'ai ajout√© cette derni√®re option plus tard, afin que dans les scripts, vous puissiez charger et convertir la grille √† partir de BatchNorm sans toucher √† la base de donn√©es LMDB - sinon, en l'absence de la base de donn√©es, rien ne fonctionnerait.  (En g√©n√©ral, il me semble √©trange que dans Caffe, la source de donn√©es soit d√©finie dans l'architecture du r√©seau - ce n'est au moins pas tr√®s pratique). <br><br><div class="spoiler">  <b class="spoiler_title">√Ä quoi ressemble l'architecture de r√©seau (courte)</b> <div class="spoiler_text"><ul><li>  Identifiant: <math></math><img src="https://habrastorage.org/getpro/habr/formulas/fb6/356/c0b/fb6356c0b081e303d042c274fb3eb600.svg" alt="300 $ \ fois 300 \ fois 3 $" data-tex="inline"></li><li>  <b>Conv conv conv conv</b> : 32 canaux, <code>stride=2</code> </li><li>  Mobilenet convolution <b>conv1 - conv11</b> : 64, 128, 128, 256, 256, 512 ... 512 canaux, certains ont une <code>stride=2</code> </li><li>  Couche de d√©tection: <math></math><img src="https://habrastorage.org/getpro/habr/formulas/991/8ae/ef0/9918aeef0ab8bbc5667b520d7731af67.svg" alt="19 $ \ fois 19 \ fois 512 $" data-tex="inline"></li><li>  Mobilenet convolution <b>conv12, conv13</b> : 1024 canaux, <b>conv12</b> a <code>stride=2</code> </li><li>  Couche de d√©tection: <math></math><img src="https://habrastorage.org/getpro/habr/formulas/a74/ae4/ee1/a74ae4ee12be96ffb79eb0564f9cd9e8.svg" alt="10 $ \ fois 10 \ fois 1024 $" data-tex="inline"></li><li>  <b>Convolution</b> compl√®te <b>conv14_1, conv14_2</b> : 256, 512 canaux, le premier <code>kernel_size=1</code> , le deuxi√®me <code>stride=2</code> </li><li>  Couche de d√©tection: <math></math><img src="https://habrastorage.org/getpro/habr/formulas/f4e/522/dc2/f4e522dc29018777f5c5f07afb43969f.svg" alt="5 $ \ fois 5 \ fois 512 $" data-tex="inline"></li><li>  <b>Convolution</b> compl√®te <b>conv15_1, conv15_2</b> : 128, 256 canaux, le premier <code>kernel_size=1</code> , le deuxi√®me <code>stride=2</code> </li><li>  Couche de d√©tection: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>3</mn><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>3</mn><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>256</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.572ex" height="2.486ex" viewBox="0 -772.3 6704.5 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-33" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-66" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-6F" x="1301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-69" x="1786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="2132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-33" x="2601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-66" x="3352" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-6F" x="3902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-69" x="4388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="4733" y="0"></use><g transform="translate(5203,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-36" x="1001" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>3</mn><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>256</mn></math></span></span><script type="math/tex" id="MathJax-Element-5"> 3 \ fois 3 \ fois 256 </script></li><li>  <b>Conv16_1</b> compl√®tes <b>, conv16_2 convolutions</b> : 128, 256 canaux, le premier <code>kernel_size=1</code> , le deuxi√®me <code>stride=2</code> </li><li>  Couche de d√©tection: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>256</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.572ex" height="2.486ex" viewBox="0 -772.3 6704.5 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-66" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-6F" x="1301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-69" x="1786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="2132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-32" x="2601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-66" x="3352" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-6F" x="3902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-69" x="4388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="4733" y="0"></use><g transform="translate(5203,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-36" x="1001" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>2</mn><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>256</mn></math></span></span><script type="math/tex" id="MathJax-Element-6"> 2 \ fois 2 \ fois 256 </script></li><li>  <b>Convolution</b> compl√®te <b>conv17_1, conv17_2</b> : 64, 128 canaux, le premier <code>kernel_size=1</code> , le deuxi√®me <code>stride=2</code> </li><li>  Couche de d√©tection: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>1</mn><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>128</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.572ex" height="2.486ex" viewBox="0 -772.3 6704.5 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-66" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-6F" x="1301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-69" x="1786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="2132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-31" x="2601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-66" x="3352" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-6F" x="3902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-69" x="4388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="4733" y="0"></use><g transform="translate(5203,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-38" x="1001" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>1</mn><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mn>128</mn></math></span></span><script type="math/tex" id="MathJax-Element-7"> 1 \ fois 1 \ fois 128 </script></li><li>  Sortie de d√©tection de la couche finale </li></ul><br></div></div><br>  J'ai l√©g√®rement corrig√© l'architecture du r√©seau.  Liste des changements: <br><br><ul><li>  √âvidemment, le nombre de classes est pass√© √† 1 (sans compter l'arri√®re-plan). </li><li>  Limitations du rapport d'aspect des patchs coup√©s pendant l'entra√Ænement: chang√© de <math></math><img src="https://habrastorage.org/getpro/habr/formulas/411/a3b/4cf/411a3b4cf9619abebebcbd3700b0ac1b.svg" alt="[0,5,2,0] $" data-tex="inline">  sur <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>1.4</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.658ex" height="2.66ex" viewBox="0 -832 3727.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-37" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-2C" x="1724" y="0"></use><g transform="translate(2169,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-34" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-5D" x="3449" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>1.4</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-8"> [0,7,1.4] </script>  (J'ai d√©cid√© de simplifier un peu la t√¢che et de ne pas apprendre des images trop √©tir√©es). </li><li>  Des cadres par d√©faut, il ne restait que des carr√©s, deux pour chaque cellule.  J'ai consid√©rablement r√©duit leur taille, car les visages sont nettement plus petits que les objets dans le probl√®me classique de d√©tection d'objets. </li></ul><br>  Caffe calcule les tailles d'image par d√©faut comme suit: avoir une taille d'image minimale <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="1.455ex" viewBox="0 -520.7 469.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> s </script>  et maximum <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-4C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> L </script>  , il cr√©e un petit et grand cadre aux dimensions <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="1.455ex" viewBox="0 -520.7 469.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> s </script>  et <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>L</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.302ex" height="2.419ex" viewBox="0 -780.1 3144 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-71" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-72" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-74" x="1631" y="0"></use><g transform="translate(1993,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-4C" x="469" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>L</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-12"> \ sqrt {sL} </script>  .  Comme je voulais d√©tecter le plus petit visage possible, j'ai calcul√© la <code>stride</code> compl√®te pour chaque couche de d√©tection et lui ai √©gal√© la taille d'image minimale.  Avec ces param√®tres, les petits cadres par d√©faut seront situ√©s les uns √† c√¥t√© des autres et ne se couperont pas.  Nous avons donc au moins une garantie que l'intersection avec l'objet existera pour une sorte de cadre.  J'ai d√©fini la taille maximale deux fois plus.  Pour les couches <b>conv16_2, conv17_2,</b> j'ai d√©fini les dimensions de l'≈ìil pour qu'elles soient identiques.  De cette fa√ßon <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mo>,</mo><mi>L</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.707ex" height="2.419ex" viewBox="0 -780.1 1596.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMAIN-2C" x="469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhjKPhCQ7ayJWKcXLDXcG0s8U_9mPw#MJMATHI-4C" x="914" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>,</mo><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> s, L </script>  pour toutes les couches √©taient: <math></math><img src="https://habrastorage.org/getpro/habr/formulas/ed2/f2d/5cd/ed2f2d5cdc06d4a3f8e0bb261fd4e006.svg" alt="(16,32), (32,64), (64 128), (128 214), (214 300), (214 300) $" data-tex="inline"><br><br><div class="spoiler">  <b class="spoiler_title">A quoi ressemblent certaines images par d√©faut (bruit pour plus de clart√©)</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/j9/ti/gj/j9tigjn9tq7sdz6m3tyxa1v2r9s.png"><br></div></div><br><h3>  Les donn√©es </h3><br>  J'ai utilis√© deux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">jeux de donn√©es</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WIDER Face</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">FDDB</a> .  WIDER contient de nombreuses images avec des visages tr√®s petits et flous, et FDDB est plus enclin √† de grandes images de visages (et un ordre de grandeur plus petit que WIDER).  Le format d'annotation y est l√©g√®rement diff√©rent, mais ce sont d√©j√† des d√©tails. <br><br>  Je n'ai pas utilis√© toutes les donn√©es pour la formation: j'ai jet√© des visages trop petits (moins de six pixels ou moins de 2% de la largeur de l'image), jet√© toutes les images avec un rapport d'aspect inf√©rieur √† 0,5 ou plus de 2, jet√© toutes les images marqu√©es comme "floues" dans le jeu de donn√©es WIDER, car ils correspondaient pour la plupart √† de tr√®s petites personnes, et je devais au moins en quelque sorte aligner le rapport des petits et des grands visages.  Apr√®s cela, j'ai fait tous les cadres carr√©s, en √©largissant le plus petit c√¥t√©: j'ai d√©cid√© que je n'√©tais pas tr√®s int√©ress√© par les proportions du visage, et la t√¢che pour le r√©seau neuronal √©tait un peu simplifi√©e.  J'ai √©galement jet√© toutes les images en noir et blanc, dont il y avait peu, et sur lesquelles le script de construction de la base de donn√©es se bloque. <br><br>  Pour les utiliser pour la formation et les tests, vous devez assembler une base LMDB √† partir d'eux.  Comment faire: <br><br><ul><li>  Pour chaque image, le balisage est cr√©√© au format <code>.xml</code> . </li><li>  Un fichier <code>train.txt</code> est <code>train.txt</code> avec des lignes de la forme <code>"path/to/image.png path/to/labels.xml"</code> , le m√™me est cr√©√© pour le test. </li><li>  Un fichier <code>test_name_size.txt</code> est <code>test_name_size.txt</code> avec des lignes de la forme <code>"test_image_name height width"</code> </li><li>  Cr√©e un fichier <code>labelmap.prototxt</code> avec des correspondances d' <code>labelmap.prototxt</code> num√©riques </li></ul><br><br>  Le <code>ssd-caffe/scripts/create_annoset.py</code> (exemple du Makefile): <br><br><pre> <code class="bash hljs">python3 /opt/movidius/ssd-caffe/scripts/create_annoset.py --anno-type=detection \ --label-map-file=$(wider_dir)/labelmap.prototxt --min-dim=0 --max-dim=0 \ --resize-width=0 --resize-height=0 --check-label --encode-type=jpg --encoded \ --redo $(wider_dir) \ $(wider_dir)/trainval.txt $(wider_dir)/WIDER_train/lmdb/wider_train_lmdb ./data</code> </pre><br><div class="spoiler">  <b class="spoiler_title">labelmap.prototxt</b> <div class="spoiler_text"><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">item</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">name</span></span>: <span class="hljs-string"><span class="hljs-string">"none_of_the_above"</span></span> label: <span class="hljs-number"><span class="hljs-number">0</span></span> display_name: <span class="hljs-string"><span class="hljs-string">"background"</span></span> } <span class="hljs-selector-tag"><span class="hljs-selector-tag">item</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">name</span></span>: <span class="hljs-string"><span class="hljs-string">"face"</span></span> label: <span class="hljs-number"><span class="hljs-number">1</span></span> display_name: <span class="hljs-string"><span class="hljs-string">"face"</span></span> }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Exemple de balisage .xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">annotation</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">width</span></span></span><span class="hljs-tag">&gt;</span></span>348<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">width</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">height</span></span></span><span class="hljs-tag">&gt;</span></span>450<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">height</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depth</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depth</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>face<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bndbox</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xmin</span></span></span><span class="hljs-tag">&gt;</span></span>161<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xmin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ymin</span></span></span><span class="hljs-tag">&gt;</span></span>43<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ymin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xmax</span></span></span><span class="hljs-tag">&gt;</span></span>241<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xmax</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ymax</span></span></span><span class="hljs-tag">&gt;</span></span>123<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ymax</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bndbox</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">annotation</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  L'utilisation de deux jeux de donn√©es en m√™me temps signifie uniquement que vous devez soigneusement fusionner les fichiers correspondants par paires, sans oublier d'enregistrer correctement les chemins, ainsi que de m√©langer le fichier pour la formation. <br><br>  Apr√®s cela, vous pouvez commencer la formation. <br><br><h3>  La formation </h3><br>  Le code pour la formation des mod√®les se trouve dans mon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">carnet Colab</a> . <br><br>  J'ai fait la formation au Google Colaboratory, parce que mon ordinateur portable a √† peine fait les tests de la grille, et a g√©n√©ralement raccroch√© sur la formation.  Le colaboratoire m'a permis de former le filet assez rapidement et gratuitement.  Le seul hic, c'est que j'ai d√ª √©crire un script de compilation SSD-Caffe pour le Colaboratory (y compris des choses √©tranges comme la recompilation du boost et l'√©dition de la source), ce qui prend environ 40 minutes.  Plus de d√©tails peuvent √™tre trouv√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans ma publication pr√©c√©dente</a> . <br><br>  Le Colaboratoire a une autre fonctionnalit√©: apr√®s 12 heures, la voiture meurt, effa√ßant d√©finitivement toutes les donn√©es.  La meilleure fa√ßon d'√©viter la perte de donn√©es consiste √† monter votre disque Google dans le syst√®me et √† y enregistrer des poids r√©seau toutes les 500 √† 1 000 it√©rations de formation. <br><br>  Quant √† mon d√©tecteur, en une session au Colaboratoire, il a r√©ussi √† d√©sapprendre 4500 it√©rations, et a √©t√© enti√®rement form√© en deux sessions. <br><br>  La qualit√© des pr√©dictions (pr√©cision moyenne moyenne) sur l'ensemble de donn√©es de test que j'ai mis en √©vidence (fusion de WIDER et FDDB avec les restrictions √©num√©r√©es ci-dessus) √©tait d'environ 0,87 pour le meilleur mod√®le.  Pour mesurer mAP sur les √©chelles enregistr√©es lors de la formation, il existe un script <code>scripts/plot_map.py</code> . <br><br>  Le d√©tecteur fonctionne sur un exemple (tr√®s √©trange) d'un ensemble de donn√©es: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nw/kc/jy/nwkcjyrtsz09v2fivdbs4uny3lc.png" width="60%"></div><br><h2>  Lancement sur NCS </h2><br>  Une d√©mo de d√©tection de visage est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Pour compiler un r√©seau neuronal pour le Neural Compute Stick, vous avez besoin du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Movidius NCSDK</a> : il contient des utilitaires pour compiler et profiler des r√©seaux neuronaux, ainsi que les API C ++ et Python.  Il convient de noter que la deuxi√®me version a √©t√© r√©cemment publi√©e, ce qui n'est pas compatible avec la premi√®re: toutes les fonctions de l'API ont √©t√© renomm√©es pour une raison quelconque, le format interne des r√©seaux de neurones a √©t√© modifi√©, FIFO a √©t√© ajout√© pour interagir avec NCS et (enfin) la conversion automatique de float 32 bit en float 16 bit, qui manquait tellement en C ++.  J'ai mis √† jour tous mes projets vers la deuxi√®me version, mais j'ai laiss√© quelques b√©quilles pour la compatibilit√© avec la premi√®re. <br><br>  Apr√®s avoir entra√Æn√© le d√©tecteur, il vaut la peine de fusionner les couches BatchNorm avec des convolutions adjacentes pour acc√©l√©rer le r√©seau neuronal.  Le script <code>merge_bn.py</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cela √† partir d'ici</a> , que j'ai √©galement emprunt√© au projet Mobilenet-SSD. <br><br>  Ensuite, vous devez appeler l'utilitaire <code>mvNCCompile</code> , par exemple: <br><br><pre> <code class="bash hljs">mvNCCompile -s 12 -o graph_ssd -w ssd-face.caffemodel ssd-face.prototxt</code> </pre><br>  Il existe une cible <code>graph_ssd</code> pour cela dans le Makefile du projet.  Le fichier <code>graph_ssd</code> r√©sultant est une description du r√©seau de neurones dans un format compris par NCS. <br><br>  Maintenant, comment interagir avec l'appareil lui-m√™me.  Le processus n'est pas tr√®s compliqu√©, mais n√©cessite une quantit√© de code assez importante.  La s√©quence d'actions est approximativement la suivante: <br><br><ul><li>  Obtenez le descripteur de l'appareil par num√©ro de s√©rie </li><li>  Ouvrir l'appareil </li><li>  Lire le fichier de r√©seau neuronal compil√© dans le tampon (sous forme de fichier binaire) </li><li>  Cr√©er un graphique de calcul vide pour NCS </li><li>  Placez le graphique sur l'appareil en utilisant les donn√©es du fichier et s√©lectionnez FIFO pour celui-ci en entr√©e / sortie;  le tampon avec le contenu du fichier peut maintenant √™tre lib√©r√© </li><li>  D√©marrage du d√©tecteur: <br><ul><li>  Obtenez l'image de la cam√©ra (ou de toute autre source) </li><li>  Traitez-le: redimensionnez-le √† la taille souhait√©e, convertissez-le en float32 et convertissez-le dans la plage [-1,1] </li><li>  T√©l√©chargez l'image sur l'appareil et demandez l'inf√©rence </li><li>  Demander un r√©sultat (le programme sera bloqu√© jusqu'√† r√©ception du r√©sultat) </li><li>  Analyser le r√©sultat, s√©lectionner les cadres des objets (sur le format - plus loin) </li><li>  Afficher les pr√©dictions </li></ul><br></li><li>  Lib√©rez toutes les ressources: supprimez FIFO et le graphique de calcul, fermez l'appareil et retirez sa poign√©e </li></ul><br>  Presque chaque action avec NCS a sa propre fonction distincte, et en C ++, elle semble tr√®s lourde, et vous devez surveiller attentivement la lib√©ration de toutes les ressources.  Afin de ne pas surcharger le code, j'ai cr√©√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">une classe wrapper pour travailler avec NCS</a> .  Dans ce document, tout le travail d'initialisation est cach√© dans le constructeur et la fonction <code>load_file</code> , et lors de la lib√©ration des ressources - dans le destructeur, et travailler avec NCS est r√©duit √† appeler des m√©thodes de classe 2-3.  De plus, il existe une fonction pratique pour expliquer les erreurs qui se sont produites. <br><br>  Cr√©ez un wrapper en transmettant la taille d'entr√©e et la taille de sortie (nombre d'√©l√©ments) au constructeur: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">NCSWrapper </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NCS</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(NETWORK_INPUT_SIZE*NETWORK_INPUT_SIZE*</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3</span></span></span></span><span class="hljs-function"><span class="hljs-params">, NETWORK_OUTPUT_SIZE)</span></span></span></span>;</code> </pre><br>  Nous chargeons le fichier compil√© avec le r√©seau de neurones, initialisant simultan√©ment tout ce dont nous avons besoin: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!NCS.load_file(<span class="hljs-string"><span class="hljs-string">"./models/face/graph_ssd"</span></span>)) { NCS.print_error_code(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre><br>  Nous convertissons l'image en float32 (l' <code>image</code> est <code>cv::Mat</code> au format <code>CV_32FC3</code> ) et la t√©l√©chargeons sur l'appareil: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!NCS.load_tensor_nowait((<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>*)image.data)) { NCS.print_error_code(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre><br>  Nous obtenons le r√©sultat (le <code>result</code> est un pointeur <code>float</code> , le tampon de r√©sultat est pris en charge par le wrapper);  jusqu'√† la fin des calculs, le programme est bloqu√©: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!NCS.get_result(result)) { NCS.print_error_code(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre><br>  En fait, l'encapsuleur a √©galement une m√©thode qui vous permet de charger des donn√©es et d'obtenir le r√©sultat en m√™me temps: <code>load_tensor((float*)image.data, result)</code> .  J'ai refus√© de l'utiliser pour une raison: en utilisant des m√©thodes distinctes, vous pouvez l√©g√®rement acc√©l√©rer l'ex√©cution du code.  Apr√®s le chargement de l'image, le CPU restera inactif jusqu'√† ce que le r√©sultat de l'ex√©cution avec NCS arrive (dans ce cas, il s'agit d'environ 100 ms), et √† ce stade, vous pouvez faire un travail utile: lire une nouvelle trame et la convertir, ainsi que afficher les d√©tections pr√©c√©dentes .  C'est exactement ainsi que le programme de d√©monstration est impl√©ment√©, dans mon cas, il augmente l√©g√®rement les FPS.  Vous pouvez aller plus loin et d√©marrer le traitement d'image et le d√©tecteur de visage de mani√®re asynchrone dans deux flux diff√©rents - cela fonctionne vraiment et vous permet d'acc√©l√©rer un peu plus, mais il n'est pas impl√©ment√© dans le programme de d√©monstration. <br><br>  En cons√©quence, le d√©tecteur renvoie un tableau flottant de taille <code>7*(keep_top_k+1)</code> .  Ici, <code>keep_top_k</code> est le param√®tre sp√©cifi√© dans le fichier <code>.prototxt</code> du mod√®le et indiquant le nombre de d√©tections (dans l'ordre de confiance d√©croissante) √† renvoyer.  Ce param√®tre, ainsi que le param√®tre responsable du filtrage des d√©tections par la valeur de confiance minimale et les param√®tres de suppression non maximale peuvent √™tre configur√©s dans le fichier <code>.prototxt</code> du mod√®le dans la toute derni√®re couche.  Il convient de noter que si Caffe retourne autant de d√©tections qu'il en a √©t√© trouv√© dans l'image, NCS renvoie toujours <code>keep_top_k</code> d√©tections afin que la taille du tableau soit constante. <br><br>  Le tableau de r√©sultats lui-m√™me est <code>keep_top_k+1</code> comme suit: si nous le consid√©rons comme une matrice avec <code>keep_top_k+1</code> lignes et 7 colonnes, alors dans la premi√®re ligne, dans le premier √©l√©ment il y aura le nombre de d√©tections, et √† partir de la deuxi√®me ligne il y aura les d√©tections elles-m√™mes au format <code>"garbage, class_index, class_probability, x_min, y_min, x_max, y_max"</code> .  Les coordonn√©es sont sp√©cifi√©es dans la plage [0,1], elles devront donc √™tre multipli√©es par la hauteur / largeur de l'image.  Les √©l√©ments restants du tableau seront des ordures.  Dans ce cas, la suppression non maximale est effectu√©e automatiquement, avant m√™me que le r√©sultat ne soit obtenu (il semble, √† droite sur NCS). <br><br><div class="spoiler">  <b class="spoiler_title">Analyse du d√©tecteur</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_detection_boxes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">* predictions, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> w, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> h, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> thresh, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;&amp; probs, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;cv::Rect&gt;&amp; boxes)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> num = predictions[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> score = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> cls = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">1</span></span>; i&lt;num+<span class="hljs-number"><span class="hljs-number">1</span></span>; i++) { score = predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">2</span></span>]; cls = predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (score&gt;thresh &amp;&amp; cls&lt;=<span class="hljs-number"><span class="hljs-number">1</span></span>) { probs.push_back(score); boxes.push_back(Rect(predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">3</span></span>]*w, predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">4</span></span>]*h, (predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">5</span></span>]-predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">3</span></span>])*w, (predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">6</span></span>]-predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">4</span></span>])*h)); } } }</code> </pre><br></div></div><br><h2>  Fonctionnalit√©s de lancement de Raspberry Pi </h2><br>  Le programme de d√©monstration lui-m√™me peut √™tre ex√©cut√© sur un ordinateur ou un ordinateur portable ordinaire avec Ubuntu, ou sur un Raspberry Pi avec un Raspbian Stretch.  J'utilise un Raspberry Pi 2 mod√®le B, mais la d√©mo devrait √©galement fonctionner sur d'autres mod√®les.  Le makefile du projet contient deux objectifs pour les modes de commutation: <code>make switch_desk</code> pour l'ordinateur / ordinateur portable et <code>make switch_rpi</code> pour le Raspberry Pi.  La diff√©rence fondamentale dans le code du programme est que dans le premier cas, OpenCV est utilis√© pour lire les donn√©es de la cam√©ra et dans le second cas, la biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RaspiCam</a> .  Pour ex√©cuter la d√©mo sur Raspberry, vous devez le compiler et l'installer. <br><br>  Maintenant, un point tr√®s important: l'installation de NCSDK.  Si vous suivez les instructions d'installation standard sur le Raspberry Pi, cela ne se terminera par rien de bon: le programme d'installation essaiera de faire glisser et de compiler SSD-Caffe et Tensorflow.  Au lieu de cela, le NCSDK doit √™tre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">compil√© en mode API uniquement</a> .  Dans ce mode, seules les API C ++ et Python seront disponibles (c'est-√†-dire qu'il ne sera pas possible de compiler et de profiler des graphiques de r√©seau neuronal).  Cela signifie que le graphique du r√©seau neuronal doit d'abord √™tre compil√© sur un ordinateur ordinaire, puis copi√© sur Raspberry.  Pour plus de commodit√©, j'ai ajout√© deux fichiers compil√©s au r√©f√©rentiel, pour YOLO et pour SSD. <br><br>  Un autre point int√©ressant est la connexion purement physique de NCS √† Raspberry.  Il semblerait qu'il ne soit pas difficile de le connecter √† un connecteur USB, mais vous devez vous rappeler que son bo√Ætier bloquera les trois autres connecteurs (il est assez sain, car il agit comme un radiateur).  Le moyen le plus simple est de le connecter via un c√¢ble USB. <br><br>  Il convient √©galement de garder √† l'esprit que la vitesse d'ex√©cution variera pour diff√©rentes versions d'USB (pour ce r√©seau de neurones particulier: 102 ms pour USB 3.0, 92 ms pour USB 2.0). <br><br>  Maintenant sur la puissance du NCS.  Selon la documentation, il consomme jusqu'√† 1 watt (√† 5 volts sur le connecteur USB ce sera jusqu'√† 200 ma; √† titre de comparaison: la cam√©ra Raspberry consomme jusqu'√† 250 ma).  Lorsqu'il est aliment√© par un chargeur ordinaire de 5 volts, 2 amp√®res, tout fonctionne tr√®s bien.  Cependant, essayer de connecter deux ou plusieurs NCS √† Raspberry peut provoquer des probl√®mes.  Dans ce cas, il est recommand√© d'utiliser un r√©partiteur USB avec possibilit√© d'alimentation externe. <br><br>  Sur Raspberry, la d√©mo est plus lente que sur un ordinateur / portable: 7,2 FPS contre 10,4 FPS.  Cela est d√ª √† plusieurs facteurs: premi√®rement, il est impossible de se d√©barrasser des calculs sur le CPU, mais ils sont effectu√©s beaucoup plus lentement;  deuxi√®mement, la vitesse de transfert de donn√©es affecte (pour USB 2.0). <br><br>  De plus, √† titre de comparaison, j'ai essay√© d'ex√©cuter un d√©tecteur de visage sur Raspberry YOLOv2 √† partir de mon premier article, mais cela a tr√®s mal fonctionn√©: √† une vitesse de 3,6 FPS, il manque beaucoup de visages m√™me sur des images simples.  Apparemment, il est tr√®s sensible aux param√®tres de l'image d'entr√©e, dont la qualit√© dans le cas de la cam√©ra Raspberry est loin d'√™tre id√©ale.  Le SSD fonctionne beaucoup plus stable, m√™me si j'ai d√ª modifier l√©g√®rement les param√®tres vid√©o dans les param√®tres de la RapiCam.  il lui manque aussi parfois les visages dans le cadre, mais il le fait assez rarement.  Pour augmenter la stabilit√© dans les applications r√©elles, vous pouvez ajouter un simple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tracker centro√Øde</a> . <br><br>  Soit dit en passant: la m√™me chose peut √™tre reproduite en Python, il existe un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tutoriel sur PyImageSearch</a> (Mobilenet-SSD est utilis√© pour la t√¢che de d√©tection d'objet). <br><br><h4>  Autres id√©es </h4><br>  J'ai √©galement test√© quelques id√©es pour acc√©l√©rer le r√©seau neuronal lui-m√™me: <br><br>  Premi√®re id√©e: vous ne pouvez laisser que la d√©tection des calques <code>conv11</code> et <code>conv13</code> , et supprimer tous les calques suppl√©mentaires.  Vous obtiendrez un d√©tecteur qui ne d√©tecte que les petits visages et fonctionne un peu plus rapidement.  Dans l'ensemble, cela n'en vaut pas la peine. <br><br>  La deuxi√®me id√©e √©tait int√©ressante, mais n'a pas fonctionn√©: j'ai essay√© de lancer des convolutions du r√©seau neuronal avec des poids proches de z√©ro, en esp√©rant que cela deviendrait plus rapide.  Cependant, il y avait peu de telles circonvolutions, et leur suppression n'a que l√©g√®rement ralenti le r√©seau neuronal (le seul pressentiment: cela est d√ª au fait que le nombre de canaux a cess√© d'√™tre une puissance de deux). <br><br><h2>  Conclusion </h2><br>  J'ai pens√© √† d√©tecter des visages sur Raspberry pendant longtemps, comme une sous-t√¢che de mon projet robotique.  Je n'aimais pas les d√©tecteurs classiques en termes de vitesse et de qualit√©, et j'ai d√©cid√© d'essayer les m√©thodes de r√©seau neuronal, en testant en m√™me temps le Neural Compute Stick, √† la suite de quoi il y avait deux projets sur GitHub et trois articles sur Habr√© (dont l'actuel).  En g√©n√©ral, le r√©sultat me convient - tr√®s probablement, j'utiliserai ce d√©tecteur dans mon robot (il y aura peut-√™tre un autre article √† ce sujet).  Il convient de noter que ma solution n'est peut-√™tre pas optimale - n√©anmoins, il s'agit d'un projet de formation, fait en partie par curiosit√© pour le NCS.  J'esp√®re n√©anmoins que cet article sera utile √† quelqu'un. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr424973/">https://habr.com/ru/post/fr424973/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr424963/index.html">Financement Zuckerberg: cr√©er ensemble des outils pour la science</a></li>
<li><a href="../fr424965/index.html">D√©veloppement d'applications React √† l'aide de ReasonReact</a></li>
<li><a href="../fr424967/index.html">Raccourcis JavaScript pour les d√©butants</a></li>
<li><a href="../fr424969/index.html">Guide Node.js, partie 9: Utilisation du syst√®me de fichiers</a></li>
<li><a href="../fr424971/index.html">Habrokast "Sunset Manually" # 1. Essayer de mettre en place un environnement pour d√©velopper un jouet pour Windows</a></li>
<li><a href="../fr424975/index.html">Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi. Partie 2. Le sch√©ma de donn√©es comme reflet du mod√®le ¬´monde¬ª</a></li>
<li><a href="../fr424977/index.html">Apprendre des erreurs: optimiser les applications sur l'App Store et Google Play</a></li>
<li><a href="../fr424979/index.html">Orme. Confortable et maladroit. Http, Task</a></li>
<li><a href="../fr424981/index.html">RPG de texte d'oeuf de P√¢ques dans le code du moteur de recherche Google</a></li>
<li><a href="../fr424985/index.html">Dans un pr√©c√©dent judiciaire important, les agences de renseignement am√©ricaines n'ont pas √©t√© en mesure d'√©couter des appels dans le messager</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>