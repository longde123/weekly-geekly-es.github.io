<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õèÔ∏è üçü üëõ Session de transmission vid√©o du son √† travers l'eau avec exposition üåÑ ‚úçüèº üåÅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬´Le Seigneur Tout-Puissant! Il semble que je viens de tuer M. May! ... Mais quoi qu'il en soit, nous continuons ¬ª(C) J. Clarkson 
 Dans cet article, j...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Session de transmission vid√©o du son √† travers l'eau avec exposition</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/408871/"><blockquote>  ¬´Le Seigneur Tout-Puissant!  Il semble que je viens de tuer M. May! ... Mais quoi qu'il en soit, nous continuons ¬ª(C) J. Clarkson </blockquote><br>  Dans cet article, je vais vous dire comment transf√©rer de la vid√©o (enfin presque de la vid√©o) en utilisant le son dans l'eau √† l'aide d'un ordinateur portable ordinaire, d'un morceau de fil, de deux prises 3,5 mm et de deux tweeter pi√©zo.  Je vais √©galement expliquer pourquoi et comment cela fonctionne, raconter une histoire amusante sur la fa√ßon dont nous en sommes arriv√©s √† cela.  Et comme cerise sur le g√¢teau, un article sur C # avec des codes sources est joint √† l'article afin que tous ceux qui sont int√©ress√©s puissent l'essayer eux-m√™mes, car les connaissances scientifiques sont v√©rifiables, n'est-ce pas? <br><a name="habracut"></a><br>  Si tout √† coup le lecteur souhaite approfondir un peu les th√®mes hydroacoustiques, je vous propose de vous familiariser avec nos publications pr√©c√©dentes, o√π nous parlons de nos projets d'une mani√®re r√©v√©lant les difficult√©s de transmission d'informations par l'eau: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GPS sous-marin √† partir de z√©ro par an</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GPS sous-marin: suite</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Navigation sous l'eau: radiogoniom√©trie - ne pas radiogoniom√©trie, vous √™tes vou√© au succ√®s</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sur l'effet des cyanobact√©ries sur les fonctions vocales du pr√©sident</a> <br><br>  En g√©n√©ral, une v√©rit√© simple doit √™tre apprise: la vid√©o √† travers l'eau √† n'importe quelle distance significative (enfin, au moins des centaines de m√®tres) ne peut pas √™tre transmise en utilisant l'acoustique.  Le point est la bande de fr√©quences disponible extr√™mement √©troite et la forte in√©galit√© de l'att√©nuation des diff√©rentes fr√©quences avec la distance.  Les avantages sont le bruit, la propagation par trajets multiples, la r√©verb√©ration, le changement de la vitesse du son dans le milieu par rapport √† la densit√© (c.-√†-d. La pression, la temp√©rature et la salinit√©), l'effet Doppler, qui ne fonctionne d'ailleurs pas tout √† fait comme dans les communications radio. <br><br>  Les limites de vitesse pour les modems sonar les plus avanc√©s sont tr√®s loin de pouvoir transmettre de la vid√©o.  Pour autant que je sache, le record appartient √† EvoLogics et s'√©l√®ve √† 62,5 kbps avec une distance maximale d√©clar√©e de 300 m√®tres.  De plus, les mots sur l'impossibilit√© de transmettre le son vid√©o √† travers l'eau (√† des distances raisonnables) appartiennent uniquement √† Konstantin Georgievich, fondateur et directeur d'EvoLogics. <br><br>  Quand j'√©tais chercheur √† l'Institut de recherche Hydrosvyaz, alors compl√®tement inconscient, je voulais de grandes r√©alisations, des <s>victoires dans le nord et le sud, un grand ameublissement des sols</s> (non, je les veux toujours, mais alors je n'√©tais pas du tout accabl√© d'exp√©rience et de connaissances et tout semblait presque magique et fabuleux).  Dans notre √©quipe de l'√©poque (dont une partie est la mienne), nous avons souvent fantasm√© sur des projets de sonar irr√©alistes, fouill√© dans une <s>d√©charge</s> et essay√© d'utiliser toutes sortes d'artefacts d'une grande civilisation ancienne d'affil√©e, dont cet institut de recherche tente en partie de comprendre le tao de la communication sonar . <br><br>  L'immersion dans ces souvenirs √©voque des sentiments contradictoires en moi.  Alors rien ne semblait et personne ne pouvait nous arr√™ter: nous avons mis hors service une fraiseuse chinoise du directeur du prototypage de produits, assembl√© des corps normobares √† partir de conduites d'eau n√©erlandaises Van De Lande, dont le fabricant a m√™me √©crit une lettre sur le sujet: ¬´Avez-vous v√©rifi√© accidentellement vos tuyaux r√©sistent-ils √† la pression ext√©rieure? "  Ils ont collect√© des mod√®les de planche √† pain pour leur propre argent dans des conteneurs de petit-d√©jeuner et se sont rendus secr√®tement au test pour les tester secr√®tement, collectant des forets √† glace et des tra√Æneaux pour des coll√®gues et des parents, et ont m√™me achet√© un bateau chinois en PVC √† Auchan.  Avec le recul, je sens √† quel point mon c≈ìur est rempli d'horreur, de nostalgie et d'appr√©hension. <br><br>  En toute honn√™tet√©, il convient de noter que pendant tout ce temps, nous avons re√ßu un grand soutien de certains de nos dirigeants - en paroles et en actes, et en cons√©quence, tous nos m√©tiers ont √©t√© l√©galis√©s en TOC (ce qui signifie travail de conception exp√©rimentale et non trouble obsessionnel compulsif), qui √©tait m√™me pr√©sent√© au salon naval international en 2013.  Oui, oui, nous avons conduit au salon nos conduites d'eau, peint <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">StDmitirev</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">notre</a> propre main en orange vif!  Les voici, dans des valises: <br><br><img src="https://habrastorage.org/webt/-7/jk/ii/-7jkii7tkq9yhpbwuvb1dw6ah2g.jpeg"><br><br>  Un jour, mon ami et coll√®gue <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">StDmitirev,</a> au milieu d'une conversation sur les spectres et les spectrogrammes, a prononc√© la phrase suivante: <br><br><blockquote>  "Mais, ce serait amusant de faire un tel syst√®me: le sous-marin est assis dans le sous-marin et regarde le moniteur, sur lequel le spectrogramme se d√©place en douceur, sur lequel les lettres et les chiffres sont √©crits comme le doigt d' <s>un autre sous-marin</s> sur la fen√™tre brumeuse d' <s>un autre sous-marin</s> ." <br></blockquote><br>  Tout le monde a ri, d√©velopp√© ce sujet, il semble que m√™me le m√™me jour, ils aient dessin√© un smiley sur le spectrogramme et √©cout√© comment √ßa sonne.  Je voulais vraiment apporter cela √† un aspect pratique. <br><br>  Maintenant, c'est difficile √† retenir (c'√©tait en 2012).  J'avais un ordinateur en √©tat de marche avec une webcam, divers artefacts-antennes et un "godet boosting" sp√©cial (VG-1-P) avec de l'eau.  Ils l'ont appel√© une √©tape parce que j'ai montr√© √† tous ses patrons le travail de diff√©rents mod√®les d'√©quipement, ce qui a conduit √† ma promotion en tant que chercheur senior. <br><br>  Je ne suis contraint par aucune obligation, la m√©thode elle-m√™me est depuis longtemps publi√©e dans le domaine public et les r√©sultats ont √©t√© rapport√©s √† plusieurs reprises lors de conf√©rences. <br><br>  Donc, je vous dis comment dans l'esprit - comment transmettre une vid√©o √† travers l'eau: <br><br><h3>  Comment g√©n√©rer un signal? </h3><br>  Nous nous souvenons que l'id√©e est bas√©e sur le ¬´dessin sur un spectrogramme¬ª, c'est-√†-dire que l'image transmise est le spectrogramme du signal.  Pour convertir un signal du domaine temporel en domaine fr√©quentiel et vice versa, il est pratique d'utiliser (enfin, par exemple) la transform√©e de Fourier, ou plut√¥t, la transform√©e de Fourier rapide, par souci de concision, appel√©e FFT ou, plus commun√©ment, FFT (Fast Fourier Transform). <br><br>  Comme nous devons transformer une image (image vid√©o) en un signal audio qui pourrait √™tre √©mis par la carte son de n'importe quel ordinateur, nous utiliserons √©videmment la transformation inverse, IFFT, pour la former.  Nous √©mettrons une image en colonnes, et un signal pour une colonne sera form√© comme dans le diagramme suivant: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l4/wi/3t/l4wi3t5t4mk3vq5zo_-bmau-dne.png"></div><br>  = <br>  Supposons que la taille de la fen√™tre FFT soit N et que nous ayons un tableau de taille N. Si nous le consid√©rons comme le spectre du signal, alors son √©l√©ment z√©ro correspond √† la fr√©quence z√©ro (constante), et le compte avec l'indice N-1 correspond √† la fr√©quence d'√©chantillonnage de la fr√©quence d'√©chantillonnage.  Il est n√©cessaire de choisir ces tailles de trame d'image et la taille de la fen√™tre FFT de sorte que, d'une part, tout cela ressemble en quelque sorte √† la vid√©o (le transfert d'une trame prendrait un temps raisonnable), et d'autre part, la bande de fr√©quence utilis√©e √©tait ad√©quate en principe et adapt√©e √† l'√©quipement disponible. .  Maintenant, si nous entrons les valeurs de luminosit√© de la colonne de l'image (Colonne de cadre) √† partir d'un d√©compte favori (de bas en haut dans le diagramme), puis effectuons la FFT inverse, la sortie recevra un signal codant une colonne de l'image.  Il nous reste maintenant √† former les signaux de la m√™me mani√®re pour les colonnes restantes de l'image et √† les √©mettre alternativement √† l'aide d'une carte son. <br><br>  Il convient de noter que la FFT √† la sortie donne un tableau de valeurs complexes, donc notre signal est la partie r√©elle.  Bien s√ªr, le signal r√©sultant dans les colonnes est r√©duit √† des entiers sign√©s 16 bits (sous cette forme, un signal audio num√©rique est g√©n√©ralement stock√©) et normalis√©. <br><br>  En fait, au d√©but de l'image, j'entre √©galement quelques colonnes de luminosit√© maximale, plus tard du c√¥t√© du r√©cepteur, cela d√©terminera la r√©ponse en fr√©quence du trajet de l'√©metteur-r√©cepteur (et du canal de transmission), qui, une fois invers√©e et l√©g√®rement liss√©e, nous aidera √† am√©liorer la trame re√ßue. <br><br>  √Ä mon avis, le moyen le plus simple de d√©montrer le dispositif de l'√©metteur est avec un morceau de code, le voici (m√©thode Encode de la classe Encoder): <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Encode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Bitmap source</span></span></span><span class="hljs-function">)</span></span> { Bitmap frame; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (source.PixelFormat != System.Drawing.Imaging.PixelFormat.Format8bppIndexed) frame = Grayscale.CommonAlgorithms.RMY.Apply(source); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> frame = source; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!frame.Size.Equals(frameSize)) frame = resizer.Apply(frame); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[] samples = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[fftSize * frameSize.Width]; alglib.complex[] slice = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> alglib.complex[fftSize]; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> maxSlice; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sampleIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> colsCount = frameSize.Width; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> startRow = startLine; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> endRow = startRow + frameSize.Height; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; colsCount; x++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = startRow; y &lt; endRow; y++) slice[y].x = (frame.GetPixel(x, frameSize.Height - (y - startRow) - <span class="hljs-number"><span class="hljs-number">1</span></span>).R / <span class="hljs-number"><span class="hljs-number">255.0</span></span>) * <span class="hljs-keyword"><span class="hljs-keyword">short</span></span>.MaxValue; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = <span class="hljs-number"><span class="hljs-number">0</span></span>; y &lt; fftSize; y++) slice[y].x *= randomizerMask[y]; alglib.fftc1dinv(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> slice); maxSlice = <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.MinValue; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = <span class="hljs-number"><span class="hljs-number">0</span></span>; y &lt; slice.Length; y++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Math.Abs(slice[y].x) &gt; maxSlice) maxSlice = Math.Abs(slice[y].x); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; slice.Length; i++) { samples[sampleIndex] = (<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>)Math.Round(slice[i].x * <span class="hljs-keyword"><span class="hljs-keyword">short</span></span>.MaxValue / maxSlice); sampleIndex++; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> samples; }</code> </pre> <br>  Le code, naturellement, ne pr√©tend rien et a √©t√© √©crit √† la h√¢te uniquement √† des fins de d√©monstration. <br><br><h3>  Et la vitesse de transmission? </h3><br>  Et comment l'√©valuer?  Nous avons r√©ussi ( <s>du mal</s> pas du mal) √† maintenir l'intrigue pendant environ deux mois, et certains de nos camarades et dirigeants sup√©rieurs ont r√©ussi √† √©crire un tas de papier pendant leur temps libre, se demandant comment une vitesse de transmission aussi folle pourrait se produire. <br><br>  Par exemple, si la fr√©quence d'√©chantillonnage est de 96 kHz et que nous prenons la taille de la fen√™tre FFT √† 512, nous enverrons 120 x 120 pixels (8 bits par pixel) √† l'entr√©e de l'√©metteur, alors le temps qu'il faut pour transmettre une trame d'image est: <br><br>  <i>120 * 512/96000 = 0,64 seconde</i> <br><br>  Le d√©bit binaire devrait sembler √™tre: <br><br>  <i>120x120 * 8 / 0,64 = 180 000 bits par seconde!</i> <br><br>  <s>Le fils du r√©alisateur √©tait ravi √† l'√©poque - oui, vous pouvez d√©j√† utiliser les protocoles Internet!</s>  <s>C'est une perc√©e!</s> <br><br>  Comme je vais le montrer ci-dessous, il est tr√®s facile de tomber dans une telle illusion.  Qu'est-ce qui ne va pas ici?  Apr√®s tout, tout est si simple et √©l√©gant! <br><br>  En fait, un tel calcul de vitesse n'est pas applicable √† cette m√©thode, tout comme, par exemple, il ne s'applique pas √† un signal de t√©l√©vision analogique, combien y a-t-il de bits par pixel?  =) Et qu'en est-il du r√©cepteur d√©tecteur le plus simple?  =)) <br><br>  La m√©thode de transmission d√©crite est essentiellement <i>ANALOGIQUE</i> et les concepts de ¬´bit¬ª et de ¬´pixel¬ª ne lui sont pas applicables - dans la m√™me image, th√©oriquement, vous ne pouvez pas prendre 8 bits par luminosit√© de pixel mais 16 et ¬´vitesse¬ª doublera automatiquement. <br><br>  Il est temps de montrer les tout premiers r√©sultats de notre ¬´perc√©e¬ª: <br><br><img src="https://habrastorage.org/webt/a5/ji/pv/a5jipvfgywxfxpy7p9jwl34v-ze.gif"><br><br>  La photo ci-dessus a √©t√© prise par nous √† l'hiver 2012 sur la rivi√®re Pichuga.  La distance de transmission √©tait de 700 m√®tres.  Oui, h√©las, mon cher lecteur, ce n'est pas du tout HD et ne tire m√™me pas sur le CamRip le plus honteux.  Je ne me souviens pas d√©j√† de qui, mais quelqu'un a tr√®s pr√©cis√©ment remarqu√© que toutes nos ¬´vid√©os¬ª sont comme envoyer des signaux d'aide d'une plan√®te mourante. <br><br>  Ce qui est remarquable, avec un √©tirement, cela peut √™tre d√©crit comme une sorte d'OFDM - les donn√©es sont transmises sur des sous-porteuses orthogonales, ce qui signifie une bonne r√©sistance aux interf√©rences tonales et autres interf√©rences √† bande √©troite - dans ce cas, les "lignes" individuelles de l'image sont d√©form√©es.  Le bruit impulsionnel, au contraire, d√©forme une ou un groupe de colonnes.  Le "bandage" caract√©ristique des images est caus√© par ce que l'on appelle  √©vanouissement s√©lectif en fr√©quence d√ª √† la propagation par trajets multiples, mais j'en parlerai une autre fois. <br><br><h3>  Comment est arrang√© le r√©cepteur? </h3><br>  Je dois r√©server tout de suite que pour essayer cette m√©thode dans un seau ou m√™me dans une petite piscine, des pi√®ces de deux heures (rondes par exemple) avec un connecteur pour une carte son soud√©e seront suffisantes.  Pour l'√©metteur, vous pouvez prendre un c√¢ble assez long (2-3-4-5 m√®tres) et non blind√©, scellant l'√©l√©ment pi√©zo√©lectrique avec du vernis au zapon ou une petite couche de mastic - c'est certainement suffisant √† plusieurs reprises.  L'antenne sonar r√©sultante (pas, eh bien, quoi?) Est ins√©r√©e dans la prise casque. <br><br>  La photo ci-dessous montre diff√©rentes pi√®ces qui √©taient √† port√©e de main au moment de la r√©daction.  Tous les √©l√©ments pi√©zo√©lectriques illustr√©s sont tout √† fait adapt√©s pour "essayer" et il y a g√©n√©ralement un magasin de radio dans n'importe quel <s>d√©potoir</s> .  Pyatak n'a pas d'effet pi√©zo√©lectrique et est pr√©sent sur l'image pour l'√©chelle. <br><br><img src="https://habrastorage.org/webt/5v/r6/xq/5vr6xqryjht0yd5tqz7sdvmbd3a.jpeg"><br><br>  Pour le r√©cepteur, il est pr√©f√©rable de prendre un c√¢ble de microphone blind√© avec le m√™me connecteur et un piezo enduit de scellant ou de vernis √† la fin.  Nous ins√©rons cette antenne dans la prise microphone. <br><br>  Pour les exp√©riences sur un √©tang, il est pr√©f√©rable de prendre une sorte d'anneau pi√©zo√©lectrique comme √©metteur et de l'alimenter amplifi√© (un amplificateur sur un TDA2030 avec un transformateur correctement enroul√© durera plusieurs centaines de m√®tres dans un bon √©tang <s>ou 5 autres tours peuvent √™tre</s> enroul√©s).  Pour le r√©cepteur, dans ce cas, un pr√©amplificateur et de pr√©f√©rence un filtre passe-bande sont √©galement n√©cessaires.  Si les lecteurs sont int√©ress√©s √† en savoir plus √† ce sujet en d√©tail, dites-le nous dans les commentaires et nous essaierons de faire un article sur la cr√©ation d'amplificateurs de puissance, de pr√©amplis et d'antennes pour la communication sonar. <br><br><h3>  Revenons donc au r√©cepteur, plus pr√©cis√©ment √† sa partie logicielle </h3><br>  La chose la plus importante en communication est la synchronisation et la d√©termination de la pr√©sence d'un signal utile.  Dans notre exemple, la d√©tection est effectu√©e par l'√©nergie dans la bande: les endroits o√π elle augmente fortement (d√©but de la trame) et o√π elle chute fortement (la fin de la trame) sont d√©termin√©s, √† condition que d'avant en bas il y ait au moins la dur√©e de la trame. <br><br>  Pour toute sa simplicit√©, il fonctionne √©tonnamment bien. <br><br>  Les donn√©es de la carte son sont collect√©es par des √©chantillons FFTSize, la FFT est ex√©cut√©e imm√©diatement sur elles et elles sont stock√©es sous forme de ¬´tranches¬ª s√©par√©es, en attendant le moment o√π elles seront trait√©es par la proc√©dure de recherche, voici son code (m√©thode de recherche dans la classe Receiver): <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Search</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sliceIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> frameWidth = encoder.FrameSize.Width; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> minSlicesToSearch = Convert.ToInt32((frameWidth + <span class="hljs-number"><span class="hljs-number">5</span></span>) * <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sliceSize = encoder.FFTSize; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> weight; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> lastRisePosition = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> prevRisePosition = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((slices.Count &gt; minSlicesToSearch) &amp;&amp; (sliceIndex &lt; slices.Count)) { weight = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; sliceSize; i++) weight += Math.Abs(slices[sliceIndex][i]); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> ratio = weight / previousWeight; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((ratio &gt;= risePeekRatio) &amp;&amp; (sliceIndex - prevRisePosition &gt; frameWidth)) { prevRisePosition = lastRisePosition; lastRisePosition = sliceIndex; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lastRisePosition + (frameWidth + <span class="hljs-number"><span class="hljs-number">5</span></span>) &lt; slices.Count) { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[][] samples = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[frameWidth + <span class="hljs-number"><span class="hljs-number">5</span></span>][]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; frameWidth + <span class="hljs-number"><span class="hljs-number">5</span></span>; i++) { samples[i] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[sliceSize]; Array.Copy(slices[lastRisePosition + i], samples[i], sliceSize); } slices.RemoveRange(<span class="hljs-number"><span class="hljs-number">0</span></span>, sliceIndex); lastRisePosition = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (FrameReceived != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) FrameReceived(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FrameReceivedEventArgs(encoder.DecodeEx(samples, <span class="hljs-number"><span class="hljs-number">5</span></span>))); lastRisePosition = sliceIndex; } } sliceIndex++; previousWeight = weight; } Interlocked.Decrement(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> isSearching); }</code> </pre> <br>  Et voici un morceau de code qui est responsable du d√©codage de l'image (Encoder.DecodeEx): <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Bitmap </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Decode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] samples, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> measureCols</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> colCount = samples.Length / fftSize; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (colCount == frameSize.Width + measureCols) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rowCount = frameSize.Height; Bitmap temp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bitmap(colCount, rowCount); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[] slice = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[fftSize]; alglib.complex[] sliceC = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> alglib.complex[fftSize]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> samplesCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> component; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> decodeStart = startLine; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> decodeEnd = startLine + rowCount; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> maxSlice; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; colCount; x++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = <span class="hljs-number"><span class="hljs-number">0</span></span>; y &lt; fftSize; y++) { slice[y] = samples[samplesCount]; samplesCount++; } alglib.fftr1d(slice, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> sliceC); maxSlice = <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.MinValue; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = decodeStart; y &lt; decodeEnd; y++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (alglib.math.abscomplex(sliceC[y].x) &gt; maxSlice) maxSlice = alglib.math.abscomplex(sliceC[y].x); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> offset = temp.Height + decodeStart - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = decodeStart; y &lt; decodeEnd; y++) { component = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)(<span class="hljs-number"><span class="hljs-number">255.0</span></span> * alglib.math.abscomplex(sliceC[y].x) / maxSlice); temp.SetPixel(x, offset - y, Color.FromArgb(component, component, component)); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> temp; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ApplicationException(<span class="hljs-string"><span class="hljs-string">"Specified array length error"</span></span>); } }</code> </pre><br>  Et maintenant je propose de regarder les r√©sultats d'exp√©riences sur la transmission de "vid√©o", men√©es √† diff√©rents moments dans diff√©rents r√©servoirs. <br><br>  Les deux photos (ci-dessous) ont √©t√© enregistr√©es au salon naval international de Saint-P√©tersbourg en 2013 sur notre (alors) stand √† travers deux ordinateurs portables et un aquarium. <br><br>  Il n'est pas possible de distinguer ce qui est √©crit sur le badge <br><br><img src="https://habrastorage.org/webt/xp/wx/sq/xpwxsqvxyyqwrzrjh0n5wr0tm-q.gif"><br><br><img src="https://habrastorage.org/webt/w7/9y/zb/w79yzbz7caic4fre7xftuh_tq00.gif"><br><br>  Et voici deux ¬´vid√©os¬ª enregistr√©es par nous dans l'une des baies du lac Ladoga en Car√©lie, elles sont une sorte de record pour cette m√©thode (nous ne l'avons plus jamais essay√©e et il est peu probable qu'elle soit) - la premi√®re a √©t√© obtenue √† une distance de 500 et la seconde √† 1000 m√®tres : <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Transmission vid√©o dans l'eau, distance 500 m (fichier 8.7 mb)</a> <br><br><img src="https://habrastorage.org/webt/ek/c_/sv/ekc_svi18z7oupqlmckhziofpy8.gif"><br><br>  Puisque la "vid√©o" a √©t√© enregistr√©e en temps r√©el √† l'aide d'une webcam, diverses choses √©tranges sont tomb√©es dans le cadre.  Ce sera tr√®s int√©ressant si quelqu'un devine et √©crit dans un commentaire ce qui est en arri√®re-plan dans la derni√®re ¬´vid√©o¬ª). <br><br>  √Ä l'appui du fait que la m√©thode a √©t√© publi√©e il y a longtemps - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">notre article</a> d√©j√† pour 2013 <br><br>  J'ai utilis√© la merveilleuse biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AForge</a> pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">capturer des images de webcam</a> . <br><br>  Le nombre complexe et les fonctions FFT sont utilis√©s √† partir de l'excellente biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AlgLib</a> . <br><br>  Et, comme je l'ai promis, l'ensemble du projet en C # (VS2012) est attach√© √† l'article comme mat√©riau pour le travail "√† domicile".  Pour plus de commodit√©, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">projet</a> et les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fichiers binaires sont</a> s√©par√©s. <br>  La d√©mo offre la possibilit√© de changer (d√©placer) la bande de fr√©quence occup√©e ainsi que la correction gamma de la trame de sortie (tout peut √™tre chang√© en temps r√©el). <br><br><h3>  PS </h3><br>  Je n'ai pas choisi C # depuis longtemps et il est tr√®s difficile de trouver l'heure dans l'horaire de travail, donc je m'excuse √† l'avance pour la confusion et la h√¢te du code. <br><br><h3>  PPS </h3><br>  Je n‚Äôattache pas un morceau de fil, deux prises et deux pi√®ces √† l‚Äôarticle - pas assez pour tout le monde. <br><br><h3>  Errata et annexe </h3><br>  - Dans certaines cartes son √† l'entr√©e, il y a un filtre passe-bas qui coupe tragiquement tout ce qui d√©passe ~ 15 kHz (pourquoi ???). <br><br>  - Par d√©faut, le projet de d√©monstration fonctionne avec une fr√©quence d'√©chantillonnage de 96 kHz, mais toutes les cartes son modernes ne le prennent pas en charge (pourquoi ???).  Si l'√©quipement ne peut pas 96 kHz, vous devez d√©finir 48 kHz dans les param√®tres, sinon, 44100 est certainement pris en charge partout, cependant, la dur√©e de transmission d'une image sera d'autant plus longue. <br><br>  Voici une liste d'ordinateurs portables et de cartes son pouvant √™tre consid√©r√©s comme de jeunes √©quipements sonars: <br><br><ul><li>  Lenovo ideapad Y510P avec son JBL </li><li>  Asus n55s </li><li>  Asus K501U </li><li>  carte son externe Sound Blaster X-Fi Surround 5.1 (mod√®le n ¬∞ SB 1095) </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr408871/">https://habr.com/ru/post/fr408871/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr408857/index.html">Revue de presse d'Oc√© Technology</a></li>
<li><a href="../fr408859/index.html">KidPRO - L'histoire d'un √©cureuil aidant les enfants</a></li>
<li><a href="../fr408861/index.html">Une nouvelle bioprinter aide √† traiter le diab√®te de type 1</a></li>
<li><a href="../fr408863/index.html">Num√©risation 3D de voitures dans le r√©glage et la r√©paration</a></li>
<li><a href="../fr408865/index.html">Nous supprimons le russe de notre anglais</a></li>
<li><a href="../fr408873/index.html">Revue vid√©o de la fraiseuse CNC 3Dtool AMAN</a></li>
<li><a href="../fr408875/index.html">Rouleau pour le dos</a></li>
<li><a href="../fr408879/index.html">Objectif fascinant de travailler beaucoup moins</a></li>
<li><a href="../fr408881/index.html">Mais que faire si nous vivons dans le futur et le pass√© en m√™me temps? Et quel est notre univers?</a></li>
<li><a href="../fr408883/index.html">Vid√©o 3Dtool Hercules Strong 2017 3D Printer Review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>