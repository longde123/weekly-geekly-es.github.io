<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤚🏿 🧝🏿 👨🏿‍🎓 索引数十亿个文本向量 ☸️ 👩🏾‍🔬 🤟🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="提取信息时，通常需要找到此类文本片段。 在搜索的上下文中，查询可以由用户（例如，用户在搜索引擎中输入的文本）或系统本身生成。 通常，我们需要将传入查询与已经建立索引的查询进行匹配。 在本文中，我们将研究如何构建一个系统来解决数十亿个请求而无需在服务器基础结构上花费大量资金。 

 首先，我们正式定义...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>索引数十亿个文本向量</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/479692/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/id/dd/fg/idddfg6zku7xq-zv9f0m8xemyiy.jpeg"></div><br> 提取信息时，通常需要找到<i>此类</i>文本片段。 在搜索的上下文中，查询可以由用户（例如，用户在搜索引擎中输入的文本）或系统本身生成。 通常，我们需要将传入查询与已经建立索引的查询进行匹配。 在本文中，我们将研究如何构建一个系统来解决数十亿个请求而无需在服务器基础结构上花费大量资金。 <br><a name="habracut"></a><br> 首先，我们正式定义问题： <br><br><blockquote> 给定一组固定的查询 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.838ex" height="2.419ex" viewBox="0 -780.1 791.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-51" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> Q </script> 传入请求 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.07ex" height="1.817ex" viewBox="0 -520.7 460.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-71" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> q </script> 和整数 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> k </script>  。 需要找到这样的查询子集 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>R&amp;#xA0;=&amp;#xA0;\&amp;#x5DE6;\&amp;#xA0;{q0&amp;#xFF0C;q1&amp;#xFF0C;...&amp;#xFF0C;qk&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5B50;&amp;#x96C6;Q</mtext></merror></math>" role="presentation"><span class="noError" style="display: inline-block;" aria-hidden="true">R&nbsp;=&nbsp;\左\&nbsp;{q0，q1，...，qk&nbsp;\右\}&nbsp;\子集Q</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>R&nbsp;=&nbsp;\左\&nbsp;{q0，q1，...，qk&nbsp;\右\}&nbsp;\子集Q</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-4"> R = \左\ {q0，q1，...，qk \右\} \子集Q </script> 对每个请求 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mi>R</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.379ex" height="2.419ex" viewBox="0 -780.1 2746.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-71" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-69" x="631" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-69" x="1040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-6E" x="1386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-52" x="1986" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> q_ {i} \ in R </script> 更像 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.07ex" height="1.817ex" viewBox="0 -520.7 460.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-71" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> q </script> 比中的任何其他请求 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo>&amp;#x2216;</mo><mi>R</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.443ex" height="2.419ex" viewBox="0 -780.1 2773.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-51" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJAMS-2216" x="1013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-52" x="2014" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo>∖</mo><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> Q∖R </script>  。 </blockquote><br> 例如，使用这组查询 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.838ex" height="2.419ex" viewBox="0 -780.1 791.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-51" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> Q </script>  ： <br><br><pre><code class="plaintext hljs">{tesla cybertruck, beginner bicycle gear, eggplant dishes, tesla new car, how expensive is cybertruck, vegetarian food, shimano 105 vs ultegra, building a carbon bike, zucchini recipes}</code> </pre> <br> 和 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>=</mo><mn>3</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.472ex" height="2.057ex" viewBox="0 -780.1 2356.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMAIN-3D" x="799" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMAIN-33" x="1855" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-9"> k = 3 </script> 您可以预期以下结果： <br><br><div class="scrollable-table"><table><tbody><tr><th> 输入要求 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.07ex" height="1.817ex" viewBox="0 -520.7 460.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-71" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> q </script><br></th><th> 类似查询 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-52" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> R </script><br></th></tr><tr><td> 特斯拉皮卡 <br></td><td>  {tesla cybertruck，tesla新车，cybertruck有多贵} <br></td></tr><tr><td> 最好的自行车2019 <br></td><td>  {shimano 105 vs ultegra，碳纤维自行车更好，齿轮传动} <br></td></tr><tr><td> 用蔬菜做饭 <br></td><td>  {茄子，西葫芦食谱，素食} <br></td></tr></tbody></table></div><br> 请注意，我们尚未定义<i>相似性</i>标准。 在这种情况下，这几乎意味着任何东西，但是通常可以归结为基于关键字或向量的某种形式的相似性。 使用基于关键字的相似性，如果两个查询包含足够的常用词，我们可以发现它们相似。 例如，查询“在慕尼黑开餐馆”和“慕尼黑最佳餐馆”类似，因为它们包含单词“ restaurant”和“ munich”。 而且“慕尼黑最佳餐厅”和“慕尼黑哪里吃饭”这两个查询已经不太相似了，因为它们只有一个通用词。 但是，如果第二对请求结果相似，那么在慕尼黑寻找餐厅的人会更好。 因此，我们将帮助基于向量的比较。 <br><br><h1> 单词的向量表示 </h1><br> 单词的向量表示是一种在自然语言处理中用于将文本或单词转换为向量的机器学习技术。 将任务移到向量空间中，我们可以对向量使用数学运算-求和和计算距离。 要在相似词之间建立链接，可以使用向量聚类的传统方法。 这些操作在原始词空间中<i>的含义</i>可能并不明显，但优点是现在我们可以使用各种数学工具。 如果您对单词向量及其应用的详细信息感兴趣，请阅读有关<a href="https://arxiv.org/pdf/1301.3781.pdf">word2vec</a>和<a href="https://nlp.stanford.edu/pubs/glove.pdf">GloVe的信息</a> 。 <br><br> 我们有一种从单词生成向量的方法，现在我们将它们收集到文本向量（文档或表达式的向量）中。 最简单的方法是添加（或平均）文本中所有单词的向量。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/692/bc5/b0c/692bc5b0ccbbe7a89392528365645708.png"><br>  <i><sup>图1：查询向量。</sup></i> <br><br> 现在，您可以通过在向量空间中表示两个文本（或查询）并计算向量之间的距离来确定它们的相似性。 通常，为此使用角距离。 <br><br> 结果，单词的向量表示允许不同类型的文本匹配，这补充了基于关键字的匹配。 您可以探索请求的语义相似性（例如，“慕尼黑最好的餐馆”和“慕尼黑哪里吃饭”），这是我们以前无法做到的。 <br><br><h1> 近似最近邻居搜索 </h1><br> 现在，我们可以优化原始查询匹配问题： <br><br><blockquote> 给定一组固定的查询向量 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.838ex" height="2.419ex" viewBox="0 -780.1 791.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-51" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> Q </script> 传入向量 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.07ex" height="1.817ex" viewBox="0 -520.7 460.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-71" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> q </script> 和整数 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-14"> k </script>  。 您需要找到这样的向量子集 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>R&amp;#xA0;=&amp;#xA0;\&amp;#x5DE6;\&amp;#xA0;{q0&amp;#xFF0C;q1&amp;#xFF0C;...&amp;#xFF0C;qk&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5B50;&amp;#x96C6;Q</mtext></merror></math>" role="presentation"><span class="noError" style="display: inline-block;" aria-hidden="true">R&nbsp;=&nbsp;\左\&nbsp;{q0，q1，...，qk&nbsp;\右\}&nbsp;\子集Q</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>R&nbsp;=&nbsp;\左\&nbsp;{q0，q1，...，qk&nbsp;\右\}&nbsp;\子集Q</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-15"> R = \左\ {q0，q1，...，qk \右\} \子集Q </script> 这样从 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.07ex" height="1.817ex" viewBox="0 -520.7 460.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-71" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-16"> q </script> 每个向量 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mi>R</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.379ex" height="2.419ex" viewBox="0 -780.1 2746.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-71" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-69" x="631" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-69" x="1040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-6E" x="1386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-52" x="1986" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-17"> q_ {i} \ in R </script> 比到中任何其他向量的距离短 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo>&amp;#x2216;</mo><mi>R</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.443ex" height="2.419ex" viewBox="0 -780.1 2773.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-51" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJAMS-2216" x="1013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-52" x="2014" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo>∖</mo><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-18"> Q∖R </script>  。 </blockquote><br> 这称为寻找最接近的邻居的任务。 在低维空间中，有<a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25B4%25D0%25B0%25D1%2587%25D0%25B0_%25D0%25BF%25D0%25BE%25D0%25B8%25D1%2581%25D0%25BA%25D0%25B0_%25D0%25B1%25D0%25BB%25D0%25B8%25D0%25B6%25D0%25B0%25D0%25B9%25D1%2588%25D0%25B5%25D0%25B3%25D0%25BE_%25D1%2581%25D0%25BE%25D1%2581%25D0%25B5%25D0%25B4%25D0%25B0">许多算法</a>可以快速解决问题。 但是当使用单词的矢量表示时，我们通常使用高维矢量（100-1000维）进行运算。 此处提到的方法不再起作用。 <br><br> 没有合适的方法可以快速确定高维空间中的最近邻居。 因此，我们通过允许使用近似结果来简化问题：我们将不满足于仅返回一些最接近或<i>在某种程度上</i>接近的邻居，而不是总是返回最接近的向量。 这被称为最近邻居任务的近似搜索，并且是一个活跃的研究领域。 <br><br><h3> 分层小世界 </h3><br> 分层可导航小世界图（ <a href="https://arxiv.org/abs/1603.09320">HNSW</a> ）是用于近似搜索最近邻居的最快算法之一。  HNSW中的搜索索引是一个多层结构，其中每个层都是一个接近图。 每个图节点对应于查询向量之一。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/42e/55e/4b7/42e55e4b72cd088b45e5aff56159f7fb.png"><br>  <sup><i>图2：多级接近图。</i></sup> <br> 使用放大方法在HNSW中查找最近的邻居。 它从最高级别的输入节点开始，并在每个级别上递归执行贪婪图遍历，直到在底部达到局部最小值。 <br><br> 有关算法和搜索技术的详细信息在科学工作中得到了很好的描述。 重要的是要记住，每个最近邻的搜索周期都包括遍历图的节点并计算向量之间的距离。 我们将在下面查看这些步骤，以使用此方法创建大型索引。 <br><br><h1> 索引数十亿查询的难度 </h1><br> 假设我们需要索引40亿个200维查询向量，每个维都由一个四字节浮点数表示（40亿个足以使任务有趣，但是您仍然可以将节点ID存储为常规的四字节数） 。 粗略的计算告诉我们，单独的向量大小将约为3 TB。 由于大多数现有库都使用RAM容量来近似搜索最近的邻居，因此我们将需要一个非常大的服务器，以便至少将向量推入RAM。 请注意，这并未考虑大多数方法所必需的附加搜索索引。 <br><br> 在我们搜索引擎发展的整个历史中，我们使用了几种不同的方法来解决此问题。 让我们考虑其中的一些。 <br><br><h3> 数据子集 </h3><br> 不允许我们完全解决问题的第一种也是最简单的方法是限制索引中向量的数量。 取十分之一的数据，我们创建了一个索引，该索引需要-令人惊讶-内存的10％。 但是，搜索的质量已经下降，因为现在我们操作的查询更少了。 <br><br><h3> 量化 </h3><br> 在这里，我们使用了所有数据，但是使用了<a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25B2%25D0%25B0%25D0%25BD%25D1%2582%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">量化来</a>减少了它们（我们使用了不同的量化技术，例如乘积量化，但是在这种数量的数据下无法达到预期的工作质量）。 通过消除一些错误，我们能够用量化的单字节版本替换原始向量中的所有四字节数字。 向量的RAM量减少了75％。 但是，我们仍然需要750 GB的内存（不计算索引本身的大小），这仍然是一个非常大的服务器。 <br><br><h1> 用Granne解决内存问题 </h1><br> 所描述的方法具有其优点，但是它们需要大量资源并且搜索质量较差。 尽管<a href="http://ann-benchmarks.com/">有些库的</a>响应时间不到1毫秒，但我们可能会牺牲速度以换取较低的硬件要求。 <br><br>  <a href="https://github.com/granne/granne">Granne</a> （基于图的近似最近邻居）是Cliqz开发并用于搜索此类查询的HNSW库。 它具有开源代码，但是该库仍在积极开发中。 改进的版本将于2020年在<a href="https://crates.io/">crates.io</a>上发布。 它是用Rust编写的，带有Python插件，旨在利用竞争力处理数十亿个向量。 从查询向量的角度来看，有趣的是Granne具有一种特殊的模式，与其他库相比，这种模式所需的内存要少得多。 <br><br><h3> 查询向量的紧凑表示 </h3><br> 减小查询向量的大小将为我们带来很多好处。 为此，让我们回头考虑创建向量。 由于查询由单词组成，而查询向量是单词向量的总和，因此我们可以明确拒绝存储查询向量，并根据需要对其进行计算。 <br><br> 您可以以单词集的形式存储查询，并使用查找表查找相应的向量。 但是，我们通过将每个查询存储为与查询中的单词向量相对应的整数ID列表来避免重定向。 例如，将查询“慕尼黑最佳餐厅”保存为 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>b</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>u</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>t</mi></mrow></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>f</mi></mrow></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x6155;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5C3C;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x9ED1;</mo></mrow></mrow></msub></mrow><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.716ex" height="2.78ex" viewBox="0 -832 11933.2 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-69" x="0" y="0"></use><g transform="translate(345,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-65" x="429" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-73" x="896" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-74" x="1365" y="0"></use></g></g><g transform="translate(1945,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(2775,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-69" x="0" y="0"></use><g transform="translate(345,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-65" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-73" x="918" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-74" x="1387" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-61" x="1749" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-75" x="2278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-72" x="2851" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-61" x="3302" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-6E" x="3832" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-74" x="4432" y="0"></use></g></g><g transform="translate(6610,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(7440,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-69" x="0" y="0"></use><g transform="translate(345,-155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-66" x="485" y="0"></use></g></g><g transform="translate(8618,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(9448,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-69" x="0" y="0"></use><g transform="translate(345,-170)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(36.68) matrix(1 0 0 -1 0 0)">慕</text><g transform="translate(586,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(36.68) matrix(1 0 0 -1 0 0)">尼</text></g><g transform="translate(1173,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(36.68) matrix(1 0 0 -1 0 0)">黑</text></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMAIN-5D" x="11654" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>b</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>u</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>t</mi></mrow></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>f</mi></mrow></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo>慕</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>尼</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>黑</mo></mrow></mrow></msub></mrow><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-19"> [{i_ {best}}，{i_ {restaurant}}，{i_ {of}}，{i_ {慕尼黑}}] </script> 在哪里 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x6700;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x4F73;</mo></mrow></mrow></msub></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.761ex" height="2.539ex" viewBox="0 -728.2 1619.3 1093.4" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-69" x="0" y="0"></use><g transform="translate(345,-170)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(36.68) matrix(1 0 0 -1 0 0)">最</text><g transform="translate(586,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(36.68) matrix(1 0 0 -1 0 0)">佳</text></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo>最</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>佳</mo></mrow></mrow></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-20"> {i_ {最佳}} </script>  -这是单词“ best”的向量ID，以此类推。假设我们有少于一千六百万个单词向量（超过这个数目，每个单词将花费1个字节），那么您可以使用3个字节来表示所有单词ID。 也就是说，除了存储800字节（或量化矢量的情况下为200字节）之外，我们将仅为此请求存储12个字节（这并非完全正确。由于请求包含不同数量的单词，因此我们还需要将列表偏移量存储在单词index中。每个请求将需要5个字节）。 <br><br> 至于词向量，我们都需要它们。 但是，单词的数量比通过组合这些单词可以创建的查询的数量小得多。 这意味着单词的大小不是那么重要。 如果将单词向量存储为简单数组中的四字节浮点版本 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>v</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.455ex" viewBox="0 -520.7 485.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/mailru/blog/479692/&amp;xid=17259,15700021,15700186,15700190,15700259,15700271&amp;usg=ALkJrhj3eE7gndzujDUrS4Lemt9EgiXhJg#MJMATHI-76" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-21"> v </script>  ，那么每百万个字我们需要不到1 GB的空间。 此卷可以轻松放入RAM。 现在查询向量看起来像这样： <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>{v&amp;#xA0;_&amp;#xA0;{{i_&amp;#xA0;{best}}}&amp;#xA0;+&amp;#xA0;{v&amp;#xA0;_&amp;#xA0;{{i_&amp;#xA0;{rest}}}}&amp;#xA0;+&amp;#xA0;{v&amp;#xA0;_&amp;#xA0;{{i_&amp;#xA0;{of}}}&amp;#xA0;+&amp;#xA0;{v&amp;#xA0;_&amp;#xA0;{{i_&amp;#xA0;{munich}}}}</mtext></merror></math>" role="presentation"><span class="noError" style="display: inline-block;" aria-hidden="true">{v&nbsp;_&nbsp;{{i_&nbsp;{best}}}&nbsp;+&nbsp;{v&nbsp;_&nbsp;{{i_&nbsp;{rest}}}}&nbsp;+&nbsp;{v&nbsp;_&nbsp;{{i_&nbsp;{of}}}&nbsp;+&nbsp;{v&nbsp;_&nbsp;{{i_&nbsp;{munich}}}}</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>{v&nbsp;_&nbsp;{{i_&nbsp;{best}}}&nbsp;+&nbsp;{v&nbsp;_&nbsp;{{i_&nbsp;{rest}}}}&nbsp;+&nbsp;{v&nbsp;_&nbsp;{{i_&nbsp;{of}}}&nbsp;+&nbsp;{v&nbsp;_&nbsp;{{i_&nbsp;{munich}}}}</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-22"> {v _ {{i_ {best}}} + {v _ {{i_ {rest}}}} + {v _ {{i_ {of}}} + {v _ {{i_ {munich}}}} </script>  。 <br><br> 查询提交的最终大小取决于查询中的单词总数。 对于40亿个查询，这大约是80 GB（包括单词向量）。 换句话说，与原始单词向量相比，大小减少了97％，与量化向量相比减少了90％。 <br><br> 还有一件事。 一次搜索，我们需要访问图的大约200-300个节点。 每个节点有20-30个邻居。 因此，我们需要计算从输入查询向量到索引中4000-9000个向量的距离。 而且，我们需要生成向量。 动态创建查询向量需要多长时间？ <br><br> 事实证明，使用相当新的处理器，可以在几毫秒内解决此问题。 以前在1毫秒内运行的请求现在可以在5毫秒内运行。 但是随后我们将向量的内存量减少了90％。 我们很高兴接受这种妥协。 <br><br><h3> 在向量和索引的内存中显示 </h3><br> 上面，我们解决了减少向量的内存量的问题。 但是，在解决了这个问题之后，索引结构本身成为了限制因素。 现在您需要减小其大小。 <br><br> 在Granne中，图结构以邻接列表的形式紧凑地存储，每个节点的邻居数量可变。 也就是说，内存几乎不会浪费在元数据上。 索引结构的大小在很大程度上取决于设计参数和图形属性。 不过，要了解索引的大小，可以说我们可以为40亿个向量建立索引，总大小约为240 GB。 对于大型服务器上的内存使用，这可能是可以接受的，但可以做得更好。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e73/daa/0de/e73daa0dea90e3e84afe9aaec7bd6a8e.jpg"><br>  <sup><i>图3：RAM和SSD中的两种不同布局。</i></sup> <br><br>  Granne的一个重要特性是能够<a href="https://ru.wikipedia.org/wiki/Mmap">在内存中显示</a>索引和查询向量。 这使我们可以延迟加载索引并与多个进程共享内存。 索引和查询文件在内存中分为单独的显示文件，可以在RAM和SSD上以不同的布局使用。 如果对延迟的要求略低，则将索引放在SSD上，请求到RAM，我们将保持可接受的速度，而不会占用过多的内存。 在本文的结尾，我们将看到这种折衷的外观。 <br><br><h3> 改善数据局部性 </h3><br> 在我们当前的配置中，当索引位于SSD上时，每个请求最多需要从磁盘读取200-300次。 您可以尝试通过排列其向量非常接近以使它们的HNSW节点位于索引中且彼此之间也不远的元素来增加数据的局部性。 数据局部性提高了性能，因为单个读取操作（通常从4 KB中提取）更可能包含遍历图形所需的其他节点。 从而减少了每次搜索的数据检索次数。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1f8/1d2/2f4/1f81d22f418256c704bb12b7514e68a1.jpg"><br>  <sup><i>图4：数据局部性减少了信息检索。</i></sup> <br><br> 应当注意，对元素进行重新排序不会影响搜索结果，这是一种加快搜索速度的方法。 也就是说，顺序可以是任意顺序，但并非每个选项都会加快搜索速度。 找到最佳顺序非常困难。 但是，我们成功使用的启发式方法是按每个查询中最<i>重要的</i>单词对查询进行排序。 <br><br><h1> 结论 </h1><br> 我们使用Granne来创建和维护具有查询向量的数十亿美元的索引，以便搜索内存消耗相对较低的类似查询。 下表显示了不同方法的要求。 对搜索过程中的延迟的绝对值表示怀疑，因为它们在很大程度上取决于被认为是可接受的响应。 但是，此信息描述了这些方法的相对性能。 <br><br><div class="scrollable-table"><table><tbody><tr><th></th><th> 初始值 <br></th><th> 量化 <br></th><th>  Granne（仅限RAM） <br></th><th>  Granne（RAM + SSD） <br></th></tr><tr><td>  <b>记忆</b> <br></td><td>  3000 + 240 GB <br></td><td>  750 + 240 GB <br></td><td>  80 + 240 GB <br></td><td>  80-150 GB * <br></td></tr><tr><td>  <b>固态硬盘</b> <br></td><td>  -- </td><td>  -- </td><td>  -- </td><td>  240 GB <br></td></tr><tr><td>  <b>延误</b> <br></td><td>  1毫秒 <br></td><td>  1毫秒 <br></td><td>  5毫秒 <br></td><td>  10-50毫秒 <br></td></tr></tbody></table></div><br>  <i>*分配大于所需数量的内存索引会导致某些节点（经常访问）的缓存，从而减少了搜索的延迟。</i>  <i>为此，不使用内部缓存，仅使用内部OS工具（Linux内核）。</i> <br><br> 应该注意的是，本文中提到的某些优化不适用于解决用不可分解的向量查找最近邻居的一般问题。 但是，它们适用于可以从更少的部分生成元素的任何情况（如单词和查询的​​情况）。 否则，您仍然可以将Granne与源向量一起使用，与其他库一样，它只占用更多的内存。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN479692/">https://habr.com/ru/post/zh-CN479692/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN479682/index.html">Sysdig容器使用情况报告2019：新的Kubernetes和安全性详细信息</a></li>
<li><a href="../zh-CN479684/index.html">如何为SEO收集低频密钥：4种简单方法</a></li>
<li><a href="../zh-CN479686/index.html">2020年后IT外包的主要趋势</a></li>
<li><a href="../zh-CN479688/index.html">考虑税收和生活费用，开发商在哪些国家和城市能赚更多钱？</a></li>
<li><a href="../zh-CN479690/index.html">Zork和Z-Machine：开发人员如何将游戏从大型机转移到8位​​家用计算机</a></li>
<li><a href="../zh-CN479696/index.html">关于Alter Table的几句话，或如何做</a></li>
<li><a href="../zh-CN479700/index.html">CIMON-2 ：（联合国）世界末日，或者IBM Watson如何爬上云层</a></li>
<li><a href="../zh-CN479702/index.html">烤面包机，我的圈子和Freelansim成为Habr的一部分</a></li>
<li><a href="../zh-CN479704/index.html">EA Origin Windows客户端中的特权升级（CVE-2019-19247和CVE-2019-19248）</a></li>
<li><a href="../zh-CN479708/index.html">关于Habr + Competition品牌更名的非官方帖子</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>