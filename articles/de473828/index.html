<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📼 👩🏼‍🤝‍👨🏿 🍷 Computer Vision als Alternative zu Büroausweisen ☀️ 👆🏿 🧜🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Heute werde ich Ihnen erzählen, wie wir im Büro ein Zugangskontrollsystem basierend auf dem Vision- Gesichtserkennungsdienst hergestellt haben. Zunäch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Computer Vision als Alternative zu Büroausweisen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/473828/"><img src="https://habrastorage.org/webt/un/xu/h1/unxuh13fdsjq-aryuwovmchvjxw.jpeg"><br><br>  Heute werde ich Ihnen erzählen, wie wir im Büro ein Zugangskontrollsystem basierend auf dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vision-</a> Gesichtserkennungsdienst hergestellt haben.  Zunächst ein kleiner Hintergrund.  Wie bei jedem E-Mail-Dienst haben wir ein Anti-Spam-System erstellt.  Solche Systeme werden jetzt auf der Grundlage von maschinellem Lernen hergestellt. Wir haben ein starkes Team, das dafür verantwortlich ist.  Und wo maschinelles Lernen stattfindet, gibt es Computer Vision.  Daher entstand der Vision-Service ganz natürlich und natürlich. <br><br>  Parallel dazu haben wir vor einigen Jahren die Cloud eingeführt, einen zuverlässigen Dateispeicher mit Geoverteilung an Rechenzentren, der sowohl von Einzelpersonen als auch von Unternehmen verwendet werden kann.  Im Laufe der Zeit haben wir eine "Cloud for Business" erhalten, in der nicht nur Dateien gespeichert werden, sondern auch virtuelle Maschinen bestellt werden können.  Allmählich wurde daraus MCS - Mail.ru Cloud Solutions, bei denen Vision organisch in einen der Services passt. <br><a name="habracut"></a><br><h1>  Wolke </h1><br>  Unsere neuronalen Netze können nicht nur Gesichter erkennen, sondern auch verschiedene <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Objekte, Objekte und Szenen</a> , einschließlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sehenswürdigkeiten</a> .  Jetzt können sie ungefähr 10.000 Kategorien erkennen, und Bildverarbeitung funktioniert manchmal besser als Menschen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/399/b8d/be4/399b8dbe4c0ba7bb25dcc7701b9efc34.jpg"><br><br>  Dies ist meine Tochter in 2012, in 2015 und 2018.  Wenn ich sie nicht persönlich kannte, verstand ich wahrscheinlich nicht sofort, dass dies ein und dieselbe Person ist.  Und das neuronale Netzwerk konnte übereinstimmen und verstehen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/543/a67/56d/543a6756d6caa113dd04657c45f8b550.jpg"><br><br>  Hier wandte sich das Mädchen ab und blinzelte, und der Junge im Allgemeinen in einer Mütze mit einem Schatten auf der Hälfte seines Gesichts.  Gleichzeitig erkannte das neuronale Netzwerk sie trotz dieser schwierigen Bedingungen genau.  Natürlich konnte die Technologie, die sich innerhalb des Unternehmens entwickelt, nicht anders, als Unterstützung bei internen Diensten zu finden. <br><br><h1>  Unser Intranet </h1><br>  Unser Intranet heißt sys.  Dies ist eine Art soziales Netzwerk (wir haben nur wenige davon).  Darin laden Mitarbeiter Fotos von verschiedenen Veranstaltungen hoch. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2c/f0b/a5b/e2cf0ba5b544efc7d8d52f1c2c7ef640.jpg"><br><br>  Wenn mehrere hundert Fotos von der Veranstaltung ausgelegt sind, ist es ziemlich schwierig, sich dort zu finden.  Daher haben wir mit diesen Alben eine Bildverarbeitung verbunden, die direkt im Intranet an einem einzigen Ort die Fotos zeigt, auf denen ich abgebildet bin.  Hier hat mich das System auf einer der Sommer-Firmenfeiern gesehen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b47/69c/5b9/b4769c5b9c349f443e9968574d5417d3.jpg"><br><br>  Das neuronale Netzwerk hat mich sogar in der Dämmerung im Profil erkannt, und auf dem Foto sind viel mehr Personen zu sehen. <br><br><h1>  Konferenzregale </h1><br>  Später machten wir Konferenzregale.  Ich habe Software für das iPad geschrieben, die im Rack installiert ist, aber im Allgemeinen bin ich ein iOS-Entwickler und habe nichts mit Computer Vision zu tun. Ich helfe nur auf freundliche Weise. <br><br><img src="https://habrastorage.org/webt/p5/01/ul/p501uly37m546fdxxrwwtuegigo.png"><br><br>  Was ist die Essenz dieses Racks?  Während der gesamten Veranstaltung - einem Meeting, einer Konferenz, einer Firmenfeier oder zumindest einem Geburtstag - werden Sie von einem Fotografen fotografiert.  Von Zeit zu Zeit werden akkumulierte Bilder in die Cloud verschoben.  Sie können jederzeit zum Schalter gehen, ein Bild aufnehmen und auf die Schaltfläche „Find Me“ klicken.  Das Rack zeigt entweder sofort alle Fotos an, auf denen Sie aufgenommen wurden, oder sagt, dass bisher nichts gefunden wurde, wenn das System die Bilder noch nicht indiziert hat, und fordert Sie auf, eine E-Mail einzugeben.  Und nach der Veranstaltung erhalten Sie per E-Mail einen Link zu dem Ordner in der Cloud mit allen Fotos, auf denen Sie sich befinden.  Dies ist eine der Anwendungen des Vision-Dienstes. <br><br><h1>  Zugangssystem </h1><br>  Natürlich wollte ich solche Gesichtserkennungsfunktionen nutzen, um nicht nur nach meiner Physiognomie in Unternehmensbildern zu suchen, sondern auch nach etwas Praktischerem.  Zum Beispiel für ein automatisches Durchsatzsystem.  Das Anbringen eines Passes an jedem Eingang Ihrer Etage ist nicht sehr praktisch: Sie vergessen oft den Pass, und für Mädchen in leichter Kleidung im Sommer gibt es keinen Platz, um den Pass zu reparieren. <br><br>  Deshalb haben wir uns entschlossen zu experimentieren.  Wir haben alle Voraussetzungen dafür: Wir müssen niemanden um Erlaubnis bitten, eine sehr reaktionsschnelle Verwaltungsabteilung, die seufzend sagt: „Okay.  Bringen Sie Ihre Kameras an.  Nur nicht an der Tür.  Türen beziehen sich auf den Brandschutz. “  Wir sind: „Na dann.  Wir werden an der Seite befestigen. "  Wir haben auch geduldige Kollegen, die unter uns gelitten haben. <br><br><h1>  Architektur </h1><br>  Auf den ersten Blick scheint die Architektur des Zugangssystems sehr einfach zu sein: Die Kamera nimmt Bilder auf, sendet sie an Vision und Vision öffnet die Tür.  Aber als wir anfingen, mit Kollegen zu malen, wie das eigentlich geht, bekamen wir ein solches Schema: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7be/683/61c/7be68361c530fdb7f8da32500b7a5c4c.jpg"><br><br>  Den Block rechts nennen wir die „Kamera“ - dies ist das Modul, das an der Tür hängt.  Es besteht aus drei Teilen.  Der Raspberry Pi empfängt Videos von einer USB-Kamera, codiert mit FFmpeg und sendet.  Wir haben mehrere IP-Kameras einer angemessenen Preisklasse getestet, und jeder hatte eine merkliche Verzögerung von etwa 0,5 s.  Und da es in anderen Phasen zu Verzögerungen kommt, wenn eine Person auftaucht, in die Kamera schaut und für einige Sekunden nichts passiert, möchte sie bereits einen Pass machen.  Daher haben wir Verzögerungen nach Möglichkeit reduziert, und der Raspberry Pi mit einer USB-Kamera erwies sich als schneller als viele kommerzielle IP-Kameras.  Mit der Himbeere ist auch ein kleiner Arduino mit einer mehrfarbigen LED und einem Quietscher verbunden.  Die Standard-LED leuchtet rot.  Wenn eine Person auftaucht und erkannt wird, leuchtet das Grün auf. <br><br>  Der Raspberry Pi überträgt also den Videostream, der über kabelgebundenes Ethernet in den Server gelangt.  Wir haben auf jeder Etage einen Serverraum, in dem sich Schalter, Verbindungskabel zu den Schreibtischen der Mitarbeiter befinden, und ein Vollzeit-Zugangskontrollsystem - ein Zugangskontroll- und -verwaltungssystem. <br><br>  Wir haben einen weiteren Raspberry Pi in den Serverraum gestellt, der den Videostream in Echtzeit empfängt und über OpenCV ausführt.  Warum brauchen wir OpenCV?  Wir müssen feststellen, ob das Bild ein Gesicht enthält.  Ein neuronales Netzwerk, das eine Person auf einem Foto definiert, funktioniert etwas länger und es ist zu teuer, ihm ständig einen Videostream zuzuführen.  Daher bestimmen wir über OpenCV das Vorhandensein eines Gesichts. Wenn es angezeigt wird, senden wir es an Vision.  Der Service antwortet entweder, dass er diesen Mitarbeiter nicht gefunden hat, oder sendet die Mitarbeiterkennung in der HR-Datenbank.  Mit dieser Mitarbeiter-ID rufen wir das Intranet auf, das dem ACS zugeordnet ist, und es gibt uns die Pass-ID zurück.  Weiter werfen wir diese Pass-ID in Arduino, die sie an das ACS weitergibt.  Für ein Zugangskontrollsystem entspricht dies einer Person, die einen Pass beantragt.  Das heißt, wir ändern das ACS in keiner Weise, es protokolliert weiterhin den Ein- und Ausstieg von Mitarbeitern. <br><br>  Wie haben wir unser System in ACS integriert?  In unserem Büro werden Bolid C2000-2-Geräte verwendet. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/351/01a/0de/35101a0de56c7879ac661be35a5060b8.jpg"><br><br>  Dies ist ein inländisches Zugangskontrollsystem.  Höchstwahrscheinlich können Sie über die 485. Schnittstelle eine Verbindung zu diesen Geräten herstellen, aber wir haben eine Verbindung über das Wiegand-Protokoll hergestellt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e5d/36e/70b/e5d36e70b78094589c3c63df5f6ee934.jpg"><br><br>  Wir haben den Arduino, der als Proxy fungiert, mit dem Passleser verbunden, der in der Nähe der Tür installiert ist. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9bc/26d/700/9bc26d7009e2dae347db5223fd50dfa8.jpg"><br><br>  Das Foto zeigt den Stromanschluss und zwei Datenleitungen vom Passleser.  Das Pad wird für eine bequemere Verbindung verwendet. <br><br>  Arduino empfängt die Passnummer entweder vom Lesegerät oder vom Raspberry Pi über USB und gibt sie an das ACS weiter.  Das ACS weiß nicht einmal, woher die Passnummer stammt. <br><br><h1>  Wiegand </h1><br>  Dies ist ein Standardprotokoll für Zugangskontrollsysteme, das von den meisten Lesern unterstützt wird.  Das Protokoll ist sehr einfach: zwei Datenleitungen, eine Zeile mit Nullen und eine Zeile mit Einheiten.  Sobald Sie die Nulllinie mit Masse verbinden, versteht der Leser, dass Null übertragen wird, genau wie bei Einheiten.  Das heißt, das Protokoll hat keine standardisierten Zeitabläufe, und die Sprungnummer ist leicht durch einen Interrupt auf dem Arduino zu lesen, es ist einfach, sie als Datensequenz darzustellen.  Und da die Aufnahme eine Art Timing erfordert, habe ich mich auf folgende Werte konzentriert: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6aa/d03/ee3/6aad03ee3eb8aa49fab36710af32b342.jpg"><br><br>  Es gibt bereits eine fertige Bibliothek für Arduino.  Sie kann verschiedene Wiegand-Formate lesen, aber ihre Fähigkeiten sind darauf beschränkt.  Und ich musste noch senden.  Deshalb habe ich meine Bibliothek geschrieben, die nur mit dem Wiegand-26-Format funktioniert.  26 ist die Anzahl der Bits: 3 Bytes der Sprungnummer und 2 Paritätsbits.  Darüber hinaus steht in allen Dokumentationen und Artikeln, dass Ihr moderner Controller höchstwahrscheinlich die Paritätsbits ignoriert, sodass ich faul bin und sie nicht zähle, sondern immer Null sende.  ACS nimmt dies normal wahr. <br><br>  Wir hatten ein anderes Problem: Wenn jemand zuerst vor der Kamera erschien und dann, ohne auf die Operation zu warten, einen Pass anwandte, entstand eine Rennsituation: Gleichzeitig kam die Passnummer vom Leser und von der Erkennung.  ACS konnte damit nicht umgehen und ließ keine Leute herein.  Daher musste ich der Bibliothek einen Ringpuffer mit 4 Codes hinzufügen.  Unabhängig davon, woher die Codes kommen, werden sie in den Puffer gestellt und dann mit einer Zeitüberschreitung von 0,5 s an das ACS übertragen.  Seitdem haben sich Kollegen nicht mehr darüber beschwert, dass sie nicht erlaubt sind. <br><br><h1>  Prüfstand </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/158/b78/43f/158b7843fe5152a47f530123a3342908.jpg"><br><br>  Der erste Prototyp wurde aus etwas Schrecklichem zusammengebaut.  Raspberry Pi hing in einer Schachtel an einem lächerlichen Gestell, und eine Kamera wurde auf ein doppelseitiges Klebeband geklebt.  Arduino hängt an den Seitenestrich.  Im Allgemeinen ist alles, was wir lieben, sehr DIY. <br><br>  Natürlich war es in dieser Form unmöglich zu gehen, es war notwendig, schön zu arrangieren.  Wir haben mit mehreren Auftragnehmern gesprochen, sie haben uns versprochen, Muster in China zu bestellen, aber dann sind alle vereinbarten Fristen abgelaufen, und niemand hat uns etwas angeboten. <br><br>  Kundenspezifische Produkte haben ein Problem: Alle Lösungen sind hochspezialisiert und werden speziell für uns hergestellt.  Erstens werden wir vom Lieferanten abhängig.  Zweitens ergibt sich ein einzigartiges Schaltungsdesign mit einer geringen Auflage, was bedeutet, dass die Kosten für ein Stück hoch sind.  Drittens ist die Produktionszeit lang genug. Wenn eine Kopie fehlschlägt, können wir keinen Ersatz schnell im Geschäft kaufen. Wir müssen auf die nächste Auflage warten. Wenn wir dies sofort tun, werden die verbleibenden Kopien im Lager abgestaubt. <br><br>  Nachdem uns alle potenziellen Partner im Stich gelassen hatten, ging ich zu einem Kollegen von Vision und sagte: „Volodya, lassen Sie mich einen Fall auf Ihrem 3D-Drucker drucken, damit er schön aussieht.“  Er seufzte und sagte: „Komm schon.  Was zu tun ist?" <br><br><h1>  Kamera V 1 </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/6f1/4f0/c61/6f14f0c6132add7dcd3eb753d95e822e.jpg"><br><br>  In Fusion habe ich so ein Frankenstein-Monster gezeichnet.  In der Ecke sollte sich ein Raspberry Pi mit einem Eingang für ein Ethernet-Kabel befinden.  Seiteneingang für Strom.  Der "zweite Stock" war eine Kamera.  Das Ergebnis war eine große Struktur, und ich habe sie sogar mit einer dünnen Schicht bedruckt, um nicht viel Plastik auszugeben.  Es sah schrecklich aus und das Aufhängen war noch peinlicher. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d5b/8ba/682/d5b8ba6826307a63d09473ef779d646c.jpg"><br><br>  Außerdem hat mir ein Kollege eine solche Referenz geschickt, sagen sie, das würde uns gefallen.  Ich antwortete, dass ich dies nicht tun könne, beschloss aber, ein anderes Gebäude zu entwerfen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9f6/668/e5e/9f6668e5e503946ad94e4a75319d4816.jpg"><br><br>  Das neue Gehäuse hatte einen Durchmesser von 11 cm und war kleiner als die CD.  Die Platzierung der Füllung erfolgt ebenfalls zweischichtig.  Nachdem ich die erste Version gedruckt hatte, wurde mir klar, dass es keinen Sinn macht, die USB-Kamera vollständig in ihre native Hülle zu stecken.  Ich habe es vorsichtig zerlegt und es stellte sich heraus, dass es 4 Landelöcher auf der Frontplatte hat.  Ich habe dieses Panel mit einer Kamera zu einer gemeinsamen Baugruppe mit Hochtöner und LED kombiniert. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/031/180/4a4/0311804a49018e3b8f7f84b86caffc22.jpg"><br><br>  Zuerst haben wir versucht, über gpio ein Quietschen auf dem Raspberry Pi zu erzeugen.  Es stellte sich als äußerst schlecht heraus.  Aus diesem Grund haben wir uns entschlossen, diese Funktion getrennt vom Raspberry Pi zu übernehmen, indem wir ein kleines Arduino (eigentlich Iskra mini), an das der Quietscher und die LED gelötet wurden, über TTL direkt an den Block angeschlossen haben. <br><br>  So sah es im Kampf aus: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/93b/9fe/6ec/93b9fe6ecea2fff3b39c6c60a83240a9.jpg"></div><br>  Wir haben das Gerät auf den Boden gehängt.  In dieser Form lebte es lange genug.  Quietschend, wunderschön leuchtend, die Tür öffnend jedoch nicht jedes Mal.  Die Kollegen beschwerten sich jedoch, dass die LED zu hell sei.  Ich musste es 4 mal schwächen. <br><br><h1>  Kamera V 2 </h1><br>  Dann machten sie diese Option: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b73/9b4/caf/b739b4caf65d413e545e9f1f1a3bd784.jpg"><br><br>  Es wurde vom Design des Xiaomi-Hubs mit einem leuchtenden Ring um den Umfang inspiriert.  Es sieht sehr schön aus.  Das Vision-Logo besteht aus einzelnen Teilen, die aus verschiedenfarbigen Kunststoffen gedruckt sind.  Hier ist das Modell: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ea/e91/536/1eae91536fc7fb62bf7b9dc8c4ee24d5.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d70/1ab/64d/d701ab64dc264959923d6c67ce011bd8.jpg"><br><br>  Diesmal habe ich den Quietscher an die Rückwand gestellt, die LED in einem transparenten Ring um den Umfang montiert und aus einem transparenten PLA gedruckt.  Das Dekor brach innen fast sofort zusammen, weil es ursprünglich einfach durch Reibung eingesetzt wurde und ich es auf Kleber auftragen musste. <br><br><h1>  Kameraprobleme </h1><br>  Wir hatten die Idee, diese Entscheidung im gesamten Gebäude zu wiederholen.  Aber es gibt ein Problem: Fast alle Stockwerke haben zwei Türen, und jede sollte zwei Kameras haben, nur 96 Kameras für nur einen unserer Türme, und jetzt wird die zweite aktiv entwickelt.  Es ist möglich, so viele Fälle zu drucken, aber es scheint bereits kompliziert zu sein.  Darüber hinaus haben wir einige Komponenten im Gerät, was viele Fehlerquellen bedeutet.  Wenn wir die Lösung auf das gesamte Gebäude skalieren, werden wir diese Kameras ständig warten.  Wieder die Komplexität des schnellen Austauschs, da jede Kamera ein Einzelgerät ist.  Und Sie müssen entweder viele davon mit einem Rand drucken oder, falls etwas passiert ist, sofort einen neuen ausführen, drucken und sammeln.  Wir haben festgestellt, dass DIY-Lösungen cool sind, aber Sie benötigen etwas Bequemeres für die Replikation.  Und die Idee kam, alles auf das iPad zu übertragen. <br><br><h3>  IPad </h3><br>  IPad hat mehrere Vorteile.  Der erste ist der Bildschirm.  Die Kollegen haben sich über das fehlende Feedback beschwert, sie sind geeignet und verstehen nicht, ob die Anerkennung begonnen hat oder nicht, um auf sie zu warten oder nicht. <br><br>  Zweitens verfügt iOS über eine integrierte Gesichtserkennungsfunktion.  Die von OpenCV ausgeführte Funktion wurde an das iPad übergeben.  Auf dem Bildschirm wird ein Rahmen angezeigt, und die Person sollte so weit kommen, dass das Gesicht in diesen Rahmen passt.  Danach erkennt das System es automatisch, Sie müssen nichts mehr drücken. <br><br>  Drittens ist das iPad ein Massenprodukt.  Wenn es fehlschlägt, setzen wir einen anderen.  Obwohl das Tablet selbst etwa 20.000 Rubel kostet, ist es immer noch billiger als die von Partnern angebotenen kundenspezifischen Kameras.  Darüber hinaus schneller und zuverlässiger. <br><br><h1>  Neue Architektur </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/35e/90f/685/35e90f685bd150fcc133f73a24b07cee.jpg"><br><br>  Das iPad übernahm die meisten Funktionen.  Auf dem Raspberry Pi, der sich im Serverraum befindet, gibt es tatsächlich nur einen HTTP-Host, der eine GET-Anforderung mit einer Pass-ID akzeptiert.  Er gibt den Code sofort in Arduino und sie in ACS. <br><br>  In der ersten Version war Raspberry Pi sehr geladen, da OpenCV ständig daran arbeitete.  Es war nicht mehr möglich, eine zweite Kamera daran anzuschließen, da nicht genügend Rechenleistung vorhanden war.  Wir haben bereits darüber nachgedacht, dort einen ehrlichen Computer zu installieren, der 4 Threads von zwei Türen aus analysiert.  Aber dazu kam es nicht.  Jetzt wird die Gesichtssuche im Bild unabhängig auf jedem iPad durchgeführt.  Im Kreuz gibt es zwei Arduino, einen für jede Tür.  Beide Boards arbeiten mit Ein- und Ausstiegspässen.  Warum ist es wichtig, mit Ein- und Ausreisekarten zu arbeiten?  Erstens, wenn das Gesicht erkannt wird und sich die Tür öffnet, leuchtet das grüne Licht am Kartenleser auf und die Kollegen verstehen, dass Sie ausgehen können.  Zweitens protokolliert ACS Ein- und Ausgänge.  Wenn wir die Ein- und Ausgabe getrennt emulieren, wird das ACS-Operationsschema nicht unterbrochen. <br><br>  Natürlich haben sich Designer zusammengerissen, die uns eine schöne Oberfläche gezeichnet haben.  So sieht es jetzt auf einer der Etagen unseres Büros aus: <br><br><img src="https://habrastorage.org/webt/t_/mv/27/t_mv273f9oor1vamysoa-hwybxe.jpeg"><br><br><h1>  Arbeiten Sie mit Vision </h1><br>  Trotz der Tatsache, dass MCS ein Geschäftsprodukt ist, können Amateure es auch verwenden.  Der Service bietet jedem 5.000 kostenlose Transaktionen pro Monat, das sind 166 pro Tag.  Daher können Sie sich für Ihre häuslichen Bedürfnisse bewerben, wenn Sie natürlich in das Limit passen.  Wie kann das gemacht werden? <br><br><pre><code class="python hljs">python examples/python/smarty.py \ -u <span class="hljs-string"><span class="hljs-string">"https://smarty.mail.ru/api/v1/persons/recognize ?oauth_provider=mcs&amp;oauth_token=e50b000614a371ce 99c01a80a4558d8ed93b313737363830"</span></span> \ -p friends1.jpg \ --meta <span class="hljs-string"><span class="hljs-string">'{"space":"1", "create_new":true}'</span></span> \ -v</code> </pre> <br>  Machen Sie ein Foto und senden Sie es zusammen mit unserem Zugriffstoken an Vision.  Wir geben an, dass wir mit dem ersten Leerzeichen arbeiten und setzen <code>create_new</code> - dann erstellt das System für jede unbekannte Person eine neue Kennung.  Folgendes erhalten wir als Antwort: <br><br><pre> <code class="python hljs">{ <span class="hljs-string"><span class="hljs-string">"status"</span></span>:<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-string"><span class="hljs-string">"body"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"objects"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"status"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"file_0"</span></span>, <span class="hljs-string"><span class="hljs-string">"persons"</span></span>:[ {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person1"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">102</span></span>,<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">184</span></span>,<span class="hljs-number"><span class="hljs-number">134</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.99999</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.5025</span></span>}, {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person2"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">393</span></span>,<span class="hljs-number"><span class="hljs-number">74</span></span>,<span class="hljs-number"><span class="hljs-number">461</span></span>,<span class="hljs-number"><span class="hljs-number">166</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.99987</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.548</span></span>}, {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person3"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">458</span></span>,<span class="hljs-number"><span class="hljs-number">48</span></span>,<span class="hljs-number"><span class="hljs-number">535</span></span>,<span class="hljs-number"><span class="hljs-number">149</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.99976</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.4766</span></span>}, {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person4"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">273</span></span>,<span class="hljs-number"><span class="hljs-number">45</span></span>,<span class="hljs-number"><span class="hljs-number">352</span></span>,<span class="hljs-number"><span class="hljs-number">147</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.99963</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.504</span></span>}, {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person5"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">525</span></span>,<span class="hljs-number"><span class="hljs-number">81</span></span>,<span class="hljs-number"><span class="hljs-number">600</span></span>,<span class="hljs-number"><span class="hljs-number">184</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.99954</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.4849</span></span>}, {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person6"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">194</span></span>,<span class="hljs-number"><span class="hljs-number">76</span></span>,<span class="hljs-number"><span class="hljs-number">258</span></span>,<span class="hljs-number"><span class="hljs-number">167</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.9984</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.5725</span></span>} ] } ], <span class="hljs-string"><span class="hljs-string">"aliases_changed"</span></span>:false }, <span class="hljs-string"><span class="hljs-string">"htmlencoded"</span></span>:false, <span class="hljs-string"><span class="hljs-string">"last_modified"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span> }</code> </pre> <br>  Ich habe JSON ein bisschen formatiert.  Die Antwort enthält die Kennung der Person, die Koordinaten des Gesichts auf dem Foto und zwei Parameter: Wie gut das Gesicht erkannt wird und inwieweit diese Person dem Standard entspricht.  Sie können eine POST-Anfrage mit einem Bild in Ihrer Programmiersprache senden, JSON abrufen und die Antwort analysieren. <br><br>  Wenn Sie ein großes Kreuz haben und nur ein Dutzend Personen bestimmen müssen, können Sie diese manuell festlegen.  Dann gibt das System Kennungen für vertraute Personen und undefinierte für unbekannte Personen aus.  Personen können auch selektiv entfernt werden, beispielsweise wenn ein Mitarbeiter gekündigt hat. <br><br><h1>  Ideen </h1><br>  In welchen Projekten können Sie die Gesichtserkennung verwenden?  Wenn Sie ein Bandbreitensystem implementieren möchten, müssen Sie sich um Anti-Spoofing kümmern.  Fügen Sie beispielsweise eine Infrarotkamera hinzu, um festzustellen, ob es sich um ein Foto oder eine lebende Person handelt.  Oder setzen Sie zwei Kameras ein, um die Tiefe des Objekts zu bestimmen. Dies kann mit OpenCV erfolgen. <br><br>  Sie können die Erkennung von Personen im Eingang organisieren.  Wenn dies Ihre Nachbarn sind, ist alles in Ordnung, und wenn jemand ein Außenseiter ist, können Sie sich selbst eine Warnung senden.  Wir haben so ein Problem in unserem Haus, dass Fremde regelmäßig kommen und viel Müll auf der Landung hinter sich lassen. <br><br>  Wenn Sie einen „intelligenten Spiegel“ herstellen, können Sie ihn mit der Anerkennung von Familienmitgliedern ausstatten, damit jeder zeigen kann, was für ihn interessant ist.  Sagen wir, der Spiegel zeigt mir den Zeitplan für die heutigen Treffen, und mit meiner Tochter wird sie mich fröhlich begrüßen und mir anbieten, meine Zähne zu putzen, und zwar nicht schnell, wie üblich, sondern zwei Minuten. <br><br>  Eine andere Idee ist die Erkennung eines Nummernschilds durch ein automatisches Tor im Land.  Um nicht auszugehen oder den Schlüsselanhänger zu drücken, können Sie eine Kamera aufstellen, die Ihre Nummer entfernt, und das Tor öffnet sich automatisch. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de473828/">https://habr.com/ru/post/de473828/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de473816/index.html">Funktionen von modernem JavaScript, die Sie möglicherweise nicht kennen</a></li>
<li><a href="../de473818/index.html">Anwendung auf TSD und Kommunikation mit 1C: Enterprise 8.3 über HTTP-Service. Teil 4 (OnKeyUp. SC-Scanner mit Tastaturemulation)</a></li>
<li><a href="../de473822/index.html">Stellenangebot an einem Tag: Wie wir am selben Tag interviewt und Feedback gegeben haben</a></li>
<li><a href="../de473824/index.html">So erstellen Sie eine Geschäftstechnologie für die Vertriebsplanung in einem einzigen System</a></li>
<li><a href="../de473826/index.html">OTP-Authentifizierung auf dem Apache-Webserver</a></li>
<li><a href="../de473832/index.html">ShIoTiny: Updates und Benachrichtigungen</a></li>
<li><a href="../de473834/index.html">Blackbox-Überwachung in Clos-Netzwerken. Yandex-Bericht</a></li>
<li><a href="../de473838/index.html">DJI Mavic Mini: der leichteste zusammenklappbare Quadrocopter</a></li>
<li><a href="../de473840/index.html">Streamen Sie Videos vom Android-Gerät über UDP zur JAVA-Anwendung</a></li>
<li><a href="../de473842/index.html">Oktober Maschinelles Lernen und künstliche Intelligenz News Digest</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>