<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèø‚Äçü§ù‚ÄçüßëüèΩ üö† üòÅ Windows 10 IoT Enterprise - Segredos de configura√ß√£o para scripts incorporados ü§∞üèæ üå®Ô∏è üë°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pref√°cio 
 Voc√™ deve ter visto caixas eletr√¥nicos, quiosques de informa√ß√µes, pain√©is de publicidade que exibem um erro ou notifica√ß√£o do sistema. Se v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Windows 10 IoT Enterprise - Segredos de configura√ß√£o para scripts incorporados</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/quarta/blog/413359/"><h2>  Pref√°cio </h2><br>  Voc√™ deve ter visto caixas eletr√¥nicos, quiosques de informa√ß√µes, pain√©is de publicidade que exibem um erro ou notifica√ß√£o do sistema.  Se voc√™ n√£o viu esses dispositivos p√∫blicos "vivos", poder√° encontrar facilmente fotos semelhantes na Internet se procurar imagens de acordo com as palavras "Erro nas janelas do caixa eletr√¥nico".  E quando a notifica√ß√£o do sistema apareceu ao vivo durante a previs√£o do tempo, a foto pode ser encontrada com as palavras "notifica√ß√£o ao vivo do Windows".  Por uma quest√£o de interesse, voc√™ ainda pode procurar "a maior tela azul". <br><br><h2>  O que tudo isso significa? </h2><br>  Voc√™ gosta de gatos? <br>  - n√£o <br>  - Voc√™ simplesmente n√£o sabe como cozinh√°-los! <br><br>  Para dispositivos especializados, a Microsoft sugere o uso do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Windows 10 <b>IoT</b> Enterprise</a> , que difere do Windows 10 Enterprise apenas na aus√™ncia de aplicativos universais.  Assim, do ponto de vista t√©cnico, o Win 10 IoT Enterprise √© um sistema operacional de desktop que envolve a intera√ß√£o do usu√°rio.  Mas em dispositivos especializados, a intera√ß√£o do usu√°rio n√£o deve ser porque  √†s vezes, nem sequer h√° um usu√°rio no seu sentido usual, especialmente para pain√©is de publicidade. <br><a name="habracut"></a><br>  Ao preparar um dispositivo especializado, alguns especialistas t√©cnicos esquecem as nuances acima ou esquecem de desativar qualquer categoria de notifica√ß√µes.  Este artigo foi escrito para lembr√°-lo de alguns recursos da instala√ß√£o do Windows para solu√ß√µes especializadas.  Neste artigo, consideraremos a prepara√ß√£o de solu√ß√µes para uma tarefa comercial. <br><br>  Todas as configura√ß√µes ser√£o descritas para o Win 10 IoT Enterprise 2016 LTSB, cuja vers√£o demo pode ser baixada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br><h2>  Que tarefa comercial voc√™ resolve? </h2><br>  Uma vez cheguei ao ponto de coleta de uma loja online.  Nesta loja, os vendedores apenas emitiram mercadorias ou deram uma olhada, e o pedido precisava ser feito apenas no site da loja.  Para poder fazer um pedido diretamente no ponto de coleta, muitos PCs foram instalados na sala de coleta.  Os PCs estavam escondidos, havia apenas um monitor e um mouse, uma base de loja especializada foi aberta na tela, na qual era poss√≠vel encontrar mercadorias e fazer um pedido e um teclado na tela. <br><br>  Considere preparar uma solu√ß√£o semelhante que ser√° projetada para navegar no site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.quarta-embedded.ru</a> .  Condi√ß√µes de uso estimadas - sem fonte de alimenta√ß√£o ininterrupta e com manuten√ß√£o m√≠nima. <br><br><h2>  Prepara√ß√£o da solu√ß√£o </h2><br><h3>  Etapa 1 - preparando o dispositivo </h3><br>  Como o dispositivo foi levado para um PC comum, com um disco r√≠gido de 120 GB, RAM 4 GB.  Modo de inicializa√ß√£o do SO - herdado. <br><br>  Porque  nosso dispositivo ser√° usado sem fonte de alimenta√ß√£o ininterrupta, √© imperativo prever uma queda de energia n√£o programada.  I.e.  o dispositivo deve se ligar quando uma fonte de alimenta√ß√£o aparecer, para isso, √© necess√°rio configurar o BIOS do dispositivo adequadamente.  Os itens necess√°rios no BIOS podem ser encontrados pelos nomes intuitivos, eu tenho "Avan√ßado&gt; Op√ß√µes de inicializa√ß√£o&gt; Ap√≥s perda de energia", defina-o como "Ligado".  Mas se voc√™ quiser que o dispositivo permane√ßa desligado quando ligado intencionalmente, defina como "Estado anterior". <br><br><h3>  Etapa 2 - Instalar o Win 10 IoT </h3><br>  Instalar o Win 10 IoT Enterprise n√£o √© diferente de instalar o Win 10 Enterprise, por isso n√£o vejo muito sentido em descrever a instala√ß√£o.  Eu instalarei o "Win 10 IoT Enterprise 2016 LTSB x32" sem uma conex√£o com a Internet, para que nada extra "entre" no sistema.  Na primeira inicializa√ß√£o, criei o usu√°rio administrador. <br><br><h3>  Etapa 3 - salve a imagem do sistema </h3><br>  O que, n√£o esperava tal virada?  Basta instalar o sistema e salvar imediatamente a imagem.  Ao preparar uma solu√ß√£o, √© recomend√°vel salvar periodicamente a imagem do sistema, caso algo de repente d√™ errado.  Ent√£o voc√™ n√£o precisar√° fazer a configura√ß√£o do sistema primeiro. <br><br>  Quando falamos em criar uma imagem, abordamos a quest√£o da replica√ß√£o, mas ela √© t√£o ampla que um artigo separado e mais de um podem ser dedicados a ela; portanto, neste artigo, n√£o descreverei essa quest√£o em detalhes. <br><br>  Para criar uma imagem tecnol√≥gica (intermedi√°ria), selarei o sistema com o comando <br><br><pre><code class="hljs perl">%SYSTEMROOT%\System32\Sysprep\sysprep.exe /audit /generalize /<span class="hljs-keyword"><span class="hljs-keyword">shutdown</span></span> /quiet</code> </pre> <br>  e crie uma imagem wim do volume do sistema usando o utilit√°rio DISM. <br><br>  Importante - se voc√™ seguir o mesmo caminho, depois de implantar essa imagem, n√£o esque√ßa de copiar o conte√∫do do diret√≥rio "Windows \ System32 \ Recovery" para o primeiro volume da pasta "Recovery \ WindowsRE".  E voc√™ precisa fazer isso antes de carregar o sistema operacional.  depois de carregar o sistema operacional, o diret√≥rio "Windows \ System32 \ Recovery" j√° estar√° vazio.  Eu o implementei da seguinte maneira: <br><br><pre> <code class="hljs tex">if exist W:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">System</span></span></span></span>32<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">*</span></span></span></span>.* ( xcopy W:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">System</span></span></span></span>32<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">*</span></span></span></span>.* S:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowsRE</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>/h /k /y attrib +s +h +i S:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span> attrib +s +h +i S:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Recovery</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">*</span></span></span></span>.* /s /d )</code> </pre><br>  Observe que, ap√≥s a selagem, o sistema efetuar√° login automaticamente na conta de administrador interna.  E agora o sysprep ser√° iniciado automaticamente.  Para evitar que essa janela me incomode, adicionei um shell script com um √∫nico comando ao shell: startup <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">taskkill</span></span> /im sysprep.exe</code> </pre> <br>  Para n√£o esquecer de excluir o script, criarei imediatamente um script para selagem, no qual o comando para limpeza da execu√ß√£o autom√°tica ser√° gravado. <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">del</span></span> "<span class="hljs-variable"><span class="hljs-variable">%systemdrive%</span></span>\Users\Administrator\AppData\Roaming\Microsoft\Windows\<span class="hljs-built_in"><span class="hljs-built_in">Start</span></span> Menu\Programs\Startup\*.*" /q</code> </pre><br>  Afinal, ainda preciso selar o sistema no modo oobe. <br>  Todos os arquivos tecnol√≥gicos que colocarei na pasta C: \ Sysprep <br><br><h3>  Etapa 4 - instala√ß√£o do driver </h3><br>  Curiosamente, mas alguns reclamam que ap√≥s a instala√ß√£o do Win 10 "os drivers n√£o se instalaram".  Corro para incomod√°-lo, nada acontece por si s√≥, os drivers devem ser instalados.  O sistema vem com um certo conjunto de drivers padr√£o, mas √© improv√°vel que, com o conjunto padr√£o de drivers, seja poss√≠vel usar todos os recursos do equipamento.  √â melhor se voc√™ instalar os drivers mais adequados para o seu dispositivo.  O Windows pode baixar automaticamente drivers de um reposit√≥rio especial da Microsoft e instal√°-los, mas n√£o √© necess√°rio que todos os drivers necess√°rios estejam l√° ou que sejam drivers adequados.  O driver que o sistema instala automaticamente pode causar uma falha no sistema.  O que fazer se voc√™ se encontrar em uma situa√ß√£o em que precisa impedir uma instala√ß√£o autom√°tica de driver?  Existem 2 op√ß√µes: <br><br>  1. Desative o servi√ßo de atualiza√ß√£o <br>  net stop wuauserv - comando de parada de servi√ßo <br>  sc config wuauserv start = disabled - altere o modo de in√≠cio do servi√ßo para "Disabled" <br>  Mas, neste caso, o sistema n√£o receber√° nenhuma atualiza√ß√£o <br><br>  2. Desative a instala√ß√£o de um driver espec√≠fico nas pol√≠ticas de grupo <br><br>  Para fazer isso, voc√™ precisa: <br><br>  Abra o Editor de Diretiva de Grupo com gpedit <br><br>  V√° para a se√ß√£o "Configura√ß√£o do computador \ Modelos administrativos \ Sistema \ Instala√ß√£o de dispositivos \ Restri√ß√£o na instala√ß√£o de dispositivos".  Vers√£o em ingl√™s da ramifica√ß√£o "Configura√ß√£o do Computador \ Modelos Administrativos \ Sistema \ Instala√ß√£o do Dispositivo \ Restri√ß√µes √† Instala√ß√£o do Dispositivo" <br>  Nesta se√ß√£o, voc√™ pode proibir a instala√ß√£o de um driver para uma classe ou ID de equipamento espec√≠fico.  Para impedir a instala√ß√£o de outros drivers, voc√™ N√ÉO precisa marcar a caixa de sele√ß√£o "Tamb√©m se aplica a dispositivos correspondentes que j√° est√£o instalados", caso contr√°rio, voc√™ impossibilitar√° o uso do dispositivo. <br><br>  Porque  Eu tenho uma solu√ß√£o experimental e os drivers n√£o importam, n√£o instalarei propositadamente os drivers.  Ap√≥s conectar-se √† Internet, o sistema encontrou um driver para alguns dispositivos. <br><br><h3>  Etapa 5 - Russifica√ß√£o do sistema </h3><br>  Penso que esta a√ß√£o √© muito simples e n√£o precisa ser descrita em detalhes.  Eu direi que, para a exibi√ß√£o correta do alfabeto cir√≠lico, especifiquei o idioma russo para programas que n√£o suportam Unicode.  Ele indicou a localiza√ß√£o, embora no meu caso isso n√£o seja necess√°rio.  E ao longo do caminho, voc√™ pode alterar o fuso hor√°rio como  o padr√£o √© UTC -8.  Instalei o pacote de idiomas em russo; quando instalei o pacote de idiomas pela Internet, pareceu-me demorado, ent√£o instalei-o usando o pacote baixado anteriormente ‚ÄúMicrosoft-Windows-Client-Language-Pack_x86_ru-ru.cab‚Äù, instalei-o com o comando <br><br><pre> <code class="hljs perl">DISM /Online /Add-Package /PackagePath:<span class="hljs-string"><span class="hljs-string">"%~dp0Microsoft-Windows-Client-Language-Pack_x%PROCESSOR_ARCHITECTURE:~-2%_ru-ru.cab"</span></span></code> </pre><br>  Ap√≥s a instala√ß√£o, mudei o idioma principal do sistema para russo e ativei a op√ß√£o de copiar as configura√ß√µes de idioma para a tela de boas-vindas e novas contas. <br>  Isso √© tudo, o idioma russo foi adicionado, talvez voc√™ possa salvar a imagem do sistema ... <br><br><h3>  Etapa 6 - Configura√ß√µes de energia </h3><br>  Nosso dispositivo n√£o deve adormecer e desligar o monitor; portanto, voc√™ precisa configurar a energia adequadamente.  A energia pode ser configurada usando o script: <br><br><pre> <code class="hljs powershell">powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-monitor</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-monitor</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-disk</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-disk</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-standby</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-standby</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-hibernate</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-ac</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> powercfg <span class="hljs-literal"><span class="hljs-literal">-change</span></span> <span class="hljs-literal"><span class="hljs-literal">-hibernate</span></span><span class="hljs-literal"><span class="hljs-literal">-timeout</span></span><span class="hljs-literal"><span class="hljs-literal">-dc</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> pause</code> </pre><br><h3>  Etapa 7 - desativando o modo de inicializa√ß√£o de emerg√™ncia </h3><br>  O ponto importante √© que, se nosso dispositivo tiver um desligamento incorreto 2-3 vezes seguidas, o sistema inicializar√° no modo de recupera√ß√£o, e isso n√£o deve ser permitido.  Portanto, desative este modo de inicializa√ß√£o.  Isso pode ser feito usando o comando <br><br><pre> <code class="hljs pgsql">bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>} bootstatuspolicy IgnoreAllFailures</code> </pre><br>  Observe que essa configura√ß√£o est√° registrada no reposit√≥rio bcd, localizado na parti√ß√£o de recupera√ß√£o.  Eu n√£o salvo a se√ß√£o de recupera√ß√£o ao salvar a imagem do sistema; portanto, ap√≥s a implanta√ß√£o do sistema, essa configura√ß√£o estar√° em seu estado original, pois  haver√° um novo armazenamento bcd.  Para n√£o esquecer essa configura√ß√£o, vou adicion√°-la ao script de veda√ß√£o no modo oobe. <br><br><h3>  Etapa 8 - desativando mensagens de erro e notifica√ß√µes pop-up </h3><br>  Para que o sistema n√£o exiba mensagens de erro, uma solicita√ß√£o para enviar relat√≥rios de erros, mensagens sobre problemas com o equipamento, tudo isso deve ser desativado.  O servi√ßo de pol√≠tica de diagn√≥stico pode ser configurado nas pol√≠ticas de grupo: <br><br>  Configura√ß√£o do Computador \ Modelos Administrativos \ Sistema \ Diagn√≥stico <br>  Diagn√≥stico: definindo o n√≠vel de execu√ß√£o do script - ative ‚ÄúDetec√ß√£o e diagn√≥stico apenas‚Äù <br><br>  Mas √© mais f√°cil para mim configurar tudo com um √∫nico arquivo reg. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;    [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SYSTEM</span></span>\<span class="hljs-type"><span class="hljs-type">CurrentControlSet</span></span>\<span class="hljs-type"><span class="hljs-type">Control</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>] ;<span class="hljs-string"><span class="hljs-string">"ErrorMode"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;   ;<span class="hljs-string"><span class="hljs-string">"ErrorMode"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;     . ,     <span class="hljs-string"><span class="hljs-string">"ErrorMode"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000002</span></span> ;    . ,   dll ;     [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">Error</span></span> <span class="hljs-type"><span class="hljs-type">Reporting</span></span>] ;<span class="hljs-string"><span class="hljs-string">"Disabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;   <span class="hljs-string"><span class="hljs-string">"Disabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;   ;       [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Policies</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">WDI</span></span>] ;<span class="hljs-string"><span class="hljs-string">"ScenarioExecutionEnabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;      <span class="hljs-string"><span class="hljs-string">"ScenarioExecutionEnabled"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;      <span class="hljs-string"><span class="hljs-string">"EnabledScenarioExecutionLevel"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;    ;<span class="hljs-string"><span class="hljs-string">"EnabledScenarioExecutionLevel"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000002</span></span> ;,    </code> </pre><br>  As notifica√ß√µes pop-up podem ser configuradas nas pol√≠ticas de grupo "Configura√ß√£o do Usu√°rio \ Modelos Administrativos \ Menu Iniciar e Barra de Tarefas \ Notifica√ß√µes".  Mas √© mais f√°cil para mim ativar o modo N√£o perturbe, ele pode ser ativado na interface gr√°fica, no centro de notifica√ß√µes e no registro.  Porque  Essa configura√ß√£o se aplica a um usu√°rio espec√≠fico, e voc√™ deve realiz√°-la no usu√°rio de destino.  Portanto, criamos um usu√°rio sob o qual o aplicativo para uso p√∫blico ser√° executado.  Enquanto esse usu√°rio estiver no grupo de administradores, para facilitar a configura√ß√£o.  Para que n√£o haja problemas com o nome do grupo russo / ingl√™s, receberei o nome do grupo por SID. <br><br><pre> <code class="hljs pgsql">net <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">User</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">add</span></span> wmic useraccount <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> "Name='User'" <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> PasswordExpires=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f "tokens=2 delims==" %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'wmic group where "SID='</span></span>S<span class="hljs-number"><span class="hljs-number">-1</span></span><span class="hljs-number"><span class="hljs-number">-5</span></span><span class="hljs-number"><span class="hljs-number">-32</span></span><span class="hljs-number"><span class="hljs-number">-544</span></span><span class="hljs-string"><span class="hljs-string">'" get Name /value^|find "Name"'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> GroupName=%%i net localgroup %GroupName% <span class="hljs-keyword"><span class="hljs-keyword">User</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">add</span></span> pause</code> </pre><br>  E ligue o modo n√£o perturbe. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;  <span class="hljs-string"><span class="hljs-string">" "</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">CurrentVersion</span></span>\<span class="hljs-type"><span class="hljs-type">Notifications</span></span>\<span class="hljs-type"><span class="hljs-type">Settings</span></span>] <span class="hljs-string"><span class="hljs-string">"NOC_GLOBAL_SETTING_TOASTS_ENABLED"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;  ;<span class="hljs-string"><span class="hljs-string">"NOC_GLOBAL_SETTING_TOASTS_ENABLED"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ; </code> </pre><br>  Para n√£o esquecer de excluir o usu√°rio do grupo de administradores, adicionarei o comando de exclus√£o ao script de veda√ß√£o. <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f <span class="hljs-string"><span class="hljs-string">"tokens=2 delims=="</span></span> %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ('wmic group <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-string"><span class="hljs-string">"SID='S-1-5-32-544'"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span> /value^|<span class="hljs-built_in"><span class="hljs-built_in">find</span></span> <span class="hljs-string"><span class="hljs-string">"Name"</span></span>') <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-type"><span class="hljs-type">GroupName</span></span>=%%i net localgroup %<span class="hljs-type"><span class="hljs-type">GroupName</span></span>% <span class="hljs-type"><span class="hljs-type">User</span></span> /delete</code> </pre><br><h3>  Etapa 9 - Configurar atualiza√ß√µes do sistema </h3><br>  N√£o √© necess√°rio instalar todas as atualiza√ß√µes mais recentes no momento da prepara√ß√£o do sistema.  Voc√™ pode configurar as atualiza√ß√µes com base nas especificidades do seu dispositivo.  Voc√™ pode desativar a instala√ß√£o de todas as atualiza√ß√µes ou atualiza√ß√µes de driver, conforme discutimos na etapa 4. Ou voc√™ pode desativar a instala√ß√£o de atualiza√ß√µes do sistema e deixar a atualiza√ß√£o do driver. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;  .      [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Policies</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span>\<span class="hljs-type"><span class="hljs-type">WindowsUpdate</span></span>\<span class="hljs-type"><span class="hljs-type">AU</span></span>] <span class="hljs-string"><span class="hljs-string">"NoAutoUpdate"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ;  ;<span class="hljs-string"><span class="hljs-string">"NoAutoUpdate"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ; </code> </pre><br>  Mas tamb√©m √© poss√≠vel que voc√™ precise instalar atualiza√ß√µes do sistema, mas alguma atualiza√ß√£o espec√≠fica desativar√° o sistema.  Nessa situa√ß√£o, voc√™ pode impedir a instala√ß√£o de uma atualiza√ß√£o espec√≠fica.  Isso pode ser feito usando o utilit√°rio wushowhide.diagcab, que pode ser encontrado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  Nas pol√≠ticas de grupo, voc√™ pode encontrar muitas configura√ß√µes detalhadas para instalar atualiza√ß√µes.  "Configura√ß√£o do computador \ Modelos administrativos \ Componentes do Windows \ Windows Update" <br><br>  Porque  N√£o preciso de atualiza√ß√µes, desativei-as completamente: <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">net</span></span> stop wuauserv sc config wuauserv <span class="hljs-built_in"><span class="hljs-built_in">start</span></span>=disabled <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span></code> </pre><br>  Aqui vou salvar mais uma vez a imagem do sistema. <br><br><h3>  Etapa 10 - configurar o lan√ßamento do aplicativo </h3><br>  A navega√ß√£o no site quarta-embedded.ru ser√° no IE. Para remover o acesso √† barra de endere√ßo e √†s configura√ß√µes, voc√™ pode ativar o modo de tela cheia nas pol√≠ticas de grupo.  "Configura√ß√£o do usu√°rio&gt; Modelos administrativos&gt; Componentes do Windows&gt; Internet Explorer&gt; Ativando o modo de tela cheia."  E voc√™ precisa proibir o fechamento do IE "Configura√ß√£o do usu√°rio&gt; Modelos administrativos&gt; Componentes do Windows&gt; Internet Explorer&gt; Menu Navegador&gt; Menu Arquivo: Desativar fechar o navegador e o Windows Explorer". <br>  Para iniciar o aplicativo em vez do shell do sistema, usaremos uma ferramenta especial de inicializa√ß√£o do aplicativo - ShellLauncher.  Usando-o, voc√™ pode: <br><br>  1. Atribua o lan√ßamento de um aplicativo espec√≠fico a um usu√°rio ou grupo de usu√°rios espec√≠fico <br><br>  2. Controle a opera√ß√£o do aplicativo em execu√ß√£o. Ao fechar o aplicativo em execu√ß√£o, voc√™ pode: <br><br><ul><li>  a.  Reinicie o aplicativo </li><li>  b.  Reinicie o sistema </li><li>  c.  Desligue o sistema </li><li>  d.  N√£o tome nenhuma a√ß√£o </li></ul><br>  Primeiro, voc√™ precisa adicionar o ShellLauncher como um componente. Isso pode ser feito na interface gr√°fica "Painel de controle&gt; Programas&gt; Ativando e desativando componentes da janela", se√ß√£o "Bloqueio de dispositivo".  Voc√™ pode configurar o in√≠cio dos programas na ramifica√ß√£o do registro "Iniciador do HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows Embedded \ Shell".  Quando o lan√ßamento dos programas √© configurado pelos SIDs dos usu√°rios, os SIDs podem ser encontrados usando o utilit√°rio whoami.  Para ativar o ShellLauncher, voc√™ s√≥ precisa substituir o lan√ßamento do shell padr√£o no registro pelo lan√ßamento do ShellLauncher.  E um pouco de nuance, o ShellLauncher n√£o afeta o tamanho e a posi√ß√£o da janela do programa em execu√ß√£o, e o IE gostaria de executar a tela cheia implantada.  Portanto, configuramos o modo de inicializa√ß√£o do IE, novamente no usu√°rio Usu√°rio, ao mesmo tempo que proibimos a chamada do menu de contexto do IE para que o usu√°rio n√£o estrague nada. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span><span class="hljs-type"><span class="hljs-type">ernet</span></span> <span class="hljs-type"><span class="hljs-type">Explorer</span></span>\<span class="hljs-type"><span class="hljs-type">Main</span></span>] <span class="hljs-string"><span class="hljs-string">"FullScreen"</span></span>=<span class="hljs-string"><span class="hljs-string">"yes"</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_CURRENT_USER</span></span>\<span class="hljs-type"><span class="hljs-type">Software</span></span>\<span class="hljs-type"><span class="hljs-type">Policies</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span><span class="hljs-type"><span class="hljs-type">ernet</span></span> <span class="hljs-type"><span class="hljs-type">Explorer</span></span>\<span class="hljs-type"><span class="hljs-type">Restrictions</span></span>] <span class="hljs-string"><span class="hljs-string">"NoBrowserContextMenu"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span></code> </pre><br>  Agora estamos configurando o ShellLauncher, mais uma vez √© mais conveniente fazer tudo usando o console ... <br><br><pre> <code class="hljs bash">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off chcp 1251 <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>  ShellLouncher   DISM /online /Enable-Feature /all /FeatureName:Client-EmbeddedShellLauncher <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>  SID  User <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f <span class="hljs-string"><span class="hljs-string">"tokens=2 delims=="</span></span> %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'wmic useraccount where "Name='</span></span>User<span class="hljs-string"><span class="hljs-string">'" get SID /value^|find "SID"'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> SID=%%i <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>   iexplore.exe   User reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\%SID%"</span></span> /v Shell /t REG_SZ /d <span class="hljs-string"><span class="hljs-string">"C:\Program Files\Internet Explorer\iexplore.exe www.quarta-embedded.ru"</span></span> /f <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>     IE reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\%SID%"</span></span> /v DefaultReturnCodeAction /t REG_DWORD /d 0 /f <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>       reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\S-1-5-32-544"</span></span> /v Shell /t REG_SZ /d <span class="hljs-string"><span class="hljs-string">"explorer.exe"</span></span> /f <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>         reg add <span class="hljs-string"><span class="hljs-string">"HKLM\SOFTWARE\Microsoft\Windows Embedded\Shell Launcher\S-1-5-32-544"</span></span> /v DefaultReturnCodeAction /t REG_DWORD /d 3 /f pause</code> </pre><br>  E, como exemplo, voc√™ pode atribuir um shell padr√£o para execu√ß√£o quando nenhum aplicativo √© atribu√≠do ao usu√°rio. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ;     ,    cmd.exe [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">Embedded</span></span>\<span class="hljs-type"><span class="hljs-type">Shell</span></span> <span class="hljs-type"><span class="hljs-type">Launcher</span></span>] <span class="hljs-string"><span class="hljs-string">"Shell"</span></span>=<span class="hljs-string"><span class="hljs-string">"explorer.exe"</span></span> ;        ;<span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;  ;<span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ; ;<span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000002</span></span> ; <span class="hljs-string"><span class="hljs-string">"DefaultReturnCodeAction"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000003</span></span> ;  </code> </pre><br>  E ative o Shell Launcher <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> ; ShellLouncher    [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">NT</span></span>\<span class="hljs-type"><span class="hljs-type">CurrentVersion</span></span>\<span class="hljs-type"><span class="hljs-type">Winlogon</span></span>] <span class="hljs-string"><span class="hljs-string">"Shell"</span></span>=<span class="hljs-string"><span class="hljs-string">"eShell.exe"</span></span> ; Shell Launcher ;<span class="hljs-string"><span class="hljs-string">"Shell"</span></span>=<span class="hljs-string"><span class="hljs-string">"explorer.exe"</span></span> ; Shell Launcher</code> </pre><br><h3>  Etapa 11 - Configurando a Tela de Inicializa√ß√£o do Sistema </h3><br>  Nas vers√µes anteriores do Windows, era poss√≠vel definir seus pr√≥prios logotipos que apareceriam quando o sistema inicializar, agora existem apenas duas op√ß√µes.  e fora  Voc√™ pode desativar o processo de exibi√ß√£o da carga no reposit√≥rio bcd, executarei esses comandos imediatamente e os adicionarei ao script de veda√ß√£o. <br><br><pre> <code class="hljs bash"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>    Windows  .     <span class="hljs-literal"><span class="hljs-literal">true</span></span>   <span class="hljs-literal"><span class="hljs-literal">false</span></span> bcdedit /<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> {globalsettings} custom:16000067 <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>        Windows.     <span class="hljs-literal"><span class="hljs-literal">false</span></span> bcdedit /<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> {globalsettings} nobootuxprogress <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre><br>  Voc√™ tamb√©m pode ocultar o processo de login do usu√°rio. <br><br><pre> <code class="hljs powershell">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5.00</span></span> [<span class="hljs-type"><span class="hljs-type">HKEY_LOCAL_MACHINE</span></span>\<span class="hljs-type"><span class="hljs-type">SOFTWARE</span></span>\<span class="hljs-type"><span class="hljs-type">Microsoft</span></span>\<span class="hljs-type"><span class="hljs-type">Windows</span></span> <span class="hljs-type"><span class="hljs-type">Embedded</span></span>\<span class="hljs-type"><span class="hljs-type">EmbeddedLogon</span></span>] ;<span class="hljs-string"><span class="hljs-string">"HideAutoLogonUI"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000000</span></span> ;  <span class="hljs-string"><span class="hljs-string">"HideAutoLogonUI"</span></span>=dword:<span class="hljs-number"><span class="hljs-number">00000001</span></span> ; </code> </pre><br>  Agora ative o usu√°rio autom√°tico de login do usu√°rio, isso pode ser feito usando o comando netplwiz.  N√≥s reinicializamos e vemos o que aconteceu, n√£o h√° exibi√ß√£o do andamento do carregamento do SO, n√£o h√° exibi√ß√£o do login do usu√°rio.  Somente antes de entrar no sistema, o √≠cone e a anima√ß√£o do Win em forma de bolas aparecem por alguns segundos, mas isso ocorre porque o sistema operacional no modo de auditoria, ap√≥s a veda√ß√£o no modo oobe, isso n√£o acontece.  O IE come√ßou automaticamente com o endere√ßo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.quarta-embedded.ru</a> . Um pouco mais tarde, a guia microsoft.com apareceu. Bem, nada. Voc√™ precisar√° adicionar um comando para alterar as configura√ß√µes no registro para o arquivo de resposta de veda√ß√£o. <br><br><pre> <code class="hljs tex">reg add HKLM<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Software</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Microsoft</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Internet</span></span></span></span> Explorer<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Main</span></span></span></span>" /v "DisableFirstRunCustomize" /t REG_DWORD /d 1</code> </pre><br>  Aqui farei novamente uma imagem do sistema. <br><br><h3>  Etapa 12 - Instalando e removendo a chave do Windows </h3><br>  Antes de instalar a chave, voc√™ precisa desconectar o PC da Internet para que o sistema n√£o seja ativado.  Voc√™ pode adicionar uma chave e remov√™-la imediatamente para que ningu√©m possa retir√°-la.  Nesse caso, o sistema ainda pode ser ativado. <br><br><pre> <code class="hljs powershell">slmgr /ipk XXXXX<span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span><span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span><span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span><span class="hljs-literal"><span class="hljs-literal">-XXXXX</span></span> slmgr /cpky</code> </pre><br><h3>  Etapa 13 - selando o sistema </h3><br>  Para que o sistema n√£o fa√ßa perguntas na primeira inicializa√ß√£o ap√≥s selar no modo oobe, eu uso um arquivo de resposta previamente preparado no utilit√°rio Gerenciador de Imagem de Sistema do Windows.  Eu executo o script para selar, abaixo do conte√∫do do script e do arquivo de resposta. <br><br>  Script para selar: <br><br><pre> <code class="hljs pgsql">del "%systemdrive%\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\*.*" /q <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f "tokens=2 delims==" %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'wmic group where "SID='</span></span>S<span class="hljs-number"><span class="hljs-number">-1</span></span><span class="hljs-number"><span class="hljs-number">-5</span></span><span class="hljs-number"><span class="hljs-number">-32</span></span><span class="hljs-number"><span class="hljs-number">-544</span></span><span class="hljs-string"><span class="hljs-string">'" get Name /value^|find "Name"'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> GroupName=%%i net localgroup %GroupName% <span class="hljs-keyword"><span class="hljs-keyword">User</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>} bootstatuspolicy IgnoreAllFailures bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {globalsettings} custom:<span class="hljs-number"><span class="hljs-number">16000067</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> bcdedit /<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> {globalsettings} nobootuxprogress <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> pushd "%~dp0" %SYSTEMROOT%\System32\Sysprep\sysprep.exe /oobe /generalize /shutdown /quiet /unattend:Unattend.xml</code> </pre><br>  Unattend.xml: <br><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unattend</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:unattend"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pass</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"specialize"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-Deployment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronous</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>reg add HKLM\Software\Microsoft\Windows\CurrentVersion\Setup\OOBE /v SetupDisplayedProductKey /t REG_DWORD /d 1 /f<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Dont show key page<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>reg add HKLM\Software\Microsoft\Windows\CurrentVersion\Setup\OOBE /v UnattendCreatedUser /t REG_DWORD /d 1 /f<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Dont make account<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>reg add "HKLM\Software\Microsoft\Internet Explorer\Main" /v "DisableFirstRunCustomize" /t REG_DWORD /d 1 /f<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Disable First Run Customize<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">wcm:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span>cmd.exe /c rd %systemdrive%\Sysprep /s /q<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span>4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Order</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Del Folder<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronousCommand</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RunSynchronous</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-Shell-Setup"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AutoLogon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Enabled</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Enabled</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Username</span></span></span><span class="hljs-tag">&gt;</span></span>User<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Username</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AutoLogon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pass</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oobeSystem"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-International-Core"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputLocale</span></span></span><span class="hljs-tag">&gt;</span></span>en-US; ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputLocale</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SystemLocale</span></span></span><span class="hljs-tag">&gt;</span></span>ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SystemLocale</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguage</span></span></span><span class="hljs-tag">&gt;</span></span>ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguage</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguageFallback</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UILanguageFallback</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserLocale</span></span></span><span class="hljs-tag">&gt;</span></span>ru-RU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserLocale</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-Shell-Setup"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorArchitecture</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">publicKeyToken</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"31bf3856ad364e35"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"neutral"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">versionScope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nonSxS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:wcm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/WMIConfig/2002/State"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OOBE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideEULAPage</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideEULAPage</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideLocalAccountScreen</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideLocalAccountScreen</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOEMRegistrationScreen</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOEMRegistrationScreen</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOnlineAccountScreens</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideOnlineAccountScreens</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideWirelessSetupInOOBE</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HideWirelessSetupInOOBE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectYourPC</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectYourPC</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OOBE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">settings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cpi:offlineImage</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cpi:source</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:cpi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:cpi"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unattend</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h2>  Sum√°rio </h2><br>  O que aconteceu no final ... O sistema se inicializou sem nenhuma d√∫vida, o IE come√ßou com a p√°gina correta.  Se voc√™ levar em considera√ß√£o que n√£o haver√° acesso f√≠sico ao PC, e apenas o mouse estar√° acess√≠vel a partir dos meios de entrada, parece que nada pode ser quebrado.  Entramos na conta de administrador e vemos que a pasta Sysprep √© exclu√≠da.  O sistema est√° pronto ... </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt413359/">https://habr.com/ru/post/pt413359/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt413347/index.html">An√°lise da atmosfera negativa e como lidar com ela</a></li>
<li><a href="../pt413349/index.html">Quais m√©tricas do Google Analytics acionam m√°s decis√µes</a></li>
<li><a href="../pt413351/index.html">Sobre pessoas, monstros - e modelagem tem√°tica</a></li>
<li><a href="../pt413353/index.html">Rocker - driver rocksdb para Erlang</a></li>
<li><a href="../pt413357/index.html">Primeiro, olhe para o smartphone para jogos ASUS ROG Phone</a></li>
<li><a href="../pt413361/index.html">Teoria do grande aterro: estamos procurando documentos cient√≠ficos na Internet</a></li>
<li><a href="../pt413363/index.html">O artes√£o parafusou a teleobjetiva Canon EF 70-200 mm na c√¢mera Game Boy</a></li>
<li><a href="../pt413367/index.html">O que √© uma bolha global de hidrocarbonetos? Resultados de simula√ß√£o no mercado de energia de at√© 2050 g</a></li>
<li><a href="../pt413371/index.html">Carro el√©trico</a></li>
<li><a href="../pt413375/index.html">√â poss√≠vel fazer amigos Gitlab CI + Docker + Systemd</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>