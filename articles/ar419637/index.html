<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉ๐ฝโ๐ ๐ ๐๐ฝ [ุชุฑุฌูุฉ] ููู ูุนูู Graal - Java JVM JVM ูุชุฑุฌู โจ๏ธ ๐๐ผ ๐๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ูุง ูุจุฑ! ุฃูุฏู ููู ุชุฑุฌูุฉ ุงูููุงู " ููู ููููุฉ ุนูู Graal - ูุชุฑุฌู ุฌุงูุง JIT ููุชูุจ ุจูุบุฉ ุฌุงูุง ". 
 ููุฏูุฉ 


 ุฃุญุฏ ุงูุฃุณุจุงุจ ุงูุชู ุฌุนูุชูู ุจุงุญุซูุง ูู ูุบุงุช ุงูุจุฑู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>[ุชุฑุฌูุฉ] ููู ูุนูู Graal - Java JVM JVM ูุชุฑุฌู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419637/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> ูุฑุญุจุง ูุง ูุจุฑ!  ุฃูุฏู ููู ุชุฑุฌูุฉ ุงูููุงู " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููู ููููุฉ ุนูู Graal - ูุชุฑุฌู ุฌุงูุง JIT ููุชูุจ ุจูุบุฉ ุฌุงูุง</a> ". </p><br><h2 id="vvedenie" style=";text-align:right;direction:rtl">  ููุฏูุฉ </h2><br><p style=";text-align:right;direction:rtl">  ุฃุญุฏ ุงูุฃุณุจุงุจ ุงูุชู ุฌุนูุชูู ุจุงุญุซูุง ูู ูุบุงุช ุงูุจุฑูุฌุฉ ูู ุฃูู ูู ูุฌุชูุน ูุจูุฑ ูู ุงูุฃุดุฎุงุต ุงููุดุงุฑููู ูู ุชูููููุฌูุง ุงูููุจููุชุฑ ุ ูุณุชุฎุฏู ุงูุฌููุน ุชูุฑูุจูุง ูุบุงุช ุงูุจุฑูุฌุฉ ุ ูุงูุนุฏูุฏ ูููู ููุชููู ุจููููุฉ ุนูููู.  ุนูุฏูุง ุชุนุฑูุช ุนูู ุงูุจุฑูุฌุฉ ูุฃูู ูุฑุฉ ุนูุฏูุง ููุช ุทููุงู ูุฃุตุจุญุช ุนูู ุฏุฑุงูุฉ ุจูุบุฉ ุจุฑูุฌุฉ ุ ูุงู ุฃูู ุดูุก ุฃุฑุฏุช ูุนุฑูุชู ูู ููู ุชุนูู ุ ูุฃูู ูุง ุฃุฑุฏุช ูุนูู ูู ุฅูุดุงุก ูุบุชู ุงูุฎุงุตุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูุนุฑุถ ุงูุชูุฏููู ุ ุณุฃูุถุญ ูู ุจุนุถ ุขููุงุช ุงูุนูู ููุบุฉ ุงูุชู ุชุณุชุฎุฏููุง ุฌููุนูุง - Java.  ุชููู ุงูุฎุตูุตูุฉ ูู ุฃููู <em>ุณุฃุณุชุฎุฏู</em> ูุดุฑูุนูุง ูุณูู <em>Graal</em> ุ ูุงูุฐู ูุทุจู ููููู <em>Java ูู Java</em> . </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  Graal ูู ูุงุญุฏ ููุท ูู ุงูููููุงุช ูู ุนูู Java - ููู ูุชุฑุฌู <em>ูู ุงูููุช ุงูููุงุณุจ</em> .  ูุฐุง ูู ุฌุฒุก ูู JVM ุงูุฐู ูุญูู Java bytecode ุฅูู ููุฏ ุงูุขูุฉ ุฃุซูุงุก ุชูููุฐ ุงูุจุฑูุงูุฌ ุ ููู ุฃุญุฏ ุงูุนูุงูู ุงูุชู ุชุถูู ุฃุฏุงุก ุนุงูู ููููุตุฉ.  ููุง ูุจุฏู ูู ุฃูุถูุง ุ ูุง ูุนุชุจุฑู ูุนุธู ุงููุงุณ ุฃุญุฏ ุฃูุซุฑ ุงูุฃุฌุฒุงุก ุชุนููุฏูุง ูุบููุถูุง ูู JVM ุ ููู ูุง ูุชุฌุงูุฒ ุฅุฏุฑุงููู.  ุชุบููุฑ ูุฐุง ุงูุฑุฃู ูู ุงูุบุฑุถ ูู ูุฐุง ุงูุฎุทุงุจ. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุชุนุฑู ูุง ูู JVM ุ  ุจุดูู ุนุงู ููู ูุง ุชุนููู ุงููุตุทูุญูู ูู ูุจู <em>ุฑูุฒ</em> <em>ุงูุจุงูุช</em> <em>ูุฑูุฒ ุงูุขูุฉ</em> ุ  ููุงุฏุฑุฉ ุนูู ูุฑุงุกุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูููุชูุจุฉ ุจูุบุฉ ุฌุงูุง ุ ูุขูู ุฃู ูููู ูุฐุง ูุงููุงู ูููู ุงูููุงุฏ ุงูููุฏูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุณุฃุจุฏุฃ ุจููุงูุดุฉ ููุงุฐุง ูุฏ ูุฑูุฏ ูุชุฑุฌููุง JIT ุฌุฏูุฏูุง ูู JVM ููุชูุจูุง ูู Java ุ ูุจุนุฏ ุฐูู ุณุฃูุถุญ ุฃูู ูุง ููุฌุฏ ุดูุก ุฅุถุงูู ุฎุงุต ูู ูุฐุง ุ ููุง ูุฏ ุชุนุชูุฏ ุ ุนู ุทุฑูู ุชูุณูู ุงููููุฉ ุฅูู ุชุฌููุน ูุชุฑุฌู ูุงุณุชุฎุฏุงู ูุชูุถูุญ ุฐูู ุฃู ุฑูุฒูุง ูู ููุณู ููุง ูู ุฃู ุชุทุจูู ุขุฎุฑ. </p><br><p style=";text-align:right;direction:rtl">  ุณูู ุฃุชุทุฑู ุฅูู ุงููุธุฑูุฉ ููููุงู ุ ุซู ุณุฃูุถุญ ููู ูุชู ุชุทุจูููุง ุฃุซูุงุก ุนูููุฉ ุงูุชุฌููุน ุจุฃููููุง ูู ุงูุจุงูุช ุฅูู ููุฏ ุงูุขูุฉ.  ุณุฃุนุฑุถ ุฃูุถูุง ุจุนุถ ุงูุชูุงุตูู ุ ููู ุงูููุงูุฉ ุณูุชุญุฏุซ ุนู ูุฒุงูุง ูุฐู ุงูููุฒุฉ ุจุงูุฅุถุงูุฉ ุฅูู ุชูููุฐ <em>Java ูู Java</em> ูู ุฃุฌููุง. </p><br><p style=";text-align:right;direction:rtl">  ุณุฃุณุชุฎุฏู ููุทุงุช ุดุงุดุฉ ุงูููุฏ ูู Eclipse ุ ุจุฏูุงู ูู ุชุดุบูููุง ุฃุซูุงุก ุงูุนุฑุถ ุงูุชูุฏููู ุ ูุชุฌูุจ ุงููุดุงูู ุงูุญุชููุฉ ููุชุดููุฑ ุงููุจุงุดุฑ. </p><br><h2 id="chto-takoe-jit-kompilyator" style=";text-align:right;direction:rtl">  ูุง ูู ูุชุฑุฌู JITุ </h2><br><p style=";text-align:right;direction:rtl">  ุฃูุง ูุชุฃูุฏ ูู ุฃู ุงููุซูุฑ ูููู ูุนุฑู ูุง ูู ูุชุฑุฌู JIT ุ ูููู ูุง ุฒูุช ุฃุชุทุฑู ุฅูู ุงูุฃุณุงุณูุงุช ุญุชู ูุง ูุฌูุณ ุฃุญุฏ ููุง ุฎุงุฆููุง ูู ุทุฑุญ ูุฐุง ุงูุณุคุงู ุงูุฑุฆูุณู. </p><br><p style=";text-align:right;direction:rtl"> ุนูุฏ ุชุดุบูู ุงูุฃูุฑ <code>javac</code> ุฃู <em>compile-on-save</em> ูู IDE ุ ูุชู ุชุฌููุน ุจุฑูุงูุฌ Java ุงูุฎุงุต ุจู ูู Java code ุฅูู JVM bytecode ุ ููู ุงูุชูุซูู ุงูุซูุงุฆู ููุจุฑูุงูุฌ.  ุฅูู ุฃูุซุฑ ุฅุญูุงูุง ูุจุณุงุทุฉ ูู ููุฏ ูุตุฏุฑ Java.  ููุน ุฐูู ุ ูุง ูููู ููุท ูููุนุงูุฌ ุงูุนุงุฏู ููููุจููุชุฑ ุงููุญููู ุฃู ุงูุฎุงุฏู ุชูููุฐ JVM bytecode. </p><br><p style=";text-align:right;direction:rtl">  ูุชุดุบูู ุงูุจุฑูุงูุฌ ุงูุฎุงุต ุจู ุ ููุณุฑ JVM ูุฐุง ุงูุฑูุฒ ุงููุฑุนู.  ุนุงุฏุฉ ูุง ูููู ุงููุชุฑุฌููู ุฃุจุทุฃ ุจูุซูุฑ ูู ุฑูุฒ ุงูุฌูุงุฒ ุงูุฐู ูุนูู ุนูู ุงููุนุงูุฌ.  ููุฐุง ุงูุณุจุจ ุ ูููู ูู JVM ุ ุฃุซูุงุก ุชุดุบูู ุงูุจุฑูุงูุฌ ุ ุชุดุบูู ูุชุฑุฌู ุขุฎุฑ ูุญูู ุงูุฑูุฒ ุงููุฑุนู ุงูุฎุงุต ุจู ุฅูู ุฑูุฒ ุงูุฌูุงุฒ ุ ูุงูุฐู ูููู ูููุนุงูุฌ ุชูููุฐู ุจุงููุนู. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ุงููุชุฑุฌู ุ ุนุงุฏุฉ ูุง ูููู ุฃูุซุฑ ุชุนููุฏูุง ูู <code>javac</code> ุ ูููู <code>javac</code> ูุนูุฏุฉ ูุฅูุชุงุฌ ููุฏ ุขูุฉ ุนุงูู ุงูุฌูุฏุฉ ูุชูุฌุฉ ูุฐูู. </p><br><h2 id="zachem-pisat-jit-kompilyator-na-java" style=";text-align:right;direction:rtl">  ููุงุฐุง ูุชุงุจุฉ ูุชุฑุฌู JIT ูู ุฌุงูุงุ </h2><br><p style=";text-align:right;direction:rtl">  ุญุชู ุงูุขู ุ ูุชุถูู ุชูููุฐ JVM ุงููุณูู <em>OpenJDK</em> ุฌุงูุนู JIT ุฑุฆูุณููู.  ุชู ุชุตููู ุจุฑูุงูุฌ ุงูุชุญููู ุงูุจุฑูุฌู ุงูุฎุงุต ุจุงูุนููู ุ ูุงููุนุฑูู ุจุงุณู <em>C1</em> ุ ููุนูู ุจุดูู ุฃุณุฑุน ุ ููููู ูู ููุณ ุงูููุช ููุชุฌ ููุฏูุง ุฃูู ุชุญุณูููุง.  ูุชุทูุจ ุงููุญูู ุงูุจุฑูุฌู ููุฎุงุฏู ุ ุงููุนุฑูู ุจุงุณู <em>opto</em> ุฃู <em>C2</em> ุ ูุฒูุฏูุง ูู ุงูููุช ููุนูู ุ ููููู ููุชุฌ ููุฏูุง ุฃูุถู. </p><br><p style=";text-align:right;direction:rtl">  ูุงูุช ุงูููุฑุฉ ูู ุฃู ุจุฑูุงูุฌ ุงูุชุญููู ุงูุจุฑูุฌู ุงูุฎุงุต ุจุงูุนููู ูุงู ููุงุณุจูุง ุจุดูู ุฃูุถู ูุชุทุจููุงุช ุณุทุญ ุงูููุชุจ ุ ุญูุซ ูุงูุช ูุชุฑุงุช ุงูุชููู ุงูุทูููุฉ ูู ูุชุฑุฌู JIT ุบูุฑ ูุฑุบูุจ ูููุง ุ ููุงู ูุชุฑุฌู ุงูุฎุงุฏู ูุชุทุจููุงุช ุงูุฎุงุฏู ุงูุชู ุชุนูู ููุชุฑุฉ ุทูููุฉ ุ ูุงูุชู ูููู ุฃู ุชูุถู ุงููุฒูุฏ ูู ุงูููุช ูู ุงูุชุฑุฌูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงูููู ูููู ุฏูุฌูุง ุจุญูุซ ูุชู ุชุฌููุน ุงูุดูุฑุฉ ุฃููุงู ุจูุงุณุทุฉ C1 ุ ุซู ุ ุฅุฐุง ุงุณุชูุฑ ุชูููุฐูุง ุจุดูู ููุซู ููู ุงูููุทูู ูุถุงุก ููุช ุฅุถุงูู ุ - C2.  ููุฐุง ูุง ูุณูู <em>ุงูุชุฌููุน ุงููุชุฏุฑุฌ</em> . </p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูุชูุงูู C2 ุ ูุชุฑุฌู ุงูุฎุงุฏู ุงูุฐู ูุคุฏู ุงููุฒูุฏ ูู ุงูุชุญุณููุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูููููุง ุงุณุชูุณุงุฎ OpenJDK ูู ุงููุฑุขุฉ ุนูู <em>GitHub</em> ุ ุฃู ููุท ูุชุญ ุดุฌุฑุฉ ุงููุดุฑูุน ุนูู ุงููููุน. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">$ git clone <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/github.com/dmlloyd</span></span><span class="hljs-regexp"><span class="hljs-regexp">/openjdk.git</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุฏ C2 ููุฌูุฏ ูู <em>openjdk / hotspot / src / share / vm / opto</em> . </p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/c2.png" alt="ููุฏ ุงููุตุฏุฑ C2"></p><br><p style=";text-align:right;direction:rtl">  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู C2 ููุชูุจ ุจูุบุฉ <em>C ++</em> .  ุจุงูุทุจุน ุ ูุฐุง ููุณ ุดูุฆูุง ุณูุฆูุง ุ ูููู ููุงู ุจุนุถ ุงูุนููุจ.  ูุบุฉ C ++ ูู ูุบุฉ ุบูุฑ ุขููุฉ.  ูุฐุง ูุนูู ุฃู ุงูุฃุฎุทุงุก ูู C ++ ูููู ุฃู ุชุญุทู ุงูุฌูุงุฒ ุงูุธุงูุฑู.  ุฑุจูุง ูููู ุงูุณุจุจ ูู ุฐูู ูู ุนูุฑ ุงูุฑูุฒ ุ ูููู ุฃุตุจุญ ูู ุงูุตุนุจ ุฌุฏูุง ุงูุญูุงุธ ุนูู ุฑูุฒ C2 C ++ ูุชุทููุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูุงู ูููู ูููู ุ ุฃุญุฏ ุงูุดุฎุตูุงุช ุงูุฑุฆูุณูุฉ ูุฑุงุก ูุชุฑุฌู C2 ุ ุฃูู ูู ููุชุจ ูุฑุฉ ุฃุฎุฑู VM ูุฑุฉ ุฃุฎุฑู ูู C ++ ุ ูุณูุนูุง ูุฑูู <em>Twitter</em> JVM ูููู ุฃู C2 ุฃุตุจุญ ุฑุงูุฏูุง ููุฌุจ ุงุณุชุจุฏุงูู ูุณุจุจ ุตุนูุจุงุช ููุงุตูุฉ ุงูุชุทููุฑ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/click-1.jpeg" alt="ูููู ุงููุฑ ููู ุงูุนุฑุถ ุงูุชูุฏููู"></p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/click-2.png" alt="ูุง ูุง ุชุฑูุฏู ูููู ูููู ูุฑุฉ ุฃุฎุฑู"></p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://www.youtube.com/watchุv=Hqw57GJSrac</a> </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐู ุ ุจุงูุนูุฏุฉ ุฅูู ุงูุณุคุงู ุ ูุง ูุฐุง ูู Java ุงูุฐู ูููู ุฃู ูุณุงุนุฏ ูู ุญู ูุฐู ุงููุดุงููุ  ููุณ ุงูุดูุก ุงูุฐู ูุนุทู ูุชุงุจุฉ ุจุฑูุงูุฌ ุจูุบุฉ Java ุจุฏูุงู ูู C ++.  ูู ุงููุญุชูู ุฃู ูููู ูุฐุง ุฃูุงููุง (ุงุณุชุซูุงุกุงุช ุจุฏูุงู ูู ุงูุฃุนุทุงู ุ ููุง ููุฌุฏ ุชุณุฑุจ ุญูููู ููุฐุงูุฑุฉ ุฃู ูุคุดุฑุงุช ูุชุฏููุฉ) ุ <em>ููุณุงุนุฏูู ุฌูุฏูู</em> ( <em>ูุตุญุญูู</em> ุ ูุฃุฏูุงุช <em>ุชุญููู</em> ุ ูุฃุฏูุงุช ูุซู <em>VisualVM</em> ) ุ ูุฏุนู IDE ุฌูุฏ ุ ุฅูุฎ. </p><br><p style=";text-align:right;direction:rtl">  ูุฏ ุชููุฑ: <em>ููู ูููููู ูุชุงุจุฉ ุดูุก ูุซู ูุชุฑุฌู ุฌุงูุง JITุ</em>  ุ ูุฃู ูุฐุง ูููู ููุท ูู ูุบุฉ ุจุฑูุฌุฉ ูุธุงู ููุฎูุถุฉ ุงููุณุชูู ูุซู C ++.  ูู ูุฐุง ุงูุนุฑุถ ุ ุขูู ุฃู ุฃููุนู ุฃู ูุฐุง ููุณ ุนูู ุงูุฅุทูุงู!  ุจุดูู ุฃุณุงุณู ุ ูุฌุจ ุนูู ุงููุชุฑุฌู JIT ููุท ูุจูู JVM bytecode ูุฅุนุทุงุก ุฑูุฒ ุงูุฌูุงุฒ - ููููู ุฅุนุทุงุคู <code>byte[]</code> ุนูุฏ ุงูุฅุฏุฎุงู ุ ูุชุฑูุฏ ุฃูุถูุง <code>byte[]</code> .  ูุชุทูุจ ุงูุฃูุฑ ุงููุซูุฑ ูู ุงูุนูู ุงููุนูุฏ ููููุงู ุจุฐูู ุ ููููู ูุง ูุคุซุฑ ุนูู ูุณุชูู ุงููุธุงู ุ ูุจุงูุชุงูู ูุง ูุชุทูุจ ูุบุฉ <em>ูุธุงู</em> ูุซู C ุฃู C ++. </p><br><h2 id="nastroyka-graal" style=";text-align:right;direction:rtl">  ุฅุนุฏุงุฏ Graal </h2><br><p style=";text-align:right;direction:rtl">  ุฃูู ุดูุก ูุญุชุงุฌู ูู Java 9. ุชูุช ุฅุถุงูุฉ ูุงุฌูุฉ Graal ุงููุณูุงุฉ <em>JVMCI ุงููุณุชุฎุฏูุฉ</em> ุฅูู Java ูุฌุฒุก ูู <em>ูุงุฌูุฉ JEP 243 Java-Level JVM Compiler Interface ุ</em> ูุงูุฅุตุฏุงุฑ ุงูุฃูู ุงูุฐู ูุชุถูููุง ูู Java 9. ุฃุณุชุฎุฏู <em>9 + 181</em> .  ูู ุญุงูุฉ ูุฌูุฏ ุฃู ูุชุทูุจุงุช ุฎุงุตุฉ ุ ุชูุฌุฏ ููุงูุฐ (ููุงูุฐ ุฎูููุฉ) ูู Java 8. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> export JAVA_HOME=`pwd`/jdk9 <span class="hljs-variable"><span class="hljs-variable">$</span></span> export PATH=<span class="hljs-variable"><span class="hljs-variable">$JAVA_HOME</span></span>/bin:<span class="hljs-variable"><span class="hljs-variable">$PATH</span></span> <span class="hljs-variable"><span class="hljs-variable">$</span></span> java <span class="hljs-literal"><span class="hljs-literal">-version</span></span> java version <span class="hljs-string"><span class="hljs-string">"9"</span></span> Java(TM) SE Runtime Environment (build <span class="hljs-number"><span class="hljs-number">9</span></span>+<span class="hljs-number"><span class="hljs-number">181</span></span>) Java HotSpot(TM) <span class="hljs-number"><span class="hljs-number">64</span></span><span class="hljs-literal"><span class="hljs-literal">-Bit</span></span> Server VM (build <span class="hljs-number"><span class="hljs-number">9</span></span>+<span class="hljs-number"><span class="hljs-number">181</span></span>, mixed mode)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุดูุก ุงูุชุงูู ุงูุฐู ูุญุชุงุฌู ูู ูุธุงู ุจูุงุก ูุณูู <code>mx</code> .  ุฅููุง ุชุดุจู ุฅูู ุญุฏ ูุง <em>Maven</em> ุฃู <em>Gradle</em> ุ ูููู ุนูู ุงูุฃุฑุฌุญ ูู ุชุฎุชุงุฑูุง <em>ูุชุทุจููู</em> .  ูููู ุจุชูููุฐ ูุธุงุฆู ูุนููุฉ ูุฏุนู ุจุนุถ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู ุงููุนูุฏุฉ ุ ููููุง ุณูุณุชุฎุฏููุง ููุท ููุชุฌููุนุงุช ุงูุจุณูุทุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููููู ุงุณุชูุณุงุฎ <code>mx</code> ุจุงุณุชุฎุฏุงู GitHub.  ุฃูุง ุฃุณุชุฎุฏู ุงูุงูุชุฒุงู <code>#7353064</code> .  ุงูุขู ููุท ูู ุจุฅุถุงูุฉ ุงูููู ุงูุชูููุฐู ุฅูู ุงููุณุงุฑ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> git clone https://github.com/graalvm/mx.git <span class="hljs-variable"><span class="hljs-variable">$</span></span> cd mx; git checkout <span class="hljs-number"><span class="hljs-number">7353064</span></span> <span class="hljs-variable"><span class="hljs-variable">$</span></span> export PATH=`pwd`/mx:<span class="hljs-variable"><span class="hljs-variable">$PATH</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุญู ุจุญุงุฌุฉ ุฅูู ุงุณุชูุณุงุฎ Graal ููุณู.  ุฃูุง ุฃุณุชุฎุฏู ุชูุฒูุนุฉ ุชุณูู <em>GraalVM</em> ุงูุฅุตุฏุงุฑ <em>0.28.2</em> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> git clone https://github.com/graalvm/graal.git -<span class="hljs-literal"><span class="hljs-literal">-branch</span></span> vm<span class="hljs-literal"><span class="hljs-literal">-enterprise</span></span><span class="hljs-literal"><span class="hljs-literal">-0</span></span>.<span class="hljs-number"><span class="hljs-number">28.2</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญุชูู ูุฐุง ุงููุณุชูุฏุน ุนูู ูุดุงุฑูุน ุฃุฎุฑู ูุง ููุชู ุจูุง ุ ูุฐูู ููุชูู ููุท ุฅูู ุงููุดุฑูุน ุงููุฑุนู <em>ูููุชุฑุฌู</em> ุ ููู ูุชุฑุฌู Graal JIT ุ ูุชุฌููุนู ุจุงุณุชุฎุฏุงู <code>mx</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">$ cd graal/compiler $ mx build</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุนูู ุจุงุณุชุฎุฏุงู ููุฏ Graal ุ ุณุฃุณุชุฎุฏู <em>Eclipse IDE</em> .  ุฃูุง ุฃุณุชุฎุฏู Eclipse 4.7.1.  ูููู ุฃู ูููุฏ <code>mx</code> ูููุงุช ูุดุฑูุน Eclipse ุจุงููุณุจุฉ ููุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">$ mx eclipseinit</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุชุญ ุฏููู <em>ุงูุฏุฑุฌุงุช ููุณุงุญุฉ</em> <em>ุนูู ุ</em> ุชุญุชุงุฌ ุฅูู ุชูููุฐ <em>ูุดุงุฑูุน ููู ุ ุงุณุชูุฑุงุฏ ... ุ ุนุงู ุ ูุงุฆูุฉ</em> ูุชุญุฏูุฏ ุฏููู <em>ุงูุฏุฑุฌุงุช ูุฑุฉ ุฃุฎุฑู</em> .  ุฅุฐุง ูู ุชูู ุจุชุดุบูู Eclipse ุนูู Java 9 ุ ููุฏ ุชุญุชุงุฌ ุฃูุถูุง ุฅูู ุฅุฑูุงู ูุตุงุฏุฑ JDK. </p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/eclipse.png" alt="ุญุฏู ูู ุงููุณูู"></p><br><p style=";text-align:right;direction:rtl">  ุฌูุฏ.  ุงูุขู ุจุนุฏ ุฃู ุฃุตุจุญ ูู ุดูุก ุฌุงูุฒูุง ุ ุฏุนูุง ูุฑู ููู ูุนูู.  ุณูุณุชุฎุฏู ูุฐุง ุงูุฑูุฒ ุงูุจุณูุท ููุบุงูุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Demo</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { workload(<span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">workload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b; } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ูููู ุจุชุฌููุน ููุฏ <code>javac</code> ูุฐุง ุ ุซู ุชุดุบูู JVM.  ุฃููุงู ุ ุณุฃูุถุญ ูู ููู ูุนูู ูุชุฑุฌู C2 JIT ุงูููุงุณู.  ููููุงู ุจุฐูู ุ <code>-XX:+PrintCompilation</code> ุงูุนุฏูุฏ ูู ุงูุนูุงูุงุช: <code>-XX:+PrintCompilation</code> ุ ููู ุถุฑูุฑู ูู JVM ููุชุงุจุฉ ุณุฌู ุนูุฏ ุชุฌููุน ุทุฑููุฉ ุ ู <code>-XX:CompileOnly=Demo::workload</code> ุ ุจุญูุซ ูุชู ุชุฌููุน ูุฐู ุงูุทุฑููุฉ ููุท.  ุฅุฐุง ูู ููุนู ุฐูู ุ ูุณูุชู ุนุฑุถ ุงููุซูุฑ ูู ุงููุนูููุงุช ุ ูุณูู ุชููู JVM ุฃูุซุฑ ุฐูุงุกู ููุง ูุญุชุงุฌ ุฅููู ุ ูุณุชุญุณู ุงูุดูุฑุฉ ุงูุชู ูุฑูุฏ ุฑุคูุชูุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">$ javac Demo.java $ java \ -<span class="hljs-symbol"><span class="hljs-symbol">XX:</span></span>+PrintCompilation \ -<span class="hljs-symbol"><span class="hljs-symbol">XX:</span></span>CompileOnly=Demo::workload \ Demo ... <span class="hljs-number"><span class="hljs-number">113</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> Demo::workload (<span class="hljs-number"><span class="hljs-number">4</span></span> bytes) ...</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุฃุดุฑุญ ุฐูู ุจุงูุชูุตูู ุ ููููู ุณุฃููู ููุท ุฃู ูุฐุง ูุงุชุฌ ุณุฌู ููุถุญ ุฃู ุทุฑููุฉ <code>workload</code> ุชู ุชุฌููุนูุง. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุ ุจุตูุชูุง ูุชุฑุฌู JIT ูู Java 9 JVM ุ ูุณุชุฎุฏู Graal ุงููุชุฑุฌู ุญุฏูุซูุง.  ููููุงู ุจุฐูู ุ ุฃุถู ุจุนุถ ุงูุนูุงูุงุช ุงูุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  <code>--module-path=...</code> and <code>--upgrade-module-path=...</code> ุฃุถู Graal ุฅูู <em>ูุณุงุฑ ุงููุญุฏุฉ</em> .  ุฏุนูู ุฃุฐูุฑู ุจุฃู <em>ูุณุงุฑ ุงููุญุฏุฉ ุงูููุทูุฉ</em> ุธูุฑ ูู Java 9 ูุฌุฒุก ูู ูุธุงู ูุญุฏุฉ <em>Jigsaw</em> ุ ููุฃุบุฑุงุถูุง ูููููุง ุฃู <em>ูุฃุฎุฐู ูู</em> ุงูุงุนุชุจุงุฑ ุนู ุทุฑูู ุงูููุงุณ ูุน <em>classpath</em> . </p><br><p style=";text-align:right;direction:rtl">  ูุญุชุงุฌ ุฅูู <code>-XX:+UnlockExperimentalVMOptions</code> ุจุณุจุจ ุญูููุฉ ุฃู JVMCI (ุงููุงุฌูุฉ ุงููุณุชุฎุฏูุฉ ูู ูุจู Graal) ูู ูุฐุง ุงูุฅุตุฏุงุฑ ูู ููุฒุฉ ุชุฌุฑูุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงูุนูุงูุฉ <code>-XX:+EnableJVMCI</code> ูุทููุจุฉ ููููู ุฃููุง ูุฑูุฏ ุงุณุชุฎุฏุงู JVMCI ุ ู <code>-XX:+UseJVMCICompiler</code> - ูุชูููู ูุชุซุจูุช ูุชุฑุฌู JIT ุฌุฏูุฏ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุนุฏู ุชุนููุฏ ุงููุซุงู ุ ูุจุฏูุงู ูู ุงุณุชุฎุฏุงู C1 ุจุงูุงูุชุฑุงู ูุน JVMCI ุ ูุฏูู ููุท ูุชุฑุฌู JVMCI ุ ุญุฏุฏ ุงูุนูู <code>-XX:-TieredCompilation</code> ุ ูุงูุฐู <code>-XX:-TieredCompilation</code> . </p><br><p style=";text-align:right;direction:rtl">  ููุง ูุงู ูู ูุจู ุ ูุญุฏุฏ ุงูุนูุงูุงุช <code>-XX:+PrintCompilation</code> ู <code>-XX:CompileOnly=Demo::workload</code> . </p><br><p style=";text-align:right;direction:rtl">  ููุง ูู ุงููุซุงู ุงูุณุงุจู ุ ูุฑู ุฃูู ุชู ุชุตููู ุทุฑููุฉ ูุงุญุฏุฉ.  ูููู ุ ูุฐู ุงููุฑุฉ ุ ุจุงููุณุจุฉ ููุชุฌููุน ุ ุงุณุชุฎุฏููุง ููุชู Graal.  ูู ุงูููุช ุงูุญุงูู ุ ุฎุฐ ูููุชู ููุท. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> java \ -<span class="hljs-literal"><span class="hljs-literal">-module</span></span><span class="hljs-literal"><span class="hljs-literal">-path</span></span>=graal/sdk/mxbuild/modules/org.graalvm.graal_sdk.jar:graal/truffle/mxbuild/modules/com.oracle.truffle.truffle_api.jar \ -<span class="hljs-literal"><span class="hljs-literal">-upgrade</span></span><span class="hljs-literal"><span class="hljs-literal">-module</span></span><span class="hljs-literal"><span class="hljs-literal">-path</span></span>=graal/compiler/mxbuild/modules/jdk.internal.vm.compiler.jar \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:+UnlockExperimentalVMOptions \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:+EnableJVMCI \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:+UseJVMCICompiler \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:<span class="hljs-literal"><span class="hljs-literal">-TieredCompilation</span></span> \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:+PrintCompilation \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:CompileOnly=Demo::workload \ Demo ... <span class="hljs-number"><span class="hljs-number">583</span></span> <span class="hljs-number"><span class="hljs-number">25</span></span> Demo::workload (<span class="hljs-number"><span class="hljs-number">4</span></span> bytes) ...</code> </pre> <br><h2 id="interfeys-kompilyatora-jvm" style=";text-align:right;direction:rtl">  ูุงุฌูุฉ ูุชุฑุฌู JVM </h2><br><p style=";text-align:right;direction:rtl">  ุฃูุง ุชุนุชูุฏ ุฃููุง ูููุง ุจุดูุก ุบูุฑ ุนุงุฏูุ  ูุฏููุง JVM ูุซุจุช ุ ูุงุณุชุจุฏููุง ูุชุฑุฌู JIT ูุน ุงููุชุฑุฌู ุงูุฌุฏูุฏ ุงูุฐู ุชู ุชุฌููุนู ููุชู ุฏูู ุชุบููุฑ ุฃู ุดูุก ูู JVM ููุณู.  ูุชู ุชูููุฑ ูุฐู ุงูููุฒุฉ ูู ุฎูุงู ูุงุฌูุฉ JVM ุฌุฏูุฏุฉ ุชุณูู JVMCI ุ <em>ูุงุฌูุฉ ูุชุฑุฌู JVM</em> ุ ูุงูุชู ุ ููุง ููุช ุฃุนูุงู ุ ูุงูุช <em>JEP 243</em> ูุฌุงุกุช ูู Java 9. </p><br><p style=";text-align:right;direction:rtl">  ุงูููุฑุฉ ูุดุงุจูุฉ ูุจุนุถ ุชูููุงุช JVM ุงูููุฌูุฏุฉ ุงูุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  ุฑุจูุง ุตุงุฏูุช <code>javac</code> ูุนุงูุฌุฉ ุฅุถุงููุฉ ูุดูุฑุฉ ุงููุตุฏุฑ ูู <em>ุฌุงูุง</em> <code>javac</code> ุจุงุณุชุฎุฏุงู <em>ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ูุนุงูุฌุฉ ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ ูู ุฌุงูุง</em> .  ุชุชูุญ ูุฐู ุงูุขููุฉ ุชุญุฏูุฏ ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ ููููุฐุฌ ุดูุฑุฉ ุงููุตุฏุฑ ุงูุชู ูุชู ุงุณุชุฎุฏุงููุง ูููุง ุ ูุฅูุดุงุก ูููุงุช ุฌุฏูุฏุฉ ุจูุงุกู ุนูููุง. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุถุง ุ ุฑุจูุง ุชููู ูุฏ ุงุณุชุฎุฏูุช ูุนุงูุฌุฉ ููุฏ ุฅุถุงูู ูู JVM ุจุงุณุชุฎุฏุงู <em>ูููุงุก Java</em> .  ุชุชูุญ ูู ูุฐู ุงูุขููุฉ ุชุนุฏูู Java bytecode ุนู ุทุฑูู ุงุนุชุฑุงุถูุง ูู ููุช ุงูุชูููุฏ. </p><br><p style=";text-align:right;direction:rtl">  ููุฑุฉ JVMCI ูุชุดุงุจูุฉ.  ูุณูุญ ูู ุจุชูุตูู ูุชุฑุฌู ุฌุงูุง JIT ุงูุฎุงุต ุจู ุงูููุชูุจ ุจูุบุฉ ุฌุงูุง. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฃุฑูุฏ ุฃู ุฃููู ุจุถุน ูููุงุช ุญูู ููููุฉ ุฅุธูุงุฑ ุงูุฑูุฒ ุฃุซูุงุก ูุฐุง ุงูุนุฑุถ ุงูุชูุฏููู.  ุฃููุงู ุ ูููู ุงูููุฑุฉ ุ ุณุฃุนุฑุถ ุจุนุถ ุงููุนุฑููุงุช ุงููุจุณุทุฉ ูุงูููุทู ูู ุดูู ูุต ุนูู ุงูุดุฑุงุฆุญ ุ ูุจุนุฏ ุฐูู ุณุฃูุชูู ุฅูู ููุทุงุช ุดุงุดุฉ Eclipse ูุฃุนุฑุถ ุงูุดูุฑุฉ ุงูุญููููุฉ ุ ูุงูุชู ูููู ุฃู ุชููู ุฃูุซุฑ ุชุนููุฏูุง ููููุงู ุ ููู ุงูููุฑุฉ ุงูุฑุฆูุณูุฉ ุณุชุธู ููุง ูู.  ุงูุบุฑุถ ุงูุฑุฆูุณู ูู ูุฐุง ุงูุนุฑุถ ุงูุชูุฏููู ูู ุฅุธูุงุฑ ุฃูู ูู ุงููููู ุญููุง ุงูุนูู ูุน ุฑูุฒ ุงููุดุฑูุน ุงูุญูููู ุ ูุจุงูุชุงูู ูุง ุฃุฑูุฏ ุฅุฎูุงุกู ุ ุนูู ุงูุฑุบู ูู ุฃูู ูููู ุฃู ูููู ูุนูุฏูุง ุฅูู ุญุฏ ูุง. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุขู ูุตุงุนุฏุง ุ ุฃุจุฏุฃ ูู ุชุจุฏูุฏ ุงูุฑุฃู ุงููุงุฆู ุจุฃูู ูุฏ ูููู ูุฏูู ูุฌูุน JIT ูุนูุฏ ููุบุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุงุฐุง ููุจู ุงููุชุฑุฌู JIT ููุฅุฏุฎุงูุ  ููุจู ุงูุฑูุฒ ุงูุซุงููู ููุทุฑููุฉ ุงูุชู ุณูุชู ุชุฌููุนูุง.  ูุงูุจุงูุช ููุฏ ุ ููุง ููุญู ุงูุงุณู ุ ูู ูุฌุฑุฏ ูุฌููุนุฉ ูู ุงูุจุงูุชุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูุงุฐุง ููุชุฌ ูุชุฑุฌู JIT ูุชูุฌุฉ ูุฐููุ  ูุนุทู ุฑูุฒ ุงูุฌูุงุฒ ููุทุฑููุฉ.  ุฑูุฒ ุงูุฌูุงุฒ ูู ุฃูุถูุง ูุฌููุนุฉ ูู ูุญุฏุงุช ุงูุจุงูุช. </p><br><p style=";text-align:right;direction:rtl">  ูุชูุฌุฉ ูุฐูู ุ ุณุชุจุฏู ุงููุงุฌูุฉ ุงูุชู ูุฌุจ ุชูููุฐูุง ุนูุฏ ูุชุงุจุฉ ูุชุฑุฌู JIT ุฌุฏูุฏ ูุชุถูููู ูู JVM ูุซู ูุฐุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JVMCICompiler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] compileMethod(<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytecode); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ุฅุฐุง ูู ุชุณุชุทุน ุฃู ุชุชุฎูู ููู ูููู ูู Java ุงูููุงู ุจุดูุก ููุฎูุถ ุงููุณุชูู ูุซู ุชุฌููุน JIT ูู ุฑูุฒ ุงูุขูุฉ ุ ููููู ุงูุขู ุฃู ุชุฑู ุฃู ูุฐุง ููุณ ุนูููุง ููุฎูุถ ุงููุณุชูู.  ุตุญูุญุ  ูุฐู ูุฌุฑุฏ ุฏุงูุฉ ูู <code>byte[]</code> ุฅูู <code>byte[]</code> . </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงูุน ุ ูู ุดูุก ุฃูุซุฑ ุชุนููุฏูุง ุฅูู ุญุฏ ูุง.  ูุฌุฑุฏ ุจุงูุช ููุฏ ููุณ ูุงููุง - ูุญู ุจุญุงุฌุฉ ุฃูุถุง ุฅูู ูุฒูุฏ ูู ุงููุนูููุงุช ุ ูุซู ุนุฏุฏ ุงููุชุบูุฑุงุช ุงููุญููุฉ ุ ูุญุฌู ุงูููุฏุณ ุงููุทููุจ ุ ูุงููุนูููุงุช ุงูุชู ุชู ุฌูุนูุง ูู ูุจู ููู ุชุนุฑูู ุงููุชุฑุฌู ูููู ููููุฉ ุชูููุฐ ุงูุดูุฑุฉ ูู ุงููุงูุน.  ูุฐูู ุ ุชุฎูู ุงูุฅุฏุฎุงู ูู ุดูู <code>CompilationRequest</code> ุ ูุงูุฐู ุณูุฎุจุฑูุง ุนู <code>JavaMethod</code> ุงูุฐู ูุฌุจ <code>JavaMethod</code> ูุชูููุฑ ุฌููุน ุงููุนูููุงุช ุงููุงุฒูุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JVMCICompiler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compileMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CompilationRequest request)</span></span></span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CompilationRequest</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">JavaMethod </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JavaMethod</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getCode(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMaxLocals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMaxStackSize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">ProfilingInfo </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getProfilingInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; ... }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃูุถุง ุ ูุง ุชุชุทูุจ ุงููุงุฌูุฉ ุฅุฑุฌุงุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุชุฑุฌูุฉ.  ุจุฏูุงู ูู ุฐูู ุ ูุชู ุงุณุชุฎุฏุงู API ุฃุฎุฑู ูุชุซุจูุช ุฑูุฒ ุงูุฌูุงุฒ ูู JVM. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">HotSpot.installCode(targetCode);</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุ ููุชุงุจุฉ ูุชุฑุฌู JIT ุฌุฏูุฏ ูู JVM ุ ูุง ุนููู ุณูู ุชูููุฐ ูุฐู ุงููุงุฌูุฉ.  ูุญุตู ุนูู ูุนูููุงุช ุญูู ุงูุทุฑููุฉ ุงูุชู ูุฌุจ <code>installCode</code> ุ ููุฌุจ ุฃู ูููู ุจุชุฌููุนูุง ูู ุฑูุฒ ุงูุฌูุงุฒ ูุงุณุชุฏุนุงุก <code>installCode</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GraalCompiler</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JVMCICompiler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compileMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CompilationRequest request)</span></span></span><span class="hljs-function"> </span></span>{ HotSpot.installCode(...); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ููุชูู ุฅูู Eclipse IDE ูุน Graal ูุฅููุงุก ูุธุฑุฉ ุนูู ุจุนุถ ุงููุงุฌูุงุช ูุงููุฆุงุช ุงูุญููููุฉ.  ููุง ุฐูุฑูุง ุณุงุจููุง ุ ุณูููููู ุฃูุซุฑ ุชุนููุฏูุง ุฅูู ุญุฏ ูุง ุ ูููู ููุณ ูุซูุฑูุง. </p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/jvmci-compiler-interface.png" alt="JVMCIC ูุชุฑุฌู"></p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/hotspot-graal-compiler-1.png" alt="HotSpotGraalCompiler"></p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/hotspot-graal-compiler-2.png" alt="ุทุฑููุฉ ุงูุชุฑุฌูุฉ"></p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฃุฑูุฏ ุฃู ุฃุซุจุช ุฃูู ูููููุง ุฅุฌุฑุงุก ุชุบููุฑุงุช ุนูู Graal ุ ูุงุณุชุฎุฏุงููุง ุนูู ุงูููุฑ ูู Java 9. ุณุฃุถูู ุฑุณุงูุฉ ุณุฌู ุฌุฏูุฏุฉ ุณูุชู ุนุฑุถูุง ุนูุฏ ุชุฌููุน ุงูุทุฑููุฉ ุจุงุณุชุฎุฏุงู Graal.  ูู ุจุฅุถุงูุชู ุฅูู ุทุฑููุฉ ุงููุงุฌูุฉ ุงููุทุจูุฉ ุ ูุงูุชู ูุทูู ุนูููุง JVMCI. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HotSpotGraalCompiler</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JVMCICompiler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">CompilationRequestResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compileMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CompilationRequest request)</span></span></span><span class="hljs-function"> </span></span>{ System.err.println(<span class="hljs-string"><span class="hljs-string">"Going to compile "</span></span> + request.getMethod().getName()); ... } }</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/hotspot-graal-compiler-3.png" alt="ุชุฌููุน"></p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุ ูู ุจุชุนุทูู ุชุณุฌูู ุงูุชุฑุฌูุฉ ูู HotSpot.  ุงูุขู ูููููุง ุฑุคูุฉ ุฑุณุงูุชูุง ูู ุงููุณุฎุฉ ุงููุนุฏูุฉ ูููุชุฑุฌู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">$ java \ --<span class="hljs-keyword"><span class="hljs-keyword">module</span></span>-path=graal/sdk/mxbuild/modules/org.graalvm.graal_sdk.jar:graal/truffle/mxbuild/modules/com.oracle.truffle.truffle_api.jar \ --upgrade-<span class="hljs-keyword"><span class="hljs-keyword">module</span></span>-path=graal/compiler/mxbuild/modules/jdk.internal.vm.compiler.jar \ -XX:+UnlockExperimentalVMOptions \ -XX:+EnableJVMCI \ -XX:+UseJVMCICompiler \ -XX:-TieredCompilation \ -XX:CompileOnly=Demo::workload \ Demo Going to compile workload</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุญุงููุช ุชูุฑุงุฑ ุฐูู ุจููุณู ุ ุณุชูุงุญุธ ุฃูู ูุณุช ุจุญุงุฌุฉ ุญุชู ุฅูู ุชุดุบูู ูุธุงู ุงูุจูุงุก ูุฏููุง - <code>mx build</code> .  ูููู ุ ุนุงุฏู ูู Eclipse ุ <em>ุชุฌููุน ุนูุฏ ุงูุญูุธ</em> .  ูุจุงูุชุฃููุฏ ูุง ูุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุจูุงุก ุงูุขููุฉ ุงููุดุชุฑูุฉ ููุณูุง.  ูููู ุจุจุณุงุทุฉ ุจุชุถููู ุงููุชุฑุฌู ุงููุนุฏู ูู JVM ุงูุญุงูู. </p><br><h2 id="graf-graal" style=";text-align:right;direction:rtl">  ุงููููุช ุฌุฑุงุงู </h2><br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ูุญู ูุนูู ุฃู Graal ูุญูู <code>byte[]</code> ูุงุญุฏูุง <code>byte[]</code> ุฅูู <code>byte[]</code> ุขุฎุฑ <code>byte[]</code> .  ุงูุขู ุฏุนููุง ูุชุญุฏุซ ุนู ุงููุธุฑูุฉ ูููุงูู ุงูุจูุงูุงุช ุงูุชู ูุณุชุฎุฏููุง ุ ูุฃูู  ููู ุบูุฑ ุนุงุฏูุฉ ุจุนุถ ุงูุดูุก ุญุชู ุจุงููุณุจุฉ ูููุชุฑุฌู. </p><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุฃุณุงุณู ุ ูุนุงูุฌ ุงููุชุฑุฌู ุจุฑูุงูุฌู.  ููุฐุง ุ ูุฌุจ ุชูุฏูู ุงูุจุฑูุงูุฌ ูู ุดูู ููุน ูู ูููู ุงูุจูุงูุงุช.  ุฃุญุฏ ุงูุฎูุงุฑุงุช ูู ุงูุจุงูุช ููุฏ ูููุงุฆู ุงูุชุนูููุงุช ุงููุดุงุจูุฉ ุ ููููุง ููุณุช ูุนุจุฑุฉ ุฌุฏูุง. </p><br><p style=";text-align:right;direction:rtl">  ุจุฏูุงู ูู ุฐูู ุ ูุณุชุฎุฏู Graal ุฑุณููุง ุจูุงูููุง ูุชูุซูู ุจุฑูุงูุฌู.  ุฅุฐุง ุฃุฎุฐูุง ุนุงูู ุฅุถุงูุฉ ุจุณูุทูุง ููุฎุต ูุชุบูุฑูู ูุญูููู ุ ูุณูุดุชูู ุงูุฑุณู ุงูุจูุงูู ุนูู ุนูุฏุฉ ูุงุญุฏุฉ ูุชุญููู ูู ูุชุบูุฑ ุ ูุนูุฏุฉ ูุงุญุฏุฉ ูููุฌููุน ุ ูุญุงูุชูู ุชุธูุฑุงู ุฃู ูุชูุฌุฉ ุชุญููู ุงููุชุบูุฑุงุช ุงููุญููุฉ ูู ุฅุฏุฎุงู ูุนุงูู ุงูุฅุถุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุณูู ูุฐุง ุฃุญูุงููุง <em>ุงูุฑุณู ุงูุจูุงูู ูุชุจุนูุฉ ุงูุจุฑูุงูุฌ</em> . </p><br><p style=";text-align:right;direction:rtl">  ุจุงูุญุตูู ุนูู ุชุนุจูุฑ ุนู ุงููููุฐุฌ <code>x + y</code> ูุญุตู ุนูู ุนูุฏ ูููุชุบูุฑุงุช ุงููุญููุฉ <code>x</code> ู <code>y</code> ุ ูุนูุฏุฉ ูู ูุฌููุนูุง. </p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/data-graph.png" alt="ุฑุณู ุจูุงูู ูุชุฏูู ุงูุจูุงูุงุช"></p><br><p style=";text-align:right;direction:rtl">  ุชูุถุญ ุงูุญูุงู ุงูุฒุฑูุงุก ูู ูุฐุง ุงูุฑุณู ุงูุจูุงูู ุงุชุฌุงู ุชุฏูู ุงูุจูุงูุงุช ูู ูุฑุงุกุฉ ุงููุชุบูุฑุงุช ุงููุญููุฉ ุฅูู ุงูุฌูุน. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุถุง ุ ูููููุง ุงุณุชุฎุฏุงู ุงูุญูุงู ูุชุนูุณ ุชุฑุชูุจ ุงูุชูููุฐ ููุจุฑูุงูุฌ.  ุฅุฐุง ุ ุจุฏูุงู ูู ูุฑุงุกุฉ ุงููุชุบูุฑุงุช ุงููุญููุฉ ุ ุงุชุตููุง ุจุงูุฃุณุงููุจ ุ ูุฅููุง ุจุญุงุฌุฉ ุฅูู ุชุฐูุฑ ุชุฑุชูุจ ุงูููุงููุฉ ุ ููุง ูููููุง ุฅุนุงุฏุฉ ุชุฑุชูุจูุง (ุฏูู ูุนุฑูุฉ ุงูุฑูุฒ ุงูููุฌูุฏ ูู ุงูุฏุงุฎู).  ููููุงู ุจุฐูู ุ ููุงู ุญูุงู ุฅุถุงููุฉ ุชุญุฏุฏ ูุฐุง ุงูุชุฑุชูุจ.  ุชุธูุฑ ุจุงูููู ุงูุฃุญูุฑ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/control-graph.png" alt="ุงูุชุญูู ูู ุชุฏูู ุงูุฑุณู ุงูุจูุงูู"></p><br><p style=";text-align:right;direction:rtl">  ุฅุฐู ุ ุงูุฑุณู ุงูุจูุงูู Graal ุ ูู ุงููุงูุน ุ ูู ุฑุณูุงู ุจูุงููุงู ูุฏูุฌุงู ูู ูุงุญุฏ.  ุงูุนูุฏ ูู ููุณูุง ุ ูููู ุจุนุถ ุงูุญูุงู ุชุดูุฑ ุฅูู ุงุชุฌุงู ุฏูู ุงูุจูุงูุงุช ุ ูู ุญูู ุฃู ุงูุจุนุถ ุงูุขุฎุฑ ูุธูุฑ ููู ุงูุชุญูู ุจููููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุฑุคูุฉ ุงูุฑุณู ุงูุจูุงูู Graal ุ ููููู ุงุณุชุฎุฏุงู ุฃุฏุงุฉ ุชุณูู <em>IdealGraphVisualiser</em> ุฃู <em>IGV</em> .  ูุชู ุจุฏุก ุงูุชุดุบูู ุจุงุณุชุฎุฏุงู <code>mx igv</code> . </p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/igv.png" alt="IdealGraphVisualiser"></p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ูู ุจุชุดุบูู JVM <code>-Dgraal.Dump</code> . </p><br><p style=";text-align:right;direction:rtl">  ูููู ุฑุคูุฉ ุฏูู ุจูุงูุงุช ุจุณูุท ุนู ุทุฑูู ูุชุงุจุฉ ุชุนุจูุฑ ุจุณูุท. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">average</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a + b) / <span class="hljs-number"><span class="hljs-number">2</span></span>; }</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/average.png" alt="ูุนูู ุงูุญุณุงุจ igv"></p><br><p style=";text-align:right;direction:rtl">  ููููู ุฃู ุชุฑู ููู ุชุฐูุจ ุงููุนููุงุช <code>0</code> ( <code>P(0</code> ) ู <code>1</code> ( <code>P(1)</code> ) ุฅูู ุฅุฏุฎุงู ุนูููุฉ ุงูุฅุถุงูุฉ ุ ูุงูุชู ุ ูุน ุงูุซุงุจุช <code>2</code> ( <code>C(2)</code> ) ุชุฐูุจ ุฅูู ุฅุฏุฎุงู ุนูููุฉ ุงููุณูุฉ ุ ูุจุนุฏ ุฐูู ูุชู ุฅุฑุฌุงุน ูุฐู ุงููููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุงููุธุฑ ุฅูู ุชุฏูู ุฃูุซุฑ ุชุนููุฏูุง ููุจูุงูุงุช ูุงูุชุญูู ุ ููุฏู ุฏูุฑุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">average</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] values)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>; n &lt; values.length; n++) { sum += values[n]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum / values.length; }</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/average-loop.png" alt="ูุนูู ุงูุญุณุงุจ igv ูุน ุฏูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/average-loop-detail.png" alt="ุงููุชูุณุท โโุงูุญุณุงุจู ุงูุชูุตููู IGV ูุน ุญููุฉ"></p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูุญุงูุฉ ุ ูุฏููุง ุนูุฏ ุจุฏุงูุฉ ูููุงูุฉ ุงูุญููุฉ ุ ููุฑุงุกุฉ ุนูุงุตุฑ ุงููุตูููุฉ ุ ููุฑุงุกุฉ ุทูู ุงููุตูููุฉ.  ููุง ูุงู ูู ูุจู ุ ุชุดูุฑ ุงูุฎุทูุท ุงูุฒุฑูุงุก ุฅูู ุงุชุฌุงู ุชุฏูู ุงูุจูุงูุงุช ุ ูุชุดูุฑ ุงูุฎุทูุท ุงูุญูุฑุงุก ุฅูู ุชุฏูู ุงูุชุญูู. </p><br><p style=";text-align:right;direction:rtl">  ููููู ุงูุขู ูุนุฑูุฉ ุณุจุจ ุชุณููุฉ ุจููุฉ ุงูุจูุงูุงุช ุฃุญูุงููุง <em>ุจุญุฑ ุงูุนูุฏ</em> ุฃู <em>ุญุณุงุก ุงูุนูุฏ</em> . </p><br><p style=";text-align:right;direction:rtl">  ุฃุฑูุฏ ุฃู ุฃููู ุฃู C2 ุชุณุชุฎุฏู ุจููุฉ ุจูุงูุงุช ูุชุดุงุจูุฉ ุฌุฏูุง ุ ููู ุงููุงูุน ุ ูุงูุช C2 ูู ุงูุชู ุดุงุนุช ููุฑุฉ ูุชุฑุฌู <em>ุจุญุฑ ูู ุงูุนูุฏ</em> ุ ูุฐูู ูุฐุง ููุณ ุงุจุชูุงุฑูุง ูู Graal. </p><br><p style=";text-align:right;direction:rtl">  ูู ุฃุนุฑุถ ุนูููุฉ ุฅูุดุงุก ูุฐุง ุงูุฑุณู ุงูุจูุงูู ุญุชู ุงูุฌุฒุก ุงูุชุงูู ูู ุงูุนุฑุถ ุงูุชูุฏููู ุ ูููู ุนูุฏูุง ูุชููู Graal ุงูุจุฑูุงูุฌ ุจูุฐุง ุงูุชูุณูู ุ ูุชู ุฅุฌุฑุงุก ุงูุชุญุณูู ูุงูุชุฌููุน ุนู ุทุฑูู ุชุนุฏูู ุจููุฉ ุงูุจูุงูุงุช ูุฐู.  ููุฐุง ุฃุญุฏ ุงูุฃุณุจุงุจ ุงูุชู ุชุฌุนู ูุชุงุจุฉ ูุชุฑุฌู JIT ูู Java ููุทููุฉ.  Java ูู ูุบุฉ ููุฌูุฉ ูููุงุฆูุงุช ุ ูุงูุฑุณู ุงูุจูุงูู ุนุจุงุฑุฉ ุนู ูุฌููุนุฉ ูู ุงููุงุฆูุงุช ุงููุชุตูุฉ ุจูุงุณุทุฉ ุญูุงู ูู ุดูู ุฑูุงุจุท. </p><br><h2 id="ot-baytkoda-k-mashinnomu-kodu" style=";text-align:right;direction:rtl">  ูู ุงูุฑูุฒ ุงูุจุงูุช ุฅูู ุฑูุฒ ุงูุฌูุงุฒ </h2><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ูุฑู ููู ุชุจุฏู ูุฐู ุงูุฃููุงุฑ ูู ุงูููุงุฑุณุฉ ุ ููุชุจุน ุจุนุถ ุฎุทูุงุช ุนูููุฉ ุงูุชุฌููุน. </p><br><h3 id="poluchenie-baytkoda" style=";text-align:right;direction:rtl">  ุงูุญุตูู ุนูู Bytecode </h3><br><p style=";text-align:right;direction:rtl">  ูุจุฏุฃ ุงูุชุฌููุน ุจุงูุจุงูุช ููุฏ.  ุฏุนููุง ูุนูุฏ ุฅูู ูุซุงู ุงูุชูุฎูุต ุงูุตุบูุฑ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">workload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูููู ุจุฅุฎุฑุงุฌ ุงูุฑูุฒ ุงูุซุงููู ุงููุณุชูู ุนูุฏ ุงูุฅุฏุฎุงู ูุจู ุจุฏุก ุงูุชุฌููุน. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HotSpotGraalCompiler</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JVMCICompiler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">CompilationRequestResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compileMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CompilationRequest request)</span></span></span><span class="hljs-function"> </span></span>{ System.err.println(request.getMethod().getName() + <span class="hljs-string"><span class="hljs-string">" bytecode: "</span></span> + Arrays.toString(request.getMethod().getCode())); ... } }</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">workload</span></span> bytecode: [<span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>, <span class="hljs-number"><span class="hljs-number">96</span></span>, -<span class="hljs-number"><span class="hljs-number">84</span></span>]</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ุชุฑูู ุ ูุฅู ุงููุฏุฎู ุฅูู ุงููุฌูุน ูู bytecode. </p><br><h3 id="parser-baytkoda-i-postroitel-grafa" style=";text-align:right;direction:rtl">  ูุญูู Bytecode ูููุดุฆ ุงูุฑุณู ุงูุจูุงูู </h3><br><p style=";text-align:right;direction:rtl">  <em>ูููู ุงููููุดุฆ</em> ุ ุฅุฐ ูุฏุฑู ูุฐุง ุงูุตููู ูู ุงูุจุงูุช ุจุฃูู ููุฏ ุจุงูุช JVM ุ ุจุชุญูููู ุฅูู ุฑุณู ุจูุงูู Graal.  ูุฐุง ููุน ูู <em>ุงูุชูุณูุฑ ุงููุฌุฑุฏ</em> - <em>ููุณุฑ</em> ุงูุจุงูู ููุฏ Java bytecode ุ ูููู ุจุฏูุงู ูู ุชูุฑูุฑ ุงูููู ุ ูุนุงูุฌ ุงูููุงูุงุช ุงูุญุฑุฉ ููุญูุงู ููุฑุจุทูุง ุจุจุนุถูุง ุงูุจุนุถ ุชุฏุฑูุฌููุง. </p><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ูุณุชููุฏ ูู ุญูููุฉ ุฃู Graal ููุชูุจ ุจูุบุฉ Java ููุฑู ููู ูุนูู ุจุงุณุชุฎุฏุงู ุฃุฏูุงุช ุงูุชููู Eclipse.  ูุญู ูุนูู ุฃู ููุงู ุนูุฏุฉ ุฅุถุงูุฉ ูู ูุซุงููุง ุ ูุฐูู ุฏุนููุง ูุฌุฏ ููุงู ุฅูุดุงุฆูุง. </p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/parser-1.png" alt="Addnode"></p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/parser-2.png" alt="ููุงููุงุช ุจุญุซ AddNode.create"></p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/parser-3.png" alt="ูุญูู"></p><br><p style=";text-align:right;direction:rtl">  ูููู ููุงุญุธุฉ ุฃูู ุชู ุฅูุดุงุคูุง ุจูุงุณุทุฉ ูุญูู <code>IADD</code> ููุฏ ุ ููุฐุง ูุงุฏูุง ุฅูู <code>IADD</code> ูุนุงูุฌุฉ <code>IADD</code> ( <code>96</code> ุ ุงูุฐู ุฑุฃููุงู ูู ุตููู ุงูุฅุฏุฎุงู ุงููุทุจูุน). </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">genArithmeticOp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JavaKind kind, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> opcode)</span></span></span><span class="hljs-function"> </span></span>{ ValueNode y = frameState.pop(kind); ValueNode x = frameState.pop(kind); ValueNode v; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (opcode) { ... <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> LADD: v = genIntegerAdd(x, y); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; ... } frameState.push(kind, append(v)); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุช ุฃุนูุงู ุฅู ูุฐุง ุชูุณูุฑ ูุฌุฑุฏ ุ ูุฃูู  ูู ูุฐุง ูุดุจู ุฅูู ุญุฏ ุจุนูุฏ ูุชุฑุฌู ุงูุดูุฑุฉ ุงูุซุงูููุฉ.  ุฅุฐุง ูุงู ูุชุฑุฌููุง ุญูููููุง ูู JVM ุ ูุณูุฃุฎุฐ ูููุชูู ูู ุงูููุฏุณ ุ ููุคุฏู ุงูุฅุถุงูุฉ ุ ููุนูุฏ ุงููุชูุฌุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ูููู ุจุฅุฒุงูุฉ ุนูุฏุชูู ูู ุงูููุฏุณ ุ ูุงูุชู ุ ุนูุฏ ุจุฏุก ุงูุจุฑูุงูุฌ ุ ุณุชููู ุญุณุงุจุงุช ุ ูุถูู ุ ูุงูุชู ูู ูุชูุฌุฉ ุงูุฌูุน ุ ุนูุฏุฉ ุฌุฏูุฏุฉ ููุฅุถุงูุฉ ุ ููุถุนูุง ุนูู ุงูููุฏุณ. </p><br><p style=";text-align:right;direction:rtl">  ูููุฐุง ุชู ุจูุงุก ุงูุฑุณู ุงูุจูุงูู Graal. </p><br><h3 id="poluchenie-mashinnogo-koda" style=";text-align:right;direction:rtl">  ุงูุญุตูู ุนูู ุฑูุฒ ุงูุฌูุงุฒ </h3><br><p style=";text-align:right;direction:rtl">  ูุชุญููู ุงูุฑุณู ุงูุจูุงูู Graal ุฅูู ุฑูุฒ ุงูุฌูุงุฒ ุ ุชุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุญุฏุงุช ุงูุจุงูุช ููู ุนูุฏู.  ูุชู ุฐูู ุจุดูู ูููุตู ููู ุนูุฏุฉ ุนู ุทุฑูู ุงุณุชุฏุนุงุก ุฃุณููุจ <code>generate</code> ุงูุฎุงุต ุจูุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Generator gen)</span></span></span><span class="hljs-function"> </span></span>{ gen.emitAdd(a, b); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃูุฑุฑ ุ ููุง ูุนูู ุจูุณุชูู ุนุงูู ุฌุฏูุง ูู ุงูุชุฌุฑูุฏ.  ูุฏููุง ูุฆุฉ ูุตุฏุฑ ุจูุง ุชุนูููุงุช ุฑูุฒ ุงูุฌูุงุฒ ุฏูู ุงูุฎูุถ ูู ุชูุงุตูู ููููุฉ ุนูู ุฐูู. </p><br><p style=";text-align:right;direction:rtl">  <code>emitAdd</code>       ,          , ,  ,       .      . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">workload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br><p style=";text-align:right;direction:rtl">       ,        . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">incl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Register dst)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> encode = prefixAndEncode(dst.encoding); emitByte(<span class="hljs-number"><span class="hljs-number">0xFF</span></span>); emitByte(<span class="hljs-number"><span class="hljs-number">0xC0</span></span> | encode); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">emitByte</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b)</span></span></span><span class="hljs-function"> </span></span>{ data.put((<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>) (b &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>)); }</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/incl.png" alt="ุชุนูููุงุช ุงูุชุฌููุน ูู ุงููุฌูุน"></p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/emit-byte.png" alt="ุฅุฎุฑุงุฌ ุงูุจุงูุช"></p><br><p style=";text-align:right;direction:rtl">  ,    ,     <code>ByteBuffer</code> โ    . </p><br><h3 id="vyhodnoy-mashinnyy-kod" style=";text-align:right;direction:rtl">    </h3><br><p style=";text-align:right;direction:rtl">               โ       . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HotSpotGraalCompiler</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JVMCICompiler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">CompilationResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compileHelper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(...)</span></span></span><span class="hljs-function"> </span></span>{ ... System.err.println(method.getName() + <span class="hljs-string"><span class="hljs-string">" machine code: "</span></span> + Arrays.toString(result.getTargetCode())); ... } }</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/machine-code.png" alt="ููุฏ ุขูุฉ ุงูุทุจุงุนุฉ"></p><br><p style=";text-align:right;direction:rtl">           .    HotSpot.     .     OpenJDK, , -,     JVM,      . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> cd openjdk/hotspot/src/share/tools/hsdis <span class="hljs-variable"><span class="hljs-variable">$</span></span> curl <span class="hljs-literal"><span class="hljs-literal">-O</span></span> http://ftp.heanet.ie/mirrors/gnu/binutils/binutils<span class="hljs-literal"><span class="hljs-literal">-2</span></span>.<span class="hljs-number"><span class="hljs-number">24</span></span>.tar.gz <span class="hljs-variable"><span class="hljs-variable">$</span></span> tar <span class="hljs-literal"><span class="hljs-literal">-xzf</span></span> binutils<span class="hljs-literal"><span class="hljs-literal">-2</span></span>.<span class="hljs-number"><span class="hljs-number">24</span></span>.tar.gz <span class="hljs-variable"><span class="hljs-variable">$</span></span> make BINUTILS=binutils<span class="hljs-literal"><span class="hljs-literal">-2</span></span>.<span class="hljs-number"><span class="hljs-number">24</span></span> ARCH=amd64 CFLAGS=<span class="hljs-literal"><span class="hljs-literal">-Wno</span></span><span class="hljs-literal"><span class="hljs-literal">-error</span></span> <span class="hljs-variable"><span class="hljs-variable">$</span></span> cp build/macosx<span class="hljs-literal"><span class="hljs-literal">-amd64</span></span>/hsdis<span class="hljs-literal"><span class="hljs-literal">-amd64</span></span>.dylib ../../../../../..</code> </pre> <br><p style=";text-align:right;direction:rtl">      : <code>-XX:+UnlockDiagnosticVMOptions</code>  <code>-XX:+PrintAssembly</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> java \ -<span class="hljs-literal"><span class="hljs-literal">-module</span></span><span class="hljs-literal"><span class="hljs-literal">-path</span></span>=graal/sdk/mxbuild/modules/org.graalvm.graal_sdk.jar:graal/truffle/mxbuild/modules/com.oracle.truffle.truffle_api.jar \ -<span class="hljs-literal"><span class="hljs-literal">-upgrade</span></span><span class="hljs-literal"><span class="hljs-literal">-module</span></span><span class="hljs-literal"><span class="hljs-literal">-path</span></span>=graal/compiler/mxbuild/modules/jdk.internal.vm.compiler.jar \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:+UnlockExperimentalVMOptions \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:+EnableJVMCI \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:+UseJVMCICompiler \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:<span class="hljs-literal"><span class="hljs-literal">-TieredCompilation</span></span> \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:+PrintCompilation \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:+UnlockDiagnosticVMOptions \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:+PrintAssembly \ <span class="hljs-literal"><span class="hljs-literal">-XX</span></span>:CompileOnly=Demo::workload \ Demo</code> </pre> <br><p style=";text-align:right;direction:rtl">             . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs perl">workload machine code: [<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">68</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, -<span class="hljs-number"><span class="hljs-number">14</span></span>, -<span class="hljs-number"><span class="hljs-number">117</span></span>, -<span class="hljs-number"><span class="hljs-number">58</span></span>, -<span class="hljs-number"><span class="hljs-number">123</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, ...] ... <span class="hljs-number"><span class="hljs-number">0x000000010f71cda0</span></span>: nopl <span class="hljs-number"><span class="hljs-number">0x0</span></span>(%rax,%rax,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">0x000000010f71cda5</span></span>: add %edx,%esi ;\*iadd {reexecute=<span class="hljs-number"><span class="hljs-number">0</span></span> rethrow=<span class="hljs-number"><span class="hljs-number">0</span></span> return_oop=<span class="hljs-number"><span class="hljs-number">0</span></span>} ; - Demo::workload@2 (line <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-number"><span class="hljs-number">0x000000010f71cda7</span></span>: mov %esi,%eax ;\*ireturn {reexecute=<span class="hljs-number"><span class="hljs-number">0</span></span> rethrow=<span class="hljs-number"><span class="hljs-number">0</span></span> return_oop=<span class="hljs-number"><span class="hljs-number">0</span></span>} ; - Demo::workload@3 (line <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-number"><span class="hljs-number">0x000000010f71cda9</span></span>: test %eax,-<span class="hljs-number"><span class="hljs-number">0xcba8da9</span></span>(%rip) <span class="hljs-comment"><span class="hljs-comment"># 0x0000000102b74006 ; {poll_return} 0x000000010f71cdaf: vzeroupper 0x000000010f71cdb2: retq</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> .  ,           .    <code>generate</code>   ,         . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddNode</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(...)</span></span></span><span class="hljs-function"> </span></span>{ ... gen.emitSub(op1, op2, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) ... <span class="hljs-comment"><span class="hljs-comment">// changed from emitAdd } }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/emit-add.png" alt="ุฅุตุฏุงุฑ ุชุนูููุงุช AddNode"></p><br><p style=";text-align:right;direction:rtl">    ,  ,      ,      . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs perl">workload mechine code: [<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">68</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">43</span></span>, -<span class="hljs-number"><span class="hljs-number">14</span></span>, -<span class="hljs-number"><span class="hljs-number">117</span></span>, -<span class="hljs-number"><span class="hljs-number">58</span></span>, -<span class="hljs-number"><span class="hljs-number">123</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, ...] <span class="hljs-number"><span class="hljs-number">0x0000000107f451a0</span></span>: nopl <span class="hljs-number"><span class="hljs-number">0x0</span></span>(%rax,%rax,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">0x0000000107f451a5</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edx</span></span></span><span class="hljs-function">,%</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function"> </span></span>;\*iadd {reexecute=<span class="hljs-number"><span class="hljs-number">0</span></span> rethrow=<span class="hljs-number"><span class="hljs-number">0</span></span> return_oop=<span class="hljs-number"><span class="hljs-number">0</span></span>} ; - Demo::workload@2 (line <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-number"><span class="hljs-number">0x0000000107f451a7</span></span>: mov %esi,%eax ;\*ireturn {reexecute=<span class="hljs-number"><span class="hljs-number">0</span></span> rethrow=<span class="hljs-number"><span class="hljs-number">0</span></span> return_oop=<span class="hljs-number"><span class="hljs-number">0</span></span>} ; - Demo::workload@3 (line <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-number"><span class="hljs-number">0x0000000107f451a9</span></span>: test %eax,-<span class="hljs-number"><span class="hljs-number">0x1db81a9</span></span>(%rip) <span class="hljs-comment"><span class="hljs-comment"># 0x000000010618d006 ; {poll_return} 0x0000000107f451af: vzeroupper 0x0000000107f451b2: retq</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> ,   ? Graal     ;         ;       ;    .  ,       Graal. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">[<span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>, <span class="hljs-number"><span class="hljs-number">96</span></span>, -<span class="hljs-number"><span class="hljs-number">84</span></span>] โ [<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">68</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">43</span></span>, -<span class="hljs-number"><span class="hljs-number">14</span></span>, -<span class="hljs-number"><span class="hljs-number">117</span></span>, -<span class="hljs-number"><span class="hljs-number">58</span></span>, -<span class="hljs-number"><span class="hljs-number">123</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-type"><span class="hljs-type">...</span></span>]</code> </pre> <br><h2 id="optimizaciya" style=";text-align:right;direction:rtl">  </h2><br><p style=";text-align:right;direction:rtl">  ,     ,        .       Graal  ,    . </p><br><p style=";text-align:right;direction:rtl"> <em> </em> โ          .      . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Phase</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Graph graph)</span></span></span></span>; }</code> </pre> <br><h3 id="kanonikalizaciya-canonicalisation" style=";text-align:right;direction:rtl">  (canonicalisation) </h3><br><p style=";text-align:right;direction:rtl"> <em></em>      .       ,       ,      <em> </em> ( <em>constant folding</em> )   . </p><br><p style=";text-align:right;direction:rtl">       โ       <code>canonical</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Node</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">Node </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">canonical</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br><p style=";text-align:right;direction:rtl"> ,  ,    ,      .                  โ    .    <code>-(-x)</code>  <code>x</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NegateNode</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Node</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">Node </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">canonical</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> NegateNode) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((NegateNode) value).getValue(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } } }</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/negate-node.png" alt="findSynonym ูู NegateNode"></p><br><p style=";text-align:right;direction:rtl">       Graal   . ,       . </p><br><p style=";text-align:right;direction:rtl">           Java,       <code>canonical</code> . </p><br><h3 id="global-value-numbering" style=";text-align:right;direction:rtl"> Global value numbering </h3><br><p style=";text-align:right;direction:rtl"> <em>Global value numbering (GVN)</em> โ       .    <code>a + b</code>    ,   โ . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">workload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a + b) * (a + b); }</code> </pre> <br><p style=";text-align:right;direction:rtl"> Graal     .   โ        .   GVN         .        <em>hash map</em>  ,  ,  . </p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/gvn.png" alt="ุชุฑููู ุงููููุฉ ุงูุนุงูููุฉ"></p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/gvn-igv-1.png" alt="ุงูุฑุณู ุงูุจูุงูู ูุชุฑููู ุงููููุฉ ุงูุนุงูููุฉ"></p><br><p style=";text-align:right;direction:rtl">    ,   <em></em> โ  ,      ,     -  .  ,  ,  ,       ,      โ . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">workload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (getA() + getB()) * (getA() + getB()); }</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/gvn-igv-2.png" alt="ุฑุณู ุจูุงูู ูุง ูููู ุชุฑููู ุงููููุฉ ุงูุนุงูููุฉ"></p><br><h3 id="ukrupnenie-blokirovok-lock-coarsening" style=";text-align:right;direction:rtl">   (lock coarsening) </h3><br><p style=";text-align:right;direction:rtl">     .               <em></em> . ,     ,      ,   <em></em> ( <em>inlining</em> ). </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">workload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span> (monitor) { counter++; } <span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span> (monitor) { counter++; } }</code> </pre> <br><p style=";text-align:right;direction:rtl">   ,   , , , . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">workload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ monitor.enter(); counter++; monitor.exit(); monitor.enter(); counter++; monitor.exit(); }</code> </pre> <br><p style=";text-align:right;direction:rtl">                    .    <em> </em> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">workload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ monitor.enter(); counter++; counter++; monitor.exit(); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  Graal       <code>LockEliminationPhase</code> .   <code>run</code>      ,         .  ,        ,           . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(StructuredGraph graph)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (monitorExitNode monitorExitNode : graph.getNodes(MonitorExitNode.class)) { FixedNode next = monitorExitNode.next(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (next <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> monitorEnterNode) { AccessmonitorNode monitorEnterNode = (AccessmonitorNode) next; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (monitorEnterNode.object() ## monitorExitNode.object()) { monitorExitNode.remove(); monitorEnterNode.remove(); } } } }</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/lock-elimination.png" alt="ุชุจุณูุท ุงูููู"></p><br><p style=";text-align:right;direction:rtl">            , , ,      ,          <code>2</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">workload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ monitor.enter(); counter += <span class="hljs-number"><span class="hljs-number">2</span></span>; monitor.exit(); }</code> </pre> <br><p style=";text-align:right;direction:rtl">    IGV   .  ,   ,       \   ,  , ,        <code>2</code> . </p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/lock-elimination-before.png" alt="ุชุจุณูุท ุงูุฃููุงู"></p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/lock-elimination-after.png" alt="ุชุจุณูุท ุงูุฃููุงู ุจุนุฏ"></p><br><h2 id="ne-zatronutye-prakticheskie-aspekty" style=";text-align:right;direction:rtl">     </h2><br><p style=";text-align:right;direction:rtl">   Graal   ,  ,      ,          . , , ,          . </p><br><p style=";text-align:right;direction:rtl">       Graal   ,  , ,         ,    ,  ,    . </p><br><h3 id="naznachenie-registrov" style=";text-align:right;direction:rtl">   </h3><br><p style=";text-align:right;direction:rtl">    Graal      ,   ,  .        ?          ,      ? </p><br><p style=";text-align:right;direction:rtl"> ,  ,    .      .       ,      , ,   ,    .        ,  ,  ,             , ,  . </p><br><p style=";text-align:right;direction:rtl">        <em> </em> ( <em>register allocation</em> ). Graal ,    JIT-,    โ <em>  </em> ( <em>linear scan algorithm</em> ). </p><br><h3 id="dispetcherizaciya" style=";text-align:right;direction:rtl">  </h3><br><p style=";text-align:right;direction:rtl">    ,     ,   ,        -    ,         . </p><br><p style=";text-align:right;direction:rtl"> ,       ,   , ,         (..     ),        . ,    ,     . </p><br><p style=";text-align:right;direction:rtl">    <em> </em> ( <em>graph scheduling</em> ).       .       ,          .       ,      , ,        . </p><br><p style=";text-align:right;direction:rtl">                ,     . </p><br><h2 id="v-kakih-sluchayah-ispolzovat-graal" style=";text-align:right;direction:rtl">     Graal? </h2><br><p style=";text-align:right;direction:rtl">        , ,   , Graal โ   ,       <em>Oracle</em> .      ,    Graal? </p><br><h3 id="kompilyator-nizhnego-urovnya-final-tier-compiler" style=";text-align:right;direction:rtl">    (final-tier compiler) </h3><br><p style=";text-align:right;direction:rtl"> C  JVMCI Graal    <em>  </em>  HotSpot โ ,     .     (   HotSpot)   Graal    ,    . </p><br><p style=";text-align:right;direction:rtl"> <em>Twitter</em>       Graal   ,    Java 9           .       : <code>-XX:+UseJVMCICompiler</code>  . </p><br><p style=";text-align:right;direction:rtl">    JVMCI   ,      Graal   JVM.    (deploy) -  JVM,      Graal.      Java-,   Graal,       JVM. </p><br><p style=";text-align:right;direction:rtl">  OpenJDK   <em>Metropolis</em>       JVM   Java. Graal        . </p><br><p style=";text-align:right;direction:rtl"><img src="https://chrisseaton.com/truffleruby/jokerconf17/metropolis.png" alt="ูุดุฑูุน ูุชุฑูุจูููุณ"></p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">http://cr.openjdk.java.net/\~jrose/metropolis/Metropolis-Proposal.html</a> </p><br><h3 id="polzovatelskie-optimizacii" style=";text-align:right;direction:rtl">   </h3><br><p style=";text-align:right;direction:rtl"> Graal    .    Graal   JVM,     Graal   .           ,  Graal       . ,     -     ,    ,                 JNI. </p><br><p style=";text-align:right;direction:rtl"> Charles Nutter      <em>JRuby</em>         Graal       Ruby. ,        - . </p><br><h3 id="aot-ahead-of-time-kompilyaciya" style=";text-align:right;direction:rtl"> AOT (ahead-of-time)  </h3><br><p style=";text-align:right;direction:rtl"> Graal โ    Java. JVMCI  ,  Graal,    ,     ,    Graal     .  ,     Graal    ,     JIT-. </p><br><p style=";text-align:right;direction:rtl">     JIT-  AOT-      ,  Graal     .       AOT   Graal. </p><br><p style=";text-align:right;direction:rtl"> Java 9              JIT-,     .        JVM,          . </p><br><p style=";text-align:right;direction:rtl"> AOT Java 9     Graal,       Linux.            ,  ,            . </p><br><p style=";text-align:right;direction:rtl">    . <em>SubstrateVM</em> โ  AOT-,   Java-    JVM  . ,     - (statically linked)  .    JVM  ,         .     SubstrateVM  Graal.          ( <em>just-in-time</em> ) SubstrateVM, ,   Graal  .   Graal AOT-  . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> javac Hello.java <span class="hljs-variable"><span class="hljs-variable">$</span></span> graalvm<span class="hljs-literal"><span class="hljs-literal">-0</span></span>.<span class="hljs-number"><span class="hljs-number">28.2</span></span>/bin/native<span class="hljs-literal"><span class="hljs-literal">-image</span></span> Hello classlist: <span class="hljs-number"><span class="hljs-number">966.44</span></span> ms (cap): <span class="hljs-number"><span class="hljs-number">804.46</span></span> ms setup: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">514.31</span></span> ms (typeflow): <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">580.70</span></span> ms (objects): <span class="hljs-number"><span class="hljs-number">719.04</span></span> ms (features): <span class="hljs-number"><span class="hljs-number">16.27</span></span> ms analysis: <span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">422.58</span></span> ms universe: <span class="hljs-number"><span class="hljs-number">262.09</span></span> ms (parse): <span class="hljs-number"><span class="hljs-number">528.44</span></span> ms (inline): <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">259.94</span></span> ms (compile): <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">716.20</span></span> ms compile: <span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">817.97</span></span> ms image: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">070.29</span></span> ms debuginfo: <span class="hljs-number"><span class="hljs-number">672.64</span></span> ms write: <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">797.45</span></span> ms [<span class="hljs-type"><span class="hljs-type">total</span></span>]: <span class="hljs-number"><span class="hljs-number">17</span></span>,<span class="hljs-number"><span class="hljs-number">907.56</span></span> ms <span class="hljs-variable"><span class="hljs-variable">$</span></span> ls <span class="hljs-literal"><span class="hljs-literal">-lh</span></span> hello <span class="hljs-literal"><span class="hljs-literal">-rwxr</span></span><span class="hljs-literal"><span class="hljs-literal">-xr</span></span><span class="hljs-literal"><span class="hljs-literal">-x</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> chrisseaton staff <span class="hljs-number"><span class="hljs-number">6.6</span></span>M <span class="hljs-number"><span class="hljs-number">4</span></span> Oct <span class="hljs-number"><span class="hljs-number">18</span></span>:<span class="hljs-number"><span class="hljs-number">35</span></span> hello <span class="hljs-variable"><span class="hljs-variable">$</span></span> file ./hello ./hellojava: Mach<span class="hljs-literal"><span class="hljs-literal">-O</span></span> <span class="hljs-number"><span class="hljs-number">64</span></span><span class="hljs-literal"><span class="hljs-literal">-bit</span></span> executable x86_64 <span class="hljs-variable"><span class="hljs-variable">$</span></span> time ./hello Hello! real <span class="hljs-number"><span class="hljs-number">0</span></span>m0.<span class="hljs-number"><span class="hljs-number">010</span></span>s user <span class="hljs-number"><span class="hljs-number">0</span></span>m0.<span class="hljs-number"><span class="hljs-number">003</span></span>s sys <span class="hljs-number"><span class="hljs-number">0</span></span>m0.<span class="hljs-number"><span class="hljs-number">003</span></span>s</code> </pre> <br><h3 id="truffle" style=";text-align:right;direction:rtl"> Truffle </h3><br><p style=";text-align:right;direction:rtl">     Graal      <em>Truffle</em> . Truffle โ         JVM. </p><br><p style=";text-align:right;direction:rtl">  ,   JVM,  ,   JIT-   (,    ,   ,  JIT- JVM    ,        ). Truffle    โ       ,   ,  Truffle, ,              <em> </em> ( <em>partial evaluation</em> ). </p><br><p style=";text-align:right;direction:rtl">         ,             <em> </em> ( <em>inlining</em> )  <em> </em> ( <em>constant folding</em> )      . Graal       ,  Truffle       . </p><br><p style=";text-align:right;direction:rtl">       Graal โ  Truffle.       Ruby,   <em>TruffleRuby</em>    Truffle , , Graal. TruffleRuby โ     Ruby,   10   , ,  ,        . </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://github.com/graalvm/truffleruby</a> </p><br><h2 id="vyvody" style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌุงุช </h2><br><p style=";text-align:right;direction:rtl">  ,      ,   ,   JIT- Java         . JIT-   ,          , , -           . ,  ,   .   JIT-    ,   <code>byte[]</code>  JVM  <code>byte[]</code>  . </p><br><p style=";text-align:right;direction:rtl">  ,       Java.           ,   C++. </p><br><p style=";text-align:right;direction:rtl"> Java- Graal   - .   ,    ,            . </p><br><p style=";text-align:right;direction:rtl">          .        ,        Eclipse     .           (definitions),     ..    . </p><br><p style=";text-align:right;direction:rtl">          JIT      JIT- JVM,   <em>JITWatch</em> ,   ,        Graal     ,   . ,   ,  -       ,     Graal     JVM.         IDE,       <em>hello-world</em> . </p><br><p style=";text-align:right;direction:rtl">         SubstrateVM  Truffle,   Graal,     ,     Java  .     ,   Graal    Java.  ,    ,   -  <em>LLVM</em> ,    , ,   ,     . </p><br><p style=";text-align:right;direction:rtl"> , ,       Graal      JVM.  ูุฃู JVMCI   Java 9, Graal      ,  ,    Java-. </p><br><p style=";text-align:right;direction:rtl"> Graal โ        .    ,      Graal.    ,      ! </p><br><hr><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">More information about TruffleRuby</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Low Overhead Polling For Ruby</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Top 10 Things To Do With GraalVM</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ruby Objects as C Structs and Vice Versa</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Understanding How Graal Works โ a Java JIT Compiler Written in Java</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Flip-Flops โ the 1-in-10-million operator</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Deoptimizing Ruby</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Very High Performance C Extensions For JRuby+Truffle</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Optimising Small Data Structures in JRuby+Truffle</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Pushing Pixels with JRuby+Truffle</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Tracing With Zero Overhead in JRuby+Truffle</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">How Method Dispatch Works in JRuby+Truffle</a> </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">A Truffle/Graal High Performance Backend for JRuby</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar419637/">https://habr.com/ru/post/ar419637/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar419623/index.html">"SHE": ููู ุชูุตููุง ุฅูู ุตูุฑ ููุฐูุงุก ุงูุงุตุทูุงุนู</a></li>
<li><a href="../ar419625/index.html">ูุธุฑุฉ ุนุงูุฉ ุนูู ููุฒุงุช PHP7 ุงูููุถูุฉ</a></li>
<li><a href="../ar419627/index.html">ูุญู ูุจุญุซ ุนู ูุชุญุฏุซูู ูู ููุณูู ูุนููู ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ</a></li>
<li><a href="../ar419633/index.html">ุงูุขู ุฌููุน ููุงุฆู ุงูุดูุงุฏุงุช ุงูุฌุฐุฑูุฉ ุงูุฑุฆูุณูุฉ ููุซูู ุจูุง ูู ููุจู Let's Encrypt</a></li>
<li><a href="../ar419635/index.html">ุฅุตุฏุงุฑ ุงูุฅุตุฏุงุฑ ุงูุซุงุจุช ูู Dart 2.0 ู Dart Web Platform</a></li>
<li><a href="../ar419641/index.html">ุฅูุดุงุก ุจุณูุท C # AI ูู ุงููุญุฏุฉ</a></li>
<li><a href="../ar419643/index.html">ูุคุชูุฑ ููุฏุณุฉ ุงูุจุฑูุฌูุงุช ูููุณู EPAM: ุงุฌุนููุง ุญููููุฉ</a></li>
<li><a href="../ar419647/index.html">ูุฏูุฉ "ุงูุฌูุนุฉ ุงูุณูุฏุงุก ูู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ. ุฃุณุฑุงุฑ ุงูุจูุงุก ุ 16 ุฃุบุณุทุณ ุ ููุณูู</a></li>
<li><a href="../ar419649/index.html">ููููุงู ุนู ุงููุทุท ุ ุฃู CAT ุงูุชู ุงุฎุชุฑูุงูุง ููุฒุงููุฉ ุงูุจูุฏูุงุณุช</a></li>
<li><a href="../ar419651/index.html">ูุง GA ููุง YM. ููู ุตูุนูุง ููุฑุงุชูุง ุงูุฎุงุตุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>