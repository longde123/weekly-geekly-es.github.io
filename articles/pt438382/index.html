<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïö üàÅ üéÄ Organiza√ß√£o de uma pesquisa em uma p√°gina da Web em JavaScript (sem jQuery) ü§º üå¶Ô∏è üë©‚Äçüíº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="H√° alguns dias, recebi uma tarefa de teste da empresa para a vaga Front-end dev. Obviamente, a tarefa consistiu em v√°rios pontos. Mas agora vamos nos ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Organiza√ß√£o de uma pesquisa em uma p√°gina da Web em JavaScript (sem jQuery)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438382/">  H√° alguns dias, recebi uma tarefa de teste da empresa para a vaga Front-end dev.  Obviamente, a tarefa consistiu em v√°rios pontos.  Mas agora vamos nos concentrar apenas em um deles - a organiza√ß√£o da pesquisa na p√°gina.  I.e.  busca banal pelo texto digitado no campo (an√°logo de Ctrl + F no navegador).  A peculiaridade da atribui√ß√£o era que o uso de qualquer estrutura ou biblioteca JS √© proibido.  <strong>Todos escrevem em JavaScript nativo nativo</strong> . <br><br>  <i>(Para maior clareza, continuarei acompanhando o artigo inteiro com capturas de tela e c√≥digo, para que voc√™ e eu entendamos do que estou falando em um determinado momento)</i> <br><a name="habracut"></a><br><h2>  Encontrando uma solu√ß√£o </h2><br>  Primeiro pensamento: algu√©m j√° escreveu exatamente isso, √© preciso pesquisar no Google e copiar e colar.  Ent√£o eu fiz.  Em uma hora, encontrei dois bons roteiros que essencialmente funcionavam da mesma maneira, mas eram escritos de maneira diferente.  Eu escolhi aquele cujo c√≥digo eu entendi melhor e inseri na p√°gina do meu velho. <br><br>  <i>Se algu√©m estiver interessado, peguei o c√≥digo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .</i> <br><br>  O script funcionou imediatamente.  Eu pensei que o problema estava resolvido, mas, como se viu, sem ofensa ao autor do script, havia uma enorme falha nele.  O script pesquisou todo o conte√∫do da tag <code>...</code> e, como voc√™ provavelmente j√° adivinhou, ao procurar qualquer combina√ß√£o de caracteres que se assemelhem a uma tag ou seus atributos, a p√°gina HTML inteira √© quebrada. <br><br><h2>  Por que o script n√£o funcionou corretamente? </h2><br>  Tudo √© simples.  O script funciona da seguinte maneira.  Primeiro, escrevemos todo o conte√∫do da tag <strong>body</strong> em uma vari√°vel, depois procuramos correspond√™ncias com a express√£o regular (o usu√°rio a define ao entrar no campo de texto) e, em seguida, substitu√≠mos todas as correspond√™ncias pelo seguinte c√≥digo: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"background-color: yellow;"</span></span></span><span class="hljs-tag">&gt;</span></span>... ...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  E ent√£o substitu√≠mos a etiqueta do <strong>corpo</strong> atual pela nova recebida.  A marca√ß√£o √© atualizada, os estilos mudam e todos os resultados encontrados s√£o destacados em amarelo na tela. <br><br>  Voc√™ provavelmente j√° entendeu qual √© o problema, mas, no entanto, explicarei com mais detalhes.  Imagine digitar a palavra <strong>"div"</strong> na caixa de pesquisa.  Como voc√™ entende, dentro do <strong>corpo</strong> existem muitas outras tags, incluindo <strong>div</strong> .  E se todos aplicarmos os estilos mencionados acima ao <strong>‚Äúdiv‚Äù</strong> , isso n√£o ser√° um bloco, mas n√£o est√° claro o que, uma vez que o design √© interrompido.  Como resultado, ap√≥s a substitui√ß√£o da marca√ß√£o, obtemos uma p√°gina da Web completamente quebrada.  Parece assim. <br><br>  Foi antes da pesquisa: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="http://saveimg.ru/thumbnails/30-04-16/b43ea456d1d7d278464d613f7eec8630.png" alt="fazer upload de fotos para a Internet"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Desaparecer completamente</a> <br>  Tornou-se ap√≥s a pesquisa: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="http://saveimg.ru/thumbnails/30-04-16/4fcd7c7461510c748fc002a616883b14.png" alt="fazer upload de fotos de gra√ßa"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Desaparecer completamente</a> <br><br>  Como voc√™ pode ver, a p√°gina √© completamente quebrada.  Em resumo, o script acabou sendo inoperante, e eu decidi escrever o meu do zero, e √© disso que trata este artigo. <br><br><h1>  Ent√£o escrevemos um script do zero </h1><br>  Como tudo parece para mim. <br><br><img src="https://habrastorage.org/files/e63/fe9/3f0/e63fe93f07ad4fe59872d26a0fc93e2d.png"><br><br>  Agora estamos interessados ‚Äã‚Äãno formul√°rio de pesquisa.  Ele a circulou com uma linha vermelha. <br><br>  Vamos dar uma olhada.  Eu implementei isso da seguinte forma (at√© agora, HTML puro).  Um formul√°rio com tr√™s tags. <br><br>  <strong>O primeiro</strong> √© para inserir texto; <br>  <strong>O segundo</strong> - para cancelar a pesquisa (desmarque); <br>  <strong>O terceiro</strong> √© para pesquisar (destaque os resultados encontrados). <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autofocus</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Portanto, temos um campo de entrada e 2 bot√µes.  Vou escrever JavaScript no js.js.  Suponha que voc√™ j√° tenha criado e conectado. <br><br>  A primeira coisa que faremos: registrar as chamadas de fun√ß√£o quando voc√™ clicar no bot√£o de pesquisa e no bot√£o Cancelar.  Ficar√° assim: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"place_for_search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text-to-find"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autofocus</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button_for_turn_back"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript: FindOnPage('text-to-find',false); return false;"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button_for_search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript: FindOnPage('text-to-find',true); return false;"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Vamos explicar um pouco o que est√° aqui e por qu√™. <br><br>  N√≥s fornecemos o campo de texto <strong>id = "texto para encontrar"</strong> ( <i>esse id se refere ao elemento de js</i> ). <br><br>  <strong>Atribu√≠mos</strong> ao <strong>bot√£o</strong> cancelar <strong>os</strong> seguintes atributos: <strong>type = "button" onclick = "javascript: FindOnPage ('text-to-find', false);</strong>  <strong>retornar falso; "</strong> <br><br>  - <i>Tipo: bot√£o</i> <br>  - <i>Quando pressionada, a fun√ß√£o FindOnPage √© chamada ('text-to-find', false);</i>  <i>e passa o ID do campo com o texto <strong>false</strong></i> <br><br>  <strong>Atribu√≠mos</strong> ao <strong>bot√£o de</strong> pesquisa <strong>os</strong> seguintes atributos: <strong>type = "button" onclick = "javascript: FindOnPage ('text-to-find', true);</strong>  <strong>retornar falso; "</strong> <br><br>  - <i>Tipo: enviar (n√£o um bot√£o, porque aqui voc√™ pode usar Enter depois de inserir o campo ou tamb√©m pode usar o bot√£o)</i> <br>  - <i>Quando pressionada, a fun√ß√£o FindOnPage √© chamada ('text-to-find', true);</i>  <i>e passa o ID do campo com o texto <strong>true</strong></i> <br><br>  Voc√™ provavelmente notou mais um atributo: <strong><i>verdadeiro / falso</i></strong> .  Vamos us√°-lo para determinar qual bot√£o foi pressionado (cancelar a pesquisa ou iniciar a pesquisa).  Se clicarmos em cancelar, passe <strong>falso</strong> .  Se clicarmos na pesquisa, ent√£o passe <strong>true</strong> . <br><br><h4>  OK, siga em frente.  Ir para JavaScript </h4><h4>  Assumimos que voc√™ j√° criou e conectou o arquivo js ao DOM. <br><br>  Antes de come√ßarmos a escrever o c√≥digo, vamos fazer uma pausa e primeiro discutir como tudo deve funcionar.  I.e.  em ess√™ncia, escreveremos um plano de a√ß√£o.  Portanto, precisamos que, ao inserir texto no campo, seja realizada uma pesquisa na p√°gina, mas as tags e atributos n√£o devem ser afetados.  I.e.  apenas objetos de texto.  Como conseguir isso - tenho certeza de que h√° muitas maneiras.  Mas agora vamos usar express√µes regulares. <br><br>  Portanto, a pr√≥xima express√£o regular procurar√° apenas o rastreamento de texto.  tipo: "&gt; ... texto ... &lt;".  I.e.  somente os objetos de texto ser√£o pesquisados, enquanto as tags e atributos permanecer√£o intocados. <br><br><pre> <code class="javascript hljs">/&gt;(.*?)&lt;<span class="hljs-regexp"><span class="hljs-regexp">/g</span></span></code> </pre><br>  Portanto, encontraremos as partes necess√°rias do c√≥digo que analisaremos e procuraremos correspond√™ncias com o texto digitado pelo usu√°rio.  Em seguida, adicionaremos estilos aos objetos encontrados e depois substituiremos o c√≥digo html por um novo. <br><br>  Vamos come√ßar.  Primeiro, as vari√°veis ‚Äã‚Äãque precisamos. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; <span class="hljs-comment"><span class="hljs-comment">//input -  ,    //search -      //pr -     &lt;body&gt;&lt;/body&gt; //result -    pr (..    ) //result_arr -  pr,      //locale_HTML -  &lt;body&gt;&lt;/body&gt;    ,    </span></span></code> </pre><br>  E determine imediatamente o valor <strong>locale_HTML</strong> , independentemente de estarmos procurando algo ou n√£o.  Isso √© necess√°rio para salvar imediatamente a p√°gina original e ter a capacidade de redefinir os estilos. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; locale_HTML = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML; <span class="hljs-comment"><span class="hljs-comment">//     body ()</span></span></code> </pre><br>  Ok, agora vale a pena criar uma fun√ß√£o chamada do <strong>DOM</strong> .  Estime imediatamente que dentro devemos ter 2 fun√ß√µes, cada uma das quais funciona dependendo do bot√£o pressionado.  Afinal, realizamos uma pesquisa ou a zeramos.  E isso √© controlado pelo atributo <strong>verdadeiro / falso</strong> , como voc√™ se lembra.  Voc√™ tamb√©m precisa entender que, quando pesquisar novamente, os estilos antigos devem ser redefinidos.  Assim, temos o seguinte: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; locale_HTML = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML; <span class="hljs-comment"><span class="hljs-comment">//     body () function FindOnPage(name, status) { if(status) { FindOnPageBack(); FindOnPageGo(); } //     if(!status) { FindOnPageBack(); } //  }</span></span></code> </pre><br>  Ok, parte da l√≥gica √© implementada, siga em frente.  √â necess√°rio verificar a palavra recebida para o n√∫mero de caracteres.  Afinal, por que precisamos procurar uma letra / s√≠mbolo.  Em geral, decidi limitar isso a mais de 3 caracteres. <br><br>  Portanto, primeiro pegamos o valor digitado pelo usu√°rio e, dependendo do seu comprimento, executamos a fun√ß√£o principal de pesquisa ou a fun√ß√£o de aviso e zeragem.  Ficar√° assim: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; locale_HTML = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML; <span class="hljs-comment"><span class="hljs-comment">//     body () function FindOnPage(name, status) { input = document.getElementById(name).value; //     html if(input.length&lt;3&amp;&amp;status==true) { alert('        '); function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  } if(input.length&gt;=3) { //  } function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  if(status) { FindOnPageBack(); FindOnPageGo(); } //     if(!status) { FindOnPageBack(); } //  }</span></span></code> </pre><br>  Agora vou explicar esta se√ß√£o do c√≥digo.  A √∫nica coisa que n√£o podia ser clara √© esta linha: <br><br>  <i>fun√ß√£o FindOnPageBack () {document.body.innerHTML = locale_HTML;</i>  <i>}</i> <br><br>  Tudo √© simples aqui: o m√©todo <strong>innerHTML</strong> retorna o c√≥digo <strong>html</strong> do objeto.  Nesse caso, simplesmente substitu√≠mos o <strong>corpo</strong> atual pelo original que salvamos ao carregar a p√°gina inteira. <br><br>  N√≥s seguimos em frente.  Damos valores √†s principais vari√°veis. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; locale_HTML = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML; <span class="hljs-comment"><span class="hljs-comment">//     body () function FindOnPage(name, status) { input = document.getElementById(name).value; //     html if(input.length&lt;3&amp;&amp;status==true) { alert('        '); function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  } if(input.length&gt;=3) { function FindOnPageGo() { search = '/'+input+'/g'; //     pr = document.body.innerHTML; //     body result = pr.match(/&gt;(.*?)&lt;/g); //       result_arr = []; //       () } } function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  if(status) { FindOnPageBack(); FindOnPageGo(); } //     if(!status) { FindOnPageBack(); } //  }</span></span></code> </pre><br>  Ent√£o, nesta fase, j√° temos as principais vari√°veis ‚Äã‚Äãe valores.  Agora precisamos fornecer as partes necess√°rias dos estilos de c√≥digo com um plano de fundo destacado.  I.e.  verificar o texto selecionado para uma express√£o regular (de fato, o texto selecionado pela express√£o regular √© analisado pela express√£o regular novamente).  Para fazer isso, voc√™ precisa criar uma express√£o regular a partir do texto digitado (pronto) e, em seguida, executar o m√©todo passado como um tato.  Aqui o m√©todo <strong>eval ()</strong> nos ajudar√°. <br><br>  Em geral, depois de substituir o texto e obter o resultado com estilos, precisamos substituir o <strong>html</strong> atual pelo recebido.  N√≥s fazemos isso. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; locale_HTML = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML; <span class="hljs-comment"><span class="hljs-comment">//     body () function FindOnPage(name, status) { input = document.getElementById(name).value; //     html if(input.length&lt;3&amp;&amp;status==true) { alert('        '); function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  } if(input.length&gt;=3) { function FindOnPageGo() { search = '/'+input+'/g'; //     pr = document.body.innerHTML; //     body result = pr.match(/&gt;(.*?)&lt;/g); //       result_arr = []; //       () for(var i=0; i&lt;result.length;i++) { result_arr[i] = result[i].replace(eval(search), '&lt;span style="background-color:yellow;"&gt;'+input+'&lt;/span&gt;'); //  ,        } for(var i=0; i&lt;result.length;i++) { pr=pr.replace(result[i],result_arr[i]) //    html       } document.body.innerHTML = pr; // html  } } function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  if(status) { FindOnPageBack(); FindOnPageGo(); } //     if(!status) { FindOnPageBack(); } //  }</span></span></code> </pre><br>  Em ess√™ncia, tudo est√° pronto, e o script j√° est√° funcionando.  Mas adicione mais alguns detalhes para a beleza. <br><br>  1) Apare os espa√ßos no texto que o usu√°rio digita.  Insira este c√≥digo: <br><br><pre> <code class="javascript hljs"> input = numer.replace(<span class="hljs-regexp"><span class="hljs-regexp">/^\s+/g</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>); input = numer.replace(<span class="hljs-regexp"><span class="hljs-regexp">/[ ]{1,}/g</span></span>,<span class="hljs-string"><span class="hljs-string">' '</span></span>);</code> </pre><br>  Ap√≥s esta linha: <br><br><pre> <code class="javascript hljs"> input = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(name).value; <span class="hljs-comment"><span class="hljs-comment">//     html</span></span></code> </pre><br>  2) Verificaremos coincid√™ncias (se nenhuma correspond√™ncia for encontrada, informaremos sobre isso).  Este c√≥digo √© inserido na fun√ß√£o FindOnPageGo () ap√≥s vari√°veis. <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> warning = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;result.length;i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(result[i].match(<span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(search))!=<span class="hljs-literal"><span class="hljs-literal">null</span></span>) { warning = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(warning == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { alert(<span class="hljs-string"><span class="hljs-string">'    '</span></span>); }</code> </pre><br>  Voc√™ pode ver a fonte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br>  Voc√™ pode baixar a fonte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  Agora tudo.  Obviamente, voc√™ pode adicionar um pergaminho ao primeiro resultado encontrado, uma pesquisa ao ajax ao vivo e, de fato, pode melhorar infinitamente.  Agora, esta √© uma pesquisa bastante primitiva no site.  O objetivo do artigo era ajudar os iniciantes se surgir a mesma pergunta que a minha.  Afinal, n√£o encontrei uma solu√ß√£o simples e pronta. <br><br>  PS: para uma opera√ß√£o correta, √© necess√°rio remover a hifeniza√ß√£o do texto no documento html nos locais em que houver texto sem formata√ß√£o entre as tags. <br><br>  Por exemplo, em vez de <br><br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Deve <br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Isso n√£o √© importante, voc√™ pode se livrar dessas transfer√™ncias automaticamente no servi√ßo, mas pode me dizer ao mesmo tempo como corrigi-lo, se entender antes de mim. <br><br>  Al√©m disso, se algu√©m escreveu isso, mas com uma pesquisa ao vivo, compartilhe a fonte, ser√° interessante analisar. <br><br>  Ficarei feliz em ouvir cr√≠ticas construtivas, opini√µes e talvez recomenda√ß√µes. <br><br>  Recentemente eu adicionei um pequeno c√≥digo, fiz uma pesquisa ao vivo na p√°gina.  Para que a quest√£o seja esclarecida.  <strong>O</strong> c√≥digo <strong>HTML</strong> n√£o foi alterado.  <strong>JS</strong> pode procurar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  A pesquisa √© realizada usando tags com a classe "place_for_live_search".  Portanto, para que o algoritmo analise o conte√∫do desejado, adicione a classe e pronto. </h4></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt438382/">https://habr.com/ru/post/pt438382/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt438370/index.html">Cibercrime como servi√ßo: servi√ßos e pre√ßos</a></li>
<li><a href="../pt438372/index.html">NASA continua tentando entrar em contato com a oportunidade</a></li>
<li><a href="../pt438374/index.html">Como carregar o OpenStreetMap no Hive?</a></li>
<li><a href="../pt438376/index.html">Engenharia reversa. A hist√≥ria Mina</a></li>
<li><a href="../pt438380/index.html">Masculino, pausa nas exce√ß√µes capturadas</a></li>
<li><a href="../pt438384/index.html">Li√ß√£o de qu√≠mica: como expor o cristal de um microchip para fotografia</a></li>
<li><a href="../pt438386/index.html">A caminho dos princ√≠pios f√≠sicos da evolu√ß√£o biol√≥gica</a></li>
<li><a href="../pt438388/index.html">Servidor de mensagens push</a></li>
<li><a href="../pt438390/index.html">Por que os desenvolvedores s√£o mais caros que o dinheiro, como salv√°-los e aument√°-los</a></li>
<li><a href="../pt438392/index.html">Uma breve hist√≥ria de uma "fita inteligente"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>