<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♠️ 🔯 🗻 解析或自己动手做DOM的艺术 🤛🏼 🛠️ ❗️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="哈Ha！ 最近，我想到了创建一种简单的标记语言（如markdown）的想法，该语言非常适合我的任务，即快速编写具有格式的讲义以及仅使用一个键盘即可“即时”插入数学公式的功能。 要将以这种格式编写的文本转换成更易于理解的形式（例如LibreOffice Writer文档），您需要一个解析器 ，换句话说...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>解析或自己动手做DOM的艺术</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442964/">哈Ha！ 最近，我想到了创建一种简单的标记语言（如markdown）的想法，该语言非常适合我的任务，即快速编写具有格式的讲义以及仅使用一个键盘即可“即时”插入数学公式的功能。 要将以这种格式编写的文本转换成更易于理解的形式（例如LibreOffice Writer文档），您需要<i>一个解析器</i> ，换句话说就是<i>解析器</i> 。 由于我以前经常骑自行车，所以我去搜索引擎查询“解析器示例”，“ html转换为DOM”，“如何解析html”等。令我失望的是，在所有找到的资源上，要么是基本示例（例如带有递归的Straustrup计算器）或使用现成的解决方案，例如flex，bison，llvm和yacc。 还有更多的库用于解析严格定义的语言（gumbo，jsoup，rapidjson，Qt工具等）。我都不打算仅使用标准库来用C ++编写自己的标记解析器，而是我的计划的一部分。技术学院的手册代替了电子资源，而成为了解析技术知识的来源。 关于如何获取文本并从其构建AST（抽象语法树），关于我在此过程中遇到的一些陷阱，我将告诉您今天可能出现的错误。 <br><br> 我将立即进行保留-如果您的目标是使用自己的脚本语言甚至更复杂，那么本文不足以实现。 理想情况下，您需要完全了解自动机和离散结构的理论。 但暂时，我只能将自己的经验限制在自己的经验上，我会慷慨地分享自己的经验。 这与我最初的意图不完全相同，但是它是一个理想的示例。 我们将把HTML解析为一种简单而熟悉的语言。 <br><a name="habracut"></a><br> 首先，解析不是将文本转换为对象模型的完整过程的同义词。 该过程本身包括两个阶段： <br><br><ol><li>  <b>对</b>文本进行标记的<b>词法分析</b>只是其中的一小部分，具有一定的句法含义。 </li><li>  <b>解析</b>是根据令牌的<i>抽象语法树</i> （AST-抽象语法树）或<i>文档对象模型</i> （DOM-文档对象模型）的值来构造令牌。 </li></ol><br> 但是让我们按顺序进行。 在打开您喜欢的IDE并编写代码之前，您需要开发一种未来语言的语法。 在正式的无上下文语法中，最著名的是<i>Backus-Naur（BNF）</i> <i>形式</i>和<i>扩展的Backus-Naur形式</i> 。 我利用了它们的共生，同时兼顾了两种形式。 可以通过其他表达式定义任何表达式，如下所示： <br><br><pre><code class="plaintext hljs">&lt;&gt; = &lt;_1&gt; &lt;_&gt; &lt;_2&gt;</code> </pre> <br> 在这里，一个表达式是通过三个其他表达式接一个定义的。 反过来，它们也必须通过“第三”表达式等表示。 <br><br> 什么时候停止？ <br><br> 形式语法中任何语言的语法描述都包含两种类型的标记： <i>terminal</i>和<i>non-terminals</i> 。  <b>非终结符</b>是需要定义以下内容的表达式： <br><br><pre> <code class="plaintext hljs">&lt;_1&gt; = &lt;&gt; (&lt;_&gt; | &lt;_&gt;) &lt;&gt;</code> </pre> <br>  <b>终端是</b>自给自足的，不需要定义它们。 上面的例子可以这样写： <br><br><pre> <code class="plaintext hljs">&lt;&gt; = &lt;_1&gt; "+" &lt;_2&gt; &lt;_1&gt; = &lt;&gt; ("*" | "/") &lt;&gt;</code> </pre> <br> 其中“ +”，“ *”，“ /”是端子。 <br> 您需要立即从语法中选择终端，甚至可以将它们写在主要定义底部的单独列表中-稍后将派上用场。 <br><br> 有关BNF的完整说明，请参见Wikipedia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a> 。 编写语言语法是创建不容忍轻浮的语言的重要阶段。 其中一个错误可能导致代码完全失效，必须重新编写代码。 因此，在进行下一步之前，请确保编译后的语法中没有争议性的问题。 如果您有两个监视器，那么在剩下的工作中，用一个语法文件占用一个监视器将很方便，这样您在编写代码时就可以很快将视线移到它上面。 相信我，您必须一直这样做。 这是我编译的HTML5 BNF语法： <br><br><pre> <code class="html hljs xml">(* document *) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">document</span></span></span><span class="hljs-tag">&gt;</span></span> = {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">document_part</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">END</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">document_part</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">block</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">empty_tag</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">comment</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">macro_tag</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">block</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">opening_tag</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">document_part</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">closing_tag</span></span></span><span class="hljs-tag">&gt;</span></span> (* tags *) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">opening_tag</span></span></span><span class="hljs-tag">&gt;</span></span> = "<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">"</span></span></span><span class="hljs-tag"> {&lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">block_tag_name</span></span></span><span class="hljs-tag">&gt;</span></span> [<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attributes_list</span></span></span><span class="hljs-tag">&gt;</span></span>] {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} "&gt;" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">closing_tag</span></span></span><span class="hljs-tag">&gt;</span></span> = "<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">"</span></span></span><span class="hljs-tag"> "/" {&lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">block_tag_name</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} "&gt;" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">empty_tag</span></span></span><span class="hljs-tag">&gt;</span></span> = "<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">"</span></span></span><span class="hljs-tag"> "!" {&lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">empty_tag_name</span></span></span><span class="hljs-tag">&gt;</span></span> [<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attributes_list]</span></span></span><span class="hljs-tag"> {&lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} ["/"] "&gt;" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">comment</span></span></span><span class="hljs-tag">&gt;</span></span> = "<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">"</span></span></span><span class="hljs-tag"> "!" "</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">--</span></span></span><span class="hljs-tag">" &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">comment_text</span></span></span><span class="hljs-tag">&gt;</span></span> "--" "&gt;" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">macro_tag</span></span></span><span class="hljs-tag">&gt;</span></span> = "<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">"</span></span></span><span class="hljs-tag"> "?" &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">macro_text</span></span></span><span class="hljs-tag">&gt;</span></span> "?" "&gt;" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">block_tag_name</span></span></span><span class="hljs-tag">&gt;</span></span> = "a" | "abbr" | "address" | "article" | "aside" | "audio" | "b" | "bdo" | "blockquote" | "body" | "button" | "canvas" | "caption" | "cite" | "code" | "colgroup" | "data" | "datalist" | "dd" | "del" | "details" | "dfn" | "dialog" | "div" | "dl" | "dt" | "em" | "fieldset" | "figcaption" | "figure" | "footer" | "form" | "h1" | "h2" | "h3" | "h4" | "h5" | "h6" | "head" | "header" | "html" | "i" | "iframe" | "ins" | "kbd" | "label" | "legend" | "li" | "main" | "map" | "mark" | "meter" | "nav" | "noscript" | "object" | "ol" | "optgroup" | "option" | "output" | "p" | "picture" | "pre" | "progress" | "q" | "ruby" | "rb" | "rt" | "rtc" | "rp" | "s" | "samp" | "script" | "section" | "select" | "small" | "span" | "strong" | "style" | "sub" | "summary" | "sup" | "table" | "tbody" | "td" | "template" | "textarea" | "tfoot" | "th" | "thead" | "time" | "title" | "tr" | "track" | "u" | "ul" | "var" | "video" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">empty_tag_name</span></span></span><span class="hljs-tag">&gt;</span></span> = "area" | "base" | "br" | "col" | "embed" | "hr" | "img" | "input" | "link" | "menuitem" | "meta" | "param" | "source" | "track" | "wbr" (* attributes *) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attributes_list</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attribute</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attribute</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attribute</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">empty_attribute</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unquoted_attribute</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">single_quoted_attribute</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">double_quoted_attribute</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">empty_attribute</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attribute_name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unquoted_attribute</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attribute_name</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} "=" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unquoted_attribute_value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">single_quoted_attribute</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attribute_name</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} "=" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} "'" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">single_quoted_attribute_value</span></span></span><span class="hljs-tag">&gt;</span></span> "'" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">double_quoted_attribute</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attribute_name</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} "=" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span>} "\"" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">double_quoted_attribute_value</span></span></span><span class="hljs-tag">&gt;</span></span> "\"" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attribute_name</span></span></span><span class="hljs-tag">&gt;</span></span> = (<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">letter</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span>) {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">letter</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span>} {* attribute values *) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unquoted_attribute_value</span></span></span><span class="hljs-tag">&gt;</span></span> = /^[\s"'=<span class="hljs-tag"><span class="hljs-tag">&lt;&gt;</span></span>/]/ {/^[\s"'=<span class="hljs-tag"><span class="hljs-tag">&lt;&gt;</span></span>/]/} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">single_quoted_attribute_value</span></span></span><span class="hljs-tag">&gt;</span></span> = /^[']/ {/^[']/} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">double_quoted_attribute_value</span></span></span><span class="hljs-tag">&gt;</span></span> = /^["]/ {/^["]/} (* nonterminals *) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag">&gt;</span></span> = {/^[<span class="hljs-tag"><span class="hljs-tag">&lt;&gt;</span></span>]/} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">comment_text</span></span></span><span class="hljs-tag">&gt;</span></span> = ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">macro_text</span></span></span><span class="hljs-tag">&gt;</span></span> = ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">letter</span></span></span><span class="hljs-tag">&gt;</span></span> = /[a-zA-Z]/ <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span> = /[0-9]/ <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ws</span></span></span><span class="hljs-tag">&gt;</span></span> = " " | "\t" | "\n" (* terminals *) "<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">",</span></span></span><span class="hljs-tag"> "&gt;</span></span>", "/", "!", "?", " ", "\t", "\n"</code> </pre><br> 语法准备就绪后，您可以继续进行词法分析器（词法分析器的另一个名称，因为它除了进行分析外，还可以识别文档中的词法错误）。 乍看之下，一切都很简单：吸收字符，写入缓冲区，并在检测到密钥终端时将接收到的令牌确定为具有某种类型的令牌，对吗？ 是的，只有令牌的类型比符号更重要。 我现在解释。 当然，反汇编（ifsteam和file）过程应该包含一个循环，该循环从输入流中读取一个字符，并将其发送到处理该字符的进程（const char＆c）过程。 似乎该处理过程需要包含开关©，其中每个键符号都有其自己的功能，具体取决于当前令牌的类型。 实际上，情况恰恰相反：最好使用开关来检查令牌的类型并定义字符的功能。 此外，当前令牌通常具有不确定类型，是许多类型之一。 例如，打开尖括号后，您会看到：打开，关闭，空标签以及HTML样式的注释或宏标签（PHP脚本包含在“ &lt;？...？&gt;”中。对于所有此类联合，您都需要自己使用大小写）。使用位标志。给出有限数量的令牌类型（越好越好，因为词法分析器的任务是使语法工作尽可能少）。对于每种类型，给出唯一的二阶数（1、2、4、8等），然后以二进制格式显示如下：0001，0010，0  100等，并且按位添加任何类型的任何数字，将获得唯一的数字。 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Token_type { END = <span class="hljs-number"><span class="hljs-number">1</span></span>, TEXT = <span class="hljs-number"><span class="hljs-number">2</span></span>, OPENING_BLOCK_TAG_NAME = <span class="hljs-number"><span class="hljs-number">4</span></span>, CLOSING_BLOCK_TAG_NAME = <span class="hljs-number"><span class="hljs-number">8</span></span>, EMPTY_TAG_NAME = <span class="hljs-number"><span class="hljs-number">16</span></span>, COMMENT = <span class="hljs-number"><span class="hljs-number">32</span></span>, MACRO_TAG = <span class="hljs-number"><span class="hljs-number">64</span></span>, ATTRIBUTE_NAME = <span class="hljs-number"><span class="hljs-number">128</span></span>, UNQUOTED_ATTRIBUTE_VALUE = <span class="hljs-number"><span class="hljs-number">256</span></span>, SINGLE_QUOTED_ATTRIBUTE_VALUE = <span class="hljs-number"><span class="hljs-number">512</span></span>, DOUBLE_QUOTED_ATTRIBUTE_VALUE = <span class="hljs-number"><span class="hljs-number">1024</span></span> };</code> </pre><br> 截断的程序过程： <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Lexer</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::process</span></span> (<span class="hljs-selector-tag"><span class="hljs-selector-tag">const</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">char</span></span> &amp;<span class="hljs-selector-tag"><span class="hljs-selector-tag">c</span></span>) { switch (curr_token_type) { case <span class="hljs-attribute"><span class="hljs-attribute">END</span></span>: { throw <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>(<span class="hljs-string"><span class="hljs-string">"unexpected ending!"</span></span>); break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TEXT</span></span>: { if (c == '&gt;') throw string("unexpected <span class="hljs-attribute"><span class="hljs-attribute">symbol</span></span>: \<span class="hljs-string"><span class="hljs-string">"&gt;\"!"</span></span>); else if (c == '&lt;') { if (!buffer.empty()) { add(buffer, TEXT); buffer.clear(); } <span class="hljs-selector-tag"><span class="hljs-selector-tag">curr_token_type</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">OPENING_BLOCK_TAG_NAME</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">CLOSING_BLOCK_TAG_NAME</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">EMPTY_TAG_NAME</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">COMMENT</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">MACRO_TAG</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">else</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">buffer</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.push_back</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">c</span></span>); <span class="hljs-selector-tag"><span class="hljs-selector-tag">break</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">OPENING_BLOCK_TAG_NAME</span></span>: { throw string("error!"); break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">CLOSING_BLOCK_TAG_NAME</span></span>: { if (c == '&lt;') throw string("unexpected <span class="hljs-attribute"><span class="hljs-attribute">symbol</span></span>: \<span class="hljs-string"><span class="hljs-string">"&lt;\"!"</span></span>); else if (c == '/') throw string("unexpected <span class="hljs-attribute"><span class="hljs-attribute">symbol</span></span>: \<span class="hljs-string"><span class="hljs-string">"&lt;\"!"</span></span>); else if (c == '!') throw string("unexpected <span class="hljs-attribute"><span class="hljs-attribute">symbol</span></span>: \<span class="hljs-string"><span class="hljs-string">"!\"!"</span></span>); else if (c == '?') throw string("unexpected <span class="hljs-attribute"><span class="hljs-attribute">symbol</span></span>: \<span class="hljs-string"><span class="hljs-string">"?\"!"</span></span>); else if (c == ' ') throw string("unexpected <span class="hljs-attribute"><span class="hljs-attribute">symbol</span></span>: \<span class="hljs-string"><span class="hljs-string">" \"!"</span></span>); else if (c == '\t') throw string("unexpected <span class="hljs-attribute"><span class="hljs-attribute">symbol</span></span>: \<span class="hljs-string"><span class="hljs-string">"\\t\"!"</span></span>); else if (c == '\n') throw string("unexpected <span class="hljs-attribute"><span class="hljs-attribute">symbol</span></span>: \<span class="hljs-string"><span class="hljs-string">"\\n\"!"</span></span>); else if (c == '&gt;') { for (unsigned int i(0); i &lt; BLOCK_TAGS_COUNT; i++) if (buffer == block_tags[i]) { add(buffer, CLOSING_BLOCK_TAG_NAME); buffer.clear(); curr_token_type = TEXT; break; } } <span class="hljs-selector-tag"><span class="hljs-selector-tag">else</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">buffer</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.push_back</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">c</span></span>); <span class="hljs-selector-tag"><span class="hljs-selector-tag">break</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">EMPTY_TAG_NAME</span></span>: { throw string("error!"); break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">COMMENT</span></span>: { ... break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">MACRO_TAG</span></span>: { ... break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">OPENING_BLOCK_TAG_NAME</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">CLOSING_BLOCK_TAG_NAME</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">EMPTY_TAG_NAME</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">COMMENT</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">MACRO_TAG</span></span>: { ... break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">EMPTY_TAG_NAME</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">COMMENT</span></span>: { ... break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ATTRIBUTE_NAME</span></span>: { ... break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ATTRIBUTE_NAME</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">UNQUOTED_ATTRIBUTE_VALUE</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">SINGLE_QUOTED_ATTRIBUTE_VALUE</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">DOUBLE_QUOTED_ATTRIBUTE_VALUE</span></span>: { ... break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">UNQUOTED_ATTRIBUTE_VALUE</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">SINGLE_QUOTED_ATTRIBUTE_VALUE</span></span> | <span class="hljs-selector-tag"><span class="hljs-selector-tag">DOUBLE_QUOTED_ATTRIBUTE_VALUE</span></span>: { ... break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">UNQUOTED_ATTRIBUTE_VALUE</span></span>: { ... break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SINGLE_QUOTED_ATTRIBUTE_VALUE</span></span>: { ... break; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">case</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">DOUBLE_QUOTED_ATTRIBUTE_VALUE</span></span>: { ... break; } } }</code> </pre><br> 我们用开关检查期望令牌（或令牌）的类型，并在每种情况下确定每个关键终端的程序。 功能并不多，每个人都执行简单的操作：将字符添加到缓冲区中，或将缓冲区转储到下一个令牌中，或更改所需的令牌类型，或引发异常。 使用可搜索的文本编辑器使用上面编写的语法很容易确定所需的过程。 只需在其他表达式的定义中查找期望标记（标记）的所有包含物，然后在“第三”中包含这些表达式，等等。 这是gedit文本编辑器中的开始标记的示例： <br><br><img src="https://habrastorage.org/webt/72/fw/tw/72fwtwt_waeie4ulzftkxua356w.png" alt="形式语法取向"><br><br> 首先，导航语法很困难，但是随着时间的流逝和经验的积累，它变得比划分列更复杂。 这是反汇编程序： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Lexer::disassemble (ifstream &amp;file) { tokens_count = <span class="hljs-number"><span class="hljs-number">0</span></span>; curr_token_type = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsigned</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">line</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> c; curr_token_type = TEXT; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((c = file.get()) != EOF) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c == <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) { pos = <span class="hljs-number"><span class="hljs-number">1</span></span>; line++; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> pos++; process(c); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer.size() != <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(curr_token_type | TEXT)) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>(<span class="hljs-string"><span class="hljs-string">"text was expected!"</span></span>); add(buffer, TEXT); buffer.clear(); } add(<span class="hljs-string"><span class="hljs-string">""</span></span>, END); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> &amp;error) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>(<span class="hljs-string"><span class="hljs-string">"lexer: "</span></span> + to_string(line) + <span class="hljs-string"><span class="hljs-string">","</span></span> + to_string(pos) + <span class="hljs-string"><span class="hljs-string">": "</span></span> + error); } }</code> </pre><br> 将类型设置为TEXT显然是第一个预期的标记，然后在结尾添加END类型的标记以及任何文本（或为空，如此处所示）。 <br><br> 例如，我拿了一个带注释的HTML文档模板，在其中添加了一个伪PHP脚本，使用词法分析器对其进行了处理，并以“ [“ &lt;token_text&gt;”：&lt;token_type&gt;]“的格式显示了令牌列表。 这是发生了什么： <br><br><div class="spoiler">  <b class="spoiler_title">文件本身</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ru"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content-type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"author"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Interquadro"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"description"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"keywords"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width=device-width, initial-scale=1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"format-detection"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"telephone=no"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x-rim-auto-match"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"telephone=none"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"referrer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"no-referrer"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_suburl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shortcut icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".ico"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--[if lt IE 9]&gt; &lt;script src="http://html5shiv.googlecode.com/svn/trunk/html5-els.js"&gt;&lt;/script&gt; &lt;![endif]--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"intro"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nav</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nav"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nav"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nav"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nav"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nav</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">main</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">main</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">small</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"copyright"</span></span></span><span class="hljs-tag">&gt;</span></span>Copyright © 2019.   .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">small</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">代币列表</b> <div class="spoiler_text"><pre> [“！DOCTYPE”：EMPTY_TAG_NAME]
 [“ html”：ATTRIBUTE_NAME]
 [“
 “：TEXT]
 [“ html”：OPENING_BLOCK_TAG_NAME]
 [“ lang”：ATTRIBUTE_NAME]
 [“ en”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
 “：TEXT]
 [“头”：OPENING_BLOCK_TAG_NAME]
 [“
	 “：TEXT]
 [“元”：EMPTY_TAG_NAME]
 [“ http-equiv”：ATTRIBUTE_NAME]
 [“内容类型”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“内容”：ATTRIBUTE_NAME]
 [“ text / html”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“字符集”：ATTRIBUTE_NAME]
 [“ utf-8”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
	 “：TEXT]
 [“元”：EMPTY_TAG_NAME]
 [“名称”：ATTRIBUTE_NAME]
 [“作者”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“内容”：ATTRIBUTE_NAME]
 [“ Interquadro”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
	 “：TEXT]
 [“元”：EMPTY_TAG_NAME]
 [“名称”：ATTRIBUTE_NAME]
 [“说明”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“内容”：ATTRIBUTE_NAME]
 [“”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
	 “：TEXT]
 [“元”：EMPTY_TAG_NAME]
 [“名称”：ATTRIBUTE_NAME]
 [“关键字”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“内容”：ATTRIBUTE_NAME]
 [“”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
	 “：TEXT]
 [“元”：EMPTY_TAG_NAME]
 [“名称”：ATTRIBUTE_NAME]
 [“视口”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“内容”：ATTRIBUTE_NAME]
 [“宽度=设备宽度，初始比例= 1”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
	 “：TEXT]
 [“元”：EMPTY_TAG_NAME]
 [“名称”：ATTRIBUTE_NAME]
 [“格式检测”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“内容”：ATTRIBUTE_NAME]
 [“电话=否”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
	 “：TEXT]
 [“元”：EMPTY_TAG_NAME]
 [“ http-equiv”：ATTRIBUTE_NAME]
 [“ x-rim-auto-match”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“内容”：ATTRIBUTE_NAME]
 [“电话=无”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
	 “：TEXT]
 [“元”：EMPTY_TAG_NAME]
 [“名称”：ATTRIBUTE_NAME]
 [“引荐来源”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“内容”：ATTRIBUTE_NAME]
 [“无推荐人”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
	 “：TEXT]
 [“元”：EMPTY_TAG_NAME]
 [“名称”：ATTRIBUTE_NAME]
 [“ _suburl”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“内容”：ATTRIBUTE_NAME]
 [“”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
	
	 “：TEXT]
 [“标题”：OPENING_BLOCK_TAG_NAME]
 [“标题”：CLOSING_BLOCK_TAG_NAME]
 [“
	 “：TEXT]
 [“链接”：EMPTY_TAG_NAME]
 [“ rel”：ATTRIBUTE_NAME]
 [“快捷方式图标”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“ href”：ATTRIBUTE_NAME]
 [“ .ico”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
	 “：TEXT]
 [“链接”：EMPTY_TAG_NAME]
 [“ rel”：ATTRIBUTE_NAME]
 [“样式表”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“类型”：ATTRIBUTE_NAME]
 [“ text / css”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“ href”：ATTRIBUTE_NAME]
 [“ .css”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“标题”：ATTRIBUTE_NAME]
 [“”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“

	 “：TEXT]
 [“ [如果是IE 9]&gt;
	 &lt;script src =“ http://html5shiv.googlecode.com/svn/trunk/html5-els.js”&gt; &lt;/ script&gt;
	 &lt;！[endif]“：评论
 [“
 “：TEXT]
 [“头”：CLOSING_BLOCK_TAG_NAME]
 [“

 “：TEXT]
 [“ body”：OPENING_BLOCK_TAG_NAME]
 [“
	 “：TEXT]
 [“标题”：OPENING_BLOCK_TAG_NAME]
 [“
		 “：TEXT]
 [“ div”：OPENING_BLOCK_TAG_NAME]
 [“ id”：ATTRIBUTE_NAME]
 [“简介”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“

		 “：TEXT]
 [“ div”：CLOSING_BLOCK_TAG_NAME]
 [“
	 “：TEXT]
 [“标题”：CLOSING_BLOCK_TAG_NAME]
 [“
	 “：TEXT]
 [“导航”：OPENING_BLOCK_TAG_NAME]
 [“
		 “：TEXT]
 [“ ul”：OPENING_BLOCK_TAG_NAME]
 [“ id”：ATTRIBUTE_NAME]
 [“导航”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
			 “：TEXT]
 [“ li”：OPENING_BLOCK_TAG_NAME]
 [“课程”：ATTRIBUTE_NAME]
 [“导航”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“ a”：OPENING_BLOCK_TAG_NAME]
 [“ href”：ATTRIBUTE_NAME]
 [“＃”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“首页”：TEXT]
 [“ a”：CLOSING_BLOCK_TAG_NAME]
 [“ li”：CLOSING_BLOCK_TAG_NAME]
 [“
			 “：TEXT]
 [“ li”：OPENING_BLOCK_TAG_NAME]
 [“课程”：ATTRIBUTE_NAME]
 [“导航”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“ a”：OPENING_BLOCK_TAG_NAME]
 [“ href”：ATTRIBUTE_NAME]
 [“＃”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“评论”：TEXT]
 [“ a”：CLOSING_BLOCK_TAG_NAME]
 [“ li”：CLOSING_BLOCK_TAG_NAME]
 [“
			 “：TEXT]
 [“ li”：OPENING_BLOCK_TAG_NAME]
 [“课程”：ATTRIBUTE_NAME]
 [“导航”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“ a”：OPENING_BLOCK_TAG_NAME]
 [“ href”：ATTRIBUTE_NAME]
 [“”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“帮助”：TEXT]
 [“ a”：CLOSING_BLOCK_TAG_NAME]
 [“ li”：CLOSING_BLOCK_TAG_NAME]
 [“
		 “：TEXT]
 [“ ul”：CLOSING_BLOCK_TAG_NAME]
 [“
	 “：TEXT]
 [“导航”：CLOSING_BLOCK_TAG_NAME]
 [“

	 “：TEXT]
 [“主要”：OPENING_BLOCK_TAG_NAME]
 [“ id”：ATTRIBUTE_NAME]
 [“内容”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“
		 “：TEXT]
 [“ php”：MACRO_TAG]
 [“
	 “：TEXT]
 [“主要”：CLOSING_BLOCK_TAG_NAME]
 [“

	 “：TEXT]
 [“页脚”：OPENING_BLOCK_TAG_NAME]
 [“
		 “：TEXT]
 [“ hr”：EMPTY_TAG_NAME]
 [“
		 “：TEXT]
 [“小”：OPENING_BLOCK_TAG_NAME]
 [“ id”：ATTRIBUTE_NAME]
 [“版权”：DOUBLE_QUOTED_ATTRIBUTE_VALUE]
 [“版权所有©2019。保留所有权利。”  ：TEXT]
 [“小”：CLOSING_BLOCK_TAG_NAME]
 [“
	 “：TEXT]
 [“页脚”：CLOSING_BLOCK_TAG_NAME]
 [“
 “：TEXT]
 [“ body”：CLOSING_BLOCK_TAG_NAME]
 [“

 “：TEXT]
 [“ html”：CLOSING_BLOCK_TAG_NAME]
 [“
 “：TEXT]
 [“”：END]
</pre><br><br></div></div><br> 现在我们准备开始第二部分-语法树的构建。 由于我们的标签具有属性，因此树节点除与其他节点通信外，还将包含键值对数组。 可以将最终的构造称为本文标题中提到的DOM文档的对象模型。 <br><br> 您需要多少个类来实现HTML元素的所有属性？ <br><br> 理想情况下，每个元素都有一个类，以便可以为它们定义级联样式表，但是我们将自己限制为三个-一个空的“ Node”标签，一个继承的“ Block”块（内容包含在两个成对标签之间）以及从他与根树的根。 我们还在解析器中定义了一个标签数组，其中可能包含文本，例如&lt;p&gt;，&lt;li&gt;，&lt;strong&gt;等，以清除带有未放置文本的标记。 现在由小决定。 如果您在词法分析器上工作得很好，那么语法上的任务就是吸收标记并在打开的节点中执行以下三种操作之一：向其添加一个空节点，打开一个新节点或通过将指针返回给父节点自己关闭它。 对于后者，要求所有类（从基本Node开始）都包含在创建元素时获得的此类指针。 此过程称为自<i>顶向下解析</i> 。 <br><br> 解析过程： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Parser::parse (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Lexer &amp;lexer) { Block * open_block = (Block*) tree; Node * last_node = (Node*) tree; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> size = lexer.count(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> i(<span class="hljs-number"><span class="hljs-number">0</span></span>); i &lt; size<span class="hljs-number"><span class="hljs-number">-2</span></span>; i++) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (lexer[i].type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Lexer::TEXT: { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j(<span class="hljs-number"><span class="hljs-number">0</span></span>); j &lt; TEXT_TAGS_COUNT; j++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (open_block-&gt;get_name() == text_tags[j]) last_node = open_block-&gt;add(<span class="hljs-string"><span class="hljs-string">"TEXT"</span></span>, lexer[i].lexeme); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Lexer::OPENING_BLOCK_TAG_NAME: { last_node = open_block = open_block-&gt;open(lexer[i].lexeme); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Lexer::CLOSING_BLOCK_TAG_NAME: { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lexer[i].lexeme != open_block-&gt;get_name()) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>(<span class="hljs-string"><span class="hljs-string">"unexpected closing tag: &lt;/"</span></span> + lexer[i].lexeme + <span class="hljs-string"><span class="hljs-string">"&gt;"</span></span>); open_block = open_block-&gt;close(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Lexer::EMPTY_TAG_NAME: { last_node = open_block-&gt;add(lexer[i].lexeme); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Lexer::COMMENT: { last_node = open_block-&gt;add(<span class="hljs-string"><span class="hljs-string">"COMMENT"</span></span>, lexer[i].lexeme); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Lexer::MACRO_TAG: { last_node = open_block-&gt;add(<span class="hljs-string"><span class="hljs-string">"MACRO"</span></span>, lexer[i].lexeme); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Lexer::ATTRIBUTE_NAME: { last_node-&gt;add_attr(lexer[i].lexeme, lexer[i].lexeme); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Lexer::UNQUOTED_ATTRIBUTE_VALUE: { last_node-&gt;set_last_attr(lexer[i].lexeme); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Lexer::SINGLE_QUOTED_ATTRIBUTE_VALUE: { last_node-&gt;set_last_attr(lexer[i].lexeme); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Lexer::DOUBLE_QUOTED_ATTRIBUTE_VALUE: { last_node-&gt;set_last_attr(lexer[i].lexeme); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Lexer::END: { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (open_block-&gt;get_type() != Node::ROOT) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>(<span class="hljs-string"><span class="hljs-string">"unexpected ending!"</span></span>); open_block-&gt;close(); } } } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> &amp;error) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>(<span class="hljs-string"><span class="hljs-string">"parser: "</span></span> + error); } }</code> </pre><br> 仅此而已！ 如果正确完成所有操作，则可以显示结果树： <br><br><pre> | 
 +-&lt;根目录&gt;
   | 
   +-&lt;！DOCTYPE&gt;
   | 
   +-&lt;html&gt;
     | 
     +-&lt;头&gt;
     |  | 
     |  +-&lt;元&gt;
     |  | 
     |  +-&lt;元&gt;
     |  | 
     |  +-&lt;元&gt;
     |  | 
     |  +-&lt;元&gt;
     |  | 
     |  +-&lt;元&gt;
     |  | 
     |  +-&lt;元&gt;
     |  | 
     |  +-&lt;元&gt;
     |  | 
     |  +-&lt;元&gt;
     |  | 
     |  +-&lt;元&gt;
     |  | 
     |  +-&lt;标题&gt;
     |  | 
     |  +-&lt;链接&gt;
     |  | 
     |  +-&lt;链接&gt;
     |  | 
     |  +-&lt;评论&gt;
     | 
     +-&lt;body&gt;
       | 
       +-&lt;标题&gt;
       |  | 
       |  +-&lt;div&gt;
       | 
       +-&lt;导航
       |  | 
       |  +-&lt;ul&gt;
       |  | 
       |  +-&lt;li&gt;
       |  |  | 
       |  |  +-&lt;a&gt;
       |  | 
       |  +-&lt;li&gt;
       |  |  | 
       |  |  +-&lt;a&gt;
       |  | 
       |  +-&lt;li&gt;
       |  | 
       |  +-&lt;a&gt;
       | 
       +-&lt;主要&gt;
       |  | 
       |  +-&lt;宏&gt;
       | 
       +-&lt;页脚&gt;
         | 
         +-&lt;hr&gt;
         | 
         +-&lt;小&gt;
</pre><br><br> 但是，尽管生成的树实际上可以称为DOM，但我们的解析器与完整的jQuery，Jsoup，beautifulsoup或Gumbo相比还很遥远，特别是因为它无法正确处理位于成对的&lt;style&gt;和&lt;script&gt;标记之间的文本，因此也无法获取源代码。直到我带来它。 但是，如果哈布罗夫斯克居民表达了这样的愿望，我肯定会补充。 成功。 <br><br>  PS在公共访问中填充了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">源代码</a> 。 恕我直言，原始的，所以我打算计划一个完整的图书馆。 <br><br>  PSS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第二部分。</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN442964/">https://habr.com/ru/post/zh-CN442964/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN442950/index.html">评论Cutra Wonder Cutter</a></li>
<li><a href="../zh-CN442952/index.html">Tinkoff.ru的新Hackathon</a></li>
<li><a href="../zh-CN442954/index.html">在Unity中使用SQLite（Unity + SQLite）</a></li>
<li><a href="../zh-CN442958/index.html">Nikita Shamgunov向The Bell讲述了在Microsoft和Facebook工作，与盖茨和MemSQL数据库进行的交谈</a></li>
<li><a href="../zh-CN442962/index.html">关于Rust的生命的另一篇文章</a></li>
<li><a href="../zh-CN442966/index.html">星巴克咖啡的比特币构成重大税收申报问题</a></li>
<li><a href="../zh-CN442968/index.html">获得支持专业认证的CPE（ISACA案例研究）</a></li>
<li><a href="../zh-CN442970/index.html">棋盘游戏，用于学习电路的基础知识。 为什么不呢</a></li>
<li><a href="../zh-CN442974/index.html">三读通过的打击假信息法案</a></li>
<li><a href="../zh-CN442976/index.html">现状：IT巨头以4.05亿美元收购Wi-Fi初创公司</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>