<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯТкЁЯП┐ ЁЯС╣ ЁЯзЧ рд▓реЛрдХрдкреНрд░рд┐рдп рд╡рд┐рд░реЛрдзреА рдзреЛрдЦрд╛ рдмреИрдЯрд▓рдИ рдХреА рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ ЁЯС╝ЁЯП┐ ЁЯХЯ ЁЯЩБ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдмреИрдЯрд▓рдпреЗ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдПрдХ рдЬрд░реНрдорди рдерд░реНрдб рдкрд╛рд░реНрдЯреА рдПрдВрдЯреА-рдЪреАрдЯ рд╣реИ, рдЬрд┐рд╕реЗ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ 32 рд╡рд░реНрд╖реАрдп рдмрд╛рд╕реНрдЯрд┐рдпрди рд╣реЗрдЗрдХреЛ рд╕реЛрдЯрд░ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рдЧреЗрдо рдкреНрд░рдХрд╛рд╢рдХреЛрдВ рдХреЛ рдП...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд▓реЛрдХрдкреНрд░рд┐рдп рд╡рд┐рд░реЛрдзреА рдзреЛрдЦрд╛ рдмреИрдЯрд▓рдИ рдХреА рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483068/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ps/ae/ij/psaeijpcayldgrqiqeiq6l83nue.jpeg"></div><br>  рдмреИрдЯрд▓рдпреЗ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдПрдХ рдЬрд░реНрдорди рдерд░реНрдб рдкрд╛рд░реНрдЯреА рдПрдВрдЯреА-рдЪреАрдЯ рд╣реИ, рдЬрд┐рд╕реЗ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ 32 рд╡рд░реНрд╖реАрдп <em>рдмрд╛рд╕реНрдЯрд┐рдпрди</em> рд╣реЗрдЗрдХреЛ рд╕реЛрдЯрд░ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдпрд╣ рдЧреЗрдо рдкреНрд░рдХрд╛рд╢рдХреЛрдВ рдХреЛ рдПрдХ рдЖрд╕рд╛рди-рд╕реЗ-рдЙрдкрдпреЛрдЧ рд╡рд┐рд░реЛрдзреА рдзреЛрдЦрд╛ рдкреНрд░рдгрд╛рд▓реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕рд╛рдорд╛рдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛ рдЕрдиреБрдХреВрд▓рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЧреЗрдо рдХреЗ рд▓рд┐рдП рдзреЛрдЦрд╛ рджреЗрддреА рд╣реИред  рдЬреИрд╕рд╛ рдХрд┐ рдЙрддреНрдкрд╛рдж рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ, рдпрд╣ рд╣рдореЗрд╢рд╛ рдЖрдзреБрдирд┐рдХ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд░рд╣рддрд╛ рд╣реИ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЦреЛрдЬ рдХреЗ рдирд╡реАрди рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ;  рдЬрд╛рд╣рд┐рд░ рд╣реИ, рдпрд╣ рдбреЗрд╡рд▓рдкрд░ рдХреА рд░рд╛рд╖реНрдЯреНрд░реАрдпрддрд╛ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реИ: <code>QUALITY MADE IN GERMANY</code> ред  рдмреИрдЯрд▓рдПрдИ рдореЗрдВ рдХрдИ рддрддреНрд╡ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдЙрди рдЦреЗрд▓реЛрдВ рдореЗрдВ рдерд┐рдПрдЯрд░ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдЙрддреНрдкрд╛рдж рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рднреБрдЧрддрд╛рди рдХрд┐рдпрд╛ рд╣реИред  рдЪрд╛рд░ рдореБрдЦреНрдп рддрддреНрд╡ рд╣реИрдВ: <br><br><ul><li>  BEService <ul><li>  рдПрдХ рд╡рд┐рдВрдбреЛрдЬ рд╕рд┐рд╕реНрдЯрдо рд╕реЗрд╡рд╛, рдЬреЛ рдмреИрдЯрд▓рдПрдИ <em>рдмреЗрд╕реЗрд╡рд░</em> рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ <em>рдХрд░рддреА</em> рд╣реИ, рдЬреЛ рдХрд┐ <em>рдмреАрдбрд╛рд╕реА</em> рдФрд░ <em>рдмреЗрд╕рд┐рдХ рдХреЗ</em> рд╕рд╛рде рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд░реНрд╡рд░ рд╕рдВрдЪрд╛рд░ рдкреНрд░рджрд╛рди <em>рдХрд░рддреА рд╣реИ</em> ред </li></ul></li><li>  BEDaisy <ul><li>  рдПрдХ рд╡рд┐рдВрдбреЛрдЬ рдХрд░реНрдиреЗрд▓ рдбреНрд░рд╛рдЗрд╡рд░ рдЬреЛ рдЧреЗрдо рдХреЛ рдЕрд╡реИрдз рд░реВрдк рд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рд╕реЗ рд╕рд┐рдиреЗрдорд╛рдШрд░реЛрдВ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд╡рд╛рд░рдХ рдШрдЯрдирд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рддрдВрддреНрд░ рдФрд░ рдорд┐рдиреА рдлрд┐рд▓реНрдЯрд░ рдХреЛ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИ </li></ul></li><li>  BEClient <ul><li>  рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╡рд┐рдВрдбреЛрдЬ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЬреЛ рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рд▓реЛрдЧреЛрдВ рд╕рд╣рд┐рдд рдЕрдзрд┐рдХрд╛рдВрд╢ рдбрд┐рдЯреЗрдХреНрд╢рди рд╡реИрдХреНрдЯрд░ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред  рдЖрд░рдВрднреАрдХрд░рдг рдХреЗ рдмрд╛рдж, рдпрд╣ рдЦреЗрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдЬреБрдбрд╝ рдЬрд╛рддрд╛ рд╣реИред </li></ul></li><li>  BEServer <ul><li>  рдорд╛рд▓рд┐рдХрд╛рдирд╛ рдмреИрдХрдПрдВрдб рд╕рд░реНрд╡рд░, рдЬрд╛рдирдХрд╛рд░реА рдПрдХрддреНрд░ рдХрд░рдиреЗ рдФрд░ рдЪреЗрдЯрд░реНрд╕ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрд╛рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред </li></ul></li></ul><br><h1>  shellcode </h1><br>  рд╣рд╛рд▓ рд╣реА рдореЗрдВ, рдмреИрдЯрд▓рдИ рд╢реЗрд▓ рдХреЛрдб рдХрд╛ рдПрдХ рдбрдВрдк рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рд╕рд╛рдордиреЗ рдЖрдпрд╛, рдФрд░ рд╣рдордиреЗ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ рдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдмреИрдЯрд▓рдПрд▓рдИ рдХрд╛ рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдг рдХреНрдпрд╛ рд╣реИред  рд╣рдордиреЗ рдмреИрдЯрд▓рдПрдИ рдХрд╛ рдЫрд╣ рдорд╣реАрдиреЗ рддрдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдирд╣реАрдВ рдХрд┐рдпрд╛, рдЗрд╕рд▓рд┐рдП рд╢реЗрд▓рдХреЛрдб рдХрд╛ рд╣рдорд╛рд░рд╛ рдЖрдЦрд┐рд░реА рдбрдВрдк рд╕рдмрд╕реЗ рдкреБрд░рд╛рдирд╛ рд╣реИред  рдЗрд╕ рдЕрдВрддрд┐рдо рдбрдВрдк рд╕реЗ рдореЗрдореЛрд░реА рд╕реЗ рдХреЗрд╡рд▓ рдХреЛрдб рдХреЗ рд╡рд┐рднрд┐рдиреНрди рднрд╛рдЧреЛрдВ рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдпрд╣ рдорд╛рдирддреЗ рд╣реБрдП рдХрд┐ рдмреИрдЯрд▓рдИ рдиреЗ рдХреЗрд╡рд▓ рд╢реЗрд▓ рдХреЛрдб рдХреЛ рдкреВрд░рд╛ рдХрд┐рдпрд╛ рдФрд░ рдкрд┐рдЫрд▓реА рдкрд╣рдЪрд╛рди рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдирд╖реНрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ред <br><a name="habracut"></a><br><h1>  рдХреИрд╕реЗ? </h1><br>  рдмреИрдЯрд▓рдПрдИрдИ рдиреЗ рдХрдерд┐рдд рддреМрд░ рдкрд░ рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рд╕реЗ рд╢реЗрд▓ рд╕реЗрд╡рд╛ рдХреЛ рдмреАрдИрдПрд╕рдИрдЖрд░рдПрд╕ рдирд╛рдордХ рдПрдХ рд╡рд┐рдВрдбреЛрдЬ рд╕реЗрд╡рд╛ рдореЗрдВ рдкреНрд░рд╡рд╛рд╣рд┐рдд рдХрд┐рдпрд╛ред  рдпрд╣ рд╕реЗрд╡рд╛ рдЦреЗрд▓ рдХреЗ рдЕрдВрджрд░ рд╕реНрдерд┐рдд BEClient рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рдХрд░рддреА рд╣реИред  рдбреЗрдЯрд╛ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди <code>\.namedpipeBattleye</code> рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ 2018 рддрдХ рдЕрдирдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рдЕрдм рд╕рднреА рдкреНрд░реЗрд╖рд┐рдд рдбреЗрдЯрд╛ рдХреЛ рдмрд╣реБрдд рдЫреЛрдЯреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдПрдХ xor-рдПрдиреНрдХреНрд░рд┐рдкреНрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдХрд┐ рдкреНрд░рд╕рд┐рджреНрдз рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ рд╣рдорд▓реЛрдВ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреЗрд╣рдж рдЖрд╕рд╛рди рдмрдирд╛рддрд╛ рд╣реИред  рдЬрдм рд╢реЗрд▓ рдХреЛрдб рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рдкреНрд░реЗрд╖рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╕рднреА рдЬреНрдЮрд╛рдд рдореЙрдбреНрдпреВрд▓ рдХреЗ рдмрд╛рд╣рд░ рд╕реНрдерд┐рдд рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рд╢реЗрд▓рдХреЛрдб рдбрдВрдк рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдпрд╛ рддреЛ рдорд╛рдирдХ Windows API рдлрд╝рдВрдХреНрд╢рди рдЬреИрд╕реЗ рдХрд┐ CreateFile, ReadFile, рдЖрджрд┐ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╕рднреА рдХреЙрд▓рд┐рдВрдЧ рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдореЗрдореЛрд░реА рдХреНрд╖реЗрддреНрд░ рдХреЛ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд▓реМрдЯреЗ рдкрддреЗ рдХреЗ рд▓рд┐рдП рдореЗрдореЛрд░реА рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЕрдиреБрд░реЛрдз) рдЬреЛ рд╕рднреА рдЬреНрдЮрд╛рдд рдореЙрдбреНрдпреВрд▓ рд╕реЗ рдмрд╛рд╣рд░ рд╣реИрдВ, рдпрд╛ рд╕рдордп-рд╕рдордп рдкрд░ рд╕рднреА рдЬреНрдЮрд╛рдд рдореЙрдбреНрдпреВрд▓ рдХреЗ рдмрд╛рд╣рд░ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдореЗрдореЛрд░реА рдХреА рддрд▓рд╛рд╢ рдореЗрдВ рдЧреЗрдо рдХреЗ рд╡рд░реНрдЪреБрдЕрд▓ рдореЗрдореЛрд░реА рд╕реНрдкреЗрд╕ рдХреЛ рд╕реНрдХреИрди рдХрд░реЗрдВ, рдФрд░ рдЗрд╕реЗ рдбрд┐рд╕реНрдХ рдкрд░ рдбрдВрдк рдХрд░реЗрдВред  рдЗрд╕реА рд╕рдордп, рдЖрдкрдХреЛ рдЙрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдкрд░ рдирдЬрд╝рд░ рд░рдЦрдиреЗ рдХреА рдЬрд╝рд░реВрд░рдд рд╣реИ рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдбрдВрдк рд╣реЛ рдЪреБрдХреЗ рд╣реИрдВ, рддрд╛рдХрд┐ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдЖрдкрдХреЛ рдХрдИ рд╕рдорд╛рди рдбрдВрдк рдирд╣реАрдВ рдорд┐рд▓реЗрдВрдЧреЗред <br><br><h1>  рд╡реНрдпрд╛рдЦреНрдпрд╛ </h1><br>  рд▓реЗрдЦ рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдЫрджреНрдордХреЛрдб рдХреЗ рдЯреБрдХрдбрд╝реЗ рд╕реБрдВрджрд░рддрд╛ рдХреА рдЦрд╛рддрд┐рд░ <strong>рджреГрдврд╝рддрд╛ рд╕реЗ</strong> рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВред  рдЖрдк рдмреИрдЯрд▓рдПрдп рд╢реЗрд▓ рдХреЛрдб рдХреЛ рдбрдВрдк рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдВрдЧреЗ рдФрд░ рддреБрд░рдВрдд рдЗрди рднрд╛рдЧреЛрдВ рдХреЛ рдкрд╣рдЪрд╛рди рд▓реЗрдВрдЧреЗ;  рд╢реЗрд▓рдХреЛрдб рдореЗрдВ рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИрдВ, рдФрд░ рд▓реЗрдЦ рдореЗрдВ рдХрдИ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рддреИрдирд╛рдд рд╣реИрдВред  рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЬрдм рдЖрдк рдЗрд╕ рднрдпрд╛рдирдХ рдкреБрд░рд╛рддрдирддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрдврд╝рдирд╛ рд╕рдорд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЗрд╕рдХреЗ рдЖрд╕рдкрд╛рд╕ рд╣реЛрдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рд╣реЛрдЧрд╛: ( <br><br><h2>  рд╕реНрдореГрддрд┐ рдЫрдБрдЯрд╛рдИ </h2><br>  рдПрдВрдЯреА-рдЪреАрдЯреНрд╕ рдореЗрдВ рд╕рдмрд╕реЗ рдЖрдо рдкрд╣рдЪрд╛рди рддрдВрддреНрд░ рдореЗрдореЛрд░реА рдПрдиреНрдпреВрдорд░реЗрд╢рди рдФрд░ рдореЗрдореЛрд░реА рд╕реНрдХреИрдирд┐рдВрдЧ рд╣реИ рдЬреЛ <em>рдЬреНрдЮрд╛рдд</em> рдзреЛрдЦрд╛ рдЫрд╡рд┐рдпреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИред  рдЗрд╕реЗ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ рдФрд░, рдЬреИрд╕рд╛ рдХрд┐ рдЕрддреАрдд рджреНрд╡рд╛рд░рд╛ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╕рд╣реА рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд╕рд╛рде, рдХрд╛рдлреА рдкреНрд░рднрд╛рд╡реА рд╣реИ рдпрджрд┐ рдЖрдк рдЕрд╕реЗрдВрдмрд▓рд░ рдХреА рдореВрд▓ рдмрд╛рддреЗрдВ рдирд╣реАрдВ рднреВрд▓ рдЧрдП рд╣реИрдВ рдФрд░ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкреНрд░рд╕реНрддрд╛рд╡ рдХреЛ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдХрд░ рджрд┐рдпрд╛ рд╣реИред <br><br>  рдмреИрдЯрд▓рдпреЗ рдЦреЗрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдкреВрд░реЗ рдкрддрд╛ рд╕реНрдерд╛рди (рдЗрд╕ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╡рд░реНрддрдорд╛рди рдкреНрд░рдХреНрд░рд┐рдпрд╛) рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ рдФрд░ рдкреГрд╖реНрда рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдкрд░ рд╡рд┐рднрд┐рдиреНрди рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реА рдореЗрдореЛрд░реА рд╕реНрдкреЗрд╕ рдХреЗ рдмрд╛рд╣рд░ рд╢реЗрд▓ рдХреЛрдб рдвреВрдВрдврддрд╛ рд╣реИред <br><br>  рдпрд╣рд╛рдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдмреИрдЯрд▓ рдореЗрдВ рдЗрд╕реЗ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// MEMORY ENUMERATION for (current_address = 0 // QUERY MEMORY_BASIC_INFORMATION NtQueryVirtualMemory(GetCurrentProcess(), current_address, 0, &amp;memory_information, 0x30, &amp;return_length) &gt;= 0 current_address = memory_information.base_address + memory_information.region_size) { const auto outside_of_shellcode = memory_information.base_address &gt; shellcode_entry || memory_information.base_address + memory_information.region_size &lt;= shellcode_entry const auto executable_memory = memory_information.state == MEM_COMMIT &amp;&amp; (memory_information.protect == PAGE_EXECUTE || memory_information.protect == PAGE_EXECUTE_READ || memory_information.protect == PAGE_EXECUTE_READWRITE const auto unknown_whitelist = memory_information.protect != PAGE_EXECUTE_READWRITE || memory_information.region_size != 100000000 if (!executable_memory || !outside_of_shellcode || !unknown_whitelist) continue // RUN CHECKS memory::anomaly_check(memory_information memory::pattern_check(current_address, memory_information memory::module_specific_check_microsoft(memory_information memory::guard_check(current_address, memory_information memory::module_specific_check_unknown(memory_information }</span></span></code> </pre> <br><h1>  рд╕реНрдореГрддрд┐ рд╡рд┐рд╕рдВрдЧрддрд┐рдпрд╛рдБ </h1><br>  BattlEye рдореЗрдореЛрд░реА рдПрдбреНрд░реЗрд╕ рд╕реНрдкреЗрд╕ рдореЗрдВ рд╕рднреА рд╡рд┐рд╕рдВрдЧрддрд┐рдпреЛрдВ рдХреЛ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░рддрд╛ рд╣реИ, рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдореЙрдбреНрдпреВрд▓ рдХреА рдореЗрдореЛрд░реА рдЬреЛ рд▓реЛрдб рдХреА рдЧрдИ рдЫрд╡рд┐ рдХреЗ рдЕрдиреБрд░реВрдк рдирд╣реАрдВ рд╣реИ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> memory::anomaly_check(MEMORY_BASIC_INFORMATION memory_information) { <span class="hljs-comment"><span class="hljs-comment">// REPORT ANY EXECUTABLE PAGE OUTSIDE OF KNOWN MODULES if (memory_information.type == MEM_PRIVATE || memory_information.type == MEM_MAPPED) { if ((memory_information.base_address &amp; 0xFF0000000000) != 0x7F0000000000 &amp;&amp; // UPPER EQUALS 0x7F (memory_information.base_address &amp; 0xFFF000000000) != 0x7F000000000 &amp;&amp; // UPPER EQUALS 0x7F0 (memory_information.base_address &amp; 0xFFFFF0000000) != 0x70000000 &amp;&amp; // UPPER EQUALS 0x70000 memory_information.base_address != 0x3E0000)) { memory_report.unknown = 0 memory_report.report_id = 0x2F memory_report.base_address = memory_information.base_address memory_report.region_size = memory_information.region_size memory_report.memory_info = memory_information.type | memory_information.protect | memory_information.state battleye::report(&amp;memory_report, sizeof(memory_report), 0 } } }</span></span></code> </pre> <br><h1>  рдкреИрдЯрд░реНрди рдХреЗ рд▓рд┐рдП рд╕реНрдХреИрдирд┐рдВрдЧ </h1><br>  рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдмреИрдЯрд▓рдИрдИрдИ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдкреИрдЯрд░реНрди рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреАрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕реНрдореГрддрд┐ рдХреЛ рднреА рд╕реНрдХреИрди рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╕реЗ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдЗрд╕ рдЫрджреНрдо рдХреЛрдб рдХреЛ рдкрдврд╝рддреЗ рд╕рдордп, рдЖрдк рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ <strong>рдЗрди рдЪреЗрдХреЛрдВ</strong> рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рд▓реЛрдб рдХрд┐рдП рдЧрдП рдореЙрдбреНрдпреВрд▓ рдХреЗ рдХреЛрдб рдХреНрд╖реЗрддреНрд░ рдХреЛ рдлрд┐рд░ <strong>рд╕реЗ</strong> рд▓рд┐рдЦрдХрд░ рджреЗрдЦрд╛ <strong>рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ</strong> , рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдЬреНрдЮрд╛рдд рдЪрд┐рддреНрд░реЛрдВ рдореЗрдВ рдкреИрдЯрд░реНрди рдХреА рдЦреЛрдЬ рдореЗрдВ рд╕реНрдХреИрди рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред  рдЕрдЦрдВрдбрддрд╛ рдХреА рдЬрд╛рдБрдЪ рдореЗрдВ рдирд╣реАрдВ рдкрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЙрди рд╕рднреА рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ <em>рдЖрд░рдбрдмреНрд▓реНрдпреВрдПрдХреНрд╕</em> рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдП рдЧрдП рдкреИрдХ рдФрд░ рд╢реНрд╡реЗрддрд╕реВрдЪреАрдмрджреНрдз рдФрд░ рдлрд┐рд░ рд╕реЗ <em>рд▓рд┐рдЦреЗ рдЧрдП</em> рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрдирд╛ <em>рдЪрд╛рд╣рддреЗ рд╣реИрдВ</em> , рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдкреИрдХрд░ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд┐рдП рдмрд┐рдирд╛ рдЕрдЦрдВрдбрддрд╛ рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдмреИрдЯрд▓рдПрд▓рдИ рд╢реЗрд▓рдХреЛрдб рдХреЗ рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ, рдпреЗ рдореЗрдореЛрд░реА рдкреИрдЯрд░реНрди рд╣рд╛рд░реНрдб-рдХреЛрдбреЗрдб рд╣реИрдВ: <br><br><pre> <code class="cpp hljs">[<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span>] ojectsPUBGChinese [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span>] BattleGroundsPrivate_CheatESP [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span>] [%<span class="hljs-number"><span class="hljs-number">.0</span></span>fm] %s [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>E] <span class="hljs-number"><span class="hljs-number">0000</span></span>Neck0000Chest0000000Mouse <span class="hljs-number"><span class="hljs-number">10</span></span> [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">3F</span></span>] PlayerESPColor [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">40</span></span>] Aimbot: %d02D3E2041 [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">36</span></span>] HackMachine [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>A] VisualHacks.net [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span>] <span class="hljs-number"><span class="hljs-number">3E232</span></span>F653E31314E4E563D4276282A3A2E463F757523286752552E6F30584748 [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">4F</span></span>] DLLInjection-master\x64\Release\ [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">52</span></span>] NameESP [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">48</span></span>] Skullhack [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">55</span></span>] .rdata$zzzdbg [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">39</span></span>] AimBot [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">39</span></span>] EB4941803C123F755C623FEB388D41D0FBEC93C977583E930EB683E1DF [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">5F</span></span>] <span class="hljs-number"><span class="hljs-number">55E9</span></span> [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">5F</span></span>] <span class="hljs-number"><span class="hljs-number">57E9</span></span> [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">5F</span></span>] <span class="hljs-number"><span class="hljs-number">60E9</span></span> [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">68</span></span>] D3D11Present initialised [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>E] [ %<span class="hljs-number"><span class="hljs-number">.0</span></span>fM ] [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">74</span></span>] [hp:%d]%dm [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">36</span></span>] <span class="hljs-number"><span class="hljs-number">48836424380488</span></span>D4C2458488B5424504C8BC848894C24304C8BC7488D4C2460 [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">36</span></span>] <span class="hljs-number"><span class="hljs-number">741F</span></span>BA80000FF15607E0085C07510F2F1087801008B8788100EB [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">36</span></span>] <span class="hljs-number"><span class="hljs-number">40F</span></span>2AA156F8D2894E9AB4489535D34F9CPOSITION0000COL [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>A] FFE090 [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">79</span></span>] %s00%d00POSITION0000COLOR0000000 [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">36</span></span>] <span class="hljs-number"><span class="hljs-number">8E85765</span></span>DCDDA452E75BA12B4C7B94872116DB948A1DAA6B948A7676BB948902C [<span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>A] n&lt;assembly xmlsn=<span class="hljs-string"><span class="hljs-string">'urn:schemas-mi</span></span></code> </pre> <br>  рдЗрди рдореЗрдореЛрд░реА рдкреИрдЯрд░реНрди рдореЗрдВ рджреЛ-рдмрд╛рдЗрдЯ рд╣реЗрдбрд░ рднреА рд╣реЛрддреЗ рд╣реИрдВ, рдЕрд░реНрдерд╛рддреН рдЕрдЬреНрдЮрд╛рдд рд╕реНрдерд┐рд░ рдореВрд▓реНрдп <code>05</code> рдФрд░ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ред <br><br>  рд╣рдо рдЬреЛ рдирд╣реАрдВ рджреЗрдЦреЗрдВрдЧреЗ, рд╡рд╣ рдпрд╣ рд╣реИ рдХрд┐ рдмреИрдЯрд▓рдИ рднреА рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ <em>BEServer</em> рд╕реЗ рдкреИрдЯрд░реНрди рдХреЛ <em>рд╕реНрдЯреНрд░реАрдо рдХрд░рддрд╛ рд╣реИ</em> рдФрд░ рдЙрдиреНрд╣реЗрдВ <em>BEClient</em> рдХреЛ рднреЗрдЬрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдЪрд░реНрдЪрд╛ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред <br><br>  рд╡реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рджреНрд╡рд╛рд░рд╛ рдкреБрдирд░рд╛рд╡реГрддреНрдд рд░реВрдк рд╕реЗ рд╕реНрдХреИрди рдХрд┐рдП рдЧрдП рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> memory::pattern_check(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* current_address, MEMORY_BASIC_INFORMATION memory_information) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> is_user32 = memory_information.allocation_base == GetModuleHandleA(<span class="hljs-string"><span class="hljs-string">"user32.dll"</span></span> <span class="hljs-comment"><span class="hljs-comment">// ONLY SCAN PRIVATE MEMORY AND USER32 CODE SECTION if (memory_information.type != MEM_PRIVATE &amp;&amp; !is_user32) continue for (address = current_address address != memory_information.base_address + memory_information.region_size address += PAGE_SIZE) // PAGE_SIZE { // READ ENTIRE PAGE FROM LOCAL PROCESS INTO BUFFER if (NtReadVirtualMemory(GetCurrentProcess(), address, buffer, PAGE_SIZE, 0) &lt; 0) continue for (pattern_index = 0 pattern_index &lt; 0x1C/*PATTERN COUNT*/ ++pattern_index) { if (pattern[pattern_index].header == 0x57A &amp;&amp; !is_user32) // ONLY DO FFE090 SEARCHES WHEN IN USER32 continue for (offset = 0 pattern[pattern_index].length + offset &lt;= PAGE_SIZE ++offset) { const auto pattern_matches = memory::pattern_match(&amp;address[offset], pattern[pattern_index // BASIC PATTERN MATCH if (pattern_matches) { // PATTERN FOUND IN MEMORY pattern_report.unknown = 0 pattern_report.report_id = 0x35 pattern_report.type = pattern[index].header pattern_report.data = &amp;address[offset pattern_report.base_address = memory_information.base_address pattern_report.region_size = memory_information.region_size pattern_report.memory_info = memory_information.type | memory_information.protect | memory_information.state battleye::report(&amp;pattern_report, sizeof(pattern_report), 0 } } } } }</span></span></code> </pre> <br><h1>  рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореЙрдбреНрдпреВрд▓ рдХреА рдорд╛рдиреНрдпрддрд╛ (Microsoft) </h1><br>  рдореЙрдбреНрдпреВрд▓ рдЪреЗрдХ рдЦреЗрд▓ рдореЗрдВ рд▓реЛрдб рдХрд┐рдП рдЧрдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореЙрдбреНрдпреВрд▓ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> memory::module_specific_check_microsoft(MEMORY_BASIC_INFORMATION memory_information) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> executable = memory_information.protect == PAGE_EXECUTE || memory_information.protect == PAGE_EXECUTE_READ || memory_information.protect == PAGE_EXECUTE_READWRITE <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> allocated = memory_information.state == MEM_COMMIT <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!allocated || !executable) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> mmres_handle = GetModuleHandleA(<span class="hljs-string"><span class="hljs-string">"mmres.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> mshtml_handle = GetModuleHandleA(<span class="hljs-string"><span class="hljs-string">"mshtml.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mmres_handle &amp;&amp; mmres_handle == memory_information.allocation_base) { battleye_module_anomaly_report module_anomaly_report module_anomaly_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> module_anomaly_report.report_id = <span class="hljs-number"><span class="hljs-number">0x5B</span></span> module_anomaly_report.identifier = <span class="hljs-number"><span class="hljs-number">0x3480</span></span> module_anomaly_report.region_size = memory_information.region_size battleye::report(&amp;module_anomaly_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(module_anomaly_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mshtml_handle &amp;&amp; mshtml_handle == memory_information.allocation_base) { battleye_module_anomaly_report module_anomaly_report module_anomaly_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> module_anomaly_report.report_id = <span class="hljs-number"><span class="hljs-number">0x5B</span></span> module_anomaly_report.identifier = <span class="hljs-number"><span class="hljs-number">0xB480</span></span> module_anomaly_report.region_size = memory_information.region_size battleye::report(&amp;module_anomaly_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(module_anomaly_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } }</code> </pre> <br><h1>  рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореЙрдбреНрдпреВрд▓ рдХреА рдЬрд╛рдБрдЪ (рдЕрдЬреНрдЮрд╛рдд) </h1><br>  рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдПрдХ рдЪреЗрдХ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рд╕рд░реНрд╡рд░ рдХреЛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рд▓реЛрдб рдХрд┐рдП рдЧрдП рдореЙрдбреНрдпреВрд▓ рд╣реИрдВ рдЬреЛ рдЗрди рдорд╛рдирджрдВрдбреЛрдВ рдореЗрдВ рд╕реЗ <em>рдХрд┐рд╕реА</em> рдХреЛ <em>рднреА</em> рд╕рдВрддреБрд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> memory::module_specific_check_unknown(MEMORY_BASIC_INFORMATION memory_information) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> dos_header = (DOS_HEADER*)module_handle <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> pe_header = (PE_HEADER*)(module_handle + dos_header-&gt;e_lfanew <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> is_image = memory_information.state == MEM_COMMIT &amp;&amp; memory_information.type == MEM_IMAGE <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!is_image) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> is_base = memory_information.base_address == memory_information.allocation_base <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!is_base) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> match_1 = time_date_stamp == <span class="hljs-number"><span class="hljs-number">0x5B12C900</span></span> &amp;&amp; *(__int8*)(memory_information.base_address + <span class="hljs-number"><span class="hljs-number">0x1000</span></span>) == <span class="hljs-number"><span class="hljs-number">0x00</span></span> &amp;&amp; *(__int32*)(memory_information.base_address + <span class="hljs-number"><span class="hljs-number">0x501000</span></span>) != <span class="hljs-number"><span class="hljs-number">0x353E900</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> match_2 = time_date_stamp == <span class="hljs-number"><span class="hljs-number">0x5A180C35</span></span> &amp;&amp; *(__int8*)(memory_information.base_address + <span class="hljs-number"><span class="hljs-number">0x1000</span></span>) != <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> match_2 = time_date_stamp == <span class="hljs-number"><span class="hljs-number">0xFC9B9325</span></span> &amp;&amp; *(__int8*)(memory_information.base_address + <span class="hljs-number"><span class="hljs-number">0x6D3000</span></span>) != <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!match_1 &amp;&amp; !match_2 &amp;&amp; !match_3) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> buffer_offset = <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-comment"><span class="hljs-comment">// OFFSET DEPENDS ON WHICH MODULE MATCHES, RESPECTIVELY 0x501000, 0x1000 AND 0x6D3000 unknown_module_report.unknown1 = 0 unknown_module_report.report_id = 0x46 unknown_module_report.unknown2 = 1 unknown_module_report.data = *(__int128*)(memory_information.base_address + buffer_offset battleye::report(&amp;unknown_module_report, sizeof(unknown_module_report), 0 }</span></span></code> </pre> <br>  рд╣рдореЗрдВ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдХреМрди рд╕реЗ рдореЙрдбреНрдпреВрд▓ рдЗрди рдорд╛рдирджрдВрдбреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рд╕рдВрджреЗрд╣ рд╣реИ рдХрд┐ рдпрд╣ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдзреЛрдЦрд╛ рдореЙрдбреНрдпреВрд▓ рдХреЗ рдмрд╣реБрдд рд╕реАрдорд┐рдд рд╕реЗрдЯ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдПрдХ рдкреНрд░рдпрд╛рд╕ рд╣реИред <br><br>  рдкрд░рд┐рд╢рд┐рд╖реНрдЯ: @ how02 рдиреЗ рд╣рдореЗрдВ рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ рдХрд┐ <code>action_x64.dll</code> рдореЙрдбреНрдпреВрд▓ рдореЗрдВ <code>action_x64.dll</code> рдХрд╛ рдЯрд╛рдЗрдо <code>0x5B12C900</code> рдФрд░ рдЗрд╕рдореЗрдВ рдПрдХ рдХреЛрдб рдХреНрд╖реЗрддреНрд░ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдк рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ;  рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╢реЛрд╖рдг рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br><h1>  рд╕реНрдореГрддрд┐ рдХреА рд╕реБрд░рдХреНрд╖рд╛ </h1><br>  рдмреИрдЯрд▓рдПрдИрдИ рдПрдХ рдмрд╣реБрдд рд╣реА рд╕рдВрджрд┐рдЧреНрдз рдкрд╣рдЪрд╛рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рднреА рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ, рд╣рдорд╛рд░реА рд░рд╛рдп рдореЗрдВ, <em>PAGE_GUARD</em> рдзреНрд╡рдЬ <em>рд╕реЗрдЯ рдХреЗ</em> рд╕рд╛рде рдореЗрдореЛрд░реА рдХреА рддрд▓рд╛рд╢ <em>рдХрд░рддрд╛ рд╣реИ</em> , рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдмрд┐рдирд╛ <em>рдЬрд╛рдВрдЪреЗ</em> рдХрд┐ рдХреНрдпрд╛ <em>PAGE_GUARD</em> рдзреНрд╡рдЬ <em>рд╕реЗрдЯ рд╣реИ</em> : <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> memory::guard_check(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* current_address, MEMORY_BASIC_INFORMATION memory_information) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (memory_information.protect != PAGE_NOACCESS) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> bad_ptr = IsBadReadPtr(current_address, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(temporary_buffer <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> read = NtReadVirtualMemory( GetCurrentProcess(), current_address, temporary_buffer, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(temporary_buffer), <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (read &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || bad_ptr) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> query = NtQueryVirtualMemory( GetCurrentProcess(), current_address, <span class="hljs-number"><span class="hljs-number">0</span></span>, &amp;new_memory_information, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(new_memory_information), &amp;return_length memory_guard_report.guard = query &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || new_memory_information.state != memory_information.state || new_memory_information.protect != memory_information.protect <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (memory_guard_report.guard) { memory_guard_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> memory_guard_report.report_id = <span class="hljs-number"><span class="hljs-number">0x21</span></span> memory_guard_report.base_address = memory_information.base_address memory_guard_report.region_size = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)memory_information.region_size memory_guard_report.memory_info = memory_information.type | memory_information.protect | memory_information.state battleye::report(&amp;memory_guard_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(memory_guard_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } } } }</code> </pre> <br><h2>  рд╡рд┐рдВрдбреЛ рд╕реЙрд░реНрдЯрд┐рдВрдЧ </h2><br>  рд╢реЗрд▓ рдХреЛрдб BattlEye рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рдВрдбреЛ рдкрд░ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ рдЬреЛ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЧреЗрдо рдХреЗ рджреМрд░рд╛рди рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ, рдКрдкрд░ рд╕реЗ рдиреАрдЪреЗ рддрдХ (z- рдорд╛рди рджреНрд╡рд╛рд░рд╛) рдЦрд┐рдбрд╝рдХрд┐рдпреЛрдВ рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рддрд╛ рд╣реИред  рдЧреЗрдо рдХреЗ рдЕрдВрджрд░ рд╡рд┐рдВрдбреЛ <code>GetWindowThreadProcessId</code> рдХреЛ рдЗрд╕ рдПрдиреНрдпреВрдорд░реЗрд╢рди рд╕реЗ рдмрд╛рд╣рд░ рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЗрд╕реЗ <code>GetWindowThreadProcessId</code> рдХреЙрд▓ рдХрд░рдХреЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдЖрдк рд╡рд┐рдВрдбреЛ рдХреЗ рдЭреВрдареЗ рдорд╛рд▓рд┐рдХ рдХреЛ рд╕рдВрдмрдВрдзрд┐рдд рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмрд╛рдБрдз рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ <strong>рдмреИрдЯрд▓рдПрдИ рдЖрдкрдХреА рд╡рд┐рдВрдбреЛ рдХреА рдЬрд╛рдВрдЪ рди рдХрд░реЗрдВ</strong> ред <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> window_handler::enumerate() { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> window_handle = GetTopWindow window_handle window_handle = GetWindow(window_handle, GW_HWNDNEXT), <span class="hljs-comment"><span class="hljs-comment">// GET WINDOW BELOW ++window_handler::windows_enumerated) // INCREMENT GLOBAL COUNT FOR LATER USAGE { auto window_process_pid = 0 GetWindowThreadProcessId(window_handle, &amp;window_process_pid if (window_process_pid == GetCurrentProcessId()) continue // APPEND INFORMATION TO THE MISC. REPORT, THIS IS EXPLAINED LATER IN THE ARTICLE window_handler::handle_summary(window_handle constexpr auto max_character_count = 0x80 const auto length = GetWindowTextA(window_handle, window_title_report.window_title, max_character_count // DOES WINDOW TITLE MATCH ANY OF THE BLACKLISTED TITLES? if (!contains(window_title_report.window_title, "CheatAut") &amp;&amp; !contains(window_title_report.window_title, "pubg_kh") &amp;&amp; !contains(window_title_report.window_title, "conl -") &amp;&amp; !contains(window_title_report.window_title, "PerfectA") &amp;&amp; !contains(window_title_report.window_title, "AIMWA") &amp;&amp; !contains(window_title_report.window_title, "PUBG AIM") &amp;&amp; !contains(window_title_report.window_title, "HyperChe")) continue // REPORT WINDOW window_title_report.unknown_1 = 0 window_title_report.report_id = 0x33 battleye::report(&amp;window_title_report, sizeof(window_title_report) + length, 0 } }</span></span></code> </pre> <br><h2>  рд╡рд┐рд╕рдВрдЧрддрд┐ рдЦреЛрдЬреЗрдВ </h2><br>  рдпрджрд┐ рджреЛ рд╕реЗ рдХрдо рд╡рд┐рдВрдбреЛрдЬрд╝ рдХреА рдЬрд╛рдБрдЪ рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рд╕реВрдЪрдирд╛ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИред  рдпрд╣ рд╕рдВрднрд╡рддрдГ рд╕рдВрдмрдВрдзрд┐рдд рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдкреИрдЪрд┐рдВрдЧ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдХрд┐рд╕реА рднреА рд╡рд┐рдВрдбреЛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП BattlEye рд╢реЗрд▓ рдХреЛрдб рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддреЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> window_handler::check_count() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (window_handler::windows_enumerated &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-comment"><span class="hljs-comment">// WINDOW ENUMERATION FAILED, MOST LIKELY DUE TO HOOK window_anomaly_report.unknown_1 = 0 window_anomaly_report.report_id = 0x44 window_anomaly_report.enumerated_windows = windows_enumerated battleye::report(&amp;window_anomaly_report, sizeof(window_anomaly_report), 0 }</span></span></code> </pre> <br><h2>  рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЫрдБрдЯрд╛рдИ </h2><br>  <code>CreateToolhelp32Snapshot</code> рдХреЙрд▓ рдХрд░рдХреЗ рд╕рднреА рдЪрд▓ рд░рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдкрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ <strong>рдХрд░рддрд╛ рд╣реИ</strong> , рд▓реЗрдХрд┐рди <strong>рдХрд┐рд╕реА рднреА рддреНрд░реБрдЯрд┐ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ</strong> , рдЬрд┐рд╕рд╕реЗ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рд╕реЗ рдмрдЪ рдЬрд╛рддрд╛ рд╣реИ: <br><br><h1>  рдкрде рдХреА рдЬрд╛рдБрдЪ </h1><br>  рдпрджрд┐ рдЫрд╡рд┐ рдХрдо рд╕реЗ рдХрдо рджреЛ рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ (рдбрд┐рд╕реНрдХ рдХреА рдЬрдбрд╝ рд╕реЗ рдЧрд┐рдирддреА) рдХреЗ рдЕрдВрджрд░ рд╣реИ, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдЙрди рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░реЗрдЧрд╛ рдпрджрд┐ рд╕рдВрдмрдВрдзрд┐рдд рдЫрд╡рд┐ рдХреЗ рдкрде рдореЗрдВ рдЗрдирдореЗрдВ рд╕реЗ рдХрдо рд╕реЗ рдХрдо рдПрдХ рдкрдВрдХреНрддрд┐ рд╢рд╛рдорд┐рд▓ рд╣реИ: <br><br><pre> <code class="cpp hljs">Desktop Temp FileRec Documents Downloads Roaming tmp.ex notepad. ...\. cmd.ex</code> </pre> <br>  рдпрджрд┐ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрде рдЗрди рдкрдВрдХреНрддрд┐рдпреЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рд░реНрд╡рд░ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓ рдХреЗ рдкрде рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рд╕реВрдЪрдирд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдорд╛рддрд╛-рдкрд┐рддрд╛ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд┐рдореНрди рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ (рдХреНрдпрд╛ рд╕рдВрдмрдВрдзрд┐рдд рдзреНрд╡рдЬ рдмрд┐рдЯ рд╕рд░реНрд╡рд░ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ): <br><br><pre> <code class="cpp hljs">steam.exe [<span class="hljs-number"><span class="hljs-number">0x01</span></span>] explorer.exe [<span class="hljs-number"><span class="hljs-number">0x02</span></span>] lsass.exe [<span class="hljs-number"><span class="hljs-number">0x08</span></span>] cmd.exe [<span class="hljs-number"><span class="hljs-number">0x10</span></span>]</code> </pre> <br>  рдпрджрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдХреЛ рдЙрдкрдпреБрдХреНрдд <code>QueryLimitedInformation</code> рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдирд╣реАрдВ рдЦреЛрд▓ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдлреНрд▓реИрдЧ рдмрд┐рдЯ <code>QueryLimitedInformation</code> рд╕реЗрдЯ рдХрд░реЗрдЧрд╛, рдпрджрд┐ <code>OpenProcess</code> рдХреЙрд▓ рд╡рд┐рдлрд▓ рд╣реЛрдиреЗ рдкрд░ рддреНрд░реБрдЯрд┐ рдХрд╛ рдХрд╛рд░рдг <code>ERROR_ACCESS_DENIED</code> рдирд╣реАрдВ рд╣реИ, рдЬреЛ рд╣рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдзреНрд╡рдЬ рдорд╛рди рдХреЗ рд▓рд┐рдП рдЕрдВрддрд┐рдо рдЧрдгрдирд╛ рдХрдВрдЯреЗрдирд░ рджреЗрддрд╛ рд╣реИ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> BATTLEYE_PROCESS_FLAG { STEAM = <span class="hljs-number"><span class="hljs-number">0x1</span></span>, EXPLORER = <span class="hljs-number"><span class="hljs-number">0x2</span></span>, ERROR = <span class="hljs-number"><span class="hljs-number">0x4</span></span>, LSASS = <span class="hljs-number"><span class="hljs-number">0x8</span></span>, CMD = <span class="hljs-number"><span class="hljs-number">0x10</span></span> }</code> </pre> <br>  рдпрджрд┐ рдореВрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рднрд╛рдк рд╣реИ, рддреЛ рдЭрдВрдбреЗ рдХреЛ рддреБрд░рдВрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЛ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рд╕реВрдЪрдирд╛ рдЖрдИрдбреА <code>0x40</code> рд╕рд╛рде рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ <code>0x40</code> <br><br><h1>  рдЫрд╡рд┐ рдХрд╛ рдирд╛рдо </h1><br>  рдпрджрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдиреАрдЪреЗ рдкреНрд░рд╕реНрддреБрдд рдХрдИ рдорд╛рдирджрдВрдбреЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рд╕реЗ рдорд┐рд▓рддреА рд╣реИ, рддреЛ рдЖрдк рддреБрд░рдВрдд рдПрдХ рдзреНрд╡рдЬ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рд╕рд░реНрд╡рд░ рдХреЛ рд╕реВрдЪрдирд╛ рдЖрдИрдбреА <code>0x38</code> рд╕рд╛рде рд╕реВрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ <br><br><pre> <code class="cpp hljs">   <span class="hljs-string"><span class="hljs-string">"Loadlibr"</span></span>    <span class="hljs-string"><span class="hljs-string">"Rng "</span></span>    <span class="hljs-string"><span class="hljs-string">"A0E7FFFFFF81"</span></span>    <span class="hljs-string"><span class="hljs-string">"RNG "</span></span>    <span class="hljs-string"><span class="hljs-string">"90E54355"</span></span>    <span class="hljs-string"><span class="hljs-string">"2.6.ex"</span></span>    <span class="hljs-string"><span class="hljs-string">"TempFile.exe"</span></span></code> </pre> <br><h1>  рд╕реНрдЯреАрдо рдЧреЗрдо рдУрд╡рд░рд▓реЗ </h1><br>  рдмреИрдЯрд▓рдПрдИ рд╕реНрдЯреАрдо рдЧреЗрдо рдУрд╡рд░рд▓реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЗрди-рдЧреЗрдо рдУрд╡рд░рд▓реЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИ, рдЬреЛ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕реНрдЯреАрдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╕реНрдЯреАрдо рдЧреЗрдореНрд╕ рдУрд╡рд░рд▓реЗ рдХрд╛ рдкреВрд░рд╛ рд╣реЛрд╕реНрдЯ рдирд╛рдо <code>gameoverlayui.exe</code> ;  рдпрд╣ рдЬреНрдЮрд╛рдд рд╣реИ рдХрд┐ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдХреНрд╕рд░ рд╢реЛрд╖рдг рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЧреЗрдо рд╡рд┐рдВрдбреЛ рдореЗрдВ рдЕрд╡реИрдз рд░реЗрдВрдбрд░рд┐рдВрдЧ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдФрд░ рдкреНрд░рджрд░реНрд╢рди рдХрд░рдирд╛ рдХрд╛рдлреА рдЖрд╕рд╛рди рд╣реИред  рд╕рддреНрдпрд╛рдкрди рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд┐рддрд┐ рд╣реИ: <br><br><pre> <code class="cpp hljs">file size != <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; image name contains (<span class="hljs-keyword"><span class="hljs-keyword">case</span></span> insensitive) gameoverlayu</code> </pre> <br>  рд╕реНрдЯреАрдо рдЧреЗрдо рдХреЗ рдУрд╡рд░рд▓реЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЪреЗрдХ рдЧреЗрдо рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдХреА рдЧрдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рдЧрднрдЧ рд╕рдорд╛рди рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП, рдЫрджреНрдо рдХреЛрдб рдореЗрдВ рдЫреЛрдбрд╝ рджрд┐рдП рдЧрдП рд╣реИрдВред <br><br><h1>  рд╕реНрдЯреАрдо рдУрд╡рд░рд▓реЗ рдореЗрдореЛрд░реА рд╕реНрдХреИрди </h1><br>  рд╕реНрдЯреАрдо рдЧреЗрдо рдХреЛ рдУрд╡рд░рд▓реЗ рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреИрдЯрд░реНрди рдФрд░ рд╡рд┐рд╕рдВрдЧрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реНрдХреИрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╣рдо рдЦрд░рдЧреЛрд╢ рдХреЗ рдЫреЗрдж рдореЗрдВ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рдереЗ, рдФрд░ рдкрддрд╛ рд▓рдЧрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдпреЗ рдкреИрдЯрд░реНрди рдХрд┐рд╕ рд▓рд┐рдП рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдмрд╣реБрдд рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд рд╣реИрдВ рдФрд░ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рдзреЛрдЦрд╛ рдореЙрдбреНрдпреВрд▓ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реИрдВред <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> gameoverlay::pattern_scan(MEMORY_BASIC_INFORMATION memory_information) { <span class="hljs-comment"><span class="hljs-comment">// PATTERNS: // Home // F1 // FFFF83C48C30000000000 // \.pipe%s // C760000C64730 // 60C01810033D2 // ... // PATTERN SCAN, ALMOST IDENTICAL CODE TO THE AFOREMENTIONED PATTERN SCANNING ROUTINE gameoverlay_memory_report.unknown_1 = 0 gameoverlay_memory_report.report_id = 0x35 gameoverlay_memory_report.identifier = 0x56C gameoverlay_memory_report.data = &amp;buffer[offset gameoverlay_memory_report.base_address = memory_information.base_address gameoverlay_memory_report.region_size = (int)memory_information.region_size gameoverlay_memory_report.memory_info = memory_information.type | memory_information.protect | memory_information.state battleye::report(&amp;gameoverlay_memory_report, sizeof(gameoverlay_memory_report), 0 }</span></span></code> </pre> <br>  рд╕реНрдХреИрдирд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рднреА рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рдмрд╛рд╣рд░ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдХреЛрдб рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рд╕реА рднреА рд╡рд┐рд╕рдВрдЧрддрд┐ рдХреА рддрд▓рд╛рд╢ рдХрд░рддреА рд╣реИ, рдпрд╣ рд╕реБрдЭрд╛рд╡ рджреЗрддреЗ рд╣реБрдП рдХрд┐ рдкрдЯрд╛рдЦреЗ рдУрд╡рд░рд▓реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдХреЛрдб рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> gameoverlay::memory_anomaly_scan(MEMORY_BASIC_INFORMATION memory_information) { <span class="hljs-comment"><span class="hljs-comment">// ... // ALMOST IDENTICAL ANOMALY SCAN COMPARED TO MEMORY ENUMERATION ROUTINE OF GAME PROCESS gameoverlay_report.unknown = 0 gameoverlay_report.report_id = 0x3B gameoverlay_report.base_address = memory_information.base_address gameoverlay_report.region_size = memory_information.region_size gameoverlay_report.memory_info = memory_information.type | memory_information.protect | memory_information.state battleye::report(&amp;gameoverlay_report, sizeof(gameoverlay_report), 0 }</span></span></code> </pre> <br><h1>  рд╕реНрдЯреАрдо рдЧреЗрдо рдУрд╡рд░рд▓реЗ рд╕реБрд░рдХреНрд╖рд╛ </h1><br>  рдпрджрд┐ рд╕реНрдЯреАрдо рдЧреЗрдо рдХреЛ рдУрд╡рд░рд▓реЗ рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╡рд┐рдВрдбреЛрдЬ рдХреА рдХреБрдЫ рд╕реБрд░рдХреНрд╖рд╛ рдЬреИрд╕реЗ <em>рд▓рд╛рдЗрдЯ (рд╡рд┐рдирдЯреЗрдХ)</em> рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рд░реНрд╡рд░ рдХреЛ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рд╕реВрдЪрдирд╛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧреАред <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> gameoverlay::protection_check(HANDLE process_handle) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> process_protection = <span class="hljs-number"><span class="hljs-number">0</span></span> NtQueryInformationProcess( process_handle, ProcessProtectionInformation, &amp;process_protection, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(process_protection), <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (process_protection == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">// NO PROTECTION return gameoverlay_protected_report.unknown = 0 gameoverlay_protected_report.report_id = 0x35 gameoverlay_protected_report.identifier = 0x5B1 gameoverlay_protected_report.data = process_protection battleye::report(&amp;gameoverlay_protected_report, sizeof(gameoverlay_protected_report), 0 }</span></span></code> </pre> <br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рд╕рдВрдмрдВрдзрд┐рдд <em>рдУрдкрдирдкреНрд░реЛрд╕реЗрд╕</em> рдХреЙрд▓, <em>ERROR_ACCESS_DENIED</em> рдХреЛ рдУрд╡рд░рд▓реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд▓реМрдЯрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдИрдбреА <code>3B</code> рд╕рд╛рде рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рд╕реВрдЪрдирд╛ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИред <br><br><h1>  рдХреНрд░рдордмрджреНрдз рдореЙрдбреНрдпреВрд▓ </h1><br>  рд╕реНрдЯреАрдо рдЧреЗрдо рдУрд╡рд░рд▓реЗ рдкреНрд░реЛрд╕реЗрд╕ рдореЙрдбреНрдпреВрд▓ рднреА рдЦреЛрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, <code>vgui2_s.dll</code> рдФрд░ <code>gameoverlayui.dll</code> ред  рдЗрди рдореЙрдбреНрдпреВрд▓ рдХреЗ рд▓рд┐рдП рдХрдИ рдЬрд╛рдБрдЪреЗрдВ рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдЬреЛ <code>gameoverlayui.dll</code> рд╢реБрд░реВ рд╣реЛрддреА рд╣реИрдВред <br><br>  рдпрджрд┐ рдпрд╣ рд╢рд░реНрдд рдкреВрд░реА рд╣реЛ рдЬрд╛рддреА рд╣реИ: <code>[gameoverlayui.dll+6C779] == 08BE55DC3CCCCB8????????C3CCCCCC</code> , рддреЛ <code>[gameoverlayui.dll+6C779] == 08BE55DC3CCCCB8????????C3CCCCCC</code> рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдкрддреЗ рдкрд░ vtable рдХреЛ рд╕реНрдХреИрди рдХрд░рддрд╛ рд╣реИ <code>????????</code>  ред  рдпрджрд┐ рдЗрдирдореЗрдВ рд╕реЗ рдХреЛрдИ рднреА рд╡реНрдпрд╡рд╣рд╛рд░реНрдп рддрддреНрд╡ рд╕реНрд░реЛрдд рдореЙрдбреНрдпреВрд▓ gameoverlayui.dll рдХреЗ рдмрд╛рд╣рд░ рд╣реИ рдпрд╛ рдПрдХ <code>int 3</code> рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ <code>3B</code> рдХреА рдЕрдзрд┐рд╕реВрдЪрдирд╛ рдЖрдИрдбреА рдХреЗ рд╕рд╛рде рд╕рд░реНрд╡рд░ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> gameoverlay::scan_vtable(HANDLE process_handle, <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* buffer, MODULEENTRY32 module_entry) { <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> function_buffer[<span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (vtable_index = <span class="hljs-number"><span class="hljs-number">0</span></span> vtable_index &lt; <span class="hljs-number"><span class="hljs-number">20</span></span> vtable_index += <span class="hljs-number"><span class="hljs-number">4</span></span>) { NtReadVirtualMemory( process_handle, *(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>*)&amp;buffer[vtable_index], &amp;function_buffer, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(function_buffer), <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (*(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>*)&amp;buffer[vtable_index] &lt; module_entry.modBaseAddr || *(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>*)&amp;buffer[vtable_index] &gt;= module_entry.modBaseAddr + module_entry.modBaseSize || function_buffer[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-number"><span class="hljs-number">0xCC</span></span> ) <span class="hljs-comment"><span class="hljs-comment">// FUNCTION PADDING { gameoverlay_vtable_report.report_id = 0x3B gameoverlay_vtable_report.vtable_index = vtable_index gameoverlay_vtable_report.address = buffer[vtable_index battleye::report(&amp;gameoverlay_vtable_report, sizeof(gameoverlay_vtable_report), 0 } } }</span></span></code> </pre> <br>  <code>vgui2_s.dll</code> рдореЙрдбреНрдпреВрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рддреНрдпрд╛рдкрди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рднреА рдХреА <code>vgui2_s.dll</code> рд╣реИ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> vgui::scan() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!equals(vgui_buffer, <span class="hljs-string"><span class="hljs-string">"6A08B31FF561C8BD??????????FF96????????8BD????????8B1FF90"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> could_read = NtReadVirtualMemory( process_handle, module_entry.modBaseAddr + <span class="hljs-number"><span class="hljs-number">0x48338</span></span>, vgui_buffer, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> pattern_offset = <span class="hljs-number"><span class="hljs-number">0x48378</span></span> <span class="hljs-comment"><span class="hljs-comment">// IF READ DID NOT FAIL AND PATTERN IS FOUND if (could_read &amp;&amp; equals(vgui_buffer, "6A46A06A26A")) { vgui_report.unknown_1 = 0 vgui_report.report_id = 0x3B vgui_report.unknown_2 = 0 vgui_report.address = LODWORD(module_entry.modBaseAddr) + pattern_offset // READ TARGET BUFFER INTO REPORT NtReadVirtualMemory( process_handle, module_entry.modBaseAddr + pattern_offset, vgui_report.buffer, sizeof(vgui_report.buffer), 0 battleye::report(&amp;vgui_report, sizeof(vgui_report), 0 } } else if ( // READ ADDRESS FROM CODE NtReadVirtualMemory(process_handle, *(int*)&amp;vgui_buffer[9], vgui_buffer, 4, 0) &gt;= 0 &amp;&amp; // READ POINTER TO CLASS NtReadVirtualMemory(process_handle, *(int*)vgui_buffer, vgui_buffer, 4, 0) &gt;= 0 &amp;&amp; // READ POINTER TO VIRTUAL TABLE NtReadVirtualMemory(process_handle, *(int*)vgui_buffer, vgui_buffer, sizeof(vgui_buffer), 0) &gt;= 0) { for (vtable_index = 0 vtable_index &lt; 984 vtable_index += 4 ) // 984/4 VTABLE ENTRY COUNT { NtReadVirtualMemory(process_handle, *(int*)&amp;vgui_buffer[vtable_index], &amp;vtable_entry, sizeof(vtable_entry), 0 if (*(int*)&amp;vgui_buffer[vtable_index] &lt; module_entry.modBaseAddr || *(int*)&amp;vgui_buffer[vtable_index] &gt;= module_entry.modBaseAddr + module_entry.modBaseSize || vtable_entry == 0xCC ) { vgui_vtable_report.unknown = 0 vgui_vtable_report.report_id = 0x3B vgui_vtable_report.vtable_index = vtable_index vgui_vtable_report.address = *(int*)&amp;vgui_buffer[vtable_index battleye::report(&amp;vgui_vtable_report, sizeof(vgui_vtable_report), 0 } } }</span></span></code> </pre> <br>        <code>48378</code> ,     : <br><br><pre> <code class="cpp hljs">push <span class="hljs-number"><span class="hljs-number">04</span></span> push offset aCBuildslaveSte_4 ; <span class="hljs-string"><span class="hljs-string">"c:\buildslave\steam_rel_client_win32"</span></span>... push offset aAssertionFaile_7 ; <span class="hljs-string"><span class="hljs-string">"Assertion Failed: IsValidIndex(elem)"</span></span></code> </pre> <br>          : <br><br><pre> <code class="cpp hljs">push <span class="hljs-number"><span class="hljs-number">04</span></span> push <span class="hljs-number"><span class="hljs-number">00</span></span> push <span class="hljs-number"><span class="hljs-number">02</span></span> push ??</code> </pre> <br>      vgui2_s.dll,       ,    ,  vtable  . <br><br><h1>    Steam </h1><br>      Steam  : <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> gameoverlay::check_thread(THREADENTRY32 thread_entry) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> tread_handle = OpenThread(THREAD_SUSPEND_RESUME|THREAD_GET_CONTEXT, <span class="hljs-number"><span class="hljs-number">0</span></span>, thread_entry.th32ThreadID <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (thread_handle) { suspend_count = ResumeThread(thread_handle <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (suspend_count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { SuspendThread(thread_handle gameoverlay_thread_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> gameoverlay_thread_report.report_id = <span class="hljs-number"><span class="hljs-number">0x3B</span></span> gameoverlay_thread_report.suspend_count = suspend_count battleye::report(&amp;gameoverlay_thread_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(gameoverlay_thread_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GetThreadContext(thread_handle, &amp;context) &amp;&amp; context.Dr7) { gameoverlay_debug_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> gameoverlay_debug_report.report_id = <span class="hljs-number"><span class="hljs-number">0x3B</span></span> gameoverlay_debug_report.debug_register = context.Dr0 battleye::report(&amp;gameoverlay_debug_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(gameoverlay_debug_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } } }</code> </pre> <br><h1> LSASS </h1><br>     Windows <em>lsass.exe</em> ,     Local Security Authority,        ,       : <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (equals(process_entry.executable_path, <span class="hljs-string"><span class="hljs-string">"lsass.exe"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> lsass_handle = OpenProcess(QueryInformation, <span class="hljs-number"><span class="hljs-number">0</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)process_entry.th32ProcessID <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lsass_handle) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (address = <span class="hljs-number"><span class="hljs-number">0</span></span> NtQueryVirtualMemory(lsass_handle, address, <span class="hljs-number"><span class="hljs-number">0</span></span>, &amp;lsass_memory_info, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, &amp;bytes_needed) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> address = lsass_memory_info.base_address + lsass_memory_info.region_size) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lsass_memory_info.state == MEM_COMMIT &amp;&amp; lsass_memory_info.type == MEM_PRIVATE &amp;&amp; (lsass_memory_info.protect == PAGE_EXECUTE || lsass_memory_info.protect == PAGE_EXECUTE_READ || lsass_memory_info.protect == PAGE_EXECUTE_READWRITE)) { <span class="hljs-comment"><span class="hljs-comment">// FOUND EXECUTABLE MEMORY OUTSIDE OF MODULES lsass_report.unknown = 0 lsass_report.report_id = 0x42 lsass_report.base_address = lsass_memory_info.base_address lsass_report.region_size = lsass_memory_info.region_size lsass_report.memory_info = lsass_memory_info.type | lsass_memory_info.protect | lsass_memory_info.state battleye::report(&amp;lsass_report, sizeof(lsass_report), 0 } } CloseHandle(lsass_handle } }</span></span></code> </pre> <br> LSASS         ,    ,   -,      LSASS.    BattlEye    ,       /,    <code>ReadProcessMemory</code> / <code>WriteProcessMemory</code> ,      BEDaisy.  BEDaisy ,      .   ,   ,    ,         . <br><br><h2>   </h2><br> BattlEye         id  <code>3C</code> .      : <br><br><ul><li>     <em>WS_EX_TOPMOST</em>   : <ul><li>   (Unicode) </li><li>    (Unicode) </li><li> Window style </li><li> Window extended style </li><li>   </li><li>    - </li><li>   - </li></ul></li><li>        (VM_WRITE|VM_READ) <ul><li>   </li><li>    </li><li>   </li><li>    </li></ul></li><li>    : <br><ul><li> тАж.ContentPaksTslGame-WindowsNoEditor_assets_world.pak </li><li> тАж.ContentPaksTslGame-WindowsNoEditor_ui.pak </li><li> тАж.ContentPaksTslGame-WindowsNoEditor_sound.pak </li></ul><br></li><li>    : <br><ul><li> тАж.BLGameCookedContentScriptBLGame.u </li></ul></li><li>    NtGetContextThread <br><ul><li>     (E9),       </li></ul></li></ul><br><h2> NoEye </h2><br>  BattlEye               NoEye:    <em>GetFileAttributesExA</em>    <code>BE_DLL.dll</code> ,      . <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> noeye::detect() { <span class="hljs-function"><span class="hljs-function">WIN32_FILE_ATTRIBUTE_DATA file_information </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GetFileAttributesExA(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"BE_DLL.dll"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, &amp;file_information))</span></span></span><span class="hljs-function"> </span></span>{ noeye_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> noeye_report.report_id = <span class="hljs-number"><span class="hljs-number">0x3D</span></span> noeye_report.file_size = file_information.nFileSizeLow battleye::report(&amp;noeye_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(noeye_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } }</code> </pre> <br><h2>   </h2><br>    Beep  Null;      .          ,      ,  -   .    driver device hijacking.    ,     IOCTL           . <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> driver::check_beep() { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> handle = CreateFileA(<span class="hljs-string"><span class="hljs-string">"\\.\Beep"</span></span>, GENERIC_READ, FILE_SHARE_READ | FILE_SHARE_WRITE, <span class="hljs-number"><span class="hljs-number">0</span></span>, OPEN_EXISTING, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (handle != INVALID_HANDLE_VALUE) { beep_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> beep_report.report_id = <span class="hljs-number"><span class="hljs-number">0x3E</span></span> battleye::report(&amp;beep_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(beep_report), <span class="hljs-number"><span class="hljs-number">0</span></span> CloseHandle(handle } }</code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> driver::check_null() { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> handle = CreateFileA(<span class="hljs-string"><span class="hljs-string">"\\.\Null"</span></span>, GENERIC_READ, FILE_SHARE_READ | FILE_SHARE_WRITE, <span class="hljs-number"><span class="hljs-number">0</span></span>, OPEN_EXISTING, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (handle != INVALID_HANDLE_VALUE) { null_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> null_report.report_id = <span class="hljs-number"><span class="hljs-number">0x3E</span></span> battleye::report(&amp;null_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(null_report), <span class="hljs-number"><span class="hljs-number">0</span></span> CloseHandle(handle } }</code> </pre> <br><h2> Sleep delta </h2><br>  , BattlEye                  (sleep): <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> sleep::check_delta() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> tick_count = GetTickCount Sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> tick_delta = GetTickCount() - tick_count <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tick_delta &gt;= <span class="hljs-number"><span class="hljs-number">1200</span></span>) { sleep_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> sleep_report.report_id = <span class="hljs-number"><span class="hljs-number">0x45</span></span> sleep_report.delta = tick_delta battleye::report(&amp;sleep_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(sleep_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } }</code> </pre> <br><h2> 7zip </h2><br>  BattlEye     ,       7zip      .   ,          .  BattlEye          7zip. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>::check_7zip() { <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> sz_7zipdll = <span class="hljs-string"><span class="hljs-string">"..\..\Plugins\ZipUtility\ThirdParty\7zpp\dll\Win64\7z.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> module_handle = GetModuleHandleA(sz_7zipdll <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (module_handle &amp;&amp; *(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>*)(module_handle + <span class="hljs-number"><span class="hljs-number">0x1000</span></span>) != <span class="hljs-number"><span class="hljs-number">0xFF1441C7</span></span>) { sevenzip_report.unknown_1 = <span class="hljs-number"><span class="hljs-number">0</span></span> sevenzip_report.report_id = <span class="hljs-number"><span class="hljs-number">0x46</span></span> sevenzip_report.unknown_2 = <span class="hljs-number"><span class="hljs-number">0</span></span> sevenzip_report.data1 = *(__int64*)(module_handle + <span class="hljs-number"><span class="hljs-number">0x1000</span></span> sevenzip_report.data2 = *(__int64*)(module_handle + <span class="hljs-number"><span class="hljs-number">0x1008</span></span> battleye::report(&amp;sevenzip_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(sevenzip_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } }</code> </pre> <br><h2>    </h2><br> BattlEye         Windows (hal.dll),   ,      . <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>::check_hal() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> module_handle = GetModuleHandleA(<span class="hljs-string"><span class="hljs-string">"hal.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (module_handle) { hal_report.unknown_1 = <span class="hljs-number"><span class="hljs-number">0</span></span> hal_report.report_id = <span class="hljs-number"><span class="hljs-number">0x46</span></span> hal_report.unknown_2 = <span class="hljs-number"><span class="hljs-number">2</span></span> hal_report.data1 = *(__int64*)(module_handle + <span class="hljs-number"><span class="hljs-number">0x1000</span></span> hal_report.data2 = *(__int64*)(module_handle + <span class="hljs-number"><span class="hljs-number">0x1008</span></span> battleye::report(&amp;hal_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(hal_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } }</code> </pre> <br><h2>   </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреИрдЯрд▓рдПрдИрдИ рдЦреЗрд▓ рдореЗрдВ рднрд░реА рд╣реБрдИ рд╡рд┐рднрд┐рдиреНрди рдЫрд╡рд┐рдпреЛрдВ рдХреА рднреА рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрди рдореЙрдбреНрдпреВрд▓реНрд╕ рдореЗрдВ рдХрдерд┐рдд рд░реВрдк рд╕реЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдЫрд╡рд┐рдпрд╛рдВ рд╣реИрдВ рдЬреЛ рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рд╣реЗрд░рдлреЗрд░ рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдЙрдирдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд░реВрдк рд╕реЗ рдмрджрд▓ рджреЗрддреА рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдо рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдХреБрдЫ рдирд╣реАрдВ рдХрд╣ рд╕рдХрддреЗ рд╣реИрдВ, рдХреЗрд╡рд▓ рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nvToolsExt64_1 </font></font></h1><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>::check_nvtoolsext64_1 { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> module_handle = GetModuleHandleA(<span class="hljs-string"><span class="hljs-string">"nvToolsExt64_1.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (module_handle) { nvtools_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> nvtools_report.report_id = <span class="hljs-number"><span class="hljs-number">0x48</span></span> nvtools_report.module_id = <span class="hljs-number"><span class="hljs-number">0x5A8</span></span> nvtools_report.size_of_image = (PE_HEADER*)(module_handle + (DOS_HEADER*)(module_handle)-&gt;e_lfanew))-&gt;SizeOfImage battleye::report(&amp;nvtools_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(nvtools_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } }</code> </pre> <br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ws2detour_x96 </font></font></h1><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>::check_ws2detour_x96 { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> module_handle = GetModuleHandleA(<span class="hljs-string"><span class="hljs-string">"ws2detour_x96.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (module_handle) { ws2detour_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> ws2detour_report.report_id = <span class="hljs-number"><span class="hljs-number">0x48</span></span> ws2detour_report.module_id = <span class="hljs-number"><span class="hljs-number">0x5B5</span></span> ws2detour_report.size_of_image = (PE_HEADER*)(module_handle + (DOS_HEADER*)(module_handle)-&gt;e_lfanew))-&gt;SizeOfImage battleye::report(&amp;ws2detour_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ws2detour_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } }</code> </pre> <br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> networkdllx64 </font></font></h1><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>::check_networkdllx64 { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> module_handle = GetModuleHandleA(<span class="hljs-string"><span class="hljs-string">"networkdllx64.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (module_handle) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> dos_header = (DOS_HEADER*)module_handle <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> pe_header = (PE_HEADER*)(module_handle + dos_header-&gt;e_lfanew <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> size_of_image = pe_header-&gt;SizeOfImage <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (size_of_image &lt; <span class="hljs-number"><span class="hljs-number">0x200000</span></span> || size_of_image &gt;= <span class="hljs-number"><span class="hljs-number">0x400000</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pe_header-&gt;sections[DEBUG_DIRECTORY].size == <span class="hljs-number"><span class="hljs-number">0x1B20</span></span>) { networkdll64_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> networkdll64_report.report_id = <span class="hljs-number"><span class="hljs-number">0x48</span></span> networkdll64_report.module_id = <span class="hljs-number"><span class="hljs-number">0x5B7</span></span> networkdll64_report.data = pe_header-&gt;TimeDatestamp battleye::report(&amp;networkdll64_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(networkdll64_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { networkdll64_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> networkdll64_report.report_id = <span class="hljs-number"><span class="hljs-number">0x48</span></span> networkdll64_report.module_id = <span class="hljs-number"><span class="hljs-number">0x5B7</span></span> networkdll64_report.data = pe_header-&gt;sections[DEBUG_DIRECTORY].size battleye::report(&amp;networkdll64_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(networkdll64_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } } }</code> </pre> <br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nxdetours_64 </font></font></h1><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>::check_nxdetours_64 { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> module_handle = GetModuleHandleA(<span class="hljs-string"><span class="hljs-string">"nxdetours_64.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (module_handle) { nxdetours64_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> nxdetours64_report.report_id = <span class="hljs-number"><span class="hljs-number">0x48</span></span> nxdetours64_report.module_id = <span class="hljs-number"><span class="hljs-number">0x5B8</span></span> nxdetours64_report.size_of_image = (PE_HEADER*)(module_handle + (DOS_HEADER*)(module_handle)-&gt;e_lfanew))-&gt;SizeOfImage battleye::report(&amp;nxdetours64_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(nxdetours64_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } }</code> </pre> <br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nvcompiler </font></font></h1><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>::check_nvcompiler { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> module_handle = GetModuleHandleA(<span class="hljs-string"><span class="hljs-string">"nvcompiler.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (module_handle) { nvcompiler_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> nvcompiler_report.report_id = <span class="hljs-number"><span class="hljs-number">0x48</span></span> nvcompiler_report.module_id = <span class="hljs-number"><span class="hljs-number">0x5BC</span></span> nvcompiler_report.data = *(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>*)(module_handle + <span class="hljs-number"><span class="hljs-number">0x1000</span></span> battleye::report(&amp;nvcompiler_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(nvcompiler_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } }</code> </pre> <br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wmp </font></font></h1><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>::check_wmp { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> module_handle = GetModuleHandleA(<span class="hljs-string"><span class="hljs-string">"wmp.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (module_handle) { wmp_report.unknown = <span class="hljs-number"><span class="hljs-number">0</span></span> wmp_report.report_id = <span class="hljs-number"><span class="hljs-number">0x48</span></span> wmp_report.module_id = <span class="hljs-number"><span class="hljs-number">0x5BE</span></span> wmp_report.data = *(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>*)(module_handle + <span class="hljs-number"><span class="hljs-number">0x1000</span></span> battleye::report(&amp;wmp_report, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(wmp_report), <span class="hljs-number"><span class="hljs-number">0</span></span> } }</code> </pre> <br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЙрдбреНрдпреВрд▓ рдЕрднрд┐рдЬреНрдЮрд╛рди рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдВрджрд░реНрдн рдХреЗ рд▓рд┐рдП, рд╣рдо рдореЙрдбреНрдпреВрд▓ рдХреЗ рд▓рд┐рдП рдЧрдгрдирд╛ рдЖрдИрдбреА рджреЗрддреЗ рд╣реИрдВ: </font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> module_id { nvtoolsext64 = <span class="hljs-number"><span class="hljs-number">0x5A8</span></span>, ws2detour_x96 = <span class="hljs-number"><span class="hljs-number">0x5B5</span></span>, networkdll64 = <span class="hljs-number"><span class="hljs-number">0x5B7</span></span>, nxdetours_64 = <span class="hljs-number"><span class="hljs-number">0x5B8</span></span>, nvcompiler = <span class="hljs-number"><span class="hljs-number">0x5BC</span></span>, wmp = <span class="hljs-number"><span class="hljs-number">0x5BE</span></span></code> </pre> <br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЯреАрд╕реАрдкреА рдЯреЗрдмрд▓ рд╕реНрдХреИрди рдХрд░реЗрдВ </font></font></h2><br> - BattlEye    TCP-   (   ┬л TCP┬╗, TCP table)  ,         IP- Cloudflare-,   - pay-to-cheat   <a href="https://xera.ph/">xera.ph</a> .      -   ,       launcher,     .       ,  IP- Cloudflare-    .        ,       ,         . <br><br>    pay-to-cheat <em>xera.ph</em>      ,   ,        .     <em>xera.ph</em> ,       ,          ,  ,       .    , , ,         ,  -,  ,    . <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> network::scan_tcp_table { <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(local_port_buffer, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(local_port_buffer <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (iteration_index = <span class="hljs-number"><span class="hljs-number">0</span></span> iteration_index &lt; <span class="hljs-number"><span class="hljs-number">500</span></span> ++iteration_index) { <span class="hljs-comment"><span class="hljs-comment">// GET NECESSARY SIZE OF TCP TABLE auto table_size = 0 GetExtendedTcpTable(0, &amp;table_size, false, AF_INET, TCP_TABLE_OWNER_MODULE_ALL, 0 // ALLOCATE BUFFER OF PROPER SIZE FOR TCP TABLE auto allocated_ip_table = (MIB_TCPTABLE_OWNER_MODULE*)malloc(table_size if (GetExtendedTcpTable(allocated_ip_table, &amp;table_size, false, AF_INET, TCP_TABLE_OWNER_MODULE_ALL, 0) != NO_ERROR) goto cleanup for (entry_index = 0 entry_index &lt; allocated_ip_table-&gt;dwNumEntries ++entry_index) { const auto ip_address_match_1 = allocated_ip_table-&gt;table[entry_index].dwRemoteAddr == 0x656B1468 // 104.20.107.101 const auto ip_address_match_2 = allocated_ip_table-&gt;table[entry_index].dwRemoteAddr == 0x656C1468 // 104.20.108.101 const auto port_match = allocated_ip_table-&gt;table[entry_index].dwRemotePort == 20480 if ( (!ip_address_match_1 &amp;&amp; !ip_address_match_2) || !port_match) continue for (port_index = 0 port_index &lt; 10 &amp;&amp; allocated_ip_table-&gt;table[entry_index].dwLocalPort != local_port_buffer[port_index ++port_index) { if (local_port_buffer[port_index]) continue tcp_table_report.unknown = 0 tcp_table_report.report_id = 0x48 tcp_table_report.module_id = 0x5B9 tcp_table_report.data = BYTE1(allocated_ip_table-&gt;table[entry_index].dwLocalPort) | (LOBYTE(allocated_ip_table-&gt;table[entry_index.dwLocalPort) &lt;&lt; 8 battleye::report(&amp;tcp_table_report, sizeof(tcp_table_report), 0 local_port_buffer[port_index] = allocated_ip_table-&gt;table[entry_index].dwLocalPort break } } cleanup: // FREE TABLE AND SLEEP free(allocated_ip_table Sleep(10 } }</span></span></code> </pre> <br><h2>   </h2><br>         -: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> BATTLEYE_REPORT_ID { MEMORY_GUARD = <span class="hljs-number"><span class="hljs-number">0x21</span></span>, MEMORY_SUSPICIOUS = <span class="hljs-number"><span class="hljs-number">0x2F</span></span>, WINDOW_TITLE = <span class="hljs-number"><span class="hljs-number">0x33</span></span>, MEMORY = <span class="hljs-number"><span class="hljs-number">0x35</span></span>, PROCESS_ANOMALY = <span class="hljs-number"><span class="hljs-number">0x38</span></span>, DRIVER_BEEP_PRESENCE = <span class="hljs-number"><span class="hljs-number">0x3E</span></span>, DRIVER_NULL_PRESENCE = <span class="hljs-number"><span class="hljs-number">0x3F</span></span>, MISCELLANEOUS_ANOMALY = <span class="hljs-number"><span class="hljs-number">0x3B</span></span>, PROCESS_SUSPICIOUS = <span class="hljs-number"><span class="hljs-number">0x40</span></span>, LSASS_MEMORY = <span class="hljs-number"><span class="hljs-number">0x42</span></span>, SLEEP_ANOMALY = <span class="hljs-number"><span class="hljs-number">0x45</span></span>, MEMORY_MODULE_SPECIFIC = <span class="hljs-number"><span class="hljs-number">0x46</span></span>, GENERIC_ANOMALY = <span class="hljs-number"><span class="hljs-number">0x48</span></span>, MEMORY_MODULE_SPECIFIC2 = <span class="hljs-number"><span class="hljs-number">0x5B</span></span>, }</code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi483068/">https://habr.com/ru/post/hi483068/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi483054/index.html">"рдХреЛрдИ рдирд░рд╕рдВрд╣рд╛рд░ рдирд╣реАрдВ рд╣реЛрдЧрд╛" - рдХреГрдорд┐ рдХреЗ рдЕрдиреБрд╡рд╛рдж рдХреА рдХрд╣рд╛рдиреА</a></li>
<li><a href="../hi483056/index.html">рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рддрд╛рд░реНрдХрд┐рдХ рдХреНрд╖реЗрддреНрд░, рдХреНрдпрд╛ рдХреЛрдИ рдорд╛рд░рдХ рд╣реИ?</a></li>
<li><a href="../hi483058/index.html">рдЫреБрдЯреНрдЯреА рд╕рд░реНрд╡реЗрдХреНрд╖рдг рдкрд░рд┐рдгрд╛рдо</a></li>
<li><a href="../hi483064/index.html">рд╕рднреА рдХреИрдирди рдкрд░ рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рдЙрд░реНрдл тАЛтАЛрдЫреЛрдЯреЗ рдмреНрд▓реЙрдЧ рдХреЗ рд▓рд┐рдП Vue</a></li>
<li><a href="../hi483066/index.html">рдмрд┐рд▓ рдЧреЗрдЯреНрд╕ рдХреА рдкрд╛рд░рдВрдкрд░рд┐рдХ 5 рдкреБрд╕реНрддрдХреЗрдВ</a></li>
<li><a href="../hi483074/index.html">TensorRT 6.xxx - рдбреАрдк рд▓рд░реНрдирд┐рдВрдЧ рдореЙрдбрд▓ (рдСрдмреНрдЬреЗрдХреНрдЯ рдбрд┐рдЯреЗрдХреНрд╢рди рдФрд░ рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди) рдХреЗ рд▓рд┐рдП рдЙрдЪреНрдЪ рдкреНрд░рджрд░реНрд╢рди</a></li>
<li><a href="../hi483076/index.html">2020 рдореЗрдВ рдПрдВрдбреНрд░реЙрдЗрдб рдРрдк рд╡рд┐рдХрд╛рд╕ рдХреЗ рд▓рд┐рдП рд╢реАрд░реНрд╖ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛рдПрдВ</a></li>
<li><a href="../hi483078/index.html">рджреАрдк рд╕реБрджреГрдвреАрдХрд░рдг рд╕реАрдЦрдирд╛: рдордХрдбрд╝рд┐рдпреЛрдВ рдХреЛ рдХреИрд╕реЗ рдЪрд▓рдирд╛ рд╕рд┐рдЦрд╛рдПрдВ</a></li>
<li><a href="../hi483082/index.html">рднреЗрджреНрдпрддрд╛ рд╢рд┐рдХрд╛рд░ 7% рдЕрдзрд┐рдХ рдкреНрд░рднрд╛рд╡реА рд╣реИ</a></li>
<li><a href="../hi483084/index.html">рдЯреНрд░реИрдХрд┐рдВрдЧ рдлрдВрдХреНрд╢рди рд╡рд╛рд▓рд╛ рдХреИрдорд░рд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>