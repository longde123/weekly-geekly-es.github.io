<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèº‚Äçüé§ üõ§Ô∏è üë®üèΩ‚ÄçüöÄ Memprogram Basis LibreOffice. Bagian 3 ü§ü üïò üßñüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hari ini kita melihat penggunaan kotak dialog saat mengedit data di LibreOffice Base (OpenOffice Base). Seperti yang kami temukan di posting sebelumny...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Memprogram Basis LibreOffice. Bagian 3</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445640/">  Hari ini kita melihat penggunaan kotak dialog saat mengedit data di LibreOffice Base (OpenOffice Base).  Seperti yang kami temukan di posting sebelumnya, formulir LibreOffice Base (OpenOffice Base) sebenarnya adalah turunan dari editor teks Penulis LibreOffice (OpenOffice).  Untuk mengatur antarmuka jendela di dalam Formulir, Dialog digunakan - yang dibuat dengan mudah dalam antarmuka visual bawaan, tetapi tidak memiliki dukungan untuk berkomunikasi dengan tabel database.  Kami akan mengatur koneksi ini dengan makro OO Basic. <br><a name="habracut"></a><br>  Mari kita mulai.  Buat dua tabel dalam database: <br><br>  produk <br>  - id (integer, kunci utama) <br>  - nama (string) <br><br>  pesanan <br>  - id (integer, kunci utama) <br>  - productId (integer) <br>  - hitung (integer) <br>  - tanggal (tipe data Tanggal) <br><br>  Buat formulir pesanan, tambahkan elemen Formulir ke formulir dengan nama pesanan.  Serta Kontrol Tabel dengan sumber data pesanan.  Cara melakukan ini dibahas dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 2 dari</a> serangkaian pesan. <br><br>  Saat mengatur properti kolom tanggal, harap perhatikan properti yang ditandai dalam gambar dengan panah yang memungkinkan Anda menampilkan data dalam format yang diinginkan dan gunakan kalender drop-down untuk memilih tanggal tertentu. <br><br><div class="spoiler">  <b class="spoiler_title">Menggambar</b> <div class="spoiler_text"><img src="http://i.piccy.info/i9/2b903f387978f7d3789a849156b778a5/1553722434/122603/1310054/Screenshot_from_2019_03_27_23_24_47.png" alt="gambar"><br></div></div><br>  Sekarang, tepat di tabel, Anda dapat menambah dan mengubah data.  Sampai titik tertentu, ini nyaman, mirip dengan pekerjaan biasa dari klien dengan prosesor meja.  Tetapi pada beberapa titik, masalah mulai yang juga karakteristik bekerja dengan prosesor meja.  Data dapat diubah secara acak tanpa menyadarinya.  Dan setelah menyadari tidak mungkin untuk memutar kembali semuanya seperti semula.  Ada sedikit ruang untuk speaker baru, dan pengguliran horizontal yang tidak menyenangkan dapat terbentuk.  Judul kolom juga memiliki batas ukuran (jika tidak mereka tidak akan cocok secara horizontal), dan ini tidak memungkinkan deskripsi rinci tentang data. <br><br>  Sebagai tindakan setengah, Anda dapat menempatkan bidang biasa untuk entri data di sebelah tabel (Kontrol Teks, Kontrol Angka, dll.).  Tetapkan bidang yang sesuai dari tabel pesanan sebagai sumber data dan semuanya akan berfungsi.  Saat menavigasi dataset, data di bidang input akan berubah.  Saat mengubah data di bidang input, data dalam tabel database akan berubah.  Namun solusi ini tidak akan terlihat sangat indah. <br><br>  Oleh karena itu, kami menerapkan fungsi tersebut menggunakan Dialog.  Dialog memiliki satu batasan signifikan.  Bidang entri dialog tidak terkait dengan tabel database.  Oleh karena itu, mengisi kolom entri Dialog dari tabel database, dan menyimpan input field ke tabel database perlu dilakukan dengan makro OO Basic.  Namun, ini bagus, karena  memungkinkan Anda untuk mempertimbangkan kemungkinan pemrograman OO Basic (sebelum itu, pesan saya dijelaskan hanya bekerja dengan lingkungan, tetapi semua ini adalah persiapan untuk pesan hari ini). <br><br>  Untuk memunculkan editor Dialog, Anda harus memilih dari menu Tools-&gt; Macro-&gt; Organize Mac-&gt; LibreOffice Basic-&gt; Organizer-&gt; Dialog-&gt; New | Edit | Delete.  Saya ingin memiliki cara yang lebih cepat untuk sampai ke editor ini.  Setelah itu, editor dialog (sayangnya, bukan yang paling nyaman) akan terbuka, di mana kita akan membuat bidang dengan nama-nama bidang dalam tabel database.  Seingat Anda, Dialog tidak secara otomatis mengikat ke tabel database, jadi kami akan menulis makro untuk melakukan ini.  Dan sebagai konvensi penamaan, mari kita tentukan nama bidang input dan bidang tabel database yang sama. <br><br>  Editor dengan formulir yang sudah selesai akan terlihat seperti ini: <br><br><div class="spoiler">  <b class="spoiler_title">Menggambar</b> <div class="spoiler_text"><img src="http://i.piccy.info/i9/b0b86197b57cf8661df79ef31d491836/1553725972/107177/1310054/Screenshot_from_2019_03_28_00_27_37.png" alt="gambar"><br></div></div><br>  Selanjutnya, tambahkan dua tombol ke Dialog.  Kami akan memberikan nama tombol secara acak, tetapi mulai dengan garis bawah, untuk membedakannya dari bidang basis data.  Setiap tombol di palet properti dapat diberi tindakan.  Mari kita atur aksi OK ke tombol - menutup dialog dengan konfirmasi tindakan.  Dan yang kedua - Batalkan - menutup dialog tanpa mengonfirmasi tindakan. <br><br>  Tutup editor Dialog, dan kembali ke editor Formulir.  Mari kita membuat tombol yang memanggil dialog dan menetapkan prosedur handler Order_Edit untuk itu, di mana kita akan mengisi Dialog dari tabel database FromBaseToDialog (oForm, oDialog), dan menyimpan data dari tabel database Dialog FromDialogToBase (oDialog, oForm). <br><br><pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Order_Edit(Event) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> oDialog As Object <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> orders As Object orders = Thiscomponent.DrawPage.Forms.GetByName(<span class="hljs-string"><span class="hljs-string">"orders"</span></span>) DialogLibraries.LoadLibrary(<span class="hljs-string"><span class="hljs-string">"Standard"</span></span>) oDialog = CreateUnoDialog(DialogLibraries.Standard.dialogOrder) FromBaseToDialog(orders, oDialog) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> oDialog.<span class="hljs-keyword"><span class="hljs-keyword">Execute</span></span>() = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> FromDialogToBase(oDialog, orders) orders.UpdateRow() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> FromBaseToDialog(oForm, oDialog) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> I <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> sName As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> I = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Ubound</span></span>(oDialog.Model.ElementNames) sName = oDialog.Model.ElementNames(I) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(sName, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) &lt;&gt; <span class="hljs-string"><span class="hljs-string">"_"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(sName, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>) &lt;&gt; <span class="hljs-string"><span class="hljs-string">"Label"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> ODialog.GetControl(sName).SetText(oForm.Columns.GetByName(sName).<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> I <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> FromDialogToBase(oDialog, oForm) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> I <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> sName As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> I = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Ubound</span></span>(oDialog.Model.ElementNames) sName = oDialog.Model.ElementNames(I) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(sName, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) &lt;&gt; <span class="hljs-string"><span class="hljs-string">"_"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(sName, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>) &lt;&gt; <span class="hljs-string"><span class="hljs-string">"Label"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> oForm.Columns.GetByName(sName).UpdateString(<span class="hljs-built_in"><span class="hljs-built_in">Trim</span></span>(oDialog.GetControl(sName).GetText())) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> I <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre> <br>  Diasumsikan bahwa Dialog disimpan di pustaka Standar sebagai dialogOrder.  Secara alami, Anda dapat memilih nama lain.  Nama-nama kontrol yang dimulai dengan garis bawah dilewati dan tidak diproses.  Juga, nama yang dimulai dengan Label, yang digunakan untuk header bidang teks, tidak diproses. <br><br>  Memanggil oDialog.Execute () = 1 menampilkan Dialog di dalam jendela Formulir dan menjeda makro sampai tombol OK atau Batal diklik.  Ketika Anda mengklik OK, nilai kembali sama dengan satu. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id445640/">https://habr.com/ru/post/id445640/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id445620/index.html">Apa yang dilakukan penulis UX?</a></li>
<li><a href="../id445622/index.html">Baru di Jawa 12: The Teeing Collector</a></li>
<li><a href="../id445626/index.html">Seberapa dalam lubang kelinci? CLRium # 5: Pengumpul Sampah</a></li>
<li><a href="../id445632/index.html">Dari parser poster teater Python ke bot Telegram. Bagian 2</a></li>
<li><a href="../id445638/index.html">Magang buta di Museum Seni Modern Garage</a></li>
<li><a href="../id445642/index.html">Windows Virtual Desktop sekarang dalam pratinjau publik di Azure</a></li>
<li><a href="../id445644/index.html">ProContent 2019: sebuah konferensi untuk penulis teknis dan siapa saja yang bekerja dengan teks</a></li>
<li><a href="../id445646/index.html">CLion 2019.1: ClangFormat, penyorotan kode melalui Clangd, tampilan memori, dukungan awal untuk mikrokontroler</a></li>
<li><a href="../id445648/index.html">Server di awan 2.0. Kami meluncurkan server ke stratosfer</a></li>
<li><a href="../id445652/index.html">Tanggung jawab mesin pencari: cara "mengedit" pencarian di Rusia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>