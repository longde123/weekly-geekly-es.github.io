<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛴️ 👨🏿‍🎨 🌨️ Java Script! = JavaScript. Fünf Javas in einer Klasse. Wir schreiben, damit wir uns für immer erinnern 👂🏾 🌗 ♏️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Diese Woche wird die JUG.ru-Gruppe voraussichtlich eine Ankündigung veröffentlichen. Bis ich was sage. Die Teilnahme an geheimen Projekten weckt die K...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Java Script! = JavaScript. Fünf Javas in einer Klasse. Wir schreiben, damit wir uns für immer erinnern</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/429670/"><iframe width="560" height="315" src="https://www.youtube.com/embed/7SCwk02RPA0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Diese Woche wird die JUG.ru-Gruppe voraussichtlich eine Ankündigung veröffentlichen.  Bis ich was sage.  Die Teilnahme an geheimen Projekten weckt die Kreativität. Hier ist ein weiteres Nachtvideo über Java. <br><br>  Unglaubliche Neuigkeiten: Jetzt sind es nicht mehr anderthalb Stunden, sondern ungefähr 20 Minuten, und es gibt sogar etwas zu sehen.  Etwas weniger als vollständig besteht es aus einem Screencast.  Diejenigen, die diesen Video-Müll nicht ausstehen können und gerne Text entschlüsseln, mussten nach dem Schneiden viel Text schneiden.  Welkam, und möge Java mit Ihnen sein. <br><a name="habracut"></a><br>  Bald werden 12 Java veröffentlicht, und viele sitzen immer noch auf Semerochka und glauben, dass sie bei einem Upgrade nichts besonders Neues oder Interessantes sehen werden.  In dieser superkurzen Ausgabe lernen wir, wie wir mit Hilfe von Java-Skripten das Leben unserer Kollegen in die Hölle verwandeln können, und an einigen Stellen werde ich neue Gadgets schrauben.  Nun, Obskurantisten werden natürlich nicht vor dem Fortschritt gerettet. <br><br>  Sag mir, warum aktualisierst du deine Idee?  Dort erscheinen ständig neue Funktionen, einige neue Verknüpfungen, die Ihre Produktivität als Entwickler zehnmal steigern.  Aber Sie wissen nichts über sie.  Lesen Sie diese Nachrichten wirklich?  Wenn Sie ein durchschnittlicher Benutzer sind, dann wahrscheinlich nicht.  Im Prinzip ist es Ihnen die meiste Zeit egal.  Sie aktualisieren die Idee einfach, weil ... Sie können.  Weil die Skins wunderschön sind, das dunkle Thema, die Touchbar auf dem MacBook.  Eine solche Erklärung scheitert jedoch nicht vor den Behörden als Antwort „Warum die Idee kaufen?“. <br><br>  Stattdessen können wir sagen, dass JetBrains am 29. Oktober in jüngerer Zeit die Unterstützung für <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rohlinien</a> in der Beta-Version von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Idea eingestellt hat</a> .  Die Idee ist in der Beta, die Zeilen sind in der Vorschau, aber das ist für niemanden mehr wichtig.  Wenn Sie so stur sind, dass Sie 12 Java setzen, dann haben Sie ernstere Probleme.  Ich weiß es für mich. <br><br>  Mal sehen, wie es in der Praxis aussieht.  Versuchen Sie dazu, ein Demonstrationsproblem zu lösen.  Sehr oft gibt es das Problem, etwas zu schreiben.  In Computerspielen handelt es sich beispielsweise um Quests, in Jenkins um Build-Skripte usw.  Normalerweise wird dafür Python oder Groove verwendet, und wir nehmen nacktes Java!  Warum, warum?  Weil wir in drei Zeilen und sogar ohne Hacks können.  Klingt nach einer großartigen Idee :-) <br><br><h1>  Wo zu sehen </h1><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Alles ist auf dem Github</a> . <br><br><h1>  Geltungsbereich </h1><br>  Stellen Sie sich vor, wir haben eine Datei wie diese: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> io.javawatch; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelloHabrPrototype</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Hello Habr!"</span></span>; } };</code> </pre> <br>  Wir möchten, dass es nicht beim Kompilieren der gesamten Anwendung ausgeführt wird, sondern als Zeichenfolge - nach dem Start.  Das heißt wie ein Skript. <br><br><h1>  Manuell </h1><br>  Zuerst müssen Sie alles in eine Zeichenfolge überholen. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String SOURCE = <span class="hljs-string"><span class="hljs-string">"\n"</span></span> + <span class="hljs-string"><span class="hljs-string">" package io.javawatch;\n"</span></span> + <span class="hljs-string"><span class="hljs-string">" public class HelloHabr {\n"</span></span> + <span class="hljs-string"><span class="hljs-string">" public String get() {\n"</span></span> + <span class="hljs-string"><span class="hljs-string">" return \"Hello Habr!\";\n"</span></span> + <span class="hljs-string"><span class="hljs-string">" }\n"</span></span> + <span class="hljs-string"><span class="hljs-string">" };"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String CNAME = <span class="hljs-string"><span class="hljs-string">"io.javawatch.HelloHabr"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String CODE_CACHE_DIR = <span class="hljs-string"><span class="hljs-string">"C:/temp/codeCache"</span></span>;</code> </pre><br>  Alle diese "\ n" Pluspunkte und Einrückungen sehen äußerst miserabel aus. <br><br>  Bisher konnten wir den Code nur in eine Datei einfügen und lesen.  Dies ist wahrscheinlich eine gute Lösung, aber nicht immer geeignet.  Sie sind beispielsweise Redner auf einer Konferenz und demonstrieren Code von Folien.  Selbst die obige Konstruktion ist viel besser als nur eine unbegründete Referenz, dass Sie irgendwo einen Code haben, der dort etwas tut.  Das Wechseln der Folien kostet Zeit und Aufmerksamkeit des Publikums.  Gut und so weiter.  Kurz gesagt, wenn Sie den Code genau inline benötigen, können Sie sich etwas einfallen lassen. <br><br>  Jetzt haben wir die Möglichkeit, den Müll mit rohen Strings loszuwerden.  Wir stehen mit dem Cursor auf dem Code auf, drücken Alt + Eingabetaste (oder was auch immer auf Ihrem Betriebssystem läuft Quck Fix in der Idee).  Wählen Sie "In rohes String-Literal konvertieren" und erhalten Sie dieses Nyashka: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String SOURCE = ` <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> io.javawatch; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelloHabr</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Hello Habr!"</span></span>; } };`; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String CNAME = <span class="hljs-string"><span class="hljs-string">"io.javawatch.HelloHabr"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String CODE_CACHE_DIR = <span class="hljs-string"><span class="hljs-string">"C:/temp/codeCache"</span></span>;</code> </pre><br>  Meiner Meinung nach lohnt es sich aus diesem Grund bereits, JDK 12 zu installieren. <br><br>  Übrigens müssen Sie verschiedene Dinge tun, damit die Funktion funktioniert: <br><br><ul><li>  Laden Sie JDK 12 herunter und registrieren Sie sich in den Projekteinstellungen </li><li>  Setzen <code>--release</code> in den globalen Javac-Einstellungen das Flag <code>--release</code> , Bytecode Version 12, zusätzliche Flags <code>--enable-preview</code> <code>-Xlint:preview</code> </li><li>  Jetzt müssen Sie in jeder Run / Debug-Konfiguration das VM-Flag <code>--enable-preview</code> hinzufügen </li></ul><br>  Wenn Sie es nicht verstehen, wie es gemacht wird, sehen Sie sich meinen Screencast aus der Post-Überschrift an. Dort ist alles ziemlich klar. <br><br>  Zunächst müssen Sie drei einfache Schritte ausführen: Verwandeln Sie die Zeichenfolge in eine praktische interne Darstellung der Quelle, kompilieren Sie sie und führen Sie Folgendes aus: <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* 1 */</span></span> RuntimeSource file = RuntimeSource.create(); <span class="hljs-comment"><span class="hljs-comment">//SimpleJavaFileObject /* 2 */ compile(Collections.singletonList(file)); /* 3 */ String result = run(); /* 4 */ /* ??? */ /* 5 */ /* PROFIT! */ System.out.println(result); }</span></span></code> </pre><br>  Es gibt eine <code>SimpleJavaFileObject</code> Klasse für die „bequeme Darstellung“, die jedoch eine interessante Funktion aufweist.  Es ist kritisch abstrakt.  Das heißt, seine Schlüsselmethode, die die kompilierte Quelle zurückgeben sollte, löst immer eine Ausführung in der Hoffnung aus, dass wir sie in Unterklassen unterteilen: <br><br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">/** * This implementation always throws {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@linkplain</span></span></span><span class="hljs-comment"> * UnsupportedOperationException}. Subclasses can change this * behavior as long as the contract of {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@link</span></span></span><span class="hljs-comment"> FileObject} is * obeyed. */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> CharSequence </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCharContent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ignoreEncodingErrors)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnsupportedOperationException(); }</code> </pre><br>  Sie müssen also einen Teil Ihres Erben schreiben.  Beachten Sie, dass der ursprüngliche <code>SimpleJavaFileObject</code> Konstruktor einen URI für die kompilierte Klasse wünscht, aber woher bekommen wir ihn?  Daher schlage ich vor, es nur auf die offensichtlichste Weise <code>buildURI</code> , wie hier in der <code>buildURI</code> Funktion: <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RuntimeSource</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimpleJavaFileObject</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String contents = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> CharSequence </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCharContent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ignoreEncodingErrors)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> contents; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> RuntimeSource </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RuntimeSource(CNAME, SOURCE); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RuntimeSource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String className, String contents)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(buildURI(className), Kind.SOURCE); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.contents = contents; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> URI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">buildURI</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String className)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// io.javawatch.HelloHabr -&gt; // string:///io/javawatch/HelloHabr.java URI uri = URI.create("string:///" + className.replace('.', '/') + Kind.SOURCE.extension); System.out.println(uri); return uri; }</span></span></code> </pre><br>  Fahren wir nun mit der Zusammenstellung fort: <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;RuntimeSource&gt; files)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ File ccDir = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(CODE_CACHE_DIR); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ccDir.exists()) { FileUtils.deleteDirectory(ccDir); FileUtils.forceMkdir(ccDir); } JavaCompiler compiler = ToolProvider.getSystemJavaCompiler(); Logger c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Logger(); StandardJavaFileManager fileManager = compiler.getStandardFileManager(c, Locale.ENGLISH, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); Iterable options = Arrays.asList(<span class="hljs-string"><span class="hljs-string">"-d"</span></span>, CODE_CACHE_DIR, <span class="hljs-string"><span class="hljs-string">"--release=12"</span></span>, <span class="hljs-string"><span class="hljs-string">"--enable-preview"</span></span>, <span class="hljs-string"><span class="hljs-string">"-Xlint:preview"</span></span>); JavaCompiler.CompilationTask task = compiler.getTask(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, fileManager, c, options, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, files); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (task.call()) { System.out.println(<span class="hljs-string"><span class="hljs-string">"compilation ok"</span></span>); } }</code> </pre><br>  Bitte beachten Sie: Wir übergeben vier Flags für die Montage, von denen drei dafür verantwortlich sind, genau die gleichen Optionen vorzuschreiben, die wir mit der Maus in den Javac-Einstellungen in der Idee gemacht haben. <br><br>  Und zum Schluss führen Sie unsere temporäre Klasse durch: <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> ClassNotFoundException, IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException, MalformedURLException </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   File ccDir = new File(CODE_CACHE_DIR); ClassLoader loader = new URLClassLoader(new URL[]{ccDir.toURL()}); var clss = loader.loadClass("io.javawatch.HelloHabr"); // Java 10 //    Object instance = clss.getConstructor().newInstance(); // Java 9 // Object instance = clss.newInstance(); Method thisMethod = clss.getDeclaredMethod("get"); Object result = thisMethod.invoke(instance); return (String) result; }</span></span></code> </pre><br>  Bitte beachten Sie, dass <code>var clss = loader.loadClass</code> zu schreiben ist als <code>Class&lt;?&gt; clss = loader.loadClass</code> und keine neuen Vorings einführt.  Das Schlüsselwort <code>var</code> in den Top Ten angezeigt. <br><br>  Beachten Sie auch, dass <code>clss.newInstance()</code> ab Nine abgeschnitten werden soll.  Er schluckt Ausnahmen, was schlecht ist.  The Nine schlägt vor, zuerst <code>getConstructor</code> , der parametrisiert ist und die richtigen Ausnahmen <code>getConstructor</code> . <br><br>  Bitte beachten Sie auch, dass ich die Variable als Wortklasse bezeichnet habe, Java jedoch nicht geschworen hat.  Hausaufgaben: Sie können dies auf verschiedene Arten tun. Sie müssen verstehen, welche am interessantesten ist und warum. <br><br>  Nun, im Allgemeinen ist das alles.  Es funktioniert. <br><br><h1>  Automatisierung </h1><br>  Hier wird der Kritiker ausrufen, hier ist alles schwarz, weil es in der Java-Welt Bibliotheken gibt, die alles für Sie in einer Zeile zusammenstellen. <br><br>  OK, lass uns einen Blick darauf werfen.  Hier ist der Code in der JOOR-Bibliothek oben in Google: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> io.javawatch; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.joor.Reflect; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.function.Supplier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Automatic</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ Supplier&lt;String&gt; supplier = Reflect.compile( <span class="hljs-string"><span class="hljs-string">"io.javawatch.HelloHabr"</span></span>, ` <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> io.javawatch; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelloHabr</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">util</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Supplier</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Hello Habr!"</span></span>; } };` ).create().get(); System.out.println(supplier.get()); } }</code> </pre><br>  Als ob alles in Ordnung wäre.  In der Tat in einer Zeile, außer dass ich den Saplayer ziehen musste. <br><br>  Aber es gibt eine Nuance.  Versuchen Sie, "Hallo Habr!"  wie rohes String-Literal: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ``Hello Habr!``; }</code> </pre><br>  Alles wird sofort mit dem Fehler "(verwenden Sie --able-Preview, um rohe String-Literale zu aktivieren)" abstürzen.  Aber haben wir es schon eingeschaltet?  Ja, zur Hölle mit zwei.  Wir haben es in die Idee aufgenommen und JOOR erstellt es mit einem System-Compiler!  Werfen wir einen Blick darauf, was drin ist: <br><br><pre> <code class="java hljs">JavaCompiler compiler = ToolProvider.getSystemJavaCompiler(); ompiler.getTask(out, fileManager, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, files).call();</code> </pre><br>  Und was ist mit uns, als wir selbst denselben JavaCompiler aufgerufen haben? <br><br><pre> <code class="java hljs"> Iterable options = Arrays.asList(<span class="hljs-string"><span class="hljs-string">"-d"</span></span>, CODE_CACHE_DIR, <span class="hljs-string"><span class="hljs-string">"--release=12"</span></span>, <span class="hljs-string"><span class="hljs-string">"--enable-preview"</span></span>, <span class="hljs-string"><span class="hljs-string">"-Xlint:preview"</span></span>); JavaCompiler.CompilationTask task = compiler.getTask(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, fileManager, c, options, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, files);</code> </pre><br>  Und in JOOR gibt es nur eine bloße Null anstelle von Optionen.  Sie können nicht einmal hineingelassen werden! <br><br>  Es ist wahrscheinlich eine gute Idee, ihnen eine solche Pull-Anfrage an Github in JOOR zu senden.  Wenn ich es nicht selbst mache, machst du es, oder? <br><br>  Und die Moral ist einfach, fürchte dich vor Open-Source-Geschenken.  Manchmal ist es einfacher, eine kleine Textwand zu schreiben, aber die Kontrolle darüber zu haben. <br><br><h1>  Einfachster Weg </h1><br>  Es gibt eine Möglichkeit, keine Textwand zu schreiben und keine verdächtigen Bibliotheken zu verwenden.  Ab Java 9 haben wir eine interaktive Shell (ähnlich der in Python, Ruby und anderen Skriptsprachen), die Java-Befehle ausführen kann.  Und natürlich ist es in Java selbst geschrieben und als Java-Klasse verfügbar.  Sie können eine Instanz davon erstellen und die erforderliche Zuordnung einfach direkt ausführen: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shell</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jShell = JShell.create(); <span class="hljs-comment"><span class="hljs-comment">//Java 9 jShell.eval("String result;"); jShell.eval(`result = "Hello Habr!";`); //Java 12 var result = jShell.variables() //Streams: Java 8, var: Java 10 .filter((@Nullable var v) -&gt; v.name().equals("result")) //var+lambda: Java 11 .findAny() .get(); System.out.println(jShell.varValue(result)); } }</span></span></code> </pre><br>  Streams wurden in Java 8 angezeigt und werden jetzt überall verwendet. Sie müssen <code>stream()</code> nicht einmal selbst aufrufen, andere rufen es für Sie auf.  In diesem Fall gibt der Aufruf von <code>variables()</code> genau den Stream zurück, nicht die ArrayList, wie es jemand aus einer schwierigen Kindheit getan hätte.  Das Ergebnis des Stroms kann sofort in <code>var</code> gegossen werden. <br><br>  Beachten Sie, dass Sie <code>var</code> jetzt auch in Lambda-Parameter schreiben können.  Diese Funktion ist seit Java 11 bei uns. <br><br>  Im Allgemeinen ist dies eine sehr bedeutende Klasse.  Es verwendet eine Reihe von Funktionen aus verschiedenen Generationen von Java, und all dies sieht ganzheitlich und harmonisch aus.  Ich bin sicher, dass solche Dinge von jedem und überall verwendet werden, daher unterscheidet sich der Code in Java 12 visuell direkt von dem in Java 7. <br><br><h1>  Zusammenfassend </h1><br>  Wir haben uns einige Funktionen angesehen: <br><br><ul><li>  8: Stream (für diejenigen im Tank) </li><li>  9: JShell und neue veraltete Methoden </li><li>  10: Schlüsselwort var </li><li>  11: Var-Entwicklung für Lambda-Parameter </li><li>  12: Raw String Literals und ihre Unterstützung in IntelliJ IDEA </li></ul><br>  Eine kleine Warnung für Anfänger.  Wenn Sie dies in realen Anwendungen ohne besondere Bedeutung ständig tun, werden Ihre Kollegen zuerst verrückt und versuchen zu verstehen, was Sie geschrieben haben, und dann können sie Sie sehr schmerzhaft schlagen.  Und ich spreche jetzt nicht über neue Java-Funktionen, sondern natürlich über die Kompilierung zur Laufzeit. <br><br>  Wenn Sie mehr über Java als Sprache erfahren möchten, sollten Sie sich beispielsweise die Berichte von Tagir Valeev ansehen.  Sie kennen ihn als einen Typen von der Spitze des Java-Hubs in Habré, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Lany</a> .  Bei Joker sprach er über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Amber</a> und bei JPoint über seine berühmten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rätsel</a> und so weiter und so fort.  Dort und über die Java-Sprache und über IntelliJ IDEA ist alles da.  All dies finden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie auf YouTube</a> .  Eigentlich aus Eifersucht auf Tagir, der etwas über die Sprache selbst sagen kann, aber ich nicht und dieser Beitrag hat sich herausgestellt.  Es wird auch neue Joker und JPoint geben, aber wir werden dies später diskutieren. <br><br>  Ich habe meine moralische Pflicht erfüllt, eine Pflicht gegenüber Java.  Von meiner Seite flogen die Kugeln heraus.  Und Sie dort, auf den sieben, die nicht das zwölfte Java haben, bleiben hier, Sie alles Gute, gute Laune und Gesundheit.  Vielen Dank. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de429670/">https://habr.com/ru/post/de429670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de429654/index.html">Projektmanagement verbessern</a></li>
<li><a href="../de429656/index.html">Künstliche Intelligenz ist auch falsch. Da Amazon Go uns in den USA verkürzt - ein Geschäft der Zukunft ohne Kassierer und Verkäufer</a></li>
<li><a href="../de429658/index.html">SpaceX Starlink Satellite Internet - "Druckgeldlizenz"</a></li>
<li><a href="../de429662/index.html">Wir durchbrechen den Schutz vor Bots</a></li>
<li><a href="../de429668/index.html">Google PageSpeed ​​Insights wurde drastisch aktualisiert. Was wird sich ändern?</a></li>
<li><a href="../de429676/index.html">Backup auf Band</a></li>
<li><a href="../de429678/index.html">Wie wir 10 Millionen Zeilen C ++ - Code in den C ++ 14-Standard (und dann in C ++ 17) übersetzt haben</a></li>
<li><a href="../de429680/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 17: Benutzerauthentifizierung, Teil 1</a></li>
<li><a href="../de429682/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 17: Benutzerauthentifizierung, Teil 2</a></li>
<li><a href="../de429684/index.html">Firebase Summit 2018: kurz zur Hauptsache</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>