<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≠ üöç üéûÔ∏è Surveillance du fonctionnement des syst√®mes r√©sidentiels de banlieue: les premiers pas vers une maison intelligente üïí üßïüèª ‚òπÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'article pr√©c√©dent a provoqu√© une discussion assez anim√©e, et cette circonstance m'a convaincu de la n√©cessit√© de poursuivre ce que nous appelons ¬´pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Surveillance du fonctionnement des syst√®mes r√©sidentiels de banlieue: les premiers pas vers une maison intelligente</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sberbank/blog/415477/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/1q/ir/bi/1qirbi2pjzork0gilefg7xlyoho.jpeg"></div><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'article pr√©c√©dent a</a> provoqu√© une discussion assez anim√©e, et cette circonstance m'a convaincu de la n√©cessit√© de poursuivre ce que nous appelons ¬´partager l'exp√©rience¬ª.  Ainsi, nous nous sommes install√©s sur le fait qu'apr√®s l'apparition de sources d'√©nergie alternatives dans la maison, principalement le capteur solaire, j'ai voulu mesurer les param√®tres qui accompagnent leur travail.  Par exemple, pour voir comment la temp√©rature du liquide de refroidissement solaire change, l'eau de la chaudi√®re surchauffe, etc.  Il est clair que la mesure de quelque chose en soi et m√™me la transmission de ces informations au lieu de consommation (t√©l√©m√©trie) n'augmentent pas le confort ou la s√©curit√©, donc imm√©diatement un √©l√©ment sur la t√©l√©commande de divers actionneurs a √©t√© ajout√© au ¬´TK¬ª.  Dans cet article, je ne vais pas donner de listes de codes, d√©tailler toutes les solutions techniques dans les moindres d√©tails.  Mon objectif est de montrer le cheminement de la pens√©e et les solutions techniques adopt√©es, ainsi que leur r√©sultat.  Quiconque veut suivre un chemin similaire devra encore r√©soudre de nombreux probl√®mes par lui-m√™me. </p><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Une l√©g√®re digression lyrique.</b> <div class="spoiler_text"><p>  En 2010, avec un onduleur / batteries, un syst√®me universel d'alarme-contr√¥leur GSM de la soci√©t√© russe RADS Electronics est apparu dans la maison.  Ce merveilleux appareil universel a √©t√© utilis√© en plus des fonctions d'alarme avec alertes GSM, √©galement pour contr√¥ler la lumi√®re dans le salon et, surtout, pour contr√¥ler la chaudi√®re √©lectrique.  J'ai donc appris √† contr√¥ler la temp√©rature, √† maintenir la temp√©rature et √† r√©chauffer la maison √† l'avance, avant l'arriv√©e, il y a longtemps.  La commodit√© de tels syst√®mes est assez √©vidente.  Cependant, les capacit√©s du contr√¥leur sont limit√©es, de sorte que le nouveau ¬´TK¬ª a initialement pos√© les bases de la cr√©ation d'un syst√®me parall√®le, m√™me avec des fonctions se r√©p√©tant partiellement et, bien s√ªr, avec l'acc√®s aux informations des capteurs et le contr√¥le via Internet. </p></div></div><br><p>  Donc, les exigences initiales se profilaient: </p><br><ol><li>  Mesurez la temp√©rature sur les 8 buses de la chaudi√®re et les 2 buses de la chaudi√®re. </li><li>  Mesurer la temp√©rature et l'humidit√© dans la chaufferie o√π l'√©quipement est mont√©. </li><li>  Mesurez la temp√©rature et l'humidit√© de l'air ext√©rieur.  Pour un jour mettre en ≈ìuvre un contr√¥le du chauffage en fonction des conditions m√©t√©orologiques. </li><li>  Conduisez une chaudi√®re √©lectrique tout en conservant l'ancien syst√®me.  La chaudi√®re est √† trois √©tages, avec r√©glage de la temp√©rature de chauffage et r√©troaction sur la temp√©rature du liquide de refroidissement.  Cependant, √† des fins de t√©l√©commande, il suffit d'activer / d√©sactiver les √©tapes de chauffage. </li><li>  G√©rez le chauffe-eau. </li><li>  Posez un minimum de fils.  Pas tant pour ne pas d√©ranger, mais parce que la d√©coration de la maison a d√©j√† √©t√© faite. </li><li>  Avoir une interface pratique pour g√©rer et travailler avec les lectures des capteurs.  L'interface doit √™tre accessible sur les appareils mobiles. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Et encore une petite digression.</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/-l/p-/jz/-lp-jzlqt49mog78ksamlq75azq.jpeg" align="left">  <i>Sur la photo - un g√©n√©rateur avec un d√©marreur √©lectrique.</i>  <i>Pour le d√©marrage hivernal, j'ai d√ª mettre une batterie de voiture et un chargeur.</i>  <i>Et utilisez de l'huile synth√©tique.</i> </p><br><p>  Au cours de la m√™me ann√©e 2010, un g√©n√©rateur d'essence s'est install√© dans le garage.  Et bient√¥t un contr√¥leur de d√©marrage automatique y a √©t√© ajout√©, fabriqu√© ind√©pendamment sur la base du microcontr√¥leur Arduino.  Le contr√¥leur examine non seulement la pr√©sence d'un r√©seau 220 V, mais √©galement le signal de l'onduleur concernant la d√©charge des batteries, et l'onduleur lui-m√™me fournit une entr√©e automatique du g√©n√©rateur.  Tous ensemble, il a √©t√© possible de mettre en ≈ìuvre un algorithme de contr√¥le de g√©n√©rateur assez intelligent.  En g√©n√©ral, il n'y avait aucune crainte d'utiliser des microcontr√¥leurs, √† la fois dans le sens de la connexion des p√©riph√©riques et dans le sens de la programmation.  Dans le pass√©, j'ai beaucoup programm√© en C / C ++. </p></div></div><br><p>  Les exigences sont, en g√©n√©ral, simples, sinon triviales.  Il existe des milliers de fa√ßons diff√©rentes de les mettre en ≈ìuvre.  Et c'est pourquoi la pierre angulaire est le choix de l'architecture et de la pile technologique sur laquelle le nouveau syst√®me sera construit.  L'approche syst√©matique est exactement ce qui est important ici, la compr√©hension que les solutions techniques individuelles doivent √™tre li√©es les unes aux autres, la compr√©hension que le syst√®me va certainement se d√©velopper davantage, comme cela s'est d√©j√† produit avec le syst√®me d'alimentation √©lectrique √† la maison.  Et il est √©galement important de comprendre vos propres capacit√©s.  Par cons√©quent, j'ai d√ª google, prendre "l'aide du public" et "appeler un ami". </p><br><p>  <i>Sur la photo Arduino Nano et nRF24L01 + avec antenne</i> <br><img src="https://habrastorage.org/webt/8b/jv/9m/8bjv9mq_4o9_pllkockdofys34m.jpeg" align="left">  J'ai commenc√© √† regarder √† partir de syst√®mes bas√©s sur la norme Z-Wave largement utilis√©e, cela a grandement influenc√© les d√©cisions ult√©rieures, bien que Z-Wave ait √©t√© rejet√© au d√©but.  √âtant donn√© que Z-Wave est un choix √©vident pour les besoins proches du mien, il est important de comprendre pourquoi il a √©t√© abandonn√©.  Tout d'abord, bien s√ªr, le co√ªt d'un capteur.  Et je n'ai besoin que de mesurer la temp√©rature sur une chaudi√®re √† 8 points, chaque point donne plus de 3000 roubles.  Deuxi√®mement, le facteur de forme des capteurs standard, qui ne permet pas leur utilisation sur les buses de chaudi√®re.  Troisi√®mement, le choix limit√© de syst√®mes de contr√¥le et d'acc√®s √† distance, qui sont √©galement tous propri√©taires (vous devriez lire: ¬´limit√©s¬ª) et payants.  Cependant, l'id√©e m√™me d'un r√©seau auto-organis√© avec la possibilit√© √† la fois de communications peer-to-peer (associations) d'un capteur-actionneur et d'une gestion centralis√©e serveur-client est tr√®s s√©duisante.  Sur les conseils d'un ami, il a poursuivi un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">projet int√©ressant</a> , qui ressemblait initialement √† une extension de la fonctionnalit√© des syst√®mes Z-Wave bas√©s sur les contr√¥leurs Vera, mais en utilisant l'approche DIY.  Le projet a utilis√© des √©metteurs-r√©cepteurs sans fil Arduino, 2,4 GHz nRF24L01 + et la biblioth√®que correspondante.  Tous ensemble, c'est exactement ce qui est n√©cessaire pour mes besoins.  L'utilisation d'Arduino ouvre des possibilit√©s presque illimit√©es de domotique pour de l'argent, un ordre de grandeur (!) Plus petit que dans le cas de Z-Wave.  Il est √©galement important que Arduino soit une plate-forme exceptionnellement stable.  Le contr√¥leur de d√©marrage automatique du g√©n√©rateur, une fois assembl√© sur l'Arduino, fonctionne sans probl√®me depuis 7 ans.  Compte tenu de l'exp√©rience de d√©veloppement, de soudure et de programmation, je me suis arr√™t√© sur ce projet. </p><br><p>  Et a m√™me continu√©.  Dans le code, j'ai compl√®tement refus√© de me lier √† Vera.  Au lieu de cela, il a choisi l'un des contr√¥leurs logiciels recommand√©s par l'auteur de la biblioth√®que mysensors.  Apr√®s avoir √©tudi√© les forums et sites de fabricants, il est devenu le projet open source <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">openHAB</a> .  Le facteur d√©cisif, en plus de l'ouverture, de la multiplicit√© des plates-formes, du langage puissant int√©gr√© des r√®gles, de la pr√©sence de clients mobiles, √©tait la propri√©t√© d√©clar√©e suivante: ¬´un fournisseur et une technologie agnostiques¬ª.  C'est exactement ce dont un sp√©cialiste informatique soucieux du syst√®me a besoin: la possibilit√© d'√©tendre le syst√®me √† l'avenir, en utilisant des composants de diff√©rents fabricants et normes, tout en √©tant le plus appropri√© √† des fins sp√©cifiques.  C'est-√†-dire  D√®s le d√©but, il √©tait entendu que tout n'√©tait pas √† faire sur l'Arduino et que tout n'√©tait pas <b>possible</b> dans les limites de Z-Wave.  Dans le m√™me temps, j'ai d√©cid√© d'adh√©rer √† une logique de gestion centralis√©e, ce qui est tout √† fait naturel pour commencer.  C'est-√†-dire  sur les appareils terminaux assembl√©s sur Arduino, il y aura une logique m√©tier minimale: allumer / √©teindre la lumi√®re des interrupteurs m√©caniques classiques <s>antiques</s> qui deviennent simplement des capteurs, lire et convertir des informations √† partir de capteurs de param√®tres physiques, transmettre des donn√©es au serveur, recevoir et ex√©cuter des commandes du serveur.  Je ne pr√©vois aucune interaction directe entre les n≈ìuds du r√©seau d'appareils.  Toute logique de gestion d'entreprise r√©elle est bas√©e sur les r√®gles openHAB.  Maintenant, il reste peu de choses - choisissez la plate-forme mat√©rielle et le syst√®me d'exploitation pour la partie serveur, pour openHAB. </p><br><p>  De nombreux amateurs de bricolage sous openHAB choisissent le Raspberry Pi.  Et c'est une excellente solution, √©conomique, compacte et silencieuse.  Cependant, il me semblait erron√© de me limiter en puissance de calcul, car j'ai tout de suite d√©cid√© d'utiliser le futur serveur comme appareil multifonctionnel, par exemple, je voulais y d√©ployer le media center Kodi et, √©ventuellement, √† l'avenir, autre chose, par exemple, un enregistreur vid√©o logiciel.  Pour l'avenir, je dirai qu'en fin de compte, Kodi est int√©gr√© √† une maison intelligente, lorsque la vid√©o d√©marre, la lumi√®re s'√©teint, lorsqu'elle s'arr√™te, elle s'allume.  Et le DVR est √©galement apparu et est √©galement int√©gr√©.  En m√™me temps, je n'ai pas d'exigences particuli√®res pour les composants multim√©dias, il suffit que le serveur dispose de HDMI et S / PDIF.  En g√©n√©ral, √† l'automne 2015, le choix s'est port√© sur un nettop sans ventilateur de Hystou (voir sur AliExpress): Intel Core i7, 8 Go, SSD 256 Go, 8 ports USB, dont 4 3.0, 2 LAN, WiFi, 2 HDMI, S / PDIF, Lecteur de cartes en g√©n√©ral, tout ce dont vous avez besoin pour le bonheur d'une bo√Æte DIY.  Il a ensuite co√ªt√© environ 24 tr.  Je n'ai jamais regrett√© le choix, m√™me si je dois dire que le WiFi n'est pas tr√®s stable pour lui.  Mais l'exp√©rience qui a suivi tout cela dit en toute confiance: partout o√π vous pouvez poser des fils - posez des fils.  Un canal radio, quelle que soit la norme et la fr√©quence (WiFi, Z-Wave, 433 MHz, 869 MHz, 2,4 GHz, etc.) est toujours pire qu'un fil.  Par cons√©quent, le nettop est enfin connect√© au fil LAN domestique.  Et plusieurs autres syst√®mes diff√©rents s'y sont install√©s. <br>  Quant au syst√®me d'exploitation du serveur, je recommanderais la stabilit√© et la pr√©visibilit√©.  Les distributions Linux avec une grande communaut√© ont cette propri√©t√©.  Je connais mieux Ubuntu.  Bien que, gr√¢ce √† la multiplateforme, tout peut √™tre fait sous Windows. </p><br><p>  Ainsi, l'architecture et la pile sont s√©lectionn√©es.  Nous agissons. </p><br><p><img src="https://habrastorage.org/webt/2h/na/oq/2hnaoqpssegd8ks0mgvm5bpymd4.jpeg" align="left">  <b>T√¢che 1.</b> S√©lectionnez les capteurs et actionneurs.  La temp√©rature du liquide de refroidissement et de l'eau sera mesur√©e sur les buses de la chaudi√®re et de la chaudi√®re.  Pour ce faire, nous prenons des capteurs DS18B20 1 fil dans une enceinte m√©tallique √©tanche, ils sont commod√©ment mont√©s directement sur les buses, de l'ext√©rieur.  Et les tuyaux eux-m√™mes avec des capteurs sur le dessus sont recouverts d'une mousse isolante pour tuyaux.  Lorsqu'il existe de nombreux capteurs similaires, le bus √† 1 fil est tr√®s pratique.  Pour mesurer la temp√©rature et l'humidit√© de l'air dans la chaufferie et dans la rue, nous choisissons le DHT22, tout simplement parce que c'est un choix de bricolage standard.  G√©rez la chaudi√®re s√©par√©ment par √©tapes - en utilisant des relais m√©caniques conventionnels de cinq volts, √©galement familiers aux tableaux de bricolage.  Il est important de noter que ces relais sont connect√©s en parall√®le avec les interrupteurs d'√©tage de la chaudi√®re, et non les relais TEN, qui sont contr√¥l√©s par l'automatisation de la chaudi√®re.  Tous les p√©riph√©riques s√©lectionn√©s sont programm√©s directement sans artifice, comme un relais, par exemple, ou ont les biblioth√®ques appropri√©es pour Arduino, comme 1 fil / DS18B20 / DHT22.  Pas de complications. </p><br><p>  <i>Sur la photo, une chaudi√®re de 300l.</i>  <i>On peut voir qu'un fil noir avec un capteur √† l'extr√©mit√© s'approche de chaque tuyau de d√©rivation, ils sont combin√©s dans une bo√Æte blanche et un fil blanc √† 1 fil commun va au contr√¥leur.</i> </p><br><p>  <b>T√¢che 2.</b> √âchangez des donn√©es et des commandes avec openHAB.  J'ai d√ª bricoler un peu, car avec openHAB je n'√©tais pas encore ¬´sur toi¬ª.  L'architecture de mysensors implique la pr√©sence d'une passerelle (passerelle) pour se connecter au contr√¥leur / serveur central, c'est-√†-dire  pour ouvrirHAB. <img src="https://habrastorage.org/webt/gs/hc/ku/gshcku8ujafvh5b_mytcifai_kw.jpeg" align="right">  La passerelle elle-m√™me est un contr√¥leur physiquement s√©par√© sur l'Arduino / nRF24L01 + et peut √™tre connect√©e au serveur via LAN / WiFi ou s√©rie.  Puisque je suis au d√©but du chemin, je s√©lectionne Serial et place la passerelle √† c√¥t√© du serveur.  La passerelle est utilis√©e pour acheminer les messages envoy√©s au r√©seau mysensors via la passerelle et communiquer directement avec le contr√¥leur central, openHAB.  Les messages de Mysensors sont au format fixe et faciles √† analyser.  Nous ajoutons √† la liaison openHAB Serial pour connecter la passerelle via USB et √©crivons une r√®gle pour analyser les messages des appareils sur le r√©seau mysensors re√ßus via USB de la passerelle.  La r√®gle openHAB qui analyse les messages est bas√©e sur le code trouv√© sur le forum mysensors.  Ensuite, nous √©crivons les r√®gles pour les actionneurs - relais de commande de chaudi√®re, chauffage de chaudi√®re, lumi√®re, etc. </p><br><p>  <i>La photo montre une passerelle, une petite bo√Æte brune avec une antenne dans un haut-parleur audio.</i> </p><br><div class="spoiler">  <b class="spoiler_title">√Ä propos d'OpenHAB</b> <div class="spoiler_text"><p>  openHAB - une solution ouverte, en expansion avec l'aide de la communaut√© en d√©veloppant des liaisons pour des appareils sp√©cifiques avec lesquels openHAB interagira.  Par exemple, pour interagir avec des appareils via USB, il existe une liaison s√©rie.  De m√™me pour d'autres appareils ou protocoles, par exemple Modbus, NTP, HTTP, Squeezebox, Kodi / XBMC, Z-Wave, ZigBee, Nest, etc.  J'ai moi-m√™me particip√© au d√©veloppement en tant que testeur de liaison Modbus actif. </p></div></div><br><p><img src="https://habrastorage.org/webt/gv/ud/dt/gvuddthvqwvemt9nxugqzbcefjg.jpeg" align="left">  Pendant que j'√©tais occup√© √† connecter la passerelle au serveur openHAB, j'ai d√©cid√© de finaliser le code de la passerelle (et la passerelle elle-m√™me), extrait de mysensors.org et d'y ajouter le capteur de temp√©rature et d'humidit√© DHT22 et le capteur de pression atmosph√©rique BMP180, et en m√™me temps j'ai trouv√© le code source pour la pr√©vision m√©t√©orologique de la dynamique atmosph√©rique la pression.  Toutes ces mesures et pr√©visions sont transmises √† openHAB. <br>  <i>Sur la photo, la passerelle est √† l'int√©rieur.</i>  <i>Sur le fil blanc est DHT22, la carte avec des broches libres est Arduino, en bas √† droite est nRF24L01 + et BMP180.</i> </p><br><p>  <b>T√¢che 3.</b> Interface et acc√®s √† distance.  openHAB est un syst√®me enti√®rement personnalisable, y compris la disposition des interfaces.  Et ce balisage est unifi√©, √† la fois pour un acc√®s ordinaire via un navigateur et via une application mobile.  Le balisage universel, bien s√ªr, n'est peut-√™tre pas id√©al, mais il a l'air bien sur un smartphone, et c'est important.  Il reste √† d√©cider comment acc√©der au serveur openHAB en dehors du r√©seau local.  Tout d'abord, vous pouvez (et surtout, facultativement) utiliser le cloud myopenhab.org.  Le serveur openHAB se connecte directement au cloud √† l'aide d'une liaison sp√©ciale.  Cette solution est la plus simple et offre une fonctionnalit√© de gestion compl√®te du syst√®me, √† l'exception du transfert de vid√©o √† partir de cam√©ras IP.  Deuxi√®mement, pour ceux qui n'aiment pas les nuages, et je leur appartiens, il existe les moyens habituels d'acc√®s √† distance, par exemple, une combinaison VPN + VNC, etc.  Je ne d√©voilerai pas les d√©tails pour des raisons √©videntes, d'autant plus que ce probl√®me ne concerne pas directement le sujet de l'article.  Je note seulement que le client mobile openHAB a une configuration pour deux adresses.  Il va au premier s'il voit un serveur openHAB √† cette adresse, au second - s'il ne le fait pas.  Il s'agit d'une fonctionnalit√© tr√®s pratique de l'interface.  Par exemple, vous pouvez sp√©cifier le cloud comme deuxi√®me adresse, puis openHAB est toujours disponible sans manipulations suppl√©mentaires avec la connexion VPN.  Ou sp√©cifiez l'adresse virtuelle obtenue √† l'aide de n'importe quelle solution VPN.  Ou autre chose. </p><br><table><thead><tr><th>  √âcran d'accueil de l'interface </th><th>  D√©filement vers le bas de l'√©cran de d√©marrage </th><th>  L'√©l√©ment de menu ouvert "Light" </th></tr></thead><tbody><tr><td><img src="https://habrastorage.org/webt/9z/ls/yp/9zlsyp9mydxjhq7g46p4a1lqvba.jpeg"></td><td><img src="https://habrastorage.org/webt/j8/zx/7_/j8zx7_o6z7tb2ihivbhn-tbkqzw.jpeg"></td><td><img src="https://habrastorage.org/webt/vp/ws/ld/vpwsldzn6krpnzqvvzqow0yvtuy.jpeg"></td></tr></tbody></table><br><p>  <em>Le balisage vous permet d'effectuer une mise en forme conditionnelle, par exemple, de mettre en surbrillance la temp√©rature en rouge lorsqu'elle d√©passe la valeur sp√©cifi√©e dans le balisage.</em>  <em>Certains √©l√©ments s'affichent lorsque vous appuyez dessus, par exemple, ¬´Chauffage¬ª, ¬´√âclairage¬ª, ¬´Sir√®ne¬ª, etc.</em> </p><br><p>  C'est tout.  On ramasse √† son tour un fer √† souder, puis un clavier.  Et progressivement, la premi√®re version du syst√®me prend forme.  Comme vous le savez, l'app√©tit vient en mangeant.  En cons√©quence, de nouveaux capteurs et m√™me de nouveaux contr√¥leurs sont ajout√©s √† la premi√®re version du syst√®me, par exemple, pour automatiser une maison d'h√¥tes.  En cons√©quence, √† la premi√®re √©tape, un syst√®me a √©t√© introduit qui: </p><br><ol><li>  Mesure la temp√©rature √† 16 points. </li><li>  Mesure l'humidit√© en 4 points. </li><li>  Mesure la tension du r√©seau 220V √† l'entr√©e de la maison, au stabilisateur. </li><li>  Mesure la lumi√®re ambiante.  L'√©clairage est utilis√© pour allumer automatiquement la lumi√®re. </li><li>  Mesure la pression atmosph√©rique et fait une pr√©vision du temps sur la dynamique de la pression. </li><li>  D√©tecte le mouvement en plusieurs points. </li><li>  Contr√¥le le monde entier dans une maison d'h√¥tes.  Les interrupteurs se sont transform√©s en capteurs. </li><li>  Actionne les sir√®nes. </li><li>  Contr√¥le s√©par√©ment 3 √©tages d'une chaudi√®re √©lectrique, pr√©servant la fonctionnalit√© de l'ancien syst√®me.  Il contr√¥le le chauffage de la chaudi√®re. </li><li>  V√©rifie la pr√©sence de tension sur la chaudi√®re et les √©l√©ments chauffants de la chaudi√®re, et lit √©galement les faits de l'inclusion des √©l√©ments chauffants de la chaudi√®re.  Ceci est important, car, d'une part, la chaudi√®re a un retour sur la temp√©rature du liquide de refroidissement et peut √©teindre les √©l√©ments chauffants lui-m√™me, et d'autre part, un relais de limitation de charge √† deux √©tages est mont√© dans le panneau, qui d√©connecte la chaudi√®re et la chaudi√®re en s√©rie si le seuil de consommation dans la maison est d√©pass√©.  Ces donn√©es seront ensuite utilis√©es dans des algorithmes de maison intelligente.  Mais √† ce stade, je ne savais pas exactement comment, je pensais simplement qu'ils seraient n√©cessaires. </li><li>  Lit les faits d'activer et de d√©sactiver la pompe du circuit solaire. <img src="https://habrastorage.org/webt/pv/so/fa/pvsofanjhrkcdclj2mlrurnll8u.jpeg" align="right"></li><li>  Construit des graphiques de temp√©rature pour la semaine, le jour et l'heure. </li><li>  Envoie des notifications push sur divers √©v√©nements.  Les √©v√©nements peuvent √™tre presque tous, par exemple, mouvement sur le porche, temp√©rature d√©passant un seuil pr√©d√©termin√©, perte / apparition d'√©lectricit√©, etc.  Une alerte SMS a √©galement √©t√© √©mise. </li><li>  L'ancien syst√®me est rest√© physiquement et logiquement s√©par√© du nouveau, bien que les m√™mes capteurs soient partiellement r√©utilis√©s dans le nouveau.  L'ancien syst√®me conservait les fonctions de s√©curit√© et un syst√®me de surveillance / contr√¥le de secours. </li></ol><br><p>  <em>La photo montre l'√©quipement √©lectrique de la maison d'h√¥tes.</em>  <em>La bo√Æte avec l'antenne est le contr√¥leur, la "rondelle" ronde est la sir√®ne, entre eux le capteur DHT22, sous le bouclier il y a un capteur de mouvement, √† gauche il y a une alimentation 12V sans coupure.</em> </p><br><div class="spoiler">  <b class="spoiler_title">Exemple de fonctionnement du syst√®me</b> <div class="spoiler_text"><p>  Toutes les 30 secondes, le contr√¥leur interroge les capteurs de temp√©rature.  En cas de modification des lectures ou √† la demande du serveur, envoie les donn√©es √† la passerelle s√©par√©ment pour chaque capteur.  La passerelle re√ßoit des donn√©es et les envoie via USB √† openHAB.  Dans openHAB, une r√®gle est d√©clench√©e, le message est analys√©, la valeur de temp√©rature correspondante est affect√©e √† l'√©l√©ment correspondant (le concept de base d'openHAB).  Une r√®gle est g√©n√©r√©e qui est configur√©e pour modifier cet √©l√©ment.  Si une r√©action est fournie par la logique, par exemple, ¬´si la temp√©rature est descendue en dessous d'un certain niveau¬ª, une action est effectu√©e, par exemple, ¬´allumer le chauffage de la chaudi√®re¬ª.  Cette commande est envoy√©e via USB √† la passerelle.  La passerelle envoie une commande par radio au contr√¥leur, le contr√¥leur re√ßoit la commande et active le relais correspondant.  Renvoie une confirmation de r√©ception de la commande.  Quelque chose comme √ßa ressemble au sch√©ma g√©n√©ral d'interaction des composants du syst√®me. </p></div></div><br><p>  <strong>Le r√©sultat.</strong>  Objectifs initiaux atteints et encore plus.  Les temp√©ratures sont mesur√©es et visualis√©es sur des graphiques et dans l'interface.  Selon les r√©sultats des observations, il est devenu clair que la temp√©rature de l'eau chaude ne d√©passe jamais 55 degr√©s, et le liquide de refroidissement dans le circuit solaire - 60, vous n'avez pas √† vous soucier de la surchauffe.  On peut voir que la temp√©rature de l'air dans la chaufferie d√©passe parfois 30 degr√©s et que vous devez installer la climatisation.  Il est devenu pratique de contr√¥ler le chauffage, il suffit de toucher les interrupteurs virtuels sur l'√©cran du smartphone.  Ensuite.        . ,    ,       .    ,         .   .     ¬´¬ª,      . <br>    .      ,  24..     ,  Raspberry Pi  2500. Arduino  AliExpress   200,    (nRF24L01+, )     .  ‚Äì .       - ,      .  C'est-√†-dire      . </p><br><div class="spoiler"> <b class="spoiler_title">,     .</b> <div class="spoiler_text"><p>  ,    .  ‚Äî 11.05.2018. ,        49 .     38,      35 .      .           .     . <img src="https://habrastorage.org/webt/a3/ba/3w/a3ba3wjudxbn9u-x-xcp2yjjhvo.jpeg"></p></div></div><br><p> <strong></strong> .  ,  ,          . ,   ,    C++,  Arduino, .     ,         openHAB.  ,        ‚Äì .      . - ,      ,  .    ¬´¬ª.    , ,    .     .   ‚Äì  .         . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr415477/">https://habr.com/ru/post/fr415477/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr415467/index.html">Concours de programmation: commerce (annonces)</a></li>
<li><a href="../fr415469/index.html">Adblock pour la radio</a></li>
<li><a href="../fr415471/index.html">Extension PHP et Kotlin Native. Premi√®re partie, na√Øve</a></li>
<li><a href="../fr415473/index.html">Qui scanne Internet. Il est temps de forger du fer</a></li>
<li><a href="../fr415475/index.html">Analyse du code h√©rit√© en cas de perte du code source: √† faire ou √† ne pas faire?</a></li>
<li><a href="../fr415481/index.html">Le Venezuela bloque les connexions directes avec Tor et le trafic obscurci vers les ponts</a></li>
<li><a href="../fr415483/index.html">7 erreurs courantes lors de la comparaison de vos serveurs avec le cloud</a></li>
<li><a href="../fr415485/index.html">Drive Kingston A1000 - une ambulance pour l'ordinateur portable?</a></li>
<li><a href="../fr415487/index.html">Pages de l'histoire d'Intel. Premi√®re puce, Intel 3101</a></li>
<li><a href="../fr415489/index.html">Facebook cl√¥ture un projet de distribution d'Internet au moyen de drones sur l'√©nergie solaire</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>