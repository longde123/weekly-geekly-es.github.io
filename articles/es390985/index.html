<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê† ü§§ üßïüèº ATmega16 + DS18B20 + LED + Matlab / Simulink = AR üßòüèª üõãÔ∏è üë¶üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pens√© en jugar con los sensores DS18B20 de alguna manera . S√≠, no solo para obtener los valores de temperatura (lo que todos pueden hacer), sino tambi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ATmega16 + DS18B20 + LED + Matlab / Simulink = AR</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/390985/"><img align="left" src="https://habrastorage.org/files/e2a/4a8/d70/e2a4a8d7092845e082baee85d185ebd2.bmp"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pens√© en jugar con los sensores </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS18B20 de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> alguna manera </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">S√≠, no solo para obtener los valores de temperatura (lo que todos pueden hacer), sino tambi√©n para visualizarlo de alguna manera. </font><font style="vertical-align: inherit;">Hab√≠a una idea simple. </font><font style="vertical-align: inherit;">Ponemos la webcam. </font><font style="vertical-align: inherit;">Encendemos la luz en un marco par, en uno extra√±o que apagamos. </font><font style="vertical-align: inherit;">Reste la imagen: solo queda el flash. </font><font style="vertical-align: inherit;">En √©l, estamos buscando la ubicaci√≥n del sensor, que est√° f√≠sicamente conectado al LED en el espacio. </font><font style="vertical-align: inherit;">Y luego el procesamiento matem√°tico. </font><font style="vertical-align: inherit;">Bueno, todo esto en una simulinka. </font><font style="vertical-align: inherit;">Bajo katom se describe c√≥mo recibir bellas im√°genes. </font><font style="vertical-align: inherit;">Y para aquellos que no quieren entender, sugiero mirar los experimentos al final del art√≠culo.</font></font><br>
<a name="habracut"></a><br>
<br clear="left">
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Circuiter√≠a</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El circuito es extremadamente simple. </font><font style="vertical-align: inherit;">El coraz√≥n es el ATmega16. </font><font style="vertical-align: inherit;">Todos los sensores DS18B20 se cuelgan en el mismo pin (en mi caso, en el PB0 del puerto PORTB). </font><font style="vertical-align: inherit;">El pin en s√≠ mismo es arrastrado a la tensi√≥n de alimentaci√≥n a trav√©s de una resistencia de 4.7 kŒ©. </font><font style="vertical-align: inherit;">El esquema es escalable. </font><font style="vertical-align: inherit;">Se puede hacer clic en la imagen.</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/files/1d6/87f/7dd/1d687f7ddbbc4e29858d20b4ceebcfe7.bmp"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos los LED est√°n conectados al puerto PORTA a trav√©s de resistencias terminales. </font><font style="vertical-align: inherit;">Un pol√≠gono gris significa que este LED est√° f√≠sicamente conectado al DS18B20. </font><font style="vertical-align: inherit;">El pin de reinicio se eleva a trav√©s de una resistencia de 10 kŒ© para evitar un reinicio accidental debido a interferencia. </font><font style="vertical-align: inherit;">El microcontrolador tiene una velocidad de reloj de cuarzo de 16 MHz. </font><font style="vertical-align: inherit;">Poner lo m√°s cerca posible de las conclusiones. </font><font style="vertical-align: inherit;">Los tanques de carga se utilizan internamente. </font><font style="vertical-align: inherit;">Configurado mediante fusible. </font><font style="vertical-align: inherit;">Separe los conectores ICP (para cargar firmware) y UART para "comunicaci√≥n". </font><font style="vertical-align: inherit;">Capacidades C1 (electrolito 10 ŒºF) y C2 (cer√°mica 100 nF). </font><font style="vertical-align: inherit;">Coloque lo m√°s cerca posible de los pines de alimentaci√≥n del microcontrolador. </font><font style="vertical-align: inherit;">Se utiliza para evitar descargas accidentales durante la transferencia de carga.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asamblea de circuitos</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/20a/9b3/6fa/20a9b36fade242d9b70e10be068168ad.jpg"></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© es un pol√≠gono gris?</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/d61/bca/b30/d61bcab30e4041e6977ff8d55687d58a.jpg"></div></div><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware + algoritmo de trabajo</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El firmware fue escrito en C en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atmel Studio 7</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IDE. </font><font style="vertical-align: inherit;">Las fuentes se publican en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">El c√≥digo est√° documentado al m√°ximo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El proyecto se divide en varios niveles de abstracci√≥n:</font></font><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hardware</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : el nivel m√°s bajo, la uni√≥n m√°xima al hardware. </font><font style="vertical-align: inherit;">Trabajar con la periferia del microcontrolador.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El middleware</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es el punto medio entre el hardware y los controladores. </font><font style="vertical-align: inherit;">Por ejemplo, la implementaci√≥n del protocolo 1-Wire.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controladores</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - nivel de conductor. </font><font style="vertical-align: inherit;">Por ejemplo, trabajando con el chip DS18B20.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplicaci√≥n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : el m√°s alto nivel de abstracci√≥n. </font><font style="vertical-align: inherit;">Por ejemplo, recibir y transmitir temperatura a trav√©s de UART.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un vistazo r√°pido a la funci√≥n principal. </font><font style="vertical-align: inherit;">Primero viene la tabla de direcciones ROM. </font><font style="vertical-align: inherit;">Es necesario que la direcci√≥n del sensor f√≠sicamente conectado al LED cero (colgado en el PA0 del puerto PORTA) est√© en la posici√≥n cero, etc. </font><font style="vertical-align: inherit;">Para obtener ROM, hay una funci√≥n </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sendROMToUART</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Solo necesita recordar que el sensor debe estar solo en el bus, de lo contrario habr√° un conflicto de direcciones.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">principal</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">
</span></span>{	
	<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> ROM[][<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM_T)] = <span class="hljs-comment"><span class="hljs-comment">/* ROM array */</span></span><font></font>
	{<font></font>
		{<span class="hljs-number"><span class="hljs-number">0x26</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4B</span></span>, <span class="hljs-number"><span class="hljs-number">0x15</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 0</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x71</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xC0</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 1</span></span>
		{<span class="hljs-number"><span class="hljs-number">0xA5</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xCB</span></span>, <span class="hljs-number"><span class="hljs-number">0xCE</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 2</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x41</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xAC</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 3</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x22</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4B</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0x0D</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 4</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x86</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xF6</span></span>, <span class="hljs-number"><span class="hljs-number">0x46</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}  <span class="hljs-comment"><span class="hljs-comment">// 5</span></span><font></font>
	};<font></font>
	<font></font>
	<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> nDevices = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM) / <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM_T); <span class="hljs-comment"><span class="hljs-comment">/* Number of DS18B20 devices */</span></span><font></font>
	<font></font>
	initUART(MYUBRR); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of UART with appropriate baudrate */</span></span>
	initTimer0(); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of Timer/counter0 */</span></span>
	initLED(nDevices); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of LEDs */</span></span><font></font>
	<font></font>
	{ <span class="hljs-comment"><span class="hljs-comment">/* DS18B20s initialization */</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> nDevices = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM) / <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM_T); <span class="hljs-comment"><span class="hljs-comment">/* Number of DS18B20 devices */</span></span>
		ROM_T *pROM = (ROM_T *)&amp;ROM; <span class="hljs-comment"><span class="hljs-comment">/* Pointer to ROM array */</span></span><font></font>
		<font></font>
		initDQ(); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of DQ pin */</span></span><font></font>
		<font></font>
		<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (nDevices--) <span class="hljs-comment"><span class="hljs-comment">/* For all DS18B20 */</span></span>
			initDS18B20(pROM++, RESOLUTION_11BIT); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of DS18B20 with appropriate resolution */</span></span><font></font>
	}<font></font>
	<font></font>
	sei(); <span class="hljs-comment"><span class="hljs-comment">/* Global enable interrupts */</span></span><font></font>
	<font></font>
	<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment">/* Infinite loop */</span></span><font></font>
	{<font></font>
		sendTemperatureToUART((ROM_T *)&amp;ROM, nDevices); <span class="hljs-comment"><span class="hljs-comment">/* Execute function routine */</span></span><font></font>
	}<font></font>
}<font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo siguiente es la inicializaci√≥n de los perif√©ricos y el DS-ok con la resoluci√≥n adecuada. </font><font style="vertical-align: inherit;">El per√≠odo de muestreo de temperatura depende de ello. </font><font style="vertical-align: inherit;">Para 11 bits, esto es 375 ms. </font><font style="vertical-align: inherit;">En un bucle infinito, el programa lee continuamente la temperatura de cada sensor y la env√≠a a trav√©s de UART. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El trabajo con LED se basa en interrupciones. </font><font style="vertical-align: inherit;">Por UART viene la ID del LED 2 veces seguidas en un marco par e impar. </font><font style="vertical-align: inherit;">Al principio, el LED se ilumina. </font><font style="vertical-align: inherit;">El temporizador se apaga despu√©s de un cierto tiempo (en mi caso, 15 ms). </font><font style="vertical-align: inherit;">La segunda vez es simplemente ignorada. </font><font style="vertical-align: inherit;">El temporizador est√° configurado en modo CTC para que se produzca una interrupci√≥n una vez cada 1 ms.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codigo</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> ledID = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* Current ledID value */</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> ledID_prev = <span class="hljs-number"><span class="hljs-number">255</span></span>;  <span class="hljs-comment"><span class="hljs-comment">/* Previous ledID value */</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> duration = FLASH_DURATION; <span class="hljs-comment"><span class="hljs-comment">/* Flash duration value */</span></span><font></font>
<font></font>
ISR(USART_RXC_vect) <span class="hljs-comment"><span class="hljs-comment">/* UART interrupt handler */</span></span><font></font>
{<font></font>
	ledID = UDR; <span class="hljs-comment"><span class="hljs-comment">/* Assign ledID to receive via UART value */</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ledID != ledID_prev) <span class="hljs-comment"><span class="hljs-comment">/* If current ledID equal to previous value */</span></span><font></font>
	{<font></font>
		turnOnLED(ledID); <span class="hljs-comment"><span class="hljs-comment">/* Turn on the ledID LED */</span></span>
		timer0Start(); <span class="hljs-comment"><span class="hljs-comment">/* Start Timer0 */</span></span>
		ledID_prev = ledID; <span class="hljs-comment"><span class="hljs-comment">/* Previous ledID assign to current */</span></span>
		duration = FLASH_DURATION; <span class="hljs-comment"><span class="hljs-comment">/* Update LED flash duration */</span></span><font></font>
	}<font></font>
}<font></font>
<font></font>
ISR(TIMER0_COMP_vect) <span class="hljs-comment"><span class="hljs-comment">/* Timer0 compare interrupt handler */</span></span><font></font>
{<font></font>
	<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (--duration == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">/* Decrement Duration value each 1ms and if it reach to 0 */</span></span><font></font>
	{<font></font>
		timer0Stop(); <span class="hljs-comment"><span class="hljs-comment">/* Stop Timer0 */</span></span>
		turnOffAllLED(); <span class="hljs-comment"><span class="hljs-comment">/* Turn off all LEDs */</span></span>
		timer0Clear(); <span class="hljs-comment"><span class="hljs-comment">/* Clear Timer0 counter register */</span></span><font></font>
	}<font></font>
}<font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las secciones de c√≥digo sensibles al tiempo, que son se√±ales de 1 cable, est√°n envueltas en una </font><font style="vertical-align: inherit;">construcci√≥n </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ATOMIC_BLOCK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Todos los ajustes b√°sicos se realizan en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">global.h</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">UART opera a una velocidad de 250,000. R√°pido y sin errores para cuarzo de 16 MHz. </font><font style="vertical-align: inherit;">El controlador DS18B20 tiene la funcionalidad m√≠nima necesaria para este proyecto. </font><font style="vertical-align: inherit;">El resto, ver el c√≥digo. </font><font style="vertical-align: inherit;">Habr√° preguntas, pregunte, no sea t√≠mido. </font><font style="vertical-align: inherit;">Tambi√©n me gustar√≠a recordarle sobre la configuraci√≥n de los fusibles. </font><font style="vertical-align: inherit;">Necesitan establecer la capacidad de reloj desde el cuarzo externo, de lo contrario ser√° desde el generador interno (y est√° a un m√°ximo de 8 MHz y no es muy estable). </font><font style="vertical-align: inherit;">Bueno, programe el bit CKOPT, de lo contrario el cuarzo por encima de 8 MHz no comenzar√°. </font><font style="vertical-align: inherit;">Tengo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fusible alto = 0xD9</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fusible bajo = 0xFF</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelo Simulink + algoritmo de operaci√≥n</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versi√≥n de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la Matlab R2015b</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">En </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el Simulink</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , adem√°s de la biblioteca incorporada, que se utiliza principalmente </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computer Vision System Toolbox</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagen Adquisici√≥n de herramientas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Todo el modelo y los archivos relacionados se cargan en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">A continuaci√≥n se muestra una descripci√≥n detallada con ejemplos ilustrativos. </font><font style="vertical-align: inherit;">Todas las im√°genes son clicables.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√≥dulo WebCamTemp</font></font></h2><br>
<a href=""><img align="left" src="https://habrastorage.org/files/f1d/b35/8bb/f1db358bbf3f4bb4b9b31dc3724daf27.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los bloques amarillos indican bloques de puertos COM. Por separado transmisor, receptor y configurador. La configuraci√≥n del puerto debe coincidir exactamente con la del microcontrolador (velocidad, paridad, n√∫mero de bits, etc.). El receptor toma la temperatura al agruparla en una matriz unidimensional de tama√±o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[n 1] de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tipo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int16</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donde </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es el n√∫mero de DS18B20 (tengo 6). Cada elemento de esta matriz se divide adem√°s por </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Esto es de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hoja de datos en la</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> p√°gina 6. El transmisor env√≠a el valor del contador actual a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Counter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Simplemente enciende un LED particular. Marcando de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Periodo 2 muestras. </font><font style="vertical-align: inherit;">Los bloques responsables de mostrar / guardar la secuencia de video se agrupan en azul. </font><font style="vertical-align: inherit;">Verde: bloques para recibir informaci√≥n de video. </font><font style="vertical-align: inherit;">En realidad, la c√°mara web en s√≠. </font><font style="vertical-align: inherit;">Hay muchas configuraciones diferentes seg√∫n el fabricante. </font><font style="vertical-align: inherit;">La imagen se muestra en tonos grises. </font><font style="vertical-align: inherit;">Muy interesante </font><font style="vertical-align: inherit;">El bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diff</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hace la diferencia entre los cuadros anteriores y actuales. </font><font style="vertical-align: inherit;">El bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impar Downsample</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> solo resalta la diferencia encendida, no un LED encendido, pero no al rev√©s. </font><font style="vertical-align: inherit;">El bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Downsample incluso</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> omite cuadros cuando el LED est√° apagado.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Img diff</font></font></b><div class="spoiler_text"> ,  ‚Äî  .        (  ).    ,       .    0.25.<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/tbpDALqIc0g%3Ffeature%3Doembed&amp;usg=ALkJrhj5P57U10gVOx1NGXAEqiRw5dCV_g" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Img gris</font></font></b><div class="spoiler_text"> ,  ‚Äî ,     .      ,    .    .<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/ATGUUmG77eo%3Ffeature%3Doembed&amp;usg=ALkJrhgTsimNbL_jyJdkuJQ0Meiy_CmAXA" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La pantalla de velocidad de fotogramas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> muestra el FPS actual. </font><font style="vertical-align: inherit;">Todo el procesamiento est√° en el bloque de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Lo consideraremos de la siguiente manera.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√≥dulo LED</font></font></h2><br>
<a href=""><img align="left" src="https://habrastorage.org/files/636/73d/92d/63673d92d053459c9c0c226edded2d13.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Violeta agrupa bloques de obtenci√≥n de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gaussianos 2D</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Necesitamos dos: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interferencia</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opacidad</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Se diferencian en sigma. </font><font style="vertical-align: inherit;">Su centro est√° en el punto m√°ximo (donde estaba encendido el LED). </font><font style="vertical-align: inherit;">Las coordenadas se encuentran en el bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√°ximo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">En lugar de generar constantemente tales Gaussianos (y el exponente es una operaci√≥n matem√°tica que consume mucho tiempo), se decidi√≥ eliminarlos. </font><font style="vertical-align: inherit;">Para hacer esto, en el archivo m, </font><b><font style="vertical-align: inherit;">se</font></b><font style="vertical-align: inherit;"> generan dos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con tama√±os 2 veces m√°s grandes con el centro en el medio, de los cuales, adem√°s, los necesarios simplemente se recortan con los bloques de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interferencia de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recorte </font><font style="vertical-align: inherit;">y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opacidad de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recorte </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ejemplo de trabajo</font></font></b><div class="spoiler_text">  ‚Äî   .   ‚Äî         .   ‚Äî      .   ‚Äî     .     0.25.<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/wGYyoVUJ8nQ%3Ffeature%3Doembed&amp;usg=ALkJrhhsf0a6djrQGlPdVPevjCEsw5lKUA" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los bloques de memoria est√°n rodeados de verde. Su prop√≥sito es almacenar las coordenadas y gaussianos para cada LED. Consideramos con m√°s detalle a continuaci√≥n. El bloque de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">color A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° </font><font style="vertical-align: inherit;">destinado a construir una distribuci√≥n de temperatura y un mapa de color. Tambi√©n se discutir√° a continuaci√≥n. Se√±al de unidad de composici√≥n </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compositing</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mezclas de las dos im√°genes </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la siguiente manera:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/84a/62d/3d6/84a62d3d604b42c5b0923eb74d8d58d4.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Insertar texto</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> impone texto formateado (en este caso, temperatura) en la imagen. </font><font style="vertical-align: inherit;">Acepta </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variables y coordenadas en el formato </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[XY]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Puede seleccionar la fuente y su tama√±o. </font><font style="vertical-align: inherit;">Los bloques dentro del rect√°ngulo rojo implementan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el algoritmo de promedio m√≥vil</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Las transiciones se vuelven menos nerviosas, lo que preserva los nervios y agrada al ojo.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ejemplo</font></font></b><div class="spoiler_text"> ,  ‚Äî    8- .            (  )     .<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/Z8NgbGUZS50%3Ffeature%3Doembed&amp;usg=ALkJrhjAQNjaQMS_t_AzJD3Hg19uOngkcQ" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√≥dulos de memoria</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La interferencia de memoria</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opacidad de la memoria</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> almacenan conjuntos Gaussianos 2D, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pts de memoria</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : coordenadas para cada LED.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interferencia de memoria y opacidad de memoria</font></font></b><div class="spoiler_text"><a href=""><img align="left" src="https://habrastorage.org/files/06d/f15/23e/06df1523e1d245f7b824b151f7dfa0e3.bmp"></a>   .   <b>Address</b>       .   .     .  <b>Delay</b>  <b>LEDs</b>     (  ,    ).      .  <b>Enable</b>  .   ,      (  <b>Maximum</b>  <b>Threshold</b>  <b>LEDs</b>).    ‚Äî    .       .      <b>[H W n]</b>,  <b>HxW</b> ‚Äî  -,   <b>n</b> ‚Äî  /.<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pts de memoria</font></font></b><div class="spoiler_text"><a href=""><img align="left" src="https://habrastorage.org/files/f25/02b/441/f2502b4415bd4badad2de75142a84044.bmp"></a>     .           .   <b>Permute Matrix</b>    ,     <b>[Y X]</b>,   <b>[X Y]</b>.<br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para colorear el m√≥dulo</font></font></h2><br>
<a href=""><img align="left" src="https://habrastorage.org/files/ff4/661/f73/ff4661f7313342bc87aab6257d405ee9.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verde: procesamiento de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opacidad</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Resumir la matriz de entrada en la tercera dimensi√≥n. Lo normalizamos al m√°ximo. Multiplique por el valor de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ganancia</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (de 0 a 1) </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En total, tenemos una matriz con gaussianos superpuestos entre s√≠ y una </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ganancia</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m√°xima </font><font style="vertical-align: inherit;">. Se utiliza como </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">factor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para mezclar im√°genes. Rojo: recibe un mapa de color de las temperaturas. Aqu√≠ un poco de matem√°tica diferente, todos los mismos gaussianos. Se describe mediante la f√≥rmula </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(2)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En t√©rminos generales, la temperatura en un punto arbitrario es el promedio ponderado de todos los sensores. Pero la influencia de cada sensor en una proporci√≥n porcentual es proporcional al valor de Gauss en √©l. La suma de todos se toma como 100%.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/87a/e2d/4a3/87ae2d4a31ba4759bb9cf4d093fff846.gif"></div><br>
<a href=""><img align="left" src="https://habrastorage.org/files/c51/f48/e29/c51f48e29b614eb28a0134f517ee49e8.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Queda por considerar c√≥mo la distribuci√≥n de temperatura se convierte en un mapa de colores. </font><font style="vertical-align: inherit;">Lo que se encierra en un c√≠rculo en azul convierte la temperatura espec√≠fica en un valor entre 0 y 1. En la zona roja, el bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prelookup</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calcula el √≠ndice por el cual se busca el valor de rojo, verde y azul. </font><font style="vertical-align: inherit;">La matriz de colores contiene 64 valores. </font><font style="vertical-align: inherit;">Los intermedios se calculan por interpolaci√≥n. </font><font style="vertical-align: inherit;">De las caracter√≠sticas, hay dos modos: relativo y absoluto. </font><font style="vertical-align: inherit;">En el lugar relativamente m√°s fr√≠o y m√°s caliente, corresponde el m√≠nimo y el m√°ximo de la matriz de entrada. </font><font style="vertical-align: inherit;">En absoluto, hay algunos valores constantes. </font><font style="vertical-align: inherit;">En el primero, es m√°s conveniente mirar el perfil de distribuci√≥n de temperatura. </font><font style="vertical-align: inherit;">En el otro, sus cambios absolutos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archivo m</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se ejecuta al principio, antes de la simulaci√≥n, introduciendo variables en el espacio de trabajo.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codigo</font></font></b><div class="spoiler_text"><pre><code class="matlab hljs">H = <span class="hljs-number"><span class="hljs-number">480</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Height of image</span></span>
W = <span class="hljs-number"><span class="hljs-number">640</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Width of image</span></span>
minT = <span class="hljs-number"><span class="hljs-number">20</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Min temperature</span></span>
maxT = <span class="hljs-number"><span class="hljs-number">25</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Max temperature</span></span>
sigmaInt = <span class="hljs-number"><span class="hljs-number">40</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Sigma interference</span></span>
sigmaOp = <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Sigma opacity</span></span>
gain = <span class="hljs-number"><span class="hljs-number">1.0</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Gain value</span></span>
T = <span class="hljs-number"><span class="hljs-number">0.3</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Threshold value</span></span>
nAvr = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-comment"><span class="hljs-comment">% number of means</span></span>
<span class="hljs-comment"><span class="hljs-comment">% ------------------------------------------------------</span></span>
[M,N] = <span class="hljs-built_in"><span class="hljs-built_in">meshgrid</span></span>(-W:W, -H:H); <span class="hljs-comment"><span class="hljs-comment">% Meshgrid function</span></span><font></font>
<font></font>
R = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(M.^<span class="hljs-number"><span class="hljs-number">2</span></span> + N.^<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">% Distance from the center</span></span><font></font>
<font></font>
Int = normpdf(R, <span class="hljs-number"><span class="hljs-number">0</span></span>, sigmaInt); <span class="hljs-comment"><span class="hljs-comment">% 2D gaussian for interference</span></span>
Op = normpdf(R, <span class="hljs-number"><span class="hljs-number">0</span></span>, sigmaOp); <span class="hljs-comment"><span class="hljs-comment">% 2D gaussian for opacity</span></span><font></font>
<font></font>
Int = Int/<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(Int)); <span class="hljs-comment"><span class="hljs-comment">% Normalization of interference gaussian</span></span>
Op = Op/<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(Op)); <span class="hljs-comment"><span class="hljs-comment">% Normalization of opacity gaussian</span></span><font></font>
<font></font>
clear M N R sigmaInt sigmaOp <span class="hljs-comment"><span class="hljs-comment">% Delete unused variables from memory</span></span><font></font>
<font></font>
load(<span class="hljs-string"><span class="hljs-string">'MyColormaps'</span></span>,<span class="hljs-string"><span class="hljs-string">'mycmap'</span></span>); <span class="hljs-comment"><span class="hljs-comment">% Load colormap</span></span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contiene las principales variables de control entre las cuales:</font></font><br>
<ul>
<li><b>H</b> ‚Äî    .</li>
<li><b>W</b> ‚Äî    .</li>
<li><b>minT</b> ‚Äî   .</li>
<li><b>maxT</b> ‚Äî   .</li>
<li><b>sigmaInt</b> ‚Äî   Interference.</li>
<li><b>sigmaOp</b> ‚Äî   Opacity.</li>
<li><b>gain</b> ‚Äî   Factor.</li>
<li><b>T</b> ‚Äî    .</li>
<li><b>nAvr</b> ‚Äî     .</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deben coincidir con la corriente en el bloque WebCamera. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maxT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> afectan el mapa de color en modo de temperatura absoluta. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T est√°</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> configurado de 0 a 1. A veces, el puerto COM y la c√°mara web no est√°n sincronizados. </font><font style="vertical-align: inherit;">La fase de la imagen diferencial puede cambiar 180 ¬∞. </font><font style="vertical-align: inherit;">Y donde deber√≠a haber un m√°ximo, hay un m√≠nimo. </font><font style="vertical-align: inherit;">Y el sistema puede elegir una coordenada arbitraria que no se corresponde con la realidad. </font><font style="vertical-align: inherit;">Para esto, hay un sistema de umbral. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nAvr es el</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√∫mero de promedios en el promedio m√≥vil. </font><font style="vertical-align: inherit;">Cuanto m√°s grande es, m√°s suaves son las transiciones, pero se pierde relevancia (aparece un cambio de tiempo). </font><font style="vertical-align: inherit;">Para comprender el efecto de las variables restantes, uno no puede resolverlo sin ejemplos ilustrativos.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Efecto SigmaInt</font></font></b><div class="spoiler_text"> <img src="https://habrastorage.org/files/dd4/52e/fa0/dd452efa07f74879864a7da50c880f39.gif">      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a>.  <img src="https://habrastorage.org/files/5de/994/dd0/5de994dd0e834600b8fff948ae13eb07.gif">       ,   , .   ‚Äî    .<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/cZV_ayNrWgE%3Ffeature%3Doembed&amp;usg=ALkJrhjeXjjYPkY31QYwJMOi8XH7-x9kKQ" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Efecto SigmaOp</font></font></b><div class="spoiler_text">     .<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/S8R4A9AKFZU%3Ffeature%3Doembed&amp;usg=ALkJrhhoa0oHfXFVQzoqFtelgQYjZ_75uA" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ganar efecto</font></font></b><div class="spoiler_text">-   .    ¬´¬ª  ¬´ ¬ª  .<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/mvKfUSIw3rI%3Ffeature%3Doembed&amp;usg=ALkJrhjx_T5va_RMGE2Pwh3PgakZv6x6yg" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los experimentos</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los siguientes son algunos experimentos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ventana abierta</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los sensores est√°n dispersos en la cama junto a la ventana. </font><font style="vertical-align: inherit;">La ventana se abre y se cierra despu√©s de un rato. </font><font style="vertical-align: inherit;">Un buen ejemplo de la diferencia entre los modos relativo (izquierda) y absoluto (derecha). </font><font style="vertical-align: inherit;">Usando el primero, es conveniente considerar la distribuci√≥n, y el segundo, c√≥mo se distribuye el fr√≠o o se restaura el calor.</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/AlDT9XyCSeo%3Ffeature%3Doembed&amp;usg=ALkJrhj1Bmp_LryM-shhyU5PvUYdyg_Nrw" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alf√©izar de la ventana</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los sensores est√°n ubicados a lo largo del alf√©izar de la ventana. </font><font style="vertical-align: inherit;">Se abre la ventana; el perfil cambia. </font><font style="vertical-align: inherit;">Las zonas m√°s fr√≠as y c√°lidas son claramente visibles.</font></font><br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/OX8_0pjPLZg%3Ffeature%3Doembed&amp;usg=ALkJrhjJhLjYyqMF0DmhV2gN_2Luc79esg" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øHace m√°s calor en la parte superior?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dicen que la parte superior es m√°s c√°lida. </font><font style="vertical-align: inherit;">Este experimento es una confirmaci√≥n completa de esto. </font><font style="vertical-align: inherit;">En el d√©cimo segundo, la ventana se abre, en el 30, se cierra.</font></font><br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/pUDan07bd-E%3Ffeature%3Doembed&amp;usg=ALkJrhhoJjjTckRkcEq_tNFMpRqFVqi6mQ" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tal esquema no reemplazar√° una c√°mara termogr√°fica de pleno derecho. </font><font style="vertical-align: inherit;">Pero no puede ver la propagaci√≥n de las masas de aire. </font><font style="vertical-align: inherit;">Y a un precio, este dise√±o es incomparablemente m√°s bajo. </font><font style="vertical-align: inherit;">Puedes usar un mapa de color diferente en √©l. </font><font style="vertical-align: inherit;">Puede tomar otras funciones en lugar de gaussianas. </font><font style="vertical-align: inherit;">Incluso puedes cambiar las leyes de la construcci√≥n. </font><font style="vertical-align: inherit;">O reescriba a OpenCV + QT para mayor velocidad y conveniencia. </font><font style="vertical-align: inherit;">Pero eso es lo que he concebido, lo he logrado. </font><font style="vertical-align: inherit;">Solo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por diversi√≥n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es390985/">https://habr.com/ru/post/es390985/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es390975/index.html">Previsiones para 2016: tres tendencias principales en la industria de semiconductores</a></li>
<li><a href="../es390977/index.html">Noticias de Sony en MWC 2016: Xperia X, Xperia X Performance y Xperia XA</a></li>
<li><a href="../es390979/index.html">Lenovo Ideacentre Stick 300: peque√±o S√≠</a></li>
<li><a href="../es390981/index.html">C√≥mo Motorika fabrica pr√≥tesis para ni√±os</a></li>
<li><a href="../es390983/index.html">Trampas de lobos y ovejas, zombis y langosta: un breve diccionario de jerga com√∫n</a></li>
<li><a href="../es390987/index.html">Sony compr√≥ un video de un artista ruso y lo bloque√≥ en YouTube (nuevamente)</a></li>
<li><a href="../es390989/index.html">El tel√©fono modular Fairphone 2 ya est√° disponible</a></li>
<li><a href="../es390993/index.html">El ojo de mariposa se convirti√≥ en un modelo para rectenos de grafeno con absorci√≥n de luz r√©cord</a></li>
<li><a href="../es390995/index.html">MasterCard prepara opciones de verificaci√≥n del cliente usando selfies, tonos de voz y frecuencia card√≠aca</a></li>
<li><a href="../es390997/index.html">9 drones que no necesitan registro</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>