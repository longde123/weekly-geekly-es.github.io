<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🎤 👾 👋🏿 Mein Hausautomationssystem. Erstellen eines Betriebssystemabbilds 👨🏼‍🎓 🖐️ 🚟</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einführung 

 Installieren des Systems auf einem Raspberry Pi 2.3 

 Ich werde meiner Meinung nach den einfachsten Weg für Anfänger beschreiben. 

 Al...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mein Hausautomationssystem. Erstellen eines Betriebssystemabbilds</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446190/">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einführung</a> <br><br>  Installieren des Systems auf einem Raspberry Pi 2.3 <br><br>  Ich werde meiner Meinung nach den einfachsten Weg für Anfänger beschreiben. <br><br>  Alle Aktionen werden in Ubuntu 18.04 ausgeführt. <br><br>  Verwenden Sie für Hilfe zu den Befehlen den Befehl "man" + den gewünschten Befehl. <br><br><pre><code class="bash hljs">man ls</code> </pre> <br>  Oder den notwendigen Befehl mit der Taste --help <br><br><pre> <code class="bash hljs">ls --<span class="hljs-built_in"><span class="hljs-built_in">help</span></span></code> </pre> <br><a name="habracut"></a><br>  1. Installieren des Raspbian Stretch Lite-Betriebssystems auf einer microSD-Karte. <br><br>  Die MicroSD-Karte sollte Klasse 10 und eine Kapazität von 8 Gigabyte haben. <br>  Legen Sie die SD-Karte in den Computer ein und geben Sie den folgenden Befehl ein: <br><br><pre> <code class="bash hljs">lsblk</code> </pre> <br><img src="https://habrastorage.org/webt/li/ti/y4/litiy47g_6lk1faubuj78odw3vi.png"><br><br>  Im Beispiel ist die Karte als mmcblk0 definiert, dann werde ich diesen Namen verwenden. <br><br>  Um die Karte von zuvor aufgezeichneten Informationen zu befreien (dann erstellen wir ein Disk-Image), müssen Sie sie mit dem folgenden Befehl löschen: <br><br><pre> <code class="bash hljs">dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/dev/zero of=/dev/mmcblk0</code> </pre> <br>  Für diesen Befehl sind Superuser-Rechte erforderlich. Dazu müssen Sie am Anfang das Schlüsselwort <i>„sudo“</i> hinzufügen.  Im Folgenden gebe ich Befehle ohne <i>Sudo</i> .  Verwenden Sie bei der Eingabe von Befehlen die automatische Vervollständigung (Tabulatortaste). Dies ist erforderlich, um die korrekte Eingabe von Befehlen und Dateipfaden zu steuern.  Während der Befehl ausgeführt wird, können Sie eine neue Distribution des Betriebssystems herunterladen. <br><br>  Hier herunterladen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">raspberrypi.org</a> <br>  Wir brauchen Raspbian Stretch Lite.  Entpacken Sie die heruntergeladene Zip-Datei. Wir benötigen eine Datei mit der Erweiterung img. Dies ist das Disk-Image, das wir auf die Karte kopieren.  Wenn wir also ein Disk-Image haben und der Befehl dd ausgeführt wird, fahren Sie fort. <br><br>  Kopieren Sie das Bild auf die Karte: <br><br><pre> <code class="bash hljs">dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/path/to/raspbian.img of=/dev/mmcblk0 bs=4M status=progress</code> </pre> <br>  Geben Sie nach Abschluss den folgenden Befehl ein: <br><br><pre> <code class="bash hljs">sync</code> </pre> <br>  Wir nehmen die Karte heraus und legen sie wieder ein. <br><br>  Erstellen Sie eine leere Datei auf der Startdiskette unserer Karte: <br><br><pre> <code class="bash hljs">touch /media/<span class="hljs-variable"><span class="hljs-variable">$USER</span></span>/boot/ssh</code> </pre> <br>  Dies ist erforderlich, damit ein SSH-Server auf Raspberry gestartet wird. <br><br>  Die Karte muss sicher entfernt, in die Himbeere eingesetzt, an ein kabelgebundenes Netzwerk angeschlossen und mit Strom versorgt werden.  Wenn kein 2-Apmera-Netzteil vorhanden ist, können Sie es über USB3 von einem Computer aus mit Strom versorgen.  Beim ersten Start erhöht das System die Größe der Festplatten auf die Größe der Karte. Dies dauert einige Zeit. <br><br>  Um die IP-Adresse unseres RPi herauszufinden, können Sie das Dienstprogramm arp-scan verwenden.  Wenn es nicht installiert ist, setzen Sie: <br><br><pre> <code class="bash hljs">apt install arp-scan</code> </pre> <br>  Wir finden den Namen unserer Netzwerkkarte heraus: <br><br><pre> <code class="bash hljs">ip a</code> </pre> <br>  oder <br><br><pre> <code class="bash hljs">netstat -i</code> </pre> <br><img src="https://habrastorage.org/webt/sg/kr/6w/sgkr6wb793k2l4dmscvleeo_4pa.png"><br><br>  Ich habe eine WLAN-Karte namens wlp1s0. <br><br>  Führen Sie arp-scan aus: <br><br><pre> <code class="bash hljs">arp-scan -I wlp1s0 -l</code> </pre> <br><img src="https://habrastorage.org/webt/vk/fz/oh/vkfzohdrqybskrape13_qijsf8e.png"><br><br>  Ich benötige ein RPi mit IP 192.168.0.114, die Adresse wird von DHCP vergeben und kann alles sein. <br><br>  Wir gehen mit ssh zu RPi: <br><br><pre> <code class="bash hljs">ssh pi@192.168.0.114</code> </pre> <br>  Sie müssen bei der ersten Authentifizierung <i>yes</i> eingeben und dann das Passwort für pi - <i>himbeere</i> eingeben. <br><br>  Wenn wir uns bei Raspberry anmelden konnten, geben Sie den folgenden Befehl ein: <br><br><pre> <code class="bash hljs">init 0</code> </pre> <br>  Dieser Befehl schaltet RPi aus. <br><br>  Sie müssen die Karte erneut in den Computer einlegen.  Jetzt brauchen wir das Programm "gparted", wenn es nicht installiert ist, setzen Sie: <br><br><pre> <code class="bash hljs">apt install gparted</code> </pre> <br>  Wir beginnen gparted, Sie müssen die Größe der Festplatte mmcblk0p2 ändern, am Ende einen nicht zugewiesenen Bereich von 300-500 Megabyte oder 2-3% der Kartengröße belassen. Dies ist erforderlich, damit unser Image auf Karten verschiedener Hersteller passt, und sie können in der Größe variieren.  Das Ergebnis sollte ungefähr so ​​aussehen: <br><br><img src="https://habrastorage.org/webt/pi/gq/y1/pigqy1qfzik2laujmitutxwzn8g.png"><br><br>  Nach Abschluss der Arbeit mit gparted können Sie eine Sicherungskopie der Karte erstellen, sodass Sie bei Problemen in weiteren Experimenten ein fertiges Image haben. <br><br><pre> <code class="bash hljs">dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/dev/mmcblk0 | bzip2 &gt; raspbian.bz2</code> </pre> <br>  Jetzt können wir unsere Festplatte immer mit dem folgenden Befehl wiederherstellen: <br><br><pre> <code class="bash hljs">bzcat raspbian.bz2 | dd bs=4M of=/dev/mmcblk0</code> </pre> <br>  Als Ergebnis haben wir eine microSD-Karte mit einem gebrauchsfertigen Betriebssystem und seiner Sicherungskopie. <br><br>  2. Raspbian Stretch Lite konfigurieren. <br><br>  Wir gehen mit ssh zu RPi.  Fügen Sie am Ende der Datei /etc/dhcpcd.conf die folgenden Einstellungen hinzu, um die statischen Adressen des kabelgebundenen Netzwerks und des WLANs zu konfigurieren: <br><br>  <i>Schnittstelle eth0</i> <i><br></i>  <i>statische IP-Adresse = 192.168.0.10 / 24</i> <i><br></i>  <i>statische Router = 192.168.0.1</i> <i><br></i>  <i>statischer Domänenname_Server = 8.8.8.8, 8.8.4.4</i> <i><br></i>  <i>Schnittstelle wlan0</i> <i><br></i>  <i>statische IP-Adresse = 192.168.0.10 / 24</i> <i><br></i>  <i>statische Router = 192.168.0.1</i> <i><br></i>  <i>statischer Domänenname_Server = 8.8.8.8, 8.8.4.4</i> <br><br>  Mit diesen Einstellungen hat RPi die gleiche IP in einem Kabel- oder WLAN-Netzwerk. <br><br>  Datei zum Konfigurieren von wifi - /etc/wpa_supplicant/wpa_supplicant.conf <br>  Fügen Sie die folgenden Einstellungen hinzu: <br><br>  <i>Netzwerk = {</i> <i><br></i>  <i>ssid = "NAME"</i> <i><br></i>  <i>psk = "PASS"</i> <i><br></i>  <i>}}</i> <br>  Wobei NAME und PASS Benutzername und Passwort aus dem WLAN-Netzwerk.  Wenn nicht im Voraus bekannt ist, wo unser RPi verwendet werden soll, können Name und Passwort später eingegeben werden. <br><br>  Fügen Sie dem Cron-Programm Aufgaben hinzu <br><br><pre> <code class="bash hljs">crontab -e</code> </pre> <br>  Beim ersten Start müssen Sie einen Texteditor auswählen, nano - ist der bekannteste. <br><br><img src="https://habrastorage.org/webt/ki/dr/an/kidranxamlfdaux2i76x5c0vjf4.png"><br><br>  Fügen Sie die folgenden Einstellungen hinzu, damit die Zeitpläne funktionieren: <br><br>  <i>PATH = / usr / sbin: / usr / bin: / sbin: / bin</i> <i><br></i>  <i>SHELL = / bin / bash</i> <br><br>  Und die Aufgaben selbst, wir werden die Zeit jedes Downloads und die Dauer des Dauerbetriebs aufzeichnen, dies werden nützliche Informationen in der Zukunft sein. <br><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Neustart</a> Schlaf 60 &amp;&amp; Datum &gt;&gt; my-reboot.txt</i> <i><br></i>  <i>@ wöchentliche Verfügbarkeit &gt;&gt; my-uptime.txt</i> <br><br>  Zum Beenden die Tastenkombination Strg + x, Y, Enter <br><br>  Das Einstellen der Zeitzone erfolgt über den folgenden Befehl: <br><br><pre> <code class="bash hljs">dpkg-reconfigure tzdata</code> </pre> <br>  Um die Ressource der SD-Karte zu erhöhen, können Sie die Protokollierung beenden und die Auslagerungsdatei löschen: <br><br>  (Ich denke, dies sollte die Wahrscheinlichkeit eines Ausfalls der SD-Karte oder einer Datenbeschädigung bei plötzlichen RPi-Abschaltungen während des Betriebs verringern.) <br><br><pre> <code class="bash hljs">apt update apt purge dphys-swapfile apt autoremove --purge apt install busybox-syslogd dpkg --purge rsyslog</code> </pre> <br>  Installation von Programmen: <br><br><pre> <code class="bash hljs">apt install mosquitto mosquitto-clients sqlite3 libsqlite3-dev mc htop arp-scan vim supervisor python-pip python3-pip python-virtualenv python-dev</code> </pre> <br><pre> <code class="bash hljs">pip install psutil paho-mqtt pip3 install psutil paho-mqtt</code> </pre> <br>  Für homekit2mqtt müssen Sie nodejs installieren: <br><br><pre> <code class="bash hljs">curl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash - apt-get install -y nodejs</code> </pre> <br>  Überprüfen der installierten Version <br><br><pre> <code class="bash hljs">node -v nodejs -v</code> </pre> <br>  Node-Red installieren: <br><br><pre> <code class="bash hljs">npm install -g --unsafe-perm node-red</code> </pre> <br>  Wir starten: <br><br><pre> <code class="bash hljs">node-red</code> </pre> <br><img src="https://habrastorage.org/webt/m7/es/jj/m7esjjrer1ip2vflmp_bgqagxle.png"><br><br>  Geben Sie in die Adressleiste des Browsers die IP-Adresse des RPi 192.168.0.10:1880 ein <br><br><img src="https://habrastorage.org/webt/ki/u_/qk/kiu_qkhawjr3-za-urpaetmamj4.png"><br><br>  Beenden Sie node-red, drücken Sie Strg + c und wechseln Sie in das Verzeichnis .node-red <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> .node-red</code> </pre> <br>  Wenn Sie Pakete für Node-Red installieren, werden diese möglicherweise zum Testen, Konfigurieren und Kommunizieren verschiedener Geräte benötigt. <br><br><pre> <code class="bash hljs">npm i node-red-dashboard node-red-contrib-sonos node-red-contrib-knx node-red-node-serialport node-red-contrib-globalcache node-red-contrib-counter</code> </pre> <br>  Wir kehren zum Ausgangsverzeichnis zurück <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span></code> </pre> <br>  Installieren Sie homekit2mqtt: <br><br><pre> <code class="bash hljs">apt install libavahi-compat-libdnssd-dev npm install -g homekit2mqtt --unsafe-perm</code> </pre> <br>  Sie können versuchen, das Homekit mit dem Befehl auszuführen <br><br><pre> <code class="bash hljs">homekit2mqtt</code> </pre> <br><img src="https://habrastorage.org/webt/o_/nr/wb/o_nrwbgde08t8wxz1f40goswfhc.png"><br><br>  Es beginnt mit den Standardeinstellungen und Sie können ein neues Gerät im Home-Programm auf Ihrem iPhone oder iPad hinzufügen <br><br>  Das Passwort <i>pi</i> verlässt das aktuelle. <br><br>  Nachdem alles installiert und überprüft wurde, müssen Sie unsere SD-Karte auf die gleiche Weise wie zuvor sichern.  Jetzt ist alles bereit, um das Automatisierungssystem zu installieren. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de446190/">https://habr.com/ru/post/de446190/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de446176/index.html">Tankerkennung in einem Videostream mithilfe maschineller Lernmethoden (+2 Videos auf Elbrus- und Baikal-Plattformen)</a></li>
<li><a href="../de446180/index.html">War MongoDB überhaupt die richtige Wahl?</a></li>
<li><a href="../de446184/index.html">TDD-Anwendungen auf Spring Boot: Feinabstimmung der Tests und Arbeiten mit dem Kontext</a></li>
<li><a href="../de446186/index.html">Wie Elon Musk versuchte, den Informanten in den Reihen von Tesla zu zerstören, und was daraus wurde</a></li>
<li><a href="../de446188/index.html">Ist es Zeit für Emoji-URLs?</a></li>
<li><a href="../de446192/index.html">Verlaufssicherung: Sieben Erfinder, von denen Sie vielleicht noch nichts gehört haben</a></li>
<li><a href="../de446194/index.html">New Galatea oder animieren Sie ein Android-Mädchen für einen Science-Fiction-Roman</a></li>
<li><a href="../de446196/index.html">Einführung in 3CX V16 mit Website Communication Widget</a></li>
<li><a href="../de446198/index.html">Zerstörung von Festplattendaten</a></li>
<li><a href="../de446200/index.html">Frontend Weekly Digest (25. - 31. März 2019)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>