<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐤 🤸🏻 🤛🏾 Como ver rapidamente avisos interessantes gerados pelo analisador PVS-Studio para código C e C ++? 👩🏾‍🎓 👜 🃏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="De tempos em tempos, os programadores que começam a se familiarizar com o analisador de código PVS-Studio perguntam: "Existe uma lista de avisos que i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como ver rapidamente avisos interessantes gerados pelo analisador PVS-Studio para código C e C ++?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/457332/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df3/c29/8f2/df3c298f21cb71d0c7c699b7e27269d3.png"></div><br>  De tempos em tempos, os programadores que começam a se familiarizar com o analisador de código PVS-Studio perguntam: "Existe uma lista de avisos que indicam com precisão erros?"  Não existe uma lista desse tipo pelo motivo de que avisos desinteressantes (falsos) em um projeto e em outro se revelam muito importantes e úteis.  No entanto, é possível começar a familiarizar o analisador com os avisos mais interessantes.  Vamos dar uma olhada mais de perto neste tópico. <br><a name="habracut"></a><br>  O problema é que, durante os primeiros lançamentos, o programador, via de regra, recebe um grande número de avisos nos quais "se afoga".  Naturalmente, ele deseja se familiarizar com os avisos mais interessantes para entender se deve passar todo esse tempo.  Bem, aqui estão três etapas simples que permitirão que você se familiarize com as respostas mais interessantes. <br><br><h2>  Etapa 1 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/648/436/d98/648436d98521380495f1c9f8ee384646.png"></div><br><br>  Desative todos os tipos de alertas, exceto geral (GA).  Um erro comum: ative todos os tipos de avisos.  Para usuários inexperientes, parece que quanto mais você ativá-lo, melhor.  Isto não é assim!  Existem conjuntos de diagnósticos, como verificações de 64 bits e regras MISRA, que devem ser usadas apenas com uma idéia clara do que é e como trabalhar com eles.  Por exemplo, ao ativar o diagnóstico MISRA para um programa de aplicativo comum, você se afogará em dezenas, milhares ou centenas de milhares de mensagens como: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V2506</a> .  Misra.  Uma função deve ter um único ponto de saída no final. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V2507</a> .  Misra.  O corpo de uma instrução loop \ condicional deve ser colocado entre chaves. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V2523</a> .  Misra.  Todas as constantes inteiras do tipo não assinado devem ter o sufixo 'u' ou 'U'. </li></ul><br>  A maioria dos avisos MISRA não indica erros, mas o cheiro do código.  Naturalmente, uma pessoa começa a fazer perguntas.  Como encontrar algo interessante na massa de todos esses avisos?  Diagnóstico sob quais números ele deve procurar?  Estas são as perguntas erradas.  Você só precisa desativar o kit MISRA.  Esse é o padrão para escrever código de qualidade para dispositivos incorporados.  A essência do padrão: tornar o código extremamente simples e compreensível.  Não tente aplicá-lo onde for inapropriado. <br><br>  Nota  Sim, existem regras no padrão MISRA destinadas a identificar erros reais.  Exemplo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V2538</a> - O valor da variável não inicializada não deve ser usado.  Mas não tenha medo de desativar o padrão MISRA.  Você não vai perder nada.  Erros reais ainda serão encontrados nos diagnósticos de uso geral (GA).  Por exemplo, uma variável não inicializada será encontrada graças ao diagnóstico <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V614</a> . <br><br><h2>  Etapa 2 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f30/9c1/d2f/f309c1d2fed7a2736170dad987cd4460.png"></div><br><br>  Qualquer analisador estático gera falsos positivos durante as primeiras partidas e requer uma determinada configuração.  Nada pode ser feito com isso, mas não é tão assustador quanto pode parecer.  Mesmo uma configuração rápida e simples permite remover a maioria dos avisos falsos e começar a se familiarizar com um relatório já bastante adequado.  Não falaremos sobre isso com mais detalhes, já que escrevi sobre isso muitas vezes, por exemplo, neste artigo: " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Características do analisador PVS-Studio usando o exemplo das bibliotecas principais da EFL, 10-15% dos falsos positivos</a> ". <br><br>  Passe um pouco de tempo desativando alertas obviamente irrelevantes e combatendo falsos positivos devido a macros.  As macros geralmente são a principal fonte de falsos positivos, pois um aviso aparece sempre que uma macro com falha é usada.  Para suprimir avisos em macros, um tipo especial de comentário pode ser colocado ao lado de sua declaração.  O formato para escrever comentários é discutido em mais detalhes na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documentação</a> . <br><br>  Sim, a configuração inicial levará um pouco de tempo, mas melhorará drasticamente a percepção do relatório, eliminando ruídos perturbadores.  Tire algum tempo para isso.  Se houver alguma dificuldade ou dúvida, estamos sempre prontos para ajudar e sugerir a melhor forma de configurar o analisador.  Sinta-se livre para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">escrever</a> e fazer perguntas. <br><br><h2>  Etapa 3 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f87/0ec/c49/f870ecc49989743ae8caea3c745e602e.png"></div><br><br>  Comece a aprender avisos a partir do nível 1.  E só então veja os 2 e 3. Os níveis de aviso nada mais são do que a confiabilidade do aviso.  Os avisos de nível 1 têm maior probabilidade de indicar um erro verdadeiro que 2. <br><br>  Podemos dizer que, ao escolher “assistir nível 1”, você pressiona o botão “assistir os erros mais interessantes”. <br><br>  A classificação dos alertas do PVS-Studio por níveis é descrita em mais detalhes no artigo “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como e por que os analisadores estáticos lidam com falsos positivos</a> ”. <br><br><h2>  Então, por que ainda não existe uma lista? </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df2/95f/70b/df295f70b19562c12916ec578022829f.png"></div><br><br>  No entanto, uma ideia com uma lista dos avisos mais úteis ainda pode parecer razoável.  Deixe-me mostrar por exemplo prático que a utilidade do diagnóstico é relativa e depende do projeto. <br><br>  Considere o aviso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V550</a> .  Um aviso revela um erro em potencial devido ao fato de o operador == ou! = Ser usado para comparar números de ponto flutuante. <br><br>  A maioria dos desenvolvedores com quem conversei acredita que esse diagnóstico é de pouca utilidade e o desativa, pois todos os aspectos positivos do projeto são falsos.  E é por isso que esse diagnóstico tem baixa confiabilidade e está localizado no 3º nível. <br><br>  De fato, na maioria das aplicações, os tipos float / double são usados ​​em algoritmos muito simples.  E muitas vezes uma comparação com uma constante é usada apenas para verificar se um valor padrão está definido ou se ele foi alterado.  Nesse caso, uma verificação precisa é bastante apropriada.  Vou explicar isso com pseudo-código. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> value = <span class="hljs-number"><span class="hljs-number">1.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (IsUserInputNewValue()) value = GetUserValue(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value == <span class="hljs-number"><span class="hljs-number">1.0f</span></span>) DefaultBehavior(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Foo(value);</code> </pre> <br>  Aqui a comparação <i>(valor == 1.0f) é</i> correta e segura. <br><br>  Isso significa que o V550 é um diagnóstico desinteressante?  Não.  Tudo depende do projeto.  Vou citar um fragmento do artigo " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como testamos a análise estática em nosso projeto de um simulador de treinamento de cirurgia endovascular</a> " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">,</a> escrito por um de nossos usuários. <br><br>  Então, o que o analisador estático chama nossa atenção aqui: <br><br>  V550 Uma comparação precisa e estranha: t! = 0. Provavelmente é melhor usar uma comparação com precisão definida: fabs (A - B)&gt; Epsilon.  objectextractpart.cpp 3401 <br><br><pre> <code class="cpp hljs">D3DXVECTOR3 N = VectorMultiplication( VectorMultiplication(V-VP, VN), VN); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = Qsqrt(Scalar(N, N)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t!=<span class="hljs-number"><span class="hljs-number">0</span></span>) { N/=t; V = V - N * DistPointToSurface(V, VP, N); }</code> </pre> <br>  Erros semelhantes são repetidos com bastante frequência nesta biblioteca.  Não direi que isso me surpreendeu.  Já encontrei anteriormente um trabalho incorreto com números de ponto flutuante neste projeto.  No entanto, não havia recursos para verificar sistematicamente as fontes para isso.  De acordo com os resultados da verificação, ficou claro que você precisa fornecer ao desenvolvedor algo para ler para ampliar seus horizontes em termos de trabalhar com números de ponto flutuante.  Eu joguei links para alguns bons artigos.  Vejamos o resultado.  É difícil dizer sem ambiguidade se esse erro causa problemas reais no programa.  A solução atual define uma série de requisitos para a rede poligonal inicial de artérias, ao longo da qual a propagação de uma substância radiopaca é simulada.  Se os requisitos não forem atendidos, o programa poderá falhar ou operação obviamente incorreta.  Alguns desses requisitos são obtidos analiticamente e outros empiricamente.  É possível que essa segunda parte dos requisitos cresça apenas com o trabalho incorreto com números de ponto flutuante.  Deve-se observar que nem todos os casos encontrados de comparação exata de números de ponto flutuante foram um erro. <br><br>  Como você pode ver, o que não é interessante em alguns projetos é interessante em outros.  Isso torna impossível criar uma lista dos "mais interessantes". <br><br>  Nota  É possível definir o nível de aviso usando as configurações.  Por exemplo, se você acha que o diagnóstico do V550 merece muita atenção, é possível movê-lo do terceiro nível para o primeiro.  Esse tipo de configuração é descrito na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documentação</a> (consulte "Como definir seu nível para diagnósticos específicos"). <br><br><h2>  Conclusão </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/37d/d9e/ecd/37dd9eecd44e33d66c2993ad552e11f7.png"></div><br><br>  Agora você sabe como começar a estudar os avisos do analisador, considerando os mais interessantes.  E não se esqueça de procurar na documentação para se familiarizar com a descrição detalhada dos avisos.  Às vezes acontece que, por trás de uma advertência despreocupada, à primeira vista, o inferno é um inferno.  Um exemplo desses diagnósticos: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V597</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V1026</a> .  Obrigado pela atenção. <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/898/3b6/5a7/8983b65a74adb29a2113eba12fbec3f1.png" align="left"></a> </p><br><br>  Se você deseja compartilhar este artigo com um público que fala inglês, use o link para a tradução: Andrey Karpov.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como verificar rapidamente avisos interessantes fornecidos pelo analisador PVS-Studio para códigos C e C ++?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt457332/">https://habr.com/ru/post/pt457332/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt457316/index.html">Como o jogo de representação de papéis no mundo real é organizado para os hóspedes da Armênia em viagens pela metade do país</a></li>
<li><a href="../pt457324/index.html">Eventos digitais em Moscou de 24 a 30 de junho</a></li>
<li><a href="../pt457326/index.html">Cluster de Failover PostgreSQL + Patroni. Experiência de implementação</a></li>
<li><a href="../pt457328/index.html">Categorias em vez de diretórios ou o sistema de arquivos semântico para Linux</a></li>
<li><a href="../pt457330/index.html">Como verificar rapidamente avisos interessantes fornecidos pelo analisador PVS-Studio para códigos C e C ++?</a></li>
<li><a href="../pt457334/index.html">TacacsGUI, Gerenciador de configuração</a></li>
<li><a href="../pt457336/index.html">As consequências da remoção prematura dos dentes do siso</a></li>
<li><a href="../pt457338/index.html">Blitz com Ilya Krasinsky: como tirar más hipóteses, por que descartar um produto e como crescer para um mínimo de ação?</a></li>
<li><a href="../pt457340/index.html">10 plugins PostCSS que economizarão seu tempo de layout</a></li>
<li><a href="../pt457342/index.html">Sinais do alto: como salvamos os cartógrafos de trabalho desnecessário e olhos vermelhos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>