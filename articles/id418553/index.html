<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧗🏼 👊🏼 🍹 Kotlin + Bereaksi vs Javasript + Bereaksi 👈🏽 👩🏽‍💼 🍼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gagasan untuk mentransfer bagian depan ke kerangka kerja apa pun muncul bersamaan dengan kemampuan untuk menulis Bereaksi di Kotlin. Dan saya memutusk...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kotlin + Bereaksi vs Javasript + Bereaksi</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418553/"> Gagasan untuk mentransfer bagian depan ke kerangka kerja apa pun muncul bersamaan dengan kemampuan untuk menulis Bereaksi di Kotlin.  Dan saya memutuskan untuk mencoba.  Masalah utama: beberapa bahan dan contoh (saya akan mencoba memperbaiki situasi ini).  Tetapi saya memiliki pengetikan penuh, refactoring tanpa rasa takut, semua fitur Kotlin, dan yang paling penting, kode umum untuk backend pada JVM dan bagian depan pada Javascript. <br><br>  Pada artikel ini, kita akan menulis halaman tentang Javasript + Bereaksi secara paralel dengan rekannya di Kotlin + Bereaksi.  Untuk membuat perbandingan itu jujur, saya menambahkan mengetik ke Javasript. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/oh/id/lj/ohidlj29--2tvypgpyosvlthsra.png"></a> <br><a name="habracut"></a><br>  Menambahkan mengetik ke Javascript tidak mudah.  Jika untuk Kotlin saya membutuhkan gradle, npm dan webpack, untuk Javascript saya membutuhkan npm, webpack, flow, dan babel dengan preset bereaksi, mengalir, es2015 dan stage-2.  Pada saat yang sama, aliran di sini entah bagaimana ada di samping, dan Anda perlu menjalankannya secara terpisah dan secara terpisah berteman dengan IDE.  Jika Anda mengurung rakitan dan sejenisnya, maka untuk penulisan kode langsung, di satu sisi, Kotlin + React tetap, dan di sisi lain Javascript + Bereaksi + babel + Aliran + ES5 | ES6 | ES7. <br><br>  Sebagai contoh kami, kami akan membuat halaman dengan daftar mobil dan kemampuan untuk memfilter berdasarkan merek dan warna.  Kami memfilter merek dan warna yang kami seret dari belakang sekali selama boot pertama.  Filter yang dipilih disimpan dalam kueri.  Kami memajang mobil di piring.  Proyek saya bukan tentang mobil, tetapi struktur keseluruhan umumnya mirip dengan apa yang saya kerjakan secara teratur. <br><br>  Hasilnya terlihat seperti ini (saya tidak akan menjadi desainer): <br><br><img src="https://habrastorage.org/webt/gq/_g/zl/gq_gzlqmvngkcana1qcw0ydq9hg.png"><br><br>  Saya tidak akan menjelaskan konfigurasi seluruh mesin syaitan ini di sini, ini adalah topik untuk artikel terpisah (untuk saat ini, Anda dapat merokok sumber dari yang ini). <br><br><h3>  Memuat data dari belakang </h3><br>  Pertama, Anda perlu memuat merek dan warna yang tersedia dari belakang. <br><table><tbody><tr><th>  javascript <br></th><th>  kotlin <br></th></tr><tr><td><pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Home</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContextRouter</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">State</span></span></span><span class="hljs-class">&gt;</span></span>{ state = { <span class="hljs-attr"><span class="hljs-attr">loaded</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-comment"><span class="hljs-comment">//(1) color: queryAsMap( this.props.location.search )["color"], brand: queryAsMap( this.props.location.search )["brand"], brands: [], //(2) colors: [] //(2) }; async componentDidMount() { this.setState({ //(3) brands: await ( //(4) await fetch('/api/brands') ).json(), colors: await ( //(4) await fetch('/api/colors') ).json() }); } } type State = { color?: string, //(5) brand?: string, //(5) loaded: boolean, //(1) brands: Array&lt;string&gt;, //(2) colors: Array&lt;string&gt; //(2) }; export default Home;</span></span></code> </pre> <br></td><td><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Home</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">props</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RouteResultProps</span></span></span><span class="hljs-class">&lt;*&gt; ) : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RComponent</span></span></span><span class="hljs-class"> &lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RouteResultProps</span></span></span><span class="hljs-class">&lt;*&gt;, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">State</span></span></span><span class="hljs-class">&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">props</span></span></span><span class="hljs-class">) { init { state = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">State</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">color</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">queryAsMap</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">props</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">location</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">search</span></span></span><span class="hljs-class"> )["color"], brand = queryAsMap( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">props</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">location</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">search</span></span></span><span class="hljs-class"> )["brand"] ) } override fun componentDidMount() { launch { updateState { //(3) brands = fetchJson( //(4) "/api/brands", </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">StringSerializer</span></span></span><span class="hljs-class">.list ) colors = fetchJson( //(4) "/api/colors", </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">StringSerializer</span></span></span><span class="hljs-class">.list ) } } } } </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">State</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">var</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">color</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class">?, //(5) var brand: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class">? //(5) ) : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RState</span></span></span><span class="hljs-class"> { var loaded: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> = false //(1) lateinit var brands: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">List</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class">&gt; //(2) lateinit var colors: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">List</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class">&gt; //(2) } private val serializer: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">JSON</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">JSON</span></span></span><span class="hljs-class">() suspend fun &lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">T</span></span></span><span class="hljs-class">&gt; fetchJson( //(4) url: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class">, kSerializer: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">KSerializer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">T</span></span></span><span class="hljs-class">&gt; ): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">T</span></span></span><span class="hljs-class"> { val json = window.fetch(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">url</span></span></span><span class="hljs-class">) .await().text().await() return serializer.parse( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">kSerializer</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">json</span></span></span><span class="hljs-class"> ) }</span></span></code> </pre><br></td></tr></tbody></table><br>  Terlihat sangat mirip.  Tetapi ada perbedaan: <br><br><ol><li>  Nilai default dapat ditulis di tempat yang sama dengan tipe yang dideklarasikan.  Ini membuatnya lebih mudah untuk menjaga integritas kode. </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lateinit</a></b> memungkinkan Anda untuk tidak menetapkan nilai default sama sekali untuk apa yang akan dimuat nanti.  Selama kompilasi, variabel seperti itu dianggap sebagai NotNull, tetapi setiap kali diperiksa, itu diisi dan kesalahan yang dapat dibaca manusia dihasilkan.  Ini akan menjadi benar terutama dengan objek yang lebih kompleks daripada array.  Saya tahu hal yang sama dapat dicapai dengan aliran, tetapi sangat rumit sehingga saya tidak mencoba. </li><li>  Kota-bereaksi keluar dari kotak memberikan fungsi setState, tetapi tidak bergabung dengan coroutine karena tidak inline.  Saya harus menyalin dan menaruh inline. </li><li>  Sebenarnya, <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">coroutine</a></b> .  Ini adalah pengganti async / menunggu dan banyak lagi.  Misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">hasil</a> dibuat melalui mereka.  Menariknya, hanya kata menangguhkan ditambahkan ke sintaks, yang lainnya hanya kode.  Karena itu, lebih banyak kebebasan penggunaan.  Dan kontrol sedikit lebih ketat di tingkat kompilasi.  Jadi, Anda tidak bisa menimpa componentDidMount dengan pengubah <code>suspend</code> , yang logis: componentDidMount adalah metode sinkron.  Tetapi Anda dapat menyisipkan <code>launch { }</code> blok asinkron di mana saja dalam kode.  Dimungkinkan untuk secara eksplisit menerima fungsi asinkron dalam parameter atau bidang kelas (tepat di bawah adalah contoh dari proyek saya). </li><li>  Dalam Javascript, sedikit kontrol tidak dapat dibatalkan.  Jadi pada kondisi yang dihasilkan, Anda dapat mengubah nullability merek, warna, dan bidang isian dan semuanya akan dikumpulkan.  Dalam versi Kotlin akan ada kesalahan kompilasi yang dibenarkan. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Trekking paralel dengan corutin</b> <div class="spoiler_text"><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parallel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">vararg</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tasks: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">suspend</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ()</span></span></span></span> -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>) { tasks.map { async { it.invoke() } <span class="hljs-comment"><span class="hljs-comment">//  task,    . async {}  -  promise }.forEach { it.await() } // ,   } override fun componentDidMount() { launch { updateState { parallel({ halls = hallExchanger.all() }, { instructors = instructorExchanger.active() }, { groups = fetchGroups() }) } } }</span></span></code> </pre><br></div></div><br>  Sekarang muat mesin dari belakang menggunakan filter dari kueri <br>  JS: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> loadCars() { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> url = <span class="hljs-string"><span class="hljs-string">`/api/cars?brand=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.state.brand || </span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">""</span></span></span></span><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class="hljs-string">&amp;color=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.state.color || </span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">""</span></span></span></span><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class="hljs-string">`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">cars</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(url)).json(), <span class="hljs-attr"><span class="hljs-attr">loaded</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }); }</code> </pre><br>  Kotlin: <br><br><pre> <code class="hljs kotlin"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadCars</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> url = <span class="hljs-string"><span class="hljs-string">"/api/cars?brand=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${state.brand.orEmpty()}</span></span></span><span class="hljs-string">&amp;color=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${state.color.orEmpty()}</span></span></span><span class="hljs-string">"</span></span> updateState { cars = fetchJson(url, Car::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">serializer</span></span></span></span>().list) <span class="hljs-comment"><span class="hljs-comment">//(*) loaded = true } }</span></span></code> </pre><br>  Saya ingin memperhatikan <code>Car::class.serializer().list</code> .  Faktanya adalah bahwa jetBrains telah menulis perpustakaan untuk serialisasi / deserialisasi yang berfungsi sama pada JVM dan JS.  Pertama, lebih sedikit masalah dan kode jika backend ada di JVM.  Kedua, validitas json yang masuk diperiksa selama deserialisasi, dan tidak kadang-kadang selama panggilan, jadi ketika mengubah versi back-end, dan ketika mengintegrasikan pada prinsipnya, masalah akan lebih cepat. <br><br><h3>  Kami menggambar topi dengan filter </h3><br>  Kami menulis komponen stateless untuk menampilkan dua daftar drop-down.  Dalam kasus Kotlin, itu hanya akan berfungsi, dalam kasus js, itu adalah komponen terpisah yang akan dihasilkan oleh loader reaksi selama perakitan. <br><br><table><tbody><tr><th>  javascript <br></th><th>  kotlin <br></th></tr><tr><td><pre> <code class="javascript hljs">type HomeHeaderProps = { <span class="hljs-attr"><span class="hljs-attr">brands</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>&lt;string&gt;, brand?: string, <span class="hljs-attr"><span class="hljs-attr">onBrandChange</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">string</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, <span class="hljs-attr"><span class="hljs-attr">colors</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>&lt;string&gt;, color?: string, <span class="hljs-attr"><span class="hljs-attr">onColorChange</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">string</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> HomeHeader = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ brands, brand, onBrandChange, colors, color, onColorChange }: HomeHeaderProps</span></span></span><span class="hljs-function">) =&gt;</span></span> ( &lt;div&gt; Brand: &lt;Dropdown value={brand} onChange={e =&gt; onBrandChange(e.value) } options={withDefault("all", brands.map(value =&gt; ({ label: value, value: value })))} /&gt; Color: &lt;Dropdown value={color} onChange={e =&gt; onColorChange(e.value) } options={withDefault("all", colors.map(value =&gt; ({ label: value, value: value })))} /&gt; &lt;/div&gt; ); function withDefault( label, options ) { options.unshift({ label: label, value: null }); return options; }</code> </pre><br></td><td><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> RBuilder.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">homeHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( brands: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;, brand: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">?, onBrandChange: (</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>, colors: List&lt;String&gt;, color: String?, onColorChange: (String?) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> ) { +<span class="hljs-string"><span class="hljs-string">"Brand:"</span></span> dropdown( value = brand, onChange = onBrandChange, options = brands.map { SelectItem( label = it, value = it ) } withDefault <span class="hljs-string"><span class="hljs-string">"all"</span></span> ) {} +<span class="hljs-string"><span class="hljs-string">"Color:"</span></span> dropdown( value = color, onChange = onColorChange, options = colors.map { SelectItem( label = it, value = it ) } withDefault <span class="hljs-string"><span class="hljs-string">"all"</span></span> ) {} } <span class="hljs-keyword"><span class="hljs-keyword">infix</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;T : Any&gt;</span></span></span><span class="hljs-function"> List</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;SelectItem&lt;T&gt;</span></span></span><span class="hljs-function">&gt;.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">withDefault</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( label: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params"> )</span></span></span></span> = listOf( SelectItem( label = label, value = <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) ) + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span></code> </pre><br></td></tr></tbody></table><br>  Hal pertama yang menarik perhatian Anda - HomeHeaderProps di bagian JS, kami dipaksa untuk mendeklarasikan parameter yang masuk secara terpisah.  Nyaman <br><br>  Sintaks Dropdown telah berubah sedikit.  Saya menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">primereact di sini</a> , tentu saja, saya harus menulis bungkus kotlin.  Di satu sisi, ini adalah pekerjaan yang berlebihan (terima kasih Tuhan ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ts2kt</a> ), tetapi di sisi lain, ini adalah kesempatan untuk membuat api lebih nyaman di tempat. <br><br>  Nah, sedikit sintaksis gula dalam pembentukan item untuk dropdown.  <code>})))}</code> dalam versi js terlihat menarik, tetapi itu tidak masalah.  Tetapi meluruskan urutan kata jauh lebih baik: "kami mengubah warna menjadi item dan menambahkan` semua` secara default ", alih-alih" menambahkan `semua` ke warna yang dikonversi ke item".  Sepertinya bonus kecil, tetapi ketika Anda memiliki beberapa kudeta berturut-turut ... <br><br><h3>  Kami menyimpan filter dalam kueri </h3><br>  Sekarang ketika memilih filter berdasarkan merek dan warna, Anda perlu mengubah status, memuat mobil dari belakang dan mengubah url. <br><br><table><tbody><tr><th>  javascript <br></th><th>  kotlin <br></th></tr><tr><td><pre> <code class="javascript hljs">render() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.loaded) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">HomeHeader</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">brands</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.brands}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">brand</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.brand}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onBrandChange</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{brand</span></span></span></span><span class="xml"><span class="hljs-tag"> =&gt;</span></span></span><span class="xml"> this.navigateToChanged({brand})} colors={this.state.colors} color={this.state.color} onColorChange={color =&gt; this.navigateToChanged({color})} /&gt; ); } navigateToChanged({ brand = this.state.brand, color = this.state.color }: Object) { //(*) this.props.history.push( `?brand=${brand || ""}` + `&amp;color=${color || ""}`); this.setState({ brand, color }); this.loadCars() }</span></span></code> </pre><br></td><td><pre> <code class="hljs kotlin"> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> RBuilder.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!state.loaded) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> homeHeader( brands = state.brands, brand = state.brand, onBrandChange = { navigateToChanged(brand = it) }, colors = state.colors, color = state.color, onColorChange = { navigateToChanged(color = it) } ) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">navigateToChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( brand: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">? = state.brand, color: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">? = state.color )</span></span></span></span> { props.history.push( <span class="hljs-string"><span class="hljs-string">"?brand=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${brand.orEmpty()}</span></span></span><span class="hljs-string">"</span></span> + <span class="hljs-string"><span class="hljs-string">"&amp;color=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${color.orEmpty()}</span></span></span><span class="hljs-string">"</span></span>) updateState { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.brand = brand <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.color = color } launch { loadCars() } }</code> </pre><br></td></tr></tbody></table><br>  Dan di sini lagi, masalah dengan nilai default dari parameter.  Untuk beberapa alasan, aliran tidak memungkinkan saya untuk memiliki tipifikasi, destruktor, dan nilai default yang diambil dari keadaan pada saat yang sama.  Mungkin hanya bug.  Tetapi, jika itu terjadi, akan perlu untuk menyatakan tipe di luar kelas, yaitu  umumnya layar lebih tinggi atau lebih rendah. <br><br><h3>  Gambar sebuah meja </h3><br>  Hal terakhir yang perlu kita lakukan adalah menulis komponen stateless untuk membuat tabel dengan mesin. <br><br><table><tbody><tr><th>  javascript <br></th><th>  kotlin <br></th></tr><tr><td><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> HomeContent = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props: { cars: </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">Array</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;Car&gt; }</span></span></span><span class="hljs-function">) =&gt;</span></span> ( &lt;DataTable value={props.cars}&gt; &lt;Column header="Brand" body={rowData =&gt; rowData["brand"] }/&gt; &lt;Column header="Color" body={rowData =&gt; &lt;span style={{ color: rowData['color'] }}&gt; {rowData['color']} &lt;/span&gt; }/&gt; &lt;Column header="Year" body={rowData =&gt; rowData["year"]} /&gt; &lt;/DataTable&gt; );</code> </pre><br></td><td><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> RBuilder.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">homeContent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( cars: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Car</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; )</span></span></span></span> { datatable(cars) { column(header = <span class="hljs-string"><span class="hljs-string">"Brand"</span></span>) { +it.brand } column(header = <span class="hljs-string"><span class="hljs-string">"Color"</span></span>) { span { attrs.style = js { color = it.color } +it.color } } column(header = <span class="hljs-string"><span class="hljs-string">"Year"</span></span>) { +<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${it.year}</span></span></span><span class="hljs-string">"</span></span> } } }</code> </pre><br></td></tr></tbody></table><br>  Di sini Anda dapat melihat bagaimana saya meluruskan primata api dan cara bergaya di kotlin-react.  Ini adalah json biasa, seperti pada versi js.  Dalam proyek saya, saya membuat pembungkus yang terlihat sama, tetapi dengan pengetikan yang kuat, sebanyak mungkin dengan gaya html. <br><br><h2>  Kesimpulan </h2><br>  Terlibat dalam teknologi baru berisiko.  Ada beberapa panduan, tidak ada pada stack overflow, beberapa hal dasar hilang.  Tetapi dalam kasus Kotlin, biaya saya terbayar. <br><br>  Ketika saya sedang mempersiapkan artikel ini, saya belajar banyak hal baru tentang Javascript modern: flow, babel, async / wait, jsx templates.  Saya bertanya-tanya seberapa cepat pengetahuan ini menjadi usang?  Dan semua ini tidak perlu jika Anda menggunakan Kotlin.  Pada saat yang sama, Anda perlu tahu sedikit tentang Bereaksi, karena sebagian besar masalah mudah diselesaikan dengan bantuan bahasa. <br><br>  Dan apa pendapat Anda tentang mengganti semua kebun binatang ini dengan satu bahasa dengan sejumlah besar roti? <br><br>  Bagi mereka yang tertarik, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kode sumber</a> . <br><br>  PS: Berencana untuk menulis artikel tentang konfigurasi, integrasi dengan JVM dan tentang dsl membentuk kedua reaksi-dom dan html biasa. <br><br>  Artikel yang sudah ditulis tentang Kotlin: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">The aftertaste dari Kotlin, bagian 1</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">The aftertaste dari Kotlin, bagian 2</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Aftertaste dari Kotlin, bagian 3. Coroutines - berbagi waktu prosesor</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id418553/">https://habr.com/ru/post/id418553/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id418543/index.html">Five Teams Menangkan Habitat Centennial Challenge 3D-Cetak Bagikan Hadiah $ 100.000</a></li>
<li><a href="../id418545/index.html">Menciptakan "kehidupan buatan" di komputer</a></li>
<li><a href="../id418547/index.html">Pemrograman Asinkron dengan Contoh: Merekonstruksi java.util.concurrent.CompletableFuture Methods</a></li>
<li><a href="../id418549/index.html">Membuat bot untuk berpartisipasi dalam AI mini cup 2018 berdasarkan pada jaringan saraf berulang (bagian 3)</a></li>
<li><a href="../id418551/index.html">Berapa banyak yang harus diketahui seorang programmer matematika?</a></li>
<li><a href="../id418557/index.html">Perhitungan proses gelombang dalam saluran hidrolik menggunakan metode karakteristik</a></li>
<li><a href="../id418559/index.html">NL2API: Membuat Antarmuka Bahasa Alami untuk API Web</a></li>
<li><a href="../id418561/index.html">Mesin negara dalam layanan MVP. Kuliah Yandex</a></li>
<li><a href="../id418563/index.html">Intisari materi menarik untuk pengembang seluler # 263 (23 Juli - 29 Juli)</a></li>
<li><a href="../id418565/index.html">Dalam perjalanan ke cakupan kode 100% dengan tes di Go menggunakan sql-dumper sebagai contoh</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>