<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïâÔ∏è üéµ üî£ Empr√©stimo de carro usado em 1 minuto üñ≤Ô∏è üë®üèª‚Äçüîß üë©üèæ‚Äçü§ù‚Äçüë©üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em vez de introduzir 


 Como todas as hist√≥rias interessantes, esta come√ßou h√° muito tempo e inesperadamente. Uma vez que nosso banco parceiro veio a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Empr√©stimo de carro usado em 1 minuto</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/kolesa/blog/431342/"><p><img src="https://habrastorage.org/webt/sb/mw/tr/sbmwtrme9nvzfag22j8cxpouqzk.jpeg"></p><br><h2 id="vmesto-vvedeniya">  Em vez de introduzir </h2><br><p>  Como todas as hist√≥rias interessantes, esta come√ßou h√° muito tempo e inesperadamente.  Uma vez que nosso banco parceiro veio at√© n√≥s e disse: ‚ÄúPessoal, aprendemos a fazer pontua√ß√µes em nosso sistema em um minuto.  Que tal unir for√ßas e integrar projetos?  Com a gente - uma decis√£o e cr√©dito, com voc√™ - carros.  Dizer que fomos inspirados - n√£o dizer nada!  Tivemos todas as chances de nos tornarmos os primeiros quase no mundo a conceder um empr√©stimo on-line para um carro usado em um minuto (UM MINUTO, CARL)!  Abaixo, vou contar o que aconteceu, mas primeiro vou dizer quem somos, de fato, N√ìS. <a name="habracut"></a></p><br><p><img src="https://habrastorage.org/webt/n7/t5/sl/n7t5sljpvereqprdx0rbocrdm84.jpeg"></p><br><p>  N√≥s somos ‚ÄúRodas |  Telhado  Market ‚Äù√© a maior empresa de TI do Cazaquist√£o.  Todos os dias, nossos produtos ajudam seis milh√µes de cazaquist√£o a comprar e vender carros, apartamentos, ber√ßos e milhares de outras coisas.  O Kolesa.kz √© o maior recurso e aplicativo para autom√≥veis; ocupa o primeiro lugar na classifica√ß√£o m√≥vel do Cazaquist√£o h√° v√°rios anos. </p><br><h2 id="chto-iz-sebya-predstavlyaet-proekt-avtokredit">  O que √© o projeto "Empr√©stimo de carro"? </h2><br><p>  No momento, a base de carros usados ‚Äã‚Äã√© 103.400 carros, mais de 60% deles est√£o dispon√≠veis a cr√©dito! </p><br><div class="spoiler">  <b class="spoiler_title">Como fica nas fotos</b> <div class="spoiler_text"><h3 id="1-vybiraem-mashinu-kotoruyu-hotim-vzyat-v-kredit">  1. Escolha o carro que queremos levar a cr√©dito </h3><br><p><img src="https://habrastorage.org/webt/j6/ft/id/j6ftidhsd9nk8dsrqghfo5jyfes.png"></p><br><p>  <em>Figura 1. Resultados da pesquisa de carros dispon√≠veis a cr√©dito</em> </p><br><h3 id="2-na-stranice-obyavleniya-vidim-formu-dlya-podachi-zayavki-na-kredit">  2. Na p√°gina do an√∫ncio, vemos um formul√°rio para solicitar um empr√©stimo </h3><br><p><img src="https://habrastorage.org/webt/qo/ja/cr/qojacrzpfgmut_8xd7-nlbcr-1s.png">  <em>Figura 2. Tela da p√°gina de an√∫ncio</em> </p><br><h3 id="3-vybiraem-period-i-pervonachalnyy-vznos-i-nazhimaem-poluchit-odobrenie">  3. Selecione o per√≠odo e o adiantamento e clique em para obter aprova√ß√£o </h3><br><p><img src="https://habrastorage.org/webt/yd/ve/ol/ydveol7jxtupaoguc81pyowbsmc.png"><br>  <em>Figura 3. Calculadora de cr√©dito para o an√∫ncio</em> </p><br><h3 id="4-popadaem-na-formu-gde-nam-nuzhno-vvesti-svoi-kontaktnye-dannye">  4. Chegamos ao formul√°rio em que precisamos inserir nossos detalhes de contato </h3><br><p><img src="https://habrastorage.org/webt/sq/sk/zj/sqskzj6wk-zophmc7dibyd1teys.png"><br>  <em>Figura 4. Formul√°rio de inicializa√ß√£o de um pedido de empr√©stimo</em> </p><br><p>  Aqui, inserimos o n√∫mero do seu celular Nome e IIN (na R√∫ssia, seria um TIN) </p><br><h3 id="5-dalee-vam-neobhodimo-vvesti-kod-sms-kotoryy-pridyot-na-ukazannyy-vami-nomer">  5. Em seguida, voc√™ precisa digitar o c√≥digo SMS que chegar√° ao seu n√∫mero </h3><br><p><img src="https://habrastorage.org/webt/od/ey/kc/odeykcr1vtkveylifnf6oza8xxm.png"><br>  <em>Figura 5. Formul√°rio de confirma√ß√£o do n√∫mero de telefone digitando SMS</em> </p><br><h3 id="6-posle-etogo-nachinaetsya-sam-process-skoringa-kotoryy-dlitsya-ne-bolee-1-minuty">  6. Depois disso, o pr√≥prio processo de pontua√ß√£o come√ßa, que n√£o dura mais que 1 minuto </h3><br><p><img src="https://habrastorage.org/webt/9s/po/6s/9spo6soaw7vjupijhkpfnehkdyq.png">  <em>Figura 6. Tela para processo de pontua√ß√£o do aplicativo</em> </p><br><h3 id="7-est-neskolko-variantov-rezultata-skoringa">  7. Existem v√°rias op√ß√µes para pontua√ß√£o de resultados: </h3><br><ol><li>  Voc√™ aprova um empr√©stimo </li><li>  Voc√™ foi negado um empr√©stimo </li><li>  Voc√™ tem condi√ß√µes alternativas </li><li>  Voc√™ √© solicitado a obter informa√ß√µes adicionais, ap√≥s o que recebe uma das op√ß√µes anteriores (a, b, c) </li></ol><br><p><img src="https://habrastorage.org/webt/7s/ba/d_/7sbad_bmbosrd4kcgdt4wa65884.png"><br>  <em>Figura 7. Exemplo de uma tela de aprova√ß√£o de empr√©stimo autom√°tico</em> </p><br><p>  Depois que uma pessoa recebe a aprova√ß√£o de seu pedido, o gerente do banco o chama de volta em 10 minutos e informa a pessoa sobre quais a√ß√µes ele precisa executar a seguir para obter um empr√©stimo.  Conveniente, n√£o √©?  Vamos ver como tudo foi implementado. </p></div></div><br><h2 id="ty-pomnish-kak-vsyo-nachinalos">  Voc√™ se lembra como tudo come√ßou ... </h2><br><p>  Tudo foi pela primeira vez e novamente!  Se antes t√≠nhamos um formul√°rio de feedback como cr√©dito, nossa nova ideia era algo completamente novo e incompreens√≠vel.  Porque  N√£o t√≠nhamos an√°logos, t√≠nhamos uma tarefa muito empolgante pela frente - planejar, projetar, distribuir e implementar.  Para come√ßar, dividimos todo o processo de nossa integra√ß√£o conjunta em 2 blocos, que foram realizados em paralelo, a saber: </p><br><ul><li>  Integra√ß√£o de infraestrutura </li><li><p>  Integra√ß√£o de software </p><br><p>  Inicialmente, concordamos com o banco parceiro que ele (o banco parceiro) nos fornecer√° algum tipo de API, para o qual enviaremos alguns dados e receberemos algumas respostas.  Eles decidiram isso.  Come√ßamos a aguardar a documenta√ß√£o da API do banco, reunindo nossos engenheiros e os de suas redes!  Em termos de integra√ß√£o de software, surgiu um esquema bastante simples: enviamos dados ao banco, o banco os rola em seu sistema e os devolve para n√≥s, e tudo isso por 60 segundos garantidos.  No caso de um tempo limite (onde poderia ser sem isso), concordamos em exibir um question√°rio de emerg√™ncia, no qual obtemos dados que o banco pode precisar adicionalmente. </p><br></li></ul><br><h3 id="seti">  Redes </h3><br><p>  Naquela √©poca, enquanto os desenvolvedores estavam escolhendo ferramentas para implementa√ß√£o, estavam projetando seu sistema e aguardando a documenta√ß√£o no sistema parceiro, o trabalho no departamento de infraestrutura j√° estava em pleno andamento!  T√≠nhamos um banco parceiro para dois: 2 tsiska pr√≥ximos um do outro em um DC, um cabo que conecta tsiska, t√∫nel VPN, certificados de seguran√ßa e pr√©-estudo para trabalhar com eles de todas as cores e tamanhos ... O plano era o seguinte: Estamos encaminhando o canal VPN criptografado entre nossos servidores e criar integra√ß√£o direta entre nossos servi√ßos.  Esquematicamente, isso pode ser representado da seguinte maneira: </p><br><p><img src="https://habrastorage.org/webt/hl/oy/wn/hloywn-uxue8ceolpvmdodhla5w.png"></p><br><h3 id="pogovorim-pro-kod">  Vamos falar sobre o c√≥digo </h3><br><p>  Abaixo, falaremos sobre como e o que √© organizado pelo nosso servi√ßo.  Portanto, depois de receber um documento descrevendo o servi√ßo do parceiro pronto para integra√ß√£o, aprendemos que, diferentemente de n√≥s, o banco trabalha apenas com solicita√ß√µes SOAP e n√£o deseja ouvir sobre nenhum servi√ßo RESTful.  E como em nossos servi√ßos usamos o SOAP um pouco menos do que nunca, tivemos muitas descobertas maravilhosas sobre como aprender a preparar o SOAP em nosso novo produto.  Portanto, precisamos ensinar nosso servi√ßo a analisar solicita√ß√µes SOAP e converter nossas respostas novamente em SOAP. </p><br><h4 id="vybora-freymvorka">  Sele√ß√£o de framework </h4><br><p>  Para iniciantes, voc√™ tinha que escolher pelo menos uma linguagem de implementa√ß√£o, havia muitas id√©ias, come√ßando com C e C # terminando com golang e erlang.  Decidimos seguir um caminho simples.  O sistema precisar√° ser suportado e, para n√£o encontrar o fator de barramento com a falta de especialistas no mercado, decidimos nos concentrar na tecnologia mais comum em nossa empresa - PHP.  Gra√ßas a Deus que fora da janela j√° n√£o era 2001, mas 2017 e existem tantos frameworks php que podem satisfazer as necessidades de engenheiros muito sofisticados.  Depois de passar por um monte, escolhemos um dos mais simples e ao mesmo tempo compat√≠veis - Yii 2. </p><br><p>  <strong>Para esta decis√£o foi:</strong> </p><br><ul><li>  F√°cil de dominar, um monte de literatura; </li><li>  √â f√°cil o suficiente criar formul√°rios e validadores; </li><li>  H√° um registro ativo e um carro pronto para trabalhar com todos os tipos de ferramentas; </li><li>  Ele √© realmente r√°pido; </li><li>  Com base nisso, uma API √© simplesmente criada, √© conveniente escrever comandos do console. </li></ul><br><p>  <strong>Contra foi:</strong> </p><br><ul><li>  A estrutura √© baseada em m√©todos est√°ticos - isso √© muito inconveniente, inclusive ao escrever testes </li><li>  N√£o ficou claro quais ferramentas adicionais precisar√≠amos no futuro pr√≥ximo ap√≥s o lan√ßamento e, como resultado, havia o risco de n√£o encontrar as bibliotecas necess√°rias ... </li></ul><br><h4 id="vybor-hranilisch">  Sele√ß√£o de armazenamento </h4><br><p>  A estrutura foi escolhida, agora √© hora de escolher um reposit√≥rio para aplicativos.  Havia v√°rias op√ß√µes, MySQL, mongoDB, postgreSQL ... Por um lado, um aplicativo √© um documento, com certeza sua estrutura pode mudar, de tempos em tempos, complementada por novos campos e se livrando de campos irrelevantes.  Por outro lado, o uso de bancos de dados n√£o relacionais impor√° suas limita√ß√µes.  Depois de ponderar todos os pr√≥s e contras, decidimos sentar em duas cadeiras e usar o MySQL para iniciar e, ap√≥s o lan√ßamento, migrar para um monte de mongoDB + ElasticSearch.  Como resultado, duas r√©plicas do MySQL foram geradas como armazenamento e parafusadas no aplicativo usando o ActiveRecord.  No momento em que iniciamos a transi√ß√£o para o mongoDB, a quantidade de dados cresceu muito e teve uma taxa de crescimento t√£o grande que havia outra necessidade de dividir aplicativos em reposit√≥rios condicionais.  Como uma ferramenta para indexa√ß√£o de documentos quase em tempo real, o ElasticSearch decidiu usar um servi√ßo escrito em Golang - monstache. </p><br><h4 id="stroim-infrastrukturu">  Infra-estrutura predial </h4><br><p>  Decidimos fazer a seguinte infraestrutura: 10 back-end com o aplicativo pelo processador de aplicativos, 2 balanceadores, 2 r√©plicas do MySQL, 3 shards de pesquisa el√°stica, 3 r√©plicas de mongoDB e 2 r√©plicas de servi√ßo monstache. <img src="https://habrastorage.org/webt/n4/c4/gz/n4c4gzsszplllqrpbxxgd4uhnkw.png"></p><br><h2 id="process">  O processo </h2><br><p>  Em geral, o processo de empr√©stimo de carro pode ser dividido em 2 partes: </p><br><ol><li>  Para come√ßar, voc√™ precisa encontrar um carro adequado, dispon√≠vel a cr√©dito.  Muito provavelmente voc√™ ser√° guiado pela condi√ß√£o dela e pelos termos do empr√©stimo. </li><li>  Depois de selecionar um carro, voc√™ precisa obter uma aprova√ß√£o de empr√©stimo, para isso, precisar√° preencher um requerimento </li></ol><br><p>  Sobre a implementa√ß√£o da segunda parte, mais ou menos descritos acima, vamos falar sobre a implementa√ß√£o da primeira parte.  A implementa√ß√£o da primeira parte consiste em v√°rias sub-partes: </p><br><ol><li>  Ao procurar um carro, uma pessoa deve ser capaz de se concentrar, al√©m dos par√¢metros t√©cnicos, na disponibilidade de um carro para compra a cr√©dito e no valor m√≠nimo de um pagamento mensal.  Para fazer isso, precisamos saber no momento do an√∫ncio que o carro est√° dispon√≠vel a cr√©dito e qual ser√° o pagamento m√≠nimo. </li><li>  Depois que uma pessoa escolhe um carro, precisamos fornecer uma calculadora de empr√©stimo, onde ele pode escolher o tamanho do adiantamento e o prazo do empr√©stimo, escolhendo assim o valor do pagamento mensal mais confort√°vel. </li></ol><br><p>  Para esse fim, um microsservi√ßo especial na linguagem go foi desenvolvido.  Sua ess√™ncia era a seguinte: quando um an√∫ncio √© enviado ao microsservi√ßo, um objeto com todos os dados sobre o carro √© enviado, o microsservi√ßo, com base nas regras escritas separadamente para ele, retorna o pagamento mensal m√≠nimo para indexa√ß√£o na pesquisa e tamb√©m retorna o pagamento m√≠nimo inicial e os prazos aceit√°veis empr√©stimos, que s√£o a base para a constru√ß√£o de uma calculadora de empr√©stimos. </p><br><p><img src="https://habrastorage.org/webt/v3/3s/oj/v33sojevpnsmwuqh8il4vhciili.png"></p><br><p>  Armazenamos em cache antecipadamente as op√ß√µes de erro de c√°lculo para os valores padr√£o de adiantamento e pagamento mensal.  Isso √© feito para cada um dos per√≠odos de cr√©dito dispon√≠veis.  Se uma pessoa alterar o pagamento inicial (dentro do intervalo aceit√°vel), o microsservi√ßo calcular√° novamente todos os dados.  Se o pagamento inicial for especificado abaixo do permitido, a calculadora exibir√° um erro de valida√ß√£o. </p><br><p><img src="https://habrastorage.org/webt/o0/0o/vv/o00ovv3safkjazq87fpkhqvvp2o.png"></p><br><p>  Devido √† alta carga em nosso servi√ßo, a calculadora de empr√©stimos possui 2 graus de armazenamento em cache: o primeiro ocorre no back-end, onde os clientes buscam inicialmente a calculadora, o segundo no pr√≥prio microsservi√ßo. </p><br><h2 id="tak-chto-v-itoge">  Ent√£o, qual √© o resultado final? </h2><br><p>  Lan√ßamos o projeto em 11 de setembro de 2017.  Desde esse momento, at√© a data (4 de dezembro de 2018), 2.973.868 pedidos foram arquivados.  Estamos em um processo cont√≠nuo de melhoria de nosso servi√ßo e simplifica√ß√£o da jornada do usu√°rio.  Tornamos mais r√°pido, mais f√°cil e mais est√°vel!  O tempo de atividade do projeto durante todo o per√≠odo desde o lan√ßamento foi de 99,99%. </p><br><p>  Como resultado, temos os seguintes resultados: </p><br><ol><li>  Caminho do usu√°rio significativamente reduzido </li><li>  Expandimos o volume de carros dispon√≠veis para empr√©stimos para 60% de toda a base </li><li>  At√© o momento, o n√∫mero de aplicativos cresceu mais de 7 vezes! </li></ol><br><h2 id="vmesto-zaklyucheniya">  Em vez de uma conclus√£o </h2><br><p>  Em 3 meses, conseguimos construir um projeto verdadeiramente incr√≠vel e √∫nico.  Seu principal objetivo era dar a nossos clientes a oportunidade de comprar carros usados ‚Äã‚Äãsem sair de nossa plataforma.  Em apenas 1 minuto, o usu√°rio pode tomar uma decis√£o sobre sua inscri√ß√£o, ligar para o vendedor e elaborar todos os documentos necess√°rios no mesmo dia. <br>  A julgar pelo n√∫mero de solicita√ß√µes para o ano e 2 meses, podemos concluir que somos capazes de tornar o servi√ßo realmente conveniente e demandado. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt431342/">https://habr.com/ru/post/pt431342/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt431330/index.html">Fim de semana m√≥vel: Mobius transmiss√£o gratuita</a></li>
<li><a href="../pt431332/index.html">Vis√£o geral dos relat√≥rios DotNext 2018 mais interessantes: vers√£o EastBanc Technologies</a></li>
<li><a href="../pt431334/index.html">Huawei: prote√ß√£o do avi√£o de controle</a></li>
<li><a href="../pt431338/index.html">O livro "DNA. A hist√≥ria da revolu√ß√£o gen√©tica ‚Äù</a></li>
<li><a href="../pt431340/index.html">Sua escolha de 11 pol√≠gonos, nada a ver com o presente</a></li>
<li><a href="../pt431344/index.html">Ac√∫stica integrada: o que √© e como funciona</a></li>
<li><a href="../pt431346/index.html">Desenvolvendo um aplicativo capaz de a√ß√£o para o Slack</a></li>
<li><a href="../pt431348/index.html">Anycubic Photon: uma mini vis√£o geral de uma impressora 3D de fotopol√≠mero de baixo custo</a></li>
<li><a href="../pt431350/index.html">Planos de desenvolvimento de processadores eletr√¥nicos da Baikal</a></li>
<li><a href="../pt431354/index.html">O primeiro codec de v√≠deo de aprendizado de m√°quina superou drasticamente todos os codecs existentes, incluindo H.265 e VP9</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>