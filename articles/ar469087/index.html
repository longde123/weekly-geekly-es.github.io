<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐๏ธ ๐ MVCC ูู PostgreSQL-2. ุดูู ุ ูููุงุช ุ ุตูุญุงุช ๐ฉ๐ผโ๐ซ ๐ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุขุฎุฑ ูุฑุฉ ุชุญุฏุซูุง ูููุง ุนู ุชูุงุณู ุงูุจูุงูุงุช ุ ุฏุฑุณูุง ุงููุฑู ุจูู ูุณุชููุงุช ุงูุนุฒูุฉ ูู ุงููุนุงููุฉ ูู ูุฌูุฉ ูุธุฑ ุงููุณุชุฎุฏู ูุชูุตููุง ุฅูู ูุนุฑูุฉ ุฃูููุฉ ูุฐุง ุงูุฃูุฑ. ุจุฏุฃูุง ุงู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MVCC ูู PostgreSQL-2. ุดูู ุ ูููุงุช ุ ุตูุญุงุช</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/469087/" style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ุขุฎุฑ ูุฑุฉ</a> ุชุญุฏุซูุง ูููุง ุนู ุชูุงุณู ุงูุจูุงูุงุช ุ ุฏุฑุณูุง ุงููุฑู ุจูู ูุณุชููุงุช ุงูุนุฒูุฉ ูู ุงููุนุงููุฉ ูู ูุฌูุฉ ูุธุฑ ุงููุณุชุฎุฏู ูุชูุตููุง ุฅูู ูุนุฑูุฉ ุฃูููุฉ ูุฐุง ุงูุฃูุฑ.  ุจุฏุฃูุง ุงูุขู ูู ุงุณุชูุดุงู ููููุฉ ุชูููุฐ PostgreSQL ูุนุฒู ุงูููุทุฉ ูุชุฒุงูู ุงูุชุญูููุงุช ุงููุชุนุฏุฏุฉ. <br><br>  ูู ูุฐู ุงูููุงูุฉ ุ ุณููุธุฑ ูู ููููุฉ ูุถุน ุงูุจูุงูุงุช ูุนูููุง ูู ุงููููุงุช ูุงูุตูุญุงุช.  ูุฐุง ูุจุนุฏูุง ุนู ููุงูุดุฉ ุงูุนุฒูุฉ ุ ููู ูุซู ูุฐุง ุงูุงุณุชุทุฑุงุฏ ุถุฑูุฑู ูููู ูุง ููู.  ุณูุญุชุงุฌ ุฅูู ูุนุฑูุฉ ููููุฉ ุชูุธูู ุชุฎุฒูู ุงูุจูุงูุงุช ุนูู ูุณุชูู ููุฎูุถ. <br><br><h1 style=";text-align:right;direction:rtl">  ุงูุนูุงูุงุช </h1><br>  ุฅุฐุง ูุธุฑุช ุฏุงุฎู ุงูุฌุฏุงูู ูุงูููุงุฑุณ ุ ุงุชุถุญ ุฃููุง ููุธูุฉ ุจุทุฑููุฉ ููุงุซูุฉ.  ููุงููุง ูุงุฆูุงุช ูุงุนุฏุฉ ุจูุงูุงุช ุชุญุชูู ุนูู ุจุนุถ ุงูุจูุงูุงุช ุงูุชู ุชุชููู ูู ุงูุตููู. <br><br>  ููุณ ููุงู ุดู ูู ุฃู ุงูุฌุฏูู ูุชููู ูู ุตููู ุ ููู ูุฐุง ุฃูู ูุถูุญูุง ุจุงููุณุจุฉ ุฅูู ุงูููุฑุณ.  ููุน ุฐูู ุ ุชุฎูู ุดุฌุฑุฉ B: ุชุชููู ูู ุงูุนูุฏ ุงูุชู ุชุญุชูู ุนูู ููู ูููุฑุณุฉ ููุฑุงุฌุน ุฅูู ุงูุนูุฏ ุงูุฃุฎุฑู ุฃู ุตููู ุงูุฌุฏูู.  ูุฐู ุงูุนูุฏ ูููู ุงุนุชุจุงุฑูุง ุตููู ููุฑุณ ุ ููู ุงููุงูุน ุ ููู ูุฐูู. <br><br>  ูู ุงููุงูุน ุ ูุชู ุชูุธูู ุนุฏุฏ ูููู ูู ุงููุงุฆูุงุช ุจุทุฑููุฉ ููุงุซูุฉ: ุงูุชุณูุณูุงุช (ุฌุฏุงูู ุฃุณุงุณูุง ุตู ูุงุญุฏ ุจุดูู ุฃุณุงุณู) ูุทุฑู ุงูุนุฑุถ ุงูููููุณุฉ (ุจุดูู ุฃุณุงุณู ุ ุงูุฌุฏุงูู ุงูุชู ุชุชุฐูุฑ ุงูุงุณุชุนูุงู).  ูููุงู ุฃูุถูุง ุทุฑู ุนุฑุถ ููุชุธูุฉ ุ ูุง ุชุฎุฒู ุงูุจูุงูุงุช ุจููุณูุง ุ ูููููุง ุชุดุจู ูู ุฌููุน ุงูุญุงูุงุช ุงูุฃุฎุฑู ุงูุฌุฏุงูู. <br><br>  ุชุณูู ูู ูุฐู ุงููุงุฆูุงุช ูู PostgreSQL <em>ุนูุงูุฉ</em> ุงููููุงุช ุงูุดุงุฆุนุฉ.  ูุฐู ุงููููุฉ ุบูุฑ ูุงุฆูุฉ ููุบุงูุฉ ูุฃููุง ูุตุทูุญ ูู ูุธุฑูุฉ ุงูุนูุงุฆููุฉ.  ููููู ุฑุณู ูุชูุงุฒู ุจูู ุงูุนูุงูุฉ ูุงูุฌุฏูู (ุงูุนุฑุถ) ุ ูููู ุจุงูุชุฃููุฏ ููุณ ุจูู ุงูุนูุงูุฉ ูุงูููุฑุณ.  ูููู ุญุฏุซ ุฐูู ุชูุงููุง: ูุชุฌูู ุงูุฃุตู ุงูุฃูุงุฏููู ูู PostgreSQL ูู ููุณู.  ูุจุฏู ูู ุฃู ุงูุฌุฏุงูู ูุทุฑู ุงูุนุฑุถ ูุงูุช ุชุณูู ุฃููุงู ุ ูุงูุจุงูู ุชุถุฎู ูุน ูุฑูุฑ ุงูููุช. <br><a name="habracut"></a><br>  ููููู ุฃูุซุฑ ุจุณุงุทุฉ ุ ุณููุงูุด ุงูุฌุฏุงูู ูุงูููุงุฑุณ ุ ููู <em>ุงูุนูุงูุงุช</em> ุงูุฃุฎุฑู ูุฑุชุจุฉ ุจููุณ ุงูุทุฑููุฉ ุชูุงููุง. <br><br><h1 style=";text-align:right;direction:rtl">  ุงูุดูู ูุงููููุงุช </h1><br>  ุนุงุฏุฉ ูุง ุชุชูุงูู ุนุฏุฉ <em>ุดููุงุช</em> ูุน ูู ุนูุงูุฉ.  ูููู ุฃู ุชุญุชูู ุงูุดููุงุช ุนูู ุนุฏุฉ ุฃููุงุน ุ ููุญุชูู ูู ูููุง ุนูู ููุน ูุนูู ูู ุงูุจูุงูุงุช. <br><br>  ุฅุฐุง ูุงู ููุงู ุดููุฉ ุ ูุชู ุชูุซูููุง ุฃููุงู <em>ุจุงูููู</em> ุงููุญูุฏ.  ุงุณู ุงูููู ูู ูุนุฑู ุฑููู ุ ูุงูุฐู ูููู ุฅูุญุงูู ุจููุงูุฉ ุชุชูุงูู ูุน ุงุณู ุงูุดููุฉ. <br><br>  ูุฒุฏุงุฏ ุญุฌู ุงูููู ุชุฏุฑูุฌูุงู ูุนูุฏูุง ูุตู ุญุฌูู ุฅูู 1 ุบูุบุงุจุงูุช ุ ูุชู ุฅูุดุงุก ููู ุฌุฏูุฏ ูู ููุณ ุงูุดููุฉ (ุชุณูู ูุฐู ุงููููุงุช ุฃุญูุงููุง <em>ุดุฑุงุฆุญ</em> ).  ูุชู ุฅูุญุงู ุงูุฑูู ุงูุชุฑุชูุจู ููุฌุฒุก ูู ููุงูุฉ ุงุณู ุงูููู. <br><br>  ูุดุฃ ูููุฏ ุญุฌู ุงูููู ุงูุชู ุชุจูุบ 1 ุบูุบุงุจุงูุช ุชุงุฑูุฎูุง ูุฏุนู ุฃูุธูุฉ ุงููููุงุช ุงููุฎุชููุฉ ุ ูุงูุชู ูุง ูุณุชุทูุน ุจุนุถูุง ุงูุชุนุงูู ูุน ุงููููุงุช ุฐุงุช ุงูุญุฌู ุงูุฃูุจุฑ.  ููููู ุชุบููุฑ ูุฐุง ุงูููุฏ ุนูุฏ ุฅูุดุงุก PostgreSQL ( <code>./configure --with-segsize</code> ). <br><br>  ูุฐูู ุ ูููู ุฃู ุชุชูุงูู ุนุฏุฉ ูููุงุช ุนูู ุงููุฑุต ูุน ุนูุงูุฉ ูุงุญุฏุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ูุทุงููุฉ ุตุบูุฑุฉ ุณูููู ููุงู ุซูุงุซุฉ ูููู. <br><br>  ุณูุชู ุชุฎุฒูู ุฌููุน ูููุงุช ุงููุงุฆูุงุช ุงูุชู ุชูุชูู ุฅูู ูุณุงุญุฉ ุฌุฏูู ูุงุญุฏุฉ ููุงุนุฏุฉ ุจูุงูุงุช ูุงุญุฏุฉ ูู ุฏููู ูุงุญุฏ.  ุชุญุชุงุฌ ุฅูู ูุถุน ุฐูู ูู ุงูุงุนุชุจุงุฑ ูุฃู ุฃูุธูุฉ ุงููููุงุช ุนุงุฏุฉ ูุง ุชูุดู ูู ุงูุนูู ุจุดูู ุฌูุฏ ูุน ุนุฏุฏ ูุจูุฑ ูู ุงููููุงุช ูู ุงูุฏููู. <br><br>  ูุงุญุธ ููุง ุฃู ุงููููุงุช ุ ุจุฏูุฑูุง ุ ุชููุณู ุฅูู <em>ุตูุญุงุช</em> (ุฃู <em>ูุชู</em> ) ุ ุนุงุฏุฉู ุจููุฏุงุฑ 8 ููููุจุงูุช.  ุณููุงูุด ุงูุจููุฉ ุงูุฏุงุฎููุฉ ููุตูุญุงุช ุฃูุซุฑ ููููุงู. <br><br><img src="https://habrastorage.org/webt/10/ze/w6/10zew6_pruaxe8amjtx7_6x70tk.png"><br><br>  ุงูุขู ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุฃููุงุน ุงูุดููุฉ. <br><br>  <strong>ุงูุดููุฉ ุงูุฑุฆูุณูุฉ</strong> ูู ุงูุจูุงูุงุช ุจุญุฏ ุฐุงุชูุง: ุตููู ุงูุฌุฏูู ูุงูููุฑุณ ุฐุงุชูุง.  ุงูุดููุฉ ุงูุฑุฆูุณูุฉ ูุชุงุญุฉ ูุฃู ุนูุงูุงุช (ุจุงุณุชุซูุงุก ุทุฑู ุงูุนุฑุถ ุงูุชู ูุง ุชุญุชูู ุนูู ุจูุงูุงุช). <br><br>  ุชุชููู ุฃุณูุงุก ูููุงุช ุงูุดููุฉ ุงูุฑุฆูุณูุฉ ูู ุงููุนุฑู ุงูุฑููู ุงููุญูุฏ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฐุง ูู ุงููุณุงุฑ ุฅูู ุงูุฌุฏูู ุงูุฐู ุฃูุดุฃูุงู ุขุฎุฑ ูุฑุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_relation_filepath(<span class="hljs-string"><span class="hljs-string">'accounts'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> pg_relation_filepath ---------------------- base/41493/41496 (1 row)</code> </pre><br>  ูู ุฃูู ุชูุดุฃ ูุฐู ุงููุนุฑูุงุชุ  ูุชูุงูู ุฏููู "ุงูุฃุณุงุณ" ูุน ูุณุงุญุฉ ุงูุฌุฏุงูู "pg_default".  ุงูุฏููู ุงููุฑุนู ุงูุชุงูู ุ ุงููุชูุงูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูู ูููุน ููู ุงูุงูุชูุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-type"><span class="hljs-type">oid</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_database <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> datname = <span class="hljs-string"><span class="hljs-string">'test'</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> oid ------- 41493 (1 row)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> relfilenode <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_class <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> relname = <span class="hljs-string"><span class="hljs-string">'accounts'</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> relfilenode ------------- 41496 (1 row)</code> </pre><br>  ุงููุณุงุฑ ูุณุจู ุ ูุชู ุชุญุฏูุฏู ุจุฏุกูุง ูู ุฏููู ุงูุจูุงูุงุช (PGDATA).  ุนูุงูุฉ ุนูู ุฐูู ุ ูุชู ุชุญุฏูุฏ ุฌููุน ุงููุณุงุฑุงุช ูู PostgreSQL ุชูุฑูุจูุง ุจุฏุกูุง ูู PGDATA.  ุจูุถู ูุฐุง ุ ููููู ููู PGDATA ุจุฃูุงู ุฅูู ูููุน ูุฎุชูู - ูุง ุดูุก ูุญุตุฑู (ุจุงุณุชุซูุงุก ุฃูู ูุฏ ูููู ูุทููุจูุง ุชุนููู ุงููุณุงุฑ ุฅูู ุงูููุชุจุงุช ูู LD_LIBRARY_PATH). <br><br>  ุนูุงูุฉ ุนูู ุฐูู ุ ุงููุธุฑ ูู ูุธุงู ุงููููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">postgres$ ls -l --time-style=+ /var/lib/postgresql/11/main/base/41493/41496</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-rw------- 1 postgres postgres 8192 /var/lib/postgresql/11/main/base/41493/41496</code> </pre><br>  ูุชููุฑ <strong>ุชูุฑุน ุงูุชููุฆุฉ</strong> ููุท ููุฌุฏุงูู ุบูุฑ ุงููููุฏุฉ (ุงูุชู ุชู ุฅูุดุงุคูุง ุจุงุณุชุฎุฏุงู UNLOGGED ุงููุญุฏุฏุฉ) ูููุงุฑุณูุง.  ูุงุฆูุงุช ูุซู ูุฐู ูุง ุชุฎุชูู ุจุฃู ุญุงู ุนู ุงููุงุฆูุงุช ุงูุนุงุฏูุฉ ุจุงุณุชุซูุงุก ุฃู ุงูุนูููุงุช ูุนูู ูู ูุชู ุชุณุฌูููุง ูู ุณุฌู ุงููุชุงุจุฉ ุงููุณุจู (WAL).  ููุฐุง ุงูุณุจุจ ุ ูููู ุงูุชุนุงูู ูุนูู ุฃุณุฑุน ุ ููู ูู ุงููุณุชุญูู ุงุณุชุฑุฏุงุฏ ุงูุจูุงูุงุช ูู ุงูุญุงูุฉ ุงูุซุงุจุชุฉ ูู ุญุงูุฉ ุญุฏูุซ ุนุทู.  ูุฐูู ุ ุฃุซูุงุก ุงูุงุณุชุฑุฏุงุฏ ุ ูููู PostgreSQL ููุท ุจุฅุฒุงูุฉ ูุงูุฉ ุดููุงุช ูุฐู ุงููุงุฆูุงุช ูููุชุจ ุดููุฉ ุงูุชููุฆุฉ ุจุฏูุงู ูู ุงูุดููุฉ ุงูุฑุฆูุณูุฉ.  ูุฐุง ููุชุฌ ูุงุฆู ูุงุฑุบ.  ุณููุงูุด ูุทุน ุงูุฃุดุฌุงุฑ ุจุงูุชูุตูู ุ ูููู ูู ุณูุณูุฉ ุฃุฎุฑู. <br><br>  ูุชู ุชุณุฌูู ุฌุฏูู "ุงูุญุณุงุจุงุช" ุ ูุจุงูุชุงูู ุ ูุง ูุญุชูู ุนูู ุชูุฑุน ุชููุฆุฉ.  ูููู ููุชุฌุฑุจุฉ ุ ูููููุง ุฅููุงู ุชุณุฌูู ุงูุฏุฎูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNLOGGED</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_relation_filepath(<span class="hljs-string"><span class="hljs-string">'accounts'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> pg_relation_filepath ---------------------- base/41493/41507 (1 row)</code> </pre><br>  ููุถุญ ุงููุซุงู ุฃู ุฅููุงููุฉ ุชุดุบูู ุชุณุฌูู ุงูุฏุฎูู ูุฅููุงู ุชุดุบููู ุฃุซูุงุก ุงูุทูุฑุงู ูุฑุชุจุทุฉ ุจุฅุนุงุฏุฉ ูุชุงุจุฉ ุงูุจูุงูุงุช ุฅูู ูููุงุช ุจุฃุณูุงุก ูุฎุชููุฉ. <br><br>  ุดููุฉ ุงูุชููุฆุฉ ููุง ููุณ ุงุณู ุงูุดููุฉ ุงูุฑุฆูุณูุฉ ุ ูููู ุจุงุณุชุฎุฏุงู ูุงุญูุฉ "_init": <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">postgres$ ls -l --time-style=+ /var/lib/postgresql/11/main/base/41493/41507_init</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-rw------- 1 postgres postgres 0 /var/lib/postgresql/11/main/base/41493/41507_init</code> </pre><br>  <strong>ุฎุฑูุทุฉ ุงููุณุงุญุฉ ุงูุญุฑุฉ</strong> ุนุจุงุฑุฉ ุนู ุดููุฉ ุชููู ุจุชุชุจุน ูุฏู ุชููุฑ ูุณุงุญุฉ ุฎุงููุฉ ุฏุงุฎู ุงูุตูุญุงุช.  ุชุชุบูุฑ ูุฐู ุงููุณุงุญุฉ ุจุงุณุชูุฑุงุฑ: ุฅููุง ุชุชูุงูุต ุนูุฏูุง ูุชู ุฅุถุงูุฉ ุฅุตุฏุงุฑุงุช ุฌุฏูุฏุฉ ูู ุงูุตููู ูุชุฒูุฏ ุฃุซูุงุก ุงููุฑุงุบ.  ูุชู ุงุณุชุฎุฏุงู ุฎุฑูุทุฉ ุงููุณุงุญุฉ ุงูุญุฑุฉ ุฃุซูุงุก ุฅุฏุฑุงุฌ ุฅุตุฏุงุฑุงุช ุตู ุฌุฏูุฏุฉ ููุนุซูุฑ ุจุณุฑุนุฉ ุนูู ุตูุญุฉ ููุงุณุจุฉ ุ ุญูุซ ุชุชูุงุณุจ ุงูุจูุงูุงุช ุงููุฑุงุฏ ุฅุถุงูุชูุง. <br><br>  ูุญุชูู ุงุณู ุฎุฑูุทุฉ ุงููุณุงุญุฉ ุงูุญุฑุฉ ุนูู ูุงุญูุฉ "_fsm".  ููู ูุฐุง ุงูููู ูุง ูุธูุฑ ุนูู ุงูููุฑ ุ ูููู ููุท ุนูุฏ ุงูุญุงุฌุฉ.  ุฃุณูู ุทุฑููุฉ ูุชุญููู ุฐูู ูู ุชูุฑูุบ ุทุงููุฉ (ุณูุดุฑุญ ููุงุฐุง ุนูุฏูุง ูุญูู ุงูููุช): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">VACUUM</span></span> accounts;</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">postgres$ ls -l --time-style=+ /var/lib/postgresql/11/main/base/41493/41507_fsm</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-rw------- 1 postgres postgres 24576 /var/lib/postgresql/11/main/base/41493/41507_fsm</code> </pre><br>  <strong>ุฎุฑูุทุฉ ุงูุฑุคูุฉ</strong> ุนุจุงุฑุฉ ุนู ุดููุฉ ุญูุซ ูุชู ุชูููุฒ ุงูุตูุญุงุช ุงูุชู ุชุญุชูู ููุท ุนูู ุฅุตุฏุงุฑุงุช ุตู ูุญุฏุซุฉ ุจุช ูุงุญุฏ.  ุชูุฑูุจูุง ุ ููุฐุง ูุนูู ุฃูู ุนูุฏูุง ุชุญุงูู ูุนุงููุฉ ูุฑุงุกุฉ ุตู ูู ูุฐู ุงูุตูุญุฉ ุ ูููู ุฅุธูุงุฑ ุงูุตู ุฏูู ุงูุชุญูู ูู ุธููุฑู.  ูู ุงูููุงูุงุช ุงูุชุงููุฉ ุ ุณููุงูุด ุจุงูุชูุตูู ููู ูุญุฏุซ ูุฐุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">postgres$ ls -l --time-style=+ /var/lib/postgresql/11/main/base/41493/41507_vm</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-rw------- 1 postgres postgres 8192 /var/lib/postgresql/11/main/base/41493/41507_vm</code> </pre><br><h1 style=";text-align:right;direction:rtl">  ุตูุญุงุช </h1><br>  ููุง ุฐูุฑูุง ุณุงุจููุง ุ ูุชู ุชูุณูู ุงููููุงุช ุจุดูู ููุทูู ุฅูู ุตูุญุงุช. <br><br>  ุนุงุฏุฉู ูุง ูููู ุญุฌู ุงูุตูุญุฉ 8 ูููู ุจุงูุช.  ูููู ุชุบููุฑ ุงูุญุฌู ุถูู ุญุฏูุฏ ูุนููุฉ (16 ูููู ุจุงูุช ุฃู 32 ูููู ุจุงูุช) ุ ูููู ููุท ุฃุซูุงุก <code>./configure --with-blocksize</code> ( <code>./configure --with-blocksize</code> ).  ูููู ุฃู ูุนูู ูุซูู ูุฏูุฌ ูุชุดุบูู ูุน ุตูุญุงุช ูู ููุณ ุงูุญุฌู. <br><br>  ุจุบุถ ุงููุธุฑ ุนู ุงูุดููุฉ ุงูุชู ุชูุชูู ุฅูููุง ุงููููุงุช ุ ูุณุชุฎุฏููุง ุงูุฎุงุฏู ุจุทุฑููุฉ ูุดุงุจูุฉ ุฅูู ุญุฏ ูุง.  ุชุชู ูุฑุงุกุฉ ุงูุตูุญุงุช ุฃููุงู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ุญูุซ ูููู ููุนูููุงุช ูุฑุงุกุชูุง ูุชุบููุฑูุง ุ  ุซู ูููุง ุฏุนุช ุงูุญุงุฌุฉ ุ ูุชู ุฅุฎูุงุคูู ุฅูู ุงููุฑุต. <br><br>  ุชุญุชูู ูู ุตูุญุฉ ุนูู ูุณู ุฏุงุฎูู ูุจุตูุฉ ุนุงูุฉ ุชุญุชูู ุนูู ุงูุฃูุณุงู ุงูุชุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl">        0 + ----------------------------------- +
           |  ุฑุฃุณ |
       24 + ----------------------------------- +
           |  ูุฌููุนุฉ ูู ุงููุคุดุฑุงุช ุฅูู ุฅุตุฏุงุฑุงุช ุงูุตู |
    ุฃูู + ----------------------------------- +
           |  ูุณุงุญุฉ ุญุฑุฉ |
    ุงูุนููู + ----------------------------------- +
           |  ุฅุตุฏุงุฑุงุช ุงูุตู |
  ุฎุงุต + ----------------------------------- +
           |  ูุณุงุญุฉ ุฎุงุตุฉ |
 pageize + ----------------------------------- +
</pre><br>  ููููู ุจุณูููุฉ ูุนุฑูุฉ ุฃุญุฌุงู ูุฐู ุงูุฃูุณุงู ุจุงุณุชุฎุฏุงู pageinspect "extension": <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXTENSION</span></span> pageinspect; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> lower, upper, special, pagesize <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> page_header(get_raw_page(<span class="hljs-string"><span class="hljs-string">'accounts'</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>));</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> lower | upper | special | pagesize -------+-------+---------+---------- 40 | 8016 | 8192 | 8192 (1 row)</code> </pre><br>  ูุญู ููุง ููุธุฑ ุฅูู <strong>ุฑุฃุณ ุงูุตูุญุฉ</strong> ุงูุฃููู (ุตูุฑ) ูู ุงูุฌุฏูู.  ุจุงูุฅุถุงูุฉ ุฅูู ุฃุญุฌุงู ุงูููุงุทู ุงูุฃุฎุฑู ุ ูุญุชูู ุงูุฑุฃุณ ุนูู ูุนูููุงุช ูุฎุชููุฉ ุญูู ุงูุตูุญุฉ ุ ูุงูุชู ูุณูุง ููุชููู ุจูุง ุญุชู ุงูุขู. <br><br>  ููุฌุฏ ุฃุณูู ุงูุตูุญุฉ <strong>ูุณุงุญุฉ ุฎุงุตุฉ</strong> ุ ููู ูุงุฑุบุฉ ูู ูุฐู ุงูุญุงูุฉ.  ูุชู ุงุณุชุฎุฏุงูู ููุท ููููุงุฑุณ ุ ูุญุชู ููุณ ููู ูููู.  "ูู ุงูุฃุณูู" ููุง ูุนูุณ ูุง ููุฌุฏ ูู ุงูุตูุฑุฉ ุ  ูุฏ ูููู ุฃูุซุฑ ุฏูุฉ ููููู "ูู ุนูุงููู ุนุงููุฉ". <br><br>  ุจุนุฏ ุงููุณุงุญุฉ ุงูุฎุงุตุฉ ุ ุชูุฌุฏ <strong>ุฅุตุฏุงุฑุงุช ุงูุตู</strong> ุ ุฃู ุชูู ุงูุจูุงูุงุช ุงูุชู ูุฎุฒููุง ูู ุงูุฌุฏูู ุจุงูุฅุถุงูุฉ ุฅูู ุจุนุถ ุงููุนูููุงุช ุงูุฏุงุฎููุฉ. <br><br>  ูู ุฃุนูู ุงูุตูุญุฉ ุ ูุจุงุดุฑุฉ ุจุนุฏ ุงูุฑุฃุณ ุ ููุฌุฏ ุฌุฏูู ุงููุญุชููุงุช: <strong>ุตููู ุงููุคุดุฑุงุช</strong> ุฅูู ุฅุตุฏุงุฑุงุช ุงูุตู ุงููุชุงุญุฉ ูู ุงูุตูุญุฉ. <br><br>  ูููู ุชุฑู <strong>ูุณุงุญุฉ ุญุฑุฉ</strong> ุจูู ุฅุตุฏุงุฑุงุช ุงูุตููู ูุงููุคุดุฑุงุช (ูุชู ุงูุงุญุชูุงุธ ุจูุฐู ุงููุณุงุญุฉ ุงูุญุฑุฉ ูู ุฎุฑูุทุฉ ุงููุณุงุญุฉ ุงูุญุฑุฉ).  ูุงุญุธ ุฃูู ูุง ููุฌุฏ ุชุฌุฒุฆุฉ ููุฐุงูุฑุฉ ุฏุงุฎู ุงูุตูุญุฉ - ุญูุซ ูุชู ุชูุซูู ูู ุงููุณุงุญุฉ ุงูุฎุงููุฉ ุจูุณุงุญุฉ ูุงุญุฏุฉ ูุชุฌุงูุฑุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ูุคุดุฑุงุช </h2><br>  ููุงุฐุง ูู ูุคุดุฑุงุช ุฅูู ุงูุตู ุงูุฅุตุฏุงุฑุงุช ุงููุงุฒูุฉุ  ุงูุดูุก ูู ุฃู ุตููู ุงูููุฑุณ ูุฌุจ ุฃู ุชุดูุฑ ุจุทุฑููุฉ ูุง ุฅูู ุฅุตุฏุงุฑุงุช ุงูุตู ูู ุงูุฌุฏูู.  ูู ุงููุงุถุญ ุฃู ุงููุฑุฌุน ูุฌุจ ุฃู ูุญุชูู ุนูู ุฑูู ุงูููู ูุฑูู ุงูุตูุญุฉ ูู ุงูููู ูุจุนุถ ูุคุดุฑุงุช ุฅุตุฏุงุฑ ุงูุตู.  ูููููุง ุงุณุชุฎุฏุงู ุงูุฅุฒุงุญุฉ ูู ุจุฏุงูุฉ ุงูุตูุญุฉ ููุคุดุฑ ุ ูููู ุบูุฑ ูุฑูุญ.  ูู ูุชููู ูู ููู ุฅุตุฏุงุฑ ุตู ุฏุงุฎู ุงูุตูุญุฉ ูุฃูู ุณูุคุฏู ุฅูู ูุณุฑ ุงููุฑุงุฌุน ุงููุชุงุญุฉ.  ููุฐุง ูู ุดุฃูู ุฃู ูุคุฏู ุฅูู ุชุฌุฒุฆุฉ ุงููุณุงุญุฉ ุฏุงุฎู ุงูุตูุญุงุช ูุบูุฑูุง ูู ุงูุนูุงูุจ ุงููุฒุนุฌุฉ.  ูุฐูู ุ ูุดูุฑ ุงูููุฑุณ ุฅูู ุฑูู ุงููุคุดุฑ ุ ููุดูุฑ ุงููุคุดุฑ ุฅูู ุงููููุน ุงูุญุงูู ูุฅุตุฏุงุฑ ุงูุตู ูู ุงูุตูุญุฉ.  ููุฐุง ูู ูุนุงูุฌุฉ ุบูุฑ ูุจุงุดุฑุฉ. <br><br>  ูุดุบู ูู ูุคุดุฑ ุฃุฑุจุนุฉ ุจุงูุช ุจุงูุถุจุท ููุญุชูู ุนูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุดุงุฑุฉ ุฅูู ุฅุตุฏุงุฑ ุงูุตู </li><li style=";text-align:right;direction:rtl">  ุญุฌู ูุฐุง ุงูุฅุตุฏุงุฑ ุงูุตู </li><li style=";text-align:right;direction:rtl">  ุนุฏุฉ ุจุงูุช ูุชุญุฏูุฏ ุญุงูุฉ ุฅุตุฏุงุฑ ุงูุตู </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุจูุงูุงุช </h2><br>  ุชูุณูู ุงูุจูุงูุงุช ุนูู ุงููุฑุต ูู ุจุงูุถุจุท ููุณ ุชูุซูู ุงูุจูุงูุงุช ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู.  ุชุชู ูุฑุงุกุฉ ุงูุตูุญุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช "ููุง ูู" ุ ุฏูู ุฃู ุชุญูููุงุช.  ูุฐูู ุ ุชุชุนุงุฑุถ ูููุงุช ุงูุจูุงูุงุช ูู ูุธุงู ุฃุณุงุณู ูุงุญุฏ ูุน ุงูุฃูุธูุฉ ุงูุฃุณุงุณูุฉ ุงูุฃุฎุฑู. <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ูู ุจููุฉ X86 ุ ูููู ุชุฑุชูุจ ุงูุจุงูุช ูู ุงูุฃูู ุฃูููุฉ ุฅูู ุงูุจุงูุช ุงูุฃูุซุฑ ุฃูููุฉ (ุงููููู-endian) ุ z / Architecture ูุณุชุฎุฏู ุงูุชุฑุชูุจ ุงูุนูุณู (big-endian) ุ ููู ARM ูููู ุชุจุฏูู ุงูุชุฑุชูุจ. <br><br>  ุชููุฑ ุงูุนุฏูุฏ ูู ุงูููุงูู ููุญุงุฐุงุฉ ุงูุจูุงูุงุช ุนูู ุญุฏูุฏ ุงููููุงุช ุงูุฌูุงุฒ.  ุนูู ุณุจูู ุงููุซุงู ุ ุนูู ูุธุงู 32 ุจุช x 86 ุ ุณูุชู ูุญุงุฐุงุฉ ุฃุฑูุงู ุนุฏุฏ ุตุญูุญ (ุงูุชุจ "ุนุฏุฏ ุตุญูุญ" ุ ูุงูุชู ุชุดุบู 4 ุจุงูุช) ุนูู ุญุฏูุฏ ุงููููุงุช ุฐุงุช 4 ุจุงูุช ุ ุจููุณ ุทุฑููุฉ ุงูุฃุฑูุงู ุงููุฒุฏูุฌุฉ ุงูุฏูุฉ (ุงูุชุจ "ุงูุฏูุฉ ุงููุฒุฏูุฌุฉ" ุ ูุงูุชู ุชุญุชู 8 ุจุงูุช).  ูุนูู ูุธุงู 64 ุจุช ุ ุณูุชู ูุญุงุฐุงุฉ ุฃุฑูุงู ุงูุฏูุฉ ุงููุฒุฏูุฌุฉ ุนูู ุญุฏูุฏ ูู 8 ุจุงูุช ุงููููุงุช.  ูุฐุง ุณุจุจ ูุงุญุฏ ูุนุฏู ุงูุชูุงูู. <br><br>  ุจุณุจุจ ุงููุญุงุฐุงุฉ ุ ูุนุชูุฏ ุญุฌู ุตู ุงูุฌุฏูู ุนูู ุชุฑุชูุจ ุงูุญูู.  ุนุงุฏุฉ ูุง ูููู ูุฐุง ุงูุชุฃุซูุฑ ููุญูุธูุง ุฌุฏูุง ุ ูููู ูู ุจุนุถ ุงูุฃุญูุงู ุ ูุฏ ูุคุฏู ุฅูู ููู ูุจูุฑ ูู ุงูุญุฌู.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงูุช ุงูุญููู ูู ุงูุฃููุงุน "char (1)" ู "integer" ูุชุดุงุจูุฉ ุ ูุนุงุฏุฉู ูุง ุชุถูุน 3 ุจุงูุช ุจููููุง.  ููุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ูุฐุง ุ ููููู ุงูุงุทูุงุน ุนูู ุนุฑุถ ูููููุงู ุดุงุจููู " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Tuple internals</a> ". <br><br><h1 style=";text-align:right;direction:rtl">  ุฅุตุฏุงุฑุงุช ุงูุตู ูุงูุฎุจุฒ </h1><br>  ุณููุงูุด ุชูุงุตูู ุงููููู ุงูุฏุงุฎูู ูุฅุตุฏุงุฑุงุช ุงูุตู ูู ุงููุฑุฉ ุงููุงุฏูุฉ.  ูู ูุฐู ุงููุฑุญูุฉ ุ ูู ุงูููู ููุท ุฃู ูุนุฑู ุฃู ูู ุฅุตุฏุงุฑ ูุฌุจ ุฃู ููุงุณุจ ุตูุญุฉ ูุงุญุฏุฉ ุชูุงููุง: ููุณ ูุฏู PostgreSQL ุฃู ุทุฑููุฉ "ูุชูุณูุน" ุงูุตู ุฅูู ุงูุตูุญุฉ ุงูุชุงููุฉ.  ูุชู ุงุณุชุฎุฏุงู ุชูููุฉ ุชุฎุฒูู ุงูุณูุงุช ูุจูุฑุฉ ุงูุญุฌู (TOAST) ุจุฏูุงู ูู ุฐูู.  ูุดูุฑ ุงูุงุณู ููุณู ุฅูู ุฃูู ูููู ุชูุณูู ุตู ุฅูู ุฎุจุฒ ูุญูุต. <br><br>  ุงููุฒุงุญ ุจุตุฑู ุงููุธุฑ ุ ุชูุณุช ููุทูู ุนูู ุงูุนุฏูุฏ ูู ุงูุงุณุชุฑุงุชูุฌูุงุช.  ูููููุง ููู ููู ุงูุณูุงุช ุงูุทูููุฉ ุฅูู ุฌุฏูู ุฏุงุฎูู ูููุตู ุจุนุฏ ุชูุณูููุง ุฅูู ุฃุฌุฒุงุก ุชูุณุช ุตุบูุฑุฉ.  ููุงู ุฎูุงุฑ ุขุฎุฑ ููู ุถุบุท ุงููููุฉ ุจุญูุซ ูุชูุงุณุจ ุฅุตุฏุงุฑ ุงูุตู ูุน ุตูุญุฉ ุนุงุฏูุฉ.  ููููููุง ุงูููุงู ุจุงูุฃูุฑูู ุงูุชุงูููู: ุฃููุงู ุถุบุท ุซู ุชูููู ูููู. <br><br>  ููู ุฌุฏูู ุฃุณุงุณู ุ ูููู ุฅูุดุงุก ุฌุฏูู TOAST ูููุตู ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูุงุญุฏ ูุฌููุน ุงูุณูุงุช (ูุน ููุฑุณ ุนูู ุฐูู).  ุชูุงูุฑ ุณูุงุช ูุญุชูู ุฃู ุชููู ุทูููุฉ ูุญุฏุฏ ูุฐู ุงูุญุงุฌุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ุงูุฌุฏูู ูุญุชูู ุนูู ุนููุฏ ูู ุงูููุน "ุฑููู" ุฃู "ูุต" ุ ูุณูุชู ุฅูุดุงุก ุฌุฏูู TOAST ุนูู ุงูููุฑ ุญุชู ุฅุฐุง ูู ูุชู ุงุณุชุฎุฏุงู ุงูููู ุงูุทูููุฉ. <br><br>  ูุธุฑูุง ูุฃู ุฌุฏูู TOAST ุนุจุงุฑุฉ ุนู ุฌุฏูู ุนุงุฏู ุ ูุฅูู ูุญุชูู ุนูู ููุณ ูุฌููุนุฉ ุงูุดูู.  ููุฐุง ูุถุงุนู ุนุฏุฏ ุงููููุงุช ุงูุชู ุชุชูุงูู ูุน ุฌุฏูู. <br><br>  ูุชู ุชุนุฑูู ุงูุงุณุชุฑุงุชูุฌูุงุช ุงูุฃูููุฉ ุญุณุจ ุฃููุงุน ุจูุงูุงุช ุงูุฃุนูุฏุฉ.  ููููู ุฅููุงุก ูุธุฑุฉ ุนูููุง ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ <code>\d+</code> ูู psql ุ ูููู ูุธุฑูุง ูุฃูู ูุคุฏู ุฅูู ุฅุฎุฑุงุฌ ุงููุซูุฑ ูู ุงููุนูููุงุช ุงูุฃุฎุฑู ุ ูุฅููุง ุณูู ูุณุชูุณุฑ ุนู ูุชุงููุฌ ุงููุธุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> attname, atttypid::<span class="hljs-type"><span class="hljs-type">regtype</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> attstorage <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-string"><span class="hljs-string">'p'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'plain'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-string"><span class="hljs-string">'e'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'external'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-string"><span class="hljs-string">'m'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'main'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-string"><span class="hljs-string">'x'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'extended'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">storage</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_attribute <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> attrelid = <span class="hljs-string"><span class="hljs-string">'accounts'</span></span>::<span class="hljs-type"><span class="hljs-type">regclass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attnum &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> attname | atttypid | storage ---------+----------+---------- id | integer | plain number | text | extended client | text | extended amount | numeric | main (4 rows)</code> </pre><br>  ุฃุณูุงุก ุงูุงุณุชุฑุงุชูุฌูุงุช ุชุนูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุนุงุฏู - TOAST ุบูุฑ ูุณุชุฎุฏู (ูุณุชุฎุฏู ูุฃููุงุน ุงูุจูุงูุงุช ุงููุนุฑููุฉ ุจุฃููุง ูุตูุฑุฉ ุ ูุซู "ุนุฏุฏ ุตุญูุญ"). </li><li style=";text-align:right;direction:rtl">  ููุชุฏ - ูู ูู ุงูุถุบุท ูุงูุชุฎุฒูู ูู ุฌุฏูู TOAST ูููุตู ูุณููุญ ุจู </li><li style=";text-align:right;direction:rtl">  ูุชู ุชุฎุฒูู ุงูููู ุงูุฎุงุฑุฌูุฉ ุงูุทูููุฉ ูู ุฌุฏูู TOAST ุฏูู ุถุบุท. </li><li style=";text-align:right;direction:rtl">  ุงูุฑุฆูุณูุฉ - ูุชู ุถุบุท ุงูููู ุงูุทูููุฉ ุฃููุงู ูุงููุตูู ููุท ุฅูู ุฌุฏูู TOAST ุฅุฐุง ูู ูุณุงุนุฏ ุงูุถุบุท. </li></ul><br>  ุจุดูู ุนุงู ุ ุงูุฎูุงุฑุฒููุฉ ูู ููุง ููู.  ููุฏู PostgreSQL ุฅูู ุงุญุชูุงุก ุฃุฑุจุนุฉ ุตููู ุนูู ุงูุฃูู ุนูู ุตูุญุฉ ูุงุญุฏุฉ.  ูุฐูู ุ ุฅุฐุง ุชุฌุงูุฒ ุญุฌู ุงูุตู ูุงุญุฏูุง ุฎุงุฑุฌ ุงูุตูุญุฉ ุ ูุน ูุฑุงุนุงุฉ ุงูุฑุฃุณ (2040 ุจุงูุช ูุตูุญุฉ 8K ุนุงุฏูุฉ) ุ ูุฌุจ ุชุทุจูู TOAST ุนูู ุฌุฒุก ูู ุงูููู.  ูุชุจุน ุงูุฃูุฑ ุงูููุถุญ ุฃุฏูุงู ููุชููู ุจูุฌุฑุฏ ุฃู ูุชุฌุงูุฒ ุงูุตู ุงูุญุฏ ุงูุฃุฏูู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃููุงู ููุชูู ุฅูู ุงูุณูุงุช ุจุงุณุชุฎุฏุงู ุงูุงุณุชุฑุงุชูุฌูุงุช "ุงูุฎุงุฑุฌูุฉ" ู "ุงูููุณุนุฉ" ุจุฏุกูุง ูู ุฃุทูู ุณูุฉ ุฅูู ุงูุฃูุตุฑ.  ูุชู ุถุบุท ุงูุณูุงุช "ุงูููุณุนุฉ" (ุฅุฐุง ูุงูุช ูุนุงูุฉ) ูุฅุฐุง ุชุฌุงูุฒุช ุงููููุฉ ููุณูุง ูุงุญุฏุงู ูู ุงูุตูุญุฉ ุ ูุฅููุง ุชุฏุฎู ุนูู ุงูููุฑ ูู ุฌุฏูู TOAST.  ุชุชู ูุนุงูุฌุฉ ุงูุณูุงุช "ุงูุฎุงุฑุฌูุฉ" ุจููุณ ุงูุทุฑููุฉ ุ ูููููุง ุบูุฑ ูุถุบูุทุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ููู ุฅุตุฏุงุฑ ุงูุตู ุจุนุฏ ุงูุตูุญุฉ ุงูุฃููู ููุงุณุจูุง ููุตูุญุฉ ุ ููุญู ูุฑุณู ุงูุณูุงุช ุงููุชุจููุฉ ุจุงุณุชุฎุฏุงู ุงูุงุณุชุฑุงุชูุฌูุงุช "ุงูุฎุงุฑุฌูุฉ" ู "ุงูููุณุนุฉ" ุฅูู ุฌุฏูู TOAST. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ูุณุงุนุฏ ุฐูู ุฃูุถูุง ุ ูุณูุญุงูู ุถุบุท ุงูุณูุงุช ุจุงุณุชุฎุฏุงู ุงูุงุณุชุฑุงุชูุฌูุฉ "ุงูุฑุฆูุณูุฉ" ุ ูููู ูุชุฑููุง ูู ุตูุญุฉ ุงูุฌุฏูู. </li><li style=";text-align:right;direction:rtl">  ูููุท ุฅุฐุง ูุงู ุฐูู ุจุนุฏ ุฐูู ุ ูุฅู ุงูุตู ููุณ ูุตูุฑูุง ุจูุง ููู ุงูููุงูุฉ ุ ูุชุฏุฎู ุงูุณูุงุช "ุงูุฑุฆูุณูุฉ" ูู ุฌุฏูู TOAST. </li></ol><br>  ูุฏ ูููู ูู ุงููููุฏ ูู ุจุนุถ ุงูุฃุญูุงู ุชุบููุฑ ุงูุฅุณุชุฑุงุชูุฌูุฉ ูุจุนุถ ุงูุฃุนูุฏุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ูู ุงููุนุฑูู ูุณุจููุง ุฃูู ูุง ูููู ุถุบุท ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ูู ุนููุฏ ูุง ุ ููููููุง ุชุนููู ุงุณุชุฑุงุชูุฌูุฉ "ุฎุงุฑุฌูุฉ" ููุง ุ ูุงูุชู ุชููููุง ูู ุชูููุฑ ุงูููุช ุนู ุทุฑูู ุชุฌูุจ ูุญุงููุงุช ุงูุถุบุท ุบูุฑ ุงููุฌุฏูุฉ.  ููุชู ุฐูู ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COLUMN</span></span> number <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> <span class="hljs-keyword"><span class="hljs-keyword">STORAGE external</span></span>;</code> </pre><br>  ุนูุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุงุณุชุนูุงู ุ ูุญุตู ุนูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> attname | atttypid | storage ---------+----------+---------- id | integer | plain number | text | external client | text | extended amount | numeric | main</code> </pre><br>  ุชูุฌุฏ ุฌุฏุงูู ูููุงุฑุณ TOAST ูู ูุฎุทุท pg_toast ุงููููุตู ุ ูุจุงูุชุงูู ุ ุนุงุฏุฉ ูุง ุชููู ุบูุฑ ูุฑุฆูุฉ.  ุจุงููุณุจุฉ ููุฌุฏุงูู ุงููุคูุชุฉ ุ ูุชู ุงุณุชุฎุฏุงู ูุฎุทุท "pg_toast_temp_ <em>N</em> " ุจุดูู ูุดุงุจู ูููุฎุทุท ุงููุนุชุงุฏ "pg_temp_ <em>N</em> ". <br><br>  ุจุงูุทุจุน ุ ุฅุฐุง ุฃุนุฌุจู ุ ููู ูุนููู ุงูุชุฌุณุณ ุนูู ุงูุขููุงุช ุงูุฏุงุฎููุฉ ููุนูููุฉ.  ูููุชุฑุถ ุฃูู ูู ุฌุฏูู "ุงูุญุณุงุจุงุช" ููุงู ุซูุงุซ ุณูุงุช ุทูููุฉ ูุญุชููุฉ ุ ูุจุงูุชุงูู ุ ูุฌุจ ุฃู ูููู ููุงู ุฌุฏูู TOAST.  ููู ููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> relnamespace::<span class="hljs-type"><span class="hljs-type">regnamespace</span></span>, relname <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_class <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-type"><span class="hljs-type">oid</span></span> = ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> reltoastrelid <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_class <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> relname = <span class="hljs-string"><span class="hljs-string">'accounts'</span></span> );</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> relnamespace | relname --------------+---------------- pg_toast | pg_toast_33953 (1 row)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; \d+ pg_toast.pg_toast_33953</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">TOAST table "pg_toast.pg_toast_33953" Column | Type | Storage ------------+---------+--------- chunk_id | oid | plain chunk_seq | integer | plain chunk_data | bytea | plain</code> </pre><br>  ูู ุงููุนููู ุฃู ูุชู ุชุทุจูู ุงูุฅุณุชุฑุงุชูุฌูุฉ "ุงูุจุณูุทุฉ" ุนูู ุงูุฎุจุฒ ุงููุญูุต ุงูุฐู ุชู ุชูุทูุน ุงูุตู ุฅููู: ูุง ููุฌุฏ ุชูุณุช ูู ุงููุณุชูู ุงูุซุงูู. <br><br>  ูุฎูู PostgreSQL ุงูููุฑุณ ุจุดูู ุฃูุถู ุ ููู ููุณ ูู ุงูุตุนุจ ุงูุนุซูุฑ ุนูู ุฃู ูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> indexrelid::<span class="hljs-type"><span class="hljs-type">regclass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_index <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> indrelid = ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-type"><span class="hljs-type">oid</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_class <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> relname = <span class="hljs-string"><span class="hljs-string">'pg_toast_33953'</span></span> );</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> indexrelid ------------------------------- pg_toast.pg_toast_33953_index (1 row)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; \d pg_toast.pg_toast_33953_index</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Unlogged index "pg_toast.pg_toast_33953_index" Column | Type | Key? | Definition -----------+---------+------+------------ chunk_id | oid | yes | chunk_id chunk_seq | integer | yes | chunk_seq primary key, btree, for table "pg_toast.pg_toast_33953"</code> </pre><br>  ูุณุชุฎุฏู ุนููุฏ "ุงูุนููู" ุงุณุชุฑุงุชูุฌูุฉ "ููุณุนุฉ": ุณูุชู ุถุบุท ูููู.  ูููุญุต: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> client = repeat(<span class="hljs-string"><span class="hljs-string">'A'</span></span>,<span class="hljs-number"><span class="hljs-number">3000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> id = <span class="hljs-number"><span class="hljs-number">1</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_toast.pg_toast_33953;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> chunk_id | chunk_seq | chunk_data ----------+-----------+------------ (0 rows)</code> </pre><br>  ูุง ููุฌุฏ ุดูุก ูู ุฌุฏูู TOAST: ูุชู ุถุบุท ุงูุฃุญุฑู ุงูููุฑุฑุฉ ุจุดูู ุฌูุฏ ูุจุนุฏ ุงูุถุบุท ุ ุชูุงุณุจ ุงููููุฉ ุตูุญุฉ ุงูุฌุฏูู ุงููุนุชุงุฏุฉ. <br><br>  ูุงูุขู ุฏุน ุงุณู ุงูุนููู ูุชููู ูู ุฃุญุฑู ุนุดูุงุฆูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> client = ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> string_agg( chr(trunc(<span class="hljs-number"><span class="hljs-number">65</span></span>+random()*<span class="hljs-number"><span class="hljs-number">26</span></span>)::<span class="hljs-type"><span class="hljs-type">integer</span></span>), <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> generate_series(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">3000</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> id = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RETURNING</span></span> left(client,<span class="hljs-number"><span class="hljs-number">10</span></span>) || <span class="hljs-string"><span class="hljs-string">'...'</span></span> || right(client,<span class="hljs-number"><span class="hljs-number">10</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ?column? ------------------------- TCKGKZZSLI...RHQIOLWRRX (1 row)</code> </pre><br>  ูุง ูููู ุถุบุท ูุฐุง ุงูุชุณูุณู ุ ููุชู ุฅุฏุฎุงูู ูู ุฌุฏูู TOAST: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> chunk_id, chunk_seq, length(chunk_data), left(encode(chunk_data,<span class="hljs-string"><span class="hljs-string">'escape'</span></span>)::<span class="hljs-type"><span class="hljs-type">text</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) || <span class="hljs-string"><span class="hljs-string">'...'</span></span> || right(encode(chunk_data,<span class="hljs-string"><span class="hljs-string">'escape'</span></span>)::<span class="hljs-type"><span class="hljs-type">text</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_toast.pg_toast_33953;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> chunk_id | chunk_seq | length | ?column? ----------+-----------+--------+------------------------- 34000 | 0 | 2000 | TCKGKZZSLI...ZIPFLOXDIW 34000 | 1 | 1000 | DDXNNBQQYH...RHQIOLWRRX (2 rows)</code> </pre><br>  ูููููุง ุฃู ูุฑู ุฃู ุงูุจูุงูุงุช ููุณูุฉ ุฅูู ุฃุฌุฒุงุก 2000 ุจุงูุช. <br><br>  ุนูุฏ ุงููุตูู ุฅูู ูููุฉ ุทูููุฉ ุ ูููู PostgreSQL ุชููุงุฆููุง ูุดูุงููุง ููุชุทุจูู ุจุงุณุชุนุงุฏุฉ ุงููููุฉ ุงูุฃุตููุฉ ูุฅุนุงุฏุชูุง ุฅูู ุงูุนููู. <br><br>  ุจุงูุชุฃููุฏ ุ ูู ุงูุถุฑูุฑู ุฌุฏูุง ุถุบุท ุงูููุงุฑุฏ ูุชูุณูููุง ุซู ุงุณุชุนุงุฏุชูุง.  ูุฐูู ุ ูุฅู ุชุฎุฒูู ุงูุจูุงูุงุช ุงูุถุฎูุฉ ูู PostgreSQL ููุณ ูู ุฃูุถู ููุฑุฉ ุ ุฎุงุตุฉู ุฅุฐุง ุชู ุงุณุชุฎุฏุงููุง ุจุดูู ูุชูุฑุฑ ููุง ูุชุทูุจ ุงูุงุณุชุฎุฏุงู ููุทููุง ูููุนุงููุงุช (ุนูู ุณุจูู ุงููุซุงู: ุนูููุงุช ุงููุณุญ ูููุณุชูุฏุงุช ุงููุญุงุณุจูุฉ ุงูุฃุตููุฉ).  ุงูุจุฏูู ุงูุฃูุซุฑ ูุงุฆุฏุฉ ูู ุชุฎุฒูู ูุฐู ุงูุจูุงูุงุช ุนูู ูุธุงู ุงููููุงุช ูุน ุฃุณูุงุก ุงููููุงุช ุงููุฎุฒูุฉ ูู DBMS. <br><br>  ูุชู ุงุณุชุฎุฏุงู ุฌุฏูู TOAST ููุท ูููุตูู ุฅูู ูููุฉ ุทูููุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุชู ุฏุนู ุงูุชุฒุงูู ุงูุชุญููู ุงูุฎุงุต ุจุฌุฏูู TOAST: ูุง ูู ููุณ ุชุญุฏูุซ ุงูุจูุงูุงุช ูููุฉ ุทูููุฉ ุ ูุฅู ุฅุตุฏุงุฑ ุตู ุฌุฏูุฏ ุณูุดูุฑ ุฅูู ููุณ ุงููููุฉ ูู ุฌุฏูู TOAST ุ ููุง ูููุฑ ูุณุงุญุฉ. <br><br>  ูุงุญุธ ุฃู TOAST ูุนูู ููุท ููุฌุฏุงูู ุ ูููู ููุณ ููููุงุฑุณ.  ูุฐุง ููุฑุถ ูููุฏูุง ุนูู ุญุฌู ุงูููุงุชูุญ ุงููุฑุงุฏ ููุฑุณุชูุง. <br><blockquote style=";text-align:right;direction:rtl">  ููุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ุจููุฉ ุงูุจูุงูุงุช ุงูุฏุงุฎููุฉ ุ ููููู ูุฑุงุกุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> . <br></blockquote><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑุฃ ุนูู</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar469087/">https://habr.com/ru/post/ar469087/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar469073/index.html">ูุดุชู ูููุตู ุฃู ููุฎุต ูููููุฉ ุฌูุน ุงูุณูุงุณู</a></li>
<li><a href="../ar469075/index.html">ุฌุฑููุงู DLR</a></li>
<li><a href="../ar469077/index.html">ุฏูุฑุฉ Microsoft Python ุงูุฌุฏูุฏุฉ [ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ]</a></li>
<li><a href="../ar469079/index.html">ุจูุซูู ูู ุฑูุฒ ุงูุงุณุชูุฏูู ุงููุฑุฆู: ุชุญุฏูุซ ุชูุฏูุฏ ุณุจุชูุจุฑ</a></li>
<li><a href="../ar469085/index.html">ูููู ุจุฅุฎุฑุงุฌ ุงูุจุฑูุงูุฌ ูู ูุชุญูู ูููุฉ ุงููุฑูุฑ Renesas M16C ุงููุญูู ุจูููุฉ ูุฑูุฑ</a></li>
<li><a href="../ar469093/index.html">ููุงุฑูุฉ ุจูู ููุชุจุงุช CLI ุงูุฃูู ุดููุนูุง ูููุณุช ุฌุฏูุง: ุฌุฑู ุ plac ุ ุจุฑููู ูุบูุฑูุง (ุฌุฒุก 2)</a></li>
<li><a href="../ar469095/index.html">ุชู ุฅุทูุงู ุชุญุฏูุซุงุช ML.NET ู Model Builder: ูุง ุงูุฌุฏูุฏ</a></li>
<li><a href="../ar469097/index.html">ุฎุงุฏู ุงูููุจ CentOS 8 ูุน php7 ู node.js ู redis</a></li>
<li><a href="../ar469099/index.html">ุงุฎุชุจุงุฑ ุงูููุงู ูู ููุงุจูุฉ ุงููุทูุฑ - ูู ูุนููุ</a></li>
<li><a href="../ar469101/index.html">ุชุนูู ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ: ููููุฉ ุชุนูู ุงูุชุญุฏุซ ููุชุญุฏุซ ุฃุตูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>