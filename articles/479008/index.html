<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙆🏻 💃🏾 🙃 Cómo cocinar RTSP en su sitio web en 2020, o por qué los jabalíes no tendrán la oportunidad de escapar 🎏 🥀 📊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="RTSP es un protocolo de señalización simple que no pueden reemplazar con nada durante muchos años, y hay que admitir que no se esfuerzan realmente. 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cómo cocinar RTSP en su sitio web en 2020, o por qué los jabalíes no tendrán la oportunidad de escapar</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flashphoner/blog/479008/"><p><img src="https://habrastorage.org/webt/0o/qj/i7/0oqji7xkok-ssze_oqdnr2kmfcg.jpeg"></p><br><p>  RTSP es un protocolo de señalización simple que no pueden reemplazar con nada durante muchos años, y hay que admitir que no se esfuerzan realmente. </p><br><p>  Por ejemplo, tenemos una cámara IP que admite RTSP.  Cualquiera que haya probado el tráfico con un cable Sharkwire le dirá que primero viene DESCRIBE, luego PLAY y luego el tráfico comienza a fluir directamente a través de RTP o, por ejemplo, envuelto en el canal TCP. </p><a name="habracut"></a><br><p>  Un esquema típico de establecer una conexión RTSP se ve así: </p><br><p><img src="https://habrastorage.org/webt/yi/i9/kw/yii9kwulxpxxz1dywpppxqdy0ko.png"></p><br><p>  Es concebible que el soporte del protocolo RTSP sea innecesario para los navegadores y de casi tanto uso como la quinta rueda, por lo tanto, los navegadores no tienen prisa por implementarlo en una escala masiva, y eso casi nunca sucederá.  Por otro lado, los navegadores podrían crear conexiones TCP directas, y eso resolvería la tarea, pero ahora se topa con problemas de seguridad: ¿alguna vez has visto un navegador que permita que un script use protocolos de transporte directamente? </p><br><p>  Pero la gente exige que las transmisiones estén disponibles en "cualquier navegador sin instalar ningún software adicional", y los principiantes escriben en sus sitios web, "no tiene que instalar nada, funcionará en todos los navegadores de fábrica", cuando desea mostrar una transmisión desde una cámara IP. </p><br><p>  En este artículo vamos a explorar cómo se puede lograr esto.  Y como el próximo año contiene una cifra redonda, agreguemos algo de actualidad a nuestro artículo y peguemos una etiqueta con 2020, especialmente porque realmente es así. </p><br><p>  Entonces, ¿qué tecnologías de visualización de video para una página web deben olvidarse en el año 2020?  Es Flash en el navegador.  Esta muerto  Ya no existe, tacharlo de la lista. </p><br><h3 id="three-useful-methods">  Tres métodos útiles </h3><br><p>  Las herramientas que le permitirán ver una transmisión de video en su navegador hoy son: </p><br><ol><li>  WebRTC </li><li>  Hls </li><li>  Websocket + MSE </li></ol><br><h4 id="what-is-wrong-with-webrtc">  Lo que está mal con WebRTC </h4><br><p>  En dos palabras: requiere muchos recursos y es complicado. </p><br><p>  Lo descartarás, "¿Qué quieres decir con uso intensivo de recursos?", Como las CPU son potentes hoy en día, la memoria es barata, ¿cuál es el problema?  Bueno, en primer lugar, es un cifrado obligatorio de todo el tráfico, incluso si no lo necesita.  En segundo lugar, WebRTC es una conexión bidireccional complicada y un intercambio de retroalimentación punto a punto sobre la calidad del canal (punto a punto, en este caso): en cada momento se calcula la tasa de bits, se detectan pérdidas de paquetes, decisiones sobre su redirección tomada, y la sincronización de audio a video se calcula con respecto a todo eso, la llamada sincronización de labios, que hace que los labios del hablante coincidan con sus palabras.  Todos estos cálculos, así como el tráfico entrante en el servidor, asignan y liberan gigabytes de RAM en tiempo real, y si algo sale mal, un servidor de 256 gigabytes con una CPU de 48 núcleos entrará en un giro fácil a pesar de todos los gigaherzs, nanómetros y DDR 10 a bordo. </p><br><p>  Entonces, es como cazar ardillas con un misil Iskander.  Todo lo que necesitamos extraer es una transmisión RTSP, y luego mostrarla, y lo que dice WebRTC es: "Sí, vamos, pero tendrás que pagar por ello". </p><br><h4 id="why-webrtc-is-good">  Por qué es bueno WebRTC </h4><br><p> La latencia  Es realmente bajo.  Si está listo para sacrificar el rendimiento y la complejidad por la baja latencia, WebRTC es la variante más adecuada para usted. </p><br><h4 id="why-hls-is-good">  Por qué HLS es bueno </h4><br><p>  En dos palabras: puede funcionar en todas partes </p><br><p>  HLS es un todoterreno lento en el mundo de mostrar contenido en vivo.  Puede funcionar en todas partes debido a dos cosas: el transporte HTTP y el patrocinio de Apple.  De hecho, el protocolo HTTP es omnipresente, puedo sentir su presencia incluso cuando estoy escribiendo estas líneas.  Entonces, no importa dónde se encuentre y qué tableta antigua use para navegar por la red, HLS (HTTP Live Streaming) lo contactará y entregará el video a su pantalla con seguridad. </p><br><p>  Todo es lo suficientemente bueno, pero ... </p><br><h4 id="why-hls-is-bad">  ¿Por qué HLS es malo? </h4><br><p>  La latencia  Existen, por ejemplo, proyectos de videovigilancia en obras.  Una instalación está en construcción durante años, y durante todo ese tiempo la cámara pobre graba videos del sitio de construcción día y noche, 24/7.  Este es un ejemplo de una situación en la que no se necesita la baja latencia. </p><br><p>  Otro ejemplo son los jabalíes.  Verracos reales.  Los granjeros de Ohio sufren una invasión de jabalíes que se alimentan de los cultivos y los pisotean como langostas, lo que representa una amenaza para el bienestar financiero de las granjas.  Los emprendedores emprendedores han lanzado un sistema de video vigilancia desde cámaras RTSP que monitorea los terrenos en tiempo real y dispara una trampa cuando los intrusos invaden.  En este caso, la baja latencia es de importancia crítica, y si se usa HLS (con una latencia de 15 segundos), los verracos huirán antes de que se active la trampa. </p><br><p><img src="https://habrastorage.org/webt/g4/ha/iw/g4haiwkwu7jqrhh65c804phjt-q.jpeg"></p><br><p>  Aquí hay un ejemplo más: presentaciones de video donde alguien le muestra un producto y espera una respuesta rápida.  En el caso de una alta latencia, le mostrarán el producto en la cámara, luego le preguntarán: "¿Y cómo le gusta?", Y eso lo alcanzará solo en 15 segundos.  En 15 segundos, la señal puede viajar a la Luna y regresar 12 veces.  No, no queremos tal latencia.  Más bien parece un video pregrabado que Live.  Pero video pregrabado, ya que así es como funciona HLS: graba porciones de un video en un disco o en la memoria del servidor, y el reproductor descarga las porciones grabadas.  Así es como funciona HTTP Live, que no es Live en absoluto. </p><br><p>  ¿Por qué sucede?  La presencia global del protocolo HTTP y su simplicidad resultan en su lentitud, ya que HTTP no estaba destinado inicialmente a la descarga y visualización rápida de miles de fragmentos de video grandes (segmentos HLS).  Por supuesto, se descargan y se reproducen con alta calidad, pero muy lentamente: se necesitan esos 15 segundos o más para descargarse, almacenarse y decodificarse. </p><br><p>  Cabe señalar aquí que Apple anunció su baja latencia HLS en otoño de 2019, pero esa ya es una historia diferente.  Veamos más detalladamente sus resultados más adelante.  Y ahora también tenemos MSE en stock. </p><br><h4 id="why-mse-is-good">  ¿Por qué MSE es bueno? </h4><br><p>  Media Source Extension es un soporte nativo para reproducir videos en paquetes en el navegador.  Puede llamarse un reproductor nativo para H.264 y AAC, al que puede alimentar segmentos de video y que no está vinculado a un protocolo de transporte, a diferencia de HLS.  Por este motivo, puede elegir el transporte a través del protocolo Websockets.  En otras palabras, los segmentos ya no se descargarán utilizando la antigua tecnología de Solicitud-Respuesta (HTTP), sino que fluirán fácilmente a través de la conexión Websockets, que es casi un canal TCP directo.  Esto es de gran ayuda con respecto a la disminución de los retrasos que pueden llegar a ser tan bajos como 3-5 segundos.  Tal latencia no es fantástica, pero es adecuada para la mayoría de los proyectos que no requieren un tiempo real difícil.  La complejidad y la intensidad de los recursos también son relativamente bajas porque se abre un canal TCP, y casi los mismos segmentos HLS se vierten a través de él, que son recogidos por el jugador y enviados para ser reproducidos. </p><br><h4 id="why-mse-is-bad">  ¿Por qué MSE es malo? </h4><br><p>  No puede funcionar en todas partes.  Al igual que con WebRTC, su penetración en los navegadores es menor.  Los iPhones (iOS) tienen un historial especialmente notable de fallas en la reproducción de MSE, lo que hace que MSE sea poco adecuado como la única solución para una startup. <br>  Está totalmente disponible en los siguientes navegadores: Edge, Firefox, Chrome, Safari, Android Browser, Opera Mobile, Chrome para Android, Firefox para Android, UC Browser para Android. </p><br><p><img src="https://habrastorage.org/webt/xt/oq/wn/xtoqwnjdoosqb6fhopu9rvoxsxy.png"></p><br><p>  El soporte limitado de MSE apareció en iOS Safari hace poco tiempo, comenzando con iOS 13. </p><br><p><img src="https://habrastorage.org/webt/fl/wd/-n/flwd-nksnux1tlprjriupeajyvm.png"></p><br><h3 id="rtsp-leg">  Pierna RTSP </h3><br><p>  Hemos discutido la entrega en el servidor de video&gt; dirección del navegador.  Además de eso, también necesitarás estas dos cosas: </p><br><p>  1) Para entregar su video desde la cámara IP al servidor. <br>  2) Para convertir el video a uno de los formatos / protocolos descritos anteriormente. </p><br><p>  Aquí es donde entra el lado del servidor. </p><br><p>  Ta-dah ... Conozca <a href="https://flashphoner.com/">Web Call Server 5</a> (o simplemente WCS para amigos).  Alguien tiene que recibir el tráfico RTSP, desempaquetar el video correctamente, convertirlo en WebRTC, HLS o MSE, preferiblemente sin ser sobrecomprimido por el transcodificador, y enviarlo hacia el navegador en forma presentable, no dañado con artefactos y congelaciones. </p><br><p>  La tarea no es complicada a primera vista, pero puede haber tantas trampas ocultas, cámaras chinas y matices de conversión detrás que es realmente horrible.  De hecho, no es posible sin hacks, pero funciona y funciona bien.  En producción </p><br><h4 id="the-delivery-scheme">  El esquema de entrega </h4><br><p>  Como resultado, un esquema completo de entrega de contenido RTSP con conversión en un servidor intermedio comienza a tomar forma. </p><br><p><img src="https://habrastorage.org/webt/jm/7e/oj/jm7eojlfeztudqtrwzjebgu4t9e.png"></p><br><p>  Una de las preguntas más frecuentes de nuestros colegas indios es: “¿Es posible?  Directamente, sin un servidor?  No, no lo es;  Necesitará el lado del servidor que hará el trabajo.  En la nube, en hardware, en corei7 en su balcón, pero no puede prescindir de él. </p><br><h4 id="lets-get-back-to-our-year-2020">  Volvamos a nuestro año 2020 </h4><br><p>  Entonces, aquí está la receta para cocinar un RTSP en su navegador: </p><br><ol><li>  <a href="">Tome un nuevo WCS (Web Call Server)</a> . </li><li>  Agregue WebRTC, HLS o MSE al gusto. </li><li><p>  Servirlos en la página web. </p><br><p>  ¡Disfruta tu comida! </p><br></li></ol><br><h3 id="no-this-isnt-all-yet">  No, esto no es todo todavía. </h3><br><p>  Las neuronas inquisitivas definitivamente querrán hacer esta pregunta, “¿Cómo?  Realmente, <a href="https://flashphoner.com/embedding-html5-rtsp-player-into-a-web-page/">¿cómo se puede hacer esto</a> ?  ¿Cómo se verá en el navegador? </p><br><p>  Nos gustaría llamar su atención sobre el minimalista reproductor WebRTC montado como un esfuerzo de mesa de cocina. </p><br><p>  1) Conecte el script API principal flashphoner.js y el script my_player.js, que vamos a crear un poco más tarde, a la página web. </p><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../../../flashphoner.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">my_player.js</span></span></span><span class="hljs-tag">"&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  2) Inicializar API en el cuerpo de la página web </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"init_api()"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  3) Agregue div, que servirá como contenedor para los videos, a la página.  Establezca los tamaños y el límite para ello. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myVideo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width:320px;height:240px;border: solid 1px"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  4) Agregue el botón Reproducir, al hacer clic en el cual se inicializará la conexión al servidor y comenzará a reproducir el video </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"connect()"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PLAY"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br><p>  5) Ahora creemos el script my_player.js que contendrá el código principal de nuestro reproductor.  Describir las constantes y variables. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> SESSION_STATUS = Flashphoner.constants.SESSION_STATUS; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> STREAM_STATUS = Flashphoner.constants.STREAM_STATUS; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> session;</code> </pre> <br><p>  6) Inicializar API cuando se carga una página HTML </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init_api</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"init api"</span></span>); Flashphoner.init({ }); }</code> </pre> <br><p>  7) Conéctese al servidor WCS a través de WebSocket.  Para que todo funcione correctamente, reemplace "wss: //demo.flashphoner.com" con su dirección WCS </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ session = Flashphoner.createSession({<span class="hljs-attr"><span class="hljs-attr">urlServer</span></span>: <span class="hljs-string"><span class="hljs-string">"wss://demo.flashphoner.com"</span></span>}).on(SESSION_STATUS.ESTABLISHED, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">session</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"connection established"</span></span>); playStream(session); }); }</code> </pre> <br><p>  8) Después de eso, transmita los siguientes dos parámetros, "nombre" y "pantalla", donde "nombre" es la URL RTSP de la transmisión que se está reproduciendo, y "pantalla" es el elemento de myVideo en el que se instalará nuestro reproductor.  Establezca la URL de su transmisión aquí también, en lugar de la nuestra. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">playStream</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> options = {<span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">"rtsp://b1.dnsdojo.com:1935/live/sys2.stream"</span></span>,<span class="hljs-attr"><span class="hljs-attr">display</span></span>:<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"myVideo"</span></span>)}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stream = session.createStream(options).on(STREAM_STATUS.PLAYING, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">stream</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"playing"</span></span>); }); stream.play(); }</code> </pre> <br><p>  Guarde los archivos e intente iniciar el reproductor.  ¿Se reproduce tu transmisión RTSP? </p><br><p>  Cuando lo <a href="https://flashphoner.com/testing-rtsp-html5-player/">probamos</a> , este se jugó: rtsp: //b1.dnsdojo.com: 1935 / live / sys2.stream. </p><br><p>  Y así es como se ve: </p><br><p>  Se hace clic en el jugador antes del botón Reproducir </p><br><p><img src="https://habrastorage.org/webt/pe/ej/6n/peej6nfw2lthkmmnsrypojl6bzq.png"></p><br><p>  El jugador con un video lanzado </p><br><p><img src="https://habrastorage.org/webt/w3/h8/yo/w3h8yozn6madl2tolxx_xg3yljs.png"></p><br><p>  No hay mucho código en absoluto: </p><br><p>  HTML </p><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../../../flashphoner.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">my_player.js</span></span></span><span class="hljs-tag">"&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"init_api()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myVideo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width:320px;height:240px;border: solid 1px"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"connect()"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PLAY"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Javascript </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//Status constants var SESSION_STATUS = Flashphoner.constants.SESSION_STATUS; var STREAM_STATUS = Flashphoner.constants.STREAM_STATUS; //Websocket session var session; //Init Flashphoner API on page load function init_api() { console.log("init api"); Flashphoner.init({ }); } //Connect to WCS server over websockets function connect() { session = Flashphoner.createSession({urlServer: "wss://demo.flashphoner.com"}).on(SESSION_STATUS.ESTABLISHED, function(session){ console.log("connection established"); playStream(session); }); } //Playing stream with given name and mount the stream into myVideo div element function playStream() { var options = {"rtsp://b1.dnsdojo.com:1935/live/sys2.stream",display:document.getElementById("myVideo")}; var stream = session.createStream(options).on(STREAM_STATUS.PLAYING, function(stream) { console.log("playing"); }); stream.play(); }</span></span></code> </pre> <br><p>  demo.flashphoner.com se utiliza como el lado del servidor.  El código completo del ejemplo está disponible a continuación, al pie de la página que contiene los enlaces. <br>  ¡Que tengas una transmisión agradable! </p><br><h3 id="links">  Enlaces </h3><br><p>  <a href="https://github.com/flashphoner/flashphoner_client/tree/wcs_api-2.0/examples/demo/streaming/player">Código de jugador en github</a> </p><br><p>  <a href="https://flashphoner.com/ip-camera-streaming-via-rtsp-for-webrtc-and-websocket-browsers/">Integración de un reproductor RTSP en una página web o aplicación móvil</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/479008/">https://habr.com/ru/post/479008/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../478998/index.html">¿Por qué siempre queremos ver la proporción áurea? Intento (sin éxito) de análisis evolutivo utilizando redes neuronales C ++</a></li>
<li><a href="../479000/index.html">Pasantía de Parallels cuando tienes 14 años</a></li>
<li><a href="../479002/index.html">Gamificación de procesos de negocio. Como funciona</a></li>
<li><a href="../479004/index.html">¿Es posible protegerse de los reclutadores molestos?</a></li>
<li><a href="../479006/index.html">Las crónicas del hambre del libro II</a></li>
<li><a href="../479012/index.html">SviMik: "Hay dos opiniones opuestas sobre esto en OSM"</a></li>
<li><a href="../479018/index.html">Docker para el front-end. Parte 2. ¿Qué eres?</a></li>
<li><a href="../479020/index.html">La historia de cómo Google Play tachó diez años de mi trabajo en una hora</a></li>
<li><a href="../479022/index.html">Los televisores inteligentes Samsung, LG, Vizio y TCL toman cada segundo "huellas digitales" de la pantalla y las envían al servidor</a></li>
<li><a href="../479026/index.html">Verdadera suma de canales de Internet - OpenMPTCPRouter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>