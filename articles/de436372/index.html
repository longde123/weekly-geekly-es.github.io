<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëçüèΩ üëä üóΩ Isometrisches Plugin f√ºr Unity3D üôÜüèº üìé üíáüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es ist eine Geschichte dar√ºber, wie man ein Plugin f√ºr Unity Asset Store schreibt, die bekannten isometrischen Probleme in Spielen l√∂st und damit ein ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Isometrisches Plugin f√ºr Unity3D</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436372/"><img src="https://habrastorage.org/files/032/000/6f4/0320006f472344e782f536c293e3099d.png"><br><p>  Es ist eine Geschichte dar√ºber, wie man ein Plugin f√ºr <strong>Unity Asset Store</strong> schreibt, die bekannten isometrischen Probleme in Spielen l√∂st und damit ein wenig Kaffeegeld verdient und wie man den erweiterbaren Unity-Editor versteht.  Bilder, Code, Grafiken und Gedanken im Inneren. </p><a name="habracut"></a><br><h2 id="prologue">  Prolog </h2><br><p> Es war also eine Nacht, als ich herausfand, dass ich so ziemlich nichts zu tun hatte.  Das kommende Jahr war in meinem Berufsleben nicht wirklich vielversprechend (im Gegensatz zu einem pers√∂nlichen, aber das ist eine ganz andere Geschichte).  Wie auch immer, ich hatte die Idee, etwas zu schreiben, das Spa√ü macht, um der alten Zeiten willen, das ganz pers√∂nlich w√§re, etwas f√ºr sich, aber immer noch einen kleinen kommerziellen Vorteil hat (ich mag dieses warme Gef√ºhl, wenn Ihr Projekt f√ºr jemand anderen interessant ist, au√üer f√ºr Ihren Arbeitgeber).  Und all dies ging Hand in Hand mit der Tatsache, dass ich lange darauf gewartet habe, die M√∂glichkeiten der Unity-Editor-Erweiterung zu pr√ºfen und festzustellen, ob die Plattform f√ºr den Verkauf der eigenen Erweiterungen der Engine etwas Gutes enth√§lt. </p><br><p>  Ich habe mich eines Tages dem Studium des Asset Store gewidmet: Modelle, Skripte, Integrationen mit verschiedenen Diensten.  Und zun√§chst schien alles bereits geschrieben und integriert worden zu sein, und es gab sogar eine Reihe von Optionen mit unterschiedlichen Qualit√§ts- und Detailstufen, genau wie Preise und Support.  Also habe ich es sofort eingegrenzt auf: </p><br><ul><li>  Nur Code (schlie√ülich bin ich Programmierer) </li><li>  Nur 2D (da ich 2D einfach liebe und sie in Unity eine anst√§ndige Out-of-the-Box-Unterst√ºtzung daf√ºr geleistet haben) </li></ul><br><p>  Und dann erinnerte ich mich daran, wie viele Kakteen ich gegessen habe und wie viele M√§use gestorben sind, als wir zuvor ein isometrisches Spiel gemacht haben.  Sie werden nicht glauben, wie viel Zeit wir f√ºr die Suche nach tragf√§higen L√∂sungen aufgewendet haben und wie viele Kopien wir bei den Versuchen, diese Isometrie zu sortieren und zu zeichnen, gebrochen haben.  Als ich mich bem√ºhte, meine H√§nde ruhig zu halten, suchte ich nach verschiedenen Schl√ºsselw√∂rtern und weniger Schl√ºsselw√∂rtern und konnte nichts au√üer einem riesigen Stapel isometrischer Kunst finden, bis ich mich schlie√ülich entschied, ein isometrisches Plugin von Grund auf neu zu erstellen. </p><br><h2 id="setting-the-goals">  Ziele setzen </h2><br><p>  Als erstes musste ich kurz beschreiben, welche Probleme dieses Plugin l√∂sen sollte und welchen Nutzen der Entwickler isometrischer Spiele daraus ziehen w√ºrde.  Die Isometrieprobleme sind also wie folgt: </p><br><ul><li>  Objekte nach Entfernung sortieren, um sie richtig zu zeichnen </li><li>  Erweiterung zum Erstellen, Positionieren und Verschieben von isometrischen Objekten im Editor </li></ul><br><p>  Daher habe ich mir mit den Hauptzielen f√ºr die erste formulierte Version eine Frist von 2-3 Tagen f√ºr die erste Entwurfsversion gesetzt.  Sie k√∂nnen also nicht aufschieben, da Begeisterung eine fragile Sache ist und wenn Sie in den ersten Tagen nichts bereit haben, besteht eine gro√üe Chance, dass Sie es ruinieren.  Und die Neujahrsfeiertage sind nicht so lang, wie es scheint, selbst in Russland, und ich wollte die erste Version innerhalb von etwa zehn Tagen ver√∂ffentlichen. </p><br><h2 id="sorting">  Sortieren </h2><br><p>  Kurz gesagt, Isometrie ist ein Versuch von 2D-Sprites, wie 3D-Modelle auszusehen.  Das f√ºhrt nat√ºrlich zu Dutzenden von Problemen.  Das wichtigste ist, dass die Sprites in der Reihenfolge sortiert werden m√ºssen, in der sie gezeichnet werden sollen, um Probleme mit gegenseitiger √úberlappung zu vermeiden. </p><br><img src="https://habrastorage.org/files/60f/22b/db9/60f22bdb9ed3434888232416258f4b37.png"><br><blockquote>  <em>Auf dem Screenshot k√∂nnen Sie sehen, wie zuerst das gr√ºne Sprite gezeichnet wird (2,1) und dann das blaue (1,1).</em> </blockquote><br><img src="https://habrastorage.org/files/9ba/a39/c6c/9baa39c6cd3b4584a57bbf1be169c050.png"><br><blockquote>  <em>Der Screenshot zeigt die falsche Sortierung, wenn das blaue Sprite zuerst gezeichnet wird</em> </blockquote><p>  In diesem einfachen Fall ist das Sortieren kein Problem, und es wird Optionen geben, zum Beispiel: </p><br><ul><li>  Sortieren nach Position von Y auf dem Bildschirm, die * <em>(isoX + isoY)</em> 0,5 + isoZ ** ist </li><li>  Zeichnen aus der entferntesten isometrischen Gitterzelle von links nach rechts, von oben nach unten <strong>[(3,3), (2,3), (3,2), (1,3), (2,2), (3, 1), ...]</strong> </li><li>  und eine ganze Reihe anderer interessanter und nicht wirklich interessanter Wege </li></ul><br><p>  Sie sind alle ziemlich gut, schnell und funktionieren, aber nur f√ºr solche einzelligen Objekte oder Spalten, die in isoZ-Richtung erweitert wurden :) Schlie√ülich war ich an einer allgemeineren L√∂sung interessiert, die f√ºr die Objekte funktioniert, die in Richtung einer Koordinate erweitert wurden. oder sogar die "Z√§une", die absolut keine Breite haben, aber in die gleiche Richtung wie die notwendige H√∂he verl√§ngert sind. </p><br><img src="https://habrastorage.org/files/396/376/23d/39637623d1c147478ef0223501a0d240.png"><br><blockquote>  <em>Der Screenshot zeigt die richtige Art und Weise, erweiterte Objekte <strong>3x1</strong> und <strong>1x3</strong> mit "Z√§unen" von <strong>3x0</strong> und <strong>0x3 zu sortieren</strong></em> </blockquote><p>  Und hier beginnen unsere Probleme und bringen uns an den Ort, an dem wir uns f√ºr den weiteren Weg entscheiden m√ºssen: </p><br><ul><li><p>  Teilen Sie "mehrzellige" Objekte in "einzellige" Objekte, d. h. um sie vertikal zu schneiden und dann die entstandenen Streifen zu sortieren </p><br></li><li><p>  Denken Sie an die neue Sortiermethode, die komplizierter und interessanter ist </p><br></li></ul><br><p>  Ich entschied mich f√ºr die zweite Option, da ich nicht besonders darauf aus war, jedes Objekt auf knifflige Weise zu bearbeiten, zu schneiden (sogar automatisch) und eine spezielle Herangehensweise an die Logik.  F√ºr die Aufzeichnung verwendeten sie den ersten Weg in einigen ber√ºhmten Spielen wie <strong>Fallout 1</strong> und <strong>Fallout 2</strong> .  Sie k√∂nnen diese Streifen tats√§chlich sehen, wenn Sie in die Daten der Spiele gelangen. </p><br><p>  Die zweite Option impliziert also keine Sortierkriterien.  Dies bedeutet, dass es keinen vorberechneten Wert gibt, nach dem Sie Objekte sortieren k√∂nnen.  Wenn Sie mir nicht glauben (und ich denke, viele Leute, die nie mit Isometrie gearbeitet haben, tun es nicht), nehmen Sie ein St√ºck Papier und zeichnen Sie kleine Objekte mit den Ma√üen <strong>2x8</strong> und zum Beispiel <strong>2x2</strong> .  Wenn Sie es irgendwie schaffen, einen Wert f√ºr die Berechnung seiner Tiefe und Sortierung herauszufinden, f√ºgen Sie einfach ein <strong>8x2-</strong> Objekt hinzu und versuchen Sie, sie an verschiedenen Positionen relativ zueinander zu sortieren. </p><br><p>  Es gibt also keinen solchen Wert, aber wir k√∂nnen immer noch Abh√§ngigkeiten zwischen ihnen (grob gesagt, welche √ºberlappen welche) f√ºr die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">topologische Sortierung verwenden</a> .  Wir k√∂nnen die Abh√§ngigkeiten der Objekte mithilfe von Projektionen isometrischer Koordinaten auf der isometrischen Achse berechnen. </p><br><img src="https://habrastorage.org/files/db0/1cd/835/db01cd8359494b35aaee399e197c972e.png"><br><blockquote>  <em>Der Screenshot zeigt den blauen W√ºrfel, der vom roten abh√§ngig ist</em> </blockquote><br><img src="https://habrastorage.org/files/eb3/af1/0d0/eb3af10d0cf04c6ba48a481a0b039f3c.png"><br><blockquote>  <em>Der Screenshot zeigt den gr√ºnen W√ºrfel, der vom blauen abh√§ngig ist</em> </blockquote><p>  Ein Pseudocode zur Abh√§ngigkeitsbestimmung f√ºr zwei Achsen (funktioniert auch mit der Z-Achse): </p><br><pre><code class="plaintext hljs">bool IsIsoObjectsDepends(IsoObject obj_a, IsoObject obj_b) { var obj_a_max_size = obj_a.position + obj_a.size; return obj_b.position.x &lt; obj_a_max_size.x &amp;&amp; obj_b.position.y &lt; obj_a_max_size.y; }</code> </pre> <br><p>  Mit einem solchen Ansatz bauen wir Abh√§ngigkeiten zwischen allen Objekten auf, gehen rekursiv zwischen ihnen √ºber und markieren die Z-Koordinate der Anzeige.  Die Methode ist ziemlich universell und funktioniert vor allem.  Eine ausf√ºhrliche Beschreibung dieses Algorithmus finden Sie beispielsweise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Sie verwenden diesen Ansatz auch in der beliebten isometrischen Flash-Bibliothek ( <a href="">as3isolib</a> ). </p><br><p>  Und alles war einfach gro√üartig, au√üer dass die zeitliche Komplexit√§t dieses Ansatzes <strong>O (N ^ 2) ist,</strong> da wir jedes Objekt mit jedem anderen vergleichen m√ºssen, um die Abh√§ngigkeiten zu erstellen.  Ich habe die Optimierung f√ºr sp√§tere Versionen verlassen und nur eine verz√∂gerte Neusortierung hinzugef√ºgt, damit nichts sortiert wird, bis sich etwas bewegt.  Wir werden also etwas sp√§ter √ºber die Optimierung sprechen. </p><br><h2 id="editor-extension">  Editor-Erweiterung </h2><br><p>  Von nun an hatte ich folgende Ziele: </p><br><ul><li>  Das Sortieren von Objekten musste im Editor funktionieren (nicht nur in einem Spiel) </li><li>  es musste eine andere Art von Gizmos-Pfeil geben (Pfeile zum Bewegen von Objekten) </li><li>  Optional w√ºrde es eine Ausrichtung mit Kacheln geben, wenn das Objekt bewegt wird </li><li>  Kachelgr√∂√üen werden automatisch angewendet und im isometrischen Weltinspektor festgelegt </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AABB-</a> Objekte werden entsprechend ihrer isometrischen Gr√∂√üe gezeichnet </li><li>  Ausgabe von isometrischen Koordinaten im Objektinspektor, durch √Ñndern der Position des Objekts in der Spielwelt </li></ul><br><p>  Und all diese Ziele wurden erreicht.  Unity erlaubt es wirklich, seinen Editor erheblich zu erweitern.  Sie k√∂nnen im Objektinspektor neue Registerkarten, Fenster, Schaltfl√§chen und neue Felder hinzuf√ºgen.  Wenn Sie m√∂chten, k√∂nnen Sie sogar einen benutzerdefinierten Inspektor f√ºr eine Komponente des genauen Typs erstellen, den Sie ben√∂tigen.  Sie k√∂nnen auch zus√§tzliche Informationen im Editorfenster ausgeben (in meinem Fall f√ºr AABB-Objekte) und auch Standard-Verschiebungs-Gizmos von Objekten ersetzen.  Das Problem des Sortierens im Editor wurde √ºber dieses magische <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ExecuteInEditMode-</a> Tag gel√∂st, mit dem Komponenten des Objekts im Editor-Modus ausgef√ºhrt werden k√∂nnen, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dh auf</a> dieselbe Weise wie in einem Spiel. </p><br><p>  All dies geschah nat√ºrlich nicht ohne Schwierigkeiten und Tricks aller Art, aber es gab kein einziges Problem, f√ºr das ich mehr als ein paar Stunden aufgewendet hatte (Google, Foren und Communitys haben mir sicher geholfen, alle Probleme zu l√∂sen entstanden, die in der Dokumentation nicht erw√§hnt wurden). </p><br><img src="https://habrastorage.org/files/df6/ae0/2ae/df6ae02aec294ca28d9a6ffcf1b81382.png"><br><blockquote>  <em>Der Screenshot zeigt meine Gizmos f√ºr Bewegungsobjekte in der isometrischen Welt</em> </blockquote><br><h2 id="release">  Lassen Sie los </h2><br><p>  Also habe ich die erste Version fertig gemacht und den Screenshot gemacht.  Ich habe sogar ein Symbol gezeichnet und eine Beschreibung geschrieben.  Es ist Zeit.  Also habe ich einen Nominalpreis von 5 US-Dollar festgelegt, das Plugin in den Store hochgeladen und darauf gewartet, dass es von Unity genehmigt wird.  Ich habe nicht viel √ºber den Preis nachgedacht, da ich noch nicht wirklich viel Geld verdienen wollte.  Mein Ziel war es herauszufinden, ob es eine allgemeine Nachfrage gibt, und wenn ja, w√ºrde ich sie gerne sch√§tzen.  Au√üerdem wollte ich Entwicklern von isometrischen Spielen helfen, denen es irgendwie an M√∂glichkeiten und Erg√§nzungen mangelte. </p><br><p>  In 5 ziemlich schmerzhaften Tagen (ich habe ungef√§hr die gleiche Zeit damit verbracht, die erste Version zu schreiben, aber ich wusste, was ich tat, ohne mich weiter zu wundern und zu √ºberdenken, was mir die h√∂here Geschwindigkeit im Vergleich zu Leuten gab, die gerade angefangen hatten, mit Isometrie zu arbeiten) Ich erhielt eine Antwort von Unity, dass das Plugin genehmigt wurde und ich es bereits im Laden sehen konnte, genauso wie seine (bisher) null Verk√§ufe.  Es hat im lokalen Forum eingecheckt, Google Analytics in die Seite des Plugins im Store integriert und mich darauf vorbereitet, darauf zu warten, dass das Gras w√§chst. </p><br><p>  Es dauerte nicht lange bis zum ersten Verkauf, als die R√ºckmeldungen im Forum und im Laden auftauchten.  F√ºr die verbleibenden Tage des 12. Januar wurden Kopien meines Plugins verkauft, was ich als Zeichen des √∂ffentlichen Interesses betrachtete und beschloss, fortzufahren. </p><br><h2 id="optimization">  Optimierung </h2><br><p>  Ich war also mit zwei Dingen unzufrieden: </p><br><ul><li>  Zeitliche Komplexit√§t der Sortierung - O (N ^ 2) </li><li>  Probleme mit der Speicherbereinigung und der allgemeinen Leistung </li></ul><br><h3 id="algorithm">  Algorithmus </h3><br><p>  Mit 100 Objekten und O (N ^ 2) musste ich 10.000 Iterationen durchf√ºhren, um Abh√§ngigkeiten zu finden. Au√üerdem musste ich alle √ºbergeben und die Anzeige Z zum Sortieren markieren.  Daf√ºr h√§tte es eine L√∂sung geben sollen.  Also habe ich eine Vielzahl von Optionen ausprobiert und konnte nicht schlafen, wenn ich √ºber dieses Problem nachdachte.  Wie auch immer, ich werde Ihnen nicht alle Methoden erz√§hlen, die ich ausprobiert habe, aber ich werde die beschreiben, die ich bisher am besten gefunden habe. </p><br><p>  Als erstes sortieren wir nat√ºrlich nur sichtbare Objekte.  Was es bedeutet ist, dass wir st√§ndig wissen m√ºssen, was in unserem Schuss ist.  Wenn es ein neues Objekt gibt, m√ºssen wir es beim Sortieren hinzuf√ºgen, und wenn eines der alten verschwunden ist, ignorieren Sie es.  Jetzt erlaubt Unity nicht, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Begrenzungsbox</a> des Objekts zusammen mit seinen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">untergeordneten Elementen</a> im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Szenenbaum</a> zu bestimmen.  √úbergeben Sie die Kinder (√ºbrigens jedes Mal, da sie hinzugef√ºgt und entfernt werden k√∂nnen) w√ºrde nicht funktionieren - zu langsam.  Wir k√∂nnen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OnBecameVisible</a> und andere Ereignisse auch nicht verwenden, da diese nur f√ºr √ºbergeordnete Objekte funktionieren.  Wir k√∂nnen jedoch alle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Renderer-</a> Komponenten aus dem erforderlichen Objekt und seinen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">untergeordneten</a> Objekten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">abrufen</a> .  Nat√ºrlich klingt es nicht nach unserer besten Option, aber ich konnte keinen anderen Weg finden, der universell und von der Leistung her akzeptabel ist. </p><br><pre> <code class="plaintext hljs">List&lt;Renderer&gt; _tmpRenderers = new List&lt;Renderer&gt;(); bool IsIsoObjectVisible(IsoObject iso_object) { iso_object.GetComponentsInChildren&lt;Renderer&gt;(_tmpRenderers); for ( var i = 0; i &lt; _tmpRenderers.Count; ++i ) { if ( _tmpRenderers[i].isVisible ) { return true; } } return false; }</code> </pre> <br><p>  <em>Es gibt einen kleinen Trick bei der Verwendung der <strong>GetComponentsInChildren-</strong> Funktion, mit der Komponenten ohne Zuordnung im erforderlichen Puffer <strong>abgerufen</strong> werden k√∂nnen, im Gegensatz zu einer anderen, die ein neues Array von Komponenten zur√ºckgibt</em> </p><br><p>  Zweitens musste ich noch etwas gegen <strong>O (N ^ 2)</strong> unternehmen.  Ich habe eine Reihe von Raumaufteilungstechniken ausprobiert, bevor ich an einem einfachen zweidimensionalen Gitter im Anzeigebereich anhielt, in dem ich meine isometrischen Objekte projiziere.  Jeder solche Sektor enth√§lt eine Liste von isometrischen Objekten, die ihn kreuzen.  Die Idee ist also einfach: Wenn Projektionen der Objekte nicht gekreuzt werden, macht es keinen Sinn, Abh√§ngigkeiten zwischen den Objekten aufzubauen.  Dann √ºbergehen wir alle sichtbaren Objekte und bauen Abh√§ngigkeiten nur in den Sektoren auf, in denen dies erforderlich ist, wodurch die zeitliche Komplexit√§t des Algorithmus verringert und die Leistung erh√∂ht wird.  Wir berechnen die Gr√∂√üe jedes Sektors als Durchschnitt zwischen den Gr√∂√üen aller Objekte.  Ich fand das Ergebnis mehr als zufriedenstellend. </p><br><h3 id="general-performance">  Allgemeine Leistung </h3><br><p>  Nat√ºrlich k√∂nnte ich einen separaten Artikel dazu schreiben ... Okay, versuchen wir es kurz zu machen.  Zuerst kassieren wir die Komponenten (wir verwenden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GetComponent</a> , um sie zu finden, was nicht schnell ist).  Ich empfehle jedem, sich selbst zu beobachten, wenn er mit etwas arbeitet, das mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Update</a> zu tun hat.  Sie m√ºssen immer bedenken, dass dies bei jedem Frame der Fall ist, daher m√ºssen Sie sehr vorsichtig sein. Denken Sie auch an alle interessanten Funktionen wie den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Operator custom ==</a> .  Es gibt viel zu beachten, aber am Ende lernen Sie jeden einzelnen davon im eingebauten Profiler kennen.  Es macht es viel einfacher, sie auswendig zu lernen und zu benutzen :) </p><br><p>  Au√üerdem lernst du den Schmerz des M√ºllsammlers wirklich verstehen.  Ben√∂tigen Sie eine h√∂here Leistung?  Vergessen Sie dann alles, was Speicher zuweisen kann, was in <strong>C #</strong> (insbesondere im alten <strong>Mono-</strong> Compiler) von allem ausgef√ºhrt werden kann, von <strong>foreach</strong> (!) Bis zu aufkommenden Lambdas, geschweige denn <strong>LINQ,</strong> das Ihnen jetzt selbst in den einfachsten F√§llen verboten ist.  Am Ende erh√§lt man anstelle von <strong>C #</strong> mit seinem syntaktischen Zucker einen Anschein von <strong>C</strong> mit l√§cherlichen F√§higkeiten. </p><br><p>  Hier werde ich einige Links zu dem Thema geben, das Sie vielleicht hilfreich finden: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil2</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil3</a> . </p><br><h3 id="results">  Ergebnisse </h3><br><p>  Ich habe noch nie jemanden gekannt, der diese Optimierungstechnik verwendet, daher war ich besonders froh, die Ergebnisse zu sehen.  Und wenn in den ersten Versionen buchst√§blich 50 sich bewegende Objekte ben√∂tigt wurden, um das Spiel in eine Diashow umzuwandeln, funktioniert es jetzt ziemlich gut, selbst wenn sich 800 Objekte in einem Frame befinden: Alles dreht sich mit H√∂chstgeschwindigkeit und wird nur f√ºr neu sortiert 3-6 ms, was f√ºr diese Anzahl von Objekten in der Isometrie sehr gut ist.  Au√üerdem hat es nach der Initialisierung fast keinen Speicher f√ºr einen Frame zugewiesen :) </p><br><h2 id="further-opportunities">  Weitere M√∂glichkeiten </h2><br><p>  Nachdem ich Feedbacks und Vorschl√§ge gelesen hatte, gab es einige Funktionen, die ich in fr√ºheren Versionen hinzugef√ºgt habe. </p><br><h3 id="2d3d-mixture">  2D / 3D-Mischung </h3><br><p>  Das Mischen von 2D und 3D in isometrischen Spielen ist eine interessante M√∂glichkeit, um das Zeichnen verschiedener Bewegungs- und Rotationsoptionen (z. B. 3D-Modelle animierter Charaktere) zu minimieren.  Es ist nicht wirklich schwer, erfordert aber die Integration in das Sortiersystem.  Alles, was Sie brauchen, ist, eine <strong>Begrenzungsbox</strong> des Modells mit all seinen <strong>untergeordneten Elementen</strong> zu erhalten und das Modell dann um die Breite der Box entlang der Anzeige Z zu verschieben. </p><br><pre> <code class="plaintext hljs">Bounds IsoObject3DBounds(IsoObject iso_object) { var bounds = new Bounds(); iso_object.GetComponentsInChildren&lt;Renderer&gt;(_tmpRenderers); if ( _tmpRenderers.Count &gt; 0 ) { bounds = _tmpRenderers[0].bounds; for ( var i = 1; i &lt; _tmpRenderers.Count; ++i ) { bounds.Encapsulate(_tmpRenderers[i].bounds); } } return bounds; }</code> </pre> <br><p>  <em>Dies ist ein Beispiel daf√ºr, wie Sie <strong>Bounding Box</strong> des Modells mit all seinen Kindern erhalten k√∂nnen</em> </p><br><img src="https://habrastorage.org/files/837/b52/c02/837b52c025b6485c95ede6c77a5b4ed3.gif"><br><blockquote>  <em>und so sieht es aus, wenn es fertig ist</em> </blockquote><br><h3 id="custom-isometric-settings">  Benutzerdefinierte isometrische Einstellungen </h3><br><p>  Das ist relativ einfach.  Ich wurde gebeten, die Einstellung des isometrischen Winkels, des Seitenverh√§ltnisses und der Fliesenh√∂he zu erm√∂glichen.  Nachdem Sie einige mathematische Schmerzen erlitten haben, erhalten Sie ungef√§hr Folgendes: </p><br><img src="https://habrastorage.org/files/02b/f56/35e/02bf5635e5df46778915d43caf2bd846.gif"><br><br><h3 id="physics">  Physik </h3><br><p>  Und hier wird es interessanter.  Da die Isometrie die 3D-Welt simuliert, soll die Physik auch dreidimensional sein, mit H√∂he und allem.  Ich habe mir diesen faszinierenden Trick ausgedacht.  Ich repliziere alle Komponenten der Physik wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rigidbody</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Collider</a> usw. f√ºr die isometrische Welt.  Nach diesen Beschreibungen und Einstellungen erstelle ich die Kopie der unsichtbaren physischen dreidimensionalen Welt mit der Engine selbst und dem eingebauten <strong>PhysX</strong> .  Danach nehme ich die berechneten Simulationsdaten und erhalte diese Bacl in duplizierenden Komponenten f√ºr die isometrische Welt.  Dann mache ich dasselbe, um St√∂√üe zu simulieren und Ereignisse auszul√∂sen. </p><br><img src="https://habrastorage.org/files/56c/c0b/199/56cc0b19987043bbb94baa257879b224.gif"><br><blockquote>  <em>Das Toolset physische Demo GIF</em> </blockquote><br><h2 id="epilogue-and-conclusions">  Nachwort und Schlussfolgerungen </h2><br><p>  Nachdem ich alle Vorschl√§ge aus dem Forum umgesetzt hatte, beschloss ich, den Preis auf 40 Dollar zu erh√∂hen, damit es nicht wie ein weiteres billiges Plugin mit f√ºnf Codezeilen aussieht :) Ich werde mich sehr freuen, Fragen zu beantworten und H√∂re auf deine Ratschl√§ge.  Da es das erste Mal ist, dass ich etwas √ºber Habr schreibe, begr√º√üe ich jede Art von Kritik, danke!  Und jetzt etwas, das ich zuletzt gespeichert habe, die Umsatzstatistik des Monats: </p><br><table border="1" width="200"><tbody><tr><th>  Monat </th><th>  5 $ </th><th>  40 $ </th></tr><tr><td>  Januar </td><td>  12 </td><td>  0 </td></tr><tr><td>  Februar </td><td>  22 </td><td>  0 </td></tr><tr><td>  M√§rz </td><td>  17 </td><td>  0 </td></tr><tr><td>  April </td><td>  9 </td><td>  0 </td></tr><tr><td>  Mai </td><td>  9 </td><td>  0 </td></tr><tr><td>  Juni </td><td>  9 </td><td>  0 </td></tr><tr><td>  Juli </td><td>  7 </td><td>  4 </td></tr><tr><td>  August </td><td>  0 </td><td>  4 </td></tr><tr><td>  September </td><td>  0 </td><td>  5 </td></tr></tbody></table><br><p>  Link zur Seite der Unity Asset Store: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Isometric 2.5D Toolset</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de436372/">https://habr.com/ru/post/de436372/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de436356/index.html">[Interessant hinter dem H√ºgel] Wie stoppen wir die technologische Abh√§ngigkeit?</a></li>
<li><a href="../de436358/index.html">Warum unterrichten √§ltere Entwickler Sch√ºler?</a></li>
<li><a href="../de436360/index.html">Ich muss schnell gehen: Auf Geschwindigkeit in iOS bauen. Teil 1</a></li>
<li><a href="../de436364/index.html">Liveprof zeigt an, wann und warum sich die Leistung Ihrer PHP-Anwendung ge√§ndert hat</a></li>
<li><a href="../de436370/index.html">Infrastruktur f√ºr √∂ffentliche Schl√ºssel X509 v.3 Stammzertifikatskette</a></li>
<li><a href="../de436374/index.html">Designtrends f√ºr UI und UX 2019</a></li>
<li><a href="../de436376/index.html">√úbersicht √ºber den Gel√§nderoboter EZ-Robot Roli Rover</a></li>
<li><a href="../de436378/index.html">bobaos.pub - KNX TP / UART, Raspberry Pi und Redis</a></li>
<li><a href="../de436380/index.html">Schneller Einstieg in den 3D-Druck: Budgetdrucker f√ºr Anf√§nger oder Technik f√ºr die breite Masse</a></li>
<li><a href="../de436382/index.html">Antiquit√§ten: Zehn Jahre Laptop-Evolution mit dem ThinkPad X301</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>