<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§üüèΩ üçø üéÑ Deep Reinforcement Learning: Wie man Spinnen das Laufen beibringt üëéüèª üé¨ üè®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Heute werde ich Ihnen erz√§hlen, wie ich Verst√§rkungs-Deep-Learning-Algorithmen zur Steuerung eines Roboters angewendet habe. Kurz gesagt, ich erkl√§re ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Deep Reinforcement Learning: Wie man Spinnen das Laufen beibringt</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483078/"><iframe width="560" height="315" src="https://www.youtube.com/embed/rxWmEnWR3jw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Heute werde ich Ihnen erz√§hlen, wie ich Verst√§rkungs-Deep-Learning-Algorithmen zur Steuerung eines Roboters angewendet habe.  Kurz gesagt, ich erkl√§re Ihnen, wie Sie eine "Black Box mit neuronalen Netzen" erstellen, die die Roboterarchitektur am Eingang akzeptiert und einen Algorithmus ausgibt, der sie am Ausgang steuern kann. </p><br><p>  Der Kern der L√∂sung ist der <b>Advantage Actor Critic</b> (A2C) -Algorithmus mit <b>Advantage-</b> Scores durch die <b>Generalized Advantage Estimation</b> (GAE). </p><br><p>  Im Endeffekt Mathematik, eine TensorFlow-Implementierung und viele Demos, auf welche Art von Laufalgorithmen es ankam. </p><br><a name="habracut"></a><p>  Inhalt: </p><br>  - <a href="https://habr.com/ru/post/483078/">Herausforderung</a> <br>  - <a href="https://habr.com/ru/post/483078/">Warum Reinforcement Learning?</a> <br>  - <a href="https://habr.com/ru/post/483078/">Erkl√§rung des Verst√§rkungslernens</a> <br>  - <a href="https://habr.com/ru/post/483078/">politisches Gef√§lle</a> <br>  - <a href="https://habr.com/ru/post/483078/">Diagonale Gau√üsche Politik</a> <br>  - <a href="https://habr.com/ru/post/483078/">Reduzieren Sie die Varianz durch Hinzuf√ºgen von Kritik</a> <br>  - <a href="https://habr.com/ru/post/483078/">Fallstricke</a> <br><p>  - <a href="https://habr.com/ru/post/483078/">Fazit</a> </p><br><a name="problem"></a><h2>  Herausforderung </h2><br><p>  In diesem Artikel bringen wir dem Roboter das Gehen in der MuJoCo-Simulation bei.  Wir √ºberspringen die Beschreibung des Schritts mit der Erstellung eines Modells des Roboters und der Python-Schnittstelle zur Umgebung, weil  da ist nichts interessantes.  Um dies zu verstehen, schauen Sie sich einfach die Demos in MuJoCo selbst und die Quellen der MuJoCo-Umgebungen in <a href="https://gym.openai.com/envs/">Gym OpenAI an</a> . </p><br><p>  Am Eingang hat der Agent viele Zahlen von MuJoCo: relative Positionen, Drehwinkel, Geschwindigkeit, Beschleunigung von K√∂rperteilen des Roboters usw.  Insgesamt liegt die Gr√∂√üenordnung bei ~ 800 Features.  Wir verwenden den Deep Learning-Ansatz und werden nicht verstehen, was sie tats√§chlich bedeuten.  Die Hauptsache ist, dass in diesem Satz von Zahlen gen√ºgend Informationen vorhanden sind, damit der Agent verstehen kann, was mit ihm geschieht. </p><br><p>  Am Ausgang erwarten wir 18 Zahlen - die Anzahl der Freiheitsgrade des Roboters, dh die Drehwinkel der Scharniere, an denen die Gliedma√üen befestigt sind. </p><br><p>  Schlie√ülich ist es das Ziel des Agenten, die Gesamtbelohnung f√ºr die Episode zu maximieren.  Wir beenden die Episode, wenn der Roboter abst√ºrzt oder wenn 3000 Schritte vergangen sind (15 Sekunden).  Bei jedem Schritt wird der Agent gem√§√ü der folgenden Formel belohnt: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="noError" id="MJXp-Span-2" style="display: inline-block;">\&nbsp;newcommand&nbsp;{\&nbsp;E}&nbsp;{\&nbsp;mathop&nbsp;{\&nbsp;mathbb&nbsp;{E}}&nbsp;\&nbsp;newcommand&nbsp;{\&nbsp;R}&nbsp;{\&nbsp;mathop&nbsp;{\&nbsp;mathbb&nbsp;{R}}}&nbsp;r_t&nbsp;=&nbsp;\&nbsp;Delta&nbsp;x&nbsp;*&nbsp;1000&nbsp;+&nbsp;0,5</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><span class="noError" style="display: inline-block;">\&nbsp;newcommand&nbsp;{\&nbsp;E}&nbsp;{\&nbsp;mathop&nbsp;{\&nbsp;mathbb&nbsp;{E}}&nbsp;\&nbsp;newcommand&nbsp;{\&nbsp;R}&nbsp;{\&nbsp;mathop&nbsp;{\&nbsp;mathbb&nbsp;{R}}}&nbsp;r_t&nbsp;=&nbsp;\&nbsp;Delta&nbsp;x&nbsp;*&nbsp;1000&nbsp;+&nbsp;0,5</span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ newcommand {\ E} {\ mathop {\ mathbb {E}} \ newcommand {\ R} {\ mathop {\ mathbb {R}}} r_t = \ Delta x * 1000 + 0,5 </script></p><p>  Das hei√üt  Das Ziel des Agenten erh√∂ht seine Koordinate <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> x </script>  und nicht bis zum Ende der Episode fallen. </p><br><p>  Die Aufgabe ist also gestellt: <b>die Funktion</b> zu <b>finden</b> <math> </math><b><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mtext" id="MJXp-Span-6">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">i</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-10">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-13" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-14">800</span></span></span><span class="MJXp-mtext" id="MJXp-Span-15">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">s</span><span class="MJXp-mtext" id="MJXp-Span-19">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-22" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-23">18</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.225ex" height="2.78ex" viewBox="0 -935.7 7416.1 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMATHI-69" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMAIN-3A" x="1376" y="0"></use><g transform="translate(2183,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMATHI-52" x="0" y="0"></use><g transform="translate(759,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMAIN-38"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMAIN-30" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMAIN-30" x="1001" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMATHI-62" x="4354" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMATHI-69" x="4783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMATHI-73" x="5129" y="0"></use><g transform="translate(5848,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMATHI-52" x="0" y="0"></use><g transform="translate(759,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700019,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiONEn8-1jDRxdkd__GZ-w-JPwbWQ#MJMAIN-38" x="500" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> \ pi: \ R ^ {800} \ bis \ R ^ {18} </script></b>   <b>wof√ºr die Belohnung f√ºr die Folge die gr√∂√üte sein wird</b> .  Das klingt nicht sehr richtig?  :) Mal sehen, wie <b>Deep Reinforcement Learning</b> diese Aufgabe <b>√ºbernimmt</b> . </p><br><a name="why-rl"></a><h2>  Warum Reinforcement Learning? </h2><br><p>  Moderne Ans√§tze zur L√∂sung des Bewegungsproblems von Laufrobotern bestehen aus klassischen Roboterpraktiken aus den Abschnitten <b>optimale Steuerung</b> und Bahnoptimierung: LQR, QP, konvexe Optimierung.  Lesen Sie mehr: <a href="https://dspace.mit.edu/handle/1721.1/110533">Boston Dynamics-Teambeitrag auf Atlas</a> . </p><br><p>  Diese Techniken stellen eine Art ‚ÄûHardcoding‚Äú dar, da viele Details der Aufgabe direkt in den Steuerungsalgorithmus eingegeben werden m√ºssen.  Sie enthalten keine Lernsysteme - die Optimierung erfolgt ‚Äûvor Ort‚Äú. </p><br><p>  Andererseits erfordert Reinforcement Learning (im Folgenden RL) keine Hypothesen im Algorithmus, wodurch die L√∂sung des Problems allgemeiner und skalierbarer wird. </p><br><a name="rl-formulation"></a><h2>  Erkl√§rung des Verst√§rkungslernens </h2><br><img src="https://habrastorage.org/webt/i8/gl/yf/i8glyfujascwmexl2qu6sypmpt0.png"><br><p>  <a href="https://simple.wikipedia.org/wiki/Reinforcement_learning"><i>Quelle</i></a> </p><br><p>  In dem RL-Problem betrachten wir die Interaktion des Agenten und der Umgebung als eine Folge von Paaren <b>(Zustand, Belohnung)</b> und die √úberg√§nge zwischen ihnen - <b>Aktion</b> . </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-24"><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-26"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-28" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-30">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">w</span><span class="MJXp-mrow" id="MJXp-Span-42"><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-45" style="vertical-align: -0.4em;">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-51"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-53" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-55">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">w</span><span class="MJXp-mrow" id="MJXp-Span-67"><span class="MJXp-msubsup" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-70" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-71">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mtext" id="MJXp-Span-75">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">w</span><span class="MJXp-mrow" id="MJXp-Span-87"><span class="MJXp-msubsup" id="MJXp-Span-88"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-90" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">n</span><span class="MJXp-mo" id="MJXp-Span-92">‚àí</span><span class="MJXp-mn" id="MJXp-Span-93">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-97" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-101" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> (s_0) \ xrightarrow {a_0} (s_1, r_1) \ xrightarrow {a_ {1}} ... \ xrightarrow {a_ {n-1}} (s_n, r_n) </script></p><p>  Definieren Sie die Terminologie: </p><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-103"><span class="MJXp-mtext" id="MJXp-Span-104">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">i</span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-110" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-111"><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-115" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-5"> \ pi (a_t | s_t) </script>  - <b>Politik</b> , Verhaltensstrategie des Agenten, bedingte Wahrscheinlichkeit, </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-117"><span class="MJXp-msubsup" id="MJXp-Span-118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-120" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mtext" id="MJXp-Span-121">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">m</span><span class="MJXp-mtext" id="MJXp-Span-125">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">i</span><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-129">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">t</span><span class="MJXp-mrow" id="MJXp-Span-134"><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-138" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-6"> a_t \ sim \ pi (\ cdot | s_t) </script>  - <b>Aktion wird</b> als Zufallsvariable aus der Verteilung betrachtet <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-140"><span class="MJXp-mtext" id="MJXp-Span-141">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> \ pi </script>  , <br>  <i>Wir k√∂nnten Politik als eine Funktion betrachten</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-144"><span class="MJXp-mtext" id="MJXp-Span-145">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">i</span><span class="MJXp-mo" id="MJXp-Span-148" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">s</span><span class="MJXp-mtext" id="MJXp-Span-155">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> \ pi: States \ to Actions </script></i>   <i>, aber wir wollen Agentenaktionen stochastisch machen, was die <b>Erkundung</b> erleichtert.</i>  <i>Das hei√üt</i>  <i>Mit einiger Wahrscheinlichkeit tun wir nicht ganz die Aktionen, die der Agent ausw√§hlt.</i> </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-165"><span class="MJXp-mtext" id="MJXp-Span-166">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> \ tau </script>  - Vom Agenten verfolgte Flugbahn, Sequenz <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-174" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-178" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-186" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> (s_1, s_2, ..., s_n) </script>  . </li></ul><br><p>  Der Agent hat die Aufgabe, die <b>erwartete Rendite</b> zu maximieren: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">J</span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-191">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">i</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-196">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-199" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-200">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">u</span><span class="MJXp-mtext" id="MJXp-Span-204">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">m</span><span class="MJXp-mtext" id="MJXp-Span-208">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">R</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-214">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">u</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-221">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-224" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-225">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">u</span><span class="MJXp-mtext" id="MJXp-Span-229">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">m</span><span class="MJXp-mtext" id="MJXp-Span-233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-236">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">t</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-242">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">u</span><span class="MJXp-msubsup" id="MJXp-Span-245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">t</span><span class="MJXp-mo" id="MJXp-Span-249">=</span><span class="MJXp-mn" id="MJXp-Span-250">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-254" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mtext" id="MJXp-Span-255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">t</span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> J (\ pi) = \ E _ {\ tau \ sim \ pi} [R (\ tau)] = \ E _ {\ tau \ sim \ pi} \ left [\ sum_ {t = 0} ^ n r_t \ right ] </script></p><p>  Nun k√∂nnen wir das RL-Problem formulieren und finden: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-262"><span class="MJXp-mtext" id="MJXp-Span-263">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">p</span><span class="MJXp-msubsup" id="MJXp-Span-265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-267" style="vertical-align: 0.5em;">‚àó</span></span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">g</span><span class="MJXp-mtext" id="MJXp-Span-272">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">p</span><span class="MJXp-msubsup" id="MJXp-Span-279"><span class="MJXp-mrow" id="MJXp-Span-280" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">x</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-284" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">J</span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-289">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">i</span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> \ pi ^ * = arg \ mathop {max} _ \ pi J (\ pi) </script></p><p>  wo <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-293"><span class="MJXp-mtext" id="MJXp-Span-294">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">p</span><span class="MJXp-msubsup" id="MJXp-Span-296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-298" style="vertical-align: 0.5em;">‚àó</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> \ pi ^ * </script>  Ist die optimale Politik. </p><br><p>  Lesen Sie mehr im Material von OpenAI: <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro.html">OpenAI Spinning Up</a> . </p><br><a name="policy-gradient"></a><h2>  Gradient der Politik </h2><br><p>  Es ist bemerkenswert, dass eine rigorose Darstellung des RL-Problems als Optimierungsproblem uns die M√∂glichkeit gibt, die bereits bekannten Optimierungsmethoden, beispielsweise <b>Gradientenabstieg,</b> anzuwenden.  Stellen Sie sich vor, wie cool es w√§re, wenn wir <b>den erwarteten Renditegradienten nach Modellparametern berechnen</b> k√∂nnten: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-299"><span class="MJXp-mtext" id="MJXp-Span-300">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">l</span><span class="MJXp-msubsup" id="MJXp-Span-305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-307" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">J</span><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-315">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">p</span><span class="MJXp-msubsup" id="MJXp-Span-317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-319" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">a</span><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> \ nabla_ \ theta J (\ pi_ \ theta) </script>  .  In diesem Fall w√§re die Regel zur Aktualisierung der Waage einfach: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-326"><span class="MJXp-mtext" id="MJXp-Span-327">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">a</span><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-334">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">t</span><span class="MJXp-msubsup" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-341" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">d</span></span></span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-346">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">a</span><span class="MJXp-mtext" id="MJXp-Span-352">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">l</span><span class="MJXp-msubsup" id="MJXp-Span-357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-359" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">J</span><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-367">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">p</span><span class="MJXp-msubsup" id="MJXp-Span-369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-371" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">a</span><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-15"> \ theta = \ theta_ {old} + \ alpha \ nabla_ \ theta J (\ pi_ \ theta) </script></p><p>  Dies ist genau die Idee aller Methoden mit <b>politischem Gef√§lle</b> .  Der strikte Abschluss dieses Gef√§lles ist etwas hardcore.  Wir werden es hier nicht schreiben, sondern einen Link zu dem <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro3.html">wunderbaren Material von OpenAI</a> hinterlassen.  Der Farbverlauf sieht folgenderma√üen aus: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-378"><span class="MJXp-mtext" id="MJXp-Span-379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">l</span><span class="MJXp-msubsup" id="MJXp-Span-384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-386" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">J</span><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-394">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">p</span><span class="MJXp-msubsup" id="MJXp-Span-396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-398" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">a</span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-406">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-409" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-410">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">u</span><span class="MJXp-mtext" id="MJXp-Span-414">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">m</span><span class="MJXp-mtext" id="MJXp-Span-418">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">p</span><span class="MJXp-msubsup" id="MJXp-Span-420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-422" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-428">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">t</span><span class="MJXp-mo" id="MJXp-Span-433" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-434">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">u</span><span class="MJXp-msubsup" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">t</span><span class="MJXp-mo" id="MJXp-Span-441">=</span><span class="MJXp-mn" id="MJXp-Span-442">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-444">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">l</span><span class="MJXp-msubsup" id="MJXp-Span-449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-451" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">a</span><span class="MJXp-mtext" id="MJXp-Span-457">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">g</span><span class="MJXp-mtext" id="MJXp-Span-461">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">p</span><span class="MJXp-msubsup" id="MJXp-Span-463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-465" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">a</span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-474" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-475"><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-479" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">R</span><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-483">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">u</span><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-488">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">t</span><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> \ nabla_ \ theta J (\ pi_ \ theta) = \ E _ {\ tau \ sim \ pi_ \ theta} \ left [\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) R (\ tau) \ right] </script></p><p>  Der <b>Verlust</b> unseres Modells wird also so aussehen: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">s</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-502">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">g</span><span class="MJXp-mo" id="MJXp-Span-506" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-507">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">p</span><span class="MJXp-msubsup" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-511" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">a</span><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-520" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-521"><span class="MJXp-mo" id="MJXp-Span-522" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-525" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-527" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">R</span><span class="MJXp-mo" id="MJXp-Span-529" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-530">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">u</span><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-17"> loss = - \ log (\ pi_ \ theta (a_t | s_t)) R (\ tau) </script></p><p>  Daran erinnern <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">R</span><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-538">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">u</span><span class="MJXp-mo" id="MJXp-Span-542" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-543" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-544">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">u</span><span class="MJXp-msubsup" id="MJXp-Span-547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">t</span><span class="MJXp-mo" id="MJXp-Span-551">=</span><span class="MJXp-mn" id="MJXp-Span-552">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-556" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> R (\ tau) = \ sum_ {t = 0} ^ T r_t </script>  und <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-557"><span class="MJXp-mtext" id="MJXp-Span-558">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">p</span><span class="MJXp-msubsup" id="MJXp-Span-560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-562" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">a</span><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-571" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-572"><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-576" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> \ pi_ \ theta (a_t | s_t) </script>  - Dies ist die Ausgabe unseres Modells zu dem Zeitpunkt, als sie in war <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-578"><span class="MJXp-msubsup" id="MJXp-Span-579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-581" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> s_t </script>  .  Das Minus erschien aufgrund der Tatsache, dass wir maximieren wollen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">J</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> J </script>  .  W√§hrend des Trainings werden wir den Gradienten von Chargen ber√ºcksichtigen und diese addieren, um die <b>Varianz</b> (Datenrauschen aufgrund einer stochastischen Umgebung) zu verringern. </p><br><p>  Dies ist ein Arbeitsalgorithmus namens <b>REINFORCE</b> .  Und er wei√ü, wie man L√∂sungen f√ºr einfache Umgebungen findet.  Zum Beispiel <a href="https://gym.openai.com/envs/CartPole-v1/">"CartPole-v1"</a> . </p><br><p>  Betrachten Sie den Agent-Code: </p><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActorNetworkDiscrete</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">20</span></span>, activation=tf.nn.relu) output_linear = tf.layers.dense(l1, units=action_space) output = tf.nn.softmax(output_linear) self.action_op = tf.squeeze(tf.multinomial(logits=output_linear,num_samples=<span class="hljs-number"><span class="hljs-number">1</span></span>), axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Training output_log = tf.nn.log_softmax(output_linear) self.weight_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.action_ph = tf.placeholder(shape=[None], dtype=tf.int32) action_one_hot = tf.one_hot(self.action_ph, action_space) responsible_output_log = tf.reduce_sum(output_log * action_one_hot, axis=1) self.loss = -tf.reduce_mean(responsible_output_log * self.weight_ph) optimizer = tf.train.AdamOptimizer(learning_rate=actor_learning_rate) self.update_op = optimizer.minimize(self.loss) actor = ActorNetworkDiscrete()</span></span></code> </pre> <br><p>  Wir haben ein kleines Perceptron dieser Architektur: (observation_space, 10, action_space) [f√ºr CartPole ist dies (4, 10, 2)].  <b>Mit tf.multinomial</b> k√∂nnen <b>Sie</b> eine zuf√§llig gewichtete Aktion ausw√§hlen.  Um eine Aktion zu erhalten, m√ºssen Sie Folgendes aufrufen: </p><br><pre> <code class="python hljs">action = sess.run(actor.action_op, feed_dict={actor.state_ph: observation})</code> </pre><br><p>  Und so werden wir ihn trainieren: </p><br><pre> <code class="python hljs">batch_generator = generate_batch(environments, batch_size=batch_size) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tqdm_notebook(range(epochs_number)): batch = next(batch_generator) <span class="hljs-comment"><span class="hljs-comment"># Remainder: batch item consists of [state, action, total reward] # Train actor _, actor_loss = sess.run([actor.update_op, actor.loss], feed_dict={actor.state_ph: batch[:, 0], actor.action_ph: batch[:, 1], actor.weight_ph: batch[:, 2]})</span></span></code> </pre><br><p>  Der Stapelgenerator f√ºhrt den Agenten in der Umgebung aus und sammelt Daten f√ºr das Training.  Elemente der Charge sind Tupel dieser Art: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-584"><span class="MJXp-mo" id="MJXp-Span-585" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-588" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-592" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">R</span><span class="MJXp-mo" id="MJXp-Span-595" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-596">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">u</span><span class="MJXp-mo" id="MJXp-Span-600" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> (s_t, a_t, R (\ tau)) </script>  . </p><br><p>  Das Schreiben eines guten Generators ist eine separate Aufgabe, bei der die Hauptschwierigkeit die relativ hohen Kosten f√ºr den Aufruf von <b>sess.run () im</b> Vergleich zu einem einzelnen Simulationsschritt (sogar MuJoCo) sind.  Um die Arbeit zu beschleunigen, k√∂nnen Sie die Tatsache ausnutzen, dass neuronale Netzwerke stapelweise ausgef√ºhrt werden und viele parallele Umgebungen verwenden.  <b>Selbst wenn Sie sie nacheinander in einem Thread starten, wird die Beschleunigung im Vergleich zu einer einzelnen Umgebung erheblich sein.</b> </p><br><div class="spoiler">  <b class="spoiler_title">Generatorcode mit DummyVecEnv aus OpenAI-Baselines</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Vectorized environments with gym-like interface from baselines.common.vec_env.subproc_vec_env import SubprocVecEnv from baselines.common.vec_env.dummy_vec_env import DummyVecEnv def make_env(env_id, seed): def _f(): env = gym.make(env_name) env.reset() # Desync environments for i in range(int(200 * seed // environments_count)): env.step(env.action_space.sample()) return env return _f envs = [make_env(env_name, seed) for seed in range(environments_count)] # Can be switched to SubprocVecEnv to parallelize on cores # (for computationally heavy envs) envs = DummyVecEnv(envs) # Source: # https://github.com/openai/spinningup/blob/master/spinup/algos/ppo/core.py def discount_cumsum(x, coef): """ magic from rllab for computing discounted cumulative sums of vectors. input: vector x, [x0, x1, x2] output: [x0 + discount * x1 + discount^2 * x2, x1 + discount * x2, x2] """ return scipy.signal.lfilter([1], [1, float(-coef)], x[::-1], axis=0)[::-1] def generate_batch(envs, batch_size, replay_buffer_size): envs_number = envs.num_envs observations = [[0 for i in range(observation_space)] for i in range(envs_number)] # [state, action, discounted reward-to-go] replay_buffer = np.empty((0,3), np.float32) # [state, action, reward] rollout lists for every environment instance rollouts = [np.empty((0, 3)) for i in range(envs_number)] while True: history = {'reward': [], 'max_action': []} replay_buffer = replay_buffer[batch_size:] # Main sampling cycle while len(replay_buffer) &lt; replay_buffer_size: # Here policy acts in environments. Note that it chooses actions for all # environments in one batch, therefore expensive sess.run is called once. actions = sess.run(actor.action_op, feed_dict={actor.state_ph: observations}) observations_old = observations observations, rewards, dones, _ = envs.step(actions) history['max_action'].append(np.abs(actions).max()) time_point = np.array(list(zip(observations_old, actions, rewards))) for i in range(envs_number): # Regular python-like append rollouts[i] = np.append(rollouts[i], [time_point[i]], axis=0) # Process done==True environments if dones.all(): print('WARNING: envs are in sync!! This makes sampling inefficient!') done_indexes = np.arange(envs_number)[dones] for i in done_indexes: rewards_trajectory = rollouts[i][:, 2].copy() history['reward'].append(rewards_trajectory.sum()) rollouts[i][:, 2] = discount_cumsum(rewards_trajectory, coef=discount_factor) replay_buffer = np.append(replay_buffer, rollouts[i], axis=0) rollouts[i] = np.empty((0, 3)) # Shuffle before yield to become closer to iid np.random.shuffle(replay_buffer) # Truncate replay_buffer to get the most relevant feedback from environment replay_buffer = replay_buffer[:replay_buffer_size] yield replay_buffer[:batch_size], history # Make a test yield a = generate_batch(envs, 8, 64) # Makes them of equal lenght for i in range(10): next(a) next(a)[0]</span></span></code> </pre></div></div><br><p>  Der resultierende Agent kann in Umgebungen mit einem <b>begrenzten Aktionsraum spielen</b> .  Dieses Format ist f√ºr unsere Aufgabe nicht geeignet.  Der Agent, der den Roboter steuert, muss einen Vektor ausgeben <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-602"><span class="MJXp-mtext" id="MJXp-Span-603">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-606" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ R ^ n </script>  wo <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> n </script>  - die Anzahl der Freiheitsgrade.  ( <a href="https://arxiv.org/abs/1910.07113">oder Sie k√∂nnen den Aktionsbereich in L√ºcken aufteilen und eine Aufgabe mit einer diskreten Ausgabe erhalten</a> ) </p><br><a name="diagonal-gaussian-policies"></a><h2>  Diagonale Gau√üsche Politik </h2><br><p>  Die Essenz des Ansatzes der <b>diagonalen Gau√üschen Politik</b> besteht darin, dass das Modell Parameter der n-dimensionalen Normalverteilung erzeugt, n√§mlich <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-609"><span class="MJXp-mtext" id="MJXp-Span-610">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">m</span><span class="MJXp-msubsup" id="MJXp-Span-612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613" style="margin-right: 0.05em;">u</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-614" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> \ mu_ \ theta </script>  - mat.  Warten und <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-620"><span class="MJXp-mtext" id="MJXp-Span-621">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">m</span><span class="MJXp-msubsup" id="MJXp-Span-626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-628" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> \ sigma_ \ theta </script>  - Standardabweichung.  <b>Sobald der Agent eine Aktion ausf√ºhren muss, werden diese Parameter vom Modell abgefragt und eine Zufallsvariable aus dieser Verteilung entnommen.</b>  Also haben wir den Agenten verlassen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-634"><span class="MJXp-mtext" id="MJXp-Span-635">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-638" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> \ R ^ n </script>  und machte es stochastisch.  Das Wichtigste ist, dass wir berechnen k√∂nnen, wenn wir die Verteilungsklasse am Ausgang festgelegt haben <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-639"><span class="MJXp-mtext" id="MJXp-Span-640">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">g</span><span class="MJXp-mo" id="MJXp-Span-644" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-645">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">p</span><span class="MJXp-msubsup" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-649" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">a</span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-658" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-659"><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-663" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> \ log (\ pi_ \ theta (a_t | s_t)) </script>  und daher politische Gef√§lle. </p><br><p>  Hinweis: Kann repariert werden <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-666"><span class="MJXp-mtext" id="MJXp-Span-667">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">m</span><span class="MJXp-msubsup" id="MJXp-Span-672"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-674" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> \ sigma_ \ theta </script>  als Hyperparameter, wodurch die Ausgabeabmessung verringert wird.  Die Praxis zeigt, dass dies nicht viel schadet, sondern im Gegenteil das Lernen stabilisiert. </p><br><p>  <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro.html">Lesen Sie mehr √ºber die stochastische Politik</a> . </p><br><p>  Agent Code: </p><br><pre> <code class="python hljs">epsilon = <span class="hljs-number"><span class="hljs-number">1e-8</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gaussian_loglikelihood</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, mu, log_std)</span></span></span><span class="hljs-function">:</span></span> pre_sum = <span class="hljs-number"><span class="hljs-number">-0.5</span></span> * (((x - mu) / (tf.exp(log_std) + epsilon))**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">2</span></span> * log_std + np.log(<span class="hljs-number"><span class="hljs-number">2</span></span> * np.pi)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tf.reduce_sum(pre_sum, axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActorNetworkContinuous</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">100</span></span>, activation=tf.nn.tanh) l2 = tf.layers.dense(l1, units=<span class="hljs-number"><span class="hljs-number">50</span></span>, activation=tf.nn.tanh) l3 = tf.layers.dense(l2, units=<span class="hljs-number"><span class="hljs-number">25</span></span>, activation=tf.nn.tanh) mu = tf.layers.dense(l3, units=action_space) log_std = tf.get_variable(name=<span class="hljs-string"><span class="hljs-string">'log_std'</span></span>, initializer=<span class="hljs-number"><span class="hljs-number">-0.5</span></span> * np.ones(action_space, std = tf.exp(log_std) self.action_op = mu + tf.random.normal(shape=tf.shape(mu)) * std <span class="hljs-comment"><span class="hljs-comment"># Training self.weight_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.action_ph = tf.placeholder(shape=[None, action_space], dtype=tf.float32) action_logprob = gaussian_loglikelihood(self.action_ph, mu, log_std) self.loss = -tf.reduce_mean(action_logprob * self.weight_ph) optimizer = tf.train.AdamOptimizer(learning_rate=actor_learning_rate) self.update_op = optimizer.minimize(self.loss)</span></span></code> </pre><br><p>  Der Trainingsteil ist nicht anders. </p><br><p>  Jetzt k√∂nnen wir endlich sehen, wie REINFORCE unsere Aufgabe bew√§ltigen wird.  Das Ziel des Agenten ist es, sich nach rechts zu bewegen. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/eH8cFxYHhQg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Langsam aber sicher schleichend auf sein Ziel zu. </p><br><h3>  Belohnung f√ºr unterwegs </h3><br><p>  Beachten Sie, dass unser Farbverlauf zus√§tzliche Elemente enth√§lt.  N√§mlich f√ºr jeden Schritt <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> t </script>  Wenn wir den Gradienten des Logarithmus abw√§gen, verwenden wir die Gesamtbelohnung <b>f√ºr die gesamte Flugbahn</b> .  Bewertung der Handlungen des Agenten anhand seiner Leistungen aus der Vergangenheit.  H√∂rt sich falsch an, nicht wahr?  Deshalb das </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-682"><span class="MJXp-mtext" id="MJXp-Span-683">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">l</span><span class="MJXp-msubsup" id="MJXp-Span-688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-690" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">J</span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-698">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">p</span><span class="MJXp-msubsup" id="MJXp-Span-700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-702" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">a</span><span class="MJXp-mo" id="MJXp-Span-708" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-710">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-713" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-714">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">u</span><span class="MJXp-mtext" id="MJXp-Span-718">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">m</span><span class="MJXp-mtext" id="MJXp-Span-722">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">p</span><span class="MJXp-msubsup" id="MJXp-Span-724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-726" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-732">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">t</span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-738">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">u</span><span class="MJXp-msubsup" id="MJXp-Span-741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">t</span><span class="MJXp-mo" id="MJXp-Span-745">=</span><span class="MJXp-mn" id="MJXp-Span-746">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-748">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">l</span><span class="MJXp-msubsup" id="MJXp-Span-753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-755" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">a</span><span class="MJXp-mtext" id="MJXp-Span-761">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">g</span><span class="MJXp-mtext" id="MJXp-Span-765">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">p</span><span class="MJXp-msubsup" id="MJXp-Span-767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-769" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">a</span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-778" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-779"><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-783" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-784" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-785">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">u</span><span class="MJXp-msubsup" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-790"><span class="MJXp-msup" id="MJXp-Span-791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-793" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-794">=</span><span class="MJXp-mn" id="MJXp-Span-795">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-799" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-802" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-803">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">t</span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> \ nabla_ \ theta J (\ pi_ \ theta) = \ E _ {\ tau \ sim \ pi_ \ theta} \ left [\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) \ sum_ {t '= 0} ^ T r_ {t'} \ right] </script></p><p>  wird dies werden </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-810"><span class="MJXp-mtext" id="MJXp-Span-811">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">l</span><span class="MJXp-msubsup" id="MJXp-Span-816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-818" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">J</span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-826">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">p</span><span class="MJXp-msubsup" id="MJXp-Span-828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-830" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">a</span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-837" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-838">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-839"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-841" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-842">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">u</span><span class="MJXp-mtext" id="MJXp-Span-846">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">m</span><span class="MJXp-mtext" id="MJXp-Span-850">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">p</span><span class="MJXp-msubsup" id="MJXp-Span-852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-854" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-860">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">t</span><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-866">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">u</span><span class="MJXp-msubsup" id="MJXp-Span-869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">t</span><span class="MJXp-mo" id="MJXp-Span-873">=</span><span class="MJXp-mn" id="MJXp-Span-874">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-876">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">l</span><span class="MJXp-msubsup" id="MJXp-Span-881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-883" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">a</span><span class="MJXp-mtext" id="MJXp-Span-889">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">g</span><span class="MJXp-mtext" id="MJXp-Span-893">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">p</span><span class="MJXp-msubsup" id="MJXp-Span-895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-897" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">a</span><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-906" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-907"><span class="MJXp-mo" id="MJXp-Span-908" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-911" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-913">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">u</span><span class="MJXp-msubsup" id="MJXp-Span-916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-918"><span class="MJXp-msup" id="MJXp-Span-919"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-921" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-922">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-927" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-928"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-930" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-931">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">t</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-32"> \ nabla_ \ theta J (\ pi_ \ theta) = \ E _ {\ tau \ sim \ pi_ \ theta} \ left [\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) \ sum_ {t '= t} ^ T r_ {t'} \ right] </script></p><p>  Finde 10 Unterschiede :) </p><br><p>  W√§hrend die Anwesenheit dieser Mitglieder nichts mathematisch verderbt, macht es viel L√§rm f√ºr uns.  W√§hrend des Trainings achtet der Agent nur auf die Belohnungen, die er <b>nach einer bestimmten Aktion erhalten hat</b> . </p><br><p>  Aufgrund dieser Verbesserung ist die durchschnittliche Belohnung gestiegen.  Einer der erhaltenen Agenten lernte, die Vorderbeine zu verwenden, um sein Ziel zu erreichen: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8sN-VaQsnVU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="add-critic"></a><h2>  Reduzieren Sie die Varianz durch Hinzuf√ºgen von Kritik </h2><br><p>  Das Wesentliche weiterer Verbesserungen ist die Reduzierung des Rauschens (Varianz), das durch die stochastischen √úberg√§nge zwischen den Zust√§nden des Mediums entsteht. </p><br><p>  Auf diese Weise k√∂nnen wir ein <b>Modell</b> hinzuf√ºgen <b>, das die durchschnittliche Anzahl der</b> vom Agenten erhaltenen <b>Belohnungen</b> ausgehend vom Status <b>vorhersagt</b> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> s </script>  bis zum Ende der Flugbahn, d.h.  Wertfunktion. </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-940"><span class="MJXp-msubsup" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-943" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">i</span><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">s</span><span class="MJXp-mo" id="MJXp-Span-948" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-950">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-953" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-954">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">u</span><span class="MJXp-mtext" id="MJXp-Span-958">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">m</span><span class="MJXp-mtext" id="MJXp-Span-962">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-965">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">t</span><span class="MJXp-mo" id="MJXp-Span-970" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">R</span><span class="MJXp-mo" id="MJXp-Span-972" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-973">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">u</span><span class="MJXp-mo" id="MJXp-Span-977" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-978"><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-982" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">s</span><span class="MJXp-mtext" id="MJXp-Span-985">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">t</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-992">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">t</span><span class="MJXp-mrow" id="MJXp-Span-997"><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">W</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">n</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> V ^ \ pi (s) = \ E _ {\ tau \ sim \ pi} \ left [R (\ tau) | s_0 = s \ right] \ text {- Wertefunktion} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1012"><span class="MJXp-msubsup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1015" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">i</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">s</span><span class="MJXp-mo" id="MJXp-Span-1020" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">a</span><span class="MJXp-mo" id="MJXp-Span-1022" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1024">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1027" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1028">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">u</span><span class="MJXp-mtext" id="MJXp-Span-1032">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">m</span><span class="MJXp-mtext" id="MJXp-Span-1036">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1039">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">t</span><span class="MJXp-mo" id="MJXp-Span-1044" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">R</span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1047">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">u</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1052"><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1056" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1057" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">s</span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1062" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">a</span><span class="MJXp-mtext" id="MJXp-Span-1065">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">t</span><span class="MJXp-mo" id="MJXp-Span-1071" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-1072">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">t</span><span class="MJXp-mrow" id="MJXp-Span-1077"><span class="MJXp-mo" id="MJXp-Span-1078" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">n</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-35"> Q ^ \ pi (s, a) = \ E _ {\ tau \ sim \ pi} \ left [R (\ tau) | s_0 = s, a_0 = a \ right] \ text {- Aktionswertfunktion} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1098"><span class="MJXp-msubsup" id="MJXp-Span-1099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100" style="margin-right: 0.05em;">A</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1101" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">i</span><span class="MJXp-mo" id="MJXp-Span-1104" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">s</span><span class="MJXp-mo" id="MJXp-Span-1106" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">a</span><span class="MJXp-mo" id="MJXp-Span-1108" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1112" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">i</span><span class="MJXp-mo" id="MJXp-Span-1115" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">s</span><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">a</span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1120" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1123" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">i</span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">s</span><span class="MJXp-mo" id="MJXp-Span-1128" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1129">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">t</span><span class="MJXp-mrow" id="MJXp-Span-1134"><span class="MJXp-mo" id="MJXp-Span-1135" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">n</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> A ^ \ pi (s, a) = Q ^ \ pi (s, a) -V ^ \ pi (s) \ text {- Vorteilsfunktion} </script></p><p>  Die Wertfunktion zeigt die erwartete Rendite an, wenn unsere Richtlinie das Spiel ab einem bestimmten Status startet.  Das Gleiche gilt f√ºr die Q-Funktion. Beheben Sie einfach die allererste Aktion. </p><br><h3>  Kritik hinzuf√ºgen </h3><br><p>  So sieht der Farbverlauf bei Verwendung von Pr√§mie f√ºr unterwegs aus: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1152"><span class="MJXp-mtext" id="MJXp-Span-1153">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">l</span><span class="MJXp-msubsup" id="MJXp-Span-1158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1160" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">a</span><span class="MJXp-mtext" id="MJXp-Span-1166">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">g</span><span class="MJXp-mtext" id="MJXp-Span-1170">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">p</span><span class="MJXp-msubsup" id="MJXp-Span-1172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1174" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">a</span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1183" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1184"><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1188" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1189" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1190">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">u</span><span class="MJXp-msubsup" id="MJXp-Span-1193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1195"><span class="MJXp-msup" id="MJXp-Span-1196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1198" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1199">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1204" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1207" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-37"> \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) \ sum_ {t '= t} ^ T r_ {t'} </script></p><p>  Nun ist der Koeffizient f√ºr den Gradienten des Logarithmus nichts weiter als ein Beispiel f√ºr die Wertefunktion. </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1208"><span class="MJXp-mtext" id="MJXp-Span-1209">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">u</span><span class="MJXp-msubsup" id="MJXp-Span-1212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1214"><span class="MJXp-msup" id="MJXp-Span-1215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1217" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1218">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1223" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1226" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1227">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">m</span><span class="MJXp-msubsup" id="MJXp-Span-1231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1233" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">i</span><span class="MJXp-mo" id="MJXp-Span-1236" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1239" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1240" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> \ sum_ {t '= t} ^ T r_ {t'} \ sim V ^ \ pi (s_t) </script></p><p>  Wir w√§gen den Logarithmusgradienten mit einer Stichprobe aus einer bestimmten Flugbahn ab, was nicht gut ist.  <b>Wir k√∂nnen die Wertefunktion mit einem Modell, zum Beispiel einem neuronalen Netzwerk, approximieren und den erforderlichen Wert von diesem abfragen, wodurch die Varianz verringert wird.</b>  Wir werden dieses Modell als <b>Kritiker bezeichnen</b> und es parallel zur Politik untersuchen.  Somit kann die Gradientenformel wie folgt geschrieben werden: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1241"><span class="MJXp-mtext" id="MJXp-Span-1242">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">l</span><span class="MJXp-msubsup" id="MJXp-Span-1247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1249" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">a</span><span class="MJXp-mtext" id="MJXp-Span-1255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">g</span><span class="MJXp-mtext" id="MJXp-Span-1259">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">p</span><span class="MJXp-msubsup" id="MJXp-Span-1261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1263" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">a</span><span class="MJXp-mo" id="MJXp-Span-1269" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1272" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1273"><span class="MJXp-mo" id="MJXp-Span-1274" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1277" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1278" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">u</span><span class="MJXp-msubsup" id="MJXp-Span-1282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1284"><span class="MJXp-msup" id="MJXp-Span-1285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1287" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1288">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1293" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1296" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1297">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">f</span><span class="MJXp-mrow" id="MJXp-Span-1303"><span class="MJXp-mo" id="MJXp-Span-1304" style="margin-left: 0em; margin-right: 0em;">√§</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">r</span><span class="MJXp-mtext" id="MJXp-Span-1307">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">l</span><span class="MJXp-msubsup" id="MJXp-Span-1312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1314" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">a</span><span class="MJXp-mtext" id="MJXp-Span-1320">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">g</span><span class="MJXp-mtext" id="MJXp-Span-1324">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">p</span><span class="MJXp-msubsup" id="MJXp-Span-1326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1328" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">a</span><span class="MJXp-mo" id="MJXp-Span-1334" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1337" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1338"><span class="MJXp-mo" id="MJXp-Span-1339" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1342" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1343" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1346" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">i</span><span class="MJXp-mo" id="MJXp-Span-1349" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1350">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">u</span><span class="MJXp-mo" id="MJXp-Span-1354" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-39"> \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) \ sum_ {t '= t} ^ Tr_ {t'} \ ungef√§hr \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) V ^ \ pi (\ tau) </script></p><p>  Wir haben die Varianz reduziert, aber gleichzeitig eine <b>Verzerrung</b> in unseren Algorithmus eingef√ºhrt, da neuronale Netze Approximationsfehler verursachen k√∂nnen.  Aber der Kompromiss in dieser Situation ist gut.  Solche Situationen beim maschinellen Lernen werden als <b><a href="https://towardsdatascience.com/understanding-the-bias-variance-tradeoff-165e6942b229">Bias-Varianz-Kompromiss bezeichnet</a></b> . </p><br><p>  Der Kritiker wird die Wert-Funktions-Regression f√ºr in der Umgebung gesammelte Belohnungsproben lehren.  Als Fehlerfunktion nehmen wir MSE.  Das hei√üt  Verlust sieht so aus: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">s</span><span class="MJXp-mo" id="MJXp-Span-1360" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1362"><span class="MJXp-mrow" id="MJXp-Span-1363" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">V</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1365" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">p</span><span class="MJXp-msubsup" id="MJXp-Span-1367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1369" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">i</span><span class="MJXp-mo" id="MJXp-Span-1373" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1376" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1377" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1378" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">u</span><span class="MJXp-msubsup" id="MJXp-Span-1382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1384"><span class="MJXp-msup" id="MJXp-Span-1385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1387" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1388">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1393" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1396" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1397"><span class="MJXp-mo" id="MJXp-Span-1398" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1399" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-40"> loss = ({V} ^ \ pi_ \ psi (s_t) - \ sum_ {t '= t} ^ T r_ {t'}) ^ 2 </script></p><p>  Kritischer Code: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CriticNetwork</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">100</span></span>, activation=tf.nn.tanh) l2 = tf.layers.dense(l1, units=<span class="hljs-number"><span class="hljs-number">50</span></span>, activation=tf.nn.tanh) l3 = tf.layers.dense(l2, units=<span class="hljs-number"><span class="hljs-number">25</span></span>, activation=tf.nn.tanh) output = tf.layers.dense(l3, units=<span class="hljs-number"><span class="hljs-number">1</span></span>) self.value_op = tf.squeeze(output, axis=<span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Training self.value_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.loss = tf.losses.mean_squared_error(self.value_ph, self.value_op) optimizer = tf.train.AdamOptimizer(learning_rate=critic_learning_rate) self.update_op = optimizer.minimize(self.loss)</span></span></code> </pre><br><p>  Der Trainingszyklus sieht jetzt so aus: </p><br><pre> <code class="python hljs">batch_generator = generate_batch(envs, batch_size=batch_size) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tqdm_notebook(range(epochs_number)): batch = next(batch_generator) <span class="hljs-comment"><span class="hljs-comment"># Remainder: batch item consists of [state, action, value, reward-to-go] # Train actor _, actor_loss = sess.run([actor.update_op, actor.loss], feed_dict={actor.state_ph: batch[:, 0], actor.action_ph: batch[:, 1], actor.weight_ph: batch[:, 2]}) # Train critic for j in range(10): _, critic_loss = sess.run([critic.update_op, critic.loss], feed_dict={critic.state_ph: batch[:, 0], critic.value_ph: batch[:, 3]})</span></span></code> </pre><br><p>  Jetzt enth√§lt die Charge einen anderen Wert, den der Kritiker im Generator berechnet hat. <br>  Das hei√üt  Die Art der Charge ist: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1400"><span class="MJXp-mo" id="MJXp-Span-1401" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1404" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1408" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1412" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">p</span><span class="MJXp-msubsup" id="MJXp-Span-1414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1416" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">i</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1423" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1424" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1426">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">u</span><span class="MJXp-msubsup" id="MJXp-Span-1429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1431"><span class="MJXp-msup" id="MJXp-Span-1432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1434" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1435">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1440" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1443" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1444" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> (s_t, a_t, V ^ \ pi_ \ psi (s_t), \ sum_ {t '= t} ^ T r_ {t'}) </script>  . </p><br><p>  In diesem Zyklus beschr√§nkt uns nichts darauf, <b>den Kritiker auf Konvergenz zu trainieren.</b> Wir f√ºhren daher mehrere Schritte des Gradientenabfalls durch, wodurch die Approximation der Wertefunktion verbessert und die Verzerrung verringert wird.  Dieser Ansatz erfordert jedoch eine gro√üe Chargengr√∂√üe, um eine Umschulung zu vermeiden.  <b>Eine √§hnliche Aussage zur Lernpolitik trifft nicht zu.</b>  Es sollte sofortiges Feedback von der Lernumgebung erhalten, da wir uns sonst m√∂glicherweise in einer Situation befinden, in der wir die Richtlinien f√ºr Ma√ünahmen festlegen, die noch nicht durchgef√ºhrt wurden.  Algorithmen mit dieser Eigenschaft werden als <b>On-Policy bezeichnet</b> . </p><br><h3>  Baselines in Politikverl√§ufen </h3><br><p>  Es kann gezeigt werden, dass es im Verlauf zul√§ssig ist, eine breite Klasse anderer n√ºtzlicher Funktionen abzulegen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> t </script>  .  Solche Funktionen werden als <b>Baselines bezeichnet</b> .  ( <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro3.html">Schlussfolgerung aus dieser Tatsache</a> ) Die folgenden Funktionen eignen sich gut als Baselines: </p><br><img src="https://habrastorage.org/webt/c8/ah/l7/c8ahl70po6_pgcud0jxdfbmubi8.png"><br><p>  <i>Quelle: <a href="https://arxiv.org/pdf/1506.02438.pdf">GAE-Papier</a> .</i> </p><br><p>  Unterschiedliche Baselines ergeben je nach Aufgabe unterschiedliche Ergebnisse.  Der gr√∂√üte Gewinn wird in der Regel durch die <b>Advantage-Funktion</b> und ihre N√§herungen erzielt. </p><br><p>  Dahinter steckt sogar eine kleine Intuition.  Wenn wir Advantage verwenden, wird der Agent mit einer Geldstrafe belegt, je nachdem, wie viel besser oder schlechter der Durchschnitt ist, den der Agent f√ºr die von ihm durchgef√ºhrte Aktion h√§lt.  Und je besser der Agent in der Umwelt spielt, desto <b>h√∂her werden seine Standards</b> .  Der ideale Agent spielt gut und bewertet alle seine Aktionen mit einem Vorteil von 0 und hat daher einen Gradienten von 0. </p><br><h3>  Vorteilsbewertung durch Wertfunktion </h3><br><p>  Erinnern Sie sich an die Definition von Vorteil: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1447"><span class="MJXp-msubsup" id="MJXp-Span-1448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449" style="margin-right: 0.05em;">A</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1450" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">i</span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">s</span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">a</span><span class="MJXp-mo" id="MJXp-Span-1457" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1458" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1461" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">i</span><span class="MJXp-mo" id="MJXp-Span-1464" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">s</span><span class="MJXp-mo" id="MJXp-Span-1466" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">a</span><span class="MJXp-mo" id="MJXp-Span-1468" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1472" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">i</span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">s</span><span class="MJXp-mo" id="MJXp-Span-1477" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1478">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">t</span><span class="MJXp-mrow" id="MJXp-Span-1483"><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">n</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-43"> A ^ \ pi (s, a) = Q ^ \ pi (s, a) -V ^ \ pi (s) \ text {- Vorteilsfunktion} </script></p><p>  Es ist nicht klar, wie man eine solche Funktion explizit lernt.  Ein Trick wird zur Rettung kommen, der die Berechnung der Advantage-Funktion auf die Berechnung der Value-Funktion reduziert. </p><br><p>  Definieren <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1501"><span class="MJXp-mtext" id="MJXp-Span-1502">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">t</span><span class="MJXp-msubsup" id="MJXp-Span-1507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1511" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1512"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1514" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">V</span><span class="MJXp-mo" id="MJXp-Span-1517" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1520" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">t</span><span class="MJXp-mo" id="MJXp-Span-1522">+</span><span class="MJXp-mn" id="MJXp-Span-1523">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1525" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">V</span><span class="MJXp-mo" id="MJXp-Span-1527" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1530" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> \ delta_t ^ V = r_t + V (s_ {t + 1}) - V (s_t) </script>  - Residuum der zeitlichen Differenz ( <b>TD-Residuum</b> ).  Es ist nicht schwer zu folgern, dass sich eine solche Funktion dem Vorteil ann√§hert: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1532"><span class="MJXp-mtext" id="MJXp-Span-1533">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">E</span><span class="MJXp-mtext" id="MJXp-Span-1535">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">t</span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1541">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545">t</span><span class="MJXp-msubsup" id="MJXp-Span-1546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">t</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1550">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">t</span><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1558">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">E</span><span class="MJXp-mtext" id="MJXp-Span-1560">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">t</span><span class="MJXp-mo" id="MJXp-Span-1565" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1568" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">V</span><span class="MJXp-mo" id="MJXp-Span-1571" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1574" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">t</span><span class="MJXp-mo" id="MJXp-Span-1576">+</span><span class="MJXp-mn" id="MJXp-Span-1577">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">V</span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1584" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1586">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">t</span><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1594">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">E</span><span class="MJXp-mtext" id="MJXp-Span-1596">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">t</span><span class="MJXp-mo" id="MJXp-Span-1601" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">Q</span><span class="MJXp-mo" id="MJXp-Span-1603" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1606" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1610" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1612" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">V</span><span class="MJXp-mo" id="MJXp-Span-1614" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1617" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1618" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1619">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">t</span><span class="MJXp-mo" id="MJXp-Span-1625" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1626" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">A</span><span class="MJXp-mo" id="MJXp-Span-1628" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1631" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1632" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1635" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1636" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-45"> \ E \ left [\ delta ^ V_t \ right] = \ E \ left [r_t + V (s_ {t + 1}) - V (s_t) \ right] = \ E \ left [Q (s_t, a_t) -V (s_t) \ right] = A (s_t, a_t) </script></p><p>  Solch eine konzeptionell komplexe √Ñnderung f√ºhrt zu einer nicht so gro√üen √Ñnderung des Codes.  Anstatt nun die Wertfunktion zu bewerten, legt der Kritiker eine Vorteilsbewertung f√ºr die Richtlinienschulung vor. </p><br><p>  Der resultierende Algorithmus hei√üt <b>Advantage Actor-Critic</b> . </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate_advantage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(states, rewards)</span></span></span><span class="hljs-function">:</span></span> values = sess.run(critic.value_op, feed_dict={critic.state_ph: states}) deltas = rewards - values deltas = deltas + np.append(values[<span class="hljs-number"><span class="hljs-number">1</span></span>:], np.array([<span class="hljs-number"><span class="hljs-number">0</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> deltas, values</code> </pre><br><p>  Die erhaltenen Wirkstoffe lassen sich bei sicherem Gang und synchronem Einsatz der Gliedma√üen beobachten: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/GCbPl3dOLmQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Verallgemeinerte Vorteilssch√§tzung </h3><br><p>  Ein relativ neuer Artikel (2018), " <a href="https://arxiv.org/pdf/1506.02438.pdf">Hochdimensionale kontinuierliche Steuerung unter Verwendung einer verallgemeinerten Vorteilssch√§tzung</a> ", bietet eine noch effizientere Bewertung des Vorteils durch die <a href="https://arxiv.org/pdf/1506.02438.pdf">Wertfunktion</a> .  Es reduziert die Varianz noch mehr: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1637"><span class="MJXp-msubsup" id="MJXp-Span-1638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639" style="margin-right: 0.05em;">A</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">E</span><span class="MJXp-mo" id="MJXp-Span-1645">(</span><span class="MJXp-mtext" id="MJXp-Span-1646">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">a</span><span class="MJXp-mo" id="MJXp-Span-1652">,</span><span class="MJXp-mtext" id="MJXp-Span-1653">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">a</span><span class="MJXp-mo" id="MJXp-Span-1660">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1662">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">u</span><span class="MJXp-msubsup" id="MJXp-Span-1665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-1671">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668">l</span><span class="MJXp-mo" id="MJXp-Span-1669">=</span><span class="MJXp-mn" id="MJXp-Span-1670">0</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676">y</span><span class="MJXp-mo" id="MJXp-Span-1677" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1678">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">a</span><span class="MJXp-mtext" id="MJXp-Span-1684">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">a</span><span class="MJXp-msubsup" id="MJXp-Span-1691"><span class="MJXp-mo" id="MJXp-Span-1692" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1693" style="vertical-align: 0.5em;">l</span></span><span class="MJXp-mtext" id="MJXp-Span-1694">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">t</span><span class="MJXp-msubsup" id="MJXp-Span-1699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">t</span><span class="MJXp-mo" id="MJXp-Span-1703">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1704">l</span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-46"> A_t ^ {GAE (\ gamma, \ lambda)} = \ sum_ {l = 0} ^ \ infty (\ gamma \ lambda) ^ l \ delta ^ V_ {t + l} </script></p><p>  wo: </p><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1706"><span class="MJXp-mtext" id="MJXp-Span-1707">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">t</span><span class="MJXp-msubsup" id="MJXp-Span-1712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1716" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1719" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1720" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721">V</span><span class="MJXp-mo" id="MJXp-Span-1722" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1725" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726">t</span><span class="MJXp-mo" id="MJXp-Span-1727">+</span><span class="MJXp-mn" id="MJXp-Span-1728">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1729" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1730" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">V</span><span class="MJXp-mo" id="MJXp-Span-1732" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1735" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1736" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> \ delta_t ^ V = r_t + V (s_ {t + 1}) - V (s_t) </script>  - TD-Rest, </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1737"><span class="MJXp-mtext" id="MJXp-Span-1738">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> \ gamma </script>  - Abzinsungsfaktor (Hyperparameter), </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1744"><span class="MJXp-mtext" id="MJXp-Span-1745">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> \ lambda </script>  - Hyperparameter. </li></ul><br><p>  Die Interpretation ist in der Publikation selbst zu finden. </p><br><p>  Implementierung: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">discount_cumsum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, coef)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Source: # https://github.com/openai/spinningup/blob/master/spinup/algos/ppo/core.py """ magic from rllab for computing discounted cumulative sums of vectors. input: vector x, [x0, x1, x2] output: [x0 + discount * x1 + discount^2 * x2, x1 + discount * x2, x2] """ return scipy.signal.lfilter([1], [1, float(-coef)], x[::-1], axis=0)[::-1] def estimate_advantage(states, rewards): values = sess.run(critic.value_op, feed_dict={critic.state_ph: states}) deltas = rewards - values deltas = deltas + discount_factor * np.append(values[1:], np.array([0])) advantage = discount_cumsum(deltas, coef=lambda_factor * discount_factor) return advantage, values</span></span></code> </pre><br><p>  Bei Verwendung einer kleinen Stapelgr√∂√üe hat sich der Algorithmus einigen lokalen Optima angen√§hert.  Hier benutzt der Agent eine Pfote als Spazierstock und der Rest dr√ºckt ab: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3f4rRbqnuxg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Dabei kam der Agent nicht zum Einsatz von Spr√ºngen, sondern fingerte einfach schnell mit Gliedma√üen.  Und Sie k√∂nnen auch sehen, wie er sich verh√§lt, wenn er z√∂gert, dreht er sich um und rennt weiter: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/O5aJoj16ZDM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Als bester Agent steht er ganz am Anfang des Artikels.  Stabiles Springen, bei dem sich alle Gliedma√üen von der Oberfl√§che l√∂sen.  Die entwickelte F√§higkeit zum Auswuchten erm√∂glicht es dem Agenten, die Flugbahn mit voller Geschwindigkeit zu korrigieren, wenn ein Fehler gemacht wurde: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xT9KKnpxxo8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="pitfalls"></a><h2>  Fallstricke </h2><br><p>  Maschinelles Lernen ist ber√ºhmt f√ºr die Dimension des Fehlerraums, der gemacht werden kann und einen v√∂llig nicht funktionierenden Algorithmus liefert.  Aber RL bringt das Problem auf eine ganz neue Ebene. </p><br><img src="https://habrastorage.org/webt/rq/w0/fl/rqw0flwtyhb3getoyjwyraaf7na.png"><br><p>  <a href="http://ai.stanford.edu/~zayd/why-is-machine-learning-hard.html"><i>Quelle</i></a> </p><br><p>  Hier sind einige der Schwierigkeiten aufgef√ºhrt, die w√§hrend der Entwicklung aufgetreten sind. </p><br><ol><li>  Der Algorithmus reagiert √ºberraschend empfindlich auf Hyperparameter.  Die Qualit√§t des Lernens √§nderte sich, als die Lernrate von 3e-4 auf 1e-4 ge√§ndert wurde.  Und das Bild hat sich grundlegend ge√§ndert - von einem v√∂llig nicht konvergenten Algorithmus zu dem Besten, das im Video enthalten ist. </li><li>  Die Gr√∂√üe der Charge ist keineswegs dieselbe wie in anderen Bereichen von DL.  Wenn Sie es sich bei der Bildklassifizierung leisten k√∂nnen, die Gr√∂√üe des 32-256-Stapels zu w√§hlen, und das Ergebnis sich durch die Erh√∂hung nicht besonders √§ndert, ist es besser, f√ºr unsere Aufgabe ein paar Tausend, 3000 Arbeiten in Anspruch zu nehmen. </li><li>  Lernen ist besser, mehrmals zu laufen, manchmal mit zuf√§lligen Samen ist kein Gl√ºck. </li><li>  Das Lernen in einem so komplexen Umfeld nimmt viel Zeit in Anspruch und der Fortschritt ist nicht einheitlich.  Beispielsweise hat der beste Algorithmus 8 Stunden lang gelernt, von denen 3 ein schlechteres Ergebnis zeigten als eine zuf√§llige Basislinie.  Daher ist es beim Testen der Algorithmen besser, mit einem kleinen zu beginnen, wie in Spielzeugumgebungen aus dem Fitnessstudio. <img src="https://habrastorage.org/webt/ol/ml/yx/olmlyxvpvt8lroty8kllva2igz4.png"></li><li>  Ein guter Ansatz zum Auffinden von Hyperparametern und Modellarchitekturen besteht darin, sich verwandte Artikel und Implementierungen anzusehen.  (Hauptsache nicht umbilden) </li></ol><br><p>  In diesem Artikel erfahren Sie mehr √ºber die Nuancen von Deep RL: <a href="https://www.alexirpan.com/2018/02/14/rl-hard.html">Deep Reinforcement Learning funktioniert noch nicht</a> . </p><br><a name="conclusion"></a><h2>  Fazit </h2><br><p>  Der resultierende Algorithmus l√∂st das Problem √ºberzeugend.  Funktion gefunden <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1752"><span class="MJXp-mtext" id="MJXp-Span-1753">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">i</span><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-1757">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1760" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1761">800</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1762">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">s</span><span class="MJXp-mtext" id="MJXp-Span-1766">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1769" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1770">18</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> \ pi: \ R ^ {800} \ bis \ R ^ {18} </script>  , agil und sicher den Roboter steuern. </p><br><p>  Eine logische Fortsetzung wird die Untersuchung enger Verwandter von A2C-, PPO- und TRPO-Algorithmen sein.  Sie verbessern die <b>Probeneffizienz</b> , d.h.  Konvergenzzeit des Algorithmus, und sie sind in der Lage, komplexere Probleme zu l√∂sen.  Es war PPO + Automatic Domain Randomization, das k√ºrzlich <a href="https://openai.com/blog/solving-rubiks-cube/">den Rubik's Cube auf einem Roboter zusammengebaut hat</a> . </p><br><p>  Hier finden Sie den Code aus dem Artikel: <a href="https://github.com/LeonidMurashov/advantage-actor-critic-gae">Repository</a> . </p><br><p>  Ich hoffe, Ihnen hat der Artikel gefallen und Sie waren inspiriert von dem, was Deep Reinforcement Learning heute leisten kann. </p><br><p>  <b>Vielen Dank f√ºr Ihre Aufmerksamkeit!</b> </p><br><h2>  N√ºtzliche Links: </h2><br><ul><li>  <a href="https://spinningup.openai.com/en/latest/index.html">Willkommen bei Spinning Up in Deep RL!</a> </li><li>  <a href="http://rail.eecs.berkeley.edu/deeprlcourse-fa17/index.html">CS 294: Deep Reinforcement Learning, Herbst 2017</a> </li><li>  <a href="http://rail.eecs.berkeley.edu/deeprlcourse/">CS 285: Deep Reinforcement Learning, Entscheidungsfindung und Kontrolle</a> </li><li>  <a href="https://arxiv.org/pdf/1506.02438.pdf">Kontinuierliche hochdimensionale Steuerung mit allgemeiner Vorteilsbewertung</a> </li><li>  <a href="https://github.com/openai/baselines/">OpenAI Baselines: Hochwertige Implementierungen von Algorithmen zum Lernen der Verst√§rkung</a> </li></ul><br><p>  <i>Vielen Dank an <a href="https://habr.com/ru/users/pinkotter/" class="user_link">Pinkotter</a> , <a href="https://habr.com/ru/users/vambala/" class="user_link">Vambala</a> , <a href="https://habr.com/ru/users/andrey_probochkin/" class="user_link">Andrey_Probochkin</a> , <a href="https://habr.com/ru/users/pollyfom/" class="user_link">Pollyfom</a> und <a href="https://habr.com/ru/users/suriknik/" class="user_link">Suriknik</a> f√ºr die Unterst√ºtzung bei dem Projekt.</i> <br>  <i>Insbesondere <a href="https://habr.com/ru/users/vambala/" class="user_link">Vambala</a> und <a href="https://habr.com/ru/users/andrey_probochkin/" class="user_link">andrey_probochkin</a> f√ºr die Schaffung einer coolen MuJoCo-Umgebung.</i> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de483078/">https://habr.com/ru/post/de483078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de483064/index.html">Vue f√ºr den kleinsten aka kleinen Blog auf allen Kanonen</a></li>
<li><a href="../de483066/index.html">Die traditionellen 5 B√ºcher von Bill Gates</a></li>
<li><a href="../de483068/index.html">Reverse Engineering des beliebten Anti-Cheat BattlEye</a></li>
<li><a href="../de483074/index.html">TensorRT 6.xxx - Hochleistungsinferenz f√ºr Deep-Learning-Modelle (Objekterkennung und -segmentierung)</a></li>
<li><a href="../de483076/index.html">Top-Programmiersprachen f√ºr die Android App-Entwicklung im Jahr 2020</a></li>
<li><a href="../de483082/index.html">Vulnerability Hunting ist 7% effektiver</a></li>
<li><a href="../de483084/index.html">Kamera mit Tracking-Funktion</a></li>
<li><a href="../de483086/index.html">Ergebnisse von 2019: Welche Verm√∂genswerte erwiesen sich f√ºr russische Investoren als die rentabelsten</a></li>
<li><a href="../de483094/index.html">Wie ich meinen Traum verwirklichte, als ich das russische B√ºro von Microsoft besuchte</a></li>
<li><a href="../de483110/index.html">Rostow am Don: IT-Unternehmen, Communities und Veranstaltungen im Jahr 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>