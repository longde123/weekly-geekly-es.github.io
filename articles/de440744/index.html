<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👞 🧕🏾 🥠 PHP für Anfänger. Fehlerbehandlung 💆🏽 👩🏿‍🤝‍👩🏻 👩🏿‍🍳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nur wer nichts tut, macht keine Fehler, und wir sind ein Beispiel dafür - wir sitzen und arbeiten unermüdlich, lesen den Habr :) 

 In diesem Artikel ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PHP für Anfänger. Fehlerbehandlung</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440744/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/18b/c9c/5d5/18bc9c5d5f043226c41b3db5fcb1b839.png" alt="Bild"></div><br>  Nur wer nichts tut, macht keine Fehler, und wir sind ein Beispiel dafür - wir sitzen und arbeiten unermüdlich, lesen den Habr :) <br><br>  In diesem Artikel werde ich meine Geschichte über Fehler in PHP und wie man sie eindämmt, führen. <br><a name="habracut"></a><br><h2>  Fehler </h2><br><h3>  Sorten in der Fehlerfamilie </h3><br>  Bevor ich Fehler zähme, würde ich empfehlen, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">jede Art zu untersuchen</a> und die prominentesten Vertreter separat zu beachten. <br><br>  Um zu verhindern, dass ein einzelner Fehler unbemerkt bleibt, müssen Sie die Verfolgung aller Fehler mithilfe der Funktion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">error_reporting ()</a> und mithilfe der Anweisung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">display_errors aktivieren</a> , um deren Anzeige zu aktivieren: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> error_reporting(E_ALL); ini_set(<span class="hljs-string"><span class="hljs-string">'display_errors'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> <br><h4>  Schwerwiegende Fehler </h4><br>  Die schwerwiegendsten Fehler sind schwerwiegend. Sie können sowohl während der Kompilierung als auch während der Arbeit des Parsers oder des PHP-Skripts auftreten, während das Skript unterbrochen wird. <br><br>  <strong>E_PARSE</strong> <br><br>  Dieser Fehler tritt auf, wenn Sie einen groben Syntaxfehler machen und der PHP-Interpreter nicht versteht, was Sie davon wollen, beispielsweise wenn Sie die geschweifte Klammer oder Klammer nicht geschlossen haben: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * Parse error: syntax error, unexpected end of file */</span></span> {</code> </pre><br>  Oder sie schrieben in einer unverständlichen Sprache: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * Parse error: syntax error, unexpected '...' (T_STRING) */</span></span>    </code> </pre><br>  Zusätzliche Klammern treten ebenfalls auf und sind nicht so wichtig rund oder lockig: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * Parse error: syntax error, unexpected '}' */</span></span> }</code> </pre><br>  Ich stelle einen wichtigen Punkt fest: Der Code der Datei, in der Sie den Analysefehler gemacht haben, wird nicht ausgeführt. Wenn Sie daher versuchen, die Anzeige von Fehlern in derselben Datei zu aktivieren, in der der Parserfehler aufgetreten ist, funktioniert dies nicht: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//     error_reporting(E_ALL); ini_set('display_errors', 1); // ..    </span></span></code> </pre><br>  <strong>E_ERROR</strong> <br><br>  Dieser Fehler tritt auf, wenn PHP verstanden hat, was Sie wollen, aber dies hat aus mehreren Gründen nicht funktioniert.  Dieser Fehler unterbricht auch die Ausführung des Skripts, und der Code funktioniert, bevor der Fehler auftritt: <br><br>  Das Plug-In wurde nicht gefunden: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Fatal error: require_once(): Failed opening required 'not-exists.php' * (include_path='.:/usr/share/php:/usr/share/pear') */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span> <span class="hljs-string"><span class="hljs-string">'not-exists.php'</span></span>;</code> </pre><br>  Eine Ausnahme wurde ausgelöst (was für ein Tier werde ich Ihnen etwas später erzählen), aber nicht verarbeitet: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Fatal error: Uncaught exception 'Exception' */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span>();</code> </pre><br>  Beim Versuch, eine nicht vorhandene Klassenmethode aufzurufen: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Fatal error: Call to undefined method stdClass::notExists() */</span></span> $stdClass = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> stdClass(); $stdClass-&gt;notExists();</code> </pre><br>  Mangel an freiem Speicher (mehr als in der Direktive <a href="">memory_limit</a> vorgeschrieben) oder etwas Ähnliches: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Fatal Error: Allowed Memory Size */</span></span> $arr = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { $arr[] = str_pad(<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-number"><span class="hljs-number">1024</span></span>); }</code> </pre><br><blockquote>  Dies ist sehr häufig beim Lesen oder Herunterladen großer Dateien der Fall. Seien Sie also vorsichtig mit dem Problem des Speicherverbrauchs </blockquote>  Rekursiver Funktionsaufruf.  In diesem Beispiel endete es bei der 256. Iteration, da es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">in den xdebug-Einstellungen</a> so geschrieben ist (ja, dieser Fehler kann in dieser Form nur auftreten, wenn die xdebug-Erweiterung aktiviert ist): <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Fatal error: Maximum function nesting level of '256' reached, aborting! */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deep</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ deep(); } deep();</code> </pre><br><h4>  Nicht tödlich </h4><br>  Diese Ansicht unterbricht die Ausführung des Skripts nicht, aber es ist der Tester, der sie normalerweise findet.  Es sind solche Fehler, die Anfängern die meisten Probleme bereiten. <br><br>  <strong>E_WARNING</strong> <br><br>  Es tritt häufig auf, wenn Sie eine Datei mit <code>include</code> , aber es wird nicht auf dem Server angezeigt oder Sie haben einen Fehler gemacht, der den Pfad zur Datei angibt: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Warning: include_once(): Failed opening 'not-exists.php' for inclusion */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">include_once</span></span> <span class="hljs-string"><span class="hljs-string">'not-exists.php'</span></span>;</code> </pre><br>  Es passiert, wenn Sie beim Aufrufen von Funktionen die falsche Art von Argumenten verwenden: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Warning: join(): Invalid arguments passed */</span></span> join(<span class="hljs-string"><span class="hljs-string">'string'</span></span>, <span class="hljs-string"><span class="hljs-string">'string'</span></span>);</code> </pre><br>  Es gibt viele von ihnen, und alles aufzulisten macht keinen Sinn ... <br><br>  <strong>E_HINWEIS</strong> <br><br>  Dies sind die häufigsten Fehler. Außerdem gibt es Lüfter, die die Fehlerausgabe ausschalten und den ganzen Tag nieten.  Es gibt eine Reihe von trivialen Fehlern. <br><br>  Beim Zugriff auf eine undefinierte Variable: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Notice: Undefined variable: a */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $a;</code> </pre><br>  Beim Zugriff auf ein nicht vorhandenes Array-Element: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Notice: Undefined index: a */</span></span> $b = []; $b[<span class="hljs-string"><span class="hljs-string">'a'</span></span>];</code> </pre><br>  Beim Zugriff auf eine nicht vorhandene Konstante: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Notice: Use of undefined constant UNKNOWN_CONSTANT - assumed 'UNKNOWN_CONSTANT' */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> UNKNOWN_CONSTANT;</code> </pre><br>  Wenn Datentypen nicht konvertiert werden: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Notice: Array to string conversion */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>();</code> </pre><br>  Um solche Fehler zu vermeiden, seien Sie vorsichtig. Wenn die IDE etwas sagt, ignorieren Sie es nicht: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/269/72e/f7f/26972ef7f88d757afd966ddb080a2e83.png" alt="PHP E_NOTICE in PHPStorm" width="367" height="68"><br><br>  <strong>E_STRICT</strong> <br><br>  Dies sind Fehler, die Sie lehren, Code korrekt zu schreiben, damit Sie sich nicht schämen, zumal die IDE Ihnen diese Fehler sofort anzeigt.  Wenn Sie beispielsweise eine nicht statische Methode als statisch bezeichnet haben, funktioniert der Code, ist jedoch irgendwie falsch, und es können schwerwiegende Fehler auftreten, wenn die Klassenmethode in Zukunft geändert wird, und es wird ein Aufruf an <code>$this</code> angezeigt: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Strict standards: Non-static method Strict::test() should not be called statically */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Strict</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Test"</span></span>; } } Strict::test();</code> </pre><br><br><blockquote>  Diese Art von Fehler ist für PHP Version 5.6 relevant und fast alle wurden herausgeschnitten <br>  7 Spiele.  Lesen Sie mehr im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">entsprechenden RFC</a> .  Wenn jemand weiß, wo diese Fehler sonst noch geblieben sind, dann schreibe in die Kommentare </blockquote><br><br>  <strong>E_DEPRECATED</strong> <br><br>  PHP wird also schwören, wenn Sie veraltete Funktionen verwenden (d. H. Solche, die als veraltet markiert sind und nicht in der nächsten Hauptversion enthalten sein werden): <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Deprecated: Function split() is deprecated */</span></span> <span class="hljs-comment"><span class="hljs-comment">//  ,   PHP 7.0 //    PHP 5.3 split(',', 'a,b');</span></span></code> </pre><br>  In meinem Editor werden ähnliche Funktionen durchgestrichen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9d1/6f8/670/9d16f8670d27cee56cbed1433a913ee4.png" alt="PHP E_DEPRECATED in PHPStorm" width="367" height="72"><br><br><h4>  Benutzerdefiniert </h4><br>  Diesen Typ, den der Codeentwickler selbst „züchtet“, habe ich schon lange nicht mehr gesehen, und ich empfehle nicht, dass Sie sie missbrauchen: <br><br><ul><li>  <code>E_USER_ERROR</code> - kritischer Fehler </li><li>  <code>E_USER_WARNING</code> - kein kritischer Fehler </li><li>  <code>E_USER_NOTICE</code> - Nachrichten, die keine Fehler sind </li></ul><br>  <code>E_USER_DEPRECATED</code> davon ist <code>E_USER_DEPRECATED</code> zu <code>E_USER_DEPRECATED</code> Dieser Typ wird immer noch sehr häufig verwendet, um den Programmierer daran zu erinnern, dass die Methode oder Funktion veraltet ist und es Zeit ist, den Code neu zu schreiben, ohne ihn zu verwenden.  Die Funktion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">trigger_error ()</a> wird verwendet, um diesen und ähnliche Fehler zu erstellen: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@deprecated</span></span></span><span class="hljs-comment"> Deprecated since version 1.2, to be removed in 2.0 */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateToken</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ trigger_error(<span class="hljs-string"><span class="hljs-string">'Function `generateToken` is deprecated, use class `Token` instead'</span></span>, E_USER_DEPRECATED); <span class="hljs-comment"><span class="hljs-comment">// ... // code ... // ... }</span></span></code> </pre><br><blockquote>  Nachdem Sie sich mit den meisten Arten und Arten von Fehlern vertraut gemacht haben, ist es an der Zeit, eine kurze Erklärung zur Funktionsweise der Anweisung <code>display_errors</code> : <br><br><ul><li>  Wenn <code>display_errors = on</code> , erhält der Browser im Fehlerfall HTML mit dem Fehlertext und dem Code 200 </li><li>  Wenn <code>display_errors = off</code> , <code>display_errors = off</code> der Antwortcode für schwerwiegende Fehler 500 und das Ergebnis wird für andere Fehler nicht an den Benutzer zurückgegeben. Der Code funktioniert nicht ordnungsgemäß, teilt jedoch niemandem davon mit </li></ul><br></blockquote><br><h3>  Zähmen </h3><br>  Es gibt 3 Funktionen zum Arbeiten mit Fehlern in PHP: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">set_error_handler ()</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Legt</a> einen Handler für Fehler fest, die das Skript nicht unterbrechen (d. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">h.</a> für nicht schwerwiegende Fehler). </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">error_get_last ()</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ruft</a> Informationen zum letzten Fehler ab </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">register_shutdown_function ()</a> - registriert einen Handler, der beim Beenden des Skripts gestartet wird.  Diese Funktion gilt nicht direkt für Fehlerbehandlungsroutinen, wird jedoch häufig zu diesem Zweck verwendet. </li></ul><br>  Nun einige Details zur Fehlerbehandlung mit <code>set_error_handler()</code> . Als Argumente akzeptiert diese Funktion den Namen der Funktion, der die Mission zur Behandlung von Fehlern zugewiesen wird, und die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Arten von Fehlern</a> , die überwacht werden.  Ein Fehlerbehandler kann auch eine Klassenmethode oder eine anonyme Funktion sein. Hauptsache, er benötigt die folgende Liste von Argumenten: <br><br><ul><li>  <code>$errno</code> - Das erste Argument enthält den Fehlertyp als Ganzzahl </li><li>  <code>$errstr</code> - Das zweite Argument enthält eine Fehlermeldung </li><li>  <code>$errfile</code> - Ein optionales drittes Argument enthält den Namen der Datei, in der der Fehler aufgetreten ist </li><li>  <code>$errline</code> - Ein optionales viertes Argument enthält die Zeilennummer, in der der Fehler aufgetreten ist </li><li>  <code>$errcontext</code> - Das optionale fünfte Argument enthält ein Array aller Variablen, die in dem Bereich vorhanden sind, in dem der Fehler aufgetreten ist </li></ul><br>  Wenn der Handler <code>true</code> zurückgibt, wird der Fehler als verarbeitet betrachtet und das Skript wird weiterhin ausgeführt. Andernfalls wird ein Standardhandler aufgerufen, der den Fehler protokolliert und je nach Typ das Skript weiterhin ausführt oder abschließt.  Hier ist ein Beispiel für einen Handler: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//    ,  E_NOTICE error_reporting(E_ALL &amp; ~E_NOTICE); ini_set('display_errors', 1); //    function myHandler($level, $message, $file, $line, $context) { //         switch ($level) { case E_WARNING: $type = 'Warning'; break; case E_NOTICE: $type = 'Notice'; break; default; //   E_WARNING   E_NOTICE //      //      PHP return false; } //    echo "&lt;h2&gt;$type: $message&lt;/h2&gt;"; echo "&lt;p&gt;&lt;strong&gt;File&lt;/strong&gt;: $file:$line&lt;/p&gt;"; echo "&lt;p&gt;&lt;strong&gt;Context&lt;/strong&gt;: $". join(', $', array_keys($context))."&lt;/p&gt;"; // ,    ,      return true; } //   ,         set_error_handler('myHandler', E_ALL);</span></span></code> </pre><br><blockquote>  Sie können nicht mehr als eine Funktion zur Behandlung von Fehlern zuweisen, obwohl ich wirklich gerne meinen eigenen Handler für jeden Fehlertyp registrieren würde, aber nein - schreiben Sie einen Handler und beschreiben Sie die gesamte Anzeigelogik für jeden Typ direkt darin </blockquote>  Es gibt ein erhebliches Problem mit dem oben beschriebenen Handler: Er fängt keine schwerwiegenden Fehler ab, und bei solchen Fehlern sehen Benutzer anstelle der Site nur eine leere Seite oder, noch schlimmer, eine Fehlermeldung.  Um ein solches Szenario zu verhindern, sollten Sie die Funktion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">register_shutdown_function</a> () verwenden und damit eine Funktion registrieren, die immer am Ende des Skripts ausgeführt wird: <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shutdown</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'    '</span></span>; } register_shutdown_function(<span class="hljs-string"><span class="hljs-string">'shutdown'</span></span>);</code> </pre><br>  Diese Funktion wird immer funktionieren! <br><br>  Zurück zu den Fehlern: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Um</a> das Auftreten des Fehlers im Fehlercode zu verfolgen, verwenden wir die Funktion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">error_get_last ()</a> . Mit ihrer Hilfe können Sie Informationen über den zuletzt erkannten Fehler <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">abrufen.</a> Da schwerwiegende Fehler die Ausführung des Codes unterbrechen, spielen sie immer die Rolle des "letzten": <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shutdown</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $error = error_get_last(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-comment"><span class="hljs-comment">//       is_array($error) &amp;&amp; //       in_array($error['type'], [E_ERROR, E_PARSE, E_CORE_ERROR, E_COMPILE_ERROR]) ) { //    (       ) while (ob_get_level()) { ob_end_clean(); } //    echo "    ,  "; } } register_shutdown_function('shutdown');</span></span></code> </pre> <br><blockquote>  Ich möchte darauf aufmerksam machen, dass dieser Code sogar zur Fehlerbehandlung vorkommt und Sie vielleicht sogar darauf stoßen, aber er hat seit der 7. Version von PHP an Relevanz verloren.  Was kam, um zu ersetzen, werde ich etwas später erzählen. </blockquote><div class="spoiler">  <b class="spoiler_title">Aufgabe</b> <div class="spoiler_text">  Ergänzen Sie den Handler für schwerwiegende Fehler durch die Ausgabe des Quellcodes der Datei, in der der Fehler aufgetreten ist, und fügen Sie eine Syntaxhervorhebung des Ausgabecodes hinzu. <br></div></div><br><h3>  Über Völlerei </h3><br>  Lassen Sie uns einen einfachen Test durchführen und herausfinden, wie viele wertvolle Ressourcen der trivialste Fehler verbraucht: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** *      */</span></span> <span class="hljs-comment"><span class="hljs-comment">//     $time= microtime(true); define('AAA', 'AAA'); $arr = []; for ($i = 0; $i &lt; 10000; $i++) { $arr[AAA] = $i; } printf('%f seconds &lt;br/&gt;', microtime(true) - $time);</span></span></code> </pre><br>  Als Ergebnis der Ausführung dieses Skripts habe ich folgendes Ergebnis erhalten: <br><br><pre> <code class="bash hljs">0.002867 seconds</code> </pre><br>  Fügen Sie nun den Fehler in die Schleife ein: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** *     */</span></span> <span class="hljs-comment"><span class="hljs-comment">//     $time= microtime(true); $arr = []; for ($i = 0; $i &lt; 10000; $i++) { $arr[BBB] = $i; //   ,      } printf('%f seconds &lt;br/&gt;', microtime(true) - $time);</span></span></code> </pre><br>  Das Ergebnis ist voraussichtlich schlechter und eine Größenordnung (sogar zwei Größenordnungen!): <br><br><pre> <code class="bash hljs">0.263645 seconds</code> </pre><br>  <strong>Die Schlussfolgerung ist klar - Fehler im Code führen zu einer übermäßigen Fülle von Skripten - schalten Sie also die Anzeige aller Fehler während der Anwendungsentwicklung und des Testens ein!</strong> <br><blockquote>  Die Tests wurden mit verschiedenen Versionen von PHP durchgeführt, und überall ist der Unterschied zehnmal so groß. Lassen Sie dies einen weiteren Grund sein, alle Fehler im Code zu beheben </blockquote><br><h3>  Wo ist der Hund begraben? </h3><br>  PHP hat ein spezielles Symbol "@" - ein Fehlerunterdrückungsoperator, der verwendet wird, um keine Fehlerbehandlung zu schreiben, sondern sich auf das korrekte Verhalten von PHP stützt. In diesem Fall: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> @UNKNOWN_CONSTANT;</code> </pre><br>  In diesem Fall wird der in <code>set_error_handler()</code> angegebene <code>set_error_handler()</code> weiterhin aufgerufen, und die Tatsache, dass der Fehler unterdrückt wurde, kann durch Aufrufen der Funktion <code>error_reporting()</code> im Handler verfolgt werden. In diesem Fall wird <code>0</code> . <br><blockquote>  Wenn Sie Fehler auf diese Weise unterdrücken, wird der Prozessor weniger belastet als wenn Sie sie nur ausblenden (siehe Vergleichstest oben). In jedem Fall ist das <strong>Unterdrücken von Fehlern jedoch böse</strong> </blockquote><div class="spoiler">  <b class="spoiler_title">Aufgabe</b> <div class="spoiler_text">  Überprüfen Sie, wie sich die Fehlerunterdrückung mit <code>@</code> auf das vorherige Schleifenbeispiel auswirkt. <br></div></div><br><h2>  Ausnahmen </h2><br><blockquote>  In der Ära von PHP4 gab es keine Ausnahmen, alles war viel komplizierter und die Entwickler kämpften mit Fehlern, so gut sie konnten. Es war ein Kampf nicht um das Leben, sondern um den Tod ... Sie können in diese faszinierende Geschichte der Konfrontation im Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Exceptional Code eintauchen.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a>  Soll ich es jetzt lesen?  Ich kann keine eindeutige Antwort geben. Ich möchte nur darauf hinweisen, dass dies Ihnen hilft, die Entwicklung der Sprache zu verstehen, und den ganzen Reiz von Ausnahmen offenbart. </blockquote>  Ausnahmen sind außergewöhnliche Ereignisse in PHP. Im Gegensatz zu Fehlern geben sie nicht nur ein Problem an, sondern erfordern zusätzliche Aktionen des Programmierers, um den jeweiligen Fall zu behandeln. <br><br>  Beispielsweise sollte ein Skript einige Daten in einer Cache-Datei speichern, wenn ein Fehler aufgetreten ist (kein Schreibzugriff, kein Speicherplatz), eine Ausnahme des entsprechenden Typs generiert wird und die Entscheidung im Ausnahmebehandler getroffen wird - Speichern an einem anderen Speicherort oder Informieren Sie den Benutzer über das Problem. <br><br>  Eine Ausnahme ist ein Objekt der <code>Exception</code> Klasse oder eines ihrer vielen Nachkommen. Sie enthält den Fehlertext und den Status sowie möglicherweise einen Link zu einer anderen Ausnahme, die zur Hauptursache dafür geworden ist.  Das Ausnahmemodell in PHP ähnelt dem in anderen Programmiersprachen verwendeten.  Mit dem Operator <code>throw</code> kann eine Ausnahme ausgelöst werden (wie sie sagen: "throw"), und Sie können die <code>catch</code> Anweisung abfangen ("catch").  Der Code, der die Ausnahme auslöst, muss von einem <code>try</code> Block umgeben sein, um die Ausnahme abzufangen.  Jeder <code>try</code> Block muss mindestens einen passenden <code>catch</code> oder <code>finally</code> Block haben: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//      if (random_int(0, 1)) { throw new Exception("One"); } echo "Zero" } catch (Exception $e) { //      echo $e-&gt;getMessage(); }</span></span></code> </pre><br>  In diesen Fällen lohnt es sich, Ausnahmen zu verwenden <br><br><ul><li>  Wenn im Rahmen einer Methode / Funktion mehrere Operationen fehlschlagen </li><li>  wenn Ihr Framework oder Ihre Bibliothek ihre Verwendung deklariert </li></ul><br>  Um das erste Szenario zu veranschaulichen, nehmen wir ein bereits geäußertes Beispiel einer Funktion zum Schreiben von Daten in eine Datei. Viele Faktoren können uns daran hindern. Um dem obigen Code jedoch genau zu sagen, was genau das Problem war, müssen Sie eine Ausnahme erstellen und auslösen: <br><br><pre> <code class="php hljs">$directory = <span class="hljs-keyword"><span class="hljs-keyword">__DIR__</span></span> . DIRECTORY_SEPARATOR . <span class="hljs-string"><span class="hljs-string">'logs'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     if (!is_dir($directory)) { throw new Exception('Directory `logs` is not exists'); } //         if (!is_writable($directory)) { throw new Exception('Directory `logs` is not writable'); } //  -   ,      if (!$file = @fopen($directory . DIRECTORY_SEPARATOR . date('Ym-d') . '.log', 'a+')) { throw new Exception('System can\'t create log file'); } fputs($file, date("[H:i:s]") . " done\n"); fclose($file);</span></span></code> </pre><br>  Dementsprechend werden wir diese Ausnahmen wie folgt abfangen: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//      // ... } catch (Exception $e) { //    echo " : ". $e-&gt;getMessage(); }</span></span></code> </pre><br>  Dieses Beispiel zeigt ein sehr einfaches Szenario für die Behandlung von Ausnahmen, wenn eine Ausnahme auf eine Weise behandelt wird.  Verschiedene Ausnahmen erfordern jedoch häufig einen unterschiedlichen Verarbeitungsansatz. Anschließend sollten Sie Ausnahmecodes verwenden und die Hierarchie der Ausnahmen in der Anwendung festlegen: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//    class FileSystemException extends Exception {} //     class DirectoryException extends FileSystemException { //   const DIRECTORY_NOT_EXISTS = 1; const DIRECTORY_NOT_WRITABLE = 2; } //     class FileException extends FileSystemException {}</span></span></code> </pre><br>  Wenn Sie diese Ausnahmen verwenden, können Sie den folgenden Code erhalten: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//      if (!is_dir($directory)) { throw new DirectoryException('Directory `logs` is not exists', DirectoryException::DIRECTORY_NOT_EXISTS); } if (!is_writable($directory)) { throw new DirectoryException('Directory `logs` is not writable', DirectoryException::DIRECTORY_NOT_WRITABLE); } if (!$file = @fopen($directory . DIRECTORY_SEPARATOR . date('Ym-d') . '.log', 'a+')) { throw new FileException('System can\'t open log file'); } fputs($file, date("[H:i:s]") . " done\n"); fclose($file); } catch (DirectoryException $e) { echo "   : ". $e-&gt;getMessage(); } catch (FileException $e) { echo "   : ". $e-&gt;getMessage(); } catch (FileSystemException $e) { echo "  : ". $e-&gt;getMessage(); } catch (Exception $e) { echo " : ". $e-&gt;getMessage(); }</span></span></code> </pre><br>  Es ist wichtig, sich daran zu erinnern, dass eine Ausnahme in erster Linie ein außergewöhnliches Ereignis ist, dh eine Ausnahme von der Regel.  Sie müssen sie nicht verwenden, um offensichtliche Fehler zu behandeln, z. B. um Benutzereingaben zu überprüfen (obwohl dies nicht so einfach ist).  In diesem Fall sollte der Ausnahmebehandler an der Stelle geschrieben werden, an der er damit umgehen kann.  Der Handler für Ausnahmen, die durch die Unzugänglichkeit einer Datei zum Schreiben verursacht werden, sollte sich beispielsweise in der Methode befinden, die für die Auswahl der Datei verantwortlich ist, oder in der Methode, mit der sie aufgerufen wird, damit eine andere Datei oder ein anderes Verzeichnis ausgewählt werden kann. <br><br>  Was passiert also, wenn Sie die Ausnahme nicht abfangen?  Sie erhalten "Schwerwiegender Fehler: Nicht erfasste Ausnahme ...".  Unangenehm. <br><br>  Um diese Situation zu vermeiden, sollten Sie die Funktion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">set_exception_handler ()</a> verwenden und den Handler für Ausnahmen festlegen, die außerhalb des try-catch-Blocks ausgelöst werden und nicht verarbeitet wurden.  Nach dem Aufrufen eines solchen Handlers wird die Skriptausführung gestoppt: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//     //     set_exception_handler(function($exception) { /** @var Exception $exception */ echo $exception-&gt;getMessage(), "&lt;br/&gt;\n"; echo $exception-&gt;getFile(), ':', $exception-&gt;getLine(), "&lt;br/&gt;\n"; echo $exception-&gt;getTraceAsString(), "&lt;br/&gt;\n"; });</span></span></code> </pre><br>  Ich erzähle Ihnen auch von der Konstruktion mit dem <code>finally</code> Block. Dieser Block wird ausgeführt, unabhängig davon, ob eine Ausnahme ausgelöst wurde oder nicht: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//      } catch (Exception $e) { //      //     } finally { // ,       }</span></span></code> </pre><br>  Um zu verstehen, was uns dies gibt, werde ich das folgende Beispiel für die Verwendung des <code>finally</code> Blocks geben: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">// -    //     $handler = mysqli_connect('localhost', 'root', '', 'test'); try { //        // ... throw new Exception('DB error'); } catch (Exception $e) { //  ,     //     ,    throw new Exception('Catch exception', 0, $e); } finally { // ,      //      finally mysqli_close($handler); } //     ,       echo "Ok"; } catch (Exception $e) { //  ,    echo $e-&gt;getMessage(); echo "&lt;br/&gt;"; //      echo $e-&gt;getPrevious()-&gt;getMessage(); }</span></span></code> </pre><br>  Das heißt,  Denken Sie daran - der <code>finally</code> Block wird auch dann ausgeführt, wenn Sie oben im <code>catch</code> Block eine Ausnahme auslösen (genau das hat er beabsichtigt). <br><br>  Für einen genau einführenden Informationsartikel, der sich nach weiteren Details sehnt, finden Sie diese im Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Außergewöhnlicher Code</a> ;) <br><br><div class="spoiler">  <b class="spoiler_title">Aufgabe</b> <div class="spoiler_text">  Schreiben Sie Ihren Ausnahmebehandler mit der Ausgabe des Texts der Datei, in der der Fehler aufgetreten ist, und vergessen Sie nicht, die Ablaufverfolgung in lesbarer Form anzuzeigen.  Als Referenz sehen Sie, wie cool es auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">whoops</a> aussieht. <br></div></div><br><h3>  PHP7 - alles ist nicht mehr so ​​wie vorher </h3><br>  Jetzt haben Sie alle oben genannten Informationen gelernt und jetzt werde ich Sie mit Innovationen in PHP7 beladen, d. H.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich werde darüber sprechen, was Ihnen bei der Arbeit an einem modernen PHP-Projekt begegnen wird. </font><font style="vertical-align: inherit;">Ich habe es Ihnen bereits gesagt und anhand von Beispielen gezeigt, welche Krücke Sie bauen müssen, um kritische Fehler zu erkennen, und so - in PHP7 haben sie beschlossen, sie zu beheben, aber? </font><font style="vertical-align: inherit;">wie gewöhnlich? </font><font style="vertical-align: inherit;">an die Abwärtskompatibilität des Codes gebunden und erhalten, obwohl eine universelle Lösung, aber es ist alles andere als ideal. </font><font style="vertical-align: inherit;">Und nun zu den Punkten über die Änderungen:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn schwerwiegende Fehler des Typs </font></font><code>E_ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder schwerwiegende Fehler mit der Möglichkeit der Verarbeitung von </font></font><code>E_RECOVERABLE_ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP auftreten, wird eine Ausnahme ausgelöst</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diese Ausnahmen </font><font style="vertical-align: inherit;">erben </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exception-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klasse </font><font style="vertical-align: inherit;">(denken Sie daran, ich habe über Abwärtskompatibilität gesprochen, alles für sie)</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diese Ausnahmen erben die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fehlerklasse</font></font></a> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sowohl die Ausnahme- als auch die Fehlerklasse implementieren die </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Throwable-</font></a><font style="vertical-align: inherit;"> Schnittstelle</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sie können die Throwable-Schnittstelle nicht in Ihrem Code implementieren </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Schnittstelle </font></font><code>Throwable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wiederholt uns fast vollständig </font></font><code>Exception</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Throwable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTraceAsString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPrevious</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Throwable</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span>; }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ist es schwierig </font><font style="vertical-align: inherit;">Nehmen wir zum Beispiel die höheren und leicht modernisierten:</font></font><br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">// ,     include 'e_parse_include.php'; } catch (Error $e) { var_dump($e); }</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Als Ergebnis fangen wir den Fehler und drucken: </font></font><br><br><pre> <code class="bash hljs">object(ParseError)<span class="hljs-comment"><span class="hljs-comment">#1 (7) { ["message":protected] =&gt; string(48) "syntax error, unexpected '' (T_STRING)" ["string":"Error":private] =&gt; string(0) "" ["code":protected] =&gt; int(0) ["file":protected] =&gt; string(49) "/www/education/error/e_parse_include.php" ["line":protected] =&gt; int(4) ["trace":"Error":private] =&gt; array(0) { } ["previous":"Error":private] =&gt; NULL }</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie Sie sehen können, haben sie die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ParseError-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ausnahme </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">abgefangen</font></a><font style="vertical-align: inherit;"> , die der Nachfolger der Ausnahme ist </font></font><code>Error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die die Schnittstelle </font></font><code>Throwable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in dem von Jack erstellten Haus </font><font style="vertical-align: inherit;">implementiert </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Es gibt viele andere Ausnahmen, aber ich werde sie nicht quälen - aus Gründen der Klarheit werde ich eine Hierarchie von Ausnahmen angeben:</font></font><br><br><pre> <code class="bash hljs">interface Throwable |- Exception implements Throwable | |- ErrorException extends Exception | |- ... extends Exception | `- ... extends Exception `- Error implements Throwable |- TypeError extends Error |- ParseError extends Error |- ArithmeticError extends Error | `- DivisionByZeroError extends ArithmeticError `- AssertionError extends Error</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und ein bisschen mehr Details: </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TypeError</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - für Fehler, wenn der Typ der Funktionsargumente nicht mit dem übergebenen Typ übereinstimmt:</font></font><br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $one, int $two)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; })(<span class="hljs-string"><span class="hljs-string">'one'</span></span>, <span class="hljs-string"><span class="hljs-string">'two'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (TypeError $e) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $e-&gt;getMessage(); }</code> </pre><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArithmeticError</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - kann während mathematischer Operationen auftreten, z. B. wenn das Berechnungsergebnis den für eine Ganzzahl zugewiesenen Grenzwert überschreitet:</font></font><br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (ArithmeticError $e) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $e-&gt;getMessage(); }</code> </pre><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DivisionByZeroError</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Division durch Null Fehler:</font></font><br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (ArithmeticError $e) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $e-&gt;getMessage(); }</code> </pre><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AssertionError</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ein seltenes Tier, das auftritt, wenn die in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assert ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> angegebene Bedingung </font><font style="vertical-align: inherit;">nicht erfüllt ist:</font></font><br><br><pre> <code class="php hljs">ini_set(<span class="hljs-string"><span class="hljs-string">'zend.assertions'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); ini_set(<span class="hljs-string"><span class="hljs-string">'assert.exception'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { assert(<span class="hljs-number"><span class="hljs-number">1</span></span> === <span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (AssertionError $e) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $e-&gt;getMessage(); }</code> </pre><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bei Einstellungen Produktion-Server - </font><font style="vertical-align: inherit;">Richtlinie </font></font><code>zend.assertions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>assert.exception</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abgeschnitten, und das zu </font><font style="vertical-align: inherit;">Recht</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine vollständige Liste der vordefinierten Ausnahmen finden Sie im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">offiziellen Handbuch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in derselben Hierarchie der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPL-Ausnahmen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufgabe</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schreiben Sie einen universellen Fehlerbehandler für PHP7, der alle möglichen Ausnahmen abfängt. </font></font><br></div></div><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beim Schreiben dieses Abschnitts wurden Materialien aus dem Artikel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auslösbare Ausnahmen und Fehler in PHP 7 verwendet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Einheitlichkeit </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Es gibt Fehler, Ausnahmen, aber kann das alles irgendwie auf den Haufen gebracht werden? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ja, es ist einfach, wir haben </font></font><code>set_error_handler()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine und niemand wird uns verbieten, eine Ausnahme in diesen Handler zu werfen:</font></font><br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//     function errorHandler($severity, $message, $file = null, $line = null) { //  ,       @ if (error_reporting() === 0) { return false; } throw new \ErrorException($message, 0, $severity, $file, $line); } //   -  set_error_handler('errorHandler', E_ALL);</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieser Ansatz mit PHP7 ist jedoch redundant und kann jetzt alles verarbeiten </font></font><code>Throwable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">/** ... **/</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (\Throwable $e) { <span class="hljs-comment"><span class="hljs-comment">//      echo $e-&gt;getMessage(); }</span></span></code> </pre><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Debuggen </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manchmal müssen Sie zum Debuggen von Code </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nachverfolgen,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> was zu einem bestimmten Zeitpunkt mit einer Variablen oder einem Objekt passiert ist. Für diese Zwecke gibt es eine Funktion </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">debug_backtrace ()</font></a><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">debug_print_backtrace ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die den Verlauf von Aufrufen von Funktionen / Methoden in umgekehrter Reihenfolge zurückgeben:</font></font><br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">example</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;pre&gt;'</span></span>; debug_print_backtrace(); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;/pre&gt;'</span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExampleClass</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ example(); } } ExampleClass::method();</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als Ergebnis der Funktionsausführung </font></font><code>debug_print_backtrace()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird eine Liste der Aufrufe angezeigt, die uns an diesen Punkt gebracht haben:</font></font><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#0 example() called at [/www/education/error/backtrace.php:10] #1 ExampleClass::method() called at [/www/education/error/backtrace.php:14]</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können den Code mit der Funktion </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">php_check_syntax ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder dem Befehl </font><font style="vertical-align: inherit;">auf Syntaxfehler überprüfen </font></font><code>php -l [  ]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, aber ich habe deren Verwendung nicht gesehen.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Behauptet </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich möchte auch über ein so exotisches Biest wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assert ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in PHP </font><font style="vertical-align: inherit;">sprechen </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Eigentlich kann dieses Stück als Mimikry für die Vertragsprogrammierungsmethode angesehen werden, und dann werde ich Ihnen sagen, wie ich es nie benutzt habe :)</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Funktion </font></font><code>assert()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hat ihr Verhalten während des Übergangs von Version 5.6 auf 7.0 geändert, und in Version 7.2 hat sich alles noch stärker geändert. Lesen Sie daher die Änderungsprotokolle und PHP sorgfältig durch.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Der erste Fall ist, wenn Sie TODO direkt in den Code schreiben müssen, damit Sie nicht vergessen, die angegebene Funktionalität zu implementieren: </font></font><br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  asserts  php.ini // zend.assertions=1 assert(false, "Remove it!");</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als Ergebnis dieses Codes erhalten wir </font></font><code>E_WARNING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="bash hljs">Warning: assert(): Remove it! failed</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP7 kann in den Ausnahmemodus geschaltet werden, und anstelle eines Fehlers wird immer eine Ausnahme angezeigt </font></font><code>AssertionError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//    «» ini_set('assert.exception', 1); assert(false, "Remove it!");</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infolgedessen erwarten wir eine Ausnahme </font></font><code>AssertionError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bei Bedarf können Sie eine beliebige Ausnahme auslösen:</font></font><br><br><pre> <code class="php hljs">assert(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span>(<span class="hljs-string"><span class="hljs-string">"Remove it!"</span></span>));</code> </pre><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich würde die Verwendung von Tags empfehlen </font></font><code>@TODO</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, moderne IDEs funktionieren gut mit ihnen, und Sie müssen keine zusätzlichen Anstrengungen und Ressourcen aufwenden, um mit ihnen zu arbeiten, obwohl die Versuchung groß ist, mit ihnen zu „punkten“</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der zweite Anwendungsfall besteht darin, eine Art TDD zu erstellen. Denken Sie jedoch daran, dass dies nur eine Ähnlichkeit ist. </font><font style="vertical-align: inherit;">Wenn Sie sich jedoch anstrengen, erhalten Sie ein lustiges Ergebnis, das Ihnen beim Testen Ihres Codes hilft:</font></font><br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// callback-      function backlog($script, $line, $code, $message) { echo $message; } //  callback- assert_options(ASSERT_CALLBACK, 'backlog'); //    assert_options(ASSERT_WARNING, false); //      assert(sqr(4) === 16, 'When I send integer, function should return square of it'); // ,   function sqr($a) { return; //    }</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Die dritte Option ist eine Art Vertragsprogrammierung, bei der Sie die Regeln für die Verwendung Ihrer Bibliothek beschrieben haben, aber sicherstellen möchten, dass Sie richtig verstanden werden. In diesem Fall teilen Sie dem Entwickler sofort einen Fehler mit (ich bin mir nicht einmal sicher, ob ich ihn richtig verstehe, sondern ein Beispiel Der Code funktioniert ziemlich gut): </font></font><br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** *        * * [ * 'host' =&gt; 'localhost', * 'port' =&gt; 3306, * 'name' =&gt; 'dbname', * 'user' =&gt; 'root', * 'pass' =&gt; '' * ] * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> $settings */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupDb</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($settings)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   assert(isset($settings['host']), 'Db `host` is required'); assert(isset($settings['port']) &amp;&amp; is_int($settings['port']), 'Db `port` is required, should be integer'); assert(isset($settings['name']), 'Db `name` is required, should be integer'); //    // ... } setupDb(['host' =&gt; 'localhost']);</span></span></code> </pre><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie an Verträgen interessiert sind, habe ich speziell für Sie einen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link zum PhpDeal-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Framework </font><font style="vertical-align: inherit;">.</font></font></blockquote><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwenden </font></font><code>assert()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie </font><font style="vertical-align: inherit;">diese Option </font><font style="vertical-align: inherit;">niemals </font><font style="vertical-align: inherit;">, um die Eingabeparameter zu überprüfen, da sie tatsächlich </font></font><code>assert()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">den ersten Parameter interpretiert (verhält sich wie </font></font><code>eval()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) und dies mit einer PHP-Injektion behaftet ist. </font><font style="vertical-align: inherit;">Und ja, dies ist das richtige Verhalten, denn wenn Sie die Zusicherung deaktivieren, werden alle übergebenen Argumente ignoriert. Wenn Sie wie im obigen Beispiel vorgehen, wird der Code ausgeführt und das boolesche Ergebnis der Ausführung wird innerhalb der deaktivierten Zusicherung übergeben. </font><font style="vertical-align: inherit;">Oh, und es hat sich in PHP 7.2 geändert :)</font></font></blockquote><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie eine Live-Nutzungserfahrung haben </font></font><code>assert()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- teilen Sie sie mir mit, ich bin Ihnen dankbar. </font><font style="vertical-align: inherit;">Und ja, hier ist eine weitere interessante Lektüre zu diesem Thema - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP Assertions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mit der gleichen Frage am Ende :)</font></font><br><br><h2>  Abschließend </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ich werde die Schlussfolgerungen aus diesem Artikel für Sie schreiben: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fehler bekämpfen - sie sollten nicht in Ihrem Code enthalten sein </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verwenden Sie Ausnahmen - die Arbeit mit ihnen muss richtig organisiert sein und es wird Glück geben </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Behauptung - über sie gelernt, und gut </font></font></li></ul><br><h3>  PS </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies ist ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus einer Reihe von Artikeln "PHP für Anfänger":</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Sitzung</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dateiverbindung</font></font></a> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fehlerbehandlung</font></font></b> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie Kommentare zum Material des Artikels oder möglicherweise in Form haben, beschreiben Sie das Wesentliche in den Kommentaren, und wir werden dieses Material noch besser machen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vielen Dank an </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maxim Slesarenko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für die Hilfe beim Schreiben des Artikels.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de440744/">https://habr.com/ru/post/de440744/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de440732/index.html">Aktualisieren Sie ein Debug-Board mit einem Baikal-T1-Prozessor: Fügen Sie eine SD-Karte hinzu</a></li>
<li><a href="../de440734/index.html">Open Session In View im Frühjahr Boot: The Phantom Menace</a></li>
<li><a href="../de440736/index.html">Ich ruiniere das Leben der Entwickler mit meinen Codeüberprüfungen und es tut mir leid</a></li>
<li><a href="../de440740/index.html">Offenes Webinar „Customer Journey: Welcher Verkehr und wohin führen?“</a></li>
<li><a href="../de440742/index.html">AMP- und Turbo-Seiten: Vor- und Nachteile sowie Implementierungsergebnisse</a></li>
<li><a href="../de440746/index.html">Die Wissensmanagement-Technologiezyklen von Gartner werden anhand von Fallstudien bei KnowledgeConf durchgeführt</a></li>
<li><a href="../de440748/index.html">Der schnellste Supercomputer der Welt bricht den KI-Rekord</a></li>
<li><a href="../de440752/index.html">Auswahl der Priorität der Benutzeranforderung</a></li>
<li><a href="../de440754/index.html">Plattformübergreifendes englisches Dienstprogramm zum Anzeigen russisch qualifizierter Zertifikate x509</a></li>
<li><a href="../de440756/index.html">Serverloses CI / CD unter AWS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>