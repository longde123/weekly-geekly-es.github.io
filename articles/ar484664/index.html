<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ โค๏ธ ๐ง๐ฝ ุทุฑูุงุฏุฉ ุฃุฎุฑู [ุชูุฑูุจูุง] ุบูุฑ ูุงุจูุฉ ููุชุดููู ููุธุงู Android ๐ฃ ๐ก ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ููุงูุฉ ุงูุนุงู ุงููุงุถู ุ ุจุงุณุชุฎุฏุงู ูุธููุฉ ุงููุดู ุนู ุงูุชุบููุฑ ูู ููุทูุฉ ุงููุธุงู ุ ุณุฌู ุจุนุถ ูุณุชุฎุฏูููุง ุชุบููุฑูุง ูู ููู ุงููุธุงู / system/lib/libc.so. ูุฐุง ูู ูุงุญุฏ ูู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุทุฑูุงุฏุฉ ุฃุฎุฑู [ุชูุฑูุจูุง] ุบูุฑ ูุงุจูุฉ ููุชุดููู ููุธุงู Android</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/drweb/blog/484664/" style=";text-align:right;direction:rtl">  ูู ููุงูุฉ ุงูุนุงู ุงููุงุถู ุ ุจุงุณุชุฎุฏุงู ูุธููุฉ ุงููุดู ุนู ุงูุชุบููุฑ ูู ููุทูุฉ ุงููุธุงู ุ ุณุฌู ุจุนุถ ูุณุชุฎุฏูููุง ุชุบููุฑูุง ูู ููู ุงููุธุงู / system/lib/libc.so.  ูุฐุง ูู ูุงุญุฏ ูู ุงูููุชุจุงุช ุงูุฑุฆูุณูุฉ ูุฃูุธูุฉ ุงูุชุดุบูู ุงููุณุชูุฏุฉ ุฅูู Linux ุงููุณุคููุฉ ุนู ููุงููุงุช ุงููุธุงู ูุงููุธุงุฆู ุงูุฃุณุงุณูุฉ.  ูุดู ูุญุต ููุตู ููุฐู ุงูุญุงูุฉ ุนู ุนููุงุช ุฌุฏูุฏุฉ ูู ุนุงุฆูุฉ <a href="https://vms.drweb.ru/search/%3Fq%3DAndroid.Xiny%255E_%255Eamp%255E_%255Elng%3Dru">Android.Xiny</a> ูู ุฃุญุตูุฉ ุทุฑูุงุฏุฉ ุ ุงููุนุฑููุฉ ููุง ููุฐ ุนุงู 2015. <br><br>  ูุฃูู ูุฑุฉ ุ ุฑุฃููุง ุชุซุจูุช ุงูุณูุฉ " <a href="https://ru.wikipedia.org/wiki/Chattr">ุบูุฑ ุงููุงุจูุฉ ููุชุบููุฑ</a> " ุนูู ูููุงุช ููุซูููุง ุ ููุง ุฃุฏู ุฅูู ุชุนููุฏ ูุจูุฑ ูู ุฅุฒุงูุฉ ุญุตุงู ุทุฑูุงุฏุฉ ูู ุงูุฃุฌูุฒุฉ. <br><a name="habracut"></a><br>  ุจุฏุช ูุณููุฉ ุชูุงููุง: ุชู ูุถุน ุงูุณูุฉ ุงููุญุฏุฏุฉ ุนูู ููู apk ููุชุทุจูู ุงููุซุจุช ุ ููุงูุช ูุญุงููุฉ ุฅุฒุงูุฉ ูุฐุง ุงูุชุทุจูู ูุงุฌุญุฉ ุ ูุชู ุญุฐู ุจูุงูุงุชู ุ ููู ููู apk ููุณู ุธู ูู ููุงูู.  ุจุนุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฌูุงุฒ ุ "ุธูุฑ" ุงูุชุทุจูู ูุฑุฉ ุฃุฎุฑู.  <a href="https://news.drweb.ru/show/%3Fi%3D10211">ุชุญุฏุซูุง</a> ุนู ุฃุญุฏ ูุฐู ุฃุญุตูุฉ ุทุฑูุงุฏุฉ ูู ุนุงู 2016.  ูููุงูุญุฉ ูุซู ูุฐู ุงูุชูุฏูุฏุงุช ุ ุฃุถููุง ูุธููุฉ ุฅุนุงุฏุฉ ุชุนููู ุณูุฉ ุงูููู ุฅูู ุจุฑูุงูุฌ ููุงูุญุฉ ุงูููุฑูุณุงุช ุงูุฎุงุต ุจูุง ุ ูุงูุฐู ูุนูู ุจุดุฑุท ููุญ ุงููุณุชุฎุฏู ุงูุชูุงุฒุงุช ุงูุฌุฐุฑ ูุจุฑูุงูุฌ ููุงูุญุฉ ุงูููุฑูุณุงุช. <br><br>  ูู ูุฐู ุงูููุงูุฉ ุ ุณููุธุฑ ูู ุทุฑููุฉ ุฃุฎุฑู ูุซูุฑุฉ ููุฏูุงุน ุนู ุงูููุณ ุ ุชุณุชุฎุฏููุง ุงูุฅุตุฏุงุฑุงุช ุงูุฌุฏูุฏุฉ ูู Android.Xiny. <br><br><h3 style=";text-align:right;direction:rtl">  ุฃูุฏุฑููุฏ 5.1ุ  ูู 2019ุ </h3><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/x3/-p/ot/x3-potio4wcuk7bwv6fqzyvc9fu.png"></div><br>  ุชุนูู ุทุฑูุงุฏุฉ ุงููุฐููุฑุฉ ูู ูุฐู ุงูููุงูุฉ ุนูู ูุธุงู ุฃูุฏุฑููุฏ ุญุชู ุงูุฅุตุฏุงุฑ 5.1 ุงูุดุงูู.  ูุฏ ูุจุฏู ูู ุงูุบุฑูุจ ุฃู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุงููุตููุฉ ููุซู ูุฐู ุงูุฅุตุฏุงุฑุงุช "ุงููุฏููุฉ" ูู ูุธุงู Android ูุง ุฒุงูุช ูุดุทุฉ (ุชู ุฅุตุฏุงุฑ ุงูุฅุตุฏุงุฑ 5.1 ูู ุนุงู 2015).  ูููู ุนูู ุงูุฑุบู ูู ุงูุนูุฑ ุ ูุง ุชุฒุงู ุงูุฅุตุฏุงุฑุงุช ุงููุฏููุฉ ููุฏ ุงูุงุณุชุฎุฏุงู.  ููููุง <a href="https://developer.android.com/about/dashboards/">ูู Google ุ</a> ุงุนุชุจุงุฑูุง ูู 7 ูุงูู 2019 ุ ูุฅู 25.2ูช ูู ุงูุฃุฌูุฒุฉ ุชุนูู ุจูุธุงู Android 5.1 ููุง ุฏููู.  ุฅุญุตุงุกุงุช ููุณุชุฎุฏูููุง ูุนุทู ุนุฏุฏ ุฃูุจุฑ ููููุง - ุญูุงูู 26 ูช.  ูุฐุง ูุนูู ุฃู ุญูุงูู ุฑุจุน ุฃุฌูุฒุฉ Android ูู ุฃูุฏุงู ูุญุชููุฉ ุ ููู ููุณุช ุตุบูุฑุฉ ุฌุฏูุง.  ูุธุฑูุง ูุฃู ูุฐู ุงูุฃุฌูุฒุฉ ุนุฑุถุฉ ูููุงุท ุงูุถุนู ุงูุชู ูู ูุชู ุฅุตูุงุญูุง ุฃุจุฏูุง ุ ูููุณ ูู ุงููุณุชุบุฑุจ ุฃู ุงูุฅุตุฏุงุฑุงุช ุงููุฏููุฉ ูู ูุธุงู ุงูุชุดุบูู Android ูุง ุชุฒุงู ุชูู ูุชุงุจ ุงูููุฑูุณุงุช.  ูู ุงููุงูุน ุ ุญููู ุงูุฌุฐุฑ ุ ูุงูุชู ูููู ุงูุญุตูู ุนูููุง ุนู ุทุฑูู ุงุณุชุบูุงู ุงูุซุบุฑุงุช ุงููุฐููุฑุฉ ุ ุชููู ุจูู ุฃูุฏู ูุชุงุจ ุงูููุฑูุณุงุช - ุจูุณุงุนุฏุชูู ุ ููููู ุงูููุงู ุจุฃู ุดูุก ุนูู ุงูุฌูุงุฒ.  ุนูู ุงูุฑุบู ูู ุฃูู ูู ุฃุบูุจ ุงูุฃุญูุงู ูุชุนูู ุงูุฃูุฑ ุจุงูุชุซุจูุช ุงูุนุงุฏู ููุชุทุจููุงุช. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูููุงู ุงูุฑุฆูุณูุฉ ูู ุทุฑูุงุฏุฉ </h3><br>  ุจุฏุกูุง ูู ุงูุฅุตุฏุงุฑุงุช ุงูุฃูุฏู ุ ุชุชูุซู ุงููุธููุฉ ุงูุฑุฆูุณูุฉ ูู Android.Xiny Trojan ูู ุชุซุจูุช ุงูุชุทุจููุงุช ุงูุชุนุณููุฉ ุนูู ุงูุฌูุงุฒ ุฏูู ุฅุฐู ุงููุณุชุฎุฏู.  ูุจุงูุชุงูู ุ ูููู ููููุงุฌููู ูุณุจ ุงููุงู ูู ุฎูุงู ุงููุดุงุฑูุฉ ูู ุงูุจุฑุงูุฌ ุงูุชุงุจุนุฉ ุงูุชู ุชุฏูุน ุซูู ุงูุชุซุจูุช.  ุจูุฏุฑ ูุง ูููู ูููุฑุก ุฃู ูุญูู ุ ููุฐุง ูู ูุงุญุฏ ูู ูุตุงุฏุฑ ุงูุฏุฎู ุงูุฑุฆูุณูุฉ ูููุจุฏุนูู ูู ูุฐู ุงูุฃุณุฑุฉ.  ุจุนุฏ ุฅุทูุงู ุจุนุถ ููุซูููุง ุ ููููู ุงูุญุตูู ุนูู ุฌูุงุฒ ุบูุฑ ูุนุงู ุนูููุงู ูู ุบุถูู ุฏูุงุฆู ููููุฉ ุ ุญูุซ ุณูุชู ุชุซุจูุช ูุฅุทูุงู ุงูุนุฏูุฏ ูู ุชุทุจููุงุช ุงููุณุชุฎุฏููู ุบูุฑ ุงูุถุงุฑุฉ ูููู ุบูุฑ ุงูุถุฑูุฑูุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูููู ููุฐู ุฃุญุตูุฉ ุทุฑูุงุฏุฉ ุฃูุถูุง ุชุซุจูุช ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ - ูู ูุฐุง ูุชููู ุนูู ุงูุฃูุฑ ุงูุฐู ุชู ุงุณุชูุงูู ูู ุฎุงุฏู ุงูุฅุฏุงุฑุฉ. <br><br>  ุงูุดูุก ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ุงูุฐู ููุทูู ุฅุตุฏุงุฑุงุช ุฌุฏูุฏุฉ ูู Android.Xiny Trojan ูู ุงูุญูุงูุฉ ุถุฏ ุงูุญุฐู.  ุนูุตุฑูู ูุณุคูููู ุนู ุฐูู.  ูููุธุฑ ูููุง ุจูุฒูุฏ ูู ุงูุชูุตูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุซุจุช </h3><br>  sha1: f9f87a2d2f4d91cd450aa9734e09534929170c6c <br>  ุงููุดู: Android.Xiny.5261 <br><br>  ูุจุฏุฃ ูุฐุง ุงููููู ุจุนุฏ ุงูุญุตูู ุนูู ุงูุชูุงุฒุงุช ุงูุฌุฐุฑ.  ูุญู ูุญู ูููุงุช ุงููุธุงู / system / bin / debuggerd ู / system / bin / ddexe ูุถูุงู ุชุดุบููู ุชููุงุฆููุง ุ ููุญูุธ ุงููุณุฎ ุงูุฃุตููุฉ ุชุญุช ุงูุฃุณูุงุก ุจุงุณุชุฎุฏุงู ุงููุงุญูุฉ _server ุ ูุชุตุฑู ูุซู ููุฑูุณ ูุตุงุญุจ ุชูููุฏู.  ูููู ุฃูุถูุง ุจูุณุฎ ุงูุนุฏูุฏ ูู ุงููููุงุช ุงููุงุจูุฉ ููุชูููุฐ ุฅูู ูุณู ุงููุธุงู ูู ุงููุฌูุฏ ุงูุฐู ุชู ุชูุฑูุฑู ูู ูุนููุงุช ุณุทุฑ ุงูุฃูุงูุฑ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูููู ูู Trojan ุชุญุฏูุซ ุงูููููุงุช ุงูุชู ุชู ุชุซุจูุชูุง ูู ูุณู ุงููุธุงู ุฅุฐุง ููุช ุจุชุดุบูููุง ุจุงุณุชุฎุฏุงู ูุนููุงุช ุฎุงุตุฉ ูุชุญุฏูุฏ ุงููุฌูุฏ ุงูุฐู ุชูุฌุฏ ุจู ุงูุฅุตุฏุงุฑุงุช ุงูุฌุฏูุฏุฉ. <br><br>  ูุญุชูู Android.Xiny.5261 ุนูู ูุงุฆูุฉ ุฑุงุฆุนุฉ ูู ุงููููุงุช ุงููุฑุงุฏ ุญุฐููุง.  ููุดูู ูุณุงุฑุงุช ูููุฒุฉ ููุฃูุฑุงุฏ ุงูุฃูุฏู ูู ุงูุนุงุฆูุฉ ุ ููุฐูู ุงูุนุงุฆูุงุช ุงููุชูุงูุณุฉ ูู ุฃุญุตูุฉ ุทุฑูุงุฏุฉ ุงููุซุจุชุฉ ูู ูุณู ุงููุธุงู.  ูุซู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุชุฑูุงุฏุง. <br><br><img src="https://habrastorage.org/webt/yf/7m/l3/yf7ml3l3uhedosepu-agiljdlso.png"><br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุฒูู Android.Xiny.5261 ุจุนุถ ุงูุชุทุจููุงุช ุงููุซุจุชุฉ ูุณุจููุง - ุฑุจูุง ูุฅูุฑุงุบ ุงููุณุงุญุฉ.  ุฃุฎูุฑูุง ุ ูุฒูู ุชุทุจููุงุช ุฅุฏุงุฑุฉ ุญููู ุงูุฌุฐุฑ ุงููุนุฑููุฉ - ูุซู SuperSU ู KingRoot ูุบูุฑูุง.  ูุจุงูุชุงูู ุ ูุฅูู ูุญุฑู ุงููุณุชุฎุฏู ูู ุงููุฏุฑุฉ ุนูู ุงุณุชุฎุฏุงู ุญููู ุงูุฌุฐุฑ ุ ูุจุงูุชุงูู ุ ุฅุฒุงูุฉ ููููุงุช ุทุฑูุงุฏุฉ ุงููุซุจุชุฉ ูู ูุณู ุงููุธุงู. <br><br><h3 style=";text-align:right;direction:rtl">  ููุชุจุฉ ุงููุธุงู ุงููุนุฏูุฉ libc.so </h3><br>  sha1: 171dba383d562bec235156f101879223bf7b32c7 <br>  ุงููุดู: Android.Xiny.5260 <br><br>  ูุฐุง ุงูููู ููููุง ุฃูุซุฑ ุ ููุฐุง ุงูุจุญุซ ุจุฏุฃ ุจู.  ุชูุดู ูุธุฑุฉ ุณุฑูุนุฉ ุนูู ุฐูู ูู hiew ุนู ูุฌูุฏ ุชุนูููุงุช ุจุฑูุฌูุฉ ูุงุจูุฉ ููุชูููุฐ ุจุงููุฑุจ ูู ุงูููุงูุฉ ูู ูุณู .data ุ ููู ุฃูุฑ ูุดุจูู. <br><br><img src="https://habrastorage.org/webt/n3/fl/7p/n3fl7p-yiggouva9njlmfxm2ova.png"><br><br><img src="https://habrastorage.org/webt/0p/bh/vm/0pbhvm1hbckkov1hzkk2-_84tv4.png"><br><br>  ุงูุชุญ ุงูููู ูู ุงููุคุณุณุฉ ุงูุฏูููุฉ ููุชูููุฉ ูุดุงูุฏ ููุน ุงูููุฏ ุงูุฐู ูู ุนููู. <br><br>  ุงุชุถุญ ุฃู ุงููุธุงุฆู ุงูุชุงููุฉ ูุฏ ุชู ุชุบููุฑูุง ูู ูุฐู ุงูููุชุจุฉ: mount ุ execve ุ execv ุ execvp ุ execle ุ execl ุ execlp. <br><br>  ุชุนุฏูู ุฑูุฒ ูุธููุฉ ุฌุจู: <br><blockquote style=";text-align:right;direction:rtl">  <font color="#993333">int</font> __ fastcall mount <font color="#009900">(</font> <font color="#993333">const</font> <font color="#993333">char</font> <font color="#339933">*</font> source <font color="#339933">ุ</font> <font color="#993333">const</font> <font color="#993333">char</font> <font color="#339933">*</font> target <font color="#339933">ุ</font> <font color="#993333">const</font> <font color="#993333">char</font> <font color="#339933">*</font> filesystemtype <font color="#339933">ุ</font> ุนูุงูุฉ mount <font color="#993333">int</font> <font color="#993333">ุบูุฑ ุงููููุนุฉ</font> <font color="#339933">ุ</font> <font color="#993333">const</font> <font color="#993333">void</font> <font color="#339933">*</font> data <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  <font color="#993333">ุบูุฑ ูููุนุฉ</font> __int8 systemPath <font color="#009900">[</font> <font color="#0000dd">19</font> <font color="#009900">]</font> <font color="#339933">ุ</font>  <font color="#666666">// [sp + 18h] [bp-1Ch]</font> <br>  ุงุณุชูุจู ููุทูู  <font color="#666666">// [sp + 2Bh] [bp-9h]</font> <br>  <font color="#993333">ูุซุงูุฉ ุงูุนูููุงุช</font> v13 <font color="#339933">ุ</font>  <font color="#666666">// [sp + 2Ch] [bp-8h]</font> <br>  v13 <font color="#339933">=</font> MAGIC_MOUNTFLAGS <font color="#339933">ุ</font>  <font color="#666666">// 0x7A3DC594</font> <br>  receivedMagicFlags <font color="#339933">=</font> mountflags <font color="#339933">==</font> MAGIC_MOUNTFLAGS <font color="#339933">ุ</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> ุนูุงูุงุช ุงูุชุญููู <font color="#339933">==</font> MAGIC_MOUNTFLAGS <font color="#009900">)</font> <br>  mountflags <font color="#339933">=</font> <font color="#208080">0x20</font> <font color="#339933">ุ</font>  <font color="#666666">// MS_REMOUNT</font> <br>  <font color="#b1b100">ุฅุฐุง</font> <font color="#009900">(</font> receivedMagicFlags <font color="#009900">)</font> <br>  <font color="#b1b100">ุฅุฑุฌุงุน</font> call_real_mount <font color="#009900">(</font> ุงููุตุฏุฑ <font color="#339933">ุ</font> ุงููุฏู <font color="#339933">ุ</font> ูุธุงู ุงููููุงุช <font color="#339933">ุ</font> ุนูุงูุงุช ุงูุชุญููู <font color="#339933">ุ</font> ุงูุจูุงูุงุช <font color="#009900">)</font> <font color="#339933">ุ</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> mountflags <font color="#339933">&amp;</font> <font color="#0000dd">1</font> <font color="#009900">)</font> <font color="#666666">// MS_RDONLY</font> <br>  <font color="#b1b100">ุฅุฑุฌุงุน</font> call_real_mount <font color="#009900">(</font> ุงููุตุฏุฑ <font color="#339933">ุ</font> ุงููุฏู <font color="#339933">ุ</font> ูุธุงู ุงููููุงุช <font color="#339933">ุ</font> ุนูุงูุงุช ุงูุชุญููู <font color="#339933">ุ</font> ุงูุจูุงูุงุช <font color="#009900">)</font> <font color="#339933">ุ</font> <br>  <font color="#b1b100">ุฅุฐุง</font> <font color="#009900">(</font> getuid_ <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#666666">// ููุณ ุงูุฌุฐุฑ</font> <br>  <font color="#b1b100">ุฅุฑุฌุงุน</font> call_real_mount <font color="#009900">(</font> ุงููุตุฏุฑ <font color="#339933">ุ</font> ุงููุฏู <font color="#339933">ุ</font> ูุธุงู ุงููููุงุช <font color="#339933">ุ</font> ุนูุงูุงุช ุงูุชุญููู <font color="#339933">ุ</font> ุงูุจูุงูุงุช <font color="#009900">)</font> <font color="#339933">ุ</font> <br>  memCopy <font color="#009900">(</font> systemPath <font color="#339933">ุ</font> <font color="#009900">(</font> <font color="#993333">ุบูุฑ ูููุน</font> __int8 <font color="#339933">*</font> <font color="#009900">)</font> off_73210 <font color="#339933">+</font> <font color="#0000dd">471424</font> <font color="#339933">ุ</font> <font color="#0000dd">8</font> <font color="#009900">)</font> <font color="#339933">ุ</font>  <font color="#666666">// / ุงููุธุงู</font> <br>  ูู ุชุดููุฑ <font color="#009900">(</font> systemPath <font color="#339933">ุ</font> <font color="#0000dd">8</font> <font color="#009900">)</font> <font color="#339933">ุ</font> <br>  <font color="#b1b100">ุฅุฐุง ูุงู</font> <font color="#009900">(</font> memCompare <font color="#009900">(</font> <font color="#009900">(</font> <font color="#993333">ุบูุฑ ูููุน</font> __int8 <font color="#339933">*</font> <font color="#009900">)</font> ูุฏููุง <font color="#339933">ุ</font> systemPath <font color="#339933">ุ</font> <font color="#0000dd">8</font> <font color="#009900">)</font> <font color="#339933">||</font> <font color="#339933">!</font> isBootCompete <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">)</font> <br>  <font color="#b1b100">ุฅุฑุฌุงุน</font> call_real_mount <font color="#009900">(</font> ุงููุตุฏุฑ <font color="#339933">ุ</font> ุงููุฏู <font color="#339933">ุ</font> ูุธุงู ุงููููุงุช <font color="#339933">ุ</font> ุนูุงูุงุช ุงูุชุญููู <font color="#339933">ุ</font> ุงูุจูุงูุงุช <font color="#009900">)</font> <font color="#339933">ุ</font> <br>  <font color="#339933">*</font> <font color="#009900">(</font> _DWORD <font color="#339933">*</font> <font color="#009900">)</font> errno_ <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">=</font> <font color="#0000dd">13</font> <font color="#339933">ุ</font> <br>  <font color="#b1b100">ุนูุฏุฉ</font> <font color="#339933">-</font> <font color="#0000dd">1</font> <font color="#339933">ุ</font> <br>  <font color="#009900">}</font> <br></blockquote><br>  ูู ุงูุจุฏุงูุฉ ุ ูุชู ูุญุต ุงููุนููุฉ mountflags ููุฌูุฏ ุงููููุฉ "ุงูุณุญุฑูุฉ" 0x7A3DC594.  ุฅุฐุง ุชู ุชูุฑูุฑ ูุฐู ุงููููุฉ ุฅูู ุงููุธููุฉ ุ ูุชู ููู ุงูุชุญูู ุนูู ุงูููุฑ ุฅูู ูุธููุฉ ุงูุชุญููู ุงูุญููููุฉ.  ุจุนุฏ ุฐูู ุ ูุชู ุงูุชุญูู ููุง ุฅุฐุง ูุงูุช ููุงู ูุญุงููุฉ ูุฅุนุงุฏุฉ ุชุญููู ูุณู / ุงููุธุงู ูููุชุงุจุฉ ููุง ุฅุฐุง ูุงู ูุฏ ุชู ุฅููุงู ุชูููุฏ ูุธุงู ุงูุชุดุบูู.  ุฅุฐุง ุชู ุงุณุชููุงุก ูุฐู ุงูุดุฑูุท ุ ููู ูุชู ุงุณุชุฏุนุงุก ูุธููุฉ ุงูุชุญููู ุงูุญููููุฉ ููุชู ุฅุฑุฌุงุน ุฎุทุฃ.  ูุจุงูุชุงูู ุ ูุฅู ูุธููุฉ ุงูุชุฑููุจ ุงููุนุฏูุฉ ุจูุงุณุทุฉ ุทุฑูุงุฏุฉ ูุง ุชุณูุญ ูุฃู ุดุฎุต ุจุฅุนุงุฏุฉ ุชุฑููุจ ูุณู ุงููุธุงู ูููุชุงุจุฉ ุ ุจุงุณุชุซูุงุก ุทุฑูุงุฏุฉ ููุณูุง ุ ูุงูุชู ุชุทูู ุนูููุง ุงููุนููุฉ "ุงูุณุญุฑูุฉ". <br><br>  ุฑูุฒ ูุธููุฉ exec ุงููุนุฏูุฉ (ูู ุจููุฉ ูุธุงุฆู exec * ูู ุดูุก ูู ููุณู): <br><blockquote style=";text-align:right;direction:rtl">  <font color="#993333">int</font> __fastcall execve <font color="#009900">(</font> <font color="#993333">const</font> <font color="#993333">char</font> <font color="#339933">*</font> filename <font color="#339933">ุ</font> <font color="#993333">char</font> <font color="#339933">*</font> <font color="#993333">const</font> argv <font color="#009900">[</font> <font color="#009900">]</font> <font color="#339933">ุ</font> <font color="#993333">char</font> <font color="#339933">*</font> <font color="#993333">const</font> envp <font color="#009900">[</font> <font color="#009900">]</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  <font color="#993333">int</font> v3 <font color="#339933">ุ</font>  <font color="#666666">// r3</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> targetInDataOrSdcard <font color="#009900">(</font> filename <font color="#009900">)</font> <font color="#339933">&gt; =</font> <font color="#0000dd">0</font> <font color="#009900">)</font> <font color="#666666">// ุจุฅุฑุฌุงุน -1 ุฅุฐุง ูุงู ุตุญูุญูุง</font> <br>  <font color="#009900">{</font> <br>  sub_7383C <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">ุ</font> <br>  v3 <font color="#339933">=</font> call_real_execve <font color="#009900">(</font> ุงุณู ุงูููู <font color="#339933">ุ</font> argv <font color="#339933">ุ</font> envp <font color="#009900">)</font> <font color="#339933">ุ</font> <br>  <font color="#009900">}</font> <br>  <font color="#b1b100">ุขุฎุฑ</font> <br>  <font color="#009900">{</font> <br>  <font color="#339933">*</font> <font color="#009900">(</font> _DWORD <font color="#339933">*</font> <font color="#009900">)</font> errno_ <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">=</font> <font color="#0000dd">13</font> <font color="#339933">ุ</font> <br>  v3 <font color="#339933">=</font> <font color="#339933">-</font> <font color="#0000dd">1</font> <font color="#339933">ุ</font> <br>  <font color="#009900">}</font> <br>  <font color="#b1b100">ุนูุฏุฉ</font> v3 <font color="#339933">.</font> <br>  <font color="#009900">}</font> <br><br>  <font color="#993333">int</font> __ fastcall targetInDataOrSdcard <font color="#009900">(</font> <font color="#993333">const</font> <font color="#993333">char</font> <font color="#339933">*</font> path <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  <font color="#993333">ุดุงุฑ</font> ุจูู <font color="#009900">[</font> <font color="#0000dd">516</font> <font color="#009900">]</font> <font color="#339933">ุ</font>  <font color="#666666">// [sp + 8h] [bp-204h]</font> <br>  <font color="#b1b100">ุฅุฐุง</font> <font color="#009900">(</font> isDataOrSdcard <font color="#009900">(</font> ุงููุณุงุฑ <font color="#009900">)</font> <font color="#009900">)</font> <br>  <font color="#b1b100">ุนูุฏุฉ</font> <font color="#339933">-</font> <font color="#0000dd">1</font> <font color="#339933">ุ</font> <br>  <font color="#b1b100">ุฅุฐุง</font> <font color="#009900">(</font> <font color="#339933">*</font> path <font color="#339933">==</font> <font color="#ff0000">'.'</font> <font color="#339933">&amp;&amp;</font> getcwd_ <font color="#009900">(</font> buf <font color="#339933">ุ</font> 0x200u <font color="#009900">)</font> <font color="#339933">&amp;&amp;</font> isDataOrSdcard <font color="#009900">(</font> buf <font color="#009900">)</font> <font color="#009900">)</font> <br>  <font color="#b1b100">ุนูุฏุฉ</font> <font color="#339933">-</font> <font color="#0000dd">1</font> <font color="#339933">ุ</font> <br>  <font color="#b1b100">ุนูุฏุฉ</font> <font color="#0000dd">0</font> <font color="#339933">ุ</font> <br>  <font color="#009900">}</font> <br></blockquote><br>  ููุง ูุชู ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุงุฑ ุฅูู ุงูููู ุงูุฐู ุชู ุฅุทูุงูู ูุจุฏุฃ ุจู "/ data /" ููุง ุฅุฐุง ูุงู ูุญุชูู ุนูู "/ sdcard".  ุฅุฐุง ุชู ุงุณุชููุงุก ุฃุญุฏ ุงูุดุฑูุท ุ ูุชู ุญุธุฑ ุงูุจุฏุงูุฉ.  ุชุฐูุฑ ุฃูู ุนูู ุทูู ุงููุณุงุฑ / ุงูุจูุงูุงุช / ุงูุจูุงูุงุช / ูู ุฏูุงุฆู ุงูุชุทุจูู.  ูุฐุง ูููุน ุชูููุฐ ุงููููุงุช ุงููุงุจูุฉ ููุชูููุฐ ูู ุฌููุน ุงูุฏูุงุฆู ุงูุชู ูููู ููุชุทุจูู ุงูุนุงุฏู ุฅูุดุงุก ููู. <br><br>  ุชุคุฏู ุงูุชุบููุฑุงุช ุงูุชู ุชู ุฅุฌุฑุงุคูุง ุนูู ููุชุจุฉ ุงููุธุงู libc.so ุฅูู ุชุนุทูู ุงูุชุทุจููุงุช ุงููุตููุฉ ููุญุตูู ุนูู ุงูุชูุงุฒุงุช ุงูุฌุฐุฑ.  ูุธุฑูุง ููุชุบูุฑุงุช ูู ูุธุงุฆู exec * ุ ูู ูุชููู ูุซู ูุฐุง ุงูุชุทุจูู ูู ุจุฏุก ุนูููุงุช ุงุณุชุบูุงู ูุฒูุงุฏุฉ ุงูุงูุชูุงุฒุงุช ูู ุงููุธุงู ุ ูุธุฑูุง ูุฃู ุนูููุงุช ุงูุงุณุชุบูุงู ุนุงุฏุฉ ูุง ุชููู ูููุงุช ูุงุจูุฉ ููุชูููุฐ ูุชู ุชูุฒูููุง ูู ุงูุดุจูุฉ ุฅูู ุฏููู ุงูุชุทุจูู ูุชุดุบูููุง.  ุฅุฐุง ููุช ูุง ุชุฒุงู ุชูุฌุญ ูู ุฑูุน ุงูุงูุชูุงุฒุงุช ุ ููู ุชุณูุญ ูู ูุธููุฉ ุงูุชุญููู ุงูุชู ุชู ุชุบููุฑูุง ุจุฅุนุงุฏุฉ ุชุญููู ูุณู ุงููุธุงู ูููุชุงุจุฉ ุ ููุง ูุนูู ุฃูู ูู ูููู ุจุฃู ุชุบููุฑุงุช ุนููู. <br><br>  ูุชูุฌุฉู ูุฐูู ุ ูุชููู ุงูุฏูุงุน ุนู ุงูููุณ ูู Trojan ูู ุฌุฒุฃูู: ุงููุซุจุช ูููู ุจุฅูุบุงุก ุชุซุจูุช ุงูุชุทุจููุงุช ูุฅุฏุงุฑุฉ ุญููู ุงูุฌุฐุฑ ุ ูุชููุน ููุชุจุฉ libc.so ุงููุนุฏูุฉ ูู ุชุซุจูุชูุง ูุฑุฉ ุฃุฎุฑู.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชุนูู ูุฐู ุงูุญูุงูุฉ ุฃูุถูุง ูู "ุงูููุงูุณูู" - ุฃุญุตูุฉ ุทุฑูุงุฏุฉ ุงูุฃุฎุฑู ุงูุชู ุชูุชุณุจ ุงูุชูุงุฒุงุช ุงูุฌุฐุฑ ููุชู ุชุซุจูุชูุง ูู ูุณู ุงููุธุงู ุ ูุฃููุง ุชุนูู ุนูู ููุณ ุงููุจุฏุฃ ูุซู ุชุทุจููุงุช ุงูุชูุงุฒุงุช ุงูุฌุฐุฑ "ุงูุฌูุฏุฉ". <br><br><h3 style=";text-align:right;direction:rtl">  ููููุฉ ุงูุชุนุงูู ูุน ูุซู ูุฐุง ุทุฑูุงุฏุฉุ </h3><br>  ููุชุฎูุต ูู Android.Xiny.5260 ุ ูููู ูููุถ ุงูุฌูุงุฒ - ุดุฑูุทุฉ ุฃู ูููู ููุงู ุจุฑูุงูุฌ ูุตูู ููุชูุญ ููุชูุญ ูู.  ูููู ูู ูู ุงููููู ุฅุฒุงูุฉ ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุจุทุฑููุฉ ุฃุฎุฑูุ  ุตุนุจ ููููู ูููู - ููุงู ุนุฏุฉ ุทุฑู.  ููุญุตูู ุนูู ุงูุชูุงุฒุงุช ุงูุฌุฐุฑ ุ ููููู ุงุณุชุฎุฏุงู ุนูููุงุช ุงูุงุณุชุบูุงู ูู ุดูู ููุชุจุงุช.  ุนูู ุนูุณ ุงููููุงุช ุงููุงุจูุฉ ููุชูููุฐ ุ ูู ูููู ุทุฑูุงุฏุฉ ุจุญุธุฑ ุงูุชูุฒูู.  ููููู ุฃูุถูุง ุงุณุชุฎุฏุงู ูููู ุทุฑูุงุฏุฉ ููุณู ุ ุงููุตูู ูุชูููุฑ ุญููู ุงูุฌุฐุฑ ูุฃุฌุฒุงุฆู ุงูุฃุฎุฑู.  ูุชููู ุงูุฃูุงูุฑ ูู ุฎูุงู ุงูููุจุณ ุนูู ุทูู ุงููุณุงุฑ / dev / socket / hs_linux_work201908091350 (ูุฏ ูุฎุชูู ุงููุณุงุฑ ูู ุชุนุฏููุงุช ูุฎุชููุฉ).  ุจุงููุณุจุฉ ูุชุฌุงูุฒ ููู ุงูุชุญููู ุ ููููู ุงุณุชุฎุฏุงู ุงููููุฉ "ุงูุณุญุฑูุฉ" ููุนููุฉ mountflags ุ ุฃู ุงูุงุชุตุงู ูุจุงุดุฑุฉ ุจู syscall ุงูููุงุจู. <br><br>  <s>ุจุงูุทุจุน ุ ูู ุฃุทุจู ูุฐุง.</s> <br><br>  ุฅุฐุง ุงูุชูุท ุฌูุงุฒู ูุซู ูุฐุง ุญุตุงู ุทุฑูุงุฏุฉ ุ ูุฅููุง ููุตู ุจุงุณุชุฎุฏุงู ุงูุตูุฑุฉ ุงูุฑุณููุฉ ููุธุงู ุงูุชุดุบูู ูู ุงููููุถ.  ููุน ุฐูู ุ ูุง ุชูุณ ุฃู ูุฐุง ุณูุคุฏู ุฅูู ุญุฐู ุฌููุน ูููุงุช ูุจุฑุงูุฌ ุงููุณุชุฎุฏููู ุ ูุฐุง ุงุนุชูู ุจุฅูุดุงุก ูุณุฎ ุงุญุชูุงุทูุฉ ูุณุจููุง. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar484664/">https://habr.com/ru/post/ar484664/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar484654/index.html">The Ember Times - ุงูุนุฏุฏ 131</a></li>
<li><a href="../ar484656/index.html">ุงููุถูุนุงุช ุนุงูู ุขุฎุฑ: Atari ST</a></li>
<li><a href="../ar484658/index.html">ุชุฑุฌูุฉ ุงูููุงู "ููุงุฐุง ูุฌุจ ุจูุงุก ุงูุฅูุชุฑูุช ุงูููู ูู ุงููุถุงุก"</a></li>
<li><a href="../ar484660/index.html">ุงููุฑูุฉ ูู ุงูุงุบุชุฑุงุจ ูู ุงูุชุฃููู</a></li>
<li><a href="../ar484662/index.html">ูุดุฑูุน ุชุฌุฑูุจู ููุนุงูุฌุฉ ุงูุจูุงูุงุช ุงูุฒูุฒุงููุฉ ุนุงููุฉ ุงููุซุงูุฉ ุจุงุณุชุฎุฏุงู ุฎุฏูุฉ MCS</a></li>
<li><a href="../ar484666/index.html">Dell ู Alienware ุงูุฌุฏูุฏุฉ ูู ูุนุฑุถ CES 2020: ูุจุฐุฉ ูุฎุชุตุฑุฉ ุนู ุงูุฅุนูุงูุงุช ุงูุฑุฆูุณูุฉ</a></li>
<li><a href="../ar484668/index.html">ุนูููุฉ ุงูููุชุฌ ูุธุฑุฉ ุนุงูุฉ ุนูู ุจุฑูุงูุฌ ุงูุชูููุฑ ุงูููุชุฌ</a></li>
<li><a href="../ar484670/index.html">PostgreSQL Antipatterns: ุณุฌู ูุงุฏุฑ ุณูุตู ุฅูู ููุชุตู JOIN</a></li>
<li><a href="../ar484672/index.html">ููู Hanipotans Deanonymize ุงููุชุณูููู ูุงููุฎุงุฏุนูู ุนูู ุงูุงูุชุฑูุช</a></li>
<li><a href="../ar484676/index.html">IB fakapy 2019 - ูููุฐุฌู ูููุณ ููุบุงูุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>