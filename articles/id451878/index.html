<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍾 🌻 ⭕️ Streaming langsung video stereo ke kacamata VR (Oculus Go) 😄 👔 🛕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami tidak akan melakukan bagian pengantar yang panjang, kami akan langsung ke intinya. 

 Jadi, ada kamera stereo yang dapat mengirimkan video H264 m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Streaming langsung video stereo ke kacamata VR (Oculus Go)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451878/">  Kami tidak akan melakukan bagian pengantar yang panjang, kami akan langsung ke intinya. <br><br>  Jadi, ada kamera stereo yang dapat mengirimkan video H264 melalui berbagai protokol.  Ada kacamata Oculus Go.  Bagaimana cara menonton siaran langsung stereo dari kamera dalam kacamata VR?  Ini diinginkan, dengan penundaan minimum dan secara lokal, sehingga Youtube dan layanan video RTMP lainnya menghilang. <br><br>  Ke depan, itulah yang terjadi.  Pada awalnya - pemutaran file video yang direkam sebelumnya dari stereo, kemudian pemutaran streaming langsung dari StereoPi (MPEG-TS via UDP). <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/MLPNXmZI8-8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br><blockquote>  Kamera stereo yang saya gunakan adalah StereoPi, jadi saya akan memberikan contoh spesifik terkait dengan itu.  Sebenarnya, ini adalah raspberry biasa, tetapi dengan dua kamera, jadi contoh yang dijelaskan dapat dicoba di raspberry biasa, jika Anda benar-benar menginginkannya.  Benar, Anda harus menginstal firmware dari StereoPi. </blockquote>  Hal pertama adalah upaya membuat aplikasi Android biasa yang memutar aliran dari kamera ke layar penuh, dan mengisinya ke dalam oculus dengan metode sideload (via adb). <br><br>  Setelah beberapa memilih dengan manifes, kacamata setuju untuk mempertimbangkan aplikasi ini asli.  Itu muncul di "Sumber Tidak Diketahui" di perpustakaan, itu dimulai, itu menunjukkan semua yang diperlukan, tetapi ada masalah - gerakan kepala tidak diperhitungkan, video dari kamera hanya ditampilkan dengan bodohnya di layar penuh dengan kacamata.  Efek stereonya adalah, ya, tetapi begitu Anda sedikit menggerakkan kepala, orang Moskow itu mulai menjadi gila, yang menyebabkan perasaan yang sangat, sangat tidak nyaman. <br><br>  Jika itu, inilah aplikasi .apk: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">StereoPi untuk Oculus Go</a> Pada saat yang sama di arsip dan adb kebohongan, sehingga Anda dapat segera mencoba mengisi gelas.  Hanya perintah <br><br><pre><code class="bash hljs">adb install StereoPi.apk</code> </pre> <br>  Setelah itu, pergi ke Perpustakaan -&gt; Sumber tidak dikenal, aplikasi com.virt2real.stereopi akan muncul di sana <br><br><img src="https://habrastorage.org/webt/q6/gi/zf/q6gizfqbbj_cftbnek3l8aqupno.png"><br><br>  Kami memulainya dan jika StereoPi berada di jaringan area lokal yang sama dengan kacamata, kami segera melihat gambar stereo dari kamera. <br><br>  Tapi ini sampah ... Saya ingin aplikasi asli normal untuk oculus menonton video.  Sehingga ada layar yang tidak bergerak dan agar tidak menyerbu saat menggerakkan kepala Anda.  Saya belum siap untuk belajar Unity untuk oculus, jadi saya punya ide untuk mencoba menggunakan aplikasi pemutar video yang sudah ada di toko Oculus.  Saya biasanya menonton film 3D di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Skybox</a> , jadi saya mencoba menggunakannya. <br><br>  Selain tampilan file media yang biasa dari flash drive built-in dan dari perangkat jaringan, item menarik "Airscreen" ditemukan di Skybox.  Ternyata Anda dapat menginstal aplikasi Skybox di komputer dengan Windows (baik, atau di Mac), beri dia file video dan kemudian menjadi mungkin untuk menonton file video ini dengan kacamata.  Yaitu  Aplikasi Windows adalah server video, dan kacamata - klien.  Saya tidak menemukan protokol komunikasi di mana pun, jadi saya harus mengungkap tcpdump. <br><br>  Setelah penggalian singkat, ternyata Skybox menggunakan pesan broadcast UDP untuk mencari server di LAN.  Pesannya terlihat seperti ini: <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"search"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"project"</span></span>:<span class="hljs-string"><span class="hljs-string">"direwolf"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceId"</span></span>:<span class="hljs-string"><span class="hljs-string">"66a86b57-b292-3957-9fc9-4041d5e1f841"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceType"</span></span>:<span class="hljs-string"><span class="hljs-string">"vr"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"udpPort"</span></span>:<span class="hljs-string"><span class="hljs-string">"6881"</span></span>}</code> </pre> <br><br>  Semua pesan di JSON sangat nyaman. <br><br>  Untuk pesan ini, kami perlu mengirim tanggapan ke host dan port pengirim yang ditentukan dalam pesan, mis.  6881 <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"udp"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-attr"><span class="hljs-attr">"project"</span></span>:<span class="hljs-string"><span class="hljs-string">"direwolf server"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"searchResult"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceId"</span></span>:<span class="hljs-string"><span class="hljs-string">"66a86b57-b292-3957-9fc9-4041d5e1f841"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"computerId"</span></span>:<span class="hljs-string"><span class="hljs-string">"53709de962eba2f9695c8a926562486c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"computerName"</span></span>:<span class="hljs-string"><span class="hljs-string">"STEREO-PI"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"ip"</span></span>:<span class="hljs-string"><span class="hljs-string">"192.168.1.51"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"ips"</span></span>:[<span class="hljs-string"><span class="hljs-string">"192.168.1.51"</span></span>],<span class="hljs-attr"><span class="hljs-attr">"port"</span></span>:<span class="hljs-number"><span class="hljs-number">6888</span></span>}</code> </pre><br>  Di sini kami menunjukkan host dan port kami yang menjalankan server WebSockets.  Semua komunikasi lebih lanjut akan melalui soket web. <br><br>  Misalnya, pesan pertama melalui soket web akan seperti ini: <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"addDevice"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceId"</span></span>:<span class="hljs-string"><span class="hljs-string">"66a86b57-b292-3957-9fc9-4041d5e1f841"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceName"</span></span>:<span class="hljs-string"><span class="hljs-string">"Oculus Pacific"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceType"</span></span>:<span class="hljs-string"><span class="hljs-string">"vr"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"showLoginCode"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>}</code> </pre> <br>  Kami menjawabnya: <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"addDevice"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceId"</span></span>:<span class="hljs-string"><span class="hljs-string">"66a86b57-b292-3957-9fc9-4041d5e1f841"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceName"</span></span>:<span class="hljs-string"><span class="hljs-string">"Oculus Pacific"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"deviceType"</span></span>:<span class="hljs-string"><span class="hljs-string">"vr"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"showLoginCode"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>}</code> </pre> <br>  Dan setelah itu, di Skybox dengan kacamata kita akan melihat StereoPi kita.  Berikutnya adalah banyak permintaan yang harus Anda kirim jawabannya.  Konten daftar putar, misalnya. <br><br><div class="spoiler">  <b class="spoiler_title">Contoh daftar putar untuk Skybox</b> <div class="spoiler_text">  [{id: 'livestream-rtsp', <br>  nama: 'Streaming Langsung RTSP', <br>  durasi: 0, <br>  ukuran: 0, <br>  url: 'rtsp: //192.168.1.51: 554 / h264', <br>  thumbnail: 'http://192.168.1.51/thumbnail/livestream.png', <br>  thumbnailLebar: 186, <br>  thumbnailTinggi: 120, <br>  lastModified: 1, <br>  pengaturan defaultVR: 1, <br>  pengaturan penggunaVR: 2, <br>  lebar: 1280, <br>  tinggi: 720, <br>  orientDegree: '0', <br>  subtitle: [], <br>  ratioTypeFor2DScreen: 'default', <br>  rotasiFor2DScreen: 0, <br>  ada: benar <br>  isBadMedia: false, <br>  ditambahkanTime: 1}, <br>  {id: 'livestream-mpegts', <br>  nama: 'Streaming Langsung MPEG-TS', <br>  durasi: 0, <br>  ukuran: 0, <br>  url: 'udp: // @: 3001', <br>  thumbnail: 'http://192.168.1.51/thumbnail/livestream.png', <br>  thumbnailLebar: 186, <br>  thumbnailTinggi: 120, <br>  lastModified: 1, <br>  pengaturan defaultVR: 1, <br>  pengaturan penggunaVR: 2, <br>  lebar: 1280, <br>  tinggi: 720, <br>  orientDegree: '0', <br>  subtitle: [], <br>  ratioTypeFor2DScreen: 'default', <br>  rotasiFor2DScreen: 0, <br>  ada: benar <br>  isBadMedia: false, <br>  ditambahkanTime: 1}] <br></div></div><br>  Ini sangat menarik sejak itu  dalam daftar putar yang membentuk aplikasi Windows, singkatan RTSP yang didambakan ditemukan.  Ternyata aplikasi server stream file video melalui RTSP, yang sudah cocok untuk streaming video langsung, yang tentu saja kita butuhkan.  Lebih tepatnya, ternyata ada "RTSP" di daftar putar, tetapi tautan ke file video adalah http biasa.  Yaitu  aplikasi server masih mengirim file melalui HTTP, tetapi ini tidak cocok untuk kita.  Pada titik ini, saya sudah kesal, tapi saya pikir, mengapa tidak mencoba untuk memberikan tautan dalam daftar putar dalam format yang biasanya dipahami oleh VLC, mis.  rtsp: //192.168.1.51: 554 / h264 Dan bersorak, Skybox mulai memutar aliran video dari server RTSP dalam stereo.  Penundaannya sangat besar, 20 detik, jadi terus terang.  Kami mencoba untuk memberi makan aliran UDP ke MPEG-TS.  Sekali lagi, VLC biasanya memakan ini menggunakan tautan udp: // @: 3001, untuk Skybox saya mencoba menentukan dengan cara yang sama.  Kemudian tinggal mengarahkan aliran MPEG-TS ke sejumlah kacamata dan port UDP yang ditentukan.  GStreamer terlibat untuk ini: <br><br><pre> <code class="bash hljs">raspivid -3d sbs -w 1280 -h 720 -o - | gst-launch-1.0 -q fdsrc ! h264parse ! mpegtsmux alignment=7 name=muxer ! rndbuffersize max=1316 min=1316 ! multiudpsink clients=<span class="hljs-string"><span class="hljs-string">"192.168.1.60:3001"</span></span> sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br>  Di skybox, kita klik elemen daftar putar "Live Stream MPEG-TS" dan voila, kita melihat streaming MPEG-TS langsung di layar lebar di bioskop virtual.  Penundaan jauh lebih sedikit dibandingkan dengan RTSP, 2-3 detik, tetapi masih lebih banyak dari pada aplikasi sederhana saya yang menerima aliran H264 mentah di atas UDP (biasanya ada penundaan 100-150 ms pada resolusi 720p). <br><br>  Kemudian saya menemui jalan buntu, sejauh ini saya belum berhasil mengurangi penundaan.  Mungkin Anda perlu menonaktifkan buffering di Skybox sendiri, saya akan mencoba menulis kepada pengembang, mungkin mereka akan membuat opsi "Nonaktifkan buffering" :-) <br><br><h3>  Kesimpulannya </h3><br>  Secara umum, jika tiba-tiba karena suatu alasan Anda tiba-tiba perlu menonton streaming video langsung di oculi atau kacamata VR lainnya (Skybox tersedia di banyak platform seperti) - Anda dapat mencoba metode yang saya jelaskan.  Saya tidak tahu apakah ini akan bekerja dengan kamera stereo lain, tetapi dengan StereoPi yang dicentang, itu bajak. <br><br><h3>  Referensi </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sumber server untuk skybox</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Utas forum dengan diskusi</a> <br><br>  Terima kasih semuanya, semuanya gratis. <br><br>  Oh ya, aku hampir lupa.  Jika tiba-tiba seseorang dapat membantu dengan aplikasi asli untuk oculus (sehingga terlihat seperti Skybox) - menulis dalam surat pribadi, kami akan membahas detailnya. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id451878/">https://habr.com/ru/post/id451878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id451866/index.html">Pilih node terdekat di jaringan</a></li>
<li><a href="../id451870/index.html">Fitur C ++ modern yang perlu diketahui oleh semua programmer</a></li>
<li><a href="../id451872/index.html">Python adalah asisten dalam mencari penerbangan murah bagi mereka yang suka bepergian</a></li>
<li><a href="../id451874/index.html">Tren SEO Teratas di Google</a></li>
<li><a href="../id451876/index.html">Pusat data Frankfurt: Pusat data Telehouse</a></li>
<li><a href="../id451880/index.html">DevPRO'19: pemandangan dari bilik Wrike</a></li>
<li><a href="../id451884/index.html">Tujuh tahun bekerja sebagai pengembang: pelajaran apa yang telah saya pelajari</a></li>
<li><a href="../id451886/index.html">Menggunakan matematika diskrit dalam pengujian</a></li>
<li><a href="../id451890/index.html">Delegasi zona reverse subnet kurang dari / 24 di BIND. Bagaimana cara kerjanya</a></li>
<li><a href="../id451894/index.html">Tinjauan singkat dan segar arsitektur kompiler</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>