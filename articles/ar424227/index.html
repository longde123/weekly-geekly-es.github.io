<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ง๐พ ๐ฆ ๐ช ุชูุฒูุน ุงูููุงุท ุจุงูุชุณุงูู ุนุจุฑ ุงููุฑุฉ ูู pytorch ู tensorflow ๐ ๐คฑ๐ฟ ๐ง๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชู ูุชุงุจุฉ ูุฐุง ุงููุต ูุฃููุฆู ุงูุฐูู ูุฑุบุจูู ูู ุงูุชุนูู ุงูุนููู ุ ุงูุฐูู ูุฑุบุจูู ูู ุงุณุชุฎุฏุงู ุทุฑู ูุฎุชููุฉ ูู ููุชุจุงุช pytorch ู tensorflow ูุชูููู ูุธููุฉ ุงูุนุฏูุฏ ูู ุงููุช...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชูุฒูุน ุงูููุงุท ุจุงูุชุณุงูู ุนุจุฑ ุงููุฑุฉ ูู pytorch ู tensorflow</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hh/blog/424227/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุชู ูุชุงุจุฉ ูุฐุง ุงููุต ูุฃููุฆู ุงูุฐูู ูุฑุบุจูู ูู ุงูุชุนูู ุงูุนููู ุ ุงูุฐูู ูุฑุบุจูู ูู ุงุณุชุฎุฏุงู ุทุฑู ูุฎุชููุฉ ูู ููุชุจุงุช pytorch ู tensorflow ูุชูููู ูุธููุฉ ุงูุนุฏูุฏ ูู ุงููุชุบูุฑุงุช ุ ุงูุฐูู ูุฑุบุจูู ูู ุชุนูู ููููุฉ ุชุญููู ุจุฑูุงูุฌ ุชู ุชูููุฐู ุจุงูุชุณูุณู ุฅูู ุญุณุงุจุงุช ูุตูููุฉ ูุชุฌููุฉ ุชุชู ุจุงุณุชุฎุฏุงู numpy.  ููููู ุฃูุถูุง ุชุนูู ููููุฉ ุนูู ุฑุณู ูุงุฑููุงุชูุฑู ูู ุงูุจูุงูุงุช ุงููุตูุฑุฉ ุจุงุณุชุฎุฏุงู PovRay ู vapory. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/kz/fa/h2/kzfah2g6zgoehvsimumi8hy9nie.jpeg"></p><a name="habracut"></a><br><h3 id="otkuda-zadacha" style=";text-align:right;direction:rtl">  ูู ุฃูู ุงููููุฉ </h3><br><blockquote style=";text-align:right;direction:rtl">  ูู ูููู ูู ูุธุงุฆูู (ุฌ) ุนุงูู ุงูุจูุงูุงุช ุงููุฌููู </blockquote><p style=";text-align:right;direction:rtl"> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุญุฏ ุงูููุดูุฑุงุช ุงูุณุงุจูุฉ</a> ููุฏููุชูุง ุ ูุจุงูุชุญุฏูุฏ ูู ููุฑุฉ "Rake No. 6" ุ ุชุญุฏุซูุง ุนู ุชูููุฉ DSSM ุ ูุงูุชู ุชุชูุญ ูู ุชุญููู ุงููุต ุฅูู ูุชุฌูุงุช.  ููุนุซูุฑ ุนูู ูุซู ูุฐุง ุงูุชุนููู ุ ูุญุชุงุฌ ุงููุฑุก ุฅูู ุงูุนุซูุฑ ุนูู ูุนุงููุงุช ุงูุชุญููุงุช ุงูุฎุทูุฉ ุงูุชู ุชููู ูู ูุธููุฉ ุงูุฎุณุงุฑุฉ ุงููุนูุฏุฉ ุฅูู ุญุฏ ูุง.  ุฅู ููู ูุง ูุญุฏุซ ุนูุฏูุง ูููู ุชุนูู ูุซู ูุฐุง ุงููููุฐุฌ ุตุนุจูุง ุจุณุจุจ ุงูุฃุจุนุงุฏ ุงููุจูุฑุฉ ูููุชุฌูุงุช.  ูุชุทููุฑ ุญุฏุณ ูุณูุญ ูู ุจุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุชุญุณูู ูุชุนููู ูุนููุงุช ูุฐู ุงูุทุฑููุฉ ุ ููููู ุงูุชูููุฑ ูู ูุณุฎุฉ ูุจุณุทุฉ ูู ูุฐู ุงููููุฉ.  ุงูุขู ุฏุน ุงููุชุฌูุงุช ุชููู ูู ูุถุงุกูุง ุงููุนุชุงุฏ ุซูุงุซู ุงูุฃุจุนุงุฏ ุ ุซู ูุณูู ุฑุณููุง.  ูุณุชููู ูุธููุฉ ุงูุฎุณุงุฑุฉ ูู ุฅููุงููุฉ ุฏูุน ุงูููุงุท ุจุนูุฏูุง ุนู ุจุนุถูุง ูุฌุฐุจูุง ุฅูู ูุญุฏุฉ ุงููุฑุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูููู ุญู ุงููุดููุฉ ูู ุงูุชูุฒูุน ุงูููุญุฏ ููููุงุท ุนุจุฑ ุงููุฌุงู.  ูู ุงูุณูู ุชูููู ุฌูุฏุฉ ุงูุญู ุงูุญุงูู ุจุงูุนูู. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ุ ุณูุจุญุซ ุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="ุชุนุฑูู Mathworld">ุชูุฒูุน ููุญุฏ ุนูู ูุทุงู</a> ูููุฉ ูุนููุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhjFBB76oNVLWD_ul9P5UhyE6FL-kA#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> n </script>  ุงูููุงุท.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="ูููู ุงููุชุจ">ูููู ูุซู ูุฐุง ุงูุชูุฒูุน</a> ุถุฑูุฑููุง ูู ุจุนุถ ุงูุฃุญูุงู ููุตูุชูุงุช ูู ุฃุฌู ููู ุงุชุฌุงู ุฅุทูุงู ููุฌุฉ ูู ุงูุจููุฑุฉ.  Signalman - ููุนุฑูุฉ ููููุฉ ูุถุน ุงูุฃููุงุฑ ุงูุตูุงุนูุฉ ูู ุงููุฏุงุฑ ูุชุญููู ุฃูุถู ุฌูุฏุฉ ุงุชุตุงูุงุช.  ุฃุฎุตุงุฆู ุงูุฃุฑุตุงุฏ ุงูุฌููุฉ - ููุถุน ูุญุทุงุช ุฑุตุฏ ุงูุทูุณ. </p><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ููุจุนุถ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhjFBB76oNVLWD_ul9P5UhyE6FL-kA#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> n </script>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="ุงุณุชุฌุงุจุฉ Stackoverflow ูุน ุงูููุงุฏ ุงูุตูุจุฉ ุงูุฃููุงุทูููุฉ">ูุชู ุญู</a> ุงููููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="ุงุณุชุฌุงุจุฉ Stackoverflow ูุน ุงูููุงุฏ ุงูุตูุจุฉ ุงูุฃููุงุทูููุฉ">ุจุณูููุฉ</a> .  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">n</span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-8">8</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.656ex" height="1.937ex" viewBox="0 -728.2 2435.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhjFBB76oNVLWD_ul9P5UhyE6FL-kA#MJMATHI-6E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhjFBB76oNVLWD_ul9P5UhyE6FL-kA#MJMAIN-3D" x="878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhjFBB76oNVLWD_ul9P5UhyE6FL-kA#MJMAIN-38" x="1934" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> n = 8 </script>  ุ ูููููุง ุฃู ูุฃุฎุฐ ุงูููุนุจ ูุณุชููู ุฑุคูุณูุง ุงูุฌูุงุจ ุนูู ุงููุดููุฉ.  ูุญู ูุญุธูุธูู ุฃูุถุง ุฅุฐุง <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhjFBB76oNVLWD_ul9P5UhyE6FL-kA#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> n </script>  ุณุชููู ูุณุงููุฉ ูุนุฏุฏ ุฑุคูุณ ุงูููู ุงููุฌุณูุฉ ุฃู ุงูุงุซูู ุนุดุฑูุฉ ุฃู ุงูุตูุจุฉ ุงูุฃููุงุทูููุฉ ุงูุฃุฎุฑู.  ูุฅูุง ุ ูุฅู ุงููููุฉ ููุณุช ุจูุฐู ุงูุจุณุงุทุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุญุตูู ุนูู ุนุฏุฏ ูุจูุฑ ุจูุง ููู ุงูููุงูุฉ ูู ุงูููุงุท ุ ููุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="ุงูุฑูุงุถูุงุช ุงููููุจูุฉ ุงููููุตูุฉ">ุตูุบุฉ ูุน ูุนุงููุงุช ูุฎุชุงุฑุฉ ุชุฌุฑูุจูุงู</a> ุ ูููุงู ุงูุนุฏูุฏ ูู ุงูุฎูุงุฑุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="ูุฑุฉ ุฃุฎุฑู ุนู ุงููููุจ">ููุง</a> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="ุชุตุญูุญ ุงูุชูุงูุช">ููุง</a> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="ูููุน ุจุฑูุงูุฌ ุงูุฑูุงุถูุงุช">ููุง</a> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="ุงูุจุญุซ ุงูุฃุณุงุณู">ูููุง</a> .  ูููู ููุงู ุญู ุฃูุซุฑ ุดููููุฉ ุ ูุฅู ูุงู ุฃูุซุฑ ุชุนููุฏูุง ุ ุชู ุชุฎุตูุต ูุฐุง ุงูููุงู ูู. </p><br><p style=";text-align:right;direction:rtl">  ูุญู ูุดููุฉ ูุดุงุจูุฉ ุฌุฏูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="ูููุฉ ุทููุณูู ุนูู ุงูุฑุณููุงุช">ููุดููุฉ ุทููุณูู</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="ูุดููุฉ ููููุจูุฏูุง ุทููุณูู">ูููู</a> ).  ูุจุนุซุฑ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhjFBB76oNVLWD_ul9P5UhyE6FL-kA#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> n </script>  ุจุดูู ุนุดูุงุฆู ุ ุซู ุงุฌุนููุง ุชุฌุฐุจ ุฅูู ุณุทุญ ุ ูุซู ูุฑุฉ ุ ูุชุฏูุน ูู ุจุนุถูุง ุงูุจุนุถ.  ูุชู ุชุญุฏูุฏ ุงูุฌุฐุจ ูุงููููุฑ ุญุณุจ ุงููุธููุฉ - ุงููุญุชููุฉ.  ุนูุฏ ุงูุญุฏ ุงูุฃุฏูู ููููุฉ ุงููุธููุฉ ุงููุญุชููุฉ ุ ุณุชูุน ุงูููุงุท ุนูู ุงููุฑุฉ ุจุงูุชุณุงูู. </p><br><p style=";text-align:right;direction:rtl">  ุชุดุจู ูุฐู ุงููููุฉ ุฅูู ุญุฏ ูุจูุฑ ุนูููุฉ ุงูุชุนูู ูููุงุฐุฌ ุงูุชุนูู ุงูุขูู (ML) ุ ูุงูุชู ูุชู ุฎูุงููุง ุชูููู ูุธููุฉ ุงูุฎุณุงุฑุฉ.  ููู ุนุงูู ุงูุจูุงูุงุช ุนุงุฏุฉ ูุง ูุฑุงูุจ ููู ููุฎูุถ โโุฑูู ูุงุญุฏ ุ ููููููุง ูุดุงูุฏุฉ ุงูุตูุฑุฉ ุชุชุบูุฑ.  ุฅุฐุง ูุฌุญูุง ุ ุณูุฑู ููู ุชุชุจุงุนุฏ ุงูููุงุท ุจุดูู ุนุดูุงุฆู ุฏุงุฎู ุงูููุนุจ ูุน ุงูุฌุงูุจ 1 ูุชุจุงููุฉ ุนูู ุทูู ุณุทุญ ุงููุฑุฉ: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/52/sl/vj/52slvj5tsk6xdd-d1ymry_lty1i.png"></p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงุญูุฉ ุงูุชุฎุทูุทูุฉ ุ ูููู ุชูุซูู ุฎูุงุฑุฒููุฉ ุญู ุงููุดููุฉ ุนูู ุงููุญู ุงูุชุงูู.  ุชูุงุจู ูู ููุทุฉ ุชูุน ูู ูุณุงุญุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ุตููุง ูู ุงููุตูููุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhjFBB76oNVLWD_ul9P5UhyE6FL-kA#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> X </script>  .  ูุชู ุญุณุงุจ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ูู ูุฐู ุงููุตูููุฉ. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">L</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhjFBB76oNVLWD_ul9P5UhyE6FL-kA#MJMATHI-4C" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> L </script> ุ ุงูุฐู ูุชูุงูู ุงูุญุฏ ุงูุฃุฏูู ููููุชู ูุน ุชูุฒูุน ููุญุฏ ููููุงุท ุนุจุฑ ุงููุฌุงู.  ุชู ุงูุนุซูุฑ ุนูู ุงูุญุฏ ุงูุฃุฏูู ูููููุฉ ุจุงุณุชุฎุฏุงู <code>tensorflow</code> ู <code>tensorflow</code> ุ ูุงูุชู ุชุณูุญ ุจุญุณุงุจ ุชุฏุฑุฌ ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ุจูุงุณุทุฉ ุงููุตูููุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhjFBB76oNVLWD_ul9P5UhyE6FL-kA#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> X </script>  ูุงุญุตู ุนูู ุงูุญุฏ ุงูุฃุฏูู ุจุงุณุชุฎุฏุงู ุฅุญุฏู ุงูุทุฑู ุงููุทุจูุฉ ูู ุงูููุชุจุฉ: SGD ุ ADAM ุ ADAGRAD ุ ุฅูุฎ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/aq/ol/q_/aqolq_qbiybgyykwurj9dzap1nw.png"></p><br><h3 id="schitaem-potencial" style=";text-align:right;direction:rtl">  ูุญู ูุนุชุจุฑ ุงูุฅููุงูุงุช </h3><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุจุณุงุทุชูุง ูุงูุชุนุจูุฑ ุนููุง ููุฏุฑุชูุง ุนูู ุงูุนูู ููุงุฌูุฉ ููููุชุจุงุช ุงูููุชูุจุฉ ุจูุบุงุช ุฃุฎุฑู ุ ูุชู ุงุณุชุฎุฏุงู Python ุนูู ูุทุงู ูุงุณุน ูุญู ูุดุงูู ุงูุชุนูู ุงูุขูู.  ูุฐูู ุ ุชูุช ูุชุงุจุฉ ุฃูุซูุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ูุฐู ุงูููุงูุฉ ูู Python.  ูู ุฃุฌู ุญุณุงุจุงุช ุงููุตูููุฉ ุงูุณุฑูุนุฉ ุ ุณูุณุชุฎุฏู ููุชุจุฉ numpy.  ูุชูููู ูุธููุฉ ุงูุนุฏูุฏ ูู ุงููุชุบูุฑุงุช - pytorch ู tensorflow. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุจุชูุฑูู ุงูููุงุท ุจุดูู ุนุดูุงุฆู ูู ุงูููุนุจ ูุน ุงูุฌุงูุจ 1. ููุญุตู ุนูู 500 ููุทุฉ ุ ูุงูุชูุงุนู ุงููุฑู ุฃูุซุฑ ุฃูููุฉ 1000 ูุฑุฉ ูู ุงูููุฑุจุงุก ุงูุณุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np n = <span class="hljs-number"><span class="hljs-number">500</span></span> k = <span class="hljs-number"><span class="hljs-number">1000</span></span> X = np.random.rand(n, <span class="hljs-number"><span class="hljs-number">3</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุฐุง ุงูุฑูุฒ ูุตูููุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhjFBB76oNVLWD_ul9P5UhyE6FL-kA#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> X </script>  ุงูุญุฌู <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mn" id="MJXp-Span-22">3</span><span class="MJXp-mtext" id="MJXp-Span-23">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0.278em; margin-right: 0.278em;">ู</span></span><span class="MJXp-mrow" id="MJXp-Span-26"><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0.278em; margin-right: 0.278em;">ุฑ</span></span><span class="MJXp-mrow" id="MJXp-Span-28"><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0.278em; margin-right: 0.278em;">ุง</span></span><span class="MJXp-mrow" id="MJXp-Span-30"><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0.278em; margin-right: 0.278em;">ุช</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> 3 \ ูุฑุงุช n </script>  ูููุฆุฉ ุจุฃุฑูุงู ุนุดูุงุฆูุฉ ูู 0 ุฅูู 1: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/vn/vf/s-/vnvfs-cf0qee5vhmzn3vwidsn64.png"></p><br><p style=";text-align:right;direction:rtl">  ููุชุฑุถ ุฃู ูู ุตู ูู ูุฐู ุงููุตูููุฉ ูุชูุงูู ูุน ููุทุฉ ูุงุญุฏุฉ.  ููู ุซูุงุซุฉ ุฃุนูุฏุฉ ูุชู ุชุณุฌูู ุงูุฅุญุฏุงุซูุงุช <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">x</span><span class="MJXp-mrow" id="MJXp-Span-35"><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0.278em; margin-right: 0.278em;">ุ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">y</span><span class="MJXp-mrow" id="MJXp-Span-38"><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0.278em; margin-right: 0.278em;">ุ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> xุ yุ z </script>  ูู ููุงุทูุง. </p><br><p style=";text-align:right;direction:rtl">  ุฅููุงูุงุช ุงูุชูุงุนู ุงููุฑู ููููุทุฉ ูุน ุณุทุญ ูุญุฏุฉ ุงููุฑุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-41"><span class="MJXp-msubsup" id="MJXp-Span-42"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-44" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">k</span><span class="MJXp-mtext" id="MJXp-Span-47">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">t</span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-53">1</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.267em; margin-right: 0.267em;">โ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">r</span><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-58" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-61">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> u_1 = k \ cdot (1 - r) ^ 2/2 </script>  .  ุฅููุงููุฉ ุงูุชูุงุนู ุงูููุฑูุณุชุงุชููู ููููุงุท <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-62"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> p </script>  ู <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> q </script>  - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-66"><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-71">1</span><span class="MJXp-mrow" id="MJXp-Span-72"><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mrow" id="MJXp-Span-74"><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-78" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0.267em; margin-right: 0.267em;">โ</span><span class="MJXp-msubsup" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-82" style="vertical-align: -0.4em;">q</span></span><span class="MJXp-mrow" id="MJXp-Span-83"><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> u_2 = 1 / | r_p - r_q | </script>  .  ุชุชููู ุงูุฅููุงููุฉ ุงููุงููุฉ ูู ุงูุชูุงุนู ุงูููุฑูุณุชุงุชููู ูุฌููุน ุฃุฒูุงุฌ ุงูููุงุท ูุงูุชูุงุนู ุงููุฑู ููู ููุทุฉ ูุน ุณุทุญ ุงููุฑุฉ </p><br><p style=";text-align:right;direction:rtl"></p><p style=";text-align:right;direction:rtl"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">U</span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-88"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-90" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-91"><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0.278em; margin-right: 0.278em;">ุ</span></span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mrow" id="MJXp-Span-96"><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0.278em; margin-right: 0.278em;">ุ</span></span><span class="MJXp-msubsup" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-100" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-103">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">m</span><span class="MJXp-mtext" id="MJXp-Span-107">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">t</span><span class="MJXp-msubsup" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114" style="margin-right: 0.05em;">s</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">n</span><span class="MJXp-mo" id="MJXp-Span-121">โ</span><span class="MJXp-mn" id="MJXp-Span-122">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">p</span><span class="MJXp-mo" id="MJXp-Span-117">=</span><span class="MJXp-mn" id="MJXp-Span-118">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-123">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">m</span><span class="MJXp-mtext" id="MJXp-Span-127">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">t</span><span class="MJXp-msubsup" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134" style="margin-right: 0.05em;">s</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">q</span><span class="MJXp-mo" id="MJXp-Span-137">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">p</span><span class="MJXp-mo" id="MJXp-Span-139">+</span><span class="MJXp-mn" id="MJXp-Span-140">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-143">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">c</span><span class="MJXp-mn" id="MJXp-Span-148">1</span><span class="MJXp-mrow" id="MJXp-Span-149"><span class="MJXp-mtext" id="MJXp-Span-150">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-151"><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0.278em; margin-right: 0.278em;">ุง</span></span><span class="MJXp-mrow" id="MJXp-Span-153"><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0.278em; margin-right: 0.278em;">ู</span></span><span class="MJXp-mrow" id="MJXp-Span-155"><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0.278em; margin-right: 0.278em;">ู</span></span><span class="MJXp-mrow" id="MJXp-Span-157"><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0.278em; margin-right: 0.278em;">ุณ</span></span><span class="MJXp-mrow" id="MJXp-Span-159"><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0.278em; margin-right: 0.278em;">ุง</span></span><span class="MJXp-mrow" id="MJXp-Span-161"><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0.278em; margin-right: 0.278em;">ุฑ</span></span><span class="MJXp-mrow" id="MJXp-Span-163"><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-165">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">c</span><span class="MJXp-mrow" id="MJXp-Span-169"><span class="MJXp-msubsup" id="MJXp-Span-170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-172" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0.267em; margin-right: 0.267em;">โ</span><span class="MJXp-mtext" id="MJXp-Span-174">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">c</span><span class="MJXp-mrow" id="MJXp-Span-178"><span class="MJXp-msubsup" id="MJXp-Span-179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-181" style="vertical-align: -0.4em;">q</span></span></span><span class="MJXp-mtext" id="MJXp-Span-182">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">t</span><span class="MJXp-mrow" id="MJXp-Span-188"><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">k</span><span class="MJXp-mtext" id="MJXp-Span-192">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">t</span><span class="MJXp-mtext" id="MJXp-Span-197">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">m</span><span class="MJXp-mtext" id="MJXp-Span-201">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">t</span><span class="MJXp-msubsup" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208" style="margin-right: 0.05em;">s</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">p</span><span class="MJXp-mo" id="MJXp-Span-211">=</span><span class="MJXp-mn" id="MJXp-Span-212">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-214">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">t</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-220">1</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0.267em; margin-right: 0.267em;">โ</span><span class="MJXp-mrow" id="MJXp-Span-222"><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">c</span><span class="MJXp-mrow" id="MJXp-Span-228"><span class="MJXp-msubsup" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-231" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mrow" id="MJXp-Span-232"><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-234">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">t</span><span class="MJXp-msubsup" id="MJXp-Span-240"><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-242" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-243">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">w</span><span class="MJXp-mtext" id="MJXp-Span-254">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">n</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> U (x_1ุ ...ุ x_n) = \ sum \ limits _ {p = 1} ^ {n - 1} \ sum \ limits _ {q = p + 1} ^ {n} \ frac 1 {\ ุงููุณุงุฑ | \ vec {x_p} - \ vec {x_q} \ right | } + k \ cdot \ sum \ limits _ {p = 1} ^ n \ left (1 - | \ vec {x_p} | \ right) ^ 2 \ rightarrow \ min </script></p><br><p style=";text-align:right;direction:rtl">  ูู ุญูุซ ุงููุจุฏุฃ ุ ูููู ุญุณุงุจ ุงููููุฉ ุงููุญุชููุฉ ุจุงุณุชุฎุฏุงู ูุฐู ุงูุตูุบุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">L_for = <span class="hljs-number"><span class="hljs-number">0</span></span> L_for_inv = <span class="hljs-number"><span class="hljs-number">0</span></span> L_for_sq = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(n): p_distance = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">3</span></span>): p_distance += x[p, i]**<span class="hljs-number"><span class="hljs-number">2</span></span> p_distance = math.sqrt(p_distance) L_for_sq += k * (<span class="hljs-number"><span class="hljs-number">1</span></span> - p_distance)**<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-comment"><span class="hljs-comment">#     ,     for q in range(p + 1, n): if q != p: pq_distance = 0 for i in range(3): pq_distance += (x[p, i] - x[q, i]) ** 2 pq_distance = math.sqrt(pq_distance) L_for_inv += 1 / pq_distance #      L_for = (L_for_inv + L_for_sq) / n print('loss =', L_for)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููู ููุงู ูุดููุฉ ุตุบูุฑุฉ.  ููุญุตูู ุนูู 2000 ููุทุฉ ูุซูุฑุฉ ููุดููุฉ ุ ุณูุชู ุชุดุบูู ูุฐุง ุงูุจุฑูุงูุฌ ููุฏุฉ 2 ุซุงููุฉ.  ุณูููู ุฃุณุฑุน ุจูุซูุฑ ุฅุฐุง ูููุง ุจุญุณุงุจ ูุฐู ุงููููุฉ ุจุงุณุชุฎุฏุงู ุญุณุงุจุงุช ุงููุตูููุฉ ุงููุชุฌููุฉ.  ูุชู ุชุญููู ุงูุชุณุฑูุน ูู ุฎูุงู ุชูููุฐ ุนูููุงุช ุงููุตูููุฉ ุจุงุณุชุฎุฏุงู ุงููุบุงุช "ุงูุณุฑูุนุฉ" fortran ู C ุ ููู ุฎูุงู ุงุณุชุฎุฏุงู ุนูููุงุช ุงููุนุงูุฌ ุงููุชุฌู ุงูุชู ุชุณูุญ ุจุชูููุฐ ุฅุฌุฑุงุก ุนูู ูููุฉ ูุจูุฑุฉ ูู ุจูุงูุงุช ุงูุฅุฏุฎุงู ูู ุฏูุฑุฉ ุณุงุนุฉ ูุงุญุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุงููุตูููุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">S</span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">X</span><span class="MJXp-mtext" id="MJXp-Span-262">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">t</span><span class="MJXp-msubsup" id="MJXp-Span-267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-269" style="vertical-align: 0.5em;">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> S = X \ cdot X ^ T </script>  .  ูุฏููุง ุงูุนุฏูุฏ ูู ุงูุฎุตุงุฆุต ุงููุซูุฑุฉ ููุงูุชูุงู ูุบุงูุจุง ูุง ุชูุฌุฏ ูู ุงูุญุณุงุจุงุช ุงููุชุนููุฉ ุจูุธุฑูุฉ ุงููุตููุงุช ุงูุฎุทูุฉ ูู ML.  ูุฐุง ุ ุฅุฐุง ุงูุชุฑุถูุง ุฐูู ูู ุตู ุงููุตูููุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> X </script>  ูุน ุงููุคุดุฑุงุช <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> p </script>  ู <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> q </script>  ุชุชู ูุชุงุจุฉ ูุงููุงุช ุงููุถุงุก ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-276"><span class="MJXp-mtext" id="MJXp-Span-277">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">c</span><span class="MJXp-mrow" id="MJXp-Span-281"><span class="MJXp-msubsup" id="MJXp-Span-282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-284" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mrow" id="MJXp-Span-285"><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0.278em; margin-right: 0.278em;">ุ</span></span><span class="MJXp-mtext" id="MJXp-Span-287">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">c</span><span class="MJXp-mrow" id="MJXp-Span-291"><span class="MJXp-msubsup" id="MJXp-Span-292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-294" style="vertical-align: -0.4em;">q</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> \ vec {r _ p} ุ \ vec {r_q} </script>  ุซู ุงููุตูููุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> S </script>  ุณูู ุชุชููู ูู ููุชุฌุงุช ููุงุณูุฉ ููุฐู ุงููุชุฌูุงุช.  ูุซู ูุฐู ุงููุชุฌูุงุช <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> n </script>  ุงููุทุน ุ ุซู ุงูุจุนุฏ ุงููุตูููุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> S </script>  ูุณุงูู <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">n</span><span class="MJXp-mtext" id="MJXp-Span-303">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-304"><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0.278em; margin-right: 0.278em;">ู</span></span><span class="MJXp-mrow" id="MJXp-Span-306"><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0.278em; margin-right: 0.278em;">ุฑ</span></span><span class="MJXp-mrow" id="MJXp-Span-308"><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0.278em; margin-right: 0.278em;">ุง</span></span><span class="MJXp-mrow" id="MJXp-Span-310"><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0.278em; margin-right: 0.278em;">ุช</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> n \ ูุฑุงุช n </script>  . </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/kh/bw/ct/khbwctgydbzj51g5qwybvxtr9wo.png"></p><br><p style=";text-align:right;direction:rtl">  ุนูู ูุทุฑ ุงููุตูููุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> S </script>  ุชูู ูุฑุจุนุงุช ุฃุทูุงู ูุงููุงุช <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-315"><span class="MJXp-mtext" id="MJXp-Span-316">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">c</span><span class="MJXp-mrow" id="MJXp-Span-320"><span class="MJXp-msubsup" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-323" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-msubsup" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-327" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-334">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">p</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> \ vec {r_p}: s_ {p p} = r_p ^ 2 </script>  .  ุจูุนุฑูุฉ ูุฐุง ุ ุฏุนูุง ูููุฑ ูู ุงูุฅููุงูุงุช ุงููุงููุฉ ููุชูุงุนู.  ูุจุฏุฃ ุจุญุณุงุจ ูุตูููุชูู ูุณุงุนุฏุชูู.  ูู ูุตูููุฉ ูุทุฑูุฉ ูุงุญุฏุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> S </script>  ุณูุชู ุชูุฑุงุฑูุง ูู ุตููู ุ ูู ุฃุฎุฑู - ูู ุฃุนูุฏุฉ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ms/np/ps/msnppskk5fbczwgqvelu3jgeo80.png"></p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ูููุฉ ุงูุชุนุจูุฑ <code>p_roll + q_roll - 2 * S</code> </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/cc/py/ii/ccpyiidioj3yrxqnpxxbuyt8ht0.png"></p><br><p style=";text-align:right;direction:rtl">  ุนูุตุฑ ูููุฑุณ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-337"><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">p</span><span class="MJXp-mrow" id="MJXp-Span-340"><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0.278em; margin-right: 0.278em;">ุ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">q</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> (pุ q) </script>  ูุตูููุฉ <code>sq_dist</code> ุชุณุงูู <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-344"><span class="MJXp-msubsup" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-348">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-353">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">q</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0.267em; margin-right: 0.267em;">โ</span><span class="MJXp-mn" id="MJXp-Span-355">2</span><span class="MJXp-mtext" id="MJXp-Span-356">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">t</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-362">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">c</span><span class="MJXp-mrow" id="MJXp-Span-366"><span class="MJXp-msubsup" id="MJXp-Span-367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-369" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mrow" id="MJXp-Span-370"><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0.278em; margin-right: 0.278em;">ุ</span></span><span class="MJXp-mtext" id="MJXp-Span-372">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">c</span><span class="MJXp-mrow" id="MJXp-Span-376"><span class="MJXp-msubsup" id="MJXp-Span-377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-379" style="vertical-align: -0.4em;">q</span></span></span><span class="MJXp-mo" id="MJXp-Span-380" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-381" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-383">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">c</span><span class="MJXp-mrow" id="MJXp-Span-387"><span class="MJXp-msubsup" id="MJXp-Span-388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-390" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-391" style="margin-left: 0.267em; margin-right: 0.267em;">โ</span><span class="MJXp-mtext" id="MJXp-Span-392">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">c</span><span class="MJXp-mrow" id="MJXp-Span-396"><span class="MJXp-msubsup" id="MJXp-Span-397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-399" style="vertical-align: -0.4em;">q</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-400"><span class="MJXp-mo" id="MJXp-Span-401" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-402" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> r_p ^ 2 + r_q ^ 2 - 2 \ cdot (\ vec {r_p}ุ \ vec {r_q}) = (\ vec {r_p} - \ vec {r_q}) ^ 2 </script>  .  ุฃู ุฃู ูุฏููุง ูุตูููุฉ ูู ูุฑุจุนุงุช ุงููุณุงูุงุช ุจูู ุงูููุงุท. </p><br><h3 id="elektrostaticheskoe-ottalkivanie-na-sfere" style=";text-align:right;direction:rtl">  ุงููููุฑ ุงูุฅููุชุฑูุณุชุงุชููู ุนูู ุงููุฑุฉ </h3><br><p style=";text-align:right;direction:rtl">  <code>dist = np.sqrt(sq_dist)</code> - ูุตูููุฉ ุงููุณุงูุงุช ุจูู ุงูููุงุท.  ูุญู ุจุญุงุฌุฉ ุฅูู ุญุณุงุจ ุงูุฅููุงูุงุช ุ ูุน ุงูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุชูุงูุฑ ุงูููุงุท ูููุง ุจูููุง ูุฌุงุฐุจูุฉ ุงููุฌุงู.  ุถุน ุงููุญุฏุงุช ุนูู ุงููุทุฑ ูุงุณุชุจุฏู ูู ุนูุตุฑ <code>rec_dist_one = 1 / (dist + np.eye(n))</code> ูุง ุชุนุชูุฏ ุฃููุง <code>rec_dist_one = 1 / (dist + np.eye(n))</code> ุงููุตูููุฉ!): <code>rec_dist_one = 1 / (dist + np.eye(n))</code> .  ูุงููุชูุฌุฉ ูู ูุตูููุฉ ุนูู ุงููุทุฑ ุงูุฐู ุชูุฌุฏ ููู ูุญุฏุงุช ุ ูุงูุนูุงุตุฑ ุงูุฃุฎุฑู ูู ุฅููุงูุงุช ุงูุชูุงุนู ุงูููุฑูุณุชุงุชููู ุจูู ุงูููุงุท. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุถูู ุฅููุงูุงุช ุงูุชุฑุจูุน ุงูุชุฑุจูุนูุฉ ุฅูู ุณุทุญ ูุญุฏุฉ ุงููุฑุฉ.  ุงููุณุงูุฉ ูู ุณุทุญ ุงููุฑุฉ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-403"><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-405">1</span><span class="MJXp-mo" id="MJXp-Span-406" style="margin-left: 0.267em; margin-right: 0.267em;">โ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">r</span><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> (1 - r) </script>  .  ูู ุจุชุฑุจูุนูุง ูุถุฑุจูุง ูู <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> k </script>  ูุงูุฐู ูุญุฏุฏ ุงูุนูุงูุฉ ุจูู ุฏูุฑ ุงูุชูุงูุฑ ุงูููุฑูุณุชุงุชููู ููุฌุณููุงุช ูุงูุฌุฐุงุจ ุงููุฑุฉ.  ุงููุฌููุน <code>k = 1000</code> ุ <code>all_interactions = rec_dist_one - torch.eye(n) + (d.sqrt() - torch.ones(n))**2</code> .  ุฏุงูุฉ ุงูุฎุณุงุฑุฉ ุงูุชู ุทุงู ุงูุชุธุงุฑูุง ุ ูุงูุชู <code>t = all_interactions.sum()</code> ูููุง: <code>t = all_interactions.sum()</code> </p><br><p style=";text-align:right;direction:rtl">  ุจุฑูุงูุฌ ูุญุณุจ ุงูุฅููุงูุงุช ุจุงุณุชุฎุฏุงู ููุชุจุฉ numpy: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">S = X.dot(XT) <span class="hljs-comment"><span class="hljs-comment">#    pp_sq_dist = np.diag(S) #  p_roll = pp_sq_dist.reshape(1, -1).repeat(n, axis=0) #     q_roll = pp_sq_dist.reshape(-1, 1).repeat(n, axis=1) #     pq_sq_dist = p_roll + q_roll - 2 * S #      pq_dist = np.sqrt(pq_sq_dist) #    pp_dist = np.sqrt(pp_sq_dist) #      surface_dist_sq = (pp_dist - np.ones(n)) ** 2 #       rec_pq_dist = 1 / (pq_dist + np.eye(n)) - np.eye(n) #      L_np_rec = rec_pq_dist.sum() / 2 #     L_np_surf = k * surface_dist_sq.sum() #       L_np = (L_np_rec + L_np_surf) / n #   ,     print('loss =', L_np)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุฃููุฑ ููุง ุฃูุถู ููููุงู - 200 ูููู ุซุงููุฉ ุนูุฏ 2000 ููุทุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุณุชุฎุฏู pytorch: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> torch pt_x = torch.from_numpy(X) <span class="hljs-comment"><span class="hljs-comment"># pt_x -   tensor   pytorch pt_S = pt_x.mm(pt_x.transpose(0, 1)) # mm - matrix multiplication pt_pp_sq_dist = pt_S.diag() pt_p_roll = pt_pp_sq_dist.repeat(n, 1) pt_q_roll = pt_pp_sq_dist.reshape(-1, 1).repeat(1, n) pt_pq_sq_dist = pt_p_roll + pt_q_roll - 2 * pt_S pt_pq_dist = pt_pq_sq_dist.sqrt() pt_pp_dist = pt_pp_sq_dist.sqrt() pt_surface_dist_sq = (pt_pp_dist - torch.ones(n, dtype=torch.float64)) ** 2 pt_rec_pq_dist = 1/ (pt_pq_dist + torch.eye(n, dtype=torch.float64)) - torch.eye(n, dtype=torch.float64) L_pt = (pt_rec_pq_dist.sum() / 2 + k * pt_surface_dist_sq.sum()) / n print('loss =', float(L_pt))</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฃุฎูุฑูุง tensorflow: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf tf_x = tf.placeholder(name=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, dtype=tf.float64) tf_S = tf.matmul(tf_x, tf.transpose(tf_x)) tf_pp_sq_dist = tf.diag_part(tf_S) tf_p_roll = tf.tile(tf.reshape(tf_pp_sq_dist, (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>)), (n, <span class="hljs-number"><span class="hljs-number">1</span></span>)) tf_q_roll = tf.tile(tf.reshape(tf_pp_sq_dist, (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)), (<span class="hljs-number"><span class="hljs-number">1</span></span>, n)) tf_pq_sq_dist = tf_p_roll + tf_q_roll - <span class="hljs-number"><span class="hljs-number">2</span></span> * tf_S tf_pq_dist = tf.sqrt(tf_pq_sq_dist) tf_pp_dist = tf.sqrt(tf_pp_sq_dist) tf_surface_dist_sq = (tf_pp_dist - tf.ones(n, dtype=tf.float64)) ** <span class="hljs-number"><span class="hljs-number">2</span></span> tf_rec_pq_dist = <span class="hljs-number"><span class="hljs-number">1</span></span> / (tf_pq_dist + tf.eye(n, dtype=tf.float64)) - tf.eye(n, dtype=tf.float64) L_tf = (tf.reduce_sum(tf_rec_pq_dist) / <span class="hljs-number"><span class="hljs-number">2</span></span> + k * tf.reduce_sum(tf_surface_dist_sq)) / n glob_init = tf.local_variables_initializer() <span class="hljs-comment"><span class="hljs-comment">#     with tf.Session() as tf_s: #     glob_init.run() #   res, = tf_s.run([L_tf], feed_dict={tf_x: x}) #   print(res)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงุฑู ุฃุฏุงุก ูุฐู ุงูุฃุณุงููุจ ุงูุซูุงุซุฉ: </p><br><table style=";text-align:right;direction:rtl"><tbody><tr><td>  ู </td><td>  ุงูุซุนุจุงู </td><td>  ุฌุงูุน </td><td>  pytorch </td><td>  tensorflow </td></tr><tr><td>  2000 </td><td>  4.03 </td><td>  0.083 </td><td>  1.11 </td><td>  0.205 </td></tr><tr><td>  10ุ000 </td><td>  99 </td><td>  2.82 </td><td>  2.18 </td><td>  7.9 </td></tr></tbody></table><br><p style=";text-align:right;direction:rtl">  ุงูุญุณุงุจุงุช ุงูููุฌูุฉ ุชุนุทู ุฑุจุญูุง ุจุฃูุซุฑ ูู ุชุฑุชูุจ ููุตู ุนุดุฑู ุจุงููุณุจุฉ ูุฑูุฒ ุงูุซุนุจุงู ุงูุฎุงูุต.  "ููุญ ุงููุฑุฌู" ูู pytorch ูุฑุฆู: ุชุณุชุบุฑู ุงูุญุณุงุจุงุช ุฐุงุช ุงูุญุฌู ุงูุตุบูุฑ ููุชูุง ููุญูุธูุง ูู ุงูููุช ุ ููููุง ูุง ุชุชุบูุฑ ุชูุฑูุจูุง ูุน ุฒูุงุฏุฉ ุญุฌู ุงูุญุณุงุจุงุช. </p><br><h3 id="vizualizaciya" style=";text-align:right;direction:rtl">  ุงูุชุตูุฑ </h3><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ุงูุญุงุถุฑ ุ ูููู ุชุตูุฑ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุนุฏุฏ ูุจูุฑ ูู ุงูุญุฒู ุ ูุซู Matlab ู Wolfram Mathematica ู Maple ู Matplotlib ููุง ุฅูู ุฐูู. ูู ูุฐู ุงูุญุฒู ููุงู ุงููุซูุฑ ูู ุงููุธุงุฆู ุงููุนูุฏุฉ ุงูุชู ุชุคุฏู ุฃุดูุงุก ูุนูุฏุฉ.  ูุณูุก ุงูุญุธ ุ ุฅุฐุง ูุงุฌูุช ูููุฉ ุจุณูุทุฉ ูููููุง ุบูุฑ ููุงุณูุฉ ุ ูุณุชุฌุฏ ููุณู ุบูุฑ ูุณูุญ.  ุงูุญู ุงูููุถู ูู ูุฐู ุงูุญุงูุฉ ูู povray.  ูุฐุง ุจุฑูุงูุฌ ููู ุฌุฏูุง ูุณุชุฎุฏู ุนุงุฏุฉู ูุฅูุดุงุก ุตูุฑ ูุงูุนูุฉ ุ ูููู ูููู ุงุณุชุฎุฏุงูู ูู "ูุฌููุน ูููุฑุฆูุงุช".  ุนุงุฏุฉู ุ ุจุบุถ ุงููุธุฑ ุนู ูุฏู ุตุนูุจุฉ ุงูุณุทุญ ุงูุฐู ุชุฑูุฏ ุนุฑุถู ุ ุงุทูุจ ูู povray ููุท ุฑุณู ูุฌุงูุงุช ุจูุง ูุฑุงูุฒ ูููุงุฉ ุนูู ูุฐุง ุงูุณุทุญ. </p><br><p style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู ููุชุจุฉ vapory ุ ููููู ุฅูุดุงุก ูุดูุฏ povray ูุจุงุดุฑุฉ ูู python ูุนุฑุถู ูุงููุธุฑ ุฅูู ุงููุชูุฌุฉ.  ุงูุขู ูุจุฏู ูุฐุง: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fh/1j/6x/fh1j6xkcdedx1m4s0x9clmsgjse.gif"></p><br><p style=";text-align:right;direction:rtl">  ูุชู ุงูุญุตูู ุนูู ุงูุตูุฑุฉ ุนูู ุงููุญู ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> vapory <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PIL <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_scene</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(moment)</span></span></span><span class="hljs-function">:</span></span> angle = <span class="hljs-number"><span class="hljs-number">2</span></span> * math.pi * moment / <span class="hljs-number"><span class="hljs-number">360</span></span> r_camera = <span class="hljs-number"><span class="hljs-number">7</span></span> camera = vapory.Camera(<span class="hljs-string"><span class="hljs-string">'location'</span></span>, [r_camera * math.cos(angle), <span class="hljs-number"><span class="hljs-number">1.5</span></span>, r_camera * math.sin(angle)], <span class="hljs-string"><span class="hljs-string">'look_at'</span></span>, [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-string"><span class="hljs-string">'angle'</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>) light1 = vapory.LightSource([<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">-3</span></span>], <span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) light2 = vapory.LightSource([<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>], <span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) plane = vapory.Plane([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-number"><span class="hljs-number">-1</span></span>, vapory.Pigment(<span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>])) box = vapory.Box([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], vapory.Pigment(<span class="hljs-string"><span class="hljs-string">'Col_Glass_Clear'</span></span>), vapory.Finish(<span class="hljs-string"><span class="hljs-string">'F_Glass9'</span></span>), vapory.Interior(<span class="hljs-string"><span class="hljs-string">'I_Glass1'</span></span>)) spheres = [vapory.Sphere( [float(r[<span class="hljs-number"><span class="hljs-number">0</span></span>]), float(r[<span class="hljs-number"><span class="hljs-number">1</span></span>]), float(r[<span class="hljs-number"><span class="hljs-number">2</span></span>])], <span class="hljs-number"><span class="hljs-number">0.05</span></span>, vapory.Texture(vapory.Pigment(<span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]))) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> x] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vapory.Scene(camera, objects=[light1, light2, plane, box] + spheres, included=[<span class="hljs-string"><span class="hljs-string">'glass.inc'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">360</span></span>): flnm = <span class="hljs-string"><span class="hljs-string">'out/sphere_{:03}.png'</span></span>.format(t) scene = create_scene(t) scene.render(flnm, width=<span class="hljs-number"><span class="hljs-number">800</span></span>, height=<span class="hljs-number"><span class="hljs-number">600</span></span>, remove_temp=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) clear_output() display(Image.open(flnm))</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ูุฌููุนุฉ ูู ุงููููุงุช ุ ูุชู ุชุฌููุน ุตูุฑ gif ุงููุชุญุฑูุฉ ุจุงุณุชุฎุฏุงู ImageMagic: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">convert -delay 10 -loop 0 sphere_*.png sphere_all.gif</code> </pre> <br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนูู github</a> ููููู ุฑุคูุฉ ุฑูุฒ ุงูุนูู ุ ูุชุฑุฏ ุฃุฌุฒุงุก ููู ููุง.  ูู ุงูููุงูุฉ ุงูุซุงููุฉ ุ ุณุฃุชุญุฏุซ ุนู ููููุฉ ุงูุจุฏุก ูู ุงูุชูููู ูู ุงููุธููุฉ ุจุญูุซ ุชุฎุฑุฌ ุงูููุงุท ูู ุงูููุนุจ ูุชูุชุดุฑ ุจุงูุชุณุงูู ุนุจุฑ ุงููุฌุงู. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar424227/">https://habr.com/ru/post/ar424227/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar424209/index.html">ุงููุนูุฉ ุงููุงุณูููุฉ: ูุฑุงุฌุนุฉ ุณูุงุนุฉ Snom A170</a></li>
<li><a href="../ar424211/index.html">ููู ูุงุฌูุฉ ุชุฎุฒูู ุงูุญุงููุงุช (ูู Kubernetes ูุงููุฒูุฏ)</a></li>
<li><a href="../ar424215/index.html">ุงูุฏุฑุฏุงุฑ. ูุฑูุญ ููุญุฑุฌ</a></li>
<li><a href="../ar424217/index.html">ุงูุชูููุฑ ูู ุงูุญุฑูุจ ุงูููุฏุณุฉ ุ ููุฐูู ูุฏุงุก ูู ุฃุฌู ุงูุณูุงู</a></li>
<li><a href="../ar424223/index.html">ุนููุงุก ูููู ุงูุชุฎูุต ูููู. ุชุฌุฒุฆุฉ ูุนูููุงุช ุงูุดุฑุงุก ุงููุชูุฑุฑุฉ</a></li>
<li><a href="../ar424229/index.html">Kubernetes ูู ุงูุฅูุชุงุฌ: ุงูุฎุฏูุงุช</a></li>
<li><a href="../ar424231/index.html">ููููุฉ ูุณุจ ุงููุงู ุนูู ุงููุถูููู</a></li>
<li><a href="../ar424233/index.html">ุชุนููู ุงูููุจููุชุฑ ููุดู ุงูุฎุฑู ุจุฏูุฉ 93ูช.</a></li>
<li><a href="../ar424235/index.html">ููููุฉ ุงุณุชุฎุฏุงู STATSPACK ุจุฏูุงู ูู AWR ูู Oracle Standard Edition</a></li>
<li><a href="../ar424237/index.html">ุงุดุญู ุนููู ูุจุงุดุฑุฉ! ุฃููุงุช ุงูุชุดุบูู ูุงููุฌูุนูู ูุงูุฃุฏุงุก ูู ุฌููุฑ 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>