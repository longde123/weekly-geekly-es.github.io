<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ด๐ผ ๐ฉ๐พโ๐คโ๐ฉ๐ผ ๐ Kaggle Home Credit ููุงูุณุฉ ุงููุฎุงุทุฑ ุงูุงูุชุฑุงุถูุฉ - ุชุญููู ุงูุจูุงูุงุช ูุงูููุงุฐุฌ ุงูุชูุจุคูุฉ ุงูุจุณูุทุฉ ๐ฒ๐ป ๐ฉ๐ฝโโ๏ธ ๐๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ููุฑุฌุงู ุงูุจูุงูุงุช 2 ูู ูููุณู ุ ูุงุญุธ ููุงุฏูููุฑ ุฅูุบููููููู ุ ูููุฏุณ ุงูุฑุคูุฉ ุงูุขููุฉ ูู Lyft ุ ุชูุงููุง ุฃู ุฃูุถู ุทุฑููุฉ ูุชุนูู ุนููู ุงูุจูุงูุงุช ูู ุงููุดุงุฑูุฉ ูู ุงููุณุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kaggle Home Credit ููุงูุณุฉ ุงููุฎุงุทุฑ ุงูุงูุชุฑุงุถูุฉ - ุชุญููู ุงูุจูุงูุงุช ูุงูููุงุฐุฌ ุงูุชูุจุคูุฉ ุงูุจุณูุทุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414613/" style=";text-align:right;direction:rtl">  ูู ููุฑุฌุงู ุงูุจูุงูุงุช 2 ูู ูููุณู ุ ูุงุญุธ ููุงุฏูููุฑ ุฅูุบููููููู ุ ูููุฏุณ ุงูุฑุคูุฉ ุงูุขููุฉ ูู Lyft ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุงููุง</a> ุฃู ุฃูุถู ุทุฑููุฉ ูุชุนูู ุนููู ุงูุจูุงูุงุช ูู ุงููุดุงุฑูุฉ ูู ุงููุณุงุจูุงุช ุ ูุชุดุบูู ุญููู ุงูุขุฎุฑูู ุ ูุฏูุฌูุง ุ ูุชุญููู ุงููุชุงุฆุฌ ูุฅุธูุงุฑ ุนููู.  ูู ุงููุงูุน ุ ูู ุฅุทุงุฑ ูุฐุง ุงููููุฐุฌ ุ ูุฑุฑุช ุฃู ุฃูุธุฑ ุนู ูุซุจ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณุงุจูุฉ</a> ุชูููู ูุฎุงุทุฑ ุงูุงุฆุชูุงู ุงูุฑุฆูุณูุฉ ูุฃุดุฑุญ (ูููุจุชุฏุฆูู ูุงูุนููุงุก ููุจู ูู ุดูุก ุจููุณู) ููููุฉ ุชุญููู ูุฌููุนุงุช ุงูุจูุงูุงุช ูุฐู ุจุดูู ุตุญูุญ ูุจูุงุก ููุงุฐุฌ ููู. <br><br><img src="https://habrastorage.org/webt/iv/ji/-t/ivji-tusvam8d05dqef8wjbmbye.png"><br><a name="habracut"></a><br>  (ุตูุฑุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ููุง</a> ) <br><br><img src="https://habrastorage.org/webt/xc/er/pe/xcerpefrjvrblmubhxyeljevcie.png" width="250" align="right">  ูุฌููุนุฉ ุงูุงุฆุชูุงู ุงูุฑุฆูุณูุฉ ูู ูุฌููุนุฉ ูู ุงูุจููู ูุงูููุธูุงุช ุงูุงุฆุชูุงููุฉ ุบูุฑ ุงููุตุฑููุฉ ุงูุชู ุชุฌุฑู ุนูููุงุช ูู 11 ุฏููุฉ (ุจูุง ูู ุฐูู ุฑูุณูุง ูุจูู ุงูุงุฆุชูุงู ูุงูุชูููู ุงูููุฒูู ุฐ.ู.ู).  ุงูุบุฑุถ ูู ุงููุณุงุจูุฉ ูู ุฅูุดุงุก ูููุฌูุฉ ูุชูููู ุงูุฌุฏุงุฑุฉ ุงูุงุฆุชูุงููุฉ ููููุชุฑุถูู ุงูุฐูู ููุณ ูุฏููู ุชุงุฑูุฎ ุงุฆุชูุงูู.  ููู ูุง ูุจุฏู ูุจูููุง ุฅูู ุญุฏ ูุง - ุบุงูุจูุง ูุง ูุง ูุชููู ุงูููุชุฑุถูู ูู ูุฐู ุงููุฆุฉ ูู ุงูุญุตูู ุนูู ุฃู ุงุฆุชูุงู ูู ุงูุจูู ููุถุทุฑูู ุฅูู ุงููุฌูุก ุฅูู ุงููุญุชุงููู ูุงููุฑูุถ ุงูุตุบูุฑุฉ.  ูู ุงููุซูุฑ ููุงูุชูุงู ุฃู ุงูุนููู ูู ูุญุฏุฏ ูุชุทูุจุงุช ุงูุดูุงููุฉ ููุงุจููุฉ ุชูุณูุฑ ุงููููุฐุฌ (ููุง ูู ุงูุญุงู ุนุงุฏุฉ ูุน ุงูุจููู) ุ ููููู ุงุณุชุฎุฏุงู ุฃู ุดูุก ุ ุญุชู ุงูุดุจูุฉ ุงูุนุตุจูุฉ. <br><br>  ุชุชููู ุนููุฉ ุงูุชุฏุฑูุจ ูู ุฃูุซุฑ ูู 300 ุฃูู ุณุฌู ุ ูููุงู ุงููุซูุฑ ูู ุงูุนูุงูุงุช - 122 ุ ูู ุจูููุง ุงูุนุฏูุฏ ูู ุงูุนูุงูุงุช ุงููุฆููุฉ (ุบูุฑ ุงูุนุฏุฏูุฉ).  ุชุตู ุงููุงูุชุงุช ุงูููุชุฑุถ ุจุชูุงุตูู ูุงููุฉ ุ ูุตููุงู ุฅูู ุงูููุงุฏ ุงูุชู ุชุตูุน ูููุง ุฌุฏุฑุงู ููุฒูู.  ุฌุฒุก ูู ุงูุจูุงูุงุช ููุฌูุฏ ูู 6 ุฌุฏุงูู ุฅุถุงููุฉ (ุจูุงูุงุช ุนู ููุชุจ ุงูุงุฆุชูุงู ูุฑุตูุฏ ุจุทุงูุฉ ุงูุงุฆุชูุงู ูุงููุฑูุถ ุงูุณุงุจูุฉ) ุ ููุฌุจ ุฃูุถูุง ูุนุงูุฌุฉ ูุฐู ุงูุจูุงูุงุช ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ูุชุญููููุง ุนูู ุงูุฌุฏุงูู ุงูุฑุฆูุณูุฉ. <br><br>  ุชุจุฏู ุงูููุงูุณุฉ ููููุฉ ุชุตููู ููุงุณูุฉ (1 ูู ุญูู TARGET ูุนูู ุฃู ุตุนูุจุงุช ูู ุงูุฏูุน ุ 0 ูุนูู ุนุฏู ูุฌูุฏ ุตุนูุจุงุช).  ููุน ุฐูู ุ ูููุณ ูู 0/1 ูุง ููุจุบู ุชููุนู ุ ูููู ุงุญุชูุงููุฉ ุงููุดุงูู (ุงูุชู ุ ุจุงูููุงุณุจุฉ ุ ูููู ุญููุง ุจุณูููุฉ ูู ุฎูุงู ุทุฑู ุงูุชูุจุค ุงูุงุญุชูุงููุฉ ููุชูุจุค ุจูุง ุงูุชู ุชูุชูููุง ุฌููุน ุงูููุงุฐุฌ ุงููุนูุฏุฉ). <br><br>  ูููููุฉ ุงูุฃููู ุ ุชุนุฏ ูุฌููุนุฉ ุงูุจูุงูุงุช ูุนูุงุฑูุง ุฌูุฏูุง ูููุงู ุงูุชุนูู ุงูุขูู ุ ููุฏ ูุฏู ุงูููุธููู ุฌุงุฆุฒุฉ ูุจูุฑุฉ ุจูููุฉ 70 ุฃูู ุฏููุงุฑ ุ ููุชูุฌุฉ ูุฐูู ุ ูุดุงุฑู ุฃูุซุฑ ูู 2600 ูุฑูู ูู ุงููุณุงุจูุฉ ุงูููู ุ ูุงููุนุฑูุฉ ูู ุงูุฃูู ูู ุงููุฆุฉ.  ููุน ุฐูู ุ ูู ูุงุญูุฉ ุฃุฎุฑู ุ ุชุนูู ูุฐู ุงูุดุนุจูุฉ ุฃู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฏ ุชูุช ุฏุฑุงุณุชูุง ุตุนูุฏูุง ููุจูุทูุง ูุชู ุฅูุดุงุก ุงูุนุฏูุฏ ูู ุงูููู ุจุงุณุชุฎุฏุงู EDA ุฌูุฏ (ุชุญูููุงุช ุงูุจูุงูุงุช ุงูุงุณุชูุดุงููุฉ - ุงูุจุญุซ ูุชุญููู ุงูุจูุงูุงุช ูู ุงูุดุจูุฉ ุ ุจูุง ูู ุฐูู ุงูุฑุณูู ุงูุจูุงููุฉ) ุ ููุฏุณุฉ ุงูููุฒุงุช (ุงูุนูู ูุน ุงูุณูุงุช) ููุน ููุงุฐุฌ ูุซูุฑุฉ ููุงูุชูุงู.  (Kernel ูู ูุซุงู ุนูู ุงูุนูู ูุน ูุฌููุนุฉ ุจูุงูุงุช ูููู ูุฃู ุดุฎุต ูุถุนูุง ูุนุฑุถ ุนูููู ุนูู kugglers ุงูุขุฎุฑูู.) <br><br>  ุชุณุชุญู ุงูุฃูุจุงุจ ุงูุงูุชูุงู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">EDA ูุน ูุตู ููุตู ูููุจุชุฏุฆูู ูุงูููุงุฐุฌ ุงูุจุณูุทุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">EDA ุงูุนููู ูุน ุญุฒูุฉ Plotly + ุชุญููู ุจูุงูุงุช ุงูููุชุจ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅูุฏุง ูุทููุฉ ูุน ุญุฒูุฉ ุณูุจูุฑู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุญููู ููุงุฑู ูููุดููุฉ ูุงูููุชุฑุถูู ุงููุชุนุซุฑูู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">15 ุณุทุฑ LightGBM ุนูู ุซูุงุซ ูุงูุชุงุช ุจุณุฑุนุฉ ุฃุฎูุฑุฉ 0.714</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุญููู ุงููุงูุชุงุช ุจุญุณุจ ููุงุชุจ ุงูุงุฆุชูุงู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅุถุงูุฉ ูุนุงูุฌุฉ.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุทุงููุงุช + LightGBM</a> </li></ul><br>  ููุนูู ูุน ุงูุจูุงูุงุช ุ ููุตู ุนุงุฏุฉู ุจุงูุฎุทุฉ ุงูุชุงููุฉ ุ ูุงูุชู ุณูุญุงูู ุงุชุจุงุนูุง. <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููู ุงููุดููุฉ ูุงูุชุนุฑู ุนูู ุงูุจูุงูุงุช </li><li style=";text-align:right;direction:rtl">  ุชูุธูู ูุชูุณูู ุงูุจูุงูุงุช </li><li style=";text-align:right;direction:rtl">  ุฌูุนูุฉ ุงูุฅูุงุฑุงุช ููุบูุต </li><li style=";text-align:right;direction:rtl">  ูููุฐุฌ ุฃุณุงุณู </li><li style=";text-align:right;direction:rtl">  ุชุญุณูู ุงููููุฐุฌ </li><li style=";text-align:right;direction:rtl">  ุชูุณูุฑ ุงููููุฐุฌ </li></ol><br>  ูู ูุฐู ุงูุญุงูุฉ ุ ูุฌุจ ุฃู ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุญูููุฉ ุฃู ุงูุจูุงูุงุช ูุงุณุนุฉ ุฌุฏูุง ููุง ูููู ุงูุชุบูุจ ุนูููุง ุนูู ุงูููุฑ ุ ููู ุงูููุทูู ุงูุชุตุฑู ุนูู ูุฑุงุญู. <br><br>  ููุจุฏุฃ ุจุงุณุชูุฑุงุฏ ุงูููุชุจุงุช ุงูุชู ูุญุชุงุฌูุง ูู ุงูุชุญููู ููุนูู ูุน ุงูุจูุงูุงุช ูู ุดูู ุฌุฏุงูู ุ ูุฅูุดุงุก ุงูุฑุณูู ุงูุจูุงููุฉ ุ ูุงูุนูู ูุน ุงููุตูููุงุช. <br><br><pre style=";text-align:right;direction:rtl"><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns %matplotlib inline</code> </pre> <br>  ูู ุจุชูุฒูู ุงูุจูุงูุงุช.  ุฏุนููุง ูุฑู ูุง ูุฏููุง ุฌููุนุง.  ุจุงูููุงุณุจุฉ ุ ูุฐุง ุงููููุน ูู ุฏููู "../input/" ูุฑุชุจุท ุจูุชุทูุจุงุช ูุถุน ุญุจุงุชู ุนูู Kaggle. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os PATH=<span class="hljs-string"><span class="hljs-string">"../input/"</span></span> print(os.listdir(PATH))</code> </pre> <br> <code>['application_test.csv', 'application_train.csv', 'bureau.csv', 'bureau_balance.csv', 'credit_card_balance.csv', 'HomeCredit_columns_description.csv', 'installments_payments.csv', 'POS_CASH_balance.csv', 'previous_application.csv']</code> <br> <br>  ููุงู 8 ุฌุฏุงูู ุจุงูุจูุงูุงุช (ูุง ุชุญุณุจ ุงูุฌุฏูู HomeCredit_columns_description.csv ุ ุงูุฐู ูุญุชูู ุนูู ูุตู ููุญููู) ุ ููู ูุชุฑุงุจุทุฉ ูููุง ููู: <br><br><img src="https://habrastorage.org/webt/vn/yr/84/vnyr84vhzozgnfinu2to2tyhlp8.png"><br><br>  application_train / application_test: ุจูุงูุงุช ุฑุฆูุณูุฉ ุ ูุชู ุชุญุฏูุฏ ุงูููุชุฑุถ ุจูุงุณุทุฉ ุงูุญูู SK_ID_CURR <br>  ุงูููุชุจ: ุจูุงูุงุช ุงููุฑูุถ ุงูุณุงุจูุฉ ูู ูุคุณุณุงุช ุงุฆุชูุงููุฉ ุฃุฎุฑู ูู ููุชุจ ุงุฆุชูุงู <br>  bureau_balance: ุจูุงูุงุช ุดูุฑูุฉ ุนู ูุฑูุถ ุงูููุชุจ ุงูุณุงุจูุฉ.  ูู ุณุทุฑ ูู ุดูุฑ ุงุณุชุฎุฏุงู ุงููุฑุถ <br>  previous_application: ุงูุชุทุจููุงุช ุงูุณุงุจูุฉ ููุญุตูู ุนูู ูุฑูุถ ูู ุงูุงุฆุชูุงู ุงูููุฒูู ุ ููู ูููุง ุญูู ูุฑูุฏ SK_ID_PREV <br>  POS_CASH_BALANCE: ุจูุงูุงุช ุดูุฑูุฉ ุนู ุงููุฑูุถ ูู ุงูุงุฆุชูุงู ุงูุณููู ูุน ุฅุตุฏุงุฑ ุงูููุฏ ูุงููุฑูุถ ูุดุฑุงุก ุงูุณูุน <br>  credit_card_balance: ุจูุงูุงุช ุฑุตูุฏ ุจุทุงูุฉ ุงูุงุฆุชูุงู ุงูุดูุฑูุฉ ูู ุฑุตูุฏ ุงูููุฒู <br>  ุงูุฃูุณุงุท: ุชุงุฑูุฎ ุงูุณุฏุงุฏ ูููุฑูุถ ุงูุณุงุจูุฉ ูู ุงูุงุฆุชูุงู ุงูููุฒูู. <br><br>  ุฏุนููุง ูุฑูุฒ ุฃููุงู ุนูู ูุตุฏุฑ ุงูุจูุงูุงุช ุงูุฑุฆูุณู ููุฑู ูุง ูู ุงููุนูููุงุช ุงูุชู ูููู ุงุณุชุฎูุงุตูุง ูููุง ูุงูููุงุฐุฌ ุงูุชู ูุจูููุง.  ูู ุจุชูุฒูู ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  app_train = pd.read_csv (PATH + 'application_train.csv'ุ) </li><li style=";text-align:right;direction:rtl">  app_test = pd.read_csv (PATH + 'application_test.csv'ุ) </li><li style=";text-align:right;direction:rtl">  print ("ุชูุณูู ูุฌููุนุฉ ุงูุชุฏุฑูุจ:"ุ app_train.shape) </li><li style=";text-align:right;direction:rtl">  ุทุจุงุนุฉ ("ุชูุณูู ุนููุฉ ุงูุงุฎุชุจุงุฑ:" ุ app_test.shape) </li><li style=";text-align:right;direction:rtl">  ุดูู ุนููุฉ ุงูุชุฏุฑูุจ: (307511 ุ 122) </li><li style=";text-align:right;direction:rtl">  ุชูุณูู ุนููุฉ ุงูุงุฎุชุจุงุฑ: (48744 ุ 121) </li></ul><br>  ูู ุงููุฌููุน ุ ูุฏููุง 307 ุขูุงู ุณุฌู ู 122 ุนูุงูุฉ ูู ุนููุฉ ุงูุชุฏุฑูุจ ู 49 ุฃูู ุณุฌู ู 121 ุนูุงูุฉ ูู ุงูุงุฎุชุจุงุฑ.  ูู ุงููุงุถุญ ุฃู ุงูุชูุงูุถ ูุฑุฌุน ุฅูู ุญูููุฉ ุฃูู ูุง ุชูุฌุฏ ุณูุฉ ุงููุฏู TARGET ูู ุนููุฉ ุงูุงุฎุชุจุงุฑ ุ ูุณูู ูุชููุน ุฐูู. <br><br>  ุฏุนููุง ูููู ูุธุฑุฉ ูุงุญุตุฉ ุนูู ุงูุจูุงูุงุช <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">pd.set_option(<span class="hljs-string"><span class="hljs-string">'display.max_columns'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  pandas     app_train.head()</span></span></code> </pre> <br><br><img src="https://habrastorage.org/webt/xo/yc/rg/xoycrgiodfhonfrjbt50ncthrls.png"><br>  (ุฃูู 8 ุฃุนูุฏุฉ ูุนุฑูุถุฉ) <br><br>  ูู ุงูุตุนุจ ุฌุฏูุง ูุดุงูุฏุฉ ุงูุจูุงูุงุช ุจูุฐุง ุงูุชูุณูู.  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ูุงุฆูุฉ ุงูุฃุนูุฏุฉ: <br><br> <code>app_train.info(max_cols=122) <br> &lt;class 'pandas.core.frame.DataFrame'&gt; <br> RangeIndex: 307511 entries, 0 to 307510 <br> Data columns (total 122 columns): <br> SK_ID_CURR 307511 non-null int64 <br> TARGET 307511 non-null int64 <br> NAME_CONTRACT_TYPE 307511 non-null object <br> CODE_GENDER 307511 non-null object <br> FLAG_OWN_CAR 307511 non-null object <br> FLAG_OWN_REALTY 307511 non-null object <br> CNT_CHILDREN 307511 non-null int64 <br> AMT_INCOME_TOTAL 307511 non-null float64 <br> AMT_CREDIT 307511 non-null float64 <br> AMT_ANNUITY 307499 non-null float64 <br> AMT_GOODS_PRICE 307233 non-null float64 <br> NAME_TYPE_SUITE 306219 non-null object <br> NAME_INCOME_TYPE 307511 non-null object <br> NAME_EDUCATION_TYPE 307511 non-null object <br> NAME_FAMILY_STATUS 307511 non-null object <br> NAME_HOUSING_TYPE 307511 non-null object <br> REGION_POPULATION_RELATIVE 307511 non-null float64 <br> DAYS_BIRTH 307511 non-null int64 <br> DAYS_EMPLOYED 307511 non-null int64 <br> DAYS_REGISTRATION 307511 non-null float64 <br> DAYS_ID_PUBLISH 307511 non-null int64 <br> OWN_CAR_AGE 104582 non-null float64 <br> FLAG_MOBIL 307511 non-null int64 <br> FLAG_EMP_PHONE 307511 non-null int64 <br> FLAG_WORK_PHONE 307511 non-null int64 <br> FLAG_CONT_MOBILE 307511 non-null int64 <br> FLAG_PHONE 307511 non-null int64 <br> FLAG_EMAIL 307511 non-null int64 <br> OCCUPATION_TYPE 211120 non-null object <br> CNT_FAM_MEMBERS 307509 non-null float64 <br> REGION_RATING_CLIENT 307511 non-null int64 <br> REGION_RATING_CLIENT_W_CITY 307511 non-null int64 <br> WEEKDAY_APPR_PROCESS_START 307511 non-null object <br> HOUR_APPR_PROCESS_START 307511 non-null int64 <br> REG_REGION_NOT_LIVE_REGION 307511 non-null int64 <br> REG_REGION_NOT_WORK_REGION 307511 non-null int64 <br> LIVE_REGION_NOT_WORK_REGION 307511 non-null int64 <br> REG_CITY_NOT_LIVE_CITY 307511 non-null int64 <br> REG_CITY_NOT_WORK_CITY 307511 non-null int64 <br> LIVE_CITY_NOT_WORK_CITY 307511 non-null int64 <br> ORGANIZATION_TYPE 307511 non-null object <br> EXT_SOURCE_1 134133 non-null float64 <br> EXT_SOURCE_2 306851 non-null float64 <br> EXT_SOURCE_3 246546 non-null float64 <br> APARTMENTS_AVG 151450 non-null float64 <br> BASEMENTAREA_AVG 127568 non-null float64 <br> YEARS_BEGINEXPLUATATION_AVG 157504 non-null float64 <br> YEARS_BUILD_AVG 103023 non-null float64 <br> COMMONAREA_AVG 92646 non-null float64 <br> ELEVATORS_AVG 143620 non-null float64 <br> ENTRANCES_AVG 152683 non-null float64 <br> FLOORSMAX_AVG 154491 non-null float64 <br> FLOORSMIN_AVG 98869 non-null float64 <br> LANDAREA_AVG 124921 non-null float64 <br> LIVINGAPARTMENTS_AVG 97312 non-null float64 <br> LIVINGAREA_AVG 153161 non-null float64 <br> NONLIVINGAPARTMENTS_AVG 93997 non-null float64 <br> NONLIVINGAREA_AVG 137829 non-null float64 <br> APARTMENTS_MODE 151450 non-null float64 <br> BASEMENTAREA_MODE 127568 non-null float64 <br> YEARS_BEGINEXPLUATATION_MODE 157504 non-null float64 <br> YEARS_BUILD_MODE 103023 non-null float64 <br> COMMONAREA_MODE 92646 non-null float64 <br> ELEVATORS_MODE 143620 non-null float64 <br> ENTRANCES_MODE 152683 non-null float64 <br> FLOORSMAX_MODE 154491 non-null float64 <br> FLOORSMIN_MODE 98869 non-null float64 <br> LANDAREA_MODE 124921 non-null float64 <br> LIVINGAPARTMENTS_MODE 97312 non-null float64 <br> LIVINGAREA_MODE 153161 non-null float64 <br> NONLIVINGAPARTMENTS_MODE 93997 non-null float64 <br> NONLIVINGAREA_MODE 137829 non-null float64 <br> APARTMENTS_MEDI 151450 non-null float64 <br> BASEMENTAREA_MEDI 127568 non-null float64 <br> YEARS_BEGINEXPLUATATION_MEDI 157504 non-null float64 <br> YEARS_BUILD_MEDI 103023 non-null float64 <br> COMMONAREA_MEDI 92646 non-null float64 <br> ELEVATORS_MEDI 143620 non-null float64 <br> ENTRANCES_MEDI 152683 non-null float64 <br> FLOORSMAX_MEDI 154491 non-null float64 <br> FLOORSMIN_MEDI 98869 non-null float64 <br> LANDAREA_MEDI 124921 non-null float64 <br> LIVINGAPARTMENTS_MEDI 97312 non-null float64 <br> LIVINGAREA_MEDI 153161 non-null float64 <br> NONLIVINGAPARTMENTS_MEDI 93997 non-null float64 <br> NONLIVINGAREA_MEDI 137829 non-null float64 <br> FONDKAPREMONT_MODE 97216 non-null object <br> HOUSETYPE_MODE 153214 non-null object <br> TOTALAREA_MODE 159080 non-null float64 <br> WALLSMATERIAL_MODE 151170 non-null object <br> EMERGENCYSTATE_MODE 161756 non-null object <br> OBS_30_CNT_SOCIAL_CIRCLE 306490 non-null float64 <br> DEF_30_CNT_SOCIAL_CIRCLE 306490 non-null float64 <br> OBS_60_CNT_SOCIAL_CIRCLE 306490 non-null float64 <br> DEF_60_CNT_SOCIAL_CIRCLE 306490 non-null float64 <br> DAYS_LAST_PHONE_CHANGE 307510 non-null float64 <br> FLAG_DOCUMENT_2 307511 non-null int64 <br> FLAG_DOCUMENT_3 307511 non-null int64 <br> FLAG_DOCUMENT_4 307511 non-null int64 <br> FLAG_DOCUMENT_5 307511 non-null int64 <br> FLAG_DOCUMENT_6 307511 non-null int64 <br> FLAG_DOCUMENT_7 307511 non-null int64 <br> FLAG_DOCUMENT_8 307511 non-null int64 <br> FLAG_DOCUMENT_9 307511 non-null int64 <br> FLAG_DOCUMENT_10 307511 non-null int64 <br> FLAG_DOCUMENT_11 307511 non-null int64 <br> FLAG_DOCUMENT_12 307511 non-null int64 <br> FLAG_DOCUMENT_13 307511 non-null int64 <br> FLAG_DOCUMENT_14 307511 non-null int64 <br> FLAG_DOCUMENT_15 307511 non-null int64 <br> FLAG_DOCUMENT_16 307511 non-null int64 <br> FLAG_DOCUMENT_17 307511 non-null int64 <br> FLAG_DOCUMENT_18 307511 non-null int64 <br> FLAG_DOCUMENT_19 307511 non-null int64 <br> FLAG_DOCUMENT_20 307511 non-null int64 <br> FLAG_DOCUMENT_21 307511 non-null int64 <br> AMT_REQ_CREDIT_BUREAU_HOUR 265992 non-null float64 <br> AMT_REQ_CREDIT_BUREAU_DAY 265992 non-null float64 <br> AMT_REQ_CREDIT_BUREAU_WEEK 265992 non-null float64 <br> AMT_REQ_CREDIT_BUREAU_MON 265992 non-null float64 <br> AMT_REQ_CREDIT_BUREAU_QRT 265992 non-null float64 <br> AMT_REQ_CREDIT_BUREAU_YEAR 265992 non-null float64 <br> dtypes: float64(65), int64(41), object(16) <br> memory usage: 286.2+ MB</code> <br> <br>  ุงุณุชุฑุฌุน ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ ุงูุชูุตูููุฉ ุญุณุจ ุงูุญูู ูู ููู HomeCredit_columns_description.  ููุง ุชุฑู ูู ุงููุนูููุงุช ุ ุฌุฒุก ูู ุงูุจูุงูุงุช ุบูุฑ ููุชูู ูุฌุฒุก ูุฆูู ุ ูุชู ุนุฑุถูุง ููุงุฆู.  ูุนุธู ุงูููุงุฐุฌ ูุง ุชุนูู ูุน ูุฐู ุงูุจูุงูุงุช ุ ุณูุชุนูู ุนูููุง ูุนู ุดูุก ูุนูุง.  ุนูู ูุฐุง ุ ูููู ุงุนุชุจุงุฑ ุงูุชุญููู ุงูุฃููู ููุชููุงู ุ ูุณูู ููุชูู ูุจุงุดุฑุฉู ุฅูู ุฌูุนูุฉ ุงูุฅูุงุฑุงุช ููุบูุต <br><br><h2 style=";text-align:right;direction:rtl">  ุชุญููู ุงูุจูุงูุงุช ุงูุงุณุชูุดุงููุฉ ุฃู ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช ุงูุฃูููุฉ </h2><br>  ูู ุนูููุฉ EDA ุ ูุญุณุจ ุงูุฅุญุตุงุฆูุงุช ุงูุฃุณุงุณูุฉ ููุฑุณู ุงูุฑุณูู ุงูุจูุงููุฉ ููุนุซูุฑ ุนูู ุงูุงุชุฌุงูุงุช ูุงูุดุฐูุฐ ูุงูุฃููุงุท ูุงูุนูุงูุงุช ุฏุงุฎู ุงูุจูุงูุงุช.  ูุฏู EDA ูู ูุนุฑูุฉ ูุง ูููู ุฃู ุชุฎุจุฑู ุงูุจูุงูุงุช.  ุนุงุฏุฉ ุ ููุชูู ุงูุชุญููู ูู ุงูุฃุนูู ุฅูู ุงูุฃุณูู - ูู ูุธุฑุฉ ุนุงูุฉ ุฅูู ุฏุฑุงุณุฉ ุงูููุงุทู ุงููุฑุฏูุฉ ุงูุชู ุชุฌุฐุจ ุงูุงูุชุจุงู ููุฏ ุชููู ุฐุงุช ูุงุฆุฏุฉ.  ุจุนุฏ ุฐูู ุ ูููู ุงุณุชุฎุฏุงู ูุฐู ุงููุชุงุฆุฌ ูู ุจูุงุก ุงููููุฐุฌ ุ ูุงุฎุชูุงุฑ ุงูููุฒุงุช ูู ูุชูุณูุฑู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุชูุฒูุน ุงููุชุบูุฑ ุงููุฏู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">app_train.TARGET.value_counts()</code> </pre> <br> <code>0 282686 <br> 1 24825 <br> Name: TARGET, dtype: int64</code> <br> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plt.style.use(<span class="hljs-string"><span class="hljs-string">'fivethirtyeight'</span></span>) plt.rcParams[<span class="hljs-string"><span class="hljs-string">"figure.figsize"</span></span>] = [<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>]โ plt.hist(app_train.TARGET) plt.show()</code> </pre> <br><img src="https://habrastorage.org/webt/xm/rd/ch/xmrdchcab8eqbwt2p1pie4jmaeu.png"><br><br>  ุฏุนูู ุฃุฐูุฑู ุฃู 1 ุชุนูู ูุดุงูู ูู ุฃู ููุน ูุน ุนูุฏุฉ ุ 0 ูุง ุชุนูู ูุดุงูู.  ููุง ุชุฑูู ุ ููุณ ูุฏู ุงูููุชุฑุถูู ุจุดูู ุฑุฆูุณู ุฃู ูุดุงูู ูู ุงูุณุฏุงุฏ ุ ุชุจูุบ ุญุตุฉ ุงูุฅุดูุงููุฉ ุญูุงูู 8 ูช.  ูุฐุง ูุนูู ุฃู ุงููุตูู ุบูุฑ ูุชูุงุฒูุฉ ููุฏ ููุฒู ุฃุฎุฐ ุฐูู ูู ุงูุงุนุชุจุงุฑ ุนูุฏ ุจูุงุก ุงููููุฐุฌ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุจุญุซ ุนู ุงูุจูุงูุงุช ุงูููููุฏุฉ </h3><br>  ููุฏ ุฑุฃููุง ุฃู ููุต ุงูุจูุงูุงุช ูุจูุฑ ููุบุงูุฉ.  ุฏุนููุง ูุฑู ุจูุฒูุฏ ูู ุงูุชูุตูู ุฃูู ููุงุฐุง ูููุต. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      def missing_values_table(df): #   mis_val = df.isnull().sum() #    mis_val_percent = 100 * df.isnull().sum() / len(df) #    mis_val_table = pd.concat([mis_val, mis_val_percent], axis=1) #   mis_val_table_ren_columns = mis_val_table.rename( columns = {0 : 'Missing Values', 1 : '% of Total Values'}) #    mis_val_table_ren_columns = mis_val_table_ren_columns[ mis_val_table_ren_columns.iloc[:,1] != 0].sort_values( '% of Total Values', ascending=False).round(1) #  print ("   " + str(df.shape[1]) + " .\n" " " + str(mis_val_table_ren_columns.shape[0]) + "    .") #     return mis_val_table_ren_columns missing_values = missing_values_table(app_train) missing_values.head(10)</span></span></code> </pre> <br><br> <code>   122 . <br>  67    .</code> <br> <img src="https://habrastorage.org/webt/oa/jm/tp/oajmtpuvkymt4asczwqmhqziria.png"><br><br>  ุจุชูุณูู ุฑุณููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plt.style.use(<span class="hljs-string"><span class="hljs-string">'seaborn-talk'</span></span>)โ fig = plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>)) miss_train = pd.DataFrame((app_train.isnull().sum())*<span class="hljs-number"><span class="hljs-number">100</span></span>/app_train.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>]).reset_index() miss_test = pd.DataFrame((app_test.isnull().sum())*<span class="hljs-number"><span class="hljs-number">100</span></span>/app_test.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>]).reset_index() miss_train[<span class="hljs-string"><span class="hljs-string">"type"</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span> miss_test[<span class="hljs-string"><span class="hljs-string">"type"</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span> missing = pd.concat([miss_train,miss_test],axis=<span class="hljs-number"><span class="hljs-number">0</span></span>) ax = sns.pointplot(<span class="hljs-string"><span class="hljs-string">"index"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,data=missing,hue=<span class="hljs-string"><span class="hljs-string">"type"</span></span>) plt.xticks(rotation =<span class="hljs-number"><span class="hljs-number">90</span></span>,fontsize =<span class="hljs-number"><span class="hljs-number">7</span></span>) plt.title(<span class="hljs-string"><span class="hljs-string">"    "</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">"  %"</span></span>) plt.xlabel(<span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre> <br><br><img src="https://habrastorage.org/webt/iv/fc/ib/ivfcibv85aaktlxybl8bps2vurw.png"><br><br>  ููุงู ุงูุนุฏูุฏ ูู ุงูุฅุฌุงุจุงุช ุนูู ุงูุณุคุงู "ูุงุฐุง ุชูุนู ุจูู ูุฐุง".  ููููู ููุฆู ุจุงูุฃุตูุงุฑ ุ ููููู ุงุณุชุฎุฏุงู ุงูููู ุงููุชูุณุทุฉ ุ ููููู ููุท ุญุฐู ุงูุฃุณุทุฑ ุจุฏูู ุงููุนูููุงุช ุงูุถุฑูุฑูุฉ.  ูู ูุฐุง ูุชููู ุนูู ุงููููุฐุฌ ุงูุฐู ูุฎุทุท ูุงุณุชุฎุฏุงูู ุ ุญูุซ ูุชุนุงูู ุจุนุถูุง ุจุดูู ูุซุงูู ูุน ุงูููู ุงูููููุฏุฉ.  ุจูููุง ูุชุฐูุฑ ูุฐู ุงูุญูููุฉ ููุชุฑู ูู ุดูุก ููุง ูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุฃููุงุน ุงูุฃุนูุฏุฉ ูุงูุชุฑููุฒ ุงููุงุทุน </h3><br>  ููุง ูุชุฐูุฑ.  ุฌุฒุก ูู ุงูุฃุนูุฏุฉ ูู ููุน ุงููุงุฆู ุ ุฃู ุฃูู ููุณ ูู ูููุฉ ุนุฏุฏูุฉ ุ ููููู ูุนูุณ ุจุนุถ ุงููุฆุงุช.  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ูุฐู ุงูุฃุนูุฏุฉ ุนู ูุซุจ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">app_train.dtypes.value_counts()</code> </pre> <br> <code>float64 65 <br> int64 41 <br> object 16 <br> dtype: int64</code> <br> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">app_train.select_dtypes(include=[object]).apply(pd.Series.nunique, axis = <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br> <code>NAME_CONTRACT_TYPE 2 <br> CODE_GENDER 3 <br> FLAG_OWN_CAR 2 <br> FLAG_OWN_REALTY 2 <br> NAME_TYPE_SUITE 7 <br> NAME_INCOME_TYPE 8 <br> NAME_EDUCATION_TYPE 5 <br> NAME_FAMILY_STATUS 6 <br> NAME_HOUSING_TYPE 6 <br> OCCUPATION_TYPE 18 <br> WEEKDAY_APPR_PROCESS_START 7 <br> ORGANIZATION_TYPE 58 <br> FONDKAPREMONT_MODE 4 <br> HOUSETYPE_MODE 3 <br> WALLSMATERIAL_MODE 7 <br> EMERGENCYSTATE_MODE 2 <br> dtype: int64</code> <br> <br>  ูุฏููุง 16 ุนููุฏูุง ุ ููู ูููุง 2 ุฅูู 58 ุฎูุงุฑูุง ูุฎุชูููุง ูููููุฉ.  ุจุดูู ุนุงู ุ ูุง ูููู ูููุงุฐุฌ ุชุนูููู ุงูุขูุฉ ุฃู ุชูุนู ุฃู ุดูุก ูุน ูุฐู ุงูุฃุนูุฏุฉ (ุจุงุณุชุซูุงุก ุงูุจุนุถ ุ ูุซู LightGBM ุฃู CatBoost).  ูุธุฑูุง ูุฃููุง ูุฎุทุท ูุชุฌุฑุจุฉ ููุงุฐุฌ ูุฎุชููุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุ ููุง ุจุฏ ูู ุนูู ุดูุก ูุง ุจูุฐุง.  ููุงู ููุฌุงู ูู ุงูุฃุณุงุณ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุฑููุฒ ุงูุชุณููุฉ - ูุชู ุชุนููู ุงููุฆุงุช ููุฃุฑูุงู 0 ู 1 ู 2 ููุง ุฅูู ุฐูู ููุชู ูุชุงุจุชูุง ูู ููุณ ุงูุนููุฏ </li><li style=";text-align:right;direction:rtl">  ุชุฑููุฒ ูุงุญุฏ ุณุงุฎู - ูุชุญูู ุนููุฏ ูุงุญุฏ ุฅูู ุนุฏุฉ ูููุง ูุนุฏุฏ ุงูุฎูุงุฑุงุช ูุชุดูุฑ ูุฐู ุงูุฃุนูุฏุฉ ุฅูู ุงูุฎูุงุฑ ุงูุฐู ูุญุชููู ูุฐุง ุงูุณุฌู. </li></ul><br>  ูู ุจูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃููุงุน</a> ุงูุดุงุฆุนุฉ ุ ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฑููุฒ ุงููุฏู ุงููุชูุณุท</a> (ุดูุฑูุง ููุชูุถูุญ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">roryorangepants</a> ). <br><br>  ููุงู ูุดููุฉ ุตุบูุฑุฉ ูู Label Encoding - ููู ูุนูู ุงูููู ุงูุนุฏุฏูุฉ ุงูุชู ูุง ุนูุงูุฉ ููุง ุจุงููุงูุน.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ููุง ูุชุนุงูู ูุน ูููุฉ ุนุฏุฏูุฉ ุ ูุฅู ุฏุฎู ุงูููุชุฑุถ ุงูุจุงูุบ 100000 ุจุงูุชุฃููุฏ ุฃูุจุฑ ูุฃูุถู ูู ุฏุฎู 20000. ูููู ูููููุง ุงูููู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฃู ูุฏููุฉ ูุงุญุฏุฉ ุฃูุถู ูู ุฃุฎุฑู ูุฃูู ุชู ุชุนููู ุงููููุฉ 100 ูุงูุขุฎุฑ 200 ุุุ <br><br>  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูุนุฏ ุชุฑููุฒ One-Hot ุฃูุซุฑ ุฃูุงููุง ุ ูููู ููููู ุฅูุชุงุฌ ุฃุนูุฏุฉ "ุฅุถุงููุฉ".  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูููุง ุจุชุดููุฑ ููุณ ุงูุฌูุณ ุจุงุณุชุฎุฏุงู One-Hot ุ ูุญุตู ุนูู ุนููุฏูู ุ "ุฌูุณ ุงูุฐููุฑ" ู "ุฌูุณ ุงูุฅูุงุซ" ุ ุนูู ุงูุฑุบู ูู ุฃู ุฃุญุฏ ุงูุฃุนูุฏุฉ ุณูููู ูุงูููุง ุ "ูู ูู ุฐูุฑ". <br><br>  ููุญุตูู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ุฌูุฏุฉ ุ ุณูููู ูู ุงูุถุฑูุฑู ุชุฑููุฒ ุงูุนูุงูุงุช ุฐุงุช ุงูุชุจุงูู ุงูููุฎูุถ ุจุงุณุชุฎุฏุงู ุชุฑููุฒ ุงูุชุณููุฉ ููู ุดูุก ุขุฎุฑ - One-Hot ุ ูููู ูู ุฃุฌู ุงูุจุณุงุทุฉ ุ ูููู ุจุชุฑููุฒ ูู ุดูุก ููููุง ูู One-Hot.  ูู ุชุคุซุฑ ุนููููุง ุนูู ุณุฑุนุฉ ุงูุญุณุงุจ ูุงููุชูุฌุฉ.  ุนูููุฉ ุชุฑููุฒ ุงูุจุงูุฏุง ููุณูุง ุจุณูุทุฉ ููุบุงูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">app_train = pd.get_dummies(app_train) app_test = pd.get_dummies(app_test)โ print(<span class="hljs-string"><span class="hljs-string">'Training Features shape: '</span></span>, app_train.shape) print(<span class="hljs-string"><span class="hljs-string">'Testing Features shape: '</span></span>, app_test.shape)</code> </pre> <br> <code>Training Features shape: (307511, 246) <br> Testing Features shape: (48744, 242)</code> <br> <br>  ูุธุฑูุง ูุฃู ุนุฏุฏ ุงูุฎูุงุฑุงุช ูู ุฃุนูุฏุฉ ุงูุชุญุฏูุฏ ุบูุฑ ูุชุณุงูู ุ ูุฅู ุนุฏุฏ ุงูุฃุนูุฏุฉ ูุง ูุชุทุงุจู ุงูุขู.  ุงููุญุงุฐุงุฉ ูุทููุจุฉ - ุชุญุชุงุฌ ุฅูู ุฅุฒุงูุฉ ุงูุฃุนูุฏุฉ ูู ูุฌููุนุฉ ุงูุชุฏุฑูุจ ุบูุฑ ุงูููุฌูุฏุฉ ูู ูุฌููุนุฉ ุงูุงุฎุชุจุงุฑ.  ูุฐุง ูุฌุนู ุทุฑููุฉ ุงููุญุงุฐุงุฉ ุ ุชุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ุงููุญูุฑ = 1 (ููุฃุนูุฏุฉ). <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># ,           . train_labels = app_train['TARGET']โ #  -   .     app_train, app_test = app_train.align(app_test, join = 'inner', axis = 1)โ print('  : ', app_train.shape) print('  : ', app_test.shape)โ # Add target back in to the data app_train['TARGET'] = train_labels</span></span></code> </pre> <br> <code>  : (307511, 242) <br>   : (48744, 242)</code> <br> <br><h3 style=";text-align:right;direction:rtl">  ุงุฑุชุจุงุท ุงูุจูุงูุงุช </h3><br>  ุทุฑููุฉ ุฌูุฏุฉ ูููู ุงูุจูุงูุงุช ูู ุญุณุงุจ ูุนุงููุงุช ุงุฑุชุจุงุท ุจูุฑุณูู ููุจูุงูุงุช ุงููุชุนููุฉ ุจุงูุณูุฉ ุงููุฏู.  ูุฐู ููุณุช ุฃูุถู ุทุฑููุฉ ูุฅุธูุงุฑ ูุฏู ุตูุฉ ุงูููุฒุงุช ุ ูููููุง ุจุณูุทุฉ ูุชุณูุญ ูู ุจุงูุญุตูู ุนูู ููุฑุฉ ุนู ุงูุจูุงูุงุช.  ูููู ุชูุณูุฑ ุงููุนุงููุงุช ุนูู ุงููุญู ุงูุชุงูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  00 -19 "ุถุนูู ุฌุฏูุง" </li><li style=";text-align:right;direction:rtl">  20 -39 "ุถุนูู" </li><li style=";text-align:right;direction:rtl">  40-59 "ูุชูุณุท" </li><li style=";text-align:right;direction:rtl">  60 -79 ูููุฉ </li><li style=";text-align:right;direction:rtl">  80-1.0 "ููู ุฌุฏุง" </li></ul><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    correlations = app_train.corr()['TARGET'].sort_values()โ #  print('  : \n', correlations.tail(15)) print('\n  : \n', correlations.head(15))</span></span></code> </pre> <br> <code>  : <br> DAYS_REGISTRATION 0.041975 <br> OCCUPATION_TYPE_Laborers 0.043019 <br> FLAG_DOCUMENT_3 0.044346 <br> REG_CITY_NOT_LIVE_CITY 0.044395 <br> FLAG_EMP_PHONE 0.045982 <br> NAME_EDUCATION_TYPE_Secondary / secondary special 0.049824 <br> REG_CITY_NOT_WORK_CITY 0.050994 <br> DAYS_ID_PUBLISH 0.051457 <br> CODE_GENDER_M 0.054713 <br> DAYS_LAST_PHONE_CHANGE 0.055218 <br> NAME_INCOME_TYPE_Working 0.057481 <br> REGION_RATING_CLIENT 0.058899 <br> REGION_RATING_CLIENT_W_CITY 0.060893 <br> DAYS_BIRTH 0.078239 <br> TARGET 1.000000 <br> Name: TARGET, dtype: float64 <br> <br>   : <br> EXT_SOURCE_3 -0.178919 <br> EXT_SOURCE_2 -0.160472 <br> EXT_SOURCE_1 -0.155317 <br> NAME_EDUCATION_TYPE_Higher education -0.056593 <br> CODE_GENDER_F -0.054704 <br> NAME_INCOME_TYPE_Pensioner -0.046209 <br> ORGANIZATION_TYPE_XNA -0.045987 <br> DAYS_EMPLOYED -0.044932 <br> FLOORSMAX_AVG -0.044003 <br> FLOORSMAX_MEDI -0.043768 <br> FLOORSMAX_MODE -0.043226 <br> EMERGENCYSTATE_MODE_No -0.042201 <br> HOUSETYPE_MODE_block of flats -0.040594 <br> AMT_GOODS_PRICE -0.039645 <br> REGION_POPULATION_RELATIVE -0.037227 <br> Name: TARGET, dtype: float64</code> <br> <br>  ูุจุงูุชุงูู ุ ูุฅู ุฌููุน ุงูุจูุงูุงุช ุชุฑุชุจุท ุงุฑุชุจุงุทูุง ุถุนูููุง ุจุงููุฏู (ุจุงุณุชุซูุงุก ุงููุฏู ููุณู ุ ูุงูุฐู ุจุงูุทุจุน ูุณุงูู ููุณู).  ููุน ุฐูู ุ ูุชู ุชูููุฒ ุงูุนูุฑ ูุจุนุถ "ูุตุงุฏุฑ ุงูุจูุงูุงุช ุงูุฎุงุฑุฌูุฉ" ุนู ุงูุจูุงูุงุช.  ุฑุจูุง ูุฐู ุจุนุถ ุงูุจูุงูุงุช ุงูุฅุถุงููุฉ ูู ููุธูุงุช ุงูุงุฆุชูุงู ุงูุฃุฎุฑู.  ูู ุงููุถุญู ุฃูู ุนูู ุงูุฑุบู ูู ุฅุนูุงู ุงููุฏู ุนูู ุฃูู ุงูุงุณุชููุงู ุนู ูุฐู ุงูุจูุงูุงุช ูู ุงุชุฎุงุฐ ูุฑุงุฑ ุงุฆุชูุงูู ุ ุฅูุง ุฃููุง ูู ุงููุงูุน ุณูุณุชูุฏ ุฅูููุง ูู ุงูููุงู ุงูุฃูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุนูุฑ </h3><br>  ูู ุงููุงุถุญ ุฃูู ูููุง ูุจุฑ ุงูุนููู ุ ุฒุงุฏ ุงุญุชูุงู ุงูุนุงุฆุฏ (ุญุชู ุญุฏ ูุนูู ุ ุจุงูุทุจุน).  ูููู ูุณุจุจ ูุง ุ ูุดุงุฑ ุฅูู ุงูุนูุฑ ูู ุงูุฃูุงู ุงูุณูุจูุฉ ูุจู ุฅุตุฏุงุฑ ุงููุฑุถ ุ ูุจุงูุชุงูู ุ ูุฑุชุจุท ุงุฑุชุจุงุทูุง ุฅูุฌุงุจููุง ุจุนุฏู ุงูุณุฏุงุฏ (ูุงูุฐู ูุจุฏู ุบุฑูุจูุง ุฅูู ุญุฏ ูุง).  ูุฃุชู ุจูุง ุฅูู ูููุฉ ุฅูุฌุงุจูุฉ ููููู ูุธุฑุฉ ุนูู ุงูุนูุงูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">app_train[<span class="hljs-string"><span class="hljs-string">'DAYS_BIRTH'</span></span>] = abs(app_train[<span class="hljs-string"><span class="hljs-string">'DAYS_BIRTH'</span></span>]) app_train[<span class="hljs-string"><span class="hljs-string">'DAYS_BIRTH'</span></span>].corr(app_train[<span class="hljs-string"><span class="hljs-string">'TARGET'</span></span>])</code> </pre> <br> <code>-0.078239308309827088</code> <br> <br>  ุฏุนููุง ูููู ูุธุฑุฉ ูุงุญุตุฉ ุนูู ุงููุชุบูุฑ.  ููุจุฏุฃ ุจุงูุฑุณู ุงูุจูุงูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     ,  25  plt.hist(app_train['DAYS_BIRTH'] / 365, edgecolor = 'k', bins = 25) plt.title('Age of Client'); plt.xlabel('Age (years)'); plt.ylabel('Count');</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/v2/zq/1q/v2zq1qolo8rc5wx0tyao4ucygxc.png"><br><br>  ูุฏ ูููู ุงูุฑุณู ุงูุจูุงูู ููุชูุฒูุน ููุณู ูููุฏูุง ุจุนุถ ุงูุดูุก ุ ุจุงุณุชุซูุงุก ุฃููุง ูุง ูุฑู ุฃู ููู ูุชุทุฑูุฉ ููู ุดูุก ูุจุฏู ุฃูุซุฑ ุฃู ุฃูู ุชุตุฏูููุง.  ูุฅุธูุงุฑ ุชุฃุซูุฑ ุชุฃุซูุฑ ุงูุนูุฑ ุนูู ุงููุชูุฌุฉ ุ ูููููุง ุฅูุดุงุก ุฑุณู ุจูุงูู ูุชูุฏูุฑ ูุซุงูุฉ ุงูููุงุฉ (KDE) - ุชูุฒูุน ุงููุซุงูุฉ ุงูููููุฉ ุ ูุทููุฉ ุจุฃููุงู ุงูุณูุฉ ุงููุณุชูุฏูุฉ.  ูุธูุฑ ุชูุฒูุน ูุชุบูุฑ ูุงุญุฏ ููููู ุชูุณูุฑู ุนูู ุฃูู ุฑุณู ุจูุงูู ุณูุณ (ูุญุณูุจ ูููุงุฉ ุบูุณูุฉ ููู ููุทุฉ ุ ูุงูุชู ูุชู ุญุณุงุจูุง ุจุนุฏ ุฐูู ูุชูุนูููุง). <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># KDE ,   sns.kdeplot(app_train.loc[app_train['TARGET'] == 0, 'DAYS_BIRTH'] / 365, label = 'target == 0')โ # KDE   sns.kdeplot(app_train.loc[app_train['TARGET'] == 1, 'DAYS_BIRTH'] / 365, label = 'target == 1')โ #  plt.xlabel('Age (years)'); plt.ylabel('Density'); plt.title('Distribution of Ages');</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/st/xs/e1/stxse1wipiaqcf0a7trlm0lwz0g.png"><br><br>  ููุง ูุชุจูู ุ ูุฅู ูุณุจุฉ ุงูุชุฎูู ุนู ุงูุณุฏุงุฏ ุฃุนูู ููุดุจุงุจ ูุชูุฎูุถ ูุน ุชูุฏู ุงูุนูุฑ.  ูุฐุง ููุณ ุณุจุจุง ูุฑูุถ ุงูุงุฆุชูุงู ููุดุจุงุจ ุฏุงุฆูุง ุ ูุซู ูุฐู "ุงูุชูุตูุฉ" ูู ุชุคุฏู ุฅูุง ุฅูู ููุฏุงู ุงูุฏุฎู ูุงูุณูู ููุจูู.  ูุฐู ููุงุณุจุฉ ููุชูููุฑ ูู ุฑุตุฏ ุฃูุซุฑ ุดูููุงู ููุซู ูุฐู ุงููุฑูุถ ูุงูุชูููู ุ ูุฑุจูุง ุญุชู ููุน ูู ุงูุชุนููู ุงููุงูู ููููุชุฑุถูู ุงูุดุจุงุจ. <br><br><h3 style=";text-align:right;direction:rtl">  ูุตุงุฏุฑ ุฎุงุฑุฌูุฉ </h3><br>  ุฏุนููุง ูููู ูุธุฑุฉ ูุงุญุตุฉ ุนูู "ูุตุงุฏุฑ ุงูุจูุงูุงุช ุงูุฎุงุฑุฌูุฉ" EXT_SOURCE ูุงุฑุชุจุงุทูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">ext_data = app_train[[<span class="hljs-string"><span class="hljs-string">'TARGET'</span></span>, <span class="hljs-string"><span class="hljs-string">'EXT_SOURCE_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'EXT_SOURCE_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'EXT_SOURCE_3'</span></span>, <span class="hljs-string"><span class="hljs-string">'DAYS_BIRTH'</span></span>]] ext_data_corrs = ext_data.corr() ext_data_corrs</code> </pre> <br><img src="https://habrastorage.org/webt/5k/ba/fe/5kbafej-y0vvcexlt6iebcjvjbs.png"><br><br>  ููุง ุฃูู ููุงุณุจ ูุนุฑุถ ุงูุงุฑุชุจุงุท ุจุงุณุชุฎุฏุงู ูุฎุทุท ุงูุญุฑุงุฑุฉ <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">sns.heatmap(ext_data_corrs, cmap = plt.cm.RdYlBu_r, vmin = <span class="hljs-number"><span class="hljs-number">-0.25</span></span>, annot = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, vmax = <span class="hljs-number"><span class="hljs-number">0.6</span></span>) plt.title(<span class="hljs-string"><span class="hljs-string">'Correlation Heatmap'</span></span>);</code> </pre> <br><img src="https://habrastorage.org/webt/e6/wj/vw/e6wjvwnetgs2y-i65_4okda-6t8.png"><br><br>  ููุง ุชุฑู ุ ุชุธูุฑ ุฌููุน ุงููุตุงุฏุฑ ุนูุงูุฉ ุณูุจูุฉ ูุน ุงููุฏู.  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุชูุฒูุน ููุฏู ููู ูุตุฏุฑ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plt.figure(figsize = (<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>))โ <span class="hljs-comment"><span class="hljs-comment">#    for i, source in enumerate(['EXT_SOURCE_1', 'EXT_SOURCE_2', 'EXT_SOURCE_3']): #  plt.subplot(3, 1, i + 1) #    sns.kdeplot(app_train.loc[app_train['TARGET'] == 0, source], label = 'target == 0') #    sns.kdeplot(app_train.loc[app_train['TARGET'] == 1, source], label = 'target == 1') #  plt.title('Distribution of %s by Target Value' % source) plt.xlabel('%s' % source); plt.ylabel('Density'); plt.tight_layout(h_pad = 2.5)</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/lf/ig/xm/lfigxmxlck1s4w2uyygfudghajm.png"><br><br>  ุงูุตูุฑุฉ ูุดุงุจูุฉ ููุชูุฒูุน ุญุณุจ ุงูุนูุฑ - ูุน ุฒูุงุฏุฉ ุงููุคุดุฑ ุ ูุฒุฏุงุฏ ุงุญุชูุงู ุนูุฏุฉ ุงููุฑุถ.  ุงููุตุฏุฑ ุงูุซุงูุซ ูู ุงูุฃููู ูู ูุฐุง ุงูุตุฏุฏ.  ุนูู ุงูุฑุบู ูู ุฃู ุงูุนูุงูุฉ ูุน ุงููุชุบูุฑ ุงููุฏู ูุง ุชุฒุงู ูู ุญูุซ ุงููููุฉ ุงููุทููุฉ ูู ุงููุฆุฉ "ููุฎูุถุฉ ุฌุฏูุง" ุ ุฅูุง ุฃู ูุตุงุฏุฑ ุงูุจูุงูุงุช ุงูุฎุงุฑุฌูุฉ ูุงูุนูุฑ ุณุชููู ุฐุงุช ุฃูููุฉ ูุตูู ูู ุจูุงุก ุงููููุฐุฌ. <br><br><h3 style=";text-align:right;direction:rtl">  ุฌุฏูู ุงูุฒูุฌ </h3><br>  ูููู ุนูุงูุฉ ูุฐู ุงููุชุบูุฑุงุช ุจุดูู ุฃูุถู ุ ููููู ุฅูุดุงุก ูุฎุทุท ุฒูุฌู ุ ุญูุซ ูููููุง ุฃู ูุฑู ุนูุงูุฉ ูู ุฒูุฌ ููุฎุทุท ุจูุงูู ููุชูุฒูุน ุนูู ุทูู ุงููุทุฑ.  ููู ุงููุทุฑ ุ ููููู ุฅุธูุงุฑ ูุฎุทุท ุงูููุงุท ุ ูุฃุฏูุงู - 2d ููุฏู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       age_data = app_train[['TARGET', 'DAYS_BIRTH']] age_data['YEARS_BIRTH'] = age_data['DAYS_BIRTH'] / 365โ #     plot_data = ext_data.drop(labels = ['DAYS_BIRTH'], axis=1).copy()โ #   plot_data['YEARS_BIRTH'] = age_data['YEARS_BIRTH']โ #         100 .  plot_data = plot_data.dropna().loc[:100000, :]โ #     def corr_func(x, y, **kwargs): r = np.corrcoef(x, y)[0][1] ax = plt.gca() ax.annotate("r = {:.2f}".format(r), xy=(.2, .8), xycoords=ax.transAxes, size = 20)โ #   pairgrid object grid = sns.PairGrid(data = plot_data, size = 3, diag_sharey=False, hue = 'TARGET', vars = [x for x in list(plot_data.columns) if x != 'TARGET'])โ #  -  grid.map_upper(plt.scatter, alpha = 0.2)โ #  -  grid.map_diag(sns.kdeplot)โ #  -   grid.map_lower(sns.kdeplot, cmap = plt.cm.OrRd_r);โ plt.suptitle('Ext Source and Age Features Pairs Plot', size = 32, y = 1.05);</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/wu/bm/ut/wubmutz04p4kwsmmk34gbuoq71g.png"><br><br>  ุชุธูุฑ ุงููุฑูุถ ุงููุงุจูุฉ ููุณุฏุงุฏ ุจุงูููู ุงูุฃุฒุฑู ูุบูุฑ ูุงุจูุฉ ููุณุฏุงุฏ ุจุงูููู ุงูุฃุญูุฑ.  ุฅู ุชูุณูุฑ ูู ูุฐุง ุฃูุฑ ุตุนุจ ุฅูู ุญุฏ ูุง ุ ูููู ูููู ุฃู ุชุธูุฑ ุตูุฑุฉ ุฌูุฏุฉ ุนูู ูููุต ุฃู ุตูุฑุฉ ูู ูุชุญู ูููู ุงูุญุฏูุซ ูู ูุฐู ุงูุตูุฑุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ูุญุต ุงูุนูุงูุงุช ุงูุฃุฎุฑู </h3><br>  ุฏุนููุง ูููุฑ ุจูุฒูุฏ ูู ุงูุชูุตูู ูู ุงูููุฒุงุช ุงูุฃุฎุฑู ูุงุนุชูุงุฏูุง ุนูู ุงููุชุบูุฑ ุงููุณุชูุฏู.  ูุธุฑูุง ููุฌูุฏ ุงูุนุฏูุฏ ูู ุงููุฆุงุช ุงููุฆููุฉ (ูุชูููุง ุจุงููุนู ูู ุชุฑููุฒูุง) ุ ูุญุชุงุฌ ูุฑุฉ ุฃุฎุฑู ุฅูู ุงูุจูุงูุงุช ุงูุฃูููุฉ.  ุฏุนูุง ูุณูููุง ุจุดูู ูุฎุชูู ููููุงู ูุชุฌูุจ ุงูุงุฑุชุจุงู <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">application_train = pd.read_csv(PATH+<span class="hljs-string"><span class="hljs-string">"application_train.csv"</span></span>) application_test = pd.read_csv(PATH+<span class="hljs-string"><span class="hljs-string">"application_test.csv"</span></span>)</code> </pre> <br>  ุณูุญุชุงุฌ ุฃูุถูุง ุฅูู ูุธููุชูู ูุนุฑุถ ุงูุชูุฒูุนุงุช ูุชุฃุซูุฑูุง ุนูู ุงููุชุบูุฑ ุงููุณุชูุฏู ุจุดูู ุฌููู.  ุดูุฑุง ุฌุฒููุง ููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุคูู</a> ูุฐู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงุฉ</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plot_stats</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(feature,label_rotation=False,horizontal_layout=True)</span></span></span><span class="hljs-function">:</span></span> temp = application_train[feature].value_counts() df1 = pd.DataFrame({feature: temp.index,<span class="hljs-string"><span class="hljs-string">' '</span></span>: temp.values})โ <span class="hljs-comment"><span class="hljs-comment">#   target=1   cat_perc = application_train[[feature, 'TARGET']].groupby([feature],as_index=False).mean() cat_perc.sort_values(by='TARGET', ascending=False, inplace=True) if(horizontal_layout): fig, (ax1, ax2) = plt.subplots(ncols=2, figsize=(12,6)) else: fig, (ax1, ax2) = plt.subplots(nrows=2, figsize=(12,14)) sns.set_color_codes("pastel") s = sns.barplot(ax=ax1, x = feature, y=" ",data=df1) if(label_rotation): s.set_xticklabels(s.get_xticklabels(),rotation=90) s = sns.barplot(ax=ax2, x = feature, y='TARGET', order=cat_perc[feature], data=cat_perc) if(label_rotation): s.set_xticklabels(s.get_xticklabels(),rotation=90) plt.ylabel(' ', fontsize=10) plt.tick_params(axis='both', which='major', labelsize=10)โ plt.show();</span></span></code> </pre> <br>  ูุฐุง ุ ุณููุธุฑ ูู ุงูุนูุงูุงุช ุงูุฑุฆูุณูุฉ ููุนููุงุก <br><br><h3 style=";text-align:right;direction:rtl">  ููุน ุงููุฑุถ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plot_stats(<span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_TYPE'</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/gf/xr/hd/gfxrhdfhqe7zyvlvwjmtgg-opam.png"><br><br>  ููู ุงููุซูุฑ ููุงูุชูุงู ุฃู ุงููุฑูุถ ุงููุชุฌุฏุฏุฉ (ุนูู ุงูุฃุฑุฌุญ ุงูุณุญุจ ุนูู ุงูููุดูู ุฃู ุดูุก ูู ูุฐุง ุงููุจูู) ุชุดูู ุฃูู ูู 10ูช ูู ุฅุฌูุงูู ุนุฏุฏ ุงููุฑูุถ.  ููู ุงูููุช ููุณู ุ ูุฅู ูุณุจุฉ ุนุฏู ุงูุนูุฏุฉ ุจูููู ุฃุนูู ุจูุซูุฑ.  ุณุจุจ ูุฌูู ููุฑุงุฌุนุฉ ูููุฌูุฉ ุงูุนูู ูุน ูุฐู ุงููุฑูุถ ุ ูุฑุจูุง ุญุชู ุงูุชุฎูู ุนููุง. <br><br><h3 style=";text-align:right;direction:rtl">  ุฌูุณ ุงูุนููู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plot_stats(<span class="hljs-string"><span class="hljs-string">'CODE_GENDER'</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/fj/vu/eu/fjvueuchpemqvpmijfzsslyiy5m.png"><br><br>  ููุงู ูุง ููุฑุจ ูู ุถุนู ุนุฏุฏ ุงูุนููุงุก ูู ุงููุณุงุก ุ ุญูุซ ูุธูุฑ ุงูุฑุฌุงู ุฎุทุฑูุง ุฃูุจุฑ ุจูุซูุฑ. <br><br><h3 style=";text-align:right;direction:rtl">  ููููุฉ ุงูุณูุงุฑุฉ ูุงูููุชููุงุช </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plot_stats(<span class="hljs-string"><span class="hljs-string">'FLAG_OWN_CAR'</span></span>) plot_stats(<span class="hljs-string"><span class="hljs-string">'FLAG_OWN_REALTY'</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/l4/iv/u4/l4ivu4-yhdkdma8yjrnhj07evdq.png"><br><img src="https://habrastorage.org/webt/fg/qn/2-/fgqn2-3qqhjvkbovec9zm_qkfgo.png"><br><br>  ุนููุงุก ุงูุณูุงุฑุฉ ูู ูุตู "ุจูุง ุญุตุงู".  ุงูุฎุทุฑ ูู ููุณู ุชูุฑูุจูุง ุ ูุฏูุน ุงูุนููุงุก ุงูุฐูู ูุฏููู ุงููุงูููุฉ ุฃูุถู ููููุงู. <br><br>  ุจุงููุณุจุฉ ููุนูุงุฑ ุ ูุฅู ุงูุนูุณ ูู ุงูุตุญูุญ - ููุงู ูุตู ุนุฏุฏ ูููู ูู ุงูุนููุงุก ุจุฏููู.  ููุง ุฃู ุงูุฎุทุฑ ุนูู ูุงููู ุงูุนูุงุฑุงุช ุฃูู ุจูููู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุญุงูุฉ ุงูุฒูุฌูุฉ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plot_stats(<span class="hljs-string"><span class="hljs-string">'NAME_FAMILY_STATUS'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/7u/qt/t1/7uqtt10kghqs01w-_y_1e6vx2jw.png"><br><br>  ูู ุญูู ุฃู ูุนุธู ุงูุนููุงุก ูุชุฒูุฌูู ุ ูุฅู ุงูุฃูุซุฑ ุฎุทูุฑุฉ ูู ุงูุนููุงุก ุงููุฏูููู ูุงูุนุฒุงุจ.  ูุธูุฑ ุงูุฃุฑุงูู ุงูุญุฏ ุงูุฃุฏูู ูู ุงููุฎุงุทุฑ. <br><br><h3 style=";text-align:right;direction:rtl">  ุนุฏุฏ ุงูุงุทูุงู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plot_stats(<span class="hljs-string"><span class="hljs-string">'CNT_CHILDREN'</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/5s/ux/o8/5suxo8vh8yl68pnxqf4vm7c-ixa.png"><br><br>  ูุนุธู ุงูุนููุงุก ุจูุง ุฃุทูุงู.  ูู ุงูููุช ููุณู ุ ููุธูุฑ ุงูุนููุงุก ุงูุฐูู ูุฏููู 9 ู 11 ุทููุงู ุนุฏู ุงุณุชุฑุฏุงุฏ ุงูุฃููุงู ุจุงููุงูู <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">application_train.CNT_CHILDREN.value_counts()</code> </pre> <br> <code>0 215371 <br> 1 61119 <br> 2 26749 <br> 3 3717 <br> 4 429 <br> 5 84 <br> 6 21 <br> 7 7 <br> 14 3 <br> 19 2 <br> 12 2 <br> 10 2 <br> 9 2 <br> 8 2 <br> 11 1 <br> Name: CNT_CHILDREN, dtype: int64</code> <br> <br>  ููุง ูุธูุฑ ุญุณุงุจ ุงูููู ุ ูุฅู ูุฐู ุงูุจูุงูุงุช ุบูุฑ ูููุฉ ุฅุญุตุงุฆููุง - ููุท ุนูููุงู ูู ุงููุฆุชูู.  ููุน ุฐูู ุ ููุฏ ุนุฌุฒ ุงูุซูุงุซุฉ ุนู ุงูุนูู ุ ููุง ูุนู ูุตู ุงูุนููุงุก ุงูุฐูู ูุฏููู 6 ุฃุทูุงู. <br><br><h3 style=";text-align:right;direction:rtl">  ุนุฏุฏ ุฃูุฑุงุฏ ุงูุฃุณุฑุฉ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plot_stats(<span class="hljs-string"><span class="hljs-string">'CNT_FAM_MEMBERS'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/bw/tg/sc/bwtgsctk9vk_y8tcx9bv9fraogu.png"><br><br>  ุงููุถุน ูุดุงุจู - ูููุง ูู ุนุฏุฏ ุงูุฃููุงู ุ ูููุง ุฒุงุฏ ุงูุนุงุฆุฏ. <br><br><h3 style=";text-align:right;direction:rtl">  ููุน ุงูุฏุฎู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plot_stats(<span class="hljs-string"><span class="hljs-string">'NAME_INCOME_TYPE'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/ow/la/kf/owlakfzs7cqh74msyjw9ngeq8h4.png"><br><br>  ูู ุงููุฑุฌุญ ุฃู ุชููุทุน ุงูุฃููุงุช ุงูุนุงุฒุจุงุช ูุงูุนุงุทูุงุช ุนู ุงูุนูู ูู ูุฑุญูุฉ ุงูุชูุฏูู - ูููุงู ุงููููู ุฌุฏูุง ูููู ูู ุงูุนููุฉ.  ููู ุงููุดุงูู ุชุธูุฑ ุจุซุจุงุช. <br><br><h3 style=";text-align:right;direction:rtl">  ููุน ุงููุดุงุท </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plot_stats(<span class="hljs-string"><span class="hljs-string">'OCCUPATION_TYPE'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/pw/m4/eu/pwm4eui3y46rrd0380w5jnkqiug.png"><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">application_train.OCCUPATION_TYPE.value_counts()</code> </pre> <br> <code>Laborers 55186 <br> Sales staff 32102 <br> Core staff 27570 <br> Managers 21371 <br> Drivers 18603 <br> High skill tech staff 11380 <br> Accountants 9813 <br> Medicine staff 8537 <br> Security staff 6721 <br> Cooking staff 5946 <br> Cleaning staff 4653 <br> Private service staff 2652 <br> Low-skill Laborers 2093 <br> Waiters/barmen staff 1348 <br> Secretaries 1305 <br> Realty agents 751 <br> HR staff 563 <br> IT staff 526 <br> Name: OCCUPATION_TYPE, dtype: int64</code> <br> <br>  ุฅููุง ุฐุงุช ุฃูููุฉ ููุณุงุฆููู ูุถุจุงุท ุงูุฃูู ุงูุฐูู ูู ูุซูุฑูู ูููุงุฌููู ูุดุงูู ูู ูุซูุฑ ูู ุงูุฃุญูุงู ุฃูุซุฑ ูู ุงููุฆุงุช ุงูุฃุฎุฑู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุชุนููู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plot_stats(<span class="hljs-string"><span class="hljs-string">'NAME_EDUCATION_TYPE'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/dh/g9/-t/dhg9-t4wl5oaaultg0m4ujq4ky0.png"><br><br>  ูููุง ุฒุงุฏ ุงูุชุนููู ุ ูููุง ูุงู ุงูุชูุฑุงุฑ ุฃูุถู. <br><br><h3 style=";text-align:right;direction:rtl">  ููุน ุงูููุธูุฉ - ุตุงุญุจ ุงูุนูู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plot_stats(<span class="hljs-string"><span class="hljs-string">'ORGANIZATION_TYPE'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/nm/eq/p-/nmeqp-rvrmowwpqhkjzvygeah20.png"><br><br>  ููุญุธุช ุฃุนูู ูุณุจุฉ ูู ุนุฏู ุงูุนูุฏุฉ ูู ุงูููู: ุงูููุน 3 (16ูช) ุ ุงูุตูุงุนุฉ: ุงูููุน 13 (13.5ูช) ุ ุงูุตูุงุนุฉ: ุงูููุน 8 (12.5ูช) ูุงููุทุนู (ุญุชู 12ูช). <br><br><h3 style=";text-align:right;direction:rtl">  ุชุฎุตูุต ุงููุฑุถ </h3><br>  ุงููุธุฑ ูู ุชูุฒูุน ูุจุงูุบ ุงููุฑูุถ ูุฃุซุฑูุง ุนูู ุงูุณุฏุงุฏ <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>)) plt.title(<span class="hljs-string"><span class="hljs-string">" AMT_CREDIT"</span></span>) ax = sns.distplot(app_train[<span class="hljs-string"><span class="hljs-string">"AMT_CREDIT"</span></span>])</code> </pre> <br><img src="https://habrastorage.org/webt/x1/8k/qg/x18kqghr1tue4io96l_keuqcr94.png"><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>))โ <span class="hljs-comment"><span class="hljs-comment"># KDE ,   sns.kdeplot(app_train.loc[app_train['TARGET'] == 0, 'AMT_CREDIT'], label = 'target == 0')โ # KDE   sns.kdeplot(app_train.loc[app_train['TARGET'] == 1, 'AMT_CREDIT'], label = 'target == 1')โ #  plt.xlabel(' '); plt.ylabel(''); plt.title(' ');</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/_3/fu/cj/_3fucjn19lmxvjjaamrrlwumh5m.png"><br><br>  ููุง ูุธูุฑ ุงูุฑุณู ุงูุจูุงูู ูููุซุงูุฉ ุ ูุชู ุฅุฑุฌุงุน ูููุงุช ูููุฉ ูู ูุซูุฑ ูู ุงูุฃุญูุงู <br><br><h3 style=";text-align:right;direction:rtl">  ุชูุฒูุน ุงููุซุงูุฉ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>)) plt.title(<span class="hljs-string"><span class="hljs-string">" REGION_POPULATION_RELATIVE"</span></span>) ax = sns.distplot(app_train[<span class="hljs-string"><span class="hljs-string">"REGION_POPULATION_RELATIVE"</span></span>])</code> </pre> <br><img src="https://habrastorage.org/webt/26/3h/os/263hoss0mbvvq2p0ewagrw5v-sm.png"><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>))โ <span class="hljs-comment"><span class="hljs-comment"># KDE ,   sns.kdeplot(app_train.loc[app_train['TARGET'] == 0, 'REGION_POPULATION_RELATIVE'], label = 'target == 0')โ # KDE   sns.kdeplot(app_train.loc[app_train['TARGET'] == 1, 'REGION_POPULATION_RELATIVE'], label = 'target == 1')โ #  plt.xlabel(''); plt.ylabel(' '); plt.title(' ');</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/fs/ez/82/fsez82q5fbqdkiqizkxjralpm-8.png"><br><br>  ูููู ุงูุนููุงุก ูู ุงูููุงุทู ุงูุฃูุซุฑ ุณูุงููุง ุฅูู ุฏูุน ุงููุฑูุถ ุจุดูู ุฃูุถู. <br><br>  ูููุฐุง ุ ุญุตููุง ุนูู ููุฑุฉ ุนู ุงูุณูุงุช ุงูุฑุฆูุณูุฉ ููุฌููุนุฉ ุงูุจูุงูุงุช ูุชุฃุซูุฑูุง ุนูู ุงููุชูุฌุฉ.  ูู ููุนู ุฃู ุดูุก ุนูู ูุฌู ุงูุชุญุฏูุฏ ูุน ุชูู ุงููุฏุฑุฌุฉ ูู ูุฐู ุงูููุงูุฉ ุ ูููู ูููู ุฃู ุชููู ูููุฉ ุฌุฏูุง ูู ุงูุนูู ุงููุณุชูุจูู. <br><br><h2 style=";text-align:right;direction:rtl">  ููุฏุณุฉ ุงูููุฒุงุช - ุชุญููู ุงูููุฒุฉ </h2><br>  ูุชู ุงูููุฒ ุจุงููุณุงุจูุงุช ุนูู Kaggle ุนู ุทุฑูู ุชุญููู ุงูุนูุงูุงุช - ุงูุดุฎุต ุงูุฐู ููููู ุฅูุดุงุก ุฃูุซุฑ ุงูุนูุงูุงุช ุงููููุฏุฉ ูู ุงูุจูุงูุงุช ูููุฒ.  ุนูู ุงูุฃูู ุจุงููุณุจุฉ ููุจูุงูุงุช ุงูููุธูุฉ ุ ูุฅู ุงูููุงุฐุฌ ุงููุงุฆุฒุฉ ูู ุงูุขู ุฎูุงุฑุงุช ูุฎุชููุฉ ูุชุนุฒูุฒ ุงูุชุฏุฑุฌ.  ูู ุฃุบูุจ ุงูุฃุญูุงู ุ ูููู ูุถุงุก ุงูููุช ูู ุชุญููู ุงูุณูุงุช ุฃูุซุฑ ููุงุกุฉ ูู ุฅุนุฏุงุฏ ุงููุนููุงุช ุงูููุฑุทุฉ ุฃู ุงุฎุชูุงุฑ ุงูููุงุฐุฌ.  ูุง ูุฒุงู ุจุฅููุงู ุงููููุฐุฌ ุงูุชุนูู ููุท ูู ุงูุจูุงูุงุช ุงูุชู ุชู ููููุง ุฅููู.  ุฅู ุงูุชุฃูุฏ ูู ุฃู ุงูุจูุงูุงุช ุฐุงุช ุตูุฉ ุจุงููููุฉ ูู ุงููุณุคูููุฉ ุงูุฑุฆูุณูุฉ ุนู ุชุงุฑูุฎ ุงูุนุงูู. <br><br>  ูุฏ ุชุชุถูู ุนูููุฉ ุชุญููู ุงูุฎุตุงุฆุต ุฅูุดุงุก ุจูุงูุงุช ุฌุฏูุฏุฉ ูุชุงุญุฉ ูุงุฎุชูุงุฑ ุฃูู ุงูุจูุงูุงุช ุงููุชุงุญุฉ ููุง ุฅูู ุฐูู.  ุณูุญุงูู ูุฐู ุงููุฑุฉ ุนูุงูุงุช ูุซูุฑุฉ ุงูุญุฏูุฏ. <br><br><h3 style=";text-align:right;direction:rtl">  ุนูุงูุงุช ูุซูุฑุฉ ุงูุญุฏูุฏ </h3><br>  ุฅู ุงูุทุฑููุฉ ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูุจูุงุก ุงูููุฒุงุช ูู ุฃููุง ูููู ุจุจุณุงุทุฉ ุจุฅูุดุงุก ููุฒุงุช ูู ุฏุฑุฌุฉ ุงูููุฒุงุช ุงููุชุงุญุฉ ูููุชุฌุงุชูุง.  ูู ุจุนุถ ุงูุญุงูุงุช ุ ูุฏ ูููู ููุฐู ุงูุณูุงุช ุงููุฑูุจุฉ ุงุฑุชุจุงุท ุฃููู ูุน ุงููุชุบูุฑ ุงููุณุชูุฏู ูู "ุขุจุงุฆูู".  ุนูู ุงูุฑุบู ูู ุฃู ูุฐู ุงูุฃุณุงููุจ ุบุงูุจูุง ูุง ุชุณุชุฎุฏู ูู ุงูููุงุฐุฌ ุงูุฅุญุตุงุฆูุฉ ุ ุฅูุง ุฃููุง ุฃูู ุดููุนูุง ูู ุงูุชุนูู ุงูุขูู.  ููุน ุฐูู.  ูุง ุดูุก ูููุนูุง ูู ุชุฌุฑุจุชูุง ุ ุฎุงุตุฉ ูุฃู Scikit-Learn ูุฏููุง ูุฆุฉ ูุฎุตุตุฉ ููุฐู ุงูุฃุบุฑุงุถ - PolynomialFeatures - ุงูุชู ุชุฎูู ููุฒุงุช ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ูููุชุฌุงุชูุง ุ ูุง ุนููู ุณูู ุชุญุฏูุฏ ุงูููุฒุงุช ุงูุฃุตููุฉ ููุณูุง ูุฃูุตู ุฏุฑุฌุฉ ูุฌุจ ุฑูุนูุง.  ูุญู ูุณุชุฎุฏู ุงูุชุฃุซูุฑุงุช ุงูุฃูุซุฑ ููุฉ ุนูู ูุชูุฌุฉ 4 ุณูุงุช ูุฏุฑุฌุฉ 3 ุญุชู ูุง ูุนูุฏ ุงููููุฐุฌ ูุซูุฑูุง ูุชุฌูุจ ุงูุฅูุฑุงุท ูู ุงูุชุฌููุฒ (ุงูุฅูุฑุงุท ูู ุชุฏุฑูุจ ุงููููุฐุฌ - ุชุนุฏููู ุงูููุฑุท ูุนููุฉ ุงูุชุฏุฑูุจ). <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       poly_features = app_train[['EXT_SOURCE_1', 'EXT_SOURCE_2', 'EXT_SOURCE_3', 'DAYS_BIRTH', 'TARGET']] poly_features_test = app_test[['EXT_SOURCE_1', 'EXT_SOURCE_2', 'EXT_SOURCE_3', 'DAYS_BIRTH']]โ #    from sklearn.preprocessing import Imputer imputer = Imputer(strategy = 'median')โ poly_target = poly_features['TARGET']โ poly_features = poly_features.drop('TARGET', axis=1)โ poly_features = imputer.fit_transform(poly_features) poly_features_test = imputer.transform(poly_features_test) from sklearn.preprocessing import PolynomialFeatures #     3 poly_transformer = PolynomialFeatures(degree = 3) #    poly_transformer.fit(poly_features) #   poly_features = poly_transformer.transform(poly_features) poly_features_test = poly_transformer.transform(poly_features_test) print('  : ', poly_features.shape)</span></span></code> </pre> <br> <code>  : (307511, 35) <br>        get_feature_names</code> <br> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">poly_transformer.get_feature_names(input_features = [<span class="hljs-string"><span class="hljs-string">'EXT_SOURCE_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'EXT_SOURCE_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'EXT_SOURCE_3'</span></span>, <span class="hljs-string"><span class="hljs-string">'DAYS_BIRTH'</span></span>])[:<span class="hljs-number"><span class="hljs-number">15</span></span>]</code> </pre> <br> <code>['1', <br> 'EXT_SOURCE_1', <br> 'EXT_SOURCE_2', <br> 'EXT_SOURCE_3', <br> 'DAYS_BIRTH', <br> 'EXT_SOURCE_1^2', <br> 'EXT_SOURCE_1 EXT_SOURCE_2', <br> 'EXT_SOURCE_1 EXT_SOURCE_3', <br> 'EXT_SOURCE_1 DAYS_BIRTH', <br> 'EXT_SOURCE_2^2', <br> 'EXT_SOURCE_2 EXT_SOURCE_3', <br> 'EXT_SOURCE_2 DAYS_BIRTH', <br> 'EXT_SOURCE_3^2', <br> 'EXT_SOURCE_3 DAYS_BIRTH', <br> 'DAYS_BIRTH^2']</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูุฌููุนู 35 ุณูุฉ ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ ููุดุชูุฉ. </font><font style="vertical-align: inherit;">ุชุญูู ูู ุงุฑุชุจุงุทูุง ุจุงููุฏู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     poly_features = pd.DataFrame(poly_features, columns = poly_transformer.get_feature_names(['EXT_SOURCE_1', 'EXT_SOURCE_2', 'EXT_SOURCE_3', 'DAYS_BIRTH']))โ #   poly_features['TARGET'] = poly_targetโ #   poly_corrs = poly_features.corr()['TARGET'].sort_values()โ #      print(poly_corrs.head(10)) print(poly_corrs.tail(5))</span></span></code> </pre> <br> <code>EXT_SOURCE_2 EXT_SOURCE_3 -0.193939 <br> EXT_SOURCE_1 EXT_SOURCE_2 EXT_SOURCE_3 -0.189605 <br> EXT_SOURCE_2 EXT_SOURCE_3 DAYS_BIRTH -0.181283 <br> EXT_SOURCE_2^2 EXT_SOURCE_3 -0.176428 <br> EXT_SOURCE_2 EXT_SOURCE_3^2 -0.172282 <br> EXT_SOURCE_1 EXT_SOURCE_2 -0.166625 <br> EXT_SOURCE_1 EXT_SOURCE_3 -0.164065 <br> EXT_SOURCE_2 -0.160295 <br> EXT_SOURCE_2 DAYS_BIRTH -0.156873 <br> EXT_SOURCE_1 EXT_SOURCE_2^2 -0.156867 <br> Name: TARGET, dtype: float64 <br> DAYS_BIRTH -0.078239 <br> DAYS_BIRTH^2 -0.076672 <br> DAYS_BIRTH^3 -0.074273 <br> TARGET 1.000000 <br> 1 NaN <br> Name: TARGET, dtype: float64</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ุ ุชุธูุฑ ุจุนุถ ุงูุนูุงูุงุช ุงุฑุชุจุงุทูุง ุฃุนูู ูู ุงูุฃุตู. </font><font style="vertical-align: inherit;">ูู ุงูููุทูู ูุญุงููุฉ ุงูุชุนูู ูุนูู ูุจุฏูููู (ูุซู ุงููุซูุฑ ูู ุงูุชุนูู ุงูุขูู ุ ูููู ุชุญุฏูุฏ ุฐูู ุชุฌุฑูุจููุง). </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ูู ุจุฅูุดุงุก ูุณุฎุฉ ูู ุฅุทุงุฑุงุช ุงูุจูุงูุงุช ูุฅุถุงูุฉ ููุฒุงุช ุฌุฏูุฏุฉ ููุงู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      poly_features_test = pd.DataFrame(poly_features_test, columns = poly_transformer.get_feature_names(['EXT_SOURCE_1', 'EXT_SOURCE_2', 'EXT_SOURCE_3', 'DAYS_BIRTH']))โ #    poly_features['SK_ID_CURR'] = app_train['SK_ID_CURR'] app_train_poly = app_train.merge(poly_features, on = 'SK_ID_CURR', how = 'left')โ #    poly_features_test['SK_ID_CURR'] = app_test['SK_ID_CURR'] app_test_poly = app_test.merge(poly_features_test, on = 'SK_ID_CURR', how = 'left')โ #   app_train_poly, app_test_poly = app_train_poly.align(app_test_poly, join = 'inner', axis = 1)โ #   print('    : ', app_train_poly.shape) print('    : ', app_test_poly.shape)</span></span></code> </pre> <br> <code>    : (307511, 277) <br>     : (48744, 277)</code> <br> <br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุฏุฑูุจ ูููุฐุฌู </font></font></h2><br><h3 style=";text-align:right;direction:rtl">  ุงููุณุชูู ุงูุฃุณุงุณู </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูุญุณุงุจุงุช ุ ุชุญุชุงุฌ ุฅูู ุงูุจุฏุก ูู ุจุนุถ ุงููุณุชูู ุงูุฃุณุงุณู ูููููุฐุฌ ุ ูุงูุฐู ูู ูุนุฏ ูู ุงููููู ุฃู ููุฎูุถ. </font><font style="vertical-align: inherit;">ูู ุญุงูุชูุง ุ ูููู ุฃู ูููู ูุฐุง 0.5 ูุฌููุน ุนููุงุก ุงูุงุฎุชุจุงุฑ - ููุฐุง ูุฏู ุนูู ุฃูู ููุณ ูุฏููุง ุฃู ููุฑุฉ ุนูู ุงูุฅุทูุงู ุนูุง ุฅุฐุง ูุงู ุงูุนููู ุณูู ูุณุฏุฏ ุงููุฑุถ ุฃู ูุง. </font><font style="vertical-align: inherit;">ูู ุญุงูุชูุง ุ ุชู ุจุงููุนู ุงูุนูู ุงูุชูููุฏู ููููู ุงุณุชุฎุฏุงู ููุงุฐุฌ ุฃูุซุฑ ุชุนููุฏูุง.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุงูุญุฏุงุฑ ุงูููุฌุณุชู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุณุงุจ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุงูุญุฏุงุฑ ุงูููุฌุณุชู ุ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุญุชุงุฌ ุฅูู ุฃุฎุฐ ุฌุฏุงูู ุจููุฒุงุช ูุฆููุฉ ูุดูุฑุฉ ุ ูููุก ุงูุจูุงูุงุช ุงูููููุฏุฉ ูุชุทุจูุนูุง (ููููุง ุฅูู ููู ูู 0 ุฅูู 1). </font><font style="vertical-align: inherit;">ูู ูุฐุง ูููุฐ ุงูููุฏ ุงูุชุงูู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.preprocessing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MinMaxScaler, Imputerโ <span class="hljs-comment"><span class="hljs-comment">#      if 'TARGET' in app_train: train = app_train.drop(labels = ['TARGET'], axis=1) else: train = app_train.copy() features = list(train.columns)โ #    test = app_test.copy()โ #     imputer = Imputer(strategy = 'median')โ #  scaler = MinMaxScaler(feature_range = (0, 1))โ #    imputer.fit(train)โ #      train = imputer.transform(train) test = imputer.transform(app_test)โ #      scaler.fit(train) train = scaler.transform(train) test = scaler.transform(test)โ print('  : ', train.shape) print('  : ', test.shape)</span></span></code> </pre> <br> <code>  : (307511, 242) <br>   : (48744, 242)</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุชุฎุฏู ุงูุงูุญุฏุงุฑ ุงูููุฌุณุชู ูู Scikit-Learn ููููุฐุฌ ุฃูู. </font><font style="vertical-align: inherit;">ููุฃุฎุฐ ูููุฐุฌ ุงูุชูุณูุฑ ุจุชุตุญูุญ ูุงุญุฏ - ูุฎูุถ ูุนููุฉ ุงูุชุณููุฉ C ูุชุฌูุจ ุงูุฅูุฑุงุท ูู ุงูุชุฌููุฒ. </font><font style="vertical-align: inherit;">ุจูุงุก ุงูุฌููุฉ ุฃูุฑ ุทุจูุนู - ูุญู ููุดุฆ ูููุฐุฌูุง ุ ูุฏุฑุจู ููุชูุจุฃ ุจุงูุงุญุชูุงููุฉ ุจุงุณุชุฎุฏุงู prob_proba (ูุญุชุงุฌ ุฅูู ุงูุงุญุชูุงููุฉ ุ ูููุณ 0/1)</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.linear_model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LogisticRegressionโ <span class="hljs-comment"><span class="hljs-comment">#   log_reg = LogisticRegression(C = 0.0001)โ #   log_reg.fit(train, train_labels) LogisticRegression(C=0.0001, class_weight=None, dual=False, fit_intercept=True, intercept_scaling=1, max_iter=100, multi_class='ovr', n_jobs=1, penalty='l2', random_state=None, solver='liblinear', tol=0.0001, verbose=0, warm_start=False)      .  prdict_proba     mx 2,  m -  ,   -  0,  -  1.    ( ). log_reg_pred = log_reg.predict_proba(test)[:, 1]</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุงูุขู ุฅูุดุงุก ููู ููุชุญููู ุฅูู Kaggle. </font><font style="vertical-align: inherit;">ุฅูุดุงุก ุฅุทุงุฑ ุจูุงูุงุช ูู ุงูุฑูู ุงูุชุนุฑููู ููุนููู ูุงุญุชูุงู ุนุฏู ุงูุฅุฑุฌุงุน ูุชุญูููู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">submit = app_test[[<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>]] submit[<span class="hljs-string"><span class="hljs-string">'TARGET'</span></span>] = log_reg_predโ submit.head()</code> </pre> <br> <code>SK_ID_CURR TARGET <br> 0 100001 0.087954 <br> 1 100005 0.163151 <br> 2 100013 0.109923 <br> 3 100028 0.077124 <br> 4 100038 0.151694</code> <br> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">submit.to_csv(<span class="hljs-string"><span class="hljs-string">'log_reg_baseline.csv'</span></span>, index = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐู ุ ูุชูุฌุฉ ุนูููุง ุงูุนููุงู: 0.673 ุ ูุน ุฃูุถู ูุชูุฌุฉ ููุฐุง ุงูููู ูู 0.802.</font></font></b> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููุฐุฌ ูุญุณู - ุบุงุจุฉ ุนุดูุงุฆูุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูุธูุฑ ููุฌุฑูุฌ ููุณู ุฌูุฏูุง ุ ูููุญุงูู ุงุณุชุฎุฏุงู ูููุฐุฌ ูุญุณูู - ุบุงุจุฉ ุนุดูุงุฆูุฉ. </font><font style="vertical-align: inherit;">ูุฐุง ูููุฐุฌ ุฃูุซุฑ ููุฉ ููููู ุจูุงุก ูุฆุงุช ุงูุฃุดุฌุงุฑ ูุชุญููู ูุชูุฌุฉ ุฃูุซุฑ ุฏูุฉ. </font><font style="vertical-align: inherit;">ูุณุชุฎุฏู 100 ุดุฌุฑุฉ. </font><font style="vertical-align: inherit;">ูุฎุทุท ุงูุนูู ูุน ุงููููุฐุฌ ูู ููุณู ุ ููุงุณู ุชูุงููุง - ุชุญููู ุงููุตูู ุ ุงูุชุฏุฑูุจ. </font><font style="vertical-align: inherit;">ุงูุชูุจุค.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.ensemble <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RandomForestClassifierโ <span class="hljs-comment"><span class="hljs-comment">#   random_forest = RandomForestClassifier(n_estimators = 100, random_state = 50)โ #     random_forest.fit(train, train_labels)โ #     predictions = random_forest.predict_proba(test)[:, 1]โ #     submit = app_test[['SK_ID_CURR']] submit['TARGET'] = predictionsโ #  submit.to_csv('random_forest_baseline.csv', index = False)</span></span></code> </pre> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูุฌุฉ ุงูุบุงุจุงุช ุงูุนุดูุงุฆูุฉ ุฃูุถู ููููุงู - 0.683</font></font></b> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููุฐุฌ ุชุฏุฑูุจ ูุน ููุฒุงุช ูุซูุฑุฉ ุงูุญุฏูุฏ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุฏููุง ูููุฐุฌ. </font><font style="vertical-align: inherit;">ุงูุฐู ููุนู ุดูุฆูุง ุนูู ุงูุฃูู - ุญุงู ุงูููุช ูุงุฎุชุจุงุฑ ุนูุงูุงุชูุง ูุชุนุฏุฏุฉ ุงูุญุฏูุฏ. </font><font style="vertical-align: inherit;">ูููุนู ููุณ ุงูุดูุก ูุนูู ูููุงุฑูุฉ ุงููุชูุฌุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">poly_features_names = list(app_train_poly.columns)โ <span class="hljs-comment"><span class="hljs-comment">#         imputer = Imputer(strategy = 'median')โ poly_features = imputer.fit_transform(app_train_poly) poly_features_test = imputer.transform(app_test_poly)โ #  scaler = MinMaxScaler(feature_range = (0, 1))โ poly_features = scaler.fit_transform(poly_features) poly_features_test = scaler.transform(poly_features_test)โ random_forest_poly = RandomForestClassifier(n_estimators = 100, random_state = 50) #     random_forest_poly.fit(poly_features, train_labels)โ #  predictions = random_forest_poly.predict_proba(poly_features_test)[:, 1]โ #    submit = app_test[['SK_ID_CURR']] submit['TARGET'] = predictionsโ #   submit.to_csv('random_forest_baseline_engineered.csv', index = False)</span></span></code> </pre> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูุฌุฉ ุบุงุจุฉ ุนุดูุงุฆูุฉ ุฐุงุช ุณูุงุช ูุซูุฑุฉ ุงูุญุฏูุฏ ุฃุตุจุญุช ุฃุณูุฃ - 0.633. </font><font style="vertical-align: inherit;">ุงูุฃูุฑ ุงูุฐู ูุดูู ูุซูุฑูุง ูู ุงูุญุงุฌุฉ ุฅูู ุงุณุชุฎุฏุงููุง.</font></font></b> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุนุฒูุฒ ุงูุชุฏุฑุฌ </font></font></h3><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนุฒูุฒ ุงูุชุฏุฑุฌ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู "ูููุฐุฌ ุฌุงุฏ" ูุชุนูู ุงูุขูุฉ. </font><font style="vertical-align: inherit;">ูุชู ุชูุฑูุจูุง ุฅุฌุฑุงุก ุฌููุน ุงููุณุงุจูุงุช ุงูุฃุฎูุฑุฉ ุชูุฑูุจูุง. </font><font style="vertical-align: inherit;">ุฏุนููุง ูุจูู ูููุฐุฌูุง ุจุณูุทูุง ููุฎุชุจุฑ ุฃุฏุงุฆู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> lightgbm <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LGBMClassifierโ clf = LGBMClassifier() clf.fit(train, train_labels)โ predictions = clf.predict_proba(test)[:, <span class="hljs-number"><span class="hljs-number">1</span></span>]โ <span class="hljs-comment"><span class="hljs-comment">#    submit = app_test[['SK_ID_CURR']] submit['TARGET'] = predictionsโ #   submit.to_csv('lightgbm_baseline.csv', index = False)</span></span></code> </pre> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูุฌุฉ LightGBM ูู 0.735 ุ ูุงูุชู ุชุชุฑู ูุฑุงุกูุง ุฌููุน ุงูููุฏููุงุช ุงูุฃุฎุฑู.</font></font></b> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชูุณูุฑ ุงููููุฐุฌ - ุฃูููุฉ ุงูุณูุงุช </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุณูู ุทุฑููุฉ ูุชูุณูุฑ ุงููููุฐุฌ ูู ุงููุธุฑ ุฅูู ุฃูููุฉ ุงูููุฒุงุช (ุงูุชู ูุง ูููู ูุฌููุน ุงูููุฏููุงุช ูุนููุง). </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ุงููุตูู ูุฏ ุนุงูุฌ ุงูุตููู ุ ูุณูู ูุณุชุบุฑู ุงูุฃูุฑ ุจุนุถ ุงูุนูู ูุฅุนุงุฏุฉ ุชุนููู ุฃุณูุงุก ุงูุฃุนูุฏุฉ ููููุง ูุฃุนูุฏุฉ ูุฐุง ุงูุตููู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      def show_feature_importances(model, features): plt.figure(figsize = (12, 8)) #          results = pd.DataFrame({'feature': features, 'importance': model.feature_importances_}) results = results.sort_values('importance', ascending = False) #  print(results.head(10)) print('\n     0.01 = ', np.sum(results['importance'] &gt; 0.01)) #  results.head(20).plot(x = 'feature', y = 'importance', kind = 'barh', color = 'red', edgecolor = 'k', title = 'Feature Importances'); return results #         feature_importances = show_feature_importances(clf, features)</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุง ูู ูุชููุนุ ูุงูุฃูุซุฑ ุฃูููุฉ ููููุฐุฌ ูู ููุณ 4 ููุฒุงุช. </font><font style="vertical-align: inherit;">ุฃูููุฉ ุงูุณูุงุช ููุณุช ุฃูุถู ุทุฑููุฉ ูุชูุณูุฑ ุงููููุฐุฌ ุ ูููููุง ุชุชูุญ ูู ููู ุงูุนูุงูู ุงูุฑุฆูุณูุฉ ุงูุชู ูุณุชุฎุฏููุง ุงููููุฐุฌ ููุชูุจุคุงุช</font></font><code>feature importance <br> 28 EXT_SOURCE_1 310 <br> 30 EXT_SOURCE_3 282 <br> 29 EXT_SOURCE_2 271 <br> 7 DAYS_BIRTH 192 <br> 3 AMT_CREDIT 161 <br> 4 AMT_ANNUITY 142 <br> 5 AMT_GOODS_PRICE 129 <br> 8 DAYS_EMPLOYED 127 <br> 10 DAYS_ID_PUBLISH 102 <br> 9 DAYS_REGISTRATION 69 <br> <br>     0.01 = 158</code> <br> <br><img src="https://habrastorage.org/webt/uc/pi/ox/ucpiox1dno_vps4lsuk0lmxk7si.png"><br><br><font style="vertical-align: inherit;"></font><br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุถุงูุฉ ุจูุงูุงุช ูู ุฌุฏุงูู ุฃุฎุฑู </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุณููุธุฑ ุจุนูุงูุฉ ูู ุงูุฌุฏุงูู ุงูุฅุถุงููุฉ ููุง ูููู ูุนูู ุจูุง. </font><font style="vertical-align: inherit;">ุงุจุฏุฃ ููุฑูุง ูู ุฅุนุฏุงุฏ ุงูุฌุฏุงูู ููุฒูุฏ ูู ุงูุชุฏุฑูุจ. </font><font style="vertical-align: inherit;">ูููู ุฃููุงู ุ ุงุญุฐู ุงูุฌุฏุงูู ุงูุถุฎูุฉ ุงูุณุงุจูุฉ ูู ุงูุฐุงูุฑุฉ ุ ูุงูุณุญ ุงูุฐุงูุฑุฉ ุจุงุณุชุฎุฏุงู ุฌุงูุน ุงูููุงูุฉ ุ ูุงุณุชูุฑุฏ ุงูููุชุจุงุช ุงููุงุฒูุฉ ููุฒูุฏ ูู ุงูุชุญููู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gcโ <span class="hljs-comment"><span class="hljs-comment">#del app_train, app_test, train_labels, application_train, application_test, poly_features, poly_features_testโ gc.collect() import pandas as pd import numpy as npโ from sklearn.preprocessing import MinMaxScaler, LabelEncoder from sklearn.model_selection import train_test_split, KFold from sklearn.metrics import accuracy_score, roc_auc_score, confusion_matrix from sklearn.feature_selection import VarianceThresholdโ from lightgbm import LGBMClassifier</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช ุ ูู ุจุฅุฒุงูุฉ ุงูุนููุฏ ุงููุฏู ุนูู ุงูููุฑ ูู ุนููุฏ ูููุตู </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">data = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'../input/application_train.csv'</span></span>) test = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'../input/application_test.csv'</span></span>) prev = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'../input/previous_application.csv'</span></span>) buro = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'../input/bureau.csv'</span></span>) buro_balance = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'../input/bureau_balance.csv'</span></span>) credit_card = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'../input/credit_card_balance.csv'</span></span>) POS_CASH = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'../input/POS_CASH_balance.csv'</span></span>) payments = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'../input/installments_payments.csv'</span></span>)โ <span class="hljs-comment"><span class="hljs-comment">#Separate target variable y = data['TARGET'] del data['TARGET']</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฑููุฒ ุงูููุฒุงุช ุงููุฆููุฉ ุนูู ุงูููุฑ. </font><font style="vertical-align: inherit;">ููุฏ ูููุง ุจุฐูู ุจุงููุนู ูู ูุจู ุ ููููุง ุจุชุดููุฑ ุนููุงุช ุงูุชุฏุฑูุจ ูุงูุงุฎุชุจุงุฑ ุจุดูู ูููุตู ุ ุซู ูููุง ุจูุญุงุฐุงุฉ ุงูุจูุงูุงุช. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุฌุฑุจ ููุฌูุง ูุฎุชูููุง ุจุนุถ ุงูุดูุก - ุณูุฌุฏ ูู ูุฐู ุงูุนูุงูุงุช ุงููุฆููุฉ ุ ูุฏูุฌ ุฅุทุงุฑุงุช ุงูุจูุงูุงุช ุ ูุงูุชุดููุฑ ูู ูุงุฆูุฉ ุชูู ุงูููุฌูุฏุฉ ุ ุซู ุชูุณูู ุงูุนููุงุช ูุฑุฉ ุฃุฎุฑู ุฅูู ุชุฏุฑูุจ ูุงุฎุชุจุงุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">categorical_features = [col <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data.columns <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> data[col].dtype == <span class="hljs-string"><span class="hljs-string">'object'</span></span>]โ one_hot_df = pd.concat([data,test]) one_hot_df = pd.get_dummies(one_hot_df, columns=categorical_features)โ data = one_hot_df.iloc[:data.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>],:] test = one_hot_df.iloc[data.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>]:,]โ <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">'  '</span></span>, data.shape) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">'  '</span></span>, test.shape)</code> </pre> <br> <code>   (307511, 245) <br>    (48744, 245)</code> <br> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจูุงูุงุช ููุชุจ ุงูุงุฆุชูุงู ุญูู ุฑุตูุฏ ุงููุฑุถ ุงูุดูุฑู. </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">buro_balance.head()</code> </pre> <br><img src="https://habrastorage.org/webt/pa/im/0s/paim0sea2cdjnvm7lok--vi8oke.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MONTHS_BALANCE - ุนุฏุฏ ุงูุฃุดูุฑ ูุจู ุชุงุฑูุฎ ุชูุฏูู ุทูุจ ุงูุญุตูู ุนูู ูุฑุถ. </font><font style="vertical-align: inherit;">ุฃูู ูุธุฑุฉ ุนู ูุซุจ ุนูู "ุงูุญุงูุงุช"</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">buro_balance.STATUS.value_counts()</code> </pre> <br> <code>C 13646993 <br> 0 7499507 <br> X 5810482 <br> 1 242347 <br> 5 62406 <br> 2 23419 <br> 3 8924 <br> 4 5847 <br> Name: STATUS, dtype: int64</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุญุงูุงุช ุชุนูู ูุง ููู: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ูุบูู ุ ุฃู ูุฑุถ ูุฏููุน. </font><font style="vertical-align: inherit;">X ุญุงูุฉ ุบูุฑ ูุนุฑููุฉ. </font><font style="vertical-align: inherit;">0 - ุงููุฑุถ ุงูุญุงูู ุจุฏูู ุงูุญุฑุงู. </font><font style="vertical-align: inherit;">1 - ุงูุชุฃุฎูุฑ ูู 1-30 ููููุง ุ 2 - ุงูุชุฃุฎูุฑ ูู 31-60 ููููุง ุ ูููุฐุง ุญุชู ุงููุถุน 5 - ูุจุงุน ุงููุฑุถ ูุทุฑู ุซุงูุซ ุฃู ูุชู ุดุทุจู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุชูููุฒ ุงูุนูุงูุงุช ุงูุชุงููุฉ: buro_grouped_size - ุนุฏุฏ ุงูุฅุฏุฎุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช buro_grouped_max - ุงูุญุฏ ุงูุฃูุตู ูุฑุตูุฏ ุงููุฑุถ buro_grouped_min - ุงูุญุฏ ุงูุฃุฏูู ูุฑุตูุฏ </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฑุถ ููููู ุชุดููุฑ ุฌููุน ุญุงูุงุช ุงููุฑุถ ูุฐู (ูุณุชุฎุฏู ุทุฑููุฉ unstack ุ ุซู ูุฑูู ุงูุจูุงูุงุช ุงููุณุชููุฉ ุจุฌุฏูู ุงูููุชุจ ุ ุญูุซ ุฅู SK_ID_BUREAU ูู ููุณู ููุง ูููุงู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">buro_grouped_size = buro_balance.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_BUREAU'</span></span>)[<span class="hljs-string"><span class="hljs-string">'MONTHS_BALANCE'</span></span>].size() buro_grouped_max = buro_balance.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_BUREAU'</span></span>)[<span class="hljs-string"><span class="hljs-string">'MONTHS_BALANCE'</span></span>].max() buro_grouped_min = buro_balance.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_BUREAU'</span></span>)[<span class="hljs-string"><span class="hljs-string">'MONTHS_BALANCE'</span></span>].min()โ buro_counts = buro_balance.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_BUREAU'</span></span>)[<span class="hljs-string"><span class="hljs-string">'STATUS'</span></span>].value_counts(normalize = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) buro_counts_unstacked = buro_counts.unstack(<span class="hljs-string"><span class="hljs-string">'STATUS'</span></span>) buro_counts_unstacked.columns = [<span class="hljs-string"><span class="hljs-string">'STATUS_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'STATUS_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'STATUS_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'STATUS_3'</span></span>,<span class="hljs-string"><span class="hljs-string">'STATUS_4'</span></span>,<span class="hljs-string"><span class="hljs-string">'STATUS_5'</span></span>,<span class="hljs-string"><span class="hljs-string">'STATUS_C'</span></span>,<span class="hljs-string"><span class="hljs-string">'STATUS_X'</span></span>,] buro_counts_unstacked[<span class="hljs-string"><span class="hljs-string">'MONTHS_COUNT'</span></span>] = buro_grouped_size buro_counts_unstacked[<span class="hljs-string"><span class="hljs-string">'MONTHS_MIN'</span></span>] = buro_grouped_min buro_counts_unstacked[<span class="hljs-string"><span class="hljs-string">'MONTHS_MAX'</span></span>] = buro_grouped_maxโ buro = buro.join(buro_counts_unstacked, how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_BUREAU'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> buro_balance gc.collect()</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุนูููุงุช ุนุงูุฉ ุนู ููุงุชุจ ุงูุงุฆุชูุงู </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">buro.head()</code> </pre> <br><img src="https://habrastorage.org/webt/00/7q/dz/007qdzakfbvd5qiizsxqwxvoari.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ูุชู ุนุฑุถ ุงูุฃุนูุฏุฉ ุงูุณุจุนุฉ ุงูุฃููู) ููุงู </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏุฑ ูุจูุฑ ูู ุงูุจูุงูุงุช ุ ุจุดูู ุนุงู ุ ููููู ูุญุงููุฉ ุงูุชุดููุฑ ุจุจุณุงุทุฉ ุจุงุณุชุฎุฏุงู One-Hot-Encoding ุ ูุชุฌููุนูุง ุญุณุจ SK_ID_CURR ุ ูู ุงููุชูุณุท โโุ ูุจููุณ ุงูุทุฑููุฉ ุ ุงูุงุณุชุนุฏุงุฏ ููุงูุถูุงู ูุน ุงูุฌุฏูู ุงูุฑุฆูุณู</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">buro_cat_features = [bcol <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bcol <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> buro.columns <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> buro[bcol].dtype == <span class="hljs-string"><span class="hljs-string">'object'</span></span>] buro = pd.get_dummies(buro, columns=buro_cat_features) avg_buro = buro.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).mean() avg_buro[<span class="hljs-string"><span class="hljs-string">'buro_count'</span></span>] = buro[[<span class="hljs-string"><span class="hljs-string">'SK_ID_BUREAU'</span></span>, <span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>]].groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).count()[<span class="hljs-string"><span class="hljs-string">'SK_ID_BUREAU'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> avg_buro[<span class="hljs-string"><span class="hljs-string">'SK_ID_BUREAU'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> buro gc.collect()</code> </pre> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจูุงูุงุช ุนู ุงูุชุทุจููุงุช ุงูุณุงุจูุฉ </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">prev.head()</code> </pre> <br><img src="https://habrastorage.org/webt/nx/sv/z-/nxsvz-simhdingy0zqgnwg9xxpi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุจุงููุซู ุ ูููู ุจุชุดููุฑ ุงูููุฒุงุช ุงููุฆููุฉ ูุงููุชูุณุท โโูุงูุฌูุน ุจูู ุงููุนุฑูู ุงูุญุงูู. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">prev_cat_features = [pcol <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> pcol <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> prev.columns <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> prev[pcol].dtype == <span class="hljs-string"><span class="hljs-string">'object'</span></span>] prev = pd.get_dummies(prev, columns=prev_cat_features) avg_prev = prev.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).mean() cnt_prev = prev[[<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>, <span class="hljs-string"><span class="hljs-string">'SK_ID_PREV'</span></span>]].groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).count() avg_prev[<span class="hljs-string"><span class="hljs-string">'nb_app'</span></span>] = cnt_prev[<span class="hljs-string"><span class="hljs-string">'SK_ID_PREV'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> avg_prev[<span class="hljs-string"><span class="hljs-string">'SK_ID_PREV'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> prev gc.collect()</code> </pre> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฑุตูุฏ ุจุทุงูุฉ ุงูุงุฆุชูุงู </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">POS_CASH.head()</code> </pre> <br><img src="https://habrastorage.org/webt/aq/25/er/aq25erq2wzuknck85ina4twk2g8.png"><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">POS_CASH.NAME_CONTRACT_STATUS.value_counts()</code> </pre> <br> <code>Active 9151119 <br> Completed 744883 <br> Signed 87260 <br> Demand 7065 <br> Returned to the store 5461 <br> Approved 4917 <br> Amortized debt 636 <br> Canceled 15 <br> XNA 2 <br> Name: NAME_CONTRACT_STATUS, dtype: int64</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููู ุจุชุดููุฑ ุงูููุฒุงุช ุงููุฆููุฉ ูุฅุนุฏุงุฏ ุฌุฏูู ููุฌูุน </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">le = LabelEncoder() POS_CASH[<span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>] = le.fit_transform(POS_CASH[<span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>].astype(str)) nunique_status = POS_CASH[[<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>, <span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>]].groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).nunique() nunique_status2 = POS_CASH[[<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>, <span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>]].groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).max() POS_CASH[<span class="hljs-string"><span class="hljs-string">'NUNIQUE_STATUS'</span></span>] = nunique_status[<span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>] POS_CASH[<span class="hljs-string"><span class="hljs-string">'NUNIQUE_STATUS2'</span></span>] = nunique_status2[<span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>] POS_CASH.drop([<span class="hljs-string"><span class="hljs-string">'SK_ID_PREV'</span></span>, <span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>], axis=<span class="hljs-number"><span class="hljs-number">1</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจูุงูุงุช ุงูุจุทุงูุฉ </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">credit_card.head()</code> </pre> <br><img src="https://habrastorage.org/webt/q5/wj/pj/q5wjpj8s-vak-svacdtlhqrwlus.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ุงูุฃุนูุฏุฉ ุงูุณุจุนุฉ ุงูุฃููู) </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ููุงุซู</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">credit_card[<span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>] = le.fit_transform(credit_card[<span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>].astype(str)) nunique_status = credit_card[[<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>, <span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>]].groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).nunique() nunique_status2 = credit_card[[<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>, <span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>]].groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).max() credit_card[<span class="hljs-string"><span class="hljs-string">'NUNIQUE_STATUS'</span></span>] = nunique_status[<span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>] credit_card[<span class="hljs-string"><span class="hljs-string">'NUNIQUE_STATUS2'</span></span>] = nunique_status2[<span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>] credit_card.drop([<span class="hljs-string"><span class="hljs-string">'SK_ID_PREV'</span></span>, <span class="hljs-string"><span class="hljs-string">'NAME_CONTRACT_STATUS'</span></span>], axis=<span class="hljs-number"><span class="hljs-number">1</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจูุงูุงุช ุงูุฏูุน </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">payments.head()</code> </pre> <br><img src="https://habrastorage.org/webt/ay/fy/3y/ayfy3yp5tzdxsffurkrgjd4udwu.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ุชุธูุฑ ุงูุฃุนูุฏุฉ ุงูุณุจุนุฉ ุงูุฃููู) </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุดุฆ ุซูุงุซุฉ ุฌุฏุงูู - ุจุงูููู ุงููุชูุณุทุฉ ูุงูุญุฏ ุงูุฃุฏูู ูุงูุญุฏ ุงูุฃูุตู ูู ูุฐุง ุงูุฌุฏูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">avg_payments = payments.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).mean() avg_payments2 = payments.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).max() avg_payments3 = payments.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).min() <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> avg_payments[<span class="hljs-string"><span class="hljs-string">'SK_ID_PREV'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> payments gc.collect()</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฑุจุท ุงูุฌุฏูู </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">data = data.merge(right=avg_prev.reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>) test = test.merge(right=avg_prev.reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>)โ data = data.merge(right=avg_buro.reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>) test = test.merge(right=avg_buro.reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>)โ data = data.merge(POS_CASH.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).mean().reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>) test = test.merge(POS_CASH.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).mean().reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>)โ data = data.merge(credit_card.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).mean().reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>) test = test.merge(credit_card.groupby(<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>).mean().reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>)โ data = data.merge(right=avg_payments.reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>) test = test.merge(right=avg_payments.reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>)โ data = data.merge(right=avg_payments2.reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>) test = test.merge(right=avg_payments2.reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>)โ data = data.merge(right=avg_payments3.reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>) test = test.merge(right=avg_payments3.reset_index(), how=<span class="hljs-string"><span class="hljs-string">'left'</span></span>, on=<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> avg_prev, avg_buro, POS_CASH, credit_card, avg_payments, avg_payments2, avg_payments3 gc.collect() <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">'  '</span></span>, data.shape) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">'  '</span></span>, test.shape) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">'  '</span></span>, y.shape)</code> </pre> <br> <code>   (307511, 504) <br>    (48744, 504) <br>    (307511,)</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููู ุงููุงูุน ุ ุณูุตู ุฅูู ูุฐุง ุงูุฌุฏูู ุงููุถุงุนู ูุน ุชุนุฒูุฒ ุงูุชุฏุฑุฌ! </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> lightgbm <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LGBMClassifierโ clf2 = LGBMClassifier() clf2.fit(data, y)โ predictions = clf2.predict_proba(test)[:, <span class="hljs-number"><span class="hljs-number">1</span></span>]โ <span class="hljs-comment"><span class="hljs-comment">#    submission = test[['SK_ID_CURR']] submission['TARGET'] = predictionsโ #   submission.to_csv('lightgbm_full.csv', index = False)</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชููู ุงููุชูุฌุฉ 0.770. </font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุณููุง ุ ุฃุฎูุฑูุง ุ ุฏุนูุง ูุฌุฑุจ ุชูููุฉ ุฃูุซุฑ ุชุนููุฏูุง ูุน ุงูุทู ูู ุงูุทูุงุช ูุงูุชุญูู ุงููุชูุงุทุน ูุงุฎุชูุงุฑ ุฃูุถู ุชูุฑุงุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">folds = KFold(n_splits=<span class="hljs-number"><span class="hljs-number">5</span></span>, shuffle=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">546789</span></span>) oof_preds = np.zeros(data.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>]) sub_preds = np.zeros(test.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>])โ feature_importance_df = pd.DataFrame()โ feats = [f <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> f <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data.columns <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> f <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [<span class="hljs-string"><span class="hljs-string">'SK_ID_CURR'</span></span>]]โ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n_fold, (trn_idx, val_idx) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(folds.split(data)): trn_x, trn_y = data[feats].iloc[trn_idx], y.iloc[trn_idx] val_x, val_y = data[feats].iloc[val_idx], y.iloc[val_idx] clf = LGBMClassifier( n_estimators=<span class="hljs-number"><span class="hljs-number">10000</span></span>, learning_rate=<span class="hljs-number"><span class="hljs-number">0.03</span></span>, num_leaves=<span class="hljs-number"><span class="hljs-number">34</span></span>, colsample_bytree=<span class="hljs-number"><span class="hljs-number">0.9</span></span>, subsample=<span class="hljs-number"><span class="hljs-number">0.8</span></span>, max_depth=<span class="hljs-number"><span class="hljs-number">8</span></span>, reg_alpha=<span class="hljs-number"><span class="hljs-number">.1</span></span>, reg_lambda=<span class="hljs-number"><span class="hljs-number">.1</span></span>, min_split_gain=<span class="hljs-number"><span class="hljs-number">.01</span></span>, min_child_weight=<span class="hljs-number"><span class="hljs-number">375</span></span>, silent=<span class="hljs-number"><span class="hljs-number">-1</span></span>, verbose=<span class="hljs-number"><span class="hljs-number">-1</span></span>, ) clf.fit(trn_x, trn_y, eval_set= [(trn_x, trn_y), (val_x, val_y)], eval_metric=<span class="hljs-string"><span class="hljs-string">'auc'</span></span>, verbose=<span class="hljs-number"><span class="hljs-number">100</span></span>, early_stopping_rounds=<span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-comment"><span class="hljs-comment">#30 ) oof_preds[val_idx] = clf.predict_proba(val_x, num_iteration=clf.best_iteration_)[:, 1] sub_preds += clf.predict_proba(test[feats], num_iteration=clf.best_iteration_)[:, 1] / folds.n_splits fold_importance_df = pd.DataFrame() fold_importance_df["feature"] = feats fold_importance_df["importance"] = clf.feature_importances_ fold_importance_df["fold"] = n_fold + 1 feature_importance_df = pd.concat([feature_importance_df, fold_importance_df], axis=0) print('Fold %2d AUC : %.6f' % (n_fold + 1, roc_auc_score(val_y, oof_preds[val_idx]))) del clf, trn_x, trn_y, val_x, val_y gc.collect()โ print('Full AUC score %.6f' % roc_auc_score(y, oof_preds))โ test['TARGET'] = sub_predsโ test[['SK_ID_CURR', 'TARGET']].to_csv('submission_cross.csv', index=False)</span></span></code> </pre> <br> <code>Full AUC score 0.785845</code> <br> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุชูุฌุฉ ุงูููุงุฆูุฉ ุนูู kaggle 0.783</font></font></b> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅูู ุฃูู ุฃุฐูุจ ุจุนุฏ ุฐูู </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุชุฃููุฏ ุชูุงุตู ุงูุนูู ูุน ุงูุนูุงูุงุช. ุงุณุชูุดู ุงูุจูุงูุงุช ุ ุญุฏุฏ ุจุนุถ ุงูุนูุงูุงุช ุ ูุฏูุฌูุง ุ ูุฅุฑูุงู ุฌุฏุงูู ุฅุถุงููุฉ ุจุทุฑููุฉ ูุฎุชููุฉ. ููููู ุชุฌุฑุจุฉ ูุนุงููุงุช hyperparameters Mogheli - ุงููุซูุฑ ูู ุงูุงุชุฌุงูุงุช. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุขูู ุฃู ุชููู ูุฐู ุงููุฌููุนุฉ ุงูุตุบูุฑุฉ ูุฏ ุฃุธูุฑุช ูู ุงูุฃุณุงููุจ ุงูุญุฏูุซุฉ ููุจุญุซ ุนู ุงูุจูุงูุงุช ูุฅุนุฏุงุฏ ุงูููุงุฐุฌ ุงูุชูุจุคูุฉ. ุชุนูู ููุงุนุฏ ุงูุจูุงูุงุช ุ ุดุงุฑู ูู ุงููุณุงุจูุงุช ุ ูู ูุงุฏุฆุง! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฑุฉ ุฃุฎุฑู ุฑูุงุจุท ููููุงุฉ ุงูุชู ุณุงุนุฏุชูู ูู ุฅุนุฏุงุฏ ูุฐุง ุงูููุงู. ุชู ูุดุฑ ุงูููุงูุฉ ุฃูุถูุง ูู ุดูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุจููุชุฑ ูุญููู ุนูู Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ููููู ุชูุฒููู ุ </font><font style="vertical-align: inherit;">ููุฌููุนุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุจูุงูุงุช</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุงูุชุดุบูู ูุงูุชุฌุฑุจุฉ. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ูููุฑุณู. ุงุจุฏุฃ ููุง: </font></font></a> <font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ุณุจุงู </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ููุฏูุฉ </font></a></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุทููุฉ. HomeCreditRisk: Extensive EDA + Baseline [0.772]</font></font></a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Gabriel Preda. Home Credit Default Risk Extensive EDA</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Pavan Raj. Loan repayers v/s Loan defaulters โ HOME CREDIT</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Lem Lordje Ko. 15 lines: Just EXT_SOURCE_x</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Shanth. HOME CREDIT โ BUREAU DATA โ FEATURE ENGINEERING</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Dmitriy Kisil. Good_fun_with_LigthGBM</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar414613/">https://habr.com/ru/post/ar414613/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar414595/index.html">ุญุฌุจ Roskomnadzor ูู ูุจู ูุดูุฏ ุงูุงุชุญุงุฏ ุงูุฑูุณู</a></li>
<li><a href="../ar414601/index.html">ุนูุฏูุง ูุงูุช ุงูุฌุจุงู ุทูููุฉ ููุงูุช ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ุงููุญูููุฉ ูุจูุฑุฉ: ุงููุฒูุฏ ูู ุชุงุฑูุฎ ุชูููููุฌูุง ุงููุนูููุงุช</a></li>
<li><a href="../ar414605/index.html">ุฅูุจุฑุงุทูุฑูุงุช ุตุบูุฑุฉ</a></li>
<li><a href="../ar414609/index.html">ูู ูููู ุฃู ุชููู 2018 PWA (ุชุทุจููุงุช ุงูููุจ ุงูุชูุฏููุฉ) ููุงูุณุฉ ุฌุฏูุฑุฉ ุจุงูุชุทุจููุงุช ุงูุฃุตููุฉุ</a></li>
<li><a href="../ar414611/index.html">ูุตุชู ุญูู ุฅูุดุงุก ุชุทุจูู ุชุญููุฒู (iOS ู Android) ูุงุจูุฉ ูุน ุงุจูุฉ ูู Unity ู C #</a></li>
<li><a href="../ar414615/index.html">ูุณูุงู ุงููุงุฆุญุฉ ุงูุนุงูุฉ ูุญูุงูุฉ ุงูุจูุงูุงุช: ูููู ูุฅุตูุงุญ ุญููู ุงููุดุฑ ูู ุงูุงุชุญุงุฏ ุงูุฃูุฑูุจู ุฃู ูุบูุฑ ุงูููุจ ุชูุงููุง</a></li>
<li><a href="../ar414619/index.html">ููุฌูุฑุชุณ ุงูุฃุญูุฑ. ุงูุณูุณูุฉ 8. ุงูุดุฑุงุน</a></li>
<li><a href="../ar414621/index.html">ูุณุฑุน ุงููุธุงู ุงูุฑูุจูุชู ุฃุฎุฐ ุนููุงุช ุงูุฏู ูุงูุงุฎุชุจุงุฑ</a></li>
<li><a href="../ar414627/index.html">ุงูุชูููุฉ ุงูุขููุฉ ูู PHDays 8: ูุชุงุฆุฌ ุงุฌุชูุงุน ูุฌุชูุน PDUG</a></li>
<li><a href="../ar414629/index.html">ุชุนุชุฑู ููุธูุฉ ุงูุตุญุฉ ุงูุนุงูููุฉ ุฑุณูููุง ุจูุฌูุฏ ุฅุฏูุงู ุงูููุงุฑ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>