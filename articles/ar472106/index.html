<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐จ๏ธ โ๏ธ ุงูุญุตูู ุนูู MacBook Pro 2018 T2 ููุนูู ูุน ArchLinux (ุซูุงุฆู ุงูุชุดุบูู) ๐ ๐ฉโ๐ฉโ๐งโ๐ง โท๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุงู ููุงู ุงููุซูุฑ ูู ุงูุถุฌูุฌ ุญูู ุญูููุฉ ุฃูู ุจุณุจุจ ุดุฑูุญุฉ T2 ุงูุฌุฏูุฏุฉ ุ ูู ุงููุณุชุญูู ุชุซุจูุช linux ุนูู ุฌูุงุฒ MacBook ุงูุฌุฏูุฏ 2018 ุจุงุณุชุฎุฏุงู ุดุฑูุท ุงูููุณ. ูุน ูุฑูุฑ ุงููู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุญุตูู ุนูู MacBook Pro 2018 T2 ููุนูู ูุน ArchLinux (ุซูุงุฆู ุงูุชุดุบูู)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/472106/" style=";text-align:right;direction:rtl"> ูุงู ููุงู ุงููุซูุฑ ูู ุงูุถุฌูุฌ ุญูู ุญูููุฉ ุฃูู ุจุณุจุจ ุดุฑูุญุฉ T2 ุงูุฌุฏูุฏุฉ ุ ูู ุงููุณุชุญูู ุชุซุจูุช linux ุนูู ุฌูุงุฒ MacBook ุงูุฌุฏูุฏ 2018 ุจุงุณุชุฎุฏุงู ุดุฑูุท ุงูููุณ.  ูุน ูุฑูุฑ ุงูููุช ุ ูุจููุงูุฉ ุนุงู 2019 ุ ูุงู ูุทูุฑู ุงูุทุฑู ุงูุซุงูุซ ุจุชูููุฐ ุนุฏุฏ ูู ุจุฑุงูุฌ ุงูุชุดุบูู ูุชุตุญูุญุงุช kernel ููุชูุงุนู ูุน ุดุฑูุญุฉ T2.  ูููู ุจุฑูุงูุฌ ุงูุชุดุบูู ุงูุฑุฆูุณู ูุทุฑุฒ MacBook 2018 ูุฃุญุฏุซ ุจุชูููุฐ VHCI (ุชุดุบูู ุงูููุณ / ููุญุฉ ุงูููุงุชูุญ / ููุง ุฅูู ุฐูู) ุ ููุฐูู ุฃุฏุงุก ุงูุตูุช. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุณู</a> ูุดุฑูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">mbp2018-bridge-drv</a> ุฅูู 3 ููููุงุช ุฑุฆูุณูุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  BCE (ูุญุฑู ุงููุณุฎ ุงูุงุญุชูุงุทู) - ูุคุณุณ ููุงุฉ ุงูุงุชุตุงู ุงูุฑุฆูุณูุฉ ูุน T2.  VHCI ูุงูุตูุช ุชุชุทูุจ ูุฐุง ุงููููู. </li><li style=";text-align:right;direction:rtl">  VHCI ูู ูุญุฏุฉ ุชุญูู ูุถูู ุธุงูุฑู USB ุ  ูุชู ุชูููุฑ ููุญุฉ ุงูููุงุชูุญ ูุงููุงูุณ ูููููุงุช ุงููุธุงู ุงูุฃุฎุฑู ุจูุงุณุทุฉ ูุฐุง ุงููููู (ุชุณุชุฎุฏู ุจุฑุงูุฌ ุงูุชุดุบูู ุงูุฃุฎุฑู ูุญุฏุฉ ุชุญูู ุงููุถูู ูุฐู ูุชูููุฑ ุงููุฒูุฏ ูู ุงููุธุงุฆู. </li><li style=";text-align:right;direction:rtl">  ุงูุตูุช - ุจุฑูุงูุฌ ุชุดุบูู ููุงุฌูุฉ ุงูุตูุช T2 ุ ุญุงูููุง ูุชู ุฏุนู ุฅุฎุฑุงุฌ ุงูุตูุช ููุท ูู ุฎูุงู ููุจุฑุงุช ุงูุตูุช ุงููุฏูุฌุฉ ูู MacBook </li></ul><a name="habracut"></a><br>  ููุทูู ุนูู ุงููุดุฑูุน ุงูุซุงูู ุงุณู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">macbook12-spi-driver</a> ุ ููููุฐ ุฅููุงููุฉ ุชุดุบูู ุจุฑูุงูุฌ ุชุดุบูู ููุญุฉ ุงูููุงุชูุญ ูููุญุฉ ุงูุชุชุจุน SPI ูุดุฑูุท ุงูููุณ ูู MacBook Pro ุฃูุงุฎุฑ ุนุงู 2016 ูุงูุฅุตุฏุงุฑุงุช ุงูุฃุญุฏุซ.  ูุชู ุงูุขู ุชุถููู ุจุนุถ ุจุฑุงูุฌ ุชุดุบูู ููุญุฉ ุงูููุงุชูุญ / ููุญุฉ ุงูุชุชุจุน ูู ุงูููุงุฉ ุ ุจุฏุกูุง ูู ุงูุฅุตุฏุงุฑ 5.3. <br><br>  ุชู ุชูููุฐ ุงูุฏุนู ุฃูุถูุง ูุฃุฌูุฒุฉ ูุซู wi-fi ุ ู touchpad ุ ุฅูุฎ ุ ุจุงุณุชุฎุฏุงู ุชุตุญูุญุงุช kernel.  ุญุงูููุง ุฅุตุฏุงุฑ kernel ูู <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">5.3.5-1</a></b> <br><br><h4 style=";text-align:right;direction:rtl">  ูุง ูุนูู ูู ุงูููุช ุงูุฑุงูู </h4><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  NVMe </li><li style=";text-align:right;direction:rtl">  ููุญุฉ ุงูููุงุชูุญ </li><li style=";text-align:right;direction:rtl">  USB-C (ูู ูุชู ุงุฎุชุจุงุฑ Thunderbolt ุ ุนูุฏูุง ูุชู ุชุญููู ุงููุญุฏุฉ ุชููุงุฆููุง ุ ูุชู ุชุนููู ุงููุธุงู ุจุฅุญูุงู) </li><li style=";text-align:right;direction:rtl">  ุดุฑูุท ุงูููุณ (ูุน ุงููุฏุฑุฉ ุนูู ุชุดุบูู ููุงุชูุญ Fn ูุงูุฅุถุงุกุฉ ุงูุฎูููุฉ ู ESC ููุง ุฅูู ุฐูู) </li><li style=";text-align:right;direction:rtl">  ุตูุช (ููุจุฑุงุช ุตูุช ูุฏูุฌุฉ ููุท) </li><li style=";text-align:right;direction:rtl">  ูุญุฏุฉ Wi-Fi (ุนุจุฑ brcmfmac ูููุท ูู ุฎูุงู iw) </li><li style=";text-align:right;direction:rtl">  ุฏูุณุจูุงูุจูุฑุช ุนุจุฑ USB-C </li><li style=";text-align:right;direction:rtl">  ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ </li><li style=";text-align:right;direction:rtl">  ุชุนููู / ุงุณุชุฆูุงู (ุฌุฒุฆูุง) </li><li style=";text-align:right;direction:rtl">  ุงูุฎ </li></ol><br>  ููุทุจู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุนูู macbookpro15.1 ู macbookpro15.2.  ุชู ุฃุฎุฐ ุงูููุงู ูู ุฌูุซุจ ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ููุง</a> .  ูู ุชูุฌุญ ูู ูุฐู ุงูููุงูุฉ ุ ูุฐูู ูุงู ุนูู ุงูุจุญุซ ุนู ุญู ุจููุฑุฏู. <br><br><h4 style=";text-align:right;direction:rtl">  ูุง ุชุญุชุงุฌ ุฅูู ุชุซุจูุช </h4><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุงูุฆ USB-C USB (ุนูู ุงูุฃูู ุซูุงุซุฉ ูุฏุฎูุงุช USB ูุชูุตูู ุงููุงูุณ ุฃู ููุญุฉ ุงูููุงุชูุญ ุฃู ููุฏู USB ุฃู ุงููุงุชู ูู ูุถุน ุงูุฑุจุท).  ูุฐุง ุถุฑูุฑู ููุท ูู ุงููุฑุงุญู ุงููุจูุฑุฉ ูู ุงูุชุซุจูุช. </li><li style=";text-align:right;direction:rtl">  ููุญุฉ ููุงุชูุญ USB </li><li style=";text-align:right;direction:rtl">  ูุญุฑู ุฃูุฑุงุต ููุงุด USB / USB-C ุณุนุฉ 4 ุฌูุฌุงุจุงูุช ุนูู ุงูุฃูู </li></ul><br><h2 style=";text-align:right;direction:rtl">  1. ุชุนุทูู ุญุธุฑ ุงูุชูุฒูู ูู ุงููุณุงุฆุท ุงูุฎุงุฑุฌูุฉ </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://support.apple.com/en-us/HT208330</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://www.ninjastik.com/support/2018-macbook-pro-boot-from-usb/</a> <br><br><h2 style=";text-align:right;direction:rtl">  2. ุชุฎุตูุต ูุณุงุญุฉ ุญุฑุฉ ุจุงุณุชุฎุฏุงู ุงููุฑุต ุงููุฑุงูู </h2><br>  ููุฑุงุญุฉ ุ ููุช ุนูู ุงูููุฑ ุจุชุฎุตูุต 30 ุบูุบุงุจุงูุช ูููุฑุต ุ ุญูุซ ููุช ุจุชููุฆุชู ูุชูุจูุฑู ูู Disk Utility ููุณูุง.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุณูู ุงููุฑุต ุงููุนูู ุฅูู ุฃูุณุงู ุงููุฑุต ุงููุณุงุนุฏุฉ</a> . <br><br><h2 style=";text-align:right;direction:rtl">  3. ุชุดููู ุตูุฑุฉ ISO </h2><br>  <b>ุฎูุงุฑุงุช:</b> <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููููู ุงุชุจุงุน ุงูุทุฑููุฉ ุงูุจุณูุทุฉ ูุชูุฒูู ุงูุตูุฑุฉ ุงูููุงุฆูุฉ ุจุงุณุชุฎุฏุงู kernel 5.3.5-1 ูุงูุจูุน ูู <a href="">ุฑุงุจุท</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">aunali1</a> <a href="">ุฅูู ุงูุตูุฑุฉ ุงูููุงุฆูุฉ</a> </li><li style=";text-align:right;direction:rtl">  ูู ุจุฅูุดุงุก ุตูุฑุฉ ูููุณู ูู ุฎูุงู archlive (ุชุญุชุงุฌ ุฅูู ูุธุงู ูุน ุชูุฒูุน archa) <br><br>  ุชุซุจูุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">archiso</a> <br><br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">pacman -S archiso</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cp -r /usr/share/archiso/configs/releng/ archlive <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> archlive</code> </pre><br>  ุฃุถู ุงููุณุชูุฏุน ุฅูู pacman.conf: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">[mbp] Server = https://packages.aunali1.com/archlinux/<span class="hljs-variable"><span class="hljs-variable">$repo</span></span>/<span class="hljs-variable"><span class="hljs-variable">$arch</span></span></code> </pre><br>  ุชุฌุงูู ุงูููุงุฉ ุงูุฃุตููุฉ ูู pacman.conf: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">IgnorePkg = linux linux-headers</code> </pre><br>  ุฃุถู ุงูุญุฒู ุงููุงุฒูุฉ ุ ูู ุงูููุงูุฉ ูุถูู ููุงุฉ linux-mbp ู linux-mbp-headers <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">... wvdial xl2tpd linux-mbp linux-mbp-headers</code> </pre><br>  ุชุบููุฑ ุงูุจุฑูุงูุฌ ุงููุตู ููุนูู ูู ุงููุถุน ุงูุชูุงุนูู (ุงุณุชุจุฏุงู pacstrap -C ูุน pacstrap -i -C): <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo nano /usr/bin/mkarchiso</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># Install desired packages to airootfs _pacman () { _msg_info "Installing packages to '${work_dir}/airootfs/'..." if [[ "${quiet}" = "y" ]]; then pacstrap -i -C "${pacman_conf}" -c -G -M "${work_dir}/airootfs" $* &amp;&gt; /dev/null else pacstrap -i -C "${pacman_conf}" -c -G -M "${work_dir}/airootfs" $* fi _msg_info "Packages installed successfully!" }</code> </pre> <br>  ูุญู ุชุดููู ุตูุฑุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo ./build.sh -v</code> </pre> <br>  ุงุถุบุท Y ูุชุฎุทู ุงูุญุฒู ุงูุชู ุชู ุชุฌุงูููุง ุ ุซู ุงูุชุจ ุตูุฑุฉ ISO ุฅูู ูุญุฑู ุฃูุฑุงุต ููุงุด USB: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=out/archlinux*.iso of=/dev/sdb bs=1M</code> </pre> <br></li></ol><br><h2 style=";text-align:right;direction:rtl">  4. ุงูุชูููุฏ ุงูุฃูู </h2><br>  ุฃุนุฏ ุงูุชุดุบูู ุจุงุณุชุฎุฏุงู ูุญุฑู ุงูุฃูุฑุงุต ุงููุญููู ูููุญุฉ ุงูููุงุชูุญ ุงููุฏุฑุฌูู.  ุงุถุบุท ุนูู ุงูุฎูุงุฑุงุช ุนูุฏ ุธููุฑ ุงูุชูุงุญุฉ ุ ุญุฏุฏ EFI BOOT. <br><br>  ุจุนุฏ ุฐูู ุ ุชุญุชุงุฌ ุฅูู ุงูุถุบุท ุนูู ุงูููุชุงุญ "e" ููุชุงุจุฉ <b>module_blacklist = ุงูุตุงุนูุฉ</b> ูู ููุงูุฉ ุณุทุฑ ุงูุฃูุงูุฑ.  ุฅุฐุง ูู ูุชู ุฐูู ุ ููุฏ ูุง ูููู ุงููุธุงู ุจุงูุชูููุฏ ุ ูุณูู ูุชุนุทู ุฎุทุฃ Thunderbolt ICM. <br><br>  ุจุงุณุชุฎุฏุงู fdisk / cfdisk ุ ูุฌุฏ ูุณููุง (ูุฏู nvme0n1p4) ุ ููู ุจุชูุณูู ุงูููุณ ูุชุซุจูุชู.  ููููู ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุนูููุงุช ุงูุฑุณููุฉ</a> ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุทุฑู ุซุงูุซ</a> . <br><br>  ูุญู ูุง ููุดุฆ ูุณู ุงูุชูููุฏ ุ ูุณูู ููุชุจ ุฃุฏุงุฉ ุชุญููู ุงูุฅููุงุน ูู <b>/ dev / nvme0n1p1</b> <br>  ุจุนุฏ ุชูููู ุงูุจูุฆุฉ ูู / mnt ุจุดูู ูุงูู ููุจู ุงูุชุจุฏูู ุฅูู ุงูููุณ ุงููููุณ ุ ููุชุจ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mount /dev/nvme0n1p1 /mnt/boot arch-chroot /mnt /bin/bash</code> </pre><br>  ุฅุถุงูุฉ ุฅูู /etc/pacman.conf: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">[mbp] Server = https://packages.aunali1.com/archlinux/<span class="hljs-variable"><span class="hljs-variable">$repo</span></span>/<span class="hljs-variable"><span class="hljs-variable">$arch</span></span></code> </pre><br>  ุชุซุจูุช ุงูููุงุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo pacman -S linux-mbp linux-mbp-headers sudo mkinitcpio -p linux-mbp</code> </pre><br>  ุถุน ุงูุตุงุนูุฉ ู applesmc ูู /etc/modprobe.d/blacklist.conf <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">blacklist thunderbolt blacklist applesmc</code> </pre><br><h3 style=";text-align:right;direction:rtl">  ููุญุฉ ุงูููุงุชูุญ ุ touchbar ุ ุงูุฎ </h3><br>  ุชุซุจูุช yay: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo pacman -S git gcc make fakeroot binutils git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://aur.archlinux.org/yay.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> yay makepkg -si</code> </pre><br>  ุชุซุจูุช ุงููุญุฏุงุช ุงูููุทูุฉ ูุดุฑูุท ุงูููุณ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> --branch mbp15 https://github.com/roadrunner2/macbook12-spi-driver.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> macbook12-spi-driver make install</code> </pre><br>  ุฅุถุงูุฉ ูุญุฏุงุช ุฅูู ุงูุชุญููู ุงูุชููุงุฆู: /etc/modules-load.d/apple.conf <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">industrialio_triggered_buffer apple-ibridge apple-ib-tb apple-ib-als</code> </pre><br>  ุชุซุจูุช ูุญุฏุงุช kernel ูููุญุฉ ุงูููุงุชูุญ.  ูุญุชูู ูุณุชูุฏุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">anuali1</a> ุนูู ุญุฒูุฉ ุฌุงูุฒุฉ ุ ูุทูู ุนูููุง <b>apple-bce-dkms-git</b> .  ูุชุซุจูุชู ุ ุงูุชุจ ูู ูุญุฏุฉ ุงูุชุญูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">pacman -S apple-bce-dkms-git</code> </pre> <br>  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุชู ุงุณุชุฏุนุงุก ุงููุญุฏุฉ ุงูููุทูุฉ kernel <b>apple-bce</b> .  ูู ุญุงูุฉ ุงูุชุฌููุน ุงูุฐุงุชู ุ ูุทูู ุนููู <b>bce</b> .  ููููุง ูุฐูู ุ ุฅุฐุง ููุช ุชุฑุบุจ ูู ุชุณุฌูู ูุญุฏุฉ ููุทูุฉ ูู ูุณู MODULES ูู ููู mkinicpio.conf ุ ููุง ุชูุณ ุงููุญุฏุฉ ุงูุชู ููุช ุจุชุซุจูุชูุง. <br><br>  ุงูุชุฌูุน ุงููุฏูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/MCMrARM/mbp2018-bridge-drv.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> mbp2018-bridge-drv make cp bce.ko /usr/lib/modules/extramodules-mbp/bce.ko</code> </pre><br>  ุฃุถู ูุญุฏุฉ bce ุฃู apple-bce ุฅูู ุงูุชุญููู ุงูุชููุงุฆู: /etc/modules-load.d/bce.conf <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">bce</code> </pre> <br>  ุฅุฐุง ููุช ุชุฑุบุจ ูู ุงุณุชุฎุฏุงู ุฃุฒุฑุงุฑ Fn ุจุดูู ุงูุชุฑุงุถู ุ ูู ุงูููู /etc/modprobe.d/apple-tb.conf ููุชุจ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">options apple-ib-tb fnmode=2</code> </pre> <br>  ุชุญุฏูุซ ุงูููุงุฉ ู initramfs. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mkinitcpio -p linux-mbp</code> </pre><br>  ุชุซุจูุช iwd: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo pacman -S networkmanager iwd</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  5. ุจููุชููุฃุฏุฑ </h2><br>  ุจูุฌุฑุฏ ุชุซุจูุช ุฌููุน ุงูุญุฒู ุงูุฑุฆูุณูุฉ ุฏุงุฎู ุงูุฌุฐุฑ ุ ููููู ุงููุชุงุจุนุฉ ูุชุซุจูุช ุฃุฏุงุฉ ุชุญููู ุงูุชุดุบูู. <br><br>  ูู ุฃุชููู ุฃุจุฏุงู ูู ุงูุญุตูู ุนูู ุงููุฑูุฉ ูู ุงูุนูู.  ูู ูุญุฑู ุฃูุฑุงุต USB ุฎุงุฑุฌู ุ ูู ุจูู ุงูุฃุญุฐูุฉ ุ ูููู ุนูุฏ ูุญุงููุฉ ุชุณุฌูููุง ูู nvme ุนุจุฑ <blockquote style=";text-align:right;direction:rtl">  grub-install --target = x86_64-efi - ุฏููู - = = boot - bootloader-id = grub </blockquote>  ุชุญุทูุช ุงููุธุงู ูู ููุงุฉ ุงููุฒุน ุ ูุจุนุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุนูุตุฑ ุฌุฏูุฏ ูู ุฎูุงู ุฎูุงุฑุงุช ูู ุชุธูุฑ.  ูู ุฃุฌุฏ ุฃู ุญู ูุงุถุญ ููุฐู ุงููุดููุฉ ุ ูุจุงูุชุงูู ูุฑุฑุช ูุญุงููุฉ ุชูููุฐ ุงูุชูููุฏ ุจุงุณุชุฎุฏุงู systemd-boot. <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุทูู <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">bootctl --path=/boot install</code> </pre> <br>  ูุชุทูุฑ ุฅูู ููุงุฉ ุงูุฐุนุฑ.  ูู ุจุฅููุงู ุชุดุบูู MacBook ุ ููู ุจุชุดุบููู ูุฑุฉ ุฃุฎุฑู ุ ูุงููุฑ ููู ุฎูุงุฑุงุช (ูุง ุชูู ุจุชุนุทูู ููุญุฉ ูุตู USB-c ุจููุญุฉ ุงูููุงุชูุญ) </li><li style=";text-align:right;direction:rtl">  ุชุญูู ูู ุธููุฑ ุณุฌู EFI BOOT ุฌุฏูุฏ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุฌูุงุฒ ุงูุฎุงุฑุฌู </li><li style=";text-align:right;direction:rtl">  ูุฎุชุงุฑ ุงูุชูููุฏ ูู ูุญุฑู ุฃูุฑุงุต USB ุฎุงุฑุฌู ุ ููุง ูู ุงูุญุงู ุฃุซูุงุก ุงูุชุซุจูุช ุงูุฃูู (ูุง ุชูุณ ุฃู ุชูุชุจ module_blacklist = ุงูุตุงุนูุฉ) </li><li style=";text-align:right;direction:rtl">  ูููู ุจุชุฑููุจ ุงููุฑุต ูุฏููุง ูุงูุฏุฎูู ูู ุงูุจูุฆุฉ ูู ุฎูุงู chroot ุงููุฏูุฏ </li></ol><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mount /dev/nvme0n1p4 /mnt mount /dev/nvme0n1p1 /mnt/boot arch-chroot /mnt</code> </pre><br>  ุฅุฐุง ูุงู ูู ุงูุถุฑูุฑู ุฃู ุชุนูู ููุญุฉ ุงูููุงุชูุญ ุญุชู ูุชู ุชุญููู ุงููุธุงู ุจุงููุงูู (ูุนุฏ ูุฐุง ุถุฑูุฑููุง ุฅุฐุง ุชู ุงุณุชุฎุฏุงู ุชุดููุฑ luks / dm-crypt) ุ ูุณููุชุจู ูู ููู /etc/mkinicpio.conf ูู ูุณู MODULES: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">MODULES=(ext4 applespi intel_lpss_pci spi_pxa2xx_platform bce)</code> </pre><br>  ุชุญุฏูุซ ุงูููุงุฉ ู initramfs. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mkinicpio -p linux-mbp</code> </pre><br><h4 style=";text-align:right;direction:rtl">  ุชูููู systemd ุงูุชูููุฏ </h4><br>  ูููู ุจุชุญุฑูุฑ ุงูููู /boot/loader/loader.conf ุ ููุญุฐู ูู ุดูุก ุจุฏุงุฎูู ุ ููุถูู ูุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">default arch timeout 5 editor 1</code> </pre><br>  ุงูุชูู ุฅูู ูุฌูุฏ / boot / loader / Entries ุ ุฃูุดุฆ ููู arch.conf ูุงูุชุจ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">title arch linux /vmlinuz-linux-mbp initrd /initramfs-linux-mbp.img options root=/dev/&lt;b&gt;nvme0n1p4&lt;/b&gt; rw pcie_ports=compat</code> </pre><br>  ุฅุฐุง ููุช ุชุณุชุฎุฏู luks ู LVM ุ ุซู <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">options cryptdevice=/dev/&lt;b&gt;nvme0n1p4&lt;/b&gt;:luks root=/dev/mapper/vz0-root rw pcie_ports=compat</code> </pre><br>  ุฅุนุงุฏุฉ ุงูุชุดุบูู ุนูู MacOS. <br><br><h2 style=";text-align:right;direction:rtl">  6. ุงูุฅุนุฏุงุฏ ูุงู ูุงู </h2><br>  ููุง ุงุชุถุญ ูููุง ุจุนุฏ ุ ูุฎุฒู MacOS ูููุงุช ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ ููุญูู wi-fi ูู ุงููุฌูุฏ <b>/ usr / share / firmware / wifi</b> ุ ูููููู ุฃุฎุฐูุง ูู ููุงู ูู ุดูู ููุงุท ุงูููุท ูุฅุฏุฎุงููุง ูู ูุญุฏุฉ brcmfmac kernel.  ููุนุฑูุฉ ุจุงูุถุจุท ุงููููุงุช ุงูุชู ูุณุชุฎุฏููุง ุงูููุงูุฆ ุ ุงูุชุญ ุงูุฌูุงุฒ ูู ูุธุงู ุงูุชุดุบูู MacOS ูุงูุชุจ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">ioreg -l | grep C-4364</code> </pre> <br>  ูุฏููุง ูุงุฆูุฉ ุทูููุฉ.  ูุญู ุจุญุงุฌุฉ ููุท ุฅูู ูููุงุช ูู ูุณู <b>RequestedFiles</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">"RequestedFiles" = ({"Firmware"="&lt;b&gt;C-4364__s-B2/maui.trx&lt;/b&gt;","TxCap"="C-4364__s-B2/maui-X3.txcb","Regulatory"="C-4364__s-B2/&lt;b&gt;maui-X3.clmb&lt;/b&gt;","NVRAM"="C-4364__s-B2/&lt;b&gt;P-maui-X3_M-HRPN_V-m__m-7.7.txt&lt;/b&gt;"})</code> </pre><br>  ูู ุญุงูุชู ุ ูุฏ ุชุฎุชูู ุฃุณูุงุก ุงููููุงุช.  ุงูุณุฎูุง ูู ุงููุฌูุฏ / usr / share / firmware / wifi ุฅูู ูุญุฑู ุฃูุฑุงุต ููุงุด USB ูุฃุนุฏ ุชุณููุชูุง ูู ุงูุนุฑุถ ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> maui.trx -&gt; brcmfmac4364-pcie.bin maui-X3.clmb -&gt; brcmfmac4364-pcie.clm_blob P-maui-X3_M-HRPN_V-m__m-7.7.txt -&gt; brcmfmac4364-pcie.Apple Inc.-&lt;b&gt;MacBookPro15,2.txt&lt;/b&gt;</code> </pre><br>  ูู ูุฐู ุงูุญุงูุฉ ุ ูุญุชูู ุงูููู ุงููุตู ุงูุฃุฎูุฑ ุนูู ุงุณู ุงูุทุฑุงุฒ ุ ุฅุฐุง ูู ููู ุทุฑุงุฒ macbookpro15ุ2 ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุฅุนุงุฏุฉ ุชุณููุฉ ูุฐุง ุงูููู ููููุง ูุทุฑุงุฒ macbook ุงูุฎุงุต ุจู. <br><br>  ุฅุนุงุฏุฉ ุชุดุบูู ูู ุงูููุณ. <br><br>  ุงูุณุฎ ุงููููุงุช ูู ูุญุฑู ุฃูุฑุงุต ููุงุด USB ุฅูู ุงููุฌูุฏ / lib / firmware / brcm / <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo cp brcmfmac4364-pcie.bin /lib/firmware/brcm/ sudo cp brcmfmac4364-pcie.clm_blob /lib/firmware/brcm/ sudo cp <span class="hljs-string"><span class="hljs-string">'brcmfmac4364-pcie.Apple Inc.-&lt;b&gt;MacBookPro15,2.txt'</span></span> /lib/firmware/brcm/</code> </pre><br>  ุชุญูู ูู ุตุญุฉ ุงููุญุฏุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">rmmod brcmfmac modprobe brcmfmac</code> </pre><br>  ูุชุฃูุฏ ูู ุฃู ูุงุฌูุฉ ุงูุดุจูุฉ ุธูุฑุช ูู ุฎูุงู ifconfig / ip. <br>  ุชูููู ูุงู ูุงู ุนุจุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">iwctl</a> <br><br>  <b>ุชุญุฐูุฑ.</b>  <b>ุนุจุฑ netctl ุ nmcli ุ ุฅูุฎ.</b>  <b>ูุง ุชุนูู ุงููุงุฌูุฉ ุ ุฅูุง ูู ุฎูุงู iwd.</b> <br><br>  ุฌุนู NetworkManager ุงุณุชุฎุฏุงู iwd.  ููููุงู ุจุฐูู ุ ูู ุจุฅูุดุงุก ุงูููู /etc/NetworkManager/NetworkManager.conf ูุงูุชุจ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">[device] wifi.backend=iwd</code> </pre><br>  ุจุฏุก ุชุดุบูู ุฎุฏูุฉ NetworkManager <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo systemctl start NetworkManager.service sudo systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> NetworkManager.service</code> </pre><br><h2 style=";text-align:right;direction:rtl">  7. ุงูุตูุช </h2><br>  ูู ุฃุฌู ุฌุนู ุงูุตูุช ุ ูุฌุจ ุนููู ุชุซุจูุช pulseaudio: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo pacman -S pulseaudio</code> </pre><br>  ูู ุจุชูุฒูู ุซูุงุซุฉ ูููุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">91-pulseaudio-custom.rules</a> </li><li style=";text-align:right;direction:rtl">  <a href="">ุงูุชูุงุญ t2.conf</a> </li><li style=";text-align:right;direction:rtl">  <a href="">AppleT2.conf</a> </li></ul><br>  ุญุฑููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> /usr/share/alsa/cards/AppleT2.conf /usr/share/pulseaudio/alsa-mixer/profile-sets/apple-t2.conf /usr/lib/udev/rules.d/91-pulseaudio-custom.rules</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  8. ุชุนููู / ุงุณุชุฆูุงู </h2><br>  ูู ุงูููุช ุงูุญุงูู ุ <b>10/16/2019</b> ุนููู ุงุฎุชูุงุฑ ุฅูุง ุงูุตูุช ุฃู ุชุนููู / ุงุณุชุฆูุงู.  ูุญู ูู ุงูุชุธุงุฑ ูุคูู ูุญุฏุฉ bce ูุฅููุงุก ุงููุธููุฉ. <br><br>  ูุฅูุดุงุก ูุญุฏุฉ ููุทูุฉ ูุน ุฏุนู ููุชุนููู / ุงูุงุณุชุฆูุงู ุ ูุฌุจ ุนููู ุงูููุงู ุจูุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/MCMrARM/mbp2018-bridge-drv.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> mbp2018-bridge-drv git checkout <span class="hljs-built_in"><span class="hljs-built_in">suspend</span></span> make cp bce.ko /usr/lib/modules/extramodules-mbp/bce.ko modprobe bce</code> </pre><br>  ุฅุฐุง ููุช ุจุชุซุจูุช ูุญุฏุฉ apple-bce ุงูุฌุงูุฒุฉ ูู ูุณุชูุฏุน anuali1 ุ ููุฌุจ ุนููู ุฃููุงู ุฅุฒุงูุชูุง ุซู ููุท ุชุฌููุน ูุชุซุจูุช ูุญุฏุฉ bce ูุน ุฏุนู ููุถุน ุงูุฅููุงู ุงููุฑุญูู. <br><br>  ุชุญุชุงุฌ ุฃูุถูุง ุฅูู ุฅุถุงูุฉ ูุญุฏุฉ applesmc ุฅูู ุงููุงุฆูุฉ ุงูุณูุฏุงุก (ุฅุฐุง ูู ุชูู ูุฏ ููุช ุจุฐูู ูู ูุจู) ูุชุฃูุฏ ูู ุฅุถุงูุฉ <b>pcie_ports =</b> compat ุฅูู /boot/loader/entries/arch.conf ูู ุณุทุฑ ุงูุฎูุงุฑุงุช ูู ุงูููุงูุฉ. <br><br>  ูู ุงูููุช ุงูุญุงูู ุ ูุชุนุทู ุจุฑูุงูุฌ ุชุดุบูู touchbar ุนูุฏ ุฅุฏุฎุงู ูุถุน ุงูุชููู ุงููุฑุญูู ุ ููููู ุจุฑูุงูุฌ ุงูุตุงุนูุฉ ุฃุญูุงููุง ุจุชุนููู ุงููุธุงู ูุฃูุซุฑ ูู 30 ุซุงููุฉ ุ ูุนูุฏ ุงูุงุณุชุฆูุงู ุ ูุนุฏุฉ ุฏูุงุฆู.  ูููู ุฅุตูุงุญ ุฐูู ุนู ุทุฑูู ุชูุฒูู ุงููุญุฏุงุช ุงูููุทูุฉ ูููุดููุงุช ุชููุงุฆููุง. <br><br>  ูู <b>ุจุฅูุดุงุก</b> ุงูุจุฑูุงูุฌ ุงููุตู <b>/lib/systemd/system-sleep/rmmod.sh</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#!/bin/sh if [ "${1}" == "pre" ]; then rmmod thunderbolt rmmod apple_ib_tb elif [ "${1}" == "post" ]; then modprobe apple_ib_tb modprobe thunderbolt fi</code> </pre><br>  ุงุฌุนููุง ูุงุจูุฉ ููุชูููุฐ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo chmod +x /lib/systemd/system-sleep/rmmod.sh</code> </pre> <br>  ูุฐุง ูู ุดูุก ุงูุขู.  ูุงููุชูุฌุฉ ูู ูุธุงู ูุนูู ุจูุงูู ุทุงูุชู ุ ุจุงุณุชุซูุงุก ุจุนุถ ุงููุฑูู ุงูุฏูููุฉ ูุน ุชุนููู / ุงุณุชุฆูุงู.  ูู ููุงุญุธ ุฃู ุชุนุทู ูููุงุฉ ุงูุฐุนุฑ ูุนุฏุฉ ุฃูุงู ุงูุฌููุฒูุฉ.  ุขูู ุฃู ูููู ูุคูู ูุญุฏุฉ bce ูู ุงููุณุชูุจู ุงููุฑูุจ ุฐูู ุ ูุณูู ูุญุตู ุนูู ุงูุฏุนู ุงููุงูู ููุชุนููู / ุงูุงุณุชุฆูุงู ูุงูุตูุช. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar472106/">https://habr.com/ru/post/ar472106/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar472092/index.html">ูุธุงุฆู ุบูุฑ ุขููุฉ PHP</a></li>
<li><a href="../ar472094/index.html">ุงูููุฏูุจูู ูุงูุฃุญุฏุงุซ ูู C #</a></li>
<li><a href="../ar472096/index.html">ูุดุชุฑู Android clicker ูู ุงููุณุชุฎุฏููู ูู ุงูุฎุฏูุงุช ุงููุฏููุนุฉ</a></li>
<li><a href="../ar472100/index.html">Shchyry ุงูุฃููุฑุงููุฉ ุฏููู ุฃู ููู ูููู ูู ูุฎูู</a></li>
<li><a href="../ar472104/index.html">Habr Weekly # 23 / ุงูุทูุฑุงู ุฅูู ุงููุถุงุก ูุงูุนูู ุ ุชุฏูู Microsoft Windows Phone ู Matrix ุงููุฏููุฉ ูุงูุฃูุนุงุจ ุงููุฑููุฉ</a></li>
<li><a href="../ar472110/index.html">ูุฌุชุงุฒ ุงูุชุญุฏู RegexPlay 100 ูช</a></li>
<li><a href="../ar472112/index.html">ุชุดุงุชุจูุช ุนูู ุฑุฎูุตุฉ</a></li>
<li><a href="../ar472114/index.html">ูุญุฏุฉ ุชุญูู ุงููุนุจุฉ ูุงูุฃูุนุงุจ ุงูุนููุง ุจููุณู. ูุฐูุฑ ูุนุจุฉ ูุญุฑู + ESPboy</a></li>
<li><a href="../ar472118/index.html">ููู ุงูุชูุจูุฑ ุงูุฃูุฑููู ูู ุงูุตูู ููุนุช</a></li>
<li><a href="../ar472120/index.html">ููููู ุงูุชููู ุงูููุฏุงูู ุงูุชูููู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>