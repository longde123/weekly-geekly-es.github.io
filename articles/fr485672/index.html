<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🤝‍👨🏽 ⛓️ 👩🏽‍🔧 Redis Best Practices, Partie 1 🙅🏿 👥 ↩️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans une série de plusieurs articles, je présenterai ma traduction adaptée de la section Redis Best Practices du site officiel de Redis Labs. 
 Redis ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Redis Best Practices, Partie 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485672/">  Dans une série de plusieurs articles, je présenterai ma traduction adaptée de la section <a href="https://redislabs.com/redis-best-practices/" rel="nofollow">Redis Best Practices</a> du site officiel de Redis Labs. <div style="text-align:center;"><img src="https://habrastorage.org/webt/hr/6y/f5/hr6yf5w1hp0fh-i5vfa0p1pxeuy.png"></div><a name="habracut"></a><br>  Redis peut être utilisé de nombreuses façons, cependant, plusieurs modèles peuvent être utilisés pour résoudre des problèmes courants.  Nous avons compilé une collection de modèles courants que nous considérons comme les <i>meilleures pratiques</i> pour résoudre ces problèmes.  Cette collection n'est pas exhaustive et ne semble pas être un ensemble des seules façons d'utiliser Redis, mais nous espérons qu'elle servira de point de départ pour résoudre les problèmes à l'aide de Redis. <br><br>  Nous avons divisé ce guide des meilleures pratiques en chapitres et sous-chapitres selon les besoins (Note du traducteur: certains sous-chapitres sont courts, je vais donc les combiner en un seul): <br><br><ul><li>  dans le chapitre «Modèles d'indexation», nous examinerons les moyens d'aller au-delà de l'accès aux valeurs-clés habituel avec Redis.  Il comprend des moyens d'utiliser intelligemment les schémas clés en utilisant divers types de données Redis pour aider non seulement à trouver des données, mais aussi à réduire la complexité d'accès; </li><li> Le chapitre Modèles d'interaction se concentre sur les modèles Redis qui déplacent les données à travers l'infrastructure.  Dans ce cas, Redis n'agit pas comme un référentiel, mais plutôt comme un guide pour les données; </li><li>  le chapitre «Modèles de stockage des données» décrit les méthodes d'enregistrement des représentations complexes de données dans Redis.  Nous calculerons des scripts complexes de documents qui peuvent être généralisés de manière simple et complexe; </li><li>  les modèles concernant les données stockées temporairement sont décrits dans le chapitre «Modèles de séries temporelles»; </li><li>  la limitation de vitesse est souvent utilisée à Redis.  Dans le chapitre "Modèles de base de limitation de vitesse", nous allons passer aux principes de base de ses cas d'utilisation; </li><li>  Le filtre Bloom a longtemps été vu dans Redis, et dans le chapitre «Patterns with a Bloom Filter» nous examinons les structures de données probabilistes et comment elles diffèrent de leurs analogues improbables; </li><li>  le comptoir est une réception étonnamment profonde.  Dans un chapitre distinct, nous explorons comment calculer l'activité et les éléments uniques de manière efficace par le calcul; </li><li>  enfin, nous parlerons de la façon de tirer parti de Lua pour que Redis fasse plus avec moins. </li></ul><br>  Ce guide est incohérent, vous pouvez donc le démarrer avec n'importe quel chapitre.  Vous pouvez également utiliser la navigation au début de chaque publication pour trouver quelque chose qui vous convient. <br><br><h2>  Modèles d'indexation </h2><br>  Conceptuellement, Redis est une base de données basée sur le paradigme clé / valeur, lorsque chaque élément de données est associé à une certaine clé.  Si vous souhaitez obtenir des données pour autre chose qu'une clé, vous devrez implémenter un index qui utilise l'un des nombreux types de données disponibles dans Redis. <br><br>  L'indexation dans Redis est assez différente de ce qui est présenté dans d'autres bases de données, donc vos propres scénarios d'utilisation et données détermineront la meilleure stratégie d'indexation.  Dans ce chapitre, nous examinerons quelques stratégies générales de récupération de données en plus de la simple récupération de clé / valeur: <br><br><ul><li>  ensembles triés comme indices; </li><li>  indices lexicographiques; </li><li>  indices géospatiaux; </li><li>  Géolocalisation IP </li><li>  recherche plein texte; </li><li>  index partitionnés. </li></ul><br><h3>  Ensembles triés comme indices </h3><br>  Les ensembles triés (ZSET) sont un type de données standard dans Redis qui représente de nombreux objets uniques (les répétitions ne sont pas enregistrées), où chaque objet est affecté à un nombre (appelé un «décompte»), qui agit comme un mécanisme de tri naturel.  Et bien que les objets ne puissent pas être répétés, quelques objets peuvent avoir le même nombre.  Avec une complexité temporelle relativement faible pour ajouter, supprimer et obtenir une plage de valeurs (par rang ou nombre), les ensembles triés sont tout à fait appropriés pour être des index.  Par exemple, prenons les pays du monde, classés par population: <br><br><pre><code class="plaintext hljs">&gt; ZADD countries-by-pop 1409517397 china &gt; ZADD countries-by-pop 146573899 russia &gt; ZADD countries-by-pop 81456724 germany &gt; ZADD countries-by-pop 333016381 usa &gt; ZADD countries-by-pop 1 mars &gt; ZADD countries-by-pop 37290812 afghanistan &gt; ZADD countries-by-pop 1388350202 india</code> </pre> <br>  Obtenir les 5 meilleurs pays sera simple: <br><br><pre> <code class="plaintext hljs">&gt; ZRANGE countries-by-pop 0 4 1) "mars" 2) "afghanistan" 3) "germany" 4) "russia" 5) "india"</code> </pre> <br>  Et obtenir des pays avec des populations entre 10 000 000 et 1 000 000 000: <br><br><pre> <code class="plaintext hljs">&gt; ZRANGEBYSCORE countries-by-pop 10000000 1000000000 1) "afghanistan" 2) "germany" 3) "russia"</code> </pre> <br>  Vous pouvez créer plusieurs index pour illustrer différentes méthodes de tri des données.  Dans notre exemple, nous pourrions utiliser les mêmes objets, mais au lieu du nombre de personnes, prendre la densité de population, la taille géographique, le nombre d'internautes, etc.  Cela créera des index hautes performances pour divers aspects.  De plus, en divisant le nom d'un objet par des données le concernant stockées soit dans Redis (dans Hash, par exemple) ou dans un autre magasin de données, le processus secondaire pourrait obtenir des informations supplémentaires sur chaque élément si nécessaire. <br><br><h3>  Indices lexicographiques </h3><br>  Les ensembles triés (ZSET) avec classement par nombre ont une propriété intéressante qui peut être utilisée pour créer un mécanisme de tri alphabétique approximatif.  La propriété est que les objets avec le même score peuvent être retournés dans l'ordre lexicographique et par des valeurs limites.  Prenez les données suivantes: <br><br><pre> <code class="plaintext hljs">&gt; ZADD animal-list 0 bison 0 boa 0 dog 0 emu 0 falcon 0 alligator 0 chipmunk</code> </pre> <br>  Cette commande ajoutera plusieurs animaux à la clé de la liste des animaux.  Chaque objet a un score de 0. Après avoir exécuté la commande ZRANGE avec les arguments 0 et -1, nous voyons un ordre curieux: <br><br><pre> <code class="plaintext hljs">&gt; ZRANGE animal-list 0 -1 1) "alligator" 2) "bison" 3) "boa" 4) "chipmunk" 5) "dog" 6) "emu" 7) "falcon"</code> </pre> <br>  Bien que les éléments n'aient pas été ajoutés par ordre alphabétique, ils ont été renvoyés triés par ordre alphabétique.  Cet ordre est le résultat d'une comparaison de chaînes binaires, octet par bit.  Cela signifie que les caractères ASCII seront retournés dans l'ordre alphabétique.  Cela suggère ce qui suit: <br><br><ul><li>  les caractères en minuscule et en majuscule ne seront pas reconnus comme identiques; </li><li>  les caractères multi-octets ne seront pas triés comme prévu. </li></ul><br>  Redis fournit également des fonctionnalités avancées pour affiner davantage les recherches lexicographiques.  Par exemple, nous voulons renvoyer les animaux commençant par <i>b</i> et se terminant par <i>e</i> .  Nous pouvons utiliser la commande suivante: <br><br><pre> <code class="plaintext hljs">&gt; ZRANGEBYLEX animal-list [b (f 1) "bison" 2) "boa" 3) "chipmunk" 4) "dog" 5) "emu"</code> </pre> <br>  L'argument <i>(f</i> peut être un peu déroutant. C'est un point important, car Redis n'a aucune idée de la compréhension littérale des lettres de l'alphabet. Cela signifie que nous devons tenir compte du fait que tout ce qui commence par <i>e</i> restera toujours devant tout ce qui commence par <i>f</i> , quelles que soient les lettres suivantes Une autre remarque est que le crochet carré indique la recherche avec inclusion et le crochet rond indique la recherche sans inclusion. Dans notre cas, si nous interrogeons avec <i>b</i> , cela sera inclus dans la liste, tandis que <i>f</i> n'apparaîtra pas dans la sélection. Si vous avez besoin tous les éléments jusqu'à la fin, utilisez  le dernier symbole codé (255 ou 0xFF): <br><br><pre> <code class="plaintext hljs">&gt; ZRANGEBYLEX animal-list [c "[\xff" 1) "chipmunk" 2) "dog" 3) "emu" 4) "falcon"</code> </pre> <br>  Cette commande peut également être limitée, assurant ainsi la pagination: <br><br><pre> <code class="plaintext hljs">&gt; ZRANGEBYLEX animal-list [b (f LIMIT 0 2 1) "bison" 2) "boa" &gt; ZRANGEBYLEX animal-list [b (f LIMIT 2 2 1) "chipmunk" 2) "dog"</code> </pre> <br>  Le seul écueil est que la complexité temporelle augmentera à mesure que l'indentation augmente (premier argument après LIMIT).  Par conséquent, si vous avez 1 million d'objets et que vous essayez d'obtenir les deux derniers, cela nécessitera une analyse d'un million seulement. <br><br><h3>  Index géospatiaux </h3><br>  Redis possède plusieurs équipes d'indexation géospatiale (équipes GEO), mais contrairement à d'autres équipes, ces équipes n'ont pas leurs propres types de données.  Ces commandes complètent en fait le type d'ensemble trié.  Ceci est réalisé en encodant la latitude et la longitude dans le score de l'ensemble trié en utilisant l'algorithme geohash. <br>  L'ajout d'éléments à un géo-index est facile.  Supposons que vous suivez un groupe de voitures qui roulent le long d'une route.  Nous appelons cet ensemble de voitures simplement des «voitures».  Disons que votre machine particulière peut être identifiée comme un objet «ma voiture» (nous utilisons le terme «objet» parce que le géo-index est simplement une forme de l'ensemble).  Pour ajouter une machine à l'ensemble, nous pouvons exécuter la commande: <br><br><pre> <code class="plaintext hljs">&gt; GEOADD cars -115.17087 36.12306 my-car</code> </pre> <br>  Le premier argument est l'ensemble auquel nous ajoutons, le second est la latitude, le troisième est la longitude et le quatrième est le nom de l'objet. <br><br>  Pour mettre à jour l'emplacement de la machine, il vous suffit d'exécuter à nouveau la commande avec les nouvelles coordonnées.  Cela fonctionne car un géo-index est simplement un ensemble où les éléments en double ne sont pas autorisés. <br><br><pre> <code class="plaintext hljs">&gt; GEOADD cars -115.17172 36.12196 my-car</code> </pre> <br>  Ajoutez une deuxième voiture aux «voitures».  Cette fois, Volodya la conduit: <br><br><pre> <code class="plaintext hljs">&gt; GEOADD cars -115.171971 36.120609 volodias-car</code> </pre> <br>  En regardant les coordonnées, vous pouvez dire que ces voitures sont assez proches les unes des autres, mais combien?  Vous pouvez le définir avec la commande GEODIST: <br><br><pre> <code class="plaintext hljs">&gt; GEODIST cars my-car volodias-car "151.9653"</code> </pre> <br>  Cela signifie que deux véhicules sont distants d'environ 151 mètres.  Vous pouvez également calculer dans d'autres unités: <br><br><pre> <code class="plaintext hljs">&gt; GEODIST cars my-car robins-car ft "498.5737"</code> </pre> <br>  Cela a renvoyé la même distance par étapes.  Vous pouvez également utiliser des miles (ml) ou des kilomètres (km). <br><br>  Voyons maintenant qui se trouve dans le rayon d'un certain point: <br><br><pre> <code class="plaintext hljs">&gt; GEORADIUS cars -115.17258 36.11996 100 m 1) "volodias-car"</code> </pre> <br>  Cela a renvoyé tout le monde dans un rayon de 100 mètres autour du point spécifié.  Vous pouvez également demander à tout le monde dans le rayon de n'importe quel objet de l'ensemble: <br><br><pre> <code class="plaintext hljs">&gt; GEORADIUSBYMEMBER cars volodias-car 152 m 1) "volodias-car" 2) "my-car"</code> </pre> <br>  Nous pouvons également activer la distance en ajoutant l'argument optionnel WITHDIST (cela fonctionne pour GEORADIUS ou GEORADIUSBYMEMBER): <br><br><pre> <code class="plaintext hljs">&gt; GEORADIUSBYMEMBER cars volodias-car 152 m WITHDIST 1) 1) "volodias-car" 2) "0.0000" 2) 1) "my-car" 2) "151.9653"</code> </pre> <br>  Un autre argument facultatif pour GEORADIUS et GEORADIUSBYMEMBER est WITHCOORD, qui renvoie les coordonnées de chaque objet.  WITHDIST et WITHCOORD peuvent être utilisés ensemble ou séparément: <br><br><pre> <code class="plaintext hljs">&gt; GEORADIUSBYMEMBER cars volodias-car 152 m WITHDIST WITHCOORD 1) 1) "volodias-car" 2) "0.0000" 3) 1) "-115.17197102308273315" 2) "36.12060917648089031" 2) 1) "my-car" 2) "151.9653" 3) 1) "-115.17171889543533325" 2) "36.12196018285882104"</code> </pre> <br>  Étant donné que les index géospatiaux ne sont qu'une alternative aux ensembles triés, certains opérateurs de ces derniers peuvent être utilisés.  Si nous voulons supprimer "ma-voiture" de l'ensemble des "voitures", nous pouvons utiliser la commande de l'ensemble trié de ZREM: <br><br><pre> <code class="plaintext hljs">&gt; ZREM cars my-car</code> </pre> <br>  Redis fournit un riche ensemble d'outils pour travailler avec les données géospatiales, et dans cette section, nous n'avons examiné que les outils de base. <br><br><h3>  Géolocalisation IP </h3><br>  Trouver l'emplacement réel du service connecté peut être très utile.  Les tables de géolocalisation IP sont généralement assez volumineuses et difficiles à gérer efficacement.  Nous pouvons utiliser des ensembles triés pour implémenter des services de géolocalisation IP rapides et efficaces. <br><br>  IPv4 est le plus souvent référencé en notation décimale (74.125.43.99, par exemple).  Cependant, les services réseau voient cette même adresse comme un nombre 32 bits, chaque octet représentant l'un des quatre nombres sous forme décimale.  L'exemple ci-dessus serait 0x4A7D2B63 en hexadécimal ou 1249717091 en décimal. <br><br>  Les jeux de données de géolocalisation IP sont largement disponibles et prennent généralement la forme d'un simple tableau à trois colonnes (début, fin, emplacement).  Le début et la fin sont la représentation décimale d'IPv4.  Dans Redis, nous pouvons adapter des ensembles triés à ce format, car il n'y a pas de «trous» dans les plages IP, par conséquent, nous pouvons sans risque supposer que la fin d'une plage est le début d'une autre. <br><br>  Pour un exemple simple, ajoutez quelques plages aux ensembles triés: <br><br><pre> <code class="plaintext hljs">&gt; ZADD ip-loc 1249716479 us:1 &gt; ZADD ip-loc 1249716735 taiwan:1 &gt; ZADD ip-loc 1249717759 us:2 &gt; ZADD ip-loc 1249718015 finland:1</code> </pre> <br>  Le premier argument est la clé de notre ensemble, le second est la représentation décimale de la fin de la plage IP et le dernier est l'objet lui-même.  Notez que l'objet set a un nombre après les deux points.  C'est juste pour faciliter un exemple.  Les vraies tables IP ont des identifiants uniques pour chaque plage (et plus d'informations supplémentaires que le nom du pays). <br><br>  Pour interroger la table pour une adresse IP donnée, nous pouvons utiliser la commande ZRANGEBYSCORE avec quelques arguments supplémentaires.  Prenez l'adresse IP et convertissez-la en décimale.  Cela peut être fait en utilisant votre langage de programmation.  Tout d'abord, utilisez l'adresse de l'exemple d'origine 74.125.43.99 (1249717091).  Si nous prenons ce nombre comme point de référence et ne spécifions pas de maximum, puis limitons le résultat uniquement au premier objet, nous trouverons sa géolocalisation: <br><br><pre> <code class="plaintext hljs">&gt; ZRANGEBYSCORE ip-loc 1249717091 +inf LIMIT 0 1 1) "us:2"</code> </pre> <br>  Le premier argument est la clé de notre ensemble trié, le second est la représentation décimale de l'adresse IP, le troisième (+ inf) indique à Redis de demander sans limite supérieure, et les trois derniers arguments indiquent simplement que nous voulons obtenir uniquement le tout premier résultat. <br><br><h3>  Recherche plein texte </h3><br>  Avant l'avènement des modules, la recherche en texte intégral était implémentée à l'aide des commandes natives de Redis.  Le module RedisSearch est beaucoup plus productif que ce modèle, cependant, dans certains environnements, il n'est pas disponible.  De plus, ce modèle est très intéressant et peut être généralisé à d'autres charges de travail dans lesquelles RedisSearch ne sera pas idéal. <br>  Supposons que nous ayons plusieurs documents texte à rechercher.  Ce n'est peut-être pas le cas d'utilisation évident pour Redis, car il fournit un accès clé, mais d'un autre côté, Redis peut être utilisé comme un moteur de recherche en texte intégral entièrement nouveau. <br><br>  Tout d'abord, prenons quelques exemples de textes dans les documents: <br><br>  <i>"Redis est très rapide"</i> <br>  <i>"Les guépards sont rapides"</i> <br>  <i>"Les guépards ont des taches"</i> <br><br>  Nous les divisons en ensembles de mots, séparés par un espace de simplicité: <br><br><pre> <code class="plaintext hljs">&gt; SADD ex1 redis is very fast &gt; SADD ex2 cheetahs are very fast &gt; SADD ex3 cheetahs have spots</code> </pre> <br>  Notez que nous mettons chaque ligne dans son propre ensemble.  Il peut sembler que nous ajoutons simplement la ligne entière - SADD est variable et prend plusieurs éléments à la fois comme arguments.  Nous avons également converti tous les mots en minuscules. <br>  Ensuite, nous devons inverser cet index et montrer quel mot est contenu dans quel document.  Pour ce faire, nous allons créer un ensemble pour chaque mot et mettre le nom du document en tant qu'objet: <br><br><pre> <code class="plaintext hljs">&gt; SADD redis ex1 &gt; SADD is ex1 &gt; SADD very ex1 ex2 &gt; SADD fast ex1 ex2 &gt; SADD cheetahs ex2 ex3 &gt; SADD have ex3 &gt; SADD spots ex3</code> </pre> <br>  Pour plus de clarté, nous avons divisé cela en différentes commandes, mais toutes les commandes sont généralement exécutées atomiquement dans le bloc MULTI / EXEC. <br><br>  Pour interroger notre petit index de texte intégral, nous utilisons la commande SINTER (intersection d'ensembles).  Trouvez des documents avec «très» et «rapide»: <br><br><pre> <code class="plaintext hljs">&gt; SINTER very fast 1) "ex2" 2) "ex1"</code> </pre> <br>  Dans le cas où aucun document ne correspond à la demande, nous obtiendrons un résultat vide: <br><br><pre> <code class="plaintext hljs">&gt; SINTER cheetahs redis (empty list or set)</code> </pre> <br>  Par souci de cohérence, il est préférable d'utiliser SUNION au lieu de SINTER: <br><br><pre> <code class="plaintext hljs">&gt; SUNION cheetahs redis 1) "ex2" 2) "ex1" 3) "ex3"</code> </pre> <br>  La suppression d'un objet de l'index est un peu plus compliquée.  Tout d'abord, récupérez les mots indexés du document, puis supprimez l'identifiant du document de chaque mot: <br><br><pre> <code class="plaintext hljs">&gt; SMEMBERS ex3 1) "spots" 2) "have" 3) "cheetahs" &gt; SREM have ex3 &gt; SREM cheetahs ex3 &gt; SREM spots ex3</code> </pre> <br>  Redis n'a pas d'opérateur séparé pour effectuer toutes ces étapes avec une seule commande, vous devez donc d'abord interroger avec la commande SMEMBERS, puis supprimer chaque objet séquentiellement à l'aide de SREM. <br><br>  Bien sûr, il s'agit d'une recherche en texte intégral très simplifiée.  Vous pouvez faire plus avancé en utilisant des ensembles triés au lieu des ensembles habituels.  Dans ce cas, si un mot apparaît plusieurs fois dans un document, vous pouvez le classer plus haut que le document dans lequel il apparaît une fois.  Les schémas décrits ci-dessus sont plus ou moins les mêmes, à l'exception des types d'ensembles utilisés. <br><br><h3>  Index partitionnés </h3><br>  Une seule instance (ou fragment) de Redis est très viable, mais il peut arriver que vous ayez besoin d'un index réparti sur plusieurs instances.  Par exemple, pour augmenter le débit en parallélisant des index plus grands que l'espace libre d'une instance.  Supposons que vous souhaitiez effectuer une opération sur plusieurs touches.  Un moyen efficace de séparer (partitionner) ces clés est d'assurer une distribution uniforme des clés sur chaque partition, d'effectuer toutes les opérations en parallèle sur chaque partition, puis de combiner les résultats à la fin. <br><br>  Pour obtenir une distribution uniforme des clés, nous utiliserons un algorithme de hachage non cryptographique.  N'importe quelle fonction de hachage rapide fera l'affaire, mais nous utilisons le célèbre CRC-32 comme exemple.  Dans la plupart des cas, ces algorithmes renvoient le résultat en hexadécimal (pour «my-cool-document» CRC-32 renverra F9FDB2C9).  La représentation hexadécimale est plus simple pour la machine, mais ce n'est qu'une autre représentation d'entiers décimaux, ce qui signifie que vous pouvez effectuer des calculs sur ces valeurs. <br>  Ensuite, vous devez déterminer le nombre de partitions - cela devrait être au moins x2 du nombre de copies.  Cela contribue en outre à la mise à l'échelle. <br><br>  Disons que nous avons 3 copies et 6 partitions.  La partition à laquelle le document est envoyé peut être calculée par l'opération suivante: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><msub><mtext>&amp;#xA0;</mtext><mi>f</mi></msub><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mi>d</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>f</mi><mi>i</mi><mi>e</mi><mi>r</mi><msub><mtext>&amp;#xA0;</mtext><mi>d</mi></msub><mi>o</mi><mi>c</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mi>u</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><msub><mtext>&amp;#xA0;</mtext><mi>p</mi></msub><mi>a</mi><mi>r</mi><mi>t</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="60.941ex" height="2.78ex" viewBox="0 -832 26238.5 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-68" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-61" x="576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-73" x="1106" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-68" x="1575" y="0"></use><g transform="translate(2152,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-66" x="353" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-75" x="2891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6E" x="3463" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-63" x="4064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-74" x="4497" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-69" x="4859" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6F" x="5204" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6E" x="5690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMAIN-28" x="6290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-69" x="6680" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-64" x="7025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-65" x="7549" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6E" x="8015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-74" x="8616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-69" x="8977" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-66" x="9323" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-69" x="9873" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-65" x="10219" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-72" x="10685" y="0"></use><g transform="translate(11137,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-64" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6F" x="11857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-63" x="12342" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-75" x="12776" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6D" x="13348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-65" x="14227" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6E" x="14693" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-74" x="15294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMAIN-29" x="15655" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6D" x="16295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6F" x="17173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-64" x="17659" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6E" x="18182" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-75" x="18783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6D" x="19355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-62" x="20234" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-65" x="20663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-72" x="21130" y="0"></use><g transform="translate(21581,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-70" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-61" x="22287" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-72" x="22817" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-74" x="23268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-69" x="23630" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-74" x="23975" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-69" x="24337" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6F" x="24682" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-6E" x="25168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/485672/&amp;xid=17259,15700023,15700186,15700190,15700256,15700259,15700262,15700265,15700271,15700302&amp;usg=ALkJrhgzp6WQWe9YqA33oMgzE5rs_-cPtg#MJMATHI-73" x="25768" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><msub><mtext>&nbsp;</mtext><mi>f</mi></msub><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">(</mo><mi>i</mi><mi>d</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>f</mi><mi>i</mi><mi>e</mi><mi>r</mi><msub><mtext>&nbsp;</mtext><mi>d</mi></msub><mi>o</mi><mi>c</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mi>u</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><msub><mtext>&nbsp;</mtext><mi>p</mi></msub><mi>a</mi><mi>r</mi><mi>t</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> hash \ _function (identifier \ _document) \ mod number \ _partitions </script></p><br><br><pre> <code class="plaintext hljs">CRC32(“my-cool-document”) = F9FDB2C9 (16)  4194153161 (10) 4194153161 mod 6 = 5</code> </pre> <br>  Dans Redis Enterprise, vous pouvez contrôler la partition à laquelle appartient la clé, en utilisant des expressions régulières prédéfinies ou en enveloppant une partie de la clé avec des accolades.  Donc, pour notre exemple, nous pouvons définir la clé du document comme suit: <br><br>  <i>idx: my-cool-document {5}</i> <br><br>  Ensuite, nous avons un autre document qui émet une partition avec le numéro 3, par conséquent, la clé ressemblera à ceci: <br><br>  <i>idx: mon-autre-document {3}</i> <br><br>  Si vous avez des clés auxiliaires supplémentaires avec lesquelles vous devrez travailler et qui sont associées à ce document, vous devez être sur la même partition afin de pouvoir effectuer des opérations avec les deux clés en même temps sans rencontrer un tas d'erreurs.  Pour ce faire, vous devez ajouter le même numéro de partition à la clé que le document. <br><br>  En regardant vos données à distance, vous verrez que votre index est réparti assez uniformément sur les partitions.  Vous pouvez paralléliser la tâche qui doit être effectuée pour chaque partition.  Lorsque vous avez une tâche qui doit être effectuée à travers l'index entier, votre application devra effectuer la même logique pour chaque partition, retourner le résultat et combiner comme requis dans l'application. <br><br>  Sur ce point, le premier article prend fin.  La prochaine sera une traduction des sous-titres «Modèles d'interaction» et «Modèles de stockage de données». </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr485672/">https://habr.com/ru/post/fr485672/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr485650/index.html">Docker Image Reduction Techniques</a></li>
<li><a href="../fr485652/index.html">Statistiques des commentaires en ligne Confluence</a></li>
<li><a href="../fr485654/index.html">Une idée tirée de la physique aide l'IA à travailler dans des dimensions plus élevées.</a></li>
<li><a href="../fr485660/index.html">La société de protection DDoS a elle-même lancé des attaques DDoS, a reconnu son fondateur</a></li>
<li><a href="../fr485664/index.html">Création de paramètres dynamiques dans un travail Jenkins, ou comment rendre votre tâche conviviale</a></li>
<li><a href="../fr485682/index.html">La gestion du temps n'aidera pas: la procrastination est le problème de la régulation des émotions, pas du temps</a></li>
<li><a href="../fr485688/index.html">Myapp prolonge ses vacances</a></li>
<li><a href="../fr485692/index.html">Conseils d'un spécialiste informatique au client, ou comment automatiser le désordre</a></li>
<li><a href="../fr485694/index.html">Embox sur processeur Elbrus. Ou n'oublie jamais ce que tu as en intelligence</a></li>
<li><a href="../fr485702/index.html">FunCorp iOS Meetup # 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>