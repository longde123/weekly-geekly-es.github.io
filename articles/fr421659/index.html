<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧙🏿 😑 💓 Comment Microsoft a oublié la moitié du monde ou lu des messages d'erreur 👳 🌍 🈁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Non, cet article n'est pas sur ce qu'est un monstre énorme et diabolique Microsoft. Et comment elle offense à nouveau les utilisateurs. Et sur la faço...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment Microsoft a oublié la moitié du monde ou lu des messages d'erreur</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421659/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/vv/dn/d-/vvdnd-jg8bvp3c9k8rxvlubwdq8.png"></div><br>  Non, cet article n'est pas sur ce qu'est un monstre énorme et diabolique Microsoft.  Et comment elle offense à nouveau les utilisateurs.  Et sur la façon de corriger la faille gênante qui est apparue avec la dernière mise à jour d'août de <b>Power BI Desktop</b> avec prise en charge de <b>Python</b> activée, à savoir les problèmes de visualisation dans les versions localisées de PBI, en particulier <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">matplotlib</a></b> . <br><br>  Au cours des dix premiers jours du mois d'août, Microsoft a publié la version tant attendue et très attendue de son produit de BI compatible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Python</a> vraiment remarquable.  Au moment de la rédaction, cette fonctionnalité se trouve dans la section des fonctionnalités préliminaires (c'est-à-dire, juste une version bêta). <br><a name="habracut"></a><br>  Depuis longtemps et avec plaisir, j'utilise Power BI dans mon travail (à la fois en tant qu'analyste de données et en tant que développeur BI).  J'essaie toujours d'essayer de nouvelles fonctionnalités qui sont généreusement annoncées dans la section pré-version.  Et, nous devons rendre hommage à l'équipe de développement de Microsoft, ce sont presque toujours des versions solides et exploitables de fonctionnalités, d'options et de visualisations. <br>  La communauté BI attendait particulièrement l'inclusion de la prise en charge Python dans Power BI.  Non pas que la fonctionnalité intégrée de Power BI n'était pas suffisante pour implémenter les tâches les plus complexes résolues par les systèmes BI.  Environ 250 fonctions du langage de requête <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DAX</a> intégré et même plus de sept cents fonctions de Power Query ont permis de résoudre presque toutes les tâches de BI, depuis l'obtention de données à partir d'une grande variété de sources, la construction d'un modèle de données et la prise en charge des visualisations et des rapports.  L'année dernière, la prise en charge du langage R a été ajoutée, ce qui a considérablement étendu les capacités de Power BI en termes de calculs scientifiques, de nouvelles visualisations et même d'apprentissage automatique. <br>  Cependant, ce n'est un secret pour personne qu'aujourd'hui, le leader de l'environnement Data Science parmi les langages de programmation est Python.  Et l'inclusion de ce langage dans l'écosystème Microsoft BI fait de Power BI une sorte de couteau suisse pour la préparation, l'analyse et la présentation finale des données.  Avec prise en charge complète de quatre langages spécialisés (DAX, Power Query / M, R, Python) et limité, dans les fonctionnalités nécessaires de SQL et MDX.  Certains geeks vissent également JavaScript, mais il s'agit d'une conversation distincte. <br><br>  En tant que développeur Python non pratiquant, j'ai inclus avec impatience le support expérimental de Python pour tester de nouveaux horizons ouverts.  J'ai vérifié le menu de la dernière version de PBI et rechargé l'application.  En savoir plus sur la connexion et la configuration <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur le blog Microsoft</a> . <br><br>  J'avais déjà installé une version précédente de Python et j'ai décidé de tenter ma chance et de ne pas prendre la peine d'en installer une nouvelle.  En conséquence, un nouveau connecteur est apparu dans les sources de données - «Pyton Script», et une nouvelle icône [ <b>Py</b> ] dans le panneau de visualisation. <br><br>  Cependant, à ce stade, le code Python n'a pas été exécuté.  Je ne décrirai pas toutes les vicissitudes associées à la tentative d'exécuter (presque) Python inconnu dans un environnement que je connais et Power BI. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iz/fd/zf/izfdzf25eygkhb_ew7dcol6qeey.png" alt="Problèmes de visualisation" width="50%"></div><br>  Quoi qu'il en soit, même une installation propre de l'assemblage Anaconda avec un grand nombre de bibliothèques préinstallées, un gestionnaire de paquets avancé, etc. ne m'a pratiquement pas poussé vers les «images» chères.  Différentes versions de Python ont donné différents messages d'erreur à mon code de test, et j'étais un peu découragé.  Une recherche Google sur ces messages n'a pas non plus renvoyé de résultats adéquats.  Récemment apparue sur le portail, dans la communauté Power BI ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://community.powerbi.com</a> ), une demande d'un utilisateur danois sur un problème similaire a conduit à une longue réflexion - il ne s'agit pas de ma configuration informatique avec un mélange houleux de logiciels installés (j'ai vérifié sur différents voitures, mais partout où ils sont - mélange explosif, seulement différent).  Le point est la localisation. <br>  Quand il est devenu clair de quel côté regarder, des réponses plus sensées des moteurs de recherche ont commencé à rencontrer des requêtes raffinées.  Mais le point était le même partout: «Dans la version actuelle de Power BI, vous ne pouvez pas utiliser le format des nombres avec un point décimal, mais uniquement avec un point décimal, avec Python.  Attendez la version mise à jour ou modifiez le format de la représentation des nombres. " <br><br>  Dans Power BI, vous pouvez modifier le format numérique en quelques secondes via le menu, mais que faire avec des tonnes de rapports prêts à l'emploi et de données source?  La peau de mouton ne valait clairement pas l'effort. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vr/ui/ez/vruiezaedw66na3176iecgffphm.png" alt="Configuration de PBI Python" width="80%"></div><br>  À ce stade, tous les «pythons affligés sous le pouvoir bi» étaient divisés en deux camps: les Américains et les Anglais avec un point décimal et tout le reste.  Une partie du «reste à la mer de la version actuelle» est passée à la hâte au premier groupe, définissant un point comme séparateur standard.  Le reste de la ponura a commencé à attendre la libération corrigée.  Mais depuis  il s'agit d'une version bêta et la traduction en fonctionnalités du produit peut prendre deux mois et demi, cela ne valait vraiment pas la peine d'attendre des corrections au jour le jour. <br><br>  Et à ce moment, j'ai décidé d'examiner de plus près le message d'erreur: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rj/3p/uv/rj3puvaexotrgi-kmg2xonkj80a.jpeg" alt="Erreur" width="80%"></div><br>  De plus près, car l'erreur n'était pas liée à mon code, qui dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Jypyter a été</a> exécuté juste sans erreurs et a affiché tous les éléments visuels sans aucun problème.  Le problème était dû au code supplémentaire que Microsoft avait implémenté pour intégrer Python à Power BI.  A savoir, avec l'appel à la bibliothèque matplotlib ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://ru.wikipedia.org/wiki/Matplotlib</a> ) et plus précisément la fonction pyplot (fichier pyplot.py). <br><br>  Mais pour cela, et un logiciel open source pour y mettre ses petites mains ludiques.  Sans y réfléchir à deux fois, en ouvrant un code de fonction de cent trente kilo-octets à l'adresse indiquée dans le texte d'erreur, j'ai découvert qu'un échec se produit lorsque figManager est initialisé. <br><br>  Dans le code source de la bibliothèque, ce code Python ressemble à ceci: <br><br><pre><code class="python hljs">figManager = new_figure_manager(num, figsize=figsize, dpi=dpi, facecolor=facecolor, edgecolor=edgecolor, frameon=frameon, FigureClass=FigureClass, **kwargs)</code> </pre> <br>  En respectant une bibliothèque aussi importante, je viens de commenter le code pour appeler le paramètre <b>figsize</b> du problème, auquel Microsoft transmet quatre arguments de Poiwer BI au lieu de deux dans les versions localisées, et transmis la taille de visualisation par défaut à ce paramètre. <br><br>  Maintenant, ce code ressemble à ceci: <br><br><pre> <code class="python hljs">figManager = new_figure_manager(num, figsize=rcParams[<span class="hljs-string"><span class="hljs-string">'figure.figsize'</span></span>], <span class="hljs-comment"><span class="hljs-comment">#figsize=figsize, dpi=dpi, facecolor=facecolor, edgecolor=edgecolor, frameon=frameon, FigureClass=FigureClass, **kwargs)</span></span></code> </pre> <br>  Dans l'assemblage Anaconda actuel, il s'agit de 542 à 549 lignes.  Si vous avez une version différente de la bibliothèque, recherchez simplement l'entrée «figManager» et apportez les modifications nécessaires et enregistrez la bibliothèque corrigée sous le même nom (pour cela, vous aurez besoin des droits d'administrateur). <br><br>  Après cela, redémarrez simplement le code de visualisation pour l'exécution et profitez du résultat ... Eh bien, ou attendez que la montagne vienne à Mohammed, ou plutôt Microsoft à Python. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3f/bt/6f/3fbt6fpa984gw7jniwutnxl2cw4.png" alt="résultat" width="90%"></div><br>  Yuri Kolmakov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">McCow</a> ) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr421659/">https://habr.com/ru/post/fr421659/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421647/index.html">Un moyen pratique de tester les composants React</a></li>
<li><a href="../fr421649/index.html">«Top 3D Expo. Digital Education 2018 »21 septembre au Technopolis Moscou</a></li>
<li><a href="../fr421653/index.html">Aperçu et dispositif des compteurs électriques modernes</a></li>
<li><a href="../fr421655/index.html">Ingénieurs Jetpack: Alexander Fedorovich Andreev</a></li>
<li><a href="../fr421657/index.html">Croissance continue JSON</a></li>
<li><a href="../fr421663/index.html">Conteneurs pour adultes (partie 03): 10 choses que vous n'avez pas besoin de faire avec des conteneurs</a></li>
<li><a href="../fr421665/index.html">Android Jetpack: transformer des applications en fusées</a></li>
<li><a href="../fr421667/index.html">CJM Meetup in MegaFon - comment c'était et de quoi nous avons parlé (reportages vidéo)</a></li>
<li><a href="../fr421669/index.html">Le tribunal a interdit la distribution gratuite de fichiers CAO de qualité militaire, de sorte que le créateur a commencé à les vendre</a></li>
<li><a href="../fr421671/index.html">Cinq nanotechnologies de la nature qui peuvent nous inspirer de nouveaux développements</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>