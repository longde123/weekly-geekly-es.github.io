<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äç‚ù§Ô∏è‚Äçüë® ü•¢ üé∏ My Single Line Dropbox Client para Linux üóíÔ∏è ü§öüèΩ üë®üèª‚Äçüåæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quiero hablar sobre mi intento de crear un cliente simple de Dropbox de una sola l√≠nea para Linux usando solo componentes gratuitos de c√≥digo abierto,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>My Single Line Dropbox Client para Linux</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434460/">  Quiero hablar sobre mi intento de crear un cliente simple de Dropbox de una sola l√≠nea para Linux usando solo componentes gratuitos de c√≥digo abierto, incluidos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">rclone</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">entr</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">systemd</a> . <br><br><h2>  Contexto </h2><br>  Recientemente, el cliente propietario de Dropbox para Linux ha dejado de admitir todos los sistemas de archivos de Linux, excepto <i>ext4 sin cifrar</i> .  Y mi directorio personal, desafortunadamente, est√° encriptado. <br><br>  A principios de diciembre, el cliente propietario dej√≥ de funcionar.  Se desconect√≥ y sugiri√≥ elegir una carpeta de sincronizaci√≥n diferente en el "sistema de archivos compatible". <br><a name="habracut"></a><br>  Por cierto, estoy ejecutando Ubuntu Bionic en el Thinkpad t460s de dos a√±os. <br><br><h2>  ¬øPor qu√© necesito Dropbox? </h2><br>  Uso activamente el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">modo Org</a> : tomo notas en texto plano y Dropbox crea continuamente copias de seguridad de las notas mientras escribo. <br><br>  Si tambi√©n trabaja en el campo de la infraestructura de almacenamiento, mi caso de uso es muy similar a la "replicaci√≥n asincr√≥nica de maestro √∫nico", es decir, con un maestro.  Todas las entradas pasan por mi Thinkpad, este es el maestro.  La carpeta remota de Dropbox es solo una r√©plica de solo lectura, que a veces ‚Äúemito solicitudes de solo lectura‚Äù o la uso como respaldo para crear un nuevo asistente cuando el actual falla o es robado. <br><br>  Sin embargo, esta configuraci√≥n de replicaci√≥n me salv√≥ la vida varias veces.  Todav√≠a tengo ante mis ojos c√≥mo el Thinkpad se neg√≥ a arrancar durante la sesi√≥n del segundo a√±o.  Como constantemente replicaba todas las notas en Dropbox, no perd√≠ ning√∫n dato y pude ver las √∫ltimas notas en el Macbook de mi madre.  Gracias mam√°! <br><br><h2>  Intentos fallidos </h2><br>  Cuando el cliente de Dropbox dej√≥ de funcionar, me concentr√© en buscar otro cliente remoto multifuncional similar para Linux.  En principio, no me importa cambiar a otro servicio, como Google Drive o AWS S3.  Algunas de las opciones son <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">overGrive</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">insync</a> . <br><br>  Sin embargo, llegu√© a la conclusi√≥n de que estas soluciones son demasiado funcionales y <b>no muy adecuadas para mi caso</b> . <br><br>  Por ejemplo, los clientes intentan <i>conectar un sistema de archivos remoto a su PC</i> .  Se esfuerzan mucho por abstraer los sistemas de archivos remotos, haci√©ndolos parecer locales.  Como regla, implementan sincronizaci√≥n bidireccional, asignaci√≥n autom√°tica de tipos de archivos remotos a tipos de archivos de Linux, etc. <br><br>  No necesito este nivel de abstracci√≥n.  Se necesita algo simple para realizar copias de seguridad constantemente en la nube mientras escribo.  Adem√°s, las abstracciones dificultan el ajuste y la depuraci√≥n.  Sin mencionar que la mayor√≠a de estos clientes multifuncionales son propietarios. <br><br><h2>  rclone </h2><br>  Encontr√© <code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">rclone</a></code> utilidad <code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">rclone</a></code> e inmediatamente me di cuenta: esto es exactamente lo que estaba buscando.  Un programa simple pero poderoso.  Muy similar a la herramienta <code>rsync</code> , solo para almacenamiento en la nube. <br><br>  Por ejemplo, <code>rclone</code> se encarga de la tolerancia a fallas (verificaci√≥n de integridad), tiene algoritmos de sincronizaci√≥n eficientes, y as√≠ sucesivamente, al tiempo que proporciona una <a href="">interfaz CRUD simple</a> para interactuar con los servicios populares de almacenamiento en la nube, incluidos Amazon S3, Google Drive y Dropbox. <br><br>  El siguiente comando sincroniza el directorio de <code>org</code> remota con el directorio local <code>/home/lpan/org</code> . <br><br><pre> <code class="bash hljs">ORG_DIR=/home/lpan/org REMOTE=dropbox rclone sync <span class="hljs-variable"><span class="hljs-variable">$ORG_DIR</span></span> <span class="hljs-variable"><span class="hljs-variable">$REMOTE</span></span>:org</code> </pre> <br><h2>  entr </h2><br>  La utilidad para ejecutar comandos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">entr</a> usa la API <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">inotify</a> .  Esencialmente, ejecuta comandos al cambiar archivos sin <i>sondear el</i> sistema de archivos. <br><br>  Un caso de uso com√∫n es <i>reconstruir un proyecto si uno de los archivos de origen ha cambiado</i> . <br><br>  <code>entr</code> toma una lista de rutas absolutas desde <code>stdin</code> y luego ejecuta el comando pasado como argumento si alguno de los archivos observados ha cambiado. <br><br><pre> <code class="bash hljs">WORKDIR=/path/to/myproject find <span class="hljs-variable"><span class="hljs-variable">$WORKDIR</span></span> | grep <span class="hljs-string"><span class="hljs-string">"\.cpp$"</span></span> | entr make</code> </pre> <br><h2>  Gui√≥n de l√≠nea √∫nica </h2><br>  Ahora tenemos <code>rclone</code> y <code>rclone</code> .  El gui√≥n resultante es muy simple.  Perm√≠tame recordarle que mi caso de uso para Dropbox es muy simple: solo necesita replicar constantemente los archivos Org locales cuando cambian.  Por lo tanto, puede usar <code>entr</code> para monitorear archivos y <code>rclone</code> para "sincronizar" con el almacenamiento remoto. <br><br>  El script resultante ( <code>/home/lpan/sync_dropbox.sh</code> ) es el siguiente: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash ORG_DIR=/home/lpan/org REMOTE=dropbox find $ORG_DIR | entr -r rclone sync -v $ORG_DIR $REMOTE:org</span></span></code> </pre> <br><h2>  Ejecuta el demonio </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Un demonio</a> es solo un programa de computadora que se ejecuta en segundo plano.  Hacemos que nuestro script sea un proceso en segundo plano para que sincronice constantemente los cambios de archivos locales en segundo plano con el sistema de archivos remoto. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">systemd</a> proporciona una interfaz para controlar los procesos de daemon. <br><br>  <code>~/.config/systemd/user/dropbox.service</code> <i>servicio de Dropbox</i> en <code>~/.config/systemd/user/dropbox.service</code> . <br><br><pre> <code class="bash hljs">[Unit] Description=Dropbox Daemon [Service] ExecStart=/home/lpan/sync_dropbox.sh Restart=always [Install] WantedBy=default.target</code> </pre> <br>  Luego puedes controlar el demonio usando los siguientes comandos: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># reload the service file systemctl --user daemon-reload # start the daemon systemctl --user start dropbox.service # start the daemon on login systemctl --user enable dropbox.service # inspect the status of the daemon systemctl --user status dropbox.service</span></span></code> </pre> <br><h2>  Conclusi√≥n </h2><br>  En este art√≠culo, discutimos c√≥mo aplicar la filosof√≠a UNIX y utilizar un conjunto de herramientas gratuitas de c√≥digo abierto para reemplazar el cliente de Dropbox propietario y heredado.  Utilizamos <code>rclone</code> y <code>rclone</code> .  Tambi√©n mostr√© c√≥mo hacer que este proceso sea un demonio y administrarlo con <code>systemd</code> . <br><br>  Quiero recordarles que la idea clave es la simplicidad.  Queremos soluciones simples para tareas simples.  Mi caso de uso para Dropbox es muy simple.  Y es por eso que un script de una l√≠nea es mejor que usar un cliente en la nube excesivamente funcional y patentado. <br><br>  Muchas gracias por leer!  Realmente espero que disfrutes esta publicaci√≥n.  Si conoce la mejor manera de hacer lo mismo o extender el script para otro caso de uso, ¬°h√°gamelo saber en los comentarios! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es434460/">https://habr.com/ru/post/es434460/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es434446/index.html">¬øPor qu√© no me gusta ir?</a></li>
<li><a href="../es434448/index.html">Cubrimos pruebas A / B con pruebas de IU. C√≥mo no confundirse en c√≥digo nativo</a></li>
<li><a href="../es434450/index.html">TeamLead Conf: "MBA digital no es camarada"</a></li>
<li><a href="../es434452/index.html">AXIS vs IDIS: la batalla de los fabricantes de videovigilancia</a></li>
<li><a href="../es434456/index.html">¬øD√≥nde conseguimos la botella?</a></li>
<li><a href="../es434466/index.html">¬øQu√© determina el costo de un vuelo en la pr√°ctica?</a></li>
<li><a href="../es434468/index.html">Guardar contenido Biblioteca de contenido de vCenter</a></li>
<li><a href="../es434470/index.html">Controlador de cebolla. Rompemos las pantallas en partes</a></li>
<li><a href="../es434474/index.html">Gato verde sobre contenido espacial</a></li>
<li><a href="../es434476/index.html">ChatOps en GitLab estar√° disponible para todos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>