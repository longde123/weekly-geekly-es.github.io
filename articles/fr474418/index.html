<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêê ü•á üë®üèΩ‚Äçüç≥ Conf√©rence DEFCON 27. B√©n√©ficier des produits de piratage pour macOS. Partie 1 üèéÔ∏è ‚òπÔ∏è üë®‚Äçüë®‚Äçüë¶‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Discours d'information . Chaque fois qu'un nouvel √©chantillon de malware pour macOS est d√©couvert, il nous donne l'opportunit√© d'√©valuer de nouvelles ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conf√©rence DEFCON 27. B√©n√©ficier des produits de piratage pour macOS. Partie 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/474418/"><blockquote> <sup><b>Discours d'information</b> .</sup>  <sup>Chaque fois qu'un nouvel √©chantillon de malware pour macOS est d√©couvert, il nous donne l'opportunit√© d'√©valuer de nouvelles opportunit√©s de piratage que nous pouvons utiliser pour notre propre b√©n√©fice.</sup>  <sup>Je veux dire, la vie est courte, pourquoi la consacrer √† l'√©criture de votre propre malware?</sup> <sup><br><br></sup>  <sup>Nous commen√ßons cette discussion par une m√©thodologie d'adaptation √† l '¬´utilisation personnelle¬ª des logiciels malveillants existants, en soulignant √† la fois les inconv√©nients et les avantages de cette approche.</sup>  <sup>Ensuite, nous passerons en revue l'armement de divers √©chantillons de logiciels malveillants pour macOS, y compris une porte d√©rob√©e interactive, un implant pour l'exfiltration de fichiers, des ransomwares et oui, m√™me des adwares.</sup>  <sup>Nos param√®tres incluent diverses modifications binaires du runtime qui obligent ces programmes malveillants √† accepter des t√¢ches de nos propres serveurs C&amp;C et / ou √† effectuer automatiquement des actions en notre nom.</sup> <sup><br><br><img src="https://habrastorage.org/webt/tv/rl/4e/tvrl4ea4ei1bog3dekukhvmico8.jpeg"><br><br></sup>  <sup>Bien s√ªr, maintenant dans leur √©tat vierge, ces √©chantillons sont d√©tect√©s par des produits antivirus.</sup>  <sup>Par cons√©quent, nous envisagerons des modifications qui garantiront l'invisibilit√© de nos outils de ¬´piratage¬ª pour les programmes antivirus traditionnels.</sup> <sup><br><br></sup>  <sup>En conclusion, nous examinons de nouvelles m√©thodes heuristiques qui peuvent toujours d√©tecter de telles menaces afin de prot√©ger les utilisateurs de Mac m√™me contre de telles menaces modifi√©es.</sup>  <sup>Pourquoi est-ce n√©cessaire?</sup>  <sup>Parce que c'est un cycle normal de d√©veloppement humain, et nous ne r√©alisons tout simplement pas que la destruction que nous voyons signifie l'introduction de nouvelles technologies qui, avant de cr√©er de nouveaux emplois, d√©truisent les anciennes.</sup> </blockquote><a name="habracut"></a>  Salutations √† tous, nous discuterons aujourd'hui du th√®me de la cr√©ation d '"armes de destruction massive" bas√©es sur les produits de piratage macOS.  Je m'appelle Patrick, je suis analyste Synack chez Digital Security, et je suis √©galement le cr√©ateur du site Web de s√©curit√© Mac et de la suite de s√©curit√© gratuite Objective-See pour macOS. <br><br>  Nous parlerons de la refonte des logiciels malveillants d'autres personnes √† leurs propres fins secr√®tes et j'expliquerai pourquoi c'est une excellente id√©e.  Ensuite, je montrerai comment exactement divers √©chantillons de logiciels malveillants pour Mac sont refaits, et puisque nous voulons que nos exploits restent invisibles √† la fois pour les services antivirus int√©gr√©s d'Apple et les logiciels antivirus tiers.  En fin de compte, nous examinerons diverses techniques courantes pour d√©tecter ce produit logiciel refait, car en fait, notre objectif ultime est de nous assurer que les utilisateurs de Mac sont prot√©g√©s contre de telles menaces. <br><br>  Commen√ßons par un sch√©ma qui explique conceptuellement le processus de r√©affectation des logiciels malveillants pour vos propres besoins. <br><br><img src="https://habrastorage.org/webt/ar/0h/qq/ar0hqqjxnmmdzvxhgdyo22--8bc.jpeg"><br><br>  Imaginez que le pirate A a soigneusement d√©velopp√© un malware sophistiqu√© et complet et l'a infect√© avec divers syst√®mes informatiques √† travers le monde.  Hacker B a r√©ussi √† mettre la main sur ce malware par accident ou en l'extrayant d'un syst√®me infect√©.  Ce pirate place un √©chantillon de ce produit dans son laboratoire et reprofile.  Lorsque nous parlons de reprofilage, nous entendons repenser ou reconfigurer certains des logiciels malveillants existants selon vos besoins. <br><br>  La diapositive montre qu'apr√®s la modification, le pirate B peut utiliser ce logiciel contre de nouveaux objectifs, contre une infrastructure diff√©rente de celle pour laquelle il a √©t√© d√©velopp√© par le pirate A. C'est une id√©e assez raisonnable.  Vous pouvez vous demander pourquoi cela est n√©cessaire, mais nous pouvons citer au moins deux raisons pour lesquelles cela vaut la peine. <br><br><img src="https://habrastorage.org/webt/je/92/ar/je92arzrz5ywc4c2ehpl1yijpci.jpeg"><br><br>  Premi√®rement, il existe des organisations bien financ√©es, des groupes tr√®s motiv√©s et arm√©s techniquement, des pirates informatiques travaillant pour des agences gouvernementales telles que la CIA et des laboratoires scientifiques entiers d√©veloppant des logiciels incroyablement malveillants.  De plus, ce logiciel complet a √©t√© test√© √† plusieurs reprises sur le terrain. <br><br>  Comme je suis assez paresseux, et au lieu de coder, je pr√©f√®re me vautrer sur la plage, faire du surf ou du yoga, je pensais: puisque ces gars-l√† cr√©ent un logiciel de piratage si efficace, pourquoi ne pas l'utiliser et le refaire √† vos besoins?  Que ceux qui ont plus de temps et d'argent fassent tout le travail dur pour moi. <br><br>  Deuxi√®mement, si quelqu'un trouve nos programmes convertis, leur paternit√© sera toujours attribu√©e aux d√©veloppeurs originaux, et non √† nous, et c'est tr√®s bien.  Vous pouvez demander, "OK, Patrick, si c'est une id√©e tellement cool, pourquoi les gens ne l'ont-ils pas encore fait?"  Je r√©pondrai: "Ils font √ßa!"  Je ne peux pas commenter sp√©cifiquement quoi que ce soit, mais les diapositives qui ont √©t√© rendues publiques montrent que la NSA a utilis√© le reprofilage de logiciels malveillants pour tester les vuln√©rabilit√©s des programmes antivirus populaires.  Le New York Times a rapport√© que les pirates chinois utilisent √©galement une technique similaire. <br><br>  L'utilisation d'un logiciel de piratage refait donne √† ces agences bien nanties un double avantage.  Premi√®rement, ils utilisent des logiciels espions d√©velopp√©s dans d'autres pays contre les objectifs qu'une autre agence, un autre pays ou un groupe APT de cyberespionnage travaille d√©j√† avec peu de risques.  Par exemple, si vous travaillez dans la NSA et que vous allez pirater un objet que d'autres pirates font d√©j√†, mais que vous ne voulez pas y injecter votre propre code, vous pouvez utiliser en toute s√©curit√© un logiciel tiers refait.  Dans le m√™me temps, votre activit√© restera secr√®te, car il y a d√©j√† ceux qui en sont soup√ßonn√©s en premier lieu. <br><br><img src="https://habrastorage.org/webt/yi/v2/go/yiv2golydkeg9sy7da-izvcobzq.jpeg"><br><br>  √âtant donn√© que ces agences pr√©f√®rent travailler en secret, elles ne sont pas int√©ress√©es √† ce que quiconque s'informe de leur participation √† ces questions, et les logiciels refaits y contribuent.  Bien s√ªr, des probl√®mes surviennent avec la modification des programmes de piratage, dont nous parlerons aujourd'hui. <br><br><img src="https://habrastorage.org/webt/bi/81/en/bi81enenfuz14twl3sjbqwh2qwe.jpeg"><br><br>  Mais nous verrons que ces probl√®mes ne sont pas insurmontables.  Supposons que nous ayons repris un morceau du malware de quelqu'un d'autre pour le refaire.  Premi√®rement, nous n'avons pas de code source, il n'y a qu'un √©chantillon de code binaire, nous devrons donc utiliser l'ing√©nierie inverse.  J'appelle cela l'√©tape d'analyse lorsque nous essayons de comprendre ce que fait ce logiciel, comment il est mis en ≈ìuvre, comment il est install√©, quelles capacit√©s il poss√®de et, bien s√ªr, nous d√©couvrons avec quel serveur C&amp;C il communique. <br><br>  Apr√®s avoir trait√© tout cela, la deuxi√®me √©tape commence - d√©terminer comment vous pouvez corriger ce malware.  Comme nous n'avons pas de source, nous d√©veloppons un patch au niveau binaire. <br><br>  √âtant donn√© que ce logiciel interagit dans la plupart des cas avec son propre serveur C&amp;C, nous d√©couvrons comment il d√©couvre o√π obtenir l'adresse de ce serveur et quel protocole est utilis√© pour l'√©change de donn√©es.  Ce n'est qu'apr√®s cela que vous pouvez cr√©er votre propre serveur C&amp;C, sur lequel le logiciel refait sera d√©ploy√©, afin d'interagir avec le nouveau syst√®me infect√© √† partir de l√†. <br><br>  √âtant donn√© que nous utilisons des logiciels malveillants bien connus, Apple ou d'autres syst√®mes de s√©curit√© antivirus ont tr√®s probablement des signatures de cette menace.  Par cons√©quent, au stade final du reprofilage, nous devons trouver un moyen d'emp√™cher la d√©tection des logiciels refaits. <br><br>  Le reprofilage doit √™tre abord√© de mani√®re tr√®s responsable si nous ne voulons pas que de tr√®s mauvaises choses se produisent. <br><br><img src="https://habrastorage.org/webt/dw/pm/vf/dwpmvfoigcizeeajk4o828oppo4.jpeg"><br><br>  Permettez-moi de vous donner un exemple de la fa√ßon dont nous avons essay√© de refaire un logiciel malveillant pour macOS.  Pendant le processus de mise √† jour, nous avons oubli√© de changer l'adresse de sauvegarde sur le serveur pirate C&amp;C.  Nous √©tions s√ªrs que nous utilisions une partie enti√®rement refaite des logiciels malveillants, mais √† un moment donn√©, nous avons envoy√© une sauvegarde au serveur pirate d'origine, lui donnant acc√®s √† l'infrastructure que nous attaquions.  Par cons√©quent, la modification du logiciel d'autres personnes doit √™tre abord√©e avec beaucoup de prudence. <br><br>  Parlons maintenant sp√©cifiquement de la refonte de logiciels malveillants pour Mac, dont le but est de cr√©er le logiciel de piratage de quelqu'un d'autre. <br><br><img src="https://habrastorage.org/webt/8p/av/zi/8pavzimr-jwncqt12sypeb-vbeg.jpeg"><br><br>  La premi√®re √©tape consiste √† s√©lectionner un √©chantillon de malware pour la conversion en fonction de 2 crit√®res.  La premi√®re consiste √† d√©terminer que ce logiciel malveillant devrait vous donner une id√©e de si vous avez besoin d'une porte d√©rob√©e interactive, ou d'un crypto-mineur, etc. <br><br><img src="https://habrastorage.org/webt/oq/ko/r0/oqkor0zgt6egkpgqcg0heexqbx4.jpeg"><br><br>  L'attribution des logiciels espions est peut-√™tre importante pour vous - qu'elle soit attribu√©e √† la CIA ou aux pirates russes.  Chez objective-see.com, nous avons rassembl√© une impressionnante collection de logiciels malveillants pour macOS.  Tous les exemples de logiciels refaits dont nous parlerons aujourd'hui peuvent √™tre t√©l√©charg√©s √† partir de ce site. <br><br>  Une fois que vous avez s√©lectionn√© un √©chantillon √† modifier, le moment de l'analyse arrive.  Son objectif principal est de d√©couvrir des choses comme l'acc√®s √† distance.  Si un logiciel malveillant acc√®de √† un serveur C&amp;C distant, vous devez savoir de quel type de serveur il s'agit et s'il est possible de modifier le logiciel afin qu'il ne puisse plus nous contacter. <br><br><img src="https://habrastorage.org/webt/el/19/oz/el19ozfoidikywbelmn87bjzbao.jpeg"><br><br>  Si le malware ne communique pas avec le serveur distant, nous devons encore traiter le protocole afin de savoir comment d√©concerter ce programme lorsqu'il se connecte √† nouveau.  Et bien s√ªr, vous devez bien comprendre les capacit√©s de ce logiciel malveillant - comment il fonctionne, comment il interagit avec le syst√®me, y compris √† distance, afin de savoir quelles commandes vous pouvez utiliser pour contr√¥ler √† distance les logiciels malveillants. <br><br>  D√®s que vous avez tout compris, il est temps de reconfigurer ou de reprofiler.  Cela signifie g√©n√©ralement que vous devez corriger les logiciels malveillants au niveau binaire. <br><br><img src="https://habrastorage.org/webt/op/2b/am/op2bamloaosdoqg6wkhjbv-sik0.jpeg"><br><br>  Cette diapositive montre que nous avons trouv√© l'adresse du serveur C&amp;C d'origine incorpor√©e dans le code et que nous pouvons la remplacer par l'adresse dont nous avons besoin dans l'√©diteur HEX.  Cela signifie qu'apr√®s la modification, ce logiciel pourra communiquer avec notre propre serveur et en recevoir des t√¢ches. <br><br>  Comme je l'ai dit, si le malware est une porte d√©rob√©e ou un implant et est contr√¥l√© √† partir du serveur C&amp;C d'origine, nous devrons √©crire notre propre serveur de gestion et nous assurer que le programme est connect√© et connect√© afin que nous puissions utiliser toutes ses capacit√©s √† distance. <br><br><img src="https://habrastorage.org/webt/kf/i9/cn/kfi9cnlonrkb7gwzsdwrtprreta.jpeg"><br><br>  Un serveur C&amp;C personnalis√© ne devrait pas √™tre trop compliqu√©, il suffit d'√©crire un script Python comp√©tent, mais si vous pr√©voyez d'utiliser votre logiciel contre de nombreux objectifs, vous aurez peut-√™tre besoin de quelque chose de plus s√©rieux.  Le DefCon pr√©c√©dent a expliqu√© comment cr√©er l'un de ces serveurs C&amp;C pour analyser des √©chantillons de logiciels.  Il est probable que chacun des √©chantillons que vous analyserez sera diff√©rent des autres en utilisant un protocole diff√©rent, par cons√©quent, vous aurez besoin d'un serveur C&amp;C distinct pour chacun des √©chantillons du logiciel converti. <br><br><h3>  Refaire la porte d√©rob√©e de FruitFly </h3><br>  Examinons un v√©ritable √©chantillon de refonte de logiciels malveillants pour Mac.  Cr√©√©e il y a environ 15 ans par les experts de la s√©curit√© Mac, cette porte d√©rob√©e s'appelle FruitFly ou Fruit Fly. <br><br>  Cette porte d√©rob√©e compl√®te prenant en charge le multit√¢che √† distance nous a servi de candidat id√©al pour le reprofilage.  Il a la capacit√© d'infecter des fichiers et des processus syst√®me, de contr√¥ler une webcam, une ligne de commande, sert d'enregistreur de frappe, peut prendre √† distance des captures d'√©cran du bureau de la victime et collecter des informations sur les ordinateurs infect√©s ex√©cutant macOS.  Nous avions l'intention d'utiliser toutes ces fonctions pour r√©soudre nos propres probl√®mes. <br><br><img src="https://habrastorage.org/webt/q2/ig/bv/q2igbv8bxidoucqh398afrut0w4.jpeg"><br><br>  La porte d√©rob√©e FruitFly √©tait un script Perl tr√®s d√©routant, mais si vous l'examinez attentivement, vous pouvez voir que sa logique traite les arguments de la ligne de commande.  Nous pouvons dire que ce script v√©rifie si certaines options ou indicateurs de ligne de commande le font faire quoi que ce soit. <br><br><img src="https://habrastorage.org/webt/m_/jc/ho/m_jchouqkbuxw5dh0zi7rafbayg.jpeg"><br><br>  Il s'av√®re qu'il recherche un port ou une combinaison de ports pour connecter votre ordinateur √† son serveur C&amp;C.  Cela signifie que si nous pouvons cr√©er une direction vers notre propre serveur via la ligne de commande, nous n'aurons pas besoin de refaire le script Perl d'origine ou un binaire malveillant. <br><br>  Nous avons commenc√© √† d√©terminer s'il √©tait possible d'enregistrer ce script FruitFly en tant que lanceur.  Comme le montre la diapositive, nous pouvons y incorporer l'adresse de notre propre serveur C&amp;C.  Cela signifie que nous pouvons facilement re-profiler cette porte d√©rob√©e pour nous connecter √† notre serveur, en contournant la connexion avec le serveur pirate d'origine. <br><br><img src="https://habrastorage.org/webt/8k/9k/hc/8k9khcoxopqticqaojsmrgwdhig.jpeg"><br><br>  Cependant, pour utiliser cette porte d√©rob√©e, elle doit √™tre install√©e sur l'ordinateur de l'utilisateur.  La bonne nouvelle est que j'ai d√©j√† √©crit un tel programme d'installation, qui est disponible sur pastebin.com.  Ce sont quelques lignes de code qui installent les logiciels malveillants exactement de la m√™me mani√®re que la porte d√©rob√©e d'origine.  √âtant donn√© que j'ai √©galement pr√©c√©demment √©crit un serveur C&amp;C pour analyser cet √©chantillon, nous pouvons commencer √† d√©montrer son fonctionnement. <br><br>  Les d√©monstrations en temps r√©el comme celle-ci sont toujours un risque, donc je vais ex√©cuter ce malware sur mon propre ordinateur portable de recherche, pas sur une machine virtuelle.  Je r√©p√®te - j'ai l'intention de vous montrer toute la puissance du malware converti, et la d√©monstration en conditions r√©elles est plus cr√©dible, alors regardons ce logiciel en action sur un vrai mat√©riel. <br><br>  La premi√®re chose √† faire est de d√©marrer le serveur C&amp;C.  Vous voyez que maintenant le syst√®me attend une connexion avec lui.  Ensuite, vous devez ex√©cuter un logiciel malveillant via le programme d'installation, en lui transmettant l'adresse IP de ce serveur.  Apr√®s le d√©marrage, nous voyons sur le c√¥t√© droit de la fen√™tre que les logiciels malveillants se sont correctement connect√©s √† notre serveur C&amp;C.  Nous voyons √©galement tout un tas de t√¢ches de piratage que ce logiciel malveillant peut utiliser contre les processus en cours d'ex√©cution sur mon ordinateur portable personnel. <br><br><img src="https://habrastorage.org/webt/vl/n0/lw/vln0lwtlwelhpdr3y1v8zfasxkk.jpeg"><br><br>  L'ex√©cution de la commande # 13 montre o√π ce malware est install√© dans le r√©pertoire / Users / Patrick / fpsaud.  En utilisant la commande n ¬∞ 2, vous pouvez prendre une capture d'√©cran et en utilisant le param√®tre 0, vous pouvez prendre une capture d'√©cran en plein √©cran. <br><br><img src="https://habrastorage.org/webt/mp/pc/3b/mppc3blujqwwj7mbaey7s33fvpg.jpeg"><br><br>  Je vais maintenant essayer de prendre une capture d'√©cran et de l'envoyer √† notre serveur C&amp;C.  Comme vous pouvez le voir, tout fonctionne comme il se doit.  C'est ainsi que fonctionne la porte d√©rob√©e FruitFly repens√©e. <br><br><h3>  Alt√©ration du mineur CreativeUpdate </h3><br>  Ensuite, nous parlerons de la refonte du mineur de crypto-monnaie CreativeUpdate pour nos besoins.  Il est utile si vous souhaitez utiliser les ordinateurs d'autres personnes pour le cryptage, mais que vous n'avez pas en m√™me temps le temps, les comp√©tences et les ressources. <br><br><img src="https://habrastorage.org/webt/jg/wu/lp/jgwulpzh_d6c6qfz2fg597-cdrw.jpeg"><br><br>  Ce mineur cryptographique s'int√®gre aux chevaux de Troie et est distribu√© via des applications tierces populaires de MacUpdate.com.  La diapositive montre un exemple d'installation du navigateur Firefox Quantum, qui n'a pas la signature du d√©veloppeur Mozila d'origine et t√©l√©charge un crypto mineur depuis l'un des serveurs Adobe Creative Cloud sur l'ordinateur de l'utilisateur. <br><br><img src="https://habrastorage.org/webt/9a/ru/an/9aruanbz7pv85jg0irp7mgfjzb0.jpeg"><br><br>  Si nous montons une image disque infect√©e contenant un tel cheval de Troie et appliquons la r√©tro-ing√©nierie au binaire principal, nous constaterons qu'il utilise une m√©thode appel√©e ¬´ex√©cuter le script avec des impressions¬ª - ¬´ex√©cuter le script avec des impressions¬ª.  Si vous regardez ce qu'il fait avec un d√©compilateur ou un d√©sassembleur, vous pouvez voir qu'il ex√©cute simplement un fichier appel√© ¬´script¬ª en dehors du r√©pertoire de ressources de l'application.  Tout d'abord, il lance un cheval de Troie sous couvert d'une copie d'un produit populaire que l'utilisateur a t√©l√©charg√© sur son ordinateur, par exemple le navigateur Firefox, pour qu'il ne soup√ßonne rien de mal. <br><br><img src="https://habrastorage.org/webt/yr/ie/2e/yrie2eidsplxe3up0v9cb5nyy9o.jpeg"><br><br>  Ensuite, nous voyons dans ce script qu'il communique avec le serveur attaquant, d'o√π il t√©l√©charge l'archive mdworker.zip.  Pendant le d√©ballage, cette archive installe quelque chose appel√© mdworker sur le syst√®me.  Si vous regardez le fichier MacOS.plist extrait de l'archive, vous pouvez voir qu'il enregistre ce binaire mdworker tr√®s malveillant sur l'ordinateur de l'utilisateur. <br><br><img src="https://habrastorage.org/webt/rx/i6/uq/rxi6uqgxuqtjbqcq5inuwtjuzag.jpeg"><br><br>  Nous voyons √©galement des arguments de ligne de commande qui sont pass√©s √† ce binaire.  Si vous ex√©cutez ce fichier mdworker binaire, vous pouvez voir qu'il s'agit d'un mineur de crypto-monnaie enti√®rement l√©gal appartenant √† la soci√©t√© mini√®re Miner Gate. <br><br>  Les arguments de la ligne de commande indiquent √©galement le compte du mineur auquel les r√©sultats de l'extraction et le type de crypto-monnaie pour l'extraction seront envoy√©s. <br><br>  √âtant donn√© que les param√®tres correspondants sont transmis via la ligne de commande et ne sont pas int√©gr√©s dans un fichier binaire, nous pouvons, comme dans le cas de Fruit Fly, substituer des arguments de ligne de commande pour r√©utiliser ce malware √† nos fins.  Par cons√©quent, nous modifions d'abord le fichier de la liste des propri√©t√©s de la liste des propri√©t√©s, ou .plist du logiciel malveillant afin qu'il pointe vers notre propre compte de mineur, puis emballons √† nouveau tous les composants du logiciel malveillant dans l'archive.  De plus, au lieu de t√©l√©charger l'archive √† partir du serveur, nous l'ajoutons simplement √† l'application malveillante.  C'est beaucoup plus simple et plus autonome, car nous n'avons pas besoin de configurer un serveur distant pour d√©marrer. <br><br>  Ensuite, nous reconfigurons le script pour qu'il fonctionne avec l'archive que nous avons ajout√©e.  Enfin, nous reconditionnons tout dans une image Firefox.dmg et nous pouvons commencer √† travailler. <br><br><img src="https://habrastorage.org/webt/xb/hl/c7/xbhlc73ts2ofwqfcdl0--pjifw4.jpeg"><br><br>  J'attire votre attention sur la deuxi√®me d√©mo.  Dans la fen√™tre du fichier, vous voyez les composants de l'application, y compris un script malveillant, l'archive mdworker.zip, le fichier de param√®tres d'application AppSettings.plist et le navigateur Firefox d'origine. <br><br><img src="https://habrastorage.org/webt/qc/y9/0q/qcy90qwhi2c_htghgujrjbhlxog.jpeg"><br><br>  Dans la fen√™tre principale, nous voyons √† quoi ressemble le contenu t√©l√©charg√© par l'utilisateur qu'il est sur le point de lancer. <br><br><img src="https://habrastorage.org/webt/si/6-/qi/si6-qizmthmtmeipzrludaaxjne.jpeg"><br><br>  J'ex√©cute cette application sur mon ordinateur portable afin de l'utiliser pour mon propre minage de crypto-monnaie.  Je clique sur l'ic√¥ne du navigateur, la fen√™tre du navigateur Firefox appara√Æt √† l'√©cran et ext√©rieurement tout va bien. <br><br>  Pour voir ce qui se passe r√©ellement sur le syst√®me apr√®s le d√©marrage de cette application, j'appelle la fen√™tre du terminal macOS √† l'√©cran.  ,         mdworker,    ,          patrick@objective-see.com. <br><br><h3> - ransomware </h3><br>      ,    , ,     - ransomware,       . <br><br><img src="https://habrastorage.org/webt/7t/wn/rv/7twnrvk1wk853o2hvg_my32qkbm.jpeg"><br><br>     ,    KeRanger.    ,       macOS.           Bit-Torrent,    -.    ,   ,     . <br><br>    ,        General.rtf.     ,    ,    macOS.       ,      C&amp;C-        . <br><br><img src="https://habrastorage.org/webt/mi/eo/6i/mieo6iymxpoxcg116xarhs3izgg.jpeg"><br><br>         ,    ,    ,  ¬´¬ª  .    -. <br><br>      . -,      ,          . <br><br><img src="https://habrastorage.org/webt/u6/ng/bt/u6ngbtuxi7brtza2nfjpth_l2zu.jpeg"><br><br>    ,       ,        HEX-  ,   ¬´¬ª,       C&amp;C-,      127.0.0.1.     RSA    ,     RSA-         ,              NetCat. <br><br>     .   ,  ,    KeRanger. NetCat     ,      . <br><br><img src="https://habrastorage.org/webt/an/fz/el/anfzelfpla0mab3nqouakkukl_w.jpeg"><br><br>     ,             . <br><br><img src="https://habrastorage.org/webt/90/4c/nt/904cntgxcyw4fcvfxx1wogob-la.jpeg"><br><br>               README_FOR_DECRIPT.txt.    ,    : ¬´      wardle@objective-see.com!¬ª. <br><br><img src="https://habrastorage.org/webt/at/rf/ag/atrfagcuscbsrisiysy4atpxbhe.jpeg"><br><br><h3>  Windtall </h3><br>       Windtall.   ,     ,     APT-.      ,       . <br><br><img src="https://habrastorage.org/webt/sk/ub/66/skub66ctvfoeenocme7-j8b0eea.jpeg"><br><br>          malware.            macOS,  ,  URL-. <br><br>         ,        .         ,   ,    , macOS       Custom URL,    ,    . <br><br>        ,  , ,  -   URL,  macOS   . <br><br>     Java     .    ,     URL,     Mac.     Java-,        URL,     . <br>   ,  ,       ,     ,       . <br><br><img src="https://habrastorage.org/webt/kw/-s/kf/kw-skfacnumohxmrjnbo_jkz9po.jpeg"><br><br>   ,   ,      . ,  ,         ,         ,          C&amp;C-      . <br><br>      .          SPF, ,       C&amp;C-,         , ,         C&amp;C-. <br><br><img src="https://habrastorage.org/webt/-q/ig/vd/-qigvdzvffym3nebnatyn_zvtek.jpeg"><br><br>  24h00 <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> DEFCON 27.       macOS.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2e partie</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/InL3YA_6P6s" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Un peu de publicit√© :) </h3><br>  Merci de rester avec nous.  Aimez-vous nos articles?  Vous voulez voir des mat√©riaux plus int√©ressants?  Soutenez-nous en passant une commande ou en recommandant √† vos amis, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cloud VPS pour les d√©veloppeurs √† partir de 4,99 $</a> , une <b>r√©duction de 30% pour les utilisateurs Habr sur un analogue unique de serveurs d'entr√©e de gamme que nous avons invent√© pour vous:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">toute la v√©rit√© sur VPS (KVM) E5-2650 v4 (6 C≈ìurs) 10 Go DDR4 240 Go SSD 1 Gbps √† partir de 20 $ ou comment partager un serveur?</a>  (les options sont disponibles avec RAID1 et RAID10, jusqu'√† 24 c≈ìurs et jusqu'√† 40 Go de DDR4). <br><br>  <b>Dell R730xd 2 fois moins cher?</b>  Nous avons seulement <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV √† partir de 199 $</a> aux Pays-Bas!</b>  <b><b>Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - √† partir de 99 $!</b></b>  Pour en savoir plus sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cr√©ation d'un b√¢timent d'infrastructure.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">classe utilisant des serveurs Dell R730xd E5-2650 v4 co√ªtant 9 000 euros pour un sou?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr474418/">https://habr.com/ru/post/fr474418/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr474402/index.html">Guide de l'API Vavr Collections</a></li>
<li><a href="../fr474404/index.html">Analyse des probl√®mes r√©solus du championnat de programmation de Yandex (d√©veloppement front-end) 2019</a></li>
<li><a href="../fr474406/index.html">La premi√®re apparition de BlueKeep √† l'√©tat sauvage enregistr√©e</a></li>
<li><a href="../fr474408/index.html">R√©volution ou √©volution du mod√®le objet page?</a></li>
<li><a href="../fr474414/index.html">Nous √©crivons notre propre moteur voxel</a></li>
<li><a href="../fr474420/index.html">Formation du thermostat: comment c'est arriv√©</a></li>
<li><a href="../fr474422/index.html">Des plateformes open source passionnantes pour le d√©veloppement d'applications mobiles</a></li>
<li><a href="../fr474424/index.html">Formation mixte - qu'est-ce que c'est et comment √ßa marche</a></li>
<li><a href="../fr474426/index.html">La s√©rie anim√©e "Cercle math√©matique"</a></li>
<li><a href="../fr474430/index.html">DevOpsDays Moscou - une conf√©rence que la communaut√© organise pour la communaut√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>