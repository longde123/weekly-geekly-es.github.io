<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🤝‍👨🏿 👥 👷🏻 猫头鹰和全球问题：连接具有相同名称空间和类名称的两个程序集 🏴 🔛 👊🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今晚， gelas开始了有关程序包管理器如何在不同平台上工作的对话。 在对话过程中，我们讨论了一种情况，当您需要将两个库连接到.NET Core项目时，这些库包含相同名称空间中的相同名称的类。 由于我做了很多.NET Core，因此我想检查一下如何解决此问题。 进一步说明 


 免责声明 。 这种...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>猫头鹰和全球问题：连接具有相同名称空间和类名称的两个程序集</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421851/"><p><img src="https://habrastorage.org/webt/3e/8e/s7/3e8es7uiiyc_xknridquachmpak.png"></p><br><p>  <em>今晚， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">gelas</a>开始了有关程序包管理器如何在不同平台上工作的对话。</em>  <em>在对话过程中，我们讨论了一种情况，当您需要将两个库连接到.NET Core项目时，这些库包含相同名称空间中的相同名称的类。</em>  <em>由于我做了很多.NET Core，因此我想检查一下如何解决此问题。</em>  <em>进一步说明</em> </p><a name="habracut"></a><br><p>  <strong>免责声明</strong> 。 这种情况经常发生吗？ 使用.NET十多年来，我从未在实际项目中处理过类似情况。 但是实验很有趣。 </p><br><p> 为了以防万一，我将澄清我将使用以下方法进行实验： </p><br><ul><li>  macOS 10.13， </li><li>  .NET Core SDK 2.1.302 </li><li> 骑士2018.2 </li></ul><br><p> 因此，我们将模拟一个情况，即当我们得到两个具有必须在项目中使用的类的库时。 同时，我们无权访问源代码，但是我们无法反汇编这些程序集以更改它们中的名称空间，因此我们也无法进行反编译。 </p><br><h4 id="podgotovka-eksperimenta"> 实验准备 </h4><br><p> 因此，对于初学者，请准备一头猫头鹰和两个地球仪。 猫头鹰，我们将有一个针对netcoreapp2.1的项目。 我们将创建两个作为Globe的项目，其中一个也将针对netcoreapp2.1，第二个将针对netstandard2.0 </p><br><p><img src="https://habrastorage.org/webt/bs/hz/zz/bshzzzux7fsi_lkytbemm-p7rya.png"></p><br><p> 在每个项目中，我们放置Globe类，它们将在相同的名称空间中，但是它们将具有不同的实现： </p><br><p> 第一个档案： </p><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Space</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Globe</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetColor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"Green"</span></span>; } }</code> </pre> <br><p> 第二档： </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Space</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Globe</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetColor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"Blue"</span></span>; } }</code> </pre> <br><h3 id="popytka-nomer-odin"> 尝试第一 </h3><br><p> 由于根据问题的情况，我们应该使用外部程序集而不是项目，因此我们将相应地添加到项目的链接，就好像它们实际上只是库一样。 为此，首先编译所有项目，以便我们拥有所需的Globe1.dll和Globe2.dll。 然后在项目中添加指向它们的链接，如下所示： </p><br><p><img src="https://habrastorage.org/webt/oc/xx/fz/ocxxfzvbq9-5alrr1lsumpm_ipy.png"></p><br><p> 现在尝试创建一个Globe类变量： </p><br><p><img src="https://habrastorage.org/webt/ei/e0/tq/eie0tqbpu2tt228xv1y0zpuwn0a.png"></p><br><p> 如您所见，IDE已经在现阶段警告我们，在理解应从何处获取我们需要的Globe类时存在问题。 </p><br><p> 乍一看，这种情况很典型，应该已经有现成的，用花岗岩浇铸的，可以应对烟囱溢出的产品。 事实证明，尚未为.NET Core提出针对<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此问题的</a>解决方案。 还是我的Google让我失望了。 但是我设法在Stack Overflow上找到了一些有用的东西，我设法在Google上找到的唯一明智的出版物是在2006年，并且描述了经典版本.NET的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">类似情况</a> 。 在这种情况下， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在NuGet项目</a>的存储库<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">中</a>讨论了非常类似的问题。 </p><br><p> 到目前为止，还没有很多有用的信息，但是仍然存在： </p><br><ul><li> 在.NET的经典版本中，实现了别名机制 </li><li> 根据规范，C＃ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">支持</a>在代码中<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">使用别名</a> </li></ul><br><p> 仍然需要了解如何在.NET Core中执行此操作。 </p><br><p> 不幸的是， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">当前版本的文档</a>很少谈论连接外部软件包/费用的可能性。 而且， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">csproj文件</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">描述</a>也绝不会说明创建别名的可能性。 但是，通过反复试验，我发现.NET Core中程序集的别名仍受支持。 内容如下： </p><br><pre> <code class="cs hljs">&lt;Project Sdk=<span class="hljs-string"><span class="hljs-string">"Microsoft.NET.Sdk"</span></span>&gt; &lt;PropertyGroup&gt; &lt;OutputType&gt;Exe&lt;/OutputType&gt; &lt;TargetFramework&gt;netcoreapp2<span class="hljs-number"><span class="hljs-number">.1</span></span>&lt;/TargetFramework&gt; &lt;/PropertyGroup&gt; &lt;ItemGroup&gt; &lt;Reference Include=<span class="hljs-string"><span class="hljs-string">"Globe1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"</span></span>&gt; &lt;HintPath&gt;..\Globe1\bin\Debug\netcoreapp2<span class="hljs-number"><span class="hljs-number">.1</span></span>\Globe1.dll&lt;/HintPath&gt; &lt;Aliases&gt;Lib1&lt;/Aliases&gt; &lt;/Reference&gt; &lt;Reference Include=<span class="hljs-string"><span class="hljs-string">"Globe2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"</span></span>&gt; &lt;HintPath&gt;..\Globe2\bin\Debug\netstandard2<span class="hljs-number"><span class="hljs-number">.0</span></span>\Globe2.dll&lt;/HintPath&gt; &lt;Aliases&gt;Lib2&lt;/Aliases&gt; &lt;/Reference&gt; &lt;/ItemGroup&gt; &lt;/Project&gt;</code> </pre> <br><p> 现在剩下的工作是学习如何使用这些别名。 前面提到的<em>extern</em>关键字将帮助我们： </p><br><p> 关于它的文档中写有以下内容： </p><br><blockquote> 在某些情况下，您可能需要引用具有相同完全限定类型名称的程序集的两个版本。 例如，您需要在一个应用程序中使用两个或多个版本的程序集。 使用外部程序集别名，可以将每个程序集的名称空间包含在由该别名命名的根级别名称空间内的包装器中，这使您可以在单个文件中使用它们。 <br>  ... <br> 每个extern别名的声明都会引入一个与全局名称空间匹配（但不在其内部）的根级别的名称空间。 因此，可以使用其全名来创建对每个程序集类型的明确引用，其全名是相应的名称空间别名。 </blockquote><p> 这里的真相是不要忘记，在C＃中也使用extern来声明具有来自非托管代码的外部实现的方法。 在这种情况下，extern通常与DllImport属性一起使用。 您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在文档</a>的相应<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分中</a>阅读有关此内容的更多信息。 </p><br><p> 因此，让我们尝试使用别名： </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">alias</span></span> Lib1; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">alias</span></span> Lib2; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Owl</span></span> { ... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SuperOwl</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Lib1::Space.Globe _firstGlobe; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Lib2::Space.Globe _secondGlobe; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IntegrateGlobe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Lib1::Space.Globe globe</span></span></span><span class="hljs-function">)</span></span> =&gt; _firstGlobe = globe; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IntegrateGlobe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Lib2::Space.Globe globe</span></span></span><span class="hljs-function">)</span></span> =&gt; _secondGlobe = globe; ... } }</code> </pre> <br><p> 该代码甚至已经可以使用。 而且它可以正常工作。 但我仍然想使其更加优雅。 这可以通过非常简单的方式完成： </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">alias</span></span> Lib1; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">alias</span></span> Lib2; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> SpaceOne=Lib1::Space; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> SpaceTwo=Lib2::Space;</code> </pre> <br><p> 现在，您可以使用通常的显而易见的语法： </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> globe1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpaceOne.Globe() <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> globe2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpaceTwo.Globe()</code> </pre> <br><h3 id="ispytaniya"> 测验 </h3><br><p> 让我们测试一下猫头鹰： </p><br><p><img src="https://habrastorage.org/webt/fo/zn/6p/fozn6pcfpbiagorzwxbz0ssruqi.png"></p><br><p> 如您所见，该代码运行良好，没有错误。 猫头鹰和地球仪的集成已成功完成！ </p><br><p>  →示例代码<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在GitHub上可用</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN421851/">https://habr.com/ru/post/zh-CN421851/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN421839/index.html">使用Vavr进行功能性Java编程</a></li>
<li><a href="../zh-CN421841/index.html">Robotaxi Waymo尚未准备好进入公共道路</a></li>
<li><a href="../zh-CN421845/index.html">数据分析师实际上在做什么？ 35次访谈的发现</a></li>
<li><a href="../zh-CN421847/index.html">跳入云端。 在NodeMCU + Azure IoT中心上构建预算IoT解决方案</a></li>
<li><a href="../zh-CN421849/index.html">2018年9月IT人力资源大事记：My Circle Digest</a></li>
<li><a href="../zh-CN421855/index.html">家用投影机：最佳“按版本”，超短焦距，亮度和速度冠军</a></li>
<li><a href="../zh-CN421857/index.html">ToFoIn v 1.在FreeBSD中保留网关并在外部通道之间切换</a></li>
<li><a href="../zh-CN421859/index.html">物联网提供商的说明。 设备和出价</a></li>
<li><a href="../zh-CN421863/index.html">创建纳米管的新方法：现已成色</a></li>
<li><a href="../zh-CN421867/index.html">如何使代码可读</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>