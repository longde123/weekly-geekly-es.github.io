<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è™ üë©üèø‚Äçüåæ üßëüèΩ‚Äçü§ù‚Äçüßëüèª Comment l'√©trange instruction popcount est utilis√©e dans les processeurs modernes üìÉ üõãÔ∏è üßìüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="C'est le pseudo d√©codage de ma pr√©sentation √† !! Con 2019 . 

 La plupart des architectures de processeur utilis√©es aujourd'hui ont des instructions a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment l'√©trange instruction popcount est utilis√©e dans les processeurs modernes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467083/"> <i>C'est le pseudo d√©codage de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ma pr√©sentation √† !! Con 2019</a> .</i> <br><br>  La plupart des architectures de processeur utilis√©es aujourd'hui ont des instructions appel√©es <code>popcount</code> , abr√©viation de ¬´population count¬ª.  Elle fait ce qui suit: compte le nombre de bits d√©finis dans un mot machine.  Par exemple (prenons des mots de 8 bits pour simplifier), <code>popcount(00100110)</code> est 3 et <code>popcount(01100000)</code> est 2. <br><br>  Cela peut vous surprendre √©norm√©ment, tout comme moi, mais c'est tout ce qu'elle fait!  Semble pas tr√®s utile, non? <br><a name="habracut"></a><br>  Je pensais que c'√©tait un ajout r√©cent √† certains cas d'utilisation hypersp√©cialis√©s, mais il est en fait pr√©sent dans les architectures de processeur depuis au moins 1961: <br><br><ul><li>  1961: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">IBM Stretch</a> <br></li><li>  1964: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CDC 6000</a> <br></li><li>  1975: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cray-1</a> <br></li><li>  2005: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SPARC</a> <br></li><li>  2005: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ARM NEON</a> <br></li><li>  2007: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AMD K10</a> <br></li><li>  2008: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Intel Nehalem</a> </li></ul><br>  Alors qu'est-ce qui se passe? <br><h4>  Instruction NSA </h4><br>  <code>popcount</code> √©galement connu comme ¬´l'instruction NSA¬ª, et un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fil tr√®s int√©ressant sur comp.arch</a> discute de son utilisation en cryptographie.  La rumeur veut qu'il ait √©t√© initialement ajout√© au jeu d'instructions CPU √† la demande de la NSA.  Comme indiqu√© dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ce fil de discussion archiv√©</a> : <br><br><blockquote>  C'√©tait presque une tradition d'envoyer un de chaque lot de voitures CDC plus rapides √† un ¬´bon client¬ª - un camion inconnu est arriv√© et n'a plus jamais √©t√© entendu. </blockquote><br>  Une grande l√©gende, mais pourquoi l'ont-ils utilis√©e? <br><br>  Une mesure du contenu est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le poids de Hamming</a> , qui est le nombre de caract√®res non nuls dans une cha√Æne.  Pour une cha√Æne binaire, c'est <code>popcount</code> ! <br><br>  Comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">expliqu√© ici</a> , la NSA a exig√© une cryptanalyse des messages intercept√©s, et puisque le CDC 6000 fonctionnait avec des mots de 60 bits, un mot √©tait suffisant pour stocker la plupart des alphabets qui les int√©ressaient.  Ils ont pu: <br><br><ol><li>  Diviser le message en lignes <br></li><li>  D√©finissez un bit pour chaque caract√®re unique d'une cha√Æne <br></li><li>  Utilisez <code>popcount</code> pour compter le nombre de caract√®res diff√©rents <br></li><li>  Utilisez le compteur comme hachage pour poursuivre la cryptanalyse </li></ol><br>  Curieusement, <code>popcount</code> semble avoir disparu des jeux d'instructions entre le milieu des ann√©es 1970 et le milieu des ann√©es 2000, donc le retour devrait √™tre expliqu√© par autre chose que des applications cryptographiques.  √Ä quoi d'autre peut-il servir? <br><br><h4>  Correction d'un bug </h4><br>  Le concept de poids de Hamming est li√© √† la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">distance de Hamming</a> , qui est le nombre de positions diff√©rentes entre deux lignes de m√™me longueur.  Pour deux cha√Ænes binaires <code>x</code> et <code>y</code> , il s'agit juste d'un <code>popcount</code> apr√®s XOR.  Par exemple: <br><br><pre>  00100110
 01100000 ^
 --------
 01000110<font></font>
<font></font>
 popcount (01000110) = 3 </pre><br>  Dans les applications de t√©l√©communication, cela aide √† calculer la distance du signal, o√π un mot connu est transmis le long du fil et le nombre de bits modifi√©s est compt√© pour estimer l'erreur de transmission. <br><br>  Ensuite, nous pouvons concevoir le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code de correction d'erreur</a> appropri√©.  Par exemple, si une transmission doit supporter jusqu'√† deux bits modifi√©s, les mots de code doivent diff√©rer d'au moins 5 en distance de Hamming. <br><br><h4>  R√©seaux de neurones convolutifs binaires </h4><br>  Et maintenant quelque chose de compl√®tement diff√©rent: les r√©seaux de neurones convolutifs binaires!  Mais d'abord, c'est quoi? <br><br><ul><li>  Binaire signifie que nous n'utilisons que des matrices des valeurs +1 (cod√©es en 1) et -1 (cod√©es en 0), contrairement aux valeurs √† virgule flottante 32 bits. <br></li><li>  La convolution signifie-t-elle une multiplication matricielle? <br></li><li>  Les r√©seaux de neurones sont des syst√®mes inspir√©s du cerveau des animaux (ici je nage un peu). </li></ul><br>  Ainsi, nous devons effectuer la multiplication des matrices binaires.  Mais quelle est la particularit√© des matrices binaires? <br><br>  La multiplication matricielle conventionnelle par des valeurs 32 bits est bien adapt√©e aux ordinateurs de bureau dot√©s de processeurs et de GPU puissants, mais nous souhaitons de plus en plus souvent effectuer des travaux utiles sur de petits appareils simples comme les smartphones, les routeurs, les montres intelligentes, etc. Nous pouvons les d√©composer. des matrices plus complexes pour les couches de matrices binaires, et il est tellement plus facile de travailler avec elles et de les stocker que nous en b√©n√©ficions m√™me malgr√© l'augmentation du nombre de couches. <br><br>  C'est <code>popcount</code> entre en jeu.  Il est utilis√© pour calculer le produit scalaire de deux matrices binaires: <br><br><pre>  a = xnor (x, y)
 b = popcount (a)
 c = len (a)
 point (x, y) = 2 √ó b - c </pre><br>  Voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici pour</a> plus de d√©tails. <br><br><h4>  Programmation d'√©checs </h4><br>  De nombreux programmes d'√©checs stockent des donn√©es dans une repr√©sentation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bitboard</a> , qui s'int√®gre facilement dans un mot 64 bits.  L'op√©ration <code>Population Count</code> √©t√© utilis√©e pour des op√©rations significatives avec cette vue, telles que le calcul de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mobilit√© d'une</a> figure. <br><br><h4>  Empreinte mol√©culaire </h4><br>  Cela est √©galement li√© √† la distance de Hamming: les mol√©cules sont en quelque sorte hach√©es et compar√©es (√† l'aide de <code>popcount</code> ) pour d√©terminer leur similitude.  Voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici pour</a> plus de d√©tails. <br><br><h4>  Essais mapp√©s de tableau de hachage (HAMT) </h4><br>  C'est l√† que j'ai <code>popcount</code> pour la premi√®re <code>popcount</code> !  HAMT est une structure de donn√©es (d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">abord cr√©√©e par Phil Bagwell</a> ) qui peut stocker un tr√®s grand nombre de valeurs (g√©n√©ralement 32 ou 64) dans un tableau sur chaque n≈ìud de trie.  Cependant, l'allocation de m√©moire pour un tableau de 32 ou 64 √©l√©ments peut √™tre incroyablement inutile √† chaque fois, surtout si le tableau ne contient en fait que quelques √©l√©ments.  La solution consiste √† ajouter un masque de bits dans lequel le nombre de bits d√©fini correspond au nombre d'√©l√©ments dans le tableau, ce qui permet au tableau de cro√Ætre et de se contracter selon les besoins.  Le calcul de l'indice pour un √©l√©ment donn√© peut effectivement √™tre effectu√© √† l'aide de <code>popcount</code> .  Dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mon article de blog</a> sur la mise en ≈ìuvre des structures HAMT, vous pouvez en savoir plus sur leur fonctionnement. <br><br><h4>  Structures de donn√©es compress√©es </h4><br>  Il s'agit d'un nouveau domaine de recherche passionnant qui se concentre sur la fa√ßon de stocker des donn√©es dans un espace minimal sans les d√©baller pour effectuer un travail utile.  L'une des m√©thodes consiste √† penser en termes de tableaux de bits (vecteurs de bits) qui peuvent √™tre demand√©s en deux op√©rations: <br><br><ul><li>  <code>rank(i)</code> compte le nombre de bits abandonn√©s au i-√®me indice dans le vecteur de bits <br></li><li>  <code>select(i)</code> trouve l'indice auquel le i-√®me bit est positionn√© </li></ul><br>  Pour rendre ces op√©rations efficaces sur des vecteurs de gros bits, vous devez cr√©er un index et l'utiliser efficacement, dans les deux cas impliquant un <code>popcount</code> .  Voici un bon aper√ßu de l'indice RRR.  Et, pour autant que je sache, l'approche moderne la plus avanc√©e est d√©crite dans l'article <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Structures de classement et de s√©lection performantes et peu encombrantes sur les s√©quences de bits non compress√©es</a></i> . <br><br><h4>  Optimisations du compilateur </h4><br>  <code>popcount</code> est devenu si r√©pandu que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GCC</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Clang</a> sont capables de le d√©tecter et de le remplacer par une instruction int√©gr√©e.  Imaginez ce Clippy: "Oh, je vois que vous essayez d'impl√©menter <code>popcount</code> , laissez-moi sortir et le r√©parer pour vous!"  Le code LLVM correspondant est <a href="">ici</a> .  Daniel Lemyr le cite comme un exemple de l'esprit √©tonnant des compilateurs modernes. <br><br><h4>  Conclusion </h4><br>  Entour√©e de myst√®re au d√©but de son histoire, l'instruction <code>popcount</code> √™tre utilis√©e partout, bien qu'elle soit rest√©e un peu inhabituelle.  J'aime la fa√ßon dont il relie ces diff√©rents domaines de l'informatique, et je me demande combien d'autres instructions √©tranges existent.  Si vous avez votre propre favori, j'aimerais entendre parler d'elle! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467083/">https://habr.com/ru/post/fr467083/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467063/index.html">Surveillance du carburant pour les g√©n√©rateurs diesel du centre de donn√©es - comment le faire et pourquoi est-ce si important?</a></li>
<li><a href="../fr467065/index.html">Archive des probl√®mes d'olympiades en physique pour les √©coliers</a></li>
<li><a href="../fr467073/index.html">¬´En Occident, il n'y a pas de directeurs artistiques de moins de 40 ans. Avec nous, cela peut aller jusqu'√† 30. " Comment est-ce d'√™tre designer en informatique</a></li>
<li><a href="../fr467079/index.html">Carrousel CSS et Javascript Ant</a></li>
<li><a href="../fr467081/index.html">Analyse de la coloration √©motionnelle des critiques de Kinopoisk</a></li>
<li><a href="../fr467085/index.html">La d√©compilation C, C ++ et DotNet sont les bases de l'inverse. R√©solution des probl√®mes de marche arri√®re avec r0ot-mi. partie 1</a></li>
<li><a href="../fr467087/index.html">Comment j'ai pr√©par√© et r√©ussi la certification Oracle Database SQL (1Z0-071)</a></li>
<li><a href="../fr467089/index.html">Exim patch√© - patchez √† nouveau. Nouvelle ex√©cution de commande √† distance dans Exim 4.92 en une seule demande</a></li>
<li><a href="../fr467091/index.html">Une introduction rapide √† Svelte du point de vue d'un d√©veloppeur angulaire</a></li>
<li><a href="../fr467093/index.html">Espionner vos programmes avec Strace</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>