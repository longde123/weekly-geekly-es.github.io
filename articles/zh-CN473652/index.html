<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â— âŒ ğŸ› ä½¿ç”¨Node.jså’ŒOracleæ•°æ®åº“åˆ›å»ºREST APIã€‚ ç¬¬5éƒ¨åˆ† ğŸ¬ ğŸ¦ƒ ğŸ”‡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç¬¬5éƒ¨åˆ†ï¼šåˆ›å»ºREST APIï¼šåˆ†é¡µï¼Œæ‰‹åŠ¨æ’åºå’Œè¿‡æ»¤ 

 åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæ‚¨å·²ç»å®Œæˆäº†CRUD APIçš„æ ¸å¿ƒåŠŸèƒ½çš„æ„å»ºã€‚ 

 ç°åœ¨ï¼Œå½“åœ¨é›‡å‘˜è·¯ç”±ä¸Šå‘å‡ºHTTP GETè¯·æ±‚æ—¶ï¼Œå°†è¿”å›è¡¨çš„æ‰€æœ‰è¡Œã€‚ å¯¹äºHR.EMPLOYEESè¡¨ä¸­åªæœ‰107è¡Œï¼Œè¿™å¯èƒ½æ²¡æœ‰å¤šå¤§å…³ç³»ï¼Œä½†å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœè¯¥è¡¨åŒ…å«æ•°åƒæˆ–æ•°...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨Node.jså’ŒOracleæ•°æ®åº“åˆ›å»ºREST APIã€‚ ç¬¬5éƒ¨åˆ†</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473652/"> <b>ç¬¬5éƒ¨åˆ†ï¼šåˆ›å»ºREST APIï¼šåˆ†é¡µï¼Œæ‰‹åŠ¨æ’åºå’Œè¿‡æ»¤</b> <br><br> åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œ</a>æ‚¨å·²ç»å®Œæˆäº†CRUD APIçš„æ ¸å¿ƒåŠŸèƒ½çš„æ„å»ºã€‚ <br><br> ç°åœ¨ï¼Œå½“åœ¨é›‡å‘˜è·¯ç”±ä¸Šå‘å‡ºHTTP GETè¯·æ±‚æ—¶ï¼Œå°†è¿”å›è¡¨çš„æ‰€æœ‰è¡Œã€‚ å¯¹äºHR.EMPLOYEESè¡¨ä¸­åªæœ‰107è¡Œï¼Œè¿™å¯èƒ½æ²¡æœ‰å¤šå¤§å…³ç³»ï¼Œä½†å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœè¯¥è¡¨åŒ…å«æ•°åƒæˆ–æ•°ç™¾ä¸‡è¡Œï¼Œå°†ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ è¯¸å¦‚ç§»åŠ¨å’ŒWebåº”ç”¨ç¨‹åºä¹‹ç±»çš„å®¢æˆ·ç«¯é€šå¸¸ä»…æ˜¾ç¤ºæ•°æ®åº“ä¸­å¯ç”¨è¡Œçš„ä¸€å°éƒ¨åˆ†ï¼Œç„¶ååœ¨å¿…è¦æ—¶é€‰æ‹©æ›´å¤šè¡Œ-å¯èƒ½æ˜¯å½“ç”¨æˆ·å‘ä¸‹æ»šåŠ¨æˆ–å•å‡»æŸäº›ä¸­æ–­æ§ä»¶ä¸Šçš„â€œä¸‹ä¸€æ­¥â€æŒ‰é’®æ—¶åˆ°ç”¨æˆ·ç•Œé¢ä¸­çš„é¡µé¢ã€‚ <br><br> ä¸ºæ­¤ï¼ŒREST APIå¿…é¡»æ”¯æŒåˆ†é¡µå·¥å…·ä»¥è¿”å›ç»“æœã€‚ ä¸€æ—¦æ”¯æŒåˆ†é¡µï¼Œå°±éœ€è¦æ’åºåŠŸèƒ½ï¼Œå› ä¸ºé€šå¸¸åº”åœ¨åº”ç”¨åˆ†é¡µä¹‹å‰å¯¹æ•°æ®è¿›è¡Œæ’åºã€‚ å¦å¤–ï¼Œæ•°æ®è¿‡æ»¤å·¥å…·å¯¹äºæ€§èƒ½éå¸¸é‡è¦ã€‚ å¦‚æœæ²¡æœ‰å¿…è¦ï¼Œä¸ºä»€ä¹ˆè¦é€šè¿‡ä¸­é—´å±‚ä»æ•°æ®åº“å°†æ•°æ®å®Œå…¨å‘é€åˆ°å®¢æˆ·ç«¯ï¼Ÿ <br><a name="habracut"></a><br> æˆ‘å°†ä½¿ç”¨URLæŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°ï¼Œä»¥ä¾¿å®¢æˆ·ç«¯å¯ä»¥æŒ‡å®šåº”å¦‚ä½•å¯¹ç»“æœè¿›è¡Œåˆ†é¡µï¼Œæ’åºå’Œè¿‡æ»¤ã€‚ ä¸ç¼–ç¨‹ä¸€æ ·ï¼Œå®ç°å¯èƒ½ä¼šå› æ‚¨çš„è¦æ±‚ï¼Œæ€§èƒ½ç›®æ ‡ç­‰è€Œå¼‚ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å‘æ‚¨ä»‹ç»å°†è¿™äº›åŠŸèƒ½æ·»åŠ åˆ°APIçš„æ‰‹åŠ¨æ–¹æ³•ã€‚ <br><br>  <b>åˆ†é¡µ</b> <br><br> æˆ‘å°†ç”¨äºåˆ†é¡µçš„æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°ï¼šè·³è¿‡å’Œé™åˆ¶ã€‚  skipå‚æ•°å°†ç”¨äºè·³è¿‡æŒ‡å®šçš„è¡Œæ•°ï¼Œè€Œlimitå°†é™åˆ¶è¿”å›çš„è¡Œæ•°ã€‚ å¦‚æœå®¢æˆ·ç«¯ä¸æä¾›è¯¥å€¼ï¼Œæˆ‘å°†ä½¿ç”¨é»˜è®¤å€¼30ä½œä¸ºé™åˆ¶ã€‚ <br><br> é¦–å…ˆæ›´æ–°æ§åˆ¶å™¨é€»è¾‘ä»¥ä»æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­æå–å€¼ï¼Œç„¶åå°†å…¶ä¼ é€’ç»™æ•°æ®åº“APIã€‚ æ‰“å¼€<b>controllers / employee.js</b>æ–‡ä»¶ï¼Œå¹¶å°†ä»¥ä¸‹ä»£ç è¡Œæ·»åŠ åˆ°è§£æreq.params.idå‚æ•°çš„è¡Œä¹‹åçš„getå‡½æ•°ä¸­ã€‚ <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// *** line that parses req.params.id is here *** context.skip = parseInt(req.query.skip, 10); context.limit = parseInt(req.query.limit, 10);</span></span></code> </pre> <br> ç°åœ¨ï¼Œæ‚¨éœ€è¦æ›´æ–°æ•°æ®åº“é€»è¾‘ä»¥è€ƒè™‘è¿™äº›å€¼ï¼Œå¹¶ç›¸åº”åœ°æ›´æ–°SQLæŸ¥è¯¢ã€‚ åœ¨SQLä¸­ï¼Œoffsetå­å¥ç”¨äºè·³è¿‡è¡Œï¼Œè€Œfetchå­å¥ç”¨äºé™åˆ¶æŸ¥è¯¢è¿”å›çš„è¡Œæ•°ã€‚ ä¸å¾€å¸¸ä¸€æ ·ï¼Œå€¼ä¸ä¼šç›´æ¥æ·»åŠ åˆ°æŸ¥è¯¢ä¸­-è€Œæ˜¯å‡ºäºæ€§èƒ½å’Œå®‰å…¨æ€§çš„è€ƒè™‘ï¼Œå®ƒä»¬å°†ä½œä¸ºç»‘å®šå˜é‡æ·»åŠ ã€‚ æ‰“å¼€<b>db_apis / employee.jsï¼Œ</b>å¹¶åœ¨findå‡½æ•°çš„ifå—ä¹‹åæ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œè¯¥ä»£ç å°†whereå­å¥æ·»åŠ åˆ°è¯·æ±‚ä¸­ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// *** if block that appends where clause ends here *** if (context.skip) { binds.row_offset = context.skip; query += '\noffset :row_offset rows'; } const limit = (context.limit &gt; 0) ? context.limit : 30; binds.row_limit = limit; query += '\nfetch next :row_limit rows only';</span></span></code> </pre> <br> è¿™å°±æ˜¯æ‚¨è¦åšçš„å…¨éƒ¨åˆ†é¡µï¼ å¯åŠ¨APIï¼Œç„¶ååœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸Šè¿è¡Œä¸€äº›URLå‘½ä»¤ä»¥å¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›æ‚¨å¯ä»¥ä½¿ç”¨çš„ç¤ºä¾‹ï¼š <br><br><pre> <code class="javascript hljs"># use <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> limit (<span class="hljs-number"><span class="hljs-number">30</span></span>) curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees"</span></span> # set limit to <span class="hljs-number"><span class="hljs-number">5</span></span> curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees?limit=5"</span></span> # use <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> limit and set skip to <span class="hljs-number"><span class="hljs-number">5</span></span> curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees?skip=5"</span></span> # set both skip and limit to <span class="hljs-number"><span class="hljs-number">5</span></span> curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees?skip=5&amp;limit=5"</span></span></code> </pre> <br>  <b>æ’åº</b> <br><br> è‡³å°‘ï¼Œå®¢æˆ·åº”è¯¥èƒ½å¤ŸæŒ‡å®šè¦æ’åºå’Œæ’åºçš„åˆ—ï¼ˆå‡åºæˆ–é™åºï¼‰ã€‚ æœ€ç®€å•çš„æ–¹æ³•æ˜¯å®šä¹‰ä¸€ä¸ªæŸ¥è¯¢å‚æ•°ï¼ˆæˆ‘å°†ä½¿ç”¨sortï¼‰ï¼Œå®ƒå…è®¸æ‚¨ä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚'last_nameï¼šasc'æˆ–'salaryï¼šdesc'ã€‚ ç¡®ä¿ä»SQLæŸ¥è¯¢è¿”å›çš„ç»“æœé›†çš„é¡ºåºçš„å”¯ä¸€æ–¹æ³•æ˜¯åŒ…æ‹¬order byå­å¥ã€‚ å› æ­¤ï¼Œæœ€å¥½å®šä¹‰ä¸€ä¸ªé»˜è®¤çš„è®¢å•å®šä¹‰ï¼Œä»¥ç¡®ä¿å½“å®¢æˆ·æœªæŒ‡å®šè®¢å•å®šä¹‰æ—¶ä¿æŒä¸€è‡´ã€‚ <br><br> è¿”å›<b>controllers / employee.js</b>å¹¶å°†ä»¥ä¸‹ä»£ç è¡Œæ·»åŠ åˆ°è§£æreq.query.limitå‚æ•°çš„è¡Œä¹‹åçš„getå‡½æ•°ä¸­ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// *** line that parses req.query.limit is here *** context.sort = req.query.sort;</span></span></code> </pre> <br> ç„¶åæ‰“å¼€<b>db_apis / employee.jsï¼Œ</b>å¹¶åœ¨å£°æ˜å’Œåˆå§‹åŒ–baseQueryçš„è¡Œä¸‹æ–¹æ·»åŠ ä»¥ä¸‹è¡Œã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// *** lines that initalize baseQuery end here *** const sortableColumns = ['id', 'last_name', 'email', 'hire_date', 'salary'];</span></span></code> </pre> <br>  sortableColumnsæ˜¯å®¢æˆ·å¯ç”¨äºæ’åºçš„åˆ—ç™½åå•ã€‚ ç„¶åï¼Œåœ¨findå‡½æ•°å†…éƒ¨ï¼Œæ·»åŠ ä»¥ä¸‹ifå—ï¼Œä»è€Œæ·»åŠ order byå­å¥ã€‚ å¿…é¡»åœ¨æ·»åŠ whereå­å¥ä¹‹åä½†åœ¨offsetå’Œfetchå­å¥ä¹‹å‰å®Œæˆã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// *** if block that appends where clause ends here *** if (context.sort === undefined) { query += '\norder by last_name asc'; } else { let [column, order] = context.sort.split(':'); if (!sortableColumns.includes(column)) { throw new Error('Invalid "sort" column'); } if (order === undefined) { order = 'asc'; } if (order !== 'asc' &amp;&amp; order !== 'desc') { throw new Error('Invalid "sort" order'); } query += `\norder by "${column}" ${order}`; }</span></span></code> </pre> <br>  ifå—çš„ç¬¬ä¸€éƒ¨åˆ†æ£€æŸ¥å®¢æˆ·ç«¯æ˜¯å¦é€šè¿‡äº†æ’åºå€¼ã€‚ å¦‚æœä¸æ˜¯ï¼Œåˆ™å°†é»˜è®¤çš„order byå­å¥æ·»åŠ åˆ°SQLæŸ¥è¯¢ä¸­ï¼Œè¯¥æŸ¥è¯¢æŒ‰last_nameå‡åºæ’åºã€‚ å¦‚æœæŒ‡å®šäº†æ’åºå€¼ï¼Œåˆ™é¦–å…ˆå°†å…¶åˆ†ä¸ºåˆ—å€¼å’Œè®¢å•å€¼ï¼Œå¹¶åœ¨å°†order byæ·»åŠ åˆ°æŸ¥è¯¢ä¹‹å‰æ£€æŸ¥æ¯ä¸ªå€¼ã€‚ <br><br> ç°åœ¨ï¼Œæ‚¨å¯ä»¥è¿è¡Œå‡ ä¸ªURLå‘½ä»¤è¿›è¡ŒéªŒè¯ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›å°è¯•çš„ç¤ºä¾‹ï¼š <br><br><pre> <code class="javascript hljs"># use <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> sort (last_name asc) curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees"</span></span> # sort by id and use <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> direction (asc) curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees?sort=id"</span></span> # sort by hire_date desc curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees?sort=hire_date:desc"</span></span> # use sort <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> limit and skip together curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees?limit=5&amp;skip=5&amp;sort=salary:desc"</span></span> # should <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> an error because first_name is not whitelisted curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees?sort=first_name:desc"</span></span> # should <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> an error because <span class="hljs-string"><span class="hljs-string">'other'</span></span> is not a valid order curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees?sort=last_name:other"</span></span></code> </pre> <br> æœ€åä¸¤ä¸ªç¤ºä¾‹åº”è¯¥å¼•å‘å¼‚å¸¸ï¼Œå› ä¸ºå®ƒä»¬åŒ…å«çš„ä¸æ˜¯ç™½åå•ä¸­çš„å€¼ã€‚ å®ƒä½¿ç”¨æ ‡å‡†çš„Expressé”™è¯¯å¤„ç†ç¨‹åºï¼Œå› æ­¤é”™è¯¯å°†ä½œä¸ºHTMLç½‘é¡µè¿”å›ã€‚ <br><br>  <b>ç­›é€‰</b> <br><br> è¿‡æ»¤æ•°æ®çš„èƒ½åŠ›æ˜¯æ‰€æœ‰REST APIå¿…é¡»æä¾›çš„é‡è¦åŠŸèƒ½ã€‚ ä¸æ’åºä¸€æ ·ï¼Œå®ç°å¯èƒ½æ˜¯ç®€å•çš„ä¹Ÿå¯èƒ½æ˜¯å¤æ‚çš„ï¼Œå…·ä½“å–å†³äºæ‚¨è¦æ”¯æŒçš„å†…å®¹ã€‚ æœ€ç®€å•çš„æ–¹æ³•æ˜¯æ·»åŠ å¯¹å®Œå…¨åŒ¹é…è¿‡æ»¤å™¨çš„æ”¯æŒï¼ˆä¾‹å¦‚ï¼Œlast_name = Doeï¼‰ã€‚ æ›´å¤æ‚çš„å®ç°å¯ä»¥å¢åŠ å¯¹åŸºæœ¬è¿ç®—ç¬¦ï¼ˆä¾‹å¦‚ï¼Œ&lt;ï¼Œ&gt;ï¼Œinstrç­‰ï¼‰å’Œå¤æ‚é€»è¾‘è¿ç®—ç¬¦ï¼ˆä¾‹å¦‚å’Œ/æˆ–ï¼‰çš„æ”¯æŒï¼Œè¿™äº›é€»è¾‘è¿ç®—ç¬¦å¯ä»¥å°†å¤šä¸ªè¿‡æ»¤å™¨ç»„åˆåœ¨ä¸€èµ·ã€‚ <br><br> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å°è¯•ç®€åŒ–æƒ…å†µå¹¶ä»…å¯¹ä¸¤åˆ—æ·»åŠ è¿‡æ»¤å™¨æ”¯æŒï¼šdepartment_idå’Œmanager_idã€‚ å¯¹äºæ¯ä¸€åˆ—ï¼Œæˆ‘å°†åœ¨æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­å¯ç”¨ç›¸åº”çš„å‚æ•°ã€‚ éœ€è¦æ›´æ–°å°†GETè¯·æ±‚å‘é€ç»™å…·æœ‰å•ä¸ªå‘˜å·¥çš„ç«¯ç‚¹æ—¶æ·»åŠ whereå­å¥çš„æ•°æ®åº“é€»è¾‘ï¼Œä»¥é€‚åº”è¿™äº›æ–°è¿‡æ»¤å™¨ã€‚ <br><br> æ‰“å¼€<b>controllers / employee.jsï¼Œ</b>å¹¶åœ¨è§£ægetå‡½æ•°ä¸­req.query.sortå€¼çš„è¡Œä¸‹æ–¹æ·»åŠ ä»¥ä¸‹è¡Œã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// *** line that parses req.query.sort is here *** context.department_id = parseInt(req.query.department_id, 10); context.manager_id = parseInt(req.query.manager_id, 10);</span></span></code> </pre> <br> ç„¶åç¼–è¾‘<b>db_apis / employee.js</b> ï¼Œå°†å¥å­1 = 1æ·»åŠ åˆ°åŸºæœ¬æŸ¥è¯¢ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> baseQuery = <span class="hljs-string"><span class="hljs-string">`select employee_id "id", first_name "first_name", last_name "last_name", email "email", phone_number "phone_number", hire_date "hire_date", job_id "job_id", salary "salary", commission_pct "commission_pct", manager_id "manager_id", department_id "department_id" from employees where 1 = 1`</span></span>;</code> </pre> <br> å½“ç„¶ï¼Œ1 = 1å°†å§‹ç»ˆä¸ºtrueï¼Œå› æ­¤ä¼˜åŒ–å™¨å°†ç®€å•åœ°å¿½ç•¥å®ƒã€‚ ä½†æ˜¯ï¼Œæ­¤æ–¹æ³•å°†åœ¨å°†æ¥ç®€åŒ–é™„åŠ è°“è¯çš„æ·»åŠ ã€‚ <br><br> åœ¨findå‡½æ•°ä¸­ï¼Œç”¨ä»¥ä¸‹å‡ è¡Œæ›¿æ¢ifå—ï¼Œè¯¥ifå—åœ¨ä¼ é€’context.idæ—¶æ·»åŠ whereå­å¥ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// *** line that declares 'binds' is here *** if (context.id) { binds.employee_id = context.id; query += '\nand employee_id = :employee_id'; } if (context.department_id) { binds.department_id = context.department_id; query += '\nand department_id = :department_id'; } if (context.manager_id) { binds.manager_id = context.manager_id; query += '\nand manager_id = :manager_id'; }</span></span></code> </pre> <br> å¦‚æ‚¨æ‰€è§ï¼Œæ¯ä¸ªifå—ä»…å°†ä¼ é€’ç»™bindså¯¹è±¡çš„å€¼æ·»åŠ ï¼Œç„¶åå°†ç›¸åº”çš„è°“è¯æ·»åŠ åˆ°whereå­å¥ã€‚ ä¿å­˜æ›´æ”¹å¹¶é‡æ–°å¯åŠ¨APIã€‚ ç„¶åä½¿ç”¨ä»¥ä¸‹URLå‘½ä»¤è¿›è¡ŒéªŒè¯ï¼š <br><br><pre> <code class="javascript hljs"># filter where department_id = <span class="hljs-number"><span class="hljs-number">90</span></span> (returns <span class="hljs-number"><span class="hljs-number">3</span></span> employees) curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees?department_id=90"</span></span> # filter where manager_id = <span class="hljs-number"><span class="hljs-number">100</span></span> (returns <span class="hljs-number"><span class="hljs-number">14</span></span> employees) curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees?manager_id=100"</span></span> # filter where department_id = <span class="hljs-number"><span class="hljs-number">90</span></span> and manager_id = <span class="hljs-number"><span class="hljs-number">100</span></span> (returns <span class="hljs-number"><span class="hljs-number">2</span></span> employees) curl <span class="hljs-string"><span class="hljs-string">"http://localhost:3000/api/employees?department_id=90&amp;manager_id=100"</span></span></code> </pre> <br> å°±æ˜¯è¿™æ ·-è¯¥APIç°åœ¨æ”¯æŒåˆ†é¡µï¼Œæ’åºå’Œè¿‡æ»¤ï¼ æ‰‹åŠ¨æ–¹æ³•æä¾›äº†å¾ˆå¤šæ§åˆ¶æƒï¼Œä½†æ˜¯éœ€è¦å¤§é‡ä»£ç ã€‚ æœç´¢åŠŸèƒ½ç°åœ¨æœ‰58è¡Œï¼Œä»…æ”¯æŒæœ‰é™çš„æ’åºå’Œè¿‡æ»¤åŠŸèƒ½ã€‚ æ‚¨å¯èƒ½ä¼šè€ƒè™‘ä½¿ç”¨æ¨¡å—ï¼ˆä¾‹å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Knex.js</a>æŸ¥è¯¢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ„å»ºå™¨</a> ï¼‰æ¥ç®€åŒ–è¿™äº›æ“ä½œã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN473652/">https://habr.com/ru/post/zh-CN473652/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN473638/index.html">ç€è‰²å™¨ä¸æ˜¯é­”æœ¯ã€‚ åœ¨Unityä¸­ç¼–å†™ç€è‰²å™¨ã€‚ å¼•è¨€</a></li>
<li><a href="../zh-CN473640/index.html">å¤§æ•°æ®æ—¥è½</a></li>
<li><a href="../zh-CN473642/index.html">Cribble Crabble Gradleï¼šè‡ªåŠ¨æ„å»ºé­”æœ¯</a></li>
<li><a href="../zh-CN473646/index.html">å°å…¬å¸çš„Hackathonï¼šå¦‚ä½•åœ¨ä¸æµªè´¹èµ„æºçš„æƒ…å†µä¸‹è¿›è¡Œå®‰æ’</a></li>
<li><a href="../zh-CN473648/index.html">é©¬å·²ç»æ­»äº†-å“­æ³£ï¼šä»tslintåˆ°eslintçš„è¿‡æ¸¡</a></li>
<li><a href="../zh-CN473654/index.html">PHP Composerï¼šè½»æ¾è§£å†³ä¾èµ–å…³ç³»</a></li>
<li><a href="../zh-CN473656/index.html">é›¨æœé™æ€ç½‘ç«™ç”Ÿæˆå™¨ä½“éªŒ</a></li>
<li><a href="../zh-CN473658/index.html">å¤„ç†Go 1.13ä¸­çš„é”™è¯¯</a></li>
<li><a href="../zh-CN473660/index.html">è¡—æœºé€†å‘å·¥ç¨‹ï¼šåœ¨NBA Jamä¸Šåˆ›ä¸‹Michael Jordan</a></li>
<li><a href="../zh-CN473664/index.html">äº²èº«å­¦ä¹ ç»éªŒã€‚ Yandex.Practicum-æ•°æ®åˆ†æå¸ˆ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>