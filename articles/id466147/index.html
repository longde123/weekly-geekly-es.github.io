<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ∑ ‚ô®Ô∏è üëè Manajer Tampilan Data Reaktif. Pendahuluan ü¶â üë©üèΩ‚Äç‚úàÔ∏è üò§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ini adalah bagian pertama dari serangkaian artikel di pustaka ReactiveDataDisplayManager (RDDM) . Dalam artikel ini, saya akan menjelaskan masalah umu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Manajer Tampilan Data Reaktif. Pendahuluan</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/surfstudio/blog/466147/">  Ini adalah bagian pertama dari serangkaian artikel di pustaka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ReactiveDataDisplayManager (RDDM)</a> .  Dalam artikel ini, saya akan menjelaskan masalah umum yang harus saya tangani saat bekerja dengan tabel "biasa", serta memberikan deskripsi RDDM. <br><br><img src="https://habrastorage.org/webt/ys/lo/ms/yslomsnycv9gjh_69ojwvxzxe14.png"><br><a name="habracut"></a><br><br><h3>  Masalah 1. UITableViewDataSource </h3><br>  Sebagai permulaan, lupakan alokasi tanggung jawab, penggunaan kembali, dan kata-kata keren lainnya.  Mari kita lihat pekerjaan biasa dengan tabel: <br><br><pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ ... } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITableViewDelegate</span></span></span><span class="hljs-class"> </span></span>{ ... } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITableViewDataSource</span></span></span><span class="hljs-class"> </span></span>{ ... }</code> </pre> <br>  Kami akan menganalisis opsi yang paling umum.  Apa yang perlu kita terapkan?  Benar, 3 metode <code>UITableViewDataSource</code> biasanya diterapkan: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, numberOfRowsInSection section: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">numberOfSections</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">in</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span></span></span></code> </pre> <br>  Untuk saat ini, kami tidak akan memperhatikan metode bantu ( <code>numberOfSection</code> , dll.) Dan mempertimbangkan yang paling menarik - <code>func tableView(tableView: UITableView, indexPath: IndexPath)</code> <br><br>  Misalkan kita ingin mengisi tabel dengan sel dengan deskripsi produk, maka metode kita akan terlihat seperti ini: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> anyCell = tableView.dequeueReusableCell(withIdentifier: <span class="hljs-type"><span class="hljs-type">ProductCell</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: indexPath) <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cell = anyCell <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">ProductCell</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span>() } cell.configure(<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.products[indexPath.row]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell }</code> </pre> <br>  Luar biasa, tidak sulit.  Sekarang, anggaplah kita memiliki beberapa jenis sel, misalnya tiga: <br><br><ul><li>  Produk </li><li>  Daftar saham; </li><li>  Iklan </li></ul><br>  Sebagai contoh sederhana, kita mendapatkan metode cell to <code>getCell</code> : <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> indexPath.row { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cell: <span class="hljs-type"><span class="hljs-type">PromoCell</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.getCell() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span>() } cell.configure(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.promo) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cell: <span class="hljs-type"><span class="hljs-type">AdCell</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.getCell() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span>() } cell.configure(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.ad) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cell: <span class="hljs-type"><span class="hljs-type">AdCell</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.getCell() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span>() } cell.configure(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.products[indexPath.row - <span class="hljs-number"><span class="hljs-number">2</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell } }</code> </pre> <br>  Entah bagaimana banyak kodenya.  Bayangkan kita ingin memperbaiki layar pengaturan.  Apa yang akan ada di sana? <br><br><ul><li>  Tutup sel dengan avatar; </li><li>  Seperangkat sel dengan transisi "mendalam"; </li><li>  Sel dengan sakelar (misalnya, aktifkan / nonaktifkan input dengan kode pin); </li><li>  Sel dengan informasi (misalnya, sel di mana akan ada telepon, email, apa pun); </li><li>  Penawaran pribadi. </li></ul><br>  Apalagi urutannya sudah diatur.  Metode yang bagus akan berubah ... <br><br>  Dan sekarang situasi lain - ada formulir input.  Pada formulir input, sekelompok sel identik, masing-masing bertanggung jawab untuk bidang tertentu dalam model data.  Misalnya, sel untuk masuk ke ponsel bertanggung jawab atas telepon dan sebagainya. <br>  Semuanya sederhana, tetapi ada satu "TETAPI".  Dalam hal ini, Anda masih harus melukis kasus yang berbeda, karena Anda perlu memperbarui bidang yang diperlukan. <br><br>  Anda dapat terus berfantasi dan membayangkan Backend Driven Design, di mana kami menerima 6 jenis bidang input yang berbeda, dan tergantung pada keadaan bidang (visibilitas, jenis input, validasi, nilai default, dan sebagainya) sel berubah begitu banyak sehingga mereka tidak dapat mengarah ke satu antarmuka.  Dalam hal ini, metode ini akan terlihat sangat tidak menyenangkan.  Bahkan jika Anda menguraikan konfigurasi menjadi metode yang berbeda. <br><br>  Ngomong-ngomong, setelah itu, bayangkan seperti apa kode Anda jika Anda ingin menambah / menghapus sel saat Anda bekerja.  Ini tidak akan terlihat sangat bagus karena kita akan dipaksa untuk secara independen memantau konsistensi data yang disimpan dalam <code>ViewController</code> dan jumlah sel. <br><br>  Masalahnya: <br><br><ul><li>  Jika ada sel dengan tipe berbeda, maka kodenya menjadi seperti mie; </li><li>  Ada banyak masalah dengan penanganan acara dari sel; </li><li>  Kode jelek jika Anda perlu mengubah status tabel. </li></ul><br><h3>  Masalah 2. MindSet </h3><br>  Waktu untuk kata-kata keren belum datang. <br>  Mari kita lihat bagaimana aplikasi bekerja, atau lebih tepatnya, bagaimana data muncul di layar.  Kami selalu menyajikan proses ini secara berurutan.  Ya kurang lebih: <br><br><ol><li>  Dapatkan data dari jaringan; </li><li>  Untuk memproses; </li><li>  Tampilkan data ini di layar. </li></ol><br>  Tapi benarkah begitu?  Tidak!  Faktanya, kami melakukan ini: <br><br><ol><li>  Dapatkan data dari jaringan; </li><li>  Untuk memproses; </li><li>  Simpan di dalam model ViewController; </li><li>  Sesuatu menyebabkan penyegaran layar; </li><li>  Model yang disimpan dikonversi ke sel; </li><li>  Data ditampilkan di layar. </li></ol><br>  Selain kuantitas, masih ada perbedaan.  Pertama, kami tidak lagi menampilkan data, itu adalah keluaran.  Kedua, ada kesenjangan logis dalam proses pemrosesan data, model disimpan dan proses berakhir di sana.  Kemudian sesuatu terjadi dan proses lain dimulai.  Jadi, kami jelas tidak menambahkan elemen ke layar, tetapi hanya menyimpannya (yang, omong-omong, juga penuh) sesuai permintaan. <br><br>  Dan ingat tentang <code>UITableViewDelegate</code> , itu juga termasuk metode untuk menentukan ketinggian sel.  Biasanya Dimensi <code>automaticDimension</code> cukup, tetapi kadang-kadang ini tidak cukup dan Anda perlu mengatur ketinggian sendiri (misalnya, dalam hal animasi atau header) <br>  Kemudian kita biasanya berbagi pengaturan sel, bagian dengan konfigurasi ketinggian ada di metode lain. <br><br>  Masalahnya: <br><br><ul><li>  Koneksi eksplisit antara pemrosesan data dan tampilannya pada UI terputus; </li><li>  Konfigurasi sel dipecah menjadi beberapa bagian. </li></ul><br><h3>  Ide </h3><br>  Masalah yang terdaftar pada layar yang rumit menyebabkan sakit kepala dan keinginan yang tajam untuk minum teh. <br><br>  Pertama, saya tidak ingin terus menerapkan metode delegasi.  Solusi yang jelas adalah membuat objek yang akan mengimplementasikannya.  Selanjutnya kita akan melakukan sesuatu seperti: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> displayManager = <span class="hljs-type"><span class="hljs-type">DisplayManager</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.tableView)</code> </pre> <br>  Bagus  Sekarang Anda membutuhkan objek untuk dapat bekerja dengan sel apa pun, sedangkan konfigurasi sel-sel ini perlu dipindahkan ke tempat lain. <br><br>  Jika kita meletakkan konfigurasi di objek terpisah, maka kita merangkum (saatnya untuk kata-kata pintar) konfigurasi di satu tempat.  Di tempat yang sama ini, kita bisa menghilangkan logika untuk memformat data (misalnya, mengubah format tanggal, penggabungan string, dll.).  Melalui objek yang sama, kita dapat berlangganan acara di sel. <br><br>  Dalam hal ini, kita akan memiliki objek yang memiliki dua antarmuka berbeda: <br><br><ol><li>  Antarmuka pembuatan instance <code>UITableView</code> adalah untuk DisplayManager kami. </li><li>  Inisialisasi, berlangganan, dan konfigurasi antarmuka - untuk Presenter atau ViewController. </li></ol><br>  Kami menyebut objek ini generator.  Kemudian generator kami untuk tabel adalah sel, dan untuk segalanya - cara untuk menyajikan data pada UI dan memproses acara. <br><br>  Dan karena konfigurasi sekarang dienkapsulasi oleh generator, dan generator itu sendiri adalah sebuah sel, kita dapat memecahkan banyak masalah.  Termasuk yang tercantum di atas. <br><br><h3>  Implementasi </h3><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TableCellGenerator</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> identifier: <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span>.<span class="hljs-type"><span class="hljs-type">Type</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cellHeight: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> estimatedCellHeight: <span class="hljs-type"><span class="hljs-type">CGFloat?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tableView: UITableView, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params"> indexPath: IndexPath)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerCell</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">in</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView)</span></span></span></span> } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewBuilder</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">associatedtype</span></span> <span class="hljs-type"><span class="hljs-type">ViewType</span></span>: <span class="hljs-type"><span class="hljs-type">UIView</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(view: ViewType)</span></span></span></span> }</code> </pre> <br>  Dengan implementasi seperti itu, kita dapat membuat implementasi default: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TableCellGenerator</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">where</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Self</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewBuilder</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tableView: UITableView, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params"> indexPath: IndexPath)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cell = tableView.dequeueReusableCell(withIdentifier: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.identifier.nameOfClass, <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: indexPath) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">Self</span></span>.<span class="hljs-type"><span class="hljs-type">ViewType</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span>() } <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.build(view: cell) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span> ?? <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span>() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerCell</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">in</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView)</span></span></span></span> { tableView.registerNib(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.identifier) } }&lt;source lang=<span class="hljs-string"><span class="hljs-string">"swift"</span></span>&gt;</code> </pre> <br>  Saya akan memberikan contoh generator kecil: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FamilyCellGenerator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cell: <span class="hljs-type"><span class="hljs-type">FamilyCell?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> family: <span class="hljs-type"><span class="hljs-type">Family?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> didTapPerson: ((<span class="hljs-type"><span class="hljs-type">Person</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>)? <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">show</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(family: Family)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.family = family cell?.fill(with: family) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showLoading</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.family = <span class="hljs-literal"><span class="hljs-literal">nil</span></span> cell?.showLoading() } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FamilyCellGenerator</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TableCellGenerator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> identifier: <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span>.<span class="hljs-type"><span class="hljs-type">Type</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">FamilyCell</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FamilyCellGenerator</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewBuilder</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(view: FamilyCell)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.cell = view view.selectionStyle = .<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> view.didTapPerson = { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>] person <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>?.didTapPerson?(person) } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> family = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.family { view.fill(with: family) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { view.showLoading() } } }</code> </pre> <br>  Di sini kami menyembunyikan konfigurasi dan langganan.  Perhatikan bahwa sekarang kita memiliki tempat di mana kita dapat merangkum keadaan (karena tidak mungkin untuk merangkum keadaan dalam sel karena digunakan kembali oleh tabel).  Dan mereka juga mendapat kesempatan untuk mengubah data di sel "on the fly." <br><br>  Perhatikan <code>self.cell = view</code> .  Kami ingat sel dan sekarang kami dapat memperbarui data tanpa memuat ulang sel ini.  Ini adalah fitur yang bermanfaat. <br><br>  Tapi saya terganggu.  Karena kita dapat memiliki sel apa pun yang diwakili oleh generator, kita dapat membuat antarmuka DisplayManager kita sedikit lebih indah. <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataDisplayManager</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">associatedtype</span></span> <span class="hljs-type"><span class="hljs-type">CollectionType</span></span> <span class="hljs-keyword"><span class="hljs-keyword">associatedtype</span></span> <span class="hljs-type"><span class="hljs-type">CellGeneratorType</span></span> <span class="hljs-keyword"><span class="hljs-keyword">associatedtype</span></span> <span class="hljs-type"><span class="hljs-type">HeaderGeneratorType</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(collection: <span class="hljs-type"><span class="hljs-type">CollectionType</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forceRefill</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addSectionHeaderGenerator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> generator: HeaderGeneratorType)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addCellGenerator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> generator: CellGeneratorType)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addCellGenerators</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> generators: [CellGeneratorType], after: CellGeneratorType)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addCellGenerator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> generator: CellGeneratorType, after: CellGeneratorType)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addCellGenerators</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> generators: [CellGeneratorType])</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(generators: [CellGeneratorType])</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clearHeaderGenerators</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clearCellGenerators</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> }</code> </pre> <br>  Ini sebenarnya tidak semuanya.  Kami dapat memasukkan generator di tempat yang tepat atau menghapusnya. <br><br>  By the way, memasukkan sel setelah sel tertentu bisa sangat berguna.  Terutama jika kami secara bertahap memuat data (misalnya, pengguna memasukkan TIN, kami mengunggah informasi TIN dan menampilkannya dengan menambahkan beberapa sel baru setelah bidang TIN). <br><br><h3>  Ringkasan </h3><br>  Bagaimana sel bekerja sekarang akan terlihat: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: [Products])</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gens = data.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> { <span class="hljs-type"><span class="hljs-type">ProductCellGenerator</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.ddm.addGenerators(gens) } }</code> </pre><br>  Atau di sini: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(fields: [Field])</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gens = fields.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> { field <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> field.type { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .phone: <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gen = <span class="hljs-type"><span class="hljs-type">PhoneCellGenerator</span></span>(item) gen.didUpdate = { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.updatePhone($<span class="hljs-number"><span class="hljs-number">0</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> gen <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .date: <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gen = <span class="hljs-type"><span class="hljs-type">DateInputCellGenerator</span></span>(item) gen.didTap = { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.showPicker() } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> gen <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .dropdown: <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gen = <span class="hljs-type"><span class="hljs-type">DropdownCellGenerator</span></span>(item) gen.didTap = { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.showDropdown(item) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> gen } } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> splitter = <span class="hljs-type"><span class="hljs-type">SplitterGenerator</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.ddm.addGenerator(splitter) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.ddm.addGenerators(gens) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.ddm.addGenerator(splitter) } }</code> </pre> <br>  Kami dapat mengontrol urutan penambahan elemen dan, pada saat yang sama, koneksi antara pemrosesan data dan menambahkannya ke UI tidak hilang.  Jadi, dalam kasus sederhana, kami memiliki kode sederhana.  Dalam kasus-kasus sulit, kode tidak berubah menjadi pasta dan pada saat yang sama terlihat lumayan.  Antarmuka deklaratif untuk bekerja dengan tabel telah muncul dan sekarang kami merangkum konfigurasi sel, yang dengan sendirinya memungkinkan kami untuk menggunakan kembali sel bersama dengan konfigurasi antara layar yang berbeda. <br><br>  Kelebihan menggunakan RDDM: <br><br><ul><li>  Enkapsulasi konfigurasi sel; </li><li>  Mengurangi duplikasi kode dengan merangkum kerja dari koleksi ke adaptor; </li><li>  Pilih objek adaptor yang merangkum logika spesifik bekerja dengan koleksi; </li><li>  Kode menjadi lebih jelas dan lebih mudah dibaca; </li><li>  Jumlah kode yang perlu ditulis untuk menambahkan tabel dikurangi; </li><li>  Proses memproses peristiwa dari sel disederhanakan. </li></ul><br>  Sumber di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br>  Terima kasih atas perhatian anda! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id466147/">https://habr.com/ru/post/id466147/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id466129/index.html">Efisiensi transportasi dengan bensin, baterai dan hidrogen</a></li>
<li><a href="../id466135/index.html">Megapack: bagaimana pengembang Factorio berhasil memecahkan masalah dengan 200 pemain multipemain</a></li>
<li><a href="../id466137/index.html">System.IO. Pipelines - alat yang sedikit dikenal bagi pecinta kinerja tinggi</a></li>
<li><a href="../id466139/index.html">Teknologi yang diterapkan pada reruntuhan demam blockchain atau manfaat praktis dari alokasi sumber daya</a></li>
<li><a href="../id466143/index.html">Bagaimana kami membuat kode kardus atau versi Awal dari game papan Golem Battle</a></li>
<li><a href="../id466149/index.html">Membuat simbol konektor dengan teks "dinamis" di OrCAD</a></li>
<li><a href="../id466151/index.html">Investigasi: program aneh dalam Daftar perangkat lunak domestik</a></li>
<li><a href="../id466153/index.html">Membuat dokumen desain misi game naratif menggunakan contoh Last of Us</a></li>
<li><a href="../id466155/index.html">Arsitektur dan Fitur Tarantool Data Grid</a></li>
<li><a href="../id466157/index.html">Blockchain: apa yang harus kita bangun PoC?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>