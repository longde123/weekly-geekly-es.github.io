<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòá ‚ôíÔ∏è üö¶ SportIduino - Sistema de marcado electr√≥nico de orientaci√≥n Arduino üå´Ô∏è üõµ ‚èπÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salir al campo siempre es maravilloso, pero con un mapa en la mano y con un objetivo consciente siempre es m√°s interesante. Hay tipos de actividades a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SportIduino - Sistema de marcado electr√≥nico de orientaci√≥n Arduino</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/404565/"><img src="https://habrastorage.org/web/6e5/049/cd8/6e5049cd8c2c4ec6907532fd1ab6a8ac.JPG"><br><br>  Salir al campo siempre es maravilloso, pero con un mapa en la mano y con un objetivo consciente siempre es m√°s interesante.  Hay tipos de actividades al aire libre como orientaci√≥n, carreras, carreras m√∫ltiples, en las que puedes pasar un buen rato.  La tarea del orientador es visitar los puntos de control indicados en el mapa en el tiempo m√≠nimo.  Para probar el hecho de su visita, se usan como los llamados  Sistemas de marcado "tradicionales": l√°pices de colores, s√≠mbolos de c√≥digo, compostadores, etc., as√≠ como sistemas electr√≥nicos.  A pesar de la conveniencia de este √∫ltimo, los m√©todos tradicionales todav√≠a se usan ampliamente en las competiciones de aficionados.  Esto se debe al costo del equipo (de 3.500 rublos por marca de estaci√≥n y de 450 rublos por chip), con la posibilidad de robo de estaciones instaladas en lugares p√∫blicos, la necesidad de tomar un dep√≥sito para el chip.  Por lo tanto, me propuse el objetivo de crear una alternativa m√°s asequible.  Su implementaci√≥n en el entorno Arduino se describe a continuaci√≥n. <br><a name="habracut"></a><br>  Un sistema de etiquetado electr√≥nico generalmente consta de chips y estaciones RFID, dispositivos especiales para su grabaci√≥n y lectura.  El sistema funciona de la siguiente manera.  Al comienzo, el atleta de orientaci√≥n recibe una ficha, toma una tarjeta y comienza.  Corriendo hacia el CP, aplica su chip a la estaci√≥n de marcado, ella registra la hora actual en el chip y da una se√±al, despu√©s de lo cual el atleta puede continuar.  Al final, el atleta pasa el chip al juez, quien lee la informaci√≥n utilizando la estaci√≥n de acceso y anuncia el resultado al atleta: su tiempo a distancia, el n√∫mero de CP visitados, el cumplimiento de una direcci√≥n determinada.  Tambi√©n puede imprimir divisiones: per√≠odos de tiempo dedicados a la ruta entre el PC, lo que le permite al atleta analizar su ruta y compararse con otros en un segmento particular de la distancia. <br><br>  Para trabajar con chips RFID, hay un m√≥dulo RFID-RC522 ampliamente disponible, para el cual hay una excelente biblioteca para arduino, en muchos aspectos este hecho determin√≥ su uso.  El m√≥dulo funciona a una frecuencia de 13.56 MHz y es compatible con el est√°ndar ISO 14443, funciona con varios chips, la lectura y escritura se produce desde una distancia de varios cent√≠metros, lo cual es muy adecuado para nuestros prop√≥sitos. <br><br><img src="https://habrastorage.org/web/1fa/1a4/186/1fa1a4186195442bba96b58d0405324e.JPG"><br><br>  <b>Papas fritas</b> <br><br>  Para crear un sistema de marcado, utilic√© el chip Mifare Classic 1K (S50) debido a su amplia disponibilidad en varios dise√±os y bajo costo (11 rublos por chip en forma de llavero).  El chip le permite leer y escribir informaci√≥n de manera r√°pida y confiable.  La memoria del chip est√° estructuralmente dividida en 16 sectores, cada uno de los cuales contiene 4 bloques de 16 bytes.  El cuarto bloque de cada sector contiene claves que pueden usarse para escribir / leer bloques en el sector.  Adem√°s, en el sector cero, el bloque cero contiene el UID e informaci√≥n sobre el fabricante.  Por lo tanto, quedan 3 bloques de 16 bytes para escribir en sectores del 1 al 15 y dos bloques en el sector 0.  La estructura de grabaci√≥n se presenta en la tabla a continuaci√≥n, todos los datos se registran por triplicado para mayor confiabilidad. <br><br><img src="https://habrastorage.org/web/7db/d8d/587/7dbd8d5873ba4e6b9c729b9ba17dd39b.png"><br><br>  Este sistema de grabaci√≥n le permite grabar 45 marcas en la memoria, incluidos el inicio y el final, para la mayor√≠a de las competiciones esto es suficiente.  Pero si optimiza el uso de la memoria y dedica un poco m√°s de tiempo a la marca, la capacidad se puede aumentar significativamente. <br><br><img src="https://habrastorage.org/web/2dd/01a/6b6/2dd01a6b642c40639634811fa5f71e22.JPG"><br><br>  <b>Estaciones de Estacion</b> <br><br>  <i>Esquema e instalaci√≥n</i> <br><br>  Los componentes principales de las estaciones de la marca: microcontrolador - Atmega328p-au, m√≥dulo RF522, reloj DS3231.  Alimentado por 3 bater√≠as AA a trav√©s del estabilizador lineal MCP1700T-33. <br><br><img src="https://habrastorage.org/web/614/c46/d8e/614c46d8e4bf4617b6ba02a2b69e5106.jpg"><br><br>  Instal√© los componentes en una placa de circuito impreso, todos los componentes SMD, con la placa RFID hice la conexi√≥n soldando a trav√©s del conector pin.  Los tableros se fabricaron utilizando pistas fotorresistentes de 0,5 mm.  Mientras se perfeccionaba el m√©todo, me cas√© mucho, probablemente sea m√°s conveniente hacer archivos gerber y ordenar su producci√≥n por separado, ya que no es muy costoso. <br><br><img src="https://habrastorage.org/web/887/6a0/176/8876a017695846c184bf5aaac77b5e55.JPG"><br><br>  Yo uso el asequible g1020BF como el caso.  Taladr√© un agujero en la caja para el LED y cort√© el exceso de pl√°stico para ingresar al compartimiento de la bater√≠a.  El orificio para el LED fue tratado con epoxi, luego insert√≥ una placa de circuito soldada.  Despu√©s de que el epoxi se endureci√≥, inyect√≥ 30 mililitros del compuesto PK-68, que fue suficiente para cubrir el tablero.  Insert√© bater√≠as en el compartimento de la bater√≠a y unt√© todo con grasa para impermeabilizar.  Despu√©s de apretar la tapa, la estaci√≥n est√° lista para usar. <br><br><img src="https://habrastorage.org/web/dab/19f/14e/dab19f14e7fa4c5b9f56fce173c95b70.jpg"><br><br>  El costo de los componentes y materiales de la estaci√≥n para su fabricaci√≥n es de aproximadamente 500 rublos.  Me lleva alrededor de 1,5 horas de tiempo puro hacer y configurar una estaci√≥n. <br><br>  <i>Firmware de la estaci√≥n</i> <br><br>  Durante el funcionamiento de la estaci√≥n, son posibles varios tipos de mal funcionamiento, fue necesario implementar el trabajo de watchdog, por lo que debe utilizar un cargador de arranque compatible para que funcione correctamente.  Aqu√≠ encontrar√° una buena versi√≥n del gestor de arranque para Atmega328p e instrucciones para instalarlo.  Tambi√©n debe cambiar la biblioteca de cables est√°ndar a no bloqueante para que la estaci√≥n contin√∫e funcionando cuando la l√≠nea i2c se rompa y no entre en un bucle sin fin.  Cargu√© el cargador de arranque usando otro arduino a trav√©s del Arduino como firmware isp, conect√© los contactos SPI a trav√©s de los pines que conducen al m√≥dulo RFID, que cort√© despu√©s de un arranque exitoso.  Despu√©s de lo cual instal√© el firmware principal. <br><br>  Con el firmware principal, cuando se inserta la bandeja, la estaci√≥n lee un bloque de informaci√≥n del que aprende los n√∫meros del √∫ltimo bloque grabado y la estaci√≥n en la que se produjo la marca.  Si el n√∫mero de estaci√≥n es diferente, el bloque de informaci√≥n se actualiza y el n√∫mero de estaci√≥n y la hora actual se registran en el siguiente bloque libre.  La hora y el n√∫mero de estaci√≥n se pueden ajustar usando chips especiales y la estaci√≥n de puerta de enlace. <br><br>  <i>Nutrici√≥n</i> <br><br>  Una de las cuestiones m√°s importantes que vali√≥ la pena resolver fue c√≥mo maximizar la vida √∫til de las estaciones con un conjunto de bater√≠as.  Esto es especialmente cr√≠tico para la orientaci√≥n tur√≠stica, cuando sucede que las estaciones se instalan mucho antes de la competencia y es necesario que est√©n garantizadas para funcionar durante m√°s de un mes. <br><br>  Para reducir el consumo, los modos de suspensi√≥n se utilizan para el controlador, as√≠ como para el RC522.  En modo inactivo, la estaci√≥n consume solo 0.02 mA versus 20 mA durante la operaci√≥n.  Para utilizar la energ√≠a de manera m√°s econ√≥mica, se han implementado tres modos de funcionamiento de la estaci√≥n con diferentes intervalos de tiempo de reposo. <br><br>  Por defecto, la estaci√≥n comienza en modo de espera.  Al mismo tiempo, se busca el chip cada segundo, la capacidad de la bater√≠a es suficiente durante 160 d√≠as.  Cuando el chip se coloca en la bandeja (esto lo hace el juez de producci√≥n o el primer atleta que ha corrido hasta la estaci√≥n), la estaci√≥n cambia al modo de operaci√≥n.  En modo operativo, se implementa una b√∫squeda de chips cada 250 ms.  Las bater√≠as nuevas duran 45 d√≠as de uso continuo.  Despu√©s de 6 horas de inactividad, la estaci√≥n vuelve al modo de espera. <br><br>  Cuando se introduce el chip de reposo maestro (chip de juez especial con configuraci√≥n de estaci√≥n), la estaci√≥n cambia al modo de almacenamiento (busque el chip una vez cada 25 segundos), lo selecciona 3 veces y se reinicia.  Las bater√≠as nuevas en este modo durar√°n 5 a√±os.  Cuando se coloca una bandeja en cualquier chip, la estaci√≥n pasa al modo de espera y se mide la carga restante de la bater√≠a.  Si el voltaje cae por debajo de 3.1V, lo que indica que queda aproximadamente el 15% de la carga, la estaci√≥n lo se√±ala. <br><br>  <b>Interfaz y procesamiento de datos</b> <br><br>  Se proporciona una estaci√≥n de interfaz para trabajar con chips y estaciones de marcado.  Con la estaci√≥n de puerta de enlace, puede configurar y ajustar la hora y los n√∫meros de estaci√≥n utilizando chips maestros especiales.  Adem√°s, la estaci√≥n de puerta de enlace realiza la limpieza previa al lanzamiento y la verificaci√≥n de chips, los ingresa con informaci√≥n inicial y un n√∫mero individual.  Bueno, por supuesto, lee las fichas y obtiene los resultados. <br><br>  Al circuito, tambi√©n agregu√© un m√≥dulo SD para grabar divisiones y un m√≥dulo Bluetooth para que la estaci√≥n se pueda conectar a un tel√©fono o computadora para recibir o transmitir datos. <br><br><img src="https://habrastorage.org/web/311/76a/72a/31176a72ae274e089e98e8f28b6caca1.PNG"><br><br>  Si bien el circuito y el firmware a√∫n no est√°n lo suficientemente optimizados e implementados tan lejos de los m√≥dulos, en la rodilla.  En el futuro, se planea finalizar para un uso m√°s conveniente. <br><br><img src="https://habrastorage.org/web/26b/aa9/e93/26baa9e935164e8f8bc0e44d5482856e.JPG"><br><br>  Por el momento, el procesamiento de datos se lleva a cabo de forma semi-manual clasificando los archivos CSV resultantes.  El sistema es muy flexible y se puede configurar f√°cilmente para cualquier competencia, para implementar el preprocesamiento de datos en la puerta de enlace de manera conveniente en diferentes casos.  Para el futuro, hay planes para escribir software para automatizar el procesamiento de datos. <br><br>  <b>Conclusi√≥n</b> <br><br>  Soy nuevo en la programaci√≥n y el desarrollo de dispositivos electr√≥nicos y he estado haciendo esto por menos de un a√±o.  Por lo tanto, el c√≥digo y las soluciones de circuitos, muy posiblemente, est√°n lejos de ser √≥ptimas o completamente incorrectas.  Estar√© encantado de criticar, todo el proyecto est√° disponible gratuitamente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el github</a> . <br><br>  Tambi√©n quiero expresar mi gratitud a aquellos que ya han ayudado con consejos e interesados ‚Äã‚Äãen el desarrollo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es404565/">https://habr.com/ru/post/es404565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es404555/index.html">Revisi√≥n del tel√©fono IP Yealink SIP-T27G</a></li>
<li><a href="../es404557/index.html">Lo que el cami√≥n Progress MS-06 entregar√° a la ISS el 16 de junio de 2017: revisi√≥n de cargas, experimentos y tareas</a></li>
<li><a href="../es404559/index.html">El desaf√≠o para los ni√±os de cinco a√±os que se ha vuelto "viral"</a></li>
<li><a href="../es404561/index.html">Oficina al estilo de Canon. Resumen de dispositivos y soluciones para empresas</a></li>
<li><a href="../es404563/index.html">Alternativa de radio para redes peque√±as</a></li>
<li><a href="../es404567/index.html">Editorial Peter. Venta de verano</a></li>
<li><a href="../es404569/index.html">Part√≠culas, antipart√≠culas y su aniquilaci√≥n.</a></li>
<li><a href="../es404571/index.html">Redes sociales: una nueva fuente seria de amenazas cibern√©ticas</a></li>
<li><a href="../es404573/index.html">Ganar el "monstruo matem√°tico": no se trata de n√∫meros, sino de aprender a pensar</a></li>
<li><a href="../es404575/index.html">La IA de Microsoft rompi√≥ el r√©cord de un hombre con la Sra. Pac-man</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>