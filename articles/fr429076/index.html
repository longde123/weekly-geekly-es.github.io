<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧘🏾 🍏 📏 L'évolution de la recherche - comment acheter un piano en trois clics 🧑🏼‍🤝‍🧑🏻 👌🏿 😰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Auparavant, sur Avito, vous pouviez trouver le bon produit en utilisant le filtrage par mots clés ou la navigation dans l'arborescence des catégories....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>L'évolution de la recherche - comment acheter un piano en trois clics</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/avito/blog/429076/"><p>  Auparavant, sur Avito, vous pouviez trouver le bon produit en utilisant le filtrage par mots clés ou la navigation dans l'arborescence des catégories.  Cette méthode, bien qu'elle paraisse familière, n'était pas toujours pratique - pour trouver un produit ou un service, il fallait faire un grand nombre de clics.  Il y a plus d'un an, nous avons gagné en pertinence, grâce à quoi la recherche s'est améliorée, et maintenant il est plus facile et plus pratique de trouver un produit ou un service même sur la page principale.  Avec cette innovation, des marchandises inadaptées et franchement «poubelles» ont cessé de tomber dans le problème.  Et ce n'est là qu'une des étapes pour améliorer votre recherche.  Nous modifions progressivement l'infrastructure, ce qui nous permet de travailler plus intensément sur la qualité de la recherche, de l'améliorer plus rapidement et de déployer de nouvelles fonctionnalités qui profitent aux vendeurs et aux acheteurs sur Avito. </p><br><p>  Dans l'article, je vais vous dire comment la recherche sur Avito a changé: comment nous avons commencé et comment nous nous dirigeons maintenant vers l'amélioration de la vie de nos utilisateurs, et partagerai nos innovations à la fois dans le produit et dans son remplissage - la partie technique.  Il n'y aura pas de viande hardcore ici, mais j'espère que vous l'apprécierez. </p><br><img src="https://habrastorage.org/webt/19/zx/he/19zxhesvegeiygbo4haapoe4mic.png"><a name="habracut"></a><br><p>  Quelques notes d'introduction: Avito est le service publicitaire le plus populaire en Russie.  Nous avons plus de 450 000 annonces par jour et le nombre mensuel de visiteurs uniques atteint 35 millions, ce qui fait plus de 140 millions de recherches par jour. </p><br><h1 id="tipichnyy-scenariy-poiska-ranshe">  Scénario de recherche typique avant </h1><br><p>  Regardons un exemple simple du fonctionnement d'une recherche il y a plus d'un an.  Supposons que vous ayez besoin d'un piano (enfin, pourquoi pas?).  On va à la page principale, on tape «piano». </p><br><img src="https://habrastorage.org/webt/yh/jq/di/yhjqdiamdihyfnkermrcwkhwzpq.png"><br><p>  Dans le cadre de l'extradition, vous recevrez très probablement des déménageurs, des services de transport de piano ou quelque chose de similaire, mais pas un instrument de musique. </p><br><img src="https://habrastorage.org/webt/wy/dp/rm/wydprmf6to16xbqxq6mfkpfqlno.png"><br><p>  Cela se produit car nous aurons un tri par date de placement - et ces services sont placés le plus souvent. </p><br><img src="https://habrastorage.org/webt/bt/m8/rz/btm8rzqberfol38jrn2uln1ipju.jpeg"><br><p>  Pour voir le piano, vous devez spécifier la catégorie.  On clique sur la rubrique "Hobbies et loisirs", on descend l'arborescence des catégories jusqu'à "Instruments de musique", puis "Instruments à clavier". </p><br><img src="https://habrastorage.org/webt/d1/h2/oq/d1h2oqqqz5gv9snlihpiu51yzau.png"><br><img src="https://habrastorage.org/webt/be/c2/zf/bec2zflrha8wktusuudqo1w3o08.png"><br><p>  Et seulement après cela, nous voyons le piano que nous recherchions. </p><br><img src="https://habrastorage.org/webt/-c/wz/71/-cwz71ifodfnrcda86qj03u__5y.png"><br><p>  Il s'avère que pour trouver l'annonce souhaitée, il y avait les options suivantes: </p><br><ul><li>  affinement de la catégorie lors de la recherche par mots-clés, </li><li>  tri par fraîcheur et prix, </li><li>  filtres </li><li>  rechercher uniquement par nom. </li></ul><br><h1 id="chto-izmenilos-blagodarya-relevantnosti">  Ce qui a changé en raison de la pertinence </h1><br><p>  En raison de leur pertinence, les annonces qui ne correspondent pas du tout ont cessé d'être incluses dans l'émission.  Maintenant, si vous cherchez un piano sur la page principale, vous ne verrez probablement pas les services de chargeurs qui vous aideront à le transporter, mais vous verrez immédiatement l'instrument de musique que vous voulez.  Dans le même temps, un nouveau tri a été ajouté - «Par défaut».  Il est formé de deux indicateurs: la pertinence de l'annonce par rapport à la requête de texte et la fraîcheur. </p><br><img src="https://habrastorage.org/webt/oc/p_/ry/ocp_rycbztfxg1fdvec-3usu0cm.png"><br><p>  En haut, vous voyez le plus récent des plus pertinents. </p><br><img src="https://habrastorage.org/webt/cg/md/pq/cgmdpq3ogawjuoqf4cr66l17gr0.png"><br><p>  Sur Avito, moyennant des frais supplémentaires, vous pouvez augmenter votre annonce.  Et avec l'introduction de la pertinence, les augmentations rémunérées fonctionnent plus efficacement.  Ils fonctionneront, tout d'abord, si votre annonce est pertinente pour la requête textuelle. </p><br><p>  L'introduction de la pertinence ne signifie pas que nous avons complètement abandonné les transitions vers l'arbre des catégories.  Dans la plupart des cas, nous avons réduit le nombre de clics vers l'annonce souhaitée lors de la recherche à partir de la page principale.  Si vous avez encore besoin de services de transport, même si vous venez de taper «piano» dans la recherche, parcourez l'arborescence des catégories et vous trouverez ces annonces.  La recherche a également commencé à fonctionner plus efficacement et dans la catégorie, par exemple, «Articles personnels» et «Appareils ménagers». </p><br><h1 id="kak-nayti-nuzhnyy-tovar-v-tri-klika">  Comment trouver le bon produit en trois clics </h1><br><p>  La recherche devient plus pratique pour les utilisateurs, non seulement en raison de la qualité des résultats de la recherche.  Il existe d'autres moyens de l'améliorer.  L'un d'eux transmet à la catégorie.  Par exemple, nous recherchons Lamborghini Gayardo (oui, vous aimez jouer du piano et vous voulez monter Lamborghini).  Pour entrer dans la catégorie d'une voiture d'un modèle particulier, vous devez faire deux clics supplémentaires.  Avec pertinence, vous obtiendrez très probablement ce que vous voulez. </p><br><img src="https://habrastorage.org/webt/vd/d0/-y/vdd0-ymtzuq15oeaxe_bdikffne.png"><br><p>  Mais il existe une méthode supplémentaire qui vous mettra immédiatement dans les voitures.  L'émission sera restreinte, la bonne voiture sera sélectionnée dans les filtres et vous recevrez vraiment des voitures dans l'émission. </p><br><img src="https://habrastorage.org/webt/xq/b_/7v/xqb_7v4xa6vmvo4rtt88h8yvttk.png"><br><img src="https://habrastorage.org/webt/vo/lk/yo/volkyo_aktkx5cemgpd9fvy2hp4.png"><br><p>  Une autre façon est d'étendre les balises.  Par exemple, lorsque vous entrez le mot «veste», vous obtiendrez des indices. </p><br><img src="https://habrastorage.org/webt/mv/7q/si/mv7qsiygsxehsjbl0pkctnhykjo.png"><br><p>  La capture d'écran ci-dessus montre les conseils: le type de vestes - femme, homme, pour filles, pour garçons.  Si vous cliquez sur «Pour les filles», vous tomberez immédiatement dans la catégorie où les filtres appropriés seront sélectionnés.  Un ensemble de balises supplémentaires supplémentaires apparaîtra également ici: veste d'hiver, cuir, neuf et ainsi de suite.  Si vous descendez manuellement l'arborescence des catégories jusqu'au produit souhaité, vous devez effectuer plus d'actions. </p><br><img src="https://habrastorage.org/webt/4k/hq/vg/4khqvgdpjs1sgxhb_icjrxl__v0.png"><br><h1 id="v-chem-raznica-mezhdu-poiskom-i-filtrami">  Quelle est la différence entre la recherche et les filtres </h1><br><p>  Lorsque j'ai parlé à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RIT ++</a> , le public avait une question: quelle est la différence entre la recherche de texte et les filtres?  Tout est assez simple.  Vous pouvez également trouver l'annonce souhaitée sans demande de texte en descendant dans l'arborescence des catégories.  Dans ce cas, la recherche trouvera toujours des biens et services, non pas par le texte donné, mais par l'ensemble de paramètres transmis à partir des filtres correspondants de la catégorie sélectionnée. </p><br><p>  Chaque catégorie a son propre ensemble de filtres.  Par exemple, dans la catégorie «Voitures» - certains filtres, dans la catégorie «Objets personnels» - d'autres filtres.  Autrement dit, les filtres sont liés de manière rigide à une catégorie. </p><br><h1 id="razmeschenie-obyavleniya-za-dve-minuty">  Placement de l'annonce en deux minutes </h1><br><p>  Une innovation importante est apparue pour les vendeurs qu'ils ressentent lors de la soumission de leur annonce.  Si votre annonce ne contient aucun "interdit" ou n'est pas un doublon - la bonne annonce habituelle - vous la verrez dans l'émission presque immédiatement.  En fait, ce délai dure environ deux minutes, mais dans de rares cas, il peut être prolongé jusqu'à 30 minutes.  Auparavant, une annonce n'apparaissait toujours sur le site qu'après une demi-heure. </p><br><h1 id="avito-pomoschnik">  Assistant Avito </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Avito Helper</a> est une extension pour Chrome qui affiche le prix d'un produit similaire sur Avito sur des sites tiers.  Dans l'extension, vous pouvez comparer les prix dans de nombreuses boutiques en ligne avec les prix d'Avito, ou simplement rechercher les produits et services nécessaires dans notre service, sans aller directement sur le site Web ou l'application.  Nous avons pu implémenter l '«Assistant», notamment grâce aux nouveaux changements d'infrastructure. </p><br><img src="https://habrastorage.org/webt/d5/hv/cw/d5hvcwkpl7-npnqilrei9wfcz80.png"><br><h1 id="arhitektura">  L'architecture </h1><br><h2 id="pilim-monolit">  Scier un monolithe </h2><br><p>  Avito a un monolithe en PHP.  Il y a un an, toutes les fonctionnalités de recherche qui fonctionnent dans Avito se trouvaient dans ce monolithe.  La recherche dans le monolithe a fonctionné avec quatre plates-formes: Android, iOS, la version mobile dans le navigateur et le bureau.  Pour donner la sortie, les requêtes SQL correspondantes ont été générées dans Sphinx à l'intérieur de ce code, le traitement était en cours et la sortie a été envoyée au format JSON ou HTML.  Ensuite, les utilisateurs ont vu ce qu'ils cherchaient. </p><br><img src="https://habrastorage.org/webt/cw/l_/rn/cwl_rnema8zlhzfu4gnrrgrz1jq.jpeg"><br><h2 id="chto-u-nas-seychas">  Ce que nous avons maintenant </h2><br><p>  Si vous implémentez de nouvelles fonctionnalités, il est très difficile de l'intégrer à ce monolithe.  Par conséquent, nous avons décidé de développer un service de recherche, que nous avons appelé «recherché».  Maintenant, le monolithe va à ce service de recherche et le service va à Sphinx. </p><br><img src="https://habrastorage.org/webt/wk/rf/up/wkrfupfza_kexfbo_yiafhq-lz4.jpeg"><br><h2 id="prichiny-sozdaniya-poiskovogo-servisa">  Raisons de créer un service de recherche </h2><br><p>  Lors du développement de services, vous devez toujours comprendre pourquoi vous faites cela.  Le premier avantage évident est la suppression de la logique de bas niveau.  Dans notre cas, cela cache la cuisine pour le traitement des requêtes SphinxQL.  De plus, nous pouvons fournir plus facilement des fonctionnalités de recherche aux systèmes tiers. </p><br><p>  Exécution de requête asynchrone.  Cet avantage est assez évident et selon la mise en œuvre, l'un ou l'autre succès peut être obtenu.  Notre service a été implémenté sur Golang, et il y avait des fonctionnalités qui pouvaient être parallélisées - trois demandes dans Sphinx, ce qui a donné de bons résultats. </p><br><p>  Déploiement rapide.  Nous avons identifié une fonctionnalité distincte avec moins de code, des tests supplémentaires (le monolithe a beaucoup de tests, pas seulement des fonctionnalités de recherche), et il est plus facile à déployer.  Plus important encore, grâce à une approche réussie de la mise en œuvre de ce service, nous avons pu réduire des choses intéressantes et implémenter des algorithmes de classement avancés - pour effectuer un traitement assez compliqué que nous ne pouvions pas faire dans un monolithe.  Cela nous fournit une très bonne base pour expérimenter la qualité de la recherche. </p><br><p>  En prime, nous avons la possibilité de passer de Sphinx à Elastic, car la logique de bas niveau est désormais masquée. </p><br><p>  Ce diagramme montre déjà le cas où il existe un monolithe, le service "Recherche" et le service tiers "Avito Assistant". </p><br><img src="https://habrastorage.org/webt/ed/3s/ws/ed3swsgnqulgqx9lokpg6l4po8g.jpeg"><br><h2 id="kak-rabotaet-poiskovyy-servis">  Comment fonctionne un service de recherche? </h2><br><p>  Il dispose d'un ensemble d'agrégateurs.  Chaque agrégateur exécute une certaine logique métier liée au traitement de l'émission.  Il peut former ce problème d'une certaine manière. </p><br><p>  La demande arrive au planificateur.  L'ordonnanceur sélectionne l'agrégateur en fonction des critères de requête en fonction de ses paramètres (ou si l'agrégateur souhaité est spécifié dans la demande elle-même).  L'agrégateur va à Sphinx.  Ayant reçu une réponse de Sphinx, il génère une sortie et donne la réponse au client. </p><br><img src="https://habrastorage.org/webt/f9/56/lj/f956ljoot6y6pas3k94vkb8bo3k.gif"><br><p>  Dans ce cas, la demande était à l'extérieur, pas à partir du cloud dans lequel notre service de recherche fonctionne.  Mais une autre option est également possible: certains autres de nos services, à l'intérieur du cloud, par exemple, Avito Assistant, se tournent vers un service de recherche.  Cette demande va déjà à un autre agrégateur - il existe une autre logique métier.  Voici comment cela fonctionne: </p><br><img src="https://habrastorage.org/webt/vb/gb/yu/vbgbyukk8a5yynkv5kupow23s6y.gif"><br><h2 id="kak-rabotaet-asinhronnoe-vypolnenie-zaprosov-na-agregatore">  Fonctionnement de l'exécution de requêtes asynchrones sur l'agrégateur </h2><br><p>  L'agrégateur se compose de plusieurs profils.  Un profil est, en gros, une entité dans laquelle vous pouvez obtenir une annonce d'un certain type ou d'une manière spécifique.  Par exemple, cela peut s'expliquer par une analogie: il y a des publicités «Premium», «VIP» et régulières sur Avito.  L'agrégateur reçoit une demande de l'ordonnanceur, tandis que des demandes parallèles sont exécutées pour l'ensemble de profils connus dans l'agrégateur.  Le profil contient un pilote qui accède physiquement au niveau sous-jacent, dans ce cas dans Sphinx, mais il peut s'agir de n'importe quelle autre source de données </p><br><img src="https://habrastorage.org/webt/la/np/ic/lanpiclts0oo-uhfktoxszkxl3g.jpeg"><br><p>  L'agrégateur peut simplement donner au planificateur les résultats des requêtes sur les profils, et il peut également effectuer des actions plus complexes, par exemple, mélanger ces résultats en utilisant l'un ou l'autre algorithme. </p><br><img src="https://habrastorage.org/webt/zy/_o/ji/zy_ojiffyfpbt4h9vmkcyciqsuy.jpeg"><br><h2 id="hranenie-poiskovogo-indeksa">  Stockage d'index de recherche </h2><br><p>  Étant donné que nous utilisons Kubernetes dans l'architecture, au RIT ++, on m'a posé une question sur le stockage de l'index de recherche - est-il stocké dans Kubernetes?  Non, nous avons Sphinx vivant sur des machines physiques.  Chez Kubernetes, nous déployons un service de recherche qui traite la logique de recherche.  Le cloud contient également un exemple d'index de recherche pour l'environnement de développement sur lequel les tests sont exécutés, mais il n'est pas souhaitable d'y mettre un index de combat, car les services qui fonctionnent dans Kubernetes sont, tout d'abord, des services sans état. </p><br><h2 id="nagruzka-na-poiskovyy-servis">  Charge de service de recherche </h2><br><p>  Maintenant que ce service est en bataille, il sert 100% de la charge à quelques exceptions près.  La charge qu'il détient est d'environ 200 krpm.  Délai: médiane - jusqu'à 17 ms, 95 centile - jusqu'à 120 ms, 99 centile - jusqu'à 320 ms. </p><br><img src="https://habrastorage.org/webt/bt/46/ny/bt46nyowpcuqysikxjcpp2weov8.png"><br><img src="https://habrastorage.org/webt/bn/fj/hx/bnfjhx1hqse5b4lfok8cgv3ez04.png"><br><h2 id="itogo-po-poiskovomu-servisu">  Service de recherche totale </h2><br><p>  Le service de recherche est écrit en Golang, déployé sur Kubernetes, l'agrégateur fonctionne de manière asynchrone avec plusieurs profils.  Le profil fonctionne avec le pilote spécifié, le pilote accède à la source de données spécifiée, par exemple, Sphinx.  Le nombre de demandes que notre service dessert est jusqu'à 200 krpm pour le moment.  Délai: médiane - jusqu'à 17 ms, 95 centile - jusqu'à 120 ms, 99 centile - jusqu'à 320 ms. </p><br><h2 id="vnedrenie-servisa-v-rabochuyu-sistemu">  Implémentation du service dans un système fonctionnel </h2><br><p>  Le problème de la double fonctionnalité est assez évident, nous devons prendre en charge deux bases de code qui doivent effectuer la même tâche.  Nous avons besoin d'un repli.  Nous l'avons appelé «pailles» - nous nous sommes souvenus de «jeter des pailles».  De plus, nous avons besoin d'un contrôle du trafic, il est souhaitable qu'il soit rapide, via un tableau de bord. </p><br><h2 id="kak-rabotaet-solomka">  Comment fonctionne la "paille" </h2><br><p>  La requête de recherche concerne la «Paille», qui fonctionne à l'intérieur du monolithe et peut effectuer un nouvel appel à une nouvelle recherche ou à une ancienne.  Elle appelle une nouvelle recherche, il la remplit et si elle réussit, nous obtenons simplement le résultat d'une nouvelle recherche. </p><br><img src="https://habrastorage.org/webt/y1/xa/wm/y1xawmqms1bxqtotevfsl7bfatu.gif"><br><p>  Il y a des situations où certaines requêtes au service de recherche échouent: par exemple, et jusqu'à ce qu'une sorte de fonctionnalité soit implémentée à l'intérieur du service de recherche.  Ensuite, nous engageons nécessairement une telle demande - "The Straw" l'exécutera dans l'ancienne recherche.  L'ancienne recherche du monolithe se tournera vers Sphinx, et la réponse ira au client.  Le client ne ressentira rien. </p><br><img src="https://habrastorage.org/webt/cr/zu/za/crzuzaufpka6dvpjsjy_m5qq0jc.gif"><br><p>  Un schéma assez fiable, et il est toujours intéressant de voir ce qui se passe dans la pratique.  Le département d'architecture d'Avito améliore constamment notre cloud, l'optimisant, le rendant plus fiable et plus productif.  À un certain stade, il y avait des problèmes lors de l'entretien d'un des nœuds avec une intensité suffisamment élevée, des erreurs provenaient du monolithe (100 erreurs par seconde). </p><br><img src="https://habrastorage.org/webt/tu/zv/wm/tuzvwmgmpzid5objz-4bmvl157y.png"><br><p>  Dans le même temps, le délai de service a fortement augmenté - dans l'image ci-dessous, vous pouvez voir des pics. </p><br><img src="https://habrastorage.org/webt/pq/of/z5/pqofz5fynz2bsibynewd3gro2cw.png"><br><p>  La «paille» a remarquablement résolu cette situation, et les erreurs HTTP résultantes étaient au même niveau - une unité d'erreurs pour l'ensemble de l'Avito.  Nos visiteurs n'ont rien remarqué. </p><br><img src="https://habrastorage.org/webt/wx/ya/ij/wxyaij2xka5dhghoa74ovncverq.png"><br><h2 id="avtomatizaciya-eksperimentov">  Automatisation des expériences </h2><br><p>  Nous voulons que la recherche se développe rapidement et que le déploiement de nouvelles fonctionnalités soit plus facile.  Pour cela, une infrastructure appropriée est nécessaire.  Nous avons configuré l'automatisation des tests A / B.  À l'aide du tableau de bord, nous pouvons démarrer de nouvelles expériences, les configurer en fonction des innovations ajoutées et, par conséquent, exécuter des expériences sans faire rouler le monolithe. </p><br><p>  Dans l'état initial, lorsqu'aucune expérience n'était lancée, tous les visiteurs voient la fonctionnalité de recherche habituelle. </p><br><img src="https://habrastorage.org/webt/go/rz/qp/gorzqpca1whra33-df1c6ss18yk.jpeg"><br><p>  Dans une expérience typique, les utilisateurs sont divisés en groupes.  Le groupe de contrôle - avec les fonctionnalités habituelles pour nos visiteurs.  Il existe plusieurs groupes de tests - avec des innovations.  Lorsque nous devons créer une nouvelle expérience, dans le service de recherche, nous implémentons une nouvelle fonctionnalité de recherche (ajouter de nouveaux agrégateurs) et via le tableau de bord, nous configurons l'expérience avec les groupes nécessaires, en les reliant à de nouveaux agrégateurs. </p><br><p>  Lors de l'analyse des expériences, nous comparons le comportement des visiteurs du groupe témoin avec ceux du test et, sur cette base, nous tirons des conclusions sur le succès de l'expérience. </p><br><img src="https://habrastorage.org/webt/gd/g5/r2/gdg5r20saoh4inq46d5jggjcxee.gif"><br><p>  Supposons que nous ayons développé une nouvelle formule de classement.  Que devons-nous faire pour l'expérimenter? </p><br><ol><li>  Dans le service de recherche, déployez l'agrégateur approprié (que ce soit «Aggregator 2»). </li><li>  Créez une expérience via un tableau de bord et connectez l'un des groupes de cette expérience à cet agrégateur. </li><li>  Maintenant, si une requête arrive dans la recherche qui tombe dans le groupe de test, elle va au service de recherche sur «Aggregator 2». </li></ol><br><p>  Nous pouvons continuer à créer de nouvelles expériences et associer leurs groupes de tests à de nouveaux agrégateurs. </p><br><h1 id="itogo-po-infrastrukture-poiska">  Infrastructure de recherche totale </h1><br><p>  Il existe un cluster de serveurs Sphinx 3. Il contient 13 krps de requêtes SphinxQL et contient plus de 45 millions d'annonces actives. </p><br><p>  Sphinx 3.0 est stable et satisfait de ses performances.  Soit dit en passant, les binaires sont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans le domaine public</a> .  De plus, grâce à Avito, de nouvelles fonctionnalités sont filmées dans Sphinx 3, par exemple, le fonctionnement du produit scalaire des vecteurs, et les bugs trouvés sont corrigés. </p><br><p>  Nous utilisons une architecture de service.  Nous avons le service de recherche "Iskalo" et le service "Avito Assistant".  Une partie de la fonctionnalité est restée dans le monolithe, mais nous continuons à travailler sur sa découpe. </p><br><h1 id="vyvody">  Conclusions </h1><br><p>  Au cours de la dernière année, un système de développement de fonctionnalités de recherche avancées a été reçu.  Nous avons eu l'opportunité de mener des expériences rapides et flexibles.  Et maintenant, la recherche d'utilisateurs est devenue plus pratique, plus rapide et permet de mieux résoudre leurs problèmes. </p><br><h1 id="chto-dalshe">  Et ensuite </h1><br><p>  De plus, nous continuerons à retirer du monolithe ce qui reste: rendu, filtres.  Nous travaillerons pour améliorer la qualité de la recherche, continuerons à ravir nos visiteurs.  J'espère aussi. </p><br><p>  Si vous avez des questions sur le travail de notre recherche, nous aimerions en savoir plus de détails techniques, écrivez dans les commentaires.  Je répondrai avec plaisir.  À propos, récemment, Andrey Drozdov a parlé à Highload ++ 2018 avec un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rapport sur l'optimisation multicritère des résultats de recherche</a> , voici sa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">présentation</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr429076/">https://habr.com/ru/post/fr429076/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr429066/index.html">Comment l'équipage de l'aéronef se prépare au départ</a></li>
<li><a href="../fr429068/index.html">Un poste très corporate: ouverture à Moscou ou pourquoi les 10 et 11 novembre sont de bons jours pour acheter de l'électronique</a></li>
<li><a href="../fr429070/index.html">Linux ne peut pas être chargé sur de nouveaux MacBook en raison de la puce T2</a></li>
<li><a href="../fr429072/index.html">Pourquoi Kodak est mort et Fujifilm s'est épanoui: l'histoire de deux cinéastes</a></li>
<li><a href="../fr429074/index.html">Bonnes actions pour Google Money: nouveau défi d'impact sur l'IA</a></li>
<li><a href="../fr429078/index.html">Comment créer de l'art procédural en moins de 100 lignes de code</a></li>
<li><a href="../fr429082/index.html">La Thaïlande sans stéréotypes</a></li>
<li><a href="../fr429084/index.html">La deuxième vie du four électrique "Kharkov"</a></li>
<li><a href="../fr429086/index.html">Fête de la bière de sauvegarde</a></li>
<li><a href="../fr429088/index.html">Exécution de requêtes GraphQL avec OdataToEntity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>