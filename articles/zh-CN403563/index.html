<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤰🏼 💆 👩‍✈️ PKCS＃11加密云服务：从神话到现实 🌱 🙍🏼 👴🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2016年，发表了文章“ PKCS＃11云令牌-神话还是现实？” 。 。 六个月后，现在在互联网上出现了一个云（云服务），任何人都可以得到支持俄罗斯密码的个人PKCS＃11云令牌。 

 前言 
 回想一下，PKCS＃11（Cryptoki）是由RSA实验室开发的标准，用于使用通过库实现的统一软件接...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PKCS＃11加密云服务：从神话到现实</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/403563/"><img src="https://habrastorage.org/files/38a/7c8/938/38a7c8938dd94d61843617b336937516.png" alt="图片" align="left" vspace="5" width="100">  2016年，发表了文章<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ PKCS＃11云令牌-神话还是现实？”</a> 。  。 六个月后，现在在互联网上出现了一个云（云服务），任何人都可以得到支持俄罗斯密码的个人PKCS＃11云令牌。 <br><a name="habracut"></a><br><h3>  <font color="blue">前言</font> </h3><br> 回想一下，PKCS＃11（Cryptoki）是由RSA实验室开发的标准，用于使用通过库实现的统一软件接口与加密令牌，智能卡和其他类似设备进行程序交互。 <br><br> 加密令牌提供了证书和密钥对（公用和专用密钥）的存储，以及根据PKCS＃11标准的加密操作。 <br><br><img src="https://habrastorage.org/files/e79/f6f/2af/e79f6f2af7834cc7abc5914e4ce190ee.png" alt="图片" align="right" vspace="5" width="200"> 因此，在互联网上出现了云服务LS11CLOUD，它是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PKCS＃11</a>标准v.2.40的云实现，并根据标准化技术委员会（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">TC 26</a> ）开发的规范``加密信息保护''对俄罗斯加密算法的支持进行了补充。  LS11CLOUD云服务支持算法GOST R 34.10-2012，GOST R 34.11-2012，GOST R 34.12-2015和GOST R 34.13-2015以及TC 26的管理文档定义的相关算法和参数。 <br><br> 云令牌的毋庸置疑的优势在于，现在用户无需携带令牌/智能卡，就可以确保其安全性。 用户将私有令牌存储在云中后，便可以从其家用计算机，笔记本电脑和移动设备访问它。 <br><br> 使用TC 26建议的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SESPAKE</a> （安全性经过评估的标准密码验证的密钥交换）验证协议，可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">确保</a>通过加密的网络通道与受保护的加密对象的个人容器（令牌）进行安全的远程交互。 <br><br> 在用户方面，具有标准pkcs＃11编程接口的ls11cloud动态库提供了基本功能。 要接收个人云令牌，用户必须在LS11CLOUD云服务上注册，然后在云服务上初始化和配置个人令牌。 <br><br><h3>  <font color="green">用户在云服务上的注册</font> </h3><br> 首先，我们注意到LS11CLOUD云令牌位于pkcs11.ru，并接受对端口4444的请求。 <br><br> 如前所述，服务器上的用户注册和帐户维护由<i>ls11cloud_config</i>实用程序执行： <br><br><pre><code class="bash hljs">$ ./ls11cloud_config LS11CLOUD User Utility Usage: ls11cloud_config &lt;<span class="hljs-built_in"><span class="hljs-built_in">command</span></span>&gt; [-p &lt;password&gt;] [-n &lt;new password&gt;] NB: Use -n &lt;new password&gt; with change_pswd <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> only! Commands: register &lt;host&gt; &lt;port&gt; &lt;id&gt; - register new user on the server duplicate &lt;host&gt; &lt;port&gt; &lt;id&gt; - duplicate user account on other computer change_pswd - change SESPAKE authentication password status - display current configuration data <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> - display server <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> file recreate - re-create token to initial empty state unregister - remove all user files from the server NB: Don<span class="hljs-string"><span class="hljs-string">'t use non-latin letters to avoid encoding problems! $</span></span></code> </pre> <br> 在用户注册期间，指示了云服务的位置（“主机”字段），与外界进行通信的端口（“端口”字段）以及用户的昵称（“ id”字段）： <br><br><pre> <code class="bash hljs"> bash-4.3$ ls11cloud_config register pkcs11.ru 4444 HABRAHABR</code> </pre> <br> 为了从Linux，Windows和OS X（macOS）平台进行注册，有一个带有实用程序的图形实用程序，带有直观的guils11cloud_conf界面： <br><br><img src="https://habrastorage.org/webt/zy/q0/a7/zyq0a7nn4ozoackahs4tgljce_i.png" alt="图片"><br><br> 用户可以获取分配 <div class="spoiler">  <b class="spoiler_title">在这里：</b> <div class="spoiler_text"><ul><li>  <a href="">Linux32</a> </li><li>  <a href="">Linux64</a> </li><li>  <a href="">OS X</a> </li><li>  <a href="">WIN32</a> </li><li>  <a href="">WIN64</a> </li></ul><br></div></div><br> 因此，让我们开始测试PKCS＃11云令牌中俄罗斯加密的实现。 <br> 下载后，必须运行<b>guils11cloud_conf</b>图形实用程序并遵循其说明： <br><br><img src="https://habrastorage.org/webt/sa/ho/lc/saholcvbm9xy537mkcwi6z93viw.png" alt="图片"><br><br> 如果您尚未从该工作站向云令牌注册，则会提示您创建令牌或连接到先前创建的令牌（请参见屏幕截图）。 要在云中进行初始注册，请单击“在云中注册”按钮： <br><br><img src="https://habrastorage.org/webt/zg/w7/3i/zgw73iyhasobz2jcx-gbienrw-g.png" alt="图片"><br><br>  “用户登录名”是用于在云中注册用户的登录名。 <br> 需要使用密码来创建从用户的应用程序到云中他的个人令牌的安全通道（SESPAKE协议）。 用户每次访问云中的令牌时都将要求输入密码，除非用户在云中成功注册后立即将其保存： <br><br><img src="https://habrastorage.org/webt/sx/v5/lg/sxv5lgjbjquonao05qaagmt1nkq.png" alt="图片"><br><br> 成功注册用户后，将为他创建一个带有SO-PIN 87654321的新令牌： <br><br><img src="https://habrastorage.org/webt/kk/a9/_m/kka9_m3y1eb7nejym6osxxjuiv0.png" alt="图片"><br><br><h3>  <font color="green">令牌初始化</font> </h3><br> 单击“确定”按钮后，将出现一个表格，其中有必要指示令牌标签（默认情况下，它与用户在云中的登录名匹配）以及用户可以访问云令牌的PIN码： <br><br><img src="https://habrastorage.org/webt/o-/8t/_r/o-8t_riuuybmfs6wkgntphs5ja4.png" alt="图片"><br><br> 单击“完成”按钮后，云令牌即可开始工作： <br><br><img src="https://habrastorage.org/webt/iw/va/gf/iwvagfqlqa2z7jfdokafkpi_tpc.png" alt="图片"><br><br> 将来， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">p11conf实用程序将</a>用于配置云令牌，就像配置其他任何PKCS＃11令牌/智能卡一样： <br><br><img src="https://habrastorage.org/webt/xe/aq/cc/xeaqcchksewr2ucyjsxw5dbpsc8.png" alt="图片"><br><br> 如果您想在另一台计算机上使用创建的云令牌，那么您要做的就是运行图形实用程序guils11cloud_config并单击“重复令牌”按钮： <br><br><img src="https://habrastorage.org/webt/q-/ct/4t/q-ct4tulb8vimwfr5kg15cvmuyw.png" alt="图片"><br><br> 之后，请记住您在云中进行注册的登录名和用于访问的密码。 通过单击“完成”按钮，您将可以访问令牌： <br><br><img src="https://habrastorage.org/webt/il/ug/z5/ilugz5vo0m9dcnkcsudjt9mdu7m.png" alt="图片"><br><br><h3>  <font color="green">在云令牌中安装第一个个人证书</font> </h3><br> 现在我们已经在云中注册并在其中创建了自己的个人云令牌，我们可以开始使用它了。 为了进行测试，让我们以基于Mozilla Firefox和Mozilla Thunderbird的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Redfox-52</a>浏览器和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Redfoxmail-52</a>电子邮件客户端<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">为例</a> ，它们在PKCS＃11令牌/智能卡上支持俄语加密。 <br><br> 我们将在WIN32平台上进行测试。 <br><br> 首先，您需要下载并安装Redfox-52。 要安装Redfox浏览器，您需要下载存档并解压缩。 <br><br> 将解压缩的Mozilla Firefox文件夹移动到方便的位置。 然后为firefox.exe可执行文件（位于Mozilla Firefox文件夹内）创建快捷方式，并将其放在任何方便的位置。 <br><br> 启动浏览器后，您需要通过将ls11cloud.dll库添加到设备来连接创建的云令牌： <br><br><img src="https://habrastorage.org/files/100/656/b89/100656b89c0f4bb5b3a48343a5452574.png" alt="图片"><br><br> 请注意，MS Windows的浏览器发行版是为Win32平台构建的。 因此，ls11cloud.dll库也应用于Win32平台。 <br><br> 在将浏览器使用的加密设备中包含云令牌之后，我们可以开始对其进行测试。 在第一阶段，您必须至少获得一个个人证书。 为此，我们使用测试CA之一的服务： <br><br><img src="https://habrastorage.org/files/aa7/f64/f9d/aa7f64f9d4db4dd0b3e5dce5d8e33400.png" alt="图片"><br><br> 当您单击继续按钮时，CA将提供验证应用程序数据的信息，然后选择一个加密设备（令牌/智能卡）来生成密钥对并存储个人证书： <br><br><img src="https://habrastorage.org/files/676/bb1/c00/676bb1c00f384190beca14a1968c9aa0.png" alt="图片"><br><br> 自然地，选择了一个云令牌，然后单击“继续”按钮后，将不仅提供该令牌以接收您的应用程序生成的个人证书，而且还可以安装/保存CA根证书： <br><br><img src="https://habrastorage.org/files/485/5a4/6bf/4855a46bf65d471d97f7e45eecd77705.png" alt="图片"><br><br> 您可以通过查看浏览器证书存储来验证证书安装： <br><br><img src="https://habrastorage.org/files/9f0/f40/0fa/9f0f400fa9614cc09d6c2e41565ed11b.png" alt="图片"><br><br><h3>  <font color="green">测试HTTPS和PKCS＃12</font> </h3><br> 因此，云令牌机制起作用。 现在，让我们检查在俄语加密的授权https模式下云令牌的运行情况： <br><br><img src="https://habrastorage.org/files/c31/dab/6d0/c31dab6d0ff1496f864297aff26e1a50.png" alt="图片"><br><br> 为了在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CryptoPro测试页</a>上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">测试</a>云令牌的运行<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">，我们将</a>使用先前在CryptoPro测试中心获得并上传到PKCS＃12容器的测试证书。 首先，您需要下载<a href="">PKCS＃12格式</a>的<a href="">证书</a>并将其安装在云令牌上（PKCS＃12容器的密码是01234567）： <br><br><img src="https://habrastorage.org/files/2d8/12f/6a2/2d812f6a2ee0485d8632c7c47690c100.png" alt="图片"><br><br> 作为存储设备，您必须选择一个云令牌： <br><br><img src="https://habrastorage.org/files/a57/3f5/689/a573f56896f846b3b6da4b7e9783149b.png" alt="图片"><br><br> 然后，您将需要输入PIN来访问令牌，即PKCS＃12的密码。 结果，证书将在令牌上： <br><br><img src="https://habrastorage.org/files/d8b/a46/7ac/d8ba467ac3c14a60bb23ec1f5858ebcd.png" alt="图片"><br><br> 同时，不要忘记在CryptoPro CA的根证书中设置信任级别： <br><br><img src="https://habrastorage.org/files/2d8/12f/6a2/2d812f6a2ee0485d8632c7c47690c100.png" alt="图片"><br><br> 现在，您可以安全地转到CryptoPro测试页，例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">，在这里</a> ： <br><br><img src="https://habrastorage.org/files/cb9/57e/de2/cb957ede2deb44d9a74972540381e9b2.png" alt="图片"><br><br><h3>  <font color="green">使用云令牌组织安全的电子邮件通信</font> </h3><br> 现在，让我们看看云令牌在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Redfoxmail / Thunderbird</a>邮件客户端中如何工作。 <br> 要在WIN32平台上安装Mozilla Thunderbird邮件客户端，您需要下载thunderbird-52.0-gost存档并将其解压缩。 将解压缩的Mozilla Thunderbird文件夹移动到方便的位置。 <br><br> 然后为thunderbird.exe可执行文件（位于Mozilla Thunderbird文件夹中）创建快捷方式，并将其放在任何方便的位置。 启动邮件客户端后，我们连接云令牌，类似于对Redfox浏览器的操作： <br><br><img src="https://habrastorage.org/files/d2e/9ed/599/d2e9ed5996c346398aa73975c7ae39e9.png" alt="图片"><br><br> 连接云令牌后，存储在其中的证书将变为可用。 但是，这可能还不够-必须安装颁发个人证书的CA根证书。 这就是为什么我们在发布期间保存了根证书的原因： <br><br><img src="https://habrastorage.org/files/af5/ea6/00d/af5ea600d0304616a8ebf85010ba20c5.png" alt="图片"><br><br> 现在，在帐户设置中，您需要安装将用于签名和加密字母的证书： <br><br><img src="https://habrastorage.org/files/495/81e/75f/49581e75fd554f0a8ade50432ede149d.png" alt="图片"><br><br> 现在，您可以安全地签名消息了： <br><br><img src="https://habrastorage.org/files/30c/9a2/eea/30c9a2eea59b48cf8b204731e8bd3d79.png" alt="图片"><br><br> 任何支持俄语加密的电子邮件客户端都可以接受此消息，例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">KMail</a> ： <br><br><img src="https://habrastorage.org/files/4d4/b4e/d13/4d4b4ed13d3f4dd4955b8a3d4e7112c6.png" alt="图片"><br><br><h3>  <font color="blue">结论</font> </h3><br> 因此，我们可以说神话正在变成现实。  LS11CLOUD云令牌的主要范围可以是内部文档管理，安全邮件和银行业务。 <br> 带有云令牌的云服务LS11CLOUD对于使用PKCS＃11令牌/智能卡的应用程序开发人员而言非常有用。 <br><br><img src="https://habrastorage.org/files/123/d83/4d8/123d834d8d0f4e8ca4418863139cf7ce.png" alt="图片" align="left">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">附言：</a>我将个人证书放在云令牌中，将其连接到公共服务插件，并通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GOSUSLOG门户</a>支付了税款。  OC-Linux。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN403563/">https://habr.com/ru/post/zh-CN403563/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN403553/index.html">个性和声音：赫尔曼·路德维希·亥姆霍兹-从基础物理学到听觉和心理声学的生理学</a></li>
<li><a href="../zh-CN403555/index.html">三个像人一样柔软的医疗机器人</a></li>
<li><a href="../zh-CN403557/index.html">维修：如何从工艺中提高，而不是从油漆中提高</a></li>
<li><a href="../zh-CN403559/index.html">一台设备的历史：通过技术创造力进行知识控制的途径</a></li>
<li><a href="../zh-CN403561/index.html">发射NROL-76并登陆Falcon-9级</a></li>
<li><a href="../zh-CN403565/index.html">电网可以成为5G时代的导体</a></li>
<li><a href="../zh-CN403567/index.html">数字办公室印刷趋势</a></li>
<li><a href="../zh-CN403569/index.html">驾驶盾Ilona Mask到达了SpaceX停车场的维修区</a></li>
<li><a href="../zh-CN403571/index.html">在埃塞俄比亚，通过终端分发盗版电影</a></li>
<li><a href="../zh-CN403575/index.html">keymemo.next-完全开放的跨平台密码管理器</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>