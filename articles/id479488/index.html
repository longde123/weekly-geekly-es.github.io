<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤺 🔅 🐇 Dari laptop - server rumah dengan daya redundan ke router Mikrotik ✍🏿 👨🏿‍🎨 🕳️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Secara singkat 
 Sebuah artikel untuk penggemar untuk menyolder skema sederhana sendiri dan mencari tahu mengapa mereka dibuat seperti itu. 

 Dan jug...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dari laptop - server rumah dengan daya redundan ke router Mikrotik</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479488/"><img src="https://habrastorage.org/webt/pl/gi/hh/plgihhkmxbo7cvnzhnbtwwdi85w.jpeg"><br><br><h1>  Secara singkat </h1><br>  Sebuah artikel untuk penggemar untuk menyolder skema sederhana sendiri dan mencari tahu mengapa mereka dibuat seperti itu. <br><br>  Dan juga bagi mereka yang benar-benar membutuhkan server seperti itu. <br><br>  Tidak ada pencapaian super di sini, tetapi ada solusi yang murah, ringkas, dan ekonomis, yang dalam beberapa kasus menggantikan banyak peralatan: <br><br><ul><li>  membuat server rumah dari laptop lama dan perangkat daya router, </li><li>  menjelaskan skema daya router dari pengisian dan baterai laptop, </li><li>  Skema untuk menyalakan laptop ketika daya dihidupkan dijelaskan. </li></ul><a name="habracut"></a><br><h1>  Ide </h1><br>  Saya membutuhkan server file kecil, yang juga harus menahan pemadaman listrik hingga 15 menit. <br><br>  Saya memutuskan untuk membuatnya dari laptop lama. <br><br>  Laptop (Asus A8J) khusus dibeli untuk percobaan dengan matriks yang rusak, tetapi dengan baterai dan kipas yang hidup. <br><br>  <i>(Catatan: jika Anda sudah memiliki laptop, maka, seperti pada tugas yang terkenal tentang ketel, tidak perlu memecahkan matriks. Namun, jika router Anda, seperti milik saya, bekerja dengan modem 4G, maka lebih baik untuk menonaktifkan matriks, maka saya akan menjelaskan alasannya.</i> <i><br><br></i>  <i>Bekerja tanpa matriks tidak menciptakan ketidaknyamanan, pertama-tama menggunakan monitor eksternal, dan kemudian SSH.)</i> <br><br>  Dalam prosesnya, saya menarik perhatian pada kenyataan bahwa router Mikrotik (saya punya RB-951G) dapat ditenagai dari 9 hingga 30 V, dan muncul ide untuk memberinya makan dari laptop. <br><br>  Ternyata menjadi kombinasi yang sangat sukses: di hadapan tegangan listrik, router ditenagai dari pengisi daya laptop (19-20 V), dan jika terjadi kegagalan listrik, dari baterai laptop yang sama (dari 12 hingga 9 V saat habis), yaitu.  semuanya dalam batas normal. <br><br>  <i>Lebih tepatnya, tegangan pada router akan menjadi 0,2-0,4 V lebih rendah karena penurunan pada dioda, tetapi masih dalam kisaran yang dapat diterima (kecuali untuk batas lebih rendah dari debit baterai, yang kita tidak tahu pasti, tetapi dalam kasus saya itu tidak mungkin untuk mencapainya. .</i> <i><br><br></i>  <i>Dan jika itu terjadi, maka tidak ada hal buruk yang akan terjadi pada router).</i> <br><br><h1>  Skema Daya Router </h1><br><img src="https://habrastorage.org/webt/x8/ym/3x/x8ym3xsabcnw62ea6dmynhylwic.jpeg"><br><br>  Karena tegangan yang lebih tinggi (20V) diutamakan di sini, rangkaian switching sangat sederhana, terdiri dari dua dioda. <br><br>  Juga nyaman bahwa tidak ada perlindungan tegangan yang diperlukan. <br><br>  Jika jaringan tidak ada dalam waktu yang lama, baterai akan habis ke batas di mana pengontrol bawaannya akan memutuskan beban dan dengan demikian pengisian berlebih tidak akan terjadi. <br><br>  Kemudian, ketika daya listrik diterapkan, baterai akan mulai mengisi, dan router akan ditenagai oleh pengisi daya. <br><br>  <i>Secara teoritis, dalam kasus yang gagal, kita dapat melebihi arus yang diizinkan dari pengisi daya dan / atau baterai (karena kita mengambil 0,4-0,8A ekstra ke router pada 20V), tetapi dalam praktiknya kelebihan arus tidak akan terjadi, dan inilah sebabnya: Saya melepas drive DVD dari laptop, controller WIFI, serta matriks.</i>  <i>Dengan demikian, konsumsi saat ini menurun.</i> <br><br>  Untuk mengurangi kehilangan tegangan, kami memilih dioda Schottky, dan secara khusus, saya mengambil perakitan dua dioda (saya tidak ingat jenisnya), yang ada dalam catu daya komputer dan terlihat seperti transistor yang kuat. <br><br>  <i>Konsumsi router saat ini bersama dengan modem 4G yang termasuk di dalamnya bisa mencapai 1,7A dalam kasus terburuk - saat ditenagai dari 9V.</i> <i><br><br></i>  <i>(Catu daya switching di dalam router mengkonsumsi daya konstan, sehingga semakin rendah tegangan input, semakin besar konsumsi saat ini).</i> <br><br>  Assembly diode menahan arus kontinu 20A, dan ini juga nyaman. <br><br>  Anda tidak perlu melakukan proteksi terhadap korsleting keluaran.  Peran ini, jika ada, akan dimainkan oleh sirkuit pengisian internal dan perlindungan baterai. <br><br>  Jika seseorang ingin menggunakan dioda Schottky yang terpisah, Anda perlu mengambilnya untuk arus setidaknya 5A dan setidaknya sedikit dingin, misalnya, melalui trek di papan tulis. <br><br><h1>  Sirkuit notebook </h1><br><img src="https://habrastorage.org/webt/tz/lz/aw/tzlzawj3w4knkung90wa0vakney.jpeg"><br><br>  Tetapi ada masalah lain: laptop itu sendiri tidak menyala ketika tegangan listrik muncul.  <i>Tidak ada opsi seperti itu di BIOS.</i>  <i>(Untuk beberapa alasan, banyak laptop tidak memiliki sejumlah fungsi yang berguna, misalnya, mereka masih tidak memiliki boot dari kartu memori).</i> <br><br>  Meskipun gangguan seperti itu untuk benar-benar mengeluarkan baterai, kami praktis tidak terjadi, tetapi saya sudah ingin menyelesaikan pertanyaan ini. <br><br>  Di laptop saya, tombol daya menutup input rangkaian ke daya minus (Anda, kemungkinan besar juga). <br><br>  Pada input yang sama, saya menyolder kawat dari konektor perangkat saya. <br><br>  Di perangkat, input ini ditutup oleh transistor minus, laptop menyala. <br><br>  Untuk melindungi transistor jika terjadi koneksi yang tidak tepat, resistor R8 telah ditambahkan ke sirkuit kolektor. <br><br>  Diperiksa bahwa laptop menyala secara stabil bahkan dengan peningkatan 3 kali lipat pada resistor ini.  (Ini juga lebih baik bagi Anda untuk memeriksa laptop Anda, karena parameter input tombol dapat bervariasi). <br><br>  Untuk mengontrol transistor, generator pulsa RC dibuat pada chip CD4093 dengan pemicu Schmitt, dan elemen R4, R5, C3.  Durasi pulsa dan jeda selama sekitar 1 detik, keakuratannya tidak penting. <br><br>  Penting bahwa pengoperasian generator dimulai dengan jeda. <br><br>  <i>Dan inilah mengapa saya membuat generator pulsa: laptop saya terkadang tidak menyala ketika saya menekan tombol untuk pertama kalinya, tetapi dinyalakan ketika saya menekan yang kedua, saya tidak tahu mengapa.</i>  <i>Bagaimanapun, itu merupakan solusi universal dan andal.</i> <br><br>  Ketika laptop dihidupkan, Anda tidak perlu lagi "menekan" tombol, dan kami menghentikan generator. <br><br>  Rangkaian belajar tentang menyalakan laptop menggunakan kawat lain yang disolder ke + 5V dari konektor USB apa pun. <br><br>  <i>Laptop saya hanya memasok + 5V ke USB saat dihidupkan.</i> <i><br><br></i>  <i>(Jika tegangan USB Anda selalu ada ketika dihidupkan dari jaringan, Anda harus mematikan opsi yang sesuai di BIOS, atau mencari titik koneksi lain untuk sinyal ini).</i> <br>  Microcircuit ini ditenagai dari input + 20V melalui stabilizer paling sederhana dari R1 dan VD3, dan C2 untuk berjaga-jaga untuk melindungi dari pulsa daya. <br><br>  Kekuatan sirkuit ini dari + 5V USB juga dibuat sehingga ketika daya utama gagal, daya generator tidak turun dan pulsa palsu terbentuk yang dapat mematikan laptop. <br><br>  Kedua catu daya disuplai ke sirkuit mikro melalui rangkaian paling sederhana pada dua dioda VD1, VD2, sama seperti pada router, hanya berdaya sangat rendah. <br><br><h1>  Konstruksi </h1><br><img src="https://habrastorage.org/webt/bg/i3/eb/bgi3ebghkos-hpssa5w7wrsrsie.jpeg"><br><br>  Konektornya adalah 10-pin: PLD-10 + PBD-10, 2 kabel secara paralel digunakan pada kabel daya. <br><br>  Dari 4 sisanya, dua ditempati oleh input tombol dan + 5V USB, 2 lainnya tidak digunakan. <br><br>  <i>Lokasi kontak dipilih sehingga jika Anda menghidupkan konektor di posisi terbalik, maka tidak ada yang akan terbakar, router akan diaktifkan, dan fungsi untuk menghidupkan laptop tidak akan berfungsi.</i> <br><br>  Perangkat ini dipasang di papan tempat memotong roti dan ditempatkan di tabung panas menyusut. <br><br>  Tidak diperlukan pendinginan tambahan. <br>  Anda dapat menempatkannya di kompartemen tempat drive DVD berada. <br>  Bagian dapat diganti dengan analog dalam rentang yang sangat luas. <br>  Saya tidak memberikan foto umum, karena  laptop rusak dan mereka semua melihatnya. <br><br><h1>  Apa yang terjadi </h1><br><img src="https://habrastorage.org/webt/q0/ym/hx/q0ymhxprycrw8yq0wg_h-szf8ue.jpeg"><br><br>  Sudah bekerja selama sebulan. <br><br>  Konsumsi setidaknya 13 watt (diukur dengan meteran listrik), dengan pekerjaan aktif meningkat menjadi 25 watt. <br><br>  2 gangguan perangkat keras terdeteksi: <br><br>  Kesalahan No. 1: jika Anda mematikan konektor pengisian daya dari laptop, maka kadang-kadang laptop mati secara instan. <br><br>  <i>Kemungkinan besar, ini karena fakta bahwa saya menjalankan kawat dari pengisian ke perangkat langsung di papan, dan bahkan dengan + 5V USB dan kabel dari tombol.</i> <i><br><br></i>  <i>Ketika Anda mencabut konektor pengisian daya pada kabel, serangkaian pulsa yang agak “curam” turun dari +19 ke + 12V dan sebaliknya, dan bahkan dengan “pantulan”, dan ini melalui kapasitansi kabel dapat mengganggu sirkuit laptop lainnya.</i> <i><br><br></i>  <i>Tetapi kemudian, jika Anda tidak mencabut konektor ini, dan memutuskan pengisian daya dari jaringan, maka tidak ada hal buruk yang terjadi.</i>  <i>Rupanya, maka tegangan pada kabel duduk perlahan karena kapasitor dalam pengisian, dan gangguan tidak terjadi.</i> <br><br>  Saya tidak memperbaiki instalasi, tetapi secara umum, tentu saja, tidak layak meletakkan kabel di papan sirkuit seperti yang saya lakukan.  Entah bagaimana mereka harus dilindungi atau dibawa keluar laptop atau setidaknya jauh dari papan.  (Sedikit fakta bahwa semua kabel saya memiliki tegangan konstan). <br>  Kapasitor C1 yang ditambahkan antara minus dan plus pengisian, tampaknya kesalahan No. 1 menghilang. <br><br>  Glitch No. 2: Laptop tidak dapat dimatikan dengan tombol. <br><br>  Untuk mematikan laptop dengan benar, pertama-tama matikan catu daya (untuk berjaga-jaga, lepaskan pengisian daya dari jaringan, bukan dari laptop, seperti yang sudah kita ketahui dari pengalaman sebelumnya). <br>  Dan kemudian kita tekan tombol power.  OS dimatikan dan mematikan laptop. <br><br>  TAPI.  Pada saat ini, masih ada tegangan pada kapasitor daya USB (dengan tidak adanya perangkat yang mengkonsumsi) di laptop, perlahan-lahan duduk, dan di beberapa titik sirkuit memberikan dorongan palsu ke tombol dan laptop menyala lagi! <br><br>  <i>Untuk mencegah hal ini terjadi, resistor R2 ditambahkan, yang mengatur untuk melepaskan kapasitor dalam sedetik, dan semuanya menjadi normal.</i>  <i>Jika Anda memiliki masalah seperti itu, maka resistansi harus dikurangi dengan faktor 2. Tidak layak melakukan resistor terlalu rendah, karena</i>  <i>dia akan berjemur.</i> <i><br><br></i>  <i>Ini praktis tidak menambah konsumsi energi.</i> <br><br><h1>  OS dan program </h1><br>  Saya menginstal server Ubuntu 14.04 dan mengkonfigurasi samba, semuanya berfungsi dan ini sudah cukup untuk saat ini. <br><br>  Ada beberapa kelemahan berikut: <br><br>  1) Kipas laptop sangat bising terlepas dari beban prosesor. <br><br>  Saya mencoba program fancontrol, tetapi dia tidak dapat menemukan akses ke kontrol kipas. <br>  Dalam proses menggali Internet, program lain ditemukan: asusfan, yang pernah dibuat orang baik-baik untuk model laptop saya.  Ini bekerja segera setelah kompilasi dan instalasi, dan sekarang kipas angin secara otomatis diatur dan membuat sedikit kebisingan, dan sumber daya dihemat. <br><br>  2) Tidak mungkin untuk menghentikan hard drive untuk malam dengan perintah hdparm -S 241 / dev / sda. <br><br>  Program logging jbd2 “menariknya” setiap 5-10 menit, bahkan ketika tidak ada tindakan yang dilakukan selama satu jam. <br><br>  Forum menulis bahwa ini adalah masalah yang tidak dapat dipulihkan dengan sistem file ext4 atau implementasinya di Ubuntu. <br><br>  Lalu saya akan mencoba untuk beralih ke xfs (atau mungkin ke SSD), tetapi untuk sekarang - "Begitulah!" (C). <br><br><h1>  Gagasan lebih lanjut (yang akan tetap pada tahap ini) </h1><br><ul><li>  Buat sirkuit independen pada beberapa perangkat seperti "GSM-relay" untuk mem-boot ulang sistem. </li><li>  Buat pada perangkat GSM yang sama sebuah sirkuit untuk menghubungkan USB flash drive dari jarak jauh dengan sistem "cadangan" sehingga Anda dapat mem-boot darinya dan memperbaiki sesuatu dalam konfigurasi jika sistem utama tidak bisa boot. </li></ul><br>  Mengapa melalui GSM, bukan Ethernet? <br><br>  Pertama, karena kemungkinan kerentanan pengontrol Ethernet, yang saya dengar di suatu tempat. <br>  Kedua, Anda mungkin perlu me-restart router, mis.  membutuhkan skema independen. <br><br>  Tetapi router Mikrotik dalam hal ini cukup dapat diandalkan dan karenanya ini sebenarnya tidak perlu, dan server juga tampaknya bekerja tanpa pertanyaan. <br><br><h1>  Ucapan Terima Kasih </h1><br>  Router membantu saya (hingga 99%) mengkonfigurasi kawan @rifei, yang banyak terima kasih padanya. <br><br>  Dan juga untuk semua orang yang menulis instruksi di Internet seperti "bagaimana menjalankan program di ubuntu 14.04", dll., Karena saya sendiri adalah teko lengkap dalam hal ini, tetapi dengan membaca 100500 instruksi seperti itu saya berhasil mengatur semuanya. <br><br>  Dan secara terpisah - untuk mereka yang membuat dan memposting segala macam program yang bermanfaat, disebutkan dan tidak disebutkan di sini. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id479488/">https://habr.com/ru/post/id479488/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id479474/index.html">Mengapa self-organisasi tim sangat penting dalam Scrum dan mengapa tidak ada manajer di dalamnya</a></li>
<li><a href="../id479478/index.html">Plug-in Java tanpa rasa sakit</a></li>
<li><a href="../id479480/index.html">SARIF SDK dan Kesalahannya</a></li>
<li><a href="../id479482/index.html">SARIF SDK dan kesalahannya</a></li>
<li><a href="../id479486/index.html">Pemrograman heterogen dan oneAPI Toolkit. Kuliah pakar improvisasi Intel menjawab pertanyaan Anda</a></li>
<li><a href="../id479492/index.html">Komputasi tanpa server berdasarkan OpenWhisk, bagian 3</a></li>
<li><a href="../id479496/index.html">Parsing Tugas WTF dalam JavaScript</a></li>
<li><a href="../id479498/index.html">Bagaimana waktu linear berubah menjadi Windows dalam O (n²)</a></li>
<li><a href="../id479502/index.html">Bagaimana cara bertahan hidup di zaman es paling parah dalam sejarah Bumi?</a></li>
<li><a href="../id479504/index.html">Membangun RDP Thin Client berbasis Raspberry Pi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>