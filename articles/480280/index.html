<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äçüîß ‚úãüèæ üîª Estudio de seguridad TurboConf ‚ö±Ô∏è üë∞üèæ ‚ò¢Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos! Decid√≠ compartir con la comunidad informaci√≥n sobre un peque√±o an√°lisis de una peque√±a utilidad (con un c√≥digo ofuscado), conocida en c√≠...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Estudio de seguridad TurboConf</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/480280/">  Hola a todos!  Decid√≠ compartir con la comunidad informaci√≥n sobre un peque√±o an√°lisis de una peque√±a utilidad (con un c√≥digo ofuscado), conocida en c√≠rculos estrechos de apodos 1s.  Este es mi primer art√≠culo sobre Habr, le pido que no patee mucho, pero que sea digno de criticar. <br><br>  <b>Descargo de responsabilidad</b> <br><br>  Todo lo que veas aqu√≠ puede afectar tus habilidades ps√≠quicas, no uses lo que se describe en el art√≠culo, ya que esto puede hacerte da√±o.  El autor no asume ninguna responsabilidad por la precisi√≥n, integridad o calidad de la informaci√≥n proporcionada. <br><br>  <b>Que es esto</b> <br><br>  TurboConf es un programa "shareware" que ampl√≠a las capacidades del configurador 1s, <s>ni una palabra m√°s acerca de 1s</s> , que no requiere instalaci√≥n.  Puede descargarlo en el sitio web del mismo nombre Runet.  Todos los estudios se realizaron en la versi√≥n 5.9.7209.21363 del 27 de septiembre de 2019. <br><a name="habracut"></a><br>  <b>An√°lisis inicial</b> <br><br>  Despu√©s de la descarga, obtenemos un archivo zip.  Desempacar  Vemos varios archivos exe.  Veamos la aplicaci√≥n principal con un √≠cono corporativo.  Si lo abre en un editor HEX simple, por ejemplo, HxD, puede comprender f√°cilmente que es un ensamblado en .Net Framework, porque los nombres de clase de la biblioteca .Net est√°ndar son visibles: <br><br><div class="spoiler">  <b class="spoiler_title">TurboConf en HxD</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ld/oi/wh/ldoiwhp4xqktpwbhbijjx8x2lqm.png" alt="imagen"><br></div></div><br>  A continuaci√≥n, tomamos el descompilador DotPeek y miramos este ensamblaje en √©l.  El c√≥digo de bytes no est√° ofuscado, por lo que el descompilador produce fuentes casi originales: <br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo de m√©todo recuperado</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/1n/8k/xi/1n8kxixubmahbgtbatso7dxgzus.png" alt="imagen"><br></div></div><br>  Aqu√≠ es f√°cil entender que el trabajo de la utilidad se traslada a la aplicaci√≥n "TurboConf.Application.exe".  √Åbrelo en DotPeek.  Este tambi√©n es un ensamblaje con c√≥digo IL.  Pero a diferencia del ensamblaje anterior, algunos de los m√©todos aqu√≠ est√°n ofuscados, probablemente usando Confuser.  Al estudiar el c√≥digo, queda claro que la l√≥gica principal del trabajo est√° en "TurboConf.Service.dll", y esto tambi√©n es un ensamblado para .Net, y tambi√©n algunos de los m√©todos est√°n ofuscados.  ¬°Genial, esto es a√∫n m√°s interesante! <br><br>  <b>Investigaci√≥n de defensa</b> <br><br>  Al ver la estructura del ensamblaje, en el espacio de nombres "TurboConf.Service.Utils" encontramos la clase "Crypto", y en ella un m√©todo con el nombre de voz "DecryptStringAES": <br><br><div class="spoiler">  <b class="spoiler_title">M√©todo DecryptStringAES</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/rg/hv/ez/rghvezapsryxqomjkk9tknejsxm.png" alt="imagen"><br></div></div><br>  Aunque est√° ofuscado, no es dif√≠cil restaurar la l√≥gica del trabajo en el futuro.  Encuentre el uso de este m√©todo (Shift + F12): <br><br><div class="spoiler">  <b class="spoiler_title">Resultados de busqueda</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ol/uj/-w/oluj-whbnl_2msvsa6u4wkuuq10.png" alt="imagen"><br></div></div><br>  ¬°Y de inmediato √©xito!  ¬°Este m√©todo se llama 2 veces en el constructor de la clase responsable de la licencia! <br><br>  <b>Fuente de recuperaci√≥n</b> <br><br>  El ofuscador cifr√≥ todas las l√≠neas y las coloc√≥ en un archivo de recursos.  Puede obtener este archivo utilizando el descompilador de Microsoft ildasm.exe incluido en el SDK de Windows (y no solo): <br><br><div class="spoiler">  <b class="spoiler_title">Recuperando un Archivo de Recursos</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/-t/fh/8h/-tfh8htaf4_1alj0r_eexymsf_e.png" alt="imagen"><br></div></div><br>  Y en lugar de las l√≠neas originales, el ofuscador sustituye la siguiente construcci√≥n en el c√≥digo: "&lt;Module&gt; .c (random_arithmic_operation)", donde el resultado de la operaci√≥n aritm√©tica es un n√∫mero determinado en funci√≥n del cual se calcula el desplazamiento del archivo de recursos, a partir del cual se extraen los datos cifrados y se restaura la cadena original.  Para facilitar la tarea de descifrar cadenas, crearemos un nuevo proyecto en Visual Studio, transferiremos, con un poco de refinamiento, la clase "&lt;M√≥dulo&gt;" y el archivo de recursos "recurso".  Por lo tanto, podemos entender que en la ventana DotPeek el siguiente c√≥digo <br><br><pre><code class="cs hljs">&lt;Module&gt;.c(<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) - <span class="hljs-number"><span class="hljs-number">47</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) + <span class="hljs-number"><span class="hljs-number">6429</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) ((<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>) k &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) + <span class="hljs-number"><span class="hljs-number">200</span></span> : System.Type.EmptyTypes.Length - <span class="hljs-number"><span class="hljs-number">1805516213</span></span>)</code> </pre> <br>  esta es la l√≠nea "Usuario:" <br><br>  Restaura lentamente la l√≥gica completa de la clase de licencia.  Podr√≠amos detenernos en esto, es decir, hacer un simple truco en el archivo investigado "TurboConf.Service.dll", reemplazando la verificaci√≥n de igualdad para una licencia con desigualdad, pero esto no es interesante.  Yendo m√°s all√° ... <br><br>  <b>Principio de protecci√≥n</b> <br><br>  Para obtener una licencia, necesita un identificador √∫nico para el equipo en el que se ejecuta el programa.  Este HardwareID se genera en funci√≥n del identificador del procesador y el n√∫mero de serie del volumen de la unidad "Ts".  Para obtener una licencia de prueba, el programa realiza una solicitud GET con un identificador de equipo para el dominio "netlenka1c.ru".  Y en respuesta llega una clave que indica la fecha de finalizaci√≥n del per√≠odo de prueba, firmada ... digitalmente.  El programa se basa en el algoritmo RSA asim√©trico con una clave de 1024 bits.  En esta etapa, me di cuenta de que es imposible hacerlo sin modificar el archivo original, ya que es casi imposible obtener la clave privada (no est√° en los archivos de la utilidad). <br><br>  <b>Mini centro de licencias</b> <br><br>  Habiendo entendido c√≥mo funciona la protecci√≥n, decid√≠ convertirme en un peque√±o dios para este programa, de modo que yo mismo pudiera generar claves.  Para hacer esto, se desarroll√≥ un parche, que primero reemplaza la clave p√∫blica de la firma digital en el ensamblado con la clave p√∫blica generada en s√≠: <br><br><div class="spoiler">  <b class="spoiler_title">Patcher</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/4a/rs/5o/4ars5o1ymfeen-znjl8enah2tr4.png" alt="imagen"><br></div></div><br>  Y luego, la utilidad desarrollada para generar claves (tanto temporales para un per√≠odo de validez especificado como perpetuas), agrega una firma digital a la clave basada en la clave privada generada: <br><br><div class="spoiler">  <b class="spoiler_title">Keygen</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/w5/fw/gb/w5fwgbdhaxidnmviodpui_xwoqc.png" alt="imagen"><br></div></div><br>  Como resultado, tenemos un programa registrado viable con funcionalidad completa: <br><br><div class="spoiler">  <b class="spoiler_title">Sobre el programa</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5n/e6/os/5ne6oswkwzsymzbacj9v5iaxpnu.png" alt="imagen"><br></div></div><br>  <b>Moraleja</b> <br><br>  La ofuscaci√≥n es un m√©todo bastante bueno para confundir lo contrario, pero es solo cuesti√≥n de tiempo. <br><br>  <b>PS</b> <br><br>  El art√≠culo espec√≠ficamente tiene lagunas en la narrativa, para no sustituir al autor del programa.  No se adjuntan c√≥digos fuente y programas de trabajo y no se incluir√°n.  ¬°Respeta el trabajo de los dem√°s, especialmente los colegas de la "tienda"! <br><br>  ¬°Gracias a todos los que leen la publicaci√≥n! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/480280/">https://habr.com/ru/post/480280/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../480268/index.html">Biblioteca Java de c√≥digo abierto con filtrado de seguimiento de pila, an√°lisis de cadenas silenciosas y comparaci√≥n de versiones</a></li>
<li><a href="../480270/index.html">La disminuci√≥n de la popularidad de PHP: ¬øno es tan simple?</a></li>
<li><a href="../480272/index.html">Inteligencia artificial y la complejidad del cerebro humano.</a></li>
<li><a href="../480274/index.html">Contador de alcohol o C√≥mo sobrevivir a las recepciones de buffet</a></li>
<li><a href="../480276/index.html">Entrevista del juego: Estrategias de contrataci√≥n. Parte 1</a></li>
<li><a href="../480282/index.html">La historia de la startup de fitness Peloton: de una valoraci√≥n de $ 8 mil millones a publicidad fallida y pron√≥sticos de una ca√≠da del 85% en las existencias</a></li>
<li><a href="../480284/index.html">Mi (nano) experiencia con Yandex.Maps API o por qu√© necesito instrucciones</a></li>
<li><a href="../480288/index.html">¬øEs posible transmitir y recibir informaci√≥n sin restricciones sobre la distancia y la velocidad de la luz?</a></li>
<li><a href="../480290/index.html">Port√°til casero ZedRipper en diecis√©is Z80</a></li>
<li><a href="../480294/index.html">Visi√≥n artificial de alta velocidad en el vers√°til dispositivo de clasificaci√≥n de piezas LEGO</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>