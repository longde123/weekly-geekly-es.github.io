<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😂 👷🏻 🏈 Informationen zu Centos Repository-Spiegeln und zur Auswahl des besten ✊ ❓ 🏟️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Letztes Jahr haben wir Online-Spiegel für verschiedene Linux-Distributionen gehostet. Dies ist kein komplizierter Prozess und für große Projekte wie U...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Informationen zu Centos Repository-Spiegeln und zur Auswahl des besten</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476262/">  Letztes Jahr haben wir Online-Spiegel für verschiedene Linux-Distributionen gehostet.  Dies ist kein komplizierter Prozess und für große Projekte wie Ubuntu ist es fast vollständig automatisiert.  In anderen Fällen müssen Sie das Projekt auf die eine oder andere Weise kontaktieren, z. B. über die Mailingliste, und Ihren Wunsch ausdrücklich äußern. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i5/vh/_l/i5vh_lmncsc_yjc6woir34ypw8o.png" alt="lecker repolist"></div><br>  Technisch ist es <code>rsync</code> , in der Regel nach einem Zeitplan.  Jemand stellt dafür fertige Skripte zur Verfügung, wie Fedora, und jemand sagt nur, dass Sie von diesem Server aus und mit den empfohlenen Parametern hier synchronisieren müssen.  Die teuerste Ressource ist der Ort, wir haben vor kurzem 4 Terabyte und dies ist in unserem Fall teuer, weil es keinen Gewinn generiert.  Im Gegenzug erhielten wir die lokale Verfügbarkeit der von uns verwendeten Distributionen. Dies ermöglichte es, die Erstkonfiguration von Servern zu vereinfachen, indem der obligatorische Internetzugang wegfiel.  Und natürlich freuen wir uns, dass wir uns etwas Großem angeschlossen haben, auch wenn unsere Teilnahme daran nicht sehr auffällig ist. <br><br>  Unser Spiegel ist öffentlich, jeder kann Updates davon erhalten, was tatsächlich passiert, wenn man die Statistik der Berufungen beurteilt.  Dies ist vor allem Russland, aber nicht nur.  Wie es ausgeht und wie der allgemeine Server für Updates ausgewählt wird, erfahren Sie am Beispiel der siebten Centos-Version dieses Beitrags. <a name="habracut"></a><br><br>  Wir werden über den <code>yum</code> Paketmanager sprechen, auf dem das <code>fastestmirror</code> Plugin standardmäßig installiert ist, und uns nur für den <code>fastestmirror</code> eines bestimmten Spiegels interessieren. <br><br><h2>  Liste spiegeln </h2><br>  Es ist bekannt, dass die Liste der Repositorys in den Dateien im Verzeichnis <code>/etc/yum.repos.d/</code> angegeben ist, sofern nicht anders angegeben.  So sehen die Einstellungen des <code>Base</code> Repositorys in der Datei <code>/etc/yum.repos.d/Centos-Base.repo</code> : <br><br><pre> <code class="bash hljs">[base] name=CentOS-<span class="hljs-variable"><span class="hljs-variable">$releasever</span></span> - Base mirrorlist=http://mirrorlist.centos.org/?release=<span class="hljs-variable"><span class="hljs-variable">$releasever</span></span>&amp;arch=<span class="hljs-variable"><span class="hljs-variable">$basearch</span></span>&amp;repo=os&amp;infra=<span class="hljs-variable"><span class="hljs-variable">$infra</span></span> <span class="hljs-comment"><span class="hljs-comment">#baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/ gpgcheck=1 gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7</span></span></code> </pre> <br>  Hier sehen Sie zwei Optionen, die den Ort angeben, an dem Sie Daten abrufen können.  Die erste <b>Baseurl zeigt</b> direkt auf den Spiegel, hier ist keine Wahl erforderlich.  Die zweite <b>Spiegelliste</b> gibt einen Link an, über den eine Liste mit 10 Spiegeln zurückgegeben wird, über die die Auswahl getroffen wird. Diese Option ist aktiv.  Wir sehen auch verschiedene Variablen im Link, die letztendlich alle eine bestimmte Stelle im Repository-Verzeichnisbaum widerspiegeln: <br><br><ul><li>  <b>release</b> - version: <code>6</code> , <code>7</code> , <code>8</code> , <code>8-stream</code> .  Ältere Versionen werden aus der vorhandenen Infrastruktur entfernt, Snapshots ihrer Repositorys finden Sie jedoch unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://vault.centos.org/.</a> </li><li>  <b>arch</b> ist eine architektur wie <code>i386</code> oder <code>x86_64</code> .  In einigen Versionen beziehen sich einige Architekturen auf alternative Repositorys und ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">anderes Spiegelsystem</a> , gleichzeitig bleibt die Infrastruktur für die Spiegelauswahl jedoch weiterhin gebräuchlich.  Für Version 7 ist <code>x86_64</code> , eine Alternative zu <code>i386</code> , der einzige unterstützte Basisspiegel.  Zum einen wird in der Grundstruktur der Spiegel eine Liste gebildet, zum anderen die Alternative </li><li>  <b>repo</b> - in unserem Fall <code>os</code> , aber es können <code>updates</code> oder andere sein, tatsächlich spiegelt der Repository-Typ wider, welche Daten wir benötigen.  In Version 8 ist das Äquivalent von <code>os</code> <code>baseos</code> </li><li>  <b>infra</b> - Ich kann mit Bedacht davon ausgehen, dass <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">es immer noch nicht verwendet wird</a> , zumindest konnte ich seine Verarbeitung beim Erstellen einer Liste von Spiegeln nicht finden.  Es ist gleich <code>stock</code> , aber wenn Sie diesen Parameter weglassen, werden keine sichtbaren Änderungen folgen </li><li>  <b>cc</b> ist die Landesvorwahl, für die USA und Kanada auch die Landesvorwahl.  Dies ist im obigen Beispiel nicht der Fall, da das Land auf Anforderung anhand der IP-Adresse des angeforderten Landes berechnet wird.  Diese Variable kann verwendet werden, um Geolocation-Fehler zu beseitigen.  Für Russland ist <code>cc=ru</code> </li></ul><br>  Für die 7. Version von Centos erhalten wir die folgende Zeile: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://mirrorlist.centos.org/?release=7&amp;arch=x86_64&amp;repo=os&amp;infra=stock, in</a> der eine Liste von 10 Spiegeln der folgenden Art angezeigt wird: <br><br><pre> <code class="bash hljs">http://&lt;   1&gt;/7.xxx/os/x86_64/ http://&lt;   2&gt;/7.xxx/os/x86_64/ ... http://&lt;   10&gt;/7.xxx/os/x86_64/</code> </pre> <br>  Beachten Sie, dass der spezifische Pfad für jeden Spiegel genau mit den Variablen in der Abfrage übereinstimmt.  Die Vollversion wird anstelle der älteren Version angezeigt, obwohl Sie sie auch verwenden können: <code>http://&lt;  &gt;/7/os/x86_64/</code> ebenfalls vorhanden und wird über einen symbolischen Link zur neuesten Version implementiert. <br><br><div class="spoiler">  <b class="spoiler_title">Und das alles zusammen entspricht der Verzeichnishierarchie direkt auf dem Server.</b> <div class="spoiler_text"><pre>  ./centos
 ├── 6
 │ ├── centosplus
 │ │ ├── i386
 ... │ └── x86_64
     ...
 │
 ├── 7
 │ │ atomar
 │ │ └── x86_64
 │ ├── centosplus
 │ │ └── x86_64
 │ ├── cr
 │ │ └── x86_64
 │ │ Punktnetz
 │ │ └── x86_64
 │ │ Extras
 │ │ └── x86_64
 │ │ Hocker
 │ │ └── x86_64
 │ ├── os
 │ │ └── x86_64
 │ │ │ repodata
 │ │ └── [repomd.xml]
 │ │ rt
 │ │ └── x86_64
 │ ├── Updates
 │ │ └── x86_64
 │ ...
 │
 ├── 7.0.1406
 ├── 7.1.1503
 ├── 7.2.1511
 ├── 7.3.1611
 ├── 7.4.1708
 ├── 7.5.1804
 ├── 7.6.1810
 ├── 7.7.1908
 ├── 8
 ├── 8-Stream
 8,0,1905 
 ... </pre></div></div><br><h3>  Implementierung </h3><br>  Nun interessiert uns für die Implementierung, die unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/CentOS/mirrorlists-code</a> zu finden ist, wie die Liste der Spiegel gebildet wird.  Das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Perlenskript makemirrorlists-combined.pl macht das</a> .  Seine Hauptaufgabe besteht darin, die Vitalität des Spiegels zu überprüfen, indem der Hash der <code>repodata/repomd.xml</code> mit der Referenz für die angegebene Version und Architektur verglichen wird.  Dementsprechend muss die Datei für alle verfügbaren Kombinationen von Versionen, Repository-Typen und Architekturen vorhanden sein. <br><br>  Die Überprüfung erfolgt gemäß der Liste in der folgenden Reihenfolge (ich zitiere aus dem Code): <br><br><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment"># phase 1 -- this US state or Canada province # phase 2 -- this country # phase 3 -- other nearby countries # phase 4 -- mirrors from the same continent # phase 5 -- a random mirror from each continent (for fallback only) # note: phase 5 will be executed once for each continent (with "redo") # phase 6 -- random mirrors from any continent (for fallback only) # phase 7 -- centos servers from the same continent # phase 8 -- centos servers from other continents (used also for fallback)</span></span></code> </pre><br>  Die Absätze 1 und 2 funktionieren entweder oder überprüfen nicht nur die Landesvorwahl, sondern auch die Landesvorwahl.  Im Wesentlichen wird versucht, die nächstgelegenen geografischen Server auszuwählen.  Für jeden Schritt wird eine Abfrage aus der Datenbank durchgeführt, zum Beispiel: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> mirrors <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-string"><span class="hljs-string">'Direct'</span></span>, <span class="hljs-string"><span class="hljs-string">'Indirect'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">status</span></span> = <span class="hljs-string"><span class="hljs-string">'Active'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> cc = <span class="hljs-string"><span class="hljs-string">'$cc'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> $commonqueryparams $skipregion $altarch_where <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RAND</span></span>();</code> </pre><br>  Anschließend wird die Vitalität der Spiegel in dieser Liste überprüft, indem die oben beschriebenen Hashes verglichen werden.  Wenn 10 Personen eingestellt sind, ist die erforderliche Aufgabe erledigt, die Arbeit ist erledigt.  Wenn Sie nichts eingeben, fahren Sie mit dem nächsten Schritt fort, um die allgemeine Liste auf 10 zu setzen, oder bis alle Optionen ausgeschöpft sind.  Das Ergebnis wird in einer Datei gespeichert und mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ml.py-</a> Skript an das Front-End des von Python präsentierten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teils übertragen</a> . Die Aufgabe besteht darin, die gewünschte Datei auszuwählen und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">anzugeben</a> , nachdem das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellland</a> der Anforderung anhand der IP-Adresse ermittelt wurde.  Der Typ des IPv4- oder IPv6-Protokolls, für das unterschiedliche Listen erstellt werden, wird ebenfalls berücksichtigt. <br><br>  <code>ORDER BY RAND()</code> dies, dass die Liste zufällig ist, wenn Sie zu der Abfrage zurückkehren, die <code>ORDER BY RAND()</code> ?  Ja, wie zufällig die Implementierung im DBMS ist, dies gilt jedoch nur für den Auftrag innerhalb jedes Schritts.  Das heißt, wenn für ein bestimmtes Land mehr als 10 Spiegel des gewünschten Repository- und Architekturtyps eingegeben werden (für Russland sind es nur 17), erhalten wir am Ende jedes Mal eine gemischte Liste von 10 verschiedenen Spiegeln in einem Land.  Wenn weniger Repositorys vorhanden sind, werden am Anfang der Liste <b>immer</b> Repositorys aus einem Land gemischt, weitere Repositorys aus den nächstgelegenen Ländern gemischt und so weiter.  Als Ergebnis erhalten wir eine nicht ganz zufällige Liste, die aus mehreren zufälligen Teilen besteht.  Es ist wichtig, wenn es in einem Land nicht so viele funktionierende Spiegel gibt, zum Beispiel, IPv6-Spiegel in Russland sind nur 7 und sie werden immer ganz oben auf der Liste stehen: <br><br><div class="spoiler">  <b class="spoiler_title">http://mirrorlist.centos.org/?release=7&amp;arch=x86_64&amp;repo=os&amp;infra=stock&amp;cc=de (die Anforderung muss über die IPv6-Adresse erfolgen)</b> <div class="spoiler_text"> <code>http://mirror.corbina.net/pub/Linux/centos/7.7.1908/os/x86_64/ <br> http://mirror.yandex.ru/centos/7.7.1908/os/x86_64/ <br> http://mirrors.powernet.com.ru/centos/7.7.1908/os/x86_64/ <br> http://mirror.reconn.ru/centos/7.7.1908/os/x86_64/ <br> http://mirror.sale-dedic.com/centos/7.7.1908/os/x86_64/ <br> http://ftp.nsc.ru/pub/centos/7.7.1908/os/x86_64/ <br> http://dedic.sh/centos/7.7.1908/os/x86_64/ <br> <br> http://ftp.funet.fi/pub/mirrors/centos.org/7.7.1908/os/x86_64/ <br> http://centos.mirror.far.fi/7.7.1908/os/x86_64/ <br> http://mirrors.glesys.net/CentOS/7.7.1908/os/x86_64/ <br></code> </div></div><br>  Schlimmer noch, die <code>i386</code> Architektur ist eine alternative Architektur für Centos 7 und ein separates Spiegelsystem.  In Russland gibt es nur einen solchen Server, der alternative Architekturen unterstützt und der immer an erster Stelle stehen wird: <br><br><div class="spoiler">  <b class="spoiler_title">http://mirrorlist.centos.org/?release=7&amp;arch=i386&amp;repo=os&amp;infra=stock&amp;cc=de</b> <div class="spoiler_text"> <code>http://mirrors.powernet.com.ru/centos-altarch/7.7.1908/os/i386/ <br> <br> http://mirror.vpsnet.com/centos-altarch/7.7.1908/os/i386/ <br> http://mirrors.huaweicloud.com/centos-altarch/7.7.1908/os/i386/ <br> http://linux.darkpenguin.net/distros/CentOS-AltArch/7.7.1908/os/i386/ <br> http://ftp.agdsn.de/pub/mirrors/centos-altarch/7.7.1908/os/i386/ <br> http://mirror1.hs-esslingen.de/pub/Mirrors/centos-altarch/7.7.1908/os/i386/ <br> http://mirror.infonline.de/centos-altarch/7.7.1908/os/i386/ <br> http://ftp.rz.uni-frankfurt.de/pub/mirrors/centos-altarch/7.7.1908/os/i386/ <br> http://ftp.yz.yamagata-u.ac.jp/pub/linux/centos-altarch/7.7.1908/os/i386/ <br> http://mirrors.daticum.com/centos-altarch/7.7.1908/os/i386/ <br></code> </div></div><br>  Die Liste ist nicht mehr zufällig, wenn Sie sich auf die erste Zeile konzentrieren, ist die Auswahl vorbestimmt.  Die Unterstützung von Repositorys für alternative Centos-Architekturen ist ein grundsätzliches <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anliegen</a> , aber für viele ist hier reiner Altruismus. <br><br>  Repositorys werden kontinuierlich gescannt und ohne Berücksichtigung der Caching-Mechanismen wird das Ergebnis ungefähr alle 3 Stunden aktualisiert.  Zitat aus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mirrorlist_crawler_deployment_notes.txt</a> : <br><blockquote> <code>- A full scan of all repos and all versions without any cached data is going to take close to 3 hours, but typically altarch is &lt;10min, C6 &lt;25min, C7 &lt;25min with all the repos enabled</code> </blockquote> <br>  In der Praxis erhielt ich in Russland einmal pro Minute Spiegellistenoptionen für IPv4 und IPv6 für das Base Centos 7-Repository - <code>http://mirrorlist.centos.org/?release=7&amp;arch=x86_64&amp;repo=os&amp;infra=stock&amp;cc=ru</code> für ein paar Beobachtungstage: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fx/qh/sn/fxqhsn08lhen5mke-jlprhlgjxa.png" alt="Anzahl der Aktualisierungen der Spiegelliste"></div><br>  blaue IPv4-Liste, rote IPv6.  Der Wechsel erfolgt nicht alle 25 Minuten, sondern nicht alle 3 Stunden - alles passt in den Intervall von einer halben bis zwei Stunden.  Das Bild mit der <code>i386</code> Architektur und alternativen Spiegeln unterscheidet sich radikal - <code>http://mirrorlist.centos.org/?release=7&amp;arch=i386&amp;repo=os&amp;infra=stock&amp;cc=ru</code> etwa eine Woche Beobachtung: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/os/xy/wb/osxywbdutbktiud6-scyrul_lok.png" alt="altmirrors list updates count"></div><br>  Wir können davon ausgehen, dass alle 15 Minuten eine neue Liste erstellt wird. In 30 Minuten werden einige Änderungen daran vorgenommen.  Aber!  Denken Sie daran, dass die Reihenfolge umso weniger zufällig ist, je weniger aktive Spiegel sind. In Russland ist dies in erster Linie immer derselbe Spiegel. <br><br><h2>  Schnellster Spiegel </h2><br>  Insgesamt wird die Liste der Spiegel bestenfalls zufällig gebildet, was für den Lastausgleich wahrscheinlich nicht schlecht ist.  Im schlimmsten Fall können wir davon ausgehen, dass wir bei der Auswahl nur des ersten Spiegels aus der Liste keine andere Wahl haben.  Darüber hinaus kann die territoriale Aufteilung der Länder in einem großen Land wie dem unseren einen Streich spielen, indem ein Spiegel von Petropawlowsk-Kamtschatski <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://mirror.vilkam.ru</a> für den Kunden aus Sotschi ganz oben auf der Liste steht.  Daher wäre es schön, die Verfügbarkeit von Spiegeln aus dieser Liste zu bewerten.  Dies <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erledigt das schnellste Mirror</a> Plugin.  Das Wesentliche davon ist auf eine einfache Handlung reduziert: <br><br><pre> <code class="python hljs">time_before = time.time() sock.connect((self.host, self.port)) result = time.time() - time_before</code> </pre><br>  Kein <code>HTTP</code> oder <code>ICMP</code> , öffnen Sie den Socket für den Knoten, überlegen Sie, wie lange es gedauert hat, und wenden Sie <code>sort()</code> auf die Ergebnisse an.  Alle 10 Spiegel, die im vorherigen Schritt erhalten wurden, werden als Parameter in Form der vollständigen <code>URL</code> gesendet, von der nur der Hostname verwendet wird.  Das Plugin ist einfach zu bedienen, Sie müssen nur die Zeilen 52 und 55 auskommentieren: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># from yum.plugins import TYPE_CORE requires_api_version = '2.5' # plugin_type = (TYPE_CORE,)</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">und kann verwendet werden.</b> <div class="spoiler_text"><pre> <code class="bash hljs">$ ./fastestmirror.py http://mirror.sale-dedic.com/centos/7.7.1908/os/x86_64/ http://mirror.corbina.net/pub/Linux/centos/7.7.1908/os/x86_64/ http://mirrors.powernet.com.ru/centos/7.7.1908/os/x86_64/ http://ftp.nsc.ru/pub/centos/7.7.1908/os/x86_64/ http://mirror.reconn.ru/centos/7.7.1908/os/x86_64/ http://mirror.yandex.ru/centos/7.7.1908/os/x86_64/ http://dedic.sh/centos/7.7.1908/os/x86_64/ http://mirror.tversu.ru/centos/7.7.1908/os/x86_64/ http://mirror.awanti.com/centos/7.7.1908/os/x86_64/ http://mirror.linux-ia64.org/centos/7.7.1908/os/x86_64/repodata/repodm.xml http://mirrors.datahouse.ru/centos/7.7.1908/os/x86_64/ http://mirror.docker.ru/centos/7.7.1908/os/x86_64/ http://mirror.logol.ru/centos/7.7.1908/os/x86_64/ http://centos-mirror.rbc.ru/centos/7.7.1908/os/x86_64/ http://mirror.truenetwork.ru/centos/7.7.1908/os/x86_64/ http://mirror.vilkam.ru/centos/7.7.1908/os/x86_64/ http://mirror.axelname.ru/centos/7.7.1908/os/x86_64/ * mirror.corbina.net : 0.085000 secs * mirrors.powernet.com.ru : 0.097000 secs * mirror.sale-dedic.com : 0.117000 secs * ftp.nsc.ru : 0.181000 secs * mirror.reconn.ru : 0.184000 secs * mirror.yandex.ru : 0.222000 secs * dedic.sh : 0.261000 secs * mirror.tversu.ru : 0.295000 secs * mirror.awanti.com : 0.345000 secs * mirror.linux-ia64.org : 0.386000 secs * mirrors.datahouse.ru : 0.403000 secs * mirror.docker.ru : 0.435000 secs * mirror.logol.ru : 0.474000 secs * centos-mirror.rbc.ru : 0.519000 secs * mirror.truenetwork.ru : 0.587000 secs * mirror.axelname.ru : 0.528000 secs * mirror.vilkam.ru : 0.709000 secs Result: [<span class="hljs-string"><span class="hljs-string">'http://mirror.corbina.net/pub/Linux/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirrors.powernet.com.ru/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirror.sale-dedic.com/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://ftp.nsc.ru/pub/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirror.reconn.ru/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirror.yandex.ru/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://dedic.sh/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirror.tversu.ru/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirror.awanti.com/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirror.linux-ia64.org/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirrors.datahouse.ru/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirror.docker.ru/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirror.logol.ru/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://centos-mirror.rbc.ru/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirror.axelname.ru/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirror.truenetwork.ru/centos/7.7.1908/os/x86_64/'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mirror.vilkam.ru/centos/7.7.1908/os/x86_64/'</span></span>]</code> </pre></div></div><br>  Die Verarbeitung erfolgt in mehreren Threads, sodass Sie nicht lange warten müssen, auch nicht auf alle 17 in Russland aufgeführten Spiegel.  Das Ergebnis der Arbeit in Form von zwei Listen, in der die Ausführungszeit angegeben ist, ist das Debuggen und es wird nicht sortiert, obwohl es so scheint.  Die Sekunde, nachdem das Wort <code>Result</code> von einer kleineren zu einer größeren Antwort sortiert wurde, ist es, die für die weitere Arbeit in der erhaltenen Reihenfolge verwendet wird. <br><br>  <code>dnf</code> auch den <a href="">schnellste Spiegel</a> aus der Menge der RPM-Bibliotheken, aber dort wird er durch <code>libcurl</code> gelöst und im Allgemeinen ist alles komplizierter. <br><br>  Letztendlich hängt alles davon ab, wie schnell die Antwort vom Spiegel empfangen wird, während das Zwischenspeichern berücksichtigt werden sollte, dh die direkte Berechnung der Verzögerung wird nicht immer durchgeführt.  Die Zeitintervalle werden stark von der internen Leistung der lokalen Maschine und ihrer Arbeitslast beeinflusst.  Nahe Knoten mit ähnlichen Ergebnissen werden wahrscheinlich häufig die Position wechseln.  Aber hier ist es erreicht, es scheint mir, dass das Hauptziel nicht ist, einen Knoten von Sotschi zur Erneuerung nach Petropawlowsk-Kamtschatski zu senden, nach Moskau zu gehen oder Wolgograd ist durchaus akzeptabel.  Worauf wir sonst noch achten, die Auswahl wird aus der Liste getroffen, die im ersten Schritt vor dem <code>fastestmirror</code> Spiegel <code>fastestmirror</code> wurde. Wenn diese Daten noch nicht im Cache sind, ist der nächste Spiegel beim ersten Versuch möglicherweise nicht der beste, einfach weil sie nicht einmal analysiert werden, ohne darauf einzugehen die Top Ten. <br><br>  In der Praxis wurden bei einer wöchentlichen Umfrage alle 10 Minuten die folgenden ersten Ergebnisse erzielt.  Ziffern - die Anzahl der beim Vergleich gewonnenen Knoten für <code>fastestmirror</code> und <code>fastestmirror</code> : <br><blockquote> <code>1422,1013 mirror.logol.ru <br> 534,986 mirror.docker.ru <br> 28,8 mirrors.datahouse.ru <br> 16 centos-mirror.rbc.ru <br> 6 mirror.sale-dedic.com <br> 5,7 mirror.reconn.ru <br> 2 dedic.sh <br> 1 mirror.corbina.net</code> </blockquote> <br>  Und IPv6-Version der Liste: <br><blockquote> <code>1989,1980 mirror.reconn.ru <br> 18,34 mirror.sale-dedic.com <br> 7 dedic.sh <br></code> </blockquote><br>  Es ist zu sehen, dass die Auswahl nicht direkt eindeutig ist, aber hier spielt die Nähe des Punktes, von dem aus ich die Umfrage durchgeführt habe, höchstwahrscheinlich eine Rolle - bis auf mehrere Spiegel beträgt der Unterschied weniger als eine Millisekunde.  Der zweite Punkt, die IPv6-Liste, ist anders und es ist schlimmer - der nächste IPv6-Host ist weiter als der nächste IPv4-Host und die Auswahl ist geringer.  Angesichts der Priorität von IPv6 ist das nicht sehr gut.  Die Ergebnisse von <code>fping</code> prägnanter, weniger gewinnbringende Knoten, aber im Allgemeinen die gleichen wie bei <code>fastestmirror</code> . <br><br><h2>  Reifer Atlas </h2><br>  Mit einer lokalen Entscheidung ist alles mehr oder weniger klar, jetzt wollen wir sehen, wie sich die Dinge im ganzen Land entwickeln.  Warum verwenden wir die Dienste <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://atlas.ripe.net/</a> - eine Reihe von Sonden (Probes) und Tools für die Arbeit mit ihnen unter der Schirmherrschaft von RIPE NCC, ich werde Sie sofort warnen, dies ist nicht die schnellste und agilste Website.  Jeder kann eine Sonde bekommen und dieses Netzwerk nutzen.  Zum Ausführen der Tests benötigen Sie jedoch eine interne Währung, die sich aus den Geräten zusammensetzt, die nach Ihnen registriert und aktiv sind.  Ich entschied mich für alle Geräte in Russland, die IPv6 und IPv4 gleichzeitig unterstützen, von denen sich 82 herausstellten. Gemäß den Messergebnissen musste ein Teil davon entfernt werden, so dass 67 von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mehr als 400</a> übrig blieben. <br><br>  Es gibt mehrere <code>fastestmirror</code> , die Sie ausführen können. Natürlich wird in " <code>fastestmirror</code> nicht das verwendet, aber es wird regelmäßig ein <code>ping</code> <code>fastestmirror</code> .  Für alle Spiegel mit Ausnahme von <code>mirror.linux-ia64.org</code> für die <code>ICMP</code> gefiltert wird, und <code>mirror.axelname.ru</code> die nach den Tests von allen ausgewählten Geräten getrennt für IPv6 und IPv4 alle 3 Stunden für eine Woche <code>mirror.axelname.ru</code> wurden Je 10 Anfragen.  Die durchschnittliche Antwortzeit wurde aufgezeichnet.  Aus dem gesamten Satz von Messungen, ungefähr 50 für jeden Spiegel, wurde der Median genommen und mit anderen Spiegeln auf dieser Sonde verglichen.  Der Spiegel mit der kürzesten Reaktionszeit hat gewonnen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cg/ap/gf/cgapgfond47sh3phyalhc30s0na.jpeg" alt="Spiegel und Sonden Karte"></div><br>  Sampler (blaue Markierungen) und Spiegel (rote Markierungen) sind zu ungleichmäßig verteilt und tendieren zu Großbuchstaben, daher sollten die Ergebnisse nicht als signifikant angesehen werden.  Rohdaten sind ab <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Messnummer 23159879</a> bis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">23159901 verfügbar</a> . Falls gewünscht, können sie genauer analysiert werden.  Zusammengefasste Gesamtzahl der ersten Plätze für IPv4: <br><blockquote> <code>22 mirror.docker.ru <br> 12 mirror.awanti.com <br> 10 centos-mirror.rbc.ru <br> 6 dedic.sh <br> 4 mirror.truenetwork.ru <br> 3 mirror.corbina.net <br> 3 mirrors.powernet.com.ru <br> 2 ftp.nsc.ru <br> 2 mirrors.datahouse.ru <br> 1 mirror.reconn.ru <br> 1 mirror.vilkam.ru <br> 1 mirror.yandex.ru <br></code> </blockquote><br>  und IPv6: <br><blockquote> <code>20 dedic.sh <br> 20 mirror.reconn.ru <br> 10 mirror.yandex.ru <br> 8 mirror.sale-dedic.com <br> 5 ftp.nsc.ru <br> 3 mirror.corbina.net <br> 1 mirrors.powernet.com.ru <br></code> </blockquote><br>  Wir können sagen, dass es für fast alle Spiegel, ich erinnere sie an 17, Verbraucher gibt.  Es ist interessant, dass <code>mirror.yandex.ru</code> zusammen mit <code>mirror.vilkam.ru</code> aus Petropawlowsk-Kamtschatski an letzter Stelle steht.  Zur gleichen Zeit ist Yandex fast überall verfügbar, es verliert jedes Mal ein wenig an Reaktionsfähigkeit, aber <code>mirror.vilkam.ru</code> gewinnt einmal, aber mehr als ehrlich im Vergleich zu anderen auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">6606-Sonde</a> aus Chabarowsk (RTT in Millisekunden): <br><blockquote> <code>centos-mirror.rbc.ru,105.4163369 <br> dedic.sh,109.2160474 <br> ftp.nsc.ru,106.4012836 <br> mirror.awanti.com,107.0802782 <br> mirror.corbina.net,98.5339837 <br> mirror.docker.ru,102.7883347 <br> mirror.logol.ru,105.9588192 <br> mirror.reconn.ru,106.5717624 <br> mirror.sale-dedic.com,106.1676841 <br> mirror.truenetwork.ru,110.9780753 <br> mirror.tversu.ru,107.9966083 <br> mirror.vilkam.ru,25.1486164 <br> mirror.yandex.ru,99.7320257 <br> mirrors.datahouse.ru,103.6546383 <br> mirrors.powernet.com.ru,116.4087614 <br></code> </blockquote><br>  Die besten Ergebnisse im Bereich von einer oder mehreren Millisekunden und das schlechteste Ergebnis in der Antwort bei Salechard, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Probe 22767</a> : <br><blockquote> <code>centos-mirror.rbc.ru,59.9632155 <br> dedic.sh,63.765421 <br> ftp.nsc.ru,59.349309 <br> mirror.awanti.com,75.8998928571 <br> mirror.corbina.net,59.906047 <br> mirror.docker.ru,65.8720585 <br> mirror.logol.ru,63.2041255 <br> mirror.reconn.ru,63.7120505 <br> mirror.sale-dedic.com,63.052342 <br> mirror.truenetwork.ru,61.2567465 <br> mirror.tversu.ru,66.2593372222 <br> mirror.vilkam.ru,138.3730595 <br> mirror.yandex.ru,63.4150445 <br> mirrors.datahouse.ru,59.304435 <br> mirrors.powernet.com.ru,78.7411795 <br></code> </blockquote><br><h2>  Nachwort </h2><br>  Für diejenigen, die an diesen Ort kamen, werde ich die Frage beantworten, die gestellt wird - unser Spiegel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://mirrors.powernet.com.ru</a> und hier ist, wie es verwendet wird: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nl/rm/nb/nlrmnbe9g8tnuvym2u6jlyurnzc.png" alt="mirrors.powernet.com.ru Datenverkehr"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tk/99/rn/tk99rnmoigycgl4ataoygkhs100.png" alt="mirrors.powernet.com.ru Bandbreitenverkehr"></div><br>  Darüber hinaus ist der Anteil dieses Verkehrs innerhalb unseres Netzwerks vernachlässigbar gering. <br><br>  So endet der Ort darauf: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ap/qk/zc/apqkzcw2htintu4idmjk5sixyfk.png" alt="mirrors.powernet.com.ru Festplatte"></div><br>  Gut unterscheidbare Schritte sind Momente, in denen wir eine neue Distribution hinzufügen.  Als alles begann, lief VirtualBox unter Windows auf einem Bürocomputer, auf dem die Videoarchive unserer Werbeabteilung gespeichert waren.  Dann sind wir zum Kampfvirtualisierungssystem übergegangen und es wurde ein bisschen einfacher: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/po/nl/hq/ponlhqp1327wrr6hmvpczednm8q.png" alt="Bild"></div><br>  Zum Vergleich gibt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mirror.truenetwork.ru</a> 3 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gbit</a> / s Datenverkehr von zwei Servern zurück.  Bei uns ist alles viel bescheidener und im Allgemeinen ist es mehr als genug für uns, den Prozess zu genießen, sowie seltene überraschend-enthusiastische Bewertungen von Freunden und Abonnenten, wenn jemand plötzlich vertraute Zeilen bemerkt, während er sein System aktualisiert.  Und manchmal flackert es im Hintergrund in verschiedenen Artikeln und Handbüchern, in denen Links zu unserem Spiegel in den Protokollen oder Screenshots sichtbar sind. <br><br>  Sie können hier den Status aller in Centos bekannten Spiegel sehen und lesen, wie Sie sich an dem Projekt beteiligen können. Es ist sowohl einfach als auch verantwortungsbewusst, aber sicherlich nicht nutzlos. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de476262/">https://habr.com/ru/post/de476262/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de476252/index.html">E-Mail-Migration: So können Sie problemlos von einem Server auf einen anderen wechseln</a></li>
<li><a href="../de476254/index.html">Von Studenten über Zwischenfälle bis hin zum Einstieg in ein IT-Unternehmen ohne Wissen und Erfahrung</a></li>
<li><a href="../de476256/index.html">Auf den Spuren der russischen Scala-Bewegung. Teil 3</a></li>
<li><a href="../de476258/index.html">GitLab-Datenbankmigration zu externem PostgreSQL</a></li>
<li><a href="../de476260/index.html">Wir sammeln in rpm WireMock - ein Dienstprogramm zum Erstellen von Stubs über Webdienste in Fedora COPR analog zu PPA in Ubuntu</a></li>
<li><a href="../de476264/index.html">Telegrammbot zum Erlernen von Fremdsprachen: Vom Wortballen bis zum Sprechen</a></li>
<li><a href="../de476266/index.html">Praktikum bei Mars Digital Technologies. Wie wir Deep Learning bei M & M angewendet haben</a></li>
<li><a href="../de476268/index.html">Lösungen für das Auffinden von Fehlern, die das PVS-Studio-Team auf Konferenzen in den Jahren 2018-2019 anbietet</a></li>
<li><a href="../de476270/index.html">Unser Won: TopCoder Open 2019</a></li>
<li><a href="../de476272/index.html">Antworten auf Aufgaben vom PVS-Studio-Stand auf Konferenzen 2018-2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>