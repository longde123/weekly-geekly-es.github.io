<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôªÔ∏è ‚õπüèª üìü Am√©lioration de la fonctionnalit√© des composants React avec React.memo () üêπ üëåüèæ ‚öôÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous vous pr√©sentons une traduction de l'article de Chidume Nnamdi, qui a √©t√© publi√© sur blog.bitsrc.io. Si vous voulez savoir comment √©viter le rendu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Am√©lioration de la fonctionnalit√© des composants React avec React.memo ()</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/plarium/blog/442116/">  Nous vous pr√©sentons une traduction de l'article de Chidume Nnamdi, qui a √©t√© publi√© sur blog.bitsrc.io.  Si vous voulez savoir comment √©viter le rendu inutile et comment les nouveaux outils sont utiles dans React, bienvenue √† cat. <br><br><img src="https://habrastorage.org/webt/pd/cr/7a/pdcr7arl6hgkxg17v5c4laoxsj8.jpeg"><a name="habracut"></a><br><br>  L'√©quipe React.js travaille dur pour faire fonctionner React le plus rapidement possible.  Pour permettre aux d√©veloppeurs d'acc√©l√©rer leurs applications React, les outils suivants y ont √©t√© ajout√©s: <br><br><ul><li>  React.lazy et Suspense pour un chargement retard√© des composants; </li><li>  Composant pur </li><li>  les hooks du cycle de vie devraientComponentUpdate (...) {...}. </li></ul><br>  Dans cet article, nous consid√©rerons, entre autres, un autre outil d'optimisation ajout√© dans React v16.6 pour acc√©l√©rer les fonctions des composants - <b>React.memo</b> . <br><br>  Conseil: utilisez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Bit</a> pour installer et partager des composants React.  Utilisez vos composants pour cr√©er de nouvelles applications et partagez-les avec l'√©quipe pour acc√©l√©rer les choses.  Essayez-le! <br><br><img src="https://habrastorage.org/webt/uk/nn/k8/uknnk8ugyblbcsges3q5aag8n3m.gif"><br><br><h3>  Rendu suppl√©mentaire </h3><br>  Dans React, chaque composant correspond √† une unit√© de vue.  Les composants ont √©galement des √©tats.  Lorsque la valeur d'√©tat change en raison des actions de l'utilisateur, le composant se rend compte qu'un nouveau dessin est n√©cessaire.  Le composant React peut √™tre redessin√© un certain nombre de fois.  Dans certains cas, cela est n√©cessaire, mais le plus souvent, vous pouvez vous passer d'un moteur de rendu, d'autant plus que cela ralentit consid√©rablement l'application. <br><br>  Consid√©rez le composant suivant: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestC</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">count</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } } componentWillUpdate(nextProps, nextState) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'componentWillUpdate'</span></span>) } componentDidUpdate(prevProps, prevState) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'componentDidUpdate'</span></span>) } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div &gt; {</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.state.count} &lt;button onClick={(</span></span></span><span class="hljs-function">)=&gt;</span></span><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({<span class="hljs-attr"><span class="hljs-attr">count</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>})}&gt;Click Me&lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt; &lt;/</span></span>div&gt; ); } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> TestC;</code> </pre> <br>  La valeur initiale de l'√©tat {count: 0} est 0. Si vous cliquez sur le bouton Click me, l'√©tat de count deviendra 1. Sur notre √©cran, 0 passera √©galement √† 1. Mais si nous cliquons √† nouveau sur le bouton, les probl√®mes commencent: le composant ne doit pas √™tre redessin√©, car il la condition n'a pas chang√©.  La valeur du compteur ¬´√†¬ª est 1, la nouvelle valeur est √©galement une, ce qui signifie qu'il n'est pas n√©cessaire de mettre √† jour le DOM. <br><br>  Pour voir la mise √† jour de notre TestC, dans lequel le m√™me √©tat est d√©fini deux fois, j'ai ajout√© deux m√©thodes de cycle de vie.  React d√©marre le cycle componentWillUpdate lorsque le composant est mis √† jour / redessin√© en raison d'un changement d'√©tat.  Le cycle componentdidUpdate React d√©marre lorsqu'un composant s'affiche correctement. <br><br>  Si nous lan√ßons le composant dans le navigateur et essayons de cliquer plusieurs fois sur le bouton Click me, nous obtenons le r√©sultat suivant: <br><br><img src="https://habrastorage.org/webt/qj/l9/zx/qjl9zx25xiry_bzjrwasb9t4b5k.png"><br><br>  La r√©p√©tition de l'entr√©e componentWillUpdate dans notre console indique que le composant est redessin√© m√™me lorsque l'√©tat ne change pas.  Ceci est un rendu suppl√©mentaire. <br><br><h3>  Composant pur / shouldComponentUpdate </h3><br>  Le hook de cycle de vie shouldComponentUpdate permet d'√©viter le rendu inutile dans les composants React. <br><br>  React lance la m√©thode <b>shouldComponentUpdate</b> au d√©but du rendu des composants et re√ßoit un feu vert de cette m√©thode pour continuer le processus ou un signal indiquant que le processus est <b>inhib√©</b> . <br><br>  Laissez notre shouldComponentUpdate ressembler √† ceci: <br><br><pre> <code class="javascript hljs">shouldComponentUpdate(nextProps, nextState) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> <br><ul><li>  <code>nextProps</code> : la prochaine valeur d' <code>props</code> que le composant recevra; </li><li>  <code>nextState</code> : la prochaine valeur d' <code>state</code> que le composant recevra. </li></ul><br>  Nous permettons donc √† React de rendre le composant car la valeur de retour est <code>true</code> . <br><br>  Supposons que nous √©crivions ce qui suit: <br><br><pre> <code class="javascript hljs">shouldComponentUpdate(nextProps, nextState) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> }</code> </pre><br>  Dans ce cas, nous interdisons √† React de restituer le composant, car <code>false</code> retourn√©. <br>  De ce qui pr√©c√®de, il s'ensuit que pour rendre le composant, nous devons retourner <code>true</code> .  Maintenant, nous pouvons r√©√©crire le composant TestC comme suit: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestC</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">count</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } } componentWillUpdate(nextProps, nextState) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'componentWillUpdate'</span></span>) } componentDidUpdate(prevProps, prevState) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'componentDidUpdate'</span></span>) } shouldComponentUpdate(nextProps, nextState) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.count === nextState.count) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div&gt; { </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.state.count } &lt;button onClick = { (</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">count</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }) }&gt; Click Me &lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt; &lt;/</span></span>div&gt; ); } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> TestC;</code> </pre><br>  Nous avons ajout√© un hook shouldComponentUpdate au composant TestC.  La valeur de <code>count</code> dans l'objet d'√©tat actuel <code>this.state.count</code> compar√©e √† la valeur de <code>count</code> dans l'objet d'√©tat suivant <code>nextState.count</code> .  S'ils sont √©gaux <code>===</code> , le redessin ne se produit pas et <code>false</code> renvoy√©.  S'ils ne sont pas √©gaux, <code>true</code> renvoy√© et un moteur de rendu est lanc√© pour afficher la nouvelle valeur. <br><br>  Si nous testons le code dans un navigateur, nous verrons un r√©sultat familier: <br><br><img src="https://habrastorage.org/webt/jp/wd/2x/jpwd2xhiz5zckb5f2c-xwosbife.png"><br><br>  Mais en cliquant plusieurs fois sur le bouton <code>Click Me</code> , tout ce que nous voyons est le suivant (affich√© une seule fois!): <br><br> <code>componentWillUpdate <br> componentDidUpdate</code> <br> <br><img src="https://habrastorage.org/webt/gy/xc/ir/gyxcir1kjjyki18hzqxdfz5hzeu.png"><br><br>  Vous pouvez modifier l'√©tat du composant TestC dans l'onglet React DevTools.  Cliquez sur l'onglet R√©agir, s√©lectionnez TestC √† droite, et vous verrez la valeur d'√©tat du compteur: <br><br><img src="https://habrastorage.org/webt/pi/qg/ix/piqgixsafppm6jygqftfm8nkpyq.png"><br><br>  Cette valeur peut √™tre modifi√©e.  Cliquez sur le texte du compteur, tapez 2 et appuyez sur Entr√©e. <br><br><img src="https://habrastorage.org/webt/v3/4m/tl/v34mtl_unwz6gmkip2kxw_4a1km.png"><br><br>  L'√©tat de comptage va changer, et dans la console, nous verrons: <br><br><pre> <code class="javascript hljs">componentWillUpdate componentDidUpdate componentWillUpdate componentDidUpdate</code> </pre><br><img src="https://habrastorage.org/webt/ql/3y/_i/ql3y_ijc3qwx9byxo_lu8ckbg-g.png"><br><br>  La valeur pr√©c√©dente √©tait 1 et la nouvelle √©tait 2, donc un nouveau trac√© √©tait n√©cessaire. <br>  Passons au <b>composant pur</b> . <br><br>  Pure Component est apparu dans React dans la version v15.5.  Il est utilis√© pour comparer les valeurs par d√©faut ( <code>change detection</code> ).  En utilisant <code>extend React.PureComponent</code> , vous n'avez pas besoin d'ajouter la m√©thode de cycle de vie <code>shouldComponentUpdate</code> aux composants: le suivi des modifications se fait tout seul. <br><br>  Ajoutez un PureComponent au composant TestC. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestC</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">count</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } } componentWillUpdate(nextProps, nextState) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'componentWillUpdate'</span></span>) } componentDidUpdate(prevProps, prevState) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'componentDidUpdate'</span></span>) } <span class="hljs-comment"><span class="hljs-comment">/*shouldComponentUpdate(nextProps, nextState) { if (this.state.count === nextState.count) { return false } return true }*/</span></span> render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div&gt; { </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.state.count } &lt;button onClick = { (</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">count</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }) }&gt; Click Me &lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt; &lt;/</span></span>div &gt; ); } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> TestC;</code> </pre><br>  Comme vous pouvez le voir, nous avons <code>shouldComponentUpdate</code> dans un commentaire.  Nous n'en avons plus besoin: tout le travail est fait par <code>React.PureComponent</code> . <br><br>  En red√©marrant le navigateur pour tester la nouvelle solution, et en cliquant plusieurs fois sur le bouton <code>Click Me</code> , nous obtenons: <br><br><img src="https://habrastorage.org/webt/jp/wd/2x/jpwd2xhiz5zckb5f2c-xwosbife.png"><br><br><img src="https://habrastorage.org/webt/gy/xc/ir/gyxcir1kjjyki18hzqxdfz5hzeu.png"><br><br>  Comme vous pouvez le voir, un seul <code>component*Update</code> Entr√©e de <code>component*Update</code> est apparu dans la console. <br><br>  Apr√®s avoir vu comment travailler dans React avec redessiner dans les classes de composants d'ES6, nous passons aux fonctions des composants.  Comment obtenir les m√™mes r√©sultats avec eux? <br><br><h3>  Composants de fonction </h3><br>  Nous savons d√©j√† comment optimiser le travail avec les classes en utilisant le composant pur et la <code>shouldComponentUpdate</code> cycle de vie <code>shouldComponentUpdate</code> .  Personne ne pr√©tend que les composants de classe sont les principaux composants de React, mais vous pouvez utiliser des fonctions comme composants. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestC</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> I am a functional component </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ) }</code> </pre> <br>  Il est important de se rappeler que les composants de fonction, contrairement aux composants de classe, n'ont pas d'√©tat (bien que maintenant que les hooks <code>useState</code> soient <code>useState</code> , cela peut √™tre discut√©), ce qui signifie que nous ne pouvons pas configurer leur redessin.  Les m√©thodes de cycle de vie que nous avons utilis√©es lorsque nous travaillions avec des classes ne sont pas disponibles ici.  Si nous pouvons ajouter des crochets de cycle de vie aux composants de fonction, nous pouvons ajouter la m√©thode <code>shouldComponentUpdate</code> pour indiquer √† React qu'un rendu de fonction est n√©cessaire.  (L'auteur a peut-√™tre fait une erreur factuelle dans la derni√®re phrase. - √âd. Approx.) Et, bien s√ªr, nous ne pouvons pas utiliser l' <code>extend React.PureComponent</code> . <br><br>  Nous transformons notre classe de composants ES6 TestC en fonction de composant. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> TestC = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Rendering TestC :`</span></span> props) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {props.count} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ) } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> TestC; <span class="hljs-comment"><span class="hljs-comment">// App.js &lt;TestC count={5} /&gt;</span></span></code> </pre> <br>  Apr√®s le rendu dans la console, nous voyons l' <code>Rendering TestC :5</code> . <br><br><img src="https://habrastorage.org/webt/zl/ul/q4/zlulq4t7iokqfn9my1s9yka6v_w.png"><br><br>  Ouvrez DevTools et cliquez sur l'onglet React.  Ici, nous allons essayer de changer la valeur des propri√©t√©s du composant TestC.  S√©lectionnez TestC, et les propri√©t√©s du compteur avec toutes les propri√©t√©s et valeurs de TestC s'ouvriront sur la droite.  Nous ne voyons que le compteur avec la valeur actuelle de 5. <br><br>  Cliquez sur le chiffre 5 pour modifier la valeur.  Une fen√™tre de saisie appara√Ætra √† la place. <br><br><img src="https://habrastorage.org/webt/1h/u-/31/1hu-31ov7pulpn2iuqatr667rns.png"><br><br>  Si nous modifions la valeur num√©rique et appuyons sur Entr√©e, les propri√©t√©s du composant changeront en fonction de la valeur que nous avons entr√©e.  Supposons √† 45. <br><br><img src="https://habrastorage.org/webt/bn/9t/yx/bn9tyxzi3bznqpx_6onqz2athra.png"><br><br>  Acc√©dez √† l'onglet Console. <br><br><img src="https://habrastorage.org/webt/1m/8a/k8/1m8ak8oggdsmsahkqbg8npptrau.png"><br><br>  Le composant TestC a √©t√© redessin√© car la valeur pr√©c√©dente de 5 est devenue la valeur actuelle - 45. Revenez √† l'onglet React et changez la valeur en 45, puis revenez √† la console. <br><br><img src="https://habrastorage.org/webt/ea/mu/vy/eamuvycxua6dksm8yp_o2b0bcym.png"><br><br>  Comme vous pouvez le voir, le composant est redessin√©, bien que les valeurs pr√©c√©dente et nouvelle soient les m√™mes.  :( <br><br>  Comment g√©rer un moteur de rendu? <br><br><h3>  Solution: React.memo () </h3><br>  <code>React.memo()</code> est une nouvelle fonctionnalit√© introduite dans React v16.6.  Son principe de fonctionnement est similaire au principe de <code>React.PureComponent</code> : aide √† la gestion du redessin des fonctions des composants.  <code>React.memo(...)</code> pour les composants de classe est <code>React.PureComponent</code> pour les composants de fonction. <br><br>  <b>Comment travailler avec React.memo (...)?</b> <br>  Assez simple.  Disons que nous avons une fonction composante. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Funcomponent = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">=&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Hiya!! I am a Funtional component </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ) }</code> </pre><br>  Il suffit de passer FuncComponent comme argument √† la fonction React.memo. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Funcomponent = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">=&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Hiya!! I am a Funtional component </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ) } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> MemodFuncComponent = React.memo(FunComponent)</code> </pre> <br>  React.memo renvoie un MemodFuncComponent <code>purified MemodFuncComponent</code> .  C'est ce que nous allons dessiner dans le balisage JSX.  Lorsque les propri√©t√©s et l'√©tat d'un composant changent, React compare les propri√©t√©s et les √©tats pr√©c√©dents et actuels du composant.  Et seulement s'ils ne sont pas identiques, la fonction composant est redessin√©e. <br><br>  Appliquez cela au composant de fonction TestC. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> TestC = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Rendering TestC :'</span></span>, props) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> { props.count } </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/&gt;</span></span></span><span class="xml"> ) } TestC = React.memo(TestC);</span></span></code> </pre> <br>  Ouvrez un navigateur et t√©l√©chargez l'application.  Ouvrez DevTools et acc√©dez √† l'onglet React.  S√©lectionnez <code>&lt;Memo(TestC)&gt;</code> . <br><br>  Si dans le bloc de droite nous changeons les propri√©t√©s du compteur √† 89, l'application sera redessin√©e. <br><br><img src="https://habrastorage.org/webt/kf/tl/ms/kftlmsn1bznnmh9loxbedc_acqi.png"><br><br>  Si nous changeons la valeur par la pr√©c√©dente, 89, alors ... <br><br><img src="https://habrastorage.org/webt/j4/ak/tq/j4aktqq4qfwkizulxk2h-em4ism.png"><br><br>  Il n'y aura pas de refonte! <br><br>  Gloire √† React.memo (...)!  :) <br><br>  Sans utiliser <code>React.memo(...)</code> dans notre premier exemple, la fonction du composant TestC est redessin√©e m√™me lorsque la valeur pr√©c√©dente devient identique.  Maintenant, gr√¢ce √† <code>React.memo(...)</code> , nous pouvons √©viter un rendu inutile des fonctions des composants. <br><br><h3>  Conclusion </h3><br><ul><li>  Passons en revue la liste? </li><li>  <code>React.PureComponent</code> - argent; </li><li>  <code>React.memo(...)</code> - or; </li><li>  <code>React.PureComponent</code> fonctionne avec les classes ES6; </li><li>  <code>React.memo(...)</code> fonctionne avec des fonctions; </li><li>  <code>React.PureComponent</code> optimise le redessin des classes ES6; </li><li>  <code>React.memo(...)</code> optimise le redessin des fonctions; </li><li>  l'optimisation des fonctionnalit√©s est une excellente id√©e; </li><li>  <code>React</code> ne sera plus jamais le m√™me. </li></ul><br>  Si vous avez des questions sur l'article ou des informations suppl√©mentaires, des changements ou des objections, n'h√©sitez pas √† m'√©crire des commentaires, des courriels ou des messages priv√©s. <br><br>  Je vous remercie! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr442116/">https://habr.com/ru/post/fr442116/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr442104/index.html">Guide de l'utilisateur Kibana. Visualisation. Partie 5</a></li>
<li><a href="../fr442108/index.html">Guide pour les d√©veloppeurs pour cr√©er des applications AI</a></li>
<li><a href="../fr442110/index.html">Antipatterns Vim</a></li>
<li><a href="../fr442112/index.html">De nouveaux langages de programmation tuent tranquillement notre connexion avec la r√©alit√©</a></li>
<li><a href="../fr442114/index.html">Guide de l'audit automatique des contrats intelligents. Partie 3: Mythril</a></li>
<li><a href="../fr442118/index.html">Le pool minier Coinhive cesse de fonctionner</a></li>
<li><a href="../fr442120/index.html">Formation aux mod√®les TensorFlow avec Azure Machine Learning Service</a></li>
<li><a href="../fr442122/index.html">Un simple Levelord moscovite: une entrevue avec le cr√©ateur de Duke Nukem</a></li>
<li><a href="../fr442124/index.html">Facebook donnera aux utilisateurs la possibilit√© de nettoyer leur histoire</a></li>
<li><a href="../fr442130/index.html">Tests 3CX v16 sur Raspberry Pi 3B + et mise √† jour WebMeeting</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>