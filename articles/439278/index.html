<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëãüèΩ üõåüèæ üßñüèΩ ACS de mi LCD: seguridad con dos tornillos üëçüèΩ üôåüèª üåë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Me apresuro a advertir a los lectores: este art√≠culo est√° escrito solo para informaci√≥n, y en ning√∫n caso no requiere ninguna acci√≥n ilegal. El autor ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ACS de mi LCD: seguridad con dos tornillos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439278/"> Me apresuro a advertir a los lectores: este art√≠culo est√° escrito solo para informaci√≥n, y en ning√∫n caso no requiere ninguna acci√≥n ilegal.  El autor no es responsable de ninguna acci√≥n ilegal cometida por personas que usan la informaci√≥n de este art√≠culo. <br><br><img src="https://habrastorage.org/webt/yk/fs/p-/ykfsp-giznlsydndwjjukl8hzyw.png"><br><br>  Saludos al lector.  Hoy quiero hablar sobre la seguridad de los sistemas de control y gesti√≥n de acceso (ACS) en general y el ejemplo de mi LCD.  Se examinar√°n las principales vulnerabilidades, as√≠ como un intento exitoso de copiar claves.  Todas las manipulaciones ser√°n principalmente de naturaleza de hardware. <br><a name="habracut"></a><br>  En mi complejo residencial, est√° instalado el sistema de portero Sinthesi S2, as√≠ como el sistema de acceso patio / entrada / piso producido por Urmet Group.  As√≠ de genial se ve√≠a el panel de la calle. <br><br><img src="https://habrastorage.org/webt/fm/mr/b1/fmmrb1xbkfetetbxhurozddrtfi.png"><br><br>  hasta que un d√≠a comenc√© a lucir as√≠: <br><br><img src="https://habrastorage.org/webt/fv/7q/hq/fv7qhqsdztc7j5h9la_ww4k38sw.png"><br><br>  Estuvo as√≠ un par de d√≠as y luego emigr√≥ a un contenedor de basura cercano.  Solo ten√≠a un lector y un teclado.  Debido a que una de las √°reas de mi empresa es el desarrollo de lectores HF, no pude resistirme y decid√≠ estudiar este lector RFID con m√°s detalle.  De la documentaci√≥n encontr√© solo un gran <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cat√°logo</a> del que se puede concluir que se trata de FD-020-017, un lector de 13.56 MHz con la interfaz Wiegand26.  Dentro hab√≠a un s√°ndwich de las placas de lectura ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MFRC531</a> ) y MK con BLE ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CC2541</a> ) pegado con adhesivo termofusible a la carcasa, que claramente no fue desarrollado para esta placa. <br><br><img src="https://habrastorage.org/webt/-l/qq/yt/-lqqyti00ujmciyzmppzpkzcbn8.png"><br><br>  La placa MK est√° inundada con un compuesto suave aparentemente para proteger la parte de la radio de la humedad.  Girando el tablero en mis manos, lo pospuse. <br><br>  Hasta hace poco, el sistema no me interesaba, ya que se inici√≥ parcialmente (solo funcionaban las cerraduras de acceso, pero ten√≠an un c√≥digo de acceso que yo conoc√≠a y no usaba una clave).  Despu√©s de que el sistema se inici√≥ por completo y se cancelaron los c√≥digos de acceso, comenc√© a estudiarlo con m√°s detalle.  Comenz√≥ una de las noches cuando regres√© a casa y descubr√≠ que la puerta del vest√≠bulo ya estaba funcionando y que mi esposa ya estaba durmiendo.  Solo ten√≠a cosas de bolsillo conmigo, pero result√≥ que esto fue suficiente para sortear toda la seguridad de √©lite (como asegura Urmet). <br><br><img src="https://habrastorage.org/webt/ip/9o/av/ip9oavphdqdmspjusi-wbwkvlsy.png"><br><br>  Todo lo que necesitaba era desenroscar los 2 tornillos que sujetaban el marco del panel con la llave del autom√≥vil, quitar los 2 bloques y usar la misma llave para cerrar el canal del rel√© que va a la cerradura de la puerta del vest√≠bulo.  Todos ... <br>  Despu√©s de este incidente, cuando veo otra pel√≠cula de Hollywood ("Pasajeros" (2016) en KDPV) y veo c√≥mo se abren las puertas s√∫per secretas quitando el panel de c√≥digos y colocando alfileres en el tablero (necesariamente con chispas y una apertura de puerta espectacular), veo bastante Situaci√≥n real. <br><br>  En mi memoria, la mayor√≠a de los ACS que he visto tienen acceso al bloqueo directamente desde el panel de c√≥digos y esta es la principal vulnerabilidad.  Toda la seguridad es proporcionada por unos pocos tornillos que sujetan este panel, y en la creencia de que este sistema es confiable.  Pero al mismo tiempo, es posible aumentar significativamente el umbral de entrada (llam√©moslo protecci√≥n contra una persona con un destornillador) mediante el uso de cerraduras con cerebros controlados por una interfaz, incluso si es la m√°s simple.  Esta medida reducir√° dr√°sticamente la probabilidad de entrada espont√°nea. <br><br><h3>  Datos de origen </h3><br>  LCD ACS en su conjunto, su funcionamiento, reacci√≥n a otras teclas, as√≠ como una forma de agregar teclas: <br><br><ul><li>  Se emite una llave gratis para el apartamento, cada una es de 300 rublos, est√° registrada en la cuenta personal de ACS.  Solo puedes comprar en el Reino Unido.  El chat LCD escribi√≥ que las copiadoras del mercado no pod√≠an hacer un duplicado, lo que significa que el sistema es m√°s genial que solo leer el UID. </li><li>  Al presentar cualquier otra tarjeta mifare, el lector ni siquiera muestra que la ve. </li><li>  Cuando lleva la llave a otra escalera / piso, el lector recoge una lectura, pero no sucede nada. </li><li>  Al leer el contenido de las teclas 8 y 12, los bloques est√°n ocultos y tienen una clave de acceso diferente de las claves conocidas de Mifare.  Entonces el secreto est√° ah√≠ afuera en alguna parte. </li></ul><br><img src="https://habrastorage.org/webt/nr/1k/xl/nr1kxljcz-vzxdgknnfcmyz0jh0.png"><br><br><h3>  Inicio del trabajo </h3><br>  En primer lugar, copi√© Block0 (el que contiene UID e informaci√≥n del fabricante) en el disco Mifare Zero y verifiqu√© que esto no era suficiente: el llavero no funcionaba.  El lector ni siquiera respondi√≥ a la presentaci√≥n de tal clon.  Qued√≥ claro que debes buscar la clave para los sectores 8 y 12. Despu√©s de leer todas las baratijas disponibles, vi que solo una de ellas tiene 12 bloques bloqueados, en el resto es cero, por lo que es obvio que la magia est√° contenida en el bloque 8. <br><br>  Es hora de obtener un lector talentoso y examinarlo m√°s de cerca.  Entonces tenemos FD-020-017 - 13.56 MHz, interfaz Wiegand26.  El MFRC531 y CC2541 est√°n conectados por un peine de 10 pines.  Y trabaj√≥ perfectamente en la mesa, sin el resto del sistema.  Reaccion√≥ a las teclas de la misma manera que el resto de los lectores.  Primero, veamos qu√© sale: <br><br><img src="https://habrastorage.org/webt/kf/sy/wm/kfsywm6pgxzqcggydxffit8-nnw.png"><br><br>  Silencio exactamente antes de la presentaci√≥n de un llavero v√°lido.  Despu√©s de leer la interfaz, el mensaje sale de acuerdo con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Wiegand26</a> .  Entonces descifr√© el paquete que env√≠a mi llave.  Con la ayuda de un mult√≠metro, restaur√© el pinout, result√≥ que los chips se comunican por SPI.  Conectamos el analizador, <br><br><img src="https://habrastorage.org/webt/2s/z6/pu/2sz6pu-h8fykc157m8vbc3xgfyy.png"><br><br>  Traemos un llavero v√°lido y miramos el intercambio por SPI: <br><br><img src="https://habrastorage.org/webt/j3/gd/ui/j3gduiwafbqwrjznhpjmvlq3p2u.png"><br><br>  A continuaci√≥n, comenc√© a mirar la documentaci√≥n del chip <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MFRC531</a> y casi me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">caigo de</a> las manos cuando vi que ten√≠a una EEPROM especial para almacenar claves.  Encontr√© los comandos para cargar la clave: <br><br><img src="https://habrastorage.org/webt/gm/zb/x6/gmzbx6c4cu4de6ut89jbkfxkwbe.png"><br><br>  El comando 0x0B se carga desde la EEPROM, el comando 0x19 de FIFO, que a su vez recibe la clave a trav√©s de SPI.  Parece que si carga una clave desde EEPROM, entonces no tengo oportunidad de revertir de esta manera, PERO para mi sorpresa, no hay un comando de intercambio 0x0B, pero hay un comando 0x19 <br><br><img src="https://habrastorage.org/webt/qj/wi/zk/qjwizk-mxiizgq5kgafox6puguu.png"><br><br>  Solo queda recoger la clave seg√∫n el formato <br><br><img src="https://habrastorage.org/webt/rh/ef/ak/rhefak-ucxfeotu8c5_aps6xm0k.png"><br><br>  Y agregue a la hoja de claves. <br><br><img src="https://habrastorage.org/webt/tt/ga/nz/ttganzuuekb2ntx4xwjeucldgbm.png"><br><br>  Bingo !!!  Result√≥ que el bloque 8 comienza con 3 bytes distintos de cero, que simplemente van a Wiegand cuando coinciden el llavero y el lector.  Estos datos no tienen nada que ver con el UID; lo m√°s probable es que solo sea un n√∫mero de serie cuando se publica en el C√≥digo Penal.  Mis llaveros ten√≠an 3 n√∫meros seguidos + uno muy diferente.  La grabaci√≥n del espacio en blanco fue exitosa, combin√© la clave de la pantalla LCD con la clave de la oficina, que funciona por UID. <br><br><h3>  Conclusi√≥n </h3><br>  Para un pirateo exitoso del sistema, necesito agradecer al programador de Urmet Group, que francamente enga√±√≥ al escribir software para el lector, porque si hay hardware capaz de eliminar dicho m√©todo de pirateo (generalmente bastante simple), no puede hacer esto, no puede nombrar nada m√°s que el trabajo de pirateo. <br><br>  La mayor√≠a de las personas que trabajan con la tecnolog√≠a RFID saben que el algoritmo de cifrado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Crypto-1</a> utilizado en las tarjetas Mifare (Classic) ha estado descifrado durante mucho tiempo y fue posible obtener la clave del bloque de una manera m√°s "limpia", pero fui de frente. <br><br>  En nuestros propios proyectos, utilizamos lectores programables con diccionarios de contrase√±a √∫nica para el cifrado.  Esto le permite protegerse de la clonaci√≥n si la tarjeta original est√° unida al lector antes del clon, de lo contrario detectar√° duplicaci√≥n (la tarjeta original dejar√° de funcionar). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/439278/">https://habr.com/ru/post/439278/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../439264/index.html">C√≥mo gestionar proyectos t√©cnicos complejos sin contratar PM: experiencia de DataLine</a></li>
<li><a href="../439266/index.html">La experiencia de crear un juego para Android solo desde cero y c√≥mo se acredit√≥ a Google Play</a></li>
<li><a href="../439268/index.html">C√≥mo funcionan juntos la impresi√≥n VR, AR y 3D: experiencia de concepto VR</a></li>
<li><a href="../439270/index.html">Un ejemplo de an√°lisis de c√≥digo C ++ usando libclang en Python</a></li>
<li><a href="../439272/index.html">Cuaderno Jupyter en Netflix</a></li>
<li><a href="../439280/index.html">Trautonio: la ola alemana en la historia de los sintetizadores</a></li>
<li><a href="../439282/index.html">Efectos de filtrado SVG. Parte 1. Filtros SVG 101</a></li>
<li><a href="../439286/index.html">Sobre el an√°lisis est√°tico con toda honestidad</a></li>
<li><a href="../439288/index.html">SciPy, optimizaci√≥n</a></li>
<li><a href="../439290/index.html">Acelere la compilaci√≥n en Xcode en Swift</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>