<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍🤝‍👨🏼 🚧 ☦️ Comment créer des mécanismes de jeu fiables dans Excel. 2e partie 😋 🐞 💆🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cette partie, nous allons résoudre le problème du placement optimal des armes sur le char, la disposition spatiale des téléporteurs en MMORPG et ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment créer des mécanismes de jeu fiables dans Excel. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430114/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/uz/nc/jb/uzncjbvwkyi9mqataguysd8pjai.png"></div><br>  Dans cette partie, nous allons résoudre le problème du placement optimal des armes sur le char, la disposition spatiale des téléporteurs en MMORPG et équilibrer les batailles des quatre classes de personnages RPG. <br><br><h2>  Tâches de placement d'objets </h2><br>  <i>Les feuilles de calcul pour cette partie peuvent être téléchargées ici: ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SuperTank</a> ) ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">téléporteurs, partie 1</a> ) ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">téléporteurs, partie 2</a> )</i> <br><br><h2>  SuperTank: le problème est résolu! </h2><br>  Dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">premier article de la</a> série, nous avons parlé d'un exemple de tâche pour un jeu appelé SuperTank.  Dans la deuxième partie, nous nous sommes familiarisés avec les concepts de base de la modélisation décisionnelle et j'ai parlé de résoudre un exemple simple en utilisant l'outil "Rechercher des solutions" dans Excel. <br><br>  Nous pouvons maintenant appliquer les connaissances acquises dans la deuxième partie au problème du SuperTank et prouver qu'avec leur aide, ce problème peut être résolu facilement et rapidement.  Rafraîchissez votre mémoire: SuperTank est un jeu dans lequel vous pouvez vous battre sur un tank personnalisé. <a name="habracut"></a>  Le supertank ressemble à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fb8/a6c/2fc/fb8a6c2fcddbb776a18893059f989afc.jpg"></div><br>  Chaque supertank peut avoir n'importe quel nombre d'armes à feu de cinq types différents: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/62e/717/050/62e717050c0d1e991663a3e9ef2dfc39.png"></div><br>  Un supertank peut contenir 50 tonnes d'armes et un joueur peut dépenser 100 crédits.  En outre, le supertank dispose de 3 «emplacements critiques», dans lesquels des pistolets spéciaux tels que MegaRocket et UltraLaser sont placés. <br><br>  La feuille de calcul de cet exemple peut être téléchargée <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  L'objectif est de ramasser des armes qui maximisent les dégâts causés par le super tank, sans dépasser les limites de 50 tonnes, 100 crédits et 3 emplacements critiques.  Nous supposons également que ce tableau contient toutes les informations nécessaires et que des facteurs tels que la portée, la fréquence et la précision ne sont pas pertinents ou sont déjà pris en compte dans le paramètre Dégâts de l'arme correspondante. <br><br>  Pour optimiser ce schéma, nous saisissons d'abord ces données dans la feuille de calcul.  Juste en dessous, nous ajouterons un autre tableau, dans lequel il y aura un ensemble de 5 cellules «quantitatives» pour indiquer la quantité de chacun des 5 types d'armes. <br><br>  Jusqu'à ce que nous entrions une valeur de 1 dans ces cellules, juste pour tester leur travail, mais ce seront nos cellules de décision - nous demanderons à l'outil Solveur de trouver les valeurs correctes pour ces cellules.  Il est possible de comprendre que ce sont des cellules de décision en jaune, car nous continuons de suivre les règles de mise en forme décrites dans la deuxième partie.  À droite des cellules «quantitatives», nous ajouterons des cellules de calcul qui multiplieront les valeurs de quantité dans les cellules de décision par les valeurs de dommages, poids, coût et emplacements critiques du tableau ci-dessus.  Ainsi, chaque ligne de ce tableau affichera correctement les dégâts, le poids, le prix et les emplacements critiques requis pour toutes les armes utilisées dans toutes les catégories d'armes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f4e/342/27a/f4e34227a58768ee4d0a4f79fe6954e3.png"></div><br>  Nous allons également créer une section ci-dessous, qui résumera toutes les valeurs de quantité, de poids, de coût et de créneaux critiques du tableau ci-dessus, et les comparera avec les valeurs maximales de poids, de coût et de créneaux critiques spécifiées dans les conditions de la tâche (50, 100 et 3, respectivement). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f6/76d/b7e/7f676db7e7034d6b9a02be24c5a1eb4b.png"></div><br>  Conformément aux règles de mise en forme de la deuxième partie de l'article, les cellules bleues en haut sont les critères des conditions du problème.  Les cellules grises sont des cellules de calcul qui représentent le poids total, le coût et les emplacements critiques en fonction de la somme du tableau des quantités (c'est-à-dire les valeurs totales des colonnes Poids x Quantité, Coût x Quantité et Emplacements critiques x Quantité).  Enfin, la cellule orange représente le total des dégâts de notre super tank reçus sur la base du total des dégâts de la colonne Damage x Quantity du tableau ci-dessus. <br><br>  Avant de commencer, rendons notre feuille de calcul plus conviviale.  Nous profiterons de l'occasion d'Excel pour attribuer un nom à chaque cellule et donner des noms clairs à sept cellules dans le dernier tableau de calcul.  C'est facultatif, mais à long terme, cela rendra la feuille de calcul beaucoup plus claire (par exemple, si au lieu de $ F $ 21 la cellule sera appelée MaxCriticalSlots).  Pour ce faire, il suffit de sélectionner une cellule et d'aller dans le champ de saisie du nom à gauche du champ de formule, puis de saisir un nouveau nom. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/295/3bc/e19/2953bce19ac48c3e2ed4920edbb1e26b.png"></div><br>  Enfin, allons dans Excel Solver et trouvons une solution (allez sur le côté droit de l'onglet Données et sélectionnez Solver. Si vous ne le voyez pas, allez dans Options Excel , sélectionnez la catégorie Compléments ("Modules complémentaires"), assurez-vous que les Compléments Excel sont sélectionnés dans la liste déroulante "Gérer", cliquez sur Aller ("Aller ...") et assurez-vous que La case Complément Solveur est cochée. <br><br>  Dans le champ Définir l'objectif («Optimiser la fonction objectif»), nous sélectionnerons la cellule orange de la cible, puis cliquez sur le bouton radio Max («Maximum»).  Dans le champ En modifiant les cellules variables, sélectionnez les cellules de décision (cellules jaunes dans la colonne Quantité du deuxième tableau).  Ci-dessous, cliquez sur le bouton Ajouter pour ajouter les restrictions suivantes: <br><br><ul><li>  Les valeurs des cellules de décision doivent être comprises entre 0 et un maximum raisonnable (nous avons choisi 50, même s'il s'agit probablement d'une valeur limite beaucoup plus élevée que nécessaire).  Il est également nécessaire de définir chaque cellule de solution sur une restriction "= entier", car nous ne pouvons pas avoir une partie fractionnaire de l'armement, et Excel Solver considère que chaque variable est un nombre réel par défaut, sauf indication contraire. </li></ul><br><ul><li>  Nous devons également limiter les valeurs du coût total, du poids total et du nombre total d'emplacements critiques aux valeurs des conditions du problème.  L'image de la boîte de dialogue montre qu'ils ont maintenant des noms pratiques que nous avons ajoutés au tableau inférieur, ce qui facilite la lecture de la boîte de dialogue. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b88/86b/402/b8886b40290a1c34dd36245276ef9930.png"></div><br>  Maintenant, nous cliquons sur le bouton Résoudre («Trouver une solution») et après une courte attente, le solveur remplira les valeurs de quantité, ce qui nous donnera ce qui suit: <br><br><ul><li>  1 mitrailleuse </li><li>  3 fusées </li><li>  2 MegaRockets </li><li>  1 laser </li><li>  1 UltraLaser </li></ul><br>  Tout cela nous donne un total de dégâts de 83 unités et prend exactement 50 tonnes, 100 crédits et 3 emplacements critiques.  Vous pouvez voir que la meilleure solution ne change pas avec l'exécution du solveur.  Si vous réinitialisez ces valeurs et effectuez une seconde optimisation, ou allez dans Options et modifiez la valeur de départ, nous obtiendrons toujours les mêmes valeurs.  Nous ne pouvons pas être sûrs à 100% que cette solution est optimale, mais compte tenu du fait que Solver n'a pas réussi à l'améliorer après plusieurs passes d'optimisation, il est très probable qu'il s'agit d'un réel optimum, et pas seulement d'un maximum local. <br><br>  Le problème est résolu! <br><br><h2>  Utilisations supplémentaires </h2><br>  Ce qui est cool, c'est que non seulement nous avons résolu le problème beaucoup plus rapidement que nous ne pouvions le traiter manuellement, mais aussi que nous l'avons configuré de manière à ce qu'il nous permette de tester quelles armes dans le jeu SuperTank seront les plus utiles avec différents paramètres (poids, coût, emplacements critiques).  Cela signifie que nous pouvons changer relativement facilement l'effet de divers changements de ces paramètres sur le jeu SuperTank, et si nous voulons ajouter un nouveau modèle alternatif de super tank qui sera plus léger, plus lourd ou aura un nombre différent d'emplacements critiques, alors cela peut être fait très simplement. <br><br>  En modifiant tous ces paramètres, nous pouvons également comprendre l'utilité relative de chacune de ces armes et déterminer rapidement laquelle est trop utile, pas assez utile, a un prix qui ne convient pas à son poids et à ses dégâts, etc. <br><br>  Encore une fois, le fait est qu'un tel outil nous permet de rechercher l'espace de conception beaucoup plus rapidement que nous ne pourrions le faire manuellement.  Cela nous offre une opportunité pratique d'évaluer l'effet de ces changements pour toute décision de conception incrémentielle que nous pouvons prendre, que ce soit en changeant les paramètres de l'arme ou du super tank lui-même, en ajoutant de nouvelles armes ou des modèles de super tanks, ainsi qu'en ajoutant de nouveaux paramètres (disons que la taille limite est en mètres cubes). <br><br>  Pour comprendre ce que je veux dire, accédez à la cellule bleue «Coût maximal» et modifiez sa valeur de 100 à 99. Exécutez à nouveau Solver et vous obtiendrez une disposition d'arme complètement différente: <br><br><ul><li>  0 mitrailleuses </li><li>  2 fusées </li><li>  3 MegaRockets </li><li>  3 lasers </li><li>  0 UltraLasers </li></ul><br>  Un tel schéma donne un indice de dommage légèrement inférieur (82 au lieu de 83), mais il est radicalement différent du précédent. <br><br>  Si vous définissez la valeur du coût maximal sur 101 ou 102 et effectuez à nouveau le calcul, il est possible que nous obtenions une configuration similaire à la première ou coïncidant avec elle;  Quoi qu'il en soit, les dommages resteront égaux à 83 (les régimes peuvent changer, car dans de tels cas, il existe plusieurs régimes optimaux).  Cependant, si vous définissez Coût maximum sur 103, vous devriez obtenir les éléments suivants: <br><br><ul><li>  1 mitrailleuse </li><li>  4 fusées </li><li>  2 MegaRockets </li><li>  0 lasers </li><li>  1 UltraLaser </li></ul><br>  Ce qui augmente le total des dégâts à 84. <br><br>  C'est intéressant: cet arrangement d'armes est très différent des deux premiers. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/106/807/611/106807611d9a60e93d06f9ddeca3f7f6.png"></div><br>  Comme vous pouvez le voir, nous obtenons un résultat inattendu: le choix optimal des armes dans notre schéma dépend fortement des paramètres du super tank et peut varier considérablement même avec de petits changements dans ces paramètres.  De plus, cela nous donne toutes sortes d'informations utiles: les cinq types d'armes sont utiles dans au moins deux des trois paramètres de super tank, et les fusées et les méga-poches sont évidemment utiles dans les trois.  Il semble que cela nous indique que les cinq types d'armes sont bien équilibrés, c'est-à-dire utiles les uns par rapport aux autres, et en même temps ils restent uniques. <br><br>  Et comme vous pouvez également le constater, une telle modélisation et optimisation des solutions nous offre une excellente opportunité d'effectuer rapidement des recherches dans un quartier local et de ré-optimiser.  Pour certains types de tâches, cela nous permettra de détecter des stratégies dominantes et des exploits de joueurs difficiles ou impossibles à trouver autrement. <br><br><h2>  Téléports - Trous de ver </h2><br>  En regardant les deux derniers exemples (l'exemple des taux d'imposition dans un jeu stratégique et SuperTank), vous pourriez penser que de telles techniques ne sont applicables que dans les cas où les utilisateurs ont affaire à des chiffres.  Mais vous vous tromperez absolument!  Comme nous le verrons, il existe de nombreux exemples de la façon dont vous pouvez obtenir les avantages de l'optimisation d'éléments de conception qui non seulement ne ressemblent pas à des nombres pour les utilisateurs, mais ne leur ressemblent pas du tout! <br><br>  Vous pouvez également penser que la modélisation des décisions ne s'applique qu'aux décisions que les joueurs peuvent prendre dans les jeux.  Ce n'est pas non plus vrai: dans certains cas, ils peuvent être utilisés pour la modélisation afin d'optimiser vos propres solutions en tant que concepteur. <br><br>  Supposons que vous travaillez sur un MMORPG spatial.  Un jour, votre concepteur principal vient à vous avec une anxiété visible sur son visage.  "Nous achevons une refonte du secteur Omega", dit-il.  «Et nous avons eu un problème.  Nous prévoyons d'ajouter quelques téléporteurs de trous de ver "dans ce segment du monde, mais nous ne pouvons pas nous mettre d'accord sur l'endroit où les placer". <br><br>  «Combien de téléporteurs?» Demandez-vous. <br><br>  «Nous ne savons pas encore.  Probablement trois, mais il peut y en avoir de deux à quatre.  Nous n'en sommes pas encore sûrs. »  Puis il vous montre une carte qui ressemble à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0db/a6e/bc1/0dba6ebc16043666d174e5b3269a2965.png"></div><br>  "Qu'est-ce que c'est?", Demandez-vous. <br><br>  «Il s'agit d'une carte du secteur Omega.  Ou au moins les systèmes stellaires qu'un joueur peut visiter dans ce quadrant.  Nous devons déterminer dans quelles cellules les trous de ver doivent se trouver. » <br><br>  «Eh bien, et selon quelles règles sont-ils placés?  Est-il possible de placer le trou de ver dans un quadrant avec le système stellaire? » <br><br>  «Nous voulons que vous placiez les trous de ver de manière à minimiser la distance entre tout système stellaire et le trou de ver le plus proche.  Et oui, vous pouvez les mettre dans le même quadrant que le système stellaire;  ce ne sont que de petits téléporteurs suspendus dans l'espace, ils peuvent donc être placés n'importe où.  Et rappelez-vous que nous n'avons pas encore décidé combien il devrait y en avoir, alors donnez-moi des solutions pour 2, 3 et 4 trous de ver. » <br><br>  Comment formuler ce problème et comment le résoudre? <br><br><h2>  Optimiser les téléporteurs! </h2><br>  Commençons par préparer les cellules de la solution.  Nous désignons les quatre téléports comme A, B, C et D. Nous savons que chaque téléportation n'est essentiellement rien de plus que les coordonnées (x, y) sur la carte stellaire du secteur Omega.  Nous savons également que nous aurons besoin d'un moyen d'indiquer le nombre de téléports actifs, nous allons donc ajouter une cellule qui vous permet de définir le nombre de téléports.  Nous n'utilisons la téléportation D que lorsque 4 trous de ver sont utilisés et C uniquement lorsque nous en avons 3 ou plus. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e25/6b2/68d/e256b268da6878a1a79c14d2b7bfeb48.png"></div><br>  Ci-dessous, nous préparerons un tableau pour calculer la distance de chaque système stellaire au téléport le plus proche.  Ce tableau ressemble à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cdf/4d8/410/cdf4d8410caa870a35ce2dfbe2f2be19.png"></div><br>  Le bleu de gauche montre les coordonnées de chaque système d'étoiles sur la carte.  Chaque rangée est un système en étoile.  Nous les avons simplement transférés de la carte du secteur Omega, qui nous a été donnée par le principal designer. <br><br>  À droite, nous calculons la distance jusqu'à chacun des quatre téléporteurs.  Ceci est juste un théorème de Pythagore.  La distance est calculée comme la racine carrée des distances horizontales et verticales entre le système stellaire et le téléport: <br><br><blockquote>  <b>= SQRT (($ B14-Ax) ^ 2 + ($ C14-Ay) ^ 2)</b> </blockquote><br>  (Ne vous inquiétez pas - je vous promets que ce sont les mathématiques les plus difficiles que nous rencontrerons dans la série!) <br><br>  Nous prenons les coordonnées X et Y de chaque système stellaire dans les cellules bleues du tableau ci-dessus, et les coordonnées X et Y de chaque téléport (cellules avec les noms Ax et Ay pour téléport A dans la fonction SQRT () illustrée ci-dessus) des cellules de solution jaunes en haut. <br><br>  Enfin, nous prenons le minimum de ces quatre valeurs dans la colonne Dist to Closest, c'est-à-dire que nous utilisons simplement la fonction MIN () pour déterminer le minimum de quatre valeurs sur la gauche.  Ensuite, nous résumons la colonne entière ci-dessous;  la somme est la cellule cible. <br><br>  Vous avez peut-être remarqué que dans la capture d'écran ci-dessus, toutes les cellules sont définies sur Dist à D. La raison en est que nous utilisons la cellule "Nombre de téléporteurs?"  dans la partie supérieure du modèle de solution, qui permet de configurer le nombre de téléports pris en compte.  Si le nombre de téléporteurs est 2, alors nous utilisons la valeur 99 à la fois dans Dist vers C et Dist vers D, et si elle est 3, alors la valeur 99 est utilisée uniquement dans la colonne Dist vers D. Par conséquent, chaque système stellaire ignorera tous les téléporteurs inutiles lors du calcul de la distance jusqu'au téléport le plus proche dans le cas de 2 ou 3 téléports. <br><br>  Nous allons maintenant lancer Solver: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/526/3f6/35c/5263f635cf3425abfe0f6ede918faf68.png"></div><br>  La cellule cible est la somme au bas de la colonne Dist to Closest.  Notez que contrairement à d'autres exemples, nous voulons ici utiliser le bouton radio «To: Min» car nous avons besoin d'une distance minimum entre tous les systèmes stellaires et les téléporteurs, pas un maximum. <br><br>  Ci-dessous, nous indiquerons huit cellules jaunes de solutions des coordonnées X et Y des «trous de ver» A, B, C et D comme «En changeant les cellules variables». Dans la section des restrictions, nous limiterons chacune des coordonnées comme une valeur entière dans la plage de 0 à 12. Notez que nous utilisons une contrainte entière pour ces cellules de solution, car nous voulons dire que le concepteur principal souhaite simplement savoir dans quelle cellule chaque téléport se trouvera, mais nous pouvons facilement ignorer cette restriction si le concepteur a besoin de coordonnées matérielles. <br><br>  Si nous demandons "Nombre de téléporteurs?"  valeurs 2, 3 et 4, et séquentiellement nous lancerons Solver à chaque valeur, nous obtiendrons les configurations suivantes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fb3/705/3d0/fb37053d0bb564a0ec27a7a45e4e8c32.png"></div><br>  Ayant ces informations, nous pouvons aller au concepteur principal et lui montrer les emplacements optimaux pour l'emplacement d'un nombre quelconque de téléporteurs dans la plage de 2 à 4. C'est ainsi que les emplacements optimaux des «trous de ver» pour les téléporteurs 2, 3 et 4 apparaissent sur la carte (indiquée en vert). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ca/08d/551/6ca08d5517b7f57754deab8408117e19.png"></div><br>  La feuille de calcul de cet exemple peut être téléchargée à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partir d'ici</a> . <br><br><h2>  Ai-je parlé du ninja? </h2><br>  "Incroyable", dit le concepteur principal, mais vous voyez la souffrance sur son visage.  «Euh, mais j'ai oublié de vous dire que certains de ces systèmes sont habités par des ninjas de l'espace.  Et nous voulons que les systèmes avec le ninja soient plus éloignés des "trous de ver" afin que les joueurs ne se sentent pas trop menacés. " <br><br>  «Wow.  Cela change complètement le cas. " <br><br>  "D'accord.  De plus, dans certains systèmes stellaires, il n'y a pas une mais deux colonies, c'est-à-dire qu'elles sont deux fois plus importantes que la proximité des téléporteurs.  Ou il est deux fois plus important d'être plus loin s'il s'agit d'un système avec deux colonies de ninjas spatiaux.  Voici à quoi ressemble la carte maintenant: " <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ab/b1c/2de/1abb1c2dea24fc72efbf45d034cb2fdb.png"></div><br>  Il poursuit: «Chaque nombre négatif est une colonie de ninjas spatiaux.  Le système avec le numéro 2 contient deux colonies humaines et avec le nombre -2, il contient deux colonies de ninja.  Pouvez-vous me dire où placer les téléporteurs dans ce cas? » <br><br>  "Dites-moi, au moins vous avez déjà décidé combien de téléports il y aura: 2, 3 ou 4?", Demandez-vous avec ironie. <br><br>  "Je n'ai pas encore peur." <br><br><h2>  Nous résolvons en tenant compte du ninja </h2><br>  Pour résoudre ce problème, nous devons ajouter une nouvelle colonne au tableau qui indique le poids du tableau.  Nous l'appellerons le «multiplicateur».  Nous multiplierons simplement cette valeur par la valeur dans la colonne Dist to Closest. <br><br>  Lorsque nous faisons cela, Dist to Closest change légèrement sa signification.  Maintenant, ce n'est pas la distance au système stellaire le plus proche, car pour les systèmes stellaires ninja, la valeur change de -1 fois.  Cela ressemble à des «points» plus généralisés (score), appelons-les ainsi. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/667/7e8/edd/6677e8edddd9fa2ac4fecf1ae499f069.png"></div><br>  Ainsi, les points indiquent désormais la valeur cumulée.  En le minimisant, nous faisons en sorte que Solver s'efforce d'être le plus près possible des systèmes avec des colonies humaines et en même temps aussi loin que possible des systèmes ninja peuplés. <br><br>  Nous obtenons maintenant les résultats suivants: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/910/372/a85/910372a8558cafb6e62a3b9298c230fc.png"></div><br>  Comme vous pouvez le voir, cela nous donne la configuration des téléporteurs, dans chaque cas très différent des versions plus simples sans ninja. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/92a/1a4/727/92a1a4727400d6279a03988381e75f5b.png"></div><br>  La feuille de calcul de cette version étendue de l'exemple de téléportation peut être téléchargée <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Comme vous pouvez le voir, notre modèle de solution a pu résoudre très rapidement cette tâche non triviale, et nous pouvons l'adapter à l'évolution des besoins. <br><br>  Cette tâche appartient à la classe des tâches dites «tâches d'allocation d'objets», très bien étudiées dans le domaine de la gestion opérationnelle.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mais comme vous pouvez le voir, ils peuvent potentiellement être utilisés dans la conception de jeux, ainsi que dans la conception de niveaux, et la solution est simple (sinon triviale) dans Excel. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Équilibrage des classes pour les combats Joueur contre Joueur </font></font></h2><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La feuille de calcul de cette partie peut être téléchargée à partir d'ici: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lien</font></font></a></i> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Feuilles de calcul et simulations </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans les trois parties précédentes de cette série d'articles, nous nous sommes présentés au concept de modélisation et d'optimisation des solutions, ainsi qu'à l'outil «Solveur» du package Excel. Nous avons montré comment ils peuvent être utilisés pour calculer les taux d'imposition optimaux de la ville dans la stratégie 4X, pour déterminer le placement optimal des téléporteurs dans le jeu spatial et pour sélectionner la disposition optimale des armes pour la tâche de super-char décrite dans la première partie. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une question naturelle se pose: qu'en est-il de l'équilibre du jeu? Est-il possible d'appliquer des techniques similaires à toutes sortes de tâches d'équilibrage complexes que l'on retrouve dans de nombreux types de jeux différents, en particulier dans les stratégies, les RPG et les MMORPG?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La réponse à cette question est oui, bien sûr, mais avec de nombreuses réserves. Les feuilles de calcul en particulier ont de nombreuses limites, car dans la plupart des cas non triviaux, elles ne décrivent pas le jeu avec précision. Par conséquent, il nous sera difficile d'effectuer un équilibrage fiable à l'aide de techniques d'optimisation; les tâches d'équilibrage réelles de la grande majorité des jeux seront bien au-delà de ce que nous pouvons modéliser dans un tableur. La simulation du jeu lui-même est généralement trop compliquée, comporte beaucoup de "pièces mobiles" et est souvent effectuée en temps réel, lorsque l'on essaie de faire des simulations discrètes, on peut rencontrer toutes sortes de problèmes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par conséquent, si nous voulions utiliser des techniques similaires pour équilibrer les classes dans les MMORPG tels que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WildStar</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou dans les jeux stratégiques comme</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Annihilation planétaire</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alors pour assurer au moins une certaine précision et utilité, il faudrait les intégrer dans la simulation du jeu lui-même.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, la vérité est que certains aspects de l'équilibrage ne peuvent pas être automatisés; comme nous l'avons expliqué dans la</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> première partie de l'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> article, il est impossible d'ajuster automatiquement l'expérience de jeu.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par conséquent, le mieux que nous puissions espérer est une démonstration d'un exemple simple illustrant une approche générale des tâches de ce type: avec un exemple simple dans Excel, nous apprendrons comment aborder la formulation de ce type de problèmes d'équilibrage et les optimiser. </font><font style="vertical-align: inherit;">Nous montrerons que, au moins pour un exemple de bataille simple, Solver peut bien équilibrer plusieurs classes RPG les unes par rapport aux autres. </font><font style="vertical-align: inherit;">Ensuite, vous pouvez utiliser cette structure de base comme base pour résoudre de tels problèmes d'optimisation avec un schéma plus complexe et plus profondément intégré dans la simulation du jeu. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous espérons qu'avec nous, vous apprendrez toutes les astuces et verrez ce que cet exemple simple peut nous donner.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Déséquilibré </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'y a pas de définition unique et généralement acceptée du mot «équilibrage». Cela a de nombreuses significations et la vérité dépend généralement du contexte du jeu en question. Dans différentes conditions, l'équilibrage peut être lié à la mise en place de plusieurs classes de personnages afin d'égaler leurs capacités dans un jeu de rôle, au nombre de forces des adversaires se battant les uns contre les autres dans un jeu stratégique, ou à l'ajustement du coût de diverses unités ou ressources en fonction de leur utilité. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La meilleure définition de «l'équilibrage» dépend généralement des objectifs de conception du jeu en question, mais comme ces objectifs peuvent être quelconques, il est impossible de </font><font style="vertical-align: inherit;">déterminer a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">priori</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ce que l'équilibrage signifie réellement pour les jeux en général.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Certains joueurs ont tendance à croire que l'équilibrage au combat signifie des dégâts égaux. </font><font style="vertical-align: inherit;">Cela est particulièrement vrai pour les MMORPG, dans lesquels les joueurs se plaignent souvent que les dégâts par seconde (DPS) d'une classe sont trop faibles ou trop importants par rapport aux autres. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bien sûr, les classes ne peuvent pas être équilibrées uniquement par DPS; </font><font style="vertical-align: inherit;">il est acceptable qu'une classe ait un DPS plus grand qu'une autre, mais cela devrait être compensé par d'autres facteurs limitant l'utilité globale de la classe, par exemple, une survie réduite ou un DPS à moins long terme par rapport au DPS à court terme.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tiny MMO </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imaginez que nous créons un nouveau projet, un jeu de rôle en ligne massivement multijoueur très simplifié appelé "Tiny MMO". </font><font style="vertical-align: inherit;">Dans le cadre du développement de la conception, nous nous efforçons d'équilibrer les quatre classes pour les combats de joueur à joueur (PVP) afin que les quatre classes soient relativement égales au combat les unes contre les autres, et qu'il n'y ait pas de classe claire «meilleure» ou «pire» qui Vous pouvez vous battre contre d'autres classes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bien que Tiny MMO soit un jeu en temps réel, l'action de chaque joueur dure exactement 3 secondes, nous pouvons donc le discrétiser en le présentant comme un jeu au tour par tour dans lequel chaque mouvement représente une part de gameplay de trois secondes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les joueurs de ce jeu peuvent choisir l'une des quatre classes de personnages:</font></font><br><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le guerrier</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fait le plus de dégâts.</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le mage</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lance des sorts à distance et a la plus longue portée d'attaque des quatre classes</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Guérisseur (Guérisseur) est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> traité automatiquement, rétablissant à chaque tour une certaine partie de sa santé</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Barbare (Barbare)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a le plus de santé</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est tout ce que nous savons sur ces quatre classes, et nous devons définir les paramètres initiaux de santé (HP), de dégâts, de soins et de portée des attaques pour les quatre classes. </font><font style="vertical-align: inherit;">Nous devons les équilibrer de manière à ce que chaque classe soit unique et ses caractéristiques soient sensiblement différentes de toutes les autres classes, mais de sorte que chaque classe se révèle être aussi «équilibrée» que possible par rapport aux trois autres. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En d'autres termes, nous nous efforçons d'optimiser le tableau suivant:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2a5/bb2/b9a/2a5bb2b9a8a5b91eed643b89f168cd5f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alors que nous utilisons des valeurs temporaires et supposons que chaque classe commence avec 50 HP, inflige 10 dégâts par tour, soigne 0 HP par tour et a une portée d'attaque de 40 mètres. Chaque personnage se déplace à une vitesse de 10 mètres par tour. Étant donné que la conception indique que les quatre classes de caractères peuvent se déplacer à la même vitesse, nous considérerons cette valeur constante et nous n'entrerons pas la vitesse de déplacement dans le tableau des variables de décision.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Évidemment, il s'agit d'une étude de cas avec un modèle de dommage très simplifié. Il s'agit d'une valeur moyenne continue de dégâts par seconde, qui ignore la différence entre les dégâts impulsifs et les dégâts à long terme, ainsi que le mana et d'autres mécanismes qui modifient les capacités d'attaque des classes. Nous n'aurons qu'un seul type de dégâts, ce qui est assez irréaliste, car la plupart des classes ont des dizaines de types de dégâts, et nous devrons implémenter un système d'IA qui sélectionne l'attaque à chaque tour. De plus, dans la plupart des jeux, les dégâts ont un élément aléatoire, mais pour l'instant nous allons l'omettre et supposer que la variabilité des dégâts n'est pas si grande qu'elle affecte de manière significative le résultat de la bataille entre les deux classes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bien sûr, tout équilibrage effectué dans Excel est peu susceptible d'être idéal ou cohérent avec l'équilibre final du jeu; </font><font style="vertical-align: inherit;">elle devra passer par de nombreuses itérations de playtesting. </font><font style="vertical-align: inherit;">Mais si nous prenons une ou deux heures pour obtenir une </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bonne</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> première option pour notre jeu dans Excel, alors au moins nous sommes beaucoup plus susceptibles de nous rapprocher des paramètres qualitatifs du solde initial, ce qui nous rapprochera du solde final que nous voulons obtenir.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Table de victoire </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous devons équilibrer quatre classes les unes avec les autres dans une bataille individuelle. </font><font style="vertical-align: inherit;">Comme nous n'avons que 4 classes (Guerrier, Mage, Guérisseur et Barbare), il existe 6 combinaisons possibles de classes différentes:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Guerrier - Mage </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Guerrier - Guérisseur </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Guerrier - Barbare </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mage - Guérisseur </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mage - Barbare </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Guérisseur - Barbare </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cet équilibrage peut être assez compliqué. </font><font style="vertical-align: inherit;">Même dans notre cas assez simple avec quatre classes, nous avons obtenu six relations interclasses, tout comme nous pouvons tracer six lignes entre quatre points d'un carré.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52f/bc5/6e2/52fbc56e2c50d662a5236a089c8c9fdc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque fois que nous voulons apporter un petit changement à l'un des paramètres de l'une des classes, ce changement affectera également l'équilibre PvP entre cette paire de classes et les </font><font style="vertical-align: inherit;">deux </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">autres</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classes. </font><font style="vertical-align: inherit;">Cette interconnexion de loi de puissance ne fera que croître avec une augmentation du nombre de classes, et les décisions d'équilibrer le PvP entre n'importe quelle paire de classes prises "dans le vide", sans prendre en compte toutes les autres interactions, peuvent devenir très dangereuses. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Idéalement, nous aimerions créer une sorte de </font><i><font style="vertical-align: inherit;">table</font></i><font style="vertical-align: inherit;"> de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">victoire</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comme celui illustré ci-dessous. </font><font style="vertical-align: inherit;">Si nous pouvons simuler une bataille entre chacune de ces 6 paires dans un tableur, alors nous serons en mesure de générer une certaine variable «points» pour chacune des 6 paires. </font><font style="vertical-align: inherit;">Plus il y a de points, mieux c'est, donc nous pouvons combiner ces six points pour générer une fonction objectif.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b2f/b4f/6e8/b2fb4f6e8317a42dfc6696d1c41ade97.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notez que dans le tableau ci-dessus, les cellules le long des diagonales sont nulles, car elles désignent des paires de la même classe qui seront équilibrées par définition. </font><font style="vertical-align: inherit;">De plus, les cellules dans le coin supérieur droit sont également nulles, car elles désignent exactement les mêmes paires que dans les cellules en bas à gauche. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Préparons maintenant le modèle pour la bataille entre deux classes différentes.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "Simulateur de bataille" </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous organiserons chaque paire de cours à une distance de 100 mètres les uns des autres. </font><font style="vertical-align: inherit;">Chaque personnage a 3 secondes pour attaquer, nous pouvons donc imaginer cela comme une simulation au tour par tour dans laquelle chaque «mouvement» signifie 3 secondes. </font><font style="vertical-align: inherit;">À chaque «coup», chaque personnage attaque l'autre, s'il est à portée de l'attaque, ou continue de se déplacer pour réduire la distance. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La simulation ressemble à ceci:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3b1/7ce/236/3b17ce2366faaece720a363f57c261d9.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ci-dessus, une paire de personnages qui sont entrés dans la bataille: dans ce cas, Mage (classe 1) et Healer (classe 2). </font><font style="vertical-align: inherit;">La colonne de gauche indique la distance actuelle entre les deux caractères simulés. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour chaque caractère, les colonnes seront:</font></font><br><br><ul><li> <b>Max Range</b> :   ,     .           . </li><li> <b>Healing</b> :      ,      . </li><li> <b>HP</b> :      .      HP    ,        .         ,         . </li><li> <b>Damage</b> :  ,   ,       .   ,     0. </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des attaques? </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Cette colonne vérifie si le personnage est dans la zone d'attaque. </font><font style="vertical-align: inherit;">Si c'est le cas, cela signifie que le personnage attaque dans le tour en cours; </font><font style="vertical-align: inherit;">sinon, le personnage se rapproche pour atteindre un autre personnage.</font></font></li></ul><br>  Ainsi, les deux personnages commencent à se rapprocher, puis attaquent jusqu'à ce que l'un d'eux ou les deux meurent.  Chaque personnage se déplace toutes les 3 secondes sur 5 mètres (5 mètres par "tour").  Lorsque les deux personnages se rapprochent, la portée change à chaque tour de 10 unités, et de 5 unités si un seul d'entre eux se déplace.  Le jeu lui-même est structuré de sorte que les deux personnages puissent commencer à se déplacer simultanément, après quoi le mouvement est autorisé en même temps, il est donc possible que les deux personnages puissent mourir en même temps. <br><br>  Ensuite, nous devons configurer la notation de ce tableau et générer une valeur numérique indiquant la «bonne» bataille.  en d'autres termes, dans quelle mesure sommes-nous proches d'atteindre nos objectifs de conception. <br><br>  De toute évidence, nous voulons que les deux personnages soient morts à la fin de la bataille, ou au moins aussi près de la mort que possible.  Si la bataille est équilibrée, les deux classes de combat devraient minimiser la santé de l'ennemi à la fin de la bataille. <br><br>  Cependant, cela ne suffit pas.  Si nous organisons le score de cette manière, l'optimiseur maximisera simplement les valeurs des dégâts afin que les deux personnages s'entretuent instantanément!  (Si vous êtes curieux, essayez de changer la feuille de calcul jointe à l'article pour voir par vous-même.)  Évidemment, nous ne visons pas la mort instantanée: nous avons besoin que les deux personnages soient morts ou presque morts à la fin de la bataille, mais <i>en même temps,</i> nous voulons que le combat dure un temps raisonnable. <br><br>  En d'autres termes, nous nous efforçons non seulement d'assurer un équilibre relativement égal de toutes les classes les unes contre les autres;  nous voulons également rendre l'équilibre <i>intéressant</i> , y compris les combats qui durent un temps approprié. <br><br>  Pour générer une telle estimation de solde, nous devons créer plusieurs cellules à droite de chaque tableau.  <i>La durée</i> indique la durée de la bataille;  elle compte le nombre de lignes du tableau dans lesquelles les <i>deux</i> personnages sont toujours en vie.  <i>Total HP</i> calcule le total des points de vie des deux personnages survivants.  Idéalement, il devrait être égal à 0, c'est-à-dire qu'au moment où la bataille se termine, les deux personnages sont en train de mourir. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/957/514/77c/95751477c6324ce2fc26e41c6979122a.png"></div><br>  Et enfin, Score combine la durée et le nombre total de points de vie sous la forme (Durée / (1 + HP total)).  Notez que nous avons ajouté 1 au diviseur, car Total HP pourrait être égal à 0, et dans ce cas, nous obtiendrions une division par erreur zéro.  De cette façon, nous pouvons garantir que nous récompensons l'optimiseur pour avoir trouvé la durée maximale de la bataille <i>et la</i> valeur minimale de la somme des points de vie. <br><br>  (Notez que puisque nous avons 17 lignes dans chaque «simulation» de combat de classe à classe. Cela signifie que nous avons essentiellement pris une décision de conception selon laquelle le combat devrait durer environ 17 rounds. Si nous voulons que le combat soit plus court ou plus longtemps, vous pouvez modifier le nombre de lignes, modifier la formule de calcul du score et effectuer une seconde optimisation en conséquence.) <br><br>  Enfin, nous prenons ces six valeurs de score (une pour chaque table) et les utilisons dans le tableau de victoire ci-dessus pour montrer les résultats de la bataille entre chaque paire de classes. <br><br>  Vous pouvez simplement résumer ces six valeurs de score et utiliser le résultat comme valeur de score finale.  Cependant, si nous le faisons, Solver ne sera probablement pas en mesure de trouver un bon équilibre entre les notes les plus élevées et les plus basses pour les combats individuels, et recevra également des notes très élevées pour certaines paires de classes et des notes faibles pour d'autres.  Ce n'est pas ce que nous voulons: nous avons besoin que <i>toutes les</i> notes soient élevées et nous nous efforçons de toutes les élever.  Pour résoudre ce problème, nous multiplions la somme des notes par la note la <i>plus basse</i> du groupe (en utilisant la fonction Excel MIN ()) pour que Solver se concentre sur la note la <i>plus basse</i> . <br><br><h2>  Ajouter des restrictions </h2><br>  Nous n'avons pas encore fini.  Si vous optimisez un modèle de solution avec les paramètres actuels, il est fort probable que les classes ne seront pas configurées correctement - en fait, il est fort probable que le modèle écrira les mêmes valeurs HP, Damage, Healing et Range dans le tableau des variables de décision. <br><br>  Et nous voulons bien sûr que chaque classe ait sa propre personnalité.  Nous avons besoin du guerrier pour faire le plus de dégâts, le mage a la plus grande portée, le guérisseur a la valeur de guérison maximale et le barbare a les HP les plus élevés.  Nous voulons également que ces différences ne soient pas trop petites - nous avons besoin que ces classes soient très différentes les unes des autres. <br><br>  Pour ce faire, nous allons créer un petit tableau de restrictions.  Ce tableau garantit que chacune des quatre classes aura un attribut correspondant, puis donnera un score de 0 ou 1, selon que la condition de contrainte est satisfaite. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/91a/a33/010/91aa330102f6855b19ddc62b21e4b1a3.png"></div><br>  Le tableau Différence minimale à droite montre la différence minimale de chaque attribut de la classe par rapport à toutes les autres classes.  En d'autres termes, le guerrier doit avoir au moins 4 HP plus de dégâts que toutes les autres classes, le mage doit avoir une portée d'attaque d'au moins 10 de plus, et ainsi de suite. <br><br>  Maintenant que nous avons ajouté ces restrictions spéciales, il est temps d'optimiser! <br><br><h2>  Recherche de solutions </h2><br>  Nous pouvons maintenant exécuter l'outil Solver («Finding Solutions») intégré à Excel pour essayer d'optimiser les paramètres initiaux.  En tant que cellule cible, nous sélectionnerons la cellule Score, qui combine les résultats des six tournois.  Nous avons défini les variables de décision pour inclure les 16 cellules dans le tableau jaune des variables de décision que nous avons créé au début. <br><br>  Nous définissons également les contraintes (dans le champ Sujet aux contraintes) comme suit: <br><br><ul><li>  Toutes les cellules de décision doivent être entières avec une valeur minimale de 0. </li><li>  Toutes les cellules de la colonne HP doivent avoir une valeur maximale de 200 et un minimum de 30. </li><li>  Toutes les cellules de la colonne Dommages ont une valeur maximale de 20. </li><li>  Toutes les cellules de la colonne Guérison ont une valeur maximale de 15. </li><li>  Toutes les cellules de la colonne Plage ont une valeur maximale de 100. </li><li>  De plus, les quatre cellules de la section Contraintes spéciales doivent être définies sur 1 pour satisfaire leurs conditions spéciales. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fc0/cae/d5a/fc0caed5a1d370e16c71d9b2f3ef7933.png"></div><br>  Enfin, définissez la méthode de résolution sur Evolutionary et exécutez Solver.  Veuillez noter que puisqu'il s'agit d'un algorithme évolutif, il est possible d'améliorer la solution trouvée lors de la deuxième ou troisième exécution du solveur, ou après avoir défini des paramètres (bouton Options) pour une optimisation évolutive. <br><br>  En conséquence, nous devrions obtenir quelque chose de similaire: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ad/d71/2c6/0add712c65d58c0182fd01b362787d1c.png"></div><br>  ... et comme par magie, Solver nous a donné une bonne configuration d'équilibre initial. <br><br>  Comme vous pouvez le voir, le Guerrier fait maintenant le plus de dégâts, le Mage a la plus grande portée, le Guérisseur guérit le mieux et le Barbare a le plus de PV.  De plus, vous pouvez descendre dans les résultats des tournois individuels «classe contre classe» et voir comment les classes se sont montrées au combat;  comme vous pouvez le voir, la plupart d'entre eux sont équilibrés de manière très égale - à la fin de la bataille, les deux classes sont en train de mourir, ou l'une d'elles survit à peine.  De plus, tous les tournois durent assez longtemps, aucune des classes ne peut «filer» l'autre. <br><br>  Pas mal pour quelques heures de travail, non? <br><br><h2>  Conclusion </h2><br>  Dans cet exemple, nous avons créé une tâche d'équilibrage simple et démontré qu'en fait, nous pouvons la résoudre à l'aide de la simulation et de l'optimisation.  Bien qu'il soit évident qu'il s'agit d'un exemple simple, il nous montre la puissance des techniques de modélisation et de l'optimisation des décisions.  De plus, il peut devenir une source d'inspiration utilisable dans des outils d'équilibrage plus complexes, étroitement intégrés à la simulation du jeu.  Nous espérons que vous pourrez utiliser cet exemple comme guide pour formuler de telles tâches dans la pratique. <br><br>  Dans les deux prochaines parties de la série, nous allons plonger dans le domaine des tâches d'affectation, qui est associé à la sélection d'affectations optimales à partir de deux ou plusieurs ensembles d'entités.  Nous allons montrer comment résoudre ces types de problèmes et montrer comment nous avons utilisé cette approche pour créer la conception de tours dans notre jeu de stratégie pour iOS / Android <i>City Conquest</i> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr430114/">https://habr.com/ru/post/fr430114/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr430102/index.html">ENOG 15: «Pourquoi Internet est-il toujours en ligne?»</a></li>
<li><a href="../fr430104/index.html">Données médicales | Ne pas délivrer de carte médicale entre vos mains</a></li>
<li><a href="../fr430106/index.html">Nouveau à XYZprinting à IMTS 2018: imprimantes 3D et robots</a></li>
<li><a href="../fr430108/index.html">Pourquoi le "jeune technicien" ne pourra pas construire un laser</a></li>
<li><a href="../fr430112/index.html">Comment nous avons appris à une voiture à parler avec des millions de personnes</a></li>
<li><a href="../fr430116/index.html">Les ordinateurs écrivent de la prose, mais restent inférieurs aux gens. Pourquoi?</a></li>
<li><a href="../fr430118/index.html">Unity3D: Modifier le délégué d'application iOS</a></li>
<li><a href="../fr430120/index.html">Apprivoisez la bête. Ce à quoi nous avons été confrontés lors du développement d'une application d'agenda personnel sur React Native</a></li>
<li><a href="../fr430122/index.html">Le workaholism est une condition douloureuse dont il n'est pas habituel de parler.</a></li>
<li><a href="../fr430126/index.html">Une autre liste de projets à pratiquer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>