<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë¢ üê¨ üìó Kami sedang menulis penerjemah sederhana dalam Lisp - II üëá üßú üñáÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel sebelumnya 

 Kami menerapkan operator penugasan 
 Sekarang mari kita ajarkan penerjemah bagaimana menangani operator penugasan. Dan di sini k...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kami sedang menulis penerjemah sederhana dalam Lisp - II</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421445/">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel sebelumnya</a> <br><br><h3>  Kami menerapkan operator penugasan </h3><br>  Sekarang mari kita ajarkan penerjemah bagaimana menangani operator penugasan.  Dan di sini kita dihadapkan dengan tugas klasik untuk memastikan perhitungan formula aljabar yang diberikan dalam notasi yang telah kita kenal sejak kita sekolah dulu.  Jika kita membuat juru bahasa, maka kita perlu menghitung nilai formula.  Dalam kasus kami, kernel Lisp akan menghitung (pada saat run time).  Dan kita hanya perlu mengubah formula dari notasi biasa menjadi Lisp. <br>  Notasi yang kita kenal disebut "notasi infiks" (tanda operasi terletak di antara operan).  Dalam Lisp, tanda operasi ditempatkan sebelum operan (notasi seperti itu disebut "notasi awalan").  Dengan demikian, tugas kami adalah mengubah bentuk infiks ke bentuk awalan. <br><br>  Anda dapat menyelesaikan masalah ini dengan berbagai cara ... <br><a name="habracut"></a><br>  Saya sarankan untuk mengubah formula menjadi apa yang disebut  "Membalikkan bentuk Polandia" (SCF).  Notasi Polandia terbalik (dinamai setelah ahli matematika Polandia Lukashevich) adalah bentuk notasi non-blocking di mana tanda-tanda operasi terletak setelah operan ("notasi postfix").  Terjemahan dari bentuk postfix ke bentuk prefix cukup sederhana.  Orang dapat "memecahkan masalah dalam satu tindakan" - segera menerapkan konversi dari infiks ke awalan.  Tetapi keputusan ini akan sedikit lebih rumit.  Namun, mereka yang berharap dapat mencoba melakukannya sendiri. <br><br>  Dan kami akan terlibat dalam transformasi formula di SCR.  Pada input, kami memiliki rumus aljabar dalam notasi infiks, disajikan dalam bentuk daftar multi-level Lisp.  Misalnya, ini: <br><br> <code>(12 + x / ( y ^ 2 + z ^ 4))</code> <br> <br>  Dalam SCR, ungkapan ini akan memiliki bentuk (sekilas - aneh) berikut: <br><br> <code>(12 xy 2 ^ z 4 ^ + / +)</code> <br> <br>  Untuk menghitung nilai rumus dalam bentuk SCR, Anda memerlukan tumpukan (struktur data yang menyimpan dan mengirimkan data pada prinsip "last come - first go").  Perhitungannya sangat sederhana.  Daftar dibaca sekali.  Dan untuk setiap elemen, tindakan berikut dilakukan: <br><br><ul><li>  Jumlah (nilai variabel) hanya didorong ke tumpukan; </li><li>  Operasi dilakukan pada jumlah operan yang sesuai dari atas tumpukan. </li></ul><br>  Harap dicatat bahwa tidak ada tanda kurung di SCF, dan operasi dilakukan sesuai urutan tertulis (prioritas, seperti dalam bentuk infix, tidak ada lagi di sini). <br><br>  Ekspresi yang ingin kami terjemahkan ke dalam SCR dapat berisi angka, variabel, fungsi, dan tanda operasi.  Ada masalah - bagaimana membedakan suatu variabel dari suatu fungsi?  Cara alami untuk menyelesaikan masalah ini adalah dengan membuat daftar semua operasi dan fungsi dan memeriksa karakter yang diperlukan dalam daftar ini: jika karakter ditemukan dalam daftar, maka ini adalah operasi, jika tidak itu adalah variabel. <br>  Selain itu, untuk setiap fungsi / operasi, Anda perlu menyimpan <b>aritynya</b> (jumlah argumen).  Daftar operasi dasar mungkin terlihat seperti ini: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">setq</span></span> *oplist* '((+ <span class="hljs-number"><span class="hljs-number">2</span></span>) (- <span class="hljs-number"><span class="hljs-number">2</span></span>) (* <span class="hljs-number"><span class="hljs-number">2</span></span>) (/ <span class="hljs-number"><span class="hljs-number">2</span></span>) (^ <span class="hljs-number"><span class="hljs-number">2</span></span>) (\ <span class="hljs-number"><span class="hljs-number">2</span></span>) (% <span class="hljs-number"><span class="hljs-number">2</span></span>) (= <span class="hljs-number"><span class="hljs-number">2</span></span>) (== <span class="hljs-number"><span class="hljs-number">2</span></span>) (/= <span class="hljs-number"><span class="hljs-number">2</span></span>) (&gt; <span class="hljs-number"><span class="hljs-number">2</span></span>) (&gt;= <span class="hljs-number"><span class="hljs-number">2</span></span>) (&lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) (&lt;= <span class="hljs-number"><span class="hljs-number">2</span></span>) (and <span class="hljs-number"><span class="hljs-number">2</span></span>) (or <span class="hljs-number"><span class="hljs-number">2</span></span>) (not <span class="hljs-number"><span class="hljs-number">1</span></span>) (sin <span class="hljs-number"><span class="hljs-number">1</span></span>) (cos <span class="hljs-number"><span class="hljs-number">1</span></span>) (abs <span class="hljs-number"><span class="hljs-number">1</span></span>) (exp <span class="hljs-number"><span class="hljs-number">1</span></span>) (log <span class="hljs-number"><span class="hljs-number">1</span></span>) (sqrt <span class="hljs-number"><span class="hljs-number">1</span></span>)))</code> </pre><br>  Perlu dicatat bahwa dalam proses penerjemah daftar ini dapat meningkat.  Faktanya adalah bahwa fungsi mini-basic mengembalikan nilai dan dapat berpartisipasi dalam ekspresi.  Nama-nama fungsi ini dan aritynya harus ditambahkan ke daftar * oplist *.  Ini dapat dilakukan dalam prosedur tindakan-proc di cabang yang memproses pernyataan proc.  Variabel * oplist * dapat dibuat di prosedur awal (dan dihancurkan sebelum selesai).  Dan menambahkan fungsi dalam kode tindakan-proc dapat diimplementasikan seperti ini: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-name">eq</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> stmt) 'proc) (<span class="hljs-name"><span class="hljs-name">setq</span></span> proc-name (<span class="hljs-name"><span class="hljs-name">nth</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> stmt)) (<span class="hljs-name"><span class="hljs-name">setq</span></span> proc-parm (<span class="hljs-name"><span class="hljs-name">nth</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> stmt)) (<span class="hljs-name"><span class="hljs-name">setq</span></span> *oplist* (<span class="hljs-name"><span class="hljs-name">cons</span></span> (<span class="hljs-name"><span class="hljs-name">list</span></span> proc-name (<span class="hljs-name"><span class="hljs-name">length</span></span> proc-parm)) *oplist*)))</code> </pre><br>  Sekarang perlu untuk setiap operasi yang terjadi dalam fungsi untuk menetapkan prioritas tertentu.  Prioritas ditetapkan oleh fungsi berikut: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">defun</span></span> prty (<span class="hljs-name"><span class="hljs-name">OP</span></span>) (<span class="hljs-name"><span class="hljs-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP 'and) <span class="hljs-number"><span class="hljs-number">1</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP 'or) <span class="hljs-number"><span class="hljs-number">1</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '&gt;) <span class="hljs-number"><span class="hljs-number">2</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '&gt;=) <span class="hljs-number"><span class="hljs-number">2</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '&lt;) <span class="hljs-number"><span class="hljs-number">2</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '&lt;=) <span class="hljs-number"><span class="hljs-number">2</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '=) <span class="hljs-number"><span class="hljs-number">2</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '==) <span class="hljs-number"><span class="hljs-number">2</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '/=) <span class="hljs-number"><span class="hljs-number">2</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '+) <span class="hljs-number"><span class="hljs-number">3</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '-) <span class="hljs-number"><span class="hljs-number">3</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '*) <span class="hljs-number"><span class="hljs-number">4</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '/) <span class="hljs-number"><span class="hljs-number">4</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '\) <span class="hljs-number"><span class="hljs-number">4</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '%) <span class="hljs-number"><span class="hljs-number">4</span></span>) ((<span class="hljs-name"><span class="hljs-name">EQ</span></span> OP '^) <span class="hljs-number"><span class="hljs-number">5</span></span>) ((<span class="hljs-name"><span class="hljs-name">member</span></span> op (<span class="hljs-name"><span class="hljs-name">mapcar</span></span> 'car *oplist*)) <span class="hljs-number"><span class="hljs-number">6</span></span>)))</code> </pre><br>  Prioritas terendah diberikan untuk operasi logis "dan" dan "atau".  Lalu ada operasi perbandingan, lalu penjumlahan dan pengurangan, dll.  Fungsi memiliki prioritas tertinggi. <br><br>  Sekarang kami menggambarkan algoritma untuk menerjemahkan ekspresi dalam SCR.  Fungsi inf2ipn menerima satu parameter yang diperlukan (formula input) dan dua opsional (tumpukan operasi dan daftar akumulator).  Dalam daftar baterai, hasilnya diakumulasikan.  Fungsi memindai daftar input dan bertindak sebagai berikut: <br><br><ul><li>  Jika elemen selanjutnya adalah angka atau variabel, maka dimasukkan ke dalam baterai. </li><li>  Jika elemen berikutnya adalah daftar, maka fungsinya diterapkan ke daftar ini secara rekursif, dan hasilnya ditambahkan ke baterai. </li><li>  Jika elemen berikutnya adalah operasi, maka dengan tumpukan operasi kosong, elemen berikutnya didorong ke tumpukan operasi.  Dengan tumpukan operasi yang tidak kosong, prioritas operasi yang masuk dibandingkan dengan bagian atas tumpukan operasi.  Jika operasi dengan prioritas lebih tinggi tiba, maka ia didorong ke tumpukan operasi. </li><li>  Jika operasi dengan prioritas tidak lebih besar dari bagian atas tumpukan tiba, maka bagian atas tumpukan operasi dipindahkan ke akumulator, dan operasi yang baru tiba dimasukkan ke dalam tumpukan operasi. </li><li>  Jika daftar input habis dan tumpukan operasi kosong, maka fungsi mengembalikan baterai terbalik (cabang terminal).  Jika tidak, fungsi mengembalikan baterai terbalik dengan daftar operasi yang sebelumnya terpasang dari tumpukan. </li></ul><br>  Fungsi yang membedakan operasi dari operan sangat sederhana - ia turun untuk memeriksa apakah karakter yang diberikan ada dalam daftar * oplist * global: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">defun</span></span> is-op (<span class="hljs-name"><span class="hljs-name">o</span></span>) (<span class="hljs-name"><span class="hljs-name">member</span></span> o (<span class="hljs-name"><span class="hljs-name">mapcar</span></span> 'car *oplist*)))</code> </pre><br>  Dan fungsi transfer dalam SCR memiliki bentuk: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">defun</span></span> inf2ipn (<span class="hljs-name"><span class="hljs-name">f</span></span> <span class="hljs-symbol"><span class="hljs-symbol">&amp;optional</span></span> (<span class="hljs-name"><span class="hljs-name">s</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) (<span class="hljs-name"><span class="hljs-name">r</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)) (<span class="hljs-name"><span class="hljs-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-name">null</span></span> f) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">null</span></span> s) (<span class="hljs-name"><span class="hljs-name">reverse</span></span> r) (<span class="hljs-name"><span class="hljs-name">inf2ipn</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> (<span class="hljs-name"><span class="hljs-name">cdr</span></span> s) (<span class="hljs-name"><span class="hljs-name">cons</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> s) r)))) ((<span class="hljs-name"><span class="hljs-name">listp</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> f)) (<span class="hljs-name"><span class="hljs-name">inf2ipn</span></span> (<span class="hljs-name"><span class="hljs-name">cdr</span></span> f) s (<span class="hljs-name"><span class="hljs-name">append</span></span> (<span class="hljs-name"><span class="hljs-name">reverse</span></span> (<span class="hljs-name"><span class="hljs-name">inf2ipn</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> f))) r))) ((<span class="hljs-name"><span class="hljs-name">numberp</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> f)) (<span class="hljs-name"><span class="hljs-name">inf2ipn</span></span> (<span class="hljs-name"><span class="hljs-name">cdr</span></span> f) s (<span class="hljs-name"><span class="hljs-name">cons</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> f) r))) ((<span class="hljs-name"><span class="hljs-name">not</span></span> (<span class="hljs-name"><span class="hljs-name">is-op</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> f))) (<span class="hljs-name"><span class="hljs-name">inf2ipn</span></span> (<span class="hljs-name"><span class="hljs-name">cdr</span></span> f) s (<span class="hljs-name"><span class="hljs-name">cons</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> f) r))) (<span class="hljs-name"><span class="hljs-name">t</span></span> (<span class="hljs-name"><span class="hljs-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-name">null</span></span> s) (<span class="hljs-name"><span class="hljs-name">inf2ipn</span></span> (<span class="hljs-name"><span class="hljs-name">cdr</span></span> f) (<span class="hljs-name"><span class="hljs-name">cons</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> f) s) r)) ((<span class="hljs-name"><span class="hljs-name">&gt;</span></span> (<span class="hljs-name"><span class="hljs-name">prty</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> f)) (<span class="hljs-name"><span class="hljs-name">prty</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> s))) (<span class="hljs-name"><span class="hljs-name">inf2ipn</span></span> (<span class="hljs-name"><span class="hljs-name">cdr</span></span> f) (<span class="hljs-name"><span class="hljs-name">cons</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> f) s) r)) (<span class="hljs-name"><span class="hljs-name">t</span></span> (<span class="hljs-name"><span class="hljs-name">let</span></span> ((<span class="hljs-name"><span class="hljs-name">a</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> s))) (<span class="hljs-name"><span class="hljs-name">inf2ipn</span></span> (<span class="hljs-name"><span class="hljs-name">cdr</span></span> f) (<span class="hljs-name"><span class="hljs-name">cons</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> f) (<span class="hljs-name"><span class="hljs-name">cdr</span></span> s)) (<span class="hljs-name"><span class="hljs-name">cons</span></span> ar))))))))</code> </pre><br>  Anda dapat memverifikasi fungsionalitas fungsi ini dengan memanggilnya langsung: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">inf2ipn</span></span> '(<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">3</span></span> * 6)) ==&gt; (2 3 6 * +) (<span class="hljs-name"><span class="hljs-name">inf2ipn</span></span> '((<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">3</span></span>) * 6)) ==&gt; (2 3 + 6 *) (<span class="hljs-name"><span class="hljs-name">inf2ipn</span></span> '(<span class="hljs-number"><span class="hljs-number">3</span></span> + a * sin ( 5 + x))) ==&gt; (3 A 5 X + SIN * +)</code> </pre><br>  Mendapatkan entri awalan dari SCR cukup sederhana.  Fungsi ipn2inf menerima ekspresi di SCR dan parameter drive.  Fungsi kerjanya seperti ini: <br><br><ul><li>  Jika daftar input kosong, kepala drive dikembalikan; </li><li>  Jika elemen berikutnya adalah angka atau variabel, maka atom ini dilampirkan ke drive; </li><li>  Jika elemen berikutnya adalah operasi arity n, maka daftar yang terdiri dari simbol operasi ini dan segmen yang dibalik dari drive dengan panjang n ditambahkan ke drive tanpa elemen n pertama. </li></ul><br>  Begini tampilannya dalam kode: <br><br><pre> <code class="lisp hljs"><span class="hljs-comment"><span class="hljs-comment">;;    (defun arity (o) (iter (for a in *oplist*) (when (eq o (car a)) (return (cadr a))))) ;;      (defun ipn2pref (f &amp;optional (s nil)) (cond ((null f) (car s)) ((numberp (car f)) (ipn2pref (cdr f) (cons (car f) s))) ((is-op (car f)) (let ((ar (arity (car f)))) (ipn2pref (cdr f) (cons (cons (car f) (reverse (subseq s 0 ar))) (subseq s ar))))) (t (ipn2pref (cdr f) (cons (car f) s))))) ;; -,      (defun i2p (f) (ipn2pref (inf2ipn f)))</span></span></code> </pre><br>  Periksa kesehatan kode: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">i2p</span></span> '(<span class="hljs-number"><span class="hljs-number">3</span></span> + a * sin ( 5 + x))) ==&gt; (+ 3 (* A (SIN (+ <span class="hljs-number"><span class="hljs-number">5</span></span> X)))) (<span class="hljs-name"><span class="hljs-name">i2p</span></span> '((<span class="hljs-number"><span class="hljs-number">3</span></span> + a) * sin ( 5 ) + x)) ==&gt; (* (+ <span class="hljs-number"><span class="hljs-number">3</span></span> A) (+ (SIN <span class="hljs-number"><span class="hljs-number">5</span></span>) X)) (<span class="hljs-name"><span class="hljs-name">i2p</span></span> '((<span class="hljs-number"><span class="hljs-number">3</span></span> + a) * sin ( 5 ^ 2 - x ) + x)) ==&gt; (* (+ <span class="hljs-number"><span class="hljs-number">3</span></span> A) (+ (SIN (- (^ <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>) X)) X))</code> </pre><br>  Sekarang tinggal menulis handler dari operator penugasan dan menghubungkannya ke handler prosedur.  Penangan penugasan dapat diimplementasikan sebagai berikut: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">defun</span></span> action-set (<span class="hljs-name"><span class="hljs-name">meat</span></span>) (<span class="hljs-name"><span class="hljs-name">let</span></span> ((<span class="hljs-name"><span class="hljs-name">name-var</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> meat)) (<span class="hljs-name"><span class="hljs-name">r-value</span></span> (<span class="hljs-name"><span class="hljs-name">i2p</span></span> (<span class="hljs-name"><span class="hljs-name">cddr</span></span> meat)))) `(setq ,name-var ,r-value)))</code> </pre><br>  Parameter daging seharusnya merujuk pada tugas daftar: <br><br><pre> <code class="lisp hljs">( = )</code> </pre> <br>  Pengakuan operator penugasan dilakukan dalam fungsi action-proc, yang mengambil bentuk: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">defun</span></span> action-proc (<span class="hljs-name"><span class="hljs-name">fi</span></span>) (<span class="hljs-name"><span class="hljs-name">let</span></span> ((<span class="hljs-name"><span class="hljs-name">stmt</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) (<span class="hljs-name"><span class="hljs-name">proc-name</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) (<span class="hljs-name"><span class="hljs-name">proc-parm</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) (<span class="hljs-name"><span class="hljs-name">loc-var</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) (<span class="hljs-name"><span class="hljs-name">lv</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) (<span class="hljs-name"><span class="hljs-name">body</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)) (<span class="hljs-name"><span class="hljs-name">loop</span></span> (<span class="hljs-name"><span class="hljs-name">setq</span></span> stmt (<span class="hljs-name"><span class="hljs-name">mk-intf</span></span> (<span class="hljs-name"><span class="hljs-name">getLine</span></span> fi))) (<span class="hljs-name"><span class="hljs-name">when</span></span> (<span class="hljs-name"><span class="hljs-name">null</span></span> stmt) (<span class="hljs-name"><span class="hljs-name">return</span></span> <span class="hljs-literal"><span class="hljs-literal">t</span></span>)) (<span class="hljs-name"><span class="hljs-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-name">eq</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> stmt) 'proc) (<span class="hljs-name"><span class="hljs-name">setq</span></span> proc-name (<span class="hljs-name"><span class="hljs-name">nth</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> stmt)) (<span class="hljs-name"><span class="hljs-name">setq</span></span> proc-parm (<span class="hljs-name"><span class="hljs-name">nth</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> stmt))) ((<span class="hljs-name"><span class="hljs-name">eq</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> stmt) 'end_proc) (<span class="hljs-name"><span class="hljs-name">return</span></span> <span class="hljs-literal"><span class="hljs-literal">t</span></span>)) ((<span class="hljs-name"><span class="hljs-name">eq</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> stmt) 'print) (<span class="hljs-name"><span class="hljs-name">setq</span></span> body (<span class="hljs-name"><span class="hljs-name">append</span></span> body (<span class="hljs-name"><span class="hljs-name">list</span></span> (<span class="hljs-name"><span class="hljs-name">cons</span></span> 'printline (<span class="hljs-name"><span class="hljs-name">cdr</span></span> stmt)))))) ((<span class="hljs-name"><span class="hljs-name">eq</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> stmt) 'input) (<span class="hljs-name"><span class="hljs-name">setq</span></span> body (<span class="hljs-name"><span class="hljs-name">append</span></span> body (<span class="hljs-name"><span class="hljs-name">list</span></span> (<span class="hljs-name"><span class="hljs-name">list</span></span> 'setq (<span class="hljs-name"><span class="hljs-name">cadr</span></span> stmt) (<span class="hljs-name"><span class="hljs-name">list</span></span> 'read) ))))) ((<span class="hljs-name"><span class="hljs-name">eq</span></span> (<span class="hljs-name"><span class="hljs-name">car</span></span> stmt) 'local) (<span class="hljs-name"><span class="hljs-name">setq</span></span> loc-var (<span class="hljs-name"><span class="hljs-name">append</span></span> loc-var (<span class="hljs-name"><span class="hljs-name">cdr</span></span> stmt)))) ((<span class="hljs-name"><span class="hljs-name">eq</span></span> (<span class="hljs-name"><span class="hljs-name">cadr</span></span> stmt) '=) (<span class="hljs-name"><span class="hljs-name">setq</span></span> body (<span class="hljs-name"><span class="hljs-name">append</span></span> body (<span class="hljs-name"><span class="hljs-name">list</span></span> (<span class="hljs-name"><span class="hljs-name">action-set</span></span> stmt))))) (<span class="hljs-name"><span class="hljs-name">t</span></span> (<span class="hljs-name"><span class="hljs-name">printsline</span></span> (<span class="hljs-name"><span class="hljs-name">strCat</span></span> <span class="hljs-string"><span class="hljs-string">"****  "</span></span> (<span class="hljs-name"><span class="hljs-name">output</span></span> stmt) <span class="hljs-string"><span class="hljs-string">"  "</span></span>)) (<span class="hljs-name"><span class="hljs-name">setq</span></span> *flagerr* <span class="hljs-literal"><span class="hljs-literal">t</span></span>)))) (<span class="hljs-name"><span class="hljs-name">iter</span></span> (<span class="hljs-name"><span class="hljs-name">for</span></span> a in (<span class="hljs-name"><span class="hljs-name">setof</span></span> loc-var)) (<span class="hljs-name"><span class="hljs-name">collecting</span></span> (<span class="hljs-name"><span class="hljs-name">list</span></span> a <span class="hljs-number"><span class="hljs-number">0</span></span>) into lv)) `(defun ,proc-name ,proc-parm (let ,lv ,@body))))</code> </pre><br>  Mari kita periksa kinerja kode kita.  Kami memuat kode ke lingkungan Lisp, memanggil fungsi mulai dan menerjemahkan prosedur berikut: <br><br> <code>0001 proc main() <br> 0002 local x,y,z <br> 0003 x=3 <br> 0004 y=4 <br> 0005 z=x^2+y^2 <br> 0006 print z <br> 0007 end_proc <br></code> <br><br>  Mari kita lihat apa yang dihasilkan oleh penerjemah kami: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">getd</span></span> 'main) ==&gt; (<span class="hljs-name"><span class="hljs-name">EXPR</span></span> NIL (<span class="hljs-name"><span class="hljs-name">LET</span></span> ((<span class="hljs-name"><span class="hljs-name">X</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>) (<span class="hljs-name"><span class="hljs-name">Y</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>) (<span class="hljs-name"><span class="hljs-name">Z</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>)) (<span class="hljs-name"><span class="hljs-name">SETQ</span></span> X <span class="hljs-number"><span class="hljs-number">3</span></span>) (<span class="hljs-name"><span class="hljs-name">SETQ</span></span> Y <span class="hljs-number"><span class="hljs-number">4</span></span>) (<span class="hljs-name"><span class="hljs-name">SETQ</span></span> Z (<span class="hljs-name"><span class="hljs-name">+</span></span> (^ X <span class="hljs-number"><span class="hljs-number">2</span></span>) (^ Y <span class="hljs-number"><span class="hljs-number">2</span></span>))) (<span class="hljs-name"><span class="hljs-name">PRINTLINE</span></span> Z)))</code> </pre><br>  Segalanya tampak benar.  Sekarang, mari panggil prosedur kami dan dapatkan hasil yang diharapkan: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">main</span></span>) <span class="hljs-number"><span class="hljs-number">25</span></span> ==&gt; <span class="hljs-number"><span class="hljs-number">25</span></span></code> </pre><br>  Penerjemah kami juga akan menangani fungsi-fungsi bawaan dengan benar.  Untuk memverifikasi ini, kami akan menjalankan, misalnya, kode berikut: <br><br> <code>0001 proc main() <br> 0002 local x,y,z,pi <br> 0003 pi=3.1415926535 <br> 0004 x=sin(pi/6) <br> 0005 y=cos(pi/6) <br> 0006 z=x^2+y^2 <br> 0007 print x <br> 0018 print y <br> 0019 print z <br> 0010 end_proc <br></code> <br><br>  Dan kita mendapatkan: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">main</span></span>) <span class="hljs-number"><span class="hljs-number">0.499999999987039</span></span> <span class="hljs-number"><span class="hljs-number">0.866025403791922</span></span> <span class="hljs-number"><span class="hljs-number">1.0</span></span> ==&gt; <span class="hljs-number"><span class="hljs-number">1.0</span></span></code> </pre><br>  Penerjemah kami menjadi hidup di depan mata kami! <br><br>  Namun, kami sangat terhanyut: berjuang untuk tujuan akhir, kami tidak memikirkan sama sekali tentang kesalahan yang dapat dilakukan oleh pengguna (pemrogram menggunakan mini-basic).  Dengan cara yang baik, kami harus segera memikirkan kesalahan, tetapi kami baru saja mulai bekerja, kami tidak melangkah terlalu jauh, dan belum terlambat untuk memperkenalkan penanganan kesalahan dan diagnostik ke dalam kode.  Selain itu, jelas bahwa "perbaikan kecil" menunjukkan (misalnya, penerjemah kami mengharuskan operator untuk menempati tepat satu baris, yang tidak nyaman). <br><br>  Artikel berikut akan dikhususkan untuk semua pertanyaan ini. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><b>Untuk dilanjutkan</b></a> <br><br>  Kode untuk artikel ini dapat diunduh di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini.</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id421445/">https://habr.com/ru/post/id421445/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id421433/index.html">Hanya ada satu hari tersisa sebelum server dimulai.</a></li>
<li><a href="../id421435/index.html">"Kenapa kita semua melakukan ini?" - Pencipta Prisma dan mantan pemimpin proyek VK tentang proyek rahasia barunya</a></li>
<li><a href="../id421439/index.html">Jepang memperkenalkan prosesor prototipe untuk superkomputer exaflops: cara kerja chip</a></li>
<li><a href="../id421441/index.html">Embox mulai mendaki Gunung Elbrus</a></li>
<li><a href="../id421443/index.html">Baru di Pasar Kami: Tinjauan Seluler IP Snom D385 dan D785</a></li>
<li><a href="../id421447/index.html">Rapat Redmadrobot iOS</a></li>
<li><a href="../id421451/index.html">Cara melindungi anak Anda dari sampah di YouTube dan membuat pemutar khusus dengan daftar saluran putih</a></li>
<li><a href="../id421453/index.html">Situasi: Sonos go public dan mungkin "keluar dari ruangan"</a></li>
<li><a href="../id421455/index.html">Jepang meluncurkan uji klinis pertama sel punca dunia menggunakan penyakit Parkinson</a></li>
<li><a href="../id421461/index.html">Pelacak Waktu untuk Google Scripts, Documents, dan Spreadsheets</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>