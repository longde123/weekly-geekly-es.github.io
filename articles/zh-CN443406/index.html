<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ŠğŸ¾ ğŸ™‡ âœ”ï¸ åœ¨C ++ä¸­ä½¿ç”¨å¤šçº¿ç¨‹æ—¶çš„å‰20ä¸ªé”™è¯¯åŠå…¶é¿å…æ–¹æ³• ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ ğŸ¼ ğŸ“</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆHaï¼ æˆ‘æè¯·æ‚¨æ³¨æ„Deb Haldaræ’°å†™çš„æ–‡ç« â€œ Top 20 C ++å¤šçº¿ç¨‹é”™è¯¯ä»¥åŠå¦‚ä½•é¿å…è¿™äº›é”™è¯¯â€ ã€‚ 


 ç”µå½±ã€Šæ—¶é—´çš„å¾ªç¯ã€‹ï¼ˆ2012ï¼‰ä¸­çš„åœºæ™¯ 

 å¤šçº¿ç¨‹æ˜¯ç¼–ç¨‹ä¸­æœ€å›°éš¾çš„é¢†åŸŸä¹‹ä¸€ï¼Œå°¤å…¶æ˜¯åœ¨C ++ä¸­ã€‚ ç»è¿‡å¤šå¹´çš„å‘å±•ï¼Œæˆ‘çŠ¯äº†å¾ˆå¤šé”™è¯¯ã€‚ å¹¸è¿çš„æ˜¯ï¼Œå®ƒä»¬ä¸­çš„å¤§å¤šæ•°æ˜¯é€šè¿‡å®¡æŸ¥ä»£ç å’Œæµ‹...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ¨C ++ä¸­ä½¿ç”¨å¤šçº¿ç¨‹æ—¶çš„å‰20ä¸ªé”™è¯¯åŠå…¶é¿å…æ–¹æ³•</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443406/"> å“ˆHaï¼ æˆ‘æè¯·æ‚¨æ³¨æ„Deb Haldaræ’°å†™çš„æ–‡ç« <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œ Top 20 C ++å¤šçº¿ç¨‹é”™è¯¯ä»¥åŠå¦‚ä½•é¿å…è¿™äº›é”™è¯¯â€</a> ã€‚ <br><br><img src="https://habrastorage.org/webt/wi/a8/4v/wia84vtxrf1vqym4rwoynnvtfw0.jpeg" title="KDPVã€‚ç”µå½±â€œæ—¶é—´å¾ªç¯ï¼ˆ2012å¹´ï¼‰â€ä¸­çš„åœºæ™¯"><br>  <i>ç”µå½±ã€Šæ—¶é—´çš„å¾ªç¯ã€‹ï¼ˆ2012ï¼‰ä¸­çš„åœºæ™¯</i> <br><br> å¤šçº¿ç¨‹æ˜¯ç¼–ç¨‹ä¸­æœ€å›°éš¾çš„é¢†åŸŸä¹‹ä¸€ï¼Œå°¤å…¶æ˜¯åœ¨C ++ä¸­ã€‚ ç»è¿‡å¤šå¹´çš„å‘å±•ï¼Œæˆ‘çŠ¯äº†å¾ˆå¤šé”™è¯¯ã€‚ å¹¸è¿çš„æ˜¯ï¼Œå®ƒä»¬ä¸­çš„å¤§å¤šæ•°æ˜¯é€šè¿‡å®¡æŸ¥ä»£ç å’Œæµ‹è¯•ç¡®å®šçš„ã€‚ ä½†æ˜¯ï¼Œç”±äºæŸç§åŸå› ï¼Œç”Ÿäº§æ•ˆç‡ä¸‹é™äº†ï¼Œæˆ‘ä»¬ä¸å¾—ä¸ç¼–è¾‘æ“ä½œç³»ç»Ÿï¼Œè¿™æ€»æ˜¯å¾ˆæ˜‚è´µçš„ã€‚ <br><br> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°è¯•ä½¿ç”¨å¯èƒ½çš„è§£å†³æ–¹æ¡ˆå¯¹æˆ‘çŸ¥é“çš„æ‰€æœ‰é”™è¯¯è¿›è¡Œåˆ†ç±»ã€‚ å¦‚æœæ‚¨çŸ¥é“å…¶ä»–ä»»ä½•é™·é˜±ï¼Œæˆ–è€…å¯¹è§£å†³æ‰€æè¿°çš„é”™è¯¯æœ‰å»ºè®®ï¼Œè¯·åœ¨æœ¬æ–‡ä¸‹æ–¹ä¿ç•™æ‚¨çš„è¯„è®ºã€‚ <br><a name="habracut"></a><br><h3> é”™è¯¯ï¼ƒ1ï¼šåœ¨é€€å‡ºåº”ç”¨ç¨‹åºä¹‹å‰ï¼Œè¯·å‹¿ä½¿ç”¨joinï¼ˆï¼‰ç­‰å¾…åå°çº¿ç¨‹ </h3><br> å¦‚æœæ‚¨å¿˜è®°åœ¨ç¨‹åºç»ˆæ­¢ä¹‹å‰åŠ å…¥æµï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">joinï¼ˆï¼‰</a> ï¼‰æˆ–å–æ¶ˆå›ºå®šå®ƒï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">detachï¼ˆï¼‰</a> ï¼‰ï¼ˆä½¿å…¶ä¸å¯è¿æ¥ï¼‰ï¼Œåˆ™å°†å¯¼è‡´å´©æºƒã€‚  ï¼ˆè™½ç„¶è¿™å¹¶ä¸å®Œå…¨æ­£ç¡®ï¼Œä½†æ˜¯ç¿»è¯‘å°†åŒ…å«åœ¨<i>joinï¼ˆï¼‰</i>ä¸Šä¸‹æ–‡ä¸­çš„<i>join</i>å’Œåœ¨<i>detachï¼ˆï¼‰</i>ä¸Šä¸‹æ–‡ä¸­çš„<i>detach</i> ã€‚å®é™…ä¸Šï¼Œ <i>joinï¼ˆï¼‰</i>æ˜¯ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹å®Œæˆçš„åœ°æ–¹ï¼Œå¹¶ä¸”ä¸ä¼šå‘ç”Ÿçº¿ç¨‹çš„åˆå¹¶æˆ–åˆå¹¶[è¯„è®ºç¿»è¯‘]ï¼‰ã€‚ <br><br> åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¿˜è®°äº†åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçº¿ç¨‹t1çš„<i>joinï¼ˆï¼‰</i> ï¼š <br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <font color="#339900">#include &lt;thread&gt;</font> <br> <br> <font color="#0000ff">using</font> <font color="#0000ff">namespace</font> std <font color="#008080">;</font> <br> <br> <font color="#0000ff">void</font> LaunchRocket <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Launching Rocket"</font> <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> thread t1 <font color="#008000">(</font> LaunchRocket <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#666666">//t1.join(); //     join-     </font> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font></code> <br> <br> ä¸ºä»€ä¹ˆç¨‹åºå´©æºƒï¼Ÿ å› ä¸ºåœ¨<i>mainï¼ˆï¼‰</i>å‡½æ•°çš„æœ«å°¾ï¼Œå˜é‡t1è¶…å‡ºèŒƒå›´ï¼Œæ‰€ä»¥è°ƒç”¨äº†çº¿ç¨‹ææ„å‡½æ•°ã€‚ ææ„å‡½æ•°æ£€æŸ¥çº¿ç¨‹t1æ˜¯å¦<i>å¯è¿æ¥</i> ã€‚ å¦‚æœçº¿ç¨‹å°šæœªåˆ†ç¦»ï¼Œåˆ™è¯¥çº¿ç¨‹æ˜¯<i>å¯è¿æ¥çš„</i> ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†åœ¨å…¶ææ„å‡½æ•°ä¸­è°ƒç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">std :: terminate</a> ã€‚ ä¾‹å¦‚ï¼Œè¿™å°±æ˜¯MSVC ++ç¼–è¯‘å™¨æ‰€åšçš„ã€‚ <br><br> <code>~thread <font color="#008000">(</font> <font color="#008000">)</font> _NOEXCEPT <br> <font color="#008000">{</font> <font color="#666666">// clean up</font> <br> <font color="#0000ff">if</font> <font color="#008000">(</font> joinable <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <br> XSTD terminate <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br> æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è§£å†³æ­¤é—®é¢˜ï¼Œå…·ä½“å–å†³äºä»»åŠ¡ï¼š <br><br>  1.åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨çº¿ç¨‹t1çš„<i>joinï¼ˆï¼‰</i> ï¼š <br><br> <code><font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> thread t1 <font color="#008000">(</font> LaunchRocket <font color="#008000">)</font> <font color="#008080">;</font> <br> t1. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <font color="#666666">//  join  t1,        </font> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br>  2.ä»ä¸»æµåˆ†ç¦»æµt1ï¼Œä½¿å…¶ç»§ç»­ä½œä¸ºâ€œå¦–é­”åŒ–â€æµå·¥ä½œï¼š <br><br> <code><font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> thread t1 <font color="#008000">(</font> LaunchRocket <font color="#008000">)</font> <font color="#008080">;</font> <br> t1. <font color="#007788">detach</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <font color="#666666">//   t1   </font> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font></code> <br> <br><h3> é”™è¯¯2ï¼šå°è¯•é™„åŠ å…ˆå‰åˆ†ç¦»çš„çº¿ç¨‹ </h3><br> å¦‚æœç¨‹åºåœ¨æŸä¸ªæ—¶å€™æœ‰<i>åˆ†ç¦»</i>æµï¼Œåˆ™æ— æ³•å°†å…¶é™„åŠ å›ä¸»æµã€‚ è¿™æ˜¯ä¸€ä¸ªéå¸¸æ˜æ˜¾çš„é”™è¯¯ã€‚ é—®é¢˜æ˜¯æ‚¨å¯ä»¥å–æ¶ˆå›ºå®šæµï¼Œç„¶åç¼–å†™å‡ ç™¾è¡Œä»£ç å¹¶å°è¯•é‡æ–°é™„åŠ å®ƒã€‚ æ¯•ç«Ÿï¼Œè°è®°å¾—ä»–å†™äº†300è¡Œï¼Œå¯¹å—ï¼Ÿ <br><br> é—®é¢˜åœ¨äºè¿™ä¸ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œç›¸åï¼Œç¨‹åºå°†åœ¨å¯åŠ¨æ—¶å´©æºƒã€‚ ä¾‹å¦‚ï¼š <br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <font color="#339900">#include &lt;thread&gt;</font> <br> <br> <font color="#0000ff">using</font> <font color="#0000ff">namespace</font> std <font color="#008080">;</font> <br> <br> <font color="#0000ff">void</font> LaunchRocket <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Launching Rocket"</font> <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> thread t1 <font color="#008000">(</font> LaunchRocket <font color="#008000">)</font> <font color="#008080">;</font> <br> t1. <font color="#007788">detach</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#666666">//..... 100  - </font> <br> t1. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <font color="#666666">// CRASH !!!</font> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br> è§£å†³æ–¹æ¡ˆæ˜¯åœ¨å°è¯•å°†çº¿ç¨‹é™„åŠ åˆ°è°ƒç”¨çº¿ç¨‹ä¹‹å‰ï¼Œå§‹ç»ˆæ£€æŸ¥è¯¥çº¿ç¨‹æ˜¯å¦å­˜åœ¨<i>joinableï¼ˆï¼‰</i> ã€‚ <br><br> <code><font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> thread t1 <font color="#008000">(</font> LaunchRocket <font color="#008000">)</font> <font color="#008080">;</font> <br> t1. <font color="#007788">detach</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#666666">//..... 100  - </font> <br> <br> <font color="#0000ff">if</font> <font color="#008000">(</font> t1. <font color="#007788">joinable</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> t1. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br><h3> é”™è¯¯3ï¼šè¯¯è§£std :: thread :: joinï¼ˆï¼‰é˜»æ­¢äº†æ‰§è¡Œçš„è°ƒç”¨çº¿ç¨‹ </h3><br> åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ‚¨ç»å¸¸éœ€è¦åˆ†ç¦»å‡ºå¤„ç†ç½‘ç»œI / Oçš„â€œé•¿æ—¶é—´æ’­æ”¾â€æ“ä½œæˆ–ç­‰å¾…ç”¨æˆ·å•å‡»æŒ‰é’®ç­‰ã€‚ å¯¹äºæ­¤ç±»å·¥ä½œæµï¼ˆä¾‹å¦‚ï¼ŒUIæ¸²æŸ“çº¿ç¨‹ï¼‰çš„<i>joinï¼ˆï¼‰</i>è°ƒç”¨å¯èƒ½ä¼šå¯¼è‡´ç”¨æˆ·ç•Œé¢æŒ‚èµ·ã€‚ æœ‰æ›´å¤šåˆé€‚çš„å®ç°æ–¹æ³•ã€‚ <br><br> ä¾‹å¦‚ï¼Œåœ¨GUIåº”ç”¨ç¨‹åºä¸­ï¼Œå·¥ä½œçº¿ç¨‹å¯ä»¥åœ¨å®Œæˆåå°†æ¶ˆæ¯å‘é€åˆ°UIçº¿ç¨‹ã€‚  UIæµå…·æœ‰å…¶è‡ªå·±çš„äº‹ä»¶å¤„ç†å¾ªç¯ï¼Œä¾‹å¦‚ï¼šç§»åŠ¨é¼ æ ‡ï¼ŒæŒ‰ä¸‹é”®ç­‰ã€‚ æ­¤å¾ªç¯è¿˜å¯ä»¥æ¥æ”¶æ¥è‡ªå·¥ä½œçº¿ç¨‹çš„æ¶ˆæ¯å¹¶å¯¹å…¶è¿›è¡Œå“åº”ï¼Œè€Œä¸å¿…è°ƒç”¨é˜»å¡çš„<i>joinï¼ˆï¼‰</i>æ–¹æ³•ã€‚ <br><br> å› æ­¤ï¼ŒMicrosoftçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WinRT</a>å¹³å°ä¸­å‡ ä¹æ‰€æœ‰ç”¨æˆ·äº¤äº’éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸”æ²¡æœ‰åŒæ­¥æ›¿ä»£æ–¹æ³•ã€‚ åšå‡ºè¿™äº›å†³å®šæ˜¯ä¸ºäº†ç¡®ä¿å¼€å‘äººå‘˜å°†ä½¿ç”¨å¯æä¾›æœ€ä½³æœ€ç»ˆç”¨æˆ·ä½“éªŒçš„APIã€‚ æ‚¨å¯ä»¥å‚è€ƒâ€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Modern C ++å’ŒWindows Store Apps</a> â€æ‰‹å†Œï¼Œä»¥è·å–æœ‰å…³æ­¤ä¸»é¢˜çš„æ›´å¤šä¿¡æ¯ã€‚ <br><br><h3> é”™è¯¯4ï¼šå‡è®¾é»˜è®¤æƒ…å†µä¸‹é€šè¿‡å¼•ç”¨ä¼ é€’æµå‡½æ•°å‚æ•° </h3><br> é»˜è®¤æƒ…å†µä¸‹ï¼Œæµå‡½æ•°çš„å‚æ•°æŒ‰å€¼ä¼ é€’ã€‚ å¦‚æœéœ€è¦æ›´æ”¹æ‰€ä¼ é€’çš„å‚æ•°ï¼Œåˆ™å¿…é¡»ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">std :: refï¼ˆï¼‰</a>å‡½æ•°é€šè¿‡å¼•ç”¨å°†å…¶ä¼ é€’ã€‚ <br><br> åœ¨å‰§é€ä¹‹ä¸‹ï¼Œæ¥è‡ªå¦<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€ç¯‡C ++ 11æ–‡ç« â€œé€šè¿‡Qï¼†Aè¿›è¡Œå¤šçº¿ç¨‹æ•™ç¨‹-çº¿ç¨‹ç®¡ç†åŸºç¡€çŸ¥è¯†ï¼ˆDeb Haldarï¼‰</a> â€çš„ç¤ºä¾‹ï¼Œè¯´æ˜äº†ä¼ é€’å‚æ•°çš„è¿‡ç¨‹ã€‚ è¯‘è€…]ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š</b> <div class="spoiler_text"> æ‰§è¡Œä»£ç æ—¶ï¼š <br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;string&gt;</font> <br> <font color="#339900">#include &lt;thread&gt;</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <font color="#339900">#include &lt;functional&gt;</font> <br> <br> <font color="#0000ff">using</font> <font color="#0000ff">namespace</font> std <font color="#008080">;</font> <br> <br> <font color="#0000ff">void</font> ChangeCurrentMissileTarget <font color="#008000">(</font> string <font color="#000040">&amp;</font> targetCity <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> targetCity <font color="#000080">=</font> <font color="#FF0000">"Metropolis"</font> <font color="#008080">;</font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" Changing The Target City To "</font> <font color="#000080">&lt;&lt;</font> targetCity <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> string targetCity <font color="#000080">=</font> <font color="#FF0000">"Star City"</font> <font color="#008080">;</font> <br> thread t1 <font color="#008000">(</font> ChangeCurrentMissileTarget, targetCity <font color="#008000">)</font> <font color="#008080">;</font> <br> t1. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Current Target City is "</font> <font color="#000080">&lt;&lt;</font> targetCity <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br> å®ƒå°†æ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸­ï¼š <br> <code>Changing The Target City To Metropolis <br> Current Target City is Star City</code> <br> <br> å¦‚æ‚¨æ‰€è§ï¼Œæµä¸­é€šè¿‡å¼•ç”¨è°ƒç”¨çš„å‡½æ•°æ¥æ”¶åˆ°çš„<i>targetCity</i>å˜é‡çš„å€¼æœªæ›´æ”¹ã€‚ <br><br> ä½¿ç”¨<i>std :: refï¼ˆï¼‰</i>é‡å†™ä»£ç ä»¥ä¼ é€’å‚æ•°ï¼š <br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;string&gt;</font> <br> <font color="#339900">#include &lt;thread&gt;</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <font color="#339900">#include &lt;functional&gt;</font> <br> <br> <font color="#0000ff">using</font> <font color="#0000ff">namespace</font> std <font color="#008080">;</font> <br> <br> <font color="#0000ff">void</font> ChangeCurrentMissileTarget <font color="#008000">(</font> string <font color="#000040">&amp;</font> targetCity <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> targetCity <font color="#000080">=</font> <font color="#FF0000">"Metropolis"</font> <font color="#008080">;</font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" Changing The Target City To "</font> <font color="#000080">&lt;&lt;</font> targetCity <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> string targetCity <font color="#000080">=</font> <font color="#FF0000">"Star City"</font> <font color="#008080">;</font> <br> thread t1 <font color="#008000">(</font> ChangeCurrentMissileTarget, std <font color="#008080">::</font> <font color="#007788">ref</font> <font color="#008000">(</font> targetCity <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> t1. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Current Target City is "</font> <font color="#000080">&lt;&lt;</font> targetCity <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font></code> <br> <br> å®ƒå°†è¾“å‡ºï¼š <br> <code>Changing The Target City To Metropolis <br> Current Target City is Metropolis</code> <br> <br> åœ¨æ–°çº¿ç¨‹ä¸­æ‰€åšçš„æ›´æ”¹å°†å½±å“åœ¨<i>ä¸»</i>å‡½æ•°ä¸­å£°æ˜å’Œåˆå§‹åŒ–çš„<i>targetCity</i>å˜é‡çš„å€¼ã€‚ <br></div></div><br><h3> é”™è¯¯5ï¼šè¯·å‹¿ä½¿ç”¨å…³é”®éƒ¨åˆ†ï¼ˆä¾‹å¦‚äº’æ–¥é”ï¼‰ä¿æŠ¤å…±äº«æ•°æ®å’Œèµ„æº </h3><br> åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œé€šå¸¸ä¼šæœ‰å¤šä¸ªçº¿ç¨‹ç«äº‰èµ„æºå’Œå…±äº«æ•°æ®ã€‚ é€šå¸¸ï¼Œè¿™ä¼šå¯¼è‡´èµ„æºå’Œæ•°æ®çš„çŠ¶æ€ä¸ç¡®å®šï¼Œé™¤éé€šè¿‡æŸç§æœºåˆ¶ä¿æŠ¤å¯¹å®ƒä»¬çš„è®¿é—®ï¼Œè¯¥æœºåˆ¶ä»…å…è®¸ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹åœ¨ä»»ä½•æ—¶é—´å¯¹å…¶æ‰§è¡Œæ“ä½œã€‚ <br><br> åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œ <i>std :: cout</i>æ˜¯ä¸€ä¸ªå…±äº«èµ„æºï¼Œå¯ä»¥ä½¿ç”¨6ä¸ªçº¿ç¨‹ï¼ˆt1-t5 + mainï¼‰ã€‚ <br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <font color="#339900">#include &lt;string&gt;</font> <br> <font color="#339900">#include &lt;thread&gt;</font> <br> <font color="#339900">#include &lt;mutex&gt;</font> <br> <br> <font color="#0000ff">using</font> <font color="#0000ff">namespace</font> std <font color="#008080">;</font> <br> <br> std <font color="#008080">::</font> <font color="#007788">mutex</font> mu <font color="#008080">;</font> <br> <br> <font color="#0000ff">void</font> CallHome <font color="#008000">(</font> string message <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Thread "</font> <font color="#000080">&lt;&lt;</font> this_thread <font color="#008080">::</font> <font color="#007788">get_id</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" says "</font> <font color="#000080">&lt;&lt;</font> message <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> thread t1 <font color="#008000">(</font> CallHome, <font color="#FF0000">"Hello from Jupiter"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> thread t2 <font color="#008000">(</font> CallHome, <font color="#FF0000">"Hello from Pluto"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> thread t3 <font color="#008000">(</font> CallHome, <font color="#FF0000">"Hello from Moon"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> CallHome <font color="#008000">(</font> <font color="#FF0000">"Hello from Main/Earth"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> thread t4 <font color="#008000">(</font> CallHome, <font color="#FF0000">"Hello from Uranus"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> thread t5 <font color="#008000">(</font> CallHome, <font color="#FF0000">"Hello from Neptune"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> t1. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> t2. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> t3. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> t4. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> t5. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br> å¦‚æœæ‰§è¡Œæ­¤ç¨‹åºï¼Œæˆ‘ä»¬å°†å¾—å‡ºç»“è®ºï¼š <br><br> <code>Thread 0x1000fb5c0 says Hello from Main/Earth <br> Thread Thread Thread 0x700005bd20000x700005b4f000 says says Thread Thread Hello from Pluto0x700005c55000Hello from Jupiter says 0x700005d5b000Hello from Moon <br> 0x700005cd8000 says says Hello from Uranus <br> <br> Hello from Neptune <br></code> <br><br> è¿™æ˜¯å› ä¸ºäº”ä¸ªçº¿ç¨‹æ­£åœ¨ä»¥éšæœºé¡ºåºåŒæ—¶è®¿é—®è¾“å‡ºæµã€‚ ä¸ºäº†ä½¿ç»“è®ºæ›´å…·ä½“ï¼Œå¿…é¡»ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">std :: mutex</a>ä¿æŠ¤å¯¹å…±äº«èµ„æºçš„è®¿é—®ã€‚ åªéœ€æ›´æ”¹<i>CallHomeï¼ˆï¼‰</i>å‡½æ•°ï¼Œä»¥ä¾¿å®ƒåœ¨ä½¿ç”¨<i>std :: cout</i>ä¹‹å‰æ•è·äº’æ–¥é‡ï¼Œå¹¶åœ¨ä¹‹åé‡Šæ”¾å®ƒã€‚ <br><br> <code><font color="#0000ff">void</font> CallHome <font color="#008000">(</font> string message <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> mu. <font color="#007788">lock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Thread "</font> <font color="#000080">&lt;&lt;</font> this_thread <font color="#008080">::</font> <font color="#007788">get_id</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" says "</font> <font color="#000080">&lt;&lt;</font> message <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> mu. <font color="#007788">unlock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font></code> <br> <br><h3> é”™è¯¯ï¼ƒ6ï¼šé€€å‡ºå…³é”®éƒ¨åˆ†åå¿˜è®°é‡Šæ”¾é” </h3><br> åœ¨ä¸Šä¸€æ®µä¸­ï¼Œæ‚¨äº†è§£äº†å¦‚ä½•ä½¿ç”¨äº’æ–¥é”ä¿æŠ¤å…³é”®éƒ¨åˆ†ã€‚ ä½†æ˜¯ï¼Œä¸å»ºè®®ç›´æ¥åœ¨äº’æ–¥<i>é”ä¸Š</i>è°ƒç”¨<i>lockï¼ˆï¼‰</i>å’Œ<i>unlockï¼ˆï¼‰</i>æ–¹æ³•ï¼Œå› ä¸ºæ‚¨å¯èƒ½ä¼šå¿˜è®°èµ‹äºˆä¿ç•™çš„é”ã€‚ æ¥ä¸‹æ¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ ç­‰å¾…èµ„æºé‡Šæ”¾çš„æ‰€æœ‰å…¶ä»–çº¿ç¨‹å°†è¢«æ— é™é˜»æ­¢ï¼Œç¨‹åºå¯èƒ½ä¼šæŒ‚èµ·ã€‚ <br><br> åœ¨æˆ‘ä»¬çš„ç»¼åˆç¤ºä¾‹ä¸­ï¼Œå¦‚æœæ‚¨å¿˜è®°äº†åœ¨<i>CallHomeï¼ˆï¼‰</i>å‡½æ•°è°ƒç”¨ä¸­è§£é”äº’æ–¥é”ï¼Œåˆ™æ¥è‡ªæµt1çš„ç¬¬ä¸€æ¡æ¶ˆæ¯å°†è¾“å‡ºåˆ°æ ‡å‡†æµï¼Œå¹¶ä¸”ç¨‹åºå°†å´©æºƒã€‚ è¿™æ˜¯ç”±äºä»¥ä¸‹äº‹å®ï¼šçº¿ç¨‹t1æ¥æ”¶äº†äº’æ–¥é”ï¼Œè€Œå…¶ä½™çº¿ç¨‹ç­‰å¾…æ­¤é”è¢«é‡Šæ”¾ã€‚ <br><br> <code><font color="#0000ff">void</font> CallHome <font color="#008000">(</font> string message <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> mu. <font color="#007788">lock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Thread "</font> <font color="#000080">&lt;&lt;</font> this_thread <font color="#008080">::</font> <font color="#007788">get_id</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" says "</font> <font color="#000080">&lt;&lt;</font> message <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <font color="#666666">//mu.unlock();     </font> <br> <font color="#008000">}</font></code> <br> <br> ä»¥ä¸‹æ˜¯æ­¤ä»£ç çš„è¾“å‡º-ç¨‹åºå´©æºƒï¼Œåœ¨ç»ˆç«¯ä¸­æ˜¾ç¤ºå”¯ä¸€çš„æ¶ˆæ¯ï¼Œä½†æ²¡æœ‰ç»“æŸï¼š <br><br> <code>Thread 0x700005986000 says Hello from Pluto <br> <br></code> <br><br> ç»å¸¸ä¼šå‘ç”Ÿæ­¤ç±»é”™è¯¯ï¼Œè¿™å°±æ˜¯ä¸å¸Œæœ›ç›´æ¥ä»äº’æ–¥é”ä½¿ç”¨<i>lockï¼ˆï¼‰/ unlockï¼ˆï¼‰</i>æ–¹æ³•çš„åŸå› ã€‚ è€Œæ˜¯ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">std :: lock_guard</a>æ¨¡æ¿ç±»ï¼Œè¯¥æ¨¡æ¿ç±»ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RAII</a>æƒ¯ç”¨è¯­æ¥æ§åˆ¶é”çš„ç”Ÿå­˜æœŸã€‚ åˆ›å»º<i>lock_guard</i>å¯¹è±¡æ—¶ï¼Œå®ƒå°†å°è¯•æ¥ç®¡äº’æ–¥é”ã€‚ å½“ç¨‹åºç¦»å¼€<i>lock_guard</i>å¯¹è±¡çš„èŒƒå›´æ—¶ï¼Œå°†è°ƒç”¨ææ„å‡½æ•°ï¼Œä»è€Œé‡Šæ”¾äº’æ–¥é‡ã€‚ <br><br> æˆ‘ä»¬ä½¿ç”¨<i>std :: lock_guard</i>å¯¹è±¡é‡å†™<i>CallHomeï¼ˆï¼‰</i>å‡½æ•°ï¼š <br><br> <code><font color="#0000ff">void</font> CallHome <font color="#008000">(</font> string message <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">lock_guard</font> <font color="#000080">&lt;</font> std <font color="#008080">::</font> <font color="#007788">mutex</font> <font color="#000080">&gt;</font> lock <font color="#008000">(</font> mu <font color="#008000">)</font> <font color="#008080">;</font> <font color="#666666">//   </font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Thread "</font> <font color="#000080">&lt;&lt;</font> this_thread <font color="#008080">::</font> <font color="#007788">get_id</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" says "</font> <font color="#000080">&lt;&lt;</font> message <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <font color="#008000">}</font> <font color="#666666">//  lock_guard    </font></code> <br> <br><h3> é”™è¯¯7ï¼šä½¿å…³é”®éƒ¨åˆ†çš„å°ºå¯¸å¤§äºå¿…è¦çš„å°ºå¯¸ </h3><br> å½“ä¸€ä¸ªçº¿ç¨‹åœ¨å…³é”®éƒ¨åˆ†å†…æ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰å…¶ä»–è¯•å›¾è¿›å…¥è¯¥çº¿ç¨‹çš„çº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡ã€‚ åœ¨å…³é”®éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ä¿ç•™å°½å¯èƒ½å°‘çš„è¯´æ˜ã€‚ ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œç»™å‡ºäº†ä¸€ä¸ªå¸¦æœ‰è¾ƒå¤§ä¸´ç•ŒåŒºçš„é”™è¯¯ä»£ç ç¤ºä¾‹ï¼š <br><br> <code><font color="#0000ff">void</font> CallHome <font color="#008000">(</font> string message <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">lock_guard</font> <font color="#000080">&lt;</font> std <font color="#008080">::</font> <font color="#007788">mutex</font> <font color="#000080">&gt;</font> lock <font color="#008000">(</font> mu <font color="#008000">)</font> <font color="#008080">;</font> <font color="#666666">//   ,    std::cout</font> <br> <br> ReadFifyThousandRecords <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Thread "</font> <font color="#000080">&lt;&lt;</font> this_thread <font color="#008080">::</font> <font color="#007788">get_id</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" says "</font> <font color="#000080">&lt;&lt;</font> message <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <br> <font color="#008000">}</font> <font color="#666666">//    lock_guard    mu </font></code> <br> <br>  <i>ReadFifyThousandRecordsï¼ˆï¼‰</i>æ–¹æ³•ä¸ä¼šä¿®æ”¹æ•°æ®ã€‚ æ²¡æœ‰ç†ç”±åœ¨é”å®šçŠ¶æ€ä¸‹æ‰§è¡Œå®ƒã€‚ å¦‚æœæ‰§è¡Œæ­¤æ–¹æ³•10ç§’é’Ÿï¼Œä»æ•°æ®åº“ä¸­è¯»å–5ä¸‡è¡Œï¼Œåˆ™åœ¨æ­¤æ•´ä¸ªå‘¨æœŸå†…ï¼Œæ‰€æœ‰å…¶ä»–çº¿ç¨‹éƒ½å°†è¢«ä¸å¿…è¦åœ°é˜»å¡ã€‚ è¿™ä¼šä¸¥é‡å½±å“ç¨‹åºæ€§èƒ½ã€‚ <br><br> æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆæ˜¯ä»…åœ¨å…³é”®éƒ¨åˆ†ä¸­ä½¿ç”¨<i>std :: cout</i> ã€‚ <br><br> <code><font color="#0000ff">void</font> CallHome <font color="#008000">(</font> string message <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> ReadFifyThousandRecords <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <font color="#666666">//         ..    </font> <br> std <font color="#008080">::</font> <font color="#007788">lock_guard</font> <font color="#000080">&lt;</font> std <font color="#008080">::</font> <font color="#007788">mutex</font> <font color="#000080">&gt;</font> lock <font color="#008000">(</font> mu <font color="#008000">)</font> <font color="#008080">;</font> <font color="#666666">//   ,    std::cout</font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Thread "</font> <font color="#000080">&lt;&lt;</font> this_thread <font color="#008080">::</font> <font color="#007788">get_id</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" says "</font> <font color="#000080">&lt;&lt;</font> message <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <br> <font color="#008000">}</font> <font color="#666666">//     lock_guard    mu </font></code> <br> <br><h3> é”™è¯¯8ï¼šä»¥ä¸åŒçš„é¡ºåºè·å–å¤šä¸ªé” </h3><br><br> è¿™æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­»é”</a>çš„æœ€å¸¸è§åŸå› ä¹‹ä¸€ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºç­‰å¾…è®¿é—®å…¶ä»–çº¿ç¨‹é˜»å¡çš„èµ„æºè€Œå¯¼è‡´çº¿ç¨‹è¢«æ— é™é˜»å¡ã€‚ è€ƒè™‘ä¸€ä¸ªä¾‹å­ï¼š <br><br><table><tbody><tr><th> æµ1 </th><th> æµ2 </th></tr><tr><td> é”A </td><td> é”B </td></tr><tr><td>  // ...ä¸€äº›æ“ä½œ </td><td>  // ...ä¸€äº›æ“ä½œ </td></tr><tr><td> é”B </td><td> é”A </td></tr><tr><td>  // ...å…¶ä»–ä¸€äº›æ“ä½œ </td><td>  // ...å…¶ä»–ä¸€äº›æ“ä½œ </td></tr><tr><td> è§£é”B </td><td> è§£é”A </td></tr><tr><td> è§£é”A </td><td> è§£é”B </td></tr></tbody></table><br> ç”±äºçº¿ç¨‹2å·²ç»æ•è·äº†é”Bï¼Œå› æ­¤çº¿ç¨‹1å°†å°è¯•æ•è·é”Bå¹¶è¢«é˜»å¡çš„æƒ…å†µå¯èƒ½ä¼šå‡ºç°ã€‚ åŒæ—¶ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹æ­£åœ¨å°è¯•æ•è·é”Aï¼Œä½†ä¸èƒ½æ‰§è¡Œæ­¤æ“ä½œï¼Œå› ä¸ºå®ƒæ˜¯ç¬¬ä¸€ä¸ªçº¿ç¨‹æ•è·çš„ã€‚ çº¿ç¨‹1ç›´åˆ°é”ä½Bç­‰åæ‰èƒ½é‡Šæ”¾é”Aã€‚ æ¢å¥è¯è¯´ï¼Œç¨‹åºå†»ç»“ã€‚ <br><br> æ­¤ä»£ç ç¤ºä¾‹å°†å¸®åŠ©æ‚¨é‡ç°<i>æ­»é”</i> ï¼š <br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <font color="#339900">#include &lt;string&gt;</font> <br> <font color="#339900">#include &lt;thread&gt;</font> <br> <font color="#339900">#include &lt;mutex&gt;</font> <br> <br> <font color="#0000ff">using</font> <font color="#0000ff">namespace</font> std <font color="#008080">;</font> <br> <br> std <font color="#008080">::</font> <font color="#007788">mutex</font> muA <font color="#008080">;</font> <br> std <font color="#008080">::</font> <font color="#007788">mutex</font> muB <font color="#008080">;</font> <br> <br> <font color="#0000ff">void</font> CallHome_Th1 <font color="#008000">(</font> string message <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> muA. <font color="#007788">lock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#666666">//  - </font> <br> std <font color="#008080">::</font> <font color="#007788">this_thread</font> <font color="#008080">::</font> <font color="#007788">sleep_for</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">chrono</font> <font color="#008080">::</font> <font color="#007788">milliseconds</font> <font color="#008000">(</font> <font color="#0000dd">100</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> muB. <font color="#007788">lock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Thread "</font> <font color="#000080">&lt;&lt;</font> this_thread <font color="#008080">::</font> <font color="#007788">get_id</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" says "</font> <font color="#000080">&lt;&lt;</font> message <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <br> muB. <font color="#007788">unlock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> muA. <font color="#007788">unlock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">void</font> CallHome_Th2 <font color="#008000">(</font> string message <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> muB. <font color="#007788">lock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#666666">// -  </font> <br> std <font color="#008080">::</font> <font color="#007788">this_thread</font> <font color="#008080">::</font> <font color="#007788">sleep_for</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">chrono</font> <font color="#008080">::</font> <font color="#007788">milliseconds</font> <font color="#008000">(</font> <font color="#0000dd">100</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> muA. <font color="#007788">lock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Thread "</font> <font color="#000080">&lt;&lt;</font> this_thread <font color="#008080">::</font> <font color="#007788">get_id</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" says "</font> <font color="#000080">&lt;&lt;</font> message <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <br> muA. <font color="#007788">unlock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> muB. <font color="#007788">unlock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> thread t1 <font color="#008000">(</font> CallHome_Th1, <font color="#FF0000">"Hello from Jupiter"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> thread t2 <font color="#008000">(</font> CallHome_Th2, <font color="#FF0000">"Hello from Pluto"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> t1. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> t2. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font></code> <br> <br> å¦‚æœè¿è¡Œæ­¤ä»£ç ï¼Œå®ƒå°†å´©æºƒã€‚ å¦‚æœæ‚¨åœ¨çº¿ç¨‹çª—å£ä¸­æ·±å…¥è°ƒè¯•å™¨ï¼Œåˆ™ä¼šçœ‹åˆ°ç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼ˆä»<i>CallHome_Th1ï¼ˆï¼‰</i>è°ƒç”¨ï¼‰è¯•å›¾è·å–äº’æ–¥é”Bï¼Œè€Œçº¿ç¨‹2ï¼ˆä»<i>CallHome_Th2ï¼ˆï¼‰</i>è°ƒç”¨ï¼‰è¯•å›¾é˜»æ­¢äº’æ–¥é”Aã€‚æ— æ³•æˆåŠŸï¼Œè¿™å°†å¯¼è‡´åƒµå±€ï¼ <br><br> <a href=""><img src="https://habrastorage.org/webt/ud/kf/a5/udkfa53cvuh8xsrn8lljglb09fa.png"></a> <br>  ï¼ˆå›¾ç‰‡å¯ç‚¹å‡»ï¼‰ <br><br> ä½ èƒ½åšä»€ä¹ˆå‘¢ï¼Ÿ æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯é‡ç»„ä»£ç ï¼Œä»¥ä¾¿æ¯æ¬¡é”å®šé”çš„é¡ºåºç›¸åŒã€‚ <br><br> æ ¹æ®æƒ…å†µï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å…¶ä»–ç­–ç•¥ï¼š <br><br>  1.ä½¿ç”¨åŒ…è£…å™¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç±»std :: scoped_lock</a>å…±åŒæ•è·å¤šä¸ªé”ï¼š <br><br> <code>std <font color="#008080">::</font> <font color="#007788">scoped_lock</font> lock <font color="#008000">{</font> muA, muB <font color="#008000">}</font> <font color="#008080">;</font></code> <br> <br>  2.ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">std :: timed_mutexç±»</a> ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­æŒ‡å®šä¸€ä¸ªè¶…æ—¶ï¼Œå¦‚æœèµ„æºä¸å¯ç”¨ï¼Œå°†åœ¨è¯¥è¶…æ—¶åé‡Šæ”¾é”ã€‚ <br><br> <code>std <font color="#008080">::</font> <font color="#007788">timed_mutex</font> m <font color="#008080">;</font> <br> <br> <font color="#0000ff">void</font> DoSome <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">chrono</font> <font color="#008080">::</font> <font color="#007788">milliseconds</font> timeout <font color="#008000">(</font> <font color="#0000dd">100</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#0000ff">while</font> <font color="#008000">(</font> <font color="#0000ff">true</font> <font color="#008000">)</font> <font color="#008000">{</font> <br> <font color="#0000ff">if</font> <font color="#008000">(</font> m. <font color="#007788">try_lock_for</font> <font color="#008000">(</font> timeout <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> std <font color="#008080">::</font> <font color="#007788">this_thread</font> <font color="#008080">::</font> <font color="#007788">get_id</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">": acquire mutex successfully"</font> <font color="#000080">&lt;&lt;</font> std <font color="#008080">::</font> <font color="#007788">endl</font> <font color="#008080">;</font> <br> m. <font color="#007788">unlock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <font color="#0000ff">else</font> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> std <font color="#008080">::</font> <font color="#007788">this_thread</font> <font color="#008080">::</font> <font color="#007788">get_id</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">": can't  acquire mutex, do something else"</font> <font color="#000080">&lt;&lt;</font> std <font color="#008080">::</font> <font color="#007788">endl</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <font color="#008000">}</font> <br> <font color="#008000">}</font></code> <br> <br><h3> é”™è¯¯9ï¼šå°è¯•ä¸¤æ¬¡æ•è·std ::äº’æ–¥é” </h3><br> å°è¯•ä¸¤æ¬¡é”å®šè¯¥é”å°†å¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚ åœ¨å¤§å¤šæ•°è°ƒè¯•å®ç°ä¸­ï¼Œè¿™å°†å´©æºƒã€‚ ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œ <i>LaunchRocketï¼ˆï¼‰å°†</i>é”å®šäº’æ–¥é”ï¼Œç„¶åè°ƒç”¨<i>StartThrusterï¼ˆï¼‰</i> ã€‚ ä»¤äººå¥½å¥‡çš„æ˜¯ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ‚¨åœ¨ç¨‹åºæ­£å¸¸è¿è¡ŒæœŸé—´ä¸ä¼šé‡åˆ°æ­¤é—®é¢˜ï¼Œä»…å½“å¼•å‘å¼‚å¸¸ï¼ˆä¼´éšç€æœªå®šä¹‰çš„è¡Œä¸ºæˆ–ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ï¼‰æ—¶æ‰ä¼šå‡ºç°æ­¤é—®é¢˜ã€‚ <br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <font color="#339900">#include &lt;thread&gt;</font> <br> <font color="#339900">#include &lt;mutex&gt;</font> <br> <br> std <font color="#008080">::</font> <font color="#007788">mutex</font> mu <font color="#008080">;</font> <br> <br> <font color="#0000ff">static</font> <font color="#0000ff">int</font> counter <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <br> <font color="#0000ff">void</font> StartThruster <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000ff">try</font> <br> <font color="#008000">{</font> <br> <font color="#666666">// - </font> <br> <font color="#008000">}</font> <br> <font color="#0000ff">catch</font> <font color="#008000">(</font> ... <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">lock_guard</font> <font color="#000080">&lt;</font> std <font color="#008080">::</font> <font color="#007788">mutex</font> <font color="#000080">&gt;</font> lock <font color="#008000">(</font> mu <font color="#008000">)</font> <font color="#008080">;</font> <br> std <font color="#008080">::</font> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Launching rocket"</font> <font color="#000080">&lt;&lt;</font> std <font color="#008080">::</font> <font color="#007788">endl</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">void</font> LaunchRocket <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">lock_guard</font> <font color="#000080">&lt;</font> std <font color="#008080">::</font> <font color="#007788">mutex</font> <font color="#000080">&gt;</font> lock <font color="#008000">(</font> mu <font color="#008000">)</font> <font color="#008080">;</font> <br> counter <font color="#000040">++</font> <font color="#008080">;</font> <br> StartThruster <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">thread</font> t1 <font color="#008000">(</font> LaunchRocket <font color="#008000">)</font> <font color="#008080">;</font> <br> t1. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br> è‹¥è¦è§£å†³æ­¤é—®é¢˜ï¼Œæ‚¨å¿…é¡»ä»¥é˜²æ­¢é‡æ–°æ£€ç´¢ä»¥å‰æ”¶åˆ°çš„é”çš„æ–¹å¼æ›´æ­£ä»£ç ã€‚ æ‚¨å¯ä»¥å°†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">std :: recursive_mutex</a>ç”¨ä½œæ‹æ–è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯è¿™æ ·çš„è§£å†³æ–¹æ¡ˆå‡ ä¹æ€»æ˜¯è¡¨æ˜ç¨‹åºçš„ä½“ç³»ç»“æ„ä¸ä½³ã€‚ <br><br><h3> é”™è¯¯10ï¼šåœ¨std ::åŸå­ç±»å‹è¶³å¤Ÿæ—¶ä½¿ç”¨äº’æ–¥ </h3><br><br> å½“æ‚¨éœ€è¦æ›´æ”¹ç®€å•æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚å¸ƒå°”å€¼æˆ–æ•´æ•°è®¡æ•°å™¨ï¼‰æ—¶ï¼Œä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">stdï¼šatomic</a>é€šå¸¸ä¼šæ¯”ä½¿ç”¨äº’æ–¥é”æä¾›æ›´å¥½çš„æ€§èƒ½ã€‚ <br><br> ä¾‹å¦‚ï¼Œä»£æ›¿ä½¿ç”¨ä»¥ä¸‹æ„é€ ï¼š <br><br> <code><font color="#0000ff">int</font> counter <font color="#008080">;</font> <br> ... <br> mu. <font color="#007788">lock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> counter <font color="#000040">++</font> <font color="#008080">;</font> <br> mu. <font color="#007788">unlock</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br></code> <br><br> æœ€å¥½å°†å˜é‡å£°æ˜ä¸º<i>std :: atomic</i> ï¼š <br><br> <code>std <font color="#008080">::</font> <font color="#007788">atomic</font> <font color="#000080">&lt;</font> <font color="#0000ff">int</font> <font color="#000080">&gt;</font> counter <font color="#008080">;</font> <br> ... <br> <font color="#007788">counter</font> <font color="#000040">++</font> <font color="#008080">;</font></code> <br> <br> æœ‰å…³äº’æ–¥é”å’ŒåŸå­é”çš„è¯¦ç»†æ¯”è¾ƒï¼Œè¯·å‚é˜…ã€Š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¯”è¾ƒï¼šC ++ 11ä¸C ++ä¸­çš„</a>åŸå­æ— <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é”ç¼–ç¨‹ã€‹ã€‚</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äº’æ–¥é”å’Œè¯»å†™é”Â»</a> <br><br><h3> é”™è¯¯11ï¼šç›´æ¥åˆ›å»ºå’Œé”€æ¯å¤§é‡çº¿ç¨‹ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç©ºé—²çº¿ç¨‹æ±  </h3><br> å°±å¤„ç†å™¨æ—¶é—´è€Œè¨€ï¼Œåˆ›å»ºå’Œé”€æ¯çº¿ç¨‹æ˜¯ä¸€é¡¹æ˜‚è´µçš„æ“ä½œã€‚ æƒ³è±¡ä¸€ä¸‹åœ¨ç³»ç»Ÿæ‰§è¡Œè®¡ç®—å¯†é›†å‹æ“ä½œï¼ˆä¾‹å¦‚æ¸²æŸ“å›¾å½¢æˆ–è®¡ç®—æ¸¸æˆç‰©ç†ï¼‰æ—¶åˆ›å»ºæµçš„å°è¯•ã€‚ é€šå¸¸ç”¨äºæ­¤ç±»ä»»åŠ¡çš„æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªé¢„åˆ†é…çº¿ç¨‹æ± ï¼Œè¯¥æ± å¯ä»¥å¤„ç†ä¾‹è¡Œä»»åŠ¡ï¼Œä¾‹å¦‚åœ¨æ•´ä¸ªè¿‡ç¨‹çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å†™å…¥ç£ç›˜æˆ–é€šè¿‡ç½‘ç»œå‘é€æ•°æ®ã€‚ <br><br> ä¸æ‚¨è‡ªå·±ç”Ÿæˆå’Œé”€æ¯çº¿ç¨‹ç›¸æ¯”ï¼Œçº¿ç¨‹æ± çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯æ‚¨ä¸å¿…æ‹…å¿ƒ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çº¿ç¨‹è¶…é¢è®¢è´­</a> ï¼ˆè¿™ç§æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ•°è¶…è¿‡äº†å¯ç”¨æ ¸å¿ƒæ•°ï¼Œå¹¶ä¸”å¤„ç†å™¨çš„å¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨åˆ‡æ¢ä¸Šä¸‹æ–‡ä¸Š[å¤§çº¦ã€‚ç¿»è¯‘]]ã€‚ è¿™å¯èƒ½ä¼šå½±å“ç³»ç»Ÿæ€§èƒ½ã€‚ <br><br> å¦å¤–ï¼Œæ± çš„ä½¿ç”¨ä½¿æˆ‘ä»¬å…äºç®¡ç†çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçš„çƒ¦æ¼ï¼Œæœ€ç»ˆä½¿å®ƒè½¬åŒ–ä¸ºå…·æœ‰æ›´å°‘é”™è¯¯çš„æ›´ç´§å‡‘ä»£ç ã€‚ <br><br> å®ç°çº¿ç¨‹æ± çš„ä¸¤ä¸ªæœ€å—æ¬¢è¿çš„åº“æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Intelçº¿ç¨‹æ„å»ºå—ï¼ˆTBBï¼‰</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Microsoftå¹¶è¡Œæ¨¡å¼åº“ï¼ˆPPLï¼‰</a> ã€‚ <br><br><h3> é”™è¯¯ç¼–å·12ï¼šä¸å¤„ç†åå°çº¿ç¨‹ä¸­å‘ç”Ÿçš„å¼‚å¸¸ </h3><br> åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å¼•å‘çš„å¼‚å¸¸æ— æ³•åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­å¤„ç†ã€‚ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¼•å‘å¼‚å¸¸çš„å‡½æ•°ã€‚ å¦‚æœæˆ‘ä»¬åœ¨ä¸æ‰§è¡Œä¸»çº¿ç¨‹åˆ†å¼€çš„å•ç‹¬çº¿ç¨‹ä¸­æ‰§è¡Œæ­¤å‡½æ•°ï¼Œå¹¶ä¸”æœŸæœ›æˆ‘ä»¬å°†æ•è·ä»é™„åŠ çº¿ç¨‹æŠ›å‡ºçš„ä»»ä½•å¼‚å¸¸ï¼Œé‚£ä¹ˆå®ƒå°†æ— æ³•æ­£å¸¸å·¥ä½œã€‚ è€ƒè™‘ä¸€ä¸ªä¾‹å­ï¼š <br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include&lt;iostream&gt;</font> <br> <font color="#339900">#include&lt;thread&gt;</font> <br> <font color="#339900">#include&lt;exception&gt;</font> <br> <font color="#339900">#include&lt;stdexcept&gt;</font> <br> <br> <font color="#0000ff">static</font> std <font color="#008080">::</font> <font color="#007788">exception_ptr</font> teptr <font color="#000080">=</font> <font color="#0000ff">nullptr</font> <font color="#008080">;</font> <br> <br> <font color="#0000ff">void</font> LaunchRocket <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000ff">throw</font> std <font color="#008080">::</font> <font color="#007788">runtime_error</font> <font color="#008000">(</font> <font color="#FF0000">"Catch me in MAIN"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000ff">try</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">thread</font> t1 <font color="#008000">(</font> LaunchRocket <font color="#008000">)</font> <font color="#008080">;</font> <br> t1. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <font color="#0000ff">catch</font> <font color="#008000">(</font> <font color="#0000ff">const</font> std <font color="#008080">::</font> <font color="#007788">exception</font> <font color="#000040">&amp;</font> ex <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Thread exited with exception: "</font> <font color="#000080">&lt;&lt;</font> ex. <font color="#007788">what</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" <font color="#000099">\n</font> "</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br> å½“æ‰§è¡Œæ­¤ç¨‹åºæ—¶ï¼Œå®ƒå°†å´©æºƒï¼Œä½†æ˜¯ï¼Œmainï¼ˆï¼‰å‡½æ•°ä¸­çš„catchå—å°†ä¸æ‰§è¡Œï¼Œå¹¶ä¸”å°†æ— æ³•å¤„ç†çº¿ç¨‹t1ä¸­å¼•å‘çš„å¼‚å¸¸ã€‚ <br><br> è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³•æ˜¯ä½¿ç”¨C ++ 11ä¸­çš„åŠŸèƒ½ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">std :: exception_ptr</a>ç”¨äºå¤„ç†åœ¨åå°çº¿ç¨‹ä¸­å¼•å‘çš„å¼‚å¸¸ã€‚ è¿™æ˜¯æ‚¨éœ€è¦é‡‡å–çš„æ­¥éª¤ï¼š <br><br><ul><li> åˆ›å»º<i>std :: exception_ptr</i>ç±»çš„å…¨å±€å®ä¾‹ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸º<i>nullptr</i> </li><li> åœ¨è¿è¡Œäºå•ç‹¬çº¿ç¨‹ä¸­çš„å‡½æ•°ä¸­ï¼Œå¤„ç†æ‰€æœ‰å¼‚å¸¸å¹¶è®¾ç½®ä¸Šä¸€æ­¥ä¸­å£°æ˜<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„</a>å…¨å±€å˜é‡<i>std :: exception_ptr</i>çš„å€¼<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">std :: current_exceptionï¼ˆï¼‰</a> </li><li> æ£€æŸ¥ä¸»çº¿ç¨‹ä¸­çš„å…¨å±€å˜é‡çš„å€¼ </li><li> å¦‚æœè®¾ç½®äº†è¯¥å€¼ï¼Œè¯·ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">std :: rethrow_exceptionï¼ˆexception_ptr pï¼‰</a>å‡½æ•°é‡å¤è°ƒç”¨å…ˆå‰æ•è·çš„å¼‚å¸¸ï¼Œå¹¶å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¼•ç”¨ </li></ul><br> é€šè¿‡å¼•ç”¨è°ƒç”¨å¼‚å¸¸ä¸ä¼šåœ¨åˆ›å»ºå®ƒçš„çº¿ç¨‹ä¸­å‘ç”Ÿï¼Œå› æ­¤æ­¤åŠŸèƒ½éå¸¸é€‚åˆå¤„ç†ä¸åŒçº¿ç¨‹ä¸­çš„å¼‚å¸¸ã€‚ <br><br> åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæ‚¨å¯ä»¥å®‰å…¨åœ°å¤„ç†åœ¨åå°çº¿ç¨‹ä¸­å¼•å‘çš„å¼‚å¸¸ã€‚ <br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include&lt;iostream&gt;</font> <br> <font color="#339900">#include&lt;thread&gt;</font> <br> <font color="#339900">#include&lt;exception&gt;</font> <br> <font color="#339900">#include&lt;stdexcept&gt;</font> <br> <br> <font color="#0000ff">static</font> std <font color="#008080">::</font> <font color="#007788">exception_ptr</font> globalExceptionPtr <font color="#000080">=</font> <font color="#0000ff">nullptr</font> <font color="#008080">;</font> <br> <br> <font color="#0000ff">void</font> LaunchRocket <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000ff">try</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">this_thread</font> <font color="#008080">::</font> <font color="#007788">sleep_for</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">chrono</font> <font color="#008080">::</font> <font color="#007788">milliseconds</font> <font color="#008000">(</font> <font color="#0000dd">100</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#0000ff">throw</font> std <font color="#008080">::</font> <font color="#007788">runtime_error</font> <font color="#008000">(</font> <font color="#FF0000">"Catch me in MAIN"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <font color="#0000ff">catch</font> <font color="#008000">(</font> ... <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#666666">//     </font> <br> globalExceptionPtr <font color="#000080">=</font> std <font color="#008080">::</font> <font color="#007788">current_exception</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">thread</font> t1 <font color="#008000">(</font> LaunchRocket <font color="#008000">)</font> <font color="#008080">;</font> <br> t1. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#0000ff">if</font> <font color="#008000">(</font> globalExceptionPtr <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000ff">try</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">rethrow_exception</font> <font color="#008000">(</font> globalExceptionPtr <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <font color="#0000ff">catch</font> <font color="#008000">(</font> <font color="#0000ff">const</font> std <font color="#008080">::</font> <font color="#007788">exception</font> <font color="#000040">&amp;</font> ex <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Thread exited with exception: "</font> <font color="#000080">&lt;&lt;</font> ex. <font color="#007788">what</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">" <font color="#000099">\n</font> "</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br><h3> é”™è¯¯13ï¼šä½¿ç”¨çº¿ç¨‹æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œï¼Œè€Œä¸æ˜¯ä½¿ç”¨std :: async </h3><br> å¦‚æœæ‚¨éœ€è¦ä»£ç ä»¥å¼‚æ­¥æ–¹å¼æ‰§è¡Œï¼Œå³ åœ¨ä¸é˜»å¡æ‰§è¡Œä¸»çº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œæœ€å¥½çš„é€‰æ‹©æ˜¯ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">std :: asyncï¼ˆï¼‰</a> ã€‚ è¿™ç­‰æ•ˆäºåˆ›å»ºæµå¹¶é€šè¿‡æŒ‡å‘lambdaå‡½æ•°å½¢å¼çš„å‡½æ•°æˆ–å‚æ•°çš„æŒ‡é’ˆä¼ é€’åœ¨è¯¥æµä¸­æ‰§è¡Œçš„å¿…è¦ä»£ç ã€‚ ä½†æ˜¯ï¼Œåœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦ç›‘è§†æ­¤çº¿ç¨‹çš„åˆ›å»ºï¼Œè¿æ¥/åˆ†ç¦»ä»¥åŠå¯¹è¯¥çº¿ç¨‹ä¸­å¯èƒ½å‘ç”Ÿçš„æ‰€æœ‰å¼‚å¸¸çš„å¤„ç†ã€‚ å¦‚æœä½¿ç”¨<i>std :: asyncï¼ˆï¼‰</i> ï¼Œåˆ™å¯ä»¥å‡è½»è¿™äº›é—®é¢˜çš„è´Ÿæ‹…ï¼Œå¹¶å¤§å¤§å‡å°‘<i>é™·å…¥åƒµå±€çš„</i>æœºä¼šã€‚ <br><br> ä½¿ç”¨<i>std :: asyncçš„</i>å¦ä¸€ä¸ªé‡è¦ä¼˜ç‚¹æ˜¯èƒ½å¤Ÿä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">std :: future</a>å¯¹è±¡å°†å¼‚æ­¥æ“ä½œçš„ç»“æœè¿”å›ç»™è°ƒç”¨çº¿ç¨‹ã€‚ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª<i>ConjureMagicï¼ˆï¼‰</i>å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªintå€¼ã€‚ æˆ‘ä»¬å¯ä»¥å¯åŠ¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œè¯¥å¼‚æ­¥æ“ä½œå°†åœ¨ä»»åŠ¡å®Œæˆæ—¶å°†å°†æ¥çš„å€¼è®¾ç½®ä¸º<i>å°†æ¥çš„</i>å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥åœ¨è°ƒç”¨è¯¥æ“ä½œçš„æ‰§è¡Œæµä¸­ä»è¯¥å¯¹è±¡ä¸­æå–æ‰§è¡Œç»“æœã€‚ <br><br> <code><font color="#666666">//        future</font> <br> std <font color="#008080">::</font> <font color="#007788">future</font> asyncResult2 <font color="#000080">=</font> std <font color="#008080">::</font> <font color="#007788">async</font> <font color="#008000">(</font> <font color="#000040">&amp;</font> ConjureMagic <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#666666">//...  -   future   </font> <br> <br> <font color="#666666">//     future</font> <br> <font color="#0000ff">int</font> v <font color="#000080">=</font> asyncResult2. <font color="#007788">get</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font></code> <br> <br> å°†ç»“æœä»æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹è¿”å›ç»™è°ƒç”¨è€…æ¯”è¾ƒéº»çƒ¦ã€‚ ä¸¤ç§æ–¹æ³•æ˜¯å¯èƒ½çš„ï¼š <br><br><ol><li> å°†å¯¹è¾“å‡ºå˜é‡çš„å¼•ç”¨ä¼ é€’åˆ°å°†ä¿å­˜ç»“æœçš„æµä¸­ã€‚ </li><li> å°†ç»“æœå­˜å‚¨åœ¨å·¥ä½œæµå¯¹è±¡çš„å­—æ®µå˜é‡ä¸­ï¼Œçº¿ç¨‹å®Œæˆæ‰§è¡Œåå³å¯è¯»å–ã€‚ </li></ol><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kurt Guntheroth</a>å‘ç°ï¼Œå°±æ€§èƒ½è€Œè¨€ï¼Œåˆ›å»ºæµçš„å¼€é”€æ˜¯ä½¿ç”¨<i>async</i>çš„å¼€é”€çš„14å€ã€‚ <br><br> åº•çº¿ï¼šé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨<i>std :: asyncï¼ˆï¼‰</i> ï¼Œç›´åˆ°æ‰¾åˆ°æœ‰åˆ©äºç›´æ¥ä½¿ç”¨<i>std :: threadçš„</i>å¼ºå¤§å‚æ•°ä¸ºæ­¢ã€‚ <br><br><h3> é”™è¯¯ç¼–å·14ï¼šå¦‚æœéœ€è¦å¼‚æ­¥ï¼Œè¯·ä¸è¦ä½¿ç”¨std :: launch :: async </h3><br>  <i>std :: asyncï¼ˆï¼‰</i>å‡½æ•°çš„åç§°ä¸å¤ªæ­£ç¡®ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹å®ƒå¯èƒ½ä¸ä¼šå¼‚æ­¥è¿è¡Œï¼ <br><br> æœ‰ä¸¤ç§<i>std :: async</i>è¿è¡Œæ—¶ç­–ç•¥ï¼š <br><br><ol><li>  <i>std :: launch :: async</i> ï¼šä¼ é€’çš„å‡½æ•°å¼€å§‹åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­ç«‹å³æ‰§è¡Œ </li><li>  <i>std :: launch :: deferred</i> ï¼šä¼ é€’çš„å‡½æ•°ä¸ä¼šç«‹å³å¯åŠ¨ï¼Œåœ¨å¯¹<i>std :: future</i>å¯¹è±¡è¿›è¡Œ<i>getï¼ˆï¼‰</i>æˆ–<i>waitï¼ˆï¼‰</i>è°ƒç”¨ä¹‹å‰ï¼Œå®ƒçš„å¯åŠ¨ä¼šå»¶è¿Ÿï¼Œè¿™å°†ä»<i>std :: async</i>è°ƒç”¨è¿”å›ã€‚ ä»£æ›¿è°ƒç”¨è¿™äº›æ–¹æ³•ï¼Œè¯¥å‡½æ•°å°†åŒæ­¥æ‰§è¡Œã€‚ </li></ol><br> å½“æˆ‘ä»¬ä½¿ç”¨é»˜è®¤å‚æ•°è°ƒç”¨<i>std :: asyncï¼ˆï¼‰</i>æ—¶ï¼Œå®ƒä»¥è¿™ä¸¤ä¸ªå‚æ•°çš„ç»„åˆå¼€å¤´ï¼Œå®é™…ä¸Šä¼šå¯¼è‡´ä¸å¯é¢„æµ‹çš„è¡Œä¸ºã€‚ ä½¿ç”¨<i>std</i>è¿˜å­˜åœ¨è®¸å¤šå…¶ä»–å›°éš¾<i>ï¼š</i>é»˜è®¤å¯åŠ¨ç­–ç•¥ä½¿ç”¨<i>asyncï¼ˆï¼‰</i> ï¼š <br><br><ul><li> æ— æ³•é¢„æµ‹å¯¹å±€éƒ¨æµé‡å˜é‡çš„æ­£ç¡®è®¿é—® </li><li> ç”±äºåœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´å¯èƒ½ä¸ä¼šè°ƒç”¨<i>getï¼ˆï¼‰</i>å’Œ<i>waitï¼ˆï¼‰</i>æ–¹æ³•ï¼Œå› æ­¤å¼‚æ­¥ä»»åŠ¡å¯èƒ½æ ¹æœ¬ä¸ä¼šå¯åŠ¨ </li><li> å½“åœ¨é€€å‡ºæ¡ä»¶æœŸæœ›std :: futureå¯¹è±¡å‡†å¤‡å°±ç»ªçš„å¾ªç¯ä¸­ä½¿ç”¨æ—¶ï¼Œè¿™äº›å¾ªç¯å¯èƒ½æ°¸è¿œä¸ä¼šç»“æŸï¼Œå› ä¸ºè°ƒç”¨std :: asyncè¿”å›çš„std :: futureå¯èƒ½å¼€å§‹äºå»¶è¿ŸçŠ¶æ€ã€‚ </li></ul><br> ä¸ºé¿å…æ‰€æœ‰è¿™äº›å›°éš¾ï¼Œè¯·<b>å§‹ç»ˆ</b>ä½¿ç”¨<i>std :: launch :: asyncå¯åŠ¨</i>ç­–ç•¥è°ƒç”¨<i>std :: async</i> ã€‚ <br><br> ä¸è¦è¿™æ ·åšï¼š <br><br> <code><font color="#666666">//  myFunction  std::async     </font> <br> <font color="#0000ff">auto</font> myFuture <font color="#000080">=</font> std <font color="#008080">::</font> <font color="#007788">async</font> <font color="#008000">(</font> myFunction <font color="#008000">)</font> <font color="#008080">;</font></code> <br> <br> ç›¸åï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š <br><br> <code><font color="#666666">//  myFunction </font> <br> <font color="#0000ff">auto</font> myFuture <font color="#000080">=</font> std <font color="#008080">::</font> <font color="#007788">async</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">launch</font> <font color="#008080">::</font> <font color="#007788">async</font> , myFunction <font color="#008000">)</font> <font color="#008080">;</font></code> <br> <br>  Scott Meyersåœ¨ä¹¦ä¸­â€œ Effective and Modern C ++â€å¯¹è¿™ä¸€ç‚¹è¿›è¡Œäº†æ›´è¯¦ç»†çš„è€ƒè™‘ã€‚ <br><br><h3> é”™è¯¯15ï¼šåœ¨æ‰§è¡Œæ—¶é—´å¾ˆå…³é”®çš„ä»£ç å—ä¸­è°ƒç”¨std :: futureå¯¹è±¡çš„getï¼ˆï¼‰æ–¹æ³• </h3><br> ä¸‹é¢çš„ä»£ç å¤„ç†ä»å¼‚æ­¥æ“ä½œçš„<i>std :: future</i>å¯¹è±¡è·å¾—çš„ç»“æœã€‚ ä½†æ˜¯ï¼Œ <i>whileå¾ªç¯</i>å°†è¢«é”å®šï¼Œç›´åˆ°å¼‚æ­¥æ“ä½œå®Œæˆï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¸º10ç§’ï¼‰ã€‚ å¦‚æœè¦ä½¿ç”¨æ­¤å¾ªç¯åœ¨å±å¹•ä¸Šæ˜¾ç¤ºä¿¡æ¯ï¼Œåˆ™å¯èƒ½å¯¼è‡´æ¸²æŸ“ç”¨æˆ·ç•Œé¢æ—¶å‡ºç°ä»¤äººä¸å¿«çš„å»¶è¿Ÿã€‚ <br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;future&gt;</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">future</font> <font color="#000080">&lt;</font> <font color="#0000ff">int</font> <font color="#000080">&gt;</font> myFuture <font color="#000080">=</font> std <font color="#008080">::</font> <font color="#007788">async</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">launch</font> <font color="#008080">::</font> <font color="#007788">async</font> , <font color="#008000">[</font> <font color="#008000">]</font> <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">this_thread</font> <font color="#008080">::</font> <font color="#007788">sleep_for</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">chrono</font> <font color="#008080">::</font> <font color="#007788">seconds</font> <font color="#008000">(</font> <font color="#0000dd">10</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#0000ff">return</font> <font color="#0000dd">8</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#666666">//     </font> <br> <font color="#0000ff">while</font> <font color="#008000">(</font> <font color="#0000ff">true</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#666666">//     </font> <br> std <font color="#008080">::</font> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Rendering Data"</font> <font color="#000080">&lt;&lt;</font> std <font color="#008080">::</font> <font color="#007788">endl</font> <font color="#008080">;</font> <br> <font color="#0000ff">int</font> val <font color="#000080">=</font> myFuture. <font color="#007788">get</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <font color="#666666">//    10 </font> <br> <font color="#666666">//  -   Val</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br>  <b>æ³¨æ„</b> ï¼šä¸Šé¢ä»£ç çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå®ƒå°è¯•ç¬¬äºŒæ¬¡è®¿é—®<i>std :: future</i>å¯¹è±¡ï¼Œå°½ç®¡<i>std :: future</i>å¯¹è±¡çš„çŠ¶æ€æ˜¯åœ¨å¾ªç¯çš„ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­è·å–çš„ï¼Œä½†æ— æ³•è·å–ã€‚ <br><br> æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨è°ƒç”¨<i>getï¼ˆï¼‰</i>æ–¹æ³•ä¹‹å‰æ£€æŸ¥<i>std :: future</i>å¯¹è±¡çš„æœ‰æ•ˆæ€§ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬ä¸ä¼šé˜»æ­¢å¼‚æ­¥ä»»åŠ¡çš„å®Œæˆï¼Œä¹Ÿä¸ä¼šå°è¯•è¯¢é—®å·²ç»æå–çš„<i>std :: future</i>å¯¹è±¡ã€‚ <br><br> æ­¤ä»£ç æ®µå¯å®ç°ä»¥ä¸‹ç›®çš„ï¼š <br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;future&gt;</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">future</font> <font color="#000080">&lt;</font> <font color="#0000ff">int</font> <font color="#000080">&gt;</font> myFuture <font color="#000080">=</font> std <font color="#008080">::</font> <font color="#007788">async</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">launch</font> <font color="#008080">::</font> <font color="#007788">async</font> , <font color="#008000">[</font> <font color="#008000">]</font> <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">this_thread</font> <font color="#008080">::</font> <font color="#007788">sleep_for</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">chrono</font> <font color="#008080">::</font> <font color="#007788">seconds</font> <font color="#008000">(</font> <font color="#0000dd">10</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#0000ff">return</font> <font color="#0000dd">8</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#666666">//     </font> <br> <font color="#0000ff">while</font> <font color="#008000">(</font> <font color="#0000ff">true</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#666666">//     </font> <br> std <font color="#008080">::</font> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Rendering Data"</font> <font color="#000080">&lt;&lt;</font> std <font color="#008080">::</font> <font color="#007788">endl</font> <font color="#008080">;</font> <br> <br> <font color="#0000ff">if</font> <font color="#008000">(</font> myFuture. <font color="#007788">valid</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000ff">int</font> val <font color="#000080">=</font> myFuture. <font color="#007788">get</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <font color="#666666">//    10 </font> <br> <br> <font color="#666666">//   -   Val</font> <br> <font color="#008000">}</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br><h3>  â„–16:  ,  ,    ,        std::future::get() </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹ä»£ç ç‰‡æ®µï¼Œæ‚¨è®¤ä¸ºè°ƒç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: future :: getï¼ˆï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„ç»“æœæ˜¯</font><font style="vertical-align: inherit;">ä»€ä¹ˆï¼Ÿ</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨è®¤ä¸ºç¨‹åºå°†å´©æºƒ-ç»å¯¹æ­£ç¡®ï¼</font><font style="vertical-align: inherit;">ä»…å½“</font><font style="vertical-align: inherit;">åœ¨</font><i><font style="vertical-align: inherit;">std :: futureå¯¹è±¡</font></i><font style="vertical-align: inherit;">ä¸Š</font><font style="vertical-align: inherit;">è°ƒç”¨</font><i><font style="vertical-align: inherit;">getï¼ˆï¼‰</font></i><font style="vertical-align: inherit;">æ–¹æ³•æ—¶ï¼Œæ‰ä¼šå¼•å‘å¼‚æ­¥æ“ä½œä¸­å¼•å‘çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚å¦‚æœ</font><font style="vertical-align: inherit;">æœªè°ƒç”¨</font><i><font style="vertical-align: inherit;">getï¼ˆï¼‰</font></i><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">ï¼Œåˆ™å½“</font><i><font style="vertical-align: inherit;">std :: future</font></i><font style="vertical-align: inherit;">å¯¹è±¡è¶…å‡ºèŒƒå›´</font><font style="vertical-align: inherit;">æ—¶ï¼Œå°†å¿½ç•¥å¹¶å¼•å‘å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨çš„å¼‚æ­¥æ“ä½œå¯èƒ½å¼•å‘å¼‚å¸¸ï¼Œåˆ™åº”å§‹ç»ˆå°†å¯¹</font><i><font style="vertical-align: inherit;">std :: future :: getï¼ˆï¼‰</font></i><font style="vertical-align: inherit;">çš„è°ƒç”¨åŒ…è£…</font><font style="vertical-align: inherit;">åœ¨</font><i><font style="vertical-align: inherit;">try / catch</font></i><font style="vertical-align: inherit;">å—ä¸­ã€‚æœ‰å…³æ­¤ç¤ºä¾‹çš„ç¤ºä¾‹ï¼š</font></font><br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;future&gt;</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">future</font> <font color="#000080">&lt;</font> <font color="#0000ff">int</font> <font color="#000080">&gt;</font> myFuture <font color="#000080">=</font> std <font color="#008080">::</font> <font color="#007788">async</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">launch</font> <font color="#008080">::</font> <font color="#007788">async</font> , <font color="#008000">[</font> <font color="#008000">]</font> <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000ff">throw</font> std <font color="#008080">::</font> <font color="#007788">runtime_error</font> <font color="#008000">(</font> <font color="#FF0000">"Catch me in MAIN"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#0000ff">return</font> <font color="#0000dd">8</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#0000ff">if</font> <font color="#008000">(</font> myFuture. <font color="#007788">valid</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000ff">int</font> result <font color="#000080">=</font> myFuture. <font color="#007788">get</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;future&gt;</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#007788">future</font> <font color="#000080">&lt;</font> <font color="#0000ff">int</font> <font color="#000080">&gt;</font> myFuture <font color="#000080">=</font> std <font color="#008080">::</font> <font color="#007788">async</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">launch</font> <font color="#008080">::</font> <font color="#007788">async</font> , <font color="#008000">[</font> <font color="#008000">]</font> <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000ff">throw</font> std <font color="#008080">::</font> <font color="#007788">runtime_error</font> <font color="#008000">(</font> <font color="#FF0000">"Catch me in MAIN"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#0000ff">return</font> <font color="#0000dd">8</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#0000ff">if</font> <font color="#008000">(</font> myFuture. <font color="#007788">valid</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000ff">try</font> <br> <font color="#008000">{</font> <br> <font color="#0000ff">int</font> result <font color="#000080">=</font> myFuture. <font color="#007788">get</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <font color="#0000ff">catch</font> <font color="#008000">(</font> <font color="#0000ff">const</font> std <font color="#008080">::</font> <font color="#007788">runtime_error</font> <font color="#000040">&amp;</font> e <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> std <font color="#008080">::</font> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Async task threw exception: "</font> <font color="#000080">&lt;&lt;</font> e. <font color="#007788">what</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#000080">&lt;&lt;</font> std <font color="#008080">::</font> <font color="#007788">endl</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <font color="#008000">}</font> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br><h3>  â„–17:  std::async,        </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°½ç®¡</font><font style="vertical-align: inherit;">åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: asyncï¼ˆï¼‰å°±</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¶³å¤Ÿäº†ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½éœ€è¦ä»”ç»†æ§åˆ¶æµä¸­ä»£ç çš„æ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è¦å°†ç‰¹å®šçº¿ç¨‹ç»‘å®šåˆ°å¤šå¤„ç†å™¨ç³»ç»Ÿï¼ˆä¾‹å¦‚Xboxï¼‰ä¸­çš„ç‰¹å®šå¤„ç†å™¨æ ¸å¿ƒã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»™å®šçš„ä»£ç ç‰‡æ®µå»ºç«‹äº†çº¿ç¨‹ä¸ç³»ç»Ÿä¸­ç¬¬5ä¸ªå¤„ç†å™¨å†…æ ¸çš„ç»‘å®šã€‚</font><font style="vertical-align: inherit;">è¿™è¦å½’åŠŸäº</font><i><font style="vertical-align: inherit;">std :: thread</font></i><font style="vertical-align: inherit;">å¯¹è±¡</font><font style="vertical-align: inherit;">çš„</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">native_handleï¼ˆï¼‰</font></a><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Win32 API</font></a><font style="vertical-align: inherit;">æµå‡½æ•°</font><font style="vertical-align: inherit;">ã€‚é€šè¿‡æµWin32 APIæä¾›çš„è®¸å¤šå…¶ä»–åŠŸèƒ½åœ¨</font><i><font style="vertical-align: inherit;">std :: thread</font></i><font style="vertical-align: inherit;">æˆ–</font><i><font style="vertical-align: inherit;">std :: asyncï¼ˆï¼‰</font></i><font style="vertical-align: inherit;">ä¸­ä¸å¯ç”¨</font><font style="vertical-align: inherit;">ã€‚é€šè¿‡å·¥ä½œæ—¶</font></font><br><br> <code><font color="#339900">#include "stdafx.h"</font> <br> <font color="#339900">#include &lt;windows.h&gt;</font> <br> <font color="#339900">#include &lt;iostream&gt;</font> <br> <font color="#339900">#include &lt;thread&gt;</font> <br> <br> <font color="#0000ff">using</font> <font color="#0000ff">namespace</font> std <font color="#008080">;</font> <br> <br> <font color="#0000ff">void</font> LaunchRocket <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> <font color="#0000dd">cout</font> <font color="#000080">&lt;&lt;</font> <font color="#FF0000">"Launching Rocket"</font> <font color="#000080">&lt;&lt;</font> endl <font color="#008080">;</font> <br> <font color="#008000">}</font> <br> <br> <font color="#0000ff">int</font> main <font color="#008000">(</font> <font color="#008000">)</font> <br> <font color="#008000">{</font> <br> thread t1 <font color="#008000">(</font> LaunchRocket <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> DWORD result <font color="#000080">=</font> <font color="#008080">::</font> <font color="#007788">SetThreadIdealProcessor</font> <font color="#008000">(</font> t1. <font color="#007788">native_handle</font> <font color="#008000">(</font> <font color="#008000">)</font> , <font color="#0000dd">5</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> t1. <font color="#007788">join</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br> <br> <font color="#0000ff">return</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br> <font color="#008000">}</font> <br></code> <br><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: asyncï¼ˆï¼‰ï¼Œ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™äº›åŸºæœ¬å¹³å°åŠŸèƒ½ä¸å¯ç”¨ï¼Œè¿™ä½¿æ­¤æ–¹æ³•ä¸é€‚ç”¨äºæ›´å¤æ‚çš„ä»»åŠ¡ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦ä¸€ç§æ–¹æ³•æ˜¯åˆ›å»º</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: packaged_task</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œç„¶ååœ¨è®¾ç½®çº¿ç¨‹çš„å±æ€§åå°†å…¶ç§»åŠ¨åˆ°æ‰€éœ€çš„æ‰§è¡Œçº¿ç¨‹ã€‚</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é”™è¯¯ï¼ƒ18ï¼šåˆ›å»ºçš„â€œæ­£åœ¨è¿è¡Œâ€çš„çº¿ç¨‹æ¯”å¯ç”¨çš„å†…æ ¸å¤šå¾—å¤š </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»ä½“ç³»ç»“æ„çš„è§’åº¦æ¥çœ‹ï¼Œæµå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šâ€œæ­£åœ¨è¿è¡Œâ€å’Œâ€œæ­£åœ¨ç­‰å¾…â€ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å ç”¨äº†æ­£åœ¨è¿è¡Œçš„å†…æ ¸çš„å¤„ç†å™¨æ—¶é—´çš„100ï¼…ã€‚å½“ä¸€ä¸ªå†…æ ¸åˆ†é…å¤šä¸ªè¿è¡Œçº¿ç¨‹æ—¶ï¼ŒCPUåˆ©ç”¨ç‡é™ä½ã€‚å¦‚æœåœ¨ä¸€ä¸ªå¤„ç†å™¨å†…æ ¸ä¸Šæ‰§è¡Œå¤šä¸ªè¿è¡Œçº¿ç¨‹ï¼Œåˆ™ä¸ä¼šè·å¾—æ€§èƒ½æå‡-å®é™…ä¸Šï¼Œç”±äºé™„åŠ çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ€§èƒ½ä¼šä¸‹é™ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç­‰å¾…çº¿ç¨‹ä»…ä½¿ç”¨å‡ ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œåœ¨ç­‰å¾…ç³»ç»Ÿäº‹ä»¶æˆ–ç½‘ç»œI / Oç­‰æ—¶æ‰§è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå†…æ ¸çš„å¤§éƒ¨åˆ†å¯ç”¨å¤„ç†å™¨æ—¶é—´ä»æœªä½¿ç”¨ã€‚ä¸€ä¸ªç­‰å¾…çº¿ç¨‹å¯ä»¥å¤„ç†æ•°æ®ï¼Œè€Œå¦ä¸€ä¸ªç­‰å¾…çº¿ç¨‹æ­£åœ¨ç­‰å¾…äº‹ä»¶è§¦å‘ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå°†å¤šä¸ªç­‰å¾…çº¿ç¨‹åˆ†é…åˆ°ä¸€ä¸ªå†…æ ¸æ˜¯æœ‰åˆ©çš„ã€‚æ¯ä¸ªå†…æ ¸è°ƒåº¦å¤šä¸ªæœªå†³çº¿ç¨‹å¯ä»¥æä¾›æ›´é«˜çš„ç¨‹åºæ€§èƒ½ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‚£ä¹ˆï¼Œå¦‚ä½•ç†è§£ç³»ç»Ÿæ”¯æŒå¤šå°‘ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å‘¢ï¼Ÿä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: thread :: hardware_concurrencyï¼ˆï¼‰</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">ã€‚æ­¤å‡½æ•°é€šå¸¸è¿”å›å¤„ç†å™¨æ ¸å¿ƒçš„æ•°é‡ï¼Œä½†æ˜¯ç”±äºä»¥ä¸‹åŸå› ï¼Œå®ƒä¼šè€ƒè™‘å……å½“ä¸¤ä¸ªæˆ–å¤šä¸ªé€»è¾‘æ ¸å¿ƒçš„æ ¸å¿ƒï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¶…è¸©è¸</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨å¿…é¡»ä½¿ç”¨è·å¾—çš„ç›®æ ‡å¹³å°å€¼æ¥è®¡åˆ’ç¨‹åºåŒæ—¶è¿è¡Œçš„æœ€å¤§çº¿ç¨‹æ•°ã€‚æ‚¨è¿˜å¯ä»¥ä¸ºæ‰€æœ‰æŒ‚èµ·çš„çº¿ç¨‹åˆ†é…ä¸€ä¸ªæ ¸å¿ƒï¼Œå¹¶ä½¿ç”¨å‰©ä½™çš„æ ¸å¿ƒæ•°æ¥è¿è¡Œçº¿ç¨‹ã€‚ä¾‹å¦‚ï¼Œåœ¨å››æ ¸ç³»ç»Ÿä¸­ï¼Œå¯¹æ‰€æœ‰æŒ‚èµ·çš„çº¿ç¨‹ä½¿ç”¨ä¸€ä¸ªæ ¸ï¼Œå¯¹äºå…¶ä½™ä¸‰ä¸ªæ ¸ï¼Œä½¿ç”¨ä¸‰ä¸ªè¿è¡Œçº¿ç¨‹ã€‚æ ¹æ®çº¿ç¨‹è°ƒåº¦ç¨‹åºçš„æ•ˆç‡ï¼ŒæŸäº›å¯æ‰§è¡Œçº¿ç¨‹å¯èƒ½ä¼šåˆ‡æ¢ä¸Šä¸‹æ–‡ï¼ˆç”±äºé¡µé¢è®¿é—®å¤±è´¥ç­‰ï¼‰ï¼Œä»è€Œä½¿å†…æ ¸å¤„äºéæ´»åŠ¨çŠ¶æ€ä¸€æ®µæ—¶é—´ã€‚å¦‚æœåœ¨åˆ†æè¿‡ç¨‹ä¸­è§‚å¯Ÿåˆ°è¿™ç§æƒ…å†µï¼Œåˆ™åº”åˆ›å»ºæ¯”å†…æ ¸æ•°é‡ç¨å¤šçš„å·²æ‰§è¡Œçº¿ç¨‹ï¼Œå¹¶ä¸ºç³»ç»Ÿé…ç½®è¯¥å€¼ã€‚</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é”™è¯¯19ï¼šä½¿ç”¨volatileå…³é”®å­—è¿›è¡ŒåŒæ­¥ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æŒ‡å®šå˜é‡ç±»å‹ä¹‹å‰</font><font style="vertical-align: inherit;">ï¼Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">volatile</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…³é”®å­—</font><font style="vertical-align: inherit;">ä¸ä¼šä½¿å¯¹è¯¥å˜é‡è¿›è¡ŒåŸå­æˆ–çº¿ç¨‹å®‰å…¨çš„æ“ä½œã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯èƒ½æƒ³è¦çš„æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std :: atomic</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰å…³</font><font style="vertical-align: inherit;">æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œ</font><font style="vertical-align: inherit;">è¯·å‚è§å…³äº</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stackoverflow</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„è®¨è®º</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é”™è¯¯20ï¼šé™¤éç»å¯¹å¿…è¦ï¼Œå¦åˆ™è¯·ä½¿ç”¨æ— é”æ¶æ„ </font></font></h3><br>    -,    .  ,    (lock free),         ,   ,  ,   . . ,    C ++,    ,  ,             ,         (     ,       !). <br><br>     C ++    ,       ,         ,            10 . <br><br>          ,     : <br><br><ul><li>         ,       ?  ,  â€“  . </li><li>    ,         ?  ,      ? </li><li>          ? </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ€»ä¹‹ï¼Œå¯¹äºæ­£å¸¸çš„åº”ç”¨ç¨‹åºå¼€å‘ï¼Œè¯·ä»…åœ¨ç”¨å°½æ‰€æœ‰å…¶ä»–æ›¿ä»£æ–¹æ³•åæ‰è€ƒè™‘éé”å®šç¼–ç¨‹ã€‚</font><font style="vertical-align: inherit;">å¦ä¸€ç§çœ‹å¾…è¿™ç§æƒ…å†µçš„æ–¹å¼æ˜¯ï¼Œå¦‚æœæ‚¨ä»åœ¨çŠ¯ä¸Šè¿°19ä¸ªé”™è¯¯ä¸­çš„æŸäº›é”™è¯¯ï¼Œåˆ™å¯èƒ½åº”é¿å…ç¼–ç¨‹è€Œä¸ä¼šé˜»å¡ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ä»ã€‚</font><font style="vertical-align: inherit;">è¯‘è€…ï¼šéå¸¸æ„Ÿè°¢</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vovo4K</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¸®åŠ©</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link"><font style="vertical-align: inherit;">æˆ‘</font></a><font style="vertical-align: inherit;">å‡†å¤‡äº†æœ¬æ–‡ã€‚</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN443406/">https://habr.com/ru/post/zh-CN443406/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN443396/index.html">3Dæ‰“å°å’Œæ°”æªï¼šæˆ‘å¦‚ä½•æ‰“å°â€œé©±åŠ¨å™¨â€</a></li>
<li><a href="../zh-CN443398/index.html">åœ¨å·¥ä¸šä¼ä¸šä¸­å®æ–½ERPï¼šAlevtina Svetozarovnaå’ŒExcelåå¯¹è‹›åˆ»çš„å»ºç­‘å¸ˆå’Œè‹±è¯­å·¥å‚</a></li>
<li><a href="../zh-CN443400/index.html">è®¡ç®—Windowsè®¡ç®—å™¨ä¸­çš„é”™è¯¯</a></li>
<li><a href="../zh-CN443402/index.html">å¦‚ä½•ä½¿ä»£ç å®¡æŸ¥æ›´å¿«ï¼Œæ›´æœ‰æ•ˆ</a></li>
<li><a href="../zh-CN443404/index.html">NASAå¯»æ‰¾åœ°çƒå¤–æ–‡æ˜çš„æ–°ç›®æ ‡ï¼šæŠ€æœ¯æ ‡å¿—</a></li>
<li><a href="../zh-CN443408/index.html">å…‰å­ï¼Œé‡å­å’ŒFockçŠ¶æ€ï¼šåˆ©ç”¨å°„é¢‘è°æŒ¯å™¨è¿›è¡Œé‡å­çº§æ“çºµ</a></li>
<li><a href="../zh-CN443412/index.html">ä¸ºä»€ä¹ˆå°½ç®¡ç²¾ç®€çš„Pythonç¨‹åºå‘˜ä»ç»§ç»­ä½¿ç”¨å†—é•¿çš„Java</a></li>
<li><a href="../zh-CN443414/index.html">è·¯æ ‡ï¼šæ–­ç‚¹ä¸è¶³æ—¶</a></li>
<li><a href="../zh-CN443416/index.html">Winntiï¼šå¯¹ä¾›åº”é“¾çš„æ”»å‡»-äºšæ´²æ¸¸æˆå¼€å‘å•†å¤„åœ¨æœ€å‰æ²¿</a></li>
<li><a href="../zh-CN443418/index.html">è½¯ä»¶æµ‹è¯•æ–¹æ³•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>