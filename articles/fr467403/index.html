<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍸 🍽️ 👇🏻 Ce que vous pouvez et ne pouvez pas extraire des composants Web 😢 🖐️ 🆘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ce n'est pas un tutoriel ou un examen complet - plutôt des notes de sang chaud après avoir compilé une bibliothèque de composants. Tout a commencé ave...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ce que vous pouvez et ne pouvez pas extraire des composants Web</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467403/">  Ce n'est pas un tutoriel ou un examen complet - plutôt des notes de sang chaud après avoir compilé une bibliothèque de composants.  Tout a commencé avec l'histoire ordinaire de tous les jours: il y a un code hérité, vous devez attacher pipmochek et petits bâtons à l'héritage, vous ne pouvez rien réécrire, une fois, et ne touchez rien ici avec vos mains;  ne touchez pas les gros paquets effrayants au cas où, et en effet, pourquoi ne prenez-vous pas simplement le meilleur framework <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vanilla JS</a> et commencez à écrire dessus, comme vos grands-pères l'ont légué? <br><a name="habracut"></a><br>  Mais comme le volume de travail était prévu pour être très perceptible, pour une raison quelconque, personne n'a ressenti d'impulsion créative à l'idée de tout écrire en JS nu.  Nous sommes allés regarder les outils et en choisir ceux qui ne feraient pas peur aux consommateurs de nos composants à genoux tremblants. <br><br><h2>  Les outils </h2><br>  Bien que j'ai déjà gâché toute cette section, quelque chose doit être dit ici.  Premièrement, les composants Web sont immédiatement devenus absolument incontestés: lorsque le résultat de la créativité est une bibliothèque de composants, et que vous ne pouvez pas faire glisser un gros monstre à la Angular, qui se modularise complètement, alors ce qui reste, c'est que vous n'avez pas du tout besoin de faire glisser le code de la bibliothèque, et fonctionne "comme ça" dans les navigateurs modernes.  Les composants Web eux-mêmes sont toujours le même framework Vanilla JS incroyable, avec seulement quelques problèmes de modularité résolus.  Il reste encore trop à écrire de vos propres mains - vous avez besoin d'un wrapper avec standardisation, et il est également souhaitable qu'il y ait un minimum de passe-partout pour chaque composant. <br><br>  Il n'y a pas beaucoup de tels emballages, et même assez mûrs pour être utilisés dans une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">production</a> sérieuse: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">hybrides,</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">LitElement,</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Stencil.</a>  Et ils font tous la même chose à peu près de la même manière, la différence réside dans les petites choses.  Les hybrides essaient d'être à la mode et sans classe, Stencil est à la mode et réagit, LitElement ne semble même pas essayer.  Et selon les résultats du choix parmi des bagatelles insignifiantes, la sortie est restée LitElement - OOPshniki a tourné le nez aux hybrides et aux non-amateurs de la réaction - à Stencil, dans lequel JSX a généralement ressenti une répétition des idées les plus incontestables de la réaction. <br><br><h2>  Pour combattre? </h2><br>  Ce n'est pas si intéressant de parler de ce que vous pouvez, tout est dans la documentation, donc je vais continuer à parler principalement de ce que vous ne pouvez pas: ils n'écrivent généralement pas à ce sujet dans la documentation. <br><br><h3>  Patterns </h3><br>  En termes de modèles, LitElement utilise lit-html, ce qui est parfaitement minimaliste: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> template = html<span class="hljs-string"><span class="hljs-string">` &lt;div attr=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${a}</span></span></span><span class="hljs-string"> .property=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${b}</span></span></span><span class="hljs-string"> ?booleanAttr=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${c}</span></span></span><span class="hljs-string"> @click=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${handleClick}</span></span></span><span class="hljs-string"> &gt;&lt;/div&gt; `</span></span>;</code> </pre> <br>  Ce n'est pas du HTML, mais vous devez vous rappeler exactement trois constructions dans un seul symbole ici - ".", "?", Et "@".  Tout le reste est en html.  En ce qui concerne JSX, avec son className et le reste, il est un peu plus agréable et juridiquement distinct du code JS / TS.  Mais, en passant, le premier «impossible» suit d'ici - pour lier quelque chose d'horrible ne fonctionne pas, vous ne pouvez lier que dans les valeurs des attributs et des propriétés, et dans le contenu du texte.  Bien sûr, dans les littéraux de modèles étiquetés, il n'y a pas de magie, et au prix d'une certaine quantité de perversions, vous pouvez assembler une chaîne en cours d'exécution et y attacher des liants lit-html, mais cela pénètre réellement dans le rendu avec vos mains, et avec le même succès, vous pouvez collecter des lignes et les envoyer dans innerHTML.  Normalement, tout cela se fait par la composition des modèles et la décomposition des composants complexes en composants plus simples.  Le passe-partout est assez petit - la liaison du modèle est pratiquement absente, car il ne s'agit que d'une variable, et pour créer un composant, vous avez besoin de cinq lignes "supplémentaires". <br><br><h3>  Composants </h3><br>  Le seul problème (mais significatif) des composants est que, pour «mélanger» complètement les composants avec le rendu des enfants, quelque part dans le modèle du parent, vous avez besoin du Shadow DOM.  Qui, bien sûr, est inclus dans LitElement par défaut, et en général, il ne semble pas être mauvais.  Mais le DOM fantôme a actuellement un gros problème avec les styles, similaire aux modules CSS: pour isoler les styles, il isole parfaitement, mais en cours de route, cela réduit toute la cascade.  Il est tout simplement impossible d'entrer dans des styles isolés de l'extérieur.  Généralement (presque) rien. <br><br>  Cela interfère considérablement, par exemple, avec la possibilité de faire défiler les composants de différents sujets.  Tout ce qui peut être fait avec le DOM fantôme est soit de regrouper toutes les options de style à l'intérieur du composant, soit d'essayer de rendre le thème complètement dépendant des variables CSS - c'est le "presque" avec lequel vous pouvez contracter des styles isolés.  Mais avec lequel il est nécessaire de fournir des variables littéralement pour toute stylisation raisonnable, et, avec une forte probabilité, il en ajoute encore plus. <br><br>  Heureusement, le DOM fantôme dans LitElement peut simplement être désactivé dans le composant.  Malheureusement, cela désactivera également la possibilité de cibler les enfants de l'élément aux bons endroits du modèle via &lt;slot&gt;.  Heureusement, après avoir un peu perverti, vous pouvez obtenir à la fois le premier et le second: pour cela, il vous <i>suffit</i> de mettre une racine fantôme sur chaque emplacement nécessaire, et de ne rien y contenir sauf, en fait, &lt;slot&gt;.  Ainsi, la stylisation du composant sera ouverte et des fentes seront présentes.  Je voulais donner un bref exemple, mais malheureusement, le code de manipulation des emplacements ne fonctionne pas brièvement de toute façon - les personnes très intéressées peuvent lire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ce numéro ici.</a>  J'ai été inspiré par des idées de là-bas. <br><br>  Eh bien, il convient de mentionner que dans un avenir prévisible, le support du navigateur et les polyfills <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">:: part</a> et :: theme vont probablement disparaître, et avec eux, le DOM fantôme deviendra finalement la solution que tout le monde attend depuis de nombreuses années - de sorte qu'il soit isolé et extensible / mutable.  Mais jusqu'à présent, ce n'est toujours pas là. <br><br><h3>  Déployer </h3><br>  À ce stade, écrire sur «ce qui est impossible» ne sort plus, car tout peut aller plus loin - les bibliothèques éclairées existent sous la forme de modules ES, et donc sans aucun problème sont récupérées par n'importe quoi et de n'importe quelle manière (même avec un navigateur nu qui peut gérer les modules )  Pour IE et Edge actuel, vous devez connecter un polyfill de composants Web, pour les modules, si vous souhaitez les retirer directement du navigateur, vous avez besoin de quelque chose qui soulage la douleur des importations de navigateur, par exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">es-module-shims.</a>  Eh bien, ou un bundler. <br><br>  Les composants Web connectés à l'application sont simples et ringards à utiliser, vous pouvez commencer à les utiliser en html et à extraire leurs méthodes et propriétés dans le code.  Vous pouvez voir à quel point tout cela peut être attaché à une autre bibliothèque ou un autre cadre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> (la réaction a excellé, mais en moyenne tout est très bon).  Nous nous sommes accrochés à AngularJS, et tout était banal: ng-prop vous permet de transférer quelque chose vers le composant, et ng-on vous permet d'écouter les événements. <br><br><h2>  Résumé </h2><br>  Si vous devez créer une interface utilisateur de composant et l'attacher à quelque chose que vous ne voulez absolument pas entrer (code hérité, cadre effrayant démodé et autres mauvais endroits) - les composants Web aident très bien.  Les principales bibliothèques "matures" qui sont gérées avec elles sont de petite taille, il n'y a pas de problèmes techniques sérieux de modularité et de mise en page, et vous pouvez simplement les prendre et les faire.  Quel type de bibliothèque que vous prenez - même pas si important, il y a très peu de différences entre eux pour le moment;  Plus précisément, le LitElement que nous avons pris n'a pas créé de problème supplémentaire pour nous et a fonctionné de la manière attendue dans tous les cas. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467403/">https://habr.com/ru/post/fr467403/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467391/index.html">Yandex présente RPKI</a></li>
<li><a href="../fr467393/index.html">NX Bootcamp démarre en octobre</a></li>
<li><a href="../fr467395/index.html">Habr Weekly # 18 / Nouveaux gadgets Apple, un smartphone entièrement modulaire, le village des programmeurs en Biélorussie, le phénomène XY</a></li>
<li><a href="../fr467399/index.html">Vous ne pouvez pas interdire d'apporter: comment mettre en œuvre le concept BYOD et ne pas nuire à la sécurité des informations</a></li>
<li><a href="../fr467401/index.html">Comparaison de Tesla Model S et Porsche Taycan</a></li>
<li><a href="../fr467405/index.html">Lyft lance un concours de reconnaissance d'objets 3D</a></li>
<li><a href="../fr467407/index.html">Nous travaillons avec le cobot Dobot M1</a></li>
<li><a href="../fr467409/index.html">Pour faire des affaires dans la Silicon Valley, vous devez vous comporter</a></li>
<li><a href="../fr467413/index.html">Framework de microservice PHP - `Hello world` de Swoft</a></li>
<li><a href="../fr467415/index.html">Marché des changes moderne</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>