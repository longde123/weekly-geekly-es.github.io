<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìÄ üëêüèª ‚õπÔ∏è Teste de autentica√ß√£o de dois fatores e poss√≠veis solu√ß√µes alternativas üë∑üèº üòù üî∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Antes mesmo de come√ßar a compreender a complexa ci√™ncia da seguran√ßa da informa√ß√£o, parecia-me que a autentica√ß√£o 2FA √© uma maneira garantida de prote...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Teste de autentica√ß√£o de dois fatores e poss√≠veis solu√ß√µes alternativas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483134/"><img src="https://habrastorage.org/webt/g8/rq/pf/g8rqpf1rdulkehqbd2aromukw5q.png"><br><br>  Antes mesmo de come√ßar a compreender a complexa ci√™ncia da seguran√ßa da informa√ß√£o, parecia-me que a autentica√ß√£o 2FA √© uma maneira garantida de proteger sua conta e que nenhum desses hackers pode, por exemplo, retirar minha moeda interna para comprar roupas para os personagens da conta do jogo.  Por√©m, com o tempo, ficou provado experimentalmente que um sistema de autentica√ß√£o de dois fatores pode ter um grande n√∫mero de vulnerabilidades. <br><a name="habracut"></a><br>  Em palavras simples, a autentica√ß√£o de dois fatores √© uma confirma√ß√£o da a√ß√£o, digitando o c√≥digo gerado para aumentar a seguran√ßa e jogando paus nas rodas de hackers condicionais durante o movimento ou antes de iniciar. <br><br>  O sistema de confirma√ß√£o de c√≥digo √© muito difundido, √© usado em todos os lugares em v√°rios sites e pode ser conectado para logins prim√°rio e secund√°rio.  Mas o aplicativo n√£o se limita a isso - os desenvolvedores anexam uma confirma√ß√£o sobre a funcionalidade de recupera√ß√£o de senha, confirma√ß√£o de registro / assinatura, confirma√ß√£o adicional de transa√ß√µes financeiras, altera√ß√£o de senha e altera√ß√£o de dados pessoais.  Ocasionalmente, o 2FA √© usado como uma parede ap√≥s o logout para cronometrar, e n√£o como uma senha ou outra forma de confirma√ß√£o. <br><br>  Neste artigo, coletei maneiras de testar o 2FA quanto a vulnerabilidades, sua explora√ß√£o e tamb√©m as op√ß√µes poss√≠veis para contornar a prote√ß√£o existente contra certos tipos de ataques.  Vejamos a lista de verifica√ß√µes de vulnerabilidade que se aplicam ao 2FA: <br><br><h2>  1. Falta de limite de taxa </h2><br>  O algoritmo de limite de taxa √© usado para testar se uma sess√£o do usu√°rio (ou endere√ßo IP) pode ser limitada em tentativas ou velocidade e sob quais circunst√¢ncias isso acontece.  Se o usu√°rio tiver conclu√≠do muitas solicita√ß√µes dentro de um certo per√≠odo de tempo, o aplicativo Web poder√° responder com um c√≥digo 429 (muitas solicita√ß√µes) ou aplicar um limite de Taxa sem mostrar erros.  A aus√™ncia de um limite de taxa implica que, durante a enumera√ß√£o normal, n√£o h√° restri√ß√µes quanto ao n√∫mero de tentativas e / ou velocidade - √© permitido iterar sobre os c√≥digos v√°rias vezes (a qualquer velocidade) dentro do per√≠odo de validade da sess√£o / token. <br><br>  Muitas vezes, √© necess√°rio lidar com um limite de taxa "silencioso"; se voc√™ perceber que n√£o h√° erros e o corpo / c√≥digo HTTP n√£o mudar nas solicita√ß√µes subseq√ºentes, fique feliz cedo demais e primeiro verifique o resultado final do ataque usando c√≥digo v√°lido. <br><br><h2>  2. O limite da taxa existe, mas pode ser contornado </h2><br>  Casos que eu tive que conhecer antes: <br><br><h4>  1) Limitar a velocidade dos fluxos sem obstru√ß√£o ap√≥s atingir uma determinada velocidade </h4><br>  Muitas vezes, os pesquisadores de seguran√ßa tentam pegar o c√≥digo usando 5 ou mais threads para acelerar um ataque (no Burp Intruder, o n√∫mero padr√£o de threads √© 5 sem demora).  √Äs vezes, por√©m, um sistema de seguran√ßa contra interrup√ß√£o ou um Load Balancer regular s√≥ pode responder a esse √∫nico fator.  Se voc√™ estiver tentando fazer for√ßa bruta com 5 threads, reduza o n√∫mero para 1 e depois para 1 com um atraso de um segundo.  Antes, tive a sorte de observar esse comportamento e foi com a ajuda de tais manipula√ß√µes que ocorreu a sele√ß√£o bem-sucedida do c√≥digo, que levou √† aquisi√ß√£o da conta.  Se o c√≥digo 2FA n√£o tiver uma data de validade espec√≠fica, teremos muito tempo para resolver.  Se o per√≠odo de validade estiver presente, o sucesso do ataque ser√° reduzido, mas o perigo potencial de vulnerabilidade ainda estar√° presente, pois ainda h√° uma chance de entrar no c√≥digo desejado. <br><br><h4>  2) O c√≥digo OTP gerado n√£o muda </h4><br>  Isso n√£o se aplica a c√≥digos que mudam constantemente, como no Google Authenticator, mas apenas aos c√≥digos est√°ticos que v√™m em SMS, email ou pessoalmente via messenger. <br><br>  A ess√™ncia desse desvio √© que o mesmo c√≥digo OTP √© enviado constantemente ou por algum tempo, por exemplo, 5 minutos, o que √© v√°lido durante todo esse tempo.  Tamb√©m vale a pena garantir que nenhum limite de taxa silencioso ocorra. <br><br>  Exemplo de relat√≥rio: <a href="https://hackerone.com/reports/420163">hackerone.com/reports/420163</a> <br><br>  Suponha que o aplicativo gere um c√≥digo aleat√≥rio de 001 a 999 e o envie ao telefone, dentro de 10 minutos quando a funcionalidade "enviar novamente" estiver ativada, obteremos o mesmo c√≥digo.  Mas o limite de taxa est√° vinculado √† solicita√ß√£o, o que limita o n√∫mero de tentativas por token de solicita√ß√£o.  Podemos solicitar constantemente um novo c√≥digo, gerar um novo token de solicita√ß√£o, aplic√°-lo a uma solicita√ß√£o subsequente (usando grep-match em um conjunto de arrotos ou usando nosso pr√≥prio script) e executar for√ßa bruta de um intervalo de n√∫meros de 001 a 999. Portanto, constantemente, use um novo token de solicita√ß√£o selecionaremos com √™xito o c√≥digo correto, pois ele n√£o muda e √© est√°tico por um determinado per√≠odo de tempo.  As limita√ß√µes deste ataque s√£o um n√∫mero longo ou misturar letras com n√∫meros como c√≥digo de confirma√ß√£o. <br><br>  Essa situa√ß√£o n√£o deve ser incentivada; voc√™ deve tentar separar pelo menos parte de nossa lista, porque existe a possibilidade de o c√≥digo gerado estar nesta parte da lista, uma vez que √© gerado aleatoriamente.  Ao tentar, voc√™ precisa confiar no acaso, mas ainda existe a chance de entrar na combina√ß√£o certa, o que prova uma vulnerabilidade que definitivamente precisa ser corrigida. <br><br><h4>  3) Redefina a taxa-limite-a ao atualizar o c√≥digo. </h4><br>  Na solicita√ß√£o de verifica√ß√£o de c√≥digo, o limite de taxa est√° presente, mas ap√≥s ativar a fun√ß√£o de reenviar o c√≥digo, ele √© redefinido e permite continuar o c√≥digo de for√ßa bruta. <br>  Exemplos de relat√≥rios: <br><br>  <a href="https://hackerone.com/reports/149598">https://hackerone.com/reports/149598</a> , - teoria; <br>  <a href="https://hackerone.com/reports/205000">hackerone.com/reports/205000</a> , uma explora√ß√£o pr√°tica baseada em um relat√≥rio anterior. <br><br><h4>  4) Ignorando o limite de taxa alterando o endere√ßo IP </h4><br>  Muitos bloqueios s√£o baseados na restri√ß√£o de recebimento de solicita√ß√µes do IP, que atingiu o limite de um certo n√∫mero de tentativas ao executar uma solicita√ß√£o.  Se o endere√ßo IP for alterado, haver√° a oportunidade de contornar essa restri√ß√£o.  Para verificar esse m√©todo, basta alterar seu IP usando o servidor proxy / VPN e verificar se o bloqueio depende do IP. <br><br>  Maneiras de mudar o IP: <br><br><ul><li>  Os proxies podem ser usados ‚Äã‚Äãem um ataque usando o complemento IP Rotator do Burp Suite <a href="https://github.com/RhinoSecurityLabs/IPRotate_Burp_Extension">github.com/RhinoSecurityLabs/IPRotate_Burp_Extension</a> .  Na minha opini√£o, essa √© a melhor escolha, pois nos oferece ~ tentativas ilimitadas de for√ßa bruta e endere√ßos IP que permitem executar um ataque de for√ßa bruta sem erros e interrup√ß√µes de 42x. </li><li>  Uma boa op√ß√£o pode ser um script python com um m√≥dulo de solicita√ß√µes de proxy, mas primeiro voc√™ precisa obter um grande n√∫mero de proxies v√°lidos em algum lugar. </li></ul><br>  Como a ferramenta de rota√ß√£o de IP envia solicita√ß√µes usando os endere√ßos IP da AWS, todas as solicita√ß√µes ser√£o bloqueadas se o aplicativo Web estiver atr√°s do firewall CloudFlare. <br><br><img src="https://habrastorage.org/webt/5b/ep/c4/5bepc4djncwcbel-6gxkjfzh1ro.png"><br><br>  Nesse caso, voc√™ precisa descobrir adicionalmente o IP do servidor da Web original ou encontrar um m√©todo que n√£o se refira aos endere√ßos IP da AWS. <br><br><h4>  5) O site inclui suporte para X-Forwarded-For </h4><br>  O cabe√ßalho X-Forwarded-For embutido pode ser usado para alterar o IP.  Se o aplicativo tiver processamento interno para esse cabe√ßalho, envie X-Forwarded-For: desejado_IP para substituir o IP para ignorar a restri√ß√£o sem o uso de proxies adicionais.  Toda vez que uma solicita√ß√£o √© enviada pelo X-Forwarded-For, o servidor da Web pensa que nosso endere√ßo IP corresponde ao valor transmitido pelo cabe√ßalho. <br>  Materiais sobre este t√≥pico: <br>  <a href="https://hackerone.com/reports/225897">hackerone.com/reports/225897</a> <br>  <a href="https://medium.com/%40arbazhussain/bypassing-rate-limit-protection-by-spoofing-originating-ip-ff06adf34157">medium.com/@arbazhussain/bypassing-rate-limit-protection-by-spoofing-originating-ip-ff06adf34157</a> <br><br><h2>  3. Ignore 2fa substituindo parte da solicita√ß√£o de uma sess√£o de outra conta </h2><br>  Se um par√¢metro com um valor espec√≠fico for enviado para verificar o c√≥digo na solicita√ß√£o, tente enviar o valor da solicita√ß√£o para outra conta. <br><br>  Por exemplo, ao enviar um c√≥digo OTP, √© verificado o ID do formul√°rio, o ID do usu√°rio ou o cookie associado ao envio do c√≥digo.  Se aplicarmos os dados dos par√¢metros da conta na qual voc√™ deseja ignorar a verifica√ß√£o de c√≥digo (Conta 1) a uma sess√£o de uma conta completamente diferente (Conta 2), obteremos o c√≥digo e o inseriremos na segunda conta, ent√£o podemos ignorar a prote√ß√£o na primeira conta.  Depois de recarregar a p√°gina 2FA deve desaparecer. <br><br><h2>  4. Ignore o 2FA usando a "funcionalidade de memoriza√ß√£o" </h2><br>  Muitos sites que oferecem suporte √† autoriza√ß√£o 2FA t√™m a funcionalidade "lembre-se de mim".  √â √∫til quando o usu√°rio n√£o deseja inserir um c√≥digo 2FA nos logins subseq√ºentes.  √â importante identificar como o 2FA √© "lembrado".  Pode ser um cookie, um valor na sess√£o / armazenamento local ou apenas anexar 2FA a um endere√ßo IP. <br><br><h4>  1) Se o 2FA for anexado usando um cookie, o valor do cookie dever√° ser inquestion√°vel </h4><br>  Ou seja, se um cookie consiste em um conjunto de n√∫meros que aumentam para cada conta, √© bem poss√≠vel aplicar um ataque de for√ßa bruta ao valor do cookie e ignorar o 2FA.  Os desenvolvedores devem fornecer ao cookie (junto com o cookie da sess√£o principal e o token CSRF) o atributo HttpOnly, para que n√£o possa ser roubado usando o XSS e usado para ignorar o 2FA. <br><br><h4>  2) Se 2FA estiver anexado ao endere√ßo IP, voc√™ poder√° tentar substitu√≠-lo </h4><br>  Para identificar esse m√©todo, fa√ßa login na sua conta usando a fun√ß√£o de armazenamento 2FA, depois mude para outro navegador ou modo de navega√ß√£o an√¥nima do navegador atual e tente fazer login novamente.  Se o 2FA n√£o for solicitado, o 2FA foi anexado ao endere√ßo IP. <br>  Para substituir o endere√ßo IP, voc√™ pode usar o cabe√ßalho X-Forwarded-For no est√°gio de digitar o login e a senha, se o aplicativo da Web suportar. <br><br>  Usando esse cabe√ßalho, voc√™ tamb√©m pode ignorar a fun√ß√£o da lista branca de endere√ßos IP, se houver alguma nas configura√ß√µes da conta.  Ele pode ser usado em conjunto com o 2FA como prote√ß√£o adicional da conta ou o 2FA pode nem ser solicitado se o endere√ßo IP corresponder √† lista branca (com o consentimento do usu√°rio).  Assim, mesmo sem conectar o 2FA ao endere√ßo IP, em alguns casos, o 2FA pode ser contornado, contornando os m√©todos de prote√ß√£o associados. <br>  Em geral, anexar 2FA a um endere√ßo IP n√£o √© uma maneira totalmente segura de prote√ß√£o, porque quando voc√™ est√° presente na mesma rede, quando conectado ao mesmo provedor de servi√ßos de Internet / VPN com um endere√ßo IP est√°tico, o 2FA pode ser ignorado. <br><br>  A maneira mais segura de se proteger √© n√£o se lembrar do 2FA em detrimento da usabilidade. <br><br><h2>  5. Erro de controle de acesso inadequado na p√°gina de entrada 2FA </h2><br>  √Äs vezes, uma p√°gina de di√°logo para inserir 2FA √© apresentada como uma URL com par√¢metros.  O acesso a uma p√°gina com par√¢metros no URL com cookies que n√£o correspondem aos usados ‚Äã‚Äãpara gerar a p√°gina ou sem cookies n√£o √© seguro.  Mas se os desenvolvedores decidiram aceitar os riscos, voc√™ precisa passar por v√°rios pontos importantes: <br><br><ol><li>  O link expira para a entrada 2FA? </li><li>  se o link est√° indexado nos mecanismos de pesquisa. </li></ol><br>  Se o link tiver uma vida √∫til longa e / ou os mecanismos de pesquisa contiverem links funcionais para entrada 2FA / os links puderem ser indexados (n√£o h√° regras nas robots.txt / meta tags), √© poss√≠vel usar um mecanismo de desvio 2FA na p√°gina de entrada 2FA, na qual ignore completamente o login e a senha e obtenha acesso √† conta de outra pessoa. <br><br><h2>  6. Censura inadequada de dados pessoais na p√°gina 2FA </h2><br>  Ao enviar um c√≥digo OTP em uma p√°gina, a censura √© usada para proteger dados pessoais, como email, n√∫mero de telefone, apelido etc.  Mas esses dados podem ser totalmente divulgados nos pontos de extremidade da API e em outras solicita√ß√µes para as quais temos direitos suficientes no est√°gio 2FA.  Se inicialmente esses dados n√£o eram conhecidos, por exemplo, inserimos apenas um logon sem saber o n√∫mero de telefone, isso √© considerado a vulnerabilidade de divulga√ß√£o de informa√ß√µes.  Saber o n√∫mero de telefone / email pode ser usado para ataques subsequentes de phishing e for√ßa bruta. <br><br>  Um exemplo de explora√ß√£o de uma vulnerabilidade usando o preenchimento de credenciais.  Digamos que exista um banco de dados no dom√≠nio p√∫blico com logins e senhas para o site A. Os invasores podem usar os dados desse banco de dados no site B: <br><br><ul><li>  Primeiro, eles verificam se o usu√°rio existe no banco de dados do site B usando o erro "Enumera√ß√£o de contas" ao registrar / recuperar a senha.  Normalmente, muitos sites n√£o consideram isso uma vulnerabilidade e assumem riscos.  "Vulnerabilidade" est√° na presen√ßa de um erro sobre o fato do registro do usu√°rio no site.  Idealmente, uma mensagem segura na p√°gina de recupera√ß√£o de senha √© a seguinte: <br><br><img src="https://habrastorage.org/webt/mh/qe/mh/mhqemhmykfiy5pcl-35konzb0dm.png"><br><br><img src="https://habrastorage.org/webt/ha/uu/ze/hauuzewqlj9escx9nc8fslz4a0o.png"></li><li>  Depois de obter o banco de dados de usu√°rios existentes, os atacantes aplicam senhas a essas contas. </li><li>  Se eles encontrarem 2FA, eles ficar√£o presos.  Por√©m, no caso de censura insuficiente dos dados do usu√°rio, eles podem complementar seu banco de dados com seus dados pessoais (se n√£o estiverem no banco de dados original). </li></ul><br><h2>  7. Ignorando 2FA em determinadas circunst√¢ncias </h2><br>  Ao executar algumas a√ß√µes que levam ao login autom√°tico em sua conta, o 2FA pode n√£o ser solicitado. <br><br><h4>  1) Ignore 2FA ao recuperar uma senha </h4><br>  Muitos servi√ßos efetuam login automaticamente em sua conta ap√≥s concluir o procedimento de recupera√ß√£o de senha.  Como o acesso √† conta √© fornecido instantaneamente, quando voc√™ faz login na sua conta 2FA, ela pode ser ignorada e completamente ignorada. <br><br>  Impacto de um relat√≥rio semelhante de hacker que enviei recentemente: <br><blockquote>  Se um invasor obt√©m acesso ao e-mail da v√≠tima (ele pode invadir a conta usando phishing, ataques de for√ßa bruta, preenchimento de credenciais etc.), ele pode ignorar o 2FA, embora nesse caso o 2FA deva proteger a conta.  No momento, para o 2FA, h√° uma verifica√ß√£o do c√≥digo do Google Authenticator ou do c√≥digo de backup, mas n√£o do c√≥digo do e-mail. Portanto, esse desvio faz sentido. </blockquote><h4>  2) Ignorando 2FA ao fazer login atrav√©s de uma rede social </h4><br>  Voc√™ pode conectar uma rede social √† sua conta de usu√°rio para fazer login rapidamente na sua conta e, ao mesmo tempo, configurar o 2FA.  Quando voc√™ faz login na sua conta atrav√©s das redes sociais, o 2FA pode ser ignorado.  Se o email da v√≠tima for invadido, ser√° poss√≠vel recuperar a senha da conta da rede social (se isso permitir) e entrar no servi√ßo sem inserir 2FA. <br><br>  Impacto de um dos relat√≥rios: <br><blockquote><ol><li>  Muitas outras vulnerabilidades, como a configura√ß√£o incorreta do OAuth enviada anteriormente # 577468, para capturar completamente a conta, quebrando o 2FA. </li><li>  Se um invasor invadir o email do usu√°rio, ele poder√° tentar recuperar o acesso √† conta da rede social e fazer login na conta sem verifica√ß√£o adicional. </li><li>  Se um invasor invadir uma conta da v√≠tima, ele poder√° associar uma rede social √† conta e efetuar login no futuro, ignorando completamente o 2FA e inserindo o login / senha. </li></ol></blockquote><h4>  3) Ignorando 2FA em uma vers√£o mais antiga do aplicativo </h4><br>  Os desenvolvedores geralmente adicionam vers√µes intermedi√°rias de um aplicativo Web a dom√≠nios / subdom√≠nios para testar determinadas fun√ß√µes.  Curiosamente, se voc√™ fizer login usando seu nome de usu√°rio e senha, o 2FA n√£o ser√° solicitado.  Talvez os desenvolvedores estejam usando uma vers√£o mais antiga do aplicativo, na qual n√£o h√° prote√ß√£o para o 2FA, o pr√≥prio 2FA est√° desabilitado ou foi intencionalmente desabilitado para teste. <br><br>  Al√©m disso, voc√™ pode verificar outras vulnerabilidades ao mesmo tempo, - registrar um novo usu√°rio em um servidor intermedi√°rio cujo email existe no banco de dados da vers√£o de produ√ß√£o pode nos fornecer dados pessoais da produ√ß√£o;  a aus√™ncia de um limite de taxa em funcionalidades importantes, por exemplo, recupera√ß√£o de senha.  Um exemplo da vulnerabilidade mais recente √© um bug no Facebook de US $ 15.000, que permitiu invadir uma conta usando o c√≥digo de recupera√ß√£o de senha bruteforce em beta.facebook.com <a href="https://www.freecodecamp.org/news/responsible-disclosure-how-i-could-have-hacked-all-facebook-accounts-f47c0252ae4d/">www.freecodecamp.org/news/responsible-disclosure-how-i-could-have-hacked-all- contas-facebook-f47c0252ae4d</a> . <br><br><h4>  4) Ignorando 2FA em caso de plataforma cruzada </h4><br>  As implementa√ß√µes 2FA na vers√£o m√≥vel ou para computador podem diferir da vers√£o web do aplicativo.  2FA pode ser mais fraco que na vers√£o web ou completamente ausente. <br><br>  7. Ao desativar o 2FA, o c√≥digo atual n√£o √© solicitado. <br><br>  Se, ao desativar o 2FA, uma confirma√ß√£o adicional n√£o for solicitada, como o c√≥digo atual do aplicativo autenticador do google, o c√≥digo do email / telefone, nesse caso, haver√° certos riscos.  Com uma solicita√ß√£o limpa, h√° uma chance de um ataque CSRF.  Se for encontrado um vetor de desvio da prote√ß√£o CSRF (se houver), o 2FA poder√° ser desativado.  Uma vulnerabilidade de clickjacking tamb√©m pode ser usada - ap√≥s alguns cliques de um usu√°rio inocente, o 2FA ser√° desconectado.  A valida√ß√£o do c√≥digo anterior adicionar√° prote√ß√£o 2FA adicional, dados poss√≠veis ataques de CSRF / XSS / Clickjacking, bem como configura√ß√µes incorretas do CORS. <br><br>  Vou dar um exemplo de hackerone.com: quando voc√™ desativa o 2FA em um formul√°rio, √© necess√°rio inserir duas vari√°veis ‚Äã‚Äãao mesmo tempo, o c√≥digo atual com o aplicativo e a senha do autenticador do Google.  Esta √© a melhor e recomendada prote√ß√£o. <br><br><img src="https://habrastorage.org/webt/wg/hh/jz/wghhjzf5sdotqin6knlde5i4g5q.png"><br><br><h2>  8. As sess√µes criadas anteriormente permanecem v√°lidas ap√≥s a ativa√ß√£o do 2FA </h2><br>  Quando o 2FA est√° ativado, √© desej√°vel que as sess√µes paralelas na mesma conta terminem e o di√°logo de entrada 2FA seja exibido, o mesmo com uma altera√ß√£o de senha.  Se a conta foi comprometida e a primeira rea√ß√£o da v√≠tima for a inclus√£o do 2FA, a sess√£o do invasor ser√° desativada e o pr√≥ximo login e senha exigir√£o o 2FA.  Em suma, esta √© a melhor pr√°tica a ser seguida.  Costumo notar como as trocas de criptomoedas adicionam prote√ß√£o semelhante.  Exemplo de relat√≥rio do HackerOne, - <br>  https://hackerone.com/reports/534450. <br><br><h4>  9. A aus√™ncia de um limite de taxa na sua conta </h4><br>  O 2FA pode ser implementado em v√°rias fun√ß√µes da conta pessoal do usu√°rio para maior seguran√ßa.  Pode ser uma altera√ß√£o de endere√ßo de email, senha, confirma√ß√£o de uma altera√ß√£o de c√≥digo para transa√ß√µes financeiras, etc.  A presen√ßa do limite de taxa-a na sua conta pode diferir da presen√ßa do limite de taxa-a no 2FA ao entrar na sua conta.  Muitas vezes me deparei com casos semelhantes quando era poss√≠vel selecionar livremente um c√≥digo 2FA na minha conta, enquanto na entrada um limite de taxa "Estrito" era definido. <br><br>  Se os desenvolvedores inicialmente adicionaram prote√ß√£o contra altera√ß√µes de dados n√£o autorizadas, essa prote√ß√£o deve ser suportada e corrigida por todos os desvios poss√≠veis.  Se o desvio for encontrado, isso ser√° considerado uma vulnerabilidade de desvio do recurso de seguran√ßa que foi implementada pelos desenvolvedores. <br><br><h4>  10. versionamento de API </h4><br>  Se voc√™ vir algo como / v * / na solicita√ß√£o do aplicativo Web, em que * √© um n√∫mero, √© prov√°vel que voc√™ possa mudar para uma vers√£o mais antiga da API.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na vers√£o antiga da API, pode haver uma prote√ß√£o fraca ou pode n√£o existir. Essa √© uma ocorr√™ncia bastante rara e ocorre se os desenvolvedores esquecerem de remover a vers√£o antiga da API no ambiente de produ√ß√£o / armazenamento tempor√°rio. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por exemplo, / endpoint / api / v4 / login executa uma solicita√ß√£o de login, verificando o nome de usu√°rio e a senha. Se 2FA estiver presente na conta, essa solicita√ß√£o dever√° ser seguida por / endpoint / api / v4 / 2fa_check, nada mais. Se substituirmos a vers√£o da API antes do 2FA, em alguns casos, podemos evit√°-la. / endpoint / api / v3 / login pode levar a / endpoint / v3 / login_successful? code = RANDOM, ignorando 2fa_check porque nesta vers√£o da API, o 2FA simplesmente n√£o foi implementado.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Outro exemplo - no request / endpoint / api / v4 / 2fa_check, h√° um limite de taxa, enquanto / endpoint / api / v3 / 2fa_check permite a itera√ß√£o de c√≥digos sem nenhuma restri√ß√£o. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 11. Controle de acesso inadequado ao solicitar c√≥digos de backup </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os c√≥digos de backup s√£o gerados imediatamente ap√≥s a ativa√ß√£o do 2FA e est√£o dispon√≠veis em uma √∫nica solicita√ß√£o. </font><font style="vertical-align: inherit;">Ap√≥s cada chamada subsequente √† solicita√ß√£o, os c√≥digos podem ser gerados por uma nova ou permanecer inalterados (c√≥digos est√°ticos). </font><font style="vertical-align: inherit;">Se houver vulnerabilidades de configura√ß√£o incorreta / XSS do CORS e outros bugs que permitem "extrair" os c√≥digos de backup da solicita√ß√£o de resposta para o terminal de exibi√ß√£o do c√≥digo de backup, o invasor poder√° roubar os c√≥digos e ignorar o 2FA se o nome de usu√°rio e a senha forem conhecidos.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em geral, o 2fa √© uma das maneiras mais confi√°veis ‚Äã‚Äãde proteger sua conta, a menos que, √© claro, os desenvolvedores armazenem os c√≥digos 2FA atuais de todos os usu√°rios do aplicativo Web no painel de administra√ß√£o - e isso aconteceu na minha pr√°tica. Tamb√©m gostaria de observar que os desenvolvedores de algumas empresas criam aplicativos para gerar seus pr√≥prios c√≥digos 2FA (exemplos s√£o Salesforce, Valve) e, devido √† seguran√ßa insuficiente, essa √™nfase na independ√™ncia do uso de outros aplicativos de autentica√ß√£o oferece aos atacantes um ponto de entrada adicional para ignorar o 2FA. O alcance da aplica√ß√£o dessa prote√ß√£o √© bastante amplo e oferece aos que desejam ignorar a prote√ß√£o 2FA mais oportunidades, espa√ßo para criatividade e aumentam o n√∫mero de varia√ß√µes dos desvios 2FA.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espero que essas informa√ß√µes sejam √∫teis para pesquisadores de seguran√ßa da informa√ß√£o, ca√ßadores de bugs e para que os desenvolvedores minimizem o n√∫mero de vulnerabilidades no servi√ßo que est√° sendo desenvolvido. </font><font style="vertical-align: inherit;">Fique seguro!</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt483134/">https://habr.com/ru/post/pt483134/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt483124/index.html">O gadget mais maci√ßo em um futuro pr√≥ximo (n√£o um smartphone)</a></li>
<li><a href="../pt483126/index.html">Efeitos criog√™nicos podem garantir o transporte seguro de baterias de ve√≠culos el√©tricos danificadas</a></li>
<li><a href="../pt483128/index.html">Apresentando o PHP 7.4: Desempenho, Recursos, Descontinua√ß√µes</a></li>
<li><a href="../pt483130/index.html">O que fazer se o c√≥digo para a fechadura da mala for esquecido?</a></li>
<li><a href="../pt483132/index.html">Projeto e fabrica√ß√£o de um telesc√≥pio</a></li>
<li><a href="../pt483136/index.html">Verificando o MacBook usado antes da compra - lista de verifica√ß√£o</a></li>
<li><a href="../pt483140/index.html">Pol√≠gonos Outro Mundo: Amiga 500</a></li>
<li><a href="../pt483142/index.html">Portando o Quake 3 para a Ferrugem</a></li>
<li><a href="../pt483144/index.html">O cientista He Jiankui √© um her√≥i, n√£o um criminoso</a></li>
<li><a href="../pt483146/index.html">Confer√™ncia DEFCON 27. Kraken Wireless WiFi Hacking Tool</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>