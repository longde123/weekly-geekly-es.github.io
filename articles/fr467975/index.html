<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎑 👩🏽‍🚀 🛌🏽 Huawei Dorado V6: Sichuan Heat 🛄 💐 👩🏼‍🏫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pour être honnête, l'été à Moscou cette année n'a pas été très bon. Cela a commencé trop tôt et trop vite, tout le monde n'y est pas parvenu et cela s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Huawei Dorado V6: Sichuan Heat</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467975/"><p><img src="https://habrastorage.org/webt/yj/u8/io/yju8iodu0czpy6vqf4esj-rbyio.png"><br>  Pour être honnête, l'été à Moscou cette année n'a pas été très bon.  Cela a commencé trop tôt et trop vite, tout le monde n'y est pas parvenu et cela s'est déjà terminé fin juin.  Par conséquent, lorsque Huawei a suggéré que j'aille en Chine, dans la ville de Chengdu, où se trouve leur centre RnD, en regardant les prévisions météorologiques à +34 degrés à l'ombre, j'ai immédiatement accepté.  Pourtant, mon âge n'est pas le même et mes os doivent être un peu réchauffés.  Mais je tiens à noter qu'il était possible de réchauffer non seulement les os, mais aussi l'intérieur, car la province du Sichuan, dans laquelle, en fait, Chengdu est célèbre pour son amour de la nourriture épicée.  Mais encore, ce blog n'est pas sur les voyages, revenons donc à l'objectif principal de notre voyage - la nouvelle gamme de systèmes de stockage - Huawei Dorado V6.  Cet article vous rappellera un peu du passé,  Il a été écrit avant l'annonce officielle, mais publié seulement après sa sortie.  Et donc, aujourd'hui, nous examinons tout ce qui est intéressant et savoureux que Huawei a préparé pour nous. </p><a name="habracut"></a><br><p><img src="https://habrastorage.org/webt/tq/ev/b4/tqevb4qfcfc3zadjk1texasfy94.png"><br>  La nouvelle ligne comprendra 5 modèles.  Tous les modèles sauf 3000V6 peuvent être en deux versions - SAS et NVMe.  L'interface de disque que vous pouvez utiliser dans ce système, les ports principaux et le nombre d'unités de disque que vous pouvez installer dans le système dépendent du choix.  NVMe utilise des SSD de taille Palm, plus fins que les SSD SAS classiques de 2,5 pouces et pouvant accueillir jusqu'à 36 unités.  La nouvelle ligne est All Flash et il n'y a aucune configuration de disque. </p><br><p><img src="https://habrastorage.org/webt/gg/f3/px/ggf3pxgpby4hojmgmepncvwgwli.jpeg"><br>  <i>SSD Palm NVMe</i> </p><br><p>  À mon avis, les Dorado 8000 et 18000 semblent être les modèles les plus intéressants. Huawei les positionne comme un système haut de gamme et, en raison de la politique de prix de Huawei, il contraste ces modèles de milieu de gamme avec son segment concurrent.  C'est sur ces modèles que je vais me concentrer aujourd'hui dans ma revue.  Immédiatement, je note qu'en raison de ses caractéristiques de conception, les systèmes à double contrôleur plus jeunes ont une architecture légèrement différente, différente des Dorado 8000 et 18000, donc tout ce dont je vais parler aujourd'hui ne s'applique pas aux modèles plus jeunes. </p><br><p>  L'une des principales caractéristiques des nouveaux systèmes était l'utilisation de plusieurs puces de leur propre conception, chacune permettant de transporter la charge logique du processeur central du contrôleur et d'ajouter des fonctionnalités à différents composants. <br><img src="https://habrastorage.org/webt/v0/qf/hn/v0qfhnmuwftjqbjywytee5qrypq.png"></p><br><p>  Le cœur des nouveaux systèmes est le processeur Kunpeng 920, développé sur les technologies ARM et fabriqué indépendamment par Huawei.  Selon le modèle, le nombre de cœurs varie, leur fréquence et le nombre de processeurs installés dans chaque contrôleur: <br>  Huawei Dorado V6 8000 - 2CPU, 64 cœurs <br>  Huawei Dorado V6 18000 - 4CPU, 48 cœurs <br><img src="https://habrastorage.org/webt/ry/dx/i4/rydxi40psrto73xx1dgz78kq_be.png"></p><br><p>  Huawei a développé ce processeur sur l'architecture ARM, et pour autant que je sache, il avait initialement prévu de le mettre uniquement dans les anciens modèles Dorado 8000 et 18000, comme c'était le cas avec certains modèles V5, mais les sanctions ont apporté des ajustements à cette idée.  Bien sûr, ARM a également évoqué le refus de coopération avec Huawei lors de l'imposition de sanctions, mais ici la situation est différente qu'avec Intel.  Huawei produit ces puces de son propre chef, et aucune sanction ne peut arrêter ce processus.  La rupture des relations avec ARM ne menace que la perte d'accès aux nouveaux développements.  Quant à la performance - ici, il ne sera possible de juger qu'après avoir effectué des tests indépendants.  Bien que j'aie vu comment 1M IOPS a été supprimé du système Dorado 18000 sans aucun problème, jusqu'à ce que je le fasse de mes propres mains dans le rack, je ne le croirai pas.  Mais les capacités des contrôleurs là-bas ne sont vraiment pas suffisantes.  Les anciens modèles sont équipés de 4 contrôleurs, chacun ayant 4 processeurs installés, ce qui donne un total de 768 cœurs. <br><img src="https://habrastorage.org/webt/so/rq/ge/sorqge26yqm7i3j0gl7gm3dyqyo.jpeg"></p><br><p>  Mais je vous parlerai des noyaux encore plus tard, lorsque nous examinerons l'architecture des nouveaux systèmes, mais pour l'instant, revenons à une autre puce installée dans le système.  La puce <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ascend 310</a> ressemble à une solution extrêmement intéressante (si je comprends bien, le frère cadet Ascend 910, qui a récemment été présenté au public).  Sa tâche est d'analyser les blocs de données arrivant au système pour augmenter le taux de réussite en lecture.  Il est encore difficile de dire comment il se montrera au travail, car  Aujourd'hui, il ne fonctionne que selon un schéma donné et n'a pas la capacité d'apprendre dans un mode intellectuel.  L'apparition d'un mode intelligent est promise dans le futur firmware, très probablement au début de l'année prochaine. </p><br><p>  Passons à l'architecture.  Huawei a continué de développer sa propre technologie Smart Matrix, qui met en œuvre une approche entièrement maillée pour connecter les composants.  Mais si dans la V5, c'était uniquement pour l'accès des contrôleurs aux disques, maintenant tous les contrôleurs ont accès à tous les ports du back-end et du front-end. <br><img src="https://habrastorage.org/webt/sq/4v/no/sq4vnozkqfimysajqmkepxlnzy0.png"></p><br><p>  Grâce à la nouvelle architecture de microservices, cela permet également d'équilibrer la charge entre tous les contrôleurs, même s'il n'y a qu'un seul lun.  Le système d'exploitation de cette gamme de baies a été développé à partir de zéro, et pas seulement optimisé pour l'utilisation de lecteurs Flash.  En raison du fait que tous les contrôleurs ont accès aux mêmes ports, en cas de défaillance ou de redémarrage du contrôleur, l'hôte ne perd pas un seul chemin vers le système de stockage et la commutation de chemin est effectuée au niveau du système de stockage de données.  Dans le même temps, l'utilisation d'UltraPath sur l'hôte n'est pas une stricte nécessité.  Une autre «économie» dans l'installation du système est un plus petit nombre de liens nécessaires.  Et si avec l'approche «classique» pour 4 contrôleurs, nous avons besoin de 8 liens de 2 usines, alors dans le cas de Huawei, même 2 suffiront (je ne parle pas maintenant de la suffisance de la bande passante d'un lien). <br><img src="https://habrastorage.org/webt/hr/a9/pq/hra9pqgs3u61zday9wnciwxkrcy.png"></p><br><p>  Comme dans la version précédente, un cache global avec mise en miroir est utilisé.  Cela vous permet de perdre jusqu'à deux contrôleurs simultanément ou trois contrôleurs en série sans affecter la disponibilité.  Mais il convient de noter que nous n'avons pas vu d'équilibrage de charge complet entre les 3 contrôleurs restants en cas de défaillance d'un, sur le stand de démonstration.  La charge du contrôleur défaillant a été complètement prise en charge par l'un des autres.  Il est possible que pour cela, il soit nécessaire de laisser le système fonctionner plus longtemps dans cette configuration.  Dans tous les cas, lors de mes propres tests, je vérifierai cela plus en détail. <br>  Huawei positionne de nouveaux systèmes en tant que systèmes NVMe de bout en bout, mais pour le moment, NVMeOF n'est pas encore pris en charge sur le frontend, uniquement FC, iSCSI ou NFS.  À la fin de ceci ou au début du suivant, comme d'autres puces, on nous promet le support RoCE. <br><img src="https://habrastorage.org/webt/qw/bb/ta/qwbbtadffklr9azbeiuvwerwx-m.png"></p><br><p>  Les étagères sont connectées aux contrôleurs de la même manière à l'aide de RoCE, ce qui présente un inconvénient - l'absence de connexion en boucle des étagères, comme c'était le cas avec SAS.  À mon avis, bien que ce soit un assez gros inconvénient, si vous avez prévu un système assez volumineux.  Le fait est que toutes les étagères sont connectées en série, et la défaillance de l'une des étagères entraîne l'inaccessibilité complète de toutes les autres qui la suivent.  Dans ce cas, pour garantir la tolérance aux pannes, nous devons connecter toutes les étagères aux contrôleurs, ce qui entraîne une augmentation du nombre requis de ports backend dans le système. </p><br><p>  Et une autre chose à noter est la mise à jour non perturbatrice (NDU).  Comme je l'ai dit ci-dessus, Huawei a mis en œuvre une approche de conteneur dans le fonctionnement du système d'exploitation de la nouvelle ligne Dorado, ce qui permet de mettre à jour et de redémarrer les services, sans avoir besoin d'un redémarrage complet du contrôleur.  Il convient de mentionner tout de suite que certaines mises à jour contiendront des mises à jour du noyau, et dans ce cas, le redémarrage classique des contrôleurs sera parfois toujours requis lors de la mise à jour, mais pas toujours.  Cela réduira le niveau d'influence de cette opération sur le système productif. </p><br><p>  Dans notre arsenal, la grande majorité des baies de la société NetApp.  Par conséquent, je pense que ce sera assez logique si je fais une petite comparaison avec les systèmes avec lesquels je dois beaucoup travailler.  Il ne s'agit pas de déterminer qui est meilleur et qui est pire ou dont l'architecture est plus avantageuse.  J'essaierai sobrement et sans fanatisme de comparer deux approches différentes pour résoudre le même problème de différents fournisseurs.  Oui, bien sûr, dans ce cas, nous considérerons les systèmes Huawei dans la «théorie» et je noterai également séparément les moments qui ne devraient être mis en œuvre que dans les futures versions du firmware.  Quels sont les avantages que je vois en ce moment: </p><br><ol><li>  Nombre de disques NVMe pris en charge.  NetApp a aujourd'hui un nombre de 288, Huawei selon le modèle - 1600-6400.  Dans le même temps, la capacité maximale utilisable de Huawei est de 32PBe, comme les systèmes NetApp (pour être plus précis, ils ont 31,64PBe).  Et cela malgré le fait que les disques du même volume sont pris en charge (jusqu'à 15 To).  Huawei explique ce fait comme suit - ils n'ont pas eu l'occasion d'assembler un support plus grand.  En théorie, ils n'ont pas de limite de volume, mais ils n'ont tout simplement pas pu tester ce fait.  Mais il convient de noter que les capacités des lecteurs flash sont très élevées aujourd'hui, et dans le cas des systèmes NVMe, nous sommes confrontés au fait que 24 disques sont suffisants pour utiliser le système haut de gamme à 2 contrôleurs.  Par conséquent, une nouvelle augmentation du nombre de disques dans le système non seulement ne donnera pas un gain de performances, mais affectera également de manière défavorable le rapport IOPS / Tb.  Bien sûr, il vaut la peine de voir combien de disques les systèmes à 4 contrôleurs 8000 et 16000 peuvent retirer, car  les capacités et le potentiel du Kunpeng 920 ne sont pas encore complètement clairs. </li><li>  Lun a un propriétaire sur les systèmes NetApp.  C'est-à-dire  un seul contrôleur peut effectuer des opérations avec la lune, tandis que le second ne fait que passer IO à travers lui-même.  Les systèmes Huawei, au contraire, n'ont pas de propriétaires et les opérations avec des blocs de données (compression, déduplication) peuvent être effectuées par l'un des contrôleurs, ainsi qu'écrites sur des disques. </li><li>  Pas de chute de port en cas de panne d'un des contrôleurs.  Pour certains, ce moment semble extrêmement critique.  L'essentiel est que la commutation à l'intérieur du système de stockage devrait être plus rapide que du côté hôte.  Et si dans le cas du même NetApp, nous avons en pratique révélé une frise de l'ordre de 5 secondes lors du retrait du contrôleur et des voies de commutation, alors passer à Huawei doit encore s'entraîner. </li><li>  Pas besoin de redémarrer le contrôleur pendant la mise à niveau.  J'étais particulièrement inquiet à ce sujet avec la sortie assez fréquente de nouvelles versions et de nouvelles branches de firmware pour NetApps.  Oui, certaines mises à jour pour Huawei nécessiteront toujours un redémarrage, mais pas toutes. </li><li>  4 contrôleurs Huawei pour le prix de deux contrôleurs NetApp.  Comme je l'ai dit plus haut, grâce à la politique tarifaire de Huawei, il peut rivaliser avec le milieu de gamme avec ses modèles haut de gamme. </li><li>  La présence de puces supplémentaires dans les contrôleurs d'étagère et les cartes de port, qui sont potentiellement destinées à augmenter l'efficacité du système. </li></ol><br><p>  Inconvénients et peurs en général: </p><br><ol><li>  Connexion directe des étagères aux contrôleurs ou besoin d'un grand nombre de ports principaux pour connecter toutes les étagères aux contrôleurs. </li><li>  L'architecture ARM et la présence d'un grand nombre de puces - son efficacité et son efficacité. </li></ol><br><p>  La plupart des craintes et des craintes pourront dissiper les propres tests de la nouvelle ligne.  J'espère que peu de temps après la sortie, ils apparaîtront déjà à Moscou et qu'il y en aura suffisamment pour en obtenir rapidement un pour leurs propres tests.  Jusqu'à présent, nous pouvons dire que l'approche de l'entreprise dans son ensemble semble intéressante, et la nouvelle gamme semble très bonne face à ses concurrents.  la mise en œuvre finale soulève beaucoup de questions, car  nous ne verrons beaucoup de choses qu'à la fin de l'année, et peut-être seulement en 2020. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467975/">https://habr.com/ru/post/fr467975/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467961/index.html">Problèmes et nuances lors du développement de SmartTV à l'aide de React.js</a></li>
<li><a href="../fr467965/index.html">Vivaldi 2.8 - Menu, s'il vous plaît</a></li>
<li><a href="../fr467967/index.html">Immersion dans les réseaux de neurones convolutifs: transfert d'apprentissage</a></li>
<li><a href="../fr467969/index.html">Présentations d'écran modal modal dans iOS 13</a></li>
<li><a href="../fr467973/index.html">Naissance de la plateforme</a></li>
<li><a href="../fr467977/index.html">Création d'une application à l'aide de composants de style dans Vue.js</a></li>
<li><a href="../fr467979/index.html">Intégrations publicitaires: comment ça marche?</a></li>
<li><a href="../fr467981/index.html">Cisco UCS C240 ​​M5 Rack Server Anboxing</a></li>
<li><a href="../fr467983/index.html">Pourquoi vous devriez jeter MVP hors de vos projets</a></li>
<li><a href="../fr467987/index.html">Gelée colorée et vivante: prise de décision au niveau matériel sans processeur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>