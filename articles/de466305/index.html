<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕟 🤲 🌂 Takashi Kokubun: Wie man Ruby-Anwendungen schneller laufen lässt 🌦️ 👩🏼‍🔧 🤴🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die zentralrussische Rubinkonferenz am 28. September markiert 10 Jahre. In diesem Jahr hat RubyRussia einen neuen Veranstaltungsort, bis zu 4 Streams ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Takashi Kokubun: Wie man Ruby-Anwendungen schneller laufen lässt</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/railsclub/blog/466305/"> Die zentralrussische Rubinkonferenz am 28. September markiert 10 Jahre.  In diesem Jahr hat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RubyRussia einen</a> neuen Veranstaltungsort, bis zu 4 Streams ausgewählter Berichte, Kommunikation und natürlich die legendäre After-Party!  Unter den Rednern sind Yukihiro Matsumoto, Takashi Kokubun, Xavier Noria, Nick Sutterer, Genadi Samokovarov und mehr! <br><br>  Zur Vorbereitung sprechen wir mit Rednern über Ruby, Arbeit und Leben.  Heute veröffentlichen wir Material, in dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dmitry</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Matveyev</a> (Projektmanager in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Evrone</a> ) Fragen an <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Takashi Kokubun stellt</a></b> . <br><br><img src="https://habrastorage.org/webt/ld/5d/ea/ld5deappknbod3tlj0kruqrj9d8.jpeg" alt="Bild"><br>  <i>Der Sprecher RubyRussia 2019, ein Optimierer für den Ruby JIT-Compiler, unterstützt Haml und ERB, einen Backend-Ingenieur in ArmTreasure Data.</i> <br><a name="habracut"></a><br>  <b>Sagen Sie mir, was in Ihrem Bericht auf der Konferenz besprochen wird?</b> <br><br>  Informationen zur Arbeit am JIT-Compiler.  Ich möchte mich auf drei Punkte konzentrieren.  Das erste ist das Inlining von Funktionen.  Die Funktion muss „sauber“ sein, ohne Nebenwirkungen, damit ihr Körper inline sein kann.  Wenn zu viele Funktionen vorhanden sind, beginnt der Compiler langsam zu arbeiten.  Ich werde beschreiben, wie dieses Problem gelöst werden kann. <br>  Der zweite Punkt betrifft die Optimierung der Platzierung von Objekten im Speicher.  In großen und komplexen Anwendungen wie Rails müssen Sie viele Objekte in einer Anforderung erstellen.  Wenn Sie diesen Prozess optimieren, können Sie die Leistung verbessern.  Normalerweise werden Objekte im Heap erstellt.  Daher müssen Sie darin komplexe Datenstrukturen verwalten.  Sie müssen auch den Garbage Collector aufrufen, um nicht verwendete Objekte zu entfernen.  Und wenn wir Objekte auf dem Stapel platzieren würden, würden wir einfach den Stapelzeiger erhöhen, wenn wir ein Objekt hinzufügen, und ihn verringern, wenn das Objekt gelöscht werden muss.  Die Verwendung des Stapels zum Speichern von Objekten ist an sich schneller, und der Garbage Collector arbeitet schneller.  Um den Stapel verwenden zu können, müssen wir jedoch sicherstellen, dass Objekte nicht anderweitig verwendet werden.  Zu diesem Zweck verwenden wir eine Technik namens „Fluchtanalyse“.  Wir müssen jede Methode analysieren und sicherstellen, dass jedes ihrer internen Objekte nicht extern verwendet wird und nicht als Ergebnis der aktuellen Methode zurückgegeben wird.  Wenn wir dies tun können, können wir Objekte auf dem Stapel platzieren, was die Produktivität erhöht.  Meine Idee ist es, Metadaten für Anweisungen hinzuzufügen.  Nun, dies ist ein Experiment, aber ich werde in naher Zukunft eine Pull-Anfrage an den Master mit diesem Code stellen. <br><br>  Der dritte Punkt betrifft die Optimierung des Versands von Funktionsaufrufen in JIT.  Gegenwärtig erzeugt dieser Prozess eine starke Verzweigung der Logik, was den Mechanismus der Verzweigungsvorhersage des Prozessors nachteilig beeinflusst.  Dies verlangsamt den Prozessor insgesamt.  Wir müssen diese Logik vereinfachen, dh die Anzahl der Bedingungen reduzieren.  Ich erforsche gerade, wie das geht. <br><br>  <b>Dies ist ein Hardcore-Bericht mit viel Code und Konzepten!</b>  <b>Es scheint schwierig zu sein?</b> <br><br>  Ich denke, dass die meisten Leute Compiler nicht selbst implementieren, und ich verstehe, dass es schwierig sein kann, dies zu verstehen.  Aber ich werde versuchen, alles so einfach wie möglich mit Beispielen und Abbildungen zu erklären.  Das heißt, mein Bericht sollte für Leute ohne besondere Erfahrung in der Compilerentwicklung verständlich sein. <br><br>  <b>Ist es möglich, den neuen Compiler jetzt in der Produktion einzusetzen, und in welchen Fällen?</b> <br><br>  Die Idee ist, RoR-Anwendungen schneller laufen zu lassen.  Zum Beispiel wird meine derzeitige Firma davon profitieren.  Aber ich würde nicht sagen, dass alles für die Produktion bereit ist.  Es stellte sich heraus, dass nur RoR-Anwendungen nicht besonders beschleunigt werden.  Dies liegt daran, dass solche Anwendungen normalerweise groß sind und viel C-Code generieren, was zu einer ineffizienten Verwendung des Caching im Prozessor führt.  Ich habe einige Ideen, wie ich das beheben kann.  Daran arbeite ich gerade.  Aber jetzt kann mein Compiler für kleine Anwendungen nützlich sein.  Ich weiß zum Beispiel, dass der Karafka-Edelstein damit schneller arbeitet als ohne. <br><br>  <b>Ich habe gelesen, dass der JIT-Compiler bereits in den Ruby-Brunch-Master integriert ist und seit Version 2.6 verfügbar ist.</b>  <b>Ist es so?</b> <br><br>  Ja, meine Zusammenführungsanforderung wurde bereits akzeptiert.  Dies ist jedoch die erste Version, und es bleibt noch viel zu tun.  Verbesserungen werden bereits in Ruby 2.7 und noch mehr in Ruby 3 vorhanden sein. <br><br>  <b>Sag mir, wie du angefangen hast, in Ruby zu schreiben?</b> <br><br>  Zuerst habe ich mit Objective-C gearbeitet, aber es hat mir nicht wirklich gefallen.  Einmal musste eine Backend-Anwendung geschrieben werden, und Freunde empfahlen, Ruby On Rails auszuprobieren.  Ich habe genau das getan - und war sehr zufrieden mit dem Ergebnis!  Ich mochte die einfache und verständliche Syntax der Sprache und begann, sie tiefer zu studieren und zu verwenden. <br><br>  <b>Schreibst du jetzt in Ruby bei der Arbeit?</b> <br><br>  Ich bin seit ein paar Jahren bei Treasure Data.  Es ist eine Plattform, die Benutzerdaten in Clientanwendungen verfolgt.  Dieses Projekt wurde ursprünglich in Ruby On Rails geschrieben und mein Beitrag hieß "Ruby Developer".  Also habe ich viel in Ruby geschrieben.  Aber jetzt arbeite ich an einigen verteilten Diensten, die in Java und Kotlin geschrieben sind, und verwende manchmal auch Python. <br><br>  <b>Das Treasure Data-Projekt ist mit hoher Auslastung und Big Data verbunden.</b>  <b>Aber Ruby ist nicht die schnellste Sprache.</b>  <b>Wie haben Sie es geschafft, eine Hochlastanwendung zu erstellen, die mit Big Data auf der RoR-Plattform funktioniert?</b> <br><br>  Die Anwendung zeichnet Benutzerdaten auf und speichert sie im Speicher.  Es bietet auch eine Schnittstelle zum Abfragen von Daten in Sprachen wie Hive und Presto sowie ein Admin-Panel.  Es war kein Problem, alles auf Schienen zu schreiben.  Außerdem haben wir eine kompetente Infrastruktur geschaffen und können die Speicher- und Prozessorressourcen bei Spitzenlasten erhöhen.  Das Hauptproblem, das wir mit Ruby haben, ist, dass es nicht für paralleles Rechnen geeignet ist.  Und wir müssen Kotlin für diesen Zweck verwenden. <br><br>  <b>Warum liebst du Ruby?</b>  <b>Wenn es ein Projekt gäbe, das sowohl in Ruby als auch in Python implementiert werden könnte, welches würden Sie wählen?</b> <br><br>  Ich mag die saubere Ruby-Syntax, sie ist sehr lesbar und intuitiv.  Auf diese Weise können Sie schnell und einfach Anwendungslogik schreiben, was aus geschäftlicher Sicht wichtig ist.  Dies ist eine reine Objektsprache, ich weiß das wirklich zu schätzen.  Ich habe Erfahrung in Python, aber es scheint mir nicht so intuitiv.  Ich würde es nur für maschinelle Lernprojekte wählen. <br><br>  <b>Eine andere Sache, an der Sie in letzter Zeit gearbeitet haben, ist die Haml-Template-Engine ...</b> <br><br>  Ich habe bei einem früheren Job bei Haml und ERB gearbeitet.  Jetzt widme ich nicht zu viel Zeit dem, aber manchmal schaue ich mir in diesen Projekten Pull-Quests an. <br><br>  <b>Was halten Sie von den Perspektiven von Template-Engines wie Haml, Slim oder ERB im Allgemeinen, da in der modernen Welt die Tendenz besteht, die Vorder- und Rückseite vollständig in zwei verschiedene Anwendungen zu trennen und die Bildung von HTML-Seiten vollständig JavaScript zu überlassen?</b>  <b>Das heißt, in einer solchen Konfiguration werden Template-Engines völlig unnötig?</b> <br><br>  Ich bin damit einverstanden, dass es für Aufgaben mit einer komplexen Benutzeroberfläche sinnvoll ist, diese Logik in einer separaten Anwendung abzulegen.  Dies muss getan werden, um mit anderen Unternehmen zu konkurrieren, die die Komplexität und Funktionalität der Benutzeroberfläche zunehmend erhöhen.  Es besteht jedoch immer noch ein Bedarf an einfacheren und vor allem billigeren Lösungen, die sinnvoll sind, um mit klassischen Template-Engines auf RoR zu schreiben.  Sie sind also noch in Betrieb und werden lange verwendet. <br><br>  <b>Ich sehe, dass Sie in vielen Sprachen programmieren können, zumindest in Ruby, Python, Java, Kotlin und C. Ein guter Satz.</b>  <b>Können Sie Anfängern Ratschläge geben, wie man so viele Sprachen lernt?</b>  <b>Wie werde ich ein guter Programmierer?</b> <br><br>  Ich denke, dass die Effektivität des Trainings hoch sein wird, wenn die Sprache für die Aufgaben eines Programmierers geeignet ist.  Ruby eignet sich gut zum Schreiben von Webanwendungen, da die Arbeit mit Zeichenfolgen im Vergleich zu Java sehr einfach ist.  Python eignet sich besser für maschinelles Lernen (es verfügt über eine umfangreiche Infrastruktur in diesem Bereich).  Wenn Sie Python lernen möchten, würde ich empfehlen, maschinelle Lernaufgaben zu lösen, anstatt Webanwendungen zu schreiben.  Wenn Sie sich mehr für Java, Kotlin oder andere JVM-basierte Sprachen interessieren, empfehle ich, verteilte Systeme zu schreiben.  Ruby ist derzeit nicht gut für anspruchsvolles oder paralleles Computing geeignet.  Um solche Probleme in Ruby zu lösen, benötigen wir viele Prozesse, die viele Ressourcen verbrauchen, sodass sie nicht effektiv sind.  Die Verwendung geeigneter Tools für relevante Probleme hilft daher zu verstehen, warum dieses Tool auf diese Weise entwickelt wurde.  Dies wird dazu beitragen, sein Wesen besser zu verstehen. <br><br>  <b>Welche Bücher stehen ganz oben auf Ihrer persönlichen „Bewertung“?</b> <br><br>  Der erste ist Ruby unter dem Mikroskop.  Es ist sehr einfach geschrieben und beschreibt die Details des Dolmetschers.  Ein tiefes Verständnis der Funktionsweise des Dolmetschers hilft bei der Lösung komplexer Probleme und erhöht das Vertrauen in den Besitz des Werkzeugs, d. H.  Zunge.  Ich empfehle dieses Buch auch für Anfänger. <br><br>  Der zweite ist "Lesbarer Code".  Es geht seltsamerweise darum, wie man klaren Code schreibt :).  Wir schreiben viel Code und lesen viel Code, und wir müssen in der Lage sein, Code zu schreiben, den andere verstehen werden.  Und dafür müssen wir den Code aus dem Blickwinkel der Wahrnehmung eines anderen betrachten.  Bücher wie dieses helfen.  Ich empfehle es auch Anfängern.  Nun, das dritte Buch ... Dies ist ein japanisches Buch über die Anordnung des Prozessors, seine Architektur bis zu den Transistoren, aus denen er besteht.  Zu verstehen, wie ein Computer auf einem so niedrigen Niveau funktioniert, ist manchmal sehr nützlich, selbst wenn Probleme auf einem viel höheren Niveau gelöst werden.  Ich empfehle, jedes gute Buch über Mikroprozessordesign zu lesen, auch wenn dies auf den ersten Blick nicht offensichtlich erscheint. <br><br>  <b>Was erwarten Sie von Russland und der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RubyRussia-</a> Konferenz</b> ? <br><br>  Ich war noch nie in Russland.  Ich gehe davon aus, dass ich von allem viel Schönes sehen werde, zum Beispiel schöne Häuser, schöne Landschaften ... Außerdem sollte es in Russland kälter sein als in Japan.  Es wird für mich interessant sein, all diese Unterschiede zwischen unseren Ländern zu sehen und zu spüren. <br><br>  <b>Cool!</b>  <b>Ich kann Ihnen versichern, dass die Konferenz und die After-Party auch dann noch heiß sein werden, wenn es kalt ist (tatsächlich ist es Ende September bei uns nicht so kalt)!</b> <br><br>  Wir warten auch auf der Konferenz auf Sie!  Sie können Ihre Fragen am 28. September persönlich (und auf der legendären Afterparty :) stellen.  Das Programm ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">da</a> und das Ticket kostet jetzt 9.000 Rubel. <br><br>  Vielen Dank an die Unternehmen, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RubyRussia unterstützen</a> : <br><br>  Veranstalter - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Evrone</a> <br>  Komplementärin - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Toptal</a> <br>  Gold Partner - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gett</a> <br>  Silver Partners - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">JetBrains</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bookmate</a> <br>  Bronze Partner - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">InSales</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de466305/">https://habr.com/ru/post/de466305/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de466289/index.html">Legislative Initiativen. Seltsam, aber der Staatsduma vorgestellt</a></li>
<li><a href="../de466291/index.html">Nachhaltigkeitsumfrage der nationalen Internet-Segmente für 2019</a></li>
<li><a href="../de466295/index.html">Schmerzloser Fallback-Cache auf Scala</a></li>
<li><a href="../de466299/index.html">Russische Soziologen führten die weltweit erste Chatbots-Umfrage durch</a></li>
<li><a href="../de466301/index.html">Noch etwas: Haiku-App-Pakete?</a></li>
<li><a href="../de466307/index.html">Wie gestalte ich SCS?</a></li>
<li><a href="../de466311/index.html">SLS Workshop 6. September</a></li>
<li><a href="../de466315/index.html">@ Pythonetc-Zusammenstellung, August 2019</a></li>
<li><a href="../de466317/index.html">Tipps und Tricks von meinem Telegramm-Kanal @pythonetc, August 2019</a></li>
<li><a href="../de466319/index.html">Deal: VMware kauft Cloud-basierten Start</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>