<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯФж ЁЯФ░ ЁЯШо рд╣рдо рдбреЗрдЯрд╛рд╢реАрдЯреНрд╕ 2 рдкрдврд╝рддреЗ рд╣реИрдВ: рдПрд╕рдЯреАрдПрдо 32 рдкрд░ рдПрд╕рдкреАрдЖрдИ; PWM рдЯрд╛рдЗрдорд░ рдФрд░ STM8 рдкрд░ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░рддрд╛ рд╣реИ тЫДя╕П ЁЯЩО ЁЯН▒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ, рдореИрдВрдиреЗ рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХ рд╢реМрдХрд┐рдпреЛрдВ рдХреЛ рдпрд╣ рдмрддрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдХрд┐ рд╡реЗ рдЕрд░реБрдбрд┐рдиреЛ рдкреИрдВрдЯ рд╕реЗ рдХреИрд╕реЗ рдЖрдЧреЗ рдмрдврд╝реЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдорд╛рдЗрдХреНрд░реЛрдХрдВрдЯреНрд░реЛрд▓рд░ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╢реАрдЯ рдФрд░ рдЕрди...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╣рдо рдбреЗрдЯрд╛рд╢реАрдЯреНрд╕ 2 рдкрдврд╝рддреЗ рд╣реИрдВ: рдПрд╕рдЯреАрдПрдо 32 рдкрд░ рдПрд╕рдкреАрдЖрдИ; PWM рдЯрд╛рдЗрдорд░ рдФрд░ STM8 рдкрд░ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░рддрд╛ рд╣реИ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skyeng/blog/456094/"><p><img src="https://habrastorage.org/webt/zz/sh/fd/zzshfdfytuphbmlregcazfpxo2a.jpeg"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ,</a> рдореИрдВрдиреЗ рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХ рд╢реМрдХрд┐рдпреЛрдВ рдХреЛ рдпрд╣ рдмрддрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдХрд┐ рд╡реЗ рдЕрд░реБрдбрд┐рдиреЛ рдкреИрдВрдЯ рд╕реЗ рдХреИрд╕реЗ рдЖрдЧреЗ рдмрдврд╝реЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдорд╛рдЗрдХреНрд░реЛрдХрдВрдЯреНрд░реЛрд▓рд░ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╢реАрдЯ рдФрд░ рдЕрдиреНрдп рджрд╕реНрддрд╛рд╡реЗрдЬ рдХреНрдпреЛрдВ рдкрдврд╝рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдкрд╛рда рдмрдбрд╝рд╛ рдирд┐рдХрд▓рд╛, рдЗрд╕рд▓рд┐рдП рдореИрдВрдиреЗ рдПрдХ рдЕрд▓рдЧ рд▓реЗрдЦ рдореЗрдВ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рдиреЗ рдХрд╛ рд╡рд╛рджрд╛ рдХрд┐рдпрд╛ред  рдЦреИрд░, рдЙрд╕рдиреЗ рдЦреБрдж рдХреЛ рдПрдХ рдорд╛рд▓ рдХрд╣рд╛ ... </p><br><p>  рдЖрдЬ рдореИрдВ рджрд┐рдЦрд╛рдКрдВрдЧрд╛ рдХрд┐ рд╕рд░рд▓ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рд╢реАрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ, рд▓реЗрдХрд┐рди рдПрд╕рдЯреАрдПрдо 3 (рдмреНрд▓реВ рдкрд┐рд▓) рдФрд░ рдПрд╕рдЯреАрдПрдо 8 рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░, рдХрдИ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред  рд╕рднреА рдбреЗрдореЛ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрд░реЗ рдкрд╕рдВрджреАрджрд╛ рдПрд▓ рдИ рдбреА рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдкрд┐рдд рд╣реИрдВ, рд╣рдо рдЙрдиреНрд╣реЗрдВ рдмрдбрд╝реА рдорд╛рддреНрд░рд╛ рдореЗрдВ рдкреНрд░рдХрд╛рд╢ рдХрд░реЗрдВрдЧреЗ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рджрд┐рд▓рдЪрд╕реНрдк рдмрд╛рд╣реНрдп рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </p><a name="habracut"></a><br><p>  рдкрд╛рда рдлрд┐рд░ рд╕реЗ рд╡рд┐рд╢рд╛рд▓ рд╣реЛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП рдореИрдВ рд╕рд╛рдордЧреНрд░реА рдХрд░ рд░рд╣рд╛ рд╣реВрдВ: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">STM32 рдмреНрд▓реВ рдкрд┐рд▓: DM634 рдбреНрд░рд╛рдЗрд╡рд░ рдХреЗ рд╕рд╛рде 16 рдПрд▓ рдИ рдбреА</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">STM8: рд╕рд┐рдХреНрд╕ PWM рдкрд┐рди рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">STM8: 8 рдЖрд░рдЬреАрдмреА рддреАрди рдкрд┐рдиреЛрдВ рдкрд░ рдПрд▓рдИрдбреА, рдЗрдВрдЯрд░рдкреНрдЯ рдХрд░рддрд╛ рд╣реИ</a> </p><br><p>  <em>рдбрд┐рд╕реНрдХреНрд▓реЗрдорд░: рдореИрдВ рдПрдХ рдЗрдВрдЬреАрдирд┐рдпрд░ рдирд╣реАрдВ рд╣реВрдВ, рдореИрдВ рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХреНрд╕ рдореЗрдВ рдЧрд╣рд░рд╛ рдЬреНрдЮрд╛рди рд░рдЦрдиреЗ рдХрд╛ рджрд┐рдЦрд╛рд╡рд╛ рдирд╣реАрдВ рдХрд░рддрд╛, рдпрд╣ рд▓реЗрдЦ рдореЗрд░реЗ рдЬреИрд╕реЗ рдкреНрд░реЗрдорд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реИред</em>  <em>рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдПрдХ рд▓рдХреНрд╖рд┐рдд рджрд░реНрд╢рдХ рдХреЗ рд░реВрдк рдореЗрдВ, рдореИрдВрдиреЗ рдЦреБрдж рдХреЛ рджреЛ рд╕рд╛рд▓ рдкрд╣рд▓реЗ рдорд╛рдирд╛ рдерд╛ред</em>  <em>рдЕрдЧрд░ рдХреЛрдИ рдореБрдЭрд╕реЗ рдХрд╣рддрд╛ рд╣реИ рдХрд┐ рдЕрдкрд░рд┐рдЪрд┐рдд рдЪрд┐рдк рдкрд░ рдбреЗрдЯрд╛рд╢реАрдЯ рдкрдврд╝рдирд╛ рдбрд░рд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реИ, рддреЛ рдореИрдВрдиреЗ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдХреЛрдб рдХреЗ рдХреБрдЫ рдЯреБрдХрдбрд╝реЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдФрд░ рдХреИрдВрдЪреА рдФрд░ рдПрдХ рдмреИрдВрдб-рд╕рд╣рд╛рдпрддрд╛ рдХреЗ рд╕рд╛рде рдмреИрд╕рд╛рдЦреА рдХрд╛ рдЖрд╡рд┐рд╖реНрдХрд╛рд░ рдХрд░рдиреЗ рдореЗрдВ рдмрд╣реБрдд рд╕рдордп рдирд╣реАрдВ рдмрд┐рддрд╛рдпрд╛ рд╣реЛрдЧрд╛ред</em> </p><br><p>  <em>рдЗрд╕ рд▓реЗрдЦ рдХреЗ рдХреЗрдВрджреНрд░ рдореЗрдВ рдбреЗрдЯрд╛рд╢реАрдЯ рд╣реИрдВ, рдкрд░рд┐рдпреЛрдЬрдирд╛рдПрдВ рдирд╣реАрдВ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдХреЛрдб рдмрд╣реБрдд рдХрдВрдШреА рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрдХреНрд╕рд░ рдмреИрд╕рд╛рдЦреАред</em>  <em>рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реНрд╡рдпрдВ рдмрд╣реБрдд рд╕рд░рд▓ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдирдИ рдЪрд┐рдк рдХреЗ рд╕рд╛рде рдкрд╣рд▓реЗ рдкрд░рд┐рдЪрд┐рдд рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИрдВред</em> </p><br><p>  <em>рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдореЗрд░рд╛ рд▓реЗрдЦ рдПрдХ рд╢реМрдХреАрди рдЧреЛрддрд╛ рдореЗрдВ рдПрдХ рд╕рдорд╛рди рдордВрдЪ рдкрд░ рдХрд┐рд╕реА рдХреА рдорджрдж рдХрд░реЗрдЧрд╛ред</em> </p><br><h1 id="stm32">  STM32 </h1><br><h1 id="16-svetodiodov-c-dm634-i-spi">  DM634 рдФрд░ SPI рдХреЗ рд╕рд╛рде 16 рдПрд▓ рдИ рдбреА </h1><br><p>  рдмреНрд▓реВ рдкрд┐рд▓ (STM32F103C8T6) рдФрд░ DM634 рдПрд▓рдИрдбреА рдбреНрд░рд╛рдЗрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рдПрдХ рдЫреЛрдЯреА рдкрд░рд┐рдпреЛрдЬрдирд╛ред  рдбреЗрдЯрд╛рд╢реАрдЯреНрд╕ рдХреА рдорджрдж рд╕реЗ рд╣рдо рдбреНрд░рд╛рдЗрд╡рд░, рдЖрдИрдУ-рдкреЛрд░реНрдЯ рдПрд╕рдЯреАрдПрдо рд╕реЗ рдирд┐рдкрдЯреЗрдВрдЧреЗ рдФрд░ рдПрд╕рдкреАрдЖрдИ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВрдЧреЗред </p><br><h2 id="dm634">  DM634 </h2><br><p>  16 16-рдмрд┐рдЯ рдкреАрдбрдмреНрд▓реВрдПрдо рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд╕рд╛рде рддрд╛рдЗрд╡рд╛рди рдХреА рдЪрд┐рдк рдХреЛ рдЬрдВрдЬреАрд░реЛрдВ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ 12-рдмрд┐рдЯ рдореЙрдбрд▓ рдШрд░реЗрд▓реВ рдкреНрд░реЛрдЬреЗрдХреНрдЯ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рд╛рдЗрдЯрдкреИрдХ рдХреЗ</a> рд▓рд┐рдП рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред  рдПрдХ рд╕рдордп рдореЗрдВ, DM63x рдФрд░ рдЬрд╛рдиреЗ-рдорд╛рдиреЗ TLC5940 рдХреЗ рдмреАрдЪ рдЪрдпрди рдХрд░рддреЗ рд╣реБрдП, рдореИрдВ рдХрдИ рдХрд╛рд░рдгреЛрдВ рд╕реЗ DM рдкрд░ рдЖрдХрд░ рдмрд╕ рдЧрдпрд╛: 1) Aliexpress рдкрд░ TLC рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдирдХрд▓реА рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдПрдХ рдирд╣реАрдВ рд╣реИ;  2) рдбреАрдПрдо рдХреЗ рдкрд╛рд╕ рд╕реНрд╡рдпрдВ рдХреА рдЖрд╡реГрддреНрддрд┐ рдЬрдирд░реЗрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реНрд╡рд╛рдпрддреНрдд PWM рд╣реИ;  3) рдпрд╣ рдорд╛рд╕реНрдХреЛ рдореЗрдВ рд╕рд╕реНрддреЗ рдореЗрдВ рдЦрд░реАрджрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЕрд▓реА рдХреЗ рд╕рд╛рде рдкрд╛рд░реНрд╕рд▓ рдХреЗ рд▓рд┐рдП рдЗрдВрддрдЬрд╛рд░ рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЦреИрд░, рдЬрд╝рд╛рд╣рд┐рд░ рд╣реИ, рдпрд╣ рд╕реАрдЦрдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рдерд╛ рдХрд┐ рдЪрд┐рдк рдХреЛ рдХреИрд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП, рдФрд░ рдПрдХ рддреИрдпрд╛рд░ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВред  рдЪрд┐рдкреНрд╕ рдЕрдм рдореБрдЦреНрдп рд░реВрдк рд╕реЗ SSOP24 рдкреИрдХреЗрдЬ рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдП рдЧрдП рд╣реИрдВ, рд╡реЗ рдПрдбреЗрдкреНрдЯрд░ рдХреЗ рд▓рд┐рдП рдЖрд╕рд╛рди рд╣реИрдВред </p><br><p>  рдЪреВрдВрдХрд┐ рдирд┐рд░реНрдорд╛рддрд╛ рддрд╛рдЗрд╡рд╛рдиреА рд╣реИ, рдЪрд┐рдк рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбреЗрдЯрд╛рд╢реАрдЯ</a> рдЪреАрдиреА рдЕрдВрдЧреНрд░реЗрдЬреА рдореЗрдВ рд▓рд┐рдЦреА рдЧрдИ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдпрд╣ рдордЬреЗрджрд╛рд░ рд╣реЛрдЧрд╛ред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, <em>рдкрд┐рди рдХрдиреЗрдХреНрд╢рди</em> ( <em>рдкрд┐рди рдХрдиреЗрдХреНрд╢рди</em> ) рдХреЛ рджреЗрдЦреЗрдВ, рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХрд┐рд╕ рдкреИрд░ рдХреЛ <em>рдкрд┐рди</em> рд╕реЗ рдЬреЛрдбрд╝рдирд╛ рд╣реИ рдФрд░ <em>рдкрд┐рди рдХрд╛ рд╡рд┐рд╡рд░рдг</em> ( <em>рдкрд┐рди рд╡рд┐рд╡рд░рдг</em> )ред  16 рдирд┐рд╖реНрдХрд░реНрд╖: </p><br><p><img src="https://habrastorage.org/webt/uj/n8/mo/ujn8mooelrxoxg7xzvvfsdh4er8.png"><br>  <sup>рдкреНрд░рддреНрдпрдХреНрд╖ рд╡рд┐рджреНрдпреБрдд рдкреНрд░рд╡рд╛рд╣ рдХреЗ рд╕реНрд░реЛрдд (рдЦреБрд▓реА рдирд╛рд▓реА)</sup> </p><br><p>  <strong>рд╕рд┐рдВрдХ</strong> / <strong>рдУрдкрди-рдбреНрд░реЗрди рдЖрдЙрдЯрдкреБрдЯ</strong> - рдирд╛рд▓реА;  рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╡рд░реНрддрдорд╛рди рдХрд╛ рд╕реНрд░реЛрдд;  рд╕рдХреНрд░рд┐рдп рдЖрдЙрдЯрдкреБрдЯ рдЬрдореАрди рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реИрдВ - рдПрд▓ рдИ рдбреА рдЪрд╛рд▓рдХ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реИрдВ рдХреИрдереЛрдбреНрд╕ рджреНрд╡рд╛рд░рд╛ред  рд╡рд┐рджреНрдпреБрдд рд░реВрдк рд╕реЗ, рдпрд╣, рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ, "рдЦреБрд▓реА рдирд╛рд▓реА" рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдбреЗрдЯрд╢реАрдЯ рдореЗрдВ рдбреНрд░реЗрди рдореЛрдб рдореЗрдВ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд▓рд┐рдП рдпрд╣ рдкрджрдирд╛рдо рдЖрдо рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/yk/bq/p4/ykbqp4ivabirkgahd2d7l_9gjny.png"><br>  <sup>рдЖрдЙрдЯрдкреБрдЯ рд╡рд░реНрддрдорд╛рди рдорд╛рди рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП REXT рдФрд░ GND рдХреЗ рдмреАрдЪ рдмрд╛рд╣рд░реА рдкреНрд░рддрд┐рд░реЛрдзрдХ</sup> </p><br><p>  рд░реЗрдлрд╝рд░ рдкрд┐рди рдФрд░ рдЧреНрд░рд╛рдЙрдВрдб рдХреЗ рдмреАрдЪ рдПрдХ рд░реЗрдлрд╝рд░реЗрдВрд╕ рд░реЗрдЬрд╝рд░ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рдЖрдВрддрд░рд┐рдХ рдкреНрд░рддрд┐рд░реЛрдз рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдбреЗрдЯрд╛рд╢реАрдЯ рдХреЗ рдкреЗрдЬ 9 рдкрд░ рдЧреНрд░рд╛рдл рдХреЛ рджреЗрдЦреЗрдВред  DM634 рдореЗрдВ, <em>рд╡реИрд╢реНрд╡рд┐рдХ рдЪрдордХ</em> рд╕реЗрдЯ рдХрд░рдХреЗ рдЗрд╕ рдкреНрд░рддрд┐рд░реЛрдз рдХреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ;  рдореИрдВ рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдореЗрдВ рдирд╣реАрдВ рдЬрд╛рдКрдВрдЧрд╛, рдореИрдВрдиреЗ рдпрд╣рд╛рдВ рдПрдХ 2.2 - 3 kOhm рд░реЛрдХрдиреЗрд╡рд╛рд▓рд╛ рдбрд╛рд▓ рджрд┐рдпрд╛ред </p><br><p>  рдЪрд┐рдк рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП, рдбрд┐рд╡рд╛рдЗрд╕ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рд╡рд┐рд╡рд░рдг рдХреЛ рджреЗрдЦреЗрдВ: </p><br><p><img src="https://habrastorage.org/webt/7s/5n/to/7s5ntogguqr1yb6fu2l5pchaob8.png"></p><br><p>  рд╣рд╛рдБ, рдпрд╣рд╛рдБ рдпрд╣ рд╣реИ, рдЪреАрдиреА рдЕрдВрдЧреНрд░реЗрдЬреА рдЕрдкрдиреА рдорд╣рд┐рдорд╛ рдореЗрдВред  рдЕрдиреБрд╡рд╛рдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╕рдорд╕реНрдпрд╛рдЧреНрд░рд╕реНрдд рд╣реИ, рдЖрдк рдЪрд╛рд╣реЗрдВ рддреЛ рдЗрд╕реЗ рд╕рдордЭ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ - рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдбреЗрдЯрд╛рд╢реАрдЯ рдореЗрдВ рдХрд╛рд░реНрдпрд╛рддреНрдордХ TLC5940 рдХреЗ рдХрд░реАрдм рдХреИрд╕реЗ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/qi/za/j2/qizaj2wq08ppbzehiszsd2spqz8.png"><br>  <sub>... рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдВ рдбреЗрдЯрд╛ рджрд░реНрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рддреАрди рдкрд┐рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред</sub>  <sub>SCLK рд╕рд┐рдЧреНрдирд▓ рдХрд╛ рдкреНрд░рдореБрдЦ рдХрд┐рдирд╛рд░рд╛ SIN рдкрд┐рди рд╕реЗ рдЖрдВрддрд░рд┐рдХ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рдбреЗрдЯрд╛ рд╢рд┐рдлреНрдЯ рдХрд░рддрд╛ рд╣реИред</sub>  <sub>рд╕рднреА рдбреЗрдЯрд╛ рдбрд╛рдЙрдирд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдПрдХ рдЫреЛрдЯрд╛ рдЙрдЪреНрдЪ XLAT рд╕рд┐рдЧреНрдирд▓ рдЖрдВрддрд░рд┐рдХ рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдореЗрдВ рд╕реАрд░рд┐рдпрд▓ рдбреЗрдЯрд╛ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рддрд╛ рд╣реИред</sub>  <sub>рдЖрдВрддрд░рд┐рдХ рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ - рдПрдХреНрд╕рдПрд▓рдПрдЯреА-рдЯреНрд░рд┐рдЧрд░ рдЧреЗрдЯ рд╡рд╛рд▓реНрд╡ред</sub>  <sub>рд╕рднреА рдбреЗрдЯрд╛ рдХреЛ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдЯ рдлреЙрд░рд╡рд░реНрдб рдореЗрдВ рдкреНрд░реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</sub> </p><br><p>  <strong>рдХреБрдВрдбреА</strong> - рдПрдХ рдХреБрдВрдбреА / рдХреБрдВрдбреА / рджрдмрд╛рдирд╛ред <br>  <strong>рдмрдврд╝рддреА рдмрдврд╝рдд</strong> - рдЖрд╡реЗрдЧ рдХреЗ рдЕрдЧреНрд░рдгреА рдХрд┐рдирд╛рд░реЗ <br>  <strong>MSB рдкрд╣рд▓реЗ</strong> - <strong>рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг</strong> ( <strong>рд╕рдмрд╕реЗ</strong> рдмрд╛рдИрдВ рдУрд░) рдереЛрдбрд╝рд╛ рдЖрдЧреЗред <br>  <strong>рдШрдбрд╝реА рдбреЗрдЯрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП</strong> - рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ (рдмрд┐рдЯрд╡рд╛рдЗрдЬрд╝) рдбреЗрдЯрд╛ рд╕рдВрдЪрд╛рд░рд┐рдд рдХрд░реЗрдВред </p><br><p>  рд╢рдмреНрдж <em>рдХреБрдВрдбреА</em> рдЕрдХреНрд╕рд░ рдЪрд┐рдкреНрд╕ рдХреЗ рд▓рд┐рдП рдкреНрд░рд▓реЗрдЦрди рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рд╕реЗ рдЕрдиреБрд╡рд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдореИрдВ рдЦреБрдж рдХреЛ рд╕рдордЭрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реВрдВ </p><div class="spoiler">  <b class="spoiler_title">рдЫреЛрдЯреЗ рд╢реИрдХреНрд╖рд┐рдХ рдХрд╛рд░реНрдпрдХреНрд░рдо</b> <div class="spoiler_text">  рдПрд▓рдИрдбреА рдбреНрд░рд╛рдЗрд╡рд░ рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ рдПрдХ рд╢рд┐рдлреНрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ рд╣реИред  рдирд╛рдо рдореЗрдВ "рд╢рд┐рдлреНрдЯ" рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдЕрдВрджрд░ рдбреЗрдЯрд╛ рдХрд╛ рдПрдХ рдмрд┐рдЯрд╡рд╛рдЗрдЬрд╝ рдореВрд╡рдореЗрдВрдЯ рд╣реИ: рдкреНрд░рддреНрдпреЗрдХ рдирдпрд╛ рдмрд┐рдЯ рдЗрдирд╡рд░реНрдб рдЕрдкрдиреЗ рд╕рд╛рдордиреЗ рдкреВрд░реА рдЪреЗрди рдХреЛ рд╣рд┐рд▓рд╛рддрд╛ рд╣реИред  рдЪреВрдВрдХрд┐ рдХреЛрдИ рднреА рд╢рд┐рдлреНрдЯ рдХреЗ рджреМрд░рд╛рди рдПрд▓ рдИ рдбреА рдХреА рдЕрд░рд╛рдЬрдХ рдЪрдордХрддреА рджреЗрдЦрдирд╛ рдирд╣реАрдВ рдЪрд╛рд╣рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдлрд░ рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдореЗрдВ рд╣реЛрддреА рд╣реИ рдЬреЛ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЛрдВ рд╕реЗ рдПрдХ <em>рдХреБрдВрдбреА</em> рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ - рдпрд╣ рдПрдХ рддрд░рд╣ рдХрд╛ рд╡реЗрдЯрд┐рдВрдЧ рд░реВрдо рд╣реИ, рдЬрд╣рд╛рдВ рдмрд┐рдЯреНрд╕ рд╕рд╣реА рдХреНрд░рдо рдореЗрдВ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рд╣реЛрддреЗ рд╣реИрдВред  рдЬрдм рд╕рдм рдХреБрдЫ рддреИрдпрд╛рд░ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╢рдЯрд░ рдЦреБрд▓рддрд╛ рд╣реИ, рдФрд░ рдмрд┐рдЯреНрд╕ рдХреЛ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкрд┐рдЫрд▓реЗ рдмреИрдЪ рдХреА рдЬрдЧрд╣ред  <em>рдорд╛рдЗрдХреНрд░реЛрдХреНрд░рд┐рд╕реНрдХрд┐рдЯреНрд╕</em> рдХреЗ рд▓рд┐рдП рдкреНрд░рд▓реЗрдЦрди рдореЗрдВ <em>рдХреБрдВрдбреА</em> рд╢рдмреНрдж рд▓рдЧрднрдЧ рд╣рдореЗрд╢рд╛ рдПрдХ рдРрд╕реЗ рдиреБрдХрд╕рд╛рди рдХрд╛ рддрд╛рддреНрдкрд░реНрдп рдХрд░рддрд╛ рд╣реИ, рдХреЛрдИ рдлрд░реНрдХ рдирд╣реАрдВ рдкрдбрд╝рддрд╛ рдХрд┐ рдпрд╣ рдХрд┐рд╕ рд╕рдВрдпреЛрдЬрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </div></div><br><p>  рдЗрд╕рд▓рд┐рдП, DM634 рдХреЛ рдбреЗрдЯрд╛ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд╣реИ: DAI рдЗрдирдкреБрдЯ рдХреЛ рдЙрдЪреНрдЪ рдПрд▓рдИрдбреА рдХреЗ рдЙрдЪреНрдЪ-рдХреНрд░рдо рдмрд┐рдЯ рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВ, DCK рдХреЛ рдКрдкрд░ рдФрд░ рдиреАрдЪреЗ рдЦреАрдВрдЪреЗрдВ;  рдЕрдЧрд▓реЗ рдмрд┐рдЯ рдореЗрдВ DAI рдЗрдирдкреБрдЯ рд╕реЗрдЯ рдХрд░реЗрдВ, DCK рдЦреАрдВрдЪреЗрдВ;  рдФрд░ рдЗрд╕реА рддрд░рд╣, рдЬрдм рддрдХ рдХрд┐ рд╕рднреА рдмрд┐рдЯреНрд╕ рд╕рдВрдЪрд░рд┐рдд ( <em>рдХреНрд▓реЙрдХ рдХрд┐рдП рдЧрдП</em> ) рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд╣рдо LAT рдЦреАрдВрдЪрддреЗ рд╣реИрдВред  рдпрд╣ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ ( <em>рдмрд┐рдЯ-рдмреИрдВрдЧ</em> ) рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рддреЗрдЬ рдПрд╕рдкреАрдЖрдИ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рджреЛ рдкреНрд░рддрд┐рдпреЛрдВ рдореЗрдВ рд╣рдорд╛рд░реА рдПрд╕рдЯреАрдПрдо 32 рдкрд░ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </p><br><h2 id="sinyaya-tabletka-stm32f103">  рдмреНрд▓реВ рдЯреИрдмрд▓реЗрдЯ STM32F103 </h2><br><p>  рдкрд░рд┐рдЪрдпрд╛рддреНрдордХ: STM32 рдирд┐рдпрдВрддреНрд░рдХ Atmega328 рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИрдВ рдЬрд┐рддрдирд╛ рд╡реЗ рдбрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЙрд╕реА рд╕рдордп, рдКрд░реНрдЬрд╛ рдХреА рдмрдЪрдд рдХреЗ рдХрд╛рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП, рд▓рдЧрднрдЧ рд╕рднреА рдмрд╛рд╣реНрдп рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рд╢реБрд░реВ рдореЗрдВ рдЕрдХреНрд╖рдо рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдПрдХ рдЖрдВрддрд░рд┐рдХ рд╕реНрд░реЛрдд рд╕реЗ рдШрдбрд╝реА рдХреА рдЖрд╡реГрддреНрддрд┐ 8 рдореЗрдЧрд╛рд╣рд░реНрдЯреНрдЬ рд╣реИред  рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, рдПрд╕рдЯреАрдПрдо рдкреНрд░реЛрдЧреНрд░рд╛рдорд░реНрд╕ рдиреЗ рдХреЛрдб рд▓рд┐рдЦрд╛ рдерд╛ рдЬреЛ рдЪрд┐рдк рдХреЛ "рдЧрдгрдирд╛" 72 рдореЗрдЧрд╛рд╣рд░реНрдЯреНрдЬ рдореЗрдВ рд▓рд╛рдпрд╛ рдерд╛, рдФрд░ рд╕рднреА рдЖрдИрдбреАрдИ рдХреЗ рд▓реЗрдЦрдХреЛрдВ рдХреЛ рдореИрдВ рдЬрд╛рдирддрд╛ рдерд╛ рдХрд┐ рдЗрд╕реЗ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдШрдбрд╝реА рдХреА рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ (рд▓реЗрдХрд┐рди <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрдЧрд░ рдЖрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ</a> )  рд▓реЗрдХрд┐рди рдЖрдкрдХреЛ рдкрд░рд┐рдзреАрдпреЛрдВ рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </p><br><p>  рдкреНрд░рд▓реЗрдЦрди: рд▓реЛрдХрдкреНрд░рд┐рдп STM32F103C8T6 рдЪрд┐рдк рдмреНрд▓реВ рдкрд┐рд▓ рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рд╣реИ, рдЗрд╕рдХреЗ рд▓рд┐рдП рджреЛ рдЙрдкрдпреЛрдЧреА рджрд╕реНрддрд╛рд╡реЗрдЬ рд╣реИрдВ: </p><br><ul><li>  STM32F103x8 рдФрд░ STM32F103xB рдорд╛рдЗрдХреНрд░реЛрдХрдВрдЯреНрд░реЛрд▓рд░ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбреЗрдЯрд╛ рд╢реАрдЯ</a> ; </li><li>  рд╕рдВрдкреВрд░реНрдг STM32F103 рд▓рд╛рдЗрди рдФрд░ рдЙрд╕рд╕реЗ рдЖрдЧреЗ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдВрджрд░реНрдн рдореИрдиреБрдЕрд▓</a> ред </li></ul><br><p>  рдПрдХ рдбреЗрдЯрд╛рд╢реАрдЯ рдореЗрдВ рд╣рдорд╛рд░реА рд░реБрдЪрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИ: </p><br><ul><li>  рдкрд┐рдирдЖрдЙрдЯ - рдЪрд┐рдкреНрд╕ рдХреЗ рдкрд┐рдирдЖрдЙрдЯ - рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рдо рдЦреБрдж рдХреЛ рдмреЛрд░реНрдб рдмрдирд╛рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд░рддреЗ рд╣реИрдВ; </li><li>  рдореЗрдореЛрд░реА рдореИрдк - рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЪрд┐рдк рдХреЗ рд▓рд┐рдП рдореЗрдореЛрд░реА рдХрд╛рд░реНрдбред  рд░реЗрдлрд░реЗрдВрд╕ рдореИрдиреБрдЕрд▓ рдореЗрдВ рдкреВрд░реА рд▓рд╛рдЗрди рдХреЗ рд▓рд┐рдП рдПрдХ рдХрд╛рд░реНрдб рд╣реЛрддрд╛ рд╣реИ, рдпрд╣ рдЙрди рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдирд╣реАрдВ рд╣реИрдВред </li><li>  рдЯреЗрдмрд▓ рдкрд┐рди рдкрд░рд┐рднрд╛рд╖рд╛рдПрдБ - рдкрд┐рдВрд╕ рдХреЗ рдореБрдЦреНрдп рдФрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдирд╛;  рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ "рдиреАрд▓реА рдЧреЛрд▓реА" рдХреЗ рд▓рд┐рдП рдЖрдк рдкрд┐рди рдФрд░ рдЙрдирдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреА рд╕реВрдЪреА рдХреЗ рд╕рд╛рде рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдЪрд┐рддреНрд░ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕рд▓рд┐рдП, рддреБрд░рдВрдд рдмреНрд▓реВ рдкрд┐рд▓ рдкрд┐рдирдЖрдЙрдЯ рдХрд░реЗрдВ рдФрд░ рдЗрд╕ рддрд╕реНрд╡реАрд░ рдХреЛ рд╣рд╛рде рдореЗрдВ рд░рдЦреЗрдВ: </li></ul><br><p><img src="https://habrastorage.org/webt/_q/q_/o4/_qq_o4hwzc3k1nzqluqtaqpuye0.png"><br>  <em>рдирд╛рдпрдм: рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рддрд╕реНрд╡реАрд░ рдореЗрдВ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдореЗрдВ рдПрдХ рддреНрд░реБрдЯрд┐ рджреЗрдЦреА рдЧрдИ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджред</em>  <em>рддрд╕реНрд╡реАрд░ рдХреЛ рдмрджрд▓ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдПрдХ рд╕рдмрдХ рд╣реИ - рдЧреИрд░-рдбреЗрдЯрд╛рд╢реАрдЯ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИред</em> </p><br><p>  рд╣рдо рдбреЗрдЯрд╛рд╢реАрдЯ рдХреЛ рд╣рдЯрд╛рддреЗ рд╣реИрдВ, рд╕рдВрджрд░реНрдн рдореИрдиреБрдЕрд▓ рдХреЛ рдЦреЛрд▓рддреЗ рд╣реИрдВ, рдЕрдм рд╣рдо рдХреЗрд╡рд▓ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред <br>  рдкреНрд░рдХреНрд░рд┐рдпрд╛: рд╣рдо рдорд╛рдирдХ рдЗрдирдкреБрдЯ / рдЖрдЙрдЯрдкреБрдЯ рд╕реЗ рдирд┐рдкрдЯрддреЗ рд╣реИрдВ, рдПрд╕рдкреАрдЖрдИ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ, рд╡рд╛рдВрдЫрд┐рдд рдмрд╛рд╣реНрдп рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдЪрд╛рд▓реВ рдХрд░рддреЗ рд╣реИрдВред </p><br><h3 id="vvod-vyvod">  рдЗрдирдкреБрдЯ-рдЖрдЙрдЯрдкреБрдЯ </h3><br><p>  Atmega328 I / O рдмреЗрд╣рдж рд╕рд░рд▓ рд╣реИ, рдпрд╣реА рд╡рдЬрд╣ рд╣реИ рдХрд┐ STM32 рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреА рдкреНрд░рдЪреБрд░рддрд╛ рднреНрд░рд╛рдордХ рд╣реЛ рд╕рдХрддреА рд╣реИред  рдЕрдм рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдирд┐рд╖реНрдХрд░реНрд╖ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЪрд╛рд░ рд╡рд┐рдХрд▓реНрдк рднреА рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/qv/ao/t6/qvaot6ql0b4z6c0bvv71dumovji.png"><br>  <sub>рдУрдкрди рдбреНрд░реЗрди рдЖрдЙрдЯрдкреБрдЯ, рдкреБрд╢-рдкреБрд▓ рдЖрдЙрдЯрдкреБрдЯ, рд╡реИрдХрд▓реНрдкрд┐рдХ рдкреБрд╢-рдкреБрд▓ рдЖрдЙрдЯрдкреБрдЯ, рд╡реИрдХрд▓реНрдкрд┐рдХ рдУрдкрди рдбреНрд░реЗрди</sub> </p><br><p>  " <em>рдкреБрд╢-рдкреБрд▓</em> " ( <em>рдкреБрд╢-рдкреБрд▓</em> ) - рдЕрд░реБрдбрд┐рдирд╛ рд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рдирд┐рд╖реНрдХрд░реНрд╖, рдкрд┐рди рдпрд╛ рддреЛ рдЙрдЪреНрдЪ рдпрд╛ рдХрдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди "рдЦреБрд▓реА рдирд╛рд▓реА" рдХреЗ рд╕рд╛рде <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрдард┐рдирд╛рдЗрдпрд╛рдВ рд╣реИрдВ</a> , рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдпрд╣рд╛рдВ рд╕рдм рдХреБрдЫ рд╕рд░рд▓ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/qa/e-/al/qae-alom88ushdmghd8wcu2l0q4.png"><br><img src="https://habrastorage.org/webt/en/oh/ny/enohnyxpb5u8cs4_t_m-cmtxbwy.png"><br>  <sub>рдЖрдЙрдЯрдкреБрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди / рдЬрдм рдкреЛрд░реНрдЯ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рд╕реМрдВрдкрд╛ рдЧрдпрд╛ рд╣реИ: / рдЖрдЙрдЯрдкреБрдЯ рдмрдлрд░ рдЪрд╛рд▓реВ рд╣реИ: / - рдУрдкрди рдбреНрд░реЗрди рдореЛрдб: "0" рдЖрдЙрдЯрдкреБрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рдПрди-рдПрдордУрдПрд╕ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИ, "1" рдЖрдЙрдЯрдкреБрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ (рдкреА-рдПрдордУрдПрд╕) рдореЗрдВ рдкреЛрд░реНрдЯ рдХреЛ рд╣рд╛рдп-рдЬреЗрдб рдореЛрдб рдореЗрдВ рд╕рдХреНрд░рд┐рдп рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ ) / - "рдкреБрд▓-рдкреБрд╢" рдореЛрдб: "0" рдЖрдЙрдЯрдкреБрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ N-MOS рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИ, "1" рдЖрдЙрдЯрдкреБрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ P-MOS рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИред</sub> </p><br><p>  рдУрдкрди рдбреНрд░реЗрди рдФрд░ <em>рдкреБрд╢-рдкреБрд▓ рдХреЗ</em> рдмреАрдЪ рдХрд╛ рд╕рд╛рд░рд╛ рдЕрдВрддрд░ рдпрд╣ рд╣реИ рдХрд┐ рдкрд╣рд▓реА рдкрд┐рди рдореЗрдВ рдпрд╣ рд╣рд╛рдИ рд╕реНрдЯреЗрдЯ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛: рдЖрдЙрдЯрдкреБрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рдПрдХ рдпреВрдирд┐рдЯ рд▓рд┐рдЦрддреЗ рд╕рдордп, рдпрд╣ <em>рдЙрдЪреНрдЪ рдкреНрд░рддрд┐рдмрд╛рдзрд╛ рдореЗрдВ рдмрджрд▓ рдЬрд╛рддрд╛ рд╣реИ</em> , <em>рд╣рд╛рдп -Z</em> )ред  рд╢реВрдиреНрдп рд░рд┐рдХреЙрд░реНрдб рдХрд░рддреЗ рд╕рдордп, рджреЛрдиреЛрдВ рдореЛрдб рдореЗрдВ рдкрд┐рди рд╕рдорд╛рди рд░реВрдк рд╕реЗ рдФрд░ рд╡рд┐рджреНрдпреБрдд рджреЛрдиреЛрдВ рддрд░рд╣ рд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИред </p><br><p>  рд╕рд╛рдорд╛рдиреНрдп рдЖрдЙрдЯрдкреБрдЯ рдореЛрдб рдореЗрдВ, рдкрд┐рди рдмрд╕ рдЖрдЙрдЯрдкреБрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ рдХреА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдХрд░рддрд╛ рд╣реИред  "рд╡реИрдХрд▓реНрдкрд┐рдХ" рдореЗрдВ рдЗрд╕реЗ рдЗрд╕реА рдкрд░рд┐рдзрд┐ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рджреЗрдЦреЗрдВ 9.1.4): </p><br><p><img src="https://habrastorage.org/webt/wu/mz/fv/wumzfvlk-fueikoig1wg6npj59u.png"><br>  <sub>рдпрджрд┐ рдкреЛрд░реНрдЯ рдмрд┐рдЯ рдХреЛ рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдВрдХреНрд╢рди рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдЙрдЯрдкреБрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ рдЕрдХреНрд╖рдо рд╣реИ рдФрд░ рдкрд┐рди рдкрд░рд┐рдзреАрдп рдЖрдЙрдЯрдкреБрдЯ рд╕рд┐рдЧреНрдирд▓ рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реИ</sub> </p><br><p>  рдкреНрд░рддреНрдпреЗрдХ рдкрд┐рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ <em>рдкрд┐рди рдкрд░рд┐рднрд╛рд╖рд╛рдПрдБ</em> рдбреЗрдЯрд╢реАрдЯ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рд╣реИ рдФрд░ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рддрд╕реНрд╡реАрд░ рдкрд░ рд╣реИред  рдпрд╣ рдкреВрдЫреЗ рдЬрд╛рдиреЗ рдкрд░ рдХрд┐ рдпрджрд┐ рдкрд┐рди рдХреЗ рдХрдИ рд╡реИрдХрд▓реНрдкрд┐рдХ рдХрд╛рд░реНрдп рд╣реИрдВ, рддреЛ рдЙрддреНрддрд░ рдбреЗрдЯрд╢реАрдЯ рдореЗрдВ рдПрдХ рдлреБрдЯрдиреЛрдЯ рджреЗрддрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/g1/hq/mi/g1hqmixkcdtdiius8u45hjfzagy.png"><br>  <sub>рдпрджрд┐ рдХрдИ рдкрд░рд┐рдзреАрдп рдЗрдХрд╛рдЗрдпрд╛рдВ рдПрдХ рд╣реА рдкрд┐рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВ, рддреЛ рд╡реИрдХрд▓реНрдкрд┐рдХ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдШрд░реНрд╖ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдкрд░рд┐рдзреАрдп рдШрдбрд╝реА рд╕рдХреНрд░рд┐рдпрдг рдмрд┐рдЯ (рдЗрд╕реА рдЖрд░рд╕реАрд╕реА рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╕рдордп рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдкрд░рд┐рдзреАрдп рдЗрдХрд╛рдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред</sub> </p><br><p>  рдЕрдВрдд рдореЗрдВ, рдЖрдЙрдЯрдкреБрдЯ рдореЛрдб рдореЗрдВ рдкрд┐рди рдХреА рднреА рдШрдбрд╝реА рдХреА рдЧрддрд┐ рд╣реЛрддреА рд╣реИред  рдпрд╣ рдПрдХ рдФрд░ рдКрд░реНрдЬрд╛ рдмрдЪрдд рд╕реБрд╡рд┐рдзрд╛ рд╣реИ, рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рдЗрд╕реЗ рдЕрдзрд┐рдХрддрдо рдкрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рднреВрд▓ рдЬрд╛рддреЗ рд╣реИрдВред </p><br><p>  рдЗрд╕рд▓рд┐рдП: рд╣рдо SPI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рджреЛ рдкрд┐рди (рдбреЗрдЯрд╛ рдФрд░ рдПрдХ рдШрдбрд╝реА рд╕рдВрдХреЗрдд рдХреЗ рд╕рд╛рде) рдПрдХ "рд╡реИрдХрд▓реНрдкрд┐рдХ рдкреБрд╢-рдкреБрд╢ рдлрд╝рдВрдХреНрд╢рди" рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рджреВрд╕рд░рд╛ (LAT) "рд╕рд╛рдорд╛рдиреНрдп рдкреБрд▓-рдкреБрд╢" рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рд▓реЗрдХрд┐рди рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рд╣рдо рдЙрдиреНрд╣реЗрдВ рдЕрд╕рд╛рдЗрди рдХрд░реЗрдВ, рд╣рдо рдПрд╕рдкреАрдЖрдИ рд╕реЗ рдирд┐рдкрдЯреЗрдВрдЧреЗред </p><br><h3 id="spi">  рдПрд╕рдкреАрдЖрдИ </h3><br><div class="spoiler">  <b class="spoiler_title">рдПрдХ рдФрд░ рдЫреЛрдЯрд╛ рд╕рд╛ рд╢реИрдХреНрд╖рд┐рдХ рдХрд╛рд░реНрдпрдХреНрд░рдо</b> <div class="spoiler_text"><p>  рдПрд╕рдкреАрдЖрдИ рдпрд╛ рд╕реАрд░рд┐рдпрд▓ рдкреЗрд░рд┐рдлреЗрд░рд┐рдпрд▓ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ (рдзрд╛рд░рд╛рд╡рд╛рд╣рд┐рдХ рдкрд░рд┐рдзреАрдп рдЗрдВрдЯрд░рдлрд╝реЗрд╕) - рд╕рдВрдЪрд╛рд░ рдПрдордХреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд░рд▓ рдФрд░ рдмрд╣реБрдд рдкреНрд░рднрд╛рд╡реА рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдЕрдиреНрдп рдПрдордХреЗ рдФрд░ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рд╣рд░реА рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рд╛рдеред  рдЗрд╕рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рдХреЛ рдкрд╣рд▓реЗ рд╣реА рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рдЪреАрдиреА рдПрд▓рдИрдбреА рдбреНрд░рд╛рдЗрд╡рд░ (рд╕рдВрджрд░реНрдн рдореИрдиреБрдЕрд▓ рдореЗрдВ, рдзрд╛рд░рд╛ 25 рджреЗрдЦреЗрдВ) рдХреЗ рдмрд╛рд░реЗ рдореЗрдВред  рдПрд╕рдкреАрдЖрдИ рдорд╛рд╕реНрдЯрд░ ("рдорд╛рд╕реНрдЯрд░") рдФрд░ рджрд╛рд╕ ("рджрд╛рд╕") рдореЛрдб рдореЗрдВ рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдПрд╕рдкреАрдЖрдИ рдХреЗ рдЪрд╛рд░ рдореВрд▓ рдЪреИрдирд▓ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рд╕рднреА рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><ul><li>  MOSI, рдорд╛рд╕реНрдЯрд░ рдЖрдЙрдЯрдкреБрдЯ / рд╕реНрд▓реЗрд╡ рдЗрдирдкреБрдЯ: рдорд╛рд╕реНрдЯрд░ рдореЛрдб рдореЗрдВ рдпрд╣ рдкрд┐рди рднреЗрдЬрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рджрд╛рд╕ рдореЛрдб рдореЗрдВ рдпрд╣ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ; </li><li>  MISO, рдорд╛рд╕реНрдЯрд░ рдЗрдирдкреБрдЯ / рд╕реНрд▓реЗрд╡ рдЖрдЙрдЯрдкреБрдЯ: рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд, рдорд╛рд╕реНрдЯрд░ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рджрд╛рд╕ рдореЗрдВ - рджреЗрддрд╛ рд╣реИ; </li><li>  рдПрд╕рд╕реАрдХреЗ, рд╕реАрд░рд┐рдпрд▓ рдХреНрд▓реЙрдХ: рдорд╛рд╕реНрдЯрд░ рдореЗрдВ рдбреЗрдЯрд╛ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдХреА рдЖрд╡реГрддреНрддрд┐ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рджрд╛рд╕ рдореЗрдВ рдПрдХ рдШрдбрд╝реА рд╕рдВрдХреЗрдд рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред  рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ рдмрд┐рдЯреНрд╕ рдзрдбрд╝рдХрддрд╛ рд╣реИ; </li><li>  рдПрд╕рдПрд╕, рд╕реНрд▓реЗрд╡ рд╕рд┐рд▓реЗрдХреНрдЯ: рдЗрд╕ рдЪреИрдирд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рджрд╛рд╕ рд╕реАрдЦрддрд╛ рд╣реИ рдХрд┐ рд╡реЗ рдЗрд╕рд╕реЗ рдХреБрдЫ рдЪрд╛рд╣рддреЗ рд╣реИрдВред  рдПрд╕рдЯреАрдПрдо 32 рдкрд░, рдЗрд╕реЗ рдПрдирдПрд╕рдПрд╕ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рдПрди = рдирдХрд╛рд░рд╛рддреНрдордХ, рдЕрд░реНрдерд╛рддреНред  рдпрджрд┐ рдЗрд╕ рдЪреИрдирд▓ рдореЗрдВ рдЧреНрд░рд╛рдЙрдВрдб рд╣реИ рддреЛ рдХрдВрдЯреНрд░реЛрд▓рд░ рдПрдХ рдЧреБрд▓рд╛рдо рдмрди рдЬрд╛рддрд╛ рд╣реИред  рдУрдкрди рдбреНрд░реЗрди рдЖрдЙрдЯрдкреБрдЯ рдореЛрдб рдХреЗ рд╕рд╛рде рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЬреЛрдбрд╝рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдПрдХ рдЕрд▓рдЧ рдХрд╣рд╛рдиреА рд╣реИред </li></ul></div></div><br><p>  рд╕рдм рдХреБрдЫ рдХреА рддрд░рд╣, рдПрд╕рдЯреАрдПрдо 32 рдкрд░ рдПрд╕рдкреАрдЖрдИ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдореЗрдВ рд╕рдореГрджреНрдз рд╣реИ, рдЬрд┐рд╕реЗ рд╕рдордЭрдирд╛ рдХреБрдЫ рдХрдард┐рди рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ рди рдХреЗрд╡рд▓ рдПрд╕рдкреАрдЖрдИ рдХреЗ рд╕рд╛рде, рдмрд▓реНрдХрд┐ I2S рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рд╕рд╛рде рднреА рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдкреНрд░рд▓реЗрдЦрди рдореЗрдВ рдЙрдирдХреЗ рд╡рд┐рд╡рд░рдг рдорд┐рд╢реНрд░рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рдЖрдкрдХреЛ рд╕рдордп рдкрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрдЯреМрддреА рдХрд░рдиреА рд╣реЛрдЧреАред  рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдп рдЕрддреНрдпрдВрдд рд╕рд░рд▓ рд╣реИ: рдЖрдкрдХреЛ рдХреЗрд╡рд▓ MOSI рдФрд░ SCK рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛ рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рд╣рдо рдзрд╛рд░рд╛ 25.3.4 (рдЕрд░реНрдз-рджреНрд╡реИрдз рд╕рдВрдЪрд╛рд░) рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд╣рд╛рдБ рд╣рдо <em>1 рдШрдбрд╝реА рдФрд░ 1 рдпреВрдирд┐рдбрд╛рдпрд░реЗрдХреНрд╢рдирд▓ рдбреЗрдЯрд╛ рд╡рд╛рдпрд░</em> (1 рдШрдбрд╝реА рд╕рд┐рдЧреНрдирд▓ рдФрд░ 1 рдпреВрдирд┐рдбрд╛рдпрд░реЗрдХреНрд╢рдирд▓ рдбреЗрдЯрд╛ рд╕реНрдЯреНрд░реАрдо) рдкрд╛рддреЗ рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/3o/wg/pm/3owgpmokhpahr9rkftf5ns2lclw.png"><br>  <sub>рдЗрд╕ рдореЛрдб рдореЗрдВ, рдПрдкреНрд▓рд┐рдХреЗрд╢рди SPI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреЗрд╡рд▓-рдЯреНрд░рд╛рдВрд╕рдорд┐рдЯ рдпрд╛ рдХреЗрд╡рд▓-рдкреНрд░рд╛рдкреНрдд рдореЛрдб рдореЗрдВ рдХрд░рддрд╛ рд╣реИред</sub>  <sub>/ рдЯреНрд░рд╛рдВрд╕рдорд┐рд╢рди-рдУрдирд▓реА рдореЛрдб, рдбреБрдкреНрд▓реЗрдХреНрд╕ рдореЛрдб рдХреЗ рд╕рдорд╛рди рд╣реИ: рдбреЗрдЯрд╛ рдЯреНрд░рд╛рдВрд╕рдорд┐рдЯрд┐рдВрдЧ рдкрд┐рди (MOSI рдЗрди рдорд╛рд╕реНрдЯрд░ рдореЛрдб рдпрд╛ MISO рдЗрди рд╕реНрд▓реЗрд╡ рдореЛрдб) рдкрд░ рдкреНрд░рд╕рд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдкреНрд░рд╛рдкреНрдд рдкрд┐рди (MISO рдпрд╛ MOSI, рдХреНрд░рдорд╢рдГ) рдПрдХ рдирд┐рдпрдорд┐рдд рдЗрдирдкреБрдЯ-рдЖрдЙрдЯрдкреБрдЯ рдкрд┐рди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</sub>  <sub>рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдЖрд░рдПрдХреНрд╕ рдмрдлрд░ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡реЗрджрди рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ (рдпрджрд┐ рдЖрдк рдЗрд╕реЗ рдкрдврд╝рддреЗ рд╣реИрдВ, рддреЛ рдХреЛрдИ рдкреНрд░реЗрд╖рд┐рдд рдбреЗрдЯрд╛ рдирд╣реАрдВ рд╣реЛрдЧрд╛)ред</sub> </p><br><p>  рдЦреИрд░, MISO рдкрд┐рди рд╣рдорд╕реЗ рдореБрдХреНрдд рд╣реИ, рдЪрд▓реЛ рдЗрд╕реЗ LAT рд╕рд┐рдЧреНрдирд▓ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рддреЗ рд╣реИрдВред  рд╣рдо рд╕реНрд▓реЗрд╡ рд╕реЗрд▓реЗрдХреНрдЯ рд╕реЗ рдирд┐рдкрдЯреЗрдВрдЧреЗ, рдЬрд┐рд╕реЗ рдПрд╕рдЯреАрдПрдо 32 рдкрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдмреЗрд╣рдж рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред  рд╣рдордиреЗ SPI рдЬрдирд░рд▓ рдХреЗ рд╕реЗрдХреНрд╢рди 25.3.1 рдореЗрдВ рдЙрд╕реА рдирд╛рдо рдХреЗ рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдХреЛ рдкрдврд╝рд╛: </p><br><p><img src="https://habrastorage.org/webt/8t/ng/jf/8tngjfopfxskwyq_gl8tlogcp2o.png"><br>  <sub>NSS рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрдВрдЯреНрд░реЛрд▓ (SSM = 1) / рдЧреБрд▓рд╛рдо рдХреЗ рдЪрдпрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА SSI рдмрд┐рдЯ рд░рдЬрд┐рд╕реНрдЯрд░ SPI -CR1 рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИред</sub>  <sub>рдмрд╛рд╣рд░реА рдПрдирдПрд╕рдПрд╕ рдкрд┐рди рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬрд░реВрд░рддреЛрдВ рдХреЗ рд▓рд┐рдП рдореБрдлреНрдд рд░рд╣рддрд╛ рд╣реИред</sub> </p><br><p>  рдпрд╣ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХрд╛ рд╕рдордп рд╣реИред  рдореИрдВрдиреЗ SPI2 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛, рд╣рдо рдбреЗрдЯрд╛рд╢реАрдЯ рдореЗрдВ рдЖрдзрд╛рд░ рдкрддреЗ рдХреА рддрд▓рд╛рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВ - рдЕрдиреБрднрд╛рдЧ 3.3 рдореЗрдореЛрд░реА рдореИрдк рдореЗрдВ: </p><br><p><img src="https://habrastorage.org/webt/os/xd/6p/osxd6pdv5zfwombf5xflzfikj5c.png"></p><br><p>  рдареАрдХ рд╣реИ, рд╣рдо рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _SPI2_(mem_offset) (*(volatile uint32_t *)(0x40003800 + (mem_offset)))</span></span></code> </pre> <br><p>  рд╣рдо "рдорд╛рд╕реНрдЯрд░ рдореЛрдб рдореЗрдВ рдПрд╕рдкреАрдЖрдИ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ" рдХреЗ рд╕рд╛рде рдзрд╛рд░рд╛ 25.3.3 рдЦреЛрд▓рддреЗ рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/s8/ah/o5/s8aho5pbdv55j5vhhwecvewrm3m.png"></p><br><p>  <strong>1. SPI_CR1 рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ BR [2: 0] рдмрд┐рдЯреНрд╕ рдХреЗ рд╕рд╛рде рд╕реАрд░рд┐рдпрд▓ рдХреНрд▓реЙрдХ рд╕реНрдкреАрдб рд╕реЗрдЯ рдХрд░реЗрдВред</strong> </p><br><p>  рд░рдЬрд┐рд╕реНрдЯрд░ рдЙрд╕реА рдирд╛рдо рдХреЗ рд╕рдВрджрд░реНрдн рдореИрдиреБрдЕрд▓ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдПрдХрддреНрд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред  CR1 рдореЗрдВ 0x00 рдХрд╛ рдПрдХ <em>рдкрддрд╛ рдСрдлрд╕реЗрдЯ</em> ( <em>рдкрддрд╛ рдСрдлрд╕реЗрдЯ</em> ) рд╣реИ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рднреА рдмрд┐рдЯ рд░реАрд╕реЗрдЯ рд╣реИрдВ ( <em>рд░реАрд╕реЗрдЯ рдорд╛рди</em> 0x0000): </p><br><p><img src="https://habrastorage.org/webt/vt/46/um/vt46umrvbimjon75durupo3zsao.png"></p><br><p>  рдмреАрдЖрд░ рдмрд┐рдЯреНрд╕ рдирд┐рдпрдВрддреНрд░рдХ рдШрдбрд╝реА рдЖрд╡реГрддреНрддрд┐ рд╡рд┐рднрдХреНрдд рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЙрд╕ рдЖрд╡реГрддреНрддрд┐ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕ рдкрд░ рдПрд╕рдкреАрдЖрдИ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрдЧрд╛ред  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ 72 рдореЗрдЧрд╛рд╣рд░реНрдЯреНрдЬ рдХреА рдПрдХ рдПрд╕рдЯреАрдПрдо 32 рдЖрд╡реГрддреНрддрд┐ рд╣реЛрдЧреА, рдПрд▓рдИрдбреА рдбреНрд░рд╛рдЗрд╡рд░, рдЗрд╕рдХреА рдбреЗрдЯрд╢реАрдЯ рдХреЗ рдЕрдиреБрд╕рд╛рд░, 25 рдореЗрдЧрд╛рд╣рд░реНрдЯреНрдЬ рддрдХ рдХреА рдЖрд╡реГрддреНрддрд┐ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдЗрд╕реЗ рдЪрд╛рд░ (рдмреАрдЖрд░ [2: 0] = 001) рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _SPI_CR1 0x00 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> BR_0 0x0008 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> BR_1 0x0010 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> BR_2 0x0020 _SPI2_ (_SPI_CR1) |= BR_0;</span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// pclk/4</span></span></span></span></code> </pre> <br><p>  <strong>2. рд╕реАрд░рд┐рдпрд▓ рдЯреНрд░рд╛рдВрд╕рдорд┐рд╢рди рдФрд░ рдзрд╛рд░рд╛рд╡рд╛рд╣рд┐рдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреА рдХреНрд▓реЙрдХрд┐рдВрдЧ рдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдз рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП CPOL рдФрд░ CPHA рдмрд┐рдЯреНрд╕ рд╕реЗрдЯ рдХрд░реЗрдВ (рдкреГрд╖реНрда 240 рдкрд░ рдЪрд┐рддреНрд░ рджреЗрдЦреЗрдВ)</strong> </p><br><p>  рдЪреВрдВрдХрд┐ рд╣рдо рд╕реНрдХреАрдорд╛рд╢реАрдЯ рдпрд╣рд╛рдВ рдкрдврд╝ рд░рд╣реЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╕реНрдХреАрдорд╛рдУрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рдмрдЬрд╛рдп, рдХреГрдкрдпрд╛ рдкреГрд╖реНрда 704 (SPI рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рд╡рд░рдг) рдкрд░ CPOL рдФрд░ CPHA рдмрд┐рдЯреНрд╕ рдХреЗ рд╢рд╛рдмреНрджрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреА рдмреЗрд╣рддрд░ рдЬрд╛рдВрдЪ рдХрд░реЗрдВ: </p><br><p><img src="https://habrastorage.org/webt/2h/pj/in/2hpjinoa65388hdfarcc9lwnqok.png"><br>  <sub>рдХреНрд▓реЙрдХ рдлреЗрдЬ рдФрд░ рдкреЛрд▓рд╛рд░рд┐рдЯреА</sub> <sub><br></sub>  <sub>SPI_CR1 рд░рдЬрд┐рд╕реНрдЯрд░ рдХреЗ CPOL рдФрд░ CPHA рдмрд┐рдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЯрд╛рдЗрдорд┐рдВрдЧ рд░рд┐рд▓реЗрд╢рдирд╢рд┐рдк рдХреЗ рд▓рд┐рдП рдЪрд╛рд░ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ рдЪреБрдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</sub>  <sub>CPOL (рдШрдбрд╝реА рдХреА рдзреНрд░реБрд╡рддрд╛) рдмрд┐рдЯ рдШрдбрд╝реА рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрдм рдХреЛрдИ рдбреЗрдЯрд╛ рдкреНрд░реЗрд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред</sub>  <sub>рдпрд╣ рдмрд┐рдЯ рдорд╛рд╕реНрдЯрд░ рдФрд░ рджрд╛рд╕ рдореЛрдб рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред</sub>  <sub>рдпрджрд┐ CPOL рд░реАрд╕реЗрдЯ рд╣реИ, рддреЛ SCK рдкрд┐рди рдирд┐рд╖реНрдХреНрд░рд┐рдп рдореЛрдб рдореЗрдВ рдХрдо рд╣реИред</sub>  <sub>рдпрджрд┐ CPOL рдмрд┐рдЯ рд╕реЗрдЯ рд╣реИ, рддреЛ SCK рдкрд┐рди рдирд┐рд╖реНрдХреНрд░рд┐рдп рдореЛрдб рдореЗрдВ рдПрдХ рдЙрдЪреНрдЪ рд╕реНрддрд░ рдкрд░ рд╣реИред</sub> <sub><br></sub>  <sub>рдпрджрд┐ CPHA рдмрд┐рдЯ (рдХреНрд▓реЙрдХ рдлрд╝реЗрдЬрд╝) рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ SCK рд╕рд┐рдЧреНрдирд▓ рдХрд╛ рджреВрд╕рд░рд╛ рдХрд┐рдирд╛рд░рд╛ рдЙрдЪреНрдЪ рдмрд┐рдЯ рдХреЗ рдЯреНрд░реИрдк-рдЧреЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ (рдпрджрд┐ CPOL рдХреНрд▓рд┐рдпрд░ рд╣реЛрддрд╛ рд╣реИ рдпрд╛ рдпрджрд┐ CPOL рд╕реЗрдЯ рд╣реИ рддреЛ рдЖрд░реЛрд╣реА рд╣реИ)ред</sub>  <sub>рдХреНрд▓реЙрдХ рд╕рд┐рдЧреНрдирд▓ рдореЗрдВ рджреВрд╕рд░реЗ рдмрджрд▓рд╛рд╡ рд╕реЗ рдбреЗрдЯрд╛ рдХреИрдкреНрдЪрд░ рд╣реЛрддрд╛ рд╣реИред</sub>  <sub>рдпрджрд┐ CPHA рдмрд┐рдЯ рдХреЛ рд╕рд╛рдлрд╝ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ SCK рд╕рд┐рдЧреНрдирд▓ рдХрд╛ рдкреНрд░рдореБрдЦ рдХрд┐рдирд╛рд░рд╛ рдЙрдЪреНрдЪ рдмрд┐рдЯ рдХреЗ рдПрдХ рдЬрд╛рд▓-рдЧреЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ (рдпрджрд┐ CPOL рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдКрдкрд░ рдХреА рддрд░рдл рдпрд╛ CPOL рд╕рд╛рдлрд╝ рд╣реЛрдиреЗ рдкрд░ рдиреАрдЪреЗ рдХреА рдУрд░)ред</sub>  <sub>рдХреНрд▓реЙрдХ рд╕рд┐рдЧреНрдирд▓ рдореЗрдВ рдкрд╣рд▓реЗ рдмрджрд▓рд╛рд╡ рд╕реЗ рдбреЗрдЯрд╛ рдХреИрдкреНрдЪрд░ рд╣реЛрддрд╛ рд╣реИред</sub> </p><br><p>  рдЗрд╕ рдЬреНрдЮрд╛рди рдХреЛ рд╕реНрдореЛрдХ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдпрд╣ рдирд┐рд╖реНрдХрд░реНрд╖ рдирд┐рдХрд╛рд▓рддреЗ рд╣реИрдВ рдХрд┐ рджреЛрдиреЛрдВ рдмрд┐рдЯреНрд╕ рд╢реВрдиреНрдп рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреНрдпреЛрдВрдХрд┐  рдЙрдкрдпреЛрдЧ рдореЗрдВ рди рд╣реЛрдиреЗ рдкрд░ рд╣рдореЗрдВ SCK рд╕рд┐рдЧреНрдирд▓ рдХрдо рд░рд╣рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рдбреЗрдЯрд╛ рдХреЛ рдкрд▓реНрд╕ рдХреЗ рдкреНрд░рдореБрдЦ рдХрд┐рдирд╛рд░реЗ рдХреЗ рд╕рд╛рде рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП (DM634 рдбреЗрдЯрд╛рд╢реАрдЯ рдореЗрдВ <em>рд░рд╛рдЗрдЬрд┐рдВрдЧ рдПрдЬ</em> рджреЗрдЦреЗрдВ)ред </p><br><p>  рд╡реИрд╕реЗ, рдпрд╣рд╛рдВ рд╣рдордиреЗ рдкрд╣рд▓реА рдмрд╛рд░ рдПрд╕рдЯреА рдбреЗрдЯрд╢реАрдЯ рдореЗрдВ рд╢рдмреНрджрд╛рд╡рд▓реА рдХреА рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд┐рдпрд╛: рдЙрдирдореЗрдВ рд╡рд╛рдХреНрдпрд╛рдВрд╢ "рд░реАрд╕реЗрдЯ рдмрд┐рдЯ рдЯреВ рдЬреАрд░реЛ" рдХреЛ <em>рдереЛрдбрд╝рд╛ рд░реАрд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП</em> рд▓рд┐рдЦрд╛ <em>рдЧрдпрд╛ рд╣реИ</em> , рдФрд░ <em>рдереЛрдбрд╝рд╛ рд╕рд╛ рд╕реНрдкрд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП</em> рдирд╣реАрдВ, рдЬреИрд╕рд╛ рдХрд┐, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдЯрдореЗрдЧрд╛ рдореЗрдВред </p><br><p>  <strong>3. 8-рдмрд┐рдЯ рдпрд╛ 16-рдмрд┐рдЯ рдбреЗрдЯрд╛ рдмреНрд▓реЙрдХ рдкреНрд░рд╛рд░реВрдк рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП DFF рдмрд┐рдЯ рд╕реЗрдЯ рдХрд░реЗрдВред</strong> </p><br><p>  рдореИрдВрдиреЗ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ 16-рдмрд┐рдЯ DM634 рд▓рд┐рдпрд╛, рддрд╛рдХрд┐ DM633 рдХреА рддрд░рд╣ 12-рдмрд┐рдЯ PWM рдбреЗрдЯрд╛ рдХреЗ рдкреНрд░рд╕рд╛рд░рдг рд╕реЗ рдкрд░реЗрд╢рд╛рди рди рд╣реЛрдВред  DFF рдПрдХ рдЗрдХрд╛рдИ рдореЗрдВ рдбрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ: </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DFF 0x0800 _SPI2_ (_SPI_CR1) |= DFF; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// 16-bit mode</span></span></span></span></code> </pre> <br><p>  <strong>4. рдмреНрд▓реЙрдХ рдкреНрд░рд╛рд░реВрдк рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд░рдЬрд┐рд╕реНрдЯрд░ SPI_CR1 рдореЗрдВ LSBFIRST рдмрд┐рдЯ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ</strong> </p><br><p>  LSBFIRST, рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕рдХреЗ рдирд╛рдо рдХрд╛ рддрд╛рддреНрдкрд░реНрдп рд╣реИ, рдХрдо-рдХреНрд░рдо рдмрд┐рдЯ рдХреЛ рдЖрдЧреЗ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди DM634 рдЙрдЪреНрдЪ рдмрд┐рдЯ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЗрд╕реЗ рддреНрдпрд╛рдЧ рджреЗрддреЗ рд╣реИрдВред </p><br><p>  <strong>5. рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдореЛрдб рдореЗрдВ, рдпрджрд┐ рдПрдирдПрд╕рдПрд╕ рдкрд┐рди рд╕реЗ рдЗрдирдкреБрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рдкреВрд░реЗ рдмрд╛рдЗрдЯ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдЕрдиреБрдХреНрд░рдо рдХреЗ рджреМрд░рд╛рди рдПрдирдПрд╕рдПрд╕ рдкрд┐рди рдХреЛ рдПрдХ рдЙрдЪреНрдЪ рд╕рдВрдХреЗрдд рднреЗрдЬреЗрдВред</strong>  <strong>NSS рдкреНрд░реЛрдЧреНрд░рд╛рдо рдореЛрдб рдореЗрдВ, SPI_CR1 рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ SSM рдФрд░ SSI рдмрд┐рдЯреНрд╕ рд╕реЗрдЯ рдХрд░реЗрдВред</strong>  <strong>рдпрджрд┐ рдПрдирдПрд╕рдПрд╕ рдкрд┐рди рдЖрдЙрдЯрдкреБрдЯ рдкрд░ рдХрд╛рдо рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рддреЛ рдХреЗрд╡рд▓ SSOE рдмрд┐рдЯ рд╕реЗрдЯ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред</strong> </p><br><p>  рдПрдирдПрд╕рдПрд╕ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдореЛрдб рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рднреВрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрд╕рдПрд╕рдПрдо рдФрд░ рдПрд╕рдПрд╕рдЖрдИ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ: </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SSI 0x0100 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SSM 0x0200 _SPI2_ (_SPI_CR1) |= SSM | SSI; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//enable software control of SS, SS high</span></span></span></span></code> </pre> <br><p>  <strong>6. MSTR рдФрд░ SPE рдмрд┐рдЯреНрд╕ рд╕реЗрдЯ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП (рд╡реЗ рдХреЗрд╡рд▓ рддрднреА рд╕реЗрдЯ рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм NSS рдкрд░ рдЙрдЪреНрдЪ рд╕рд┐рдЧреНрдирд▓ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)</strong> </p><br><p>  рджрд░рдЕрд╕рд▓, рдЗрди рдмрд┐рдЯреНрд╕ рдХреЗ рд╕рд╛рде рд╣рдо рдЕрдкрдиреЗ рдПрд╕рдкреАрдЖрдИ рдХреЛ рдПрдХ рдорд╛рд╕реНрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрд╕рд╛рдЗрди рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдЪрд╛рд▓реВ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MSTR 0x0004 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SPE 0x0040 _SPI2_ (_SPI_CR1) |= MSTR; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//SPI master //  ,  SPI _SPI2_ (_SPI_CR1) |= SPE;</span></span></span></span></code> </pre> <br><p>  рдПрд╕рдкреАрдЖрдИ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЪрд▓реЛ рдлрд╝рдВрдХреНрд╢рди рд▓рд┐рдЦрддреЗ рд╣реИрдВ рдЬреЛ рдбреНрд░рд╛рдЗрд╡рд░ рдХреЛ рддреБрд░рдВрдд рдмрд╛рдЗрдЯ рднреЗрдЬрддреЗ рд╣реИрдВред  рд╣рдо 25.3.3 "рдорд╛рд╕реНрдЯрд░ рдореЛрдб рдореЗрдВ рдПрд╕рдкреАрдЖрдИ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛" рдкрдврд╝рдирд╛ рдЬрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/sb/rg/u5/sbrgu5xwvaj7vc8a9rk2guxfdeq.png"><br>  <sub>рдбреЗрдЯрд╛ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛</sub> <sub><br></sub>  <sub>рдЯреНрд░рд╛рдВрд╕рдорд┐рд╢рди рддрдм рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЯреАрдПрдХреНрд╕ рдмрдлрд░ рдХреЛ рдПрдХ рдмрд╛рдЗрдЯ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред</sub> <sub><br></sub>  <sub>рдбреЗрдЯрд╛ рдмрд╛рдЗрдЯ рдХреЛ рдкрд╣рд▓реЗ рдмрд┐рдЯ рдХреЗ рдкреНрд░рд╕рд╛рд░рдг рдХреЗ рджреМрд░рд╛рди <strong>рд╕рдорд╛рдирд╛рдВрддрд░</strong> рдореЛрдб (рдЖрдВрддрд░рд┐рдХ рдмрд╕ рд╕реЗ) рдореЗрдВ рд╢рд┐рдлреНрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдЗрд╕реЗ <strong>рд╕реАрд░рд┐рдпрд▓</strong> рдореЛрдб рдореЗрдВ MOSI рдкрд┐рди рдореЗрдВ рдкреНрд░реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкрд╣рд▓реЗ CPI_CR1 рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ LSFFIRST рдмрд┐рдЯ рдХреА рд╕реЗрдЯрд┐рдВрдЧ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред</sub>  <sub>TXE рдзреНрд╡рдЬ рдХреЛ <strong>Tx рдмрдлрд░ рд╕реЗ рд╢рд┐рдлреНрдЯ рд░рдЬрд┐рд╕реНрдЯрд░</strong> рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдпрджрд┐ CPE_CR1 рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ TXEIE рдмрд┐рдЯ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ рдЕрд╡рд░реЛрдз рднреА рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</sub> </p><br><p>  рдПрд╕рдЯреАрдПрдо рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдореЗрдВ рдПрд╕рдкреАрдЖрдИ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреА рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рдкрд░ рдзреНрдпрд╛рди рдЖрдХрд░реНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореИрдВрдиреЗ рдЕрдиреБрд╡рд╛рдж рдореЗрдВ рдХреБрдЫ рд╢рдмреНрджреЛрдВ рдкрд░ рдкреНрд░рдХрд╛рд╢ рдбрд╛рд▓рд╛ред  Atmega рдкрд░, TXE рдзреНрд╡рдЬ ( <em>Tx Empty</em> , Tx рдЦрд╛рд▓реА рд╣реИ рдФрд░ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИ) рдкреВрд░реА рдмрд╛рдЗрдЯ рдирд┐рдХрд▓ <em>рдЬрд╛рдиреЗ рдХреЗ</em> рдмрд╛рдж рд╣реА рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ <em>рд╣реИ</em> ред  рдФрд░ рдпрд╣рд╛рдБ рдЗрд╕ рдЭрдВрдбреЗ рдХреЛ рдмрд╛рдЗрдЯ рдХреЗ рдмрд╛рдж рдЖрдВрддрд░рд┐рдХ рд╢рд┐рдлреНрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЪреВрдВрдХрд┐ рдпрд╣ рд╕рднреА рдмрд┐рдЯреНрд╕ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд╕рд╛рде (рд╕рдорд╛рдирд╛рдВрддрд░ рдореЗрдВ) рд╡рд╣рд╛рдВ рдЫрд╛рдпрд╛ рд╣реБрдЖ рд╣реИ, рдФрд░ рдлрд┐рд░ рдбреЗрдЯрд╛ рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░реЗрд╖рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдмрд╛рдЗрдЯ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рднреЗрдЬреЗ рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ TXE рд╕реЗрдЯ рд╣реЛрддрд╛ рд╣реИред  рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХреНрдпреЛрдВрдХрд┐  рд╣рдорд╛рд░реЗ рдПрд▓рдИрдбреА рдбреНрд░рд╛рдЗрд╡рд░ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдореЗрдВ <em>рд╕рднреА</em> рдбреЗрдЯрд╛ рднреЗрдЬрдиреЗ рдХреЗ рдмрд╛рдж LAT рдкрд┐рди рдХреЛ рдЦреАрдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рддреНред  рдХреЗрд╡рд▓ TXE рдзреНрд╡рдЬ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрдЧрд╛ред </p><br><p>  рдФрд░ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдореЗрдВ рдХрд┐рд╕реА рдФрд░ рдзреНрд╡рдЬ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  25.3.7 рдореЗрдВ рджреЗрдЦрддреЗ рд╣реИрдВ - "рд╕реНрдерд┐рддрд┐ рдЭрдВрдбреЗ": </p><br><p><img src="https://habrastorage.org/webt/_d/vn/jj/_dvnjjudvkmdyutpylvwfkfknng.png"><br>  &lt;...&gt; <br><img src="https://habrastorage.org/webt/3y/wv/nd/3ywvndaij5blabzqfq2n6wzdbfe.png"><br>  <sub>BUSY рдЭрдВрдбрд╛</sub> <sub><br></sub>  <sub>BSY рдзреНрд╡рдЬ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛ рд╕реЗрдЯ рдФрд░ рд░реАрд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (рдЗрд╕реЗ рд▓рд┐рдЦрдирд╛ рдХреБрдЫ рднреА рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ)ред</sub>  <sub>рдмреАрдПрд╕рд╡рд╛рдИ рдзреНрд╡рдЬ рдПрд╕рдкреАрдЖрдИ рд╕рдВрдЪрд╛рд░ рдкрд░рдд рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред</sub> <sub><br></sub>  <sub>рдпрд╣ рд░реАрд╕реЗрдЯ рд╣реИ:</sub> <sub><br></sub>  <sub>рдЬрдм рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рдП (рдорд╛рд╕реНрдЯрд░ рдореЛрдб рдХреЛ рдЫреЛрдбрд╝рдХрд░, рдпрджрд┐ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдирд┐рд░рдВрддрд░ рд╣реИ)</sub> <sub><br></sub>  <sub>рдЬрдм SPI рдЕрдХреНрд╖рдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ</sub> <sub><br></sub>  <sub>рдЬрдм рд╡рд┐рдЬрд╝рд╛рд░реНрдб рдореЛрдб рддреНрд░реБрдЯрд┐ рд╣реЛрддреА рд╣реИ (MODF = 1)</sub> <sub><br></sub>  <sub>рдпрджрд┐ рдЯреНрд░рд╛рдВрд╕рдорд┐рд╢рди рдирд┐рд░рдВрддрд░ рдирд╣реАрдВ рд╣реИ, рддреЛ рдкреНрд░рддреНрдпреЗрдХ рдбреЗрдЯрд╛ рдЯреНрд░рд╛рдВрд╕рдорд┐рд╢рди рдХреЗ рдмреАрдЪ BSY рдзреНрд╡рдЬ рд╕рд╛рдлрд╝ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред</sub> </p><br><p>  рдареАрдХ рд╣реИ, рдХрд╛рдо рдореЗрдВ рдЖ рдЬрд╛рдУред  рд╣рдореЗрдВ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдЯреАрдПрдХреНрд╕ рдмрдлрд░ рдХрд╣рд╛рдБ рд╕реНрдерд┐рдд рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, "SPI рдбреЗрдЯрд╛ рд░рдЬрд┐рд╕реНрдЯрд░" рдкрдврд╝реЗрдВ: </p><br><p><img src="https://habrastorage.org/webt/sj/gk/o7/sjgko7dcnefgkio4jk9xrwt67bs.png"><br>  <sub>рдмрд┐рдЯреНрд╕ 15: 0 DR [15: 0] рдбреЗрдЯрд╛ рд░рдЬрд┐рд╕реНрдЯрд░</sub> <sub><br></sub>  <sub>рдЯреНрд░рд╛рдВрд╕рдорд┐рд╢рди рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдпрд╛ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ред</sub> <sub><br></sub>  <sub>рдбреЗрдЯрд╛ рд░рдЬрд┐рд╕реНрдЯрд░ рдХреЛ рджреЛ рдмрдлрд╝рд░реНрд╕ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ - рдПрдХ рд▓реЗрдЦрди рдХреЗ рд▓рд┐рдП (рдЯреНрд░рд╛рдВрд╕рдлрд╝реЙрд░реНрдо рдмрдлрд░) рдФрд░ рджреВрд╕рд░рд╛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП (рдмрдлрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ)ред</sub>  <sub>рдбреЗрдЯрд╛ рд░рдЬрд┐рд╕реНрдЯрд░ рдкрд░ рд▓рд┐рдЦрдирд╛ рдЯреАрдПрдХреНрд╕ рдмрдлрд░ рдХреЛ рд▓рд┐рдЦрддрд╛ рд╣реИ, рдФрд░ рдбреЗрдЯрд╛ рд░рдЬрд┐рд╕реНрдЯрд░ рд╕реЗ рдкрдврд╝рдиреЗ рд╕реЗ рдЖрд░рдПрдХреНрд╕ рдмрдлрд░ рдореЗрдВ рдирд┐рд╣рд┐рдд рдореВрд▓реНрдп рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рдПрдЧрд╛ред</sub> </p><br><p>  рдЦреИрд░, рд╕реНрдерд┐рддрд┐ рд░рдЬрд┐рд╕реНрдЯрд░, рдЬрд╣рд╛рдБ TXE рдФрд░ BSY рдЭрдВрдбреЗ рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/-k/pi/q9/-kpiq96tkpbqvvr1vly6nlzpwoe.png"></p><br><p>  рд╣рдо рд▓рд┐рдЦрддреЗ рд╣реИрдВ: </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _SPI_DR 0x0C #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _SPI_SR 0x08 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> BSY 0x0080 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> TXE 0x0002 void dm_shift16(uint16_t value) { _SPI2_(_SPI_DR) = value; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//send 2 bytes while (!(_SPI2_(_SPI_SR) &amp; TXE)); //wait until they're sent }</span></span></span></span></code> </pre> <br><p>  рдареАрдХ рд╣реИ, рдЪреВрдВрдХрд┐ рд╣рдореЗрдВ рдПрд▓рдИрдбреА рдбреНрд░рд╛рдЗрд╡рд░ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рджреЛ рдмрд╛рд░ 16 рдмрд╛рдЗрдЯреНрд╕ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рд╕реЗ: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendLEDdata</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ LAT_low(); <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> k = <span class="hljs-number"><span class="hljs-number">16</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { k--; dm_shift16(leds[k]); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (k); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (_SPI2_(_SPI_SR) &amp; BSY); <span class="hljs-comment"><span class="hljs-comment">// finish transmission LAT_pulse(); }</span></span></code> </pre> <br><p>  рд▓реЗрдХрд┐рди рд╣рдо рдЕрднреА рднреА рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдкрд┐рди LAT рдХреИрд╕реЗ рдЦреАрдВрдЪрдирд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо I / O рдкрд░ рд▓реМрдЯ рдЖрдПрдВрдЧреЗред </p><br><h3 id="naznachaem-piny">  рдкрд┐рди рдЕрд╕рд╛рдЗрди рдХрд░реЗрдВ </h3><br><p>  STM32F1 рдореЗрдВ, рдкрд┐рдВрд╕ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд░рдЬрд┐рд╕реНрдЯрд░ рдЕрд╕рд╛рдорд╛рдиреНрдп рд╣реИрдВред  рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ рдЙрдирдореЗрдВ рдПрдЯрдореЗрдЧрд╛ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реЗ рдЕрдиреНрдп рдПрд╕рдЯреАрдПрдо рдЪрд┐рдкреНрд╕ рд╕реЗ рднреА рднрд┐рдиреНрди рд╣реИрдВред  GPIO рдХреА рдзрд╛рд░рд╛ 9.1 рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рд╡рд░рдг: </p><br><p><img src="https://habrastorage.org/webt/ky/w9/ks/kyw9ksdar6bepxsf1u7kvyejfwm.png"><br>  <sub>рд╕рд╛рдорд╛рдиреНрдп рдкреНрд░рдпреЛрдЬрди рдЗрдирдкреБрдЯ / рдЖрдЙрдЯрдкреБрдЯ рдкреЛрд░реНрдЯреНрд╕ <em>(GPIO) рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ</em> рдореЗрдВ рджреЛ 32-рдмрд┐рдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд░рдЬрд┐рд╕реНрдЯрд░ (GPIOx_CRL рдФрд░ GPIOx_CRH), рджреЛ 32-рдмрд┐рдЯ рдбреЗрдЯрд╛ рд░рдЬрд┐рд╕реНрдЯрд░ (GPIOx_IDR рдФрд░ GPIOx_ODR), рдПрдХ 32-рдмрд┐рдЯ рд╕реЗрдЯ / рд░реАрд╕реЗрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ (GPIOx_BSRR), 16-рдмрд┐рдЯ рд╣реИред рдПрдХ рд░реАрд╕реЗрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ (GPIOx_BRR) рдФрд░ рдПрдХ 32-рдмрд┐рдЯ рдмреНрд▓реЙрдХ рд░рдЬрд┐рд╕реНрдЯрд░ (GPIOx_LCKR)ред</sub> </p><br><p>  рдЕрд╕рд╛рдорд╛рдиреНрдп, рд╕рд╛рде рд╣реА рд╕рд╛рде рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ, рдкрд╣рд▓реЗ рджреЛ рд░рдЬрд┐рд╕реНрдЯрд░ рдпрд╣рд╛рдВ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ 16 рдкреЛрд░реНрдЯ рдкрд┐рди рдЙрди рдкрд░ "рдЪрд╛рд░ рдмрд┐рдЯ рдкреНрд░рддрд┐ рднрд╛рдИ" рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдмрд┐рдЦрд░реЗ рд╣реБрдП рд╣реИрдВред  рдпрд╛рдиреА  рдкрд┐рди рд╕рд╛рддрд╡реЗрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╢реВрдиреНрдп CRL рдореЗрдВ рд╣реИрдВ, рдФрд░ рдмрд╛рдХреА CRH рдореЗрдВ рд╣реИрдВред  рдЗрд╕реА рд╕рдордп, рдмрд╛рдХреА рд░рдЬрд┐рд╕реНрдЯрд░ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреЛрд░реНрдЯ рдХреЗ рд╕рднреА рдкрд┐рдиреЛрдВ рдХреЗ рдмрд┐рдЯреНрд╕ рдореЗрдВ рдлрд┐рдЯ рд╣реЛрддреЗ рд╣реИрдВ - рдЕрдХреНрд╕рд░ рд╢реЗрд╖ рдЖрдзрд╛ "рдЖрд░рдХреНрд╖рд┐рдд" рд╣реЛрддрд╛ рд╣реИред </p><br><p>  рд╕рд╛рджрдЧреА рдХреЗ рд▓рд┐рдП, рд╕реВрдЪреА рдХреЗ рдЕрдВрдд рдореЗрдВ рд╢реБрд░реВ рдХрд░реЗрдВред </p><br><p>  рд╣рдореЗрдВ рдмреНрд▓реЙрдХ рд░рдЬрд┐рд╕реНрдЯрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред </p><br><p>  рд╕реЗрдЯрдЕрдк рдФрд░ рд░реАрд╕реЗрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд╛рдлреА рдордЬрд╝реЗрджрд╛рд░ рд╣реЛрддреЗ рд╣реИрдВ рдХрд┐ рд╡реЗ рдЖрдВрд╢рд┐рдХ рд░реВрдк рд╕реЗ рдПрдХ рджреВрд╕рд░реЗ рдХреА рдирдХрд▓ рдХрд░рддреЗ рд╣реИрдВ: рдЖрдк рдХреЗрд╡рд▓ рдмреАрдПрд╕рдЖрд░рдЖрд░ рдореЗрдВ рд╕рдм рдХреБрдЫ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд╣рд╛рдВ рдЙрдЪреНрдЪрддрдо 16 рдмрд┐рдЯреНрд╕ рдкрд┐рди рдХреЛ рд╢реВрдиреНрдп рдкрд░ рд░реАрд╕реЗрдЯ рдХрд░ рджреЗрдВрдЧреЗ, рдФрд░ рдирд┐рдЪрд▓реЗ рд╡рд╛рд▓реЗ - 1 рдкрд░ рд╕реЗрдЯ рд╣реЛрдВрдЧреЗ, рдпрд╛ рдмреАрдЖрд░рдЖрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░реЗрдВрдЧреЗ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдирд┐рдЪрд▓реЗ 16 рдмрд┐рдЯреНрд╕ рдХреЗрд╡рд▓ рдкрд┐рди рд░реАрд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВред ред  рдореБрдЭреЗ рджреВрд╕рд░рд╛ рд╡рд┐рдХрд▓реНрдк рдкрд╕рдВрдж рд╣реИред  рдпреЗ рд░рдЬрд┐рд╕реНрдЯрд░ рдЗрд╕ рдорд╛рдпрдиреЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВ рдХрд┐ рд╡реЗ рдкрд┐рдиреЛрдВ рдХреЛ рдкрд░рдорд╛рдгреБ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/tr/g9/tq/trg9tqg8ksmhfiaokjbslfvvhny.png"><br><img src="https://habrastorage.org/webt/yb/dm/da/ybdmdaayb-f0np1pawunxobfbaa.png"><br>  <sub>рдкрд░рдорд╛рдгреБ рд╕реНрдерд╛рдкрдирд╛ рдпрд╛ рд░реАрд╕реЗрдЯ</sub> <sub><br></sub>  <sub>GPIOx_ODR рдХреЛ рдмрд┐рдЯ рд╕реНрддрд░ рдкрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдХрд░рддреЗ рд╕рдордп рдЖрдкрдХреЛ рдЗрдВрдЯрд░рдкреНрдЯ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ: рдЖрдк рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ рдмрд┐рдЯреНрд╕ рдХреЛ рдПрдХ рдкрд░рдорд╛рдгреБ рд▓реЗрдЦрди рдСрдкрд░реЗрд╢рди APB2 рдХреЗ рд╕рд╛рде рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред</sub>  <sub>рдпрд╣ рд╕реЗрдЯ / рд░реАрд╕реЗрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ (GPIOx_BSRR рдпрд╛, рдХреЗрд╡рд▓ рд░реАрд╕реЗрдЯ рдХреЗ рд▓рд┐рдП, GPIOx_BRR) рдЙрд╕ рдмрд┐рдЯ рдореЗрдВ рд▓рд┐рдЦрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдк рдмрджрд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред</sub>  <sub>рдЕрдиреНрдп рдмрд┐рдЯреНрд╕ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рд░рд╣реЗрдВрдЧреЗред</sub> </p><br><p>  рдбреЗрдЯрд╛ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рдХрд╛рдлреА рдмреЛрд▓рдиреЗ рд╡рд╛рд▓реЗ рдирд╛рдо рд╣реИрдВ - IDR = <em>рдЗрдирдкреБрдЯ</em> рдбрд╛рдпрд░реЗрдХреНрд╢рди рд░рдЬрд┐рд╕реНрдЯрд░, рдЗрдирдкреБрдЯ рд░рдЬрд┐рд╕реНрдЯрд░;  ODR = <em>рдЖрдЙрдЯрдкреБрдЯ</em> рдбрд╛рдпрд░реЗрдХреНрд╢рди рд░рдЬрд┐рд╕реНрдЯрд░, рдЖрдЙрдЯрдкреБрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ред  рд╡рд░реНрддрдорд╛рди рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рд╣рдореЗрдВ рдЙрдирдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧреАред </p><br><p>  рдФрд░ рдЕрдВрдд рдореЗрдВ, рдирд┐рдпрдВрддреНрд░рдг рд░рдЬрд┐рд╕реНрдЯрд░ред  рдЪреВрдВрдХрд┐ рд╣рдо рджреВрд╕рд░реЗ SPI, PB13, PB14 рдФрд░ PB15 рдХреЗ рдкрд┐рди рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ, рд╣рдо рддреБрд░рдВрдд CRH рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/ei/_v/it/ei_vitm85yhwasuf5zjbhksfsoq.png"></p><br><p>  рдФрд░ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ 20 рд╡реАрдВ рд╕реЗ 31 рд╡реАрдВ рддрд╛рд░реАрдЦ рддрдХ рдмрд┐рдЯреНрд╕ рдореЗрдВ рдХреБрдЫ рд▓рд┐рдЦрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛ред </p><br><p>  рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдкрддрд╛ рд▓рдЧрд╛ рд▓рд┐рдпрд╛ рд╣реИ рдХрд┐ рд╣рдо рдкрд┐рдВрд╕ рд╕реЗ рдХреНрдпрд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдВ рдореИрдВ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдХреЗ рдмрд┐рдирд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВ, рдмрд╕ рдпрд╣ рдХрд╣рдирд╛ рд╣реИ рдХрд┐ MODE рджрд┐рд╢рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ (рдЗрдирдкреБрдЯ, рдпрджрд┐ рджреЛрдиреЛрдВ рдмрд┐рдЯреНрд╕ 0 рдкрд░ рд╕реЗрдЯ рд╣реИрдВ) рдФрд░ рдкрд┐рди рдЧрддрд┐ (рд╣рдореЗрдВ 50MHz рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд рджреЛрдиреЛрдВред "1") рдореЗрдВ рдкрд┐рди, рдФрд░ CNF рдореЛрдб рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ: рд╕рд╛рдорд╛рдиреНрдп "рдкреБрд╢-рдкреБрд╢" - 00, "рд╡реИрдХрд▓реНрдкрд┐рдХ" - 10. рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рдКрдкрд░ рджреЗрдЦрддреЗ рд╣реИрдВ, рд╕рднреА рдкрд┐рди рдиреАрдЪреЗ рд╕реЗ рддреАрд╕рд░рд╛ рдмрд┐рдЯ (CNF0) рд╣реИ, рдпрд╣ рдЙрдиреНрд╣реЗрдВ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ <em>рдлреНрд▓реЛрдЯрд┐рдВрдЧ рдЗрдирдкреБрдЯ</em> рдореЛрдбред </p><br><p>  рдЪреВрдВрдХрд┐ рдореИрдВ рдЗрд╕ рдЪрд┐рдк рдХреЗ рд╕рд╛рде рдХреБрдЫ рдФрд░ рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛ рд░рд╣рд╛ рд╣реВрдВ, рдЗрд╕рд▓рд┐рдП рд╕рд╛рджрдЧреА рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рдирд┐рдЪрд▓реЗ рдФрд░ рдКрдкрд░реА рджреЛрдиреЛрдВ рдирд┐рдпрдВрддреНрд░рдг рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рднреА рд╕рдВрднрд╡ MODE рдФрд░ CNF рдореВрд▓реНрдпреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рд╣реИред </p><br><div class="spoiler">  <b class="spoiler_title">рдЦреИрд░, рдРрд╕рд╛ рд╣реА рдХреБрдЫ</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF0_0 0x00000004 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF0_1 0x00000008 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF1_0 0x00000040 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF1_1 0x00000080 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF2_0 0x00000400 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF2_1 0x00000800 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF3_0 0x00004000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF3_1 0x00008000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF4_0 0x00040000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF4_1 0x00080000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF5_0 0x00400000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF5_1 0x00800000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF6_0 0x04000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF6_1 0x08000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF7_0 0x40000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF7_1 0x80000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF8_0 0x00000004 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF8_1 0x00000008 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF9_0 0x00000040 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF9_1 0x00000080 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF10_0 0x00000400 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF10_1 0x00000800 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF11_0 0x00004000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF11_1 0x00008000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF12_0 0x00040000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF12_1 0x00080000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF13_0 0x00400000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF13_1 0x00800000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF14_0 0x04000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF14_1 0x08000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF15_0 0x40000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CNF15_1 0x80000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE0_0 0x00000001 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE0_1 0x00000002 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE1_0 0x00000010 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE1_1 0x00000020 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE2_0 0x00000100 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE2_1 0x00000200 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE3_0 0x00001000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE3_1 0x00002000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE4_0 0x00010000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE4_1 0x00020000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE5_0 0x00100000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE5_1 0x00200000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE6_0 0x01000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE6_1 0x02000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE7_0 0x10000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE7_1 0x20000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE8_0 0x00000001 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE8_1 0x00000002 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE9_0 0x00000010 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE9_1 0x00000020 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE10_0 0x00000100 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE10_1 0x00000200 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE11_0 0x00001000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE11_1 0x00002000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE12_0 0x00010000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE12_1 0x00020000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE13_0 0x00100000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE13_1 0x00200000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE14_0 0x01000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE14_1 0x02000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE15_0 0x10000000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MODE15_1 0x20000000</span></span></code> </pre> </div></div><br><p>  рд╣рдорд╛рд░реЗ рдкрд┐рди рдкреЛрд░реНрдЯ B рдкрд░ рд╕реНрдерд┐рдд рд╣реИрдВ (рдЖрдзрд╛рд░ рдкрддрд╛ 0x40010C00 рд╣реИ), рдХреЛрдб: </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _PORTB_(mem_offset) (*(volatile uint32_t *)(0x40010C00 + (mem_offset))) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _BRR 0x14 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _BSRR 0x10 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _CRL 0x00 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _CRH 0x04 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  SPI2: MOSI  B15, CLK  B13 //LAT     MISO тАУ B14 //  ,      _PORTB_ (_CRH) &amp;= ~(CNF15_0 | CNF14_0 | CNF13_0 | CNF12_0); //   MOSI  SCK _PORTB_ (_CRH) |= CNF15_1 | CNF13_1; //50 , MODE = 11 _PORTB_ (_CRH) |= MODE15_1 | MODE15_0 | MODE14_1 | MODE14_0 | MODE13_1 | MODE13_0;</span></span></span></span></code> </pre> <br><p>  рдФрд░, рддрджрдиреБрд╕рд╛рд░, рдЖрдк LAT рдХреЗ рд▓рд┐рдП рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ BRR рдФрд░ BSRR рдХреЛ рдЪрд┐рдХреЛрдЯреА рджреЗрдЧрд╛: </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/*** LAT pulse тАУ high, then low */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> LAT_pulse() _PORTB_(_BSRR) = (1&lt;&lt;14); _PORTB_(_BRR) = (1&lt;&lt;14) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> LAT_low() _PORTB_(_BRR) = (1&lt;&lt;14)</span></span></code> </pre> <br><p>  (LAT_low рд╕рд┐рд░реНрдл рдЬрдбрд╝рддрд╛ рд╕реЗ, рдХрд┐рд╕реА рддрд░рд╣ рдпрд╣ рд╣рдореЗрд╢рд╛ рдерд╛, рдЕрдкрдиреЗ рдЖрдк рдХреЛ рд░рд╣рдиреЗ рджреЛ) </p><br><p>  рдЕрдм рд╕рдм рдХреБрдЫ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдорд╣рд╛рди рд╣реИ, рдмрд╕ рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИред  рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрд╕рдЯреАрдПрдо 32 рд╣реИ, рдпрд╣ рдмрд┐рдЬрд▓реА рдмрдЪрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдЖрд╡рд╢реНрдпрдХ рдмрд╛рд╣реНрдп рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдШрдбрд╝реА рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </p><br><h2 id="vklyuchaem-taktirovanie">  рд╕рдордп рдкрд░ рдЪрд╛рд▓реВ рдХрд░реЗрдВ </h2><br><p>  рдШрдбрд╝реА рдХреЗ рд▓рд┐рдП рдШрдбрд╝реА рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИ, рд╡реЗ рднреА рдШрдбрд╝реА рд╣реИрдВред  рдФрд░ рд╣рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдирд╛рдо рдЖрд░рд╕реАрд╕реА рджреЗрдЦ рд╕рдХрддреЗ рдереЗред  рд╣рдо рдЗрд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рджреЗрдЦ рд░рд╣реЗ рд╣реИрдВ: рдпрд╣ рд░реАрд╕реЗрдЯ рдФрд░ рдШрдбрд╝реА рдирд┐рдпрдВрддреНрд░рдг рд╣реИред </p><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рдХрд╣рд╛ рдЧрдпрд╛ рдерд╛, рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, рдПрд╕рдЯреАрдПрдо рдХреЗ рд▓реЛрдЧреЛрдВ рдиреЗ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЯрд╛рдЗрдорд┐рдВрдЧ рд╡рд┐рд╖рдп рдХрд╛ рд╕рдмрд╕реЗ рдХрдард┐рди рд╣рд┐рд╕реНрд╕рд╛ рдХрд┐рдпрд╛, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╡реЗ рдЖрдкрдХреЛ рдмрд╣реБрдд рдзрдиреНрдпрд╡рд╛рдж рджреЗрддреЗ рд╣реИрдВ (рдПрдХ рдмрд╛рд░ рдлрд┐рд░ рдореИрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбрд┐ рд╣рд╛рд▓реНрдЯ рдХреА рд╡реЗрдмрд╕рд╛рдЗрдЯ</a> рдкрд░ рдПрдХ рд▓рд┐рдВрдХ рджреВрдВрдЧрд╛ рддрд╛рдХрд┐ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рд╕рдХреЗ рдХрд┐ рдпрд╣ рдХрд┐рддрдирд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЙрд▓рдЭрд╛ рд╣реБрдЖ</a> рд╣реИ)ред  рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдкрд░рд┐рдзреАрдп рдШрдбрд╝рд┐рдпреЛрдВ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрддреНрддрд░рджрд╛рдпреА рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдкреЗрд░рд┐рдлреЗрд░рд▓ рдХреНрд▓реЙрдХ рд╕рдХреНрд╖рдо рд░рдЬрд┐рд╕реНрдЯрд░)ред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрд░рд╕реАрд╕реА рдХрд╛ рдЖрдзрд╛рд░ рдкрддрд╛ рдвреВрдВрдвреЗрдВ, рдпрд╣ "рдореЗрдореЛрд░реА рдХрд╛рд░реНрдб" рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/r5/ad/jt/r5adjtnefym8toywwtuxwls-s8e.png"></p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _RCC_(mem_offset) (*(volatile uint32_t *)(0x40021000 + (mem_offset)))</span></span></code> </pre> <br><p>  рдФрд░ рдлрд┐рд░ рдЙрд╕ рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдЬрд╣рд╛рдВ рдкреНрд▓реЗрдЯ рдореЗрдВ рдХреБрдЫ рдЦреЛрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ, рдпрд╛, рдмрд╣реБрдд рдмреЗрд╣рддрд░, <em>рд╕рдХреНрд╖рдо рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ</em> рдкрд░ рд╡рд░реНрдЧреЛрдВ рд╕реЗ рд╢рд╛рдорд┐рд▓ рдХрд┐рдП рдЧрдП рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдХреЗ рд╡рд┐рд╡рд░рдгреЛрдВ рдкрд░ рдЬрд╛рдПрдВред  рдЬрд╣рд╛рдБ рд╣рдо RCC_APB1ENR рдФрд░ RCC_APB2ENR рдкрд╛рддреЗ рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/bt/e7/_6/bte7_6icypsiop8tvagswdtfdpe.png"><br><img src="https://habrastorage.org/webt/pr/d0/l1/prd0l1e_vckbrxqk83wso_h9t5k.png"></p><br><p>  рдФрд░ рдЙрдирдореЗрдВ, рдХреНрд░рдорд╢рдГ, рдмрд┐рдЯреНрд╕, рдЬрд┐рд╕рдореЗрдВ SPI2, IOPB (I / O рдкреЛрд░реНрдЯ B) рдФрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдВрдХреНрд╢рди (AFIO) рд╢рд╛рдорд┐рд▓ рд╣реИрдВред </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _APB2ENR 0x18 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _APB1ENR 0x1C #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> IOPBEN 0x0008 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SPI2EN 0x4000 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> AFIOEN 0x0001 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//   B  .  _RCC_(_APB2ENR) |= IOPBEN | AFIOEN; //  SPI2 _RCC_(_APB1ENR) |= SPI2EN;</span></span></span></span></code> </pre> <br><p>  рдЕрдВрддрд┐рдо рдХреЛрдб <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИ</a> ред </p><br><p>  рдпрджрд┐ рдХреЛрдИ рдЕрд╡рд╕рд░ рд╣реИ рдФрд░ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ, рддреЛ рд╣рдо DM634 рдХреЛ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ: DAI рд╕реЗ PB15, DCK рд╕реЗ PB13, LAT рд╕реЗ PB14ред  рд╣рдо 5 рд╡реЛрд▓реНрдЯ рд╕реЗ рдбреНрд░рд╛рдЗрд╡рд░ рдХреЛ рдЦрд┐рд▓рд╛рддреЗ рд╣реИрдВ, рдкреГрдереНрд╡реА рдХреЛ рдЧрдардмрдВрдзрди рдХрд░рдирд╛ рдирд╣реАрдВ рднреВрд▓рддреЗ рд╣реИрдВред </p><br><p><img src="https://habrastorage.org/webt/sx/bz/va/sxbzvazmpgcgwsl0o5pt90gzlnm.jpeg"></p><br><h1 id="stm8-pwm">  STM8 PWM </h1><br><h1 id="shim-na-stm8">  STM8 рдкрд░ PWM </h1><br><p>  рдЬрдм рдореИрдВ рдЗрд╕ рд▓реЗрдЦ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛ рд░рд╣рд╛ рдерд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рдПрдХ рдЕрдкрд░рд┐рдЪрд┐рдд рдЪрд┐рдк рдХреА рдХреБрдЫ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдХреЗрд╡рд▓ рдПрдХ рдбреЗрдЯрд╢реАрдЯ рдХреЗ рд╕рд╛рде рд╕реАрдЦрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛, рддрд╛рдХрд┐ рдореБрдЭреЗ рдмрд┐рдирд╛ рдмреВрдЯ рдХреЗ рдПрдХ рдерд╛рдиреЗрджрд╛рд░ рди рдорд┐рд▓реЗред  STM8 рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ рдЗрд╕ рднреВрдорд┐рдХрд╛ рдХреЗ рдЕрдиреБрдХреВрд▓ рд╣реИ: рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдореЗрд░реЗ рдкрд╛рд╕ STM8S103 рдХреЗ рд╕рд╛рде рдЪреАрдиреА рдорджрд░рдмреЛрд░реНрдб рдХреА рдПрдХ рдЬреЛрдбрд╝реА рдереА, рдФрд░ рджреВрд╕рд░реА рдмрд╛рдд, рдпрд╣ рдмрд╣реБрдд рд▓реЛрдХрдкреНрд░рд┐рдп рдирд╣реАрдВ рд╣реИ, рдФрд░ рдЗрд╕рд▓рд┐рдП рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдПрдХ рд╕рдорд╛рдзрд╛рди рдХреЛ рдкрдврд╝рдиреЗ рдФрд░ рдЦреЛрдЬрдиреЗ рдХрд╛ рдкреНрд░рд▓реЛрднрди рдЗрди рдмрд╣реБрдд рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдореЗрдВ рд░рд╣рддрд╛ рд╣реИред </p><br><p>  рдЪрд┐рдк рдореЗрдВ рдПрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбреЗрдЯрд╢реАрдЯ</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдВрджрд░реНрдн рдореИрдиреБрдЕрд▓ RM0016 рднреА рд╣реИ</a> , рдкрд╣рд▓реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкрд┐рдирдЖрдЙрдЯ</a> рдореЗрдВ рдФрд░ рджреВрд╕рд░реЗ рдореЗрдВ рдкрддреЗ рджрд░реНрдЬ рдХрд░реЗрдВ - рдмрд╛рдХреА рд╕рдм рдХреБрдЫред  STM8 рдХреЛ C рдореЗрдВ рдмрджрд╕реВрд░рдд IDE <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">ST рджреГрд╢реНрдп рд╡рд┐рдХрд╛рд╕</a> рдореЗрдВ рдХреНрд░рдорд╛рджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </p><br><h3 id="taktirovanie-i-vvod-vyvod">  рдХреНрд▓реЙрдХрд┐рдВрдЧ рдФрд░ рдЖрдИ / рдУ </h3><br><p>  рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, STM8 2 рдореЗрдЧрд╛рд╣рд░реНрдЯреНрдЬ рдХреА рдЖрд╡реГрддреНрддрд┐ рдкрд░ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕реЗ рддреБрд░рдВрдд рддрдп рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </p><br><p><img src="https://habrastorage.org/webt/h-/w7/hc/h-w7hclj1kovrmig-mxtjj-n62k.png"><br>  <sub>HSI рдШрдбрд╝реА (рдЖрдВрддрд░рд┐рдХ рдЧрддрд┐)</sub> <sub><br></sub>  <sub>рдПрдЪрдПрд╕рдЖрдИ рдШрдбрд╝реА рдПрдХ рдЖрдВрддрд░рд┐рдХ 16-рдореЗрдЧрд╛рд╣рд░реНрдЯреНрдЬ рдЖрд░рд╕реА рдСрд╕рд┐рд▓реЗрдЯрд░ рд╕реЗ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдмрд▓ рдбрд┐рд╡рд╛рдЗрдбрд░ (1 рд╕реЗ 8) рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛рддреА рд╣реИред</sub>  <sub>рдЗрд╕реЗ рдХреНрд▓реЙрдХ рдбрд┐рд╡рд╛рдЗрдбрд░ (CLK_CKDIVR) рдХреЗ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред</sub> <sub><br></sub>  <sub>рдиреЛрдЯ: рд╢реБрд░реБрдЖрдд рдореЗрдВ, рд╡рд┐рднрдХреНрдд 8 рдХреЗ рд╕рд╛рде HSI RC рдерд░рдерд░рд╛рдирд╡рд╛рд▓рд╛ рдХреЛ рдкреНрд░рдореБрдЦ рдШрдбрд╝реА рд╕реНрд░реЛрдд рдХреЗ рд░реВрдк рдореЗрдВ рдЪреБрдирд╛ рдЧрдпрд╛ рд╣реИред</sub> </p><br><p>  рд╣рдореЗрдВ рдбреЗрдЯрд╛рд╢реАрдЯ рдореЗрдВ рд░рдЬрд┐рд╕реНрдЯрд░ рдкрддрд╛ рдорд┐рд▓рддрд╛ рд╣реИ, рд░рд┐рдлрд╝рдореИрди рдореЗрдВ рд╡рд┐рд╡рд░рдг рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рд░рдЬрд┐рд╕реНрдЯрд░ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: </p><br><pre> <code class="plaintext hljs">#define CLK_CKDIVR *(volatile uint8_t *)0x0050C6 CLK_CKDIVR &amp;= ~(0x18);</code> </pre> <br><p>  рдЪреВрдВрдХрд┐ рд╣рдо PWM рд╢реБрд░реВ рдХрд░рдиреЗ рдФрд░ рдПрд▓ рдИ рдбреА рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ, рд╣рдо рдкрд┐рдирдЖрдЙрдЯ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/uv/ii/kt/uviikt-bigbrftn_ivjxx681d8e.png"></p><br><p>  рдЪрд┐рдк рдЫреЛрдЯрд╛ рд╣реИ, рдПрдХ рд╣реА рдкрд┐рди рдкрд░ рдХрдИ рдХрд╛рд░реНрдп рдирд┐рд▓рдВрдмрд┐рдд рд╣реИрдВред  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рд╡рд░реНрдЧ рдХреЛрд╖реНрдардХ рдореЗрдВ "рд╡реИрдХрд▓реНрдкрд┐рдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛" рд╣реИ, рдЗрд╕реЗ " <em>рд╡рд┐рдХрд▓реНрдк рдмрд╛рдЗрдЯреНрд╕</em> " рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рд┐рдЪ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ - рдПрдЯрдореЗрдЧрд╛ рдХреЗ рдлрд╝реНрдпреВрдЬрд╝ рдХреА рддрд░рд╣ рдХреБрдЫред  рдЖрдк рдЙрдирдХреЗ рдореВрд▓реНрдпреЛрдВ рдХреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ, рдХреНрдпреЛрдВрдХрд┐  рд░рд┐рдмреВрдЯ рдХреЗ рдмрд╛рдж рд╣реА рдирдИ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд╕рдХреНрд░рд┐рдп рд╣реЛрддреА рд╣реИред  рдПрд╕рдЯреА рд╡рд┐рдЬрд╝реБрдЕрд▓ рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ (рджреГрд╢реНрдп рд╡рд┐рдХрд╛рд╕ рдХреЗ рд╕рд╛рде рдбрд╛рдЙрдирд▓реЛрдб) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ рдЬреЛ рдЗрди рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред  рдкрд┐рдирдЖрдЙрдЯ рд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдкрд╣рд▓реЗ рдЯрд╛рдЗрдорд░ рдХреЗ рд╕реАрдПрдЪ 1 рдФрд░ рд╕реАрдПрдЪ 2 рдХреЗ рдирд┐рд╖реНрдХрд░реНрд╖ рд╡рд░реНрдЧ рдХреЛрд╖реНрдардХ рдореЗрдВ рдЫрд┐рдкреЗ рд╣реБрдП рд╣реИрдВ;  рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдмрд┐рдЯреНрд╕ AFR1 рдФрд░ AFR0 рдХреЛ STVP рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рдП, рдФрд░ рджреВрд╕рд░рд╛ PD4 рд╕реЗ PC5 рддрдХ рджреВрд╕рд░реЗ рдЯрд╛рдЗрдорд░ рдХреЗ CH1 рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рднреА рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░реЗрдЧрд╛ред </p><br><p>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, 6 рдкрд┐рди рдПрд▓ рдИ рдбреА рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░реЗрдВрдЧреЗ: рдкрд╣рд▓реЗ рдЯрд╛рдЗрдорд░ рдХреЗ рд▓рд┐рдП рдкреАрд╕реА 6, рдкреАрд╕реА 7 рдФрд░ рдкреАрд╕реА 3, рджреВрд╕рд░реЗ рдХреЗ рд▓рд┐рдП рдкреАрд╕реА 5, рдкреАрдбреА 3 рдФрд░ рдкреАрдП 3ред </p><br><p>  STM8 рдкрд░ I / O рдкрд┐рди рд╕реНрд╡рдпрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛ STM32 рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╕рд░рд▓ рдФрд░ рдЕрдзрд┐рдХ рддрд╛рд░реНрдХрд┐рдХ рд╣реИ: </p><br><ul><li>  Atmega <em>рдбреЗрдЯрд╛ рджрд┐рд╢рд╛ рд░рдЬрд┐рд╕реНрдЯрд░ рд╕реЗ</em> рдкрд░рд┐рдЪрд┐рдд: 1 = рдЖрдЙрдЯрдкреБрдЯ; </li><li>  рдЖрдЙрдЯрдкреБрдЯ рдкрд░ рдкрд╣рд▓рд╛ рдХрдВрдЯреНрд░реЛрд▓ рд░рдЬрд┐рд╕реНрдЯрд░ CR1 рдкреБрд╢-рдкреБрд▓ рдореЛрдб (1) рдпрд╛ рдУрдкрди рдбреНрд░реЗрди (0) рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ;  рдЪреВрдВрдХрд┐ рдореИрдВ рдПрд▓рдИрдбреА рдХреЛ рдХреИрдереЛрдб рд╕реЗ рдЪрд┐рдк рд╕реЗ рдЬреЛрдбрд╝рддрд╛ рд╣реВрдВ, рдЗрд╕рд▓рд┐рдП рдореИрдВ рдпрд╣рд╛рдВ рд╢реВрдиреНрдп рдЫреЛрдбрд╝рддрд╛ рд╣реВрдВ; </li><li>  рдЙрддреНрдкрд╛рджрди рдкрд░ рджреВрд╕рд░рд╛ рдирд┐рдпрдВрддреНрд░рдг рд░рдЬрд┐рд╕реНрдЯрд░ CR2 рдШрдбрд╝реА рдХреА рдЧрддрд┐ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ: 1 = 10 рдореЗрдЧрд╛рд╣рд░реНрдЯреНрдЬ </li></ul><br><pre> <code class="plaintext hljs">#define PA_DDR *(volatile uint8_t *)0x005002 #define PA_CR2 *(volatile uint8_t *)0x005004 #define PD_DDR *(volatile uint8_t *)0x005011 #define PD_CR2 *(volatile uint8_t *)0x005013 #define PC_DDR *(volatile uint8_t *)0x00500C #define PC_CR2 *(volatile uint8_t *)0x00500E PA_DDR = (1&lt;&lt;3); //output PA_CR2 |= (1&lt;&lt;3); //fast PD_DDR = (1&lt;&lt;3); //output PD_CR2 |= (1&lt;&lt;3); //fast PC_DDR = ((1&lt;&lt;3) | (1&lt;&lt;5) | (1&lt;&lt;6) | (1&lt;&lt;7)); //output PC_CR2 |= ((1&lt;&lt;3) | (1&lt;&lt;5) | (1&lt;&lt;6) | (1&lt;&lt;7)); //fast</code> </pre> <br><h2 id="nastroyka-shim">  PWM рд╕реЗрдЯрдЕрдк </h2><br><p>  рдкрд╣рд▓реЗ, рд╢рд░реНрддреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ: </p><br><ul><li>  <strong>рдкреАрдбрдмреНрд▓реВрдПрдо рдЖрд╡реГрддреНрддрд┐</strong> - рдЖрд╡реГрддреНрддрд┐ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдЯрд╛рдЗрдорд░ рдЯрд┐рдХ рд░рд╣рд╛ рд╣реИ; </li><li>  <strong>рдСрдЯреЛ-рд░реАрд▓реЛрдб, рдПрдЖрд░</strong> - рдСрдЯреЛрд▓реИрдб рдореВрд▓реНрдп, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдЯрд╛рдЗрдорд░ рдЧрдгрдирд╛ рдХрд░реЗрдЧрд╛ (рдкрд▓реНрд╕ рдЕрд╡рдзрд┐); </li><li>  <strong>рдЕрдкрдбреЗрдЯ рдЗрд╡реЗрдВрдЯ, рдпреВрдИрд╡реА</strong> - рдПрдХ рдШрдЯрдирд╛ <strong>рдЬреЛ рддрдм рд╣реЛрддреА рд╣реИ</strong> рдЬрдм рдЯрд╛рдЗрдорд░ рдПрдЖрд░ рддрдХ рдЧрд┐рдирд╛ рдЬрд╛рддрд╛ рд╣реИ; </li><li>  <strong>рдкреАрдбрдмреНрд▓реВрдПрдо рдбреНрдпреВрдЯреА рд╕рд╛рдЗрдХрд┐рд▓</strong> - рдкреАрдбрдмреНрд▓реВрдПрдо рдХрд░реНрддрд╡реНрдп рдЪрдХреНрд░, рдЬрд┐рд╕реЗ рдЕрдХреНрд╕рд░ "рдХрд░реНрддрд╡реНрдп рдЪрдХреНрд░" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ; </li><li>  <strong>рдХреИрдкреНрдЪрд░ / рддреБрд▓рдирд╛ рдореВрд▓реНрдп</strong> - <strong>рдХреИрдкреНрдЪрд░ / рддреБрд▓рдирд╛ рдХреЗ</strong> рд▓рд┐рдП рдорд╛рди, рдЬрд┐рд╕рдХреА рдЧрдгрдирд╛ рдЯрд╛рдЗрдорд░ <em>рдХреБрдЫ рдХрд░реЗрдЧрд╛</em> (рдкреАрдбрдмреНрд▓реВрдПрдо рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдЖрдЙрдЯрдкреБрдЯ рд╕рд┐рдЧреНрдирд▓ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИ); </li><li>  <strong>рдкреНрд░реАрд▓реЛрдб рд╡реИрд▓реНрдпреВ</strong> - рдкреНрд░реАрд▓реЛрдбреЗрдб рд╡реИрд▓реНрдпреВред  рдЯрд╛рдЗрдорд░ рдЯрд┐рдХ рд╣реЛрдиреЗ рдХреЗ рд╕рдордп <em>рдорд╛рди рдХреА рддреБрд▓рдирд╛</em> рдмрджрд▓ рдирд╣реАрдВ рд╕рдХрддреА, рдЕрдиреНрдпрдерд╛ PWM рдЪрдХреНрд░ рдЯреВрдЯ рдЬрд╛рдПрдЧрд╛ред  рдЗрд╕рд▓рд┐рдП, рдирдП рд╕рдВрдЪрд░рд┐рдд рдореВрд▓реНрдпреЛрдВ рдХреЛ рдмрдлрд░ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЯрд╛рдЗрдорд░ рдХреЗ рдЧрд┐рдирддреА рдХреЗ рдЕрдВрдд рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдФрд░ рд░реАрд╕реЗрдЯ рд╣реЛрдиреЗ рдкрд░ рд╡рд╣рд╛рдВ рд╕реЗ рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ; </li><li>  <strong>рдПрдЬ-рд╕рдВрд░реЗрдЦрд┐рдд</strong> рдФрд░ <strong>рдХреЗрдВрджреНрд░-рд╕рдВрд░реЗрдЦрд┐рдд рдореЛрдб</strong> - рд╕реАрдорд╛ рдкрд░ рдФрд░ <strong>рдХреЗрдВрджреНрд░ рдореЗрдВ</strong> рд╕рдВрд░реЗрдЦрдг, рдПрдЯрдореЗрд▓реЛрд╡рд╕реНрдХреА <em>рдлрд╛рд╕реНрдЯ рдкреАрдбрдмреНрд▓реВрдПрдо</em> рдФрд░ <em>рдЪрд░рдг-рд╕рд╣реА рдкреАрдбрдмреНрд▓реВрдПрдо рдХреЗ рд╕рдорд╛рди</em> ред </li><li>  <strong>OCiREF, рдЖрдЙрдЯрдкреБрдЯ рд╕рдВрджрд░реНрдн рд╕рд┐рдЧреНрдирд▓ рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ</strong> - рд╕рдВрджрд░реНрдн рдЖрдЙрдЯрдкреБрдЯ рд╕рд┐рдЧреНрдирд▓, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдХрд┐ PWM рдореЛрдб рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдкрд┐рди рдкрд░ рд╣реИред </li></ul><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рд╣реА рдкрд┐рдирдЖрдЙрдЯ рд╕реЗ рд╕реНрдкрд╖реНрдЯ рд╣реИ, рджреЛ рдЯрд╛рдЗрдорд░ рдореЗрдВ рдкреАрдбрдмреНрд▓реВрдПрдо рдХреА рдХреНрд╖рдорддрд╛рдПрдВ рд╣реИрдВ - рдкрд╣рд▓рд╛ рдФрд░ рджреВрд╕рд░рд╛ред  рджреЛрдиреЛрдВ 16-рдмрд┐рдЯ рд╣реИрдВ, рдкрд╣рд▓реЗ рд╡рд╛рд▓реЗ рдореЗрдВ рдмрд╣реБрдд рд╕рд╛рд░реА рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╣реИрдВ (рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдпрд╣ рдКрдкрд░ рдФрд░ рдиреАрдЪреЗ рджреЛрдиреЛрдВ рдХреЛ рдЧрд┐рди рд╕рдХрддрд╛ рд╣реИ)ред  рд╣рдо рджреЛрдиреЛрдВ рдХреЛ рдПрдХ рд╣реА рддрд░рд╣ рд╕реЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдореИрдВрдиреЗ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЧрд░реАрдм рджреВрд╕рд░реЗ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛, рддрд╛рдХрд┐ рдЧрд▓рддреА рд╕реЗ рдХрд┐рд╕реА рдРрд╕реА рдЪреАрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ рдЬреЛ рдЗрд╕рдореЗрдВ рдирд╣реАрдВ рд╣реИред  рдХреБрдЫ рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рд╕рдВрджрд░реНрдн рдкреБрд╕реНрддрд┐рдХрд╛ рдореЗрдВ рд╕рднреА рдЯрд╛рдЗрдорд░ рдХреА PWM рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рд╡рд░реНрдгрди рдкрд╣рд▓реЗ рдЯрд╛рдЗрдорд░ (17.5.7 PWM рдореЛрдб) рдХреЗ рдЕрдзреНрдпрд╛рдп рдореЗрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдкреВрд░реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдЖрдЧреЗ рдФрд░ рдкреАрдЫреЗ рдХреВрджрдирд╛ рд╣реЛрдЧрд╛ред </p><br><p>  PWM Atmega рдкрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд▓рд╛рдн PWM рдкрд░ PWM: </p><br><p><img src="https://habrastorage.org/webt/pk/_-/za/pk_-za7gnzo77lvwyw-gvkts1y0.png"><br>  <sub>рдмрдврд╝рдд рд╕рдВрд░реЗрдЦрдг рдХреЗ рд╕рд╛рде PWM</sub> <sub><br></sub>  <sub>рдЦрд╛рддрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдиреАрдЪреЗ рд╕реЗ рдКрдкрд░ рддрдХ</sub> <sub><br></sub>  <sub>рдЕрдЧрд░ TIM_CR1 рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ DIR рдмрд┐рдЯ рд╕рд╛рдлрд╝ рд╣реЛ рдЧрдпрд╛ рд╣реИ рддреЛ рдиреАрдЪреЗ-рдКрдкрд░ рдХреА рдЧрд┐рдирддреА рд╕рдХреНрд░рд┐рдп рд╣реИ</sub> <sub><br></sub>  <sub>рдЙрджрд╛рд╣рд░рдг</sub> <sub><br></sub>  <sub>рдЙрджрд╛рд╣рд░рдг рдкрд╣рд▓реЗ PWM рдореЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред</sub>  <sub>OCiREF PWM рд╕рдВрджрд░реНрдн рд╕рдВрдХреЗрдд рдЙрдЪреНрдЪ рдЖрдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдмрдХрд┐ TIM1_CNT &lt;TIM1_CCRiред</sub>  <sub>рдЕрдиреНрдпрдерд╛, рдпрд╣ рдПрдХ рдирд┐рдореНрди рд╕реНрддрд░ рд▓реЗрддрд╛ рд╣реИред</sub>  <sub>рдпрджрд┐ TIM1_CCRi рдореЗрдВ рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП рдореВрд▓реНрдп рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдореВрд▓реНрдп (рд░рдЬрд┐рд╕реНрдЯрд░ TIM1_ARR) рд╕реЗ рдЕрдзрд┐рдХ рд╣реИ, рддреЛ OCiREF рд╕рд┐рдЧреНрдирд▓ 1 рдкрд░ рдЖрдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <strong>рдпрджрд┐ рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП рдорд╛рди 0 рд╣реИ, рддреЛ OCiREF рд╢реВрдиреНрдп рдкрд░ рдЖрдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</strong></sub>  <sub>...</sub> </p><br><p>  <em>рдЕрджреНрдпрддрди рдШрдЯрдирд╛ рдХреЗ</em> рджреМрд░рд╛рди STM8 рдЯрд╛рдЗрдорд░ рдкрд╣рд▓реЗ <em>рддреБрд▓рдирд╛ рдореВрд▓реНрдп рдХреА</em> рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рд╣реА рдПрдХ рд╕рдВрджрд░реНрдн рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИред  Atmega рдХреЗ рдЯрд╛рдЗрдорд░ рдореЗрдВ рдкрд╣рд▓реЗ рдлреЗрд░рдмрджрд▓ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж, рдЬрд┐рд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдЬрдм <code>compare value == 0</code> рдХрд░рддреЗ <code>compare value == 0</code> рддреЛ рдЖрдЙрдЯрдкреБрдЯ рдПрдХ рд╕реБрдИ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рд▓рдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рддрд╛рд░реНрдХрд┐рдХ рд░реВрдк рд╕реЗ рддрд╛рд░реНрдХрд┐рдХ рддрд░реНрдХ рджреНрд╡рд╛рд░рд╛)ред </p><br><p>  рдЗрд╕рд▓рд┐рдП, рд╣рдо рдХреНрдпрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ: 8-рдмрд┐рдЯ рдкреАрдбрдмреНрд▓реВрдПрдо ( <code>AR == 255</code> ), рд╣рдо рдиреАрдЪреЗ рд╕реЗ рдКрдкрд░ рддрдХ, рд╕реАрдорд╛ рдХреЗ рд╕рд╛рде рд╕рдВрд░реЗрдЦрдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рддреЗ рд╣реИрдВред  рдЪреВрдВрдХрд┐ рдкреНрд░рдХрд╛рд╢ рдмрд▓реНрдм рдХреИрдереЛрдб рджреНрд╡рд╛рд░рд╛ рдЪрд┐рдк рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВ, рдкреАрдбрдмреНрд▓реВрдПрдо рдХреЛ <em>рдореВрд▓реНрдп рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ</em> рд╕реЗ рдкрд╣рд▓реЗ 0 рдФрд░ (рдПрд▓рдИрдбреА рдЪрд╛рд▓реВ рд╣реИ) рдЖрдЙрдЯрдкреБрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред </p><br><p>  рд╣рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХреБрдЫ <em>PWM рдореЛрдб рдХреЗ</em> рдмрд╛рд░реЗ рдореЗрдВ рдкрдврд╝рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдХреЗ рд▓рд┐рдП рд╕рдВрджрд░реНрдн рдкреБрд╕реНрддрд┐рдХрд╛ (18.6.8 - TIMx_CCMR1) рдЦреЛрдЬрдХрд░ рджреВрд╕рд░реЗ рдЯрд╛рдЗрдорд░ рдХрд╛ рд╡рд╛рдВрдЫрд┐рдд рд░рдЬрд┐рд╕реНрдЯрд░ рдвреВрдВрдврддреЗ рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/tt/_3/7s/tt_37syfd9-bib2-ymdxijus9qi.png"><br>  <sub>110: рдкрд╣рд▓рд╛ рдкреАрдбрдмреНрд▓реВрдПрдо рдореЛрдб - рдиреАрдЪреЗ рд╕реЗ рдКрдкрд░ рдХреА рдУрд░ рдЧрд┐рдирддреА рдХрд░рддреЗ рд╕рдордп, рдкрд╣рд▓рд╛ рдЪреИрдирд▓ рд╕рдХреНрд░рд┐рдп рд╣реИ рдЬрдмрдХрд┐ TIMx_CNT &lt;TIMx_CCR1ред</sub>  <sub>рдЕрдиреНрдпрдерд╛, рдкрд╣рд▓рд╛ рдЪреИрдирд▓ рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╣реИред</sub>  <sub>[рдЖрдЧреЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдЧрд▓рдд рдХреЙрдкреА-рдкреЗрд╕реНрдЯ рдЯрд╛рдЗрдорд░ рд╕реЗ 1]</sub> <sub><br></sub>  <sub>111: рджреВрд╕рд░рд╛ рдкреАрдбрдмреНрд▓реВрдПрдо рдореЛрдб - рдиреАрдЪреЗ рд╕реЗ рдКрдкрд░ рдХреА рдУрд░ рдЧрд┐рдирддреА рдХрд░рддреЗ рд╕рдордп, рдкрд╣рд▓рд╛ рдЪреИрдирд▓ рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╣реИ рдЬрдмрдХрд┐ TIMx_CNT &lt;TIMx_CCR1ред</sub>  <sub>рдЕрдиреНрдпрдерд╛, рдкрд╣рд▓рд╛ рдЪреИрдирд▓ рд╕рдХреНрд░рд┐рдп рд╣реИред</sub> </p><br><p>  рдЪреВрдВрдХрд┐ рдПрд▓рдИрдбреА рдПрдордХреЗ рдХреИрдереЛрдб рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реБрдП рд╣реИрдВ, рджреВрд╕рд░рд╛ рдореЛрдб рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИ (рдкрд╣рд▓рд╛ рднреА, рд▓реЗрдХрд┐рди рд╣рдо рдЕрднреА рддрдХ рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реИрдВ)ред </p><br><p><img src="https://habrastorage.org/webt/go/ap/x_/goapx_hk5neeok4phdkas_nnfzu.png"><br>  <sub>рдмрд┐рдЯ 3 OC1PE: рдЖрдЙрдЯрдкреБрдЯ 1 рдкреНрд░реАрд▓реЛрдб рд╕рдХреНрд╖рдо рдХрд░реЗрдВ</sub> <sub><br></sub>  <sub>0: TIMx_CCR1 рдкрд░ рдкреНрд░реА-рд▓реЛрдб рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░реЗрдВред</sub>  <sub>рдЖрдк рдХрд┐рд╕реА рднреА рд╕рдордп TIMx_CCR1 рдХреЛ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВред</sub>  <sub>рдирдпрд╛ рдорд╛рди рддреБрд░рдВрдд рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред</sub> <sub><br></sub>  <sub>1: TIMx_CCR1 рдкрд░ рдкреНрд░реАрд▓реЛрдб рд░рдЬрд┐рд╕реНрдЯрд░ рд╕рдХреНрд╖рдо рд╣реИред</sub>  <sub>рдкреНрд░реАрд▓реЛрдб рд░рдЬрд┐рд╕реНрдЯрд░ рдХреЛ рдкрдврд╝реЗрдВ / рд▓рд┐рдЦреЗрдВ рд╕рдВрдЪрд╛рд▓рдиред</sub>  <sub>рдкреНрд░реАрд▓реЛрдбреЗрдб рдорд╛рди TIMx_CCR1 рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдЕрдкрдбреЗрдЯ рдИрд╡реЗрдВрдЯ рдХреЗ рджреМрд░рд╛рди рдЫрд╛рдпрд╛ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</sub> <sub><br></sub>  <sub>* рдиреЛрдЯ: рдкреАрдбрдмреНрд▓реВрдПрдо рдореЛрдб рдХреЛ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкреНрд░реАрд▓реЛрдб рд░рдЬрд┐рд╕реНрдЯрд░ рдЪрд╛рд▓реВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред</sub> <sub>      (  TIMx_CR1   OPM).</sub> <br></p><p> ,  ,  ,     : </p><br><pre> <code class="plaintext hljs">#define TIM2_CCMR1 *(volatile uint8_t *)0x005307 #define TIM2_CCMR2 *(volatile uint8_t *)0x005308 #define TIM2_CCMR3 *(volatile uint8_t *)0x005309 #define PWM_MODE2 0x70 //PWM mode 2, 0b01110000 #define OCxPE 0x08 //preload enable TIM2_CCMR1 = (PWM_MODE2 | OCxPE); TIM2_CCMR2 = (PWM_MODE2 | OCxPE); TIM2_CCMR3 = (PWM_MODE2 | OCxPE);</code> </pre> <br><p> AR     ,   : </p><br><pre> <code class="plaintext hljs">#define TIM2_ARRH *(volatile uint8_t *)0x00530F #define TIM2_ARRL *(volatile uint8_t *)0x005310 TIM2_ARRH = 0; TIM2_ARRL = 255;</code> </pre> <br><p>      -,   ,    .   , ,  256.        TIM2_PSCR     : </p><br><pre> <code class="plaintext hljs">#define TIM2_PSCR *(volatile uint8_t *)0x00530E TIM2_PSCR = 8;</code> </pre> <br><p>       .     <em>Capture/Compare <strong>Enable</strong></em> :  ,      .     ,     , ..       PWM Mode 1. : </p><br><pre> <code class="plaintext hljs">#define TIM2_CCER1 *(volatile uint8_t *)0x00530A #define TIM2_CCER2 *(volatile uint8_t *)0x00530B #define CC1E (1&lt;&lt;0) // CCER1 #define CC2E (1&lt;&lt;4) // CCER1 #define CC3E (1&lt;&lt;0) // CCER2 TIM2_CCER1 = (CC1E | CC2E); TIM2_CCER2 = CC3E;</code> </pre> <br><p>  , ,     TIMx_CR1: </p><br><p><img src="https://habrastorage.org/webt/u8/rj/5v/u8rj5vb2h3oxtgnoe1zzz90fnfm.png"></p><br><pre> <code class="plaintext hljs">#define TIM2_CR1 *(volatile uint8_t *)0x005300 TIM2_CR1 |= 1;</code> </pre> <br><p>    AnalogWrite(),        .    <em>Capture/Compare registers</em> ,      :  8   TIM2_CCRxL    TIM2_CCRxH.    8- ,     : </p><br><pre> <code class="plaintext hljs">#define TIM2_CCR1L *(volatile uint8_t *)0x005312 #define TIM2_CCR2L *(volatile uint8_t *)0x005314 #define TIM2_CCR3L *(volatile uint8_t *)0x005316 void setRGBled(uint8_t r, uint8_t g, uint8_t b) { TIM2_CCR1L = r; TIM2_CCR2L = g; TIM2_CCR3L = b; }</code> </pre> <br><p>   ,       ,   100%  (   255      ).      ,      ,   . </p><br><p>     ,   . </p><br><p>            (  ,   ┬л┬╗   ,        ).            .      , ..       ,   16-     <em>Prescaler High</em>  <em>Low</em> .   тАж    .   ? </p><br><p>             1,   ,     .  <em>17.7.30 Break register (TIM1_BKR)</em> ,    : </p><br><p><img src="https://habrastorage.org/webt/kb/h8/ue/kbh8ueavruur-vxcqo4fe0c2pdy.png"><br> <sub>  </sub> </p><br><pre> <code class="plaintext hljs">#define TIM1_BKR *(volatile uint8_t *)0x00526D TIM1_BKR = (1&lt;&lt;7);</code> </pre> <br><p>    ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> </a> . </p><br><p><img src="https://habrastorage.org/webt/b9/hb/tn/b9hbtn6retrnp1vpnzxjsjaayoq.jpeg"></p><br><h1 id="stm8-multiplex"> STM8 Multiplex </h1><br><h1 id="multipleksing-na-stm8">   STM8 </h1><br><p>  -   ,          RGB-      .   тАУ  LED-,   ,   -     ,   ,     ( <em>persistence of vision</em> ,   ). -   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">-   </a> . </p><br><p>    : </p><br><ul><li>    RGB LED; </li><li>  ,     ; </li><li>    ; </li><li>    RGB LED; </li><li>  ... </li></ul><br><p>   .. ,    ,     ┬л┬╗   .   .   ,    ,         ,   UEV          RGB-. </p><br><p>   LED  ,   ┬л┬╗,      .   : </p><br><pre> <code class="plaintext hljs">uint8_t colors[8][3];</code> </pre> <br><p>  ,     ,        .         </p><br><pre> <code class="plaintext hljs">uint8_t cnt;</code> </pre> <br><h3 id="demuks">  </h3><br><p>     ,   ,  CD74HC238.  тАУ ,    <code>&lt;&lt;</code> .     ( 0, 1  2)      X,        ( <code>1&lt;&lt;X</code> ).        .            ,     тАУ      ,  ,    .   ,       . </p><br><p> CD74HC238      ,       .           P-MOSFET,       , ..   20 ,  <em>absolute maximum ratings</em>  .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> CD74HC238</a>       : </p><br><p><img src="https://habrastorage.org/webt/b3/lz/rv/b3lzrv4xyavibkiwekm3lbvkays.png"><br> <sub>H =   , L =   , X тАУ  </sub> </p><br><p>  E2  E1  , E3, A0, A1  A3   PD5, PC3, PC4  PC5 STM8.      ,   ,     push-pull . </p><br><h2 id="shim">  </h2><br><p>       ,    ,   : </p><br><p> -,      <em>Update Event</em> (UEV),    ,   LED.     <em>Update Interrupt Enable</em>      </p><br><p><img src="https://habrastorage.org/webt/me/kx/6p/mekx6pckxk6qmhkegaudnneach4.png"><br> <sub>  </sub> </p><br><pre> <code class="plaintext hljs">#define TIM2_IER *(volatile uint8_t *)0x005303 //enable interrupt TIM2_IER = 1;</code> </pre> <br><p>       ,  <em>ghosting</em> тАУ   .       - ,  ,    UEV,   ,       LED      -   .        (0 =  , 255 =   )      .  рдпрд╛рдиреА  ,   UEV       . </p><br><p>  : </p><br><pre> <code class="plaintext hljs">//set polarity TIM2_CCER1 |= (CC1P | CC2P); TIM2_CCER2 |= CC3P;</code> </pre> <br><p>   r, g  b  255       . </p><br><h3 id="preryvaniya">  </h3><br><p>    ,            -  .   -    ,     . </p><br><p>         ST Visual Develop,   <code>main.c</code>       <code>stm8_interrupt_vector.c</code> ,    .         <code>NonHandledInterrupt</code> .        . </p><br><p>      ,    : </p><br><p><img src="https://habrastorage.org/webt/ly/ra/gy/lyragyga5skmcrzjojlftjit1qg.png"><br> <sub>13 TIM2 / <br> 14 TIM2 /</sub> </p><br><p>    LED  UEV,     тДЦ13. </p><br><p> , -,   <code>stm8_interrupt_vector.c</code>   ,    тДЦ13 (IRQ13)    : </p><br><pre> <code class="plaintext hljs">{0x82, TIM2_Overflow}, /* irq13 */</code> </pre> <br><p> -,     <code>main.h</code>  : </p><br><pre> <code class="plaintext hljs">#ifndef __MAIN_H #define __MAIN_H @far @interrupt void TIM2_Overflow (void); #endif</code> </pre> <br><p>  , ,      <code>main.c</code> : </p><br><pre> <code class="plaintext hljs">@far @interrupt void TIM2_Overflow (void) { PD_ODR &amp;= ~(1&lt;&lt;5); //   PC_ODR = (cnt&lt;&lt;3); //      PD_ODR |= (1&lt;&lt;5); //   TIM2_SR1 = 0; //   Update Interrupt Pending cnt++; cnt &amp;= 7; //   LED TIM2_CCR1L = ~colors[cnt][0]; //      TIM2_CCR2L = ~colors[cnt][1]; //     TIM2_CCR3L = ~colors[cnt][2]; // return; }</code> </pre> <br><p>   .     <code>rim</code> тАУ     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Programming Manual</a> : </p><br><pre> <code class="plaintext hljs">//enable interrupts _asm("rim");</code> </pre> <br><p>    тАУ <code>sim</code> тАУ  .          ┬л┬╗,         . </p><br><p>   тАУ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> </a> . </p><br><p><img src="https://habrastorage.org/webt/ri/ul/qs/riulqsjmsnehvg5fb_iofcnjl3u.jpeg"></p><br><p>   -   , ,     .     ,    . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi456094/">https://habr.com/ru/post/hi456094/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi456082/index.html">рд╣рдо рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЙрддреНрдкрд╛рдж рд╕рд┐рдлрд╛рд░рд┐рд╢реЗрдВ рдХреИрд╕реЗ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi456084/index.html">рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ 1.15: рд╣рд╛рдЗрд▓рд╛рдЗрдЯреНрд╕ рдУрд╡рд░рд╡реНрдпреВ</a></li>
<li><a href="../hi456088/index.html">рдмрд┐рдЧ рдбреЗрдЯрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдореБрджреНрджреЗ</a></li>
<li><a href="../hi456090/index.html">рдПрдХрддрд╛ рдореЗрдВ рдЗрдХрд╛рдИ рдкрд░реАрдХреНрд╖рдг рдХрд╛ рдкрд░рд┐рдЪрдп</a></li>
<li><a href="../hi456092/index.html">рд╕рд╛рдд рдкрд░реЗрд╢рд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрдХреЗрдд рдЬреЛ рдЖрдк рдореМрд╕рдо рдкрд░ рдирд┐рд░реНрднрд░ рд╣реИрдВ, рднрд▓реЗ рд╣реА рдЖрдк рдРрд╕рд╛ рди рд╕реЛрдЪрддреЗ рд╣реЛрдВ</a></li>
<li><a href="../hi456096/index.html">рдмрд╛рджрд▓реЛрдВ рдореЗрдВ рдордБрдбрд░рд╛рддреЗ рд╕рдордп рдФрд╕рдд geektimes рдкрд╛рдардХ рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi456100/index.html">рдЕрдм рдирдИ рдкреИрдХреЗрдЬрд┐рдВрдЧ рдореЗрдВ - M.2 рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдХрд┐рдВрдЧреНрд╕реНрдЯрди A400 рдмрд╛рдЬрд╛рд░ рдореЗрдВ рдЖ рдЧрдпрд╛</a></li>
<li><a href="../hi456102/index.html">C / C ++ рдореЗрдВ рдЖрд╕рд╛рди рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ</a></li>
<li><a href="../hi456104/index.html">рдПрдЬрд╝рдмреНрд▓реЙрдХ рдкрд╛рдИ - рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдХреЗ рдмрд┐рдирд╛ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ, рдЗрд╕ рдмрд╛рд░ рд░рд╛рд╕реНрдкрдмреЗрд░реА рдкрд╛рдИ рдХреЗ рдкреНрд░рд╢рдВрд╕рдХреЛрдВ рдХреЗ рд▓рд┐рдП</a></li>
<li><a href="../hi456106/index.html">рд╣рдо рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рддреЗрдЬреА рд╕реЗ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреЗ рд╣реИрдВред Android рдХреЗ рд╡рд┐рдХрд╛рд╕ рдореЗрдВ рдЕрдиреБрднрд╡</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>