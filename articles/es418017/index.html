<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏭 🍼 🤹🏻 Análisis del comportamiento del troyano Pegasus en la red. 🤸🏿 👲🏿 🥕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El código fuente del troyano bancario Pegasus ha sido publicado recientemente. A pesar de la mención del grupo Carbanak en el nombre del archivo, los ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Análisis del comportamiento del troyano Pegasus en la red.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/418017/">  El código fuente del troyano bancario Pegasus ha sido <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">publicado</a> recientemente.  A pesar de la mención del grupo Carbanak en el nombre del archivo, los investigadores de Minerva Labs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">negaron la</a> participación del troyano en este grupo y demostraron su participación en el grupo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Buhtrap</a> (Ratopak).  Dentro del archivo hay una breve descripción del trabajo del troyano, sus códigos fuente, una descripción del sistema de pago bancario y los datos de los empleados de muchos bancos rusos. <br><br>  La arquitectura del código fuente de este malware es bastante interesante.  La funcionalidad se divide en módulos ensamblados en un solo "binpack" en la etapa de compilación.  El proceso de compilación también incluye la firma de archivos ejecutables con un certificado del archivo tric.pfx, que no está en el archivo. <br><br>  No menos curiosa es la actividad de red de Pegasus, que, después de la infección, intenta propagarse dentro del dominio y sabe cómo proxy de datos entre máquinas que utilizan tuberías y el transporte Mailslot.  Nos centramos en estudiar las características de la actividad de red del troyano y rápidamente agregamos los detectores de Pegasus al producto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PT Network Attack Discovery</a> .  Esto permitirá a todos sus usuarios detectar oportunamente la actividad de este troyano y sus modificaciones en su red.  En este artículo, daré una descripción detallada de los mecanismos de distribución de red y la interacción entre copias de Pegasus. <br><br><img src="https://habrastorage.org/webt/yn/sn/-u/ynsn-udu1ai9y-xbrolf4fubrta.png"><a name="habracut"></a><br><br><h2>  Introducción </h2><br>  Una vez en la máquina, el módulo principal InstallerExe inyecta el código en svchost.exe utilizando la técnica Process Hollowing y, después de inicializar los módulos principales, Pegasus inicia varios procesos paralelos: <br><br><ol><li>  Replicación de dominio: se dedica a la inteligencia dentro de la red e intenta extenderse a otras máquinas con Windows. </li><li>  El oyente Mailslot escucha los mensajes de transmisión de correo, a través de los cuales Pegasus envía cuentas minadas.  El nombre del espacio se genera en tiempo de compilación. </li><li>  Pipe Server Listener escucha Windows Pipe con el nombre generado en nombre de la máquina.  Estas tuberías se utilizan principalmente para detectar otras copias de Pegasus en la red y su interacción. </li><li>  Las contraseñas de inicio de sesión periódicamente cada pocos minutos intentan volcar los datos de la cuenta con un módulo de Mimikatz. </li><li>  Network Connectivity es responsable de la comunicación con el servidor CnC y de los mensajes periódicos. </li></ol><br><pre><code class="bash hljs">// start transports <span class="hljs-built_in"><span class="hljs-built_in">which</span></span> links data with our CB-manager pwInitPipeServerAsync(dcmGetServerCallback()); mwInitMailslotServer(dcmGetServerCallback()); ... // start broadcasting creds to other machines cmStartupNetworkBroadcaster();</code> </pre> <br><h2>  Replicación de dominio </h2><br>  Uno de los subsistemas en Pegasus es responsable del movimiento lateral en una red de Windows.  La distribución se divide en dos pasos importantes: <br><br><ol><li>  Detección de autos vecinos. </li><li>  Intento de replicación a una máquina. </li></ol><br>  El descubrimiento de máquinas vecinas en un dominio se realiza a través de dos llamadas API: <br><br><img src="https://habrastorage.org/webt/-p/6f/sj/-p6fsjb6pe8v-rdjacycwncholk.png" align="left">  NetServerEnum, que requiere el servicio del navegador y llamadas a WNetOpenEnum / WNetEnumResource. <br>  Todas las máquinas encontradas en el dominio deben analizarse si ya están infectadas.  Pegasus sondea el nombre de la tubería generada cada 200 milisegundos durante más de 20 veces seguidas.  Utilizamos este comportamiento anormal como uno de los indicadores de la actividad de Pegaso en el dominio.  Al no haber detectado ningún signo de infección, el malware continúa con el siguiente paso: el intento de replicación. <br><br><img src="https://habrastorage.org/webt/j0/nw/yl/j0nwylxgv6mvqzd8krxwf2su2x8.png" align="left">  La replicación es la siguiente.  Usando las cuentas encontradas (KM) en el host, Pegasus intenta iniciar sesión en las bolas IPC $ y ADMIN $ en la máquina a través de SMB, y si hay acceso a IPC $ y no hay acceso a ADMIN $, entonces Pegasus concluye que es correcto la cuenta es insuficiente y debe marcarse como no válida.  Después de obtener acceso a ADMIN $ ball, que es un alias para la carpeta% windir%, el malware intenta determinar la arquitectura de la máquina para poder utilizar el módulo apropiado en el futuro. <br><br>  El algoritmo de determinación de arquitectura se basa en encabezados de archivos PE en la máquina remota.  Como tal archivo, Pegasus intenta leer los primeros 4 kilobytes de notepad.exe de la carpeta% windir%.  Un inconveniente obvio de este método es que en Windows Server 2012, el bloc de notas se encuentra en la ruta% windir% \ System32. <br><br>  Ubicación notepad.exe en Windows 7: <br><br><pre> <code class="bash hljs">C:\Users\Administrator&gt;<span class="hljs-built_in"><span class="hljs-built_in">where</span></span> notepad.exe C:\Windows\System32\notepad.exe C:\Windows\notepad.exe</code> </pre><br>  En Windows Server 2012: <br><br><pre> <code class="bash hljs">C:\Users\Administrator&gt;<span class="hljs-built_in"><span class="hljs-built_in">where</span></span> notepad.exe C:\Windows\System32\notepad.exe</code> </pre><br>  Si no detecta notepad.exe, Pegasus no puede infectar el servidor, incluso si tiene información de cuenta con los derechos necesarios.  La simple ausencia de bloc de notas en% windir% puede detener la distribución de Pegasus en Windows Server 2012. El uso de regedit.exe a este respecto es más confiable. <br><br>  Después de definir con éxito la arquitectura del servidor de destino, Pegasus carga un pequeño gotero RSE (Remote Service Exe) de aproximadamente 10 kilobytes de tamaño, cuya tarea es cargar el binpack desde los módulos de Pegasus a través de la tubería en forma transparente y transferir el control al módulo Shellcode.  El nombre del cuentagotas está compuesto de manera pseudoaleatoria y consiste en una cadena de caracteres hexadecimales de 8 a 15 caracteres de longitud.  El generador pseudoaleatorio se inicializa según el nombre de la máquina de destino y será el mismo entre arranques para evitar el posible desorden de% windir% con copias anteriores del cuentagotas. <br><br><img src="https://habrastorage.org/webt/pu/qb/hf/puqbhf_9-i8k7civefzklrqegxk.png"><br><br>  El antivirus verifica la integridad y la posible eliminación por parte del antivirus, luego de lo cual es lanzado por uno de los dos mecanismos implementados: SCM o WMI, y en primer lugar, Pegasus intenta iniciar RSE a través del mecanismo WMI, y solo luego utilizando el Administrador de control de servicios (SCM).  Esto se debe a que SCM deja más rastros en los registros de Windows.  Los creadores de Pegasus también planearon otros métodos de distribución: Wsh Remote, Powershell remoting, Task Scheduler y un módulo para ejecutar comandos a través de RDP estaba en desarrollo. <br><br>  Como se mencionó anteriormente, después de un lanzamiento exitoso, el cuentagotas verifica y abre la tubería para escuchar y transfiere el control a la carga útil entrante. <br><br><img src="https://habrastorage.org/webt/od/zt/to/odztto9o8_yrp0galq3-9_owej4.png"><br><br>  Dado que el método Process Hollowing inyecta el código Pegasus en el proceso svchost.exe, ni el módulo InstallerExe original debe permanecer en el disco en caso de una infección primaria, ni el cuentagotas RSE en caso de distribución.  Si el gotero aún es accesible por una ruta conocida, Pegasus lo elimina a su manera: <br><br><ol><li>  sobrescribir el contenido del archivo con datos aleatorios; </li><li>  sobrescribir con datos vacíos (ceros); </li><li>  renombrar archivo; </li><li>  eliminación de archivos </li></ol><br><img src="https://habrastorage.org/webt/up/ti/uy/uptiuydt0vx1zc9lz29l2kcdy80.png"><br><br>  Después de una infección exitosa, el proceso de distribución de Replicación de dominio comienza nuevamente. <br><br><h2>  Trabajos de correo </h2><br><img src="https://habrastorage.org/webt/z1/oa/hu/z1oahuoskry5bzymotu4d6n_9kk.png" align="left">  Después de que Pegasus obtenga acceso a los datos de la cuenta, ya sea desde otra copia de Pegasus o desde el módulo mod_LogonPasswords, comenzará a transmitir datos de EE. UU. Por dominio.  La distribución se lleva a cabo utilizando el mecanismo SMB basado en Mailslot, que permite la transmisión unidireccional de una pequeña porción de datos a través de un dominio.  La distribución se realiza de acuerdo con un nombre de ranura generado aleatoriamente y para que todas las máquinas infectadas en el dominio puedan enviar y recibir datos con un solo nombre, el generador pseudoaleatorio para nombres se inicializa desde la variable TARGET_BUILDCHAIN_HASH especificada en la configuración durante la compilación. <br><br>  Dado que el mecanismo de Mailslot impone un límite en el tamaño máximo de paquete, solo se envía un KM a la vez de acuerdo con el principio del último tiempo de envío: entre todos los KM disponibles, el dominio cuya última fecha de envío es la más antigua se envía por dominio. <br><br><img src="https://habrastorage.org/webt/e6/rw/wt/e6rwwt8svxdb_yzrszemgjeonlk.png" align="right">  Los datos en Mailslot no se transmiten en texto claro, sino que se envuelven en tres capas de cifrado XOR, y las claves se transmiten junto con los datos.  La primera capa de datos es el sobre NetMessageEnvelope con comprobación de integridad de datos por el algoritmo SHA1, utilizado para todos los datos transmitidos a través de la red local.  4 bytes de datos al comienzo del paquete son la clave, que se cambia mediante desplazamientos de 5 bits a la derecha por ciclo.  Dentro del sobre hay una estructura de datos codificada XOR con campos directos de EE. UU. Y la fecha en que se agregaron.  La clave de 8 y bytes también se encuentra al comienzo de la estructura, pero se aplica sin compensaciones.  Después de decodificar la estructura KM, solo queda deserializar los campos individuales de las estructuras ENC_BUFFER, como el nombre de la computadora, el nombre de dominio, el nombre de usuario y la contraseña.  Estos campos están encriptados con una clave de 8 bytes con compensaciones.  El script para descifrar el paquete Mailslot y un ejemplo de dicho paquete se pueden encontrar aquí: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">script</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PCAP</a> . <br><br>  El período para enviar mensajes de Mailslot en la versión de lanzamiento varía de 20 segundos a 11 minutos. <br><br><pre> <code class="bash hljs">// some random <span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> before making next step DbgPrint(<span class="hljs-string"><span class="hljs-string">"going to sleep"</span></span>); <span class="hljs-comment"><span class="hljs-comment">#ifdef _DEBUG // debug - 2-5 s Sleep(rg.rgGetRnd(&amp;rg, 2000, 5000)); #else // release - 20 - 650 s //Sleep(rg.rgGetRnd(&amp;rg, 2000, 65000) * 10); Sleep(rg.rgGetRnd(&amp;rg, 2000, 15000)); #endif</span></span></code> </pre> <br>  Además de intercambiar cuentas, el mecanismo Mailslot se utiliza para buscar una máquina infectada con acceso a Internet y para anunciar el acceso a Internet.  El sobre NetMessageEnvelope almacena el tipo de mensaje que se envía.  El intercambio de datos entre la máquina sin acceso y la máquina con acceso a Internet se realiza a través de las tuberías. <br><br><h2>  Tuberías </h2><br>  Para la comunicación bidireccional o la transferencia de grandes cantidades de datos, las copias de Pegasus usan tuberías como canal de comunicación.  El nombre de la tubería, aunque también es generado por un generador pseudoaleatorio, depende del nombre de la máquina y la construcción y, por lo tanto, permite que las partes del cliente y del servidor usen el mismo nombre. <br><br>  En la comunicación unidireccional, por ejemplo, al transferir binpack durante la replicación a otra máquina, los datos no se cifran y se transmiten de forma clara.  Binpack comienza con una estructura SHELLCODE_CONTEXT con una longitud de 561 bytes. <br><br><img src="https://habrastorage.org/webt/qf/ja/89/qfja89-eipqz2lncisi7fkcuqbe.png"><br><br>  Durante la transmisión bidireccional, por ejemplo, proxy de datos entre una copia de Pegasus sin acceso a Internet y un servidor CnC, se utiliza la misma estructura de sobre de NetMessageEnvelope con cifrado XOR como en el caso de Mailslot, porque  le permite distinguir entre diferentes tipos de mensajes en el campo id. <br><br>  Arquitectónicamente, la representación de datos se realiza a través de una solicitud para transferir una parte de los datos (PMI_SEND_QUERY), recibir el id de la solicitud en respuesta y consultar el estado de la tarea por id (PMI_CHECK_STATUS_QUERY).  Como regla general, otra estructura de envolvente se transfiere como una carga, agregando varias funcionalidades y otra capa de cifrado. <br><br>  Además, trabajar con tuberías no termina en la interacción entre máquinas infectadas.  El módulo mod_KBRI_hd inyecta código en los procesos cmd.exe que intercepta las llamadas MoveFileExW y analiza todos los datos que se copian, ya que esto es parte del proceso de pago.  Si el archivo copiado contiene datos que son de interés para los atacantes: datos con pagos, se envía una notificación al servidor CnC.  La comunicación entre el módulo mod_KBRI inyectado en cmd.exe y una copia de Pegasus se lleva a cabo dentro de la máquina infectada a través de una tubería cuyo nombre no se genera pero está codificado en el código fuente: <br><br><pre> <code class="bash hljs">\.\pipe\pg0F9EC0DB75F67E1DBEFB3AFA2</code> </pre> <br><img src="https://habrastorage.org/webt/xr/eh/uj/xrehuj7ia40r-g4ka-osjtq9gjc.png" align="left">  La funcionalidad del módulo también incluye la sustitución de cuentas de datos sobre la marcha de acuerdo con la plantilla.  Un ejemplo de patrones para buscar en la captura de pantalla. <br><br><h2>  Tráfico cnc </h2><br>  Una secuencia separada es responsable del intercambio directo de datos con el servidor CnC, que comprueba la cola de fragmentos de datos de procesos internos u otras copias de malware cada pocos minutos y los envía al servidor. <br><br>  Durante la inicialización del módulo mod_NetworkConnectivity, realiza una comprobación de varias etapas de la conexión de red: <br><br>  1) Detectar la configuración del servidor proxy e intentar conectarse a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.google.com</a> : <br><br><ul><li>  En la rama del registro \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ Configuración de Internet. </li><li>  Vía WPAD (llame a WinHttpGetProxyForUrl). </li><li>  A través de la configuración del proxy para el usuario actual (llame a WinHttpGetIEProxyConfigForCurrentUser). </li></ul><br>  2) Verificación de la conexión con los servidores de actualización de Microsoft y los datos devueltos ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">authrootseq.txt</a> , <a href="">authrootstl.cab</a> , <a href="">rootsupd.exe</a> ) <br><br>  3) Prueba de conexiones HTTPS con una de 6 direcciones: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">safebrowsing.google.com</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aus3.mozilla.org</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">addons.mozilla.org</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fhr.data.mozilla.com</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">versioncheck-bg.addons.mozilla.org</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">services.addons.mozilla.org</a> </li></ul><br>  Solo después de pasar todos los controles, Pegasus cree que tiene el acceso necesario a la red externa y puede anunciar esto a través del dominio Mailslot con un mensaje.  Además, Pegasus puede disfrazarse y comunicarse con el servidor CnC solo durante el horario comercial, de 9 a.m. a 7 p.m., hora local. <br><br>  Pegasus envía fragmentos de datos envueltos en un sobre con el cálculo del hash de la cantidad en forma cifrada usando el cifrado DES en el modo CRYPT_MODE_CBC / PKCS5_PADDING.  La clave de cifrado depende solo de la variable durante la compilación y, por lo tanto, podemos descifrar el tráfico entre el malware y el servidor conociendo solo su BUILDCHAIN_HASH.  En el código fuente dentro del archivo, esta variable tenía el valor 0x7393c9a643eb4a76.  Aquí se puede encontrar un script para descifrar Check-in en el servidor y un ejemplo de dicho paquete: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">script</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PCAP</a> . <br><br>  Transfiere dicho contenido (estructura INNER_ENVELOPE) al servidor CnC durante el Check-in, o junto con cualquier dato.  Inicialmente, hay 28 bytes de un sobre con un campo de longitud y una suma SHA1. <br><br><img src="https://habrastorage.org/webt/po/zs/7s/pozs7shklsxh653kgnbxkgnmgl0.png"><br><br>  Los mismos datos se transfieren entre máquinas durante la transmisión a través de tuberías, pero se envuelven dentro del sobre NetMessageEnvelope que conocemos con una suma hash y un cifrado XOR. <br><br>  El operador CnC puede enviar comandos para su ejecución a copias de Pegasus y mensajes con comandos u otros datos, por ejemplo, EID_CREDENTIALS_LIST puede contener sus propias capas de cifrado de campo, como vimos en el ejemplo de las cuentas de difusión. <br><br><h2>  Detección </h2><br>  En primer lugar, estábamos interesados ​​en detectar la actividad de Pegasus en la red y, después de estudiar cuidadosamente los códigos fuente y ejecutar en el entorno de prueba, descubrimos esas anomalías y artefactos de red que indican claramente la presencia de este complejo malware en la red.  Pegasus realmente se puede llamar versátil: utiliza activamente el protocolo SMB para enviar mensajes y establecer comunicación con otras copias, se extiende a otras máquinas y se comunica con el servidor CnC de su propia manera especial.  Al instalar una red punto a punto en el dominio, las copias de Pegasus allanan el camino a la red externa y se comunican con el servidor CnC mediante la transmisión de tráfico entre sí.  El uso de certificados para firmar archivos ejecutables y el acceso a los recursos de Microsoft y Mozilla durante la verificación de la conexión dificulta la detección de su actividad y detección en el host. <br><br>  El proyecto de código fuente de Pegasus está bastante bien estructurado y descrito, por lo que en el futuro cercano podemos esperar que otros programas maliciosos tomen prestados partes de su código y que aparezcan modificaciones. <br><br>  Muchos de los mecanismos para ejecutar comandos de forma remota y buscar datos de la cuenta no se realizaron, los desarrolladores también agregarían la capacidad de cambiar el código shell durante la implementación sobre la marcha.  Y estas no son todas sus ideas. <br><br>  Hemos desarrollado varias firmas para PT NAD e IDS Suricata, que nos permiten identificar la actividad de red específica de Pegasus en diferentes etapas, comenzando desde los primeros segundos de su actividad.  Puede encontrar firmas abiertas para IDS de Suricata en nuestro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Twitter</a> , que llegarán automáticamente a su Suricata si utiliza el mecanismo de actualización de actualización de Suricata. <br><br>  Puede ver cómo funcionan las firmas para la actividad de Pegasus en la captura de pantalla a continuación.  Este es nuestro nuevo producto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PT Network Attack Discovery</a> que identifica incidentes y ayuda a investigarlos: <br><br> <a href=""><img src="https://habrastorage.org/webt/cc/ok/ou/ccokou2rr1ed01valiivylk6prs.png"></a> <br><br>  Además, se pueden utilizar los siguientes indicadores de compromiso (IC) para la detección: <br><br><pre>  MAILSLOT \ 46CA075C165CBB2786 
 pipe \ pg0F9EC0DB75F67E1DBEFB3AFA2<font></font>
<font></font>
 hxxp: //denwer/pegasus/index.php
 hxxp: //mp3.ucrazy.org/music/index.php
 hxxp: //support.zakon-auto.net/tuning/index.asp
 hxxp: //video.tnt-online.info/tnt-comedy-tv/stream.php </pre><br>  <b>Publicado por</b> Cyril Shipulin de @attackdetection, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Twitter</a> |  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Telegrama</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es418017/">https://habr.com/ru/post/es418017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es418007/index.html">Desarrollo multiplataforma con .NET, programación reactiva, patrón MVVM y generación de código</a></li>
<li><a href="../es418009/index.html">Node.js y representación del servidor en Airbnb</a></li>
<li><a href="../es418011/index.html">Páginas individuales y SEO. Secretos de optimización</a></li>
<li><a href="../es418013/index.html">El Intel Core i7-8086K (parte 3)</a></li>
<li><a href="../es418015/index.html">Nuevo Vasyuki. Desarrollo innovador de Moscú hasta 2100</a></li>
<li><a href="../es418023/index.html">Los punteros en C son más abstractos de lo que piensas</a></li>
<li><a href="../es418025/index.html">El libro "Learning Java EE. Programación moderna para grandes empresas ”</a></li>
<li><a href="../es418027/index.html">Microservice Blitz</a></li>
<li><a href="../es418029/index.html">ReactOS 0.4.9: los que odian tendrán que buscar nuevos argumentos</a></li>
<li><a href="../es418031/index.html">Apilamiento masivo de modelos ML en producción: ¿real o no?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>