<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§òüèº üßùüèº üïô Mini AI Cup 2 ou presque AgarIO - ce qui pourrait √™tre fait pour gagner üñçÔ∏è üìê üë®‚Äçüë©‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous! Cette fois, je veux √©crire comment j'ai r√©ussi √† gagner la comp√©tition Mini AI Cup 2 . Comme dans mon dernier article , il n'y aura pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mini AI Cup 2 ou presque AgarIO - ce qui pourrait √™tre fait pour gagner</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420737/">  Bonjour √† tous!  Cette fois, je veux √©crire comment j'ai r√©ussi √† gagner la comp√©tition <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mini AI Cup 2</a> .  Comme dans mon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dernier article</a> , il n'y aura pratiquement aucun d√©tail de mise en ≈ìuvre.  Cette fois, la t√¢che √©tait moins volumineuse, mais il y avait n√©anmoins beaucoup de nuances et de petites choses qui affectaient le comportement du bot.  En cons√©quence, m√™me apr√®s pr√®s de trois semaines de travail actif sur le bot, il y avait encore des id√©es sur la fa√ßon d'am√©liorer la strat√©gie. <br><br><img src="https://habrastorage.org/webt/iw/ef/hv/iwefhvnhx6m3ubjpwo_d0cgn3qi.png"><br><br>  Sous la coupe, beaucoup de gifs et de trafic. <br><a name="habracut"></a><br>  <i>Les pers√©v√©rants le d√©couvriront, les autres s'enfuiront avec horreur (d'apr√®s les commentaires sur la <s>br√®ve</s> partie compress√©e).</i> <br><br>  <i>Ceux qui sont trop paresseux pour lire beaucoup peuvent aller √† l'avant-dernier spoiler de l'article pour voir une <s>br√®ve</s> description concise de l'algorithme <s>, puis vous pouvez commencer √† lire depuis le d√©but</s> .</i> <br><br>  Lien vers la source <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur le github</a> . <br><br><h3>  S√©lection d'outils </h3><br>  Comme la derni√®re fois, il m'a fallu beaucoup de temps pour r√©fl√©chir par o√π commencer.  Le choix s'est fait, entre autres, entre deux langages: Java, familier pour moi, et d√©j√† assez oubli√© des jours √©tudiants C ++.  Mais comme d√®s le d√©but il me semblait que le principal obstacle √† l'√©criture d'un bon bot ne serait pas tant la vitesse de d√©veloppement que la productivit√© de la solution finale, le choix s'est n√©anmoins port√© en C ++. <br><br>  Apr√®s l'exp√©rience r√©ussie d'utiliser mon propre visualiseur pour d√©boguer le bot lors des comp√©titions pr√©c√©dentes, je ne voulais pas m'en passer cette fois aussi.  Mais le visualiseur que j'ai √©crit moi-m√™me sur Qt pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CodeWars</a> ne ressemblait pas √† une solution id√©ale pour moi, et j'ai d√©cid√© d'utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ce</a> visualiseur.  Il a √©galement √©t√© r√©alis√© sous CodeWars, mais n'a pas n√©cessit√© de traitement s√©rieux pour √™tre utilis√© dans ce concours.  La relative simplicit√© de connexion et la commodit√© d'invoquer le rendu n'importe o√π dans le code jouaient en sa faveur. <br><br>  Comme auparavant, je voulais vraiment d√©boguer n'importe quel tick du jeu - la possibilit√© d'ex√©cuter une strat√©gie √† un moment arbitraire du jeu test√©.  √âtant donn√© que le visualiseur de plug-in n'a pas pu r√©soudre ce probl√®me, √† l'aide de la paire #ifdef (dans laquelle j'ai √©galement encapsul√© les morceaux de code responsables du rendu), j'ai ajout√© √† chaque tick l'enregistrement de la classe Context, qui contenait toutes les valeurs n√©cessaires des variables de la tick pr√©c√©dente.  √Ä la base, la solution √©tait similaire √† celle que j'utilisais dans Code Wizards, mais cette fois, l'approche n'√©tait pas si spontan√©e.  Apr√®s avoir simul√© l'int√©gralit√© du jeu, il vous a √©t√© demand√© de saisir le num√©ro du tick du jeu, qui doit √™tre red√©marr√©.  Des informations sur l'√©tat des variables avant ce tick ont ‚Äã‚Äã√©t√© prises dans le tableau, ainsi que la ligne re√ßue par la strat√©gie d'entr√©e, ce qui m'a permis de jouer les mouvements de ma strat√©gie dans n'importe quel ordre n√©cessaire. <br><br><h3>  Commencer </h3><br>  Le jour de l'ouverture des r√®gles, je ne suis pas pass√© et le premier soir j'ai regard√© ce qui nous attend.  Il n'a pas h√©sit√© √† s'indigner du format d'entr√©e json (oui, c'est pratique, mais certains participants commencent √† apprendre de nouveaux PJ anciens ou oubli√©s depuis longtemps dans de telles comp√©titions, et commencer par l'analyse json n'est pas le plus agr√©able), a examin√© l'√©trange formule de mouvement et a commenc√© √† former le cadre de l'avenir strat√©gies (pour comprendre l'article √† l'avenir, il est utile de lire les <a href="">r√®gles</a> ).  Pendant 2 jours, j'ai √©crit un tas de cours comme Ejection, Virus, Player et autres, lisant json, connectant une biblioth√®que √† fichier unique pour la journalisation ... Et le soir de l'ouverture d'un bac √† sable non class√©, j'avais d√©j√† une strat√©gie qui √©tait presque identique en principe au C ++, mais significativement, un code beaucoup plus grand. <br><br>  Et puis ... j'ai commenc√© √† trouver des options, comment les d√©velopper.  R√©flexions √† l'√©poque: <br><br><ul><li>  La recherche des √©tats du monde ne peut √™tre r√©duite √† ces valeurs qui peuvent dominer le minimax et les modifications; </li><li>  Les champs potentiels sont bons, mais ils r√©pondent mal √† la question de savoir comment le monde changera les n tics suivants; </li><li>  La g√©n√©tique et des algorithmes similaires fonctionneront, mais seulement 20 ms sont donn√©s par coup, et la profondeur de calcul serait souhaitable, √† premi√®re vue, plus que les sensations ne peuvent √™tre trait√©es en utilisant le GA.  Oui, et vous pouvez jouer avec la s√©lection des param√®tres de mutation ¬´avec bonheur pour toujours¬ª. </li></ul><br>  J'ai d√©finitivement d√©cid√© une chose: nous devons faire une simulation du monde.  Apr√®s tout, les calculs approximatifs peuvent-ils ¬´battre¬ª un calcul froid et pr√©cis?  De telles consid√©rations, bien s√ªr, m'ont incit√© √† examiner le code qui √©tait cens√© √™tre responsable de la simulation du monde sur le serveur, car cette fois il a √©t√© mis dans le domaine public avec les r√®gles.  Apr√®s tout, il n'y a rien de mieux que du code qui devrait d√©crire avec pr√©cision les r√®gles du monde? <br><br>  J'ai donc pens√© exactement jusqu'√† ce que je commence √† √©tudier le code qui √©tait cens√© tester nos bots sur le serveur et localement.  Initialement, en termes de compr√©hensibilit√© et d'exactitude du code, tout n'√©tait pas tr√®s bon, et les organisateurs, avec les participants, ont commenc√© √† le traiter activement.  Pendant le test b√™ta (capture quelques jours apr√®s), les changements dans le moteur de jeu ont √©t√© tr√®s graves, et beaucoup n'ont commenc√© √† participer qu'au moment o√π le moteur de test ne se stabilise pas.  Mais au final, √† mon avis, ils ont attendu un moteur qui fonctionne bien pour un jeu tr√®s adapt√© au format comp√©tition.  Je n'ai pas non plus commenc√© √† mettre en ≈ìuvre d'approches s√©rieuses jusqu'√† ce que le coureur local se stabilise, et pendant la premi√®re semaine, rien de plus sens√© n'a √©t√© fait dans mon bot, √† l'exception du visualiseur viss√©. <br><br>  La veille du premier week-end du t√©l√©gramme, les organisateurs ont cr√©√© un groupe distinct dans lequel il √©tait suppos√© que les gens seraient en mesure d'aider √† corriger et √† am√©liorer le coureur local.  J'ai √©galement particip√© aux travaux sur le moteur du monde.  Apr√®s des discussions dans ce chat, en tant que test, j'ai fait 2 demandes de tirage aux param√®tres r√©gionaux du coureur: ajuster la formule <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">alimentaire</a> (et de petits changements dans l'ordre de manger) aux r√®gles, et fusionner plusieurs parties en une seule agaric tout en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">maintenant l'inertie et le centre de masse</a> ).  Ensuite, j'ai commenc√© √† r√©fl√©chir √† la fa√ßon d'ins√©rer une physique de collision saine dans ce code, car la physique pr√©sente dans le monde du jeu √† cette √©poque fonctionnait tr√®s illogiquement.  Les collisions entre les deux agarics n'√©tant pas d√©crites dans le r√®glement, j'ai demand√© aux organisateurs des crit√®res selon lesquels ma mise en place d'une telle logique serait acceptable.  La r√©ponse √©tait la suivante: les agarics dans une collision devraient √™tre ¬´mous¬ª (c'est-√†-dire qu'ils pourraient se heurter un peu), tandis que la logique d'une collision avec les murs ne devrait pas √™tre touch√©e (c'est-√†-dire que les murs devraient simplement arr√™ter les agarics, mais pas les repousser).  Et ma prochaine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">demande de traction a</a> √©t√© une s√©rieuse alt√©ration de la physique. <br><br><div class="spoiler">  <b class="spoiler_title">Avant et apr√®s alt√©ration de la physique</b> <div class="spoiler_text">  <i>Cette physique de collision √©tait:</i> <br><img src="https://habrastorage.org/webt/hx/xc/ey/hxxceykf2thwuvqz9eknvhuy9rw.gif" alt="image"><br>  <i>Et elle le devint apr√®s les mises √† jour:</i> <br><img src="https://habrastorage.org/webt/hu/4s/-k/hu4s-kyhokl2-0sotgkuhib2fem.gif" alt="image"><br></div></div><br>  Je voudrais √©galement souligner <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cette</a> demande de tirage, qui a consid√©rablement r√©duit le code d√©routant avec l'analyse d'√©tat et un grand nombre de bogues trouv√©s (et potentiels) en quelque chose de beaucoup plus intelligible. <br><br><h3>  √âcrire une simulation </h3><br>  Apr√®s avoir apport√© le code des param√®tres r√©gionaux du coureur sous une forme saine, j'ai progressivement commenc√© √† transf√©rer le code de simulation mondiale des param√®tres r√©gionaux du coureur vers mon bot.  Tout d'abord, c'√©tait bien s√ªr un code pour simuler le mouvement des agarics, et en m√™me temps un code pour calculer la physique des collisions.  Il a fallu quelques soir√©es pour sauver le code repens√© des bogues de r√©√©criture (le transfert logique n'a pas √©t√© fait du tout en copiant le code) et des estimations approximatives de la profondeur des calculs. <br><br>  La fonction de notation pour chaque tick √† ce moment √©tait +1 pour la nourriture que je mange et -1 pour la nourriture mang√©e par l'ennemi, ainsi que des valeurs l√©g√®rement plus √©lev√©es pour manger les agarics les uns des autres.  Dans les constantes pour manger d'autres agarics, il y avait initialement une diff√©rence entre manger mon adversaire, mon adversaire (et, bien s√ªr, une tr√®s grosse amende pour avoir mang√© ma derni√®re agarika par l'adversaire), ainsi que deux adversaires diff√©rents l'un de l'autre (apr√®s quelques jours le dernier coefficient est devenu 0).  De plus, la vitesse totale pour tous les ticks pr√©c√©dents de la simulation, chaque tick a √©t√© multipli√©e par 1 + 1e-5 pour encourager mon bot √† effectuer des actions plus utiles au moins un peu plus t√¥t, et √† la fin de la simulation, la vitesse du dernier tick a √©t√© ajout√©e en bonus, √©galement tr√®s petite .  Pour simuler le mouvement des agarics, des points ont √©t√© s√©lectionn√©s sur le bord de la carte avec un pas de 15 degr√©s par rapport aux coordonn√©es arithm√©tiques moyennes de tous mes agarics, et un point a √©t√© s√©lectionn√© lors de la simulation du mouvement auquel la fonction d'estimation a pris la plus grande valeur.  Et d√©j√† avec une simulation aussi primitive et une √©valuation simple √† l'√©poque, le bot s'est en toute confiance retranch√© dans le top 10. <br><br><div class="spoiler">  <b class="spoiler_title">D√©monstration de points, la commande de mouvement √† laquelle l'algorithme a simul√© √† l'origine</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/fy/xr/l_/fyxrl_dc2onzsfeij-vmex1qnoc.gif" alt="image"><br>  <i>Points, dont l'ordre de mouvement a √©t√© donn√© lors de diff√©rentes simulations.</i>  <i>Si vous regardez de tr√®s pr√®s - la commande finale donn√©e est parfois d√©cal√©e par rapport aux points recherch√©s, mais ce sont les cons√©quences de modifications futures.</i> <br></div></div><br>  Au cours de la soir√©e de vendredi et samedi, une simulation de fusion d'agarics, une simulation de ¬´sape¬ª sur les virus, et de deviner le TTF de l'adversaire a √©t√© ajout√©e.  Le TTF de l'adversaire √©tait une valeur calcul√©e assez int√©ressante, et il √©tait possible de comprendre √† quel point l'adversaire a fait une scission ou atteint le virus uniquement en saisissant le moment du vol incontr√¥l√©, qui pourrait durer √† partir d'un tr√®s petit nombre de tiques avec une grande viscosit√© et jusqu'au vol √† travers toute la carte.  √âtant donn√© que les collisions agariques pouvaient entra√Æner un l√©ger exc√®s de leur vitesse maximale, pour calculer le TTF de l'adversaire, j'ai v√©rifi√© que sa vitesse en deux ticks d'affil√©e correspond vraiment √† la vitesse √† laquelle vous pouvez obtenir deux ticks d'affil√©e en vol libre (en vol libre, les agarics volaient strictement en ligne droite et avec ralentissement de chaque tique strictement √©gal √† la viscosit√©).  Cela a presque compl√®tement √©limin√© la possibilit√© de faux positifs.  De plus, lors du test de cette logique, j'ai remarqu√© qu'un TTF plus grand correspond toujours √† un identifiant plus grand de l'agaric (dont j'ai √©t√© plus tard convaincu lors du transfert du code d' <a href="">explosion sur le virus</a> et du <a href="">traitement de la division</a> ), ce qui valait √©galement la peine d'√™tre utilis√©. <br><br>  Apr√®s avoir examin√© les divisions constantes dans le top 3 (ce qui leur a permis de collecter de la nourriture de mani√®re significative sur la carte), comme test, j'ai ajout√© une commande de division permanente au bot s'il n'y avait pas d'ennemi dans le rayon de visibilit√©, et dimanche matin, j'ai trouv√© mon bot sur la deuxi√®me ligne de la note.  G√©rer une poign√©e de petites agarics a consid√©rablement augment√© le classement, mais les perdre √©tait beaucoup plus facile si vous tombez sur un adversaire.  Et comme la peur d'√™tre mang√©e par mes agarics √©tait tr√®s conditionnelle (la peine √©tait seulement pour manger dans une simulation, mais pas pour approcher un adversaire qui pouvait manger), la premi√®re chose a √©t√© ajout√©e une p√©nalit√© pour traverser avec un adversaire qui pouvait manger.  Et cette m√™me √©valuation a fonctionn√© comme un bonus pour chasser un adversaire.  Apr√®s avoir v√©rifi√© la consommation du processeur avec ma strat√©gie, j'ai d√©cid√© d'ajouter un tour de simulation suppl√©mentaire lorsque le fractionnement a √©t√© effectu√© lors du premier tick (cette logique, bien s√ªr, a √©galement d√ª √™tre transf√©r√©e vers mon code √† partir des param√®tres r√©gionaux du runner), puis la simulation s'est d√©roul√©e exactement comme avant. .  Ce type de logique n'√©tait pas tr√®s appropri√© pour "tirer" sur l'ennemi (bien que parfois par accident, il se fendait √† un moment tr√®s appropri√©), mais il √©tait tr√®s bon pour collecter de la nourriture plus rapidement, ce que faisait tout le haut √† ce moment-l√†.  De telles modifications nous ont permis d'entrer la semaine prochaine sur la premi√®re ligne de la notation, bien que la marge ne soit pas significative. <br><br>  √Ä cette √©poque, cela suffisait, la ¬´colonne vert√©brale¬ª de la strat√©gie √©tait √©labor√©e, la strat√©gie semblait assez primitive et extensible.  Mais ce que j'ai vraiment remarqu√©, c'est la consommation du processeur et la stabilit√© globale du code.  Par cons√©quent, les soir√©es de la prochaine partie de la semaine de travail ont √©t√© principalement consacr√©es √† l'am√©lioration de la pr√©cision des simulations (ce que le visualiseur a beaucoup aid√©), √† la stabilisation du code (valgrind) et √† certaines optimisations de la vitesse de travail. <br><br><h3>  Allons de l'avant </h3><br>  Ma prochaine strat√©gie envoy√©e, qui a montr√© un r√©sultat nettement meilleur et devan√ßait les adversaires (√† l'√©poque), contenait deux changements importants: ajouter un champ potentiel pour collecter de la nourriture et doubler le nombre de simulations s'il y a un adversaire avec un TTF inconnu √† proximit√©. <br><br>  Le champ potentiel de collecte de nourriture dans la premi√®re version √©tait assez simple et son essence √©tait de se souvenir de la nourriture qui avait disparu de la zone de visibilit√©, r√©duisant le potentiel dans les endroits pr√®s du bot ennemi et mettant √† z√©ro dans ma zone de visibilit√© (avec restauration ult√©rieure tous les n tiques conform√©ment aux r√®gles).  Cela semblait √™tre une am√©lioration utile, mais dans la pratique, √† mon avis subjectif, la diff√©rence √©tait soit faible, soit compl√®tement absente.  Par exemple, sur des cartes √† forte inertie et vitesse, le bot sautait souvent la nourriture et tentait ensuite d'y revenir, tout en perdant beaucoup de vitesse.  Cependant, s'il d√©cidait de maintenir la vitesse et ignorait simplement la nourriture saut√©e, il mangerait beaucoup plus. <br><br><div class="spoiler">  <b class="spoiler_title">Champ potentiel de collecte de nourriture</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/aw/ae/lg/awaelgpt4zl98lgdjfr1rvk53so.gif" alt="image"><br>  <i>Vous pouvez faire attention √† la fa√ßon dont tous les 40 ticks le champ devient un peu plus lumineux.</i>  <i>Toutes les 40 graduations, le champ est mis √† jour en fonction de la fa√ßon dont la nourriture est ajout√©e sur la carte, et la probabilit√© d'apparition de nourriture est uniform√©ment ¬´√©tal√©e¬ª √† travers le champ.</i>  <i>Si sur cette tique, nous voyons qu'il y a de la nourriture que nous verrions sur la tique pr√©c√©dente - la probabilit√© d'apparition de cet aliment n'est pas "√©tal√©e" avec le reste, mais est fix√©e par des points sp√©cifiques (la nourriture appara√Æt toutes les 40 tiques de mani√®re strictement sym√©trique).</i> <br></div></div><br>  Un utilitaire subjectif compl√®tement diff√©rent s'est av√©r√© √™tre une double simulation de l'ennemi avec diff√©rents TTF - le minimum et le maximum possible (au cas o√π je ne connais pas le TTF pour tous les agarics visibles sur la carte).  Et si plus t√¥t mon robot pensait que le tas d'agarics ennemi deviendrait un tout et se d√©placerait lentement, alors maintenant il a choisi le pire des deux sc√©narios et ne risque pas d'√™tre proche de l'ennemi, dont il sait moins qu'il ne voudrait. <br><br>  Apr√®s avoir obtenu un avantage significatif, j'ai essay√© de l'augmenter en ajoutant une d√©finition du point auquel l'adversaire donne l'ordre √† ses agarics de se d√©placer, et bien que ce point ait √©t√© calcul√© dans la plupart des cas assez pr√©cis√©ment, cela seul n'a pas am√©lior√© les r√©sultats du bot.  Selon mes observations, cela est devenu encore pire que le cas lorsque les agarics de l'adversaire se sont simplement d√©plac√©s dans la m√™me direction et √† la m√™me vitesse que si l'adversaire n'avait rien fait, de sorte que ces modifications ont √©t√© enregistr√©es dans une branche de guitare s√©par√©e jusqu'√† des temps meilleurs. <br><br><div class="spoiler">  <b class="spoiler_title">La d√©finition de l'√©quipe adverse qui a √©t√© utilis√©e plus tard</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/8l/vx/ac/8lvxacnkg_w4byrrkka9znflham.gif" alt="image"><br>  <i>Les rayons des agarics de l'adversaire montrent l'√©quipe pr√©sum√©e que l'adversaire a donn√©e √† leurs agarics lors du tick pr√©c√©dent.</i>  <i>Les rayons bleus sont la direction exacte dans laquelle l'agarik a chang√© de direction au dernier tick.</i>  <i>Le noir est l'intention.</i>  <i>Il n'a √©t√© possible de d√©terminer plus pr√©cis√©ment la direction de l'√©quipe que si la g√©lose √©tait compl√®tement dans la zone de notre visibilit√© (il a √©t√© possible de calculer l'effet des collisions sur le changement de sa vitesse).</i>  <i>L'intersection des rayons est l'√©quipe pr√©vue de l'adversaire.</i>  <i>Gif r√©alis√© sur la base du jeu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">aicups.ru/session/200710</a> , environ 3 000 ticks.</i> <br></div></div><br>  Il y a √©galement eu des tentatives de transfert de la fonction d'√©valuation √† l'√©valuation de la masse gagn√©e, des tentatives de changement de la fonction d'√©valuation du danger de l'adversaire ... Mais encore une fois, tous ces changements de sentiments se sont encore aggrav√©s.  La seule chose qui √©tait utile pour √©valuer le danger d'√™tre proche de l'ennemi √©tait une autre optimisation des performances ainsi que l'extension de cette estimation √† un rayon beaucoup plus grand que le rayon d'intersection avec l'ennemi (essentiellement toute la carte, mais avec une diminution quadratique, si l√©g√®rement simplifi√©e - faisant une pr√©sence dans cinq rayons ou plus de l'adversaire dans la r√©gion de 1/25 du danger maximum d'√™tre mang√©).  Le dernier changement √©galement impr√©vu a conduit au fait que mes agariks ont eu tr√®s peur d'approcher un ennemi beaucoup plus grand, ainsi que dans le cas de leurs tailles tr√®s sup√©rieures √©taient plus enclins √† se diriger vers l'adversaire.  Ainsi, il s'est av√©r√© √™tre un remplacement r√©ussi et peu gourmand en ressources du code pr√©vu pour l'avenir, qui √©tait cens√© √™tre responsable de la peur d'une attaque d'un adversaire par scission (et un peu d'aide pour une telle attaque pour moi plus tard). <br><br>  Apr√®s de longues et relativement vaines tentatives d‚Äôam√©liorer quelque chose, je suis de nouveau revenu √† pr√©dire la direction du mouvement de l‚Äôadversaire.  J'ai d√©cid√© de l'essayer si ce n'est pas seulement pour remplacer les rivaux factices, puis faites comme je l'ai fait avec l'option TTF minimum et maximum - simulez deux fois et choisissez la meilleure.  Mais pour cela, le CPU pourrait ne pas √™tre suffisant, et dans de nombreux jeux de mon bot, ils pourraient simplement se d√©connecter du syst√®me en raison d'un app√©tit insatiable.  Par cons√©quent, avant de mettre en ≈ìuvre cette option, j'ai ajout√© une d√©finition approximative du temps pass√© et, si les limites √©taient d√©pass√©es, j'ai commenc√© √† r√©duire le nombre de mouvements de simulation.  En ajoutant une double simulation de l'ennemi pour le cas o√π je connais l'endroit o√π il se dirige, j'ai de nouveau re√ßu une augmentation assez s√©rieuse dans la plupart des param√®tres de jeu, √† l'exception des plus gourmandes en ressources (avec une grande inertie / faible vitesse / faible viscosit√©), ce qui en raison d'une forte diminution de la profondeur Les simulations pourraient m√™me s'aggraver un peu. <br><br>  Avant le d√©but des parties de 25 000 ticks, deux autres am√©liorations utiles ont √©t√© apport√©es: la p√©nalit√© pour terminer la simulation loin du centre de la carte, ainsi que pour se souvenir de la position pr√©c√©dente de l'adversaire s'il quittait la ligne de vue (ainsi que pour simuler son mouvement √† ce moment-l√†).                    ,                .            CPU      ,     .               .      .     ,          (,    )   ‚Äú‚Äù   ,        . <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple de champ de danger √† la fin d'un virage dans un coin et de tiques g√¢ch√©es</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/rc/qc/7s/rcqc7st4c0xmmzn038tl7eiuxrm.png"><br> <i>      ,         </i> <br><img src="https://habrastorage.org/webt/r_/qm/zx/r_qmzxmxzysmrityd6sld0yjhlw.gif" alt="image"><br> <i>  ,       .      ,      .</i> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, des points de simulation de mouvement ont √©t√© ajout√©s aux points sur le bord de la carte: √† chaque agarik de rivaux et dans un rayon de la coordonn√©e moyenne arithm√©tique de mon agariki tous les 45 degr√©s. </font><font style="vertical-align: inherit;">Le rayon a √©t√© r√©gl√© sur distance moyenne des coordonn√©es arithm√©tiques moyennes de mes agarics.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nouveaux points de simulation</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/1g/tp/s0/1gtps0pna1gmgquavh75h2ta-jc.gif" alt="image"><br> <i>        .       ¬´¬ª   ,   .       .</i> <br></div></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pr√©paration finale </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Au moment de l'ouverture des matchs pour 25 000 ticks et du passage √† la finale, j'avais une solide marge, mais je n'avais pas l'intention de me d√©tendre. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avec les nouveaux jeux 25k, la nouvelle est arriv√©e: les matchs de la finale auront √©galement une longueur de 25k, et la limite de temps de la strat√©gie pour les ticks est devenue un peu plus longue. </font><font style="vertical-align: inherit;">Apr√®s avoir √©valu√© le temps que ma strat√©gie passe sur le jeu dans les nouvelles conditions, j'ai d√©cid√© d'ajouter une autre version de la simulation: on fait tout comme d'habitude, mais pendant la simulation on the go n do split. </font><font style="vertical-align: inherit;">Cela, entre autres, a n√©cessit√© l'utilisation de la simulation trouv√©e √† l'√©tape pr√©c√©dente, mais avec un d√©calage de 1 mouvement (par exemple, si nous avons constat√© que le fractionnement de 7 ticks de l'actuel, alors le coup suivant, nous r√©p√©tons la m√™me chose, mais nous ferons d√©j√† la division au 6√®me coup). </font><font style="vertical-align: inherit;">Cela a consid√©rablement ajout√© des attaques agressives contre ses rivaux, mais a mang√© un peu plus de temps de strat√©gie.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il aurait d√ª y avoir une description concise de l'algorithme</font></font></b> <div class="spoiler_text"> <i>   </i> <br><br>  : <br><img src="https://habrastorage.org/webt/nr/we/mj/nrwemjif4m5vgis-dy_r6shmc3u.gif"><br><ul><li> f ‚Äî ,            ; </li><li> sim ‚Äî        (  ,  , TTF ,     ); </li><li> finalPositionFoodPotentialField ‚Äî   ,   ,    ; </li><li> finalPositionCornerDanger ‚Äî        .        ,         ; </li><li> n ‚Äî ,         .  10   50 ; </li><li> ateFood ‚Äî         i; </li><li> virusBurst ‚Äî            i; </li><li> opponentAteFood ‚Äî        i; </li><li> meAteOpponent ‚Äî      ; </li><li> opponentAteMe ‚Äî      ; </li><li> mine/opponents ‚Äî     .  C'est-√†-dire          ‚Äî      ; </li><li> danger ‚Äî  ,   ,     . </li></ul><br><br><img src="https://habrastorage.org/webt/xu/0b/vq/xu0bvqxveolkicxieftkfrmuv5u.gif"><br><ul><li> moveType ‚Äî    ,        ; </li><li> max/min TTF ‚Äî   ,        TTF   (    TTF ); </li><li> dummy/aim ‚Äî      Dummy         (    ,          ). </li></ul><br><br><img src="https://habrastorage.org/webt/kr/cn/vl/krcnvlbbrj1eyfcai1abuv4o4pi.gif"><br><ul><li> destination ‚Äî ,         ; </li><li> moveTo ‚Äî  ,   n    ‚Äú   ‚Äù   ; </li><li> splitThenMove ‚Äî       split   ; </li><li> delayedSplitThenMove ‚Äî  ,  split    . </li></ul><br><br>             1 .  C'est-√†-dire  splitThenMove    moveTo, delayedSplitThenMove      7  6 ,      6  5  ..     ,     ‚Äî               7 .                . <br><br>  destination : <br><ul><li>      15       ( ‚Äî  ).  24      ; </li><li>  ,       (    ); </li><li>         : </li><li> ‚Äú‚Äù     ,       ; </li><li>  8   .             . </li></ul><br>    destination     ,              . <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tous les perfectionnements ult√©rieurs √©taient exclusivement li√©s √† l'efficacit√© des simulations en cas de manque de TL: optimisation de la s√©quence de d√©connexion de certaines parties de la logique en fonction du CPU consomm√©. </font><font style="vertical-align: inherit;">Dans la plupart des jeux, cela n'√©tait pas cens√© changer quoi que ce soit, mais trouver quelque chose de plus correct ne fonctionnait pas.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Points finaux en finale</font></font></b> <div class="spoiler_text"> <i>          .  808       2424 ,     . <s>   .</s></i> <br> <a href=""><img src="https://habrastorage.org/webt/ij/bi/qf/ijbiqfz4pmd8je8ps7qfvird4pi.png"></a> <br></div></div><br><h4>  Au lieu d'une conclusion </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En g√©n√©ral, le d√©but de cette comp√©tition s'est av√©r√© plut√¥t huil√©, mais dans les premi√®res semaines et demie, la t√¢che a √©t√© ramen√©e √† une forme assez jouable avec l'aide des participants. </font><font style="vertical-align: inherit;">Au d√©part, la t√¢che √©tait tr√®s variable et choisir la bonne approche pour la r√©soudre ne semblait pas √™tre une t√¢che triviale. </font><font style="vertical-align: inherit;">Il √©tait encore plus int√©ressant de trouver des moyens d'am√©liorer l'algorithme sans d√©passer les limites de la consommation du processeur. </font><font style="vertical-align: inherit;">Un grand merci aux organisateurs pour le concours et pour la mise en place des codes sources du monde pour l'acc√®s libre. </font><font style="vertical-align: inherit;">Ces derniers, bien s√ªr, leur ont √©norm√©ment ajout√© des probl√®mes au d√©part, mais ont grandement facilit√© (sinon pour dire, ce qui a permis en principe) la compr√©hension par les participants du dispositif du simulateur mondial. </font><font style="vertical-align: inherit;">Un merci sp√©cial pour l'opportunit√© de choisir un prix! </font><font style="vertical-align: inherit;">Le prix est donc ressorti beaucoup plus utile :-) </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi ai-je besoin d'un autre MacBook?</font></font></s> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr420737/">https://habr.com/ru/post/fr420737/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr420715/index.html">La dure v√©rit√© sur la gravit√© de l'apprentissage</a></li>
<li><a href="../fr420725/index.html">Comment j'ai appris √† l'IA √† jouer √† Tetris pour NES. Partie 1: analyse du code du jeu</a></li>
<li><a href="../fr420729/index.html">Webinaire ouvert "Naive Bayes Classifier"</a></li>
<li><a href="../fr420731/index.html">Zabbix sur les st√©ro√Ødes: comment fonctionne la plate-forme de surveillance unifi√©e de Sbertech</a></li>
<li><a href="../fr420735/index.html">Nous vous invitons √† la finale du marathon Find Yourself in Digital au bureau du groupe Mail.Ru</a></li>
<li><a href="../fr420739/index.html">La bo√Æte est toujours dans la poign√©e: pourquoi en 2018 vous devez encore apprendre les langues vous-m√™me</a></li>
<li><a href="../fr420741/index.html">Aide-m√©moire pour les programmeurs ou "nous allons google pour vous"</a></li>
<li><a href="../fr420749/index.html">GitLab pour le projet de livraison continue sur les technologies InterSystems: conteneurs</a></li>
<li><a href="../fr420753/index.html">Frontend de microservice - une approche moderne de la s√©paration du front</a></li>
<li><a href="../fr420757/index.html">Concours de programmation: commerce (r√©sultats)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>