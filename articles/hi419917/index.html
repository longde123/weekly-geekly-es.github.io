<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСиЁЯП╛тАНЁЯдЭтАНЁЯСиЁЯП╜ ЁЯОЕЁЯП╜ ЁЯТТ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ: рдЯреЗрдВрд╕рд░ рдлреНрд▓реЛ рдФрд░ рдкрд╛рдпрдерди рдкрд░ рдорд╢рд░реВрдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХрд╛рд░реНрдп рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди ЁЯСитАНЁЯСж ЁЯек ЁЯСйЁЯП┐тАНЁЯдЭтАНЁЯСйЁЯП╗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tensor Flow, Google рдХреЗ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдФрд░ рдЙрд╕рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рд▓рд┐рдП рдПрдХ рд░реВрдкрд░реЗрдЦрд╛ рд╣реИред рдЖрдкрдХреЛ рдорд╢реАрди рд╕реАрдЦрдиреЗ рдХреЗ рдЖрдВрддрд░рд┐рдХ рд╡рд┐рд╡рд░рдг рд╕реЗ рдЕрд▓рдЧ рдХрд░рдиреЗ рдФрд░ рдЖрдкрдХреА рд╕рдорд╕реНрдпрд╛ рдХреЛ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ: рдЯреЗрдВрд╕рд░ рдлреНрд▓реЛ рдФрд░ рдкрд╛рдпрдерди рдкрд░ рдорд╢рд░реВрдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХрд╛рд░реНрдп рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419917/">  Tensor Flow, Google рдХреЗ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдФрд░ рдЙрд╕рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рд▓рд┐рдП рдПрдХ рд░реВрдкрд░реЗрдЦрд╛ рд╣реИред  рдЖрдкрдХреЛ рдорд╢реАрди рд╕реАрдЦрдиреЗ рдХреЗ рдЖрдВрддрд░рд┐рдХ рд╡рд┐рд╡рд░рдг рд╕реЗ рдЕрд▓рдЧ рдХрд░рдиреЗ рдФрд░ рдЖрдкрдХреА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдкрд░ рд╕реАрдзреЗ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдПрдХ рдмрд╣реБрдд рд╣реА рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдЪреАрдЬ, рдпрд╣ рдЖрдкрдХреЛ рдХрд┐рд╕реА рднреА рдЬреНрдЮрд╛рдд рдкреНрд░рдХрд╛рд░ рдХреЗ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдмрдирд╛рдиреЗ, рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдореБрдЭреЗ рдЗрд╕ рд╡рд┐рд╖рдп рдкрд░ Habr├й рдкрд░ рдПрдХ рднреА рд╕рдордЭрджрд╛рд░ рдкрд╛рда рдирд╣реАрдВ рдорд┐рд▓рд╛, рдЗрд╕рд▓рд┐рдП рдореИрдВрдиреЗ рдЕрдкрдирд╛ рд▓рд┐рдЦрд╛ред  рдиреАрдЪреЗ рд╣рдо рдЯреЗрдВрд╕рд░ рдлреНрд▓реЛ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╢рд░реВрдо рдХреА рд╕рдорд╕реНрдпрд╛ рдХреЗ рд╕рдорд╛рдзрд╛рди рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛ рд╡рд░реНрдгрди рдХрд░реЗрдВрдЧреЗред  рд╡реИрд╕реЗ, рдиреАрдЪреЗ рд╡рд░реНрдгрд┐рдд рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд▓рдЧрднрдЧ рдХрд┐рд╕реА рднреА рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдХрд┐рд╕реА рд╡реНрдпрдХреНрддрд┐ рдореЗрдВ рдХреИрдВрд╕рд░ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдпрд╛ рдкреЛрдХрд░ рдореЗрдВ рдкреНрд░рддрд┐рджреНрд╡рдВрджреНрд╡реА рдореЗрдВ рдХрд╛рд░реНрдбред <a name="habracut"></a><br><br><h3>  рдХрд╛рд░реНрдп </h3><br>  рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╕рд╛рд░: рдлрдВрдЧрд╕ рдХреЗ рдЗрдирдкреБрдЯ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЗрд╕рдХреА рдПрдбрд┐рдмрд┐рд▓рд┐рдЯреА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред  рд╡рд┐рд╢рд┐рд╖реНрдЯрддрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдпреЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╢реНрд░реЗрдгреАрдмрджреНрдз рд╣реИрдВ, рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдирд╣реАрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, "рд╣реИрдЯ рдЖрдХрд╛рд░" рдкреИрд░рд╛рдореАрдЯрд░ "рдлреНрд▓реИрдЯ" рдпрд╛ "рдЙрддреНрддрд▓" рдпрд╛ "рд╢рдВрдХреБ рдХреЗ рдЖрдХрд╛рд░" рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА</a> рд╕реЗ рд▓рд┐рдП рдЧрдП рдиреЗрдЯрд╡рд░реНрдХ рд▓рд░реНрдирд┐рдВрдЧ рдХреЗ рдорд╢рд░реВрдо рдорд╢рд░реВрдоред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╕рдорд╕реНрдпрд╛ рдХреЗ рд╕рдорд╛рдзрд╛рди рдХреЛ рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдПрдХ рддрд░рд╣ рдХрд╛ рд╣реИрд▓реЛ рд╡рд░реНрд▓реНрдб рдХрд╣рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрд░реЗрдЬ</a> рдХреА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдорд╕реНрдпрд╛</a> , рдЬрд╣рд╛рдВ рдбрд┐рдЬрд┐рдЯрд▓ рдорд╛рдкрджрдВрдбреЛрдВ рдореЗрдВ рдлреВрд▓реЛрдВ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рд╡реНрдпрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br><h3>  рд╕реНрд░реЛрдд рдХреЛрдб </h3><br>  рдЖрдк рдЧрд┐рддреБрдм: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рд┐рдВрдХ</a> рдкрд░ рдореЗрд░реЗ рднрдВрдбрд╛рд░ рд╕реЗ рд╕рднреА рд╕реНрд░реЛрддреЛрдВ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдХреЛрдб рдХреЛ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдореЗрдВ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдРрд╕рд╛ рдХрд░реЗрдВред  рдХреЗрд╡рд▓ рд╕реНрд░реЛрдд рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рд╕рдВрдХреЗрдд рдФрд░ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рд╡рд╣рд╛рдВ рджреЗрдЦреЗ рдЬрд╛рддреЗ рд╣реИрдВред  рдиреАрдЪреЗ рдкреВрд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд░ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдЪрд░реНрдЪрд╛ рдХреА рдЬрд╛рдПрдЧреАред <br><br><h3>  рдЯреНрд░реЗрдирд┐рдВрдЧ </h3><br>  рдпрд╣ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдкреВрд░реНрд╡-рд╕реНрдерд╛рдкрд┐рдд рдЯреЗрдВрд╕рд░ рдлреНрд▓реЛ рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рд╣реИред  рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рд┐рдВрдХ</a> рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><h3>  рд╕реНрд░реЛрдд рдХреЛрдб </h3><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-comment"><span class="hljs-comment">#       . #     CSV-    Tensor Flow       .  ,       (0  1) def prepare_data(data_file_name): header = ['class', 'cap_shape', 'cap_surface', #  CSV-   ,     'agaricus-lepiota.name'   'cap_color', 'bruises', 'odor', 'gill_attachment', 'gill_spacing', 'gill_size', 'gill_color', 'stalk_shape', 'stalk_root', 'stalk_surface_above_ring', 'stalk_surface_below_ring', 'stalk_color_above_ring', 'stalk_color_below_ring', 'veil_type', 'veil_color', 'ring_number', 'ring_type', 'spore_print_color', 'population', 'habitat'] df = pd.read_csv(data_file_name, sep=',', names=header) #   "?"      #        df.replace('?', np.nan, inplace=True) df.dropna(inplace=True) #         #  'e'  'p' .       # ,   0  , 1 -    df['class'].replace('p', 0, inplace=True) df['class'].replace('e', 1, inplace=True) #       , #     . Tensor Flow      # .  Pandas    "get_dummies" #      cols_to_transform = header[1:] df = pd.get_dummies(df, columns=cols_to_transform) #      #    -    () #      () df_train, df_test = train_test_split(df, test_size=0.1) #           num_train_entries = df_train.shape[0] num_train_features = df_train.shape[1] - 1 num_test_entries = df_test.shape[0] num_test_features = df_test.shape[1] - 1 #      csv-, .. #          #  csv,    Tensor Flow df_train.to_csv('train_temp.csv', index=False) df_test.to_csv('test_temp.csv', index=False) #     ,    open("mushroom_train.csv", "w").write(str(num_train_entries) + "," + str(num_train_features) + "," + open("train_temp.csv").read()) open("mushroom_test.csv", "w").write(str(num_test_entries) + "," + str(num_test_features) + "," + open("test_temp.csv").read()) #   ,     os.remove("train_temp.csv") os.remove("test_temp.csv") #        Tensor Flow def get_test_inputs(): x = tf.constant(test_set.data) y = tf.constant(test_set.target) return x, y #        Tensor Flow def get_train_inputs(): x = tf.constant(training_set.data) y = tf.constant(training_set.target) return x, y #        #    ( : , ) #  ,         def new_samples(): return np.array([[0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1]], dtype=np.int) if __name__ == "__main__": MUSHROOM_DATA_FILE = "agaricus-lepiota.data" #     Tensor Flow, #   CSV- (  ) prepare_data(MUSHROOM_DATA_FILE) #    training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename='mushroom_train.csv', target_dtype=np.int, features_dtype=np.int, target_column=0) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename='mushroom_test.csv', target_dtype=np.int, features_dtype=np.int, target_column=0) # ,        ( ) feature_columns = [tf.contrib.layers.real_valued_column("", dimension=98)] #   DNN-  10, 20  10    classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[10, 20, 10], n_classes=2, model_dir="/tmp/mushroom_model") #   classifier.fit(input_fn=get_train_inputs, steps=2000) #        accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=1)["accuracy"] print("\n : {0:f}\n".format(accuracy_score)) #         predictions = list(classifier.predict_classes(input_fn=new_samples)) print("   : {}\n" .format(predictions))</span></span></code> </pre> <br><h3>  рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рдХрд░реЗрдВ </h3><br>  рд╣рдо рдЗрд╕рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдмрдирд╛рдИ рдЧрдИ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА</a> рд╕реЗ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВрдЧреЗред  рд╕рднреА рдбреЗрдЯрд╛ рджреЛ рдлрд╛рдЗрд▓реЛрдВ рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдП рдЧрдП рд╣реИрдВ: agaricus-lepiota.data рдФрд░ agaricus-lepiota.namesред  рдкрд╣рд▓реА 8124 рдкрдВрдХреНрддрд┐рдпрд╛рдБ рдФрд░ 22 рд╕реНрддрдВрднред  рдПрдХ рдкрдВрдХреНрддрд┐ рдПрдХ рдорд╢рд░реВрдо рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдХреЙрд▓рдо рдкреВрд░реЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╢рдмреНрдж рд╕реЗ рдПрдХ рдХрдореА рдЪрд░рд┐рддреНрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╢рд░реВрдо рдХреЗ 22 рдорд╛рдкрджрдВрдбреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред  рд╕рднреА рдкрд╛рддреНрд░реЛрдВ рдХреА рдХрд┐рдВрд╡рджрдВрддреА agarius-lepiota.names рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╣реИред <br><br>  рдЯреИрдиреНрд╕реЛрд░ рдлреНрд▓реЛ рдХреЗ рд▓рд┐рдП рд╕реНрд╡реАрдХрд╛рд░реНрдп рдлреЙрд░реНрдо рдореЗрдВ рд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдкрд╣рд▓реЗ рд╣рдо рдХрд╛рдо рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os</code> </pre> <br>  рдлрд┐рд░ рд╣рдо рдЯреЗрдВрд╕рд░ рдлреНрд▓реЛ рдХреЗ рд▓рд┐рдП рдорд╢рд░реВрдо рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рд╕реЗ рдПрдХ рд╣реЗрдбрд░ рдмрдирд╛рдПрдВрдЧреЗ, рддрд╛рдХрд┐ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рдкрддрд╛ рдЪрд▓реЗ рдХрд┐ рдбреЗрдЯрд╛ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдХреМрди рд╕рд╛ рдХреЙрд▓рдо рдХрд┐рд╕ рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред  рдЯреЛрдкреА рдбреЗрдЯрд╛ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдЪрд┐рдкрдХреА рд╣реБрдИ рд╣реИред  рд╣рдо рдПрдХ рд╕рд░рдгреА рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рддреЗ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рддрддреНрд╡ рдлрд╝рд╛рдЗрд▓ agaricus-lepiota.names рд╕реЗ рд▓рд┐рдП рдЧрдП рд╣реИрдВред <br><br><pre> <code class="python hljs">header = [<span class="hljs-string"><span class="hljs-string">'class'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_shape'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_surface'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'bruises'</span></span>, <span class="hljs-string"><span class="hljs-string">'odor'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_attachment'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_spacing'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_size'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_shape'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_root'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_surface_above_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_surface_below_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_color_above_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_color_below_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'veil_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'veil_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'ring_number'</span></span>, <span class="hljs-string"><span class="hljs-string">'ring_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'spore_print_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'population'</span></span>, <span class="hljs-string"><span class="hljs-string">'habitat'</span></span>] df = pd.read_csv(data_file_name, sep=<span class="hljs-string"><span class="hljs-string">','</span></span>, names=header)</code> </pre> <br>  рдЕрдм рдЖрдкрдХреЛ рд▓рд╛рдкрддрд╛ рдбреЗрдЯрд╛ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдкреНрд░рддреАрдХ "?" рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдмрдЬрд╛рдп agaricus-lepiota.data рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдРрд╕реЗ рдорд╛рдорд▓реЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдо рдХрдо рд╕реЗ рдХрдо рдПрдХ рд▓рд╛рдкрддрд╛ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдкреВрд░реА рд▓рд╛рдЗрди рдХреЛ рд╣рдЯрд╛ рджреЗрдВрдЧреЗред <br><br><pre> <code class="python hljs">df.replace(<span class="hljs-string"><span class="hljs-string">'?'</span></span>, np.nan, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df.dropna(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  рдЕрдЧрд▓рд╛, рдЖрдкрдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдкреНрд░рддреАрдХрд╛рддреНрдордХ рд╕рдВрдкрд╛рджрди рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдбрд┐рдЬрд┐рдЯрд▓ рдХреЗ рд╕рд╛рде рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛ред  рдпрд╣реА рд╣реИ, "p" рдФрд░ "e" рдХреЛ 0 рдФрд░ 1 рд╕реЗ рдмрджрд▓реЗрдВред <br><br><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'class'</span></span>].replace(<span class="hljs-string"><span class="hljs-string">'p'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df[<span class="hljs-string"><span class="hljs-string">'class'</span></span>].replace(<span class="hljs-string"><span class="hljs-string">'e'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж, рдЖрдк рдмрд╛рдХреА рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рдЕрдВрдХ рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣ рдкрд╛рдВрдбрд╛ рдХреА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ get_dummies рдлрд╝рдВрдХреНрд╢рди рдХрд░рддрд╛ рд╣реИред <br><br><pre> <code class="python hljs">cols_to_transform = header[<span class="hljs-number"><span class="hljs-number">1</span></span>:] df = pd.get_dummies(df, columns=cols_to_transform)</code> </pre> <br>  рдХрд┐рд╕реА рднреА рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдХрд╛рдо рдХреА рд╕рдЯреАрдХрддрд╛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдЗрд╕реЗ рдХреИрд▓рд┐рдмреНрд░реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреЛ рджреЛ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВрдЧреЗ - рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдЕрдВрд╢рд╛рдВрдХрдиред  рдкрд╣рд▓рд╛ рджреВрд╕рд░реЗ рд╕реЗ рдмрдбрд╝рд╛ рд╣реЛрдЧрд╛, рдЬреИрд╕рд╛ рдХрд┐ рдпрд╣ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><pre> <code class="python hljs">df_train, df_test = train_test_split(df, test_size=<span class="hljs-number"><span class="hljs-number">0.1</span></span>)</code> </pre> <br>  рдФрд░ рдЖрдЦрд┐рд░реА рд╡рд╛рд▓рд╛ред  Tensor Flow рдХреЛ рдбреЗрдЯрд╛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЗрдВрдЧрд┐рдд рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдФрд░ рд╕реНрддрдВрднреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рд╣рдо рдЕрдкрдиреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдЕрдВрд╢рд╛рдВрдХрди рдбреЗрдЯрд╛рд╕реЗрдЯ рд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓реЗрдВрдЧреЗ рдФрд░ рдлрд┐рд░ рдкрд░рд┐рдгрд╛рдореА CSV рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд▓рд┐рдЦреЗрдВрдЧреЗред <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#         num_train_entries = df_train.shape[0] num_train_features = df_train.shape[1] - 1 num_test_entries = df_test.shape[0] num_test_features = df_test.shape[1] - 1 #     CSV df_train.to_csv('train_temp.csv', index=False) df_test.to_csv('test_temp.csv', index=False) #       CSV,      open("mushroom_train.csv", "w").write(str(num_train_entries) + "," + str(num_train_features) + "," + open("train_temp.csv").read()) open("mushroom_test.csv", "w").write(str(num_test_entries) + "," + str(num_test_features) + "," + open("test_temp.csv").read())</span></span></code> </pre> <br>  рдЕрдВрдд рдореЗрдВ, рдЖрдкрдХреЛ рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП: <a href="">рдкреНрд░рд╢рд┐рдХреНрд╖рдг</a> рдФрд░ <a href="">рдЕрдВрд╢рд╛рдВрдХрди</a> ред <br><br><h3>  рдЬреЗрдирд░реЗрдЯ рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ Tensor Flow рдореЗрдВ рдлреЗрдВрдХ рджреЗрдВ </h3><br>  рдЕрдм рдЬрдм рд╣рдордиреЗ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рд╣реИ рдФрд░ рдорд╢рд░реВрдо рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рд╕реАрдПрд╕рд╡реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдЯреЗрдиреНрд╕рд░ рдлреНрд▓реЛ рдореЗрдВ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣ load_csv_with_header () рдлрдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдлрдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: <br><br><pre> <code class="python hljs">training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=<span class="hljs-string"><span class="hljs-string">'mushroom_train.csv'</span></span>, target_dtype=np.int, features_dtype=np.int, target_column=<span class="hljs-number"><span class="hljs-number">0</span></span>) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=<span class="hljs-string"><span class="hljs-string">'mushroom_test.csv'</span></span>, target_dtype=np.int, features_dtype=np.int, target_column=<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  Load_csv_with_header () рдлрд╝рдВрдХреНрд╢рди рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рд╕реЗ рд╕реЗрдЯ рдХрд┐рдП рдЧрдП рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдбреЗрдЯрд╛ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдореЗрдВ рд▓рдЧрд╛ рд╣реБрдЖ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдордиреЗ рдКрдкрд░ рдПрдХрддреНрд░ рдХрд┐рдпрд╛ рд╣реИред  рдбреЗрдЯрд╛ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдлрд╝рдВрдХреНрд╢рди рдПрдХ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ target_dtype рд▓реЗрддрд╛ рд╣реИ, рдЬреЛ рдЕрдВрдд рдореЗрдВ рдЕрдиреБрдорд╛рдирд┐рдд рдбреЗрдЯрд╛ рдХрд╛ рдПрдХ рдкреНрд░рдХрд╛рд░ рд╣реИред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдХрд╡рдХ рдХреА edibility рдпрд╛ рд╡рд┐рд╖рд╛рдХреНрддрддрд╛ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рд╕рд┐рдЦрд╛рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЬрд┐рд╕реЗ 1 рдпрд╛ 0. рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рд╡реНрдпрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ target_dtype рдПрдХ рдкреВрд░реНрдгрд╛рдВрдХ рдорд╛рди рд╣реИред  features_dtype - рдкреИрд░рд╛рдореАрдЯрд░ рдЬрд╣рд╛рдВ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╕реНрд╡реАрдХреГрдд рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдкреНрд░рдХрд╛рд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдПрдХ рдкреВрд░реНрдгрд╛рдВрдХ рднреА рд╣реИ (рд╢реБрд░реВ рдореЗрдВ рд╡реЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдереЗ, рд▓реЗрдХрд┐рди, рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдпрд╛рдж рдХрд░рддреЗ рд╣реИрдВ, рд╣рдордиреЗ рдЙрдиреНрд╣реЗрдВ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдкрдЫрд╛рдбрд╝ рджрд┐рдпрд╛)ред  рдЕрдВрдд рдореЗрдВ, target_column рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдЙрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдХреЙрд▓рдо рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рд╣реИ рдЬрд┐рд╕реЗ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдирд╛ рд╣реИред  рдпрд╛рдиреА рдПрдбрд┐рдмрд┐рд▓рд┐рдЯреА рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рдеред <br><br><h3>  рдПрдХ Tensor Flow Classifier Object рдмрдирд╛рдПрдВ </h3><br>  рдЕрд░реНрдерд╛рддреН, рдПрдХ рд╡рд░реНрдЧ рдХреА рдПрдХ рд╡рд╕реНрддреБ рдЬреЛ рд╕реАрдзреЗ рдкрд░рд┐рдгрд╛рдо рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИред  рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рд╡рд░реНрдЧред <br><br><pre> <code class="python hljs">feature_columns = [tf.contrib.layers.real_valued_column(<span class="hljs-string"><span class="hljs-string">""</span></span>, dimension=<span class="hljs-number"><span class="hljs-number">98</span></span>)] classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], n_classes=<span class="hljs-number"><span class="hljs-number">2</span></span>, model_dir=<span class="hljs-string"><span class="hljs-string">"/tmp/mushroom_model"</span></span>)</code> </pre> <br>  рдкрд╣рд▓рд╛ рдкреИрд░рд╛рдореАрдЯрд░ feature_columns рд╣реИред  рдпреЗ рдорд╢рд░реВрдо рдХреЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВред  рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкреИрд░рд╛рдореАрдЯрд░ рдорд╛рди рд╡рд╣реАрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рд╣реИред  рд╡рд╣рд╛рдВ, рдЗрдирдкреБрдЯ рдкрд░, рдЖрдпрд╛рдо рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдорд╛рди 98 рд▓рд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╕рдВрдкрд╛рджрди рдХреЗ рдЕрдкрд╡рд╛рдж рдХреЗ рд╕рд╛рде, рдорд╢рд░реВрдо рдХреЗ 98 рд╡рд┐рднрд┐рдиреНрди рдкреИрд░рд╛рдореАрдЯрд░ред <br><br>  Hidden_units - рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдкреНрд░рддреНрдпреЗрдХ рдкрд░рдд рдореЗрдВ рдиреНрдпреВрд░реЙрдиреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ред  рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдХрд▓рд╛ рдХреЗ рд╕реНрддрд░ рдкрд░ рдЙрдирдореЗрдВ рдкрд░рддреЛрдВ рдФрд░ рдиреНрдпреВрд░реЙрдиреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рд╕рд╣реА рдЪрдпрди рдХреБрдЫ рд╣реИред  рдЕрдиреБрднрд╡ рдХреЗ рдмрд╛рдж рд╣реА рдЗрди рдореВрд▓реНрдпреЛрдВ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред  рд╣рдордиреЗ рдЗрди рдирдВрдмрд░реЛрдВ рдХреЛ рд╕рд┐рд░реНрдл рдЗрд╕рд▓рд┐рдП рд▓рд┐рдпрд╛ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ Tensor Flow рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓реНрд╕ рдореЗрдВ рд╕реЗ рдПрдХ рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВред  рдФрд░ рд╡реЗ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред <br><br>  n_classes - рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдХреНрд╖рд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ред  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЙрдирдореЗрдВ рд╕реЗ рджреЛ рд╣реИрдВ - рдЦрд╛рджреНрдп рдФрд░ рдирд╣реАрдВред <br><br>  model_dir - рд╡рд╣ рдкрде рдЬрд╣рд╛рдВ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рд╕рд╣реЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛ред  рдФрд░ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рддрд╛рдХрд┐ рд╣рд░ рдмрд╛рд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рди рдХрд░реЗрдВред <br><br><h3>  рдЯреНрд░реЗрдирд┐рдВрдЧ </h3><br>  рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдХрд╛рдо рдореЗрдВ рдЖрд╕рд╛рдиреА рдХреЗ рд▓рд┐рдП, рд╣рдо рджреЛ рдХрд╛рд░реНрдп рдмрдирд╛рдПрдВрдЧреЗ: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_test_inputs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> x = tf.constant(test_set.data) y = tf.constant(test_set.target) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x, y <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_train_inputs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> x = tf.constant(training_set.data) y = tf.constant(training_set.target) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x, y</code> </pre> <br>  рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рдВрдХреНрд╢рди рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХрд╛ рдЕрдкрдирд╛ рд╕реЗрдЯ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ - рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдФрд░ рдЕрдВрд╢рд╛рдВрдХрди рдХреЗ рд▓рд┐рдПред  x рдФрд░ y рдЯреЗрдиреНрд╕рд░ рдлреНрд▓реЛ рд╕реНрдерд┐рд░рд╛рдВрдХ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рд░реВрдкрд░реЗрдЦрд╛ рдХреЛ рдХрд╛рдо рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рд╡рд┐рд╡рд░рдг рдореЗрдВ рдордд рдЬрд╛рдУ, рдмрд╕ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ рдХрд┐ рдпреЗ рдлрд╝рдВрдХреНрд╢рди рдбреЗрдЯрд╛ рдФрд░ рдПрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдмреАрдЪ рдПрдХ рдордзреНрдпрд╕реНрде рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br>  рд╣рдо рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="python hljs">classifier.fit(input_fn=get_train_inputs, steps=<span class="hljs-number"><span class="hljs-number">2000</span></span>)</code> </pre> <br>  рдкрд╣рд▓рд╛ рдкреИрд░рд╛рдореАрдЯрд░ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХреЛ рдКрдкрд░ рд╕реЗ рдКрдкрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ, рджреВрд╕рд░рд╛ - рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЪрд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ред  рдлрд┐рд░ рд╕реЗ, рдЯреЗрдиреНрд╕рд░ рдлреНрд▓реЛ рдореИрдиреБрдЕрд▓ рдореЗрдВ рд╕реЗ рдПрдХ рдореЗрдВ рдирдВрдмрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдЗрд╕ рд╕реЗрдЯрд┐рдВрдЧ рдХреА рд╕рдордЭ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЕрдиреБрднрд╡ рдХреЗ рд╕рд╛рде рдЖрдПрдЧреАред <br><br>  рдЗрд╕рдХреЗ рдмрд╛рдж, рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдХреИрд▓рд┐рдмреНрд░реЗрдЯ рдХрд░реЗрдВред  рдпрд╣ рдКрдкрд░ рдЙрддреНрдкрдиреНрди рдЕрдВрд╢рд╛рдВрдХрди рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдХрд╛рд░реНрдп рдХрд╛ рдкрд░рд┐рдгрд╛рдо рднрд╡рд┐рд╖реНрдп рдХреА рдиреЗрдЯрд╡рд░реНрдХ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпреЛрдВ (рд╕рдЯреАрдХрддрд╛_рд╕реНрдХреЛрд░) рдХреА рд╕рдЯреАрдХрддрд╛ рд╣реЛрдЧреАред <br><br><pre> <code class="python hljs">accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=<span class="hljs-number"><span class="hljs-number">1</span></span>)[<span class="hljs-string"><span class="hljs-string">"accuracy"</span></span>] print(<span class="hljs-string"><span class="hljs-string">"\n : {0:f}\n"</span></span>.format(accuracy_score))</code> </pre> <br><h3>  рд╣рдо рдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВрдЧреЗ </h3><br>  рдЕрдм рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рддреИрдпрд╛рд░ рд╣реИ, рдФрд░ рдЖрдк рдЗрд╕рдХреА рдорджрдж рд╕реЗ рдХрд╡рдХ рдХреА рдХреНрд╖рдорддрд╛ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new_samples</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.array([[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]], dtype=np.int)</code> </pre> <br>  рдЙрдкрд░реЛрдХреНрдд рдлрд╝рдВрдХреНрд╢рди рджреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдирдП рдорд╢рд░реВрдо рдХрд╛ рдбреЗрдЯрд╛ рджреЗрддрд╛ рд╣реИ рдЬреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдореЗрдВ рдпрд╛ рдЕрдВрд╢рд╛рдВрдХрди рд╕реЗрдЯ рдореЗрдВ рдореМрдЬреВрдж рдирд╣реАрдВ рдереЗ (рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЙрдиреНрд╣реЗрдВ рдмрд╕ рдмрд╛рдж рд╡рд╛рд▓реЗ рд╕реЗ рдЦреАрдВрдЪрд╛ рдЧрдпрд╛ рдерд╛)ред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХрд▓реНрдкрдирд╛ рдХреАрдЬрд┐рдП рдХрд┐ рдЖрдкрдиреЗ рдЙрдиреНрд╣реЗрдВ рдмрд╛рдЬрд╛рд░ рдореЗрдВ рдЦрд░реАрджрд╛ рд╣реИ, рдФрд░ рдпрд╣ рд╕рдордЭрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдЙрдиреНрд╣реЗрдВ рдЦрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдХреЛрдб рдЗрд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдЧрд╛: <br><br><pre> <code class="python hljs">predictions = list(classifier.predict(input_fn=new_samples)) print(<span class="hljs-string"><span class="hljs-string">"   : {}\n"</span></span> .format(predictions))</code> </pre> <br>  рдХрд╛рд░реНрдп рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдирд┐рдореНрди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП: <br><br><pre> <code class="python hljs">   : [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]</code> </pre> <br>  рдФрд░ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдкрд╣рд▓рд╛ рдорд╢рд░реВрдо рдЬрд╣рд░реАрд▓рд╛ рд╣реИ, рджреВрд╕рд░рд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЦрд╛рджреНрдп рд╣реИред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдЖрдк рдХрд┐рд╕реА рднреА рдбреЗрдЯрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЪрд╛рд╣реЗ рд╡рд╣ рдорд╢рд░реВрдо рд╣реЛ, рд▓реЛрдЧ рд╣реЛрдВ, рдЬрд╛рдирд╡рд░ рд╣реЛрдВ рдпрд╛ рдХреБрдЫ рднреА рд╣реЛред  рдпрд╣ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред  рдФрд░ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдПрдХ рдорд░реАрдЬ рдХреА рдЕрддрд╛рд▓рддрд╛ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдпрд╛ рд╕реНрдЯреЙрдХ рдПрдХреНрд╕рдЪреЗрдВрдЬ рдкрд░ рд╕реНрдЯреЙрдХ рдореВрд▓реНрдп рдЖрдВрджреЛрд▓рдиред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi419917/">https://habr.com/ru/post/hi419917/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi419905/index.html">рдмреНрд▓реИрдХ рд▓реЙрдиреНрдЪ рдХреЗ рдмрд╛рдж рдЖрдзреА рд╕рджреА рдореЗрдВ рдпреВрдХреЗ рд▓реЙрдиреНрдЪ рдЙрджреНрдпреЛрдЧ рдЬрд╛рдЧрддрд╛ рд╣реИ рдФрд░ рд▓рдХреНрд╖реНрдп рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi419907/index.html">рдореЛрдмрд╛рдЗрд▓ рдЧреЗрдо рд▓реЙрдиреНрдЪ рдЯрд┐рдкреНрд╕: рднрд╛рдЧ 2, рдЧреНрд▓реЛрдмрд▓ рд▓реЙрдиреНрдЪ</a></li>
<li><a href="../hi419911/index.html">рдкрд╛рдпрдерди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдХрд╛рд╢реАрдп рдкрд┐рдВрдбреЛрдВ рдХреА рдХрдХреНрд╖рд╛рдУрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг</a></li>
<li><a href="../hi419913/index.html">IKEA рдФрд░ рд╕реНрдорд╛рд░реНрдЯ рдШрд░ред рднрд╛рдЧ реи</a></li>
<li><a href="../hi419915/index.html">Initramfs рдореЗрдВ рдмреЙрдиреНрдбрд┐рдВрдЧ рдФрд░ SSH рд╕рд░реНрд╡рд░</a></li>
<li><a href="../hi419919/index.html">SQL рд╕рд░реНрд╡рд░ рдХреЗ рдЕрдВрджрд░ рд╕рдВрд╕реНрдХрд░рдг рдирд┐рдпрдВрддреНрд░рдг</a></li>
<li><a href="../hi419921/index.html">рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 10 рдорд┐рд▓рд┐рдпрди рдкреИрдХреЗрдЯ рдХреИрд╕реЗ рдЧрд┐рд░рд╛рдПрдВ</a></li>
<li><a href="../hi419923/index.html">рдореЗрд░рд╛ рдЕрд╕реНрдерд╛рдпреА рдХрд╛рдо, рдорджрд░рдмреЛрд░реНрдб рджреЗрдЦрддрд╛ рд╣реИ</a></li>
<li><a href="../hi419925/index.html">GitHub Gist рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╕рдВрд╕реНрдХрд░рдг рдирд┐рдпрдВрддреНрд░рдг</a></li>
<li><a href="../hi419927/index.html">[рдбреЙрдЯрдиреЗрдЯрдмреБрдХ] рдЕрдкрд╡рд╛рдж: рдЯрд╛рдЗрдк рд╕рд┐рд╕реНрдЯрдо рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>