<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒŸ ğŸ•ºğŸ¾ ğŸ‘©ğŸ¾â€ğŸ¨ Nä¸ªç‰©ä½“çš„ä»»åŠ¡æˆ–å¦‚ä½•åœ¨ä¸ç¦»å¼€å¨æˆ¿çš„æƒ…å†µä¸‹ç‚¸æ¯æ˜Ÿç³» ğŸ‘¨ğŸ½â€âœˆï¸ ğŸ˜ƒ ğŸ¤¹ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä¸ä¹…å‰ï¼Œæˆ‘è¯»äº†åˆ˜å¥‡æ–°çš„ç§‘å¹»å°è¯´ã€Šä¸‰ä½“é—®é¢˜ã€‹ ã€‚ åœ¨å…¶ä¸­ï¼Œä¸€äº›å¤–æ˜Ÿäººé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜-ä»–ä»¬ä¸çŸ¥é“å¦‚ä½•ä»¥è¶³å¤Ÿçš„å‡†ç¡®åº¦æ¥è®¡ç®—è‡ªå·±æ˜Ÿçƒçš„è½¨è¿¹ã€‚ ä¸æˆ‘ä»¬ä¸åŒï¼Œä»–ä»¬ç”Ÿæ´»åœ¨ä¸‰æ˜Ÿçº§ç³»ç»Ÿä¸­ï¼Œæ˜Ÿçƒä¸Šçš„â€œå¤©æ°”â€åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå®ƒä»¬çš„ç›¸å¯¹ä½ç½®-ä»ç„šçƒ§çš„çƒ­é‡åˆ°å†°å†·çš„å¤©æ°”ã€‚ æˆ‘å†³å®šæ£€æŸ¥æˆ‘ä»¬æ˜¯å¦å¯ä»¥è§£å†³æ­¤ç±»é—®é¢˜ã€‚ 

 ç°è±¡çš„ç‰©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nä¸ªç‰©ä½“çš„ä»»åŠ¡æˆ–å¦‚ä½•åœ¨ä¸ç¦»å¼€å¨æˆ¿çš„æƒ…å†µä¸‹ç‚¸æ¯æ˜Ÿç³»</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437014/"><br><img src="https://habrastorage.org/webt/ke/eo/en/keeoenv3rtuxqu19szhk5hzfb7q.png"><br><br> ä¸ä¹…å‰ï¼Œæˆ‘è¯»äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ˜å¥‡æ–°çš„</a>ç§‘å¹»å°è¯´<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ã€Šä¸‰ä½“é—®é¢˜ã€‹</a> ã€‚ åœ¨å…¶ä¸­ï¼Œä¸€äº›å¤–æ˜Ÿäººé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜-ä»–ä»¬ä¸çŸ¥é“å¦‚ä½•ä»¥è¶³å¤Ÿçš„å‡†ç¡®åº¦æ¥è®¡ç®—è‡ªå·±æ˜Ÿçƒçš„è½¨è¿¹ã€‚ ä¸æˆ‘ä»¬ä¸åŒï¼Œä»–ä»¬ç”Ÿæ´»åœ¨ä¸‰æ˜Ÿçº§ç³»ç»Ÿä¸­ï¼Œæ˜Ÿçƒä¸Šçš„â€œå¤©æ°”â€åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå®ƒä»¬çš„ç›¸å¯¹ä½ç½®-ä»ç„šçƒ§çš„çƒ­é‡åˆ°å†°å†·çš„å¤©æ°”ã€‚ æˆ‘å†³å®šæ£€æŸ¥æˆ‘ä»¬æ˜¯å¦å¯ä»¥è§£å†³æ­¤ç±»é—®é¢˜ã€‚ <br><a name="habracut"></a><br><h2> ç°è±¡çš„ç‰©ç† </h2><br> è¦ç†è§£é—®é¢˜ï¼Œæœ‰å¿…è¦å¤„ç†ç°è±¡çš„ç‰©ç†ç°è±¡ã€‚ åœ¨å¤å…¸ç†è®ºçš„æ¡†æ¶ä¸­ï¼Œä¸¤ä¸ªç‰©ä½“çš„å¸å¼•åŠ›ç”±<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç‰›é¡¿</a>å®šå¾‹ç¡®å®šï¼š <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">c</span><span class="MJXp-mrow" id="MJXp-Span-6"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">F</span></span><span class="MJXp-mrow" id="MJXp-Span-8"><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-mtext" id="MJXp-Span-10">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">c</span><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mrow" id="MJXp-Span-15" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">r</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-17" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-18"><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼Œ</span></span><span class="MJXp-mtext" id="MJXp-Span-20">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">c</span><span class="MJXp-msubsup" id="MJXp-Span-24"><span class="MJXp-mrow" id="MJXp-Span-25" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">r</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-27" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-28"><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">G</span><span class="MJXp-msubsup" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-35" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-36"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-38" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-39">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">c</span><span class="MJXp-mrow" id="MJXp-Span-44"><span class="MJXp-mtext" id="MJXp-Span-45">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">c</span><span class="MJXp-msubsup" id="MJXp-Span-49"><span class="MJXp-mrow" id="MJXp-Span-50" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">r</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-52" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-54">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">c</span><span class="MJXp-msubsup" id="MJXp-Span-58"><span class="MJXp-mrow" id="MJXp-Span-59" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">r</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-61" style="vertical-align: -0.4em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-62"><span class="MJXp-mrow" id="MJXp-Span-63"><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-65">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">c</span><span class="MJXp-msubsup" id="MJXp-Span-69"><span class="MJXp-mrow" id="MJXp-Span-70" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">r</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-72" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-74">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">c</span><span class="MJXp-msubsup" id="MJXp-Span-78"><span class="MJXp-mrow" id="MJXp-Span-79" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">r</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-82"><span class="MJXp-mrow" id="MJXp-Span-83" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-85" style="vertical-align: 0.5em;">3</span></span></span><span class="MJXp-mrow" id="MJXp-Span-86"><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼Œ</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ vec {F}ï¼ˆ\ vec {r} _1ï¼Œ\ vec {r} _2ï¼‰=-G m_1 m_2 \ frac {\ vec {r} _1-\ vec {r} _2} {| \ vec {r} _1-\ vec {r} _2 | ^ 3}ï¼Œ</script></p><br><br> åœ¨å“ªé‡Œ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-88"><span class="MJXp-mtext" id="MJXp-Span-89">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">c</span><span class="MJXp-msubsup" id="MJXp-Span-93"><span class="MJXp-mrow" id="MJXp-Span-94" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">r</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-96" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-97"><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼Œ</span></span><span class="MJXp-mtext" id="MJXp-Span-99">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">c</span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mrow" id="MJXp-Span-104" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">r</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-106" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-2"> \ vec {r} _1ï¼Œ\ vec {r} _2 </script>  -ç‰©ä½“åœ¨å¤ªç©ºä¸­çš„ä½ç½®ï¼Œ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-msubsup" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-110" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-111"><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼Œ</span></span><span class="MJXp-msubsup" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-115" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-3"> m_1ï¼Œm_2 </script>  -å¤§é‡çš„èº«ä½“ï¼Œ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">G</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-4"> G </script>  -é‡åŠ›å¸¸æ•°ã€‚ <br> åœ¨ç³»ç»Ÿä¸­ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-5"> N </script> æ¯ä¸ªèº«ä½“ä¸Šçš„èº«ä½“éƒ½ä¼šå—åˆ°å…¶ä½™èº«ä½“çš„å¸å¼•åŠ›çš„å½±å“ï¼Œå…¶æ–¹ç¨‹å¼å¦‚ä¸‹ï¼š <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-120"><span class="MJXp-mtext" id="MJXp-Span-121">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">c</span><span class="MJXp-msubsup" id="MJXp-Span-125"><span class="MJXp-mrow" id="MJXp-Span-126" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">F</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-128" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-129" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">G</span><span class="MJXp-mtext" id="MJXp-Span-132">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">u</span><span class="MJXp-msubsup" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-137" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">k</span><span class="MJXp-mtext" id="MJXp-Span-139">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-146" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-msubsup" id="MJXp-Span-147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-149" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mtext" id="MJXp-Span-150">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">c</span><span class="MJXp-mrow" id="MJXp-Span-155"><span class="MJXp-mtext" id="MJXp-Span-156">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">c</span><span class="MJXp-msubsup" id="MJXp-Span-160"><span class="MJXp-mrow" id="MJXp-Span-161" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-163" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-165">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">c</span><span class="MJXp-msubsup" id="MJXp-Span-169"><span class="MJXp-mrow" id="MJXp-Span-170" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-172" style="vertical-align: -0.4em;">k</span></span></span><span class="MJXp-mrow" id="MJXp-Span-173"><span class="MJXp-mrow" id="MJXp-Span-174"><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-176">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">c</span><span class="MJXp-msubsup" id="MJXp-Span-180"><span class="MJXp-mrow" id="MJXp-Span-181" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-183" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-185">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">c</span><span class="MJXp-msubsup" id="MJXp-Span-189"><span class="MJXp-mrow" id="MJXp-Span-190" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-192" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-193"><span class="MJXp-mrow" id="MJXp-Span-194" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-196" style="vertical-align: 0.5em;">3</span></span></span><span class="MJXp-mrow" id="MJXp-Span-197"><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.278em; margin-right: 0.278em;">ã€‚</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> \ vec {F} _n = -G \ sum_ {k \ neq n} m_n m_k \ frac {\ vec {r} _n-\ vec {r} _k} {| \ vec {r} _n-\ vec {r } _k | ^ 3}ã€‚ </script></p><br><br> ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼Œ</a>æˆ‘ä»¬ä¸ºæ¯ä¸ªç²’å­å†™åŠ é€Ÿåº¦ï¼š <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-199"><span class="MJXp-mtext" id="MJXp-Span-200">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">c</span><span class="MJXp-msubsup" id="MJXp-Span-204"><span class="MJXp-mrow" id="MJXp-Span-205" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">a</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-207" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-209">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">c</span><span class="MJXp-msubsup" id="MJXp-Span-213"><span class="MJXp-mrow" id="MJXp-Span-214" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">F</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-216" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mrow" id="MJXp-Span-217"><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-221" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">G</span><span class="MJXp-mtext" id="MJXp-Span-225">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">u</span><span class="MJXp-msubsup" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-230" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">k</span><span class="MJXp-mtext" id="MJXp-Span-232">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-239" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mtext" id="MJXp-Span-240">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">c</span><span class="MJXp-mrow" id="MJXp-Span-245"><span class="MJXp-mtext" id="MJXp-Span-246">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">c</span><span class="MJXp-msubsup" id="MJXp-Span-250"><span class="MJXp-mrow" id="MJXp-Span-251" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-253" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">c</span><span class="MJXp-msubsup" id="MJXp-Span-259"><span class="MJXp-mrow" id="MJXp-Span-260" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-262" style="vertical-align: -0.4em;">k</span></span></span><span class="MJXp-mrow" id="MJXp-Span-263"><span class="MJXp-mrow" id="MJXp-Span-264"><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-266">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">c</span><span class="MJXp-msubsup" id="MJXp-Span-270"><span class="MJXp-mrow" id="MJXp-Span-271" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-273" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-275">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">c</span><span class="MJXp-msubsup" id="MJXp-Span-279"><span class="MJXp-mrow" id="MJXp-Span-280" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-282" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-283"><span class="MJXp-mrow" id="MJXp-Span-284" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-286" style="vertical-align: 0.5em;">3</span></span></span><span class="MJXp-mrow" id="MJXp-Span-287"><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0.278em; margin-right: 0.278em;">ã€‚</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-7"> \ vec {a} _n = \ vec {F} _n / m_n = -G \ sum_ {k \ neq n} m_k \ frac {\ vec {r} _n-\ vec {r} _k} {| \ vec { r} _n-\ vec {r} _k | ^ 3}ã€‚ </script></p><br><br> å›é¡¾åŠ é€Ÿåº¦æ˜¯åæ ‡çš„ç¬¬äºŒæ—¶é—´å¯¼æ•°ï¼Œæˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªäºŒé˜¶åå¾®åˆ†æ–¹ç¨‹ï¼Œå¿…é¡»æ±‚è§£è¯¥æ–¹ç¨‹æ‰èƒ½è·å¾—æ¯ä¸ªç‰©ä½“çš„è½¨è¿¹ï¼š <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-289"><span class="MJXp-mtext" id="MJXp-Span-290">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">c</span><span class="MJXp-mrow" id="MJXp-Span-295"><span class="MJXp-mtext" id="MJXp-Span-296" style="color: red;">\éƒ¨</span><span class="MJXp-msubsup" id="MJXp-Span-297"><span class="MJXp-mrow" id="MJXp-Span-298" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-299" style="margin-left: 0.278em; margin-right: 0.278em;">åˆ†</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-300" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">c</span><span class="MJXp-msubsup" id="MJXp-Span-305"><span class="MJXp-mrow" id="MJXp-Span-306" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-308" style="vertical-align: -0.4em;">n</span></span></span><span class="MJXp-mrow" id="MJXp-Span-309"><span class="MJXp-mtext" id="MJXp-Span-310" style="color: red;">\éƒ¨</span><span class="MJXp-mrow" id="MJXp-Span-311"><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0.278em; margin-right: 0.278em;">åˆ†</span></span><span class="MJXp-msubsup" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-315" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-319" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">G</span><span class="MJXp-mtext" id="MJXp-Span-323">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">u</span><span class="MJXp-msubsup" id="MJXp-Span-326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-328" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">k</span><span class="MJXp-mtext" id="MJXp-Span-330">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-337" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mtext" id="MJXp-Span-338">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">c</span><span class="MJXp-mrow" id="MJXp-Span-343"><span class="MJXp-mtext" id="MJXp-Span-344">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">c</span><span class="MJXp-msubsup" id="MJXp-Span-348"><span class="MJXp-mrow" id="MJXp-Span-349" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-351" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-353">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">c</span><span class="MJXp-msubsup" id="MJXp-Span-357"><span class="MJXp-mrow" id="MJXp-Span-358" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-360" style="vertical-align: -0.4em;">k</span></span></span><span class="MJXp-mrow" id="MJXp-Span-361"><span class="MJXp-mrow" id="MJXp-Span-362"><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-364">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">c</span><span class="MJXp-msubsup" id="MJXp-Span-368"><span class="MJXp-mrow" id="MJXp-Span-369" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-371" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-372" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-373">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">c</span><span class="MJXp-msubsup" id="MJXp-Span-377"><span class="MJXp-mrow" id="MJXp-Span-378" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-380" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-381"><span class="MJXp-mrow" id="MJXp-Span-382" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-384" style="vertical-align: 0.5em;">3</span></span></span><span class="MJXp-mrow" id="MJXp-Span-385"><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0.278em; margin-right: 0.278em;">ã€‚</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> \ frac {\éƒ¨åˆ†^ 2 \ vec {r} _n} {\éƒ¨åˆ†t ^ 2} = f_n = -G \ sum_ {k \ neq n} m_k \ frac {\ vec {r} _n-\ vec {r } _k} {| \ vec {r} _n-\ vec {r} _k | ^ 3}ã€‚ </script></p><br> è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œè®¡ç®—å‡½æ•°çš„å¤æ‚æ€§ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-387"><span class="MJXp-msubsup" id="MJXp-Span-388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-390" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> f_n </script> ç­‰äº <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">O</span><span class="MJXp-mrow" id="MJXp-Span-393"><span class="MJXp-mo" id="MJXp-Span-394" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-msubsup" id="MJXp-Span-395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-397" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-398"><span class="MJXp-mo" id="MJXp-Span-399" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> Oï¼ˆN ^ 2ï¼‰</script> å¹¶ä¸”éšç€ç›¸äº’ä½œç”¨ä½“æ•°é‡çš„å¢åŠ è€Œæ˜¾ç€å¢åŠ ã€‚ <br><br><h2> æ•°å­¦ </h2><br> æ±‚è§£å¾®åˆ†æ–¹ç¨‹çš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯æœ€ç®€å•çš„æ–¹æ³•æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Euleræ–¹æ³•</a> ï¼Œè¯¥æ–¹æ³•è®¾è®¡ç”¨äºæ±‚è§£ä»¥ä¸‹å½¢å¼çš„æ–¹ç¨‹ï¼š <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-400"><span class="MJXp-mtext" id="MJXp-Span-401">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">c</span><span class="MJXp-mrow" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">y</span></span><span class="MJXp-mrow" id="MJXp-Span-409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">x</span></span><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">f</span><span class="MJXp-mrow" id="MJXp-Span-414"><span class="MJXp-mo" id="MJXp-Span-415" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">x</span><span class="MJXp-mrow" id="MJXp-Span-417"><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼Œ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">y</span><span class="MJXp-mrow" id="MJXp-Span-420"><span class="MJXp-mo" id="MJXp-Span-421" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span><span class="MJXp-mrow" id="MJXp-Span-422"><span class="MJXp-mo" id="MJXp-Span-423" style="margin-left: 0.278em; margin-right: 0.278em;">ã€‚</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> \ frac {dy} {dx} = fï¼ˆxï¼Œyï¼‰ã€‚ </script></p><br> è¿‡æ¸¡åˆ°ç¦»æ•£åŒºåŸŸåï¼Œæˆ‘ä»¬è·å¾—ï¼š <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-424"><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-427" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-432" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">i</span><span class="MJXp-mo" id="MJXp-Span-434">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-435">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">f</span><span class="MJXp-mrow" id="MJXp-Span-439"><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-msubsup" id="MJXp-Span-441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-443" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">i</span><span class="MJXp-mo" id="MJXp-Span-445">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-446">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-447"><span class="MJXp-mo" id="MJXp-Span-448" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼Œ</span></span><span class="MJXp-msubsup" id="MJXp-Span-449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-451" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">i</span><span class="MJXp-mo" id="MJXp-Span-453">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-454">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-455"><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span><span class="MJXp-mrow" id="MJXp-Span-457"><span class="MJXp-mo" id="MJXp-Span-458" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼Œ</span></span><span class="MJXp-mtext" id="MJXp-Span-459">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">i</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-466">1</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-468">2</span><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-470">3</span><span class="MJXp-mrow" id="MJXp-Span-471"><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼Œ</span></span><span class="MJXp-mtext" id="MJXp-Span-473" style="color: red;">\ç‚¹</span><span class="MJXp-mrow" id="MJXp-Span-474"><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼Œ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">m</span><span class="MJXp-mrow" id="MJXp-Span-477"><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼Œ</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> y_ {i} = y_ {i-1} + h fï¼ˆx_ {i-1}ï¼Œy_ {i-1}ï¼‰ï¼Œ\ quad i = 1,2,3ï¼Œ\ç‚¹ï¼Œmï¼Œ</script></p><br> åœ¨å“ªé‡Œ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> h </script> æ˜¯æ•´åˆæ­¥éª¤ï¼Œå¹¶ä¸” <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> m </script>  -é›†æˆæ­¥éª¤æ•°ã€‚ å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ä¸€æ¬¡è®¡ç®—ç‰©ä½“çš„ä½ç½® <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> T </script> é‚£æˆ‘ä»¬åº”è¯¥åš <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">m</span><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-488"><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0.278em; margin-right: 0.278em;">å¨</span></span><span class="MJXp-mrow" id="MJXp-Span-490"><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mrow" id="MJXp-Span-492"><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0.278em; margin-right: 0.278em;">å°</span></span><span class="MJXp-mrow" id="MJXp-Span-494"><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0.278em; margin-right: 0.278em;">æ—¶</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> m =å¨/å°æ—¶</script> æ•´åˆæ­¥éª¤ã€‚ åœ¨è¿™é‡Œç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯å¯è§çš„-å¦‚æœ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> T </script> å¾ˆå¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦é‡‡å–å¤§é‡çš„é›†æˆæ­¥éª¤ã€‚ <br><br> è¦å°†æ¬§æ‹‰æ–¹æ³•åº”ç”¨äºæˆ‘ä»¬çš„é—®é¢˜ï¼Œåº”å°†å…¶ç®€åŒ–ä¸ºä¸€é˜¶ç³»ç»Ÿã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¼•å…¥äº†å¦ä¸€ä¸ªå˜é‡-ç²’å­é€Ÿåº¦ï¼š <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-498"><span class="MJXp-mtext" id="MJXp-Span-499">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">c</span><span class="MJXp-mrow" id="MJXp-Span-504"><span class="MJXp-mtext" id="MJXp-Span-505" style="color: red;">\éƒ¨</span><span class="MJXp-mrow" id="MJXp-Span-506"><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0.278em; margin-right: 0.278em;">åˆ†</span></span><span class="MJXp-mtext" id="MJXp-Span-508">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">c</span><span class="MJXp-msubsup" id="MJXp-Span-512"><span class="MJXp-mrow" id="MJXp-Span-513" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">v</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-515" style="vertical-align: -0.4em;">n</span></span></span><span class="MJXp-mrow" id="MJXp-Span-516"><span class="MJXp-mtext" id="MJXp-Span-517" style="color: red;">\éƒ¨</span><span class="MJXp-mrow" id="MJXp-Span-518"><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0.278em; margin-right: 0.278em;">åˆ†</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">t</span></span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-524" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mrow" id="MJXp-Span-525"><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼Œ</span></span><span class="MJXp-mspace" id="MJXp-Span-527" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-528">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">c</span><span class="MJXp-mrow" id="MJXp-Span-533"><span class="MJXp-mtext" id="MJXp-Span-534" style="color: red;">\éƒ¨</span><span class="MJXp-mrow" id="MJXp-Span-535"><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0.278em; margin-right: 0.278em;">åˆ†</span></span><span class="MJXp-mtext" id="MJXp-Span-537">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">c</span><span class="MJXp-msubsup" id="MJXp-Span-541"><span class="MJXp-mrow" id="MJXp-Span-542" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-544" style="vertical-align: -0.4em;">n</span></span></span><span class="MJXp-mrow" id="MJXp-Span-545"><span class="MJXp-mtext" id="MJXp-Span-546" style="color: red;">\éƒ¨</span><span class="MJXp-mrow" id="MJXp-Span-547"><span class="MJXp-mo" id="MJXp-Span-548" style="margin-left: 0.278em; margin-right: 0.278em;">åˆ†</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">t</span></span><span class="MJXp-mo" id="MJXp-Span-550" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-551">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">c</span><span class="MJXp-msubsup" id="MJXp-Span-555"><span class="MJXp-mrow" id="MJXp-Span-556" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">v</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-558" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mrow" id="MJXp-Span-559"><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0.278em; margin-right: 0.278em;">ã€‚</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-18"> \ frac {\éƒ¨åˆ†\ vec {v} _n} {\éƒ¨åˆ†t} = f_nï¼Œ\\ \ frac {\éƒ¨åˆ†\ vec {r} _n} {\éƒ¨åˆ†t} = \ vec {v} _nã€‚ </script></p><br><br> è§£å¾®åˆ†æ–¹ç¨‹ç»„çš„ç¬¬äºŒä¸ªé—®é¢˜æ˜¯è§£åŠå…¶æ§åˆ¶çš„å‡†ç¡®æ€§ã€‚ å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æé«˜å‡†ç¡®æ€§ï¼šé€šè¿‡å‡å°‘ç§¯åˆ†æ­¥éª¤å’Œé€‰æ‹©å…·æœ‰æ›´é«˜å‡†ç¡®æ€§çš„æ–¹æ³•ã€‚ ä¸¤ç§æ–¹æ³•éƒ½å¯¼è‡´è®¡ç®—å¤æ‚æ€§çš„å¢åŠ ï¼Œä½†æ˜¯æ–¹å¼ä¸åŒã€‚ ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç»å…¸çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å››é˜¶Runge-Kuttaæ–¹æ³•</a> ï¼›å®ƒéœ€è¦å››ä¸ªå‡½æ•°è®¡ç®— <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-561"><span class="MJXp-msubsup" id="MJXp-Span-562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-564" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> f_n </script> åœ¨æ¯ä¸ªæ­¥éª¤ä¸­ï¼Œä½†å…·æœ‰ä¸€å®šçš„å‡†ç¡®æ€§ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">O</span><span class="MJXp-mrow" id="MJXp-Span-567"><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-msubsup" id="MJXp-Span-569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-571" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mrow" id="MJXp-Span-572"><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> Oï¼ˆh ^ 4ï¼‰</script>  ï¼ˆä¸ºäº†è¿›è¡Œæ¯”è¾ƒï¼Œæ¬§æ‹‰æ–¹æ³•çš„ç²¾åº¦ä¸º <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">O</span><span class="MJXp-mrow" id="MJXp-Span-576"><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">h</span><span class="MJXp-mrow" id="MJXp-Span-579"><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> Oï¼ˆhï¼‰</script> å¹¶éœ€è¦è¿›è¡Œä¸€æ¬¡è®¡ç®— <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-581"><span class="MJXp-msubsup" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-584" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> f_n </script>  ï¼‰ è§£å†³æ–¹æ¡ˆçš„å‡†ç¡®æ€§ä¹Ÿå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ§åˆ¶ï¼šä¸åˆ†æè§£å†³æ–¹æ¡ˆè¿›è¡Œæ¯”è¾ƒï¼Œä½¿ç”¨ä¸åŒæ–¹æ³•æˆ–ä¸åŒæ­¥éª¤è¿›è¡Œè§£å†³å¹¶æ¯”è¾ƒç»“æœï¼Œæ§åˆ¶è§£å†³æ–¹æ¡ˆå¿…é¡»éµå®ˆçš„ç¬¬ä¸‰æ–¹å‚æ•°å’Œé™åˆ¶ã€‚ <br> è€Œä¸”ï¼Œè¿™äº›æ–¹æ³•ä¸­çš„æ¯ä¸€ç§éƒ½æœ‰å…¶ç¼ºç‚¹ã€‚ å¯èƒ½æ²¡æœ‰åˆ†æå†³å®šï¼Œæˆ–è€…ç”šè‡³åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç”šè‡³æ˜¯å®Œå…¨æ²¡æœ‰ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºæˆ‘ä»¬çš„ä»»åŠ¡ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> N </script> ç”µè¯åˆ†æè§£å†³æ–¹æ¡ˆä»…é€‚ç”¨äº <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">N</span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-590">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> N = 2 </script>  ï¼Œä½†è¿™è¶³ä»¥æµ‹è¯•æ–¹æ³•çš„å‡†ç¡®æ€§ã€‚ ç”¨ä¸¤ç§æ–¹æ³•æˆ–ç”¨ä¸åŒçš„æ­¥éª¤è§£å†³é—®é¢˜ä¼šå¢åŠ è®¡ç®—æ—¶é—´ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•å‡ ä¹å¯ä»¥åº”ç”¨äºä»»ä½•ä»»åŠ¡ã€‚ å¹¶éæ¯é¡¹ä»»åŠ¡éƒ½æœ‰å±€é™æ€§ï¼Œä½†å¯¹æˆ‘ä»¬è€Œè¨€ï¼Œå®ƒä»¬éƒ½æœ‰å±€é™æ€§ï¼šåœ¨æ•´åˆçš„æ¯ä¸ªæ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥æ§åˆ¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¿æŠ¤æ³•</a>çš„æ‰§è¡Œã€‚ è¿™ç§æ–¹æ³•ä¹Ÿå¢åŠ äº†è®¡ç®—çš„å¤æ‚æ€§ï¼Œä½†æ˜¯æœ‰å¾ˆå¤šé€‰æ‹©ï¼Œæ‰€æœ‰ç²’å­çš„åŠ¨é‡å’Œæˆ–è§’åŠ¨é‡ä¹‹å’Œçš„è®¡ç®—éƒ½éå¸¸å¤æ‚ã€‚ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">O</span><span class="MJXp-mrow" id="MJXp-Span-593"><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">N</span><span class="MJXp-mrow" id="MJXp-Span-596"><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> Oï¼ˆNï¼‰</script>  ï¼Œè€Œè®¡ç®—ç³»ç»Ÿçš„æ€»èƒ½é‡å…·æœ‰é˜¶æ•°å¤æ‚æ€§ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">O</span><span class="MJXp-mrow" id="MJXp-Span-600"><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-msubsup" id="MJXp-Span-602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-604" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-605"><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> Oï¼ˆN ^ 2ï¼‰</script><br><br><div class="spoiler">  <b class="spoiler_title">å…³äºè®¡ç®—æ€»èƒ½é‡çš„æ³¨æ„äº‹é¡¹</b> <div class="spoiler_text"> åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œç³»ç»Ÿçš„æ€»èƒ½é‡ç”±ä¸¤éƒ¨åˆ†ç»„æˆ-åŠ¨èƒ½å’ŒåŠ¿èƒ½ã€‚ åŠ¨èƒ½ç”±æ‰€æœ‰ç‰©ä½“çš„åŠ¨èƒ½ä¹‹å’Œç»„æˆã€‚ è¦è®¡ç®—åŠ¿èƒ½ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å‰©ä½™ç²’å­çš„å¼•åŠ›åœºä¸­å°†æ¯ä¸ªç²’å­çš„åŠ¿èƒ½ç›¸åŠ ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ·»åŠ  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">O</span><span class="MJXp-mrow" id="MJXp-Span-609"><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-msubsup" id="MJXp-Span-611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-613" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-614"><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span></span></span><script type="math/tex" id="MathJax-Element-27"> Oï¼ˆN ^ 2ï¼‰</script> æ¡æ¬¾ã€‚ å›°éš¾åœ¨äºæ‰€æœ‰é¡¹çš„é˜¶æ¬¡éå¸¸ä¸åŒï¼Œå³ä½¿ä½¿ç”¨åŒç²¾åº¦è®¡ç®—ï¼Œä¹Ÿæ— æ³•ä»¥è¶³ä»¥åœ¨ä¸åŒæ­¥éª¤è¿›è¡Œæ¯”è¾ƒçš„ç²¾åº¦æ¥è®¡ç®—è¯¥å€¼ã€‚ ä¸ºäº†å…‹æœè¿™ä¸ªé—®é¢˜ï¼Œæœ‰å¿…è¦æ ¹æ®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kahanç®—æ³•è¿›è¡Œ</a>æ±‚å’Œã€‚ <br></div></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4d8/270/e1d/4d8270e1d2f39d30e9d2e5beabec6fa0.png" alt="æ¤­åœ†è½¨è¿¹"></div><br><p>  <b>å›¾1.</b> <i>æ¤­åœ†è½¨è¿¹çš„ç¤ºä¾‹ã€‚</i> </p><br><br><br> è€ƒè™‘ä¸€ä¸‹å«æ˜Ÿç»•åœ°çƒæ¤­åœ†è½¨é“è¿åŠ¨çš„ç®€å•æƒ…å†µã€‚ éšç€å«æ˜Ÿæ¥è¿‘åœ°çƒï¼Œå…¶é€Ÿåº¦ä¼šå¢åŠ ï¼Œè€Œå½“è¿œç¦»åœ°çƒç§»åŠ¨æ—¶ï¼Œå…¶é€Ÿåº¦ä¼šé™ä½ï¼Œå› æ­¤æœ‰å¯èƒ½å‡å°‘è½¨é“ç»¿è‰²éƒ¨åˆ†çš„æ—¶é—´ç§¯åˆ†æ­¥é•¿ï¼Œå¹¶ä»¥çº¢è‰²å’Œè“è‰²å¢åŠ ç§¯åˆ†æ­¥é•¿è€Œä¸ä¼šæ”¹å˜è§£å†³æ–¹æ¡ˆçš„ç²¾åº¦ã€‚ è®©æˆ‘ä»¬å°è¯•æ›´è¯¦ç»†åœ°æ¯”è¾ƒã€‚ <br><br>  <b>è¡¨1.</b> <i>ç ”ç©¶å¾®åˆ†æ–¹ç¨‹çš„ç ”ç©¶æ–¹æ³•</i> <br><table><tbody><tr><th> å·²æ ‡è®° </th><th> è®¢è´­ </th><th> å†…å®¹æè¿° </th></tr><tr><td> äºšå½“æ–¯ </td><td>  1-5 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äºšå½“æ–¯-å·´ä»€ç¦ç‰¹æ³•</a> </td></tr><tr><td> æ¬§æ‹‰ </td><td>  1ä¸ª </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¬§æ‹‰æ³•</a> </td></tr><tr><td>  rk4 </td><td>  4 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç»å…¸Runge-Kuttaæ–¹æ³•</a> </td></tr><tr><td> å°”å…‹ </td><td>  5 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¡ä»€å¡æ™®æ–¹æ³•</a> </td></tr><tr><td>  rkdp </td><td>  5 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¤šæ›¼ç‹å­æ³•</a> </td></tr><tr><td>  rkdverk </td><td>  6 </td><td>  Werneræ–¹æ³•<a href="">1ï¼‰</a> pã€‚  181 </td></tr><tr><td>  rkf </td><td>  7 </td><td> è´¹å°”ä¼¯æ ¼æ–¹æ³•<a href="">1ï¼‰</a> pã€‚  180 </td></tr><tr><td>  kg </td><td>  6 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">éšå«é«˜æ–¯-å‹’æ ¼å¾·æ–¹æ³•</a> </td></tr><tr><td>  rklc </td><td>  4 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">éšå¼Lobattoæ–¹æ³•</a> </td></tr><tr><td> ç©ºä¸­é£äºº </td><td>  2 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¢¯å½¢æ³•</a> </td></tr></tbody></table><br> è¦ä¸ºæˆ‘ä»¬çš„ä»»åŠ¡é€‰æ‹©æœ€ä½³æ–¹æ³•ï¼Œæˆ‘ä»¬å°†æ¯”è¾ƒå‡ ç§å·²çŸ¥æ–¹æ³•ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº†ä¸¤ä¸ªç‰©ä½“ç³»ç»Ÿçš„ç¢°æ’ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">N</span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-619">512</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> N = 512 </script> å¹¶åœ¨ä»¿çœŸç»“æŸæ—¶æµ‹é‡<a href="">æ€»èƒ½é‡</a> ï¼Œ <a href="">åŠ¨é‡</a>åŠå…¶<a href="">çŸ©</a>çš„ç›¸å¯¹å˜åŒ–ï¼ˆæœ€å¤§ä»¿çœŸæ—¶é—´ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-620"><span class="MJXp-msubsup" id="MJXp-Span-621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-623" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-628">2.5</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> T_ {max} = 2.5 </script>  ï¼‰ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†æ›´æ”¹é›†æˆæ–¹æ³•çš„æ­¥éª¤å’Œå‚æ•°ï¼Œå¹¶æµ‹é‡å‡½æ•°è°ƒç”¨çš„æ¬¡æ•° <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-629"><span class="MJXp-msubsup" id="MJXp-Span-630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-632" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> f_n </script> åˆ†åˆ«åœ°ï¼Œé‚£äº›å…·æœ‰è¾ƒå°‘è°ƒç”¨æ¬¡æ•°çš„æ–¹æ³•å°†å¯¼è‡´è¾ƒå°‘çš„æŸå¤±ï¼Œæˆ‘ä»¬å°†è®¤ä¸ºæ›´å¯æ¥å—ã€‚ <br><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/c0c/9de/886/c0c9de886418710c403863bc34021d9a.svg"><br></a> <br></td><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/311/f1b/614/311f1b6146bb4b13a4bd1db313ee1372.svg"><br></a> <br></td></tr><tr><td align="center">  aï¼‰ </td><td align="center">  bï¼‰ </td></tr><tr><td colspan="2" align="center">  <b>å›¾2.</b> <i>ç³»ç»Ÿä»¿çœŸç»“æŸæ—¶èƒ½é‡çš„ç›¸å¯¹å˜åŒ–aï¼‰ï¼ŒåŠ¨é‡bï¼‰</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">N</span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-636">512</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> N = 512 </script></i>   <i>æ ¹æ®å‡½æ•°è®¡ç®—çš„æ•°é‡ï¼Œé€šè¿‡å„ç§æ–¹æ³•é€‰æ‹©ä¸»ä½“</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-637"><span class="MJXp-msubsup" id="MJXp-Span-638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-640" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> f_n </script></i>   <i>åŒç²¾åº¦</i> </td></tr></tbody></table><br> ä»å›¾2çš„å›¾è¡¨å¯ä»¥çœ‹å‡ºï¼Œå‡½æ•°è®¡ç®—é‡çš„æœ€ä½³æ¯”ç‡ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-641"><span class="MJXp-msubsup" id="MJXp-Span-642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-644" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> f_n </script> ä»¥åŠäº”é˜¶Adamså’ŒDorman-Princeæ–¹æ³•ä¸­ç‰©ä½“ç³»ç»Ÿèƒ½é‡çš„ç›¸å¯¹å˜åŒ–ã€‚ è¿˜å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºæ‰€æœ‰æ–¹æ³•ï¼Œè®¡ç®—é‡éƒ½ä¼šå¢åŠ  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-645"><span class="MJXp-msubsup" id="MJXp-Span-646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-648" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> f_n </script> ç³»ç»ŸåŠ¨é‡çš„ç›¸å¯¹å˜åŒ–å¢åŠ ã€‚ å¯¹äºèƒ½é‡çš„ç›¸å¯¹å˜åŒ–ï¼Œè¿™ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œä½†ä»…é€‚ç”¨äºå¯èƒ½è¾¾åˆ°é˜ˆå€¼çš„å‡ ç§æ–¹æ³• <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">E</span><span class="MJXp-mrow" id="MJXp-Span-652"><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655" style="margin-right: 0.05em;">E</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-656" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-658"><span class="MJXp-mn" id="MJXp-Span-659" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-660" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-661">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-662">12</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> dE / E_0 <10 ^ {-12} </script>  ã€‚ è¿™ç§å½±å“ä¸èƒ½å†å½’å› äºæ–¹æ³•çš„é”™è¯¯ï¼Œè€Œåº”å½’å› äºè®¡ç®—çš„é”™è¯¯ï¼Œå¹¶ä¸”åªæœ‰éšç€æµ®ç‚¹æ•°è®¡ç®—ç²¾åº¦çš„æé«˜ï¼Œç²¾åº¦çš„è¿›ä¸€æ­¥æé«˜æ‰å¯èƒ½å®ç°ã€‚ <br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/c8e/e99/4ba/c8ee994ba56d3dcbb7c305aad402f0e3.svg"><br></a> <br></td><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/745/6a2/7f4/7456a27f4253ae5ac634dcc2ebf0776d.svg"><br></a> <br></td></tr><tr><td align="center">  aï¼‰ </td><td align="center">  bï¼‰ </td></tr><tr><td colspan="2" align="center">  <b>å›¾3.</b> <i>ç³»ç»Ÿä»¿çœŸç»“æŸæ—¶ï¼Œèƒ½é‡aï¼‰ï¼ŒåŠ¨é‡bï¼‰çš„ç›¸å¯¹å˜åŒ–</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">N</span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-666">512</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> N = 512 </script></i>   <i>æ ¹æ®å‡½æ•°è®¡ç®—çš„æ•°é‡ï¼Œé€šè¿‡å„ç§æ–¹æ³•é€‰æ‹©ä¸»ä½“</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-667"><span class="MJXp-msubsup" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-670" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> f_n </script></i>   <i>å…·æœ‰å››å€ç²¾åº¦ï¼ˆ__float128ï¼‰</i> </td></tr></tbody></table><br> å›¾3aå’Œ3bè¡¨æ˜ï¼Œä½¿ç”¨å…·æœ‰å››å€ç²¾åº¦çš„è®¡ç®—å¯ä»¥å°†ç›¸å¯¹èƒ½é‡æŸå¤±é™ä½è‡³ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-671"><span class="MJXp-msubsup" id="MJXp-Span-672"><span class="MJXp-mn" id="MJXp-Span-673" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-674" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-675">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-676">23</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> 10 ^ {-23} </script>  ï¼Œä½†æ‚¨éœ€è¦äº†è§£ï¼Œä¸åŒç²¾åº¦ç›¸æ¯”ï¼Œè®¡ç®—æ—¶é—´å¢åŠ äº†ä¸¤ä¸ªæ•°é‡çº§ã€‚ ä¸åŒç²¾åº¦è®¡ç®—ä¸€æ ·ï¼Œæœ€ä½³ç²¾åº¦æ¯”ç‡å’Œå‡½æ•°è®¡ç®—æ¬¡æ•° <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-677"><span class="MJXp-msubsup" id="MJXp-Span-678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-680" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> f_n </script> æ‹¥æœ‰äº”é˜¶äºšå½“æ–¯å’Œå¤šæ›¼ç‹å­çš„æ–¹æ³•ã€‚ <br><br>  Dorman-Princeå’ŒWerner <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–¹æ³•</a>å±äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åµŒå¥—æ–¹æ³•</a>ç±»ï¼Œå¯ä»¥åŒæ—¶è®¡ç®—ä¸¤ä¸ªç²¾åº¦é«˜ä½çš„è§£å†³æ–¹æ¡ˆï¼ˆå¯¹äºDorman-Princeæ–¹æ³•ï¼Œç²¾åº¦ä¸º5å’Œ4ï¼Œå¯¹äºWerneræ–¹æ³•ï¼Œç²¾åº¦ä¸º6å’Œ5ï¼‰ã€‚ å¦‚æœè¿™ä¸¤ç§è§£å†³æ–¹æ¡ˆéå¸¸ä¸åŒï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†å½“å‰çš„é›†æˆæ­¥éª¤åˆ†è§£ä¸ºæ›´å°çš„è§£å†³æ–¹æ¡ˆã€‚ è¿™ä½¿æˆ‘ä»¬èƒ½å¤ŸåŠ¨æ€æ›´æ”¹é›†æˆæ­¥éª¤ï¼Œå¹¶ä»…åœ¨éœ€è¦çš„åœ°æ–¹å‡å°‘é›†æˆæ­¥éª¤ã€‚ <br><br> è®©æˆ‘ä»¬åœ¨æ›´é•¿çš„ç³»ç»Ÿä»¿çœŸé—´éš”å†…æ›´è¯¦ç»†åœ°æ¯”è¾ƒäº”é˜¶Dorman-Princeï¼ŒWernerå’ŒAdamsæ–¹æ³•ï¼ˆ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-681"><span class="MJXp-msubsup" id="MJXp-Span-682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-684" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-689">300</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> T_ {max} = 300 </script>  ï¼‰ <br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/dcf/431/463/dcf431463350504334895ae590038f54.svg"><br></a> <br></td></tr><tr><td align="center">  <b>aï¼‰</b> <i>å»ºæ¨¡è¿‡ç¨‹ä¸­èƒ½é‡ï¼ŒåŠ¨é‡åŠå…¶åŠ¨é‡</i> <b>çš„</b> <i>ç›¸å¯¹å˜åŒ–</i> <br></td></tr><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/a2f/039/e55/a2f039e5575a01df083f913ab5cbb6d7.svg"><br></a> <br></td></tr><tr><td align="center">  <b>bï¼‰</b> <i>å‡½æ•°è®¡ç®—æ¬¡æ•°</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-690"><span class="MJXp-msubsup" id="MJXp-Span-691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-693" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> f_n </script></i>   <i>åœ¨æ¨¡æ‹Ÿé—´éš”</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-694"><span class="MJXp-mtext" id="MJXp-Span-695">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">T</span><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-703">0.3</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> \ Delta T = 0.3 </script></i> <br></td></tr><tr><td align="center">  <b>å›¾4.</b> <i>ç³»ç»Ÿç‰©ç†å‚æ•°çš„ç›¸å¯¹å˜åŒ–ä¸åŠŸèƒ½è®¡ç®—æ¬¡æ•°çš„å…³ç³»</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-704"><span class="MJXp-msubsup" id="MJXp-Span-705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-707" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> f_n </script></i>   <i>ä½¿ç”¨Dorman-Princeå¯å˜æ­¥é•¿æ³•ä¸æ—¶å»ºæ¨¡</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">h</span><span class="MJXp-mo" id="MJXp-Span-710" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-711"><span class="MJXp-mn" id="MJXp-Span-712" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-713" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-714">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-715">5</span></span></span><span class="MJXp-mtext" id="MJXp-Span-716" style="color: red;">\ç‚¹</span><span class="MJXp-msubsup" id="MJXp-Span-717"><span class="MJXp-mn" id="MJXp-Span-718" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-719" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-720">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-721">9</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> h = 10 ^ {-5} \ç‚¹10 ^ {-9} </script></i> <br></td></tr></tbody></table><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/db6/ed7/96b/db6ed796b48734885acac334d62bf74c.svg"><br></a> <br></td></tr><tr><td align="center">  <b>aï¼‰</b> <i>å»ºæ¨¡è¿‡ç¨‹ä¸­èƒ½é‡ï¼ŒåŠ¨é‡åŠå…¶åŠ¨é‡</i> <b>çš„</b> <i>ç›¸å¯¹å˜åŒ–</i> <br></td></tr><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/1a8/b05/599/1a8b05599c05680aa8501197f70f8d5c.svg"><br></a> <br></td></tr><tr><td align="center">  <b>bï¼‰</b> <i>å‡½æ•°è®¡ç®—æ¬¡æ•°</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-722"><span class="MJXp-msubsup" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-725" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> f_n </script></i>   <i>åœ¨æ¨¡æ‹Ÿé—´éš”</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mtext" id="MJXp-Span-727">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">T</span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-735">0.3</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> \ Delta T = 0.3 </script></i> <br></td></tr><tr><td align="center">  <b>å›¾5.</b> <i>ç³»ç»Ÿç‰©ç†å‚æ•°çš„ç›¸å¯¹å˜åŒ–å’ŒåŠŸèƒ½è®¡ç®—æ¬¡æ•°çš„ä¾èµ–æ€§</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-736"><span class="MJXp-msubsup" id="MJXp-Span-737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-739" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> f_n </script></i>   <i>å¯å˜æ­¥é•¿çš„Werneræ–¹æ³•è¿›è¡Œæ—¶é—´å»ºæ¨¡</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">h</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-743"><span class="MJXp-mn" id="MJXp-Span-744" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-745" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-746">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-747">5</span></span></span><span class="MJXp-mtext" id="MJXp-Span-748" style="color: red;">\ç‚¹</span><span class="MJXp-msubsup" id="MJXp-Span-749"><span class="MJXp-mn" id="MJXp-Span-750" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-751" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-752">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-753">9</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> h = 10 ^ {-5} \ç‚¹10 ^ {-9} </script></i> <br></td></tr></tbody></table><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/f6b/b1e/832/f6bb1e8323381a14ab438133218fdcc8.svg"><br></a> <br></td></tr><tr><td align="center">  <b>å›¾6.</b> <i>ç”¨äº”é˜¶Adams-Bashfortæ–¹æ³•å»ºæ¨¡æ—¶ï¼Œèƒ½é‡ï¼ŒåŠ¨é‡åŠå…¶çŸ©çš„ç›¸å¯¹å˜åŒ–</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">h</span><span class="MJXp-mo" id="MJXp-Span-756" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-757"><span class="MJXp-mn" id="MJXp-Span-758" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-759" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-760">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-761">6</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> h = 10 ^ {-6} </script></i> <br></td></tr></tbody></table><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/fc2/19e/8fa/fc219e8fa8a9bc8dfddc4ebb5a2aeae5.svg"><br></a> <br></td></tr><tr><td align="center">  <b>å›¾7.</b> <i>å‡½æ•°è®¡ç®—æ•°é‡çš„ä¾å­˜å…³ç³»</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-762"><span class="MJXp-msubsup" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-765" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> f_n </script></i>   <i>ä»ä»¿çœŸæ—¶é—´å¼€å§‹ç”¨äºäº”é˜¶Adamsï¼ŒDorman-Princeå’ŒWerneræ–¹æ³•</i> <br></td></tr></tbody></table><br> å¯ä»¥çœ‹å‡ºï¼Œåœ¨æˆ‘ä»¬ç³»ç»Ÿå‘å±•çš„åˆæœŸï¼ˆ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">T</span><span class="MJXp-mo" id="MJXp-Span-768" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-769">25</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> T <25 </script>  ï¼‰è¿™ä¸‰ç§æ–¹æ³•éƒ½æ˜¾ç¤ºå‡ºç›¸ä¼¼çš„ç‰¹æ€§ï¼Œä½†æ˜¯åœ¨åæœŸç³»ç»Ÿä¸­ä¼šå‘ç”ŸæŸäº›äº‹ä»¶ï¼Œå…¶ç»“æœæ˜¯ç³»ç»Ÿä¸»è¦å‚æ•°ï¼ˆæ€»èƒ½é‡ï¼ŒåŠ¨é‡åŠå…¶åŠ¨é‡ï¼‰çš„è¯¯å·®æ€¥å‰§ä¸Šå‡ã€‚ ä½†æ˜¯ç”±äºå‡å°‘äº†â€œå¤æ‚â€éƒ¨åˆ†ä¸­çš„ç§¯åˆ†æ­¥éª¤çš„èƒ½åŠ›ï¼ŒDorman-Princeå’ŒWerneræ–¹æ³•èƒ½å¤Ÿæ›´å¥½åœ°åº”å¯¹è¿™äº›å˜åŒ–ï¼Œç»“æœæ˜¯å‡½æ•°è®¡ç®—çš„æ•°é‡å¢åŠ äº† <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-770"><span class="MJXp-msubsup" id="MJXp-Span-771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-773" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> f_n </script> å¦‚å›¾4bå’Œ5bæ‰€ç¤ºï¼Œä½†è®¡ç®—æ€»æ•° <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-774"><span class="MJXp-msubsup" id="MJXp-Span-775"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-777" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> f_n </script> åµŒå¥—æ–¹æ³•æ¯”Adams-Bashfortæ–¹æ³•è¦å°ï¼Œå¦‚å›¾7æ‰€ç¤ºã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æˆ‘ä¸çŸ¥é“è¿™äº›æ—¶å€™ç³»ç»Ÿå‘ç”Ÿäº†ä»€ä¹ˆ</b> <div class="spoiler_text"><table><tbody><tr><td align="center"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZPyM6PRXjkY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></td></tr><tr><td align="center">  <b>è§†é¢‘1.</b> <i>å»ºæ¨¡512ä¸ªå®ä½“çš„ç³»ç»Ÿã€‚</i>  <i>Dorman-Princeæ–¹æ³•ã€‚</i>  <i>åŠ¨æ€æ­¥è¿›</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">h</span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-781"><span class="MJXp-mn" id="MJXp-Span-782" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-783" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-784">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-785">5</span></span></span><span class="MJXp-mtext" id="MJXp-Span-786" style="color: red;">\ç‚¹</span><span class="MJXp-msubsup" id="MJXp-Span-787"><span class="MJXp-mn" id="MJXp-Span-788" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-789" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-790">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-791">9</span></span></span></span></span><script type="math/tex" id="MathJax-Element-54"> h = 10 ^ {-5} \ç‚¹10 ^ {-9} </script></i> <br></td></tr></tbody></table><br></div></div><br> è§†é¢‘æ¼”ç¤ºäº†è¿™ä¸€ç‚¹ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">T</span><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-795">25</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> T = 25 </script> è¿åŠ¨ç›¸å¯¹å¹³é™ï¼Œæ­¤åâ€œæ˜Ÿç³»â€ä¸­å¿ƒå‘ç”Ÿç¢°æ’ï¼Œè¿™å¯¼è‡´è½¨è¿¹çš„æ€¥å‰§å˜åŒ–å’ŒæŸäº›ç²’å­çš„é€Ÿåº¦å¤§å¤§å¢åŠ ã€‚ æ­¤å¤–ï¼Œä¸ºäº†ä¿æŒè§£å†³æ–¹æ¡ˆçš„å‡†ç¡®æ€§ï¼Œæœ‰å¿…è¦å‡å°‘é›†æˆæ­¥éª¤ã€‚ åµŒå¥—æ–¹æ³•å¯ä»¥è‡ªåŠ¨æ‰§è¡Œæ­¤æ“ä½œï¼›å›¾è¡¨æ˜¾ç¤ºï¼Œåœ¨ç³»ç»Ÿæ¼”åŒ–çš„æŸäº›éƒ¨åˆ†ä¸­ï¼Œé›†æˆæ­¥éª¤å‡å°‘äº†è¿‘ä¸¤ä¸ªæ•°é‡çº§ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-796"><span class="MJXp-msubsup" id="MJXp-Span-797"><span class="MJXp-mn" id="MJXp-Span-798" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-799" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-800">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-801">5</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> 10 ^ {-5} </script> ä¹‹å‰ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">h</span><span class="MJXp-mo" id="MJXp-Span-804" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-805"><span class="MJXp-mn" id="MJXp-Span-806" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-807" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-808">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-809">7</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> h = 10 ^ {-7} </script>  ã€‚ å½“ä½¿ç”¨Adamsæ–¹æ³•ä»¥åŠåœ¨æ•´ä¸ªç³»ç»Ÿæ¼”åŒ–è¿‡ç¨‹ä¸­é‡‡å–è¿™æ ·çš„æ­¥éª¤æ—¶ï¼Œæˆ‘ä»¬å°±ä¸å¿…ç­‰å¾…è§£å†³æ–¹æ¡ˆäº†ã€‚ <br><br><h4> æ€»ç»“ </h4><br> å¯¹äºè¯¥è§£å†³æ–¹æ¡ˆï¼Œæœ€å¥½ä½¿ç”¨åµŒå¥—æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å…è®¸æ‚¨åŠ¨æ€æ§åˆ¶ç§¯åˆ†æ­¥éª¤ï¼Œå¹¶ä»…åœ¨è½¨è¿¹çš„â€œå¤æ‚â€éƒ¨åˆ†ä¸Šå‡å°‘ç§¯åˆ†æ­¥éª¤ã€‚ <br><br> ä¸è¦è¿½é€æœ€é«˜é¡ºåºçš„æ–¹æ³•ã€‚ å³ä½¿ä½¿ç”¨â€œåŒç²¾åº¦â€æ•°æ®ç±»å‹ï¼Œå®ƒä»¬ä¹Ÿæ— æ³•å‘æŒ¥å…¶æ½œåœ¨åŠŸèƒ½ï¼Œä½†ä»¥æ›´é«˜çš„ç²¾åº¦ä½¿ç”¨ç›¸åŒçš„æ•°æ®ç±»å‹ä¼šæå¤§åœ°å¢åŠ è§£å†³é—®é¢˜æ‰€éœ€çš„æ—¶é—´ã€‚ <br><br><h2>  CPUå®æ–½ </h2><br> ç°åœ¨å®šä¹‰äº†æ±‚è§£æ–¹ç¨‹çš„æ–¹æ³•çš„é€‰æ‹©ï¼Œè®©æˆ‘ä»¬å°è¯•è®¡ç®—æ¯ä¸ªç²’å­çš„ç›¸äº’ä½œç”¨åŠ›çš„è®¡ç®—ã€‚ å¯¹äºæ‰€æœ‰ç²’å­ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªåŒå¾ªç¯ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">å®ç°ä»£ç â€œç®€å•â€</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> body1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; body1 &lt; count; ++body1) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbvertex_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rx[ body1 ], ry[ body1 ], rz[ body1 ])</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> total_force; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> body2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; body2 != count; ++body2) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(body1 == body2) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbvertex_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rx[ body2 ], ry[ body2 ], rz[ body2 ])</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbvertex_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">force</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(m_data-&gt;force(v1, v2, mass[body1], mass[body2]))</span></span></span></span>; total_force += force; } frx[body1] = vx[body1]; fry[body1] = vy[body1]; frz[body1] = vz[body1]; fvx[body1] = total_force.x / mass[body1]; fvy[body1] = total_force.y / mass[body1]; fvz[body1] = total_force.z / mass[body1]; }</code> </pre> <br></div></div><br> æ¯ä¸ªç‰©ä½“çš„é‡åŠ›æ˜¯ç‹¬ç«‹è®¡ç®—çš„ï¼Œè¦ä½¿ç”¨æ‰€æœ‰å¤„ç†å™¨æ ¸å¿ƒï¼Œåœ¨ç¬¬ä¸€ä¸ªå¾ªç¯ä¹‹å‰ç¼–å†™OpenMPæŒ‡ä»¤å°±è¶³å¤Ÿäº†ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">ä¸€æ®µæ¥è‡ªâ€œ openmpâ€å®ç°çš„ä»£ç </b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> omp parallel for for(size_t body1 = 0; body1 &lt; count; ++body1)</span></span></code> </pre><br></div></div><br> å› ä¸º æ¯ä¸ªä¸»ä½“å½¼æ­¤äº¤äº’ï¼Œç„¶åå‡å°‘å¤„ç†å™¨ä¸RAMçš„äº¤äº’æ¬¡æ•°å¹¶æé«˜ç¼“å­˜ä½¿ç”¨ç‡ï¼Œæˆ‘ä»¬å¯ä»¥å°†éƒ¨åˆ†æ•°æ®åŠ è½½åˆ°ç¼“å­˜ä¸­å¹¶é‡å¤ä½¿ç”¨ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">å®ç°ä»£ç â€œ openmp +å—â€</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> omp parallel for for(size_t n1 = 0; n1 </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; count; n1 += BLOCK_SIZE) { nbcoord_t x1[BLOCK_SIZE]; nbcoord_t y1[BLOCK_SIZE]; nbcoord_t z1[BLOCK_SIZE]; nbcoord_t m1[BLOCK_SIZE]; nbvertex_t total_force[BLOCK_SIZE]; for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { size_t local_n1 = b1 + n1; x1[b1] = rx[local_n1]; y1[b1] = ry[local_n1]; z1[b1] = rz[local_n1]; m1[b1] = mass[local_n1]; } for(size_t n2 = 0; n2 &lt; count; n2 += BLOCK_SIZE) { nbcoord_t x2[BLOCK_SIZE]; nbcoord_t y2[BLOCK_SIZE]; nbcoord_t z2[BLOCK_SIZE]; nbcoord_t m2[BLOCK_SIZE]; for(size_t b2 = 0; b2 != BLOCK_SIZE; ++b2) { size_t local_n2 = b2 + n2; x2[b2] = rx[local_n2]; y2[b2] = ry[local_n2]; z2[b2] = rz[local_n2]; m2[b2] = mass[n2 + b2]; } for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { const nbvertex_t v1(x1[ b1 ], y1[ b1 ], z1[ b1 ]); for(size_t b2 = 0; b2 != BLOCK_SIZE; ++b2) { const nbvertex_t v2(x2[ b2 ], y2[ b2 ], z2[ b2 ]); const nbvertex_t force(m_data-&gt;force(v1, v2, m1[b1], m2[b2])); total_force[b1] += force; } } } for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { size_t local_n1 = b1 + n1; frx[local_n1] = vx[local_n1]; fry[local_n1] = vy[local_n1]; frz[local_n1] = vz[local_n1]; fvx[local_n1] = total_force[b1].x / m1[b1]; fvy[local_n1] = total_force[b1].y / m1[b1]; fvz[local_n1] = total_force[b1].z / m1[b1]; } }</span></span></span></span></code> </pre><br></div></div><br> è¿›ä¸€æ­¥çš„ä¼˜åŒ–åŒ…æ‹¬å–å‡ºè®¡ç®—ä¸»å¾ªç¯åŠ›çš„åŠŸèƒ½å†…å®¹ï¼Œå¹¶æ¶ˆé™¤ä½“é‡m1 [b1]çš„é™¤æ³•å’Œä¹˜æ³•ã€‚ é™¤äº†æˆ‘ä»¬ç¨å¾®å‡å°‘äº†è®¡ç®—é‡è¿™ä¸€äº‹å®å¤–ï¼Œç¼–è¯‘å™¨å°†èƒ½å¤Ÿåœ¨å¦‚æ­¤æ‰©å±•çš„å‘¨æœŸä¸Šåº”ç”¨SSEå’ŒAVXå¤„ç†å™¨çš„çŸ¢é‡æŒ‡ä»¤ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å®ç°ä»£ç â€œ openmp +å—+ä¼˜åŒ–â€</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> omp parallel for for(size_t n1 = 0; n1 &lt; count; n1 += BLOCK_SIZE) { nbcoord_t x1[BLOCK_SIZE]; nbcoord_t y1[BLOCK_SIZE]; nbcoord_t z1[BLOCK_SIZE]; nbcoord_t total_force_x[BLOCK_SIZE]; nbcoord_t total_force_y[BLOCK_SIZE]; nbcoord_t total_force_z[BLOCK_SIZE]; for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { size_t local_n1 = b1 + n1; x1[b1] = rx[local_n1]; y1[b1] = ry[local_n1]; z1[b1] = rz[local_n1]; total_force_x[b1] = 0; total_force_y[b1] = 0; total_force_z[b1] = 0; } for(size_t n2 = 0; n2 &lt; count; n2 += BLOCK_SIZE) { nbcoord_t x2[BLOCK_SIZE]; nbcoord_t y2[BLOCK_SIZE]; nbcoord_t z2[BLOCK_SIZE]; nbcoord_t m2[BLOCK_SIZE]; for(size_t b2 = 0; b2 != BLOCK_SIZE; ++b2) { size_t local_n2 = b2 + n2; x2[b2] = rx[local_n2]; y2[b2] = ry[local_n2]; z2[b2] = rz[local_n2]; m2[b2] = mass[n2 + b2]; } for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { for(size_t b2 = 0; b2 != BLOCK_SIZE; ++b2) { nbcoord_t dx = x1[b1] - x2[b2]; nbcoord_t dy = y1[b1] - y2[b2]; nbcoord_t dz = z1[b1] - z2[b2]; nbcoord_t r2(dx * dx + dy * dy + dz * dz); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } nbcoord_t r = sqrt(r2); nbcoord_t coeff = (m2[b2]) / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; total_force_x[b1] -= dx; total_force_y[b1] -= dy; total_force_z[b1] -= dz; } } } for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { size_t local_n1 = b1 + n1; frx[local_n1] = vx[local_n1]; fry[local_n1] = vy[local_n1]; frz[local_n1] = vz[local_n1]; fvx[local_n1] = total_force_x[b1]; fvy[local_n1] = total_force_y[b1]; fvz[local_n1] = total_force_z[b1]; } }</span></span></code> </pre><br></div></div><br>  <b>è¡¨2.</b> <i>å‡½æ•°è®¡ç®—æ—¶é—´çš„ä¾èµ–æ€§ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-810"><span class="MJXp-msubsup" id="MJXp-Span-811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-813" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> f_n </script></i>   <i>ç›¸äº’ä½œç”¨ä½“çš„æ•°é‡</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-814"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59"> N </script></i>   <i>ç”¨äºå„ç§CPUå®ç°</i> <br><table><tbody><tr><th><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> N </script></th><th>  2048 </th><th>  4096 </th><th>  8192 </th><th>  16384 </th><th>  32768 </th></tr><tr><td> ç®€å•çš„ </td><td>  0.0425 </td><td>  0.1651 </td><td>  0.6594 </td><td>  2.65 </td><td>  10.52 </td></tr><tr><td> çš„openmp </td><td>  0.0078 </td><td>  0.0260 </td><td>  0.1079 </td><td>  0.417 </td><td>  1.655 </td></tr><tr><td>  openmp +å—+ä¼˜åŒ– </td><td>  0.0037 </td><td>  0.0128 </td><td>  0.0495 </td><td>  0.194 </td><td>  0.774 </td></tr></tbody></table><br><div class="spoiler">  <b class="spoiler_title">ç³»ç»Ÿå‚æ•°ï¼š</b> <div class="spoiler_text"><ul><li> ç³»ç»Ÿï¼š <i>Debian 9ï¼ŒIntel Core i7-5820Kï¼ˆ6æ ¸å¿ƒï¼‰</i> </li><li> ç¼–è¯‘å™¨ï¼š <i>gcc 6.3.0</i> </li></ul><br></div></div><br> å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œå…·æœ‰OpenMPæ”¯æŒçš„ç‰ˆæœ¬åœ¨å†…æ ¸æ•°é‡æ–¹é¢çš„é€Ÿåº¦æé«˜äº†å…­å€ï¼Œè€Œä¼˜åŒ–ç‰ˆæœ¬çš„é€Ÿåº¦ç”šè‡³å¿«äº†ä¸¤å€å¤šã€‚ å› æ­¤ï¼Œé€šè¿‡ä¼˜åŒ–ï¼Œæ‚¨ä¸åº”è¯¥ä»…ä¾èµ–äºå¹¶å‘ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œåœ¨å•æµè®¡ç®—ä¸­ï¼Œå¤„ç†å™¨çš„å·¥ä½œé¢‘ç‡ä¸º3.6 GHzï¼Œåœ¨å¹¶è¡Œç‰ˆæœ¬ï¼ˆopenmpï¼‰ä¸­ï¼Œè¯¥é¢‘ç‡é™è‡³3.4 GHzï¼Œè€Œåœ¨å¹¶è¡Œä¼˜åŒ–ä¸­ï¼ˆopenmp + block +æœ€ä¼˜åŒ–ï¼‰ï¼Œè¯¥é¢‘ç‡é™è‡³3.3 GHzï¼Œä½†è¿™è¿™å¹¶æ²¡æœ‰é˜»æ­¢å¥¹æ›´å¿«åœ°å·¥ä½œ13.6å€ã€‚ è¿˜å¯ä»¥çœ‹åˆ°ï¼Œéšç€é—®é¢˜å¤§å°çš„å¢åŠ ï¼Œè®¡ç®—æ—¶é—´çš„å¢åŠ æ˜¯äºŒæ¬¡æ–¹çš„ï¼Œå¹¶ä¸”è¿›ä¸€æ­¥å¢åŠ  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61"> N </script> ä½¿ä»»åŠ¡åœ¨åˆç†çš„æ—¶é—´å†…æ— æ³•è§£å†³ã€‚ <br><br><h2>  GPUå®æ–½ </h2><br> ä½†æ˜¯ï¼Œäººä»¬å¸Œæœ›æ›´å¿«åœ°è¿›è¡Œè®¡ç®—ã€‚ æœ‰å‡ ç§æ–¹å‘å¯ç”¨äºåŠ é€Ÿï¼šGPUè®¡ç®—ï¼Œå‡½æ•°é€¼è¿‘ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-820"><span class="MJXp-msubsup" id="MJXp-Span-821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-823" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> f_n </script>  ã€‚ é¦–å…ˆï¼Œå¯¹äºGPUè®¡ç®—ï¼Œæˆ‘é€‰æ‹©äº†OpenCLæŠ€æœ¯ã€‚ ä¸ºäº†æ›´æ–¹ä¾¿çš„å·¥ä½œï¼Œä½¿ç”¨äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CLHPP</a>åº“ã€‚  OpenCLçš„ä¸»è¦ä¼˜ç‚¹æ˜¯ä»£ç å¯ä»¥åœ¨å¤„ç†å™¨å’ŒGPUä¸Šè¿è¡Œï¼Œä»è€Œç®€åŒ–äº†ç¼–å†™å’Œè°ƒè¯•ï¼Œå¹¶æ‰©å±•äº†è¦è¿è¡Œçš„ç¡¬ä»¶åˆ—è¡¨ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Oclgrind</a>å·¥å…·æœ‰åŠ©äºè°ƒè¯•ï¼Œè¯¥è°ƒè¯•åœ¨è¿è¡Œæ—¶æ˜¾ç¤ºä¸æ­£ç¡®çš„OpenCL APIè°ƒç”¨å’Œå†…å­˜è®¿é—®é—®é¢˜ã€‚ <br><br><h4>  Openclçš„ </h4><br> è¦å¼€å§‹ä½¿ç”¨OpenCLï¼Œæ‚¨éœ€è¦è·å–å¯ç”¨å¹³å°çš„åˆ—è¡¨ã€‚ æœ€å¸¸è§çš„å¹³å°æ˜¯AMDï¼ŒIntelå’ŒNVidiaã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ä»£å·</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;cl::Platform&gt; platforms; cl::Platform::get(&amp;platforms);</code> </pre><br></div></div><br> æ¥ä¸‹æ¥ï¼Œåœ¨é€‰æ‹©å¹³å°ä¹‹åï¼Œæ‚¨éœ€è¦é€‰æ‹©è¯¥å¹³å°ä»£è¡¨çš„è®¡ç®—è®¾å¤‡ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">ä»£å·</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> cl::<span class="hljs-function"><span class="hljs-function">Platform&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">platform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(platforms[platform_n])</span></span></span></span>; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;cl::Device&gt; all_devices; platform.getDevices(CL_DEVICE_TYPE_ALL, &amp;all_devices);</code> </pre><br></div></div><br> åœ¨å‡†å¤‡é˜¶æ®µçš„æœ€åï¼Œæœ‰å¿…è¦åˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡å’Œé˜Ÿåˆ—ï¼Œä»¥åœ¨å…¶ä¸­åˆ†é…å†…å­˜å¹¶æ‰§è¡Œè®¡ç®—ã€‚ ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªå°†é€‰å®šå¹³å°çš„æ‰€æœ‰è®¡ç®—è®¾å¤‡ç»„åˆåœ¨ä¸€èµ·çš„ä¸Šä¸‹æ–‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><div class="spoiler">  <b class="spoiler_title">ä¸Šä¸‹æ–‡å’Œé˜Ÿåˆ—åˆ›å»ºä»£ç </b> <div class="spoiler_text"><pre> <code class="cpp hljs">cl::<span class="hljs-function"><span class="hljs-function">Context </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">context</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(all_devices)</span></span></span></span>; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;cl::CommandQueue&gt; queues; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(cl::Device device: all_devices) queues.push_back(cl::CommandQueue(context, device));</code> </pre><br></div></div><br> è¦å°†æºä»£ç ä¸‹è½½åˆ°è®¡ç®—è®¾å¤‡ï¼Œå¿…é¡»å°†å…¶ç¼–è¯‘ï¼Œcl :: Programç±»ç”¨äºæ­¤ç›®çš„ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å†…æ ¸ç¼–è¯‘ä»£ç </b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> &gt; source_data; cl::Program::Sources sources; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i != files.size(); ++i) { source_data.push_back(load_program(files[i]));<span class="hljs-comment"><span class="hljs-comment">//   sources.push_back(std::make_pair(source_data.back().data(), source_data.back().size())); } cl::Program prog(context, sources); devices.push_back(all_devices); prog.build(devices, options);</span></span></code> </pre><br></div></div><br> ä¸ºäº†æè¿°åœ¨è®¡ç®—è®¾å¤‡ä¸Šæ‰§è¡Œçš„åŠŸèƒ½ï¼ˆå†…æ ¸ï¼‰çš„å‚æ•°ï¼Œæœ‰ä¸€ä¸ªclæ¨¡æ¿ï¼šmake_kernelã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">äº¤äº’å¼ºåº¦è®¡ç®—å†…æ ¸ç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> cl::make_kernel&lt; cl_int, cl_int, <span class="hljs-comment"><span class="hljs-comment">//Block offset cl::Buffer, //mass cl::Buffer, //y cl::Buffer, //f cl_int, cl_int, //yoff,foff cl_int, cl_int //points_count,stride &gt; ComputeBlock;</span></span></code> </pre><br></div></div><br> æ­¤å¤–ï¼Œä¸€åˆ‡éƒ½å¾ˆç®€å•ï¼šæˆ‘ä»¬å£°æ˜ä¸€ä¸ªå…·æœ‰å†…æ ¸ç±»å‹çš„å˜é‡ï¼Œå°†ç¼–è¯‘åçš„ç¨‹åºå’Œè®¡ç®—å†…æ ¸çš„åç§°ä¼ é€’ç»™å®ƒï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥åƒæ­£å¸¸å‡½æ•°ä¸€æ ·å¯åŠ¨å†…æ ¸ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å†…æ ¸å¯åŠ¨ä»£ç </b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">ComputeBlock </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fcompute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(prog, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"ComputeBlockLocal"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; cl::<span class="hljs-function"><span class="hljs-function">NDRange </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">global_range</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(device_data_size)</span></span></span></span>; cl::<span class="hljs-function"><span class="hljs-function">NDRange </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">local_range</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(block_size)</span></span></span></span>; cl::<span class="hljs-function"><span class="hljs-function">EnqueueArgs </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eargs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ctx.m_queue, global_range, local_range)</span></span></span></span>; fcompute(eargs, ...  ); <span class="hljs-comment"><span class="hljs-comment">//,   .</span></span></code> </pre><br></div></div><br>  OpenCLæœ¬èº«çš„è®¡ç®—æ ¸å¿ƒä¸CPUçš„'openmp + block +æœ€ä¼˜åŒ–'é€‰é¡¹éå¸¸ç›¸ä¼¼ï¼Œä»…ä¸CPUç‰ˆæœ¬ä¸åŒï¼Œç¬¬ä¸€ä¸ªå‘¨æœŸæ˜¯ä½¿ç”¨OpenCLæ¥æ§åˆ¶çš„ï¼ˆå‘¨æœŸèŒƒå›´ç”±å†…æ ¸å¯åŠ¨ä»£ç ä¸­çš„global_rangeå˜é‡ç¡®å®šï¼Œè€Œå½“å‰çš„è¿­ä»£ç¼–å·å¯ä»å†…æ ¸è·å–ï¼‰ä½¿ç”¨å‡½æ•°get_global_idï¼ˆ0ï¼‰ï¼‰ã€‚ é¦–å…ˆï¼Œéƒ¨åˆ†èº«ä½“æ•°æ®ä»æœ¬åœ°å†…å­˜åŠ è½½ï¼Œç„¶åè¿›è¡Œå¤„ç†ã€‚ æœ¬åœ°å†…å­˜æ˜¯è¯¥ç»„ä¸­æ‰€æœ‰çº¿ç¨‹æ‰€å…±æœ‰çš„ï¼Œå› æ­¤è¯¥ä¸‹è½½å¯¹äºè¯¥ç»„ä»…å‘ç”Ÿä¸€æ¬¡ï¼Œå¹¶ç”±è¯¥ç»„ä¸­çš„æ¯ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œå¹¶ä¸” æœ¬åœ°å†…å­˜æ¯”å…¨å±€å†…å­˜è¦å¿«å¾—å¤šï¼Œè®¡ç®—è¦å¿«å¾—å¤šã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å†…æ ¸ä»£ç </b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">kernel </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ComputeBlockLocal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n2, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* mass, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* y, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> yoff, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> foff, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> stride)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = get_global_id(<span class="hljs-number"><span class="hljs-number">0</span></span>) + offset_n1; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rx = y + yoff; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* ry = rx + stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rz = rx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vx = rx + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vy = rx + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vz = rx + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frx = f + foff; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fry = frx + stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frz = frx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvx = frx + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvy = frx + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvz = frx + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = rx[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = ry[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = rz[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; __local <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x2[NBODY_DATA_BLOCK_SIZE]; __local <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y2[NBODY_DATA_BLOCK_SIZE]; __local <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z2[NBODY_DATA_BLOCK_SIZE]; __local <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> m2[NBODY_DATA_BLOCK_SIZE]; <span class="hljs-comment"><span class="hljs-comment">// NB! get_local_size(0) == NBODY_DATA_BLOCK_SIZE for(int b2 = 0; b2 &lt; points_count; b2 += NBODY_DATA_BLOCK_SIZE) { int n2 = b2 + offset_n2 + get_local_id(0); // Copy data block to local memory x2[ get_local_id(0) ] = rx[n2]; y2[ get_local_id(0) ] = ry[n2]; z2[ get_local_id(0) ] = rz[n2]; m2[ get_local_id(0) ] = mass[n2]; // Synchronize local work-items copy operations barrier(CLK_LOCAL_MEM_FENCE); nbcoord_t local_res_x = 0.0; nbcoord_t local_res_y = 0.0; nbcoord_t local_res_z = 0.0; for(int local_n2 = 0; local_n2 != NBODY_DATA_BLOCK_SIZE; ++local_n2) { nbcoord_t dx = x1 - x2[local_n2]; nbcoord_t dy = y1 - y2[local_n2]; nbcoord_t dz = z1 - z2[local_n2]; nbcoord_t r2 = (dx * dx + dy * dy + dz * dz); if(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } nbcoord_t r = sqrt(r2); nbcoord_t coeff = (m2[local_n2]) / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; local_res_x -= dx; local_res_y -= dy; local_res_z -= dz; } // Synchronize local work-items computations barrier(CLK_LOCAL_MEM_FENCE); res_x += local_res_x; res_y += local_res_y; res_z += local_res_z; } frx[n1] = vx[n1]; fry[n1] = vy[n1]; frz[n1] = vz[n1]; fvx[n1] = res_x; fvy[n1] = res_y; fvz[n1] = res_z; }</span></span></code> </pre><br></div></div><br><h4> åº“è¾¾ </h4><br>  NVidia CUDAå¹³å°çš„å®ç°æ¯”OpenCLæ›´ä¸ºç®€å•ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºè®¾å¤‡ä¸Šä¸‹æ–‡å¹¶è‡ªè¡Œç®¡ç†æ‰§è¡Œé˜Ÿåˆ—ï¼ˆè‡³å°‘åœ¨æˆ‘ä»¬è¦è¿›è¡Œå¤šGPUå®ç°ä¹‹å‰ï¼‰ã€‚ ä¸OpenCLä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦åœ¨GPUä¸Šåˆ†é…å†…å­˜ï¼Œå°†æ•°æ®å¤åˆ¶åˆ°å…¶ä¸­ï¼Œç„¶åæ‰èƒ½å¯åŠ¨è®¡ç®—æ ¸å¿ƒã€‚ <br><br> æ‚¨å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨æ­¤å¤„</a>é˜…è¯»æœ‰å…³ä½¿ç”¨CUDAçš„æ›´å¤šä¿¡æ¯ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">CUDAå†…æ ¸å¯åŠ¨ä»£ç </b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">dim3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">grid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(count / block_size)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">dim3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">block</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(block_size)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> shared_size(<span class="hljs-number"><span class="hljs-number">4</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>) * block_size); kfcompute &lt;&lt;&lt; grid, block, shared_size &gt;&gt;&gt; (... ...);</code> </pre><br></div></div><br> ä¸OpenCLä¸åŒï¼ŒCUDAå¹¶æœªæŒ‡å®šå®Œæ•´çš„è¿­ä»£èŒƒå›´ï¼ˆåœ¨OpenCLå®ç°ä¸­ä¸ºglobal_rangeï¼‰ï¼Œè€Œæ˜¯åœ¨ç½‘æ ¼ä¸­è®¾ç½®äº†ç½‘æ ¼å¤§å°å’Œå—å¤§å°ï¼Œå› æ­¤ï¼Œå½“å‰ä¸»ä½“æ•°çš„è®¡ç®—ä¼šç•¥æœ‰å˜åŒ–ï¼Œå¦åˆ™å†…æ ¸ä¸OpenCLéå¸¸ç›¸ä¼¼ï¼Œé™¤äº†å…¶ä»–åç§°ä¹‹å¤–å…±äº«å†…å­˜çš„åŒæ­¥å’Œè¯´æ˜ç¬¦åŠŸèƒ½ã€‚  CUDAçš„å¦ä¸€ä¸ªæœ‰ç”¨çš„åŒºåˆ«åŠŸèƒ½æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å†…æ ¸å¯åŠ¨æ—¶æŒ‡å®šæ‰€éœ€çš„å…±äº«å†…å­˜å¤§å°ã€‚ ä¸OpenCLå®æ–½ä¸€æ ·ï¼Œåœ¨æ¯ä¸ªè¿­ä»£å—çš„å¼€å¤´ï¼Œæˆ‘ä»¬å°†éƒ¨åˆ†æ•°æ®å¤åˆ¶åˆ°å…±äº«å†…å­˜ä¸­ï¼Œç„¶åä»è¯¥å—çš„æ‰€æœ‰çº¿ç¨‹ä¸­ä½¿ç”¨è¯¥å†…å­˜ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">CUDAå†…æ ¸ä»£ç </b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">global__ </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kfcompute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> yoff, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> foff, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* mass, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> stride)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = blockDim.x * blockIdx.x + threadIdx.x; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rx = y + yoff; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* ry = rx + stride; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rz = rx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = rx[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = ry[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = rz[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> __shared__ <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> shared_xyzm_buf[]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* x2 = shared_xyzm_buf; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* y2 = x2 + blockDim.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* z2 = y2 + blockDim.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* m2 = z2 + blockDim.x; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; b2 &lt; points_count; b2 += blockDim.x) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n2 = b2 + offset_n2 + threadIdx.x; <span class="hljs-comment"><span class="hljs-comment">// Copy data block to local memory x2[ threadIdx.x ] = rx[n2]; y2[ threadIdx.x ] = ry[n2]; z2[ threadIdx.x ] = rz[n2]; m2[ threadIdx.x ] = mass[n2]; // Synchronize local work-items copy operations __syncthreads(); nbcoord_t local_res_x = 0.0; nbcoord_t local_res_y = 0.0; nbcoord_t local_res_z = 0.0; for(int n2 = 0; n2 != blockDim.x; ++n2) { nbcoord_t dx = x1 - x2[n2]; nbcoord_t dy = y1 - y2[n2]; nbcoord_t dz = z1 - z2[n2]; nbcoord_t r2 = (dx * dx + dy * dy + dz * dz); if(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } nbcoord_t r = sqrt(r2); nbcoord_t coeff = (m2[n2]) / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; local_res_x -= dx; local_res_y -= dy; local_res_z -= dz; } // Synchronize local work-items computations __syncthreads(); res_x += local_res_x; res_y += local_res_y; res_z += local_res_z; } n1 += foff; f[n1 + 3 * stride] = res_x; f[n1 + 4 * stride] = res_y; f[n1 + 5 * stride] = res_z; }</span></span></code> </pre><br></div></div><br>  <b>è¡¨3.</b> <i>è®¡ç®—æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰å‡½æ•°çš„ä¾èµ–æ€§</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-824"><span class="MJXp-msubsup" id="MJXp-Span-825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-827" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> f_n </script></i>   <i>ç›¸äº’ä½œç”¨ä½“çš„æ•°é‡</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> N </script></i>   <i>é€‚ç”¨äºå„ç§GPUå®ç°å’Œæ›´å¥½çš„CPUå®ç°</i> <br><table><tbody><tr><th><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65"> N </script></th><th>  4096 </th><th>  8192 </th><th>  16384 </th><th>  32768 </th><th>  65536 </th><th>  131072 </th></tr><tr><td>  openmp +å—+ä¼˜åŒ– </td><td>  0.0128 </td><td>  0.0495 </td><td>  0.194 </td><td>  0.774 </td><td>  --- </td><td>  --- </td></tr><tr><td>  OpenCL +ä¸€åŠNVidia K80 </td><td>  0.004 </td><td>  0.008 </td><td>  0.026 </td><td>  0.134 </td><td>  0.322 </td><td>  1.18 </td></tr><tr><td>  CUDA +ä¸€åŠNVidia K80 </td><td>  0.004 </td><td>  0.008 </td><td>  0.0245 </td><td>  0.115 </td><td>  0.291 </td><td>  1.13 </td></tr></tbody></table><br><div class="spoiler">  <b class="spoiler_title">å“ªé‡Œå¯ä»¥ä¹°åˆ°NVidia K80</b> <div class="spoiler_text">  Googleçš„å…è´¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Colab</a>æœåŠ¡å¯åŠ¨äº†OpenCLå’ŒCUDAå®æ–½ï¼Œè¯¥æœåŠ¡æä¾›å¯¹NVidia K80è®¡ç®—æœºçš„è®¿é—®ã€‚ æ‚¨å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é›†çº¿å™¨</a>ä¸Šé˜…è¯»æœ‰å…³ä½¿ç”¨æ­¤æœåŠ¡çš„æ›´å¤šä¿¡æ¯ã€‚ <br></div></div><br> é€šå¸¸ï¼Œç»“æœä»¤äººå¤±æœ›ï¼Œä»…æ¯”CPUå®ç°å¿«5-6å€ã€‚ å³ä½¿æˆ‘ä»¬å¯¹æ•´ä¸ªK80è¿›è¡Œè®¡ç®—ï¼Œæˆ‘ä»¬ä¹Ÿä¼šè·å¾—é«˜è¾¾12å€çš„åŠ é€Ÿåº¦ï¼Œä½†æ˜¯ ç”±äºä»»åŠ¡çš„å¤æ‚æ€§æ˜¯äºŒæ¬¡çš„ï¼Œå› æ­¤åœ¨åˆç†çš„æ—¶é—´å†…ï¼Œæˆ‘ä»¬å°†ä¸èƒ½å¤„ç†32768ä¸ªäº¤äº’ä½“ï¼Œè€Œå¯ä»¥å¤„ç†131072ï¼Œä»…å¤šäº†4å€ã€‚ <br><br><h2> å‡½æ•°è¿‘ä¼¼ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-832"><span class="MJXp-msubsup" id="MJXp-Span-833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-835" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> f_n </script></h2><br> å¦‚æœä»”ç»†çœ‹ä¸€ä¸‹ç”±ä¸¤ä¸ªç‰©ä½“çš„å¸å¼•åŠ›è®¾ç½®çš„å‡½æ•°ï¼Œå¾ˆæ˜æ˜¾å®ƒéšè·ç¦»å‘ˆäºŒæ¬¡æ–¹å‡å°ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å‡†ç¡®åœ°è®¡ç®—å‡ºè¿‘èº«ä¹‹é—´ä»¥åŠè¿‘èº«ä¹‹é—´çš„ç›¸äº’ä½œç”¨åŠ›ã€‚ ä¸€ç§è‘—åçš„æ–¹æ³• <br> æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">D.Barnes</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">P.Hat</a>æå‡ºçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ ‘ç </a>ç®—æ³•ã€‚ åœ¨æ¨¡æ‹Ÿç©ºé—´ä¸­æ„é€ äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…«å‰æ ‘</a> ï¼Œå…¶å¶å­ä¸­åŒ…å«æ¨¡æ‹Ÿç‰©ä½“çš„åæ ‡å’Œè´¨é‡ã€‚ çˆ¶èŠ‚ç‚¹åŒ…å«è´¨å¿ƒï¼Œå­èŠ‚ç‚¹çš„æ€»è´¨é‡ä»¥åŠå›´ç»•å­èŠ‚ç‚¹çš„å®ä½“æè¿°çš„çƒä½“çš„åŠå¾„ã€‚ æ ‘çš„æ ¹åŒ…å«æ‰€æœ‰ç‰©ä½“çš„è´¨å¿ƒï¼Œå®ƒä»¬çš„æ€»è´¨é‡ä»¥åŠå›´ç»•å®ƒä»¬æè¿°çš„çƒä½“çš„åŠå¾„ã€‚ åœ¨è®¡ç®—ç›¸äº’ä½œç”¨åŠ›æ—¶ï¼Œå¦‚æœåˆ°èŠ‚ç‚¹çš„è·ç¦»ä¸å…¶åŠå¾„ä¹‹æ¯”å¤§äºæŸä¸ªå¸¸æ•°ï¼Œåˆ™é¦–å…ˆè¦è€ƒè™‘åˆ°æ ‘æ ¹çš„è·ç¦» <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-836"><span class="MJXp-mtext" id="MJXp-Span-837">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">d</span><span class="MJXp-msubsup" id="MJXp-Span-843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-845" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67"> \ lambda_ {crit} </script>  ï¼Œåˆ™è¯¥æ ¹è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªåæ ‡ç­‰äºå…¶æ‰€åŒ…å«çš„ç‰©ä½“çš„è´¨å¿ƒåæ ‡çš„ç‰©ä½“ï¼Œå¹¶ä¸”å¦‚æœè¯¥æ¯”ç‡å°äºæˆ–ç­‰äºï¼Œåˆ™å…¶è´¨é‡ç­‰äºå­èŠ‚ç‚¹çš„è´¨é‡ä¹‹å’Œã€‚ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-850"><span class="MJXp-mtext" id="MJXp-Span-851">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">d</span><span class="MJXp-msubsup" id="MJXp-Span-857"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-859" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68"> \ lambda_ {crit} </script>  ï¼Œç„¶åä¸ºæ¯ä¸ªå­èŠ‚ç‚¹é€’å½’åœ°é‡å¤è¯¥è¿‡ç¨‹ã€‚ å¦‚æœåˆ°è¾¾æ ‘çš„å¶å­ï¼Œåˆ™ä»¥é€šå¸¸çš„æ–¹å¼è€ƒè™‘ç›¸äº’ä½œç”¨åŠ›ã€‚ å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªç‰©ä½“è¿œç¦»å…¶ä»–ç‰©ä½“çš„ç´§å‡‘ç»„ï¼Œåˆ™å°†è¯¥ç»„ä½œä¸ºä¸€ä¸ªç‰©ä½“å‘ˆç°ç»™å®ƒï¼Œå¹¶ä¸”ä¸è®¡ç®—æ¯ä¸ªç‰©ä½“çš„ç›¸äº’ä½œç”¨åŠ›ï¼Œè€Œåªè®¡ç®—ä¸€ä¸ªç‰©ä½“ã€‚ å› æ­¤ï¼Œç®—æ³•çš„å¤æ‚åº¦éšç€ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">O</span><span class="MJXp-mrow" id="MJXp-Span-866"><span class="MJXp-mo" id="MJXp-Span-867" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-msubsup" id="MJXp-Span-868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-870" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-871"><span class="MJXp-mo" id="MJXp-Span-872" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> Oï¼ˆN ^ 2ï¼‰</script> ä¹‹å‰ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">O</span><span class="MJXp-mrow" id="MJXp-Span-875"><span class="MJXp-mo" id="MJXp-Span-876" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">N</span><span class="MJXp-mtext" id="MJXp-Span-878" style="color: red;">\æ—¥</span><span class="MJXp-mrow" id="MJXp-Span-879"><span class="MJXp-mo" id="MJXp-Span-880" style="margin-left: 0.278em; margin-right: 0.278em;">å¿—</span></span><span class="MJXp-mrow" id="MJXp-Span-881"><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">N</span><span class="MJXp-mrow" id="MJXp-Span-884"><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span><span class="MJXp-mrow" id="MJXp-Span-886"><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> Oï¼ˆN \æ—¥å¿—ï¼ˆNï¼‰ï¼‰</script> ä»¥ç‰ºç‰²ä¸€äº›å‡†ç¡®æ€§ä¸ºä»£ä»·ã€‚ <br><br> åœ¨æˆ‘çš„æ–¹æ³•ä¸­ï¼Œæˆ‘å†³å®šä¸ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">octree</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ ‘</a> ï¼Œè€Œæ˜¯ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">kdæ ‘ï¼Œ</a>å› ä¸º ä¸å…«å‰æ ‘ç›¸æ¯”ï¼Œå®ƒæ›´æ˜“äºä½¿ç”¨å¹¶ä¸”å…·æœ‰è¾ƒä½çš„å­˜å‚¨å¼€é”€ã€‚ <br><br> è®©æˆ‘ä»¬å›åˆ°åœ¨CPUä¸Šçš„å®ç°ã€‚  kd-treeèŠ‚ç‚¹å¯ä»¥ä»¥ç±»çš„å½¢å¼è¡¨ç¤ºï¼Œè¯¥ç±»åŒ…å«æŒ‡å‘å·¦å³åä»£çš„æŒ‡é’ˆä»¥åŠæœ‰å…³åæ ‡å’Œè´¨é‡çš„ä¿¡æ¯ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">Kdæ ‘èŠ‚ç‚¹</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">node</span></span></span><span class="hljs-class"> {</span></span> node* m_left; <span class="hljs-comment"><span class="hljs-comment">//!&lt;   node* m_right; //!&lt;   nbvertex_t m_mass_center; //!&lt;     nbcoord_t m_mass; //!&lt;   nbcoord_t m_radius_sqr; //!&lt;    ,   lambda_crit nbvertex_t m_bmin; //!&lt;     nbvertex_t m_bmax; //!&lt;     size_t m_body_n; //!&lt;  ,    };</span></span></code> </pre><br></div></div><br> ä½¿ç”¨è¿™ç§å­˜å‚¨æ ‘çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§å¯èƒ½çš„éå†æ ‘çš„é€‰é¡¹ï¼šä½¿ç”¨æ˜¾å¼é€’å½’æˆ–è‡ªå·±ä½¿ç”¨å †æ ˆã€‚ æˆ‘é€‰æ‹©äº†ç¬¬äºŒä¸ªé€‰é¡¹ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">é€šè¿‡éå†æ ‘è®¡ç®—ç›¸äº’ä½œç”¨åŠ›</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> force_compute(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span>&amp; v1, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> mass1) { <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> total_force; node* stack_data[MAX_STACK_SIZE] = {}; node** <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = stack_data; node** stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; *<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++ = m_root; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { node* curr = *--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbcoord_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">distance_sqr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">((v1 - curr-&gt;m_mass_center).norm())</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(distance_sqr &gt; curr-&gt;m_radius_sqr) {<span class="hljs-comment"><span class="hljs-comment">//  ,       total_force += force(v1, curr-&gt;m_mass_center, mass1, curr-&gt;m_mass); } else {//   ,      if(curr-&gt;m_right != NULL) { *stack++ = curr-&gt;m_right; } if(curr-&gt;m_left != NULL) { *stack++ = curr-&gt;m_left; } } } return total_force; }</span></span></code> </pre><br></div></div><br> ä¸â€œç²¾ç¡®â€ CPUå®ç°çš„æƒ…å†µä¸€æ ·ï¼Œæ¯ä¸ªä¸»ä½“éƒ½éœ€è¦è°ƒç”¨åŠ›è®¡ç®—åŠŸèƒ½ã€‚ ä½¿ç”¨OpenMPæŒ‡ä»¤å¯ä»¥è½»æ¾åœ°å¹¶è¡ŒåŒ–æ‰€æœ‰ä¸»ä½“ä¹‹é—´çš„å¾ªç¯ã€‚ <br><br> ä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç›¸é‚»å¾ªç¯è¿­ä»£å°†å¼•ç”¨æ ‘çš„å®Œå…¨ä¸åŒçš„éƒ¨åˆ†ï¼Œè¿™ä¸å…è®¸æœ‰æ•ˆä½¿ç”¨å¤„ç†å™¨ç¼“å­˜ã€‚ ä¸ºäº†å…‹æœè¿™ä¸ªé—®é¢˜ï¼Œæ‰€æœ‰ç‰©ä½“éƒ½ä¸å¿…ä»¥åŸå§‹é¡ºåºéå†ï¼Œè€Œæ˜¯ä»¥ç‰©ä½“ä½äºkd-treeçš„å¶å­ä¸­çš„é¡ºåºéå†ï¼Œç„¶åå¯¹ç©ºé—´ç´§å¯†çš„ç‰©ä½“è¿›è¡Œç›¸é‚»çš„è¿­ä»£ï¼Œå¹¶å°†æ²¿å‡ ä¹ç›¸åŒçš„è·¯å¾„éå†æ ‘ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ ‘å¶éå†</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Visitor</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">traverse</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Visitor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">visit</span></span></span><span class="hljs-class">) {</span></span> node* stack_data[MAX_STACK_SIZE] = {}; node** <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = stack_data; node** stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; *<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++ = m_root; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { node* curr = *--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(curr-&gt;m_radius_sqr &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<span class="hljs-comment"><span class="hljs-comment">//  .    . if(curr-&gt;m_left != NULL) { *stack++ = curr-&gt;m_left; } if(curr-&gt;m_right != NULL) { *stack++ = curr-&gt;m_right; } } else {//   .  . visit(curr-&gt;m_body_n, curr-&gt;m_mass_center, curr-&gt;m_mass); } } }</span></span></code> </pre><br></div></div><br> æ­¤å®ç°è¿˜æœ‰å¦ä¸€ä¸ªé—®é¢˜-æ²¡æœ‰é€šç”¨çš„æ–¹æ³•å¯ä»¥å¹¶è¡ŒåŒ–è¿™ç§æ ‘éå†ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å®Œå…¨æ”¹å˜æ ‘åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼-æˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰èŠ‚ç‚¹å­˜å‚¨åœ¨ä¸€ä¸ªçº¿æ€§æ•°ç»„ä¸­ï¼Œå¹¶é€šè¿‡ç±»ä¼¼äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äºŒè¿›åˆ¶å †</a>çš„æ„é€ å®Œå…¨æ”¾å¼ƒå¯¹åä»£çš„æŒ‡é’ˆçš„å­˜å‚¨ã€‚ ç”¨ä»¥ä¸‹å‘½ä»¤å¼€å§‹ç¼–å·èŠ‚ç‚¹æ—¶ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-888"><span class="MJXp-mn" id="MJXp-Span-889">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71"> 1 </script> å¦‚æœèŠ‚ç‚¹åœ¨å•å…ƒæ ¼ç¼–å·ä¸­ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-890"><span class="MJXp-mrow" id="MJXp-Span-891"><span class="MJXp-mo" id="MJXp-Span-892" style="margin-left: 0.278em; margin-right: 0.278em;">æˆ‘</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-72">æˆ‘</script>  ï¼Œé‚£ä¹ˆä»–çš„å·¦å­©å­åœ¨ç‰¢æˆ¿ä¸­ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-893"><span class="MJXp-mn" id="MJXp-Span-894">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73"> 2i </script>  ï¼Œå•å…ƒæ ¼ä¸­çš„å¯¹å­ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-896"><span class="MJXp-mn" id="MJXp-Span-897">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">i</span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-900">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-74"> 2i + 1 </script>  ï¼Œä»¥åŠå•å…ƒæ ¼ä¸­çš„çˆ¶çº§ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-901"><span class="MJXp-mrow" id="MJXp-Span-902"><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0.278em; margin-right: 0.278em;">æˆ‘</span></span><span class="MJXp-mrow" id="MJXp-Span-904"><span class="MJXp-mo" id="MJXp-Span-905" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-906">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-75">æˆ‘/ 2 </script>  ã€‚ å³è¾¹çš„èŠ‚ç‚¹ä¸å·¦è¾¹å¯¹åº”çš„æ•°å­— <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-907"><span class="MJXp-mrow" id="MJXp-Span-908"><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0.278em; margin-right: 0.278em;">æˆ‘</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76">æˆ‘</script> å°†æœ‰ä¸€ä¸ªæ•°å­— <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-910"><span class="MJXp-mrow" id="MJXp-Span-911"><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0.278em; margin-right: 0.278em;">æˆ‘</span></span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-914">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77">æˆ‘+ 1 </script>  ã€‚ æ•°ç»„æœ¬èº«å°†æœ‰ä¸€ä¸ªé•¿åº¦ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-915"><span class="MJXp-mn" id="MJXp-Span-916">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78"> 2N </script>  ï¼Œå¹¶ä¸”æ‰€æœ‰å¶èŠ‚ç‚¹å°†ä½äºæœ€åä¸€ä¸ª <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-79"> N </script> æ­¤å¤–ï¼Œå•å…ƒé—´è·å¾ˆè¿‘çš„èŠ‚ç‚¹å°†ä½äºé˜µåˆ—çš„ç´§å¯†å•å…ƒä¸­ã€‚ æ ‘éå†å‡½æ•°å°†æœ‰æ‰€å˜åŒ–ï¼Œä½†æ˜¯æ¡†æ¶ä¿æŒä¸å˜ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">é€šè¿‡éå†æ•°ç»„ä¸­çš„æ ‘æ¥è®¡ç®—åŠ›</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> force_compute(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span>&amp; v1, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> mass1) { <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> total_force; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> stack_data[MAX_STACK_SIZE] = {}; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>* <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = stack_data; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>* stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; *<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++ = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> curr = *--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbcoord_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">distance_sqr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">((v1 - m_mass_center[curr]).norm())</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(distance_sqr &gt; m_radius_sqr[curr]) { total_force += force(v1, m_mass_center[curr], mass1, m_mass[curr]); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> left(left_idx(curr)); <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> rght(rght_idx(curr)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rght &lt; m_body_n.size()) { *<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++ = rght; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(left &lt; m_body_n.size()) { *<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++ = left; } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> total_force; }</code> </pre><br></div></div><br> ä½†è¿™å¹¶ä¸æ˜¯å°†èŠ‚ç‚¹å­˜å‚¨åœ¨æ•°ç»„ä¸­çš„æ‰€æœ‰å¯èƒ½ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨çˆ¬ç½‘æ—¶æ‹’ç»å †æ ˆã€‚ ä¸ºæ­¤ï¼Œåœ¨è½¬åˆ°è¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„ä»£ç åˆ†æ”¯ä¸­ï¼Œæ·»åŠ è¯¥å‡½æ•°ä»¥è®¡ç®—ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">x</span><span class="MJXp-msubsup" id="MJXp-Span-924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-926" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">p</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80"> next_ {up} </script>  ï¼‰ï¼Œå¹¶åœ¨è®¡ç®—ç›¸äº’ä½œç”¨åŠ›çš„åˆ†æ”¯ä¸­ï¼Œæ·»åŠ è·³è¿‡å½“å‰å­æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„è®¡ç®—ï¼ˆ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">i</span><span class="MJXp-msubsup" id="MJXp-Span-933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-935" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">n</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81"> skip_ {down} </script>  ï¼‰ <br><br> è¦è·³è¿‡å½“å‰å­æ ‘ï¼Œæˆ‘ä»¬éœ€è¦å‘ä¸‹åˆ°æ ¹ï¼ˆæ–¹å‘ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-940"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82"> D </script>  ï¼‰ï¼Œå½“æˆ‘ä»¬åœ¨å³åä»£ä¸­æ—¶ï¼Œä¸€åˆ°è¾¾å·¦åï¼Œä¾¿è½¬åˆ°ç›¸åº”çš„å³å­æ ‘ï¼ˆæ–¹å‘ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">R</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-83"> R </script>  ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬åˆ°è¾¾æ ¹ï¼Œé‚£ä¹ˆæ ‘éå†å°±å®Œæˆäº†ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å­æ ‘è·³è¿‡åŠŸèƒ½ä»£ç </b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> skip_down(<span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> idx) { <span class="hljs-comment"><span class="hljs-comment">// While index is 'right' -&gt; go down while(is_right(idx)) { index_t parent = parent_idx(idx); // We at root again. Stop traverse. if(parent == NBODY_HEAP_ROOT_INDEX) { return NBODY_HEAP_ROOT_INDEX; } idx = parent; } return left2right(idx); }</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/f29/d13/fe4/f29d13fe464d49022665ac28be8912cf.svg"><br>  <b>å›¾8.</b> <i>è·³è¿‡å­æ ‘</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-944"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">i</span><span class="MJXp-msubsup" id="MJXp-Span-948"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-950" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">n</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84"> skip_ {down} </script></i>   <i>ã€‚</i> <br><br> è¦è½¬åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¯·å°½å¯èƒ½è½¬åˆ°å·¦å­èŠ‚ç‚¹ï¼ˆæ–¹å‘ <math></math><img src="https://habrastorage.org/getpro/habr/formulas/d07/cc5/b26/d07cc5b26db621faab45e0e0b54ede62.svg" alt="U" data-tex="inline">  ï¼‰ï¼Œå¦‚æœæ²¡æœ‰åä»£ï¼Œåˆ™ä½¿ç”¨å‡½æ•°â€œä»ä¸‹é¢â€è½¬åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">i</span><span class="MJXp-msubsup" id="MJXp-Span-959"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-961" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">n</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85"> skip_ {down} </script>  ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">è½¬åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹åŠŸèƒ½ä»£ç </b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> next_up(<span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> idx, <span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> tree_size) { <span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> left = left_idx(idx); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(left &lt; tree_size) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> left; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> skip_down(idx); }</code> </pre><br></div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/26d/909/a33/26d909a33c617b955c256a3f717fa116.svg"><br>  <b>å›¾9.</b> <i>è¿‡æ¸¡åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">x</span><span class="MJXp-msubsup" id="MJXp-Span-970"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-972" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">p</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86"> next_ {up} </script></i>   <i>ã€‚</i> <br><br> ä¼¼ä¹æˆ‘ä»¬ç”¨å¾ªç¯æ›¿æ¢äº†é€’å½’ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-975"><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mo" id="MJXp-Span-977" style="margin-left: 0.278em; margin-right: 0.278em;">è€Œ</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87">è€Œ</script> åœ¨åŠŸèƒ½ä¸Š <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-978"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">i</span><span class="MJXp-msubsup" id="MJXp-Span-982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-984" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">n</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88"> skip_ {down} </script>  ï¼Œè¿™æ ·çš„æ›¿æ¢ä¸ä¼šç»™å‡ºä»»ä½•ç»“æœï¼Œä½†æ˜¯è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç¡®å®šä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦å¸¦æœ‰æ•°å­— <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-989"><span class="MJXp-mrow" id="MJXp-Span-990"><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0.278em; margin-right: 0.278em;">æˆ‘</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89">æˆ‘</script> å³åè£”ã€‚ åªéœ€æ£€æŸ¥å…¶å¥‡æ•°å³å¯å®Œæˆæ“ä½œï¼ˆæ­£ç¡®çš„å­©å­åœ¨å•å…ƒæ ¼ä¸­ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-992"><span class="MJXp-mn" id="MJXp-Span-993">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">i</span><span class="MJXp-mo" id="MJXp-Span-995" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-996">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-90"> 2i + 1 </script>  ï¼‰ï¼Œå› æ­¤è¶³ä»¥è®¡ç®— <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-997"><span class="MJXp-mrow" id="MJXp-Span-998"><span class="MJXp-mo" id="MJXp-Span-999" style="margin-left: 0.278em; margin-right: 0.278em;">æˆ‘</span></span><span class="MJXp-mtext" id="MJXp-Span-1000" style="color: red;">\ï¼†</span><span class="MJXp-mn" id="MJXp-Span-1001">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-91">æˆ‘\ï¼†1 </script>  ã€‚ å³ æˆ‘ä»¬å°†æ•°å­—ç›¸é™¤ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1002"><span class="MJXp-mrow" id="MJXp-Span-1003"><span class="MJXp-mo" id="MJXp-Span-1004" style="margin-left: 0.278em; margin-right: 0.278em;">æˆ‘</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-92-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-92">æˆ‘</script> å¦‚æœæœ€ä½æœ‰æ•ˆä½è®¾ç½®ä¸º1ï¼Œåˆ™ä¸º2ã€‚ ä½†è¿™æ— éœ€å¾ªç¯å³å¯å®Œæˆï¼Œåœ¨è®¸å¤šå¤„ç†å™¨ä¸­ï¼Œéƒ½æœ‰ä¸€æ¡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æŸ¥æ‰¾ç¬¬ä¸€è®¾ç½®</a>æŒ‡ä»¤è¿”å›ç¬¬ä¸€è®¾ç½®ä½çš„ä½ç½®ï¼Œä½¿ç”¨å®ƒæˆ‘ä»¬å°†å¾ªç¯å˜æˆå››ä¸ªå¤„ç†å™¨æŒ‡ä»¤ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ä¼˜åŒ–çš„è·³è¿‡å­æ ‘åŠŸèƒ½ä»£ç </b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> skip_down(<span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> idx) { idx = idx &gt;&gt; (__builtin_ffs(~idx) - <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> left2right(idx); }</code> </pre><br></div></div><br> ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä»æ ‘éå†å‡½æ•°ä¸­æ’é™¤å †æ ˆï¼Œå¹¶ç”¨ä¸€å¯¹æ›¿æ¢ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">i</span><span class="MJXp-msubsup" id="MJXp-Span-1009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1011" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">x</span><span class="MJXp-msubsup" id="MJXp-Span-1020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1022" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">p</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-93-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-93"> skip_ {down} + next_ {up} </script>  ï¼Œä¹‹åå‡½æ•°çœ‹èµ·æ¥æ›´ç®€å•ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">é€šè¿‡éå†æ•°ç»„ä¸­çš„æ ‘è€Œä¸ä½¿ç”¨å †æ ˆæ¥è®¡ç®—åŠ›</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> force_compute(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span>&amp; v1, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> mass1) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> total_force; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> curr = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> tree_size = m_mass_center.size(); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbcoord_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">distance_sqr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">((v1 - m_mass_center[curr]).norm())</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(distance_sqr &gt; m_radius_sqr[curr]) { total_force += force(v1, m_mass_center[curr], mass1, m_mass[curr]); curr = skip_down(curr); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { curr = next_up(curr, tree_size); } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(curr != NBODY_HEAP_ROOT_INDEX); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> total_force; }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ€»å…±ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ ‘éå†å’ŒåŠ›è®¡ç®—çš„å…­ä¸ªç»„åˆã€‚</font><font style="vertical-align: inherit;">æ¯”è¾ƒè¿™äº›æ–¹æ³•çš„è®¡ç®—æ—¶é—´å’Œè´¨é‡ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†ç»è¿‡100æ¬¡è¿­ä»£åç³»ç»Ÿæ€»èƒ½é‡çš„ç›¸å¯¹å˜åŒ–ä½œä¸ºè´¨é‡åº¦é‡ã€‚</font><font style="vertical-align: inherit;">ä½œä¸ºæ¨¡å‹ç³»ç»Ÿï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸¤ä¸ªç›¸äº’ä½œç”¨çš„â€œæ˜Ÿç³»â€</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1025"><span class="MJXp-mn" id="MJXp-Span-1026"><font style="vertical-align: inherit;"></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¯ä¸ª</font><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1025"><span class="MJXp-mn" id="MJXp-Span-1026"><font style="vertical-align: inherit;"> 16384å…·</font></span></span></span><font style="vertical-align: inherit;">å°¸ä½“ã€‚</font><b><font style="vertical-align: inherit;">è¡¨4.</font></b><i><font style="vertical-align: inherit;">æ ‘æœ¨éå†æ–¹æ³•å’ŒåŠ›è®¡ç®—çš„ç»„åˆ</font></i></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-94-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-94">16384</script><font style="vertical-align: inherit;"></font><br><br> <b><font style="vertical-align: inherit;"></font></b> <i><font style="vertical-align: inherit;"></font></i> <br><table><tbody><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ ‘éå†/åŠ›è®¡ç®—ç±»å‹ </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ ‘ä¸å †æ ˆ </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å †çš„â€œå †â€ </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ²¡æœ‰å †çš„â€œå †â€ </font></font></th></tr><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æŒ‰ä¸»ä½“ç¼–å·è¿›è¡Œè¿­ä»£ </font></font></th><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¾ªç¯+æ ‘ </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¾ªç¯+å † </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å‘¨æœŸ+æ— å † </font></font></td></tr><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¶æ—è·¯ </font></font></th><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nestedtree +æ ‘ </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nestedtree +å † </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åµŒå¥—æ ‘+æ— å † </font></font></td></tr></tbody></table><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/dc4/be0/e89/dc4be0e898fd575d0bdf4228a5310884.svg"><br></a> <br></td><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/aa2/ca4/e2d/aa2ca4e2daa0cfa77f59f0e6112a3714.svg"><br></a> <br></td></tr><tr><td> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aï¼‰</font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°è®¡ç®—æ—¶é—´ä¾èµ–æ€§</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1027"><span class="MJXp-msubsup" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1030" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-95-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-95">f_n</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»åˆ°æ ‘èŠ‚ç‚¹çš„å…³é”®è·ç¦»åˆ°å®ƒçš„åŠå¾„çš„æ¯”ç‡ï¼ˆ</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1031"><span class="MJXp-msubsup" id="MJXp-Span-1032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Î» </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1034" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‡ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Å™ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¨</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-96-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-96">\lambda_{crit}</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font></i> </td><td> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bï¼‰</font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç³»ç»Ÿä¸­èƒ½é‡çš„ç›¸å¯¹å˜åŒ–å¯¹åˆ°æ ‘èŠ‚ç‚¹çš„ä¸´ç•Œè·ç¦»ä¸å…¶åŠå¾„ä¹‹æ¯”çš„ä¾èµ–å…³ç³»ï¼ˆ</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1039"><span class="MJXp-msubsup" id="MJXp-Span-1040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Î» </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1042" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‡ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Å™ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¨</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-97-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-97">\lambda_{crit}</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font></i> </td></tr><tr><td colspan="2" align="center"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å›¾10. </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°è®¡ç®—ç»“æœ</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1047"><span class="MJXp-msubsup" id="MJXp-Span-1048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1050" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nä»¥</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-98-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-98">f_n</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å„ç§æ–¹å¼åœ¨CPUä¸Šï¼ˆä¸»ä½“æ•°</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1051"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N </font></font></span><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1054"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32768</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-99-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-99">N=32768</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i> </td></tr></tbody></table><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯ä»¥çœ‹å‡ºï¼Œâ€œåµŒå¥—æ ‘+æ ‘â€çš„å®ç°é€Ÿåº¦æ¯«æ— å¸Œæœ›åœ°è½åï¼Œå› ä¸º </font><font style="vertical-align: inherit;">å®ƒç¼ºä¹å¹¶å‘æ€§ã€‚</font><font style="vertical-align: inherit;">æœ€é‡è¦çš„æ˜¯å®ç°åœ¨æ•°ç»„ä¸­å…·æœ‰æ ‘èŠ‚ç‚¹çš„ä½ç½®å¹¶åœ¨äºŒè¿›åˆ¶å †ä¸­å»ºç«‹ç´¢å¼•çš„å®ç°ã€‚</font><font style="vertical-align: inherit;">èƒ½é‡çš„ç›¸å¯¹å˜åŒ–å¯¹äºæ‰€æœ‰å…·æœ‰</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1055"><span class="MJXp-msubsup" id="MJXp-Span-1056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Î» </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1058" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‡ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Å™ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¨</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt; </font></font></span><span class="MJXp-mn" id="MJXp-Span-1064"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-100-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-100">\lambda_{crit} > 1</script>  ã€‚<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒæ ·åœ¨å›¾ã€‚</font><font style="vertical-align: inherit;">å›¾10aæ˜¾ç¤ºäº†</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1065"><span class="MJXp-msubsup" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Î» </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1068" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‡ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Å™ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¨</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1073" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &lt; </font></font></span><span class="MJXp-mn" id="MJXp-Span-1074"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ï¼Œæ‰€æœ‰å®æ–½ä¾‹å‡½æ•°è¿ç®—</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-101-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-101">\lambda_{crit} < 10</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1075"><span class="MJXp-msubsup" id="MJXp-Span-1076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1078" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤§å¤§è¶…è¿‡äº†ç²¾ç¡®è®¡ç®—çš„æœ€ä¼˜åŒ–ç‰ˆæœ¬ï¼ˆâ€œ openmp +å—+ä¼˜åŒ–â€ï¼‰ï¼Œå¹¶ä¸”è¿›ä¸€æ­¥æé«˜äº†é€Ÿåº¦</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-102-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-102">f_n</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1079"><span class="MJXp-msubsup" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Î» </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1082" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã§ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[R </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç‰›é€¼</font></font></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ ‘æœ¨æŸå¤±ç²¾åº¦ç‰ˆæœ¬çš„å®ç°ã€‚</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-103-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-103">\lambda_{crit}</script><font style="vertical-align: inherit;"></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GPUæ ‘éå† </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘å°è¯•ä½¿ç”¨OpenCLæŠ€æœ¯å’ŒCUDAç»•è¿‡GPUä¸Šçš„æ ‘ã€‚</font><font style="vertical-align: inherit;">ä»¥æ ‘å½¢å¼å­˜å‚¨èŠ‚ç‚¹çš„é€‰é¡¹è¢«ç«‹å³ä¸¢å¼ƒï¼Œä»…å‰©ä¸‹å°†æ ‘å­˜å‚¨åœ¨å…·æœ‰ç´¢å¼•çš„æ•°ç»„ä¸­çš„é€‰é¡¹ï¼Œå¦‚åœ¨äºŒè¿›åˆ¶å †ä¸­é‚£æ ·ã€‚</font><font style="vertical-align: inherit;">é€šå¸¸ï¼Œè®¡ç®—æ ¸å¿ƒçš„å®ç°ä¸CPUç‰ˆæœ¬æ²¡æœ‰å¤ªå¤§åŒºåˆ«ã€‚</font></font><br><br><div class="spoiler"> <b class="spoiler_title">OpenCL        (    )</b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">kernel </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ComputeTreeBH</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tree_size, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* y, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmx, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmy, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmz, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_mass, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_crit_r2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = get_global_id(<span class="hljs-number"><span class="hljs-number">0</span></span>) + offset_n1; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stride = points_count; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rx = y; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* ry = rx + stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rz = rx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vx = rx + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vy = rx + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vz = rx + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frx = f; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fry = frx + stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frz = frx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvx = frx + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvy = frx + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvz = frx + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = rx[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = ry[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = rz[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_data[MAX_STACK_SIZE] = {}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> curr = stack_data[--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dx = x1 - tree_cmx[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dy = y1 - tree_cmy[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dz = z1 - tree_cmz[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r2 = (dx * dx + dy * dy + dz * dz); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &gt; tree_crit_r2[curr]) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(r2); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> coeff = tree_mass[curr] / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; res_x -= dx; res_y -= dy; res_z -= dz; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> left = left_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rght = rght_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(left &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = left; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rght &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = rght; } } } frx[n1] = vx[n1]; fry[n1] = vy[n1]; frz[n1] = vz[n1]; fvx[n1] = res_x; fvy[n1] = res_y; fvz[n1] = res_z; }</code> </pre><br></div></div><br>             ,        ,        GPU.       ,    ,           , ..        .  ,           ,   ,          ,    ,   ,          tn1. <br><br><div class="spoiler"> <b class="spoiler_title">OpenCL        (     )</b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">kernel </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ComputeHeapBH</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tree_size, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* y, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmx, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmy, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmz, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_mass, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_crit_r2, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">* body_n)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tree_offset = points_count - <span class="hljs-number"><span class="hljs-number">1</span></span> + NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stride = points_count; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tn1 = get_global_id(<span class="hljs-number"><span class="hljs-number">0</span></span>) + offset_n1 + tree_offset; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = body_n[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = tree_cmx[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = tree_cmy[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = tree_cmz[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_data[MAX_STACK_SIZE] = {}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> curr = stack_data[--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dx = x1 - tree_cmx[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dy = y1 - tree_cmy[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dz = z1 - tree_cmz[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r2 = (dx * dx + dy * dy + dz * dz); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &gt; tree_crit_r2[curr]) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(r2); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> coeff = tree_mass[curr] / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; res_x -= dx; res_y -= dy; res_z -= dz; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> left = left_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rght = rght_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(left &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = left; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rght &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = rght; } } } __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vx = y + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vy = y + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vz = y + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frx = f; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fry = frx + stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frz = frx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvx = frx + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvy = frx + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvz = frx + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; frx[n1] = vx[n1]; fry[n1] = vy[n1]; frz[n1] = vz[n1]; fvx[n1] = res_x; fvy[n1] = res_y; fvz[n1] = res_z; }</code> </pre><br></div></div><br>           .      .  ,      ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> , ..      ,     .   ,      ,        ,       ,       ,      ,        .    ,   ,      . å³<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½“éå†æ ‘çš„å…¶ä½™éƒ¨åˆ†æ—¶ï¼Œè®¡ç®—æ ¸å¿ƒçš„ç›¸é‚»çº¿ç¨‹ä¸ä¼šè®¿é—®æ ‘çš„ç›¸åŒèŠ‚ç‚¹ï¼Œè€Œæ˜¯ç´§å¯†ä½äºå†…å­˜ä¸­ã€‚</font><font style="vertical-align: inherit;">è¦ä¼˜åŒ–æ­¤å†…å­˜è®¿é—®ï¼Œå¯ä»¥ä½¿ç”¨çº¹ç†å†…å­˜ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯æœ‰ä¸€ä¸ªéšœç¢ã€‚</font><font style="vertical-align: inherit;">ç›®å‰ï¼Œçº¹ç†ä¸æ”¯æŒä½¿ç”¨åŒç²¾åº¦æ•°æ®ï¼ˆæˆ‘ä»¬è¦ç²¾ç¡®è®¡ç®—ï¼‰ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯åœ¨CUDAä¸­ï¼Œæœ‰ä¸€ä¸ª</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__hiloint2double</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°</font><font style="vertical-align: inherit;">ï¼Œå®ƒä»ä¸¤ä¸ªæ•´æ•°ä¸­æ”¶é›†ä¸€ä¸ªåŒç²¾åº¦æ•°ã€‚</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥è‡ªå­˜å‚¨æ•´æ•°çš„çº¹ç†çš„åŒç²¾åº¦æ•°å­—è¯·æ±‚ä»£ç </font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nb1Dfetch</span></span></span><span class="hljs-class">&lt;double&gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> double4 vec4; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> __<span class="hljs-function"><span class="hljs-function">device__ </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cudaTextureObject_t tex, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-function">int2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tex1Dfetch&lt;int2&gt;(tex, i))</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> __hiloint2double(py, px); } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> __<span class="hljs-function"><span class="hljs-function">device__ vec4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetch4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cudaTextureObject_t tex, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ii</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * i)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">int4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tex1Dfetch&lt;int4&gt;(tex, ii))</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">int4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tex1Dfetch&lt;int4&gt;(tex, ii + </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">))</span></span></span></span>; vec4 d4 = {__hiloint2double(p1.y, p1.x), __hiloint2double(p1.w, p1.z), __hiloint2double(p2.y, p2.x), __hiloint2double(p2.w, p2.z) }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> d4; } };</code> </pre><br></div></div><br>      ,      (x, y, z, tree_crit_r2)  ,        .      ,     <i>r2 &gt; tree_crit_r2[curr]</i> ,         .      CUDA       L1     ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">cudaFuncSetCacheConfig</a> ).         ,      L1   . <br><br><div class="spoiler"> <b class="spoiler_title">CUDA        (     )</b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">global__ </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kfcompute_heap_bh_tex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tree_size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, cudaTextureObject_t tree_xyzr, cudaTextureObject_t tree_mass, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">* body_n)</span></span></span><span class="hljs-function"> </span></span>{ nb1Dfetch&lt;<span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>&gt; tex; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tree_offset = points_count - <span class="hljs-number"><span class="hljs-number">1</span></span> + NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stride = points_count; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tn1 = blockDim.x * blockIdx.x + threadIdx.x + offset_n1 + tree_offset; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = body_n[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbvec4_t</span></span> xyzr = tex.fetch4(tree_xyzr, tn1); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = xyzr.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = xyzr.y; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = xyzr.z; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_data[MAX_STACK_SIZE] = {}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> curr = stack_data[--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">nbvec4_t</span></span> xyzr2 = tex.fetch4(tree_xyzr, curr); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dx = x1 - xyzr2.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dy = y1 - xyzr2.y; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dz = z1 - xyzr2.z; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r2 = (dx * dx + dy * dy + dz * dz); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &gt; xyzr2.w) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(r2); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> coeff = tex.fetch(tree_mass, curr) / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; res_x -= dx; res_y -= dy; res_z -= dz; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> left = nbody_heap_func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;::left_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rght = nbody_heap_func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;::rght_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(left &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = left; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rght &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = rght; } } } f[n1 + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride] = res_x; f[n1 + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride] = res_y; f[n1 + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride] = res_z; }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯¹nvprofåˆ†æå™¨ä¸­çš„ç¨‹åºè¿›è¡Œçš„åˆ†æè¡¨æ˜ï¼Œå³ä½¿ä½¿ç”¨çº¹ç†å†…å­˜å­˜å‚¨æ ‘ï¼Œå…¨å±€å†…å­˜ä¸Šçš„è´Ÿè½½ä»ç„¶éå¸¸é«˜ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®é™…ä¸Šï¼Œåœ¨CUDAä¸­ï¼Œæ‰€æœ‰å¯»å€åˆ°â€œè®¡ç®—å‡ºçš„â€åœ°å€çš„å†…æ ¸å†…å­˜éƒ½å­˜å‚¨åœ¨å…¨å±€å†…å­˜ä¸­ï¼Œå› æ­¤ï¼Œéå†æ ‘æ‰€éœ€çš„å †æ ˆä½äºå…¨å±€å†…å­˜ä¸­ï¼Œå¹¶ä¸”åå™¬äº†å†…å­˜èŠ¯ç‰‡å¸¦å®½çš„å¾ˆå¤§ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºè¯¥å †æ ˆå…·æœ‰æ¯ä¸ªè¿è¡Œçº¿ç¨‹ï¼Œå¹¶ä¸”æœ‰å¾ˆå¤šçº¿ç¨‹ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•åœ¨ä¸ä½¿ç”¨å †æ ˆçš„æƒ…å†µä¸‹éå†æ ‘ã€‚</font><font style="vertical-align: inherit;">ç”¨è®¡ç®—ä¸‹ä¸€ä¸ªæ ‘èŠ‚ç‚¹çš„åŠŸèƒ½å¯¹å…ˆå‰çš„è®¡ç®—æ ¸å¿ƒè¿›è¡Œè¡¥å……ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„å†…æ ¸ï¼Œè€Œä¸”æ›´åŠ ç´§å‡‘ã€‚</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CUDAæ ¸å¿ƒï¼Œæ— éœ€éå†å †æ ˆå³å¯éå†æ ‘æ¥è®¡ç®—å¼ºåº¦</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">global__ </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kfcompute_heap_bh_stackless</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tree_size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, cudaTextureObject_t tree_xyzr, cudaTextureObject_t tree_mass, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">* body_n)</span></span></span><span class="hljs-function"> </span></span>{ nb1Dfetch&lt;<span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>&gt; tex; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tree_offset = points_count - <span class="hljs-number"><span class="hljs-number">1</span></span> + NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stride = points_count; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tn1 = blockDim.x * blockIdx.x + threadIdx.x + offset_n1 + tree_offset; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = body_n[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbvec4_t</span></span> xyzr = tex.fetch4(tree_xyzr, tn1); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = xyzr.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = xyzr.y; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = xyzr.z; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> curr = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">nbvec4_t</span></span> xyzr2 = tex.fetch4(tree_xyzr, curr); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dx = x1 - xyzr2.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dy = y1 - xyzr2.y; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dz = z1 - xyzr2.z; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r2 = (dx * dx + dy * dy + dz * dz); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &gt; xyzr2.w) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(r2); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> coeff = tex.fetch(tree_mass, curr) / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; res_x -= dx; res_y -= dy; res_z -= dz; curr = nbody_heap_func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;::skip_idx(curr); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { curr = nbody_heap_func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;::next_up(curr, tree_size); } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(curr != NBODY_HEAP_ROOT_INDEX); f[n1 + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride] = res_x; f[n1 + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride] = res_y; f[n1 + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride] = res_z; }</code> </pre><br></div></div><br>  ,   GPU,     ,     .    ,  ,          .     ,          ,        ,  ,                 .                .        NVidia K80. <br><br> <b> 5.</b> <i>   ( ) </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1087"><span class="MJXp-msubsup" id="MJXp-Span-1088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1090" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-104-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-104">f_n</script></i>  <i>     GPU    </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">N</span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1094">131072</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-105-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-105">N=131072</script></i>  <i></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1095"><span class="MJXp-msubsup" id="MJXp-Span-1096"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1098" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1104">10</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-106-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-106">\lambda_{crit}=10</script></i> <br><table><tbody><tr><th>  / </th><th>  8 </th><th>  16 </th><th> 32 </th><th> 64 </th><th> 128 </th><th> 256 </th><th> 512 </th><th> 1024 </th></tr><tr><td> opencl+dense </td><td> 5.77 </td><td> 2.84 </td><td> 1.46 </td><td> <b>1.13</b> </td><td> 1.15 </td><td> 1.14 </td><td> 1.14 </td><td> 1.13 </td></tr><tr><td> cuda+dense </td><td> 5.44 </td><td> 2.55 </td><td> 1.27 </td><td> <b>0.96</b> </td><td> 0.97 </td><td> 0.99 </td><td> 0.99 </td><td>  -- </td></tr><tr><td> opencl+heap+cycle </td><td> 5.88 </td><td> 5.65 </td><td> 5.74 </td><td> 5.96 </td><td> 5.37 </td><td> 5.38 </td><td> <b>5.35</b> </td><td> 5.38 </td></tr><tr><td> opencl+heap+nested </td><td> 4.54 </td><td> <b>3.68</b> </td><td> 3.98 </td><td> 5.25 </td><td> 5.46 </td><td> 5.41 </td><td> 5.48 </td><td> 5.31 </td></tr><tr><td> cuda+heap+nested </td><td>  3.62 </td><td>  2.81 </td><td> <b>2.68</b> </td><td> 4.26 </td><td> 4.84 </td><td> 4.75 </td><td> 4.8 </td><td> 4.67 </td></tr><tr><td> cuda+heap+nested+tex </td><td> 2.6 </td><td> 1.51 </td><td> 0.912 </td><td> <b>0.7</b> </td><td> 1.85 </td><td> 1.75 </td><td> 1.69 </td><td> 1.61 </td></tr><tr><td> cuda+heap+nested+tex+stackless </td><td> 2.3 </td><td> 1.29 </td><td> 0.773 </td><td> <b>0.5</b> </td><td> 0.51 </td><td> 0.52 </td><td> 0.52 </td><td> 0.52 </td></tr></tbody></table><br><br> <b> 6.</b> <i>   ( ) </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1105"><span class="MJXp-msubsup" id="MJXp-Span-1106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1108" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-107-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-107">f_n</script></i>  <i>     GPU    </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">N</span><span class="MJXp-mo" id="MJXp-Span-1111" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1112">1</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-108-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-108">N=1M</script></i>  <i></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1114"><span class="MJXp-msubsup" id="MJXp-Span-1115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Î» </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1117" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‡ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Å™ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¨</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mn" id="MJXp-Span-1123"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-109-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-109">\lambda_{crit}=4</script></i> <br><table><tbody><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å—å¤§å°/æ ¸å¿ƒ </font></font></th><th>  8 </th><th>  16 </th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 32 </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 64 </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 128 </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 256 </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 512 </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1024 </font></font></th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> opencl +å¯†é›† </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 366 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 179 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 89.9 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 69.3 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 70.3 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 69.1 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 68.9 </font></font></td><td> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">68.0</font></font></b> </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CUDA +å¯†é›† </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 346 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 162 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 79.6 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 60.8 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 60.8 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 60.7 </font></font></td><td> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">59.6</font></font></b> </td><td>  -- </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> opencl +å †+å‘¨æœŸ </font></font></td><td> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16.2</font></font></b> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 18.2 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 20.1 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 21.2 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 21.2 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 21.3 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 21.2 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 21.1 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> opencl +å †+åµŒå¥— </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10.5 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7.63 </font></font></td><td> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.38</font></font></b> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.23 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9.95 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9.89 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9.65 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9.66 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CUDA +å †+åµŒå¥— </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.67 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6.44 </font></font></td><td> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.39</font></font></b> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5.93 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.65 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.61 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.41 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8.27 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CUDA +å †+åµŒå¥—+ TEX </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6.38 </font></font></td><td>  3.57 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2.13 </font></font></td><td> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.44</font></font></b> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.56 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.46 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.30 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.29 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cuda +å †+åµŒå¥—+ tex +æ— å †æ ˆ </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5.78 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.19 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.83 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.21 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.11 </font></font></td><td> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.10</font></font></b> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.11 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.13 </font></font></td></tr></tbody></table><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯ä¸€ä¸ªå›°éš¾çš„æƒ…å†µï¼Œä½†æ˜¯ä¸æ ‘éå†çš„CPUç‰ˆæœ¬ä¸åŒï¼Œå¾ˆæ˜æ˜¾ï¼Œæ¯ä¸ªä¼˜åŒ–æ­¥éª¤éƒ½ä¼šå¸¦æ¥åˆ‡å®çš„ç»“æœã€‚</font><font style="vertical-align: inherit;">ä¸å®Œå…¨å‡½æ•°è®¡ç®—çš„ç²¾ç¡®è§£å†³æ–¹æ¡ˆç›¸æ¯”ï¼Œâ€œ opencl +å †+å‘¨æœŸâ€çš„å®ç°æ…¢äº†è¿‘6å€</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1124"><span class="MJXp-msubsup" id="MJXp-Span-1125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ËšF </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1127" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã±</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110">f_n</script>  ã€‚  'opencl+heap+nested',        ,    1.4 , ..    .   'cuda+heap+nested'   L1    ,       1.4 ,   ,   cuda       (  'opencl+dense'  'cuda+dense'  ,    cuda    ~1.2 ).      ( 3.8 )              .        'cuda+heap+nested+tex+stackless'    1.4 , ..                     .  ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1128"><span class="MJXp-msubsup" id="MJXp-Span-1129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1131" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1137">10</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111">\lambda_{crit}=10</script>             <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1138"><span class="MJXp-msubsup" id="MJXp-Span-1139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1141" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-112">f_n</script>  ã€‚ ä½†æ˜¯ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1142"><span class="MJXp-msubsup" id="MJXp-Span-1143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1145" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1150" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1151">10</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-113-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-113">\lambda_{crit}=10</script>    ,                    CPU  ,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1152"><span class="MJXp-msubsup" id="MJXp-Span-1153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1155" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-114-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-114">\lambda_{crit}</script>     .   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1160"><span class="MJXp-msubsup" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1163" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-115-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-115">\lambda_{crit}</script>    ,      . <br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/ae8/8b7/344/ae88b7344bf6c884545168e2870edeec.svg"><br></a> <br></td><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/85e/073/df6/85e073df6103f00705376ff7deb32ca1.svg"><br></a> <br></td></tr><tr><td align="center"> <b>a)</b> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N </font></font></span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1171"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128 </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-116-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-116">N=128K</script><br></td><td align="center"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bï¼‰</font></font></b> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N </font></font></span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1176"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç™¾ä¸‡</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-117-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-117">N=1M</script><br></td></tr><tr><td colspan="2" align="center"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å›¾11. </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°è®¡ç®—æ—¶é—´çš„ä¾èµ–æ€§ã€‚</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1178"><span class="MJXp-msubsup" id="MJXp-Span-1179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1181" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-118-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-118">f_n</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»åˆ°æ ‘èŠ‚ç‚¹çš„å…³é”®è·ç¦»åˆ°å®ƒçš„åŠå¾„çš„æ¯”ç‡ï¼ˆ</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1182"><span class="MJXp-msubsup" id="MJXp-Span-1183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Î» </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1185" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‡ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Å™ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¨</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-119-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-119">\lambda_{crit}</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…³äºå„ç§GPUéå†çš„å®ç°ï¼‰</font></font></i> <br></td></tr></tbody></table><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºå° </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1190"><span class="MJXp-msubsup" id="MJXp-Span-1191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Î» </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1193" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‡ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Å™ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Å¤</font></font></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¡ç®—ç‰¹å¾çš„æ‰€æœ‰æ–¹æ³•</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-120-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-120">\lambda_{crit}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1198"><span class="MJXp-msubsup" id="MJXp-Span-1199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1201" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥è¿‘äºå…³é—­å€¼ï¼Œè¯¥å€¼ç”±æ„é€ kd-treeå’Œå‡†å¤‡GPUæ•°æ®æ—¶ç¡®å®šã€‚</font><font style="vertical-align: inherit;">æ­¤å¤–ï¼Œæ¤æ ‘çš„æ—¶é—´å¯¹</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-121-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-121">f_n</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1202"><span class="MJXp-msubsup" id="MJXp-Span-1203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1205" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mn" id="MJXp-Span-1211">4</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-122-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-122">\lambda_{crit}\leq 4</script> ,     .  ,   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">N</span><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1215">128</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">K</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-123-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-123">N=128K</script>      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1217"><span class="MJXp-msubsup" id="MJXp-Span-1218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1220" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1225" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1226">1024</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-124-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-124">\lambda_{crit}=1024</script> ,     ,    GPU        ,     L1    <i>'branch divergence'</i> .  ,         (cuda+heap+nested+tex+stackless),          <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1227"><span class="MJXp-mn" id="MJXp-Span-1228"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.4 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1229" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-1230"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.5</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€ã€‚</font><font style="vertical-align: inherit;">å…¶ä»–å®ç°åˆ™æ…¢äº†å¥½å‡ å€ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†åˆå¹¶ç»“æœï¼Œæˆ‘ä»¬å°†åœ¨å…·æœ‰æ›´æ–°æ¶æ„çš„GPUä¸Šè®¡ç®—æ—¶é—´ã€‚</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-125-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-125">1.4-1.5</script><font style="vertical-align: inherit;"></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GeForce GTX 1080 Tiçš„å‘å¸ƒç»“æœï¼ˆå•ç²¾åº¦ï¼‰</font></font></b> <div class="spoiler_text"> <b> 7.</b> <i>   ( ) </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1231"><span class="MJXp-msubsup" id="MJXp-Span-1232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1234" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-126">f_n</script></i>  <i>     GPU    </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">N</span><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1238">1</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">M</span></span></span><script type="math/tex" id="MathJax-Element-127">N=1M</script></i>  <i></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1240"><span class="MJXp-msubsup" id="MJXp-Span-1241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1243" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1248" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1249">4</span></span></span><script type="math/tex" id="MathJax-Element-128">\lambda_{crit}=4</script></i> <br><table><tbody><tr><th>  / </th><th>  8 </th><th>  16 </th><th> 32 </th><th> 64 </th><th> 128 </th><th> 256 </th><th> 512 </th><th> 1024 </th></tr><tr><td> opencl+dense </td><td> 47.8 </td><td> 23.4 </td><td> 11.6 </td><td> <b>11.59</b> </td><td> 12.8 </td><td> 12.8 </td><td> 12.8 </td><td> 12.8 </td></tr><tr><td> cuda+dense </td><td> 49.0 </td><td> 23.8 </td><td> 11.9 </td><td> 11.8 </td><td> <b>11.7</b> </td><td> 11.7 </td><td> 11.7 </td><td> 11.7 </td></tr><tr><td> opencl+heap+cycle </td><td> 7.48 </td><td> 8.26 </td><td> 7.73 </td><td> 7.36 </td><td> 7.33 </td><td> <b>7.27</b> </td><td> 7.25 </td><td> 7.26 </td></tr><tr><td> opencl+heap+nested </td><td> 1.33 </td><td> <b>1.20</b> </td><td> 1.41 </td><td> 2.46 </td><td> 2.53 </td><td> 2.49 </td><td> 2.44 </td><td> 2.47 </td></tr><tr><td> cuda+heap+nested </td><td> 1.23 </td><td> <b>1.10</b> </td><td> 1.31 </td><td> 2.28 </td><td> 2.29 </td><td> 2.28 </td><td> 2.23 </td><td> 2.25 </td></tr><tr><td> cuda+heap+nested+tex </td><td> 0.88 </td><td> 0.68 </td><td> <b>0.654</b> </td><td>  1.6 </td><td>  1.6 </td><td>  1.6 </td><td>  1.6 </td><td>  1.6 </td></tr><tr><td> cuda+heap+nested+tex+stackless </td><td> 0.71 </td><td> 0.47 </td><td> 0.45 </td><td> 0.43 </td><td> 0.43 </td><td> 0.42 </td><td> 0.41 </td><td> <b>0.395</b> </td></tr></tbody></table><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b14/d81/e27/b14d81e271e2edf7b1d70faa815e1710.svg"><br></a> <br></td></tr><tr><td align="center"> <b> 12.</b> <i>   </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1250"><span class="MJXp-msubsup" id="MJXp-Span-1251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1253" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-129">f_n</script></i>  <i>          (</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1254"><span class="MJXp-msubsup" id="MJXp-Span-1255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1257" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">t</span></span></span></span></span><script type="math/tex" id="MathJax-Element-130">\lambda_{crit}</script></i>  <i>)   GPU   </i> <br></td></tr></tbody></table><br></div></div><br>   GeForce GTX 1080 Ti  ,             ,  ,      .      ,      GPU   .    5-7 ,                 GPU, ,       ,        .  ,            . <br><br> ,    â€”          ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1262"><span class="MJXp-msubsup" id="MJXp-Span-1263"><span class="MJXp-mn" id="MJXp-Span-1264" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1265" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1266">20</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-131-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-131">2^{20}</script> )     ,    GPU.    GPU (Tesla V100), ,            , ..       ,    Tesla K80. ,            ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  </a> , ,   ,  . <br><br><h2> ç»“è®º </h2><br>                   ,               .  ,      Â«  Â»,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-132-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-132">N</script> ,          ,      . <br><br><h4> å¯è§†åŒ– </h4><br>  ,              . <br><br>    .    60 . <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/AYzgTC0qqV0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¨¡æ‹Ÿç”±ä¸€ç™¾ä¸‡é¢—æ’æ˜Ÿç»„æˆçš„æ˜Ÿç³»çš„æ¼”åŒ–ã€‚</font><font style="vertical-align: inherit;">ä¸­å¿ƒæ˜¯è´¨é‡æ€»è®¡ä¸º99ï¼…çš„ç‰©ä½“ã€‚</font><font style="vertical-align: inherit;">å•ä¸ªé¢—ç²’å‡ ä¹æ— æ³•åŒºåˆ†ã€‚</font><font style="vertical-align: inherit;">å·²ç»æ›´åƒä¸€æ»´æ¶²ä½“ä¸­çš„æ³¢æµªã€‚</font><font style="vertical-align: inherit;">æ ¹æ®é€Ÿåº¦æ¨¡å—ç€è‰²ã€‚</font><font style="vertical-align: inherit;">ä½é€Ÿ-è“è‰²ï¼Œä¸­-ç»¿è‰²ï¼Œé«˜-çº¢è‰²ã€‚</font><font style="vertical-align: inherit;">å¯ä»¥çœ‹å‡ºï¼Œåœ¨ä¸­å¿ƒé€Ÿåº¦è¾ƒé«˜ï¼Œå¹¶é€æ¸å‡å°åˆ°è¾¹ç¼˜ï¼Œè€Œåœ¨èµ¤é“é¢æœ€ä½ã€‚</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/0_8nZCrVqWI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç™¾ä¸‡æ˜Ÿç³»æ¼”åŒ–çš„æ›´â€œåŠ¨æ€â€æ¨¡æ‹Ÿã€‚</font><font style="vertical-align: inherit;">ä¸­å¿ƒæ˜¯è´¨é‡å æ€»è´¨é‡10ï¼…çš„ç‰©ä½“ã€‚</font><font style="vertical-align: inherit;">ä¸­å¤®èº«ä½“å¯¹å…¶ä½™éƒ¨åˆ†çš„å½±å“æ˜æ˜¾è¾ƒå°ã€‚</font><font style="vertical-align: inherit;">é¦–å…ˆï¼Œâ€œæ˜Ÿæ˜Ÿâ€é£æ•£ï¼Œç„¶åèšé›†æˆå‡ ä¸ªæ˜Ÿå›¢ï¼Œæœ€ååˆå½¢æˆä¸€ä¸ªå¤§æ˜Ÿå›¢ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å»ºæ¨¡è¿‡ç¨‹ä¸­ï¼Œçº¦æœ‰5ï¼…çš„â€œæ˜Ÿæ˜Ÿâ€ä¸å¯æ’¤é”€åœ°ç¦»å¼€äº†åˆå§‹åŒºåŸŸã€‚</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/XLvIPK6m6QI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ç¬¬åç§’ï¼Œå®ƒéå¸¸ç±»ä¼¼äºç°æœ‰çš„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è½¦è½®æ˜Ÿç³»</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®ä»£ç å¯ä»¥åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸Šæ‰¾åˆ°</font><font style="vertical-align: inherit;">ã€‚</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN437014/">https://habr.com/ru/post/zh-CN437014/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN437002/index.html">æœ‰æ•ˆçš„ASP.NET Core</a></li>
<li><a href="../zh-CN437004/index.html">YMLç¨‹åºå‘˜æ˜¯å¦æ¢¦æƒ³è¿‡å¯ä»¥è¿›è¡Œæµ‹è¯•ï¼Ÿ</a></li>
<li><a href="../zh-CN437006/index.html">Wanhao Duplicator 10 3Dæ‰“å°æœºè¯„è®º</a></li>
<li><a href="../zh-CN437008/index.html">NLPã€‚ åŸºç¡€çŸ¥è¯†ã€‚ æŠ€æœ¯ã€‚ è‡ªæˆ‘å‘å±•ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN437010/index.html">è¿‡å»çš„å›å£°ï¼šå¹´è½»çš„ç»éªŒï¼ŒåŸºäºæ–°çš„Xå°„çº¿å…‰è°±æ³•</a></li>
<li><a href="../zh-CN437018/index.html">Pythonä¸­é™æ€ç±»å‹çš„ä¸€äº›é™·é˜±</a></li>
<li><a href="../zh-CN437020/index.html">å¼ºåŒ–å­¦ä¹ æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</a></li>
<li><a href="../zh-CN437022/index.html">å™ªå£°å®‰å…¨ä½0x22ï¼ˆæ•…éšœæ³¨å…¥æ”»å‡»ï¼Œ35C3å’ŒWallet.failï¼‰</a></li>
<li><a href="../zh-CN437026/index.html">Googleå› æ»¥ç”¨ä¸ªäººæ•°æ®è€Œå¯¹GDPRå¤„ä»¥5000ä¸‡æ¬§å…ƒçš„ç½šæ¬¾</a></li>
<li><a href="../zh-CN437030/index.html">ä¸€ä¸ªè±ªååŠå…¬å®¤çš„åŸºç¡€è®¾æ–½è‡ªåŠ¨åŒ–ï¼šå¤–è§‚</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>