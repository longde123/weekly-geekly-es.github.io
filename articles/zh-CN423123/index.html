<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥄 👨🏿‍🤝‍👨🏻 🍳 如何在Windows 10上引发测试项目（黄瓜+水豚+硒网络驱动程序） 🤩 ✋ 😻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本文旨在使您熟悉Windows 10中的环境的自动测试和部署，并且适合那些对Cucumber + Capybara + Selenium-webdriver有所了解的人使用。 本文的想法是由于Windows 10和Linux上的部署环境不同而引起的。 


 关于Cucumber + Capybar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>如何在Windows 10上引发测试项目（黄瓜+水豚+硒网络驱动程序）</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423123/"> 本文旨在使您熟悉Windows 10中的环境的自动测试和部署，并且适合那些对<b>Cucumber + Capybara + Selenium-webdriver</b>有所了解的人使用。 本文的想法是由于Windows 10和Linux上的部署环境不同而引起的。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ww/rj/s-/wwrjs-iwpbsztyvj1ocolretoz0.jpeg"></div><br> 关于Cucumber + Capybara + Selenium-webdriver gem（库）的几点说明，这些是运行和填充UI测试所需的。 <br><br><h4> 黄瓜 </h4><br>  ucumber是一颗宝石，可让您用人类语言编写测试。 为此，请使用Gherkin符号，该符号定义了编写脚本的结构和规则。 详情请<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">点击这里</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b2/n_/ly/b2n_lym6xgyjm1tmbqlrj2ikhvs.jpeg"></div><br><h4> 水豚 </h4><br> 水豚是一颗宝石，可让您搜索/单击/ ...以查找浏览器元素。 即 它是测试的Cucumber步骤和webdriver（调用的浏览器的实例）之间的链接。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在这里，</a>您可以查看此gem的方法。 <br><br><h4>  Selenium-webdriver </h4><br>  Selenium-webdriver是用于自动执行Web浏览器操作的工具。 本质上，这是浏览器实例。 <br><a name="habracut"></a><br><h4> 初步行动 </h4><br><div class="spoiler">  <b class="spoiler_title">初步行动说明</b> <div class="spoiler_text"> 为了方便起见，我们将使用RubyMine。 您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">下载</a> 30天<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的试用版</a> 。 <br><br> 下载Firefox和Chrome浏览器以运行测试。 <br><br> 下载并安装Git（版本控制系统或类似的VCS， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">官方网站</a> ）。 但是，当您已经有一个项目或要将代码存储在Git系统中时，就需要Git。 <br></div></div><br><h4> 所以我们开始吧 </h4><br> 我们已经安装了RubyMine。 <br><br><ol><li> 您需要安装Ruby语言本身。 为此，请转到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>并安装RubyInstaller。 我选择了带有DevKit软件包的最新版本（RubyInstaller 2.5.1-2）。 通过此配置包，您可以在Linux中从控制台运行测试，以及灵活地管理gem。 </li><li>  RubyInstaller软件包已安装，我们继续进行配置。 <br> 如果我们要创建一个新项目，请打开RubyMine并创建一个空项目，指示已安装Ruby。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h4/nm/tf/h4nmtfigi9avbshzxmctt1go0v4.jpeg"></div></li><li> 接下来，我们需要根据注释创建文件夹和文件的这种结构 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kg/mv/qp/kgmvqptts6xoxwmvblc-tu0q-ca.jpeg"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>详细描述 </li><li>  Gemfile-包含项目中使用的宝石列表 <br><br><div class="spoiler">  <b class="spoiler_title">这是我们的gemfile的内容，其中包含用于UI测试的最基本的gem</b> <div class="spoiler_text"><blockquote><pre><code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">source</span></span> <span class="hljs-string"><span class="hljs-string">'https://rubygems.org'</span></span> gem <span class="hljs-string"><span class="hljs-string">'cucumber'</span></span> gem <span class="hljs-string"><span class="hljs-string">'capybara'</span></span> gem <span class="hljs-string"><span class="hljs-string">'selenium-webdriver'</span></span> gem <span class="hljs-string"><span class="hljs-string">'chromedriver-helper'</span></span></code> </pre> </blockquote><br></div></div><br> 这4个gem必须在Gemfile中指定。 <br>  gem'chromedriver-helper'-允许在Chrome上运行测试的Chrome驱动程序 <br> 使用此gemfile，您需要安装我们选择的gem。 从RubyMine界面在Windows上安装是最简单的： <b>工具-&gt; Bundler-&gt;安装菜单</b> 。  Bundler也是宝石，但可以控制宝石。 但是，您也可以从命令行执行此操作，该命令行位于程序菜单中的名称为Start Command Prompt...。 <br> 顺便说一句，使用此命令行，您可以绕过RubyMine运行测试。 <br></li><li>  env.rb文件是用于运行UI测试的关键rb文件。 初始化变量和测试文件时，将是env.rb。 这是运行测试的浏览器的注册。  env.rb的现成示例，其中注册了Chrome，Firefox，或者让我们了解到我们根本不需要浏览器即可运行测试。 <br> 不需要浏览器的情况-尽管我们认为Cucumber测试不太适合这样做，但我们会检查休息请求，集成测试。 <br><br><div class="spoiler">  <b class="spoiler_title">编写env.rb</b> <div class="spoiler_text"><blockquote><pre> <code class="hljs ruby"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'capybara/cucumber'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'selenium-webdriver'</span></span> Capybara.register_driver <span class="hljs-symbol"><span class="hljs-symbol">:driver</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|app|</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ENV[<span class="hljs-string"><span class="hljs-string">'DRIVER'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'chrome'</span></span> Capybara::Selenium::Driver.new(app, <span class="hljs-symbol"><span class="hljs-symbol">:browser</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:chrome</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'without_browser'</span></span> Capybara.default_driver = <span class="hljs-symbol"><span class="hljs-symbol">:mechanize</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> client = Selenium::WebDriver::Remote::Http::Default.new Capybara::Selenium::Driver.new(app, <span class="hljs-symbol"><span class="hljs-symbol">:browser</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:firefox</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">port:</span></span> <span class="hljs-number"><span class="hljs-number">10000</span></span> + Random.rand(<span class="hljs-number"><span class="hljs-number">1000</span></span>), <span class="hljs-symbol"><span class="hljs-symbol">http_client:</span></span> client) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Capybara.default_driver = <span class="hljs-symbol"><span class="hljs-symbol">:driver</span></span> Capybara.default_selector = <span class="hljs-symbol"><span class="hljs-symbol">:xpath</span></span></code> </pre> </blockquote><br></div></div><br> 另外，这是Firefox的版本控制问题。 <br> 如果您已安装Firefox 46或更低版本，则为了正确运行测试，您需要gem'capybara'版本'2.53.4'或更低版本。 <br><br> 如果Firefox版本高于46，则它会基于“ geckodriver”基于其他原理工作，因此，要正确运行测试，您需要<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">安装geckodriver</a> 。 <br><br><div class="spoiler">  <b class="spoiler_title">为何需要壁虎驱动程序的原因</b> <div class="spoiler_text"> 在47版之前，Firefox自动化驱动程序只是每个客户端附带的扩展。 但是由于策略更改，此扩展名已被删除，该更改现在要求所有扩展名均由Mozilla签名。 <br><br>  Marionette是Firefox附带的新驱动程序。 该驱动程序具有自己的协议，该协议与Selenium / WebDriver协议不兼容。 <br><br>  Geckodriver是实现Selenium / WebDriver协议的应用程序服务器。 他翻译了Selenium命令，并将其重定向到Marionette驱动程序。 <br></div></div><br>  <b>重要的细微差别是</b> ，在安装“ geckodriver”之后，有必要规定系统路径，以便在执行env.rb时找到我们的“ geckodriver”。 <br><br><div class="spoiler">  <b class="spoiler_title">系统路径</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/na/qm/jd/naqmjdhlfa_o9xn8jqax-oqmkfk.jpeg"><br></div></div><br></li><li> 接下来，仅需编写测试即可在Chrome，Firefox和没有浏览器的情况下运行：)。 例如，我们将写一些步骤输入mail.ru邮件 <br><br><div class="spoiler">  <b class="spoiler_title">步骤说明</b> <div class="spoiler_text"><blockquote><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">encoding</span></span>: UTF<span class="hljs-number"><span class="hljs-number">-8</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">language</span></span>: ru Given(/^   "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |page| visit page <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^  "(.*?)"   c id "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |<span class="hljs-type"><span class="hljs-type">text</span></span>, field_id| find("//input[@id='#{field_id}']").<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-type"><span class="hljs-type">text</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^  "(.*?)"     id "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |<span class="hljs-type"><span class="hljs-type">text</span></span>, select_id| find("//select[@id='#{select_id}']/option[text()='#{text}']").click <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^    "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |<span class="hljs-type"><span class="hljs-type">text</span></span>| find("//input[@value='#{text}']").click <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^ (\d+) (?:|)$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |sec| sleep sec.to_i <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> </blockquote><br></div></div><br></li><li> 以及黄瓜测试本身 <br><br><div class="spoiler">  <b class="spoiler_title">测试功能</b> <div class="spoiler_text"><blockquote><pre> <code class="hljs swift"># encoding: <span class="hljs-type"><span class="hljs-type">UTF</span></span>-<span class="hljs-number"><span class="hljs-number">8</span></span> # language: ru :   :       <span class="hljs-string"><span class="hljs-string">"https://mail.ru/"</span></span>    <span class="hljs-string"><span class="hljs-string">"dorian.grey.2019"</span></span>   <span class="hljs-built_in"><span class="hljs-built_in">c</span></span> id <span class="hljs-string"><span class="hljs-string">"mailbox:login"</span></span>    <span class="hljs-string"><span class="hljs-string">"********"</span></span>   <span class="hljs-built_in"><span class="hljs-built_in">c</span></span> id <span class="hljs-string"><span class="hljs-string">"mailbox:password"</span></span>    <span class="hljs-string"><span class="hljs-string">"@inbox.ru"</span></span>     id <span class="hljs-string"><span class="hljs-string">"mailbox:domain"</span></span>      <span class="hljs-string"><span class="hljs-string">""</span></span>   <span class="hljs-number"><span class="hljs-number">5</span></span> </code> </pre> </blockquote><br></div></div><br></li><li> 剩下的只是检查我们的所有努力并享受UI测试的成功运行（在测试的示例1中）：）。 剩下的最后一个设置是测试运行设置。 转到菜单RubyMine-&gt;编辑配置-&gt; Runner选项-在这里我们只选择驱动程序:) <br>  env.rb中的ENV ['DRIVER']，这是启动设置。 我们只需要在“运行程序选项”中指定“ DRIVER = firefox”或“ DRIVER = chrome”。 <br></li></ol><br> 我们启动 <br><br><img src="https://habrastorage.org/webt/fy/dg/7i/fydg7ieltbsbgugy2teio6e6btu.jpeg"><br><br> 仅此而已，成功的黄瓜测试为您服务！ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN423123/">https://habr.com/ru/post/zh-CN423123/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN423109/index.html">苹果介绍了什么以及iOS开发人员对此有何看法</a></li>
<li><a href="../zh-CN423115/index.html">CSS背景图层混合模式改善了效果</a></li>
<li><a href="../zh-CN423117/index.html">寿命更长或年龄增长更慢：一种技术手段来延年益寿</a></li>
<li><a href="../zh-CN423119/index.html">DIY TTL街机机...在2018年</a></li>
<li><a href="../zh-CN423121/index.html">低级脑操</a></li>
<li><a href="../zh-CN423125/index.html">地理共享应用</a></li>
<li><a href="../zh-CN423127/index.html">冥王星被认为是行星</a></li>
<li><a href="../zh-CN423129/index.html">妨碍您学习英语的神话和借口</a></li>
<li><a href="../zh-CN423131/index.html">TL； Richard Hamming撰写的《科学与工程的艺术》一书的博士</a></li>
<li><a href="../zh-CN423133/index.html">主动界面：重新设计Google自杀搜索页面</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>