<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♉️ 😑 🌨️ Sistem penyiraman otomatis pabrik lainnya menggunakan ESP8266 dan Blynk 📮 👃🏿 👨🏼‍🤝‍👨🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Suatu ketika, ketika saya bersantai dengan teman-teman di kemah mahasiswa di MEPhI, salah satu dari mereka mengatakan kepada saya bahwa dia baru-baru ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sistem penyiraman otomatis pabrik lainnya menggunakan ESP8266 dan Blynk</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/388589/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suatu ketika, ketika saya bersantai dengan teman-teman di kemah mahasiswa di MEPhI, salah satu dari mereka mengatakan kepada saya bahwa dia baru-baru ini memutuskan untuk mencoba menanam stroberi di sebidang tanah. Saya membeli pot, menggali tanah di suatu tempat, dan membawa selang air. Dan semua akan baik-baik saja, pemiliknya tidur - stroberi tumbuh, tetapi mereka hanya harus pergi ke negara itu secara stabil seminggu sekali atau bahkan lebih sering agar tanaman tidak mengering tanpa air. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Teringat sepasang Arduino yang tergeletak di dalam laci, serta keinginan lama untuk mencapai sesuatu yang lebih dari sekadar LED yang berkedip, saya segera memutuskan untuk mengambil tugas ini dan melakukan kali ini, jika mungkin, sampai akhir.</font></font><br>
<br>
<img src="https://habrastorage.org/files/ffc/8b7/deb/ffc8b7deb2ff4ca893b5493546e9f826.jpg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai antarmuka manajemen sistem, diputuskan untuk memberikan kontrol manual "dari tombol", serta menerapkan kontrol jarak jauh melalui Internet. Arduino Mega dipilih sebagai pengontrol kepala, karena perisai dengan layar LCD dan tombol-tombolnya mudah dihubungkan, dan ia juga memiliki cukup memori dan GPIO untuk tugas ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skema umum sistem: </font></font><br>
<br>
<img src="https://habrastorage.org/files/805/b74/a51/805b74a51ab54684af02c5961b3dfff3.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk berinteraksi dengan jaringan global, motherboard ESP8266, yang secara aktif mendapatkan popularitas, dipilih. Pilihan protokol transfer data nirkabel adalah karena, selain biaya rendah modul Wi-Fi, dengan adanya router Wi-Fi yang terus-menerus ada di dacha pelanggan, yang menghindari menarik koneksi kabel di dalam rumah.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terlepas dari kenyataan bahwa ESP8266 muncul di cakrawala komunitas DIY baru-baru ini, sumber daya pengembang pada chip ini sudah aktif berkembang di RuNet, di mana Anda selalu dapat mencari jawaban untuk pertanyaan Anda, menemukan contoh menghubungkan papan ESP tertentu atau meminta bantuan dengan masalah.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perkiraan proyek</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memantau kelembaban tanah saat ini, sensor standar dengan Ebay dipesan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menampilkan dan memasukkan informasi, diputuskan untuk menggunakan pelindung Keypad LCD, yang merupakan modul elektronik dengan layar LCD dan 6 tombol yang terhubung ke satu input analog. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai alat kontrol untuk pasokan air, keran mekanis 12 volt dengan 2 kabel dipilih, yang penutup-pembukaannya dilakukan dengan mengubah tanda-tanda tegangan yang disediakan. Oleh karena itu, selain keran, modul relai 4-channel telah dipesan (dua relay mengubah polaritas yang disediakan, satu bertanggung jawab untuk memasok tegangan, satu lagi tersisa sebagai cadangan). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai ESP8266 di Ebay, versi paling sederhana dipesan - ESP-01. Hal utama adalah untuk mengingat bahwa ESP8266 ditenagai secara eksklusif dari 3,3 V, yang harus dijaga terlebih dahulu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daftar peralatan yang diperlukan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derek bermotor</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino mega</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modul WiFi (ESP8266)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relay 4 saluran</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensor kelembaban tanah</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layar LCD dengan tombol</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Total biaya (tidak termasuk biaya semua yang diperlukan untuk penyolderan, perakitan, serta catu daya): $ 61,01. </font><font style="vertical-align: inherit;">Kontribusi utama untuk biaya akhir sistem saya dibuat oleh derek bertenaga ($ 23,32) dan resmi Arduino Mega 2560 ($ 26,80).</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fungsionalitas sistem</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah sedikit refleksi, saya memutuskan bahwa sistem penyiraman otomatis harus dapat berfungsi dalam tiga mode berikut:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manual ("dari tombol"). </font><font style="vertical-align: inherit;">Dalam mode ini, pengguna memutuskan waktu mulai irigasi berdasarkan informasi yang diberikan kepadanya dari sensor kelembaban tanah atau berdasarkan pengalaman pribadi;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode terjadwal. </font><font style="vertical-align: inherit;">Pengguna hanya menetapkan parameter irigasi sesuai dengan jadwal (frekuensi, durasi), setelah itu sistem itu sendiri mengairi sesuai dengan pengaturan yang dipilih;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode sensor. </font><font style="vertical-align: inherit;">Penyiraman dilakukan secara otomatis ketika ambang kelembaban yang telah ditentukan tercapai. </font><font style="vertical-align: inherit;">Pengguna hanya perlu mengatur nilai kelembaban ambang dan durasi penyiraman;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remote (dari smartphone atau komputer). </font><font style="vertical-align: inherit;">Ini mencakup kemampuan untuk mengontrol sistem dari jarak jauh menggunakan logika salah satu dari tiga mode yang tercantum di atas.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sulit membayangkan implementasi fungsi seperti itu tanpa menu paling sederhana, navigasi yang akan dilakukan menggunakan tombol perisai LCD-Keypad. </font><font style="vertical-align: inherit;">Anda dapat membaca tentang implementasi menu di Arduino, misalnya, di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blynk</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memikirkan implementasi kendali irigasi jarak jauh, saya menemukan proyek Blynk yang menarik, penggalangan dana untuk implementasi yang </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diluncurkan di Kickstarter pada 16 Januari 2015</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selama satu bulan, proyek tersebut mengumpulkan $ 49.235 dan bukan $ 10.000, yang tampaknya mencerminkan minat besar pada proyek-proyek semacam itu dari komunitas geek global. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tujuan utama Blynk adalah menciptakan platform yang terjangkau untuk kontrol nirkabel perangkat elektronik buatan sendiri dari smartphone. Seperti yang direncanakan oleh penulis, akses Internet bukan prasyarat - Blynk Server dapat diunduh dan digunakan di jaringan rumah Anda, setelah menerima otonomi penuh di rumah Anda.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daftar lengkap platform yang didukung (di antaranya, tentu saja, adalah Arduino, Raspberry PI dan Intel Edison), di mana Blynk direncanakan akan diangkut, ada di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara skematis, prinsip operasi Blynk disajikan dalam gambar berikut: </font></font><br>
<br>
<img src="https://habrastorage.org/files/1f9/7ac/ca3/1f97acca361d4f4ea4f48a78ac433937.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam daftar fitur antarmuka program untuk ponsel cerdas untuk mengendalikan perangkat jarak jauh dan menampilkan informasi yang diterima darinya, berbagai elemen ("widget") diumumkan. </font><font style="vertical-align: inherit;">Kami memilih yang utama:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tombol</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bilah geser</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Joystick monoaxial dan biaksial;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manajemen menggunakan giroskop dan akselerometer telepon;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berbagai macam tombol kontrol;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indikator panah;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemberitahuan munculan.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daftar lengkap item dapat ditemukan di halaman proyek Blynk di Kickstarter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perlu dicatat bahwa proyek ini dalam tahap pengembangan aktif, oleh karena itu, tidak semua fungsi yang dinyatakan oleh pengembang telah dilaksanakan sejauh ini. </font><font style="vertical-align: inherit;">Namun, menurut mereka, ini hanya masalah waktu saja. </font><font style="vertical-align: inherit;">Fungsi yang tersedia untuk proyek kami sudah cukup.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementasi teknis</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diagram skematis perangkat: </font></font><br>
<br>
<img src="https://habrastorage.org/files/4d4/1b7/3f8/4d41b73f802341d7aecc2dd74067e2fc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti dapat dilihat dari diagram yang disajikan, pertukaran informasi antara Arduino dan ESP8266 akan dilakukan melalui UART. </font><font style="vertical-align: inherit;">Agar tidak mengalami masalah saat menginstal controller, kami menghubungkan modul Wi-Fi ke kontak D2, D3, mengatur UART perangkat keras (Serial3) pada kaki-kaki ini dan mengatur kecepatan ke 11520 baud.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pembaca yang penuh perhatian harus memiliki pertanyaan logis - bagaimana Arduino didukung oleh logika 5-volt dan ESP8266 3.3-volt berkomunikasi? </font><font style="vertical-align: inherit;">Setelah mempelajari masalah ini di Internet, saya sampai pada kesimpulan bahwa mayoritas tidak benar-benar mementingkan masalah ini (seperti yang ternyata kemudian - tidak sia-sia) dengan langsung menghubungkan kaki yang sesuai dari dua papan ini. </font><font style="vertical-align: inherit;">Hanya beberapa artikel yang menyarankan penggunaan pembagi tegangan paling sederhana, atau konverter yang dirancang khusus. </font><font style="vertical-align: inherit;">Secara alami, saya tidak memiliki konverter, jadi pada awalnya suatu upaya dilakukan untuk mengimplementasikan komunikasi menggunakan pembagi, tetapi itu tidak mengarah ke hasil apa pun, dan saya bergabung dengan serangkaian masalah penutup mata yang disebutkan sebelumnya (manfaatnya bekerja tanpa koordinasi level logis) .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beberapa kata tentang kekuatan ESP8266</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang telah disebutkan dalam banyak tutorial, untuk operasi normal ESP Anda memerlukan catu daya yang stabil di kisaran 3,0-3,6 volt. </font><font style="vertical-align: inherit;">Untuk melakukan ini, Anda dapat menggunakan berbagai konverter linier, misalnya, AMS1117 3.3 populer saat ini. </font><font style="vertical-align: inherit;">The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datasheet AMS1117</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menunjukkan bahwa tegangan input mungkin sampai 15 V. Namun, untuk operasi yang stabil dari arus keluaran dari modus sekitar 1 A dianjurkan untuk menurunkan tegangan input (dalam praktek cukup 5-6 V). </font><font style="vertical-align: inherit;">Dari pengalaman saya sendiri, saya akan mengatakan bahwa ketika konverter terhubung ke sumber 12 V, AMS mulai memanaskan secara aktif, yang dengan cepat menyebabkan penurunan tegangan output dan, sebagai hasilnya, reboot ESP8266.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurasikan ESP8266</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Interaksi Arduino dan ESP8266 saat menggunakan Blynk dapat diimplementasikan dalam dua cara berbeda:</font></font><br>
<br>
<ul>
<li> «»  ESP8266 AT-,      Arduino (..  «ESP8266 as shield»);</li>
<li>  ESP   Arduino IDE    Blynk,      ,    ,  Arduino      ,      /  (..  «ESP8266 as standalone»).</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kedua opsi memiliki pro dan kontra, tetapi opsi pertama lebih mudah karena tidak perlu bekerja dengan dua program dan terus-menerus memantau kompatibilitas kedua perangkat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengontrol menggunakan Blynk, Anda harus dapat mengunggah firmware yang diinginkan ke ESP8266. Dalam kasus kami, versi AT firmware </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v0.22 SDK v1.0.0</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan digunakan </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mem-flash papan ESP8266, Anda memerlukan konverter USB-TTL (misalnya, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">satu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), namun, Anda juga dapat menggunakan Arduino dengan menutup kaki RST dan GND di atasnya dan menghubungkan modul RX Wi-Fi ke kaki RX Arduino, mirip dengan TX ke TX. Selanjutnya, masukkan ESP8266 ke mode flashing (untuk melakukan ini, tutup output GPIO0 ke ground), dan menggunakan utilitas XTCom Util, isi firmware, seperti dijelaskan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Tetap hanya untuk meningkatkan kecepatan UART menjadi 115200 baud dengan perintah AT AT + UART_DEF = 115200,8,1,0,0, setelah itu konfigurasi modul Wi-Fi akan selesai.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sketsa untuk Arduino</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perpustakaan utama untuk bekerja dengan Blynk di bawah Arduino IDE adalah perpustakaan BlynkSimpleEsp8266.h. Pertimbangkan fungsi utamanya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) Blynk.begin (auth, "ssid", "pass") </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang mungkin sudah Anda duga, fungsi tersebut menerima parameter untuk menghubungkan ke titik Wi-Fi - SSID dan kata sandinya, serta token autent dari perangkat kami untuk terhubung ke server Blynk. </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penting!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Proses menghubungkan ke server Blynk dimulai hanya setelah salah satu dari fungsi berikut dipanggil dalam program untuk pertama kalinya: Blynk.run () atau Blynk.connect ().</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Untuk memutuskan / terhubung ke server Blynk, fungsi Blynk.disconnect () dan Blynk.connect () digunakan, mengembalikan hasilnya dalam tipe boolean. Untuk membuat koneksi (batas waktu dalam detik), Blynk.connect digunakan (secara default, batas waktu diatur ke 30 detik).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) Blynk.run () </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi utama untuk menyinkronkan perangkat dengan server Blynk dan menerima perintah dari telepon pintar. Biasa digunakan dalam satu lingkaran. Selain itu, fungsi ini memungkinkan Anda untuk mengontrol input dan output papan ESP (dalam mode "Standalone") tanpa menggunakan fungsi seperti digitalRead, digitalWrite, analogRead, analogWrite di mana saja dalam kode. Cukup menambahkan elemen yang diperlukan ke layar kontrol dalam aplikasi pada smartphone dan menghubungkannya dengan GPIO ESP8266 yang diperlukan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3) Bekerja dengan kontak virtual ("Pin Virtual")</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satu fitur Blynk adalah penggunaan kontak virtual. Istilah ini mengacu pada saluran logis untuk mentransmisikan berbagai informasi antara aplikasi seluler dan perangkat, baik itu variabel Boolean, nilai numerik (bilangan bulat atau panjang) atau data teks sebagai string. Kontak virtual tidak memiliki koneksi langsung dengan terminal perangkat dan digunakan terutama untuk interaksi dengan perpustakaan modul periferal (LCD, servos, dll.) Atau antarmuka aplikasi seluler.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kode sketsa, memproses panggilan ke kontak virtual dengan nomor n terjadi menggunakan blok BLYNK_READ (Vn) {...} dan BLYNK_WRITE (Vn) {...}. </font><font style="vertical-align: inherit;">Di dalam kurung keriting, kode pemrosesan untuk mengakses kontak virtual ditunjukkan. </font><font style="vertical-align: inherit;">Misalnya, jika widget aplikasi meminta nilai kelembaban tanah untuk tampilan virtual No. 2 untuk ditampilkan sebagai grafik, maka kita perlu menulis sesuatu seperti ini di sketsa:</font></font><br>
<br>
<pre><code class="cpp hljs">BLYNK_READ(V2)<font></font>
{<font></font>
<span class="hljs-comment"><span class="hljs-comment">//     ,    humidity:</span></span>
  Blynk.virtualWrite(<span class="hljs-number"><span class="hljs-number">2</span></span>, humidity);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Demikian pula, Anda dapat mempertimbangkan parameter yang dikirim, misalnya, melalui kontak virtual No. 9 dari pengguna aplikasi Blynk:</font></font><br>
<br>
<pre><code class="cpp hljs">BLYNK_WRITE(V9)<font></font>
{<font></font>
<span class="hljs-comment"><span class="hljs-comment">//      x:</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = param.asInt();<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini menggunakan konversi variabel input ke nilai integer menggunakan param.asInt (). Konversi param.asStr () dan param.asDouble () juga diperbolehkan. </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penting!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Prosedur BLYNK_READ / BLYNK_WRITE harus dijalankan secepat mungkin sehingga perangkat dapat mengatur untuk memproses semua permintaan dari aplikasi. Oleh karena itu, sangat disarankan untuk menggunakan fungsi sllep / delay di dalam rutinitas tersebut.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Informasi lebih rinci tentang fungsi Blynk dapat ditemukan di halaman github pengembang di folder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contoh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau di halaman </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dokumen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang, dengan bekal pengetahuan, mari kembali ke autowatering dan menulis sketsa. Kami akan memberikan kemungkinan berikut untuk aplikasi seluler untuk berinteraksi dengan sistem:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pilihan mode operasi sistem: manual, berdasarkan sensor, berdasarkan jadwal;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampilan kelembaban tanah yang diterima dari sistem dan keluaran data historis;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertukaran informasi melalui elemen aplikasi terminal.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mencoba mengomentari setiap bagian kode yang bertanggung jawab untuk fungsi tertentu dari sistem, jadi kami tidak akan membahas kode program secara terperinci. </font><font style="vertical-align: inherit;">Saya hanya mencatat bahwa untuk kemudahan penggunaan, semua pengaturan yang dibuat oleh pengguna dicatat dalam memori Arduino yang tidak mudah menguap (EEPROM). </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sketsa dapat diunduh di GitHub.</font></font></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menyiapkan aplikasi seluler Blynk</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Langkah terakhir ditinggalkan - mengatur aplikasi seluler. </font><font style="vertical-align: inherit;">Dalam kasus saya, elemen-elemen berikut akan digunakan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 indikator LED (Pin Virtual 1, 29, 30, 31);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 tombol (Pin Virtual 2, 3);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terminal untuk pertukaran informasi (Virtual Pin 4);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indikator numerik "Tampilan Nilai" (Virtual Pin 8);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafik dengan kemampuan untuk menampilkan data historis "Grafik Sejarah" (Virtual Pin 8);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Widget untuk mengaktifkan pekerjaan dengan surat ("Email");</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Widget untuk mengaktifkan notifikasi pop-up ("Push").</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menginstal aplikasi seluler </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blynk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">Anda</font></a><font style="vertical-align: inherit;"> harus mendaftar dan memilih perangkat yang ingin Anda kelola (dalam kasus kami, itu adalah ESP8266). </font><font style="vertical-align: inherit;">Lebih lanjut, agar tidak hilang, kami mengirimkan sendiri token auth unik, yang digunakan dalam sketsa untuk otentikasi pada server Blynk. </font><font style="vertical-align: inherit;">Di bawah ini adalah screenshot yang menggambarkan pengaturan aplikasi.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buat proyek baru</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/281/a53/aa0/281a53aa0ca146e881c9cc3f1dd7feea.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di jendela yang terbuka dari proyek yang dibuat di sudut kanan atas ada 3 tombol: pengaturan proyek global, menambahkan elemen (widget) ke formulir dan meluncurkan:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formulir kosong untuk proyek baru</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/fc7/abf/40c/fc7abf40ca904aaeaff940c7f253c728.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetap menambahkan kontrol ke formulir aplikasi dan mengonfigurasinya. </font><font style="vertical-align: inherit;">Beberapa widget yang tersedia pada saat penulisan disajikan di bawah ini:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daftar widget untuk ditambahkan ke formulir aplikasi</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/e43/d27/9bd/e43d279bd969493e8db442636f980fe3.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengontrol operasi sistem, tambahkan 2 tombol ke formulir: satu akan bertanggung jawab untuk memilih mode operasi, yang kedua - untuk memulai irigasi dalam mode manual. </font><font style="vertical-align: inherit;">Status sistem saat ini akan disusun menggunakan empat indikator LED. </font><font style="vertical-align: inherit;">Satu indikator akan menyala selama irigasi, tiga lainnya diperlukan untuk menampilkan mode saat ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetap memilih warna elemen, menambahkan teks dan mengikatnya ke kontak virtual yang diinginkan.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengkonfigurasi indikator dan tombol LED</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/d0d/356/6bc/d0d3566bc8f74bdc9e9314c71443770e.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menampilkan dinamika kelembaban tanah, tambahkan ke bentuk grafik dengan kemampuan untuk menampilkan data historis ("Grafik Sejarah"). </font><font style="vertical-align: inherit;">Kami akan menampilkan nilai kelembaban saat ini pada tampilan digital ("Value Display").</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahkan Grafik Sejarah dan Elemen Tampilan Nilai</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/290/032/d00/290032d009594489a490e7ad79ef16c3.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk kenyamanan konfigurasi parameter sistem jarak jauh, serta memperoleh informasi yang lebih lengkap tentang keadaan saat ini, kami menambahkan terminal ke aplikasi. </font><font style="vertical-align: inherit;">Dan untuk menerima notifikasi melalui email dan telepon, Anda juga harus menempatkan elemen "Push" dan "Email" pada formulir.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahkan Terminal, Push dan Elemen Email</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/e51/925/ced/e51925ced41e406298873c57bb1ef698.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetap menempatkan pada semua widget yang dijelaskan di atas dan kita akan mendapatkan sesuatu seperti ini:</font></font><br>
<br>
<img src="https://habrastorage.org/files/644/2ce/b5c/6442ceb5c4d04b8fb99632e68e2aa374.jpg"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bawah ini adalah beberapa foto dari sistem dalam keadaan saat ini dan video dari pekerjaan autowatering dan Blynk. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya akan segera memesan bahwa saya tidak menghubungkan keran mekanis di apartemen dan memasok air ke pot bunga, dan tidak ada kebutuhan mendesak - pada saat menguji sistem, proses penyiraman (ketika keran dibuka) berhasil ditiru oleh istri saya dan kaleng penyiraman normal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Foto No. 1: </font></font><br>
<br>
<img src="https://habrastorage.org/files/130/39f/64b/13039f64bd264d478120610771310cf0.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Foto No. 2: </font></font><br>
<br>
<img src="https://habrastorage.org/files/cde/fe9/15a/cdefe915aad142d4a2468d15eff9b6ad.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Video:</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://www.youtube.com/embed/wSNd7GkT-Wc%3Ffeature%3Doembed&amp;usg=ALkJrhjN-YBE4E6zNdrXGzRGoU6vun7dXA" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alih-alih sebuah kesimpulan</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meringkas pembuatan sistem penyiraman otomatis menggunakan Blynk, kita dapat mengatakan yang berikut: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Dengan sendirinya, layanan Blynk adalah alat yang sangat mudah dan mudah dipelajari sehingga, berkat banyaknya papan dan perangkat yang didukung, dapat dengan mudah diintegrasikan ke dalam hampir semua perangkat. Bersama dengan harga rendah dari modul Wi-Fi ESP8266, keunggulan ini memungkinkan Anda untuk menambahkan kontrol jarak jauh ke proyek tertentu dengan sedikit usaha. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kerugian menggunakan solusi seperti itu, tentu saja, adalah kurang fleksibel dalam menyesuaikan sistem untuk diri sendiri dan ketergantungan pada pengembang aplikasi, yang, bagaimanapun, tidak sedikit pun mengurangi manfaatnya ketika digunakan dalam proyek DIY kecil.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Dua kelemahan utama dari penerapan sistem irigasi otomatis di atas adalah biaya dan rendahnya kualitas sensor kelembaban tanah yang digunakan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kerugian pertama disebabkan, seperti yang disebutkan di atas, oleh tingginya biaya keran elektromagnetik dan papan Arduino Mega resmi. Namun, ini dapat dikurangi secara signifikan dengan menggunakan, misalnya, Arduino-analog atau dengan menerapkan seluruh bagian elektronik pada MK lain yang sesuai. Sayangnya, crane tidak dapat ditemukan lebih murah, dan ini bukan tujuan saya.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sedangkan untuk sensor kelembaban, untuk meningkatkan masa pakai dan mengurangi produk-produk elektrolisis di antara kontaknya, pertama-tama, perlu untuk menerapkan tegangan hanya sebelum mengukur kelembaban (yang diterapkan dalam sistem saya), dan kedua, lebih baik untuk mengganti itu baik pada batang grafit, atau menggunakan kontak stainless steel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam waktu dekat ini direncanakan untuk merakit bagian elektronik bersama-sama dan meletakkannya di beberapa bangunan yang layak dan, saya harap, akhirnya menginstal semua yang ada di negara ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terima kasih atas perhatian anda!</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id388589/">https://habr.com/ru/post/id388589/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id388579/index.html">DEXP Ursus KX210i - Tablet Transformer Windows 10 dengan Prosesor Intel® Atom ™</a></li>
<li><a href="../id388581/index.html">Bagaimana saya membuat Snowblower 3.0 dengan kontrol Bluetooth dari smartphone Android</a></li>
<li><a href="../id388583/index.html">Keputusan tentang penghapusan Badan Antariksa Federal ditandatangani</a></li>
<li><a href="../id388585/index.html">Media Penyimpanan Evolusi Bagian 3: Hard Drive</a></li>
<li><a href="../id388587/index.html">Printer Dotwork Homemade Murah</a></li>
<li><a href="../id388591/index.html">Mozilla sedang mempertimbangkan untuk merilis perangkat di Firefox OS daripada smartphone yang baru saja meninggal</a></li>
<li><a href="../id388593/index.html">Netflix telah menemukan cara untuk membuat anak-anak pergi tidur lebih awal pada Malam Tahun Baru</a></li>
<li><a href="../id388595/index.html">Glove-controller dengan pembangkit energi independen untuk bekerja</a></li>
<li><a href="../id388601/index.html">Peristiwa paling signifikan dalam eksplorasi ruang angkasa untuk tahun ini</a></li>
<li><a href="../id388603/index.html">Apa itu robotika pendidikan? Pendapat para ahli dari Komisi Dewan Federasi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>