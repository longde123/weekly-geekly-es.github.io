<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåê üôèüèª ü§πüèæ Obtenga una declaraci√≥n de USRN de Rosreestr usando python, evitando la api üñêüèΩ üí∏ üë®üèΩ‚Äçüé®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No es el primer conocido del portal de Rosreestr 
 Cualquier abogado ha hecho una solicitud a Rosreestr (Servicio Federal de Registro Estatal, Catastr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Obtenga una declaraci√≥n de USRN de Rosreestr usando python, evitando la api</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460040/"><h3>  No es el primer conocido del portal de Rosreestr </h3><br>  Cualquier abogado ha hecho una solicitud a Rosreestr (Servicio Federal de Registro Estatal, Catastro y Cartograf√≠a).  Los momentos en que para una solicitud era necesario correr a la sucursal de Rosreestr y presentar una solicitud en papel son cosa del pasado.  Rosreestr ha lanzado varios servicios en l√≠nea que puede usar sin salir de su hogar.  Estos servicios incluyen una solicitud de extracto del Registro Estatal Unificado de Bienes Ra√≠ces.  Sitio oficial para comenzar. <br><br>  Todos los que ya han logrado trabajar con el sitio saben que para recibir un extracto de la USRN, que contendr√° informaci√≥n no solo sobre las caracter√≠sticas generales de la instalaci√≥n, sino tambi√©n sobre el titular de los derechos de autor de esta instalaci√≥n, es necesario ir a la cuenta personal de Rosreestr. <br><br>  Quiz√°s esta sea una manera conveniente de obtener una o m√°s declaraciones.  Sin embargo, ¬øqu√© hacer si necesita un paquete de extractos de USRN?  Suponga que trabaja con bienes inmuebles o que posee una cantidad de objetos, cuyo n√∫mero total es m√°s de 10. Como regla general, debe recibir un extracto de la USRN al menos 1 vez al a√±o para poder responder r√°pidamente en el plano legal a cambios indeseables en el Registro Federal si ocurren adem√°s del suyo. la voluntad <br><br><a name="habracut"></a><br>  Puede enviar solicitudes manualmente a trav√©s de su cuenta personal, o puede usar la API de Rosreestr.  La primera opci√≥n es extremadamente agotadora.  Adem√°s del hecho de que el servicio en l√≠nea de Rosreestra funciona muy lentamente con bloqueos constantes, el usuario com√∫n tambi√©n est√° invitado a enviar un arsenal de campos para cada objeto cuando env√≠e cada solicitud.  Por ejemplo, una solicitud de una parcela de tierra: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/u9/tg/mm/u9tgmm4q3jkkaxgzabu9ktaf3_a.jpeg"></div><br>  Es decir, para encontrar informaci√≥n sobre el objeto y obtener un extracto f√≠sico.  ¬°la persona ya debe conocer todas las caracter√≠sticas del objeto!  Y cada vez que solicite informaci√≥n, debe completar todos los campos.  Qu√© decir es muy inconveniente.  Gracias por al menos proporcionar que la tierra se puede medir en mil√≠metros cuadrados. <br><br>  La segunda opci√≥n para obtener extractos de la USRN es la API de Rosreestr.  Api es un conjunto de instrucciones del programa, seg√∫n el cual su parte de software y parte de Rosreestr intercambian informaci√≥n sin su participaci√≥n.  Una cosa conveniente si todo funciona correctamente.  Y uno podr√≠a terminar. <br><br>  Sin embargo, si mira la p√°gina donde Rosreestr explica c√≥mo implementar una API conveniente, se siente inc√≥modo. <br><br>  Aqu√≠ se publica un documento con una descripci√≥n: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">rosreestr.ru/wps/portal/cc_ib_documents?documentId=1521</a> <br><br>  Solo toma 19 p√°ginas, pero est√° escrito en lenguaje t√©cnico y sugiere que no podemos prescindir de una firma digital.  En general, durante mucho tiempo, es incomprensible e inconveniente.  Vamos por un camino m√°s corto. <br><br>  Cuando trabajamos con el sitio colgante de Rosreestr, necesitamos comprender una herramienta de Python como las expectativas.  La herramienta m√°s adecuada para trabajar con este sitio, al menos en la etapa actual de desarrollo de este servicio Rosreestra. <br><br>  Cuando una p√°gina se carga lentamente cargada en un navegador, los elementos en esta p√°gina pueden aparecer en diferentes intervalos de tiempo (o no aparecer en absoluto).  Esto dificulta la b√∫squeda de elementos; peri√≥dicamente se genera una excepci√≥n ElementNotVisibleException o NoSuchElement.  Usando expectativas, podemos resolver este problema. <br><br>  La espera proporciona un cierto intervalo de tiempo entre las acciones realizadas: la b√∫squeda de un elemento o cualquier otra operaci√≥n con el elemento. <br><br>  Como utilizamos el m√≥dulo de selenio en nuestro trabajo, trabajaremos con lo que ofrece.  Selenium ofrece dos tipos de expectativas: impl√≠citas y expl√≠citas. <br><br>  La espera expl√≠cita es el c√≥digo mediante el cual determina qu√© condici√≥n debe ocurrir para que se ejecute m√°s c√≥digo.  Anteriormente usamos time.sleep (), que establece el tiempo de espera exacto.  Pero esta opci√≥n no es del todo exitosa.  La desventaja es que si no adivina el tiempo de inactividad (suspensi√≥n), el programa se bloquear√°.  Existen m√©todos m√°s convenientes que pueden ayudarlo a escribir c√≥digo que espera todo lo que necesita. <br><br><h3>  Estamos escribiendo un programa para trabajar con Rosreestr en l√≠nea. </h3><br>  Pasemos a nuestro programa. <br><br>  Su esencia es que al ingresar al sitio web de Rosreestr, ella inicia sesi√≥n a trav√©s de la cuenta personal de una persona f√≠sica.  personas y adem√°s comenzaron a presentar de forma independiente solicitudes de extractos de la USRN.  Nuestro programa recibir√° datos para solicitudes de un archivo de Excel (d√≥nde estar√≠a sin √©l).  Una advertencia.  Al enviar una solicitud, el sitio web de Rosreestr tiene un campo con la direcci√≥n del objeto.  Habr√° dificultades con √©l, ya que las direcciones en Rosreestr se abren de una manera especial.  Esto deber√° tenerse en cuenta en el programa. <br><br>  Empecemos <br><br>  Antes de comenzar, prepare una tabla de Excel con los datos de origen en el siguiente formato: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3r/l4/v6/3rl4v6quswpmwbrzd-23pb6uk2o.jpeg"></div><br>  N√∫mero-nombre del titular del copyright-direcci√≥n de la propiedad-tipo de propiedad-n√∫mero catastral-√°rea.  Previa solicitud, necesitaremos todos los campos de la tabla, excepto "n√∫mero" y "nombre del titular de los derechos de autor". <br><br>  Ahora cree un nuevo archivo de Python: rosreestr.py.  E importamos los m√≥dulos necesarios: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> webbrowser,time <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> selenium <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> webdriver <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> csv <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> selenium.webdriver.common.keys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Keys <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> selenium.common.exceptions <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> NoSuchElementException <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> openpyxl</code> </pre> <br>  Abra el archivo de Excel con datos sobre bienes inmuebles: <br><br><pre> <code class="python hljs">wb = openpyxl.load_workbook(<span class="hljs-string"><span class="hljs-string">'activ2.xlsx'</span></span>) sheet=wb.get_active_sheet()</code> </pre> <br>  Vamos a la p√°gina web de Rosreestr.  Dado que la entrada al sitio en s√≠ ya puede estar retrasada, debe establecer una expectativa: <br><br><pre> <code class="python hljs">browser = webdriver.Firefox() browser.get (<span class="hljs-string"><span class="hljs-string">'https://rosreestr.ru/'</span></span>) time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre> <br>  Aqu√≠ puedes dejar solo el tiempo. Duerme 5 segundos.  Pero mejor, usando las expectativas, escriba as√≠: <br><br><pre> <code class="python hljs">browser.implicitly_wait(<span class="hljs-number"><span class="hljs-number">40</span></span>)</code> </pre> <br>  Ahora debemos esperar a que aparezca el bot√≥n en su cuenta personal y hacer clic en √©l: <br><br><pre> <code class="python hljs">act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'#top_panel &gt; a:nth-child(4)'</span></span>) act.click()</code> </pre><br>  Dado que el registro en su cuenta personal se realiza a trav√©s del portal de Servicios del Estado, el sitio redirige a los servicios del Estado y esto tambi√©n ocurre con retraso, considere esto: <br><br><pre> <code class="python hljs">browser.implicitly_wait(<span class="hljs-number"><span class="hljs-number">40</span></span>) act = browser.find_element_by_id(<span class="hljs-string"><span class="hljs-string">'mobileOrEmail'</span></span>) act.click()</code> </pre> <br>  Ahora el programa nos autorizar√° en el sitio web del Servicio Estatal ingresando un nombre de usuario y contrase√±a (en lugar de un nombre de usuario y contrase√±a, ingrese sus datos): <br><br><pre> <code class="python hljs">i=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">'@mail.ru'</span></span>: act.send_keys(i) time.sleep (<span class="hljs-number"><span class="hljs-number">0.1</span></span>) act = browser.find_element_by_id(<span class="hljs-string"><span class="hljs-string">'password'</span></span>) act.click() i=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>: act.send_keys(i) time.sleep (<span class="hljs-number"><span class="hljs-number">0.1</span></span>) act = browser.find_element_by_id(<span class="hljs-string"><span class="hljs-string">'loginByPwdButton'</span></span>) act.click()</code> </pre> <br>  Despu√©s de que el programa ha presionado el bot√≥n enter, la siguiente ventana puede aparecer antes de la autorizaci√≥n: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rj/sd/o5/rjsdo5yqe7qqf0-92ihgbii99mm.jpeg"></div><br><br>  Aqu√≠ debe seleccionar el selector CSS nat.  caras  ¬øRecuerdas c√≥mo hacerlo?  Haga clic derecho en el icono Persona privada ... - explore el elemento: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mb/k9/y2/mbk9y2jai48t7h7cbwo5m-pzqzw.jpeg"></div><br><br>  Y copie el selector CSS: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ow/x8/5c/owx85cjb9x2sptrqhuxbmkxw-5a.jpeg"></div><br><br>  Lo agregaremos a nuestro programa: <br><br><pre> <code class="python hljs">act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'tr.not-border:nth-child(1) &gt; td:nth-child(2) &gt; div:nth-child(2)'</span></span>) act.click()</code> </pre> <br>  Ahora que hemos iniciado sesi√≥n, el navegador nos redirigir√° desde el sitio web de los Servicios del Estado al sitio web de Rosreestr.  All√≠, nuestro programa debe hacer clic en el elemento "Solicitud de informaci√≥n sobre bienes inmuebles y (o) sus propietarios": <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lo/v5/o6/lov5o6q89bkbtsywd2y6farnrae.jpeg"></div><br><br>  Ingresaremos el c√≥digo apropiado: <br><br><pre> <code class="python hljs">act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'div.services-item:nth-child(5) &gt; div:nth-child(1) &gt; span:nth-child(2)'</span></span>) act.click() act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'div.services-item:nth-child(5) &gt; table:nth-child(2) &gt; tbody:nth-child(1) &gt; tr:nth-child(2) &gt; td:nth-child(2) &gt; a:nth-child(1)'</span></span>) act.click()</code> </pre> <br>  Llegamos a la p√°gina de inicio de env√≠o de una solicitud, donde se esperan 5 pasos de nosotros: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/41/gk/m_/41gkm_5njcfbvg51unp52ezdqnc.jpeg"></div><br><br>  Para ir al segundo paso, debe verificar la p√°gina y hacer clic en siguiente.  Denota esto en c√≥digo: <br><br><pre> <code class="python hljs">act = browser.find_element_by_class_name(<span class="hljs-string"><span class="hljs-string">'PGU-LabelIcon'</span></span>) act.click() act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'#__nextStep'</span></span>) act.click()</code> </pre><br>  Estamos en el segundo paso del sitio web de Rosreestr.  Aqu√≠ es necesario completar la categor√≠a de campo del solicitante, todos los dem√°s datos se obtienen autom√°ticamente del servicio p√∫blico.  Luego haga clic en "Siguiente": <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/no/tc/km/notckmfto_dccwi-qqtb1zgps9u.jpeg"></div><br><br>  En c√≥digo, se ve as√≠: <br><br><pre> <code class="python hljs">act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'#Form7\.step2\.specialDeclarantKind\.code &gt; div:nth-child(2) &gt; div:nth-child(1)'</span></span>) act.click() act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(2)'</span></span>) act.click() act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'#__nextStep'</span></span>) act.click()</code> </pre> <br>  Si ejecutamos nuestro programa, lo m√°s probable es que recibamos un error: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gs/xc/gv/gsxcgvd0p65--6yjfg_4v-4jscy.jpeg"></div><br><br>  Manejamos este error de la siguiente manera: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: act = browser.find_element_by_class_name(<span class="hljs-string"><span class="hljs-string">'PGU-LabelIcon'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: browser.refresh() time.sleep (<span class="hljs-number"><span class="hljs-number">40</span></span>) act = browser.find_element_by_class_name(<span class="hljs-string"><span class="hljs-string">'PGU-LabelIcon'</span></span>)</code> </pre> <br>  Ahora, si surge una situaci√≥n en la que la p√°gina no se carga, el programa actualizar√° el navegador e intentar√° nuevamente hacer clic en el icono deseado.  Desafortunadamente, las expectativas no funcionan aqu√≠, y debe usar el viejo y probado time.sleep (). <br><br>  Estamos en el tercer paso y es el m√°s laborioso: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ef/bp/gy/efbpgyhkkjfjhl3djkt4_firx4y.jpeg"></div><br><br>  Es necesario completar todos los campos con el signo "*". <br><br>  Comencemos ingresando el objeto: <br><br><pre> <code class="python hljs">n=<span class="hljs-number"><span class="hljs-number">1</span></span> i=sheet[<span class="hljs-string"><span class="hljs-string">'B'</span></span>+str(n)].value <span class="hljs-comment"><span class="hljs-comment">#i=input(". 1- .2-.3-.4-.5- : ") if i==' ': #1- act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectTypeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(2)') act.click() #  act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.area &gt; div:nth-child(1) &gt; div:nth-child(4) &gt; div:nth-child(1) &gt; div:nth-child(2) &gt; input:nth-child(1)') act.click() for i in str(sheet['E'+str(n)].value): act.send_keys(i) time.sleep (0.1) act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.area\.unit &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(2)') act.click() elif i=='': #2- act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectTypeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(3)') act.click() act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectPurposeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(2)') act.click() elif i=='': #3- act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectTypeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(4)') act.click() act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.roomPurposeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(3)') act.click() elif i=='': #4- act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectTypeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(5)') act.click() elif i==' ': #5-  act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectTypeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(6)') act.click()</span></span></code> </pre><br>  Aqu√≠ comenzamos con una celda en Excel, donde tenemos escrito el nombre del objeto.  Si, por ejemplo, se ingresa "Terreno" en la celda, entonces el programa selecciona el elemento apropiado usando el selector css.  Todo sucede tambi√©n con otros tipos de objetos en la celda: el programa los procesa. <br><br>  A continuaci√≥n, hacemos clic en los selectores css del n√∫mero catastral, el tipo de declaraci√≥n y la direcci√≥n de los objetos, estos selectores son los mismos para todos los objetos: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  -   excel  act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180 &gt; div:nth-child(1) &gt; div:nth-child(4) &gt; div:nth-child(6) &gt; div:nth-child(2) &gt; input:nth-child(1)') act.click() for i in sheet['C'+str(n)].value: act.send_keys(i) time.sleep (0.1) time.sleep(2) #  act = browser.find_element_by_css_selector('#Form7\.step3\.extractDataRequestType1 &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(2)') act.click() #   act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.addressesList\[0\]\.address &gt; div:nth-child(2) &gt; div:nth-child(2) &gt; a:nth-child(1) &gt; span:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.fias_input_search') act.click()</span></span></code> </pre><br>  Ahora necesita conducir la direcci√≥n: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sheet[<span class="hljs-string"><span class="hljs-string">'D'</span></span>+str(n)].value: act.send_keys(i) time.sleep (<span class="hljs-number"><span class="hljs-number">0.1</span></span>) print(sheet[<span class="hljs-string"><span class="hljs-string">'D'</span></span>+str(n)].value) i=input(<span class="hljs-string"><span class="hljs-string">" eneter            enter: "</span></span>) act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'a.button-custom:nth-child(2)'</span></span>) act.click()</code> </pre><br>  La direcci√≥n se toma de la columna C de la tabla de Excel.  Hay una pausa en forma de reactivaci√≥n de las acciones del usuario.  Esto se debe al hecho de que la direcci√≥n en Rosreestr puede diferir de la direcci√≥n que tiene y lo m√°s probable es que sea.  Por lo tanto, el programa, al ingresar la direcci√≥n de la tabla en el sitio, esperar√° que el usuario presione enter en el int√©rprete para continuar. <br><br>  Los pasos restantes en el portal de Rosreestr son los menos notables, all√≠ el programa simplemente hace clic en los botones del portal "Siguiente" y env√≠a la solicitud al Rosreestr: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  act = browser.find_element_by_css_selector('#__nextStep &gt; span:nth-child(1)') act.click() #   ,     act = browser.find_element_by_css_selector('#__nextStep &gt; span:nth-child(1)') act.click() time.sleep (1) # ,    act = browser.find_element_by_css_selector('#__nextStep &gt; span:nth-child(1)') act.click()</span></span></code> </pre><br>  Al final del programa, agregue una actualizaci√≥n del navegador: <br><br><pre> <code class="python hljs">browser.refresh() time.sleep (<span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre><br>  Si el programa funcion√≥ correctamente, solo queda comenzar un ciclo a trav√©s de todas las celdas con objetos en nuestro archivo de Excel.  Para hacer esto, agregue al comienzo del bloque antes de <code>i=sheet['B'+str(n)].value</code> : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> n&lt;<span class="hljs-number"><span class="hljs-number">36</span></span>:</code> </pre><br>  y al final: <code>n+=1</code> , donde n es el n√∫mero de bienes inmuebles en la tabla de Excel. <br><br>  El texto completo del programa se puede ver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/460040/">https://habr.com/ru/post/460040/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460022/index.html">PHP Digest No. 160 (del 1 al 15 de julio de 2019)</a></li>
<li><a href="../460028/index.html">Resoluci√≥n de problemas con pwnable.kr 04 - flag. Archivos ejecutables empaquetados</a></li>
<li><a href="../460030/index.html">Desarrollo nativo, React Native y Flutter: criterios de selecci√≥n</a></li>
<li><a href="../460036/index.html">Habilidad B2B de Alice: del prototipo al primer rublo guardado</a></li>
<li><a href="../460038/index.html">Generaci√≥n de mazmorras en Diablo 1</a></li>
<li><a href="../460044/index.html">Control de temperatura del calentador del horno, con temporizador en Arduino</a></li>
<li><a href="../460046/index.html">Comparaci√≥n del marco Python BDD: Pros y contras</a></li>
<li><a href="../460048/index.html">C√≥mo construimos la gesti√≥n de vulnerabilidades</a></li>
<li><a href="../460050/index.html">NeoQUEST 2019 cara a cara: en el mundo de la ciberseguridad</a></li>
<li><a href="../460052/index.html">Interacci√≥n de las soluciones de Cisco en GosSOPKoy y FinCERT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>