<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฒ๐ป ๐ ๐ ุฎุฏูุงุช ุฃูุงุฒูู ููุงูุฏ ูุชุญููู ูุญูุธุฉ ุงูุงุณุชุซูุงุฑ ๐๐พ ๐ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุงูุขููุฉ ุงูุฃุฎูุฑุฉ ุ ูุงู ููุงู ุชููุจ ูุจูุฑ ูู ุฃุณูุงู ุงูุฃุณูู ุ ุนูุฏูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุฏ ุชููุฏ ูุฑูุฉ ูุณุชูุฑุฉ ูุดุฑูุฉ ูุนุฑููุฉ ุฌูุฏูุง ุนุฏุฉ ูู ุงููุงุฆุฉ ูู ููุช ูุงุญุฏ ุจุณ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฎุฏูุงุช ุฃูุงุฒูู ููุงูุฏ ูุชุญููู ูุญูุธุฉ ุงูุงุณุชุซูุงุฑ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426027/" style=";text-align:right;direction:rtl">  ูู ุงูุขููุฉ ุงูุฃุฎูุฑุฉ ุ ูุงู ููุงู ุชููุจ ูุจูุฑ ูู ุฃุณูุงู ุงูุฃุณูู ุ ุนูุฏูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุฏ ุชููุฏ ูุฑูุฉ ูุณุชูุฑุฉ ูุดุฑูุฉ ูุนุฑููุฉ ุฌูุฏูุง ุนุฏุฉ ูู ุงููุงุฆุฉ ูู ููุช ูุงุญุฏ ุจุณุจุจ ุฃูุจุงุก ุงูุนููุจุงุช ุถุฏ ุฅุฏุงุฑุชูุง ุฃู ุงูุนูุณ ุจุงูุนูุณ ุฅูู ุงูุณูุงุก ุนูู ุชูุฑูุฑ ุฅูุฌุงุจู ูุชููุนุงุช ุงููุณุชุซูุฑูู ุจุดุฃู ุฃุฑุจุงุญ ูุฑุจุญุฉ ููุบุงูุฉ. <br><br>  ููู ูููู ุชุญุฏูุฏ ูุง ุฅุฐุง ูุงูุช ููููุฉ ูุฑูุฉ ูุงููุฉ ูุนููุฉ ูุฏ ุฌูุจุช ุฏุฎูุงู ุฃู ุฎุณุฑุช ููุท ูุฎูุจุฉ ุฃููุ <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/q3/2q/zs/q32qzs8fmzzpilpnbmfcek6l57a.png"></div>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">(ุงููุตุฏุฑ)</a> <br><br>  ูู ูุฐู ุงูููุงูุฉ ุณุฃุฎุจุฑู ุจููููุฉ ุชุญุฏูุฏ ูุชุตูุฑ ุงููุชูุฌุฉ ุงููุงููุฉ ุงููุนุฏูุฉ ููุฃูุฑุงู ุงููุงููุฉ. <br><br>  ุจุงุณุชุฎุฏุงู ูุซุงู ุชูุงุฑูุฑ ุงููุณูุท ุงูุงูุชุชุงุญู ููุนููู ุ ุณููุธุฑ ูู ุชุญููู ูุฏูุฌ ุชูุงุฑูุฑ ุงููุณุงุทุฉ ูุณูู ุงูุฃูุฑุงู ุงููุงููุฉ ุ ูุจูุงุก ุจููุฉ ูุธุงู ุงูุชูุงุฑูุฑ ุงูุณุญุงุจูุฉ ูุน ุงูุชุญููู ุงููุงุญู ุงูุจุณูุท ูุงููุฑูุญ ูู AWS Quicksight. <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ูุตู ุงููููุฉ </h2><br>  ุชุฎุจุฑูุง ุงูุนุฏูุฏ ูู ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ ูุงูุฏุฑูุณ ุงูุชุนููููุฉ ุนู ุงูุญุงุฌุฉ ุฅูู ุฏูุชุฑ ููููุงุช ุงููุชุฏุงูู ุ ุญูุซ ูุชู ุชุณุฌูู ุฌููุน ูุนููุงุช ุงููุนุงููุงุช ููุฒูุฏ ูู ุงูุชุญููู ูุชูุฎูุต ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุฏุงูู.  ุฃูุงูู ุนูู ุฃู ูุฐุง ุงูููุฌ ููุนูู ูู ุงูุจูุฑุตุฉ ูุณูุญ ูู ุจุชุฃุฏูุจ ุชุงุฌุฑ ุ ูุฒูุงุฏุฉ ูุนูู ุ ูููู ูููู ุฃูุถูุง ุฃู ูุชุนุจู ูู ุนูููุฉ ุดุงูุฉ. <br><br>  ุฃุนุชุฑู ุฃูู ูู ุงูุจุฏุงูุฉ ุญุงููุช ุจุนูุงูุฉ ุงุชุจุงุน ูุตูุญุฉ ููููุงุช ุ ูุชุจุช ุจุฏูุฉ ูู ูุนุงููุฉ ูุน ูุนููุงุชูุง ูู ุฌุฏูู Excel ุ ูููุช ุจุจูุงุก ุจุนุถ ุงูุชูุงุฑูุฑ ุ ูุงูุฑุณูู ุงูุจูุงููุฉ ุงูููุฌุฒุฉ ุ ูุงููุนุงููุงุช ุงููุณุชูุจููุฉ ุงููุฎุทุท ููุง ุ ูููู ... ุณุฆูุช ูู ูู ุฐูู ุจุณุฑุนุฉ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุงุฐุง ูุนุฏ ุงูุงุญุชูุงุธ ุจูุฌูุฉ ุงูุชุงุฌุฑ ุฃูุฑูุง ุบูุฑ ูุฑูุญ ูุฏูููุงุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุก ูุฏูู ูููุฌูุฉ (ุญุชู ุจุงุณุชุฎุฏุงู ุงูุฃุชูุชุฉ ุงูุฌุฒุฆูุฉ ุ ูู ุดูู ุชูุฑูุบ ุงููุนุงููุงุช ุงูููููุฉ ูู ููุตุฉ ุงูุชุฏุงูู) ุจุณุฑุนุฉ ุงูุฅุทุงุฑุงุช ุ </li><li style=";text-align:right;direction:rtl">  ููุงู ุฎุทุฑ ูุจูุฑ ูุญุฏูุซ ุฎุทุฃ ุฃู ุฎุทุฃ ูุทุจุนู ูุน ุฅุฏุฎุงู ูุฏูู ุ </li><li style=";text-align:right;direction:rtl">  ูุฏ ูุญุฏุซ ุฃู ูุตุจุญ ุงูุชุงุฌุฑ ุงููุดุท ูุณุชุซูุฑูุง ุณูุจููุง ููุนูุฏ ุฅูู ูุฐู ุงููุฌูุฉ ุฃูู ูุฃูู ุ ุซู ููุณู ุชูุงููุง ุฐูู (ุญุงูุชู) ุ  ุฌูุฏ ูุฃุฎูุฑูุง </li><li style=";text-align:right;direction:rtl">  ูููููุง ุงูุจุฑูุฌุฉ ุ ูููุงุฐุง ูุง ูุณุชููุฏ ูู ูุฐุง ูุฃุชูุช ุงูุนูููุฉ ุจุฑูุชูุงุ  ูุฐุง ุ ุฏุนูุง ูุฐูุจ! </li></ul></div></div><br>  ุบุงูุจูุง ูุง ุชููู ุดุฑูุงุช ุงูุณูุณุฑุฉ ุนุจุงุฑุฉ ุนู ูุคุณุณุงุช ุฐุงุช ุชูููุฉ ุนุงููุฉ ุชููุฑ ูุนููุงุฆูุง ุชุญูููุงุช ุนุงููุฉ ุงูุฌูุฏุฉ ุฅูู ุญุฏ ูุง ุจุดุฃู ุฌููุน ุงููุถุงูุง ุงููููุฉ ุชูุฑูุจูุง.  ูู ุงูุฅูุตุงู ุงูููู ุฅู ูุฐุง ุงูุชูุฑูุฑ ูุชุญุณู ุจุดูู ุฃูุถู ูุน ูู ุชุญุฏูุซ ุ ูููู ุญุชู ุฃูุซุฑูุง ุชูุฏููุง ูุฏ ูุง ูููู ูุฏูู ุงูุชุฎุตูุต ูุงูุฏูุฌ ุงูุฐู ูุฑูุฏ ุงูุนููุงุก ุงููุชุทูุจูู ูุงููุถูููู ุฑุคูุชู. <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ูุชูุญ ูู ูุชุญ ูุณูุท ูุชููู ุชูุงุฑูุฑ ุงูุณูุณุฑุฉ ุจุชูุณูู XML ูู ุญุณุงุจู ุงูุดุฎุตู ุ ูููู ุฅุฐุง ูุงู ูุฏูู IIA ูุญุณุงุจ ูุณุงุทุฉ ุนุงุฏู ูู ุจูุฑุตุฉ ููุณูู (MOEX) ุ ูุณูููู ูุฐุงู ุชูุฑูุฑุงู ูุฎุชููุงู ุ ูุฅุฐุง ูุงู ูุฏูู ุญุณุงุจ ุขุฎุฑ ูู ุณุงูุช. ุจูุฑุตุฉ ุจุทุฑุณุจูุฑุบ (SPB) ุ ุซู ุชุถูู ุงูุฃููู ูุงูุซุงููุฉ ูุงุญุฏุฉ ุฃุฎุฑู. <br><br>  ูู ุงููุฌููุน ุ ูู ุฃุฌู ุงูุญุตูู ุนูู ุฏูุชุฑ ููููุฉ ููุญุฏ ูููุณุชุซูุฑ ุ ุณูููู ูู ุงูุถุฑูุฑู ูุนุงูุฌุฉ ุซูุงุซุฉ ูููุงุช ุจุชูุณูู XML. <br><br>  ุชุฎุชูู ุงูุชูุงุฑูุฑ ุงููุฐููุฑุฉ ุฃุนูุงู ุนู MOEX ู SPB ุงุฎุชูุงููุง ุทููููุง ูู ุชูุณููุงุชูุง ุ ูุงูุชู ูุฌุจ ุฃู ุชุคุฎุฐ ูู ุงูุงุนุชุจุงุฑ ูู ุนูููุฉ ุชูููุฐ ุฑุณู ุฎุฑุงุฆุท ุงูุจูุงูุงุช. <br><br><h2 style=";text-align:right;direction:rtl">  ุจููุฉ ุงููุธุงู ููุฏ ุงูุชุทููุฑ </h2><br>  ููุถุญ ุงูุฑุณู ุงูุจูุงูู ุฃุฏูุงู ูููุฐุฌ ุงูุนูุงุฑุฉ ูููุธุงู ููุฏ ุงูุชุทููุฑ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/vv/uq/ed/vvuqedfvl-l8tnghx3v6vtujabc.jpeg"></div><br><h2 style=";text-align:right;direction:rtl">  ุชูููุฐ ุงููุญูู </h2><br>  ุณูู ูุชููู ุชูุงุฑูุฑ ุนู ุฌููุน ุงูุญุณุงุจุงุช ุงูุซูุงุซุฉ ูู ุงูุญุณุงุจ ุงูุดุฎุตู ูุฃูุตู ูุชุฑุฉ ููููุฉ (ูููู ุชูุณูููุง ุฅูู ุนุฏุฉ ุชูุงุฑูุฑ ููู ุนุงู) ุ ูุญูุธูุง ุจุชูุณูู XML ููุถุนูุง ูู ูุฌูุฏ ูุงุญุฏ.  ูุจูุงูุงุช ุงุฎุชุจุงุฑ ููุฏุฑุงุณุฉ ุ ุณูุณุชุฎุฏู ูุญูุธุฉ ุนููุงุก ููููุฉ ุ ูููู ูุน ูุนููุงุช ูุฑูุจุฉ ูุฏุฑ ุงูุฅููุงู ูู ุญูุงุฆู ุงูุณูู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/og/ig/xw/ogigxw4yganahuuzbdqecsbqmry.png"></div><br>  ูููุชุฑุถ ุฃู ุงููุณุชุซูุฑ X ููุฏ ุงูุฏุฑุงุณุฉ ูุฏูู ูุญูุธุฉ ุตุบูุฑุฉ ูู ุฎูุณุฉ ุฃูุฑุงู ูุงููุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุณูุญุชูู ุงูุชูุฑูุฑ ุงูุฎุงุต ุจุจูุฑุตุฉ SPB ุนูู ูุฑูุชูู: Apple ู Microsoftุ </li><li style=";text-align:right;direction:rtl">  ูุญุชูู ุชูุฑูุฑ ุจูุฑุตุฉ MOEX (ุงูุณูุณุฑุฉ) ุนูู ูุฑูุฉ ูุงุญุฏุฉ: FGC UESุ </li><li style=";text-align:right;direction:rtl">  ูุญุชูู ุงูุชูุฑูุฑ ูู ุจูุฑุตุฉ MOEX ุนูู ุงุซููู ูู ุงูุฃูุฑุงู ุงููุงููุฉ: MMK ู OFZ 24019 ุ </li></ol><br>  ููููุง ูุฃูุฑุงููุง ุงููุงููุฉ ุงูุฎูุณุฉ ุ ูุฏ ุชููู ููุงู ูุนุงููุงุช ุนูู ุงูุดุฑุงุก / ุงูุจูุน ุ ูุฏูุน ุฃุฑุจุงุญ ุงูุฃุณูู ููุณููุฉ ุ ูุฏ ูุชุบูุฑ ุงูุณุนุฑ ุ ุฅูุฎ.  ูุฑูุฏ ุฃู ูุฑู ุงููุถุน ูู ุงูููุช ุงูุญุงูู ุ ููู: ุงููุชูุฌุฉ ุงููุงููุฉ ุ ูุน ูุฑุงุนุงุฉ ุฌููุน ุงููุฏููุนุงุช ูุงููุนุงููุงุช ูุงููููุฉ ุงูุณูููุฉ ุงูุญุงููุฉ. <br><br>  ูููุง ูุฃุชู ุฏูุฑ Python ุ ููุฑุฃ ุงููุนูููุงุช ูู ุฌููุน ุงูุชูุงุฑูุฑ ูู ุตููู ูุงุญุฏ: <br><br><pre style=";text-align:right;direction:rtl"><code class="python hljs">my_files_list = [join(<span class="hljs-string"><span class="hljs-string">'Data/'</span></span>, f) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> f <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> listdir(<span class="hljs-string"><span class="hljs-string">'Data/'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isfile(join(<span class="hljs-string"><span class="hljs-string">'Data/'</span></span>, f))] my_xml_data = [] <span class="hljs-comment"><span class="hljs-comment">#     for f in my_files_list: tree = ET.parse(f) root = tree.getroot() my_xml_data.append(root)</span></span></code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ููุชุญูููุงุช ุ ูู ุงูุชูุงุฑูุฑ ูุญุชุงุฌ ุฅูู ุนุฏุฉ ููุงูุงุช ุ ููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุงูุน ุงูุฃูุฑุงู ุงููุงููุฉ ูู ุงููุญูุธุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุงูุตููุงุช ุงููุจุฑูุฉ </li><li style=";text-align:right;direction:rtl">  ุงูุนูููุงุช ุบูุฑ ุงูุชุฌุงุฑูุฉ ูุญุฑูุงุช ุงูุญุณุงุจ ุงูุฃุฎุฑู ุ </li><li style=";text-align:right;direction:rtl">  ูุชูุณุท โโุฃุณุนุงุฑ ุงูุตููุงุช ุงูููุชูุญุฉ </li></ul></blockquote>  ูู ุฃุฌู ุฅุนุฏุงุฏ ุงูุนููุฉ ุ ุณูุณุชุฎุฏู ุฃุฑุจุนุฉ ููุงููุณ ููุตู ุงููุฌููุนุงุช ุงููุฐููุฑุฉ ุฃุนูุงู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">dict_stocks = {<span class="hljs-string"><span class="hljs-string">'stock_name'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'account'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'currency'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'current_cost'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'current_cost_rub'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'saldo'</span></span> : []} dict_deals = {<span class="hljs-string"><span class="hljs-string">'stock_name'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'account'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'date_oper'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'type_oper'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'quantity'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'price'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'currency'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'brokerage'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'result'</span></span>: []} dict_flows = {<span class="hljs-string"><span class="hljs-string">'stock_name'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'account'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'date_oper'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'type_oper'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'result'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'currency'</span></span>: []} dict_avg_price = {<span class="hljs-string"><span class="hljs-string">'stock_name'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'account'</span></span>: [], <span class="hljs-string"><span class="hljs-string">'avg_open_price'</span></span> : []}</code> </pre> <br>  ุจุถุน ูููุงุช ุญูู ูุงููุฉ ูุฐู ุงูููุงููุณ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุงููุณ Dict_stocks</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุงููุณ dict_stocks ูุทููุจ ูุชุฎุฒูู ูุนูููุงุช ุนุงูุฉ ุนู ุงููุญูุธุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณู ุงููุฑูุฉ (stock_name) ุ </li><li style=";text-align:right;direction:rtl">  ุงุณู ุงูุญุณุงุจ (SPB ุ MOEX BROK ุ MOEX IIS) (ุงูุญุณุงุจ) ุ </li><li style=";text-align:right;direction:rtl">  ุงูุนููุฉ ุงููุณุชุฎุฏูุฉ ููุชุณููุงุช ุนูู ูุฐู ุงููุฑูุฉ (ุงูุนููุฉ) ุ </li><li style=";text-align:right;direction:rtl">  ุงููููุฉ ุงูุญุงููุฉ (ููุช ุฅูุดุงุก ุงูุชูุฑูุฑ ูู ูุณูุท ูุชุญ ุงูุญุณุงุจ ุงูุดุฎุตู) (current_cost).  ููุง ุฃูุฏ ุฃู ุฃุดูุฑ ุฅูู ุฃูู ุจุงููุณุจุฉ ููุนููุงุก ุงูุฐูู ูุทูุจูู ุงููุซูุฑ ุ ูู ุงููููู ุฅุฌุฑุงุก ุชุญุณููุงุช ุฅุถุงููุฉ ูู ุงููุณุชูุจู ูุงุณุชุฎุฏุงู ุงูุงุณุชูุงู ุงูุฏููุงูููู ูุนุฑุถ ุฃุณุนุงุฑ ุงูุฃูุงู ูู ููุตุฉ ุงูุชุฏุงูู ุฃู ูู ูููุน ุงูุจูุฑุตุฉ ุงูููุงุจูุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุงููููุฉ ุงูุญุงููุฉ ููููุถุน ุงูุฃููู โโูู ููุช ุฅูุดุงุก ุงูุชูุฑูุฑ (current_cost_rub) <br>  ุนูู ุบุฑุงุฑ ุงูุจูุฏ ุฃุนูุงู ุ ููุง ููููู ุฃูุถูุง ุงูุญุตูู ุนูู ุณุนุฑ ุงูุจูู ุงููุฑูุฒู ูู ุงูููุช ุงูุญุงูู ุฃู ุณุนุฑ ุงูุตุฑู ุ ููุง ุชุฑูุฏ. </li><li style=";text-align:right;direction:rtl">  ุงูุฑุตูุฏ ุงูุญุงูู ููุฃูุฑุงู ุงููุงููุฉ (saldo) </li></ul></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุงููุณ dict_deals</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุงููุณ dict_deals ูุทููุจ ูุชุฎุฒูู ุงููุนูููุงุช ุงูุชุงููุฉ ุนู ุงููุนุงููุงุช ุงูููุชููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณู ุงููุฑูุฉ (stock_name) ุ </li><li style=";text-align:right;direction:rtl">  ุงุณู ุงูุญุณุงุจ (SPB ุ MOEX BROK ุ MOEX IIS) (ุงูุญุณุงุจ) ุ </li><li style=";text-align:right;direction:rtl">  ุชุงุฑูุฎ ุงููุนุงููุฉ ุ ุฃู  T0 (date_oper) ุ </li><li style=";text-align:right;direction:rtl">  ููุน ุงูุนูููุฉ (type_oper) ุ </li><li style=";text-align:right;direction:rtl">  ุญุฌู ุงูุฃูุฑุงู ุงููุงููุฉ ุงููุดุงุฑูุฉ ูู ุงููุนุงููุฉ (ุงููููุฉ) ุ </li><li style=";text-align:right;direction:rtl">  ุงูุณุนุฑ ุงูุฐู ููุฐุช ุจู ุงููุนุงููุฉ (ุงูุณุนุฑ) ุ </li><li style=";text-align:right;direction:rtl">  ุงูุนููุฉ ุงูุชู ุชูุช ุจูุง ุงููุนุงููุฉ (ุงูุนููุฉ) ุ </li><li style=";text-align:right;direction:rtl">  ุนูููุฉ ุงูุณูุณุฑุฉ ูู ุงููุนุงููุฉ (ุงููุณุงุทุฉ) ุ </li><li style=";text-align:right;direction:rtl">  ุงููุชูุฌุฉ ุงููุงููุฉ ูููุนุงููุฉ (ุงููุชูุฌุฉ) </li></ul></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุงููุณ Dict_flows</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุนูุณ ูุงููุณ dict_flows ุญุฑูุฉ ุงูุฃููุงู ูู ุญุณุงุจ ุงูุนููู ููุณุชุฎุฏู ูุชุฎุฒูู ุงููุนูููุงุช ุงูุชุงููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณู ุงููุฑูุฉ (stock_name) ุ </li><li style=";text-align:right;direction:rtl">  ุงุณู ุงูุญุณุงุจ (SPB ุ MOEX BROK ุ MOEX IIS) (ุงูุญุณุงุจ) ุ </li><li style=";text-align:right;direction:rtl">  ุชุงุฑูุฎ ุงููุนุงููุฉ ุ ุฃู  T0 (date_oper) ุ </li><li style=";text-align:right;direction:rtl">  ููุน ุงูุนูููุฉ (type_oper).  ูููู ุฃู ูุณุชุบุฑู ุนุฏุฉ ููู: div ุ NKD ุ ุถุฑูุจุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุงูุนููุฉ ุงูุชู ุชูุช ุจูุง ุงููุนุงููุฉ (ุงูุนููุฉ) ุ </li><li style=";text-align:right;direction:rtl">  ุงููุชูุฌุฉ ุงููุงููุฉ ููุนูููุฉ (ุงููุชูุฌุฉ) </li></ul></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุงููุณ dict_avg_price</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ุฅู ูุงููุณ dict_avg_price ุถุฑูุฑู ูููุนูููุงุช ุงููุญุงุณุจูุฉ ุจูุชูุณุท โโุณุนุฑ ุงูุดุฑุงุก ููู ูุฑูุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณู ุงููุฑูุฉ (stock_name) ุ </li><li style=";text-align:right;direction:rtl">  ุงุณู ุงูุญุณุงุจ (SPB ุ MOEX BROK ุ MOEX IIS) (ุงูุญุณุงุจ) ุ </li><li style=";text-align:right;direction:rtl">  ูุชูุณุท โโุณุนุฑ ุงูุตููุฉ ุงูููุชูุญุฉ (avg_open_price) </li></ul></div></div><br>  ูุนุงูุฌ ูุฌููุนุฉ ูู ูุณุชูุฏุงุช XML ููููุฃ ูุฐู ุงูููุงููุณ ุจุงูุจูุงูุงุช ุงูููุงุณุจุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       for XMLdata in my_xml_data: #      exchange_name = 'SPB' if XMLdata.get('board_list') == ' ' else 'MOEX' client_code = XMLdata.get('client_code') account_name = get_account_name(exchange_name, client_code) #   current_position, deals, flows, stock_name, \ saldo, ticketdate, price, brokerage, \ operationdate, currency, \ current_cost, current_cost_rub, \ stock_name_deal, payment_currency, currency_flows = get_allias(exchange_name) #      get_briefcase(XMLdata) df_stocks = pd.DataFrame(dict_stocks) df_stocks.set_index("stock_name", drop = False, inplace = True) #    get_deals(XMLdata) df_deals = pd.DataFrame(dict_deals) df_avg = pd.DataFrame(dict_avg_price) #       get_nontrade_operation(XMLdata) df_flows = pd.DataFrame(dict_flows)</span></span></code> </pre> <br>  ูู ุงููุนุงูุฌุฉ ุชูุฑ ุนุจุฑ ุงูุญููุฉ ุนุจุฑ ุฌููุน ุจูุงูุงุช XML ูู ุงูุชูุงุฑูุฑ.  ูุนูููุงุช ุญูู ููุตุฉ ุงูุชุฏุงูู ุ ุฑูุฒ ุงูุนููู ูู ููุณู ูู ุฌููุน ุงูุชูุงุฑูุฑ ุ ูุฐูู ููููู ุงุณุชุฎุฑุงุฌูุง ุจุฃูุงู ูู ููุณ ุงูุนูุงูุงุช ุฏูู ุงุณุชุฎุฏุงู ุงูุฎุฑุงุฆุท. <br><br>  ูููู ูุฌุจ ุนูููุง ุจุนุฏ ุฐูู ุงุณุชุฎุฏุงู ุชุตููู ุฎุงุต ูููุฑ ุงูุงุณู ุงููุณุชุนุงุฑ ุงูุถุฑูุฑู ููุนูุงูุฉ ุงุณุชูุงุฏูุง ุฅูู ุงูุชูุฑูุฑ (SPB ุฃู MOEX) ุ ูุฃู  ุงูุจูุงูุงุช ุฐุงุช ุงูุทุจูุนุฉ ุงููุชุทุงุจูุฉ ูู ูุฐู ุงูุชูุงุฑูุฑ ุชุณูู ุจุดูู ูุฎุชูู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุชูุงูุถุงุช ูู ุงูุนูุงูุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชููู ุนูููุฉ ูุณูุท ุงููุนุงููุงุช ูู ุชูุฑูุฑ SBP ูู ุนูุงูุฉ <b>ุงููุณุงุทุฉ</b> ุ ููู ุชูุฑูุฑ <b>MOEX</b> - <b>broker_commission</b> ุ </li><li style=";text-align:right;direction:rtl">  ุชุงุฑูุฎ ูุนุงููุงุช ุงูุญุณุงุจ ุบูุฑ ุงููุชุฏุงูู ูู ุชูุฑูุฑ SPB ูู ุชุงุฑูุฎ <b>ุงูุชุดุบูู</b> ุ ููู MOEX ุ ูู ุชุงุฑูุฎ_ุงูุนูู ุ ุฅูุฎ. </li></ul></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุซุงู ูุฑุณู ุงูุฎุฑุงุฆุท</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs">tags_mapping = { <span class="hljs-string"><span class="hljs-string">'SPB'</span></span>: { <span class="hljs-string"><span class="hljs-string">'current_position'</span></span>: <span class="hljs-string"><span class="hljs-string">'briefcase_position'</span></span>, <span class="hljs-string"><span class="hljs-string">'deals'</span></span>: <span class="hljs-string"><span class="hljs-string">'closed_deal'</span></span>, <span class="hljs-string"><span class="hljs-string">'flows'</span></span>: <span class="hljs-string"><span class="hljs-string">'nontrade_money_operation'</span></span>, ... <span class="hljs-string"><span class="hljs-string">'stock_name_deal'</span></span>: <span class="hljs-string"><span class="hljs-string">'issuername'</span></span>, <span class="hljs-string"><span class="hljs-string">'paymentcurrency'</span></span>: <span class="hljs-string"><span class="hljs-string">'paymentcurrency'</span></span>, <span class="hljs-string"><span class="hljs-string">'currency_flows'</span></span>: <span class="hljs-string"><span class="hljs-string">'currencycode'</span></span> }, <span class="hljs-string"><span class="hljs-string">'MOEX'</span></span>: { <span class="hljs-string"><span class="hljs-string">'current_position'</span></span>: <span class="hljs-string"><span class="hljs-string">'spot_assets'</span></span>, <span class="hljs-string"><span class="hljs-string">'deals'</span></span>: <span class="hljs-string"><span class="hljs-string">'spot_main_deals_conclusion'</span></span>, <span class="hljs-string"><span class="hljs-string">'flows'</span></span>: <span class="hljs-string"><span class="hljs-string">'spot_non_trade_money_operations'</span></span>, ... <span class="hljs-string"><span class="hljs-string">'stock_name_deal'</span></span>: <span class="hljs-string"><span class="hljs-string">'security_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'paymentcurrency'</span></span>: <span class="hljs-string"><span class="hljs-string">'price_currency_code'</span></span>, <span class="hljs-string"><span class="hljs-string">'currency_flows'</span></span>: <span class="hljs-string"><span class="hljs-string">'currency_code'</span></span> } }</code> </pre></div></div><br>  ุชูุฑุฌุน ุงูุฏุงูุฉ get_allias ุงุณู ุงูุนูุงูุฉ ุงูุถุฑูุฑูุฉ ูููุนุงูุฌุฉ ุ ูุน ุฃุฎุฐ ุงุณู ููุตุฉ ุงูุชุฏุงูู ููุฏุฎู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฏุงูุฉ Get_allias</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_allias</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(exchange_name)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>( tags_mapping[exchange_name][<span class="hljs-string"><span class="hljs-string">'current_position'</span></span>], tags_mapping[exchange_name][<span class="hljs-string"><span class="hljs-string">'deals'</span></span>], tags_mapping[exchange_name][<span class="hljs-string"><span class="hljs-string">'flows'</span></span>], ... tags_mapping[exchange_name][<span class="hljs-string"><span class="hljs-string">'stock_name_deal'</span></span>], tags_mapping[exchange_name][<span class="hljs-string"><span class="hljs-string">'paymentcurrency'</span></span>], tags_mapping[exchange_name][<span class="hljs-string"><span class="hljs-string">'currency_flows'</span></span>] )</code> </pre></div></div><br>  ุงููุธููุฉ get_briefcase ูุณุคููุฉ ุนู ูุนุงูุฌุฉ ุงููุนูููุงุช ุญูู ุญุงูุฉ ุญุงูุธุฉ ุงูุนููู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฏุงูุฉ Get_briefcase</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_briefcase</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XMLdata)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#         briefcase_position briefcase_position = XMLdata.find(current_position) if not briefcase_position: return try: for child in briefcase_position: stock_name_reduce = child.get(stock_name).upper() stock_name_reduce = re.sub('[,\.]|(\s?INC)|(\s+$)|([-\s]?)', '', stock_name_reduce) dict_stocks['stock_name'].append(stock_name_reduce) dict_stocks['account'].append(account_name) dict_stocks['currency'].append(child.get(currency)) dict_stocks['current_cost'].append(float(child.get(current_cost))) dict_stocks['current_cost_rub'].append(float(child.get(current_cost_rub))) dict_stocks['saldo'].append(float(child.get(saldo))) except Exception as e: print('get_briefcase --&gt; Oops! It seems we have a BUG!', e)</span></span></code> </pre> </div></div><br>  ุจุนุฏ ุฐูู ุ ุชุณุชุฑุฏ ูุธููุฉ get_deals ูุนูููุงุช ุญูู ุงููุนุงููุงุช: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฏุงูุฉ Get_deals</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_deals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XMLdata)</span></span></span><span class="hljs-function">:</span></span> stock_name_proc = <span class="hljs-string"><span class="hljs-string">''</span></span> closed_deal = XMLdata.find(deals) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> closed_deal: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-comment"><span class="hljs-comment">#   SPB    -    , #    MOEX:  ,      #    : if exchange_name == 'SPB': sortchildrenby(closed_deal, stock_name_deal) for child in closed_deal: sortchildrenby(child, stock_name_deal) try: for child in closed_deal: stock_name_reduce = child.get(stock_name_deal).upper() stock_name_reduce = re.sub('[,\.]|(\s?INC)|(\s+$)|([-\s]?)', '', stock_name_reduce) dict_deals['stock_name'].append(stock_name_reduce) dict_deals['account'].append(account_name) dict_deals['date_oper'].append(to_dt(child.get(ticketdate)).strftime('%Y-%m-%d')) current_cost = get_current_cost(stock_name_reduce) #    SPB     - quantity, #   MOEX  : buy_qnty  sell_qnty if exchange_name == 'MOEX': if child.get('buy_qnty'): quantity = float(child.get('buy_qnty')) else: quantity = - float(child.get('sell_qnty')) else: quantity = float(child.get('quantity')) dict_deals['quantity'].append(quantity) dict_deals['price'].append(float(child.get('price'))) dict_deals['type_oper'].append('deal') dict_deals['currency'].append(child.get(payment_currency)) brok_comm = child.get(brokerage) if brok_comm is None: brok_comm = 0 else: brok_comm = float(brok_comm) dict_deals['brokerage'].append(float(brok_comm)) #         if stock_name_proc != stock_name_reduce: if stock_name_proc != '': put_avr_price_in_df(account_name, stock_name_proc, \ pnl.m_net_position, pnl.m_avg_open_price) current_cost = get_current_cost(stock_name_proc) pnl.update_by_marketdata(current_cost) if len(dict_deals['result']) &gt; 0: if exchange_name != 'SPB': dict_deals['result'][-1] = pnl.m_unrealized_pnl * 0.87 -dict_deals['brokerage'][-2] else: dict_deals['result'][-1] = pnl.m_unrealized_pnl - dict_deals['brokerage'][-2] stock_name_proc = stock_name_reduce pnl = PnlSnapshot(stock_name_proc, float(child.get('price')), quantity) dict_deals['result'].append(-1 * brok_comm) else: pnl.update_by_tradefeed(float(child.get('price')), quantity) #  ,   if quantity &lt; 0: if pnl.m_realized_pnl &gt; 0 and exchange_name != 'SPB': pnl_sum = pnl.m_realized_pnl * 0.87 - brok_comm else: pnl_sum = pnl.m_realized_pnl - brok_comm dict_deals['result'].append(float(pnl_sum)) else: pnl.update_by_marketdata(current_cost) dict_deals['result'].append(-1 * brok_comm) put_avr_price_in_df(account_name, stock_name_proc, \ pnl.m_net_position, pnl.m_avg_open_price) current_cost = get_current_cost(stock_name_proc) pnl.update_by_marketdata(current_cost) if len(dict_deals['result']) &gt; 0: if exchange_name != 'SPB': dict_deals['result'][-1] = pnl.m_unrealized_pnl * 0.87 -dict_deals['brokerage'][-2] else: dict_deals['result'][-1] = pnl.m_unrealized_pnl - dict_deals['brokerage'][-2] except Exception as e: print('get_deals --&gt; Oops! It seems we have a BUG!', e)</span></span></code> </pre> </div></div><br>  ุจุงูุฅุถุงูุฉ ุฅูู ูุนุงูุฌุฉ ูุตูููุฉ ุจูุนูููุงุช ุญูู ูุนููุงุช ุงููุนุงููุฉ ุ ูุชู ุฃูุถูุง ุญุณุงุจ ูุชูุณุท โโุณุนุฑ ุงููุฑูุฒ ุงูููุชูุญ ูุชุญููู PNL ุจุงุณุชุฎุฏุงู ุทุฑููุฉ FIFO.  ุฅู ูุฆุฉ PnlSnapshot ูุณุคููุฉ ุนู ูุฐุง ุงูุญุณุงุจ ุ ุญูุซ ุชู ุฅูุดุงุก ุงูููุฏ ุงูููุฏู ููุง ูุน ุงูุชุนุฏููุงุช ุงูุตุบูุฑุฉ ูุฃุณุงุณ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญุณุงุจ ุงูุฑุจุญ ูุงูุฎุณุงุฑุฉ</a> <br><br>  ูุฃุฎูุฑูุง ุ ูุฅู ุฃุตุนุจ ุนูููุฉ ุงูุชูููุฐ ูู ูุธููุฉ ุงูุญุตูู ุนูู ูุนูููุงุช ุญูู ุงูุนูููุงุช ุบูุฑ ุงูุชุฌุงุฑูุฉ - <b>get_nontrade_operation</b> .  ูููู ุชุนููุฏูุง ูู ุญูููุฉ ุฃูู ูู ูุชูุฉ ุงูุชูุฑูุฑ ุงููุณุชุฎุฏูุฉ ููุนูููุงุช ุบูุฑ ุงูุชุฌุงุฑูุฉ ุ ูุง ุชูุฌุฏ ูุนูููุงุช ูุงุถุญุฉ ุญูู ููุน ุงููุนุงููุฉ ูุงูุฃูุงู ุงูุฐู ุชุฑุชุจุท ุจู ูุฐู ุงูุนูููุฉ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุซุงู ุนูู ูุฌูุงุช ุงูุฏูุน ููุนูููุงุช ุบูุฑ ุงูุชุฌุงุฑูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูููู ุจูุงู ุฏูุน ุฃุฑุจุงุญ ุงูุฃุณูู ุฃู ุฃุฑุจุงุญ ุงูููุจููุงุช ุงููุชุฑุงููุฉ ุนูู ุงููุญู ุงูุชุงูู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฏูุน ุฃุฑุจุงุญ ุฏุฎู ุงูุนููู &lt;777777&gt; &lt; <font color="#cc0000">APPLE</font> INC-ao&gt; -&gt; ุฏูุน ุฃุฑุจุงุญ ุงูุฃุณูู ูู ุชูุฑูุฑ SPB ุ </li><li style=";text-align:right;direction:rtl">  ุฏูุน ุฃุฑุจุงุญ ุนููู ุงูุฏุฎู &lt;777777&gt; &lt; <font color="#cc0000">MICROSOFT</font> COM-&gt; </li><li style=";text-align:right;direction:rtl">  ุฏูุน ุฏุฎู ุงูุนููู 777777i (NKD 2 <font color="#cc0000">OFZ 24019</font> ) ุงูุถุฑูุจุฉ ุงูููุชุทุนุฉ 0.00 ุฑูุจู -&gt; ุฏูุน ุงููุณููุฉ ูู ุชูุฑูุฑ MOEX ุ </li><li style=";text-align:right;direction:rtl">  ุฏูุน ุงูุฏุฎู ููุนููู 777777 <font color="#cc0000">ุฃุฑุจุงุญ ูู FGC UES</font> -ao ุถุฑูุจุฉ ุงูุงุณุชูุทุงุน XX.XX ุฑูุจู -&gt; ุฏูุน ุฃุฑุจุงุญ ุงูุฃุณูู ูู ุชูุฑูุฑ MOEX.  ุงูุฎ. </li></ol></div></div><br>  ููููุง ูุฐูู ุ ุณูููู ูู ุงูุตุนุจ ุงูุงุณุชุบูุงุก ุนู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ ุ ูุฐูู ุณูุณุชุฎุฏููุง ุนูู ุฃููู ูุฌู.  ุงูุฌุงูุจ ุงูุขุฎุฑ ูู ุงููุณุฃูุฉ ูู ุฃู ุงุณู ุงูุดุฑูุฉ ูุง ูุชุทุงุจู ุฏุงุฆููุง ูุน ุงูุงุณู ูู ุงููุญูุธุฉ ุฃู ูู ุงููุนุงููุงุช ูุบุฑุถ ุงูุฏูุน.  ูุฐูู ุ ูุฌุจ ุฃู ูุฑุชุจุท ุงูุงุณู ุงููุณุชูู ูููุตุฏุฑ ูู ุบุฑุถ ุงูุฏูุน ุจุงูุฅุถุงูุฉ ุฅูู ุงููุงููุณ.  ููุงููุณ ุณูุณุชุฎุฏู ูุฌููุนุฉ ูู ุงูุตููุงุช ุ ูุฃู  ููุงู ูุงุฆูุฉ ูุงููุฉ ูู ุงูุดุฑูุงุช. <br><br>  <b>ุชุณุชุฑุฌุน</b> ุงูุฏุงูุฉ <b>get_company_from_str</b> ุงุณู ุงููุตุฏุฑ ูู ุงูุชุนููู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฏุงูุฉ Get_company_from_str</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_company_from_str</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(comment)</span></span></span><span class="hljs-function">:</span></span> company_name = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-comment"><span class="hljs-comment">#    / flows_pattern = [ '^.+\s&lt;(\w+)?.+-&gt;$', '^.+\s(.+)-.+$', '^.+\(\s\d?\s(.+)\).+$', '^.+\s(.+)-.+$' ] for pattern in flows_pattern: match = re.search(pattern, comment) if match: return match.group(1).upper() return company_name</span></span></code> </pre> </div></div><br>  ุชุคุฏู ุงูุฏุงูุฉ <b>get_company_from_briefcase</b> ุงุณู ุงูุดุฑูุฉ ุฅูู ุงููุงููุณ ุฅุฐุง ูุฌุฏุช ุชุทุงุจููุง ุจูู ุงูุดุฑูุงุช ุงูุชู ุดุงุฑูุช ูู ุงููุนุงููุงุช: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฏุงูุฉ Get_company_from_briefcase</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_company_from_briefcase</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(company_name)</span></span></span><span class="hljs-function">:</span></span> company_name_full = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> value_from_dic = df_deals[df_deals[<span class="hljs-string"><span class="hljs-string">'stock_name'</span></span>].str.contains(company_name)] company_arr = value_from_dic[<span class="hljs-string"><span class="hljs-string">'stock_name'</span></span>].unique() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(company_arr) == <span class="hljs-number"><span class="hljs-number">1</span></span>: company_name_full = company_arr[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> company_name_full</code> </pre> <br></div></div><br>  ูุฃุฎูุฑูุง ุ ุงููุธููุฉ ุงูุฃุฎูุฑุฉ ูุฌูุน ุงูุจูุงูุงุช ุนู ุงูุนูููุงุช ุบูุฑ ุงูุชุฌุงุฑูุฉ ูู <b>get_nontrade_operation</b> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฏุงูุฉ Get_nontrade_operation</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_nontrade_operation</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XMLdata)</span></span></span><span class="hljs-function">:</span></span> nontrade_money_operation = XMLdata.find(flows) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> nontrade_money_operation: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> child <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> nontrade_money_operation: comment = child.get(<span class="hljs-string"><span class="hljs-string">'comment'</span></span>) type_oper_match = re.search(<span class="hljs-string"><span class="hljs-string">'||^.+.+.+$'</span></span>, comment) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> type_oper_match: company_name = get_company_from_str(comment) type_oper = get_type_oper(comment) dict_flows[<span class="hljs-string"><span class="hljs-string">'stock_name'</span></span>].append(company_name) dict_flows[<span class="hljs-string"><span class="hljs-string">'account'</span></span>].append(account_name) dict_flows[<span class="hljs-string"><span class="hljs-string">'date_oper'</span></span>].append(to_dt(child.get(operationdate)).strftime(<span class="hljs-string"><span class="hljs-string">'%Y-%m-%d'</span></span>)) dict_flows[<span class="hljs-string"><span class="hljs-string">'type_oper'</span></span>].append(type_oper) dict_flows[<span class="hljs-string"><span class="hljs-string">'result'</span></span>].append(float(child.get(<span class="hljs-string"><span class="hljs-string">'amount'</span></span>))) dict_flows[<span class="hljs-string"><span class="hljs-string">'currency'</span></span>].append(child.get(currency_flows)) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: print(<span class="hljs-string"><span class="hljs-string">'get_nontrade_operation --&gt; Oops! It seems we have a BUG!'</span></span>, e)</code> </pre> </div></div><br>  ุณุชููู ูุชูุฌุฉ ุฌูุน ุงูุจูุงูุงุช ูู ุงูุชูุงุฑูุฑ ุซูุงุซุฉ DataFrames ุ ููู ุชูุฑูุจูุง ูุง ููู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  DataFrame ุจูุนูููุงุช ุนู ูุชูุณุท โโุฃุณุนุงุฑ ุงูุตููุงุช ุงูููุชูุญุฉ: <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/1o/c-/qs/1oc-qs_akl5cvraaq7sg7pvfwfu.png"></div></li><li style=";text-align:right;direction:rtl">  ุฅุทุงุฑ ุจูุงูุงุช ุงูุตููุฉ: <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/gq/lp/xb/gqlpxby2utfl0ahr-fm8l_fqywc.png"></div></li><li style=";text-align:right;direction:rtl">  DataFrame ูุน ูุนูููุงุช ุญูู ุงูุนูููุงุช ุบูุฑ ุงูุชุฌุงุฑูุฉ: <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/hx/-7/su/hx-7suk1zgheyiyr6ov6o0z5yd0.png"></div><br></li></ol><br>  ูุฐูู ุ ูู ูุง ุชุจูู ููุง ูู ุงูููุงู ุจุงุชุญุงุฏ ุฎุงุฑุฌู ูุฌุฏูู ุงููุนุงููุงุช ูุน ุฌุฏูู ูุนูููุงุช ุงููุญูุธุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">df_result = pd.merge(df_deals, df_stocks_avg, how=<span class="hljs-string"><span class="hljs-string">'outer'</span></span>, on=[<span class="hljs-string"><span class="hljs-string">'stock_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'account'</span></span>, <span class="hljs-string"><span class="hljs-string">'currency'</span></span>]).fillna(<span class="hljs-number"><span class="hljs-number">0</span></span>) df_result.sample(<span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/jo/wj/nz/jowjnzmldhgscs30ynz5lrdcueu.png"></div><br>  ูุฃุฎูุฑูุง ุ ุงูุฌุฒุก ุงูุฃุฎูุฑ ูู ูุนุงูุฌุฉ ูุตูููุฉ ุงูุจูุงูุงุช ูู ุฏูุฌ ูุตูููุฉ ุงูุจูุงูุงุช ุงูุชู ุชู ุงูุญุตูู ุนูููุง ูู ุงูุฎุทูุฉ ุงูุณุงุจูุฉ ูุน DataFrame ูููุนุงููุงุช ุบูุฑ ุงูุชุฌุงุฑูุฉ. <br>  ูุชูุฌุฉ ุงูุนูู ุงูููุฌุฒ ูู ุทุงููุฉ ูุณุทุญุฉ ูุจูุฑุฉ ูุงุญุฏุฉ ูุน ุฌููุน ุงููุนูููุงุช ุงููุงุฒูุฉ ููุชุญููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">df_result_full = df_result.append(df_flows, ignore_index=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>).fillna(<span class="hljs-number"><span class="hljs-number">0</span></span>) df_result_full.sample(<span class="hljs-number"><span class="hljs-number">10</span></span>).head()</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/cc/jc/rh/ccjcrh4dq5auyrg3jba6csb_s0g.png"></div><br>  ูุชู ุชุญููู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุงุชุฌุฉ (ุงูุชูุฑูุฑ ุงูููุงุฆู) ูู DataFrame ุจุณูููุฉ ุฅูู CSV ููููู ุงุณุชุฎุฏุงููุง ุจุนุฏ ุฐูู ููุชุญููู ุงูุชูุตููู ูู ุฃู ูุธุงู BI. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> exists(<span class="hljs-string"><span class="hljs-string">'OUTPUT'</span></span>): makedirs(<span class="hljs-string"><span class="hljs-string">'OUTPUT'</span></span>) report_name = <span class="hljs-string"><span class="hljs-string">'OUTPUT\my_trader_diary.csv'</span></span> df_result_full.to_csv(report_name, index = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, encoding=<span class="hljs-string"><span class="hljs-string">'utf-8-sig'</span></span>)</code> </pre> <br><br><h2 style=";text-align:right;direction:rtl">  ุชุญููู ููุนุงูุฌุฉ ุงูุจูุงูุงุช ูู AWS </h2><br>  ุงูุชูุฏู ูุง ููู ุณุงููุงู ูุงูุขู ุชูุชุณุจ ุงูุฎุฏูุงุช ุงูุณุญุงุจูุฉ ูููุงุฐุฌ ุงูุญูุณุจุฉ ุจุฏูู ุฎุงุฏู ุดุนุจูุฉ ูุจูุฑุฉ ูู ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูุชุฎุฒูููุง.  ููุฑุฌุน ุฐูู ุฅูู ุญุฏ ูุจูุฑ ุฅูู ุจุณุงุทุฉ ูุฑุฎุต ูุฐุง ุงูููุฌ ุ ุนูุฏูุง ูุง ุชุญุชุงุฌ ุฅูู ุดุฑุงุก ูุนุฏุงุช ุจุงูุธุฉ ุงูุซูู ูุจูุงุก ุจููุฉ ูุธุงู ููุญูุณุจุฉ ุงููุนูุฏุฉ ุฃู ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงูุถุฎูุฉ ุ ูููู ุนููู ููุท ุงุณุชุฆุฌุงุฑ ุงูุทุงูุฉ ูู ุงูุณุญุงุจุฉ ููููุช ุงูุฐู ุชุญุชุงุฌู ููุดุฑ ุงูููุงุฑุฏ ุงููุงุฒูุฉ ุจุณุฑุนุฉ ูุงููุฉ ููุงุจู ุฑุณูู ุตุบูุฑุฉ ูุณุจููุง . <br><br>  ูุนุชุจุฑ Amazon ูู ุฃูุจุฑ ูุฒูุฏู ุงูุฎุฏูุงุช ุงูุณุญุงุจูุฉ ูุฃูุซุฑูู ุดูุฑุฉ ูู ุงูุณูู.  ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ูุซุงู ุจูุฆุฉ Amazon Web Services (AWS) ูุจูุงุก ูุธุงู ุชุญูููู ููุนุงูุฌุฉ ุงูุจูุงูุงุช ูู ูุญูุธุชูุง ุงูุงุณุชุซูุงุฑูุฉ. <br><br>  ุชุญุชูู AWS ุนูู ูุฌููุนุฉ ูุงุณุนุฉ ูู ุงูุฃุฏูุงุช ุ ูููููุง ุณูุณุชุฎุฏู ูุง ููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Amazon S3</a> - ุชุฎุฒูู ุงููุงุฆู ุ ูุงูุฐู ูุณูุญ ูู ุจุชุฎุฒูู ูููุงุช ุบูุฑ ูุญุฏูุฏุฉ ูู ุงููุนูููุงุช ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">AWS Glue</a> - ุฃููู ุฎุฏูุฉ ETL ุงูุณุญุงุจูุฉ ุงูุชู ูููููุง ุชุญุฏูุฏ ุงููููู ูุฅูุดุงุก ุฑูุฒ ETL ูู ุจูุงูุงุช ุงููุตุฏุฑ ุงููุญุฏุฏุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุชุชูุญ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Amazon Athena</a> ุ ููู ุฎุฏูุฉ ุงุณุชุนูุงู SQL ุนุจุฑ ุงูุฅูุชุฑูุช ุจุฏูู ุฎุงุฏู ุ ุชุญููู ุงูุจูุงูุงุช ุจุณุฑุนุฉ ูู S3 ุฏูู ุงููุซูุฑ ูู ุงูุชุญุถูุฑ.  ูุฏูู ุฃูุถูุง ุญู ุงููุตูู ุฅูู ุงูุจูุงูุงุช ุงููุตููุฉ ุงูุชู ูุนุฏูุง AWS Glue ุ ูุงูุชู ุชุชูุญ ูู ุงููุตูู ุฅูู ุงูุจูุงูุงุช ูุจุงุดุฑุฉ ุจุนุฏ ุงุฌุชูุงุฒ ETL ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Amazon QuickSight</a> - ุฎุฏูุฉ BI <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฏูู ุฎุงุฏู</a> ุ ููููู ุฅูุดุงุก ุฃู ุชุตูุฑุงุช ูุชูุงุฑูุฑ ุชุญููููุฉ "ุนูู ุงูุทุงูุฑ" ุ ุฅูุฎ. </li></ul><br>  ูุซุงุฆู ุฃูุงุฒูู ุนูู ูุง ูุฑุงู ุ ุนูู ูุฌู ุงูุฎุตูุต ุ ููุงู ููุงู ุฌูุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃูุถู ุงูููุงุฑุณุงุช ุนูุฏ ุงุณุชุฎุฏุงู Athena ูุน AWS Glue</a> ุ ูุงูุฐู ูุตู ููููุฉ ุฅูุดุงุก ูุงุณุชุฎุฏุงู ุงูุฌุฏุงูู ูุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู AWS Glue.  ุฏุนููุง ูุณุชููุฏ ูู ุงูุฃููุงุฑ ุงูุฑุฆูุณูุฉ ููุฐู ุงูููุงูุฉ ููุทุจููุง ูุฅูุดุงุก ูููููุง ุงูุฎุงุต ููุธุงู ุฅุนุฏุงุฏ ุงูุชูุงุฑูุฑ ุงูุชุญููููุฉ. <br><br>  ุณุชุชู ุฅุถุงูุฉ ูููุงุช CSV ุงูุชู ุฃุนุฏูุง ุงููุญูู ุงููุบูู ููุชูุฑูุฑ ุฅูู ูุฌููุนุฉ S3.  ูู ุงููุฎุทุท ุฃู ูุชู ุชุฌุฏูุฏ ุงููุฌูุฏ ุงูููุงุจู ุนูู S3 ูู ููู ุณุจุช - ูู ููุงูุฉ ุฃุณุจูุน ุงูุชุฏุงูู ุ ูุฐูู ูุง ููููู ุงูุงุณุชุบูุงุก ุนู ุชูุณูู ุงูุจูุงูุงุช ุจุญููู ุชุงุฑูุฎ ุชูููู ุงูุชูุฑูุฑ ููุนุงูุฌุชู. <br>  ุจุงูุฅุถุงูุฉ ุฅูู ุชุญุณูู ุชุดุบูู ุงุณุชุนูุงูุงุช SQL ููุฐู ุงูุจูุงูุงุช ุ ุณูุณูุญ ููุง ูุฐุง ุงูููุฌ ุจุฅุฌุฑุงุก ุชุญููู ุฅุถุงูู ุ ุนูู ุณุจูู ุงููุซุงู ุ ููุญุตูู ุนูู ุฏููุงููููุงุช ุงูุชุบููุฑุงุช ูู ุงููุชูุฌุฉ ุงููุงููุฉ ููู ูุฑูุฉ ุ ููุง ุฅูู ุฐูู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุนูู ูุน Amazon S3</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุฏูู ุนูู S3 ุ ูุทูู ุนููู "ูุญูู ุงูุชูุฑูุฑ" ุ </li><li style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูุฏูู "report-parser" ูู ุจุฅูุดุงุก ูุฌูุฏ ูุณูู "my_trader_diary" ุ </li><li style=";text-align:right;direction:rtl">  ูู ุงูุฏููู "my_trader_diary" ูู ุจุฅูุดุงุก ุฏููู ุจุชุงุฑูุฎ ุงูุชูุฑูุฑ ุงูุญุงูู ุ ุนูู ุณุจูู ุงููุซุงู ุ "date_report = 2018-10-01" ูุถุน ููู CSV ููู ุ </li><li style=";text-align:right;direction:rtl">  ููุท ูู ุฃุฌู ุงูุชุฌุฑุจุฉ ูููู ุงูุชูุณูู ุจุดูู ุฃูุถู ุ ุณููุดุฆ ุฏููููู ุฅุถุงูููู: "date_report = 2018-09-27" ู "date_report = 2018-10-08".  ูุถุน ููุณ ููู CSV ูููุง ุ </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูุจุฏู ุฏูู S3 ุงูููุงุฆู "ูุญูู ุงูุชูุฑูุฑ" ููุง ูู ููุถุญ ูู ุงูุตูุฑ ุฃุฏูุงู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/n1/4z/c9/n14zc9odchiv6l-_dpc_qbs3s_o.png"></div></li></ul></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุนูู ูุน ุงูุบุฑุงุก AWS</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ุจุดูู ุนุงู ุ ููููู ุงูููุงู ููุท ุจู Amazon Athena ูุฅูุดุงุก ุฌุฏูู ุฎุงุฑุฌู ูู ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ุนูู S3 ุ ูููู AWS Glue ูู ุฃุฏุงุฉ ุฃูุซุฑ ูุฑููุฉ ูููุงุกูุฉ ููุฐุง. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุชูู ุฅูู AWS Glue ูููุดุฆ ุฒุงุญููุง ุฌุฏูุฏูุง ุ ูุงูุฐู ุณูุฌูุน ุฌุฏูููุง ูุงุญุฏูุง ูู ูููุงุช CSV ูููุตูุฉ ุญุณุจ ุชูุงุฑูุฎ ุฅุนุฏุงุฏ ุงูุชูุงุฑูุฑ: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุนููู ุงุณู ุงูุฒุงุญู ุงูุฌุฏูุฏ ุ </li><li style=";text-align:right;direction:rtl">  ูุดูุฑ ุฅูู ุงููุณุชูุฏุน ุญูุซ ูุญุตู ุนูู ุงูุจูุงูุงุช ูู (s3: // report-parser / my_trader_diary /) </li><li style=";text-align:right;direction:rtl">  ูุฎุชุงุฑ ุฃู ููุดุฆ ุฏูุฑ IAM ุฌุฏูุฏูุง ููููู ุงููุตูู ุฅูู ุชุดุบูู ุงูุฒุงุญู ูุงููุตูู ุฅูู ุงูููุฑุฏ ุงููุญุฏุฏ ุนูู S3 ุ </li><li style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ุชุญุชุงุฌ ุฅูู ุชุนููู ุชุฑุฏุฏ ุงูุจุฏุก.  ุจูููุง ูุถุน ุงูุทูุจ ุ ูููู ูู ุงููุณุชูุจู ุ ุฃุนุชูุฏ ุฃู ูุฐุง ุณูุชุบูุฑ ูุณูููู ุงูุฅุทูุงู ุฃุณุจูุนููุง ุ </li><li style=";text-align:right;direction:rtl">  ุงุญูุธ ูุงูุชุธุฑ ุฅูุดุงุก ุงูุฒุงุญู. </li></ul></li><li style=";text-align:right;direction:rtl">  ุนูุฏูุง ูุฏุฎู ุงูุฒุงุญู ุฅูู ุญุงูุฉ ุงูุงุณุชุนุฏุงุฏ ุ ุงุจุฏุฃ! <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ed/xx/z9/edxxz9kurfrebky5-fuaqwzt-0e.png"></div></li><li style=";text-align:right;direction:rtl">  ุจูุฌุฑุฏ ุฃู ูุนูู ุ ุณูุธูุฑ ุฌุฏูู my_trader_diary ุฌุฏูุฏ ูู ุบุฑุงุก AWS: ูุงุนุฏุฉ ุงูุจูุงูุงุช -&gt; ุนูุงูุฉ ุงูุชุจููุจ ุงูุฌุฏุงูู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/u6/2n/rt/u62nrttephj6m-hxxguky4il6os.png"></div></li></ul></div></div><br>  ุถุน ูู ุงุนุชุจุงุฑู ุงูุฌุฏูู ุงูุฐู ุชู ุฅูุดุงุคู ุจูุฒูุฏ ูู ุงูุชูุงุตูู. <br>  ุฅุฐุง ููุช ุจุงูููุฑ ููู ุงุณู ุงูุฌุฏูู ุงูุฐู ุชู ุฅูุดุงุคู ุ ูุณููุชูู ุฅูู ุงูุตูุญุฉ ูุน ูุตู ุงูุจูุงูุงุช ุงููุตููุฉ.  ููุฌุฏ ูู ุงูุฃุณูู ุชุฎุทูุท ุฌุฏูู ูุขุฎุฑูุง ุนููุฏ ูู ููู ูู ููู CSV ุงููุตุฏุฑ - date_report.  ููุดุฆ ูุฐุง ุงูุนููุฏ AWS Glue ุชููุงุฆููุง ุงุณุชูุงุฏูุง ุฅูู ุชุนุฑูู ุฃูุณุงู ุจูุงูุงุช ุงููุตุฏุฑ (ูู Bucket S3 ุ ุณูููุง ุจุดูู ุฎุงุต ุงููุฌูุฏุงุช date_report = YYYY-MM-DD ุ ููุง ุณูุญ ููุง ุจุงุณุชุฎุฏุงููุง ูุฃูุณุงู ููุตููุฉ ุญุณุจ ุงูุชุงุฑูุฎ). <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูุณูู ุงูุฌุฏูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/5o/30/2v/5o302vb08y_zmylnfyaiign5us0.png"></div><br>  ูู ููุณ ุงูุตูุญุฉ ูู ุงูุฒุงููุฉ ุงููููู ุงูุนููุง ููุฌุฏ ุฒุฑ ุนุฑุถ ุงูุฃูุณุงู ุ ุนู ุทุฑูู ุงูููุฑ ุนูู ุงูุชู ูููููุง ุฃู ูุฑู ุงูุฃูุณุงู ุงูุชู ูุชููู ุฌุฏูููุง ุงูุฐู ุชู ุฅูุดุงุคู ูู: <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/82/0l/kk/820lkk4mytj34kzh0tt__ieb6me.png"></div></div></div><br><h2 style=";text-align:right;direction:rtl">  ุชุญููู ุงูุจูุงูุงุช </h2><br>  ุจุนุฏ ุชุญููู ุงูุจูุงูุงุช ุงููุนุงูุฌุฉ ุชุญุช ุชุตุฑููุง ุ ูููููุง ุจุณูููุฉ ุงูุจุฏุก ูู ุชุญููููุง.  ููุจุฏุก ุ ุถุน ูู ุงุนุชุจุงุฑู ุฅููุงููุงุช Amazon Athena ุนูู ุฃููุง ุฃุณูู ูุฃุณุฑุน ุทุฑููุฉ ูุฅุฌุฑุงุก ุงุณุชุนูุงูุงุช ุชุญููููุฉ.  ููููุงู ุจุฐูู ุ ุงูุชูู ุฅูู ุฎุฏูุฉ Amazon Athena ุ ูุญุฏุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุชู ูุญุชุงุฌูุง (ูุงููุฉ) ูุงูุชุจ ููุฏ SQL ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> d.date_report, d.account, d.stock_name, d.currency, <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(d.quantity) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> quantity, <span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(d.result), <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">result</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> my_trader_diary d <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> d.date_report, d.account, d.stock_name, d.currency <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> d.account, d.stock_name, d.date_report;</code> </pre> <br>  ุณูุนุฑุถ ููุง ูุฐุง ุงูุทูุจ ูุชูุฌุฉ ูุงููุฉ ุตุงููุฉ ููู ุชุฃููู ูุฌููุน ุชูุงุฑูุฎ ุฅุนุฏุงุฏ ุงูุชูุงุฑูุฑ.  ูุฃู  ูููุง ุจุชูุฒูู ููุณ ุงูุชูุฑูุฑ ุซูุงุซ ูุฑุงุช ูุชูุงุฑูุฎ ูุฎุชููุฉ ุ ููู ุชุชุบูุฑ ุงููุชูุฌุฉ ุ ูุงูุชู ุจุงูุทุจุน ุณุชููู ูุฎุชููุฉ ูู ุงูุณูู ุงูุญููููุฉ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/9o/fg/dl/9ofgdloafbrxbvctdyprolilvna.png"></div><br>  ูููู ูุงุฐุง ูู ุฃุฑุฏูุง ุชุตูุฑ ุงูุจูุงูุงุช ุงููุณุชููุฉ ูู ุดูู ุฌุฏุงูู ุฃู ุฑุณูู ุจูุงููุฉ ูุฑูุฉุ  ููุง ูุฃุชู Amazon QuickSight ุฅูู ุงูุฅููุงุฐ ุ ูุงูุฐู ููููู ูู ุฎูุงูู ุชูููู ุชุญูููุงุช ูุฑูุฉ ุจุณุฑุนุฉ ุชูุฑูุจูุง ูุซู ูุชุงุจุฉ ุงุณุชุนูุงู SQL.  ุณูุฐูุจ ุฅูู ุฎุฏูุฉ Amazon QuickSight (ุฅุฐุง ูู ุชูู ูุฏ ุณุฌูุช ููุงู ุ ูุงูุชุณุฌูู ูุทููุจ). <br><br>  ุงููุฑ ููู ุงูุฒุฑ ุชุญูููุงุช ุฌุฏูุฏุฉ -&gt; ูุฌููุนุฉ ุจูุงูุงุช ุฌุฏูุฏุฉ ููู ุงููุงูุฐุฉ ุงูุชู ุชุธูุฑ ุญุฏุฏ ูุตุงุฏุฑ ูุฌููุนุฉ ุงูุจูุงูุงุช ุ ุงููุฑ ููู ุฃุซููุง: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/yq/kr/bv/yqkrbv144qas16af4jolsj3rnci.png"></div><br><br>  ุณูุฎุฑุฌ ุจุงุณู ููุตุฏุฑ ุจูุงูุงุชูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ "PNL_analysis" ูุงููุฑ ุนูู ุฒุฑ "ุฅูุดุงุก ูุตุฏุฑ ุจูุงูุงุช". <br><br>  ุจุนุฏ ุฐูู ุ ุชูุชุญ ูุงูุฐุฉ ุงุฎุชูุงุฑ ุงูุฌุฏูู ุงูุฎุงุต ุจู ุ ุญูุซ ุชุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฌุฏูู ูุตุฏุฑ ุงูุจูุงูุงุช.  ูุฎุชุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช - ุงููุงููุฉ ูุงูุฌุฏูู ุงูููุฌูุฏ ูููุง: my_traider_diary.  ุจุดูู ุงูุชุฑุงุถู ุ ูุชู ุงุณุชุฎุฏุงู ุงูุฌุฏูู ุจุงููุงูู ุ ูููู ุฅุฐุง ุญุฏุฏุช "ุงุณุชุฎุฏุงู SQL ูุฎุตุต" ุ ูููููู ุชุฎุตูุต ุนููุฉ ุงูุจูุงูุงุช ุงูุชู ุชุญุชุงุฌูุง ูุถุจุทูุง ุจุฏูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุณุชุฎุฏู ุงูุฌุฏูู ุจุฃูููู ููููุฑ ููู ุงูุฒุฑ ุชุญุฑูุฑ / ูุนุงููุฉ ุงูุจูุงูุงุช. <br><br>  ุณูุชู ูุชุญ ุตูุญุฉ ุฌุฏูุฏุฉ ุญูุซ ููููู ุฅุฌุฑุงุก ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ ููุนุงูุฌุฉ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ. <br><br>  ูุญุชุงุฌ ุงูุขู ุฅูู ุฅุถุงูุฉ ุญููู ูุญุณูุจุฉ ุฅุถุงููุฉ ุฅูู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฏููุง: ุฑุจุน ูุณูุฉ ุงูุชุดุบูู.  ูุฏ ููุงุญุธ ุงููุงุฑุฆ ุงูููุธ ุฃู ูุซู ูุฐู ุงูุชูุงุนุจุงุช ูุงูุช ุฃุณูู ูู ุงูุฌุงูุจ ุงููุบูู ูุจู ุญูุธ ุงูุชูุฑูุฑ ุงูููุงุฆู ุฅูู CSV.  ุจูุง ุดู ุ ูุฏูู ุงูุขู ูู ุฅุธูุงุฑ ูุฏุฑุงุช ููุฑููุฉ ุฅุนุฏุงุฏุงุช ูุธุงู BI ุนูู ุงูุทุงูุฑ.  ููุงุตู ุฅูุดุงุก ุงูุญููู ุงููุญุณูุจุฉ ุจุงูููุฑ ููู ุงูุฒุฑ "ุญูู ุฌุฏูุฏ". <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูู ุจุฅูุดุงุก ุญูู ุฌุฏูุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ax/1z/ag/ax1zagyy7nnryd62t5najdntcio.png"></div></div></div><br>  ูุชู ุงุณุชุฎุฏุงู ุงูุตูุบ ุงูุจุณูุทุฉ ูุฅุจุฑุงุฒ ุนุงู ุงูุนูููุฉ ูุงูุฑุจุน: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/pm/yc/bi/pmycbiybxqtus62nkaa_5v2fu4s.png"></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชุนุจุฆุฉ ุงูุตูุบ ูุญูู ุฌุฏูุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/uo/e1/u1/uoe1u1uco3ygn7cljsr6qcnhwbk.png"></div></div></div><br>  ุนูุฏูุง ูุชู ุฅูุดุงุก ุงูุญููู ุงููุญุณูุจุฉ ูุฅุถุงูุชูุง ุฅูู ุงูุชุญุฏูุฏ ุจูุฌุงุญ ุ ูู ุจุชุณููุฉ ูุฌููุนุฉ ุจูุงูุงุชูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ "my_pnl_analyze" ูุงููุฑ ุนูู ุฒุฑ "ุญูุธ ูุชุตูุฑ". <br><br>  ุจุนุฏ ุฐูู ุ ููุชูู ุฅูู ุงูููุญุฉ ุงูุฑุฆูุณูุฉ ูู Amazon QuickSight ูุฃูู ุดูุก ูุฌุจ ุนูููุง ุงูููุงู ุจู ูู ุฅุนุฏุงุฏ ูุฑุดุญ ูุชุงุฑูุฎ ุงูุชูุฑูุฑ (ูุน ุงูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุญูููุฉ ุฃู ููุณ ุงูุจูุงูุงุช ุชู ุฌูุนูุง ูู ุซูุงุซุฉ ุฃูุณุงู).  ุญุฏุฏ ุชุงุฑูุฎ ุงูุชูุฑูุฑ 2018-10-01 ูุงููุฑ ุนูู ุฒุฑ ุชุทุจูู ูุงูุชูู ุฅูู ุนูุงูุฉ ุงูุชุจููุจ ุชุตูุฑ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุนุฏุงุฏ ุงูุชุตููุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/an/jo/et/anjoet5xt_divhygnebb5v9ys8k.png"></div></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุงูุขู ุชุตูุฑ ูุชูุฌุฉ ุงููุญูุธุฉ ูู ุฃู ุทุงุฆุฑุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ููู ูุฑูุฉ ูุงููุฉ ุฏุงุฎู ุญุณุงุจ ุงูุชุฏุงูู ุ ูุชูุณูููุง ุจุญุณุจ ุงูุนููุฉ (ูุฃู ุงููุชูุฌุฉ ุบูุฑ ูุงุจูุฉ ููููุงุฑูุฉ ุจุนููุงุช ูุฎุชููุฉ) ูุฃููุงุน ุงูุนูููุงุช. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุจุฏุฃ ุจุฃููู ุฃุฏุงุฉ ูุฃู BI - ุงูุฌุฏุงูู ุงููุญูุฑูุฉ. </font><font style="vertical-align: inherit;">ูุชูููุฑ ุงููุณุงุญุฉ ูุนุฑุถ ุงููุฑููุฉ ุ ุฃุถุน ุงูุนููุฉ ูู ุนูุตุฑ ุชุญูู ูููุตู (ุชูุซููู ููุดุฑูุญุฉ ูู MS Excel)</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/90/3e/it/903eitay8v9j1psyz05d8qaqh_k.png"></div><blockquote style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุถุญ ุงูุฌุฏูู ุฃุนูุงู ุฃูู ุฅุฐุง ูุฑุฑ ุงููุณุชุซูุฑ ุจูุน ุฌููุน ุฃุณูู FGC UES ุงูุขู ุ ูุณูู ูุณุฌู ุจุงูุชุงูู ุฎุณุงุฑุฉ ุ </font><font style="vertical-align: inherit;">ุชูุฒูุนุงุช ุฃุฑุจุงุญ ูุฏููุนุฉ ุจูุจูุบ 1.509.91 ุต. </font><font style="vertical-align: inherit;">ููู ูุง ุชุบุทู ุชูุงููููุง (1ุ763.36 ุฑูุจู - ูุฑู ุณุนุฑ ุตุฑู ุณูุจู ู 174 ุฑูุจู - ุถุฑูุจุฉ ุงูุฏุฎู ุงูุดุฎุตู ุนูู ุฃุฑุจุงุญ ุงูุฃุณูู). </font><font style="vertical-align: inherit;">ูู ุงูููุทูู ุงูุงูุชุธุงุฑ ูุงูุงูุชุธุงุฑ ูุฃููุงุช ุฃูุถู ูู ุงูุจูุฑุตุฉ.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฑุณู ุงูุจูุงูู ุงูุชุงูู ูู ูุฎุทุท ุดุฑูุทู: </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/up/a7/qj/upa7qjdqjiqyo-j6tx0bnrth67m.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุขู ุณูุดูู ุฌุฏููุงู ููุถุญ ููุง ููุฏุงุฑ ูุง ุงุณุชุซูุฑูุงู ูู ูู ูุฑูุฉ ุ ูุนุฏุฏ ุงูุฃูุงู ูู ูุญูุธุชูุง ููุง ูู ุงูุฑุจุญูุฉ ุทูุงู ูุชุฑุฉ ุงูููููุฉ. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ุฃุถู ุญูููู ูุญุณูุจูู ุฌุฏูุฏูู: sum_investment ู count_days.</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจูุบ ุงูุงุณุชุซูุงุฑ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">   sum_investment ( )   : <br><br> ifelse({stock_name} = ' 24019',{avg_open_price} * quantity * 10,{avg_open_price} * quantity) <br><br>           ,       โ     (    โ 1000). <br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุฏุฏ ุงูุญููู_ุฃูุงู</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">   count_day (   )                : <br><br> dateDiff(parseDate({date_oper}),parseDate({date_report})) <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชู ุนุฑุถ ุงูุฌุฏูู ุงูููุงุฆู ูู ููุทุฉ ุงูุดุงุดุฉ ุฃุฏูุงู: </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ut/ws/dk/utwsdkbzhksrjh3wunw_w6stqr0.png"></div><br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุงุณุชูุชุงุฌุงุช ูุงูููุฎุต </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ูุญุตูุง ูุนู ุชูููุฐ ูุญูู ุงูุชูุฑูุฑ ูุทุฑู ุชุญููู ุงูุจูุงูุงุช ุงูุชู ุฃุนุฏูุง "ุนูู ุงูุทุงูุฑ" ุจุงุณุชุฎุฏุงู ุฎุฏูุงุช ุฃูุงุฒูู. ููุง ุชุทุฑููุง ุฅูู ุจุนุถ ุงูุฌูุงูุจ ุงูุชุฌุงุฑูุฉ ูุงูุฌูุงูุจ ุงูุฃุณุงุณูุฉ ูุชุญููู ุงููุญูุธุฉ ุงูุงุณุชุซูุงุฑูุฉ ุ ูุซู ูุฐุง ุงูููุถูุน ุถุฎู ุชูุฑูุจูุง ููุตุนุจ ุชุถูููู ูู ููุงู ูุงุญุฏ ุ ุฃุนุชูุฏ ุฃูู ูู ุงูููุทูู ูุถุนู ูู ููุดูุฑ ูููุตู ุฃู ุญุชู ุณูุณูุฉ ูู ุงูููุดูุฑุงุช. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง ูููุง ูุชุนูู ุจุงุณุชุฎุฏุงู ุฃุฏุงุฉ ูุนุงูุฌุฉ ุชูุงุฑูุฑ ุงููุณูุท ูุงูุฃุณุงููุจ ูุงูุฎูุงุฑุฒููุงุช ุงููุณุชุฎุฏูุฉ ูููุง ุ ููููู ุงุณุชุฎุฏุงููุง (ูุน ุงูุชุนุฏูู ุงูููุงุณุจ) ููุนุงูุฌุฉ ุชูุงุฑูุฑ ุงููุณุทุงุก ุงูุขุฎุฑูู. ุนูู ุฃู ุญุงู ุ ุฅุฐุง ููุช ุชุฎุทุท ูุชูููู ุงูุดูุฑุฉ ูุน ุงุญุชูุงุฌุงุชู ุ ูุฃูุง ุนูู ุงุณุชุนุฏุงุฏ ูุฅุนุทุงุก ุจุนุถ ุงููุตุงุฆุญ ุ ูุฐูู ูุง ุชุชุฑุฏุฏ ูู ุทุฑุญ ุงูุฃุณุฆูุฉ - ุณุฃุญุงูู ุจุงูุชุฃููุฏ ุงูุฅุฌุงุจุฉ ุนูููุง.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง ูุชุฃูุฏ ูู ุฃู ูุฐุง ุงููุธุงู ุณูุฌุฏ ุชุทุจููู ูุณูููู ูู ูุฒูุฏ ูู ุงูุชุทููุฑ. ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงููุฎุทุท ุฃู ุชุถุงู ุฅูู ุญุณุงุจ PNL ุงููุงูู ูููุญูุธุฉ ูุญุงุณุจุฉ ุงูุฅูุฏุงุน ูุงูุฑุณูู ุงูุฃุฎุฑู (ุนูู ุณุจูู ุงููุซุงู ุ ูุณุญุจ ุงูุฃููุงู) ุ ููุฐูู ุณุฏุงุฏ ุงูุณูุฏุงุช ุ ููุง ุฅูู ุฐูู ... ุชู ุงุณุชุฎุฏุงู ุงูุญููู ุงููุญุณูุจุฉ ุนูู ุฌุงูุจ Quicksight ูุฃุบุฑุงุถ ุงูุนุฑุถ ุงูุชูุถูุญู ุ ูู ุงูุฅุตุฏุงุฑ ุงูุชุงูู ูู ุงููุญูู ุงููุบูู ุ ุณูุชู ููู ุฌููุน ูุฐู ุงูุฃุนูุฏุฉ ุงูุฅุถุงููุฉ ุฅูู Python ูุณูุชู ุญุณุงุจูุง ุนูู ุฌุงูุจ ุงููุญูู ุงููุบูู.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุตูุชู ูููุฏุณูุง ูุนูุงุฑููุง ูุนููููุง ุฑุฆูุณููุง ููุฐุง ุงูุญู ุ ุฃุฑู ุชุฑููุฉ ุฃุฎุฑู ุนูู ุงููุญู ุงูุชุงูู: ุญุณููุง ุ ูุง ุฃุฑูุฏ ุทูุจ ุชูุงุฑูุฑ XML ูุฏูููุง ูู ูู ูุฑุฉ! </font><font style="vertical-align: inherit;">ุจุงูุทุจุน ุ ูุง ุชูุฌุฏ ุฅููุงููุฉ ุฃุฎุฑู ุญุชู ุงูุขู ุ ูููู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Broker ูุน ููู ุงูุฑูุฒ ุงููููุฒ ููุทุงู ุฃุฎุฐ ุงูุนููุงุช ุณุชููู ูุซุงููุฉ ูุชููู ุงูุชูุงุฑูุฑ ุงูุฃูููุฉ ุงูุฃุณุจูุนูุฉ. </font><font style="vertical-align: inherit;">ุงููุนุงูุฌุฉ ุงูุชููุงุฆูุฉ ุงููุงููุฉ ุงููุงุญูุฉ ุนูู ุฌุงูุจ Amazon: ูู ุชุดุบูู ETL-job ุนูู AWS Glue ุฅูู ุงูุญุตูู ุนูู ูุชุงุฆุฌ ุฌุงูุฒุฉ ูู ุดูู ุฑุณูู ุจูุงููุฉ ูุฌุฏุงูู ูู Amazon QuickSight ุณุชุณูุญ ูู ุจุฃุชูุชุฉ ุงูุนูููุฉ ุจุงููุงูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุงูุนุซูุฑ ุนูู ุดูุฑุฉ ุงููุตุฏุฑ ุงููุงููุฉ ูู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ูุณุชูุฏุน GitHub ุงูุฎุงุต</font></a><font style="vertical-align: inherit;"> ุจู</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar426027/">https://habr.com/ru/post/ar426027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar426017/index.html">ููููุฉ ุชูููู ุนุฏุฏ ุงูุชุฌุงุฑุจ ุนูู ุงูุญููุงูุงุช</a></li>
<li><a href="../ar426019/index.html">ูุญุทุฉ ุงูุทูุณ ุนูู Arduino ูู A ุฅูู Z. Part 5</a></li>
<li><a href="../ar426021/index.html">libgdx ูุงููุดุงุนุฑ</a></li>
<li><a href="../ar426023/index.html">ูุชุญ ุงูุฏุฑุณ "ุงููุฎุชุจุฑ ุงูุงูุชุฑุงุถู ูู Vagrant"</a></li>
<li><a href="../ar426025/index.html">ุงุณุชุฎุฏุงู ุทุฑู ูุฌูููุฉ ูุฅุซุฑุงุก ุฐูุงุก ุงูุชูุฏูุฏ</a></li>
<li><a href="../ar426029/index.html">ูู ุชุณุชุณูู ูุชุฑูุฏ ุฅููุงุก ุงููููุฉุ ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ูุจุฏู ุจูุง ุชุฏุฑูุจ ุงููุทูุฑ ุงููุนุงู</a></li>
<li><a href="../ar426031/index.html">ูุฏ ูุนุชูุฏ ุงูููู ุจุดุฃู ุงูุงุณุชููุงุก ุนูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุนูู ุงูุนุงูู ุนูู ุงูุชุฑุงุถุงุช ุบูุฑ ุนูููุฉ</a></li>
<li><a href="../ar426033/index.html">ุงุดุชุจู ุฌุจุงุจุฑุฉ ุงูุฑูุงุถูุงุช ุญูู ุฅุซุจุงุช ููุญูู ููุฑุถูุฉ ABC</a></li>
<li><a href="../ar426039/index.html">ุฅุทูุงู ุงูุทูุงุฑุฆ "Soyuz MS-10" (ุฅููุงุฐ ุงูุทุงูู ุ ุงูุจุซ ุนุจุฑ)</a></li>
<li><a href="../ar426041/index.html">ุญู ุฑูุฒู ูููุนุงุฏูุงุช ุงูุชูุงุถููุฉ ุงูุฎุทูุฉ ูุงููุธู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุชุญููู ูุงุจูุงุณ ุจุงุณุชุฎุฏุงู SymPy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>