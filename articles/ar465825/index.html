<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ˜ª ğŸ§‘ğŸ» ğŸš² Ø¯Ù„ÙŠÙ„ Ù‡Ø§ØªÙ Asterisk FreePBX Ù…Ù† Ø¬Ø¯Ø§ÙˆÙ„ SQL (Ø¯Ù„ÙŠÙ„ ÙŠØ³ØªÙ†Ø¯ Ø¥Ù„Ù‰ Ø§Ù„ÙˆÙŠØ¨ ØŒ ÙˆØªØ­Ù…ÙŠÙ„ Ø¥Ù„Ù‰ Ù…Ù„Ù xml Ù„Ù‡ÙˆØ§ØªÙ Grandstream) â˜¹ï¸ â™ï¸ ğŸ¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ§Ù„ÙŠØ© Ù‚Ø¯ ØªÙƒÙˆÙ† ÙÙŠ Ù…ØªÙ†Ø§ÙˆÙ„ Ø§Ù„ÙŠØ¯ Ù„Ù„Ø¯Ø±Ø§Ø³Ø©. 

 1) Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø§Ø¯Ù… SQL Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª: 



mysql -u freepbxuser -p Enter . Enter, MySQL: mysql>_  ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ø¯Ù„ÙŠÙ„ Ù‡Ø§ØªÙ Asterisk FreePBX Ù…Ù† Ø¬Ø¯Ø§ÙˆÙ„ SQL (Ø¯Ù„ÙŠÙ„ ÙŠØ³ØªÙ†Ø¯ Ø¥Ù„Ù‰ Ø§Ù„ÙˆÙŠØ¨ ØŒ ÙˆØªØ­Ù…ÙŠÙ„ Ø¥Ù„Ù‰ Ù…Ù„Ù xml Ù„Ù‡ÙˆØ§ØªÙ Grandstream)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465825/" style=";text-align:right;direction:rtl">  Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ§Ù„ÙŠØ© Ù‚Ø¯ ØªÙƒÙˆÙ† ÙÙŠ Ù…ØªÙ†Ø§ÙˆÙ„ Ø§Ù„ÙŠØ¯ Ù„Ù„Ø¯Ø±Ø§Ø³Ø©. <br><br>  1) Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø§Ø¯Ù… SQL Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª: <br><br><pre style=";text-align:right;direction:rtl"><code class="dos hljs">mysql -u freepbxuser -p   Enter     .      Enter,    MySQL: mysql&gt;_</code> </pre> <br>  2) Ø£ÙˆØ§Ù…Ø± sql Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© <br><br><pre style=";text-align:right;direction:rtl"> <code class="dos hljs">   : SHOW DATABASES;    : USE dbtest;     : SHOW tables;    : SELECT * FROM page;   : DESCRIBE testtable;</code> </pre><a name="habracut"></a><br>  3) Ø§ØªØµØ§Ù„ sql Ù…Ù† Ø´Ø¨ÙƒØ© Ø®Ø§Ø±Ø¬ÙŠØ©: <br><br><pre style=";text-align:right;direction:rtl"> <code class="dos hljs">CREATE USER '--'@'localhost' IDENTIFIED BY '<span class="hljs-variable"><span class="hljs-variable">!!!</span></span><span class="hljs-variable"><span class="hljs-variable">!!!</span></span>'; GRANT ALL PRIVILEGES ON * . * TO '--'@'localhost'; GRANT SELECT ON * . * TO '--'@'localhost'; use mysql SELECT Host,User,Password FROM user; UPDATE user <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> Host='%' WHERE User='--' AND Host='localhost'; FLUSH PRIVILEGES;</code> </pre><br>  4) ØªÙ†Ø³ÙŠÙ‚ Ù…Ù„Ù XML: <br><br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AddressBook</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pbgroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>70<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>User Manager Group<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pbgroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Contact</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>760<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FirstName</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FirstName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LastName</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LastName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Frequent</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Frequent</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Phone</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Work"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phonenumber</span></span></span><span class="hljs-tag">&gt;</span></span>101<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phonenumber</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">accountindex</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">accountindex</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Phone</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Group</span></span></span><span class="hljs-tag">&gt;</span></span>70<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Group</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Primary</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Primary</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Contact</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AddressBook</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <b>Ø§Ù„Ø®Ø·ÙˆØ© 1. Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù†ØµÙŠ php Ù„Ù‚Ø±Ø§Ø¡Ø© Ø¬Ø¯ÙˆÙ„ Asterisk sql ÙˆØ¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù xml</b> <br><br>  Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙÙŠÙ† config.php Ùˆ phonebook.php ØŒ Ù…Ø¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù„Ø§Ø²Ù…Ø©. <br><br>  Ù…Ù„Ù Config.php <br><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">"db"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"mysql:host=localhost;dbname=asterisk"</span></span>, <span class="hljs-string"><span class="hljs-string">"pb_file_gs"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"/var/www/html/phonebook/phonebook.xml"</span></span>, <span class="hljs-string"><span class="hljs-string">"username"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"freepbxuser"</span></span>, <span class="hljs-comment"><span class="hljs-comment">//Mysql login "password" =&gt; " freepbxuser", //Mysql password "options" =&gt; array(PDO::MYSQL_ATTR_INIT_COMMAND =&gt; 'SET NAMES utf8') );</span></span></code> </pre><br>  Ù…Ù„Ù Phonebook.php <br><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $config = <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(<span class="hljs-string"><span class="hljs-string">"db/config.php"</span></span>); $db = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PDO($config[<span class="hljs-string"><span class="hljs-string">"db"</span></span>], $config[<span class="hljs-string"><span class="hljs-string">"username"</span></span>], $config[<span class="hljs-string"><span class="hljs-string">"password"</span></span>], $config[<span class="hljs-string"><span class="hljs-string">"options"</span></span>]); <span class="hljs-comment"><span class="hljs-comment">//     $sql = "SELECT userman_users.username, userman_users.displayname, contactmanager_group_entries.groupid FROM asterisk.userman_users, asterisk.contactmanager_group_entries, asterisk.contactmanager_groups WHERE contactmanager_group_entries.user = userman_users.id AND contactmanager_group_entries.groupid = contactmanager_groups.id"; //     $sqlgrp = "SELECT contactmanager_groups.name,contactmanager_groups.id FROM asterisk.contactmanager_groups"; //      $q = $db-&gt;prepare($sql); $q-&gt;execute(); $rows = $q-&gt;fetchAll(); //    $q2 = $db-&gt;prepare($sqlgrp); $q2-&gt;execute(); $rows2 = $q2-&gt;fetchAll(); unlink($config["pb_file_gs"]); //    $fp = fopen($config["pb_file_gs"],"w+"); fputs($fp, '</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">xml version="1.0" encoding="UTF-8"</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment">&lt;AddressBook&gt;'); foreach($rows2 as $row) { //    ,   fputs($fp,'&lt;pbgroup&gt;'); fputs($fp,'&lt;id&gt;'.$row['id'].'&lt;/id&gt;'); fputs($fp,'&lt;name&gt;'.$row['name'].'&lt;/name&gt;'); fputs($fp,'&lt;/pbgroup&gt;'); } foreach($rows as $row) { //    ,  XML    if (strlen($row['username']) === 3) { $alln = $row['displayname']; //if ($alln = '') #alln = $row['username']; $ln = strstr($alln, ' ', true); $fn = strstr($alln, ' ', false); $fn = trim($fn); $i++; fputs($fp, '&lt;Contact&gt; &lt;id&gt;'.$i.'&lt;/id&gt; &lt;FirstName&gt;'.$ln.'&lt;/FirstName&gt; &lt;LastName&gt;'.$fn.'&lt;/LastName&gt; &lt;Phone type="Work"&gt; &lt;phonenumber&gt;'.$row['username'].'&lt;/phonenumber&gt; &lt;accountindex&gt;1&lt;/accountindex&gt; &lt;/Phone&gt; &lt;Group&gt;' .$row['groupid']. '&lt;/Group&gt; &lt;/Contact&gt; '); } } fputs($fp,'&lt;/AddressBook&gt;'); fclose($fp); </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br>  <b>Ø§Ù„Ø®Ø·ÙˆØ© 2. Ù‚Ù… Ø¨Ø¥Ø¹Ø¯Ø§Ø¯ Ù‡Ø§ØªÙÙƒ Grandstream Ù„Ù‚Ø±Ø§Ø¡Ø© Ø¯ÙØªØ± Ø§Ù„Ù‡Ø§ØªÙ Ù…Ù† Ù…Ù„Ù xml</b> <br><br>  Ø§Ù†ØªØ¨Ù‡ ØŒ Ù…Ù† Ø§Ù„Ù…Ù‡Ù… Ø¹Ù†Ø¯ Ø¥Ø¹Ø¯Ø§Ø¯ "Ø¥Ø¯Ø§Ø±Ø© Ø¯ÙØªØ± Ø§Ù„Ù‡Ø§ØªÙ" Ø¹Ù„Ù‰ Ù‡Ø§ØªÙ Grandstream GXP16xx ØŒ ÙÙŠ Ø­Ù‚Ù„ "Ù…Ø³Ø§Ø± Ø®Ø§Ø¯Ù… Ø¯Ù„ÙŠÙ„ Ø¯ÙØªØ± Ø§Ù„Ù‡Ø§ØªÙ" ØŒ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³Ø§Ø± ÙÙ‚Ø· Ø¯ÙˆÙ† Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù. <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ÙÙŠ Ø§Ù„Ø­Ù‚Ù„ "ØªÙ…ÙƒÙŠÙ† ØªÙ†Ø²ÙŠÙ„ Ø¯ÙØªØ± Ù‡Ø§ØªÙ XML" ØŒ Ø­Ø¯Ø¯ "Ù…Ù…ÙƒÙ‘Ù† ØŒ Ø§Ø³ØªØ®Ø¯Ù… HTTP" </li><li style=";text-align:right;direction:rtl">  ÙÙŠ Ø­Ù‚Ù„ "Ù…Ø³Ø§Ø± Ø®Ø§Ø¯Ù… XML Ù„Ø¯ÙØªØ± Ø§Ù„Ù‡Ø§ØªÙ" ØŒ Ø­Ø¯Ø¯ Ø§Ù„Ù…Ø³Ø§Ø± Ø¥Ù„Ù‰ Ù…Ù„Ù xml ØŒ Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„: "192.168.0.220/phonebook" </li></ol><br>  ÙŠØ´Ø§Ø± Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø·Ù„Ø¨. <br><br>  <b>Ø§Ù„Ø®Ø·ÙˆØ© 3. Ø¥Ù†Ø´Ø§Ø¡ Ø¯Ù„ÙŠÙ„ Ø¯ÙØªØ± Ø§Ù„Ù‡Ø§ØªÙ Ø¹Ù„Ù‰ Ø´Ø¨ÙƒØ© Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</b> <br><br><img src="https://habrastorage.org/webt/6j/-p/_u/6j-p_ugxxm08bugu1jcstcav6ym.png"><br><br>  Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù pb.php. <br><br>  Ø§Ù„Ø¶ÙˆØ¡. <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Ø£ÙˆÙ„ ØªØ­Ù…ÙŠÙ„ Ù…Ù† Ù…Ù„Ù XML ÙˆÙ…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ </li><li style=";text-align:right;direction:rtl">  Ù‚Ù… Ø¨Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ÙˆØ¹Ø±Ø¶ Ø¬Ù‡Ø§Øª Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©. </li></ol><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Ù…Ù„Ù Config.php</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="php hljs">&lt;html&gt; &lt;style&gt; &lt;!-- <span class="hljs-comment"><span class="hljs-comment">/*  HTML  */</span></span> table.sort{ border-spacing:<span class="hljs-number"><span class="hljs-number">0</span></span>em; margin-bottom:<span class="hljs-number"><span class="hljs-number">1</span></span>em; margin-top:<span class="hljs-number"><span class="hljs-number">1</span></span>em } <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> table.sort td{ border:<span class="hljs-number"><span class="hljs-number">1</span></span>px solid <span class="hljs-comment"><span class="hljs-comment">#CCCCCC; padding:0.3em 1em } /*   */ table.sort thead td{ cursor:pointer; cursor:hand; font-weight:bold; text-align:center; vertical-align:middle } tbody tr:hover { background: #999999; /*     */ color: #FFFFFF; /*     */ } /*    */ table.sort thead td.curcol{ background-color:#999999; color:#FFFFFF } --&gt; &lt;/style&gt; &lt;script type="text/javascript"&gt; initial_sort_id = 0; //    ,    initial_sort_up = 0; // 0 -  , 1 -  var sort_case_sensitive = false; //      function _sort(a, b) { var a = a[0]; var b = b[0]; var _a = (a + '').replace(/,/, '.'); var _b = (b + '').replace(/,/, '.'); if (parseInt(_a) &amp;&amp; parseInt(_b)) return sort_numbers(parseInt(_a), parseInt(_b)); else if (!sort_case_sensitive) return sort_insensitive(a, b); else return sort_sensitive(a, b); } function sort_numbers(a, b) { return a - b; } function sort_insensitive(a, b) { var anew = a.toLowerCase(); var bnew = b.toLowerCase(); if (anew &lt; bnew) return -1; if (anew &gt; bnew) return 1; return 0; } function sort_sensitive(a, b) { if (a &lt; b) return -1; if (a &gt; b) return 1; return 0; } function getConcatenedTextContent(node) { var _result = ""; if (node == null) { return _result; } var childrens = node.childNodes; var i = 0; while (i &lt; childrens.length) { var child = childrens.item(i); switch (child.nodeType) { case 1: // ELEMENT_NODE case 5: // ENTITY_REFERENCE_NODE _result += getConcatenedTextContent(child); break; case 3: // TEXT_NODE case 2: // ATTRIBUTE_NODE case 4: // CDATA_SECTION_NODE _result += child.nodeValue; break; case 6: // ENTITY_NODE case 7: // PROCESSING_INSTRUCTION_NODE case 8: // COMMENT_NODE case 9: // DOCUMENT_NODE case 10: // DOCUMENT_TYPE_NODE case 11: // DOCUMENT_FRAGMENT_NODE case 12: // NOTATION_NODE // skip break; } i++; } return _result; } function sort(e) { var el = window.event ? window.event.srcElement : e.currentTarget; while (el.tagName.toLowerCase() != "td") el = el.parentNode; var a = new Array(); var name = el.lastChild.nodeValue; var dad = el.parentNode; var table = dad.parentNode.parentNode; var up = table.up; // no set/getAttribute! var node, arrow, curcol; for (var i = 0; (node = dad.getElementsByTagName("td").item(i)); i++) { if (node.lastChild.nodeValue == name){ curcol = i; if (node.className == "curcol"){ arrow = node.firstChild; table.up = Number(!up); }else{ node.className = "curcol"; arrow = node.insertBefore(document.createElement("span"),node.firstChild); arrow.appendChild(document.createTextNode("")); table.up = 0; } arrow.innerHTML=((table.up==0)?"â†“":"â†‘")+" "; }else{ if (node.className == "curcol"){ node.className = ""; if (node.firstChild) node.removeChild(node.firstChild); } } } var tbody = table.getElementsByTagName("tbody").item(0); for (var i = 0; (node = tbody.getElementsByTagName("tr").item(i)); i++) { a[i] = new Array(); a[i][0] = getConcatenedTextContent(node.getElementsByTagName("td").item(curcol)); a[i][1] = getConcatenedTextContent(node.getElementsByTagName("td").item(1)); a[i][2] = getConcatenedTextContent(node.getElementsByTagName("td").item(0)); a[i][3] = node; } a.sort(_sort); if (table.up) a.reverse(); for (var i = 0; i &lt; a.length; i++) { tbody.appendChild(a[i][3]); } } function init(e) { if (!document.getElementsByTagName) return; if (document.createEvent) function click_elem(elem){ var evt = document.createEvent("MouseEvents"); evt.initMouseEvent("click", false, false, window, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, elem); elem.dispatchEvent(evt); } for (var j = 0; (thead = document.getElementsByTagName("thead").item(j)); j++) { var node; for (var i = 0; (node = thead.getElementsByTagName("td").item(i)); i++) { if (node.addEventListener) node.addEventListener("click", sort, false); else if (node.attachEvent) node.attachEvent("onclick", sort); node.title = "  ,   "; } thead.parentNode.up = 0; if (typeof(initial_sort_id) != "undefined"){ td_for_event = thead.getElementsByTagName("td").item(initial_sort_id); if (td_for_event.dispatchEvent) click_elem(td_for_event); else if (td_for_event.fireEvent) td_for_event.fireEvent("onclick"); if (typeof(initial_sort_up) != "undefined" &amp;&amp; initial_sort_up){ if (td_for_event.dispatchEvent) click_elem(td_for_event); else if (td_for_event.fireEvent) td_for_event.fireEvent("onclick"); } } } } var root = window.addEventListener || window.attachEvent ? window : document.addEventListener ? document : null; if (root){ if (root.addEventListener) root.addEventListener("load", init, false); else if (root.attachEvent) root.attachEvent("onload", init); } //  function getCookie(name) { var cookie = " " + document.cookie; var search = " " + name + "="; var setStr = null; var offset = 0; var end = 0; if (cookie.length &gt; 0) { offset = cookie.indexOf(search); if (offset != -1) { offset += search.length; end = cookie.indexOf(";", offset) if (end == -1) { end = cookie.length; } setStr = unescape(cookie.substring(offset, end)); } } return(setStr); } //    function selectChanged() { var sel = document.getElementById('myselect'); var str = sel.selectedIndex+1 ? (sel.options[sel.selectedIndex].innerHTML) : '  '; document.cookie = "sgrp="+str+";"; //document.getElementById('nameslist').innerHTML = '&lt;?php $hello = $_COOKIE["sgrp"]; echo $hello; ?&gt;'; location.reload(); } &lt;/script&gt; &lt;strong&gt; &lt;div style="text-align: center;"&gt; &lt;/div&gt; &lt;br&gt; &lt;/strong&gt; &lt;?php $xml = simplexml_load_file('http://192.168.0.220/phonebook/phonebook.xml'); $conts_cnt = count($xml-&gt;Contact); $grp_cnt = count($xml-&gt;pbgroup); //    echo '&lt;div id="groupslist" style="width: 20%; float:left"&gt; &lt;strong&gt;:&lt;/strong&gt; &lt;br&gt; &lt;br&gt; &lt;select id="myselect" size="20" onchange="javascript:selectChanged();"&gt;'; echo "&lt;option&gt;&lt;/option&gt;"; for($ig = 0; $ig &lt; $grp_cnt; $ig++) { $Groups = $xml-&gt;pbgroup[$ig]; if ($Groups-&gt;name &lt;&gt; 'User Manager Group') echo "&lt;option&gt;{$Groups-&gt;name}&lt;/option&gt;"; } echo "&lt;/select&gt; &lt;/div&gt;"; //   echo '&lt;div id="nameslist" style="width: 80%; float:right"&gt;'; echo "&lt;strong&gt;{$_COOKIE['sgrp']}&lt;/strong&gt;"; echo "&lt;table class=sort align=center width=100%&gt;"; echo "&lt;thead&gt;"; echo "&lt;tr&gt;"; echo "&lt;td&gt;&lt;/td&gt;"; echo "&lt;td&gt;&lt;/td&gt;"; echo "&lt;td&gt;&lt;/td&gt;"; //echo "&lt;td&gt;&lt;/td&gt;"; echo "&lt;/tr&gt;"; echo "&lt;/thead&gt;"; echo "&lt;tbody&gt;"; for($i = 0; $i &lt; $conts_cnt; $i++) { $Contacts = $xml-&gt;Contact[$i]; $FirstName = $Contacts-&gt;FirstName; $LastName = $Contacts-&gt;LastName; $phonenumber = $Contacts-&gt;Phone-&gt;phonenumber; echo "&lt;tr&gt;"; for($ig = 0; $ig &lt; $grp_cnt; $ig++) { $Groups = $xml-&gt;pbgroup[$ig]; if (strcasecmp($Contacts-&gt;Group, $Groups-&gt;id) == 0) { if ($_COOKIE["sgrp"] == trim($Groups-&gt;name)) { echo "&lt;td class=col1&gt;{$FirstName}&lt;/td&gt;"; echo "&lt;td class=col1&gt;{$LastName}&lt;/td&gt;"; echo "&lt;td class=col1&gt;{$phonenumber}&lt;/td&gt;"; //echo "&lt;td class=col1&gt;{$Groups-&gt;name}&lt;/td&gt;"; } else if ("" == $_COOKIE["sgrp"]) { echo "&lt;td class=col1&gt;{$FirstName}&lt;/td&gt;"; echo "&lt;td class=col1&gt;{$LastName}&lt;/td&gt;"; echo "&lt;td class=col1&gt;{$phonenumber}&lt;/td&gt;"; } } } echo "&lt;/tr&gt;"; } echo "&lt;/tbody&gt;"; echo "&lt;/table&gt;"; echo '&lt;/div&gt;'; ?&gt; &lt;/html&gt;</span></span></code> </pre><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar465825/">https://habr.com/ru/post/ar465825/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar465813/index.html">14 Ù†ØµØ§Ø¦Ø­ Ù„ÙƒØªØ§Ø¨Ø© Ø±Ù…Ø² Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ù†Ø¸ÙŠÙ. Ø§Ù„Ø¬Ø²Ø¡ 2</a></li>
<li><a href="../ar465815/index.html">Ù†Ù…Ø§ Ø§Ù„Ø¹Ù„Ù…Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ù…Ù† Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ø¹ØµØ¨ÙŠØ© ÙˆØ£Ø±Ø³Ù„ÙˆÙ‡Ø§ Ø¥Ù„Ù‰ Ù…Ø­Ø·Ø© Ø§Ù„ÙØ¶Ø§Ø¡ Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©</a></li>
<li><a href="../ar465817/index.html">ÙƒÙŠÙ ÙŠØ³Ø§Ø¹Ø¯Ù†Ø§ Ø¹Ø¯Ù… Ø§Ù„Ø±Ø§Ø­Ø© ÙÙŠ ØªØ­Ø³ÙŠÙ† Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ·ÙˆÙŠØ±.</a></li>
<li><a href="../ar465819/index.html">Ø´Ø¨ÙƒØ© Ù…Ø­Ù„ÙŠØ© Ù…Ø«Ø§Ù„ÙŠØ©</a></li>
<li><a href="../ar465823/index.html">Ù…Ø´ØºÙ„ Tarantool kubernetes</a></li>
<li><a href="../ar465829/index.html">[Ø¯Ø±ÙˆØ³] ÙƒÙŠÙÙŠØ© Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙˆÙ„ Ù„Ø¹Ø¨Ø© Ø¬Ø§ÙØ§ Ø³ÙƒØ±ÙŠØ¨Øª IDLE ØªØ²Ø§ÙŠØ¯ÙŠ</a></li>
<li><a href="../ar465833/index.html">TOKEN2 Molto-1 ØŒ Ø£ÙˆÙ„ Ø±Ù…Ø² Ù…Ù…ÙŠØ² Ù„Ø£Ø¬Ù‡Ø²Ø© TOTP ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…</a></li>
<li><a href="../ar465835/index.html">Ù…ØµÙ†Ø¹ Ù…Ø¬Ø±Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£ØµØ§Ø¨Ø¹</a></li>
<li><a href="../ar465839/index.html">ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬ Ù„Ù…Ø¹Ø±ÙØªÙ‡ Ø­ÙˆÙ„ CSS Margin</a></li>
<li><a href="../ar465841/index.html">ØªØ¹Ù‚Ø¨ GPS BOXY</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>