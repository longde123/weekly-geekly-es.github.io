<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•´ üì£ üëè M√©canisme de soumission - Magie cubaine sp√©ciale ‚õé ‚è´ üï†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les vues, ou vues, est l'un des concepts de la plateforme CUBA, pas le plus courant dans le monde des frameworks web. Comprendre cela signifie vous √©v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>M√©canisme de soumission - Magie cubaine sp√©ciale</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/haulmont/blog/425765/"><p><img src="https://habrastorage.org/webt/ro/89/bc/ro89bcf9p8amjxin9ca0ksoctf8.jpeg" alt="CPAP"></p><br><p>  Les vues, ou vues, est l'un des concepts de la plateforme CUBA, pas le plus courant dans le monde des frameworks web.  Comprendre cela signifie vous √©viter des erreurs stupides lorsque, en raison d'un chargement de donn√©es incomplet, l'application cesse soudainement de fonctionner.  Voyons quelles sont les repr√©sentations (jeu de mots) et pourquoi elles sont r√©ellement pratiques. </p><br><h3 id="problema-nezagruzhennyh-dannyh">  Le probl√®me des donn√©es d√©charg√©es </h3><br><p>  Prenons un sujet plus simple et consid√©rons le probl√®me en utilisant son exemple.  Supposons que nous ayons une entit√© <em>Client</em> qui se r√©f√®re √† une entit√© <em>CustomerType</em> dans une relation plusieurs-√†-un, en d'autres termes, l'acheteur a un lien vers un certain type qui le d√©crit: par exemple, "vache √† lait", "vivaneau", etc.  L'entit√© <em>CustomerType</em> a un attribut de <em>nom</em> dans lequel le nom de type est stock√©. </p><br><p>  Et, probablement, tous les nouveaux arrivants (ou m√™me les utilisateurs avanc√©s) de CUBA ont t√¥t ou tard re√ßu cette erreur: </p><br><p><code>IllegalStateException: Cannot get unfetched attribute [type] from detached object com.rtcab.cev.entity.Customer-e703700d-c977-bd8e-1a40-74afd88915af [detached].</code> </p> <br><p><img src="https://habrastorage.org/webt/-x/ss/fm/-xssfm8nzwvf86jcicyrelm5nby.png" alt="Impossible d'obtenir une erreur d'attribut non r√©cup√©r√©e dans l'interface utilisateur CUBA"></p><br><p>  Avouez-le, vous l'avez aussi vu de vos propres yeux?  Je - oui, dans une centaine de situations diff√©rentes.  Dans cet article, nous examinerons la cause de ce probl√®me, pourquoi il existe et comment le r√©soudre. <br>  Pour commencer, une petite introduction au concept de vues. </p><br><h3 id="chto-takoe-predstavlenie">  Qu'est-ce qu'une vue? </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Une vue</a> dans CUBA est essentiellement une collection de colonnes dans une base de donn√©es qui doivent √™tre charg√©es ensemble dans une seule requ√™te. </p><a name="habracut"></a><br><p>  Supposons que nous voulons cr√©er une interface utilisateur avec une table client, o√π la premi√®re colonne est le nom du client et la seconde est le nom du type de l'attribut <em>customerType</em> (comme dans la capture d'√©cran ci-dessus).  Il est logique de supposer que dans ce mod√®le de donn√©es, nous aurons deux tables distinctes dans la base de donn√©es, une pour l'entit√© <em>Customer</em> , l'autre pour <em>CustomerType</em> .  La <code>SELECT * from CEV_CUSTOMER</code> nous renverra les donn√©es d'une seule table ( <code>name</code> attribut, etc.).  √âvidemment, pour obtenir √©galement des donn√©es d'autres tables, nous utiliserons JOINs. </p><br><p>  Dans le cas de l'utilisation de requ√™tes SQL classiques √† l'aide de JOIN, la hi√©rarchie des associations (attributs de r√©f√©rence) se d√©veloppe √† partir du graphique dans une liste plate. <br>  <em>Note du traducteur: en d'</em> autres termes, les relations entre les tables sont effac√©es et le r√©sultat est pr√©sent√© dans un seul tableau de donn√©es repr√©sentant l'union des tables. </p><br><p>  Dans le cas de CUBA, ORM est utilis√©, qui ne perd pas d'informations sur les relations entre les entit√©s et pr√©sente le r√©sultat des requ√™tes sous la forme d'un graphique int√©gral des donn√©es demand√©es.  Dans ce cas, JPQL, un objet analogique de SQL, est utilis√© comme langage de requ√™te. </p><br><p>  N√©anmoins, les donn√©es doivent encore √™tre d√©charg√©es d'une mani√®re ou d'une autre de la base de donn√©es et transform√©es en un graphique d'entit√©.  Pour cela, le m√©canisme de mappage objet-relationnel (qui est JPA) a deux approches principales pour les requ√™tes vers la base de donn√©es. </p><br><h3 id="lazy-loading-vs-eager-fetching">  Chargement paresseux vs.  d√©sireux d'aller chercher </h3><br><p>  Le chargement paresseux et le chargement gourmand sont deux strat√©gies possibles pour obtenir des donn√©es de la base de donn√©es.  La diff√©rence fondamentale entre les deux r√©side dans le chargement des donn√©es des tables li√©es.  Un petit exemple pour une meilleure compr√©hension: </p><br><p>  Vous vous souvenez de la sc√®ne du livre "Le Hobbit ou aller-retour", o√π un groupe de gnomes en compagnie de Gandalf et Bilbo essaient de demander √† passer la nuit dans la maison de Beorn?  Gandalf a ordonn√© aux nains d'appara√Ætre strictement √† son tour et seulement apr√®s avoir soigneusement convenu avec Beorn et a commenc√© √† les pr√©senter un √† la fois afin de ne pas choquer le propri√©taire par la n√©cessit√© d'accueillir 15 invit√©s √† la fois. </p><br><p><img src="https://habrastorage.org/webt/ys/pm/ql/yspmqlsytd5vmefxszi9xeqqduc.jpeg" alt="Gandalf et les nains dans la maison de Beorn"></p><br><p>  Donc, Gandalf et les gnomes dans la maison de Beorn ... Ce n'est probablement pas la premi√®re chose qui me vient √† l'esprit en pensant aux t√©l√©chargements paresseux et gourmands, mais il y a certainement des similitudes.  Gandalf a agi sagement ici, car il √©tait conscient des limites.  On peut dire qu'il a consciemment choisi le chargement paresseux des gnomes, car il a compris que le t√©l√©chargement de toutes les donn√©es √† la fois serait une op√©ration trop lourde pour cette base de donn√©es.  Cependant, apr√®s le 8e gnome, Gandalf est pass√© au chargement gourmand et a charg√© un tas des gnomes restants, car il a remarqu√© que des appels trop fr√©quents √† la base de donn√©es commen√ßaient √† le rendre moins √©nervant. </p><br><p>  La morale est que le chargement paresseux et gourmand a ses avantages et ses inconv√©nients.  Quoi appliquer dans chaque situation sp√©cifique, vous d√©cidez. </p><br><h3 id="problema-zaprosa-n1">  Probl√®me de demande N + 1 </h3><br><p>  Le probl√®me de requ√™te N + 1 se pose souvent si vous utilisez inconsid√©r√©ment le chargement paresseux o√π que vous alliez.  Pour illustrer, regardons un morceau de code Grails.  Cela ne signifie pas que dans Grails, tout se charge paresseusement (en fait, vous choisissez vous-m√™me la m√©thode de d√©marrage).  Dans Grails, une requ√™te vers la base de donn√©es par d√©faut renvoie des instances d'entit√© avec tous les attributs de sa table.  Essentiellement, <code>SELECT * FROM Pet</code> est ex√©cut√©. </p><br><p>  Si vous voulez approfondir les relations entre les entit√©s, vous devez le faire post factum.  Voici un exemple: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> getPetOwnerNamesForPets(String nameOfPet) { def pets = Pet.findAll(sort:"name") { <span class="hljs-type"><span class="hljs-type">name</span></span> == nameOfPet } def ownerNames = [] pets.<span class="hljs-keyword"><span class="hljs-keyword">each</span></span> { ownerNames &lt;&lt; it.<span class="hljs-keyword"><span class="hljs-keyword">owner</span></span>.name } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ownerNames.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(", ") }</code> </pre> <br><p>  Le graphique est <code>it.owner.name</code> ici par une seule ligne: <code>it.owner.name</code> .  Le propri√©taire est une relation qui n'a pas √©t√© charg√©e dans la demande d'origine ( <code>Pet.findAll</code> ).  Ainsi, √† chaque appel de cette ligne, GORM fera quelque chose comme <code>SELECT * FROM Person WHERE id='‚Ä¶'</code> .  Chargement paresseux √† l'eau pure. </p><br><p>  Si vous calculez le nombre total de requ√™tes SQL, vous obtenez N (un propri√©taire pour chaque appel <code>it.owner</code> ) + 1 (pour le <code>Pet.findAll</code> origine).  Si vous souhaitez approfondir le graphique des entit√©s li√©es, il est probable que votre base de donn√©es trouvera rapidement ses limites. </p><br><p>  En tant que d√©veloppeur, vous ne le remarquerez probablement pas, car de votre point de vue, vous ne faites que parcourir le graphique des objets.  Cette imbrication cach√©e dans une courte ligne cause une r√©elle douleur √† la base de donn√©es et rend le chargement paresseux parfois dangereux. </p><br><p>  En d√©veloppant une analogie hobby, le probl√®me de N + 1 pourrait se manifester comme suit: imaginez que Gandalf n'est pas capable de stocker les noms des gnomes dans sa m√©moire.  Par cons√©quent, introduisant les nains un par un, il est oblig√© de se retirer dans son groupe et de demander son nom au nain.  Avec ces informations, il retourne √† Beorn et repr√©sente Thorin.  Il r√©p√®te ensuite cette man≈ìuvre pour Bifur, Bofur, Fili, Kili, Dori, Nori, Ori, Oin, Gloyn, Balin, Dvalin et Bombur. </p><br><p><img src="https://habrastorage.org/webt/fw/g_/vs/fwg_vscjob0zb0yzrn7dhrj2o_s.jpeg" alt="Probl√®me des Nains N + 1"></p><br><p>  Il est facile d'imaginer qu'un tel sc√©nario serait peu susceptible de na√Ætre: quel destinataire voudrait attendre si longtemps les informations demand√©es?  Par cons√©quent, vous ne devez pas utiliser cette approche sans r√©fl√©chir et vous fier aveugl√©ment aux param√®tres par d√©faut de votre mappeur de persistance. </p><br><h3 id="reshaem-problemu-zaprosov-n1-s-pomoschyu-cuba-views">  R√©solution du probl√®me des requ√™tes N + 1 √† l'aide des vues CUBA </h3><br><p>  Dans CUBA, vous ne rencontrerez probablement jamais le probl√®me de requ√™te N + 1, car la plate-forme a d√©cid√© de ne pas utiliser du tout le chargement paresseux cach√©.  Au lieu de cela, CUBA a introduit le concept de repr√©sentations.  Les vues sont une description des attributs qui doivent √™tre s√©lectionn√©s et charg√©s avec les instances d'entit√©.  Quelque chose comme </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pet.name, person.name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Pet pet <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> Person person <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> pet.owner == person.id</code> </pre> <br><p>  D'une part, la vue d√©crit les colonnes qui doivent √™tre charg√©es √† partir de la table principale ( <em>Pet</em> ) (au lieu de charger tous les attributs via *), d'autre part, elle d√©crit les colonnes qui doivent √™tre charg√©es √† partir des tables c-JOIN. </p><br><p>  Vous pouvez imaginer la vue CUBA comme vue SQL pour OR-Mapper: le principe de fonctionnement est √† peu pr√®s le m√™me. </p><br><p>  Dans la plate-forme CUBA, vous ne pouvez pas appeler une requ√™te via le DataManager sans utiliser la vue.  La documentation fournit un exemple: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DataManager dataManager; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Book </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadBookById</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UUID bookId)</span></span></span><span class="hljs-function"> </span></span>{ LoadContext&lt;Book&gt; loadContext = LoadContext.create(Book.class) .setId(bookId).setView(<span class="hljs-string"><span class="hljs-string">"book.edit"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dataManager.load(loadContext); }</code> </pre> <br><p>  Ici, nous voulons t√©l√©charger le livre par son ID.  La <code>setView("book.edit")</code> , lors de la cr√©ation d'un contexte de chargement, indique avec quelle vue le livre doit √™tre charg√© √† partir de la base de donn√©es.  Si vous ne transmettez aucune vue, le gestionnaire de donn√©es utilise l'une des trois vues standard de chaque entit√©: la <em>vue _local</em> .  Local fait ici r√©f√©rence √† des attributs qui ne font pas r√©f√©rence √† d'autres tables, tout est simple. </p><br><h3 id="reshenie-problemy-s-illegalstateexception-cherez-views">  R√©solution du probl√®me avec IllegalStateException via des vues </h3><br><p>  Maintenant que nous comprenons un peu le concept de repr√©sentation, revenons au premier exemple du d√©but de l'article et essayons d'√©viter de lever une exception. </p><br><p>  Le message <em>IllegalStateException: impossible d'obtenir l'attribut non r√©cup√©r√© [] de l'objet d√©tach√©</em> signifie simplement que vous essayez d'afficher un attribut qui n'est pas inclus dans la vue avec laquelle l'entit√© est charg√©e. </p><br><p>  Comme vous pouvez le voir, dans le descripteur de l'√©cran de navigation, j'ai utilis√© la <em>vue _local</em> , et c'est tout le probl√®me: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dsContext</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customersDs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.rtcab.cev.entity.Customer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">view</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_local"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> &lt;![CDATA[select e from cev$Customer e]]&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dsContext</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Pour supprimer l'erreur, vous devez d'abord inclure le type de client dans la vue.  Comme nous ne pouvons pas changer la vue par d√©faut de <em>_local</em> , nous pouvons cr√©er la n√¥tre.  Dans Studio, cela peut √™tre fait, par exemple, comme suit (clic droit sur les entit√©s&gt; cr√©er une vue): </p><br><p><img src="https://habrastorage.org/webt/ki/oz/vy/kiozvyydas04xj9ypswst8afvxo.png" alt="Cr√©ation d'une vue dans Studio"></p><br><p>  soit directement dans le descripteur <a href="">views.xml</a> de notre application: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">view</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.rtcab.cev.entity.Customer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">extends</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_local"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customer-view"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">view</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_minimal"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">view</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Apr√®s cela, nous modifions le lien vers la vue dans l'√©cran de navigation, comme ceci: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customersDs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.rtcab.cev.entity.Customer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">view</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customer-view"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> &lt;![CDATA[select e from cev$Customer e]]&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Cela r√©sout compl√®tement le probl√®me, et maintenant les donn√©es du lien sont affich√©es dans l'√©cran de visualisation du client. </p><br><h3 id="predstavlenie-_minimal-i-ponyatie-instance-name">  _Minimal view and instance name </h3><br><p>  Ce qui m√©rite d'√™tre mentionn√© dans le contexte des vues, c'est la vue <em>_minimal</em> .  La vue locale a une d√©finition tr√®s claire: elle inclut tous les attributs de l'entit√©, qui sont des attributs directs de la table (qui ne sont pas des cl√©s √©trang√®res). </p><br><p>  La d√©finition d'une repr√©sentation minimale n'est pas si √©vidente, mais aussi assez claire. </p><br><p>  CUBA a le concept d'un nom d'instance d'entit√© - nom d'instance.  Le nom de l'instance est l'√©quivalent de la <code>toString()</code> dans le bon vieux Java.  Il s'agit d'une repr√©sentation sous forme de cha√Æne d'une entit√© √† afficher sur une interface utilisateur et √† utiliser dans les liens.  Le nom de l'instance est d√©fini √† l'aide de l'annotation de l'entit√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">NamePattern</a> . </p><br><p>  Il est utilis√© comme ceci: <code>@NamePattern("%s (%s)|name,code")</code> .  Nous avons deux r√©sultats: </p><br><h4 id="imya-ekzemplyara-opredelyaet-otobrazhenie-suschnosti-v-ui">  Le nom d'instance d√©finit le mappage de l'entit√© avec l'interface utilisateur </h4><br><p>  Tout d'abord, le nom de l'instance d√©termine quoi et dans quel ordre sera affich√© dans l'interface utilisateur si une entit√© fait r√©f√©rence √† une autre entit√© (comme <em>Client</em> fait r√©f√©rence √† <em>CustomerType</em> ). </p><br><p>  Dans notre cas, le type de client sera affich√© comme le nom de l'instance <em>CustomerType</em> , √† laquelle le code est ajout√© aux crochets.  Si le nom d'instance n'est pas d√©fini, le nom de la classe d'entit√© et l'ID de l'instance sp√©cifique seront affich√©s - convenez que ce n'est pas du tout ce que l'utilisateur aimerait voir.  Voir les captures d'√©cran avant et apr√®s ci-dessous pour des exemples des deux cas. </p><br><p><img src="https://habrastorage.org/webt/wa/gd/u8/wagdu8lfbckngwhi2swjhgj8mxe.png" alt="R√©f√©rence √† une entit√© pour laquelle aucun nom d'instance n'est sp√©cifi√©"></p><br><p><img src="https://habrastorage.org/webt/uy/7f/ok/uy7fokvhqcl9m5jx0ui1ju2v4l0.png" alt="Une r√©f√©rence d'entit√© avec le nom d'instance donn√©"></p><br><h4 id="imya-ekzemplyara-opredelyaet-atributy-minimalnogo-predstavleniya">  Le nom de l'instance d√©finit les attributs de vue minimum </h4><br><p>  La deuxi√®me chose que l'annotation NamePattern affecte est: tous les attributs sp√©cifi√©s apr√®s la barre verticale forment automatiquement une vue <em>_minimal</em> .  √Ä premi√®re vue, cela semble √©vident, car les donn√©es sous une forme ou une autre doivent √™tre affich√©es dans l'interface utilisateur, ce qui signifie que vous devez d'abord les t√©l√©charger √† partir de la base de donn√©es.  Bien que, pour √™tre honn√™te, je pense rarement √† ce fait. </p><br><p>  Il est important de noter ici que la repr√©sentation minimale, si elle est compar√©e √† la repr√©sentation locale, peut contenir des r√©f√©rences √† d'autres entit√©s.  Par exemple, pour l'acheteur de l'exemple ci-dessus, j'ai d√©fini un nom d'instance, qui comprend un attribut local de l'entit√© <em>Client</em> ( <code>name</code> ) et un attribut de r√©f√©rence ( <code>type</code> ): </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@NamePattern</span></span>(<span class="hljs-string"><span class="hljs-string">"%s - %s|name,type"</span></span>)</code> </pre> <br><p>  La repr√©sentation minimale peut √™tre utilis√©e r√©cursivement: (Client [Nom de l'instance] -&gt; Type de client [Nom de l'instance]) </p><br><p>  <em>Note du traducteur:</em> depuis la publication de l'article, une autre vue syst√®me est apparue: la vue <code>_base</code> , qui inclut tous les attributs locaux non syst√®me et les attributs sp√©cifi√©s dans l'annotation @NamePattern (c'est-√†-dire en fait <code>_minimal</code> + <code>_local</code> ). </p><br><h3 id="zaklyuchenie">  Conclusion </h3><br><p>  En conclusion, nous r√©sumons le sujet le plus important.  Gr√¢ce aux vues, dans CUBA, nous pouvons indiquer explicitement ce qui doit √™tre charg√© √† partir de la base de donn√©es.  Les vues d√©terminent ce qui sera charg√© avec gourmandise, tandis que la plupart des autres frameworks effectuent secr√®tement un chargement paresseux. </p><br><p>  Les repr√©sentations peuvent sembler √™tre un m√©canisme lourd, mais √† long terme elles se justifient. </p><br><p>  J'esp√®re avoir r√©ussi √† expliquer de mani√®re accessible ce que sont r√©ellement ces vues myst√©rieuses.  Bien s√ªr, il existe des sc√©narios plus avanc√©s pour leur utilisation, ainsi que des pi√®ges dans le travail avec les repr√©sentations en g√©n√©ral et avec des repr√©sentations minimales en particulier, mais j'√©crirai √† ce sujet dans un article s√©par√© d'une mani√®re ou d'une autre. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr425765/">https://habr.com/ru/post/fr425765/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr425753/index.html">Google+ RIP</a></li>
<li><a href="../fr425755/index.html">D√©veloppement: New Generation Messenger (Partie 3). Applications de bureau</a></li>
<li><a href="../fr425759/index.html">Nouvelles aventures de Cyborg en Allemagne</a></li>
<li><a href="../fr425761/index.html">Test DevDay Pro: enregistrement de rapports</a></li>
<li><a href="../fr425763/index.html">PHP Excel Templator (moteur de cr√©ation de mod√®les PHP pour Excel) ou comment nous avons √©crit le code dur pour Excel avant</a></li>
<li><a href="../fr425767/index.html">Splunk 7.2 Quoi de neuf? SmartStore, gestion de charge et plus ...</a></li>
<li><a href="../fr425769/index.html">Comment apprendre √† MySQL √† regarder dans le pass√©</a></li>
<li><a href="../fr425771/index.html">Le principe de moindre action en m√©canique analytique</a></li>
<li><a href="../fr425773/index.html">Comment nous contr√¥lons les employ√©s distants</a></li>
<li><a href="../fr425775/index.html">Automatisation de l'industrie du sexe ou des services publics en allemand</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>