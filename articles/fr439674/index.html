<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèáüèΩ üë®‚Äçüé§ üò≠ Renforcement de l'apprentissage en profondeur: ping pong pixel brut ‚öíÔ∏è üíπ üë©üèº‚Äçüöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il s'agit d'un article attendu depuis longtemps sur l'apprentissage par renforcement (RL). RL est un sujet cool! 

 Vous savez peut-√™tre que les ordin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Renforcement de l'apprentissage en profondeur: ping pong pixel brut</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439674/">  Il s'agit d'un article attendu depuis longtemps sur l'apprentissage par renforcement (RL).  RL est un sujet cool! <br><br>  Vous savez peut-√™tre que les ordinateurs peuvent d√©sormais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">apprendre automatiquement √† jouer aux jeux ATARI</a> (en obtenant des pixels de jeu bruts √† l'entr√©e!).  Ils ont battu les champions du monde dans le jeu de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Go</a> , les quadrup√®des virtuels apprennent √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">courir et √† sauter</a> , et les robots apprennent √† effectuer des t√¢ches de manipulation complexes qui d√©fient la programmation explicite.  Il s'av√®re que toutes ces r√©alisations ne sont pas compl√®tes sans RL.  J'ai √©galement √©t√© int√©ress√© par RL au cours de la derni√®re ann√©e: j'ai travaill√© avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le</a> livre de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Richard Sutton (r√©f√©rence approximative: remplac√©)</a> , lu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le</a> cours de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">David Silver</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">assist√© aux conf√©rences de John Schulman</a> , √©crit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la biblioth√®que RL sur Javascript</a> et effectu√© un stage chez DeepMind en √©t√©, travaillant dans un groupe DeepRL, et plus r√©cemment, dans le d√©veloppement d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OpenAI Gym</a> , est la nouvelle bo√Æte √† outils RL.  Donc, bien s√ªr, je fais partie de cette vague depuis au moins un an, mais je n'ai pas encore pris la peine d'√©crire une note sur pourquoi RL est d'une grande importance, de quoi il s'agit, comment tout cela se d√©veloppe. <br><br><img src="https://habrastorage.org/webt/vr/ir/gu/vrirgukar82fw0cg6wbnsklagum.png"><br>  <i>Exemples d'utilisation de Deep Q-Learning.</i>  <i>De gauche √† droite: le r√©seau neuronal joue ATARI, le r√©seau neuronal joue AlphaGo, le robot plie Lego, le quadrup√®de virtuel court autour des obstacles virtuels.</i> <br><a name="habracut"></a><br>  Il est int√©ressant de r√©fl√©chir √† la nature des progr√®s r√©cents en mati√®re de RL.  Je voudrais noter quatre facteurs distincts affectant le d√©veloppement de l'IA: <br><br><ol><li>  Vitesse de calcul (GPU, dispositifs sp√©ciaux ASIC, loi de Moore) </li><li>  Donn√©es suffisantes sous une forme utilisable (par exemple ImageNet) </li><li>  Algorithmes (recherche et id√©es, par exemple backprop, CNN, LSTM) </li><li>  Infrastructure (Linux, TCP / IP, Git, ROS, PR2, AWS, AMT, TensorFlow, etc.). </li></ol><br>  Tout comme en vision par ordinateur, les progr√®s en RL √©voluent ... mais pas autant que cela puisse para√Ætre.  Par exemple, en vision par ordinateur, le r√©seau neuronal AlexNet 2012 est une version augment√©e en profondeur et en largeur du r√©seau neuronal ConvNets des ann√©es 1990.  De m√™me, ATARI Deep Q-Learning 2013 est une impl√©mentation de l'algorithme Q-Learning standard que vous pouvez trouver dans le livre classique de Richard Sutton de 1998.  De plus, AlphaGo utilise la technique du gradient politique et la recherche d'arbre Monte Carlo (SCTM) sont √©galement de vieilles id√©es ou leurs combinaisons.  Bien s√ªr, il faut beaucoup de comp√©tences et de patience pour les faire fonctionner, et de nombreux param√®tres d√©licats ont √©t√© d√©velopp√©s en plus des anciens algorithmes.  <b>Mais en premi√®re approximation, le principal moteur des progr√®s r√©cents n'est pas les nouveaux algorithmes et id√©es, mais l'intensification des calculs, des donn√©es suffisantes et une infrastructure mature.</b> <br><br>  Revenons maintenant √† RL.  Beaucoup de gens ne peuvent pas croire que nous pouvons enseigner √† un ordinateur comment jouer √† des jeux ATARI √† un niveau humain en utilisant des pixels bruts √† partir de z√©ro et en utilisant le m√™me algorithme d'auto-apprentissage.  En m√™me temps, chaque fois que je ressens un √©cart - √† quel point cela semble magique et √† quel point c'est vraiment simple √† l'int√©rieur. <br><br>  L'approche de base que nous utilisons est en fait assez stupide.  Quoi qu'il en soit, je voudrais vous pr√©senter la technique Policy Gradient (PG), notre choix par d√©faut pr√©f√©r√© pour r√©soudre les probl√®mes avec RL en ce moment.  Vous pouvez √™tre curieux de savoir pourquoi, √† la place, je ne peux pas imaginer DQN, qui est un algorithme RL alternatif et mieux connu qui est √©galement utilis√© dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">formation ATARI</a> .  Il s'av√®re que bien que le Q-Learning soit connu, il n'est pas si parfait.  La plupart des gens choisissent d'utiliser Policy Gradient, y compris les auteurs de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article DQN</a> original, qui ont montr√© qu'avec un bon r√©glage, Policy Gradient fonctionne encore mieux que Q-Learning.  PG est pr√©f√©rable car il est explicite: il existe une politique claire et une approche coh√©rente qui optimise directement les r√©compenses attendues.  √Ä titre d'exemple, nous allons apprendre √† jouer √† ATARI Pong: √† partir de z√©ro, √† partir de pixels bruts √† travers un gradient de politique avec un r√©seau de neurones.  Et nous allons mettre tout cela dans 130 lignes de Python.  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lien essentiel</a> ) Voyons comment cela se fait. <br><br><img src="https://habrastorage.org/webt/yy/fk/hg/yyfkhg3xutt4gsualf7l6o0sa4i.gif"><br><img src="https://habrastorage.org/webt/mw/rq/2w/mwrq2wthkobnxuqohcfovs1lgei.jpeg"><br>  <i>Ci-dessus: Ping Pong.</i>  <i>Ci-dessous: Pr√©sentation du ping-pong comme cas particulier du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">processus d√©cisionnel de Markov (MDP)</a> : chaque sommet du graphique correspond √† un certain √©tat du jeu, et les bords d√©terminent les probabilit√©s de transition vers d'autres √©tats.</i>  <i>Chaque c√¥te d√©termine √©galement la r√©compense.</i>  <i>Le but est de trouver le meilleur chemin √† partir de n'importe quel √©tat pour maximiser la r√©compense</i> <br><br>  Jouer au ping-pong est un excellent exemple d'un d√©fi RL.  Dans la version ATARI 2600, nous jouerons nous-m√™mes une raquette.  Une autre raquette est contr√¥l√©e par un algorithme int√©gr√©.  Nous devons frapper la balle pour que l'autre joueur n'ait pas le temps de la frapper.  J'esp√®re qu'il n'est pas n√©cessaire d'expliquer ce qu'est le Ping Pong.  √Ä un niveau bas, le jeu fonctionne comme suit: nous obtenons un cadre d'image - un tableau d'octets 210x160x3, et d√©cidons si nous voulons d√©placer la raquette UP ou DOWN.  Autrement dit, nous n'avons que deux choix pour g√©rer le jeu.  Apr√®s chaque choix, le simulateur de jeu effectue son action et nous donne une r√©compense: soit +1 r√©compense si le ballon a d√©pass√© la raquette de l'adversaire, soit -1 si nous avons rat√© le ballon.  Sinon 0. Et, bien s√ªr, notre objectif est de d√©placer la raquette afin que nous obtenions autant de r√©compenses que possible. <br><br>  Lorsque vous envisagez une solution, n'oubliez pas que nous allons essayer de faire si peu d'hypoth√®ses sur le pong, car ce n'est pas particuli√®rement important dans la pratique.  Nous prenons beaucoup plus de choses en compte dans les t√¢ches √† grande √©chelle, telles que la manipulation de robots, l'assemblage et la navigation.  Pong est juste un cas de test amusant avec lequel nous jouons pendant que nous d√©couvrons comment √©crire des syst√®mes d'IA tr√®s g√©n√©raux qui peuvent un jour effectuer des t√¢ches utiles arbitraires. <br><br>  <b>R√©seau de neurones comme politique RL</b> .  Premi√®rement, nous allons d√©terminer la soi-disant politique que notre joueur (ou ¬´agent¬ª) met en ≈ìuvre.  ((*) ¬´Agent¬ª, ¬´environnement¬ª et ¬´politique d'agent¬ª sont des termes standard de la th√©orie RL).  La fonction politique dans notre cas est un r√©seau de neurones.  Elle acceptera l'√©tat du jeu √† l'entr√©e et √† la sortie elle d√©cidera quoi faire - monter ou descendre.  Comme bloc de calcul simple pr√©f√©r√©, nous utiliserons un r√©seau neuronal √† deux couches qui prend des pixels d'image bruts (total de 100800 nombres (210 * 160 * 3)) et produit un nombre unique indiquant la probabilit√© de d√©placer la raquette vers le haut.  Veuillez noter que l'utilisation de la politique stochastique est standard, ce qui signifie que nous ne produisons que la probabilit√© d'un mouvement √† la hausse.  Pour obtenir le mouvement r√©el, nous utiliserons cette probabilit√©.  La raison de cela deviendra plus claire lorsque nous parlerons de formation. <br><br><img src="https://habrastorage.org/webt/cm/n4/ap/cmn4apvesxvu5d8konqytnbk0cm.png"><br>  <i>Notre fonction politique consistant en un r√©seau neuronal √† 2 couches enti√®rement connect√©</i> <br><br>  Plus pr√©cis√©ment, supposons qu'√† l'entr√©e, nous obtenons un vecteur X, qui contient un ensemble de pixels pr√©trait√©s.  Ensuite, nous devons calculer en utilisant python \ numpy: <br><br><pre><code class="python hljs">h = np.dot(W1, x) <span class="hljs-comment"><span class="hljs-comment"># compute hidden layer neuron activations h[h&lt;0] = 0 # ReLU nonlinearity: threshold at zero logp = np.dot(W2, h) # compute log probability of going up p = 1.0 / (1.0 + np.exp(-logp)) # sigmoid function (gives probability of going up)</span></span></code> </pre> <br>  Dans ce fragment, W1 et W2 sont deux matrices que nous initialisons au hasard.  Nous n'utilisons pas de parti pris, car nous le voulions.  Notez qu'au final, nous utilisons la non-lin√©arit√© du sigmo√Øde, ce qui r√©duit la probabilit√© de sortie √† la plage [0,1].  Intuitivement, les neurones dans une couche cach√©e (dont les poids sont situ√©s dans W1) peuvent d√©tecter divers sc√©narios de jeu (par exemple, la balle est au-dessus et notre raquette est au milieu), et les poids dans W2 peuvent alors d√©cider si nous devons augmenter dans chaque cas ou vers le bas.  Les W1 et W2 al√©atoires initiaux, bien s√ªr, provoqueront d'abord des spasmes et des convulsions chez notre neuro-joueur, ce qui l'√©galera comme un imb√©cile autiste aux commandes d'un avion.  La seule t√¢che maintenant est donc de trouver W1 et W2, ce qui conduit √† un bon jeu! <br><br>  Il y a une remarque √† propos du pr√©traitement des pixels - id√©alement, vous devez transf√©rer au moins 2 images sur le r√©seau neuronal afin qu'il puisse d√©tecter les mouvements.  Mais pour simplifier la situation, nous appliquerons la diff√©rence de deux images.  Autrement dit, nous soustraireons les trames actuelles et pr√©c√©dentes et n'appliquerons alors la diff√©rence qu'√† l'entr√©e du r√©seau neuronal. <br><br>  <b>Cela ressemble √† quelque chose d'impossible.</b>  √Ä ce stade, j'aimerais que vous compreniez la complexit√© du probl√®me RL.  Nous obtenons 100 800 nombres (210x160x 3) et les envoyons √† notre r√©seau de neurones qui met en ≈ìuvre la politique du joueur (qui, incidemment, comprend facilement environ un million de param√®tres dans les matrices W1 et W2).  Supposons qu'√† un moment donn√©, nous d√©cidions de monter.  Le simulateur de jeu peut r√©pondre que cette fois nous obtiendrons 0 r√©compenses et nous donnerons encore 100 800 num√©ros pour la prochaine image.  Nous pouvons r√©p√©ter ce processus des centaines de fois avant d'obtenir une r√©compense non nulle!  Par exemple, supposons que nous ayons finalement obtenu une r√©compense +1.  C'est merveilleux, mais comment alors dire - qu'est-ce qui a men√© √† cela?  √âtait-ce l'action que nous avons faite tout √† l'heure?  Ou peut-√™tre 76 images en arri√®re?  Ou peut-√™tre que cela a d'abord √©t√© associ√© √† l'image 10, puis nous avons fait quelque chose de bien dans l'image 90?  Et comment savoir - lequel des millions de "stylos" tourner afin d‚Äôobtenir un succ√®s encore plus grand √† l‚Äôavenir?  Nous appelons cela la t√¢che de d√©terminer le coefficient de confiance dans certaines actions.  Dans le cas sp√©cifique du pong, nous savons que nous obtenons +1 si le ballon d√©passe l'adversaire.  La vraie raison est que nous avons accidentellement bott√© le ballon le long d'un bon chemin √† quelques images en arri√®re, et chaque action ult√©rieure que nous avons effectu√©e ne l'a pas affect√©e du tout.  En d'autres termes, nous sommes confront√©s √† un probl√®me de calcul tr√®s complexe, et tout semble plut√¥t sombre. <br><br>  <b>Formation avec un professeur.</b>  Avant de nous plonger dans le gradient de la politique (PG), je voudrais rappeler bri√®vement l'enseignement avec un enseignant, car, comme nous le verrons, RL est tr√®s similaire.  Reportez-vous au tableau ci-dessous.  Dans l'enseignement ordinaire avec un professeur, nous transf√©rerons l'image sur le r√©seau et recevrons en sortie des probabilit√©s num√©riques pour les classes.  Par exemple, dans notre cas, nous avons deux classes: UP et DOWN.  J'utilise les probabilit√©s logarithmiques (-1,2, -0,36) au lieu des probabilit√©s au format 30% et 70%, car nous optimisons la probabilit√© logarithmique de la bonne classe (ou √©tiquette).  Cela rend les calculs math√©matiques plus √©l√©gants et √©quivaut √† optimiser la probabilit√© juste, car le logarithme est monotone. <br><br>  En formation avec un professeur, nous aurons un acc√®s instantan√© √† la bonne classe (label).  Au stade de la formation, ils nous diront exactement quelle bonne √©tape est n√©cessaire en ce moment (disons que c'est UP, √©tiquette 0), bien que le r√©seau neuronal puisse penser diff√©remment.  Par cons√©quent, nous calculons le gradient <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-9" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"> l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;">p </font></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17"><font style="vertical-align: inherit;">y </font></span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;">= </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;">U </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;">P </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;">d </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;">x </font></span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mtext" id="MJXp-Span-11">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-21">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.327ex" height="2.66ex" viewBox="0 -832 12196.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6E" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-61" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-62" x="1380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6C" x="1809" y="0"></use><g transform="translate(2108,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-57" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6C" x="3728" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6F" x="4027" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-67" x="4512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-70" x="4993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-28" x="5496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-79" x="5886" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-3D" x="6661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-55" x="7717" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-50" x="8485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6D" x="9486" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="10365" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-64" x="10710" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-78" x="11234" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-29" x="11806" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ nabla_ {W} \ log p (y = UP \ mid x) </script>  pour modifier les param√®tres r√©seau.  Ce gradient nous indique simplement comment nous devons modifier chacun de nos millions de param√®tres afin que le r√©seau soit l√©g√®rement plus susceptible de pr√©voir UP dans la m√™me situation.  Par exemple, l'un des millions de param√®tres du r√©seau peut avoir un gradient de -2,1, ce qui signifie que si nous augmentions ce param√®tre d'une petite valeur positive (par exemple, 0,001), la probabilit√© logarithmique de UP diminuerait de 2,1 * 0,001.  (diminution due au signe n√©gatif).  Si nous appliquons le gradient puis mettons √† jour le param√®tre √† l'aide de l'algorithme de r√©tropropagation, alors, oui, notre r√©seau donnera une forte probabilit√© de UP lorsqu'il verra la m√™me image ou une image tr√®s similaire √† l'avenir. <br><br><img src="https://habrastorage.org/webt/-p/r6/bu/-pr6bumeyrk2xdf9nuoulm5oflw.png"><br><br>  <b>Gradients de politique (PG)</b> .  OK, mais que faisons-nous si nous n'avons pas le bon label de formation de renforcement?  Voici une solution pour PG (reportez-vous √† nouveau au sch√©ma ci-dessous).  Notre r√©seau de neurones a calcul√© la probabilit√© d'une augmentation de 30% (logprob -1,2) et d'une baisse de 70% (logprob -0,36).  Maintenant, nous faisons une s√©lection √† partir de cette distribution et sp√©cifions quelle action nous allons faire.  Par exemple, ils ont choisi DOWN et envoy√© cette action au simulateur de jeu.  √Ä ce stade, faites attention √† un fait int√©ressant: nous pourrions imm√©diatement calculer et appliquer le gradient pour l'action DOWN, comme nous l'avons fait dans l'enseignement avec un enseignant, et ainsi rendre le r√©seau plus susceptible d'ex√©cuter l'action DOWN √† l'avenir.  Ainsi, nous pouvons imm√©diatement appr√©cier et m√©moriser ce gradient.  Mais le probl√®me est que pour le moment nous ne le savons pas encore - est-ce bon de descendre?  <b>Mais la chose la plus int√©ressante est que nous pouvons simplement attendre un peu et appliquer le gradient plus tard!</b>  √Ä Pong, nous pouvons attendre la fin de la partie, puis prendre la r√©compense que nous avons re√ßue (soit +1 si nous avons gagn√©, soit -1 si nous avons perdu), et la saisir comme facteur de gradient.  Donc, si nous introduisons -1 pour la probabilit√© DOWN et faisons la propagation arri√®re, nous reconstruirons les param√®tres du r√©seau afin qu'il soit moins susceptible d'ex√©cuter l'action DOWN √† l'avenir lorsqu'elle rencontrera la m√™me image, car l'adoption de cette action nous a fait perdre le jeu.  Autrement dit, nous devrons en quelque sorte nous souvenir de toutes les actions (entr√©es et sorties du r√©seau neuronal) dans un √©pisode du jeu et, sur la base de ce tableau, tordre le r√©seau neuronal presque de la m√™me mani√®re que dans l'enseignement avec un enseignant. <br><br><img src="https://habrastorage.org/webt/hj/jr/tg/hjjrtgpmkweozlnidrhixsf7jfs.png"><br><br>  Et c'est tout ce qui est n√©cessaire: nous avons une politique stochastique qui choisit les actions, puis √† l'avenir, les actions qui conduisent finalement √† de bons r√©sultats sont encourag√©es, et les actions qui conduisent √† de mauvais r√©sultats ne sont pas encourag√©es.  De plus, la r√©compense ne devrait m√™me pas √™tre +1 ou -1 si nous gagnons finalement la partie.  Il peut s'agir d'une valeur arbitraire de m√™me signification.  Par exemple, si tout fonctionne tr√®s bien, la r√©compense pourrait √™tre 10,0, que nous utilisons ensuite comme gradient pour d√©marrer la r√©tropropagation backprop.  C'est la beaut√© des r√©seaux de neurones.  Leur utilisation peut sembler un canular: vous √™tes autoris√© √† avoir 1 million de param√®tres int√©gr√©s dans 1 t√©raflop de calculs, et vous pouvez faire apprendre au programme √† faire des choses arbitraires avec la descente de gradient stochastique (SGD).  √áa ne devrait pas marcher, mais c'est dr√¥le que nous vivions dans un univers o√π √ßa marche. <br><br>  Si nous jouions √† des jeux de soci√©t√© simples, comme des dames, la commande serait √† peu pr√®s la m√™me.  Il existe une diff√©rence notable par rapport aux algorithmes d'√©cr√™tage minimax ou alpha-b√™ta.  Dans ces algorithmes, le programme regarde en avant, connaissant les r√®gles du jeu, et analyse des millions de positions.  Dans l'approche RL, seuls les mouvements r√©ellement effectu√©s sont analys√©s.  Dans le m√™me temps, le r√©seau neuronal ne regarde pas vers l'avant, car il ne sait rien des r√®gles du jeu. <br><br>  <b>Ordre d'entra√Ænement en d√©tail.</b>  Nous cr√©ons et initialisons un r√©seau de neurones avec certains W1, W2 et jouons 100 parties de pong (nous l'appelons le ¬´rodage¬ª de la politique, les d√©ploiements de politiques).  Supposons que chaque jeu se compose de 200 images, donc au total, nous avons pris 100 * 200 = 20 000 d√©cisions de monter ou de descendre.  Et pour chacune des solutions, nous connaissons un gradient qui nous indique comment les param√®tres devraient changer si nous voulons encourager ou interdire cette solution dans cet √©tat √† l'avenir.  Il ne reste plus qu'√† √©tiqueter chaque d√©cision que nous prenons comme bonne ou mauvaise.  Par exemple, supposons que nous ayons gagn√© 12 matchs et perdu 88. Nous prendrons toutes les 200 * 12 = 2400 d√©cisions que nous avons prises dans les jeux gagnants et effectuerons une mise √† jour positive (en remplissant un gradient +1,0 pour chaque action, en faisant un backprop et en mettant √† jour les param√®tres encourageant les actions que nous avons choisies dans toutes ces conditions).  Et nous prendrons les 200 * 88 = 17 600 autres d√©cisions que nous avons prises en perdant des jeux et effectuerons une mise √† jour n√©gative (n'approuvant pas ce que nous avons fait).  Et c'est tout ce qu'il faut.  Le r√©seau sera d√©sormais plus susceptible de r√©p√©ter des actions qui ont fonctionn√© et l√©g√®rement moins susceptibles de r√©p√©ter des actions qui n'ont pas fonctionn√©.  Maintenant, nous jouons 100 autres jeux avec notre nouvelle politique l√©g√®rement am√©lior√©e, puis r√©p√©tons l'application des d√©grad√©s. <br><br><img src="https://habrastorage.org/webt/zv/ap/mo/zvapmoiul9plnltsttdsplvze3g.png"><br>  <i>Sch√©ma de dessin anim√© de 4 jeux.</i>  <i>Chaque cercle noir est une sorte d'√©tat de jeu (trois exemples d'√©tats sont pr√©sent√©s ci-dessous), et chaque fl√®che est une transition marqu√©e par l'action qui a √©t√© s√©lectionn√©e.</i>  <i>Dans ce cas, nous avons gagn√© 2 matchs et perdu 2 matchs.</i>  <i>Nous avons pris les deux matchs gagn√©s et avons l√©g√®rement encourag√© chaque action que nous avons faite dans cet √©pisode.</i>  <i>Inversement, nous prendrons √©galement les deux matchs perdus et d√©couragerons l√©g√®rement chaque action individuelle que nous avons effectu√©e dans cet √©pisode.</i> <br><br>  Si vous r√©fl√©chissez √† cela, vous commencerez √† trouver des propri√©t√©s amusantes.  Par exemple, que se passe-t-il si nous effectuons une bonne action dans l'image 50, en bottant correctement le ballon, mais que nous ratons ensuite le ballon dans l'image 150?  Depuis que nous avons perdu le jeu, chaque action individuelle est maintenant marqu√©e comme mauvaise, et cela n'emp√™che-t-il pas le coup correct √† l'image 50?  Vous avez raison - il en sera ainsi pour cette f√™te.  Cependant, lorsque vous consid√©rez le processus dans des milliers / millions de jeux, la bonne ex√©cution du rebond augmente vos chances de gagner √† l'avenir.  En moyenne, vous verrez des mises √† jour plus positives que n√©gatives pour une frappe de raquette appropri√©e.  Et la politique de mise en ≈ìuvre du r√©seau de neurones produira finalement les bonnes r√©actions. <br><br>  <i>Mise √† jour: le 9 d√©cembre 2016</i> est une vue alternative.  Dans mon explication ci-dessus, j'utilise des termes tels que ¬´d√©finir un gradient et une propagation arri√®re de backprop¬ª, qui est une technique habile d√©finie.  Si vous avez l'habitude d'√©crire votre propre code back-backprop ou d'utiliser Torch, vous pouvez contr√¥ler enti√®rement les d√©grad√©s.  Cependant, si vous √™tes habitu√© √† Theano ou TensorFlow, vous serez un peu perplexe car le code backprop est enti√®rement automatis√© et difficile √† personnaliser.  Dans ce cas, la vue alternative suivante peut √™tre plus productive.  En enseignant avec un enseignant, l'objectif habituel est de maximiser <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mtext" id="MJXp-Span-28">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-33" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35"><font style="vertical-align: inherit;"> l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;">p </font></span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-msubsup" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">y </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-42" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"> m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;">d </font></span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">x </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> )</font></span></font><span class="MJXp-mtext" id="MJXp-Span-34">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-42" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-43">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.045ex" height="2.66ex" viewBox="0 -832 9060.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6C" x="2764" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6F" x="3063" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-67" x="3548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-70" x="4029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-28" x="4532" y="0"></use><g transform="translate(4922,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6D" x="6007" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="6885" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-64" x="7231" y="0"></use><g transform="translate(7754,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-29" x="8671" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ sum_i \ log p (y_i \ mid x_i) </script>  o√π <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-51"><span class="MJXp-msubsup" id="MJXp-Span-52"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-54" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-58" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.102ex" height="1.817ex" viewBox="0 -520.7 2196.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-2C" x="916" y="0"></use><g transform="translate(1361,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="693" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> x_i, y_i </script>  - des exemples de formation (tels que des images et leurs √©tiquettes).  L'application du gradient √† la fonction politique co√Øncide exactement avec la formation avec l'enseignant, mais avec deux petites diff√©rences: 1) nous n'avons pas les bonnes √©tiquettes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-59"><span class="MJXp-msubsup" id="MJXp-Span-60"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-62" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="1.817ex" viewBox="0 -520.7 834.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> y_i </script>  , par cons√©quent, en tant que ¬´faux label¬ª, nous utilisons l'action que nous avons re√ßue pour s√©lectionner dans la politique lorsqu'elle a vu <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-63"><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-66" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.129ex" height="1.817ex" viewBox="0 -520.7 916.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="809" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> x_i </script>  , et 2) Nous introduisons un autre coefficient d'opportunit√© (avantage) pour chaque action.  Ainsi, √† la fin, notre perte ressemble maintenant √† <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-67"><span class="MJXp-mtext" id="MJXp-Span-68">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-73" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-76" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78"><font style="vertical-align: inherit;"> l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81"><font style="vertical-align: inherit;">p </font></span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-msubsup" id="MJXp-Span-83"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">y </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-83"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-85" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87"><font style="vertical-align: inherit;"> m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89"><font style="vertical-align: inherit;">d </font></span><span class="MJXp-msubsup" id="MJXp-Span-90"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">x </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-90"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-92" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> )</font></span></font><span class="MJXp-mtext" id="MJXp-Span-77">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-83"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-85" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-86">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-90"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-92" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.588ex" height="2.66ex" viewBox="0 -832 10155.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="1242" y="-213"></use></g><g transform="translate(2514,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="1061" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6C" x="3859" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6F" x="4158" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-67" x="4643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-70" x="5124" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-28" x="5627" y="0"></use><g transform="translate(6017,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6D" x="7101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="7980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-64" x="8325" y="0"></use><g transform="translate(8849,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-29" x="9766" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> \ sum_i A_i \ log p (y_i \ mid x_i) </script>  o√π <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-97" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="1.817ex" viewBox="0 -520.7 834.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> y_i </script>  - c'est l'action que nous avons r√©alis√©e avec l'√©chantillon, et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-98"><span class="MJXp-msubsup" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-101" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.543ex" height="2.419ex" viewBox="0 -780.1 1094.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="1061" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> A_i </script>  Est le nombre que nous appelons le coefficient d'opportunit√©.  Par exemple, dans le cas du pong, la valeur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-102"><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-105" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.543ex" height="2.419ex" viewBox="0 -780.1 1094.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="1061" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> A_i </script>  il pourrait √™tre de 1,0 si nous finissons par gagner l'√©pisode, et de -1,0 si nous perdons.  Cela garantit que nous maximisons la probabilit√© d'enregistrer des actions qui ont conduit √† un bon r√©sultat et minimisons la probabilit√© d'enregistrer des actions qui ne l'ont pas fait.  Et des actions neutres √† la suite de nombreux appels n'affecteront pas particuli√®rement la fonction de la politique.  Ainsi, l'apprentissage par renforcement est exactement le m√™me que l'apprentissage avec un enseignant, mais sur un ensemble de donn√©es en constante √©volution (√©pisodes), avec un facteur suppl√©mentaire. <br><br>  <b>Fonctions de faisabilit√© plus avanc√©es.</b>  J'ai √©galement promis un peu plus d'informations.  Jusqu'√† pr√©sent, nous avons √©valu√© l'exactitude de chaque action individuelle selon que nous gagnions ou non.  Dans une configuration RL plus g√©n√©rale, nous recevrons une ¬´r√©compense conditionnelle¬ª <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-106"><span class="MJXp-msubsup" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-109" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.875ex" height="1.817ex" viewBox="0 -520.7 807.1 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-74" x="638" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> r_t </script>  pour chaque √©tape, en fonction du num√©ro ou de l'heure.  L'une des options courantes consiste √† utiliser un coefficient actualis√©, de sorte que la ¬´r√©compense possible¬ª dans le diagramme ci-dessus sera <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-110"><span class="MJXp-msubsup" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-113" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-115">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">u</span><span class="MJXp-msubsup" id="MJXp-Span-118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-124"><span class="MJXp-mtext" id="MJXp-Span-125">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">y</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">k</span><span class="MJXp-mo" id="MJXp-Span-122">=</span><span class="MJXp-mn" id="MJXp-Span-123">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-131">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">m</span><span class="MJXp-msubsup" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-138" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-141" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">t</span><span class="MJXp-mo" id="MJXp-Span-143">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.746ex" height="3.503ex" viewBox="0 -1091.4 12376.9 1508.3" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-74" x="1074" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-3D" x="1392" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-73" x="2699" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-75" x="3168" y="0"></use><g transform="translate(3741,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,490)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-69" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6E" x="699" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-66" x="1299" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-74" x="1850" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-79" x="2211" y="0"></use></g><g transform="translate(878,-327)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-30" x="1300" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-67" x="6885" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-61" x="7365" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6D" x="7895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6D" x="8773" y="0"></use><g transform="translate(9652,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6B" x="748" y="513"></use></g><g transform="translate(10650,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMAIN-2B" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6B" x="1140" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-11"> R_t = \ sum_ {k = 0} ^ {\ infty} \ gamma ^ k r_ {t + k} </script>  o√π <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-mtext" id="MJXp-Span-146">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.237ex" height="1.817ex" viewBox="0 -520.7 3546.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-67" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-61" x="730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6D" x="1260" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-6D" x="2138" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg3RJH17u9eCtjv0U5jN7sy7tD3mA#MJMATHI-61" x="3017" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> \ gamma </script>  Est un nombre de 0 √† 1, appel√© coefficient d'actualisation (par exemple, 0,99).  L'expression dit que la force avec laquelle nous encourageons l'action est la somme pond√©r√©e de toutes les r√©compenses, mais les r√©compenses suivantes sont exponentiellement moins importantes.  Autrement dit, les courtes cha√Ænes d'actions sont mieux encourag√©es et la queue des longues cha√Ænes d'actions devient moins importante.  En pratique, vous devez √©galement les normaliser.  Par exemple, supposons que nous calculons <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-152"><span class="MJXp-msubsup" id="MJXp-Span-153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-155" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> R_t </script>  pour l'ensemble des 20 000 actions d'une s√©rie de 100 √©pisodes du jeu.  Une tr√®s bonne id√©e est de normaliser ces valeurs (soustraire la moyenne, diviser par l'√©cart-type) avant de les connecter √† l'algorithme backprop.  Ainsi, nous encourageons et d√©courageons toujours environ la moiti√© des actions effectu√©es.  Cela r√©duit les fluctuations et rend la politique plus convergente.  Une √©tude plus approfondie est disponible sur [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien</a> ]. <br><br>  <b>D√©riv√© d'une fonction de politique.</b>  Je voulais √©galement d√©crire bri√®vement comment les d√©grad√©s sont pris math√©matiquement.  Les gradients de la fonction de la politique sont un cas particulier d'une th√©orie plus g√©n√©rale.  Le cas g√©n√©ral est que lorsque nous avons une expression de la forme <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-156"><span class="MJXp-msubsup" id="MJXp-Span-157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-159" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">x</span><span class="MJXp-mtext" id="MJXp-Span-161">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">p</span><span class="MJXp-mo" id="MJXp-Span-166">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">x</span><span class="MJXp-mtext" id="MJXp-Span-168">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">d</span><span class="MJXp-mtext" id="MJXp-Span-172">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">a</span><span class="MJXp-mo" id="MJXp-Span-178">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">f</span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">x</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> E_ {x \ sim p (x \ mid \ theta)} [f (x)] </script>  , c'est-√†-dire l'attente d'une fonction scalaire <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">f</span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">x</span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> f (x) </script>  avec une certaine distribution de son param√®tre <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">p</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">x</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-195">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">a</span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> p (x; \ theta) </script>  param√©tr√© par un vecteur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-202"><span class="MJXp-mtext" id="MJXp-Span-203">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> \ theta </script>  .  Alors <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">f</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">x</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> f (x) </script>  deviendra notre fonction de r√©compense (ou la fonction d'opportunit√© dans un sens plus g√©n√©ral), et la distribution discr√®te <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">p</span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">x</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> p (x) </script>  sera notre politique, qui a en fait la forme <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">p</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">a</span><span class="MJXp-mtext" id="MJXp-Span-223">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">I</span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> p (a \ mid I) </script>  donnant les probabilit√©s d'une action a pour l'image <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">I</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> I </script>  .  Ensuite, nous voulons savoir comment d√©placer la distribution de p √† travers ses param√®tres <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-231"><span class="MJXp-mtext" id="MJXp-Span-232">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> \ theta </script>  agrandir <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> f </script>  (c'est-√†-dire comment modifions-nous les param√®tres r√©seau pour que les actions obtiennent une r√©compense plus √©lev√©e).  Nous avons ceci: <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-240"><span class="noError" id="MJXp-Span-241" style="display: inline-block;">\&nbsp;begin&nbsp;{align}&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;E_x&nbsp;[f&nbsp;(x)]&nbsp;&amp;&nbsp;=&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;sum_x&nbsp;p&nbsp;(x)&nbsp;f&nbsp;(x)&nbsp;&amp;&nbsp;\&nbsp;text&nbsp;{d√©finition&nbsp;de&nbsp;l'attente}&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;\&nbsp;sum_x&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;p&nbsp;(x)&nbsp;f&nbsp;(x)&nbsp;&amp;&nbsp;\&nbsp;text&nbsp;{permuter&nbsp;la&nbsp;somme&nbsp;et&nbsp;le&nbsp;gradient}&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;\&nbsp;sum_x&nbsp;p&nbsp;(x)&nbsp;\&nbsp;frac&nbsp;{\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;p&nbsp;(x)}&nbsp;{p&nbsp;(x)}&nbsp;f&nbsp;(x)&nbsp;&amp;&nbsp;\&nbsp;text&nbsp;{multiplier&nbsp;et&nbsp;diviser&nbsp;par}&nbsp;p&nbsp;(x)&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;\&nbsp;sum_x&nbsp;p&nbsp;(x)&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;log&nbsp;p&nbsp;(x)&nbsp;f&nbsp;(x)&nbsp;&amp;&nbsp;\&nbsp;text&nbsp;{utiliser&nbsp;le&nbsp;fait&nbsp;que}&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;log&nbsp;(z)&nbsp;=&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{z}&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;z&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;E_x&nbsp;[f&nbsp;(x)&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;log&nbsp;p&nbsp;(x)]&nbsp;&amp;&nbsp;\&nbsp;text&nbsp;{d√©finition&nbsp;de&nbsp;l'attente}&nbsp;\&nbsp;end&nbsp;{align}</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> \ begin {align} \ nabla _ {\ theta} E_x [f (x)] & = \ nabla _ {\ theta} \ sum_x p (x) f (x) & \ text {d√©finition de l'attente} \\ & = \ sum_x \ nabla _ {\ theta} p (x) f (x) & \ text {permuter la somme et le gradient} \\ & = \ sum_x p (x) \ frac {\ nabla _ {\ theta} p (x)} {p (x)} f (x) & \ text {multiplier et diviser par} p (x) \\ & = \ sum_x p (x) \ nabla _ {\ theta} \ log p (x) f (x) & \ text {utiliser le fait que} \ nabla _ {\ theta} \ log (z) = \ frac {1} {z} \ nabla _ {\ theta} z \\ & = E_x [f (x) \ nabla _ {\ theta} \ log p (x)] & \ text {d√©finition de l'attente} \ end {align} </script><br><br>  Je vais essayer de l'expliquer.  Nous avons une certaine distribution <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">p</span><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">x</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-247">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">a</span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> p (x; \ theta) </script>  (J'ai utilis√© l'abr√©viation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">p</span><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">x</span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> p (x) </script>  √† partir de laquelle nous pouvons s√©lectionner des valeurs sp√©cifiques.  Par exemple, il peut s'agir d'une distribution gaussienne √† partir de laquelle un g√©n√©rateur de nombres al√©atoires √©chantillonne.  Pour chaque exemple, nous pouvons √©galement calculer la fonction d'estimation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> f </script>  , qui selon l'exemple actuel nous donne une estimation scalaire.  L'√©quation r√©sultante nous indique comment d√©placer la distribution √† travers ses param√®tres <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-mtext" id="MJXp-Span-262">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> \ theta </script>  si nous voulons d'autres exemples d'actions bas√©es sur elle pour obtenir des taux plus √©lev√©s <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> f </script>  .  Nous prenons quelques exemples d'actions <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> x </script>  et leur √©valuation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">f</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">x</span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> f (x) </script>  , et aussi pour chaque x, nous √©valuons √©galement le deuxi√®me terme <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-277"><span class="MJXp-mtext" id="MJXp-Span-278">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">l</span><span class="MJXp-msubsup" id="MJXp-Span-283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-285" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-286">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-292">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">p</span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">x</span><span class="MJXp-mo" id="MJXp-Span-299" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-300">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">a</span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> \ nabla _ {\ theta} \ log p (x; \ theta) </script>  .  Quel est ce multiplicateur?  C'est pr√©cis√©ment le vecteur - le gradient, qui nous donne une direction dans l'espace des param√®tres, ce qui entra√Ænera une augmentation de la probabilit√© d'une action sp√©cifique <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> x </script>  .  En d'autres termes, si nous avons pouss√© Œ∏ dans la direction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-309"><span class="MJXp-mtext" id="MJXp-Span-310">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">l</span><span class="MJXp-msubsup" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-317" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-318">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-324">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">p</span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">x</span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-332">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">a</span><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> \ nabla _ {\ theta} \ log p (x; \ theta) </script>  , nous verrions que la nouvelle probabilit√© de cette action augmentera l√©g√®rement.  Si vous regardez en arri√®re la formule, elle nous dit que nous devons prendre cette direction et multiplier la valeur scalaire par elle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">f</span><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">x</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> f (x) </script>  .  Cela garantira que les exemples d'actions avec une note plus √©lev√©e (dans notre cas, une r√©compense) ¬´tireront¬ª plus fortement que les exemples avec un indicateur plus bas, donc, si nous devions mettre √† jour sur la base de plusieurs √©chantillons <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> p </script>  , la densit√© de probabilit√© se d√©placerait vers la direction des points de jeu r√©sultants plus √©lev√©s, ce qui augmente la probabilit√© d'obtenir des exemples d'actions avec des r√©compenses √©lev√©es.  Il est important que le gradient ne soit pas pris de la fonction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> f </script>  , car il peut g√©n√©ralement √™tre indiff√©renci√© et impr√©visible.  Un <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> p </script>  diff√©renciable par <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-350"><span class="MJXp-mtext" id="MJXp-Span-351">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> \ theta </script>  .  C‚Äôest <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> p </script>  est une distribution discr√®te r√©glable en continu, o√π vous pouvez ajuster les probabilit√©s d'actions individuelles.  Nous supposons √©galement que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> p </script>  normalis√©. <br><br><img src="https://habrastorage.org/webt/xo/qy/9p/xoqy9pzjvy4d3sxosr_irpasic4.png"><br><br>  <i>Visualisation du d√©grad√©.</i>  <i>Gauche: distribution gaussienne et plusieurs exemples de celle-ci (points bleus).</i>  <i>√Ä chaque point bleu, nous tra√ßons √©galement le gradient de la probabilit√© logarithmique par rapport au param√®tre moyen.</i>  <i>La fl√®che indique la direction dans laquelle la valeur de distribution moyenne doit √™tre d√©cal√©e pour augmenter la probabilit√© de cet exemple d'action.</i>  <i>Au milieu: Ajout d'une fonction d'√©valuation qui donne -1 partout sauf +1 dans certaines petites r√©gions (notez que cela peut √™tre une fonction scalaire arbitraire et pas n√©cessairement diff√©rentiable).</i>  <i>Les fl√®ches sont maintenant cod√©es par couleur, car en raison de la multiplication, nous allons faire la moyenne de toutes les fl√®ches vertes avec une note positive et des fl√®ches rouges n√©gatives.</i>  <i>Droite: apr√®s la mise √† jour des param√®tres, les fl√®ches vertes et les fl√®ches rouges invers√©es nous poussent vers la gauche et vers le bas.</i>  <i>Si vous le souhaitez, les √©chantillons de cette distribution auront d√©sormais une note attendue plus √©lev√©e.</i> <br><br>  J'esp√®re que le lien avec RL est clair.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notre politique nous donne des exemples d'actions, et certaines d'entre elles fonctionnent mieux que d'autres (√† en juger par la fonction d'opportunit√©). La fa√ßon de modifier les param√®tres de strat√©gie consiste √† ex√©cuter, √† prendre le gradient des actions s√©lectionn√©es, √† le multiplier par la note et √† ajouter tout ce que nous avons fait ci-dessus. Pour une conclusion plus approfondie, je recommande une conf√©rence de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">John Shulman. </font></font><br></a> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La formation.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eh bien, nous avons d√©velopp√© les principes des gradients de la fonction de la politique. J'ai impl√©ment√© toute l'approche dans un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script Python de 130 lignes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui utilise l'√©mulateur ATAI 2600 Pong pr√™t √† l'emploi d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAI Gym</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. J'ai form√© un r√©seau neuronal √† deux couches avec 200 neurones √† couche cach√©e en utilisant l'algorithme RMSProp pour une s√©rie de 10 √©pisodes (chaque √©pisode selon les r√®gles se compose de plusieurs tirages au sort et l'√©pisode continue de marquer 21). Je n'ai pas trop configur√© les param√®tres hyper et j'ai exp√©riment√© sur mon Macbook lent, mais apr√®s une s√©ance d'entra√Ænement de trois jours, j'ai eu une politique qui joue un peu mieux que le lecteur int√©gr√©. Le nombre total d'√©pisodes √©tait d'environ 8 000, donc l'algorithme a jou√© environ 200 000 jeux de pong, ce qui est beaucoup, et a produit un total d'environ 800 mises √† jour des poids. Si je me suis entra√Æn√© sur le GPU avec ConvNets, alors en quelques jours, je pourrais obtenir d'excellents r√©sultats, et si j'optimisais les hyperparam√®tres, je pourrais toujours gagner. Cependant, je n'ai pas pass√© trop de temps √† calculer ou √† configurer,nous avons donc obtenu Pong AI, qui illustre les principales id√©es et fonctionne assez bien:</font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/cf/gf/jr/cfgfjrkzt_awy-l7f5lcxcrfvki.png"></a> <br> <i>  .      </i> <br><br> <b> .</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous pouvons √©galement regarder les poids obtenus du r√©seau neuronal. Gr√¢ce au pr√©traitement, chacune de nos entr√©es est une image de diff√©rence de 80x80 (image actuelle moins image pr√©c√©dente). Chaque neurone de la couche W1 est connect√© √† une couche cach√©e W2 compos√©e de 200 neurones. Le nombre de liaisons est de 80 * 80 * 200. Essayons d'analyser ces connexions. Nous allons trier tous les neurones de la couche W2 et visualiser quels poids y conduisent. √Ä partir des √©chelles qui m√®nent √† un neurone W2 √† partir des neurones W1, nous ferons des images 80x80. Voici 40 images de W2 (un total de 200). Les pixels blancs sont des poids positifs et le noir est n√©gatif. Notez que plusieurs neurones W2 sont r√©gl√©s sur une boule volante encod√©e en lignes pointill√©es. Dans un jeu, la balle ne peut √™tre qu‚Äôun seul endroit,par cons√©quent, ces neurones sont polyvalents et ¬´tireront¬ª si la balle se trouve quelque part √† l'int√©rieur de ces lignes. L'alternance du noir et du blanc est int√©ressante, car lorsque la balle se d√©place le long de la piste, l'activit√© du neurone fluctue comme une onde sinuso√Ødale. Et √† cause de ReLU, il ne ¬´tirera¬ª que sur certaines positions. Il y a beaucoup de bruit dans les images, ce qui serait moins si j'utilisais la r√©gularisation L2.</font></font><br><br><img src="https://habrastorage.org/webt/1t/n4/le/1tn4lew2rszryk1u9vkbreigku4.png"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce qui ne se passe pas.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nous avons donc appris √† jouer au pong sur des images en utilisant le gradient de la fonction de strat√©gie, et cela fonctionne plut√¥t bien. Cette approche est une forme bizarre de ¬´suggestion et v√©rification¬ª, o√π ¬´deviner¬ª fait r√©f√©rence √† l'ex√©cution de notre politique sur plusieurs √©pisodes du jeu, et la ¬´v√©rification¬ª encourage les actions qui m√®nent √† de bons r√©sultats. En g√©n√©ral, cela repr√©sente le niveau actuel de la fa√ßon dont nous abordons actuellement les probl√®mes de l'apprentissage renforc√©. Si vous comprenez l'algorithme intuitivement et savez comment il fonctionne, vous devriez √™tre au moins un peu d√©√ßu. En particulier, quand √ßa ne marche pas?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comparez cela √† la fa√ßon dont une personne peut apprendre √† jouer au pong. Vous leur montrez vous-m√™me le jeu et dites quelque chose comme: "Vous contr√¥lez la raquette, vous pouvez la d√©placer de haut en bas, et votre t√¢che est de lancer la balle devant un autre joueur contr√¥l√© par le programme int√©gr√©", et vous √™tes pr√™t √† partir. Veuillez noter quelques diff√©rences:</font></font><br><br><ul><li>         - , ,   ,     .     RL       ,        .       ,        (        ),       ,  .         .   ,          ,  ,  ,   ,            , ,   ,  . <br></li><li>      ,     ( ,    ,     ,      ..),    ( ¬´¬ª ¬´ ,  , ,    -  -  . .).      ¬´¬ª          / . ,     ,    (   )   (      ,    ). <br></li><li>    ‚Äî    (brute force),            ,       .              .       ,    ,           ,      .   ,     ¬´¬ª    ,        .   ,    ,         . <br></li><li>        ,    ,     .    ,             ,      .           . <br></li></ul><br><img src="https://habrastorage.org/webt/do/4a/ha/do4ahazbavg7xmlq-a5omrr77vq.png"><br><br> <i>:  :      RL.   ,  ,     .  ,    .     ,  99%        .  ,  ¬´¬ª   . :       ¬´¬ª,    ,  - , -  , -  ,     ,     .                 ¬´ ,      ¬ª.</i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je voudrais √©galement souligner le fait qu'au contraire, dans de nombreux jeux, les gradients de la politique vaincraient facilement une personne. En particulier, cela s'applique aux jeux avec des r√©compenses fr√©quentes, qui n√©cessitent une r√©action pr√©cise et rapide et sans planification √† long terme. Les corr√©lations √† court terme entre les r√©compenses et les actions sont facilement visibles par l'approche PG. Vous pouvez voir similaire dans notre agent Pong. Il d√©veloppe une strat√©gie lorsqu'il attend simplement le ballon, puis se d√©place rapidement pour l'attraper uniquement au bord m√™me, c'est pourquoi le ballon rebondit √† une vitesse verticale √©lev√©e. L'agent gagne plusieurs victoires d'affil√©e, r√©p√©tant cette strat√©gie simple. Il existe de nombreux jeux (Pinball, Breakout) dans lesquels Deep Q-Learning attire et pi√©tine une personne dans la boue avec ses actions simples et pr√©cises.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une fois que vous avez compris le ¬´truc¬ª avec lequel ces algorithmes fonctionnent, vous pouvez comprendre leurs forces et leurs faiblesses. En particulier, ces algorithmes sont loin derri√®re les gens dans la construction d'id√©es abstraites sur les jeux que les gens peuvent utiliser pour un apprentissage rapide. Une fois que l'ordinateur a regard√© le tableau de pixels et a remarqu√© la cl√©, la porte se dit qu'il serait probablement bien de prendre la cl√© et de se rendre √† la porte. Il n'y a actuellement rien de semblable √† cela, et essayer d'y arriver est un domaine de recherche actif. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calculs non diff√©renciables dans les r√©seaux de neurones.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je voudrais mentionner une autre application int√©ressante des gradients de politique non li√©s au jeu: cela nous permet de concevoir et d'entra√Æner des r√©seaux de neurones en utilisant des composants qui fonctionnent (ou interagissent) avec des calculs non diff√©renciables. Cette id√©e a √©t√© introduite pour la premi√®re fois en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1992 par Williams</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . et a r√©cemment √©t√© popularis√© dans </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les mod√®les r√©currents d'attention visuelle.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">appel√© ¬´attention particuli√®re¬ª dans le contexte d'un mod√®le qui traite une image avec une s√©quence d'apparences fov√©ales √©troites √† basse r√©solution, semblable √† la fa√ßon dont notre ≈ìil examine les objets avec une vision centrale en cours d'ex√©cution. √Ä chaque it√©ration, le RNN recevra un petit fragment de l'image et s√©lectionnera l'emplacement √† rechercher plus loin. Par exemple, le RNN peut regarder la position (5.30), obtenir un petit fragment de l'image, puis d√©cider de regarder (24, 50), etc. Il y a une section du r√©seau neuronal qui s√©lectionne o√π regarder plus loin, puis l'inspecte. Malheureusement, cette op√©ration n'est pas diff√©renciable, car nous ne savons pas ce qui se passerait si nous pr√©levions un √©chantillon ailleurs. Dans un cas plus g√©n√©ral, consid√©rons un r√©seau neuronal qui a plusieurs entr√©es et sorties:</font></font><br><br><img src="https://habrastorage.org/webt/xn/gn/ca/xngncauic38rgmg3bi_srnlevbw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notez que la plupart des fl√®ches bleues sont diff√©renciables comme d'habitude, mais certaines transformations de vue peuvent √©galement inclure une op√©ration de s√©lection indiff√©renci√©e, qui sont surlign√©es en rouge. Nous pouvons simplement parcourir les fl√®ches bleues dans la direction oppos√©e, mais la fl√®che rouge est une d√©pendance √† travers laquelle nous ne pouvons pas inverser la propagation du backprop.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une politique de d√©grad√© √† la rescousse! R√©fl√©chissons √† la partie du r√©seau qui effectue l'√©chantillonnage et peut √™tre repr√©sent√©e en fonction de la politique stochastique int√©gr√©e dans un grand r√©seau de neurones. Par cons√©quent, pendant la formation, nous produirons plusieurs exemples (indiqu√©s par les branches ci-dessous), puis nous encouragerons les √©chantillons qui conduisent finalement √† de bons r√©sultats (dans ce cas, par exemple, mesur√©s par la perte √† la fin). En d'autres termes, nous formerons les param√®tres inclus dans les fl√®ches bleues en utilisant le backprop, comme d'habitude, mais les param√®tres inclus dans la fl√®che rouge seront d√©sormais mis √† jour ind√©pendamment du passage inverse en utilisant des gradients de politique, encourageant les √©chantillons qui entra√Ænent de faibles pertes. Cette id√©e a √©galement √©t√© r√©cemment bien cadr√©e.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estimation du gradient √† l'aide de graphiques de calcul stochastiques.</font></font></a> <br><br><img src="https://habrastorage.org/webt/td/vx/lr/tdvxlrd98jepxgmsvpc5gtewlxs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Entr√©e / sortie form√©e dans la m√©moire √† acc√®s al√©atoire. Vous retrouverez √©galement cette id√©e dans de nombreux autres articles. Par exemple, la </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neural Turing Machine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a une bande m√©moire avec laquelle ils lisent et √©crivent. Pour effectuer une op√©ration d'√©criture, vous devez faire quelque chose comme m [i] = x, o√π i et x sont pr√©dits par le r√©seau neuronal RNN. Cependant, aucun signal ne nous dit ce qui arriverait √† la fonction de perte si nous √©crivions j! = I. Par cons√©quent, NTM peut effectuer des op√©rations de lecture et d'√©criture en douceur. Il pr√©dit la fonction de distribution d'attention a, puis effectue pour tout i: m [i] = a [i] * x. Il est d√©sormais diff√©renciable, mais nous devons payer un prix de calcul √©lev√©, en triant toutes les cellules.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, nous pouvons utiliser des gradients de politique pour contourner th√©oriquement ce probl√®me, comme cela est fait dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RL-NTM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nous pr√©disons toujours la distribution de l'attention a, mais au lieu d'une recherche exhaustive, nous s√©lectionnons au hasard des lieux d'√©criture: i = √©chantillon (a); m [i] = x. Pendant la formation, nous pourrions le faire pour un petit ensemble de i et, √† la fin, trouverions un ensemble qui fonctionnerait mieux que les autres. Un grand avantage de calcul est que pendant les tests, vous pouvez lire / √©crire √† partir d'une cellule. Cependant, comme indiqu√© dans le document, cette strat√©gie est tr√®s difficile √† mettre en ≈ìuvre, car vous devez passer par de nombreuses options et passer presque accidentellement √† des algorithmes de travail. Actuellement, les chercheurs conviennent que PG ne fonctionne bien que lorsqu'il existe plusieurs options discr√®tes, lorsque vous n'avez pas besoin de passer au peigne fin les grands espaces de recherche.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, √† l'aide de gradients politiques et dans les cas o√π une grande quantit√© de donn√©es et de puissance de calcul est disponible, nous pouvons en principe r√™ver beaucoup. Par exemple, nous pouvons concevoir des r√©seaux de neurones qui apprennent √† interagir avec de grands objets non diff√©renciables, tels que des compilateurs en latex. Par exemple, pour que char-rnn g√©n√®re du code Latex pr√™t √† l'emploi, ou un syst√®me SLAM, ou des solveurs LQR, ou autre chose. Ou, par exemple, la superintelligence peut vouloir apprendre √† interagir avec Internet via TCP / IP (qui n'est pas non plus diff√©renciable) pour acc√©der aux informations n√©cessaires pour capturer le monde. Ceci est un excellent exemple.</font></font><br><br><h4>  Conclusions </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons vu que les gradients de politique sont un puissant algorithme g√©n√©ral, et √† titre d'exemple, nous avons form√© l'agent ATARI Pong √† partir de pixels bruts √† partir de z√©ro dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">130 lignes Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En g√©n√©ral, le m√™me algorithme peut √™tre utilis√© pour former des agents √† des jeux arbitraires et, esp√©rons-le, un jour nous pourrons l'utiliser pour r√©soudre des probl√®mes de contr√¥le dans le monde r√©el. En conclusion, je voudrais ajouter quelques commentaires: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur le d√©veloppement de l'IA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nous avons vu que l'algorithme fonctionne au moyen de la recherche par force brute, dans laquelle vous h√©sitez d'abord au hasard et devez tomber sur des situations utiles au moins une fois, et id√©alement souvent, avant que la fonction de politique modifie ses param√®tres. Nous avons √©galement vu qu'une personne aborde ces solutions √† ces probl√®mes d'une mani√®re compl√®tement diff√©rente, ce qui ressemble √† la construction rapide d'un mod√®le abstrait. √âtant donn√© que ces mod√®les abstraits sont tr√®s difficiles (voire impossibles) √† imaginer explicitement, c'est aussi la raison pour laquelle il y a r√©cemment eu un tel int√©r√™t pour les mod√®les g√©n√©ratifs et l'induction de logiciels. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä propos de l'utilisation en robotique.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'algorithme ne s'applique pas lorsqu'il est difficile d'obtenir une √©norme quantit√© de recherches. Par exemple, vous pouvez avoir un (ou plusieurs) robots interagissant avec le monde en temps r√©el. Cela ne suffit pas pour une application na√Øve de l'algorithme. Un domaine de travail con√ßu pour att√©nuer ce probl√®me est celui </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des gradients politiques d√©terministes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Au lieu de faire de v√©ritables tentatives, cette approche obtient des informations de gradient √† partir d'un deuxi√®me r√©seau neuronal (appel√© critique) qui mod√©lise la fonction d'√©valuation. Cette approche peut, en principe, √™tre efficace avec des actions de grande dimension, o√π l'√©chantillonnage al√©atoire offre une faible couverture. Une autre approche connexe consiste √† intensifier la robotique que nous commen√ßons √† voir sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Robot Farm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou peut-√™tre m√™me sur une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tesla S + avec pilote automatique.</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il existe √©galement une ligne de travail qui essaie de rendre le processus de recherche moins d√©sesp√©r√© en ajoutant un contr√¥le suppl√©mentaire. Par exemple, dans de nombreux cas pratiques, vous pouvez obtenir la direction initiale du d√©veloppement directement de la personne. Par exemple, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AlphaGo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilise d'abord la formation avec un enseignant pour pr√©dire uniquement les actions humaines (par exemple, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le contr√¥le √† distance du robot</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apprentissage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">optimisation de la trajectoire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la recherche de politique compl√®te</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Et la politique r√©sultante est ensuite configur√©e √† l'aide de PG pour atteindre le v√©ritable objectif - gagner le match.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans certains cas, il peut y avoir moins de pr√©r√©glages (par exemple, pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contr√¥ler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">distance des robots</font></a><font style="vertical-align: inherit;"> ), et des m√©thodes existent pour utiliser ces donn√©es de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©-stage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Enfin, si les gens ne fournissent pas de donn√©es ou de param√®tres sp√©cifiques, ils peuvent √©galement √™tre obtenus dans certains cas par calcul en utilisant des m√©thodes d'optimisation assez co√ªteuses, par exemple, en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">optimisant la trajectoire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans un mod√®le dynamique connu (comme F = ma dans un simulateur physique) ou dans des cas lorsqu'un mod√®le local approximatif est cr√©√© (comme le montre une structure tr√®s prometteuse pour la recherche de politique g√©r√©e). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä propos de l'utilisation de PG dans la pratique.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je voudrais parler davantage de RNN. Je pense qu'il peut sembler que les RNN sont magiques et r√©solvent automatiquement les probl√®mes li√©s aux s√©quences arbitraires. La v√©rit√© est que faire fonctionner ces mod√®les peut √™tre d√©licat. Des soins et de l'exp√©rience sont n√©cessaires, ainsi que de savoir quand des m√©thodes plus simples peuvent vous aider √† 90%. Il en va de m√™me pour les gradients politiques. Ils ne fonctionnent pas automatiquement comme √ßa: vous avez besoin de nombreux exemples, ils peuvent s'entra√Æner ind√©finiment, ils sont difficiles √† d√©boguer quand ils ne fonctionnent pas. Vous devez toujours essayer de tirer avec un petit pistolet avant d'atteindre Bazooka. Par exemple, dans le cas d'un entra√Ænement par renforcement, la </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">m√©thode de l'entropie crois√©e (CEM)</font></a><font style="vertical-align: inherit;"> doit toujours √™tre v√©rifi√©e en premier.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, une approche stochastique simple ¬´deviner et v√©rifier¬ª inspir√©e de l'√©volution. Et si vous insistez pour essayer des gradients de strat√©gie pour votre t√¢che, assurez-vous de conna√Ætre les astuces sp√©cifiques. Commencez simplement et utilisez une option PG appel√©e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRPO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui fonctionne presque toujours mieux et de mani√®re plus coh√©rente </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que la PG classique</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . L'id√©e de base est d'√©viter de mettre √† jour les param√®tres qui modifient trop votre politique, en raison de l'utilisation de la distance Kulbak-Leibler entre l'ancienne et la nouvelle politique.</font></font><br><br>  C‚Äôest tout!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'esp√®re que je vous ai donn√© une id√©e de l'endroit o√π nous en sommes avec l'apprentissage par renforcement, quels sont les probl√®mes, et si vous voulez aider √† promouvoir RL, je vous invite √† le faire dans notre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAI Gym</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :) A la prochaine fois!</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrej Karpathy, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chercheur, d√©veloppeur, directeur du d√©partement d'IA et pilote automatique Tesla </font></font><br><br> <i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informations suppl√©mentaires:</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Deep Learning on Fingers </font><font style="vertical-align: inherit;">Course </font><font style="vertical-align: inherit;">2018 </font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://habr.com/en/post/414165/</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Deep Learning on Fingers </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open Course 2019 </font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https: // habr.com/ru/company/ods/blog/438940/</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Facult√© de physique de NSU </font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://www.phys.nsu.ru/</font></font></a></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr439674/">https://habr.com/ru/post/fr439674/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr439662/index.html">Annonce de TypeScript 3.3</a></li>
<li><a href="../fr439664/index.html">Compatibilit√© binaire C ++ et mises √† niveau sans douleur vers Visual Studio 2019</a></li>
<li><a href="../fr439668/index.html">Mise √† l'√©chelle d'une newsletter technique pour 700 000 abonn√©s dans 300 villes: l'histoire du r√©sum√© des startups Techstars</a></li>
<li><a href="../fr439670/index.html">Syst√®me d'IA russe pour le diagnostic du cancer Botkin.AI. Maintenant dans Azure Marketplace</a></li>
<li><a href="../fr439672/index.html">Principes de base de PowerShell: d√©tection si une cha√Æne se termine par un certain caract√®re</a></li>
<li><a href="../fr439676/index.html">R√©agissez √† l'int√©gration native et C ++ pour iOS et Android</a></li>
<li><a href="../fr439678/index.html">Soumettez au d√©fi F # appliqu√©</a></li>
<li><a href="../fr439680/index.html">Environ 50% des Russes sont pr√™ts √† vendre leurs donn√©es personnelles</a></li>
<li><a href="../fr439682/index.html">Formation Cisco 200-125 CCNA v3.0. Sp√©cialiste r√©seau certifi√© Cisco (CCNA). Jour 4. Dispositifs de passerelle</a></li>
<li><a href="../fr439684/index.html">Postulez pour le d√©fi F # appliqu√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>