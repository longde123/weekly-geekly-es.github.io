<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧚🏾 🈳 🍪 Création du visage d'un personnage pour le jeu "OnAir" 〰️ 🍀 😫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bon après-midi Je m'appelle Daria, je suis artiste 3D dans le studio de production RainStyle. Nous développons actuellement un jeu d'horreur de scienc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Création du visage d'un personnage pour le jeu "OnAir"</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471288/">  Bon après-midi  Je m'appelle Daria, je suis artiste 3D dans le studio de production RainStyle.  Nous développons actuellement un jeu d'horreur de science-fiction appelé <b>«On Air»</b> . <br><br><img src="https://habrastorage.org/webt/kx/a4/x0/kxa4x0nk1p-invxwlnmddbywfkm.png" alt="image"><br><br>  Le jeu raconte des événements mystérieux survenus avec le personnage principal, qui a accidentellement séjourné à l'hôtel américain Algol.  Cet incident changera complètement sa vie et le fera affronter l'inconnu. <br><a name="habracut"></a><br>  Il s'agit de notre premier projet de jeu et nous essayons d'atteindre le réalisme maximal des personnages, de transmettre leurs émotions et leur caractère.  Par conséquent, pour les créer, il a été décidé d'utiliser la technologie de numérisation faciale.  Dans le cadre des objectifs du projet, nous avons besoin de deux degrés de détail pour les personnages: pour le rendu - pour les cinématiques et le low poly - pour une utilisation dans le jeu lui-même. <br><br>  Le jeu On Air est en cours de développement sur l'Unreal Engine 4. Nous prévoyons d'écrire plusieurs articles dans lesquels nous décrirons en détail les étapes de la préparation des personnages. <br><br>  Pour le moment, nous créons une version de démonstration du jeu, qui apparaîtra bientôt dans Steam.  Dans cet article, je parlerai de la phase initiale de création du visage du personnage principal de notre jeu. <br><br><img src="https://habrastorage.org/webt/-e/ce/rh/-ecerhoq3v8iuxdyublvhwuwfd8.png" alt="image"><br><br><h4>  Partie 1 </h4><br>  L'image ci-dessous montre certaines des émotions que nous avons reçues après le traitement des numérisations. <br><br><img src="https://habrastorage.org/webt/fd/tc/wt/fdtcwtsvrpdodfwomu8r6_np_g4.png" alt="image"><br><br>  Fondamentalement, ils sont exagérés et ne semblent pas réalistes.  Cela a été fait exprès.  Le fait est que la base de cette méthode de création d'un visage est le principe du mélange des formes «Formes de mélange».  Autrement dit, chacune de ces émotions sera appliquée non pas sous une forme «pure», mais en combinaison avec d'autres.  J'en parlerai plus à la fin de l'article.  Tout d'abord, vous devez savoir quoi faire avec la tête numérisée et comment nous pouvons l'utiliser.  Évidemment, la topologie de l'analyse ne permet pas de l'utiliser comme modèle, mais en préparant la carte normale, nous obtenons les principales caractéristiques du visage, des rides, des pores, des bosses ou des cicatrices.  De la numérisation, nous pouvons également extraire la texture de la couleur de base. <br><br><img src="https://habrastorage.org/webt/4l/ex/lr/4lexlrzmipmxepu4d2uqhs1ocgw.png" alt="image"><br><br>  Le programme Wrap 3.3 nous y aidera.  Il est largement utilisé pour traiter les modèles numérisés.  Avec son aide, nous projetterons notre futur modèle de tête sur des scans. <br><br><h4>  2e partie </h4><br>  Vous devez d'abord créer ce que l'on appelle le maillage de base.  C'est-à-dire une expression faciale neutre qui sous-tendra toutes les émotions.  Notre scan des émotions neutres ressemble à ceci: <br><br><img src="https://habrastorage.org/webt/bf/zm/9r/bfzm9rnkwmw7whotrzfbolxmcym.png" alt="image"><br><br>  Le programme Wrap 3.3 possède un système de nœuds, c'est-à-dire que toutes les fonctions sont présentées sous la forme de nœuds (nœuds) reliés entre eux par une chaîne. <br><br>  La sélection des nœuds s'effectue à l'aide de la touche Tab.  À l'aide des nœuds LoadGeom et LoadImage, un scan avec une émotion neutre et sa texture correspondante sont chargés.  Pour ce faire, spécifiez le chemin d'accès dans la fenêtre Noms de fichiers.  Dans les paramètres du nœud «LoadGeom», vous pouvez sélectionner différents modes d'affichage de la géométrie (la fonction filaire est désactivée dans l'image ci-dessous).  Ici, vous pouvez également changer la couleur de la géométrie (ne fonctionne pas si la texture est connectée), les coordonnées et l'échelle. <br><br><img src="https://habrastorage.org/webt/jj/sa/ck/jjsacktagmrzkvs25xuhzuq0fos.png" alt="image"><br><br>  Ensuite, vous devez charger le maillage de base, qui sera projeté sur ce scan.  Vous pouvez le trouver sur l'onglet «Galerie».  Voici de nombreuses émotions toutes faites.  Dans ce cas, je choisis Basemesh. <br><br><img src="https://habrastorage.org/webt/-v/lc/b7/-vlcb7otf7kgk5o4zzbnwhdkvq4.png" alt="image"><br><br>  Basemesh doit être à peu près assorti à un scan.  Pour ce faire, vous pouvez utiliser l'axe des coordonnées. <br><br>  Pour projeter le maillage de base sur le scan, j'utilise le nœud Wrapping.  Lorsque vous passez la souris sur les nœuds du nœud, une info-bulle s'affiche: le premier nœud, Géométrie flottante - pour la géométrie projetée, le deuxième nœud, Géométrie Fixet - pour l'objet fixe sur lequel la géométrie sera projetée (dans notre cas, il s'agit d'un scan avec une émotion neutre). <br><br><img src="https://habrastorage.org/webt/xd/y0/mc/xdy0mcmzi9irpyydokryacbctla.png" alt="image"><br><br>  Pour commencer le calcul, il est nécessaire de marquer sur les deux modèles les points qui correspondront l'un à l'autre.  Pour cela, le nœud Select points est utilisé, qui est connecté aux nœuds correspondants des modèles.  Après avoir sélectionné ce nœud, accédez à l'onglet Visual Editor.  La fonction Sync vues incluse vous permet de synchroniser les caméras pour les fenêtres gauche et droite. <br><br><img src="https://habrastorage.org/webt/8f/ow/uc/8fowucelwz7738je5jm2xp9gkxc.png" alt="image"><br><br>  Si le modèle projeté contient des polygones qui doivent rester en place, vous devez les sélectionner à l'aide de la fonction Sélectionner des polygones.  Sinon, des artefacts peuvent apparaître associés aux détails internes du maillage. <br><br><img src="https://habrastorage.org/webt/jr/zv/dz/jrzvdzuikyktk64wpo_cs4n62yi.png" alt="image"><br><br>  Pour utiliser le nœud Sélectionner des polygones, utilisez l'onglet Visual Editor.  Ici, vous pouvez sélectionner les polygones que les modèles de la galerie sont divisés en polygroupes, cela simplifie la tâche: ils peuvent être sélectionnés ou désélectionnés dans le panneau supérieur. <br><br>  Je souligne les parties internes de la gorge, des narines, des paupières extrêmes et du bas du cou. <br><br><img src="https://habrastorage.org/webt/2v/nj/97/2vnj97z73izx0zdbnvvlefk4aja.png" alt="image"><br><br><img src="https://habrastorage.org/webt/so/ps/rc/sopsrc9xofh9bcneqnj8grhh2lm.png" alt="image"><br><br>  Après cela, le modèle sera projeté correctement. <br><br><img src="https://habrastorage.org/webt/i2/52/78/i25278qwzpx0x0a-s13wj4vn8wk.png" alt="image"><br><br>  De plus, pour plus de granularité, vous pouvez utiliser le nœud Subdivide.  Il se connecte au maillage de base et tous les nœuds ci-dessous sont connectés à son nœud inférieur (sortie). <br><br><img src="https://habrastorage.org/webt/u7/s-/dd/u7s-ddnr9ctkghve6wicg-x7qic.png" alt="image"><br><br>  Ensuite, faites cuire la texture du scan au maillage de base.  Pour cela, le nœud Transférer la texture est utilisé.  Le noeud Géométrie source se connecte au modèle avec lequel la texture va cuire.  Dans notre cas, il s'agit d'un scan.  Le nœud de géométrie cible est connecté au maillage de base, mais pas au nœud LoadGeom, mais au nœud d'habillage, car nous utiliserons la géométrie projetée déjà modifiée. <br><br><img src="https://habrastorage.org/webt/em/vj/ra/emvjrap3jv0drbe42u8lxjspjn8.png" alt="image"><br><br>  Dans les paramètres de ce nœud, vous pouvez sélectionner la qualité de la texture cuite.  Après cela, vous devez ajouter le nœud Extrapoler l'image pour remplir les endroits transparents et enregistrer la texture résultante à l'aide du nœud Enregistrer l'image et en appuyant sur le bouton Calculer l'image actuelle.  La géométrie est enregistrée de la même manière à l'aide du nœud Save Geom. <br><br><img src="https://habrastorage.org/webt/q8/ol/xq/q8olxqwsxreywugalgqd5gfh1ek.png" alt="image"><br><br><h4>  3e partie </h4><br>  Après avoir obtenu une émotion et une texture neutres, nous pouvons passer à l'obtention d'une géométrie pour d'autres émotions.  Pour ce faire, chargez le modèle de numérisation et Basemesh avec des textures. <br><br><img src="https://habrastorage.org/webt/sd/ey/nx/sdeynxlfx4nmbc9hefsxeq_y-v4.png" alt="image"><br><br>  Ensuite, vous devez aligner Basemesh en fonction du scan.  Pour commencer, vous pouvez comparer les modèles approximativement en utilisant des axes de coordonnées. <br><br><img src="https://habrastorage.org/webt/oh/ka/7x/ohka7x47eywbrue0da6kbhgc9e4.png" alt="image"><br><br>  Un nœud qui vous permet d'aligner plus précisément les modèles les uns par rapport aux autres - Alignement rigide.  Le nœud Géométrie flottante connecte la géométrie qui doit être alignée.  Dans le noeud Géométrie fixe, respectivement, il y aura une géométrie statique (dans notre cas, il s'agit d'un scan). <br><br><img src="https://habrastorage.org/webt/-1/8f/an/-18fanskyoz3mzz3ispdjlsgt9k.png" alt="image"><br><br>  Lorsque vous utilisez le nœud d'alignement rigide, vous devez utiliser le nœud Sélectionner des points: <br><br><img src="https://habrastorage.org/webt/yx/nk/yz/yxnkyzv8vfifpocy9rezqo77sbq.png" alt="image"><br><br>  Mon modèle possède des marqueurs de contrôle qui simplifient la tâche de sélection des points.  Pour aligner les modèles les uns par rapport aux autres, des points doivent être placés sur les parties du visage qui changent légèrement lorsqu'elles représentent une émotion particulière.  Dans le cas de cette émotion, il s'agit du front, de la partie supérieure du nez, du cou, etc.  En outre, il est conseillé de placer des points de tous les côtés du modèle (c'est-à-dire, par exemple, non seulement sur le visage, mais également à l'arrière de la tête et des oreilles). <br><br><img src="https://habrastorage.org/webt/qy/88/yf/qy88yf5dndsigcayzn7cruu1m-4.png" alt="image"><br><br>  En conséquence, nous obtenons des modèles alignés les uns par rapport aux autres: <br><br><img src="https://habrastorage.org/webt/bx/l9/ao/bxl9aog0pbuv2bap92i0sysyi9g.png" alt="image"><br><br>  Dans les paramètres du nœud d'alignement rigide, il existe une fonction «Match skale».  Il est utilisé si les modèles doivent également être mis à l'échelle. <br><br>  Après cela, vous pouvez commencer à projeter le maillage de base sur le scan.  Pour cela, nous utiliserons le nœud Optical Flow Wrapping.  Il vous permet d'aligner la géométrie en fonction de la texture du scan.  Dans le même temps, la texture résultante des émotions coïncidera complètement avec la texture du maillage de base, à l'exception des rides, des rides et d'autres changements.  Toutes les irrégularités de la peau et des pores lors de l'utilisation de cette méthode restent en place. <br><br><img src="https://habrastorage.org/webt/mb/7m/iv/mb7mivt59e9su6kjmrpk1hnugwa.png" alt="image"><br><br>  Avant d'utiliser le flux optique, comme dans le premier cas, le nœud Select Polygons est utilisé: <br><br><img src="https://habrastorage.org/webt/ju/4v/to/ju4vto3ddusr5jsvugf6odd_qbi.png" alt="image"><br><br>  Ainsi, les parties fixes de la tête resteront en place. <br><br>  Vous pouvez également utiliser le nœud Sélectionner des points.  Voici les points sur les parties mobiles du visage: <br><br><img src="https://habrastorage.org/webt/ph/3h/gw/ph3hgwcigqpzp7k8phlpe-n-d78.png" alt="image"><br><br>  Ensuite, accédez aux paramètres de flux optique.  Des caméras pouvant être ajustées sont apparues dans la fenêtre de Visual Editor autour du modèle. <br><br><img src="https://habrastorage.org/webt/kf/lk/gs/kflkgszewb1rqqb5mruaw2fpo38.png" alt="image"><br><br>  En haut, il y a un menu déroulant avec lequel vous pouvez accéder à la vue depuis la caméra.  Il y en a 13. Par défaut, vous devez les régler pour que le visage s'insère complètement dans le cadre. <br><br><img src="https://habrastorage.org/webt/nk/rz/da/nkrzdal-nf0bmdccxubbr2jfgnk.png" alt="image"><br><br>  Sur la recommandation des développeurs, je laisse presque tous les réglages par défaut à l'exception des paramètres finaux Résolution finale et Lissage du flux optique: <br><br><img src="https://habrastorage.org/webt/rs/og/t3/rsogt301d29-fmdkw3-w_ikb4f8.png" alt="image"><br><br>  Après cela, vous pouvez cliquer sur Calculer et voir le résultat: <br><br><img src="https://habrastorage.org/webt/oq/sh/wv/oqshwvwqspwpktcdmrtcdaan0ru.png" alt="image"><br><br>  Une fois le maillage projeté exactement sur le scan, vous devez cuire la texture.  cela se fait selon le même principe que dans la première partie de l'article: <br><br><img src="https://habrastorage.org/webt/5q/i3/ua/5qi3uariv6ry89ideprjf9yonmo.png" alt="image"><br><br>  Par conséquent, si vous combinez la texture résultante avec la texture du maillage de base, certains détails seront ajoutés, mais en même temps, les points de contrôle coïncideront: <br><br><img src="https://habrastorage.org/webt/fs/ws/tk/fswstkeyd2cmmu2xdzdja_3ffbg.png" alt="image"><br><br>  Après cela, la texture et la géométrie résultante peuvent être enregistrées. <br><br><img src="https://habrastorage.org/webt/fg/o1/sz/fgo1szpef_fqluip7uf4uqgehko.png" alt="image"><br><br>  En conséquence, nous avons obtenu un maillage d'une nouvelle émotion avec une texture. <br><br><h4>  Partie 4 </h4><br>  La méthode des formes Blend vous permet de «mélanger les émotions».  Pour ce faire, chargez les maillages déjà reçus dans le nœud Formes de fusion. <br><br><img src="https://habrastorage.org/webt/jl/fi/i2/jlfii24nzvg4ptcyfl7bawhwbbc.png" alt="image"><br><br>  J'ai chargé l'émotion neutre dans le premier nœud.  En déplaçant les curseurs dans les paramètres du nœud, vous pouvez choisir la force à laquelle telle ou telle émotion sera exprimée.  Pour que cette méthode fonctionne, les modèles doivent avoir la même topologie. <br><br><img src="https://habrastorage.org/webt/zx/0k/o5/zx0ko5teguiqiogh4qcsc8cyw_u.png" alt="image"><br><br><img src="https://habrastorage.org/webt/vi/ld/uq/vilduqi1jwtzgr662xx4nsyh85q.png" alt="image"><br><br><h4>  Résultat </h4><br>  Le processus ci-dessus n'est qu'une petite partie d'un travail très volumineux.  Après avoir reçu les modèles de tête LowPoly, il était nécessaire de créer des cartes normales, de la rugosité, du sous-sol, etc., ainsi que de configurer le shader (dans notre cas, nous avons configuré le shader pour le rendu et pour le moteur).  Les yeux, les vêtements et les cheveux ont également été créés séparément.  Il convient également de noter que seules trois personnes ont effectué cette tâche.  C'était notre première expérience dans la création d'un personnage très détaillé.  Nous étions satisfaits du résultat, mais nous nous efforcerons d'en faire plus. <br><br><img src="https://habrastorage.org/webt/25/wo/-m/25wo-m_68qxmzq4wtff-2px721u.jpeg" alt="image"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr471288/">https://habr.com/ru/post/fr471288/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr471268/index.html">Comprendre les courtiers de messages. Apprentissage de la mécanique de la messagerie via ActiveMQ et Kafka. Chapitre 2. ActiveMQ</a></li>
<li><a href="../fr471270/index.html">Nous automatisons la réception de données sur la vitesse de chargement d'un site à partir de Google PageSpeed ​​Insights [modèle]</a></li>
<li><a href="../fr471272/index.html">Les avantages de la frappe forte en C ++: expérience pratique</a></li>
<li><a href="../fr471278/index.html">Génération de texte en russe par des modèles</a></li>
<li><a href="../fr471282/index.html">Recherche de pneumonie aux rayons X avec Fast.ai</a></li>
<li><a href="../fr471294/index.html">Poèmes sur Haskell, C ++ et les programmeurs</a></li>
<li><a href="../fr471296/index.html">Lean Manufacturing - Un outil pour l'efficacité</a></li>
<li><a href="../fr471298/index.html">Bieber et Bilan agitent un stylo. AI chante maintenant des chansons</a></li>
<li><a href="../fr471300/index.html">Réagissez: la levée de l'état tue votre application</a></li>
<li><a href="../fr471302/index.html">Vérification des utilisateurs en Chine et crédit social</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>