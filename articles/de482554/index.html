<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🤝‍👨🏼 🛏️ 😏 Smart Home mit Xiaomi am Beispiel einer Badewanne 👩🏽‍⚖️ 🌈 🔠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im Internet gibt es eine ganze Reihe von Rezensionen und Videos zum Bau von Smart Homes. Es gibt die Meinung, dass dies alles ziemlich teuer und mühsa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Smart Home mit Xiaomi am Beispiel einer Badewanne</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/plesk/blog/482554/"> Im Internet gibt es eine ganze Reihe von Rezensionen und Videos zum Bau von Smart Homes.  Es gibt die Meinung, dass dies alles ziemlich teuer und mühsam in der Organisation ist, das heißt im Allgemeinen die Menge der Geeks.  Aber der Fortschritt steht nicht still.  Geräte werden billiger, während sie funktionaler sind und Design und Installation recht einfach sind.  Grundsätzlich konzentrieren sich die Reviews jedoch auf 1-2 Anwendungsbeispiele, die praktisch nicht die Nuancen abdecken und kein ganzheitliches Bild ergeben.  In diesem Artikel möchte ich daher das abgeschlossene Projekt überprüfen und Nutzungsszenarien und Fallstricke aufzeigen, die beim Bau eines Smart Homes mit Xiaomi-Geräten am Beispiel des Badehauses auftreten.  Die beschriebenen Ideen mit geringfügigen Abweichungen können auf die Automatisierung der Wohnung angewendet werden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9h/lb/tj/9hlbtjf6rdghf--lzwsq-5bysk8.jpeg" alt="Bild" width="400" height="400"></div><br><a name="habracut"></a><br><h2>  Hintergrund oder warum das alles notwendig ist </h2><br>  Für den Anfang ein wenig Hintergrund, um den Kontext zu verdeutlichen.  Anfang Herbst 2018 wurde die Fertigstellung des Bades abgeschlossen und in Betrieb genommen.  Das Badehaus ist ein autonomes Hauptgebäude mit ganzjähriger Heizung und Wasserversorgung. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ns/wd/o5/nswdo5svyprgue1sgxhojmb83kk.jpeg" alt="Bild"></div><br>  Aus offensichtlichen Gründen lebt niemand ständig im Badehaus und kontrolliert nicht den Zustand der Räumlichkeiten.  Auch ein Badebesuch ist, so oft ich möchte, nicht sehr häufig.  Dementsprechend waren von Anfang an Überlegungen angestellt, ein „intelligentes“ Bad zu schaffen.  Zunächst aus Sicherheitsgründen (Feuer, Überschwemmung, Zugangskontrolle).  Das Ausschalten der Heizung bei -35 Grad auf der Straße (ich wohne in Nowosibirsk) ist beispielsweise eine sehr gefährliche Situation.  Im Gegensatz zum Haupthaus habe ich jedoch nicht von Anfang an über das Projekt der Automatisierung des Bades nachgedacht und keine zusätzliche Verkabelung an den richtigen Stellen vorgenommen.  Auf der anderen Seite wurde das Internet im Badehaus betrieben, und für das Erscheinungsbild von zwei anderen Gebäuden wird eine Videoüberwachung durchgeführt (Sie können visuell auswerten, was passiert). <br><br>  Nachdem ich im November 2019 von einer Geschäftsreise zurückgekehrt war, ging ich abends zum Badehaus, öffnete die Haustür und war schockiert von dem, was ich sah.  Die WiFi-Punkt-LEDs blinkten aus der Dunkelheit auf mich zu und ein Wasserstrahl sprudelte auf meine Füße.  Das heißt, Überschwemmungen traten auf, während der Strom nicht abgeschaltet wurde.  Das Wasser im Badehaus wird mithilfe einer eigenen Tauchpumpe und einer Automatisierung, die den Prozess steuert, organisiert.  Wie sich später herausstellte, wurde eine der Armaturen im Toilettenwechsel unterbrochen und alle Räume überflutet.  Ich habe nie herausgefunden, warum die Automatisierung schade war und immer noch ausgeschaltet war, aber sie schaffte es, 15 cm Wasser auf 30 Quadrate zu pumpen.  Auf der Straße war an diesem Tag -14 Grad.  Der warme Boden kam zurecht und hielt die Raumtemperatur weiterhin auf dem richtigen Niveau, aber es erschien eine Feuchtigkeit von 100%.  Es war unmöglich, mehr über die Organisation eines intelligenten Hauses zu zögern - Sie müssen damit beginnen. <br><br><h2>  Auswahl der Ausrüstung </h2><br>  Während des Baus des Haupthauses habe ich Erfahrungen mit <a href="https://eldesalarms.com/">Eldes-</a> Geräten <a href="https://eldesalarms.com/">gesammelt</a> (die entsprechende Verkabelung wurde erstellt).  Ein Teil der Automatisierung erfolgt auf dem <a href="https://www.raspberrypi.org/">Raspberry PI</a> .  Ein weiterer Teil <a href="https://www.aqara.com/en/home.html">betrifft Xiaomi Aqara-Geräte</a> .  Die Option mit Raspberry PI war für mich die attraktivste und wurde zunächst für das Badehaus in Betracht gezogen.  Leider erfordert es aber deutlich mehr Organisationsaufwand.  Dies ist immer noch kein Plug-and-Play-Gerät - angefangen mit Übungen mit Hardware bis hin zum Schreiben von Software für Ihre eigenen Bedürfnisse.  Aus bestimmten Gründen war <a href="https://mjdm.ru/">MajorDoMo</a> nicht glücklich.  Das Überqueren von Himbeer-PI, ZigBee-Adapter (für die Verwendung von drahtlosen Xiaomi-Sensoren) und Apple HomeKit erfordert eine Studie (und die Apple HomeKit-Benutzeroberfläche ist im Moment nicht sehr zufrieden).  Es blieb nicht viel Zeit (ich wollte die Situation nicht wiederholen) und es gab keine Verkabelung für jeden gewünschten Punkt, sodass ich mich entschied, alles auf Xiaomi-Geräten zu tun. <br><br>  Das Hauptgerät in dieser Situation ist der Hub.  Bei Xiaomi gibt es zwei Optionen für den Hub: Xiaomi Mi Smart Home Gateway 2 und Xiaomi Aqara Gateway.  Letzteres ist etwa doppelt so teuer, für den lokalen Markt besser geeignet und kann Geräte in Apple HomeKit integrieren.  Wenn Sie jedoch die Aqara Home-Anwendung installieren und die Region „Russland“ auswählen, sind zum Zeitpunkt des Schreibens dieser Zeilen nur 13 verschiedene Geräte (Schalter, Steckdosen, Sensoren) verfügbar.  Wenn Sie die Xiaomi Home-Anwendung installieren, wählen Sie die Region „China Mainland“ aus. Hunderte von Geräten stehen für die Verbindung zur Verfügung.  Wenn Sie jedoch die Region „China Mainland“ auswählen, können Sie keine europäische Steckdose anschließen und umgekehrt.  Die Auswahl der Region „China Mainland“ als Teil der Aqara Home-Anwendung bietet nicht die Vollständigkeit von Geräten, die in Xiaomi Home mit derselben Region vorhanden sind.  Aus Angst vor Inkompatibilität habe ich mich dazu entschlossen, beim Hub Xiaomi Mi Smart Home Gateway 2 anzuhalten.  Der Hub selbst fungiert übrigens als Lampe - dies kann bei der Installation berücksichtigt werden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vs/ul/kx/vsulkxlnghjjindbwwmxw9aemxq.jpeg" alt="Bild"></div><br>  Eine andere interessante Frage ist, wie lange dies funktionieren wird.  Es geht nicht einmal um Sensoren und Batterien, sondern um Synchronisation und Datenspeicherung in der Cloud.  Das Konto ist derzeit frei.  Alle Informationen werden auf Xiaomi-Servern gespeichert.  Wenn die Jungs morgen entscheiden, dass Benutzer aus Russland keine Daten in der Region „China Mainland“ speichern sollen oder wenn Roskomnadzor aus irgendeinem Grund ihre Server sperrt, läuft das ganze Smart House Gefahr, sich in einen Kürbis zu verwandeln.  Ich habe selbst entschieden, dass in diesem Fall die Sensoren erhalten bleiben und der Hub durch den Raspberri PI + ZigBee Adapter ersetzt wird. <br><br><h2>  Leckagekontrolle und -verhütung </h2><br>  Das erste und wichtigste Automatisierungsszenario war eine natürliche Fortsetzung des Problems - bei einem Leck müssen Sie die Wasserversorgung, dh die Pumpe, abschalten und eine Benachrichtigung über das Problem an das Telefon senden.  Es gab zwei potenziell gefährliche Stellen für das Auftreten von Undichtigkeiten. <br><br>  Neben dem Hub für dieses Szenario waren zwei Lecksensoren und eine intelligente Wandsteckdose erforderlich.  Der Preis für den Leckagesensor liegt bei ca. 1400 r.  Der Preis für eine intelligente Steckdose beträgt ca. 1700 p.  Die Lecksensoren sind autonom, sie arbeiten mit Batterien.  Der Hersteller gibt an, dass eine Batterie für 2 Jahre ausreicht. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bt/d3/q2/btd3q2gftpvfsf_drdszmsisfwm.jpeg" alt="Bild"></div><br>  Die Installation einer intelligenten Steckdose war etwas kompliziert, da für chinesische Steckdosen quadratische Steckdosen erforderlich sind, die nicht in unseren normalen Läden verkauft werden (sondern bestellt werden können).  Das Bohren von quadratischen Löchern ist immer noch ein Vergnügen.  Zu guter Letzt benötigen Sie einen Adapter, obwohl es auch eine Steckdose für einen europäischen Stecker gibt.  In der Aqara-Version für den lokalen Markt gibt es derzeit keine Wandsteckdose für die Wandmontage, was uns an die Region „China Mainland“ bindet.  Alternativ können Sie eine normale Steckdose installieren und eine intelligente Steckdose mit einem Stecker von Xiaomi daran anschließen. Hierfür sind jedoch zwei zusätzliche Adapter erforderlich.  Eine andere Alternative ist ein Relais.  Aber ich entschied mich für eine Wandsteckdose. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qe/rg/pg/qergpgrjkaqqosy5xr2pqc_hli8.jpeg" alt="Bild"></div><br>  In der Xiaomi Home-Anwendung wurden ein Sockel und ein Sensor hinzugefügt.  Als nächstes wird das Szenario „Im Falle eines Lecks“ für zwei Aktionen vorgeschrieben: Schalten Sie die Steckdose aus und senden Sie einen Alarm. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p7/pj/ub/p7pjubzhpjzb6tt_aoxrdd20_fs.jpeg" alt="Bild"></div><br>  Der erste Leckagesensor wurde neben der Pumpe (und tatsächlich neben der Nabe) installiert.  Für den Test wurde Wasser in eine kleine Platte gegossen und der Sensor wurde hineingesenkt.  Ich habe die gesamte Aktion direkt am Aufstellungsort des Sensors durchgeführt, um die Situation so nah wie möglich an die Realität heranzuführen.  Der Test war erfolgreich: Die Steckdose wurde ausgeschaltet, die Benachrichtigung ging auf das Telefon und der Hub blinkte im Notfallmodus. <br><br>  Der zweite Leckanzeiger sollte in der Toilette neben dem Rohraustausch installiert werden.  Bei der Installation traten jedoch Nuancen auf - der Hub konnte den Sensor nicht erkennen, obwohl der Abstand gering war.  Der Grund ist die Konfiguration der Räumlichkeiten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ce/33/gb/ce33gbivdrkzwq2f4t-vghi69ki.jpeg" alt="Bild"></div><br>  Zwischen dem Aufstellort der Nabe (Ruheraum) und dem Aufstellort des zweiten Leckagesensors (Toilette) befand sich ein Dampfbad.  Das Dampfbad ist in bester Tradition mit Folie in den Kreis eingenäht, was zu Problemen beim Durchgang des Signals führt. <br><br>  Der Hersteller behauptet, dass die Geräte ein Mesh-Netzwerk bilden können, dh ein Gerät kann Daten über ein anderes Gerät an den Hub übertragen.  Irgendwo stieß ich auf die Information, dass nur mit dem Netzwerk verbundene Geräte (und keine Batterien) als solche Sender in einem Maschennetzwerk fungieren können.  Es hat mir jedoch gereicht, einen Temperatursensor in der Ecke des Waschraums anzubringen, damit das Signal vom Leckagesensor nicht mehr verschwindet.  Möglicherweise ist dies ein Zufall, da später im Waschraum unter der Decke ein Relais zur Steuerung der Straßenbeleuchtung angebracht wurde (möglicherweise fungiert es als Sender im Maschennetz).  Das Problem mit dem Signalverlust vom Lecksensor in der Toilette wurde jedoch behoben.  Zusätzlich können Sie die Verbindung des Geräts mit dem Hub überprüfen, indem Sie auf den Sensor in der Mitte klicken.  Wenn alles in Ordnung ist, ertönen die relevanten Informationen in reinem Chinesisch vom Hub (im Fall des Aqara-Hubs erfolgt die Kommunikation in angenehmem Englisch). <br><br>  Das Überprüfen der Abschaltung und das anschließende Einschalten des Stroms mit der Maschine zeigten, dass die Smart-Steckdose ausgeschaltet ist.  Damit es beim Auftreten von Strom in den Ein-Zustand wechselt, gibt es eine entsprechende Einstellung: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7m/mp/rv/7mmprvrfrwirqrveigp5hk5rbna.jpeg" alt="Bild"></div><br>  Ein zusätzliches Zeichen für die Überflutung des Raumes war eine Erhöhung der Luftfeuchtigkeit um bis zu 100%.  Über die Kontrolle dieses Symptoms - im nächsten Abschnitt. <br><br><h2>  Rauch- und Temperaturkontrolle </h2><br>  Das Badehaus ist ein brandgefährdeter Raum, daher sollten im folgenden Szenario Anzeichen eines Feuers identifiziert werden. <br><br>  Für dieses Szenario wurden zwei Temperatur- (und Feuchtigkeits-) Sensoren und ein Rauchsensor benötigt.  Der Preis für den Temperatursensor liegt bei ca. 1000 r.  Der Rauchmelder kostet ca. 2000 p.  In der Aqara-Version für die Region gibt es derzeit keinen Rauchmelder, was uns wieder an die Region „China Mainland“ bindet. <br><br>  Der Rauchmelder wurde an der Decke des Korridors im Waschraum montiert (eigentlich nicht weit vom Herd und dem Dampfraumausgang entfernt).  Anschließend wurde in der Xiaomi Home-Anwendung ein Gerät hinzugefügt und ein Szenario für den Fall der Raucherkennung erstellt. Anschließend wurde eine Benachrichtigung an das Telefon gesendet.  Der Test wurde von einem Kaminsims durchgeführt.  Der Sensor hat den Test erfolgreich abgeschlossen.  Der Hub blinkte mit einem Alarm und ein akustischer Alarm ertönte.  Der Sensor selbst war auch sehr gemein und piepste laut und warnte vor dem Problem. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zg/ej/jg/zgejjg01wv9ayueq8tzptcumzs8.jpeg" alt="Bild"></div><br>  Ein weiteres Zeichen von Feuer ist ein Temperaturanstieg.  Zur Überwachung der Temperatur wurden zwei Sensoren installiert: einer im Ruheraum, der andere im Waschraum.  In der Anwendung wurde dann das Szenario „Bei einer höheren Temperatur als der eingestellten“ mit der entsprechenden Benachrichtigung des Telefons konfiguriert.  Im Moment stelle ich die Schwelle für den Ruheraum auf 30 Grad ein (im Sommer muss ich sie wahrscheinlich neu konfigurieren). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/0w/pj/nq0wpjrfwe3nsl6hfpnjxwsuzhq.jpeg" alt="Bild"></div><br>  Außerdem wurde das Szenario „bei einer Temperatur unter dem eingestellten Wert“ mit einem Schwellenwert von 18 Grad eingerichtet und auf das Telefon aufmerksam gemacht.  Wenn aus irgendeinem Grund die Heizung nicht mehr funktioniert, möchte ich so schnell wie möglich darüber informiert werden.  In ähnlicher Weise wurden für beide Sensoren die Szenarien „bei erhöhter Luftfeuchtigkeit“ mit einer Schwelle von 70%, einem Telefonalarm und einem Abschalten der Wasserversorgungspumpe erstellt. <br><br>  Von den angenehmen Boni für Temperatur- und Feuchtigkeitssensoren sind historische Diagramme in der Anwendung verfügbar.  Sie können beispielsweise bestimmen, zu welchem ​​Zeitpunkt das Bad für den vorgesehenen Zweck verwendet wurde (Temperaturspitzen in der folgenden Grafik) oder vergleichen, ob die aktuelle Temperatur abnormal ist. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cf/tb/av/cftbaviejmlpp8nndfwizm6un60.jpeg" alt="Bild"></div><br><br><h2>  Lüftungssteuerung </h2><br>  Ein erzwungener Auszug aus dem Gelände wird im Dampfbad organisiert.  Nach Abschluss der Prozeduren ist es ratsam, den Raum zu lüften.  Die Belüftung wurde über einen Schlüsselschalter eingeschaltet, und die Belüftung selbst dauerte mindestens 30 Minuten. Oft enden Versammlungen im Badehaus jedoch in der ersten oder zweiten Stunde der Nacht.  Es ist nicht immer möglich, alles im Voraus zu erledigen und am Ende weitere 30 Minuten zu sitzen und zu warten, bis das Dampfbad belüftet ist, ist ein Vergnügen, das unterdurchschnittlich ist, da Sie bereits schlafen möchten. <br><br>  Für dieses Szenario benötigten wir einen Schlüsselschalter von Xiaomi mit einer Nulllinie und einer Wandmontage.  Der Ausgabepreis beträgt ca. 1900 p.  Schalter sind in der Aqara-Version für den lokalen Markt erhältlich. <br><br>  In meinem Fall können Sie einen herkömmlichen Schalter einfach nicht durch einen intelligenten ersetzen - eine Stromleitung ist erforderlich.  Dementsprechend musste ich die Nulllinie zum Montageloch für den Schalter strecken, da es eine solche Möglichkeit gab.  Bei einem Schalter ohne Nulllinie wäre die Installation einfacher. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q0/k2/p-/q0k2p-qvozvt_zk3e-i407jprhk.jpeg" alt="Bild"></div><br>  Nach der Installation wurde der Anwendung ein Smart Switch als Gerät hinzugefügt und die Leistung getestet.  In den Schaltereinstellungen befindet sich ein Timer, und Sie können die Zeit zum Ausschalten einstellen.  Das heißt, bevor Sie das Bad verlassen, wird der Ausschalttimer auf zusätzliche 30 Minuten Belüftung eingestellt, und Sie können sicher einschlafen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9e/4c/5g/9e4c5gckmsp0dsiekxkbvhk5imk.jpeg" alt="Bild"></div><br>  Eine weitere Option der Prozessautomatisierung ist möglich.  Nach dem Baden wird zusätzlich zur Belüftung die Dampfbadtür vollständig geöffnet.  Dies führt zu einem Temperaturanstieg im Waschraum, in dem ein Temperatursensor installiert ist.  Basierend auf den Messwerten dieses Sensors können Sie Szenarien zum Ein- und Ausschalten der Beatmung erstellen.  Aber ich habe diese Option noch nicht ausgeführt.  Außerdem könnte man mit einem Dampfbad-Türöffnungssensor experimentieren.  Aber ich fürchte, er wird schnell sterben oder abfallen, da die Tür aus Glas ist und im Dampfbad auch 120 Grad haben kann. <br><br><h2>  Kontrolle der Straßenbeleuchtung </h2><br>  Eine andere Aufgabe, die ich automatisieren wollte, war die Steuerung der Straßenbeleuchtung auf der Veranda.  Eines der typischen Szenarien: Schalten Sie das Licht auf der Veranda ein, wenn Sie sich in der Nähe des Gebäudes befinden und es draußen dunkel wird.  Das Bad ist verschlossen, der Schalter für die Straßenbeleuchtung befindet sich im Haus.  Ich musste dem Schlüssel nachgehen, um die Tür zu öffnen und das Licht einzuschalten.  Das Ausschalten der Lichter erforderte eine ähnliche Prozedur.  Ein weiteres Szenario, das regelmäßig auftrat: Schalten Sie das Licht auf der Veranda ein oder aus, wenn Sie sich im Haupthaus befinden.  Sehr oft vergaß ich beim Verlassen des Badehauses, das Licht auf der Veranda auszuschalten, und fand dies, als ich im Haus war: entweder indem ich aus dem Fenster schaute oder indem ich auf die Überwachungskameras schaute.  In diesem Moment ist Widerwillen normalerweise kein Ausweg, sodass das Licht die ganze Nacht brannte. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cc/tg/ex/cctgexbilx-hsr-tomjp9cs0gl8.jpeg" alt="Bild"></div><br>  Um diese Idee umzusetzen, wurde ein zweikanaliges Relais gekauft.  Der Ausgabepreis beträgt ca. 2000 p.  Relais in der Aqara-Version für den lokalen Markt fehlen derzeit.  Es kann jedoch durch einen Schlüsselschalter ersetzt werden (die Installation in einem Verteilerkasten ist natürlich schwieriger). <br><br>  Ursprünglich wollte ich das Relais hinter dem Schlüsselschalter montieren, es stellte sich jedoch als sehr problematisch heraus, die Stromleitung an die richtige Stelle zu ziehen (wieder benötigt das Relais Strom).  Ein idealer Ort ist ein Verteilerkasten, an dem die Stromleitung, die Leitung vom Schalter und die Leitung von Straßenlaternen zusammenlaufen.  Es befand sich unter einer Zwischendecke, was zum Abbau mehrerer Auskleidungsschienen führte.  Es war ratsam, diesen Punkt im Voraus zu überdenken.  Die Installation wurde jedoch erfolgreich abgeschlossen.  Der Schaltplan ist viel komplizierter als für Steckdosen und Schalter (in meinem Fall vier 3-Draht-Drähte und 8 Klemmen am Relais selbst).  Um nichts zu merken und zu verwechseln, habe ich vor der Montage ein Diagramm auf ein Blatt Papier gezeichnet.  Dann habe ich eine Testinstallation durchgeführt, um alles zu überprüfen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bz/n5/gd/bzn5gdba_obeh-ja73lxl2fdvjc.jpeg" alt="Bild"></div><br>  Das Gerät wurde in der Anwendung angeschlossen und die Testphase hat begonnen.  Die Straßenlaterne sollte als zuvor vorhandener Schlüsselschalter und unter Verwendung der Anwendung ein- und ausgeschaltet werden.  Auf der Straße gibt es zwei Ampeln - eine links und eine rechts.  Das Relais hat zwei Kanäle, aber es war nicht sinnvoll, sie separat einzuschalten.  Andererseits wollte ich sie nicht mit zwei Klicks in die Anwendung einbinden.  Daher wurde die Steuerung auf einem Relaiskanal durchgeführt.  Durch einen seltsamen Zufall funktionierte diese Option nicht normal - es blieb in der einen oder anderen Position stecken.  Es gab nicht mehr viel Zeit für Experimente, als das Tageslicht endete und ich die Verkleidung an der Deckenrückseite montieren wollte.  Deshalb habe ich die Lichter auf beiden Kanälen parallel geschaltet und alles hat funktioniert, wie ich wollte.  Damit die physischen und Software-Switches als Passthrough funktionieren, wurde die Option Interlock in den Relaiseinstellungen aktiviert. <br><br>  Es wäre auch möglich, die Ein / Aus-Timer-Beleuchtung zu organisieren.  Aber dieses Szenario war noch nicht interessiert. <br><br><h2>  Zugangskontrolle </h2><br>  Ein weiterer merkwürdiger Moment war die Kontrolle über das Öffnen der Straßentür.  Zuallererst, um festzustellen und zu benachrichtigen, dass jemand vergessen hat, diese Tür normal zu schließen oder sie ganz offen zu lassen. <br><br>  Für dieses Szenario wurde ein Fenster- / Türöffnungssensor benötigt.  Der Ausgabepreis beträgt ca. 1000 R.  Es gibt Sensoren von Aqara für den lokalen Markt (sie haben weniger abgerundete Kanten). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pb/fy/id/pbfyidivjmpgggpxrwxowgeq-h8.jpeg" alt="Bild"></div><br>  Die Installation ist sehr einfach - die Sensoren werden auf doppelseitigem Klebeband montiert.  Vor der Montage ist es besser, den Sensor in der Anwendung anzuschließen, um zu sehen, in welcher Entfernung die Operation stattfindet.  Die Anleitung schreibt einen Spalt von bis zu 20 mm vor, was aber, gelinde gesagt, nicht stimmt - der Sensor und der Reaktionsmagnet müssen fast bündig montiert werden.  Im Haupthaus ist ein ähnlicher Sensor am Garagentor installiert.  Zwischen der Führung und dem Bund befindet sich ein Dichtungsgummi mit einer Breite von 1 cm. In diesem Abstand zeigte der Sensor die Position „offen“ an und musste den Ansprechmagneten erhöhen. <br><br>  Nachdem der Anwendung ein neues Gerät hinzugefügt wurde, können Sie mit der Automatisierung fortfahren.  Wir konfigurieren das Szenario "Wenn die Tür länger als 1 Minute geöffnet ist" mit einer Benachrichtigung an das Telefon.  In der englischen Lokalisierung ist ein Teil der Phrase von ungefähr 1 Minute nicht sichtbar, aber die Ansprechschwelle ist genau das.  In den Anwendungen Aqara Sensor und Aqara Home können andere Triggerintervalle konfiguriert werden.  Leider ist dies in der Xiaomi Home-Anwendung noch nicht möglich.  Die Praxis hat jedoch gezeigt, dass ein Intervall von 1 Minute mehr als ausreichend ist - es gibt keine falschen Positiven, alle Positiven waren in dem Fall.  Sie können die Protokolle auch nach Sensoren anzeigen.  Dieser Sensor ist keine Ausnahme.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es ist zum Beispiel möglich, anhand eines Protokolls zu bestimmen, wann das Badehaus ankam (die erste Tür wurde an diesem Tag geöffnet) und wann es verließ (die letzte Tür wurde geschlossen), wodurch die Gesamtzeit geschätzt wird, die im Raum verbracht wurde. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wk/uv/ry/wkuvryxsyoah4u-7dwoj0yct9a4.jpeg" alt="Bild"></div><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bedienimpressionen </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Gesamtbetriebserfahrung ist rein positiv. </font><font style="vertical-align: inherit;">Natürlich gibt es einige kleine Nuancen, aber das Hauptziel der Automatisierung wurde erreicht. </font><font style="vertical-align: inherit;">Dies ist in erster Linie eine psychologische Ruhe, die durch Testergebnisse bestätigt wird. </font><font style="vertical-align: inherit;">Komfort ist auch wichtig - Fernbedienung der Straßenbeleuchtung, eine Abzugshaube wurde beschafft, eine zusätzliche Nachtlampe erschien. </font><font style="vertical-align: inherit;">Wenn Sie in den Urlaub gefahren sind, können Sie sich erinnern und das Wasser aus der Ferne abstellen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Kosten aller oben genannten Geräte in ungefährer Form (ohne Bezugnahme auf ein bestimmtes Geschäft) sind unten angegeben. </font><font style="vertical-align: inherit;">Bei der Bestellung auf AliExpress unterscheiden sich die Preise in eine kleinere Richtung.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i9/ij/pf/i9ijpffhxd2i-jaq00ieo58eupo.png" alt="Bild"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bei der Auswahl eines Gerätesatzes muss die Kompatibilität berücksichtigt werden (für welche Region dieses Gerät hergestellt wurde und zu welcher Familie es gehört). Im Rahmen des Antrags wird es nicht möglich sein, ein Szenario zu erstellen, das beispielsweise durch das Rauchmelderereignis (für die Region „China Mainland“) den Auslass für die europäische Region steuert. Wenn Sie keinen exotischen Rauchmelder benötigen, sollten Sie sich die Aqara-Geräte für den lokalen Markt genauer ansehen. Am Ende kann das Relais beispielsweise durch einen Zweitastenschalter ersetzt werden. Einige Geschäfte, die Xiaomi-Geräte verkaufen, importieren diese offenbar in Grau (diese Geräte wurden für die chinesische Region entwickelt). Aber zum Beispiel der Messenger, glückliche Geräte, die für unseren Markt entwickelt wurden. Neben der Kompatibilität derselben Steckdosen enthalten sie auch Anweisungen in Englisch und Russisch. Unten sehen Sie ein Foto von zwei identischen Sensoren.aber für verschiedene Regionen (innenchinesisch - links und außereuropäisch - rechts):</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uw/ph/x_/uwphx_titz3r1-hhwlduqxmzlwg.jpeg" alt="Bild"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Reaktionsvermögen der Steuerung durch die Anwendung ist nicht immer gut. Zum Beispiel kann es vorkommen, dass Sie immer wieder auf eine Situation stoßen, in der wir nicht das Licht einschalten, sondern einen Fehler im Sinne von "Anfrage fehlgeschlagen" erhalten. Die experimentell identifizierte Behandlung, bei der die Anwendung aus dem Speicher entfernt und neu gestartet wird, löst dieses Problem schneller, als beim nächsten Versuch auf eine Antwort zu warten. Manchmal treten auch Verzögerungen auf (bis zu 20-30 Sekunden), wenn der Status eines Sensors aktualisiert wird. In diesen Momenten ist es besser, die Ein- / Aus-Taste nicht erneut zu drücken, sondern nur auf die Aktualisierung des Status zu warten. Wenn Sie die Anwendung in bestimmten Situationen starten, wird anstelle einer Geräteliste eine leere Liste angezeigt. Es besteht kein Grund zur Panik - es erscheint normalerweise innerhalb der nächsten Sekunden. Benachrichtigungen auf dem Telefon werden nicht lokalisiert und die ordnungsgemäße Benennung der Ereignisse wird gespeichert.Darüber hinaus nutzen die Autoren der Anwendung regelmäßig den Push-Benachrichtigungskanal für Werbezwecke (erneut auf Chinesisch). Das mag ich natürlich nicht, aber es gibt nicht viel Auswahl.</font></font><br><br> ,           Xiaomi         .     - ,    ,      . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de482554/">https://habr.com/ru/post/de482554/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de482544/index.html">Ein Startup-Team mit „0“ zusammenstellen - Schritt-für-Schritt-Anleitung für die Kleinsten</a></li>
<li><a href="../de482546/index.html">VK Tech: Ein Jahr der Entwicklung in Git-Zahlen</a></li>
<li><a href="../de482548/index.html">Sicherheitswoche 52 + 1: Nicht-Standard-Top-3-Nachrichten des Jahres</a></li>
<li><a href="../de482550/index.html">Das mysteriöse LyX-Programm. Teil 2</a></li>
<li><a href="../de482552/index.html">Registrierung und Autorisierung mit Spring Security am Beispiel einer einfachen Anwendung</a></li>
<li><a href="../de482556/index.html">Ungefähr zu der Zeit, als das Gras „grüner“ war und AKG dinostatische Kopfhörer produzierte</a></li>
<li><a href="../de482560/index.html">Wie man einfache Texte schreibt</a></li>
<li><a href="../de482562/index.html">Der Personal Computer sollte vor zehn Jahren sterben: Was passierte stattdessen?</a></li>
<li><a href="../de482564/index.html">Wenn alle Geschichten im Stil von Science-Fiction geschrieben wären</a></li>
<li><a href="../de482566/index.html">Die neueste Generation von Wireless</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>