<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚Äçü§ù‚Äçüë®üèº üõèÔ∏è üòè Smart Home mit Xiaomi am Beispiel einer Badewanne üë©üèΩ‚Äç‚öñÔ∏è üåà üî†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im Internet gibt es eine ganze Reihe von Rezensionen und Videos zum Bau von Smart Homes. Es gibt die Meinung, dass dies alles ziemlich teuer und m√ºhsa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Smart Home mit Xiaomi am Beispiel einer Badewanne</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/plesk/blog/482554/"> Im Internet gibt es eine ganze Reihe von Rezensionen und Videos zum Bau von Smart Homes.  Es gibt die Meinung, dass dies alles ziemlich teuer und m√ºhsam in der Organisation ist, das hei√üt im Allgemeinen die Menge der Geeks.  Aber der Fortschritt steht nicht still.  Ger√§te werden billiger, w√§hrend sie funktionaler sind und Design und Installation recht einfach sind.  Grunds√§tzlich konzentrieren sich die Reviews jedoch auf 1-2 Anwendungsbeispiele, die praktisch nicht die Nuancen abdecken und kein ganzheitliches Bild ergeben.  In diesem Artikel m√∂chte ich daher das abgeschlossene Projekt √ºberpr√ºfen und Nutzungsszenarien und Fallstricke aufzeigen, die beim Bau eines Smart Homes mit Xiaomi-Ger√§ten am Beispiel des Badehauses auftreten.  Die beschriebenen Ideen mit geringf√ºgigen Abweichungen k√∂nnen auf die Automatisierung der Wohnung angewendet werden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9h/lb/tj/9hlbtjf6rdghf--lzwsq-5bysk8.jpeg" alt="Bild" width="400" height="400"></div><br><a name="habracut"></a><br><h2>  Hintergrund oder warum das alles notwendig ist </h2><br>  F√ºr den Anfang ein wenig Hintergrund, um den Kontext zu verdeutlichen.  Anfang Herbst 2018 wurde die Fertigstellung des Bades abgeschlossen und in Betrieb genommen.  Das Badehaus ist ein autonomes Hauptgeb√§ude mit ganzj√§hriger Heizung und Wasserversorgung. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ns/wd/o5/nswdo5svyprgue1sgxhojmb83kk.jpeg" alt="Bild"></div><br>  Aus offensichtlichen Gr√ºnden lebt niemand st√§ndig im Badehaus und kontrolliert nicht den Zustand der R√§umlichkeiten.  Auch ein Badebesuch ist, so oft ich m√∂chte, nicht sehr h√§ufig.  Dementsprechend waren von Anfang an √úberlegungen angestellt, ein ‚Äûintelligentes‚Äú Bad zu schaffen.  Zun√§chst aus Sicherheitsgr√ºnden (Feuer, √úberschwemmung, Zugangskontrolle).  Das Ausschalten der Heizung bei -35 Grad auf der Stra√üe (ich wohne in Nowosibirsk) ist beispielsweise eine sehr gef√§hrliche Situation.  Im Gegensatz zum Haupthaus habe ich jedoch nicht von Anfang an √ºber das Projekt der Automatisierung des Bades nachgedacht und keine zus√§tzliche Verkabelung an den richtigen Stellen vorgenommen.  Auf der anderen Seite wurde das Internet im Badehaus betrieben, und f√ºr das Erscheinungsbild von zwei anderen Geb√§uden wird eine Video√ºberwachung durchgef√ºhrt (Sie k√∂nnen visuell auswerten, was passiert). <br><br>  Nachdem ich im November 2019 von einer Gesch√§ftsreise zur√ºckgekehrt war, ging ich abends zum Badehaus, √∂ffnete die Haust√ºr und war schockiert von dem, was ich sah.  Die WiFi-Punkt-LEDs blinkten aus der Dunkelheit auf mich zu und ein Wasserstrahl sprudelte auf meine F√º√üe.  Das hei√üt, √úberschwemmungen traten auf, w√§hrend der Strom nicht abgeschaltet wurde.  Das Wasser im Badehaus wird mithilfe einer eigenen Tauchpumpe und einer Automatisierung, die den Prozess steuert, organisiert.  Wie sich sp√§ter herausstellte, wurde eine der Armaturen im Toilettenwechsel unterbrochen und alle R√§ume √ºberflutet.  Ich habe nie herausgefunden, warum die Automatisierung schade war und immer noch ausgeschaltet war, aber sie schaffte es, 15 cm Wasser auf 30 Quadrate zu pumpen.  Auf der Stra√üe war an diesem Tag -14 Grad.  Der warme Boden kam zurecht und hielt die Raumtemperatur weiterhin auf dem richtigen Niveau, aber es erschien eine Feuchtigkeit von 100%.  Es war unm√∂glich, mehr √ºber die Organisation eines intelligenten Hauses zu z√∂gern - Sie m√ºssen damit beginnen. <br><br><h2>  Auswahl der Ausr√ºstung </h2><br>  W√§hrend des Baus des Haupthauses habe ich Erfahrungen mit <a href="https://eldesalarms.com/">Eldes-</a> Ger√§ten <a href="https://eldesalarms.com/">gesammelt</a> (die entsprechende Verkabelung wurde erstellt).  Ein Teil der Automatisierung erfolgt auf dem <a href="https://www.raspberrypi.org/">Raspberry PI</a> .  Ein weiterer Teil <a href="https://www.aqara.com/en/home.html">betrifft Xiaomi Aqara-Ger√§te</a> .  Die Option mit Raspberry PI war f√ºr mich die attraktivste und wurde zun√§chst f√ºr das Badehaus in Betracht gezogen.  Leider erfordert es aber deutlich mehr Organisationsaufwand.  Dies ist immer noch kein Plug-and-Play-Ger√§t - angefangen mit √úbungen mit Hardware bis hin zum Schreiben von Software f√ºr Ihre eigenen Bed√ºrfnisse.  Aus bestimmten Gr√ºnden war <a href="https://mjdm.ru/">MajorDoMo</a> nicht gl√ºcklich.  Das √úberqueren von Himbeer-PI, ZigBee-Adapter (f√ºr die Verwendung von drahtlosen Xiaomi-Sensoren) und Apple HomeKit erfordert eine Studie (und die Apple HomeKit-Benutzeroberfl√§che ist im Moment nicht sehr zufrieden).  Es blieb nicht viel Zeit (ich wollte die Situation nicht wiederholen) und es gab keine Verkabelung f√ºr jeden gew√ºnschten Punkt, sodass ich mich entschied, alles auf Xiaomi-Ger√§ten zu tun. <br><br>  Das Hauptger√§t in dieser Situation ist der Hub.  Bei Xiaomi gibt es zwei Optionen f√ºr den Hub: Xiaomi Mi Smart Home Gateway 2 und Xiaomi Aqara Gateway.  Letzteres ist etwa doppelt so teuer, f√ºr den lokalen Markt besser geeignet und kann Ger√§te in Apple HomeKit integrieren.  Wenn Sie jedoch die Aqara Home-Anwendung installieren und die Region ‚ÄûRussland‚Äú ausw√§hlen, sind zum Zeitpunkt des Schreibens dieser Zeilen nur 13 verschiedene Ger√§te (Schalter, Steckdosen, Sensoren) verf√ºgbar.  Wenn Sie die Xiaomi Home-Anwendung installieren, w√§hlen Sie die Region ‚ÄûChina Mainland‚Äú aus. Hunderte von Ger√§ten stehen f√ºr die Verbindung zur Verf√ºgung.  Wenn Sie jedoch die Region ‚ÄûChina Mainland‚Äú ausw√§hlen, k√∂nnen Sie keine europ√§ische Steckdose anschlie√üen und umgekehrt.  Die Auswahl der Region ‚ÄûChina Mainland‚Äú als Teil der Aqara Home-Anwendung bietet nicht die Vollst√§ndigkeit von Ger√§ten, die in Xiaomi Home mit derselben Region vorhanden sind.  Aus Angst vor Inkompatibilit√§t habe ich mich dazu entschlossen, beim Hub Xiaomi Mi Smart Home Gateway 2 anzuhalten.  Der Hub selbst fungiert √ºbrigens als Lampe - dies kann bei der Installation ber√ºcksichtigt werden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vs/ul/kx/vsulkxlnghjjindbwwmxw9aemxq.jpeg" alt="Bild"></div><br>  Eine andere interessante Frage ist, wie lange dies funktionieren wird.  Es geht nicht einmal um Sensoren und Batterien, sondern um Synchronisation und Datenspeicherung in der Cloud.  Das Konto ist derzeit frei.  Alle Informationen werden auf Xiaomi-Servern gespeichert.  Wenn die Jungs morgen entscheiden, dass Benutzer aus Russland keine Daten in der Region ‚ÄûChina Mainland‚Äú speichern sollen oder wenn Roskomnadzor aus irgendeinem Grund ihre Server sperrt, l√§uft das ganze Smart House Gefahr, sich in einen K√ºrbis zu verwandeln.  Ich habe selbst entschieden, dass in diesem Fall die Sensoren erhalten bleiben und der Hub durch den Raspberri PI + ZigBee Adapter ersetzt wird. <br><br><h2>  Leckagekontrolle und -verh√ºtung </h2><br>  Das erste und wichtigste Automatisierungsszenario war eine nat√ºrliche Fortsetzung des Problems - bei einem Leck m√ºssen Sie die Wasserversorgung, dh die Pumpe, abschalten und eine Benachrichtigung √ºber das Problem an das Telefon senden.  Es gab zwei potenziell gef√§hrliche Stellen f√ºr das Auftreten von Undichtigkeiten. <br><br>  Neben dem Hub f√ºr dieses Szenario waren zwei Lecksensoren und eine intelligente Wandsteckdose erforderlich.  Der Preis f√ºr den Leckagesensor liegt bei ca. 1400 r.  Der Preis f√ºr eine intelligente Steckdose betr√§gt ca. 1700 p.  Die Lecksensoren sind autonom, sie arbeiten mit Batterien.  Der Hersteller gibt an, dass eine Batterie f√ºr 2 Jahre ausreicht. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bt/d3/q2/btd3q2gftpvfsf_drdszmsisfwm.jpeg" alt="Bild"></div><br>  Die Installation einer intelligenten Steckdose war etwas kompliziert, da f√ºr chinesische Steckdosen quadratische Steckdosen erforderlich sind, die nicht in unseren normalen L√§den verkauft werden (sondern bestellt werden k√∂nnen).  Das Bohren von quadratischen L√∂chern ist immer noch ein Vergn√ºgen.  Zu guter Letzt ben√∂tigen Sie einen Adapter, obwohl es auch eine Steckdose f√ºr einen europ√§ischen Stecker gibt.  In der Aqara-Version f√ºr den lokalen Markt gibt es derzeit keine Wandsteckdose f√ºr die Wandmontage, was uns an die Region ‚ÄûChina Mainland‚Äú bindet.  Alternativ k√∂nnen Sie eine normale Steckdose installieren und eine intelligente Steckdose mit einem Stecker von Xiaomi daran anschlie√üen. Hierf√ºr sind jedoch zwei zus√§tzliche Adapter erforderlich.  Eine andere Alternative ist ein Relais.  Aber ich entschied mich f√ºr eine Wandsteckdose. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qe/rg/pg/qergpgrjkaqqosy5xr2pqc_hli8.jpeg" alt="Bild"></div><br>  In der Xiaomi Home-Anwendung wurden ein Sockel und ein Sensor hinzugef√ºgt.  Als n√§chstes wird das Szenario ‚ÄûIm Falle eines Lecks‚Äú f√ºr zwei Aktionen vorgeschrieben: Schalten Sie die Steckdose aus und senden Sie einen Alarm. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p7/pj/ub/p7pjubzhpjzb6tt_aoxrdd20_fs.jpeg" alt="Bild"></div><br>  Der erste Leckagesensor wurde neben der Pumpe (und tats√§chlich neben der Nabe) installiert.  F√ºr den Test wurde Wasser in eine kleine Platte gegossen und der Sensor wurde hineingesenkt.  Ich habe die gesamte Aktion direkt am Aufstellungsort des Sensors durchgef√ºhrt, um die Situation so nah wie m√∂glich an die Realit√§t heranzuf√ºhren.  Der Test war erfolgreich: Die Steckdose wurde ausgeschaltet, die Benachrichtigung ging auf das Telefon und der Hub blinkte im Notfallmodus. <br><br>  Der zweite Leckanzeiger sollte in der Toilette neben dem Rohraustausch installiert werden.  Bei der Installation traten jedoch Nuancen auf - der Hub konnte den Sensor nicht erkennen, obwohl der Abstand gering war.  Der Grund ist die Konfiguration der R√§umlichkeiten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ce/33/gb/ce33gbivdrkzwq2f4t-vghi69ki.jpeg" alt="Bild"></div><br>  Zwischen dem Aufstellort der Nabe (Ruheraum) und dem Aufstellort des zweiten Leckagesensors (Toilette) befand sich ein Dampfbad.  Das Dampfbad ist in bester Tradition mit Folie in den Kreis eingen√§ht, was zu Problemen beim Durchgang des Signals f√ºhrt. <br><br>  Der Hersteller behauptet, dass die Ger√§te ein Mesh-Netzwerk bilden k√∂nnen, dh ein Ger√§t kann Daten √ºber ein anderes Ger√§t an den Hub √ºbertragen.  Irgendwo stie√ü ich auf die Information, dass nur mit dem Netzwerk verbundene Ger√§te (und keine Batterien) als solche Sender in einem Maschennetzwerk fungieren k√∂nnen.  Es hat mir jedoch gereicht, einen Temperatursensor in der Ecke des Waschraums anzubringen, damit das Signal vom Leckagesensor nicht mehr verschwindet.  M√∂glicherweise ist dies ein Zufall, da sp√§ter im Waschraum unter der Decke ein Relais zur Steuerung der Stra√üenbeleuchtung angebracht wurde (m√∂glicherweise fungiert es als Sender im Maschennetz).  Das Problem mit dem Signalverlust vom Lecksensor in der Toilette wurde jedoch behoben.  Zus√§tzlich k√∂nnen Sie die Verbindung des Ger√§ts mit dem Hub √ºberpr√ºfen, indem Sie auf den Sensor in der Mitte klicken.  Wenn alles in Ordnung ist, ert√∂nen die relevanten Informationen in reinem Chinesisch vom Hub (im Fall des Aqara-Hubs erfolgt die Kommunikation in angenehmem Englisch). <br><br>  Das √úberpr√ºfen der Abschaltung und das anschlie√üende Einschalten des Stroms mit der Maschine zeigten, dass die Smart-Steckdose ausgeschaltet ist.  Damit es beim Auftreten von Strom in den Ein-Zustand wechselt, gibt es eine entsprechende Einstellung: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7m/mp/rv/7mmprvrfrwirqrveigp5hk5rbna.jpeg" alt="Bild"></div><br>  Ein zus√§tzliches Zeichen f√ºr die √úberflutung des Raumes war eine Erh√∂hung der Luftfeuchtigkeit um bis zu 100%.  √úber die Kontrolle dieses Symptoms - im n√§chsten Abschnitt. <br><br><h2>  Rauch- und Temperaturkontrolle </h2><br>  Das Badehaus ist ein brandgef√§hrdeter Raum, daher sollten im folgenden Szenario Anzeichen eines Feuers identifiziert werden. <br><br>  F√ºr dieses Szenario wurden zwei Temperatur- (und Feuchtigkeits-) Sensoren und ein Rauchsensor ben√∂tigt.  Der Preis f√ºr den Temperatursensor liegt bei ca. 1000 r.  Der Rauchmelder kostet ca. 2000 p.  In der Aqara-Version f√ºr die Region gibt es derzeit keinen Rauchmelder, was uns wieder an die Region ‚ÄûChina Mainland‚Äú bindet. <br><br>  Der Rauchmelder wurde an der Decke des Korridors im Waschraum montiert (eigentlich nicht weit vom Herd und dem Dampfraumausgang entfernt).  Anschlie√üend wurde in der Xiaomi Home-Anwendung ein Ger√§t hinzugef√ºgt und ein Szenario f√ºr den Fall der Raucherkennung erstellt. Anschlie√üend wurde eine Benachrichtigung an das Telefon gesendet.  Der Test wurde von einem Kaminsims durchgef√ºhrt.  Der Sensor hat den Test erfolgreich abgeschlossen.  Der Hub blinkte mit einem Alarm und ein akustischer Alarm ert√∂nte.  Der Sensor selbst war auch sehr gemein und piepste laut und warnte vor dem Problem. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zg/ej/jg/zgejjg01wv9ayueq8tzptcumzs8.jpeg" alt="Bild"></div><br>  Ein weiteres Zeichen von Feuer ist ein Temperaturanstieg.  Zur √úberwachung der Temperatur wurden zwei Sensoren installiert: einer im Ruheraum, der andere im Waschraum.  In der Anwendung wurde dann das Szenario ‚ÄûBei einer h√∂heren Temperatur als der eingestellten‚Äú mit der entsprechenden Benachrichtigung des Telefons konfiguriert.  Im Moment stelle ich die Schwelle f√ºr den Ruheraum auf 30 Grad ein (im Sommer muss ich sie wahrscheinlich neu konfigurieren). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/0w/pj/nq0wpjrfwe3nsl6hfpnjxwsuzhq.jpeg" alt="Bild"></div><br>  Au√üerdem wurde das Szenario ‚Äûbei einer Temperatur unter dem eingestellten Wert‚Äú mit einem Schwellenwert von 18 Grad eingerichtet und auf das Telefon aufmerksam gemacht.  Wenn aus irgendeinem Grund die Heizung nicht mehr funktioniert, m√∂chte ich so schnell wie m√∂glich dar√ºber informiert werden.  In √§hnlicher Weise wurden f√ºr beide Sensoren die Szenarien ‚Äûbei erh√∂hter Luftfeuchtigkeit‚Äú mit einer Schwelle von 70%, einem Telefonalarm und einem Abschalten der Wasserversorgungspumpe erstellt. <br><br>  Von den angenehmen Boni f√ºr Temperatur- und Feuchtigkeitssensoren sind historische Diagramme in der Anwendung verf√ºgbar.  Sie k√∂nnen beispielsweise bestimmen, zu welchem ‚Äã‚ÄãZeitpunkt das Bad f√ºr den vorgesehenen Zweck verwendet wurde (Temperaturspitzen in der folgenden Grafik) oder vergleichen, ob die aktuelle Temperatur abnormal ist. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cf/tb/av/cftbaviejmlpp8nndfwizm6un60.jpeg" alt="Bild"></div><br><br><h2>  L√ºftungssteuerung </h2><br>  Ein erzwungener Auszug aus dem Gel√§nde wird im Dampfbad organisiert.  Nach Abschluss der Prozeduren ist es ratsam, den Raum zu l√ºften.  Die Bel√ºftung wurde √ºber einen Schl√ºsselschalter eingeschaltet, und die Bel√ºftung selbst dauerte mindestens 30 Minuten. Oft enden Versammlungen im Badehaus jedoch in der ersten oder zweiten Stunde der Nacht.  Es ist nicht immer m√∂glich, alles im Voraus zu erledigen und am Ende weitere 30 Minuten zu sitzen und zu warten, bis das Dampfbad bel√ºftet ist, ist ein Vergn√ºgen, das unterdurchschnittlich ist, da Sie bereits schlafen m√∂chten. <br><br>  F√ºr dieses Szenario ben√∂tigten wir einen Schl√ºsselschalter von Xiaomi mit einer Nulllinie und einer Wandmontage.  Der Ausgabepreis betr√§gt ca. 1900 p.  Schalter sind in der Aqara-Version f√ºr den lokalen Markt erh√§ltlich. <br><br>  In meinem Fall k√∂nnen Sie einen herk√∂mmlichen Schalter einfach nicht durch einen intelligenten ersetzen - eine Stromleitung ist erforderlich.  Dementsprechend musste ich die Nulllinie zum Montageloch f√ºr den Schalter strecken, da es eine solche M√∂glichkeit gab.  Bei einem Schalter ohne Nulllinie w√§re die Installation einfacher. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q0/k2/p-/q0k2p-qvozvt_zk3e-i407jprhk.jpeg" alt="Bild"></div><br>  Nach der Installation wurde der Anwendung ein Smart Switch als Ger√§t hinzugef√ºgt und die Leistung getestet.  In den Schaltereinstellungen befindet sich ein Timer, und Sie k√∂nnen die Zeit zum Ausschalten einstellen.  Das hei√üt, bevor Sie das Bad verlassen, wird der Ausschalttimer auf zus√§tzliche 30 Minuten Bel√ºftung eingestellt, und Sie k√∂nnen sicher einschlafen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9e/4c/5g/9e4c5gckmsp0dsiekxkbvhk5imk.jpeg" alt="Bild"></div><br>  Eine weitere Option der Prozessautomatisierung ist m√∂glich.  Nach dem Baden wird zus√§tzlich zur Bel√ºftung die Dampfbadt√ºr vollst√§ndig ge√∂ffnet.  Dies f√ºhrt zu einem Temperaturanstieg im Waschraum, in dem ein Temperatursensor installiert ist.  Basierend auf den Messwerten dieses Sensors k√∂nnen Sie Szenarien zum Ein- und Ausschalten der Beatmung erstellen.  Aber ich habe diese Option noch nicht ausgef√ºhrt.  Au√üerdem k√∂nnte man mit einem Dampfbad-T√ºr√∂ffnungssensor experimentieren.  Aber ich f√ºrchte, er wird schnell sterben oder abfallen, da die T√ºr aus Glas ist und im Dampfbad auch 120 Grad haben kann. <br><br><h2>  Kontrolle der Stra√üenbeleuchtung </h2><br>  Eine andere Aufgabe, die ich automatisieren wollte, war die Steuerung der Stra√üenbeleuchtung auf der Veranda.  Eines der typischen Szenarien: Schalten Sie das Licht auf der Veranda ein, wenn Sie sich in der N√§he des Geb√§udes befinden und es drau√üen dunkel wird.  Das Bad ist verschlossen, der Schalter f√ºr die Stra√üenbeleuchtung befindet sich im Haus.  Ich musste dem Schl√ºssel nachgehen, um die T√ºr zu √∂ffnen und das Licht einzuschalten.  Das Ausschalten der Lichter erforderte eine √§hnliche Prozedur.  Ein weiteres Szenario, das regelm√§√üig auftrat: Schalten Sie das Licht auf der Veranda ein oder aus, wenn Sie sich im Haupthaus befinden.  Sehr oft verga√ü ich beim Verlassen des Badehauses, das Licht auf der Veranda auszuschalten, und fand dies, als ich im Haus war: entweder indem ich aus dem Fenster schaute oder indem ich auf die √úberwachungskameras schaute.  In diesem Moment ist Widerwillen normalerweise kein Ausweg, sodass das Licht die ganze Nacht brannte. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cc/tg/ex/cctgexbilx-hsr-tomjp9cs0gl8.jpeg" alt="Bild"></div><br>  Um diese Idee umzusetzen, wurde ein zweikanaliges Relais gekauft.  Der Ausgabepreis betr√§gt ca. 2000 p.  Relais in der Aqara-Version f√ºr den lokalen Markt fehlen derzeit.  Es kann jedoch durch einen Schl√ºsselschalter ersetzt werden (die Installation in einem Verteilerkasten ist nat√ºrlich schwieriger). <br><br>  Urspr√ºnglich wollte ich das Relais hinter dem Schl√ºsselschalter montieren, es stellte sich jedoch als sehr problematisch heraus, die Stromleitung an die richtige Stelle zu ziehen (wieder ben√∂tigt das Relais Strom).  Ein idealer Ort ist ein Verteilerkasten, an dem die Stromleitung, die Leitung vom Schalter und die Leitung von Stra√üenlaternen zusammenlaufen.  Es befand sich unter einer Zwischendecke, was zum Abbau mehrerer Auskleidungsschienen f√ºhrte.  Es war ratsam, diesen Punkt im Voraus zu √ºberdenken.  Die Installation wurde jedoch erfolgreich abgeschlossen.  Der Schaltplan ist viel komplizierter als f√ºr Steckdosen und Schalter (in meinem Fall vier 3-Draht-Dr√§hte und 8 Klemmen am Relais selbst).  Um nichts zu merken und zu verwechseln, habe ich vor der Montage ein Diagramm auf ein Blatt Papier gezeichnet.  Dann habe ich eine Testinstallation durchgef√ºhrt, um alles zu √ºberpr√ºfen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bz/n5/gd/bzn5gdba_obeh-ja73lxl2fdvjc.jpeg" alt="Bild"></div><br>  Das Ger√§t wurde in der Anwendung angeschlossen und die Testphase hat begonnen.  Die Stra√üenlaterne sollte als zuvor vorhandener Schl√ºsselschalter und unter Verwendung der Anwendung ein- und ausgeschaltet werden.  Auf der Stra√üe gibt es zwei Ampeln - eine links und eine rechts.  Das Relais hat zwei Kan√§le, aber es war nicht sinnvoll, sie separat einzuschalten.  Andererseits wollte ich sie nicht mit zwei Klicks in die Anwendung einbinden.  Daher wurde die Steuerung auf einem Relaiskanal durchgef√ºhrt.  Durch einen seltsamen Zufall funktionierte diese Option nicht normal - es blieb in der einen oder anderen Position stecken.  Es gab nicht mehr viel Zeit f√ºr Experimente, als das Tageslicht endete und ich die Verkleidung an der Deckenr√ºckseite montieren wollte.  Deshalb habe ich die Lichter auf beiden Kan√§len parallel geschaltet und alles hat funktioniert, wie ich wollte.  Damit die physischen und Software-Switches als Passthrough funktionieren, wurde die Option Interlock in den Relaiseinstellungen aktiviert. <br><br>  Es w√§re auch m√∂glich, die Ein / Aus-Timer-Beleuchtung zu organisieren.  Aber dieses Szenario war noch nicht interessiert. <br><br><h2>  Zugangskontrolle </h2><br>  Ein weiterer merkw√ºrdiger Moment war die Kontrolle √ºber das √ñffnen der Stra√üent√ºr.  Zuallererst, um festzustellen und zu benachrichtigen, dass jemand vergessen hat, diese T√ºr normal zu schlie√üen oder sie ganz offen zu lassen. <br><br>  F√ºr dieses Szenario wurde ein Fenster- / T√ºr√∂ffnungssensor ben√∂tigt.  Der Ausgabepreis betr√§gt ca. 1000 R.  Es gibt Sensoren von Aqara f√ºr den lokalen Markt (sie haben weniger abgerundete Kanten). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pb/fy/id/pbfyidivjmpgggpxrwxowgeq-h8.jpeg" alt="Bild"></div><br>  Die Installation ist sehr einfach - die Sensoren werden auf doppelseitigem Klebeband montiert.  Vor der Montage ist es besser, den Sensor in der Anwendung anzuschlie√üen, um zu sehen, in welcher Entfernung die Operation stattfindet.  Die Anleitung schreibt einen Spalt von bis zu 20 mm vor, was aber, gelinde gesagt, nicht stimmt - der Sensor und der Reaktionsmagnet m√ºssen fast b√ºndig montiert werden.  Im Haupthaus ist ein √§hnlicher Sensor am Garagentor installiert.  Zwischen der F√ºhrung und dem Bund befindet sich ein Dichtungsgummi mit einer Breite von 1 cm. In diesem Abstand zeigte der Sensor die Position ‚Äûoffen‚Äú an und musste den Ansprechmagneten erh√∂hen. <br><br>  Nachdem der Anwendung ein neues Ger√§t hinzugef√ºgt wurde, k√∂nnen Sie mit der Automatisierung fortfahren.  Wir konfigurieren das Szenario "Wenn die T√ºr l√§nger als 1 Minute ge√∂ffnet ist" mit einer Benachrichtigung an das Telefon.  In der englischen Lokalisierung ist ein Teil der Phrase von ungef√§hr 1 Minute nicht sichtbar, aber die Ansprechschwelle ist genau das.  In den Anwendungen Aqara Sensor und Aqara Home k√∂nnen andere Triggerintervalle konfiguriert werden.  Leider ist dies in der Xiaomi Home-Anwendung noch nicht m√∂glich.  Die Praxis hat jedoch gezeigt, dass ein Intervall von 1 Minute mehr als ausreichend ist - es gibt keine falschen Positiven, alle Positiven waren in dem Fall.  Sie k√∂nnen die Protokolle auch nach Sensoren anzeigen.  Dieser Sensor ist keine Ausnahme.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es ist zum Beispiel m√∂glich, anhand eines Protokolls zu bestimmen, wann das Badehaus ankam (die erste T√ºr wurde an diesem Tag ge√∂ffnet) und wann es verlie√ü (die letzte T√ºr wurde geschlossen), wodurch die Gesamtzeit gesch√§tzt wird, die im Raum verbracht wurde. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wk/uv/ry/wkuvryxsyoah4u-7dwoj0yct9a4.jpeg" alt="Bild"></div><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bedienimpressionen </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Gesamtbetriebserfahrung ist rein positiv. </font><font style="vertical-align: inherit;">Nat√ºrlich gibt es einige kleine Nuancen, aber das Hauptziel der Automatisierung wurde erreicht. </font><font style="vertical-align: inherit;">Dies ist in erster Linie eine psychologische Ruhe, die durch Testergebnisse best√§tigt wird. </font><font style="vertical-align: inherit;">Komfort ist auch wichtig - Fernbedienung der Stra√üenbeleuchtung, eine Abzugshaube wurde beschafft, eine zus√§tzliche Nachtlampe erschien. </font><font style="vertical-align: inherit;">Wenn Sie in den Urlaub gefahren sind, k√∂nnen Sie sich erinnern und das Wasser aus der Ferne abstellen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Kosten aller oben genannten Ger√§te in ungef√§hrer Form (ohne Bezugnahme auf ein bestimmtes Gesch√§ft) sind unten angegeben. </font><font style="vertical-align: inherit;">Bei der Bestellung auf AliExpress unterscheiden sich die Preise in eine kleinere Richtung.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i9/ij/pf/i9ijpffhxd2i-jaq00ieo58eupo.png" alt="Bild"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bei der Auswahl eines Ger√§tesatzes muss die Kompatibilit√§t ber√ºcksichtigt werden (f√ºr welche Region dieses Ger√§t hergestellt wurde und zu welcher Familie es geh√∂rt). Im Rahmen des Antrags wird es nicht m√∂glich sein, ein Szenario zu erstellen, das beispielsweise durch das Rauchmelderereignis (f√ºr die Region ‚ÄûChina Mainland‚Äú) den Auslass f√ºr die europ√§ische Region steuert. Wenn Sie keinen exotischen Rauchmelder ben√∂tigen, sollten Sie sich die Aqara-Ger√§te f√ºr den lokalen Markt genauer ansehen. Am Ende kann das Relais beispielsweise durch einen Zweitastenschalter ersetzt werden. Einige Gesch√§fte, die Xiaomi-Ger√§te verkaufen, importieren diese offenbar in Grau (diese Ger√§te wurden f√ºr die chinesische Region entwickelt). Aber zum Beispiel der Messenger, gl√ºckliche Ger√§te, die f√ºr unseren Markt entwickelt wurden. Neben der Kompatibilit√§t derselben Steckdosen enthalten sie auch Anweisungen in Englisch und Russisch. Unten sehen Sie ein Foto von zwei identischen Sensoren.aber f√ºr verschiedene Regionen (innenchinesisch - links und au√üereurop√§isch - rechts):</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uw/ph/x_/uwphx_titz3r1-hhwlduqxmzlwg.jpeg" alt="Bild"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Reaktionsverm√∂gen der Steuerung durch die Anwendung ist nicht immer gut. Zum Beispiel kann es vorkommen, dass Sie immer wieder auf eine Situation sto√üen, in der wir nicht das Licht einschalten, sondern einen Fehler im Sinne von "Anfrage fehlgeschlagen" erhalten. Die experimentell identifizierte Behandlung, bei der die Anwendung aus dem Speicher entfernt und neu gestartet wird, l√∂st dieses Problem schneller, als beim n√§chsten Versuch auf eine Antwort zu warten. Manchmal treten auch Verz√∂gerungen auf (bis zu 20-30 Sekunden), wenn der Status eines Sensors aktualisiert wird. In diesen Momenten ist es besser, die Ein- / Aus-Taste nicht erneut zu dr√ºcken, sondern nur auf die Aktualisierung des Status zu warten. Wenn Sie die Anwendung in bestimmten Situationen starten, wird anstelle einer Ger√§teliste eine leere Liste angezeigt. Es besteht kein Grund zur Panik - es erscheint normalerweise innerhalb der n√§chsten Sekunden. Benachrichtigungen auf dem Telefon werden nicht lokalisiert und die ordnungsgem√§√üe Benennung der Ereignisse wird gespeichert.Dar√ºber hinaus nutzen die Autoren der Anwendung regelm√§√üig den Push-Benachrichtigungskanal f√ºr Werbezwecke (erneut auf Chinesisch). Das mag ich nat√ºrlich nicht, aber es gibt nicht viel Auswahl.</font></font><br><br> ,           Xiaomi         .     - ,    ,      . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de482554/">https://habr.com/ru/post/de482554/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de482544/index.html">Ein Startup-Team mit ‚Äû0‚Äú zusammenstellen - Schritt-f√ºr-Schritt-Anleitung f√ºr die Kleinsten</a></li>
<li><a href="../de482546/index.html">VK Tech: Ein Jahr der Entwicklung in Git-Zahlen</a></li>
<li><a href="../de482548/index.html">Sicherheitswoche 52 + 1: Nicht-Standard-Top-3-Nachrichten des Jahres</a></li>
<li><a href="../de482550/index.html">Das mysteri√∂se LyX-Programm. Teil 2</a></li>
<li><a href="../de482552/index.html">Registrierung und Autorisierung mit Spring Security am Beispiel einer einfachen Anwendung</a></li>
<li><a href="../de482556/index.html">Ungef√§hr zu der Zeit, als das Gras ‚Äûgr√ºner‚Äú war und AKG dinostatische Kopfh√∂rer produzierte</a></li>
<li><a href="../de482560/index.html">Wie man einfache Texte schreibt</a></li>
<li><a href="../de482562/index.html">Der Personal Computer sollte vor zehn Jahren sterben: Was passierte stattdessen?</a></li>
<li><a href="../de482564/index.html">Wenn alle Geschichten im Stil von Science-Fiction geschrieben w√§ren</a></li>
<li><a href="../de482566/index.html">Die neueste Generation von Wireless</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>