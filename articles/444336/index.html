<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöΩ üàµ üë®üèª‚Äçüè≠ Listas de captura r√°pida: ¬øcu√°l es la diferencia entre enlaces d√©biles, fuertes y no propios? üëÇüèø ‚òïÔ∏è ü•ñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Joseph Wright, The Prisoner - Ilustraci√≥n de una captura fuerte 

 La lista de valores "capturados" se encuentra frente a la lista de par√°metros de ci...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Listas de captura r√°pida: ¬øcu√°l es la diferencia entre enlaces d√©biles, fuertes y no propios?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444336/"><img src="https://habrastorage.org/webt/ol/xa/zo/olxazojaea9ikajugulkcm6c-24.jpeg"><br>  <i>Joseph Wright, The Prisoner</i> - Ilustraci√≥n de una captura fuerte <br><br>  La lista de valores "capturados" se encuentra frente a la lista de par√°metros de cierre y puede "capturar" valores del alcance de tres maneras diferentes: utilizando los enlaces "fuerte", "d√©bil" o "sin due√±o".  A menudo lo usamos, principalmente para evitar ciclos de referencia fuertes ("ciclos de referencia fuertes" tambi√©n conocidos como "ciclos de retenci√≥n"). <br>  Puede ser dif√≠cil para un desarrollador novato decidir qu√© m√©todo aplicar, por lo que puede pasar mucho tiempo eligiendo entre "fuerte" y "d√©bil" o entre "d√©bil" y "sin due√±o", pero, con el tiempo, se dar√° cuenta de que la elecci√≥n correcta - solo uno. <br><a name="habracut"></a><br>  Primero, crea una clase simple: <br><br><pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Singer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">playSong</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Shake it off!"</span></span>) } }</code> </pre> <br>  Luego, escribimos una funci√≥n que crea una instancia de la clase <b>Singer</b> y devuelve un cierre que llama al m√©todo <b>playSong ()</b> de la clase <b>Singer</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sing</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; () -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> taylor = <span class="hljs-type"><span class="hljs-type">Singer</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> singing = { taylor.playSong() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> singing }</code> </pre> <br>  Finalmente, podemos llamar a <b>sing () en</b> cualquier lugar para obtener el resultado de <b>jugar playSong ()</b> <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> singFunction = sing() singFunction()</code> </pre> <br><br>  Como resultado, se mostrar√° la l√≠nea "Shake it off!". <br><br><h2>  Captura fuerte </h2><br>  A menos que especifique expl√≠citamente un m√©todo de captura, Swift utiliza una captura "fuerte".  Esto significa que el cierre captura los valores externos utilizados y nunca los dejar√° libres. <br><br>  Echemos un vistazo a la funci√≥n <b>sing ()</b> nuevamente <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sing</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; () -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> taylor = <span class="hljs-type"><span class="hljs-type">Singer</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> singing = { taylor.playSong() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> singing }</code> </pre> <br>  La <b>constante taylor se</b> define dentro de una funci√≥n, por lo que, en circunstancias normales, su lugar se liberar√≠a una vez que la funci√≥n haya terminado su trabajo.  Sin embargo, esta constante se usa dentro del cierre, lo que significa que Swift asegurar√° autom√°ticamente su presencia mientras exista el cierre, incluso despu√©s del final de la funci√≥n. <br>  Esta es una captura "fuerte" en acci√≥n.  Si Swift permiti√≥ <b>que</b> se liberara <b>a taylor</b> , entonces llamar a un cierre no ser√≠a seguro: su m√©todo <b>taylor.playSong ()</b> ya no es v√°lido. <br><br><h2>  Captura "d√©bil" (captura d√©bil) </h2><br>  Swift nos permite crear una " <u>lista de captura</u> " para determinar c√≥mo se capturan los valores utilizados.  Una alternativa a la captura "fuerte" es "d√©bil" y su aplicaci√≥n conlleva las siguientes consecuencias: <br><br>  1. Los valores capturados "d√©bilmente" no se mantienen en el cierre y, por lo tanto, pueden liberarse y establecerse en <b>nulo</b> . <br><br>  2. Como consecuencia del primer p√°rrafo, los valores capturados "d√©bilmente" en Swift son siempre <b>opcionales</b> . <br>  Modificamos nuestro ejemplo usando una captura "d√©bil" e inmediatamente vemos la diferencia. <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sing</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; () -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> taylor = <span class="hljs-type"><span class="hljs-type">Singer</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> singing = { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> taylor] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> taylor?.playSong() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> singing }</code> </pre> <br>  <b>[taylor d√©bil]</b> : esta es nuestra " <u>lista de captura</u> ", una parte especial de la sintaxis de cierre en la que damos instrucciones sobre c√≥mo se deben capturar los valores.  Aqu√≠ decimos que <b>taylor</b> debe capturarse "d√©bilmente", por lo que debemos usar <b>taylor? .PlaySong ()</b> : ahora es <b>opcional</b> , ya que puede establecerse en <b>nulo</b> en cualquier momento. <br><br>  Si ahora ejecuta este c√≥digo, ver√° que llamar a <b>singFunction ()</b> ya no da como resultado un mensaje.  La raz√≥n de esto es que <b>taylor</b> existe solo dentro de <b>sing ()</b> , y el cierre devuelto por esta funci√≥n no mantiene a <b>taylor</b> "fuertemente" dentro de s√≠ mismo. <br><br>  Ahora intenta cambiar <b>taylor? .PlaySong ()</b> a <b>taylor! .PlaySong ()</b> .  Esto conducir√° a un desempaque forzado de <b>taylor</b> dentro del cierre y, en consecuencia, a un error fatal (desempaquetar contenido que contenga <b>cero</b> ) <br><br><h2>  Captura "sin propietario" (captura sin propietario) </h2><br>  Una alternativa a la captura "d√©bil" es "sin propietario". <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sing</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; () -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> taylor = <span class="hljs-type"><span class="hljs-type">Singer</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> singing = { [<span class="hljs-keyword"><span class="hljs-keyword">unowned</span></span> taylor] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> taylor.playSong() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> singing }</code> </pre> <br>  Este c√≥digo terminar√° anormalmente de manera similar con el opcional desplegado opcionalmente que se muestra arriba: Taylor no propietario dice: "S√© con certeza que <b>Taylor</b> existir√° durante el cierre, por lo que no necesito guardarlo en la memoria".  De hecho, <b>Taylor</b> se lanzar√° casi de inmediato y este c√≥digo se bloquear√°. <br><br>  Por lo tanto, use <b>sin propietario con</b> mucho cuidado. <br><br><h2>  Problemas comunes </h2><br>  Hay cuatro problemas que enfrentan los desarrolladores cuando usan la captura de valor en los cierres: <br><br><h3>  1. Dificultades con la ubicaci√≥n de la lista de captura en el caso en que el cierre toma par√°metros </h3><br>  Este es un problema com√∫n que puede encontrar al comienzo del estudio de cierres, pero, afortunadamente, Swift nos ayudar√° en este caso. <br><br>  Al usar la lista de captura y los par√°metros de cierre juntos, la lista de captura viene entre corchetes, luego los par√°metros de cierre, luego la palabra clave in, que marca el comienzo del "cuerpo" de cierre. <br><br><pre> <code class="swift hljs">writeToLog { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>] user, message <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>?.addToLog(<span class="hljs-string"><span class="hljs-string">"\(user) triggered event: \(message)"</span></span>) }</code> </pre> <br>  Intentar poner una lista de captura despu√©s de los par√°metros de cierre dar√° como resultado un error de compilaci√≥n. <br><br><h3>  2. La aparici√≥n de un ciclo de enlaces fuertes, que conduce a una p√©rdida de memoria </h3><br>  Cuando una entidad A tiene una entidad B, y viceversa, tiene una situaci√≥n llamada "ciclo de retenci√≥n". <br><br>  Como ejemplo, considere el c√≥digo: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">House</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ownerDetails: (() -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>)? <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printDetails</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"This is a great house."</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">deinit</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"I'm being demolished!"</span></span>) } }</code> </pre> <br>  Definimos la clase <b>House</b> , que contiene una propiedad (cierre), un m√©todo y un inicializador que mostrar√° un mensaje cuando se destruya una instancia de la clase. <br><br>  Ahora cree una clase de <b>Propietario</b> similar a la anterior, excepto que su propiedad de cierre contiene informaci√≥n sobre la casa. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Owner</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> houseDetails: (() -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>)? <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printDetails</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"I own a house."</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">deinit</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"I'm dying!"</span></span>) } }</code> </pre> <br>  Ahora cree instancias de estas clases dentro del bloque <b>do</b> .  No necesitamos un bloque catch, pero el uso de un bloque <b>do</b> destruir√° las instancias justo despu√©s} <br><br><pre> <code class="swift hljs"><span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Creating a house and an owner"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> house = <span class="hljs-type"><span class="hljs-type">House</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> owner = <span class="hljs-type"><span class="hljs-type">Owner</span></span>() } <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Done"</span></span>)</code> </pre> <br>  Como resultado, se mostrar√°n mensajes: "Creando una casa y un propietario", "¬°Me estoy muriendo!", "¬°Estoy siendo demolido!", Y luego "Hecho": todo funciona como deber√≠a. <br><br>  Ahora crea un bucle de enlaces fuertes. <br><br><pre> <code class="swift hljs"><span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Creating a house and an owner"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> house = <span class="hljs-type"><span class="hljs-type">House</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> owner = <span class="hljs-type"><span class="hljs-type">Owner</span></span>() house.ownerDetails = owner.printDetails owner.houseDetails = house.printDetails } <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Done"</span></span>)</code> </pre> <br>  Ahora aparecer√° el mensaje "Creando una casa y un propietario", luego "Listo".  No se llamar√°n desinfectantes. <br><br>  Esto sucedi√≥ como resultado del hecho de que la casa tiene una propiedad que apunta al propietario, y el propietario tiene una propiedad que apunta a la casa.  Por lo tanto, ninguno de ellos puede liberarse de forma segura.  En una situaci√≥n real, esto conduce a p√©rdidas de memoria, que conducen a un bajo rendimiento e incluso a un bloqueo de la aplicaci√≥n. <br><br>  Para solucionar la situaci√≥n, necesitamos crear un nuevo cierre y usar una captura "d√©bil" en uno o dos casos, como este: <br><br><pre> <code class="swift hljs"><span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Creating a house and an owner"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> house = <span class="hljs-type"><span class="hljs-type">House</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> owner = <span class="hljs-type"><span class="hljs-type">Owner</span></span>() house.ownerDetails = { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> owner] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> owner?.printDetails() } owner.houseDetails = { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> house] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> house?.printDetails() } } <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Done"</span></span>)</code> </pre> <br>  No es necesario declarar ambos valores capturados, es suficiente hacerlo en un solo lugar; esto permitir√° que Swift destruya ambas clases cuando sea necesario. <br><br>  En proyectos reales, la situaci√≥n de un ciclo tan obvio de v√≠nculos fuertes rara vez surge, pero esto habla a√∫n m√°s de la importancia de utilizar la captura "d√©bil" con un desarrollo competente. <br><br><h3>  3. El uso inadvertido de enlaces fuertes, generalmente al capturar m√∫ltiples valores </h3><br>  Swift utiliza un fuerte agarre por defecto, lo que puede conducir a un comportamiento inesperado. <br>  Considere el siguiente c√≥digo: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sing</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; () -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> taylor = <span class="hljs-type"><span class="hljs-type">Singer</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> adele = <span class="hljs-type"><span class="hljs-type">Singer</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> singing = { [<span class="hljs-keyword"><span class="hljs-keyword">unowned</span></span> taylor, adele] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> taylor.playSong() adele.playSong() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> singing }</code> </pre> <br>  Ahora tenemos dos valores capturados por el cierre, y los usamos a ambos de la misma manera.  Sin embargo, solo <b>taylor se</b> captura como no <b>propiedad: se</b> captura a <b>adele con</b> fuerza porque la palabra clave <b>no propiedad</b> debe usarse para cada valor capturado. <br><br>  Si hizo esto a prop√≥sito, entonces todo est√° bien, pero si desea que ambos valores se capturen " <b>sin propiedad</b> ", necesita lo siguiente: <br><br><pre> <code class="swift hljs">[<span class="hljs-keyword"><span class="hljs-keyword">unowned</span></span> taylor, <span class="hljs-keyword"><span class="hljs-keyword">unowned</span></span> adele]</code> </pre> <br><h3>  4. Copie los cierres y comparta los valores capturados </h3><br>  El √∫ltimo caso en el que los desarrolladores se topan es c√≥mo se copian las fallas porque los datos que capturan est√°n disponibles para todas las copias de la falla. <br>  Considere un ejemplo de un cierre simple que captura la variable entera <b>numberOfLinesLogged</b> declarada fuera del cierre, para que podamos aumentar su valor e imprimirlo cada vez que se llama al cierre: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> numberOfLinesLogged = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> logger1 = { numberOfLinesLogged += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Lines logged: \(numberOfLinesLogged)"</span></span>) } logger1()</code> </pre> <br>  Esto mostrar√° el mensaje "L√≠neas registradas: 1". <br>  Ahora crearemos una copia del cierre que compartir√° los valores capturados junto con el primer cierre.  Por lo tanto, si llamamos al cierre original o su copia, veremos el valor creciente de la variable. <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> logger2 = logger1 logger2() logger1() logger2()</code> </pre><br>  Esto imprimir√° los mensajes "L√≠neas registradas: 1" ... "L√≠neas registradas: 4" porque <b>logger1</b> y <b>logger2</b> apuntan a la misma variable <b>numberOfLinesLogged</b> capturada. <br><br><h2>  Cu√°ndo usar una captura "fuerte", "d√©bil" y "sin due√±o" </h2><br>  Ahora que entendemos c√≥mo funciona todo, intentemos resumir: <br><br>  1. Si est√° seguro de que el valor capturado nunca ser√° <b>nulo</b> al realizar el cierre, puede usar <b>"captura no propiedad"</b> .  Esta es una situaci√≥n infrecuente en la que el uso de la captura "d√©bil" puede causar dificultades adicionales, incluso cuando se usa la protecci√≥n de dejar un valor d√©bilmente capturado dentro del cierre. <br><br>  2. Si tiene un caso de un ciclo de enlaces fuertes (la entidad A es propietaria de la entidad B y la entidad B es propietaria de la entidad A), entonces, en uno de los casos, debe usar <b>"captura d√©bil"</b> .  Es necesario tener en cuenta cu√°l de las dos entidades se liberar√° primero, por lo que si el controlador de vista A representa el controlador de vista B, entonces el controlador de vista B puede contener un enlace "d√©bil" de regreso a "A". <br><br>  3. Si se excluye la posibilidad de un ciclo de enlaces fuertes, puede usar la captura "fuerte" ( <b>"captura fuerte"</b> ).  Por ejemplo, ejecutar una animaci√≥n no se bloquea dentro del cierre que contiene la animaci√≥n, por lo que puede usar un enlace fuerte. <br><br>  4. Si no est√° seguro, comience con un enlace "d√©bil" y c√°mbielo solo si es necesario. <br><br>  Opcional - Gu√≠a oficial de Swift: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cortocircuitos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Conteo autom√°tico de enlaces</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/444336/">https://habr.com/ru/post/444336/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../444324/index.html">Siguiendo los pasos de las calculadoras: SpeedCrunch</a></li>
<li><a href="../444326/index.html">Monitoreo por SMS del peso de tres colmenas por $ 30</a></li>
<li><a href="../444328/index.html">El redise√±o de la interfaz de usuario suele ser una p√©rdida de tiempo</a></li>
<li><a href="../444330/index.html">El CMS sin servidor es finalmente un digno competidor para Wordpress</a></li>
<li><a href="../444332/index.html">Seguridad de la informaci√≥n y restauraci√≥n: c√≥mo piensan los gerentes acerca de los productos de TI</a></li>
<li><a href="../444338/index.html">Encapsulaci√≥n en Python 3</a></li>
<li><a href="../444340/index.html">Caracter√≠sticas del uso del tipo de datos Symbol en JavaScript</a></li>
<li><a href="../444342/index.html">Desarrollar aplicaciones JavaScript simples y modernas utilizando Webpack y tecnolog√≠as web avanzadas</a></li>
<li><a href="../444344/index.html">10 pasos para un proyecto exitoso de Python</a></li>
<li><a href="../444346/index.html">GraphQL y Golang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>