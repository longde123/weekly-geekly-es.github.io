<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úçüèæ ‚òÉÔ∏è üí´ B√∫squeda de Azure üì¥ ü§∞üèø üï∏Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Si alguno de sus proyectos usa los datos almacenados en la base de datos de Azhurov, es muy posible que tenga la oportunidad de usar la b√∫squeda de da...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>B√∫squeda de Azure</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454820/"><p><img src="https://habrastorage.org/webt/dd/li/cx/ddlicxgiqvi5vlyllvf2hgklivs.jpeg"></p><br><p>  Si alguno de sus proyectos usa los datos almacenados en la base de datos de Azhurov, es muy posible que tenga la oportunidad de usar la b√∫squeda de datos mediante la b√∫squeda de Azure.  Puede buscar no solo por bases de datos (Azure Cosmos DB, Azure SQL Database, SQL Server alojada en una m√°quina virtual de Azure), sino tambi√©n por Blob (Azure Blob Storage, Azure Table Storage). </p><br><p>  La b√∫squeda tiene una tarifa gratuita, que le permite crear hasta tres √≠ndices con un tama√±o total de hasta 50 Mb.  La tarifa gratuita no tiene capacidades de equilibrio de carga, pero es bastante adecuada para su uso. </p><a name="habracut"></a><br><p> Tratar con la b√∫squeda me pareci√≥ bastante simple (aunque no siempre es obvio).  Hay 3 tipos de objetos: fuente de datos, √≠ndice e indexador.  El objeto principal, tal vez, es el √≠ndice.  Es √©l quien es responsable de c√≥mo buscar y qu√© buscar exactamente.  Datasource es una conexi√≥n de datos, y el indexador es un trabajo que actualiza los datos del √≠ndice. </p><br><p>  La interfaz de usuario del portal le permite importar datos y crear los tres objetos.  La oportunidad pasar√° y agregar√° capacidades cognitivas a la b√∫squeda.  Si la base de datos SQL est√° en la suscripci√≥n, puede seleccionarla al crear la fuente de datos.  Aunque la contrase√±a por alguna raz√≥n, todav√≠a tiene que ingresar.  Si desea usar Cosmos DB, deber√° ingresar la cadena de conexi√≥n manualmente.  No olvide indicar en la l√≠nea y en la base de datos, agregando al final de la l√≠nea Base de datos = YOUR_BASE_NAME </p><br><p>  Despu√©s de elegir una fuente de datos, se le pedir√° que use capacidades de b√∫squeda cognitiva.  El conjunto de habilidades predeterminadas a√∫n es bastante peque√±o: puede definir el idioma, extraer nombres, nombres de organizaciones, lugares y frases clave.  Tambi√©n hay una oportunidad interesante para determinar la naturaleza del texto para las emociones positivas o negativas mediante la detecci√≥n de sentimientos.  Esta habilidad deber√≠a ser conveniente para usar con rese√±as de productos en tiendas en l√≠nea.  Es posible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">crear su propia habilidad</a> usando la descripci√≥n de la API. </p><br><p><img src="https://habrastorage.org/webt/r6/wh/4x/r6wh4xtuxatvapppu0wxw2lh67k.png"></p><br><p>  Para los archivos cargados en blob, es posible el reconocimiento √≥ptico de caracteres (OCR).  Es posible el reconocimiento de textos escritos a mano (hasta ahora solo en ingl√©s) e impresos.  Usando servicios cognitivos, es posible identificar varios objetos en la foto.  Por ejemplo, lugares famosos o celebridades. </p><br><p>  El siguiente paso es crear un √≠ndice.  La √∫nica opci√≥n para el <strong>modo de b√∫squeda de</strong> este d√≠a es "analysisInfixMatching" </p><br><p><img src="https://habrastorage.org/webt/aq/qg/6l/aqqg6ln6ptkzoqgpnizcp2cuezu.png"></p><br><p>  En este punto, puede marcar las casillas junto a los campos en su tabla o agregar alg√∫n campo nuevo al √≠ndice.  Por si acaso, explicar√© las posibilidades de los campos: </p><br><p>  <strong>Recuperable</strong> : el campo estar√° presente en los resultados de b√∫squeda <br>  <strong>Filtrable</strong> : el valor del campo se puede filtrar <br>  <strong>Seleccionable</strong> : puede ordenar el resultado por este campo <br>  <strong>Facetable</strong> : un tipo de agrupaci√≥n de acuerdo con ciertas caracter√≠sticas.  Por ejemplo, utilizando la siguiente expresi√≥n facet = listPrice, valores: 10 | 25 | 100 | 500 | 1000 | 2500, puede obtener el siguiente desglose de los resultados en grupos </p><br><p><img src="https://habrastorage.org/webt/pp/8d/wn/pp8dwnctx7vgllop2h-hsmboqqu.png"></p><br><p>  <strong>Se</strong> puede buscar: este campo buscar√° </p><br><p>  El campo <strong>Analizador</strong> sugiere elegir un analizador para varios idiomas.  Se utilizan 2 versiones: <em>Lucene</em> y <em>Microsoft</em> .  Para comprender cu√°l es la diferencia, debe comprender cu√°l es la diferencia entre los dos t√©rminos siguientes: </p><br><p>  <em>La tartamudez</em> es el proceso de encontrar la base de una palabra para una palabra fuente dada.  Tallo (ingl√©s) - tallo, tallo, origen.  Stemming usa algoritmos.  A menudo trunca las palabras eliminando sufijos y terminaciones, obteniendo la base de la palabra. <br>  <em>La lematizaci√≥n</em> es el proceso de reducir una forma de palabra a lema, su forma normal (vocabulario).  El lema es la forma can√≥nica, b√°sica de la palabra.  La lematizaci√≥n utiliza una b√∫squeda en el diccionario que contiene varias formas de palabras. </p><br><p>  El analizador Lucene utiliza stemming.  El analizador de Microsoft usa lematizaci√≥n. <br>  Por defecto, si no se selecciona nada, se usa Lucene.  Pero si est√° buscando datos en un idioma en particular, sin duda es mejor usar un analizador para este idioma. </p><br><p>  <strong>Suggester</strong> : le permite dar pistas con documentos que contienen el texto ingresado utilizando las letras iniciales de la b√∫squeda. </p><br><p>  Si est√° usando el probador en Azure Search en la aplicaci√≥n cliente, tendr√° 2 opciones para usarlo: el propio <em>contador</em> o el <em>autocompletado</em> .  En resumen, el mensaje sugiere completamente la fila completa del campo de la tabla, y el autocompletado solo ofrece completar una palabra o expresi√≥n de un par de palabras.  El mejor art√≠culo sobre las diferencias entre las indicaciones y los modos de autocompletar se describe en el siguiente art√≠culo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Autocompletar en Azure Buscar ahora en vista previa p√∫blica</a> Este art√≠culo tiene gifs muy visuales. </p><br><p>  En la etapa de creaci√≥n del <strong>indexador,</strong> debe especificar una <em>columna de marca de agua alta</em> .  Este es un campo que cambia cada vez que se cambia un registro.  Por lo general, esto es algo as√≠ como un campo con la fecha del √∫ltimo cambio o un campo _ts en Cosmos DB.  Durante la indexaci√≥n, si se cambia el valor del campo, el √≠ndice tambi√©n cambiar√°. </p><br><p><img src="https://habrastorage.org/webt/sb/-v/-y/sb-v-yttwlbx9lebmpzm5__wyjc.png"></p><br><p>  <strong>El seguimiento de eliminaciones</strong> es una opci√≥n para eliminar entradas del √≠ndice autom√°ticamente.  Pero para esto, debe tener una eliminaci√≥n suave configurada en su base de datos.  Si usa la eliminaci√≥n suave, cuando elimina un registro, no se elimina, sino que simplemente se marca como eliminado.  La opci√≥n est√°ndar es agregar el campo isDeleted a la base de datos y establecerlo en verdadero si se elimina el registro. <br>  Alternativamente, cada vez que elimine una entrada de la base de datos, puede enviar una solicitud de eliminaci√≥n de la b√∫squeda a la API de Azure Search.  En este caso, se puede omitir la casilla de verificaci√≥n Eliminaciones de Trak.  Pero realmente no me gusta esta opci√≥n, porque si la solicitud de eliminaci√≥n no funciona, el registro permanecer√° en el √≠ndice.  En cuanto a m√≠, no hay suficientes oportunidades para reconstruir el √≠ndice una vez en un cierto per√≠odo de tiempo por completo. </p><br><p>  A pesar de todas las ventajas del portal, despu√©s de crearlo puede agregar algunos campos nuevos al √≠ndice, pero no puede cambiar los existentes.  ¬øQu√© hacer si necesitas cambiar algo?  Puedes recrear el √≠ndice.  Elimine el existente y cree uno nuevo que contenga los cambios necesarios.  Usar el portal para hacer esto es una tarea bastante triste.  Yo uso la API para estos fines.  Usando una aplicaci√≥n como Postman, puede obtener el √≠ndice JSON y usarlo para escribir una solicitud de creaci√≥n de √≠ndice.  Solo es necesario realizar peque√±os cambios (por ejemplo, elimine los campos del sistema "@ odata.context" y "@ odata.etag"). </p><br><p>  Para trabajar con la API, debe tomar la clave del portal, que debe agregarse al encabezado de cada solicitud de API.  La clave se toma aqu√≠: </p><br><p><img src="https://habrastorage.org/webt/gb/4q/do/gb4qdotcdf2hz3d_busivo1tal4.png"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Una consulta para obtener datos de √≠ndice</a> es: </p><br><pre><code class="plaintext hljs">GET https://[service name].search.windows.net/indexes/[index name]?api-version=[api-version]</code> </pre> <br><p>  <code>api-key: [admin key]</code> debe agregarse al encabezado <code>api-key: [admin key]</code> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Es</a> posible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">crear un √≠ndice</a> utilizando una de las siguientes dos consultas: </p><br><pre> <code class="plaintext hljs">POST https://[servicename].search.windows.net/indexes?api-version=[api-version] Content-Type: application/json api-key: [admin key]</code> </pre> <br><p>  o </p><br><pre> <code class="plaintext hljs">PUT https://[servicename].search.windows.net/indexes/[index name]?api-version=[api-version]</code> </pre> <br><p>  En cuerpo, debe especificar JSON con el contenido del √≠ndice.  La √∫ltima versi√≥n en este momento es 2019-05-06, y antes de que se usara durante mucho tiempo 2017-11-11 </p><br><p>  Trabajando a trav√©s de la API, puede usar algunas funciones de b√∫squeda que no est√°n disponibles en el portal. </p><br><p>  Para dar prioridad a algunos campos en la b√∫squeda, puede usar <strong>perfiles de puntuaci√≥n</strong> . </p><br><p>  El siguiente JSON agregado a la solicitud le da al campo "t√≠tulo" una doble ventaja sobre el campo "informaci√≥n": </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"scoringProfiles"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"profileForTitle"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"document"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"weights"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, ‚Äúinfo<span class="hljs-attr"><span class="hljs-attr">": 1 } } ]</span></span></code> </pre> <br><p>  Adem√°s de la capacidad de dar prioridad a algunos campos usando pesos, es posible usar algunas funciones predefinidas: frescura, magnitud, distancia y etiqueta. </p><br><p>  <strong>La frescura se</strong> usa solo con los campos de fecha y hora y le permite mostrar los √∫ltimos registros en la b√∫squeda.  <strong>La magnitud se</strong> usa con los campos int y double.  Bueno, y en consecuencia, esta funci√≥n es buena para usar con campos que almacenan precios, la cantidad de descargas y otra informaci√≥n num√©rica.  <strong>La distancia se</strong> usa solo con campos como Edm.GeographyPoint y se eleva en una b√∫squeda por distancia desde una ubicaci√≥n espec√≠fica.  Si la <strong>etiqueta</strong> se especifica como el tipo de funci√≥n, los documentos que contienen etiquetas que aparecen en la cadena de b√∫squeda aparecer√°n en la b√∫squeda. </p><br><p>  Una de las opciones m√°s populares es recoger los √∫ltimos documentos en una b√∫squeda como esta: </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"scoringProfiles"</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"newDocs"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"functions"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"freshness"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fieldName"</span></span>: <span class="hljs-string"><span class="hljs-string">"documentDate"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"boost"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">"interpolation"</span></span>: <span class="hljs-string"><span class="hljs-string">"quadratic"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"freshness"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"boostingDuration"</span></span>: <span class="hljs-string"><span class="hljs-string">"P7D"</span></span> } } ] } ]</code> </pre> <br><p>  Se mostrar√°n los documentos cuyo campo documentDate contiene la fecha de los √∫ltimos siete d√≠as ("P7D"). </p><br><p>  Despu√©s de haber creado un perfil de puntuaci√≥n, puede especificar su nombre en las solicitudes.  Solo en este caso se generar√°n los campos necesarios en la b√∫squeda. </p><br><p>  Lea m√°s en la documentaci√≥n oficial: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Agregue perfiles de puntuaci√≥n a un √≠ndice de Azure Search</a> </p><br><h3 id="data-change-detection-policy">  Pol√≠tica de detecci√≥n de cambio de datos </h3><br><p>  La API proporciona un poco m√°s de funciones para la fuente de datos.  Como puede leer arriba, al crear un origen de datos, puede especificar un campo para determinar si los datos han cambiado.  En forma de JSON, se ve as√≠: </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"dataChangeDetectionPolicy"</span></span> : { <span class="hljs-attr"><span class="hljs-attr">"@odata.type"</span></span> : <span class="hljs-string"><span class="hljs-string">"#Microsoft.Azure.Search.HighWaterMarkChangeDetectionPolicy"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"highWaterMarkColumnName"</span></span> : <span class="hljs-string"><span class="hljs-string">"[a rowversion or last_updated column name]"</span></span> }        soft delete     policy: <span class="hljs-string"><span class="hljs-string">"dataDeletionDetectionPolicy"</span></span> : { <span class="hljs-attr"><span class="hljs-attr">"@odata.type"</span></span> : <span class="hljs-string"><span class="hljs-string">"#Microsoft.Azure.Search.SoftDeleteColumnDeletionDetectionPolicy"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"softDeleteColumnName"</span></span> : <span class="hljs-string"><span class="hljs-string">"IsDeleted"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"softDeleteMarkerValue"</span></span> : <span class="hljs-string"><span class="hljs-string">"true"</span></span> }</code> </pre> <br><p>  Si utiliza SQL Server y su base de datos admite el seguimiento de cambios, los registros eliminados se pueden eliminar del √≠ndice autom√°ticamente.  No es necesario especificar highWaterMarkColumnName en este caso.  Es suficiente especificar SqlIntegratedChangeTrackingPolicy en lugar de HighWaterMarkChangeDetectionPolicy </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"dataChangeDetectionPolicy"</span></span> : { <span class="hljs-attr"><span class="hljs-attr">"@odata.type"</span></span> : <span class="hljs-string"><span class="hljs-string">"#Microsoft.Azure.Search.SqlIntegratedChangeTrackingPolicy"</span></span> }</code> </pre> <br><p>  Es muy conveniente.  Pero hay matices que no permiten disfrutar esta caracter√≠stica por completo. </p><br><p>  Primero, SqlIntegratedChangeTrackingPolicy no se puede usar con vistas.  En segundo lugar, la tabla no debe tener claves primarias compuestas.  No hace falta decir que la versi√≥n de SQL Server debe ser m√°s o menos nueva.  Y finalmente, el seguimiento de cambios debe estar habilitado para la base de datos y las tablas utilizadas por la b√∫squeda.  Para la base de datos, se activa as√≠: </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DATABASE</span></span> AdventureWorks2012 <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> CHANGE_TRACKING = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (CHANGE_RETENTION = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DAYS</span></span>, AUTO_CLEANUP = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>)</code> </pre> <br><p>  Y para la mesa como esta: </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> Person.Contact <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span> CHANGE_TRACKING <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (TRACK_COLUMNS_UPDATED = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>)</code> </pre> <br><p>  Pero eso no es todo.  Se recomienda encarecidamente que habilite el aislamiento de instant√°neas para la base. </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DATABASE</span></span> AdventureWorks2012 <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> ALLOW_SNAPSHOT_ISOLATION <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>;</code> </pre> <br><p>  Adem√°s de bailar con una pandereta cuando instalo Change Tra√ßking para la base de datos, la desventaja es la incapacidad de usar vistas.  Por lo tanto, todav√≠a tengo que usar HighWaterMarkChangeDetectionPolicy </p><br><h3 id="poisk-po-dannym">  B√∫squeda de datos </h3><br><p>  De forma predeterminada, la b√∫squeda de Azure usa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">una sintaxis de consulta simple</a> .  Puede que no parezca sorprendente, pero es bastante simple: </p><br><p>  <strong>wifi + lujo</strong> busca las palabras wifi y lujo al mismo tiempo <br>  <strong>"hotel de lujo" est√°</strong> buscando la frase <br>  <strong>wifi |</strong>  <strong>lujo</strong> busca la palabra wifi o la palabra lujo <br>  <strong>wifi ‚Äìluxury</strong> busca textos con la palabra wifi pero sin la palabra lujo <br>  <strong>lux</strong> busca palabras que empiecen con lux </p><br><p>  Es posible combinar reglas de b√∫squeda usando par√©ntesis.  Por ejemplo, la regla <strong>motel + (wifi | lujo)</strong> busca la palabra motel y la palabra wifi o la palabra lujo </p><br><p>  Es bueno que Azure Search pueda usar la sintaxis de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lucene</a> .  Para usarlo, es necesario agregar <strong>queryType = full a la consulta de</strong> b√∫squeda </p><br><p>  La diferencia entre la sintaxis cl√°sica de Azure y Lucene es solo en ausencia de rango. </p><br><p>  Por lo tanto, en Azure Search no puede: <code>mod_date:[20020101 TO 20030101]</code> </p><br><p>  Pero en Azure Search, puede usar $ filter con sintaxis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ODATA</a> .  Aqu√≠ hay un filtro de ejemplo: </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Scott"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"filter"</span></span>: <span class="hljs-string"><span class="hljs-string">"(age ge 25 and and lt 50) or surname eq 'Guthrie'"</span></span> }</code> </pre> <br><p>  Los filtros tambi√©n se pueden usar con sintaxis de consulta simple. </p><br><p>  En Lucene, la l√≥gica "o" se implementa utilizando <strong>OR</strong> o <strong>||</strong> <br>  Ambos valores se pueden encontrar especificando la declaraci√≥n "y" con: <strong>AND</strong> , <strong>&amp;&amp;</strong> o <strong>+</strong> <br>  Para "no" puede utilizar uno de los siguientes: ¬° <strong>NO!</strong>  o <strong>-</strong> </p><br><p>  La instrucci√≥n "no" tiene una caracter√≠stica com√∫n tanto para la sintaxis simple como para Lucene.  Su comportamiento depende del modo de b√∫squeda, que se puede establecer tanto en <strong>searchMode = all</strong> como en <strong>searchMode = any</strong> (este valor se usa de manera predeterminada).  En cualquier modo, al buscar wifi -luxury encontrar√° documentos con la palabra wifi o documentos sin la palabra lujo.  En el modo todo, por la misma solicitud, encontrar√° muelles con la palabra wifi y simult√°neamente sin la palabra lujo. </p><br><p>  Veamos algunas caracter√≠sticas interesantes de Lucene. </p><br><p>  <strong>La b√∫squeda difusa le</strong> permite buscar palabras que difieren de la b√∫squeda en una o m√°s letras.  Es decir, ayuda a lidiar con los errores tipogr√°ficos.  Por ejemplo, una b√∫squeda de "azul ~" o "azul ~ 1" le devolver√° "azul" y "azul" e incluso "pegamento".  Pero al mismo tiempo, una b√∫squeda de "analista comercial ~" significar√° comercial o analista <br>  <strong>La proximidad le</strong> permite buscar palabras cercanas.  Por ejemplo, "hotel aeropuerto" ~ 5 encontrar√° las palabras "hotel" y "aeropuerto" que se encuentran en el texto a no m√°s de 5 palabras entre s√≠. <br>  <strong>El refuerzo de t√©rminos le</strong> permite establecer la prioridad de una palabra en la b√∫squeda.  Ejemplo: "rock ^ 2 electronic" busca las palabras rock y electronic, pero las entradas con la palabra rock en la b√∫squeda se mostrar√°n arriba. <br>  <strong>Expresiones regulares</strong> : uso de expresiones regulares.  Todo aqu√≠ est√° de acuerdo con la documentaci√≥n oficial de expresiones regulares de Lucene.  Puedes encontrarla <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el siguiente enlace</a> .  Al buscar, las expresiones regulares deben colocarse entre barras diagonales "/".  Por ejemplo, as√≠: / [mh] otel / </p><br><p>  Si su cadena de b√∫squeda contiene caracteres especiales, se deben escapar con una barra diagonal inversa.  Caracteres de ejemplo para escapar: <strong>+ - &amp;&amp; ||!</strong>  <strong>() {} [] ^ "~ * ?: \ /</strong> <br>  La b√∫squeda se puede hacer usando una solicitud GET.  El ejemplo oficial es este: </p><br><pre> <code class="plaintext hljs">GET /indexes/hotels/docs?search=category:budget AND \"recently renovated\"^3&amp;searchMode=all&amp;api-version=2019-05-06&amp;querytype=full</code> </pre> <br><p>  Pero puede usar una solicitud POST con body.  De nuevo, un ejemplo oficial: </p><br><pre> <code class="plaintext hljs">POST /indexes/hotels/docs/search?api-version=2019-05-06 { "search": "category:budget AND \"recently renovated\"^3", "queryType": "full", "searchMode": "all" }</code> </pre> <br><p>  Si est√° utilizando una solicitud GET o POST con el tipo de datos application / x-www-form-urlencoded, entonces necesita codificar caracteres inseguros y reservados. </p><br><p>  Los s√≠mbolos  <strong>/?: @ = &amp;</strong> est√°n reservados <br>  Los caracteres <strong>`` &lt;&gt; #% {} | \ ^ ~ []</strong> no son seguros. <br>  Por ejemplo, el s√≠mbolo # se convertir√° en% 23 y el s√≠mbolo?  se convierte en% 3F </p><br><h3 id="para-ssylok-dlya-razrabotchikov">  Un par de enlaces para desarrolladores. </h3><br><p>  Si .NET es desarrollador, puede utilizar el paquete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Microsoft.Azure.Search</a> NuGet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">.</a> Adem√°s, hay ejemplos en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">NodeJS</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Java</a> . </p><br><p>  Puede encontrar un ejemplo de una aplicaci√≥n simple en .NET Core aqu√≠. Ejemplo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">b√∫squeda de ASP.NET Core Azure</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/454820/">https://habr.com/ru/post/454820/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454806/index.html">Entrenamiento Cisco 200-125 CCNA v3.0. D√≠a 9. El mundo f√≠sico de los interruptores. Parte 1</a></li>
<li><a href="../454808/index.html">Sobre naves espaciales y espacio. C√≥mo hacer una funci√≥n cambiando todo el producto en el camino</a></li>
<li><a href="../454810/index.html">Aire fresco en Marte: doble una mol√©cula de CO2 y obtenga ox√≠geno</a></li>
<li><a href="../454816/index.html">Configuraci√≥n del paquete php-fpm + nginx en WSL</a></li>
<li><a href="../454818/index.html">Rekko Challenge: c√≥mo ocupar el segundo lugar en la competencia para la creaci√≥n de sistemas de recomendaci√≥n</a></li>
<li><a href="../454824/index.html">El amplificador operacional m√°s simple en elementos discretos</a></li>
<li><a href="../454826/index.html">Reduzca las copias de seguridad en un 99.5% con hashget</a></li>
<li><a href="../454828/index.html">Crear una imagen de mosaico</a></li>
<li><a href="../454830/index.html">3 cualidades clave para un gerente de producto exitoso: Alexander Belyaev</a></li>
<li><a href="../454832/index.html">¬øPor qu√© una semana laboral de cuatro d√≠as es una mala historia?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>