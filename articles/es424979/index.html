<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèúÔ∏è üï¥üèø üìº Olmo C√≥modo e inc√≥modo. Http, Tarea üôéüèæ üíáüèæ üì∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Seguimos hablando de Elm 0.18 . 


 Olmo C√≥modo e inc√≥modo 
 Olmo C√≥modo e inc√≥modo. Composici√≥n 
 Olmo C√≥modo e inc√≥modo. Json.Encoder y Json.Decoder...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Olmo C√≥modo e inc√≥modo. Http, Tarea</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424979/"><p>  Seguimos hablando de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Elm 0.18</a> . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Olmo</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥modo e inc√≥modo</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Olmo</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥modo e inc√≥modo.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Composici√≥n</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Olmo</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥modo e inc√≥modo.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Json.Encoder y Json.Decoder</a> </p><br><p>  En este art√≠culo, consideramos cuestiones de interacci√≥n con el lado del servidor. </p><a name="habracut"></a><br><h2 id="vypolnenie-zaprosov">  Ejecuci√≥n de la consulta </h2><br><p>  Se pueden encontrar ejemplos de consultas simples en la descripci√≥n del paquete <a href="https://package.elm-lang.org/packages/elm-lang/">Http</a> . </p><br><p>  El tipo de solicitud es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http</a> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://package.elm-lang.org/packages/elm-lang/">Solicite a</a> . <br>  El tipo de resultado de la consulta es Result <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Error</a> a. <br>  Ambos tipos est√°n parametrizados por el tipo de usuario, cuyo decodificador debe especificarse al generar la solicitud. </p><br><p>  Puede ejecutar la solicitud utilizando las funciones: </p><br><ol><li>  Http.send; </li><li>  Http.toTask. </li></ol><br><p>  Http.send le permite ejecutar la solicitud y, una vez finalizada, pasa el mensaje a la funci√≥n de actualizaci√≥n especificada en el primer argumento.  El mensaje lleva datos sobre el resultado de la solicitud. </p><br><p>  Http.toTask le permite crear una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tarea a</a> partir de una solicitud que puede ejecutar.  Usar la funci√≥n Http.toTask, en mi opini√≥n, es lo m√°s conveniente, ya que las instancias de Tarea se pueden combinar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">usando varias funciones</a> , por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Task.map2</a> . </p><br><p>  Veamos un ejemplo.  Por ejemplo, para guardar los datos del usuario, se deben ejecutar dos consultas dependientes consecutivas.  Deje que cree una publicaci√≥n del usuario y le guarde fotos (se usa algo de CDN). </p><br><p>  Primero, considere la implementaci√≥n para el caso Http.Send.  Para esto necesitamos dos funciones: </p><br><pre><code class="hljs vbscript">save : UserData -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Request</span></span> Http.<span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> UserData save userData = Http.post ‚Äú/some/url‚Äù (Http.jsonBody (encodeUserData userData)) decodeUserData saveImages : <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> -&gt; Images -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Request</span></span> Http.<span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> CDNData saveImages id images = Http.post (‚Äú/some/cdn/<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>/‚Äù ++ (toString id)) (imagesBody images) decodedCDNData</code> </pre> <br><p>  Los tipos UserData y CDNData no se describir√°n; por ejemplo, no son importantes.  La funci√≥n encodeUserData es un codificador.  saveImages acepta un identificador de datos de usuario, que se utiliza para formar la direcci√≥n, y una lista de fotos.  La funci√≥n imagesBody forma un cuerpo de solicitud del tipo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://package.elm-lang.org/packages/elm-lang/">multipart / form-data</a> .  Las funciones decodeUserData y decodedCDNData decodifican la respuesta del servidor para los datos del usuario y el resultado de la solicitud CDN, respectivamente. </p><br><p>  A continuaci√≥n, necesitamos dos mensajes, los resultados de la consulta: </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UserData</span></span></span><span class="hljs-class">) | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ImagesSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CDNData</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>  Supongamos que, en alg√∫n lugar de la implementaci√≥n de la funci√≥n de actualizaci√≥n, hay una secci√≥n de c√≥digo que almacena datos.  Por ejemplo, podr√≠a verse as√≠: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> : Msg -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Model</span></span> -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">Model</span></span>, Cmd Msg) <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> msg <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Msg <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ClickedSomething -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">model</span></span>, Http.send DataSaved (<span class="hljs-keyword"><span class="hljs-keyword">save</span></span> model.userData))</code> </pre> <br><p>  En este caso, se crea una consulta y se marca con un mensaje DataSaved.  Adem√°s, se recibe este mensaje: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> : Msg -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Model</span></span> -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">Model</span></span>, Cmd Msg) <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> msg <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Msg <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> DataSaved (Ok userData) -&gt; ( {<span class="hljs-keyword"><span class="hljs-keyword">model</span></span> | userData = userData}, Http.send ImagesSaved (saveImages userData.id model.images)) DataSaved (Err reason) -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">model</span></span>, Cmd.None)</code> </pre> <br><p>  En caso de guardar con √©xito, actualizamos los datos en el modelo y llamamos a la solicitud para guardar las fotos donde transferimos el identificador de datos de usuario recibido.  Procesar el mensaje ImagesSaved ser√° similar a DataSaved, ser√° necesario manejar casos exitosos y fallidos. </p><br><p>  Ahora considere la opci√≥n de usar la funci√≥n Http.toTask.  Usando las funciones descritas, definimos una nueva funci√≥n: </p><br><pre> <code class="hljs erlang-repl">saveAll : UserData -&gt; Images -&gt; Task Http.Error (UserData, CDNData) saveAll : userData images = save model.userData |&gt; Http.toTask |&gt; Task.andThen (\newUserData -&gt; saveImages usersData.id images |&gt; Http.toTask |&gt; Task.map (\newImages -&gt; (userData, newImages) } )</code> </pre> <br><p>  Ahora, utilizando la capacidad de combinar tareas, podemos obtener todos los datos en un solo mensaje: </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Saved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UserData</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CDNData</span></span></span><span class="hljs-class">)) update : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Model</span></span></span><span class="hljs-class"> -&gt; (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class">) update msg model case </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> of </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ClickedSomething</span></span></span><span class="hljs-class"> -&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attempt</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Saved</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">saveAll</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">)) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ok</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">)) -&gt; ( {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class"> | </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">}, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">none</span></span></span><span class="hljs-class">) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Err</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reason</span></span></span><span class="hljs-class">) -&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">None</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>  Para ejecutar solicitudes, utilizamos la funci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Task.attempt</a> , que le permite completar la tarea.  No debe confundirse con la funci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Task.perform</a> .  Task.perform: le permite completar tareas que <strong>no pueden fallar</strong> .  Task.attempt: realiza tareas que <strong>pueden fallar</strong> . </p><br><p>  Este enfoque es m√°s compacto en t√©rminos de la cantidad de mensajes, la complejidad de la funci√≥n de actualizaci√≥n y le permite mantener la l√≥gica m√°s local. </p><br><p>  En mis proyectos, aplicaciones y componentes, a menudo creo el m√≥dulo Commands.elm, en el que describo las funciones de interactuar con la parte del servidor con el tipo ... -&gt; Task Http.Error a. </p><br><h2 id="sostoyanie-vypolneniya-zaprosov">  Solicitar estado de ejecuci√≥n </h2><br><p>  En el proceso de ejecuci√≥n de consultas, la interfaz a menudo tiene que bloquearse total o parcialmente, y tambi√©n informar errores en la ejecuci√≥n de consultas, si corresponde.  En general, el estado de una solicitud se puede describir como: </p><br><ol><li>  la solicitud no ha sido completada; </li><li>  la solicitud est√° en curso; </li><li>  La solicitud se complet√≥ con √©xito. </li><li>  solicitud fallida </li></ol><br><p>  Para tal descripci√≥n, hay un paquete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RemoteData</a> .  Al principio, lo us√© activamente, pero con el tiempo, la presencia de un tipo adicional de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WebData se</a> volvi√≥ redundante, y trabajar con √©l fue tedioso.  En lugar de este paquete, aparecieron las siguientes reglas: </p><br><ol><li>  declarar todos los datos del servidor como tal vez.  En este caso, Nothing indica la ausencia de datos; </li><li>  declare un atributo de carga de tipo Int en la aplicaci√≥n o modelo de componente.  El par√°metro almacena el n√∫mero de solicitudes ejecutadas.  El √∫nico inconveniente de este enfoque es la necesidad de incrementar y disminuir el atributo al comienzo de la solicitud y al finalizar, respectivamente; </li><li>  declarar un atributo de error de tipo Cadena de lista en la aplicaci√≥n o modelo de componente.  Este atributo se usa para almacenar datos de error. </li></ol><br><p>  El esquema descrito no es mucho mejor que la opci√≥n con el paquete RemoteData, como muestra la pr√°ctica.  Si alguien tiene otras opciones, comparta en los comentarios. </p><br><p>  El estado de ejecuci√≥n de la solicitud debe incluir el progreso de descarga del paquete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Progress</a> . </p><br><h2 id="posledovatelnost-zadach">  Secuencia de tareas </h2><br><p>  Considere las opciones para secuencias de tareas que a menudo se encuentran en el desarrollo: </p><br><ol><li>  tareas dependientes secuenciales; </li><li>  tareas independientes consistentes; </li><li>  tareas paralelas independientes. </li></ol><br><p>  Las tareas dependientes sucesivas ya se han considerado anteriormente; dar√© una descripci√≥n general y enfoques de implementaci√≥n en esta secci√≥n. </p><br><p>  La secuencia de tareas se interrumpe en el primer fallo y se devuelve un error.  Si tiene √©xito, se devuelve una combinaci√≥n de resultados: </p><br><pre> <code class="hljs erlang-repl">someTaskA |&gt; Task.andThen (\resultA -&gt; someTaskB |&gt; Task.map (\resultB -&gt; (resultA, resultB) ) )</code> </pre> <br><p>  Este c√≥digo crea una tarea de tipo Error de tarea (a, b), que se puede realizar m√°s tarde. </p><br><p>  La funci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Task.andThen le</a> permite transferir una nueva tarea para su ejecuci√≥n si la anterior se completa con √©xito.  La funci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Task.map le</a> permite convertir resultados de mel√≥n de ejecuci√≥n en caso de √©xito. </p><br><p>  Hay opciones cuando la finalizaci√≥n exitosa de la tarea no ser√° suficiente y necesita verificar la consistencia de los datos.  Suponga que las ID de usuario coinciden: </p><br><pre> <code class="hljs pgsql">someTaskA |&gt; Task.andThen (\resultA -&gt; someTaskB |&gt; Task.andThen (\resultB -&gt; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> resultA.userId == resultB.userId <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> -&gt; Task.succeed (resultA, resultB) <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> -&gt; Task.fail ‚Äú<span class="hljs-keyword"><span class="hljs-keyword">User</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> the same‚Äù ) )</code> </pre> <br><p>  Vale la pena se√±alar que en lugar de la funci√≥n Task.map, se utiliza la funci√≥n Task.andThen y el √©xito de la segunda tarea se determina de forma independiente utilizando las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">funciones</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Task.succeed</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Task.fail</a> . </p><br><p>  Si una de las tareas puede fallar y esto es aceptable, debe usar la funci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Task.onError</a> para indicar el valor en caso de error: </p><br><pre> <code class="hljs julia">someTaskA |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.onError (\msg -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>,succeed defaultValue) |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.andThen (\resultA -&gt; someTaskB |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.map (\resultB -&gt; (resultA, resultB) ) )</code> </pre> <br><p>  La llamada a la funci√≥n Task.onError debe declararse inmediatamente despu√©s de declarar la tarea. </p><br><p>  Se pueden realizar consultas independientes sucesivas utilizando las funciones Task.mapN.  Lo que le permite combinar varios resultados de tareas en uno.  La primera tarea ca√≠da interrumpe la ejecuci√≥n de toda la cadena, as√≠ que use la funci√≥n Task.onError para los valores predeterminados.  Consulte tambi√©n la funci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Task.sequence</a> , que le permite realizar una serie de tareas similares. </p><br><p>  No se describen tareas paralelas en la implementaci√≥n del lenguaje actual.  Su implementaci√≥n es posible a nivel de aplicaci√≥n o componente a trav√©s del procesamiento de eventos en la funci√≥n de actualizaci√≥n.  Toda la l√≥gica permanece sobre los hombros del desarrollador. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es424979/">https://habr.com/ru/post/es424979/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es424969/index.html">Gu√≠a de Node.js, Parte 9: Trabajar con el sistema de archivos</a></li>
<li><a href="../es424971/index.html">Habrokast "Puesta de sol manual" # 1. Tratando de configurar un entorno para desarrollar un juguete para Windows</a></li>
<li><a href="../es424973/index.html">Detecci√≥n de rostros en video: Raspberry Pi y Neural Compute Stick</a></li>
<li><a href="../es424975/index.html">Profundidades SIEM: correlaciones listas para usar. Parte 2. Esquema de datos como reflejo del modelo del "mundo"</a></li>
<li><a href="../es424977/index.html">Aprender de los errores: optimizar aplicaciones en App Store y Google Play</a></li>
<li><a href="../es424981/index.html">Easter Egg Text RPG en el c√≥digo del motor de b√∫squeda de Google</a></li>
<li><a href="../es424985/index.html">En un importante precedente judicial, las agencias de inteligencia de EE. UU. No pudieron interceptar llamadas telef√≥nicas en el mensajero</a></li>
<li><a href="../es424987/index.html">Recupere im√°genes borrosas y desenfocadas utilizando el filtro Wiener. Implementaci√≥n en C ++ OpenCV</a></li>
<li><a href="../es424989/index.html">Proceso de dise√±o: 7 pasos para el proyecto perfecto</a></li>
<li><a href="../es424991/index.html">Cuando los viejos m√©todos no funcionan: Vasily Mazin - en un enfoque h√≠brido para el desarrollo de IA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>