<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßùüèø ‚õ±Ô∏è üë®‚Äç‚öñÔ∏è QlikView. Pemformatan bersyarat "Suka di Excel" üéΩ üåø üìï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tugasnya adalah membuat pemformatan bersyarat dari tabel "seperti di Excel." QlikView cukup mampu mengatasi tugas-tugas standar pewarnaan berdasarkan ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>QlikView. Pemformatan bersyarat "Suka di Excel"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446076/">  Tugasnya adalah membuat pemformatan bersyarat dari tabel "seperti di Excel."  QlikView cukup mampu mengatasi tugas-tugas standar pewarnaan berdasarkan kondisi, tetapi dengan pilihan parameter secara dinamis, dan bahkan seperti di Excel, muncul pertanyaan: ‚Äúapakah memang seperti itu sama sekali ..?‚Äù. <br>  Intinya: ada beberapa opsi implementasi, beberapa versi, banyak waktu dihabiskan untuk pengujian dan debugging.  Refactoring dari implementasi selesai dilakukan.  Saya menyajikan versi final, memuaskan kebutuhan pelanggan, diuji dan diverifikasi. <br><br><h4>  Tugas fungsional (pernyataan) </h4><br>  Ada tabel di mana dimensi dan ekspresi dipilih secara dinamis, rumus untuk menghitung nilai-nilai itu sendiri sederhana: jumlah, rata-rata, persentase relatif, nilai absolut, dan sejenisnya. <br><br>  Diperlukan untuk memungkinkan pengguna untuk mewarnai tabel tergantung pada parameter yang dipilih.  Pendahuluan utama - satu kolom harus dapat dicat dengan warna berbeda, yaitu multi-warna, sesuai dengan parameter yang berbeda.  Kunci kedua harus kemampuan untuk mewarnai bidang tergantung pada "parameter yang saling berhubungan" lainnya, misalnya, kita mewarnai "jumlah pembelian" tergantung pada nilai "harga rata-rata produk di pasar". <br>  Berikut ini adalah bagian utama dari implementasi.  Saya tidak akan memikirkan hal-hal seperti sembunyikan / tutup menu, membuat daftar, dan sejenisnya.  Jika Anda memiliki pertanyaan tentang detailnya, saya akan memberi tahu tambahan. <br><br>  <b>Hasil akhir, jalan setapak yang sulit:</b> <br><br><img src="https://habrastorage.org/webt/vn/el/2p/vnel2p-q3tehw8sbujckvxzvacy.png"><br><a name="habracut"></a><br><h4>  Blok 1. Persiapan data untuk menu fungsi </h4><br><div class="spoiler">  <b class="spoiler_title">Kode menyiapkan fondasi untuk daftar menu yang dijelaskan dalam blok No. 3</b> <div class="spoiler_text"><pre><code class="plaintext hljs">tColorsFormatListSelection: LOAD * INLINE [%ColorDisplayNameFormat      n   n%  n   n%     ]; tFilterTypeListSelection: LOAD * INLINE [%FilterDisplayNameType    ]; tColorsTableList: LOAD*INLINE [%ColorDisplayName|%ColorRGBValue|%SortColorList -| RGB(192,0,0)|1 | RGB(255,0,0)|2 | RGB(255,192,0)|3 | RGB(255,255,0)|4 -| RGB(146,208,80)|5 | RGB(0,176,80)|6 -| RGB(0,176,240)|7 | RGB(0,112,192)|8 -| RGB(0,32,96)|9 | RGB(112,48,160)|10 ](delimiter is '|'); tColorFieldsListSelectionRelation: Load [ Qlik] AS %ColorFieldName, [/] AS %ExpressionType D:\QLIK\Data\Mapped_fields.xlsx (ooxml, embedded labels, table is [MetaField]) WHERE Match([/],'',''); tColorFieldsListSelectionClause: Load [ Qlik] AS %ColorFieldNameClause, [/] AS %ExpressionTypeClause FROM D:\QLIK\Data\Mapped_fields.xlsx (ooxml, embedded labels, table is [MetaField]) WHERE Match([/],'');</code> </pre> <br></div></div><br>  Saya juga perlu membuat beberapa lusin variabel: <br><br><img src="https://habrastorage.org/webt/tl/rs/ym/tlrsym9idf0sqsncklwtuo6jyyy.png"><br><br>  <i>vColorFormatString</i> - string yang dikumpulkan <br><br>  <i>vColorFormatString1 ... 10</i> - dirancang untuk mengurai serangkaian vColorFormatString menjadi 10 parameter <b>untuk nilai absolut</b> , saya membuat batasan ini dengan sengaja, pendapat saya adalah bahwa itu tidak lagi diperlukan, secara umum pembatasan ini murni ideologis dan Anda dapat meningkatkan jumlah parameter dengan menghabiskan sedikit waktu. <br><br>  <i>vColorFormatStringPerc1 ... 10</i> - dirancang untuk mengurai string dari vColorFormatString menjadi 10 parameter <b>untuk nilai relatif (persen)</b> <br><br>  <i>vColorFormat1 ... 10</i> - warna <br><br><h4>  Blok 2. Pengembangan menu fungsional1 </h4><br><img src="https://habrastorage.org/webt/gu/t6/zp/gut6zpyf9ffnlb-jeb7k4tghxvo.png"><br><br>  Janji temu: <br><br><ol><li>  Menampilkan daftar parameter yang dibuat oleh pengguna saat ini. </li><li>  Kemampuan untuk menghapus opsi pemformatan bersyarat apa pun </li><li>  Meminta menu untuk memilih opsi pemformatan bersyarat. </li></ol><br>  Mari kita bahas dua elemen di bawah ini. <br><br>  Yang pertama adalah tampilan parameter yang saat ini dibuat. <br><br>  Area ini adalah objek teks yang menampilkan parameter yang dibuat saat ini berdasarkan parsing string.  Dan sekarang batu bata pertama dari seluruh aksi ini: <br><br><div class="spoiler">  <b class="spoiler_title">Formula tampilan teks</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">= SubField(TextBetween(vColorFormatString,'||','||',1),'|',1) &amp; '' &amp; If(SubField(TextBetween(vColorFormatString,'||','||',1),'|',1) = SubField(TextBetween(vColorFormatString,'||','||',1),'|',2),'', SubField(TextBetween(vColorFormatString,'||','||',1),'|',2)) &amp; ' ('&amp; SubField(TextBetween(vColorFormatString,'||','||',1),'|',4) &amp; ' '&amp; If( Index(SubField(TextBetween(vColorFormatString,'||','||',1),'|',2),'%')&gt;0 OR Index(SubField(TextBetween(vColorFormatString,'||','||',1),'|',4),'%')&gt;0, If(WildMatch( SubField(TextBetween(vColorFormatString,'||','||',1),'|',4),'**'),'', num($(=SubField(TextBetween(vColorFormatString,'||','||',1),'|',5)),'# ##0,00')) &amp; ' % '&amp; If(WildMatch( SubField(TextBetween(vColorFormatString,'||','||',1),'|',6),'*Empty*'),'', num($(=SubField(TextBetween(vColorFormatString,'||','||',1),'|',6)),'# ##0,00')&amp;' %') , If(WildMatch( SubField(TextBetween(vColorFormatString,'||','||',1),'|',4),'**'),'', num($(=SubField(TextBetween(vColorFormatString,'||','||',1),'|',5)),'# ##0.0')) &amp; ' '&amp; If(WildMatch( SubField(TextBetween(vColorFormatString,'||','||',1),'|',6),'*Empty*'),SubField(%EdName,',',1), num($(=SubField(TextBetween(vColorFormatString,'||','||',1),'|',6)),'# ##0.0')&amp; ' ' &amp;SubField(%EdName,',',1) ) )&amp; ')'</code> </pre> <br></div></div><br>  Beberapa horor, bukan? :) <br><br>  Sekarang saya pikir itu menjadi jelas bagi banyak orang bahwa semua logika diimplementasikan pada baris teks.  Mengumpulkan garis - mengurutkan garis! <br><br>  Perakitan string memiliki bentuk <br><br>  <i>|| RWA% | RWA% | RGB (255,0,0) | Di atas rata-rata | num (vColorFormatValue1 / 100, '# ## 0,00') | Kosong</i> <i><br></i>  <i>|| CODE% | CODE% | RGB (255,0,0) | Di bawah rata-rata | num (vColorFormatValue1 / 100, '# ## 0,00') | Kosong</i> <i><br></i>  <i>|| GCD% | GCD% | RGB (255.0.0) | Di bawah rata-rata | num (vColorFormatValue1 / 100, '# ## 0,00') | Kosong</i> <i><br></i>  <i>|| RORWA% | RORWA% | RGB (255,0,0) | Di bawah rata-rata | bulat (num (124,63), 0,0001) | Kosong</i> <i><br></i>  <i>|| EL% | EL% | RGB (255.255,0) | Rata-rata di atas | bulat (num (124,62), 0,0001) | Kosong</i> <i><br></i>  <i>|| EL% | EL% | RGB (0,176,80) | Di bawah rata-rata | bulat (num (124,62), 0,0001) | Kosong</i> <i><br></i>  <i>|| OD% | OD% | RGB (0,112,192) | Di bawah rata-rata | bulat (num (124,62), 0,0001) | Kosong</i> <i><br></i>  <i>||</i> <br><br>  Mari kita uraikan kalimatnya <br><br>  ||  <b>WhatColor</b> |  <b>NILAI APA</b> |  <b>Warna</b> |  <b>Ketentuan</b> |  <b>Nilai1</b> |  <b>Nilai2</b> <br><br>  Indeks di bagian SubField (TextBetween (vColorFormatString, '||', '||', 1), '|', 4) - ekspresi setiap parameter disorot oleh '||'  '||', ekspresi properti dipisahkan oleh tunggal '|'  dengan demikian, indeks 1 dan 4 mengatakan untuk mengambil blok parameter pertama dan darinya nilai keempat. <br><br>  Dua nilai (Value1, Value2) untuk parameter "antara". <br><br>  Mari kita melangkah lebih jauh ... <br><br>  Menghapus parameter pada dasarnya adalah "replay" dari nilai dalam string. <br><br><div class="spoiler">  <b class="spoiler_title">Kode untuk menghapus parameter pemformatan bersyarat</b> <div class="spoiler_text"> <code>=Replace(vColorFormatString, '||' &amp; TextBetween(vColorFormatString,'||','||',1),'')</code> <br> </div></div><br><h4>  Blok 3. Pengembangan menu fungsional2 </h4><br><div class="spoiler">  <b class="spoiler_title">Gambar1</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/jx/gt/nu/jxgtnu4mm3vaxctlafmr-ufzqaa.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Gambar2</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/eb/lm/ze/eblmzeohegkowdx4u5wtomvhjx8.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Gambar3</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/zs/ax/-p/zsax-p55hm9lt7zjglxy2-e48te.png"><br></div></div><br>  Menu utama untuk mengumpulkan parameter.  Sekali lagi, saya tidak akan membahas unsur-unsur daftar dan deskripsi dari logika mereka untuk menyembunyikan penutupan. <br><br>  Logika utama untuk baris kami adalah untuk mengumpulkan semua yang diminta pengguna dalam menu ini dijahit ke tombol "siap". <br><br><div class="spoiler">  <b class="spoiler_title">Tindakan "set variable" adalah vColorFormatString, kode:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">=If( SubStringCount(vColorFormatString,'||')&lt;11 AND ( (vColorParamByClause=0 AND ( (Len(GetFieldSelections(%ColorFieldName))&gt;0 AND Len(GetFieldSelections(%ColorFieldNameClause))&gt;0) AND (GetFieldSelections(%ColorFieldName) &lt;&gt; GetFieldSelections(%ColorFieldNameClause)) )) OR (vColorParamByClause=1 AND Len(GetFieldSelections(%ColorFieldNameClause))&gt;0) ), If(vColorParamByClause=0, if(len(vColorFormatString)&lt;1, '||' &amp; Trim(GetFieldSelections(%ColorFieldName,'|',50)) &amp;'|' &amp; Trim(GetFieldSelections(%ColorFieldNameClause,'|',50)) &amp;'|' &amp; $(=only({&lt;%ColorDisplayName={"$(=SubField(concat(%ColorDisplayName,',',%SortColorList),',',1))"}&gt;}%ColorRGBValue)) &amp;'|'&amp; GetFieldSelections(%ColorDisplayNameFormat,'|',1) &amp; '|'&amp; vColorFormatValue1Transform &amp; '|'&amp; If(GetFieldSelections(%ColorDisplayNameFormat,1) ='', vColorFormatValue2Transform,'Empty') &amp; '||', vColorFormatString &amp; Trim(GetFieldSelections(%ColorFieldName,'|',50)) &amp;'|' &amp; Trim(GetFieldSelections(%ColorFieldNameClause,'|',50)) &amp;'|' &amp; $(=only({&lt;%ColorDisplayName={"$(=SubField(concat(%ColorDisplayName,',',%SortColorList),',',1))"}&gt;}%ColorRGBValue)) &amp;'|'&amp; GetFieldSelections(%ColorDisplayNameFormat,'|',1) &amp; '|'&amp; vColorFormatValue1Transform &amp; '|'&amp; If(GetFieldSelections(%ColorDisplayNameFormat,1) ='', vColorFormatValue2Transform,'Empty') &amp;'||' ) , if(len(vColorFormatString)&lt;1, '||' &amp; Trim(GetFieldSelections(%ColorFieldNameClause,'|',50)) &amp;'|' &amp; Trim(GetFieldSelections(%ColorFieldNameClause,'|',50)) &amp;'|' &amp; $(=only({&lt;%ColorDisplayName={"$(=SubField(concat(%ColorDisplayName,',',%SortColorList),',',1))"}&gt;}%ColorRGBValue)) &amp;'|'&amp; GetFieldSelections(%ColorDisplayNameFormat,'|',1) &amp; '|'&amp; vColorFormatValue1Transform &amp; '|'&amp; If(GetFieldSelections(%ColorDisplayNameFormat,1) ='', vColorFormatValue2Transform,'Empty') &amp; '||', vColorFormatString &amp; Trim(GetFieldSelections(%ColorFieldNameClause,'|',50))&amp;'|' &amp; Trim(GetFieldSelections(%ColorFieldNameClause,'|',50)) &amp;'|' &amp; $(=only({&lt;%ColorDisplayName={"$(=SubField(concat(%ColorDisplayName,',',%SortColorList),',',1))"}&gt;}%ColorRGBValue)) &amp;'|'&amp; GetFieldSelections(%ColorDisplayNameFormat,'|',1) &amp; '|'&amp; vColorFormatValue1Transform &amp; '|'&amp; If(GetFieldSelections(%ColorDisplayNameFormat,1) ='', vColorFormatValue2Transform,'Empty') &amp;'||' ) ), vColorFormatString )</code> </pre> <br></div></div><br><h4>  Blok 5. Mengurai teks </h4><br>  Kode untuk variabel adalah vColorFormatString1 ... 10. <br><br>  Poin kunci untuk masing-masing 10 variabel adalah mengubah indeks untuk SubField SubField (TextBetween (vColorFormatString, '||', '||', <b>1</b> ) - vColorFormatString <b>1</b> , indeks 1. <br><br>  Untuk vColorFormatString <b>4</b> - masing-masing <br>  SubField (TextBetween (vColorFormatString, '||', '||', <b>4</b> ) <br><br><div class="spoiler">  <b class="spoiler_title">Kode Variabel Parsing Nilai Mutlak</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">=If(Len(SubField(TextBetween(vColorFormatString,'||','||',4),'|',4))&gt;0, Pick(Match(SubField(TextBetween(vColorFormatString,'||','||',4),'|',4) ,'','','','',' n ',' n%',' n ',' n%',' ',' '), // 'round(sum(['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;'])/$(=%Value),1)' &amp; '&gt;' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',4),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), // 'round(sum(['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;'])/$(=%Value),1)' &amp; '&lt;' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',4),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), // 'round(sum(['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;'])/$(=%Value),1)' &amp; '&gt;' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',4),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)') &amp;' AND '&amp; 'round(sum(['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;'])/$(=%Value),1)' &amp; '&lt;' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',4),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',6)'), // 'round(sum(DISTINCT ['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;'])/$(=%Value),1)' &amp; '=' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',4),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), // n  'num(rank(if(round(sum(['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;'])/$(=%Value),1)&gt;0, sum(['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;']))/$(=%Value),1))' &amp; '&lt;=' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',4),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), // n% '100-((sum(['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;']) / SUM( TOTAL ['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;']))*100) &lt; ' &amp; '100-' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',4),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)') , // n  'num(rank(if(round(sum(['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;'])/$(=%Value),1)&gt;0, -sum(['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;']))/$(=%Value),1))' &amp; '&lt;=' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',4),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), // n% '((sum(['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;']) / SUM( TOTAL ['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;']))*100) &lt; ' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',4),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), //  'sum(DISTINCT ['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;'])&gt;= Median(TOTAL &lt;$(vGroupByList)&gt; ['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;'])', //  'sum(DISTINCT ['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;'])&lt;= Median(TOTAL &lt;$(vGroupByList)&gt; ['&amp; Trim(SubField(TextBetween(vColorFormatString,'||','||',4),'|',2)) &amp;'])' ),'0&gt;1')</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Yang menarik, isinya lebih rumit</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">=If(Len(SubField(TextBetween(vColorFormatString,'||','||',2),'|',4))&gt;0 AND $(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')')&gt;0, Pick(Match(SubField(TextBetween(vColorFormatString,'||','||',2),'|',4) ,'','','','',' n ',' n%',' n ',' n%',' ',' '), // Pick($(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')'), '$(vELPercFormula)','$(vNODPercFormula)','$(vODPercFormula)','$(vKODPercFormula)','$(vRWAPercFormula)','$(vRWAPercRORWAFormula)','$(vRORWAPercFormula)') &amp; '&gt;' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',2),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), // Pick($(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')'), '$(vELPercFormula)','$(vNODPercFormula)','$(vODPercFormula)','$(vKODPercFormula)','$(vRWAPercFormula)','$(vRWAPercRORWAFormula)','$(vRORWAPercFormula)') &amp; '&lt;' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',2),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), // Pick($(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')'), '$(vELPercFormula)','$(vNODPercFormula)','$(vODPercFormula)','$(vKODPercFormula)','$(vRWAPercFormula)','$(vRWAPercRORWAFormula)','$(vRORWAPercFormula)') &amp; '&gt;' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',2),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)') &amp;' AND '&amp; Pick($(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')'), '$(vELPercFormula)','$(vNODPercFormula)','$(vODPercFormula)','$(vKODPercFormula)','$(vRWAPercFormula)','$(vRWAPercRORWAFormula)','$(vRORWAPercFormula)') &amp; '&lt;' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',2),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',6)'), // Pick($(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')'), '$(vELPercFormula)','$(vNODPercFormula)','$(vODPercFormula)','$(vKODPercFormula)','$(vRWAPercFormula)','$(vRWAPercRORWAFormula)','$(vRORWAPercFormula)') &amp; '=' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',2),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), // n  Pick($(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')'), 'num(rank($(vELPercFormula),1))','num(rank($(vNODPercFormula),1))','num(rank($(vODPercFormula),1))','num(rank($(vKODPercFormula),1))','num(rank($(vRWAPercFormula),1))','num(rank($(vRWAPercRORWAFormula),1))','num(rank($(vRORWAPercFormula),1))') &amp; '&lt;=' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',2),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), // n% Pick($(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')'), '$(vELPercFormula)','$(vNODPercFormula)','$(vODPercFormula)','$(vKODPercFormula)','$(vRWAPercFormula)','$(vRWAPercRORWAFormula)','$(vRORWAPercFormula)') &amp; ' &lt; 100-' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',2),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)') , // n  Pick($(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')'), 'num(rank(-$(vELPercFormula),1))','num(rank(-$(vNODPercFormula),1))','num(rank(-$(vODPercFormula),1))','num(rank(-$(vKODPercFormula),1))','num(rank(-$(vRWAPercFormula),1))','num(rank(-$(vRWAPercRORWAFormula),1))','num(rank(-$(vRORWAPercFormula),1))') &amp; '&lt;=' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',2),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), // n% Pick($(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')'), '$(vELPercFormula)','$(vNODPercFormula)','$(vODPercFormula)','$(vKODPercFormula)','$(vRWAPercFormula)','$(vRWAPercRORWAFormula)','$(vRORWAPercFormula)') &amp; ' &lt; ' &amp; $(='SubField(TextBetween(vColorFormatString,'&amp;chr(39)&amp;'||'&amp;chr(39)&amp;','&amp;chr(39)&amp;'||'&amp;chr(39)&amp;',2),'&amp;chr(39)&amp;'|'&amp;chr(39)&amp;',5)'), //  Pick($(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')'), 'round($(vELPercFormula),0.0001) &gt; round($(vELPercTOTALFormula),0.0001)', 'round($(vNODPercFormula),0.0001) &gt; round($(vNODPercTOTALFormula),0.0001)', 'round($(vODPercFormula),0.0001) &gt; round($(vODPercTOTALFormula),0.0001)', 'round($(vKODPercFormula),0.0001) &gt; round($(vKODPercTOTALFormula),0.0001)', 'round($(vRWAPercFormula),0.0001) &gt; round($(vRWAPercTOTALFormula),0.0001)', 'round($(vRWAPercRORWAFormula),0.0001) &gt; round($(vRWAPercRORWAFormulaTotal),0.0001)', 'round($(vRORWAPercFormula),0.0001) &gt; round($(vRORWAPercTotalFormula),0.0001)'), //  Pick($(='WildMatch('&amp; chr(39) &amp; SubField(TextBetween(vColorFormatString,'||','||',2),'|',2)&amp;chr(39) &amp; ',' &amp;chr(39)&amp;'EL %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;',' &amp;chr(39)&amp;' %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA %'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RWA%(RORWA)'&amp;chr(39) &amp;','&amp; chr(39)&amp;'RORWA%'&amp;chr(39) &amp;')'), 'round($(vELPercFormula),0.0001) &lt; round($(vELPercTOTALFormula),0.0001)', 'round($(vNODPercFormula),0.0001) &lt; round($(vNODPercTOTALFormula),0.0001)', 'round($(vODPercFormula),0.0001) &lt; round($(vODPercTOTALFormula),0.0001)', 'round($(vKODPercFormula),0.0001) &lt; round($(vKODPercTOTALFormula),0.0001)', 'round($(vRWAPercFormula),0.0001) &lt; round($(vRWAPercTOTALFormula),0.0001)', 'round($(vRWAPercRORWAFormula),0.0001) &lt; round($(vRWAPercRORWAFormulaTotal),0.0001)', 'round($(vRORWAPercFormula),0.0001) &lt; round($(vRORWAPercTotalFormula),0.0001)') ),'0&gt;1')</code> </pre><br></div></div><br>  Perbedaannya adalah bahwa saya juga menjahit rumus nilai relatif menjadi variabel dan menggantinya tergantung pada isi string.  Itu tidak bekerja dengan cara yang berbeda atau itu tidak selalu bekerja secara stabil, itu dianggap bengkok ... Secara umum, nilai absolut dan relatif awalnya dalam satu variabel parsing dan itu sangat rumit, praktis tidak mungkin untuk mencari kesalahan kode atau perhitungan, untuk mengurai apa yang ditulis.  Oleh karena itu, diputuskan untuk membagi - parsim absolut dalam beberapa variabel, persen dalam variabel lain. <br><br><h4>  Blok 6. Tambahkan pengaturan ke tabel </h4><br>  Nah dan yang paling penting, sekarang Anda perlu mengecat tabel berdasarkan apa yang kami bagikan, kode untuk semua bidang tabel identik, dengan pengecualian kondisi input untuk penamaan bidang, jadi saya harus memalu semuanya secara manual, tidak ada otomatisasi, lebih tepatnya di suatu tempat pada kolom 15, otomatisme Ini diproduksi di otot-otot jari, memori otot berkembang.  Selanjutnya <br><br><div class="spoiler">  <b class="spoiler_title">misalnya, untuk bidang "ID CRM" dari tabel, kode memiliki formulir</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">if(Match('CRM ID',SubField(TextBetween(vColorFormatString,'||','||',1),'|',1)) AND ($(vColorFormatString1) OR $(vColorFormatStringPerc1)),$(vColorFormat1), If(Match('CRM ID',SubField(TextBetween(vColorFormatString,'||','||',2),'|',1)) AND ($(vColorFormatString2) OR $(vColorFormatStringPerc2)),$(vColorFormat2), If(Match('CRM ID',SubField(TextBetween(vColorFormatString,'||','||',3),'|',1)) AND ($(vColorFormatString3) OR $(vColorFormatStringPerc3)),$(vColorFormat3), If(Match('CRM ID',SubField(TextBetween(vColorFormatString,'||','||',4),'|',1)) AND ($(vColorFormatString4) OR $(vColorFormatStringPerc4)),$(vColorFormat4), If(Match('CRM ID',SubField(TextBetween(vColorFormatString,'||','||',5),'|',1)) AND ($(vColorFormatString5) OR $(vColorFormatStringPerc5)),$(vColorFormat5), If(Match('CRM ID',SubField(TextBetween(vColorFormatString,'||','||',6),'|',1)) AND ($(vColorFormatString6) OR $(vColorFormatStringPerc6)),$(vColorFormat6), If(Match('CRM ID',SubField(TextBetween(vColorFormatString,'||','||',7),'|',1)) AND ($(vColorFormatString7) OR $(vColorFormatStringPerc7)),$(vColorFormat7), If(Match('CRM ID',SubField(TextBetween(vColorFormatString,'||','||',8),'|',1)) AND ($(vColorFormatString8) OR $(vColorFormatStringPerc8)),$(vColorFormat8), If(Match('CRM ID',SubField(TextBetween(vColorFormatString,'||','||',9),'|',1)) AND ($(vColorFormatString9) OR $(vColorFormatStringPerc9)),$(vColorFormat9), If(Match('CRM ID',SubField(TextBetween(vColorFormatString,'||','||',10),'|',1)) AND ($(vColorFormatString10) OR $(vColorFormatStringPerc10)),$(vColorFormat10), ))))))))))</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">misalnya, untuk bidang ‚ÄúJUMLAH‚Äù pada tabel, kode memiliki formulir</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">if(Match('AMOUNT',SubField(TextBetween(vColorFormatString,'||','||',1),'|',1)) AND ($(vColorFormatString1) OR $(vColorFormatStringPerc1)),$(vColorFormat1), If(Match('AMOUNT',SubField(TextBetween(vColorFormatString,'||','||',2),'|',1)) AND ($(vColorFormatString2) OR $(vColorFormatStringPerc2)),$(vColorFormat2), If(Match('AMOUNT',SubField(TextBetween(vColorFormatString,'||','||',3),'|',1)) AND ($(vColorFormatString3) OR $(vColorFormatStringPerc3)),$(vColorFormat3), If(Match('AMOUNT',SubField(TextBetween(vColorFormatString,'||','||',4),'|',1)) AND ($(vColorFormatString4) OR $(vColorFormatStringPerc4)),$(vColorFormat4), If(Match('AMOUNT',SubField(TextBetween(vColorFormatString,'||','||',5),'|',1)) AND ($(vColorFormatString5) OR $(vColorFormatStringPerc5)),$(vColorFormat5), If(Match('AMOUNT',SubField(TextBetween(vColorFormatString,'||','||',6),'|',1)) AND ($(vColorFormatString6) OR $(vColorFormatStringPerc6)),$(vColorFormat6), If(Match('AMOUNT',SubField(TextBetween(vColorFormatString,'||','||',7),'|',1)) AND ($(vColorFormatString7) OR $(vColorFormatStringPerc7)),$(vColorFormat7), If(Match('AMOUNT',SubField(TextBetween(vColorFormatString,'||','||',8),'|',1)) AND ($(vColorFormatString8) OR $(vColorFormatStringPerc8)),$(vColorFormat8), If(Match('AMOUNT',SubField(TextBetween(vColorFormatString,'||','||',9),'|',1)) AND ($(vColorFormatString9) OR $(vColorFormatStringPerc9)),$(vColorFormat9), If(Match('AMOUNT',SubField(TextBetween(vColorFormatString,'||','||',10),'|',1)) AND ($(vColorFormatString10) OR $(vColorFormatStringPerc10)),$(vColorFormat10), ))))))))))</code> </pre><br></div></div><br>  Itu pada dasarnya itu.  Jika Anda mendeskripsikan setiap item menu, Anda mendapatkan buku lengkap, seperti manual pelatihan.  Maaf jika ada yang kurang detail. <br><br><div class="spoiler">  <b class="spoiler_title">PS</b> <div class="spoiler_text">  Saya mengerti bahwa kemungkinan besar ini bisa dilakukan jauh lebih elegan, tetapi ketika Anda sudah dalam proses, maka hanya chip yang akan terbang.  Saya tidak benar-benar ingin menggambarkan semua detail implementasi menu, dan mengapa tidak.  Secara umum, artikel ini dimaksudkan untuk menunjukkan bagaimana Anda dapat melakukannya, mungkin itu akan menginspirasi seseorang, ide implementasi yang lebih curam akan muncul. <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id446076/">https://habr.com/ru/post/id446076/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id446062/index.html">Quo vadis. Pengembang Melarang di Google Play</a></li>
<li><a href="../id446064/index.html">Pakar: pembaruan perangkat lunak tidak akan membantu perkawinan di peluncur Boeing</a></li>
<li><a href="../id446066/index.html">Kami mengembangkan teori algoritma sebagai proyek sumber terbuka</a></li>
<li><a href="../id446072/index.html">Menggunakan bootloader yang ditandatangani untuk memintas perlindungan Boot Aman UEFI</a></li>
<li><a href="../id446074/index.html">Bagaimana kami memecah perkembangan menjadi beberapa tim (dan melupakan sprint tanpa akhir dan stand-up yang tidak berguna)</a></li>
<li><a href="../id446078/index.html">"Suara": mendiskusikan podcast tentang teknologi audio</a></li>
<li><a href="../id446080/index.html">Di AS, pengadilan merekomendasikan untuk melarang impor model iPhone tertentu karena melanggar paten Qualcomm Apple</a></li>
<li><a href="../id446082/index.html">Kisah Setengah Lingkaran</a></li>
<li><a href="../id446086/index.html">Sejarah Linux. Bagian III: pasar baru dan "musuh" lama</a></li>
<li><a href="../id446088/index.html">Hal-hal yang tidak saya ketahui pada tahun 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>