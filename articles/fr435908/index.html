<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüî¨ üë®üèæ‚Äçüè≠ üëßüèΩ Web asc√©tique: prototypes de march√©s aux puces on go et js üë©üèæ‚Äçüî¨ üë©üèø‚Äçüíº üôä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous, je souhaite partager le r√©sultat de mes r√©flexions sur ce que peut √™tre une application web moderne. Par exemple, envisagez de concevo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Web asc√©tique: prototypes de march√©s aux puces on go et js</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435908/"><p> <a href=""><img src="https://habrastorage.org/webt/jl/lq/qo/jllqqo3xn1mthylxxodb2-digfw.png" alt="capture d'√©cran"></a> </p><br><p>  Bonjour √† tous, je souhaite partager le r√©sultat de mes r√©flexions sur ce que peut √™tre une application web moderne.  Par exemple, envisagez de concevoir un babillard pour les bandes dessin√©es.  Dans un sens, le produit en question est con√ßu pour un public de geeks et sympathisants, ce qui vous permet de faire preuve de libert√© dans l'interface.  Dans la composante technique, au contraire, une attention aux d√©tails est n√©cessaire. </p><br><p>  En v√©rit√©, je ne comprends rien dans les bandes dessin√©es, mais j'adore les march√©s aux puces, surtout au format forum, qui √©taient populaires dans le z√©ro.  Par cons√©quent, l'hypoth√®se (peut-√™tre fausse), dont d√©coulent les conclusions suivantes, n'est qu'une - le principal type d'interaction avec l'application est la visualisation, le secondaire - la publication d'annonces et de discussions. </p><br><p>  Notre objectif sera de cr√©er une application simple, sans <del> savoir-faire technique </del>  des sifflets suppl√©mentaires, cependant, conformes aux r√©alit√©s modernes.  Les principales exigences que j'aimerais atteindre sont: </p><a name="habracut"></a><br><ol><li><p>  C√¥t√© serveur: </p><br><p>  a) Effectue les fonctions de stockage, de validation, d'envoi de donn√©es utilisateur au client <br>  b) Les op√©rations ci-dessus consomment une quantit√© acceptable de ressources (temps, y compris) <br>  c) L'application et les donn√©es sont prot√©g√©es des vecteurs d'attaque populaires <br>  d) Il dispose d'une API simple pour les clients tiers et l'interaction entre serveurs <br>  e) D√©ploiement multiplateforme et simple </p><br></li><li><p>  C√¥t√© client: </p><br><p>  a) Fournit les fonctionnalit√©s n√©cessaires pour cr√©er et consommer du contenu <br>  b) L'interface est pratique pour une utilisation r√©guli√®re, le chemin minimum vers toute action, la quantit√© maximale de donn√©es par √©cran <br>  c) Hors communication avec le serveur, toutes les fonctions disponibles dans cette situation sont disponibles <br>  d) L'interface affiche la version actuelle de l'√©tat et du contenu, sans red√©marrage ni attente <br>  d) Le red√©marrage de l'application n'affecte pas son √©tat <br>  f) Si possible, r√©utilisez les √©l√©ments DOM et le code JS <br>  g) Nous n'utiliserons pas de biblioth√®ques et de frameworks tiers lors de l'ex√©cution <br>  h) La mise en page est s√©mantique pour l'accessibilit√©, les analyseurs, etc. <br>  i) La navigation du contenu principal est accessible via l'URL et le clavier </p><br></li></ol><br><p>  √Ä mon avis, les exigences logiques et la plupart des applications modernes √† un degr√© ou un autre remplissent ces conditions.  Voyons ce qui se passe avec nous (lien vers la source et la d√©mo √† la fin du post). </p><br><div class="spoiler">  <b class="spoiler_title">Avertissements:</b> <div class="spoiler_text"><ul><li>  Je tiens √† m'excuser aupr√®s des auteurs inconnus des images utilis√©es dans la d√©mo sans autorisation, ainsi qu'√† G√∂sse G., Prozorovskaya B. D. et √† la maison d'√©dition "Library of Florence Pavlenkov" pour avoir utilis√© des extraits de l'ouvrage "Siddhartha". </li><li>  L'auteur n'est pas un vrai programmeur, je ne recommande pas d'utiliser le code ou les techniques utilis√©es dans ce projet si vous ne savez pas ce que vous faites. </li><li>  Je m'excuse pour le style du code; il aurait pu √™tre √©crit de mani√®re plus lisible et √©vidente, mais ce n'est pas amusant.  Un projet pour l'√¢me et pour un ami, comme on dit. </li><li>  Je m'excuse √©galement pour le taux d'alphab√©tisation, en particulier dans le texte anglais.  Les ann√©es parlent de May Hart. </li><li>  Les performances du prototype pr√©sent√© ont √©t√© test√©es en [chrome 70;  linux x86_64;  1366x768], je serai extr√™mement reconnaissant aux utilisateurs d'autres plates-formes et appareils pour les messages d'erreur. </li><li>  Il s'agit d'un prototype et d'un sujet de discussion propos√© - approches et principes, je demande que toutes les critiques de la mise en ≈ìuvre et du c√¥t√© esth√©tique soient accompagn√©es d'arguments. </li></ul></div></div><br><h2 id="server">  Serveur </h2><br><p>  La langue du serveur est le golang.  Un langage simple et rapide avec une excellente biblioth√®que et documentation standard ... un peu ennuyeux.  Le choix initial s'est port√© sur elixir / erlang, mais comme je connaissais d√©j√† go (relativement), il a √©t√© d√©cid√© de ne pas le compliquer (et les packages n√©cessaires n'√©taient que pour go). </p><br><p>  L'utilisation de cadres Web dans la communaut√© go n'est pas encourag√©e (√† juste titre, cela vaut la peine d'√™tre admis), nous choisissons un compromis et utilisons le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">microframework labstack / echo</a> , r√©duisant ainsi la quantit√© de routine et, il me semble, ne perd pas beaucoup de performances. </p><br><p>  Nous utilisons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tidwall / buntdb</a> comme base de donn√©es.  Premi√®rement, la solution int√©gr√©e est plus pratique et r√©duit les frais g√©n√©raux, et deuxi√®mement, en m√©moire + cl√© / valeur - <del>  √† la mode, √©l√©gant </del>  Rapide et sans cache n√©cessaire.  Nous stockons et fournissons des donn√©es dans JSON, validant uniquement lors de la modification. </p><br><p>  Sur l'i3 de deuxi√®me g√©n√©ration, l'enregistreur int√©gr√© affiche le temps d'ex√©cution pour diff√©rentes requ√™tes de 0,5 √† 10 ms.  L'ex√©cution de wrk sur la m√™me machine donne √©galement des r√©sultats suffisants pour nos besoins: </p><br><pre><code class="plaintext hljs">‚ûú comico git:(master) wrk -t2 -c500 -d60s http://localhost:9001/pub/mtimes Running 1m test @ http://localhost:9001/pub/mtimes 2 threads and 500 connections Thread Stats Avg Stdev Max +/- Stdev Latency 20.74ms 16.68ms 236.16ms 72.69% Req/Sec 13.19k 627.43 15.62k 73.58% 1575522 requests in 1.00m, 449.26MB read Requests/sec: 26231.85 Transfer/sec: 7.48MB</code> </pre> <br><pre> <code class="plaintext hljs">‚ûú comico git:(master) wrk -t2 -c500 -d60s http://localhost:9001/pub/goods Running 1m test @ http://localhost:9001/pub/goods 2 threads and 500 connections Thread Stats Avg Stdev Max +/- Stdev Latency 61.79ms 65.96ms 643.73ms 86.48% Req/Sec 5.26k 705.24 7.88k 70.31% 628215 requests in 1.00m, 8.44GB read Requests/sec: 10454.44 Transfer/sec: 143.89MB</code> </pre> <br><h3 id="struktura-proekta">  Structure du projet </h3><br><p>  Le package <u>comico / model</u> est divis√© en trois fichiers: <br>  model.go - contient une description des types de donn√©es et des fonctions g√©n√©rales: cr√©ation / mise √† jour (buntdb ne fait pas de distinction entre ces op√©rations et nous v√©rifions la pr√©sence d'un enregistrement manuellement), validation, suppression, obtention d'un enregistrement et obtention d'une liste; <br>  rules.go - contient des r√®gles de validation pour un type sp√©cifique et une fonction de journalisation; <br>  files.go - travailler avec des images. <br>  Le type Mtimes stocke des donn√©es sur le dernier changement des types restants dans la base de donn√©es, informant ainsi le client quelles donn√©es ont chang√©. </p><br><p>  Le package <u>comico / bd</u> contient des fonctions g√©n√©ralis√©es pour interagir avec la base de donn√©es: cr√©ation, suppression, s√©lection, etc. Buntdb enregistre toutes les modifications apport√©es √† un fichier (dans notre cas, une fois par seconde), au format texte, ce qui est pratique dans certaines situations.  Le fichier db n'est pas √©dit√©, les modifications en cas de succ√®s de la transaction sont ajout√©es √† la fin.  Toutes mes tentatives pour violer l'int√©grit√© des donn√©es ont √©chou√©, dans le pire des cas, les modifications de la derni√®re seconde sont perdues. <br>  Dans notre impl√©mentation, chaque type correspond √† une base de donn√©es distincte dans un fichier s√©par√© (√† l'exception des journaux qui sont stock√©s exclusivement en m√©moire et sont remis √† z√©ro au red√©marrage).  Cela est en grande partie d√ª √† la commodit√© de la sauvegarde et de l'administration, un petit plus - une transaction ouverte pour l'√©dition bloque l'acc√®s √† un seul type de donn√©es. <br>  Ce package peut √™tre facilement remplac√© par un package similaire en utilisant une autre base de donn√©es, SQL, par exemple.  Pour ce faire, il suffit d'impl√©menter les fonctions suivantes: </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Exist</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key, val </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadAll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, pattern </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(str </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, err error)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadOne</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(str </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, err error)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Renew</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err error, newId </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span></code> </pre> <br><p>  Le <u>package comico / cnst</u> contient certaines constantes n√©cessaires dans tous les packages (types de donn√©es, types d'actions, types d'utilisateurs).  De plus, ce paquet contient tous les messages lisibles par l'homme avec lesquels notre serveur r√©pondra au monde ext√©rieur. </p><br><p>  Le package <u>comico / server</u> contient des informations de routage.  De plus, seulement quelques lignes (gr√¢ce aux d√©veloppeurs Echo), l'autorisation utilisant JWT, CORS, les en-t√™tes CSP, l'enregistreur, la distribution statique, gzip, le certificat automatique ACME, etc. sont configur√©es. </p><br><h3 id="tochki-vhoda-api">  Points d'entr√©e API </h3><br><table><thead><tr><th>  URL </th><th>  Les donn√©es </th><th>  La description </th></tr></thead><tbody><tr><td>  get / pub / (marchandises | messages | utilisateurs | cmnts | fichiers) </td><td>  - </td><td>  Obtention d'un √©ventail d'annonces, de publications, d'utilisateurs, de commentaires et de fichiers pertinents </td></tr><tr><td>  get / pub / mtimes </td><td>  - </td><td>  Obtention de la derni√®re heure de modification pour chaque type de donn√©es </td></tr><tr><td>  poste / pub / connexion </td><td>  {id *: login, pass *: mot de passe} </td><td>  Renvoie le jeton JWT et sa dur√©e </td></tr><tr><td>  poste / pub / pass </td><td>  {id *, pass *} </td><td>  Cr√©e un nouvel utilisateur si les donn√©es sont correctes </td></tr><tr><td>  mettre / api / passer </td><td>  {id *, pass *} </td><td>  Mise √† jour du mot de passe </td></tr><tr><td>  post | put / api / goods </td><td>  {id *, auth *, title *, type *, price *, text *, images: [], Table: {key: value}} </td><td>  Cr√©er / mettre √† jour l'annonce </td></tr><tr><td>  post | put / api / posts </td><td>  {id *, auth *, title *, type *, text *} </td><td>  Cr√©er / mettre √† jour le message du forum </td></tr><tr><td>  post | put / api / utilisateurs </td><td>  {id *, titre, type, statut, scribes: [], ignore: [], Table: {cl√©: valeur}} </td><td>  Cr√©er / mettre √† jour un utilisateur </td></tr><tr><td>  post / api / cmnts </td><td>  {id *, auth *, propri√©taire *, tapez *, √†, texte *} </td><td>  Cr√©ation de commentaire </td></tr><tr><td>  supprimer / api / (marchandises | messages | utilisateurs | cmnts) / [id] </td><td>  - </td><td>  Supprime une entr√©e avec id </td></tr><tr><td>  obtenir / api / activit√© </td><td>  - </td><td>  Met √† jour la derni√®re heure de lecture des commentaires entrants pour l'utilisateur actuel </td></tr><tr><td>  obtenir / api / (s'abonner | ignorer) / [tag] </td><td>  - </td><td>  Ajoute ou supprime (le cas √©ch√©ant) une balise √† l'utilisateur dans la liste des abonnements / ignore </td></tr><tr><td>  post / api / upload / (marchandises | utilisateurs) </td><td>  multipart (nom, fichier) </td><td>  T√©l√©charge des annonces photo / avatar d'utilisateur </td></tr></tbody></table><br><p>  * - champs obligatoires <br>  api - n√©cessite une autorisation, pub - non </p><br><p>  Avec une requ√™te get qui ne correspond pas √† ce qui pr√©c√®de, le serveur recherche un fichier dans le r√©pertoire pour la statique (par exemple, / img / * - images, /index.html - le client). <br>  Tout point API renverra un code de r√©ponse 200 en cas de succ√®s, 400 ou 404 pour une erreur et un court message si n√©cessaire. <br>  Les droits d'acc√®s sont simples: la cr√©ation d'une entr√©e est disponible pour un utilisateur autoris√©, la modification pour l'auteur et le mod√©rateur, l'administrateur peut modifier et nommer des mod√©rateurs. <br>  L'API est √©quip√©e de l'anti-vandalisme le plus simple: les actions sont enregistr√©es avec l'ID utilisateur et l'IP, et, en cas d'acc√®s fr√©quent, une erreur est renvoy√©e vous demandant d'attendre un peu (utile contre la devinette du mot de passe). </p><br><h2 id="klient">  Client </h2><br><p>  J'aime le concept de web'a r√©actif, je pense que la plupart des sites / applications modernes doivent se faire soit dans le cadre de ce concept, soit compl√®tement statiques.  D'un autre c√¥t√©, un simple site avec des m√©gaoctets de code JS ne peut que d√©primer.  √Ä mon avis, ce probl√®me (et pas seulement) peut √™tre r√©solu par Svelte.  Ce framework (ou plut√¥t le langage pour construire des interfaces r√©actives) n'est pas inf√©rieur √† Vue dans la fonctionnalit√© n√©cessaire, mais il a un avantage ind√©niable - les composants sont compil√©s dans vanilla JS, ce qui r√©duit √† la fois la taille du bundle et la charge sur la machine virtuelle (bundle.min.js.gz notre march√© aux puces est modeste, selon les normes actuelles, 24 Ko).  Les d√©tails peuvent √™tre trouv√©s dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> officielle. </p><br><p>  Nous choisissons le march√© aux puces SvelteJS pour le c√¥t√© client du march√© aux puces, nous souhaitons tout le meilleur √† Rich Harris et la poursuite du d√©veloppement du projet! </p><br><p>  PS Je ne veux offenser personne.  Je suis s√ªr que chaque sp√©cialiste et chaque projet a ses propres outils. </p><br><h3 id="klient--dannye">  Client / Donn√©es </h3><br><h4 id="url">  URL </h4><br><p>  Nous utilisons pour la navigation.  Nous ne simulerons pas un document de plusieurs pages; nous utilisons plut√¥t des pages de hachage avec des param√®tres de requ√™te.  Pour les transitions, vous pouvez utiliser le &lt;a&gt; habituel sans js. </p><br><p>  Les sections correspondent aux types de donn√©es: <u>/ # marchandises</u> , <u>/ # publications</u> , <u>/ # utilisateurs</u> . <br>  Param√®tres <em>:?</em> <u>Id =</u> <em>record_id,?</em> <u>Page =</u> <em>page_number,?</em> <u>Search =</u> <em>search_query</em> . </p><br><p>  Quelques exemples: </p><br><ul><li>  <u>/ # posts? id = 1542309643 &amp; page = 999 &amp; search = {auth: anon}</u> - section <em>posts</em> , id poste - <em>1542309643</em> , page de commentaires - <em>999</em> , requ√™te de recherche - <em>{auth: anon}</em> </li><li>  <u>/ # goods? page = 2 &amp; search = siddhartha</u> - section <em>articles</em> , section page - <em>2</em> , requ√™te de recherche - <em>siddhartha</em> </li><li>  <u>/ # goods? search = wer {key: value} t</u> - <em>marchandises de</em> section, requ√™te de recherche - consiste √† rechercher la sous-cha√Æne <em>wert</em> dans l'en-t√™te ou le texte de l'annonce et la <em>valeur de</em> la sous-cha√Æne dans la propri√©t√© <em>key</em> de la partie tabulaire de l'annonce </li><li>  <u>/ # goods? search = {model: 100, display: 256}</u> - Je pense que tout est clair ici par analogie </li></ul><br><p>  Les fonctions d'analyse et de g√©n√©ration d'URL dans notre impl√©mentation ressemblent √† ceci: </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'hashchange'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> hash = location.hash.slice(<span class="hljs-number"><span class="hljs-number">1</span></span>).split(<span class="hljs-string"><span class="hljs-string">'?'</span></span>), result = {} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!hash[<span class="hljs-number"><span class="hljs-number">1</span></span>]) hash[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str</span></span></span><span class="hljs-function"> =&gt;</span></span> { str = str.split(<span class="hljs-string"><span class="hljs-string">'='</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!str[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp;&amp; !!str[<span class="hljs-number"><span class="hljs-number">1</span></span>]) result[<span class="hljs-built_in"><span class="hljs-built_in">decodeURI</span></span>(str[<span class="hljs-number"><span class="hljs-number">0</span></span>]).toLowerCase()] = <span class="hljs-built_in"><span class="hljs-built_in">decodeURI</span></span>(str[<span class="hljs-number"><span class="hljs-number">1</span></span>]).toLowerCase() }) result.type = hash[<span class="hljs-number"><span class="hljs-number">0</span></span>] || <span class="hljs-string"><span class="hljs-string">'goods'</span></span> store.set({ <span class="hljs-attr"><span class="hljs-attr">hash</span></span>: result }) }) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">goto</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ type, id, page, search }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { hash } = store.get(), args = <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>], query = [] <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-string"><span class="hljs-string">'id'</span></span>, <span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'search'</span></span>).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = args[key] !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> ? args[key] : hash[key] || <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value !== <span class="hljs-literal"><span class="hljs-literal">null</span></span>) query.push(key + <span class="hljs-string"><span class="hljs-string">'='</span></span> + value) }) location.hash = (type || hash.type || <span class="hljs-string"><span class="hljs-string">'goods'</span></span>) + (!!query.length ? <span class="hljs-string"><span class="hljs-string">'?'</span></span> + query.join(<span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>) : <span class="hljs-string"><span class="hljs-string">''</span></span>) }</code> </pre> <br><h4 id="api">  API </h4><br><p>  Pour √©changer des donn√©es avec le serveur, nous utiliserons l'api fetch.  Pour t√©l√©charger des enregistrements mis √† jour √† de courts intervalles, nous faisons une demande √† <em>/ pub / mtimes</em> , si l'heure de la derni√®re modification pour n'importe quel type diff√®re de celle locale, nous chargeons une liste de ce type.  Oui, il √©tait possible d'impl√©menter la notification des mises √† jour via SSE ou WebSockets et le chargement incr√©mentiel, mais dans ce cas, nous pouvons nous en passer.  Qu'avons-nous obtenu: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GET</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">type</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(location.origin + <span class="hljs-string"><span class="hljs-string">'/pub/'</span></span> + type) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">ok</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> })) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type === <span class="hljs-string"><span class="hljs-string">'mtimes'</span></span>) store.set({ <span class="hljs-attr"><span class="hljs-attr">online</span></span>: response.ok }) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.ok ? <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> response.json() : [] } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkUpdate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">type, mtimes, updates = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> local = store.get()._mtimes, net = mtimes || <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> GET(<span class="hljs-string"><span class="hljs-string">'mtimes'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!net[type] || local[type] === net[type]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = updates[<span class="hljs-string"><span class="hljs-string">'_'</span></span> + type] = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> GET(type) local[type] = net[type]; updates._mtimes = local <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!value &amp;&amp; !!value.sort) store.set(updates) } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkUpdates</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> checkUpdates(), <span class="hljs-number"><span class="hljs-number">30000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mtimes = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> store.GET(<span class="hljs-string"><span class="hljs-string">'mtimes'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-string"><span class="hljs-string">'users'</span></span>, <span class="hljs-string"><span class="hljs-string">'goods'</span></span>, <span class="hljs-string"><span class="hljs-string">'posts'</span></span>, <span class="hljs-string"><span class="hljs-string">'cmnts'</span></span>, <span class="hljs-string"><span class="hljs-string">'files'</span></span>) .forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">type</span></span></span><span class="hljs-function"> =&gt;</span></span> checkUpdate(type, mtimes)) }</code> </pre> <br><p>  Pour le filtrage et la pagination, nous utilisons les propri√©t√©s calcul√©es de Svelte, bas√©es sur les donn√©es de navigation.  La direction des valeurs calcul√©es est la suivante: <strong>items</strong> (tableaux d'enregistrements provenant du serveur) =&gt; <strong>ignoredItems</strong> (enregistrements filtr√©s en fonction de la liste d' <strong>ignorance</strong> de l'utilisateur actuel) =&gt; <strong>scribedItems</strong> (filtre les enregistrements en fonction de la liste des abonnements, si activ√©s) =&gt; <strong>curItem</strong> et <strong>curItems</strong> (calcule les enregistrements actuels selon la section) =&gt; <strong>filterItems</strong> (filtre les enregistrements en fonction de la requ√™te de recherche, s'il n'y a qu'un seul enregistrement - filtre les commentaires) =&gt; <strong>maxPage</strong> (calcule le nombre de pages au taux de 12 enregistrements / commentaires par page) =&gt; <strong>pagedItem</strong> (renvoie le tableau final avec  messages / commentaires bas√©s sur le num√©ro de page actuel). </p><br><p>  Les commentaires et les images ( <strong>commentaires</strong> et <strong>_images</strong> ) sont calcul√©s s√©par√©ment, regroup√©s par type et enregistrement de propri√©taire. </p><br><p>  Les calculs se produisent automatiquement et uniquement lorsque les donn√©es associ√©es changent, les donn√©es interm√©diaires sont constamment en m√©moire.  √Ä cet √©gard, nous tirons une conclusion d√©sagr√©able - pour une grande quantit√© d'informations et / ou sa mise √† jour fr√©quente, une grande quantit√© de ressources peut √™tre d√©pens√©e. </p><br><h4 id="cache">  Cache </h4><br><p>  Conform√©ment √† la d√©cision de faire une application hors ligne, nous impl√©mentons le stockage des enregistrements et certains aspects de l'√©tat dans localStorage, les fichiers image dans CacheStorage.  Travailler avec localStorage est extr√™mement simple, nous convenons que les propri√©t√©s avec le pr√©fixe "_" sont automatiquement enregistr√©es et restaur√©es au red√©marrage lorsqu'elles sont modifi√©es.  Ensuite, notre solution peut ressembler √† ceci: </p><br><pre> <code class="javascript hljs">store.on(<span class="hljs-string"><span class="hljs-string">'state'</span></span>, ({ changed, current }) =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(changed).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">prop</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!prop.indexOf(<span class="hljs-string"><span class="hljs-string">'_'</span></span>)) localStorage.setItem(prop, <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(current[prop])) }) }) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadState</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; localStorage.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> prop = localStorage.key(i) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(localStorage.getItem(prop) || <span class="hljs-string"><span class="hljs-string">'null'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!value &amp;&amp; !prop.indexOf(<span class="hljs-string"><span class="hljs-string">'_'</span></span>)) state[prop] = value } store.set(state) }</code> </pre> <br><p>  Les fichiers sont un peu plus compliqu√©s.  Tout d'abord, nous utiliserons la liste de tous les fichiers pertinents (avec l'heure de cr√©ation) provenant du serveur.  Lors de la mise √† jour de cette liste, nous la comparons avec les anciennes valeurs, mettons les nouveaux fichiers dans CacheStorage, supprimons ceux qui sont obsol√®tes √† partir de l√†: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheImages</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newFiles</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> oldFiles = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(localStorage.getItem(<span class="hljs-string"><span class="hljs-string">'_files'</span></span>) || <span class="hljs-string"><span class="hljs-string">'[]'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> cache = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> caches.open(<span class="hljs-string"><span class="hljs-string">'comico'</span></span>) oldFiles.forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">file</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!~newFiles.indexOf(file)) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [ id, type ] = file.split(<span class="hljs-string"><span class="hljs-string">':'</span></span>) cache.delete(<span class="hljs-string"><span class="hljs-string">`/img/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${type}</span></span></span><span class="hljs-string">_</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${id}</span></span></span><span class="hljs-string">_sm.jpg`</span></span>) }}) newFiles.forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">file</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!~oldFiles.indexOf(file)) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [ id, type ] = file.split(<span class="hljs-string"><span class="hljs-string">':'</span></span>), src = <span class="hljs-string"><span class="hljs-string">`/img/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${type}</span></span></span><span class="hljs-string">_</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${id}</span></span></span><span class="hljs-string">_sm.jpg`</span></span> cache.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Request(src, { <span class="hljs-attr"><span class="hljs-attr">cache</span></span>: <span class="hljs-string"><span class="hljs-string">'no-cache'</span></span> })) }}) }</code> </pre> <br><p>  Ensuite, vous devez red√©finir le comportement de r√©cup√©ration afin que le fichier soit extrait de CacheStorage sans se connecter au serveur.  Pour ce faire, vous devez utiliser ServiceWorker.  Dans le m√™me temps, nous allons configurer d'autres fichiers √† mettre en cache pour un fonctionnement en dehors du serveur: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CACHE = <span class="hljs-string"><span class="hljs-string">'comico'</span></span>, FILES = [ <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-string"><span class="hljs-string">'/bundle.css'</span></span>, <span class="hljs-string"><span class="hljs-string">'/bundle.js'</span></span> ] self.addEventListener(<span class="hljs-string"><span class="hljs-string">'install'</span></span>, (e) =&gt; { e.waitUntil(caches.open(CACHE).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cache</span></span></span><span class="hljs-function"> =&gt;</span></span> cache.addAll(FILES)) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> self.skipWaiting())) }) self.addEventListener(<span class="hljs-string"><span class="hljs-string">'fetch'</span></span>, (e) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> r = e.request <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (r.method !== <span class="hljs-string"><span class="hljs-string">'GET'</span></span> || !!~r.url.indexOf(<span class="hljs-string"><span class="hljs-string">'/pub/'</span></span>) || !!~r.url.indexOf(<span class="hljs-string"><span class="hljs-string">'/api/'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!~r.url.lastIndexOf(<span class="hljs-string"><span class="hljs-string">'_sm.jpg'</span></span>) &amp;&amp; e.request.cache !== <span class="hljs-string"><span class="hljs-string">'no-cache'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> e.respondWith(fromCache(r)) e.respondWith(toCache(r)) }) <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromCache</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">request</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">await</span></span> caches.open(CACHE)).match(request) || <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Response(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, { <span class="hljs-attr"><span class="hljs-attr">status</span></span>: <span class="hljs-number"><span class="hljs-number">404</span></span> }) } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toCache</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">request</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(request).catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> fromCache(request)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!response &amp;&amp; response.ok) (<span class="hljs-keyword"><span class="hljs-keyword">await</span></span> caches.open(CACHE)).put(request, response.clone()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response }</code> </pre> <br><p>  Il semble un peu maladroit, mais remplit ses fonctions. </p><br><h3 id="klient--interfeys">  Client / Interface </h3><br><p>  Structure des composants: <br>  index.html |  main.js <br>  == <u>header.html</u> - contient un logo, une barre d'√©tat, un menu principal, un menu de navigation inf√©rieur, un formulaire de <u>soumission de</u> commentaires <br>  == <u>c√¥t√©.html</u> - est un conteneur pour tous les composants modaux <br>  ==== <u>goodForm.html</u> - formulaire pour ajouter et modifier une annonce <br>  ==== <u>userForm.html</u> - <u>modifie le</u> formulaire de l'utilisateur actuel <br>  ====== <u>tableForm.html</u> - un fragment du formulaire pour saisir des donn√©es tabulaires <br>  ==== <u>postForm.html</u> - formulaire pour publication sur le forum <br>  ==== <u>login.html</u> - <u>formulaire de</u> connexion / inscription <br>  ==== <u>activity.html</u> - affiche les commentaires adress√©s √† l'utilisateur actuel <br>  ==== <u>goodImage.html</u> - afficher les annonces photo principales et suppl√©mentaires <br>  == <u>main.html</u> - conteneur pour le contenu principal <br>  ==== <u>goods.html</u> - liste ou cartes d'annonce uniques <br>  ==== <u>users.html</u> - idem pour les utilisateurs <br>  ==== <u>posts.html</u> - Je pense que c'est clair <br>  ==== <u>cmnts.html</u> - liste des commentaires sur le <u>post</u> actuel <br>  ====== <u>cmntsPager.html</u> - pagination pour les commentaires </p><br><ul><li>  Dans chaque composant, nous essayons de minimiser le nombre de balises html. </li><li>  Nous utilisons les classes uniquement comme indicateur d'√©tat. </li><li>  Nous supprimons des fonctions similaires au magasin (les propri√©t√©s et m√©thodes du magasin svelte peuvent √™tre utilis√©es directement √† partir des composants en leur ajoutant le pr√©fixe '$'). </li><li>  La plupart des fonctions attendent un √©v√©nement utilisateur ou un changement de certaines propri√©t√©s, manipulent les donn√©es d'√©tat, sauvegardent le r√©sultat de leur travail √† l'√©tat et terminent.  Ainsi, une petite coh√©rence et extensibilit√© du code est obtenue. </li><li>  Pour la vitesse apparente des transitions et autres √©v√©nements d'interface utilisateur, nous s√©parons, dans la mesure du possible, les manipulations avec des donn√©es se produisant en arri√®re-plan et les actions associ√©es √† l'interface, qui √† son tour utilise le r√©sultat du calcul actuel, reconstruisant si n√©cessaire, le reste sera aimablement effectu√© par le framework. </li><li>  Les donn√©es du formulaire √† remplir sont stock√©es dans localStorage pour chaque entr√©e afin d'√©viter leur perte. </li><li>  Dans tous les composants, nous utilisons le mode immuable dans lequel la propri√©t√©-objet n'est consid√©r√©e comme modifi√©e que lorsqu'un nouveau lien est re√ßu, quel que soit le changement dans les champs, acc√©l√©rant ainsi un peu nos applications, bien qu'en raison d'une l√©g√®re augmentation de la quantit√© de code. </li></ul><br><h3 id="klient--upravlenie">  Client / Gestion </h3><br><p>  Pour contr√¥ler √† l'aide du clavier, nous utilisons les combinaisons suivantes: <br>  <strong>Alt + s</strong> / <strong>Alt + a</strong> - fait basculer la page des enregistrements vers l'avant / vers l'arri√®re, car un enregistrement fait basculer la page des commentaires. <br>  <strong>Alt + w</strong> / <strong>Alt + q</strong> - passe √† l'enregistrement suivant / pr√©c√©dent (le cas √©ch√©ant), fonctionne en mode liste, enregistrement unique et vue d'image <br>  <strong>Alt + x</strong> / <strong>Alt + z</strong> - fait d√©filer la page vers le haut / bas.  Dans la vue d'image, fait basculer les images vers l'avant / l'arri√®re <br>  <strong>Echap</strong> - ferme la fen√™tre modale, si ouverte, revient √† la liste, si une seule entr√©e est ouverte, annule la requ√™te de recherche en mode liste <br>  <strong>Alt + c</strong> - se concentre sur le champ de recherche ou de commentaire, selon le mode actuel <br>  <strong>Alt + v</strong> - activer / d√©sactiver le mode d'affichage des photos pour une seule annonce <br>  <strong>Alt + r</strong> - ouvre / ferme la liste des commentaires entrants pour un utilisateur autoris√© <br>  <strong>Alt + t</strong> - Bascule les th√®mes clair / sombre <br>  <strong>Alt + g</strong> - Liste des annonces <br>  <strong>Alt + u</strong> - Utilisateurs <br>  <strong>Alt + p</strong> - forum <br>  Je sais que dans de nombreux navigateurs, ces combinaisons sont utilis√©es par le navigateur lui-m√™me, mais pour mon chrome, je n'ai pas pu trouver quelque chose de plus pratique.  Je serai heureux de vos suggestions. </p><br><p>  En plus du clavier, vous pouvez bien s√ªr utiliser la console du navigateur.  Par exemple, <em>store.goBack ()</em> , <em>store.nextPage ()</em> , <em>store.prevPage ()</em> , <em>store.nextItem ()</em> , <em>store.prevItem ()</em> , <em>store.search (stringValue)</em> , <em>store.checkUpdate ('goods' || ' utilisateurs || 'messages' || 'fichiers' || 'cmnts')</em> - faites ce que le nom implique;  <em>store.get (). comments</em> et <em>store.get () ._ images</em> - retourne les fichiers group√©s et les commentaires;  <em>store.get (). ignoredItems</em> et <em>store.get (). scribedItems</em> sont des listes d'enregistrements que vous ignorez et suivez.  Une liste compl√®te de toutes les donn√©es interm√©diaires et calcul√©es est disponible sur <em>store.get ()</em> .  Je ne pense pas que quiconque puisse en avoir besoin s√©rieusement, mais, par exemple, le filtrage des enregistrements par utilisateur et la suppression me paraissent assez pratiques depuis la console. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  C'est ici que vous pouvez mettre fin √† votre connaissance du projet; vous pouvez trouver plus de d√©tails dans le code source.  En cons√©quence, nous avons obtenu une application assez rapide et compacte, dans la plupart des validateurs, v√©rificateurs de s√©curit√©, de vitesse, de disponibilit√©, etc., elle montre de bons r√©sultats sans optimisation cibl√©e. <br>  Je voudrais conna√Ætre l'opinion de la communaut√© sur la justification des approches d'organisation des applications utilis√©es dans le prototype, quels pi√®ges pourraient √™tre, que mettriez-vous en ≈ìuvre d'une mani√®re fondamentalement diff√©rente? <br>  Code source, exemples d'instructions d'installation et d√©monstration <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> (veuillez <del>  vandaliser </del>  √† tester dans le cadre du code p√©nal). </p><br><p>  Postscript.  Un peu mercantile en conclusion.  Dites-moi, avec un tel niveau, est-il vraiment possible de commencer √† programmer pour de l'argent?  Sinon, que chercher avant tout, si oui, dites-moi o√π ils recherchent un travail int√©ressant sur une pile similaire maintenant.  Je vous remercie </p><br><p>  Postscript.  Un peu plus sur l'argent et le travail.  Comment aimez-vous cette id√©e: supposons qu'une personne soit pr√™te √† travailler sur un projet int√©ressant pour n'importe quel salaire, cependant, les donn√©es sur les t√¢ches et leur paiement seront disponibles publiquement (la disponibilit√© et un code pour √©valuer la qualit√© des performances sont souhaitables), si le paiement est nettement inf√©rieur au march√©, les concurrents de l'employeur peut offrir beaucoup d'argent pour effectuer ses t√¢ches, s'il est plus √©lev√© - de nombreux artistes pourront offrir leurs services √† un prix inf√©rieur.  Un tel syst√®me, dans certaines situations, √©quilibrera-t-il le march√© (TI) de mani√®re plus optimale et plus √©quitable? </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr435908/">https://habr.com/ru/post/fr435908/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr435898/index.html">√Ä quoi penser lors d'une entrevue NALSD</a></li>
<li><a href="../fr435900/index.html">L'encapsuler</a></li>
<li><a href="../fr435902/index.html">Vous ne pouvez pas simplement prendre et √©crire SELECT si le fournisseur ne le permet pas ... mais nous √©crirons</a></li>
<li><a href="../fr435904/index.html">L'IA a traduit l'activit√© c√©r√©brale en discours</a></li>
<li><a href="../fr435906/index.html">Stockage en cluster de pacemaker + DRBD (double primaire) + ctdb</a></li>
<li><a href="../fr435910/index.html">Pourquoi BSD a-t-il perdu la bataille avec GNU / Linux?</a></li>
<li><a href="../fr435912/index.html">Les principaux probl√®mes de d√©veloppement d'interfaces modernes</a></li>
<li><a href="../fr435914/index.html">Emballage d'applications ASP.NET Core √† l'aide de Docker</a></li>
<li><a href="../fr435916/index.html">Hacking VK, l'authentification √† deux facteurs ne sauvera pas</a></li>
<li><a href="../fr435920/index.html">D√©veloppeur Cookbook: DDD Recipes (Part 4, Structures)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>