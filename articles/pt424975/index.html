<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∞üèæ üë®üèΩ‚Äç‚öñÔ∏è üëâüèª Profundidades do SIEM: correla√ß√µes prontas para uso. Parte 2. Esquema de dados como reflexo do modelo "mundo" üíß ‚ÜóÔ∏è üî∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este √© o segundo artigo da s√©rie, que √© dedicado √† metodologia para criar regras de correla√ß√£o prontas para uso em sistemas SIEM. No artigo anterior ,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profundidades do SIEM: correla√ß√µes prontas para uso. Parte 2. Esquema de dados como reflexo do modelo "mundo"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/424975/">  Este √© o segundo artigo da s√©rie, que √© dedicado √† metodologia para criar regras de correla√ß√£o prontas para uso em sistemas SIEM.  No <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> anterior <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">,</a> nos propusemos a essa tarefa, descrevemos as vantagens que ser√£o obtidas em sua implementa√ß√£o e tamb√©m listamos os principais problemas que est√£o em nosso caminho.  Neste artigo, come√ßaremos a buscar solu√ß√µes e come√ßar com o problema de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">transformar o modelo do ‚Äúmundo‚Äù</a> , bem como sua manifesta√ß√£o no est√°gio de normaliza√ß√£o dos eventos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/th/ty/w_/thtyw_5tngr0v1dhkcakeexhlw8.jpeg" alt="Transforma√ß√£o do modelo SIEM"></div><br><a name="habracut"></a><br>  O problema de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">transformar o modelo do ‚Äúmundo‚Äù</a> foi descrito no primeiro artigo.  Vamos relembrar brevemente sua ess√™ncia: quando um fen√¥meno ocorre na fonte de eventos (por exemplo, iniciando um processo no sistema operacional), ele √© corrigido em diferentes formatos, primeiro na mem√≥ria, depois no log de eventos do sistema operacional e depois no sistema SIEM.  Cada est√°gio do processamento √© acompanhado pela perda de dados, pois no n√≠vel do sistema operacional existe um modelo "mundial" e, no log do sistema operacional, outro, limitado por um conjunto de campos, pelo esquema de log.  Assim, h√° uma reflex√£o (transforma√ß√£o) de um modelo com um grande n√∫mero de par√¢metros para outro, com um n√∫mero menor deles.  Normalizar e salvar um evento no SIEM √© outra transforma√ß√£o que tamb√©m ocorre com a perda de dados, uma vez que o SIEM tamb√©m possui seu pr√≥prio modelo de "mundo". <br><br>  √â dif√≠cil encontrar uma maneira que permita a transforma√ß√£o de um modelo em outro sem perda.  Conhecendo essa limita√ß√£o, √© necess√°rio formular tal abordagem para normaliza√ß√£o e a forma√ß√£o de uma lista de campos do esquema de eventos, nos quais as informa√ß√µes n√£o seriam perdidas, importantes na correla√ß√£o e na investiga√ß√£o adicional de incidentes de seguran√ßa da informa√ß√£o. <br><br>  Dentro da estrutura do SIEM, um modelo √© representado por um esquema - um conjunto de campos nos quais os dados do evento inicial se encaixam no processo de normaliza√ß√£o.  No futuro, ser√° utilizado por especialistas na cria√ß√£o de regras de correla√ß√£o.  Para que os investigadores de incidentes e os respons√°veis ‚Äã‚Äãpelo desenvolvimento de regras de correla√ß√£o interpretem sem ambiguidade os eventos normalizados, o esquema deve satisfazer as propriedades b√°sicas: <br><br><ul><li>  ser unificado para eventos de qualquer tipo e fonte; </li><li>  descreva claramente quem interagiu com quem e como; </li><li>  mantenha a ess√™ncia e o contexto da intera√ß√£o. </li></ul><br>  No processo de desenvolvimento de regras de normaliza√ß√£o, as informa√ß√µes sobre a intera√ß√£o devem ser encontradas no evento inicial e decompostas em campos especialmente designados.  O mesmo precisa ser feito com o contexto e a ess√™ncia da intera√ß√£o (mais sobre isso no pr√≥ximo artigo). <br><br>  Surge a pergunta: √© poss√≠vel identificar esquemas t√≠picos para intera√ß√µes que satisfizessem qualquer evento criado por todas as fontes poss√≠veis de seguran√ßa de TI e informa√ß√µes?  Em caso afirmativo, como s√£o esses esquemas? <br><br>  Para encontrar a resposta para essas perguntas, voc√™ precisa recorrer √† an√°lise e tentar analisar o maior n√∫mero poss√≠vel de regras de normaliza√ß√£o j√° desenvolvidas e operando em solu√ß√µes SIEM para identificar padr√µes comuns.  Como parte desse trabalho, foi poss√≠vel analisar mais de 3.000 regras de normaliza√ß√£o de mais de 100 fontes diferentes de solu√ß√µes como Positive Technologies MaxPatrol SIEM e Micro Focus ArcSight.  A an√°lise resultou nas seguintes conclus√µes: <br><br><ol><li>  Existem esquemas de intera√ß√£o t√≠picos. </li><li>  Em cada evento individual, como regra, h√° informa√ß√µes sobre a intera√ß√£o no <b>n√≠vel da rede</b> e no <b>n√≠vel do aplicativo</b> . </li><li>  Os padr√µes de intera√ß√£o t√≠picos podem variar em diferentes n√≠veis, e isso deve ser levado em considera√ß√£o. </li></ol><br><a name="NetworkAppLevels"></a><br><h1>  Esquemas de comunica√ß√£o da rede e da camada de aplicativos </h1><br>  Descrevemos esquemas t√≠picos para cada n√≠vel.  Antes disso, voc√™ precisa destacar as entidades que est√£o sempre presentes nos eventos.  Al√©m disso, com base neles, ser√£o criados esquemas de intera√ß√£o.  Estes incluem: <br><br><ul><li>  <b>Assunto</b> .  Uma entidade que afeta um objeto.  Por exemplo, um usu√°rio alterando uma chave do Registro ou um host com IP 10.0.0.1, enviando um pacote para um host com IP 20.0.0.1. </li><li>  <b>Objeto</b> .  A entidade afetada pelo Assunto. </li><li>  <b>Fonte</b>  Como regra, um host que registra a intera√ß√£o do Assunto com o Objeto e gera o pr√≥prio evento.  Por exemplo, a Origem ser√° um firewall que registrou a transmiss√£o de pacotes do host - o Assunto com IP 10.0.0.1, para o host - o Objeto com IP 20.0.0.1. </li><li>  <b>Transmissor</b>  H√° casos em que o SIEM recebe eventos n√£o diretamente da fonte, mas de um servidor intermedi√°rio pelo qual esses eventos passam.  O exemplo mais simples √© um servidor syslog intermedi√°rio.  Um exemplo √© mais complicado - quando o Transmissor pode ser um servidor de gerenciamento, por exemplo, o Kaspersky Security Center.  Nesse caso, a Origem √© um agente espec√≠fico do Kaspersky Endpoint Security. </li></ul><br>  No entanto, nem todas as entidades podem ser representadas simultaneamente no evento (mais sobre isso mais adiante), portanto, √© importante entrar inicialmente em contratos, pois nesse caso os campos correspondentes do esquema s√£o preenchidos.  No futuro, isso ajudar√° a distinguir claramente os casos em que esses campos n√£o foram preenchidos devido a um erro de um especialista que est√° desenvolvendo regras de normaliza√ß√£o dos casos em que o evento original realmente n√£o continha dados sobre nenhuma entidade. <br><br>  Vamos seguir para padr√µes de intera√ß√£o e exemplos de eventos.  Para maior clareza, todos os exemplos ser√£o dados com base em logs de arquivos, mensagens syslog ou registros em um banco de dados relacional, mas eles podem ser usados ‚Äã‚Äãpara outros formatos de log, por exemplo, bin√°rios. <br><br><h2>  N√≠vel de rede </h2><br>  O identificador principal para entidades no n√≠vel da rede s√£o os endere√ßos IP.  √â importante entender que pode haver outros identificadores relacionados - endere√ßos MAC no n√≠vel do canal, FQDN - no n√≠vel do aplicativo.  Surge a pergunta: eles est√£o falando sobre a mesma entidade ou diferente?  Esses identificadores podem mudar ao longo do tempo com a mesma entidade?  Um artigo separado ser√° dedicado a isso. Agora, vamos nos concentrar no fato de que o identificador principal dos modelos de intera√ß√£o no n√≠vel da rede √© o endere√ßo IP. <br><br>  Portanto, os esquemas de intera√ß√£o t√≠picos desse n√≠vel podem ser divididos em duas classes - b√°sica e degenerada. <br><br><h3>  Esquemas b√°sicos de intera√ß√£o </h3><br><a name="Schema1"></a><br><img src="https://habrastorage.org/webt/-s/nl/ii/-snliisaaef13_b5_bvrawyycxi.png" height="262"><br>  <i>Esquema 1. Esquema completo de intera√ß√£o</i> <br><br>  Dentro da estrutura deste modelo, no evento recebido na entrada SIEM, todas as principais entidades podem ser distinguidas: Assunto, Objeto, Origem, Transmissor.  No esquema de intera√ß√£o, o Sujeito atua no Objeto.  Esse efeito registra (observa) a Fonte e gera um evento.  O evento da Fonte entra no Transmissor e a partir dele entra no SIEM. <br><br>  O evento abaixo captura a resolu√ß√£o da intera√ß√£o de rede entre hosts pelo firewall da Stonesoft (agora Forcepoint), enquanto o evento em si n√£o entra no SIEM diretamente, mas em um servidor syslog intermedi√°rio. <br><br><img src="https://habrastorage.org/webt/rr/99/hk/rr99hkccik_qrx1gqndn6dub870.png"><br><br>  Aqui: <br>  <b>40.0.0.1</b> - Transmissor (servidor syslog intermedi√°rio), <br>  <b>30.0.0.1</b> - Origem (n√≥ do firewall), <br>  <b>10.0.0.1</b> - Assunto (enviando pacotes UDP), <br>  <b>20.0.0.1</b> - Um objeto (recebendo pacotes UDP). <br><br><img src="https://habrastorage.org/webt/mm/tv/3d/mmtv3d2b7w5gan5mcmxzuvsyyaa.png"><br>  <i>Diagrama 2: Diagrama de coleta direta sem transmissor</i> <br><br>  Nem sempre no esquema de intera√ß√£o √© um transmissor.  Como regra, ele est√° presente quando um servidor intermedi√°rio (por exemplo, um servidor syslog) √© usado para transmitir eventos ou quando a solu√ß√£o da qual os eventos s√£o coletados possui um sistema de gerenciamento centralizado - por exemplo, Kaspersky Security Center, Check Point Smart Console ou Cisco Prime.  Sob esse esquema, os eventos caem no SIEM diretamente da Fonte.  A maioria dos eventos √© descrita por esse esquema espec√≠fico.  A prop√≥sito, um exemplo de um evento desse tipo pode ser visto na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Figura 1</a> , se n√£o houvesse um servidor syslog intermedi√°rio nele e recebemos eventos diretamente do firewall. <br><br><img src="https://habrastorage.org/webt/gu/vp/aw/guvpawlp6njgeswk6dukx9cf5io.png"><br><br>  Aqui: <br>  <b>30.0.0.1</b> - Origem (n√≥ do firewall), <br>  <b>10.0.0.1</b> - Assunto (enviando pacotes UDP), <br>  <b>20.0.0.1</b> - Um objeto (recebendo pacotes UDP). <br><br><img src="https://habrastorage.org/webt/b8/0s/m2/b80sm2hvahlh46ih3ylmb8tut9w.png"><br>  <i>Esquema 3. Intera√ß√£o com muitos objetos</i> <br><br>  Esse esquema de intera√ß√£o no n√≠vel da rede √© bastante raro e, como regra, √© t√≠pico para eventos de equipamentos de rede.  No esquema, um Assunto interage com muitos Objetos, uma intera√ß√£o semelhante est√° presente em eventos que descrevem difus√µes de difus√£o seletiva, unicast ou difus√£o. <br><br>  Observe que, √†s vezes, muitos objetos podem ser unidos por um identificador comum - um endere√ßo de sub-rede ou um endere√ßo de broadcast.  Isso deve ser lembrado, pois ao analisar eventos, inclusive no n√≠vel das regras de correla√ß√£o, voc√™ pode pular facilmente a intera√ß√£o potencialmente importante, pois nesse esquema o endere√ßo do Objeto fica oculto atr√°s do endere√ßo do grupo. <br><br>  O exemplo a seguir demonstra um evento de um servidor de retransmiss√£o IGMP atrav√©s do qual uma solicita√ß√£o de associa√ß√£o multicast √© transmitida. <br><br><img src="https://habrastorage.org/webt/i7/zj/yk/i7zjykhwdwtzkocjqqaexwiiey0.png"><br><br>  Aqui: <br>  <b>30.0.0.1</b> - Origem (servidor de IGMP Relay), <br>  <b>10.0.0.1</b> - Assunto (solicitando participa√ß√£o em um grupo), <br>  <b>224.0.0.252</b> - O objeto (endere√ßo multicast). <br><br><h3>  Esquemas degenerados </h3><br>  Assunto, Objeto e Origem s√£o as entidades b√°sicas no grupo de esquemas b√°sicos de intera√ß√£o.  No entanto, h√° casos em que uma das entidades pode estar ausente no evento. <br><br><img src="https://habrastorage.org/webt/e8/h_/z4/e8h_z4bo7ixafd2vytv7y-gxuqa.png"><br>  <i>Esquema 4. Intera√ß√£o sem um Objeto</i> <br><br>  Frequentemente, esse padr√£o √© t√≠pico em situa√ß√µes nas quais o Sujeito relata uma mudan√ßa em seu estado interno - ou seja, ele atua simultaneamente no papel do Sujeito e do Objeto.  Por exemplo, essa intera√ß√£o pode ser observada em eventos de altera√ß√£o de configura√ß√£o ou detec√ß√£o de malware na esta√ß√£o de trabalho.  Mas essas informa√ß√µes n√£o s√£o registradas pelo pr√≥prio sujeito, mas por um sistema de gerenciamento centralizado e armazenadas em seu di√°rio. <br><br>  O exemplo mostra como o Symantec Management Server captura que o agente do Symantec Endpoint Protection que ele gerencia detectou um arquivo malicioso em seu host. <br><br><img src="https://habrastorage.org/webt/uc/8i/tk/uc8itkdycqecus0f5xb2zhxlbgi.png"><br><br>  Aqui: <br>  <b>30.0.0.1</b> - Origem (Symantec Management Server), <br>  <b>10.0.0.1</b> - Assunto (Symantec Endpoint Protection Agent). <br><br><img src="https://habrastorage.org/webt/qq/wg/ao/qqwgaoqcw7dwndbgulrzbdimunm.png"><br>  <i>Esquema 5. Combinando o papel do Sujeito e do Objeto na Fonte</i> <br><br>  O √∫ltimo esquema de intera√ß√£o degenerada √© t√≠pico para uma situa√ß√£o em que o SIEM recebe eventos de uma Origem relatando uma altera√ß√£o em seu estado interno: por exemplo, reconfigurando um dispositivo ou software, habilitando ou desabilitando uma porta de rede.  Nesse esquema, o papel da Fonte coincide com o papel do Sujeito e do Objeto.  Ao contr√°rio do esquema anterior, aqui os eventos no SIEM v√™m diretamente. <br><br>  Neste exemplo, um switch baseado no Cisco IOS informa que sua interface foi transferida para o status UP. <br><br><img src="https://habrastorage.org/webt/in/ap/cd/inapcd3rbeuutgbgivcfmt-ujmq.png"><br><br>  Aqui <b>30.0.0.1</b> √© a fonte (switch). <br><br><h2>  N√≠vel de aplica√ß√£o </h2><br>  Nesse n√≠vel, h√° intera√ß√µes de entidades j√° conhecidas: Assunto, Objeto.  No entanto, todas as informa√ß√µes sobre a fonte e o transmissor permanecem diretamente no n√≠vel da rede e n√£o s√£o refletidas no n√≠vel do aplicativo. <br><br>  A maioria de todos os tipos de eventos incorpora intera√ß√µes simultaneamente no n√≠vel da rede e no n√≠vel do aplicativo.  No entanto, observamos que os eventos gerados diretamente pelo software aplicativo, por exemplo, 1C: Enterprise, Microsoft SQL Server ou Oracle Database, podem conter exclusivamente intera√ß√µes no n√≠vel do aplicativo. <br><br>  Al√©m disso, uma entidade de <b>Recurso</b> adicional aparece no n√≠vel do aplicativo. <br><br>  <b>Um recurso</b> √© uma entidade intermedi√°ria atrav√©s da qual o Assunto exerce influ√™ncia sobre o Objeto sem intera√ß√£o direta.  Por exemplo, concedendo a Alex os direitos de acessar o MyFile para Bob.  Aqui Alex √© o Assunto, Bob √© o Objeto, MyFile √© o Recurso.  Observe que, neste exemplo, Alex n√£o interage diretamente com Bob. <br><br>  <i>Importante</i> : os eventos no n√≠vel do aplicativo podem conter par√¢metros adicionais do Assunto e do Objeto, al√©m do pr√≥prio Recurso.  Por exemplo, par√¢metros adicionais de um Recurso, como um "arquivo", podem ser o diret√≥rio em que ele est√° localizado ou seu tamanho. <br>  Nesse caso, o Assunto, Objeto e Recurso s√£o identificados por nome ou identificador exclusivo: endere√ßo de email, nome do arquivo, nome do diret√≥rio, nome da tabela no banco de dados. <br><br>  Considere padr√µes de intera√ß√£o adicionais espec√≠ficos para a camada do aplicativo. <br><br><img src="https://habrastorage.org/webt/tg/lk/rm/tglkrmwarm0l4og50f0igcsgwhm.png"><br>  <i>Figura 6. Intera√ß√£o de recursos</i> <br><br>  Neste diagrama, o Assunto atua indiretamente no Objeto atrav√©s de um Recurso intermedi√°rio.  Como regra, os eventos com esse esquema s√£o claramente vis√≠veis nos logs de auditoria do banco de dados ou ao trabalhar com direitos de acesso a arquivos e diret√≥rios no n√≠vel do SO. <br><br>  O exemplo mostra uma entrada do banco de dados de auditoria do banco de dados Oracle.  Ele corrige o processo de revogar uma fun√ß√£o de um usu√°rio. <br><br><img src="https://habrastorage.org/webt/fc/fe/l3/fcfel3yxldwmxgxkj8mnp_3uf8k.png"><br><br>  Aqui: <br>  <b>"ALEX"</b> - Assunto (nome de usu√°rio que retira a fun√ß√£o), <br>  <b>"BOB"</b> - Objeto (nome do usu√°rio que est√° sendo revogado), <br>  <b>"ROLE"</b> - Recurso (nome da fun√ß√£o revogada). <br><br><img src="https://habrastorage.org/webt/3m/kt/93/3mkt93zoast_9sgow61s6yiaou8.png"><br>  <i>Diagrama 7. Intera√ß√£o com muitos recursos</i> <br><br>  No n√≠vel do aplicativo, bem como no n√≠vel da rede, existem tipos de eventos nos quais o Assunto interage com o Objeto imediatamente por meio de muitos Recursos.  √â muito raro, mas h√° momentos em que o n√∫mero de objetos tamb√©m √© mais do que um.  Esses tipos de eventos aparecem ao corrigir opera√ß√µes em massa.  Por exemplo, concedendo acesso a v√°rios arquivos a um usu√°rio ou alterando o conjunto de regras inclu√≠das na pol√≠tica. <br><br>  No exemplo, a solu√ß√£o para proteger ambientes virtuais o vGate Security Code captura a adi√ß√£o de novas pol√≠ticas ao conjunto. <br><br><img src="https://habrastorage.org/webt/jp/hn/il/jphnilptae5cmxk3by0plhdjnno.png"><br><br>  Aqui: <br>  <b>"Admin @ VGATE"</b> - Assunto (nome do usu√°rio que altera o conjunto de pol√≠ticas) <br>  <b>"Base"</b> - Objeto (conjunto de pol√≠ticas) <br>  <b>‚ÄúInstalando e mantendo a integridade do sistema de arquivos‚Äù, ‚ÄúVerificando as configura√ß√µes do agente SNMP‚Äù, ‚ÄúDesativando a instala√ß√£o autom√°tica do VMware Tools‚Äù</b> - Recursos (nomes de pol√≠ticas adicionadas) <br><a name="ChannelModel"></a><br><h1>  O modelo do canal de intera√ß√£o entre o Sujeito e o Objeto </h1><br>  Em todos os esquemas, distinguimos diferentes entidades (sujeitos, objetos, recursos, fontes, transmissores) e observamos o chamado canal de intera√ß√£o entre eles.  Vamos nos aprofundar mais no pen√∫ltimo componente do grande modelo do ‚Äúmundo‚Äù com o qual o SIEM deve operar - nos modelos do canal de intera√ß√£o entre o Sujeito e o Objeto.  Lembre-se de que o √∫ltimo componente √© o contexto da intera√ß√£o (o pr√≥ximo artigo ser√° dedicado a isso). <br><br>  Portanto, existem duas entidades interagindo entre si.  Como parte dessa intera√ß√£o, os dados s√£o transferidos de uma entidade para outra.  Podem ser pacotes de rede com dados, arquivos ou comandos de gerenciamento.  Nesse caso, o canal formado pode ser representado na forma de um "tubo" ao longo do qual existe um fluxo direcionado de dados e comandos.  Esse modelo √© claramente vis√≠vel no n√≠vel da rede, mas menos pronunciado no n√≠vel do aplicativo (veja o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">exemplo</a> ). <br><br><img src="https://habrastorage.org/webt/pi/3i/hl/pi3ihljaztjgnfszntwesq3s5k8.png"><br>  <i>Modelo de canal de dados</i> <br><br>  Com base nesse modelo, cada evento que o SIEM recebe pode conter informa√ß√µes que descrevem: <br><br><ul><li>  Os par√¢metros do canal em si s√£o o "pipe", </li><li>  Os dados transmitidos atrav√©s deste "tubo". </li></ul><br>  Normalmente, um canal √© descrito por par√¢metros como identificador de sess√£o, protocolo de transfer√™ncia de dados, tempo de estabelecimento do canal, tempo de conclus√£o, dura√ß√£o.  Os dados nos eventos s√£o caracterizados pelo formato usado pelos algoritmos de criptografia, pelo n√∫mero de pacotes transmitidos, pelo n√∫mero de bytes transmitidos. <br><br>  Considere um exemplo de um evento que cont√©m dados sobre o canal de intera√ß√£o.  Aqui est√° um evento do Cisco Identity Services Engine (ISE), um sistema de gerenciamento de processos para identificar e controlar o acesso, que registra a sess√£o de rede de um usu√°rio como parte do procedimento de contabilidade (contabilidade). <br><br><a name="ComplexExample"></a><br><img src="https://habrastorage.org/webt/op/qr/qt/opqrqtfyo0do7ybijdpx7gm_va4.png"><br><br>  Aqui: <br>  <b>‚ÄúAcct-Session-Id = 1A346216‚Äù, ‚ÄúAcct-Session-Time = 50‚Äù, ‚ÄúService-Type = Framed‚Äù, ‚ÄúFramed-Protocol = PPP‚Äù</b> - par√¢metros do canal de comunica√ß√£o, <br>  <b>‚ÄúAcct-Input-Octets = 43525‚Äù, ‚ÄúAcct-Output-Octets = 122215‚Äù, ‚ÄúAcct-Input-Packets = 234‚Äù, ‚ÄúAcct-Output-Packets = 466‚Äù</b> - par√¢metros dos dados transmitidos pelo canal. <br><br><h1>  Um exemplo de modelos de intera√ß√£o de entidades e o canal em um evento </h1><br>  Assim, examinamos os esquemas de intera√ß√£o dos n√≠veis e aplicativos da rede, bem como o modelo do canal de intera√ß√£o.  A seguir, mostramos um exemplo de como, em um evento, os esquemas de intera√ß√£o de diferentes n√≠veis s√£o combinados e as informa√ß√µes sobre o modelo de canal s√£o usadas. <br><br>  Aqui vemos um evento do firewall - o Cisco Adaptive Security Appliance (ASA), no qual uma conex√£o TCP de sa√≠da √© corrigida. <br><br><img src="https://habrastorage.org/webt/ls/ra/i5/lsrai5eqgcgrydjiwanqr4hhfde.png"><br><br>  O exemplo mostra claramente que, em um evento, existem entidades do n√≠vel da rede e do n√≠vel do aplicativo.  No n√≠vel da rede, um esquema de intera√ß√£o entre o Assunto e o Objeto, que √© fixado pela Fonte.  N√£o h√° transmissor. <br><br>  Aqui: <br>  <b>30.0.0.1</b> - Fonte (Cisco ASA), <br>  <b>10.0.0.1</b> - Assunto (o endere√ßo de quem se conecta), <br>  <b>20.0.0.1</b> - Um objeto (o endere√ßo daquele a quem eles se conectam). <br><br>  No n√≠vel da aplica√ß√£o, um esquema simples no qual apenas o Assunto e o Objeto est√£o presentes: <br>  <b>"ALEX"</b> - Assunto (nome de usu√°rio que se conecta), <br>  <b>"BOB"</b> - O objeto (o nome do usu√°rio ao qual eles se conectam). <br><br>  Tamb√©m neste evento, h√° uma descri√ß√£o do canal de dados, mas n√£o h√° descri√ß√£o dos pr√≥prios dados: <br>  <b>"TCP"</b> √© o protocolo com base no qual o canal foi criado, <br>  <b>"136247"</b> √© o identificador da sess√£o do canal. <br><br><h1>  Conclus√µes </h1><br>  Como os esquemas t√≠picos de intera√ß√£o destacados por n√≥s podem ajudar? <br><br><ul><li>  <b>Primeiro</b> , ao escrever regras de correla√ß√£o e analisar eventos, um especialista deve entender quais entidades est√£o presentes em cada evento que chega ao SIEM.  Para isso, √© necess√°rio, no est√°gio de normaliza√ß√£o dos eventos, distinguir claramente as entidades: Assunto, Objeto, Recurso, Fonte e Transmissor. </li><li>  <b>Em segundo lugar</b> , durante a normaliza√ß√£o, √© importante levar em considera√ß√£o que o evento cont√©m informa√ß√µes sobre a intera√ß√£o do n√≠vel da rede e do n√≠vel do aplicativo.  Ambas as intera√ß√µes podem estar presentes simultaneamente em um evento. </li><li>  <b>Em terceiro lugar</b> , a intera√ß√£o em si √© uma estrutura composta na qual h√° informa√ß√µes sobre o canal formado e sobre os dados transmitidos por esse canal. </li></ul><br>  Assim, o modelo do ‚Äúmundo‚Äù, constru√≠do no SIEM e representado por um conjunto de campos (um esquema), deve conter se√ß√µes para descrever: <br><br><ol><li>  <b>No n√≠vel da rede</b> : <br><ul><li>  Assunto; </li><li>  O objeto; </li><li>  Fonte; </li><li>  Transmissor </li><li>  Canal de intera√ß√£o; </li><li>  Dados transmitidos pelo canal. </li></ul><br></li><li>  <b>No n√≠vel do aplicativo</b> : <br><ul><li>  Assunto; </li><li>  Um objeto ou uma pluralidade de objetos; </li><li>  Um recurso ou v√°rios recursos. </li></ul><br></li></ol><br>  Para cada entidade, √© necess√°rio definir um conjunto de propriedades que a identifiquem exclusivamente.  No n√≠vel da rede, as entidades s√£o identificadas por IP, MAC ou FQDN.  No n√≠vel do aplicativo, por nome ou ID.  O esquema deve ter campos dedicados para armazenar esses identificadores. <br><br>  Existem esquemas de intera√ß√£o degenerados nos quais uma entidade pode combinar v√°rias fun√ß√µes ao mesmo tempo.  Ao normalizar esses eventos, √© necess√°rio definir explicitamente a regra para preencher todos os campos do esquema que s√£o respons√°veis ‚Äã‚Äãpor todo o conjunto de entidades.  No futuro, isso ajudar√° as regras de correla√ß√£o a n√£o perder parte das intera√ß√µes. <br><br>  Vamos explicar: tomemos o caso de combinar o papel do Sujeito e o Objeto na Fonte.        ,   ,   ,           ,      . <br><br>       ,          .      ,   . <br><br>    ,      ,  : <br><br><img src="https://habrastorage.org/webt/zo/dp/if/zodpiffknu6hbuk7e0rqpqg4h7q.png"><br> <i> ,   </i> <br><br>   ‚Äî    ¬´¬ª SIEM     ,     .  ,   ,   Alex        , ‚Äî  ,      , , .         ,       . , -     ,      ,    SIEM    . <br><br>        ,        ,    .          ,      ,     . <br><br><hr><br> <b> :</b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> SIEM:  ¬´ ¬ª.  1:     ?</a> <br><br>  SIEM:  ¬´ ¬ª.  2.      ¬´¬ª ( <i> </i> ) <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> SIEM:  ¬´ ¬ª.  3.1.  </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> SIEM:  ¬´ ¬ª.  3.2.   </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> SIEM:  ¬´ ¬ª.  4.      </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> SIEM:  ¬´ ¬ª.  5.    </a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt424975/">https://habr.com/ru/post/pt424975/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt424965/index.html">Reagir o desenvolvimento de aplicativos usando ReasonReact</a></li>
<li><a href="../pt424967/index.html">Atalhos de JavaScript para iniciantes</a></li>
<li><a href="../pt424969/index.html">Guia Node.js, parte 9: Trabalhando com o sistema de arquivos</a></li>
<li><a href="../pt424971/index.html">Habrokast "P√¥r do sol manualmente" # 1. Tentando configurar um ambiente para desenvolver um brinquedo para Windows</a></li>
<li><a href="../pt424973/index.html">Detec√ß√£o de rosto em v√≠deo: Raspberry Pi e Neural Compute Stick</a></li>
<li><a href="../pt424977/index.html">Aprendendo com os erros: otimizando aplicativos na App Store e no Google Play</a></li>
<li><a href="../pt424979/index.html">Elm. Confort√°vel e estranho. Http, Tarefa</a></li>
<li><a href="../pt424981/index.html">Ovo de P√°scoa RPG de texto no Google Search Engine Code</a></li>
<li><a href="../pt424985/index.html">Em um importante precedente judicial, as ag√™ncias de intelig√™ncia dos EUA n√£o foram capazes de escutar chamadas telef√¥nicas no messenger</a></li>
<li><a href="../pt424987/index.html">Recupere imagens borradas e desfocadas usando o filtro Wiener. Implementa√ß√£o em C ++ OpenCV</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>