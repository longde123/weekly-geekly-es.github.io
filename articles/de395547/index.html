<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛐 🍙 🔷 Mehrere kritische Sicherheitslücken in Symantec / Norton Antivirus 🙅🏻 🧗🏿 🧒🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Für alle Versionen von Antivirenprogrammen wurde ein funktionierender Exploit veröffentlicht. Die Tatsache, Code unter der GPL auszuleihen, wird aufge...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mehrere kritische Sicherheitslücken in Symantec / Norton Antivirus</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/395547/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Für alle Versionen von Antivirenprogrammen wurde ein funktionierender Exploit veröffentlicht. </font><font style="vertical-align: inherit;">Die Tatsache, Code unter der GPL auszuleihen, wird aufgedeckt</font></font></h3><br>
<img src="https://habrastorage.org/files/bf8/e9c/a2b/bf8e9ca2bd75423b977548077c4710b8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gestern hat Tavis Ormandy vom Project Zero-Hacker bei Google </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">offenen Zugriff</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf zahlreiche Sicherheitslücken in Symantec-Antivirenprogrammen veröffentlicht, einschließlich Sicherheitslücken bei der Remotecodeausführung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einige Experten sagen, dass das auf dem Computer installierte Antivirenprogramm aufgrund seiner maximalen Berechtigungsstufe im System zu einem zusätzlichen Angriffsvektor werden kann, dh zu einer zusätzlichen Verletzung der Gesamtsicherheit des Systems. Das Symantec-Beispiel zeigt dies so deutlich wie möglich. In einigen Fällen wird unter Windows schädlicher Code direkt in den Kernel des Betriebssystems geladen, was zu einer Beschädigung des Kernelspeichers führt.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Symantec-Programme verwenden denselben Kernel, sodass die beschriebenen Methoden für alle Symantec-Programme funktionieren, einschließlich der unter der Marke Norton vertriebenen Virenschutzprogramme. </font><font style="vertical-align: inherit;">Unter ihnen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Norton Security, Norton 360 und andere ältere Norton-Produkte (alle Plattformen)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Endpoint Protection (alle Versionen, alle Plattformen)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Email Security (alle Plattformen)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Protection Engine (alle Plattformen)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Protection für SharePoint Server</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und andere</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tavis Ormandy von Project Zero hat Beispiele für einige Sicherheitslücken vorgestellt, damit jeder die Essenz des Problems verstehen kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Fall von Virenschutzprogrammen besteht das Problem darin, wie sie ausführbare Dateien scannen, die von Packern wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPX gepackt wurden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Zum Scannen solcher Dateien verwenden Virenschutzprogramme spezielle Dateientpacker, um die Datei in ihre ursprüngliche Form zurückzusetzen. Dies hilft bei Standardpackern, aber für den Rest müssen Sie auf die Emulation zurückgreifen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tavis Ormandy schreibt, dass all diese Methoden unnötig komplex und äußerst anfällig sind, da es sehr schwierig ist, solchen Code sicher zu machen. „Wir empfehlen die Verwendung der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sandbox</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Security Development Lifecycle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aber Anbieter schneiden hier oft ab “, schreibt Thevis. </font><font style="vertical-align: inherit;">Aus diesem Grund werden Entpacker zu einer großen Quelle von Sicherheitslücken, wie dies bereits bei </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comodo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kaspersky</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fireeye</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vielen anderen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der Fall war </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Fall von Symantec ist die Situation noch schlimmer, da in seinen Programmen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entpacker im Kernel arbeiten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispielsweise ermöglicht der Entpacker für </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASPack</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> einen geringfügigen Pufferüberlauf, wenn der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SizeOfRawData-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wert </font><font style="vertical-align: inherit;">größer als </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SizeOfImage ist</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In diesem Fall überträgt Symantec die "zusätzlichen" Bytes mithilfe von in den Puffer</font></font><code>memcpy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dementsprechend können wir mit dieser Methode leicht beliebigen Code zur Ausführung auf Kernelebene ausführen:</font></font><br>
<br>
<pre><code class="hljs lisp">    char *buf = malloc(<span class="hljs-name"><span class="hljs-name">SizeOfImage</span></span>)<span class="hljs-comment"><span class="hljs-comment">;</span></span><font></font>
<font></font>
    memcpy(<span class="hljs-name"><span class="hljs-name">&amp;buf</span></span>[DataSection-&gt;VirtualAddress],<font></font>
           DataSection-&gt;PointerToRawData,<font></font>
           SectionSizeOnDisk)<span class="hljs-comment"><span class="hljs-comment">;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Sicherheitsanfälligkeit CVE-2016-2208 wird im </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bug-Tracker</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ausführlicher beschrieben </font><font style="vertical-align: inherit;">. Unter Linux-, MacOS- und Unix-Betriebssystemen führt dies zu einem sauberen Überlauf auf Stammebene im Symantec- oder Norton-Prozess und unter Windows zu einer Beschädigung des Kernelspeichers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da Symantec einen speziellen Treiber verwendet, um alle Systeminterrupts abzufangen und die Sicherheitsanfälligkeit auszunutzen, senden Sie dem Opfer einfach eine Datei per E-Mail oder einen Link zum Exploit. Das Opfer muss die Datei nicht öffnen oder dem Link folgen, das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antivirenprogramm</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erledigt </font><b><font style="vertical-align: inherit;">alles selbstständig</font></b><font style="vertical-align: inherit;"> . Dadurch kann sich der Wurm mit dem installierten Symantec / Norton-Antivirenprogramm automatisch auf alle Systeme ausbreiten!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf diese Weise können Sie problemlos eine große Anzahl von Computern im lokalen Netzwerk des Unternehmens infizieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist merkwürdig, dass Tavis Ormandy vor der Veröffentlichung der Informationen in der Öffentlichkeit einen Exploit per E-Mail in einem passwortgeschützten Zip-Archiv an die Sicherheitsabteilung gesendet hat und das Passwort im Text des Briefes angegeben wurde. Der Mailserver mit den installierten „Sicherheitsfunktionen“ Symantec extrahierte das Kennwort aus dem Nachrichtentext, wandte es auf das Archiv an und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stürzte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beim Studium des Exploit-Codes selbst ab </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tavis Ormandy spricht auch über Schwachstellen beim Parsen von PowerPoint-Dateien und anderen Microsoft Office-Dateien sowie über Schwachstellen in der heuristischen Engine Bloodhound Heuristics (Advanced Heuristic Protection). Exploit-Quellcode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">veröffentlicht</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dies ist ein zu 100% funktionierender Exploit, der gegen die Standardkonfigurationen von Norton Antivirus und Symantec Endpoint funktioniert und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> funktioniert, </font><b><font style="vertical-align: inherit;">wenn Sie den Link per E-Mail senden oder auf einer Webseite veröffentlichen</font></b><font style="vertical-align: inherit;"> (er muss nicht geöffnet werden). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall sind die folgenden Produkte anfällig (nicht alle potenziell anfälligen Symantec-Programme sind hier aufgelistet, es ist durchaus möglich, dass der Exploit auch in anderen funktioniert):</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Norton Antivirus (Mac, Windows)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Endpoint (Mac, Windows, Linux, Unix)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Scan Engine (alle Plattformen)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Cloud / NAS Protection Engine (alle Plattformen)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Email Security (alle Plattformen)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Protection für SharePoint / Exchange / Notes / etc (alle Plattformen)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alle anderen Symantec / Norton Carrier-, Enterprise-, SMB-, Home- und andere Antivirenprogramme</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und andere</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unter Windows führt dies zur Ausführung von Code auf SYSTEM-Ebene in anderen Betriebssystemen mit Root-Rechten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einige Programme von Symantec werden nicht automatisch aktualisiert, daher müssen Systemadministratoren dringend Maßnahmen ergreifen, um ihre Netzwerke zu schützen. </font><font style="vertical-align: inherit;">Offizielle Informationen von Symantec finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD </font><font style="vertical-align: inherit;">Wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sich herausstellte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hat Symantec Code aus den Open-Source-Bibliotheken libmspack und unrarsrc ausgeliehen - und ihn mindestens sieben Jahre lang nicht aktualisiert!</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de395547/">https://habr.com/ru/post/de395547/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de395535/index.html">Welcher der Absolventen soll gut leben?</a></li>
<li><a href="../de395537/index.html">Markiere es</a></li>
<li><a href="../de395541/index.html">Ein Raumanzug für die Landung auf Europa und dem Mond - was soll es sein? Interview mit dem Lead Final Frontier Design Designer</a></li>
<li><a href="../de395543/index.html">Russland schafft eine offene Basis erdnaher Objekte</a></li>
<li><a href="../de395545/index.html">Novgorod-Archäologen entdeckten einen unbekannten altrussischen Fluch</a></li>
<li><a href="../de395549/index.html">Stimmt es, dass die Menschheit dumm wird?</a></li>
<li><a href="../de395551/index.html">Blockchain - Neues Google</a></li>
<li><a href="../de395555/index.html">Viv ist eine neue Ära persönlicher Assistenten. Interview mit Doug Kittlaus, dem Schöpfer von Siri</a></li>
<li><a href="../de395557/index.html"># 2 Video Slider Control Unit</a></li>
<li><a href="../de395559/index.html">Flug Moskau-Meer der Klarheit ist verspätet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>