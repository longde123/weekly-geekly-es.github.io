<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👂🏽 🔥 ⁉️ Abhängigkeitsinjektions-, JavaScript- und ES6-Module 😷 ⛑️ 🔂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eine weitere Implementierung von Dependency Injection in JavaScript sind ES6-Module mit der Möglichkeit, denselben Code in einem Browser und in nodejs...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Abhängigkeitsinjektions-, JavaScript- und ES6-Module</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464347/"><p>  Eine weitere Implementierung von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dependency Injection in JavaScript</a> sind ES6-Module mit der Möglichkeit, denselben Code in einem Browser und in nodejs zu verwenden und keine Transpiler zu verwenden. </p><br><p><img src="https://habrastorage.org/webt/cm/yd/it/cmyditgokfobpp0llt2opzsflts.jpeg" alt="Bild"></p><br><p>  Unter dem Strich ist meine Sicht auf DI, seinen Platz in modernen Webanwendungen, die grundlegende Implementierung eines DI-Containers, mit dem Objekte sowohl vorne als auch hinten erstellt werden können, sowie eine Erklärung, was Michael Jackson damit zu tun hat. </p><a name="habracut"></a><br><p>  Ich bitte diejenigen, die es in dem Artikel trivial finden, nicht, sich selbst zu vergewaltigen und nicht bis zum Ende zu lesen, damit sie später, wenn sie enttäuscht sind, kein "Minus" setzen.  Ich bin nicht gegen die "Minuspunkte" - aber nur wenn das Minus von einem Kommentar begleitet wird, was genau in der Publikation eine negative Reaktion hervorrief.  Dies ist ein technischer Artikel. Versuchen Sie also, sich dem Präsentationsstil herablassen zu können, und kritisieren Sie genau die technische Komponente des oben genannten.  Vielen Dank. </p><br><h1 id="obekty-v-prilozhenii">  Objekte in der Anwendung </h1><br><p>  Ich respektiere die funktionale Programmierung sehr, aber ich habe den größten Teil meiner beruflichen Tätigkeit der Erstellung von Anwendungen gewidmet, die aus Objekten bestehen.  JavaScript beeindruckt mich dadurch, dass die darin enthaltenen Funktionen auch Objekte sind.  Beim Erstellen von Anwendungen denke ich an Objekte, dies ist meine berufliche Verformung. </p><br><p>  Je nach Lebensdauer können Objekte in der Anwendung in die folgenden Kategorien unterteilt werden: </p><br><ul><li>  <strong>dauerhaft</strong> - entstehen zu einem bestimmten Zeitpunkt des Antrags und werden erst nach Abschluss des Antrags vernichtet; </li><li>  <strong>vorübergehend</strong> - entstehen, wenn eine Operation ausgeführt werden muss, und werden zerstört, wenn diese Operation abgeschlossen ist; </li></ul><br><p>  In dieser Hinsicht gibt es bei der Programmierung solche Entwurfsmuster wie: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Singleton</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">abstrakte Fabrik</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Baumeister</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pool</a> , ... </li></ul><br><p>  Das heißt, aus meiner Sicht besteht die Anwendung aus permanent vorhandenen Einzelgängern, die entweder die erforderlichen Operationen selbst ausführen oder temporäre Objekte generieren, um sie auszuführen. </p><br><h1 id="konteyner-obektov">  Objektcontainer </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Abhängigkeitsinjektion</a> ist ein Ansatz, mit dem Objekte in einer Anwendung einfach erstellt werden können.  Das heißt, in der Anwendung gibt es ein spezielles Objekt, das „weiß“, wie alle anderen Objekte erstellt werden.  Ein solches Objekt wird als Objektcontainer (manchmal als Objektmanager) bezeichnet. </p><br><p>  Der Objektcontainer ist kein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">göttliches Objekt</a> , weil  Ihre Aufgabe besteht nur darin, wichtige Objekte der Anwendung zu erstellen und ihnen Zugriff auf andere Objekte zu gewähren.  Die überwiegende Mehrheit der Anwendungsobjekte, die vom Container generiert werden und sich darin befinden, hat keine Ahnung vom Container selbst.  Sie können in jeder anderen Umgebung platziert werden, die mit den erforderlichen Abhängigkeiten ausgestattet ist, und sie funktionieren dort auch bemerkenswert gut (Tester wissen, was ich meine). </p><br><h1 id="mesto-vnedreniya">  Ort der Umsetzung </h1><br><p>  Im Großen und Ganzen gibt es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zwei Möglichkeiten</a> , Abhängigkeiten in ein Objekt einzufügen: </p><br><ul><li>  durch den Konstruktor; </li><li>  durch eine Eigenschaft (oder ihren Zugang); </li></ul><br><p>  Ich habe im Grunde den ersten Ansatz verwendet, daher werde ich die Beschreibung unter dem Gesichtspunkt der Abhängigkeitsinjektion durch den Konstruktor fortsetzen. </p><br><p>  Angenommen, wir haben eine Anwendung, die aus drei Objekten besteht: </p><br><p><img src="https://habrastorage.org/webt/lv/5n/w4/lv5nw4nv1bperu7mgoxtn4luss4.png" alt="Bild"></p><br><p>  In PHP (diese Sprache mit langjährigen DI-Traditionen, ich habe derzeit aktives Gepäck, ich werde etwas später zu JS übergehen) könnte sich eine ähnliche Situation folgendermaßen widerspiegeln: </p><br><pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Config</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $config; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Config $config)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;config = $config; } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $config; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $service; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Config $config, Service $service)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;config = $config; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;service = $service; } }</code> </pre> <br><p>  Diese Informationen sollten ausreichen, damit ein DI-Container (z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Liga / Container</a> ) bei entsprechender Konfiguration auf Anforderung zum Erstellen eines <code>Application</code> dessen Abhängigkeiten <code>Service</code> und <code>Config</code> erstellen und diese Parameter an den Konstruktor des <code>Application</code> kann. </p><br><h1 id="identifikatory-zavisimostey">  Abhängigkeitskennungen </h1><br><p>  Wie versteht der Objektcontainer, dass der Konstruktor des <code>Application</code> zwei <code>Config</code> und <code>Config</code> benötigt?  Durch Analyse des Objekts über die Reflection-API ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Java</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PHP</a> ) oder durch direkte Analyse des Objektcodes (Code-Annotationen).  Das heißt, im allgemeinen Fall können wir die Namen der Variablen bestimmen, die der Objektkonstruktor an der Eingabe erwartet, und wenn die Sprache typisierbar ist, können wir auch die Typen dieser Variablen abrufen. </p><br><p>  Somit kann der Container als Bezeichner von Objekten entweder mit den Namen der Eingabeparameter des Konstruktors oder mit den Arten von Eingabeparametern arbeiten. </p><br><h1 id="sozdanie-obektov">  Objekte erstellen </h1><br><p>  Das Objekt kann vom Programmierer explizit erstellt und im Container unter der entsprechenden Kennung abgelegt werden (z. B. "Konfiguration"). </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \League\Container\Container $container */</span></span> $container-&gt;add(<span class="hljs-string"><span class="hljs-string">"configuration"</span></span>, $config);</code> </pre> <br><p>  und kann vom Container nach bestimmten Regeln erstellt werden.  Diese Regeln bestehen im Großen und Ganzen darin, die Kennung des Objekts mit seinem Code abzugleichen.  Regeln können explizit festgelegt werden (Zuordnung in Form von Code, XML, JSON, ...) </p><br><pre> <code class="json hljs">[ [<span class="hljs-string"><span class="hljs-string">"object_id_1"</span></span>, <span class="hljs-string"><span class="hljs-string">"/path/to/source1.php"</span></span>], [<span class="hljs-string"><span class="hljs-string">"object_id_2"</span></span>, <span class="hljs-string"><span class="hljs-string">"/path/to/source2.php"</span></span>], ... ]</code> </pre> <br><p>  oder in Form eines Algorithmus: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id)</span></span></span><span class="hljs-function"> </span></span>{. <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/path/to/source/${id}.php"</span></span>; }</code> </pre> <br><p>  In PHP sind die Regeln für den Abgleich eines Klassennamens mit einer Datei mit ihrem Quellcode standardisiert ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PSR-4</a> ). In Java erfolgt der Abgleich auf der JVM-Konfigurationsebene ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Class Loader</a> ).  Wenn der Container beim Erstellen von Objekten eine automatische Suche nach Quellen bietet, sind die Klassennamen ausreichend für Bezeichner in einem solchen Container. </p><br><h1 id="namespaces">  Namespaces </h1><br><p>  In der Regel werden in einem Projekt neben dem eigenen Code auch Module von Drittanbietern verwendet.  Mit dem Aufkommen von Abhängigkeitsmanagern (Maven, Composer, npm) wurde die Verwendung von Modulen erheblich vereinfacht und die Anzahl der Module in Projekten hat stark zugenommen.  Mit Namespaces können gleichnamige Codeelemente in einem einzelnen Projekt aus verschiedenen Modulen (Klassen, Funktionen, Konstanten) vorhanden sein. </p><br><p>  Es gibt Sprachen, in denen der Namespace anfänglich eingebaut ist (Java): </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> vendor.project.<span class="hljs-keyword"><span class="hljs-keyword">module</span></span>.folder;</code> </pre> <br><p>  Es gibt Sprachen, in denen der Namespace während der Entwicklung der Sprache (PHP) hinzugefügt wurde: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Vendor</span></span>\<span class="hljs-title"><span class="hljs-title">Project</span></span>\<span class="hljs-title"><span class="hljs-title">Module</span></span>\<span class="hljs-title"><span class="hljs-title">Folder</span></span>;</code> </pre> <br><p>  Mit einer guten Namespace-Implementierung können Sie jedes Element des Codes eindeutig ansprechen: </p><br><pre> <code class="php hljs">\Doctrine\Common\Annotations\Annotation\Attribute::$name</code> </pre> <br><p>  Der Namespace löst das Problem der Organisation vieler Softwareelemente in einem Projekt, und die Dateistruktur löst das Problem der Organisation von Dateien auf der Festplatte.  Daher gibt es nicht nur viele Gemeinsamkeiten und manchmal auch viele Gemeinsamkeiten. In Java muss beispielsweise eine öffentliche Klasse im Namespace eindeutig an eine Datei mit dem Code dieser Klasse angehängt werden. </p><br><p>  Die Verwendung des Bezeichners einer Objektklasse im Projektnamespace als Objektbezeichner im Container ist daher eine gute Idee und kann als Grundlage für die Erstellung von Regeln für die automatische Erkennung von Quellcodes beim Erstellen des gewünschten Objekts dienen. </p><br><pre> <code class="php hljs">$container-&gt;add(\Vendor\Project\Module\ObjectType::class, $obj);</code> </pre> <br><h1 id="avtozagruzka-koda">  Code-Start </h1><br><p>  In PHP <code>composer</code> Modul-Namespace im Moduldeskriptor <code>composer</code> dem Dateisystem innerhalb des Moduls zugeordnet: </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"autoload"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"psr-4"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Doctrine\\Common\\Annotations\\"</span></span>: <span class="hljs-string"><span class="hljs-string">"lib/Doctrine/Common/Annotations"</span></span> } }</code> </pre> <br><p>  Die JS-Community könnte eine ähnliche Zuordnung in <code>package.json</code> wenn in JS Namespaces <code>package.json</code> wären. </p><br><h1 id="identifikatory-zavisimostey-v-js">  JS-Abhängigkeitskennungen </h1><br><p>  Oben habe ich angegeben, dass der Container entweder die Namen der Eingabeparameter des Konstruktors oder die Arten von Eingabeparametern als Bezeichner verwenden kann.  Das Problem ist, dass: </p><br><ol><li>  JS ist eine Sprache mit dynamischer Typisierung und bietet keine Angabe von Typen beim Deklarieren einer Funktion. </li><li>  JS verwendet Minifizierer, die Eingabeparameter umbenennen können. </li></ol><br><p>  Die Entwickler des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">awilix</a> DI-Containers schlagen vor, das Objekt als einzigen Eingabeparameter für den Konstruktor und die Eigenschaften dieses Objekts als Abhängigkeiten zu verwenden: </p><br><pre> <code class="plaintext hljs">class UserController { constructor(opts) { this.userService = opts.userService } }</code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die</a> Objekteigenschafts- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ID</a> in JS kann aus alphanumerischen Zeichen "_" und "$" bestehen und darf nicht mit einer Ziffer beginnen. </p><br><p>  Da wir für das automatische Laden dem Pfad zu ihren Quellen im Dateisystem Abhängigkeitskennungen zuordnen müssen, ist es besser, die Verwendung von "$" aufzugeben und die Erfahrung von PHP zu nutzen.  Bevor der <code>namespace</code> Operator in einigen Frameworks (z. B. in Zend 1) angezeigt wurde, wurden die folgenden Namen für Klassen verwendet: </p><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Zend_Config_Writer_Json</span></span></span><span class="hljs-class"> </span></span>{...}</code> </pre> <br><p>  So könnten wir unsere Anwendung von drei Objekten ( <code>Application</code> , <code>Config</code> , <code>Service</code> ) auf JS wie <code>Config</code> widerspiegeln: </p><br><pre> <code class="plaintext hljs">class Vendor_Project_Config { constructor() { } } class Vendor_Project_Service { constructor({Vendor_Project_Config}) { this.config = Vendor_Project_Config; } } class Vendor_Project_Application { constructor({Vendor_Project_Config, Vendor_Project_Service}) { this.config = Vendor_Project_Config; this.service = Vendor_Project_Service; } }</code> </pre> <br><p>  Wenn wir den Code jeder Klasse veröffentlichen: </p><br><pre> <code class="plaintext hljs">export default class Vendor_Project_Application { constructor({Vendor_Project_Config, Vendor_Project_Service}) { this.config = Vendor_Project_Config; this.service = Vendor_Project_Service; } }</code> </pre> <br><p>  in Ihrer Datei in unserem Projektmodul: </p><br><ul><li> <code>./src/</code> <br> <ul><li> <code>./Application.js</code> </li> <li> <code>./Config.js</code> </li> <li> <code>./Service.js</code> </li> </ul></li></ul><br><p>  Dann können wir das Stammverzeichnis des Moduls mit dem Stamm- "Namespace" des Moduls in der Konfiguration des Containers verbinden: </p><br><pre> <code class="plaintext hljs">const ns = "Vendor_Project"; const path = path.join(module_root, "src"); container.addSourceMapping(ns, path);</code> </pre> <br><p>  <code>${module_root}/src/Config.js</code> dann ausgehend von diesen Informationen den Pfad zu den entsprechenden Quellen ( <code>${module_root}/src/Config.js</code> ) basierend auf der Abhängigkeitskennung ( <code>${module_root}/src/Config.js</code> ). </p><br><h1 id="es6-moduli">  ES6-Module </h1><br><p>  ES6 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bietet ein</a> allgemeines Design zum Laden von ES6-Modulen: </p><br><pre> <code class="plaintext hljs">import { something } from 'path/to/source/with/something';</code> </pre> <br><p>  Da wir ein Objekt (eine Klasse) an eine Datei anhängen müssen, ist es in der Quelle sinnvoll, diese Klasse standardmäßig zu exportieren: </p><br><pre> <code class="plaintext hljs">export default class Vendor_Project_Path_To_Source_With_Something {...}</code> </pre> <br><p>  Im Prinzip ist es möglich, keinen so langen Namen für die Klasse zu schreiben, nur <code>Something</code> wird auch funktionieren, aber in Zend 1 haben sie geschrieben und nicht gebrochen, und die Eindeutigkeit des Klassennamens innerhalb des Projekts wirkt sich positiv auf die Funktionen der IDE aus (automatische Vervollständigung und kontextbezogene Eingabeaufforderungen) und beim Debuggen: </p><br><p><img src="https://habrastorage.org/webt/qc/vj/wg/qcvjwg4lkvdwbg0nwcbmotantby.png" alt="Bild"></p><br><p>  Das Importieren einer Klasse und das Erstellen eines Objekts sieht in diesem Fall folgendermaßen aus: </p><br><pre> <code class="plaintext hljs">import Something from 'path/to/source/with/something'; const something = new Something();</code> </pre> <br><h1 id="front--back-import">  Front &amp; Back Import </h1><br><p>  Der Import funktioniert sowohl im Browser als auch in NodeJS, es gibt jedoch Nuancen.  Beispielsweise versteht der Browser den Import von NodeJS-Modulen nicht: </p><br><pre> <code class="plaintext hljs">import path from "path";</code> </pre> <br><p>  Wir erhalten eine Fehlermeldung im Browser: </p><br><pre> <code class="plaintext hljs">Failed to resolve module specifier "path". Relative references must start with either "/", "./", or "../".</code> </pre> <br><p>  Das heißt, wenn unser Code sowohl im Browser <strong>als auch in den</strong> Knotenjs funktionieren soll, können wir keine Konstrukte verwenden, die der Browser <strong>oder die</strong> Knotenjs nicht verstehen.  Ich konzentriere mich speziell darauf, weil eine solche Schlussfolgerung zu natürlich ist, um darüber nachzudenken.  Wie man atmet. </p><br><h1 id="mesto-di-v-sovremennyh-web-prilozheniyah">  DIs Platz in modernen Webanwendungen </h1><br><p>  Dies ist aufgrund meiner persönlichen Erfahrung, wie alles andere in dieser Veröffentlichung, nur meine persönliche Meinung. </p><br><p>  In Webanwendungen nimmt JS praktisch ohne Alternative seinen Platz im Browser ein.  Auf der Serverseite haben sich Java, PHP, .Net, Ruby, Python dicht eingegraben ... Mit dem Aufkommen von nodejs drang auch JavaScript in den Server ein.  Und die in anderen Sprachen verwendeten Technologien, einschließlich DI, begannen, serverseitiges JS zu durchdringen. </p><br><p>  Die Entwicklung von JavaScript ist auf das asynchrone Verhalten des Codes im Browser zurückzuführen.  Asynchronität ist kein außergewöhnliches Merkmal von JS, sondern angeboren.  Das Vorhandensein von JS sowohl auf dem Server als auch auf der Vorderseite überrascht niemanden, sondern fördert die Verwendung derselben Ansätze an beiden Enden der Webanwendung.  Und der gleiche Code.  Natürlich sind Vorder- und Rückseite im Wesentlichen und in den zu lösenden Aufgaben zu unterschiedlich, um dort und dort denselben Code zu verwenden.  Wir können jedoch davon ausgehen, dass es in einer mehr oder weniger komplexen Anwendung Browser, Server und allgemeinen Code gibt. </p><br><p>  DI wird an der Vorderseite bereits in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RequireJS verwendet</a> : </p><br><pre> <code class="plaintext hljs">define( ["./config", "./service"], function App(Config, Service) {} );</code> </pre> <br><p>  Richtig, hier werden die Bezeichner von Abhängigkeiten explizit und sofort in Form von Links zu den Quellen geschrieben (Sie können die Zuordnung von Bezeichnern in der Bootloader-Konfiguration konfigurieren). </p><br><p>  In modernen Webanwendungen existiert DI nicht nur auf der Serverseite, sondern auch im Browser. </p><br><h1 id="pri-chyom-tut-maykl-dzhekson">  Was hat Michael Jackson damit zu tun? </h1><br><p>  Wenn ES-Module in nodejs aktiviert sind (das <code>--experimental-modules</code> ), identifiziert die Engine den Inhalt von Dateien mit der <code>*.mjs</code> als EcmaScript-Module (im Gegensatz zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Common-Modulen</a> mit der <code>*.cjs</code> ). </p><br><p>  Dieser Ansatz wird manchmal als " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Michael Jackson-Lösung</a> " bezeichnet, und die Skripte werden als Michael Jackson-Skripte ( <code>*.mjs</code> ) bezeichnet. </p><br><p>  Ich bin damit einverstanden, dass die mittelmäßige Intrige mit dem KDPV gelöst wurde, aber ... der Camon der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Jungs, Michael Jackson ...</a> </p><br><h1 id="yet-another-di-implementation">  Noch eine DI-Implementierung </h1><br><p>  Nun, wie erwartet, deine eigene <del>  Fahrrad </del>  DI-Modul - <a href="">@ teqfw / di</a> </p><br><p>  Dies ist keine kampfbereite Lösung, sondern eine grundlegende Implementierung.  Alle Abhängigkeiten sollten ES-Module sein und gemeinsame Funktionen für den Browser und die Knoten verwenden. </p><br><p>  Um Abhängigkeiten aufzulösen, verwendet das Modul den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">awilix-</a> Ansatz: </p><br><pre> <code class="plaintext hljs">constructor(spec) { /** @type {Vendor_Module_Config} */ const _config = spec.Vendor_Module_Config; /** @type {Vendor_Module_Service} */ const _service = spec.Vendor_Module_Service; }</code> </pre> <br><p>  So führen Sie das hintere Beispiel aus: </p><br><pre> <code class="plaintext hljs">import Container from "./src/Container.mjs"; const container = new Container(); container.addSourceMapping("Vendor_Module", "../example"); container.get("Vendor_Module_App") .then((app) =&gt; { app.run(); });</code> </pre> <br><p>  auf dem Server: </p><br><pre> <code class="plaintext hljs">$ node --experimental-modules main.mjs</code> </pre> <br><p>  So führen Sie das vordere Beispiel aus ( <code>example.html</code> ): </p><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>DI in Browser<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"module"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./main.mjs"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Load main script './main.mjs', create new DI container, then get object by ID from container.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Open browser console to see output.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Sie müssen das Modul auf den Server stellen und die Seite <code>example.html</code> im Browser öffnen (oder die Funktionen der IDE nutzen).  Wenn Sie <code>example.html</code> direkt öffnen, lautet der Fehler in Chrom: </p><br><pre> <code class="plaintext hljs">Access to script at 'file:///home/alex/work/teqfw.di/main.mjs' from origin 'null' has been blocked by CORS policy: Cross origin requests are only supported for protocol schemes: http, data, chrome, chrome-extension, https.</code> </pre> <br><p>  Wenn alles gut gegangen ist, gibt es in der Konsole (Browser oder NodeJS) ungefähr Folgendes: </p><br><pre> <code class="plaintext hljs">Create object with ID 'Vendor_Module_App'. Create object with ID 'Vendor_Module_Config'. There is no dependency with id 'Vendor_Module_Config' yet. 'Vendor_Module_Config' instance is created. Create object with ID 'Vendor_Module_Service'. There is no dependency with id 'Vendor_Module_Service' yet. 'Vendor_Module_Service' instance is created (deps: [Vendor_Module_Config]). 'Vendor_Module_App' instance is created (deps: [Vendor_Module_Config, Vendor_Module_Service]). Application 'Vendor_Module_Config' is running.</code> </pre> <br><h1 id="rezyume">  Zusammenfassung </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AMD, CommonJS, UMD?</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ESM</a> ! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de464347/">https://habr.com/ru/post/de464347/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de464331/index.html">Nutzlose Vorteile: Synthese von UV-absorbierenden Chemikalien aus Cashewnüssen</a></li>
<li><a href="../de464333/index.html">Verfolgung des Lebenszyklus von Benutzern ohne Zange und Isolierband</a></li>
<li><a href="../de464335/index.html">Unit-Tests in DBMS - wie wir es in Sportmaster machen, Teil eins</a></li>
<li><a href="../de464337/index.html">So umgehen Sie Captcha: Neuronales Netzwerk auf Tensorflow, Keras, Python v numerisch verrauschtes Captcha</a></li>
<li><a href="../de464345/index.html">5 Gründe, ein IT-Startup in Deutschland zu eröffnen</a></li>
<li><a href="../de464351/index.html">PoE IP-Kameras, spezielle Anforderungen und störungsfreier Betrieb - alles zusammen</a></li>
<li><a href="../de464353/index.html">1C: ERP VS 1C: KA 2.0. Was sollten Lebensmittelhersteller wählen?</a></li>
<li><a href="../de464355/index.html">Wie ein Frame in Shadow Fight 3 gerendert wird</a></li>
<li><a href="../de464357/index.html">RSA zufällige Blockchain</a></li>
<li><a href="../de464359/index.html">Funktionen zum Testen von mobilen Webanwendungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>