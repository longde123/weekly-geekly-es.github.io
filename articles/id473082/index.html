<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ” ğŸ¥‡ ğŸ¤ŸğŸ¾ Bagaimana kami menulis layanan microser dan mengapa kami tidak melakukannya dengan cepat ğŸŒ… ğŸ‘¨ğŸ½â€ğŸ’» ğŸ…ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cerita penggergajian Monolith sering terlihat serupa. Tim memiliki monolit kikuk yang besar dan kuat, mereka memutuskan untuk memotongnya menjadi hamb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana kami menulis layanan microser dan mengapa kami tidak melakukannya dengan cepat</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rbkmoney/blog/473082/"><p><img src="https://habrastorage.org/webt/ua/k5/wc/uak5wcoywpsmcnone42xp0hkroo.jpeg"></p><br><p>  Cerita penggergajian Monolith sering terlihat serupa.  Tim memiliki monolit kikuk yang besar dan kuat, mereka memutuskan untuk memotongnya menjadi hamburan layanan microser biasa dan pintar, semuanya menjadi keren.  Kisah-kisah hanya berbeda dalam tingkat horor "sebelum", sukacita "setelah" dan sejumlah karakteristik sekunder. </p><br><p>  Di RBK.money, kami juga memiliki layanan microser.  Tetapi kami datang kepada mereka sedikit berbeda dari kebanyakan.  Semuanya lebih buruk bagi kami daripada monolit - pada awalnya, semuanya hanya buruk. </p><br><p>  Di bawah kucing tentang bagaimana kita, pada kenyataannya, membangun microservices, mengapa OpenSource tidak hanya hebat pada prinsipnya, tetapi juga berfungsi sebagai komponen motivasi untuk menulis kode yang baik. </p><a name="habracut"></a><br><p>  Jadi, semuanya buruk.  Sedemikian rupa sehingga memperbaikinya tidak masuk akal, tetapi masuk akal untuk setuju untuk tidak pernah mengingat kengerian ini dan hanya menulis semuanya dari awal.  Dan segera pada layanan microser.  Pada tahap pertama pengembangan, kami segera membuat peraturan untuk selalu mengingat fakta bahwa suatu hari kami ingin kembali merasakan semua kebaikan atau bagian darinya.  Lagipula, semuanya disimpan dalam sejarah komit, termasuk julukan pengembang, jadi kami hanya duduk dan segera mencoba menulis semuanya sedemikian rupa sehingga nantinya kami tidak akan malu dengan kode kami di depan komunitas.  Lagi pula, tidak ada yang mau memerah untuk kode mereka atau arsitektur proyek, begitu-begitu sejarah. </p><br><h2 id="bystro-vs-horosho">  Cepat vs bagus </h2><br><p>  Di dunia yang ideal, Anda selalu ingin menulis kode dengan cepat dan menulisnya dengan baik.  Ya, seperti "Lebih baik menjadi kaya dan sehat daripada miskin dan sakit."  Oleh karena itu, layanan microser menjadi cara terbaik untuk mengatasi situasi ini.  Proses penulisan kode dibangun di atas tugas-tugas bisnis.  Misalkan bisnis membutuhkan fungsionalitas yang akan memperhitungkan dana akun dalam akun rekanan ketika melakukan pembayaran.  Fungsi ini berubah menjadi microservice, Accounter dengan nama kode, yang bergerak dalam alat akuntansi.  Dengan layanan microser lainnya, cerita yang sama. </p><br><p>  Hal utama di sini adalah untuk memastikan bahwa setiap fungsi bisnis dikonkretkan sehingga satu orang dapat menulisnya.  Ini sangat tergantung pada tugas-tugas yang datang sendiri untuk bekerja, dan pada bagaimana direktur teknis atau proyek menerjemahkan ini ke tim.  Kami berhasil melakukan ini, segera memberikan beberapa keuntungan signifikan yang baik. </p><br><p>  Pertama, ini memberikan paralelisasi besar pembangunan.  Pada awalnya, kami memiliki sekitar 10 orang, dan kami berhasil menulis sejumlah besar kode secara bersamaan (dan menulis dengan baik).  Kedua, ini memberi Anda kesempatan untuk memutar penuh.  Tapi ini sudah sedikit lebih penting daripada yang terlihat pada pandangan pertama. </p><br><p> Sangat sering, seseorang mulai buang air besar, bukan karena dia mendapatkan pekerjaan ini untuk Anda, tetapi karena matanya menjadi klise dan matanya menjadi kusam dan bosan.  Jika satu orang terus-menerus duduk di microservice yang sama, ia dapat mulai menghasilkan govnokod.  Dan ini bukan masalah profesionalisme, melainkan masalah waktu.  Setelah 7-8 bulan, orang akan bosan mendukung layanan microser yang sama, mereka akan melihat-lihat - dan ada kehidupan, musim semi datang setelah musim dingin, kolega saya memiliki semacam gerakan, sekali lagi iPhone baru keluar, dan Anda semua duduk di microservice yang sama .  Inilah mengapa monolith dilahirkan dengan satu titik kegagalan dalam bentuk orang yang lelah dengan tas di bawah matanya. </p><br><p><img src="https://habrastorage.org/webt/xr/y6/bx/xry6bxwqz1-stgebqm7kyv-yuwg.jpeg"></p><br><p>  Atau, secara umum, seseorang mulai berpikir bahwa semuanya hanya pada dirinya dan bersandar pada dirinya.  Dia akan mencoba membuat dirinya sangat diperlukan dengan mengelilingi karyanya dengan sekelompok "pengetahuan rahasia" dan prosedur aneh.  Pada awal perjalanan saya, saya memiliki situasi di mana warisan itu sangat liar sehingga tidak mungkin untuk mengetahuinya tanpa sepengetahuan ini.  Misalnya, Anda harus memulai satu layanan.  Seperti yang biasanya Anda bayangkan ini: </p><br><ol><li>  Mulai layanan. </li></ol><br><p>  Bagaimana itu: </p><br><ol><li>  Pergi ke registri Windows. </li><li>  Temukan kunci tertentu di sana. </li><li>  Ubah ke 1. </li><li>  Mulai layanan. </li><li>  Atur ulang nilai kunci ke 0. </li></ol><br><p>  Ini adalah contoh klasik kompleksitas demi kompleksitas dan "Tidak ada yang berfungsi di sini tanpa saya."  Faktanya, tanpa ini, semuanya bekerja.  Hanya lebih cepat dan lebih baik.  Anda dapat menghilangkan ini dengan rotasi - idealnya, ketika seseorang menulis satu layanan microser untuk sekitar beberapa sprint, dan kemudian pergi untuk melakukan tugas lain.  Dengan cara yang sama, kami mendukung pertukaran pengetahuan yang konstan dalam sebuah tim. </p><br><h2 id="kod-ot-protokola">  Kode dari protokol </h2><br><p><img src="https://habrastorage.org/webt/ce/rc/de/cercdegevteiviniruliireh98i.jpeg"></p><br><p>  Jika Anda mengambil TK apa pun dari bisnis, menerjemahkannya dengan baik ke dalam manusia, buang kulitnya dan menguap - Anda mendapatkan protokol, bahasa yang akan berkomunikasi dengan mesin.  Yaitu, kami mengambil tugas bisnis, memahami sendiri apa sebenarnya dan bagaimana kami akan melakukannya, dan mengubahnya menjadi spesifikasi untuk penghematan atau kesombongan (layanan mikro di dalam berkomunikasi melalui penghematan).  Langkah pertama adalah menjelaskan semuanya secara terperinci: apa yang akan dilakukan oleh layanan mikro, jenis data apa yang akan diterimanya, apa yang akan dijawab, struktur apa yang akan, dan sebagainya.  Protokol ini melewati tinjauan pertama dari mereka yang memiliki gagasan yang jelas tentang bagaimana semuanya bekerja (arsitek de facto).  Ini bekerja seperti filter kasar di mana beberapa omong kosong tidak akan lulus bahkan pada tingkat konsep. </p><br><p>  Segera setelah protokol muncul, Anda dapat duduk untuk menulis kode.  Dan jika protokol sepenuhnya direvisi sendiri oleh orang-orang universal, maka kode itu sendiri ada dalam tim orang-orang tertentu.  Kami menulis dalam tiga bahasa - JS, Java, Erlang.  Hal utama adalah tidak membuat orang terburu-buru dengan ulasan atau menulis kode.  Ya, bisnis selalu dan di mana saja harus cepat dan keren.  Tetapi saya jarang menyibukkan mereka sebagai direktur teknis, karena saya mengerti apa yang ingin mereka lakukan dengan baik.  Hasilnya adalah situasi yang saya sering didorong oleh pelanggan bisnis dari waktu ke waktu.  Namun praktis tidak harus memerah untuk kualitas. </p><br><p>  Kami hanya bergegas sekali, ketika jackpot itu ditumpangkan - pelanggan super dan tenggat waktu yang sangat mendesak, baru saja menciptakan Dompet kami.  Kemudian ya, kami menurunkan lengan baju kami dan melakukan segalanya lebih cepat dari yang kami rencanakan (dan lebih buruk dari yang kami inginkan, ya).  Idealnya, semuanya dianggap sebagai sekelompok layanan mikro yang rapi.  Ternyata sepotong monolit seperti itu.  Keuntungan dari situasi ini adalah kita sekali lagi menyadari untuk diri kita sendiri bahwa tidak perlu terburu-buru.  Dan layanan itu sendiri perlahan-lahan ditarik ke dalam layanan microser terpisah, seperti yang mereka inginkan. </p><br><p><img src="https://habrastorage.org/webt/lf/r4/93/lfr4930-sblgqmzndnbizn2ekki.png"></p><br><p>  Ada 50 layanan mikro dalam RBK Money, semuanya ditulis oleh sekitar 20 orang.  Hemat ada di mana-mana di dalam, untuk pengembang itu adalah protokol yang agak rumit, debasing sulit, dokumentasi juga sulit untuk ditulis.  Dan jika saya membiarkan penghematan dalam bentuk yang paling murni, mereka akan memanggil saya kata-kata buruk.  Oleh karena itu, kami tidak menemukan apa pun - JSON yang lain, sederhana dan intuitif, plus OpenAPI, sangat menonjol.  Untuk dapat menerima permintaan ini dari luar, mereka harus divalidasi, diotorisasi, dan kemudian diluncurkan ke platform oleh layanan Microsoft lainnya.  Dan kami juga menulis semua ini sebagai microservice independen, yang: </p><br><ul><li>  menerima barang curian dari luar; </li><li>  memvalidasi skema; </li><li>  mengizinkan pengguna; </li><li>  mengubah semua ini menjadi permintaan penghematan; </li><li>  Yah, dia menulis log, tentu saja. </li></ul><br><p>  Apakah nyaman untuk menulis sistem pembayaran pada layanan microser?  Tentu saja - di sini Anda memiliki paralelisasi pekerjaan, dan mempertahankan minat karyawan, dan tidak adanya titik kegagalan tunggal.  Satu microservice mogok atau tiba-tiba orang yang melakukannya kemarin pergi - tidak masalah, Anda dapat dengan cepat memperbaiki sesuatu, dan menempatkan orang baru di kursi pilot selama sprint baru. </p><br><p><img src="https://habrastorage.org/webt/ed/cc/os/edccospw6yqswlvrknqex1gfodo.jpeg"></p><br><p>  Tetapi ada pendapat bahwa jika seseorang duduk dan dengan hati-hati memotong layanan microser tertentu untuk waktu yang lama, maka dia pasti melakukannya dengan baik.  Karena kami mulai membicarakan hal ini, silakan tulis di komentar pendekatan mana yang lebih dekat dengan Anda.  Dan yang paling penting - mengapa. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id473082/">https://habr.com/ru/post/id473082/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id473064/index.html">Air mata Batavia, mobil dan Gorilla Glass: tentang beberapa jenis kaca yang diperkuat</a></li>
<li><a href="../id473070/index.html">Redux - Tidak diperlukan! Ganti dengan useContext dan useReducer in React?</a></li>
<li><a href="../id473072/index.html">Bagaimana Gazpromneft menciptakan jalur digital untuk klien korporat</a></li>
<li><a href="../id473074/index.html">Apa itu APS dan mengapa itu tidak "membuat rencana produksi seperti yang kita inginkan ..."</a></li>
<li><a href="../id473078/index.html">Mudah mengelola konfigurasi layanan-mikro dengan microconfig.io</a></li>
<li><a href="../id473084/index.html">"Ivan" adalah profesi bot obrolan. Atau eksperimen kreatif dengan asisten virtual</a></li>
<li><a href="../id473086/index.html">Bagaimana malware menghindar dari kotak pasir dengan Visual Basic</a></li>
<li><a href="../id473090/index.html">Ulasan PocketBook 632 dan 632 Aqua - pembaca 6-inci andalan dengan E Ink</a></li>
<li><a href="../id473092/index.html">AMA dengan Habr, # 13: berita penting bagi pengguna dan perusahaan</a></li>
<li><a href="../id473094/index.html">Kisah pengembang yang luar biasa, bagian 5: Rahasia Semesta</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>