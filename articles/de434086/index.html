<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçí üë©üèª‚Äçü§ù‚Äçüë®üèæ ‚öóÔ∏è Embedded-Bereitstellung f√ºr Windows und Linux üöò üëÖ üôçüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Artikel beschreibt die schnelle Bereitstellung eines eingebetteten Systems auf Basis von Windows 10 und Debian Linux. Beispiele f√ºr den Aufbau ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Embedded-Bereitstellung f√ºr Windows und Linux</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434086/">  Dieser Artikel beschreibt die schnelle Bereitstellung eines eingebetteten Systems auf Basis von Windows 10 und Debian Linux.  Beispiele f√ºr den Aufbau einer sicheren Schnittstelle werden gegeben. <br><a name="habracut"></a><br><h1>  Einf√ºhrung </h1><br><p>  Bei der Entwicklung von Ger√§ten mit einer grafischen Mensch-Maschine-Schnittstelle entsteht fr√ºher oder sp√§ter nicht nur die Aufgabe, die Schnittstelle selbst zu erstellen, sondern auch die Plattform auszuw√§hlen, auf der sie arbeiten soll.  Eine solche Plattform kann entweder ein Einplatinencomputer mit einem Betriebssystem oder ein Mikrocontroller mit einem Bildschirm und einer Reihe relevanter Bibliotheken oder eine andere urspr√ºngliche L√∂sung sein. </p><br><p>  Es kommt h√§ufig vor, dass auf der obersten Ebene des Steuerungssystems, auf dem die Schnittstelle ausgef√ºhrt wird, auch Kommunikationsaufgaben mit der Au√üenwelt und die Interaktion mit einer Vielzahl von Peripherieger√§ten ausgef√ºhrt werden.  Dar√ºber hinaus kann die Benutzeroberfl√§che selbst sehr hohe Anforderungen an die grafischen Ressourcen stellen.  Vor diesem Hintergrund und um Arbeitskosten zu sparen, ist es m√∂glich, einen Einplatinencomputer als Basis zu verwenden und ein vorgefertigtes Betriebssystem darauf zu installieren.  Die Softwareentwicklung kann in diesem Fall durch die Verwendung moderner Frameworks mit guter Dokumentation und einer Reihe von Beispielen erheblich vereinfacht werden. </p><br><h2>  Schnittstellenanforderungen </h2><br><p>  Aus Sicht des Benutzers sollte die Schnittstelle die folgenden Anforderungen erf√ºllen: </p><br><ul><li>  Beim Laden im Vollbildmodus sollte eine Anwendung angezeigt werden. Es handelt sich um dieselbe Benutzeroberfl√§che und dieselbe grafische Shell. </li><li>  Au√üer dieser Anwendung sollte dem Benutzer nichts mehr zur Verf√ºgung stehen. </li><li>  Die Anwendung sollte die ganze Zeit funktionieren, das System sollte nicht einschlafen, der Bildschirm sollte sich nicht ausschalten. </li><li>  Alle Tastaturk√ºrzel, Helfer, Eingabehilfen und √§hnliche Funktionen sollten deaktiviert sein. </li><li>  Im Falle eines Fehlers der Anwendung sollte diese vom System automatisch neu gestartet werden. </li><li>  Das System stellt keine besonderen Anforderungen an Geschwindigkeits- oder Echtzeitmodi. Es ist jedoch erforderlich, dass die Schnittstelle ohne merkliche Verz√∂gerungen auf Benutzerbefehle reagiert. </li><li>  Das System muss gegen wiederholte harte Neustarts resistent sein. Es muss kein spezielles Skript ausgef√ºhrt werden, um die Arbeit abzuschlie√üen. </li><li>  Es sollte m√∂glich sein, die fertige Baugruppe schnell in eine Reihe von Ger√§ten zu klonen, wobei alle erforderlichen Einstellungen im automatischen Modus vorgenommen werden. </li></ul><br><p>  Mit anderen Worten, eine vollst√§ndige Einschr√§nkung der Benutzeraktionen, Stabilit√§t und Skalierbarkeit. </p><br><p>  F√ºr das Betriebssystem eines Einplatinencomputers werden sofort zwei Optionen in Betracht gezogen, eine basierend auf Windows und eine basierend auf Linux, und sie miteinander verglichen. </p><br><p>  Erstellen wir beispielsweise eine Touchscreen-Kiosk-Oberfl√§che.  Nehmen wir als Anwendung eines der Qt Quick-Schulungsbeispiele und implementieren es mit einigen √Ñnderungen.  Das Qt-Framework ist f√ºr beide Betriebssysteme verf√ºgbar. </p><br><p>  Um nicht in die Nuancen der Installation von Windows und Linux auf einer ARM-Plattform einzutauchen, kann das System einfach auf der Basis eines x86-kompatiblen Prozessors zusammengestellt werden.  In diesem Fall wurde eines der vielen verf√ºgbaren Boards auf der Intel Bay Trail-Plattform f√ºr Experimente verwendet. </p><br><p>  Ein Paket aller Programme und Skripte ist auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub</a> verf√ºgbar. </p><br><h1>  Windows-Pfad </h1><br><p>  Zu einer Zeit wurde Windows Embedded von Microsoft eingef√ºhrt, um eingebettete Systeme zu erstellen.  Bereits in der fr√ºhen Version von Windows Embedded XP erhielten Entwickler eine Reihe von Tools zum Zusammenstellen der am meisten abgeschnittenen, jedoch mit den erforderlichen Bildtreibern ausgestatteten Tools.  Diese Baugruppen ben√∂tigten ein Minimum an RAM und funktionierten auch auf schwachen Prozessoren einwandfrei.  Die Technologie wurde in der Version von Windows Embedded Standard 7 entwickelt, in der an den Prozess des Erstellens eigener Assemblys erinnert wurde.  Windows Embedded verwendete die Ideologie eines offenen Katalogs von Modulen, und jeder konnte sein System nur mit den erforderlichen Komponenten ausstatten.  Die neueste Version, in der dieser Ansatz verf√ºgbar war, ist Windows Embedded Standard 8.1, obwohl in abgeschnittener Form. </p><br><p>  Das moderne Windows 10 IoT ist eine Alternative zu Windows Embedded, unterscheidet sich jedoch stark von seinen Vorg√§ngern.  Ein offener Komponentenkatalog ist nicht mehr verf√ºgbar.  Die M√∂glichkeit, Lichtbilder vom Designer zu sammeln und daraus eigene Installationsdisketten zu erstellen, ist verschwunden.  Spezielle Optionen eines eingebetteten Systems, wie z. B. ein Aufnahmefilter, ein Bootloader-Branding, ein Tastaturfilter usw., sind jetzt in einem vorinstallierten System konfiguriert.  Dar√ºber hinaus ist die Unterst√ºtzung dieser Funktionen nur als Teil der schweren Version von Windows 10 Enterprise verf√ºgbar. </p><br><p>  Trotz der hohen Systemanforderungen, insbesondere hinsichtlich der RAM-Gr√∂√üe, verursacht die Verwendung selbst schwerer Versionen in eingebetteten L√∂sungen keine besonderen Probleme, vor allem aufgrund der Verf√ºgbarkeit von Hardwarekomponenten.  Vergessen Sie au√üerdem nicht, dass es in den letzten Jahren schwieriger geworden ist, eine Lizenz f√ºr alte Produkte von Microsoft zu kaufen. </p><br><h2>  Schnelle L√∂sung </h2><br><p>  Bei der ersten Pr√ºfung stellt sich heraus, dass selbst unter normalen Windows 10-Funktionen bereits eine integrierte Funktion f√ºr den zugewiesenen Zugriff vorhanden ist (Abb. 1), die wie eine vorgefertigte L√∂sung f√ºr die Aufgabe aussieht. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/t6/14/yr/t614yroc8ueu_rkh1t7srjo0cnu.png" alt="Zu wahrer zugriff"></div><p>  <i>Abb.</i>  <i>1. Zugewiesene Zugriffsfunktion</i> </p><br><p>  Ein Programm, das in diesem Fall als Schnittstelle verwendet werden kann, sollte zun√§chst als universelle Windows-Plattformanwendung entwickelt werden.  Diese <i>AppX-Anwendungen</i> werden beispielsweise auf einem Windows Phone installiert.  Eine einfache Vollbildanwendung kann nat√ºrlich in <i>appx</i> konvertiert und mit den erforderlichen Zertifikaten signiert und dann installiert werden.  Es kann als Schnittstelle fungieren, jedoch ohne angemessenen Schutz.  Leider hat der Benutzer im normalen Modus "Zugewiesener Zugriff" weiterhin offenen Zugriff auf einige Systemeinstellungen und Hotkeys.  Infolgedessen kann mit diesem Ansatz keine Schnittstelle erhalten werden, die alle oben genannten Anforderungen erf√ºllt.  Das System muss auf andere Weise manuell konfiguriert werden. </p><br><h2>  Richtige Entscheidung </h2><br><h3>  1. Erstinstallation </h3><br><p>  Daher ben√∂tigen wir zun√§chst die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Windows 10 Enterprise LTSB-Distribution</a> .  Sie k√∂nnen das Original-Microsoft-Image aufnehmen, ein leichtes verwenden oder mit Tools von Drittanbietern ein eigenes erstellen.  F√ºr die Versuchsplatine wurde eine der vorgefertigten Baugruppen ausgew√§hlt (leichte 32-Bit-Version). </p><br><p>  Wir installieren das System aus dem Distributionskit auf der Zielplatine.  Bei der Installation wird die Festplatte in zwei Abschnitte unterteilt: C: - f√ºr das System, D: - f√ºr die Hauptanwendung, Dienstprogramme und Protokolle.  Eine solche Aufschl√ºsselung ist in Zukunft f√ºr den Aufzeichnungsfilter n√ºtzlich.  Nach der Installation warten wir, bis das Einstellungsmen√º angezeigt wird, oder wir setzen das Men√º mit den Netzwerkeinstellungen nicht fort. </p><br><p>  Wir starten √ºber Strg + Umschalt + F3 in den Servicemodus. </p><br><p>  Wenn w√§hrend des Installationsvorgangs keine Fehler aufgetreten sind, wechselt das System nach dem Neustart in das Dienstkonto des Administrators und das Fenster <i>SysPrep</i> wird auf dem Bildschirm angezeigt (Abb. 2).  Es muss geschlossen sein, wir werden <i>SysPrep</i> anders starten und eine spezielle Antwortdatei verwenden, die noch erstellt werden muss. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/kw/xn/3y/kwxn3yxs3totane-ogcok3z9bto.png" alt="Sysprep-Fenster"></div><p>  <i>Abb.</i>  <i>2. Servicemodus.</i> </p><br><h3>  2. Systemkonfiguration </h3><br><p>  F√ºr weitere Aktionen ben√∂tigen Sie die Bereitstellungstools aus dem <a href="">Windows 10 Assessment and Deployment Kit</a> . </p><br><p>  Von der Festplatte mit der auf der <i>Karte</i> installierten Windows-Distribution m√ºssen Sie die Image- <i>Datei install.wim</i> extrahieren.  Es kommt vor, dass diese Datei in einigen Assemblys in komprimierter Form mit der Erweiterung <i>esd</i> gespeichert werden kann.  In diesem Fall m√ºssen Sie es zuerst auspacken.  <i>Hierf√ºr wird das</i> Dienstprogramm <i>dism</i> verwendet. </p><br><p>  Finden Sie die Seriennummer der gew√ºnschten Version im Container heraus (SourceIndex). </p><br><pre><code class="plaintext hljs">dism /Get-WimInfo /WimFile:install.esd</code> </pre> <br><p>  Extrahieren Sie dann die Bilddatei (in diesem Fall die erste im Container). </p><br><pre> <code class="plaintext hljs">dism /export-image /SourceImageFile:install.esd /SourceIndex:1 /DestinationImageFile:install.wim /Compress:max /CheckIntegrity</code> </pre> <br><p>  Jetzt m√ºssen Sie das Image im Windows System Image Manager (√ºber die Bereitstellungstools) √∂ffnen und ein Verzeichnis erstellen. </p><br><p>  Es ist zu beachten, dass das Arbeiten mit Images im Windows System Image Manager nur m√∂glich ist, wenn die Bittiefe des Images mit der Bittiefe des Hosts √ºbereinstimmt.  Das hei√üt, es ist unm√∂glich, das Image der 32-Bit-Version in einem 64-Bit-System zu bearbeiten.  Hier, wie sie sagen, kein Kommentar. </p><br><p>  Bearbeiten Sie beim <i>Erstellen</i> des Verzeichnisses die Antwortdatei f√ºr das Dienstprogramm <i>SysPrep</i> .  Geben Sie die Eigent√ºmerinformationen ein, f√ºgen Sie die erforderlichen Benutzer hinzu und konfigurieren Sie das erste Autologin (Abb. 3). </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/ch/fn/4f/chfn4fan0jtazdofcrskqz6dakc.png" alt="Antwortdatei"></div><p>  <i>Abb.</i>  <i>3. Erstellen einer Antwortdatei.</i> </p><br><p>  Es macht keinen Sinn, alle Parameter aufzulisten. Der Inhalt der Antwortdatei befindet sich im Repository.  Die <i>Hauptsache</i> ist, nicht zu vergessen, die <i>CopyProfile-</i> Parameter auf <i>true</i> , <i>SkipReam</i> auf <i>1 zu setzen</i> und die Administrator- <i>Autologin zu</i> aktivieren.  Sie k√∂nnen Ihren Produktschl√ºssel in Abschnitt <i>4 Spezialisieren - Microsoft-Windows-Shell-Setup - ProductKey eingeben</i> . </p><br><h3>  3. Programme installieren </h3><br><p>  Als N√§chstes ben√∂tigen Sie die eigentliche <i>install.wim-</i> Image- <i>Datei</i> . Sie m√ºssen sie daher neben der Antwortdatei <i>customize.xml</i> ablegen, in der Sie nach dem Speichern den Pfad zum Image manuell ersetzen m√ºssen.  Am Ende der Datei sollte die Zeile folgenderma√üen aussehen: </p><br><pre> <code class="plaintext hljs">&lt;cpi:offlineImage cpi:source="wim:d:/service/install.wim#Windows 10 Enterprise LTSB" xmlns:cpi="urn:schemas-microsoft-com:cpi" /&gt;</code> </pre> <br><p>  Um die KioskShell-Demo-Oberfl√§che zu erhalten, m√ºssen Sie eine Version f√ºr Windows aus dem Quellcode erstellen.  Montagetipps befinden sich im Repository. </p><br><p>  Wir kopieren die Dateien auf die Karte und erhalten die folgende Datei- und Verzeichnisstruktur: </p><br><pre> <code class="plaintext hljs">C:\ ‚îî‚îÄ‚îÄ Design\ ‚îú‚îÄ‚îÄ backgroundDefault.jpg -      ( ) ‚îî‚îÄ‚îÄ oemlogo.bmp -  ,      D:\ ‚îú‚îÄ‚îÄ Logs\ -       ‚îú‚îÄ‚îÄ Service\ ‚îÇ ‚îú‚îÄ‚îÄ AfterSetup.bat -   ,     SysPrep ‚îÇ ‚îú‚îÄ‚îÄ FirstLogon.bat -        ‚îÇ ‚îú‚îÄ‚îÄ customize.xml -   ‚îÇ ‚îú‚îÄ‚îÄ install.wim -   ‚îÇ ‚îú‚îÄ‚îÄ CustomShellSetup.ps1 -  PowerShell     ‚îÇ ‚îú‚îÄ‚îÄ EnableRules.ps1 -  PowerShell     ‚îÇ ‚îú‚îÄ‚îÄ DisableAllRules.ps1 -      ( ) ‚îÇ ‚îî‚îÄ‚îÄ UserLogon.bat -      ( ) ‚îî‚îÄ‚îÄ Shell\ -     "KioskShell.exe"   </code> </pre> <br><h3>  4. Manuelle Systemeinrichtung </h3><br><p>  Wenn sich das System im Servicemodus befindet, k√∂nnen Sie so oft neu starten, wie Sie m√∂chten. Das System kehrt automatisch dazu zur√ºck.  Bei einer langen Leerlaufzeit vor dem Einrichten der Stromversorgung wird der Bildschirm m√∂glicherweise gesperrt und nicht wieder angezeigt. Nur ein Neustart hilft.  Da jedes spezifische Projekt m√∂glicherweise √ºber eigene Konfigurationsfunktionen verf√ºgt, ist es besser, dies manuell durchzuf√ºhren. Sie k√∂nnen jedoch auch Automatisierungsskripts verwenden. </p><br><p>  Wir installieren die erforderlichen Komponenten des eingebetteten Systems und deaktivieren die Benutzerkontensteuerung (siehe <i>AfterSetup.bat</i> aus dem Repository). </p><br><p>  Installieren Sie alle Treiber, konfigurieren Sie die Hardware (IP-Netzwerkkarte, Aufl√∂sung und Ausrichtung des Bildschirms, Anschl√ºsse externer Ger√§te usw.), deaktivieren Sie Sticky Keys und alle Sonderfunktionen. </p><br><p>  Da ich in Zukunft remote verwalten m√∂chte, werden wir den Zugriff √ºber RDP erm√∂glichen.  Das Administratorkennwort l√§uft in der Phase der automatischen Konfiguration ab. </p><br><p>  Als N√§chstes m√ºssen Sie das Systemupdate im <i>Editor f√ºr lokale Gruppenrichtlinien</i> deaktivieren (im Abschnitt <i>Computerkonfiguration - Administrative Vorlagen - Windows-Komponenten - Windows Update</i> m√ºssen Sie <i>Konfigurierte automatische Updates</i> auf <i>Deaktiviert setzen</i> ).  Dar√ºber hinaus m√ºssen Sie das automatische Scannen von Windows Update deaktivieren (im Aufgabenplaner im Abschnitt <i>Microsoft - Windows - UpdateOrchestrator m√ºssen</i> Sie alle Aufgaben deaktivieren). Andernfalls wird bei jedem Start ein schwarzes Fenster angezeigt. Wenn Sie eine Verbindung zum Internet herstellen, beginnt Windows m√∂glicherweise pl√∂tzlich mit der Aktualisierung. </p><br><p>  Konfigurieren Sie als N√§chstes die Energieeinstellungen.  Machen Sie dazu zun√§chst im Abschnitt <i>Erweiterte Energieeinstellungen</i> alle Energieeinstellungen sichtbar (dazu in der Registrierung in jedem Unterschl√ºssel unter <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Power \ PowerSettings \ 238C9FA8-0AAD-41ED-83F4-97BE242C8F20,</i> wenn Sie den Parameter <i>Attribute</i> ben√∂tigen Wert f√ºr ihn <i>2</i> ).  Nachdem alle Einstellungen verf√ºgbar sind, schalten Sie den Ruhemodus und den Abwesenheitsmodus aus, entfernen Sie die Aktion auf dem Netzschalter (sofern Sie nicht etwas anderes ben√∂tigen) und schalten Sie den Autorisierungs-Timer im Leerlauf aus.  Als n√§chstes entfernen wir den Standby-Modus mit der Verbindung (setzen Sie im <i>Abschnitt</i> <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Power</i> den Parameter <i>CsEnabled</i> auf <i>0</i> ).  Schalten Sie gegebenenfalls die adaptive Helligkeitsregelung des Bildschirms aus. </p><br><p>  Wenn alle Systemeinstellungen abgeschlossen sind, haben wir die letzte M√∂glichkeit, √Ñnderungen vorzunehmen, da beim zweiten Ausf√ºhren des Skripts <i>AfterSetup.bat</i> der automatische Konfigurationsmechanismus mit <i>SysPrep gestartet wird</i> , der nicht gestoppt werden kann.  Sie m√ºssen immer noch daran denken, das System zu aktivieren (es wird empfohlen, sich mit den Aktivierungsoptionen f√ºr Unternehmensversionen von Windows selbst vertraut zu machen).  Bereits zu diesem Zeitpunkt k√∂nnen Sie eine Sicherungskopie der gesamten Festplatte erstellen und den vorl√§ufigen Status des Images bei zuk√ºnftigen √Ñnderungen korrigieren. </p><br><p>  Am Ende der Arbeit wird <i>SysPrep</i> nicht neu <i>gestartet</i> , sondern der Computer ausgeschaltet. Zu diesem Zeitpunkt k√∂nnen Sie bereits ein Arbeitsimage erstellen, das f√ºr die Portierung auf eine Serie bereit ist. </p><br><h3>  5. Endg√ºltige automatische Systemeinrichtung </h3><br><p>  Nach dem ersten Laden des Arbeitsabbilds (siehe <i>FirstLogon.bat</i> aus dem Repository) wird die sichere Schnittstelle konfiguriert, die <i>automatische Anmeldung</i> zum Benutzerkonto neu konfiguriert und die Tastaturk√ºrzel, die das System besch√§digen k√∂nnen, werden deaktiviert.  Als n√§chstes wird der Unified Write Filter konfiguriert und aktiviert.  In diesem Fall ist der Filter so konfiguriert, dass alle Partitionen mit Ausnahme der Ordner " <i>Service"</i> und " <i>Protokolle"</i> gesch√ºtzt werden, und verwendet einen 256-MB-Swap.  Das System wird mehrmals neu gestartet. Wenn alles korrekt ausgef√ºhrt wurde, wird beim n√§chsten Start eine sichere Schnittstelle angezeigt, die im Namen des <i>Benutzerkontos</i> gestartet wird. </p><br><p>  Um das System vor Ort zu warten, k√∂nnen Sie zum Anmeldebildschirm wechseln und sich beispielsweise beim Administratorkonto anmelden.  In Windows 10 wird hierf√ºr eine Standardmethode bereitgestellt. Sie m√ºssen die Taste ‚ÄûWin‚Äú f√ºnfmal hintereinander dr√ºcken. </p><br><h1>  Linux-Pfad </h1><br><p>  Es gibt keine einheitliche Methode zum Erstellen eingebetteter Systeme mit einer auf Linux basierenden grafischen Oberfl√§che.  Da es jedoch keine einzige gemeinsame Verteilung gibt, handelt es sich um eine Systemfamilie, die nach v√∂llig unterschiedlichen Prinzipien erstellt wird.  Das n√§chstgelegene Thema scheint das Yocto Linux-Projekt zu sein.  Es ist jedoch ziemlich schwierig, Bilder voller Anwendungen, Treiber und Bibliotheken von Drittanbietern zu sammeln.  Um dieses Problem zu l√∂sen, ist es einfacher, eine vorgefertigte, gut unterst√ºtzte Distribution manuell zu konfigurieren. </p><br><h2>  Einfache L√∂sung </h2><br><h3>  1. Erstinstallation </h3><br><p>  Zuallererst brauchen wir also die Distribution selbst, zum Beispiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Debian</a> .  Sie k√∂nnen einen anderen nehmen, Sie k√∂nnen Ihren eigenen machen.  Die Hauptsache ist, dass die Distribution kein automatisches Update-System hat.  F√ºr das Experimental Board wurde Debian Linux 9 (64-Bit-Version, Kernel 4.9) ausgew√§hlt. </p><br><p>  Wir installieren das System auf herk√∂mmliche Weise.  Bei der Installation teilen wir die Festplatte in zwei Abschnitte auf: sda1 - <i>/</i> f√ºr das System, sda2 - <i>/ var / log</i> f√ºr System- und Softwareprotokolle.  Eine solche Aufschl√ºsselung ist in Zukunft f√ºr den Aufzeichnungsfilter n√ºtzlich.  Installieren Sie die Standard- <i>xfce-GUI</i> und den <i>SSH-</i> Server.  Wir f√ºgen w√§hrend der Installation des Benutzers einen <i>Administrator</i> hinzu und legen das Passwort fest. </p><br><p>  Nach der Installation f√ºgt der <i>Root-</i> Account als erstes den <i>Administrator</i> der <i>sudo-</i> Gruppe hinzu. </p><br><pre> <code class="plaintext hljs">apt install sudo adduser administrator sudo</code> </pre> <br><p>  Wir gehen unter dem Benutzernamen <i>Administrator</i> in das System und f√ºgen einen neuen <i>Benutzer hinzu</i> . </p><br><pre> <code class="plaintext hljs">sudo useradd -m user</code> </pre> <br><p>  Der Einfachheit halber k√∂nnen Sie das Passwort f√ºr ihn vollst√§ndig entfernen, da der Zugriff auf dieses Konto weiterhin √ºberall geschlossen bleibt. </p><br><pre> <code class="plaintext hljs">sudo passwd -d user</code> </pre> <br><h3>  2. Systemkonfiguration </h3><br><p>  Wir installieren Treiber, Firmware-Pakete und zus√§tzliche Programme nach Wunsch. </p><br><p>  Um die <i>Remoteverwaltung</i> in Zukunft zu aktivieren, k√∂nnen Sie den <i>vnc-</i> Server bei Bedarf installieren und konfigurieren.  In diesem Fall macht dies jedoch keinen Sinn, da alle administrativen Aufgaben einfach √ºber die Konsole ausgef√ºhrt werden k√∂nnen und hierf√ºr nur der Zugriff √ºber <i>ssh</i> ausreicht. </p><br><p>  Linux kann verschiedene Fenstermanager f√ºr verschiedene Benutzer verwenden.  Installieren Sie einen minimalistischen Manager mit der M√∂glichkeit zur Feinabstimmung, damit die Benutzeroberfl√§che funktioniert.  Und f√ºr die Konfiguration ben√∂tigen Sie einige weitere Anwendungen. </p><br><pre> <code class="plaintext hljs">sudo apt install fluxbox arandr plymouth</code> </pre> <br><p>  Mit <i>arandr k√∂nnen</i> Sie bei Bedarf die Aufl√∂sung und Ausrichtung des Bildschirms √§ndern und die Konfiguration dann als Skript speichern (Abb. 4). </p><br><p><img src="https://habrastorage.org/webt/fm/qo/nw/fmqonwqu3j3rua5xd_nr9zbj4p4.png" alt="Bildschirmparameter set_resolution.sh"></p><br><p>  Abb.  4. Bildschirmeinstellungen. </p><br><p>  Als N√§chstes m√ºssen Sie sich einmal unter dem Benutzerkonto beim System anmelden, nachdem Sie die zuvor als Fenstermanager installierte <i>Fluxbox ausgew√§hlt</i> und sich dann erneut abgemeldet haben.  Dies ist erforderlich, damit <i>Fluxbox</i> beim ersten Start alle Einstellungsdateien erstellt und als Standardmanager f√ºr das <i>Benutzerkonto ausgew√§hlt wird</i> (siehe die <i>.dmrc-</i> Datei im Home-Verzeichnis des <i>Benutzers</i> ). </p><br><p>  Jetzt m√ºssen Sie die <i>Fluxbox so</i> konfigurieren, dass sie die oben beschriebenen Schnittstellenanforderungen erf√ºllt.  <i>Deaktivieren</i> Sie dazu das <i>Fenster session.screen0.toolbar.visible</i> in <i>/home/user/.fluxbox/init</i> <i>: false</i> , kommentieren Sie alle Tastaturk√ºrzel mit Ausnahme der Lautst√§rketasten in <i>/home/user/.fluxbox/keys</i> und in <i>/ home / user / aus. Fluxbox / Startup</i> F√ºgen Sie den Start des Bildschirmkonfigurationsskripts hinzu und deaktivieren Sie die Energiesparfunktionen des Monitors und die automatische Ausf√ºhrung der Vollbildanwendung.  Das Skript startet die Anwendung im Falle eines unerwarteten Fehlers neu. </p><br><pre> <code class="plaintext hljs">set_resolution.sh xset -dmps s off /home/user/autostart.sh &amp;</code> </pre><br><p>  Jetzt m√ºssen Sie den Systemstartvorgang beschleunigen und vor dem Benutzer verbergen.  Setzen Sie dazu <i>GRUB_TIMEOUT = 0</i> in <i>/ etc / default / grub und</i> setzen Sie <i>quiet_boot = "1"</i> in <i>/etc/grub.d/10_linux</i> .  Um die Animation beim Laden in die <i>Kernelparameter GRUB_CMDLINE_LINUX anzuzeigen, m√ºssen</i> Sie die <i>Begr√º√üungsoption</i> hinzuf√ºgen. Wenn sich die Bildschirmausrichtung √§ndert, wird je nach Richtung die Option <i>fbcon = drehen: 1</i> oder <i>fbcon = drehen: 3 hinzugef√ºgt</i> .  Bei Bedarf k√∂nnen Sie die Aufl√∂sung und Ausrichtung auf dem Anmeldebildschirm √§ndern.  Dazu muss <i>display-setup-script = set_resolution.sh</i> in <i>/etc/lightdm/lightdm.conf</i> angegeben <i>werden</i> .  Und wenn Sie den Cursor ausblenden m√ºssen, f√ºgen Sie <i>xserver-command = X -core -nocursor hinzu</i> . </p><br><p>  Wir w√§hlen einen Animationsstil zum Laden. </p><br><pre> <code class="plaintext hljs">sudo plymouth-set-default-theme -R text</code> </pre> <br><p>  Und schlie√ülich alle √Ñnderungen beheben. </p><br><pre> <code class="plaintext hljs">sudo update-grub2</code> </pre> <br><h3>  3. Programme installieren </h3><br><p>  Um die KioskShell-Demo-Oberfl√§che zu erhalten, m√ºssen Sie eine Linux-Version aus dem Quellcode erstellen.  Montagetipps befinden sich im Repository. </p><br><p>  Wir kopieren die Dateien auf die Karte und erhalten die folgende Datei- und Verzeichnisstruktur: </p><br><pre> <code class="plaintext hljs">/ ‚îú‚îÄ‚îÄ usr/ -      "KioskShell"    ‚îú‚îÄ‚îÄ local/ ‚îÇ ‚îî‚îÄ‚îÄ bin/ ‚îÇ ‚îî‚îÄ‚îÄ set_resolution.sh ‚îî‚îÄ‚îÄ home/ ‚îú‚îÄ‚îÄ administrator/ ‚îÇ ‚îî‚îÄ‚îÄ relogin.sh -       ‚îî‚îÄ‚îÄ user/ ‚îî‚îÄ‚îÄ autostart.sh -    </code> </pre> <br><h3>  4. Endg√ºltige Systemeinrichtung </h3><br><p>  In dieser Phase k√∂nnen Sie eine Sicherungskopie der gesamten Festplatte erstellen und den vorl√§ufigen Status des Images f√ºr den Fall von zuk√ºnftigen √Ñnderungen korrigieren. </p><br><p>  Richten Sie die automatische Anmeldung unter dem Benutzerkonto ein. Setzen Sie dazu <i>autologin-user = user</i> in <i>/etc/lightdm/lightdm.conf</i> . </p><br><p>  Stellen Sie nun den Schreibschutz ein. </p><br><pre> <code class="plaintext hljs">sudo apt install bilibop</code> </pre> <br><p>  W√§hlen Sie bei der Installation die <i>dynamische gef√§lschte Ger√§tezuordnung aus</i> . </p><br><p>  Bearbeiten Sie die Einstellungsdatei <i>/etc/bilibop/bilibop.conf</i> .  Wir aktivieren das Modul mit dem Parameter <i>BILIBOP_LOCKFS = "true"</i> und f√ºgen den Ausnahmen <i>BILIBOP_LOCKFS_WHITELIST = "/ var / log"</i> einen Abschnitt mit Protokollen hinzu.  Aktivieren Sie die M√∂glichkeit, den Schutz bei Bedarf vor√ºbergehend zu deaktivieren. <i>BILIBOP_LOCKFS_POLICY = "soft"</i> .  Und da das System keine Verschl√ºsselung enth√§lt, m√ºssen Sie <i>BILIBOP_LOCKFS_SWAP_POLICY = "soft" setzen</i> . </p><br><p>  Wir starten das System neu und wenn alles richtig gemacht ist, erscheint eine sichere Schnittstelle, die im Namen des Benutzerkontos gestartet wird. </p><br><p>  Der letzte Schritt kann leicht automatisiert werden, um beim ersten Start ein System mit automatischer Konfiguration zu erhalten.  Dadurch wird eine Verteilung f√ºr die Skalierung auf mehrere Ger√§te erstellt (dieser Mechanismus soll unabh√§ngig implementiert werden). </p><br><p>  Um das System an Ort und Stelle zu warten, k√∂nnen Sie zum Anmeldebildschirm gelangen und sich beim Administratorkonto anmelden.  Unter Linux m√ºssen Sie zuerst √ºber Strg + Alt + F1 zur Konsole gelangen.  Erzwingen Sie nach der Anmeldung beim Administratorkonto, dass sich der Benutzer vom System abmeldet. </p><br><pre> <code class="plaintext hljs">sudo skill -KILL -u user</code> </pre> <br><p>  Kehren Sie dann √ºber Strg + Alt + F7 in den Grafikmodus zur√ºck und melden Sie sich erneut als Administrator an. </p><br><h1>  Schlussfolgerungen </h1><br><p>  Unabh√§ngig davon, welcher Pfad gew√§hlt wurde, ist das Endergebnis das gleiche Ergebnis.  Bei richtiger Konfiguration erf√ºllt die Benutzeroberfl√§che alle oben beschriebenen Anforderungen.  Es sind nur visuelle Unterschiede m√∂glich, die in der Regel mit den Funktionen zum Rendern grafischer Elemente mithilfe der Hardwarebeschleunigung auf verschiedenen Plattformen verbunden sind. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/rm/nk/1-/rmnk1-wetcbmnk4qnwng5ztxdri.png" alt="Gesch√ºtzte Shell-Anwendung"></div><p>  Abb.  5. Die Schnittstelle ist in Betrieb. </p><br><p></p><p>  Da die Basis des Systems ein Einplatinencomputer ist, ist die Installation von Touchscreens oder anderen Steuerelementen kein Problem.  Wenn Sie √ºber die entsprechende Anwendung verf√ºgen, k√∂nnen Sie auf dieser Basis nicht nur die Steuerkonsole oder das interaktive Dashboard des Ger√§ts erstellen, sondern auch andere Ger√§te, z. B. Informationen oder Handelsterminals. </p><br><h2>  Auswahlproblem </h2><br><p>  Es gibt eine Meinung, dass Linux sehr schwer zu konfigurieren und zu warten ist, aber gleichzeitig kostenlos ist und Windows einfach und bequem ist, aber Geld kostet.  Dies ist vielleicht wahr, aber nur auf Haushaltsebene.  Bei der Erstellung eingebetteter Systeme sollten andere Umst√§nde ber√ºcksichtigt werden.  Beispielsweise scheint die Feinabstimmung von Windows, insbesondere im Hinblick auf die Energieverwaltung und andere Elemente auf niedriger Ebene, nicht mehr einfach und bequem zu sein.  Vergessen Sie au√üerdem nicht, dass Windows 10 sehr hohe Ressourcenanforderungen stellt.  In diesem Beispiel war es m√∂glich, den Speicherverbrauch eines sauberen Systems mehrmals zu messen, und im Ruhezustand waren es ungef√§hr 400 MB.  Zum Vergleich: Linux Debian mit all seinen Add-Ons belegte etwa 200 MB Speicherplatz.  Wenn Sie √ºber mehrere Gigabyte RAM verf√ºgen, ist dies nat√ºrlich kein Problem. Bei Verwendung von Windows und hoch geladenen Clientanwendungen m√ºssen Sie jedoch leistungsst√§rkere Single-Board-Computer verwenden.  Linux ist weniger ressourcenintensiv, aber sehr schwer zu konfigurieren und erfordert einen ordentlichen Ansatz, insbesondere bei der Arbeit mit dem Bootloader.  Dar√ºber hinaus ist es bei der Entwicklung und Implementierung einiger Elemente in das System manchmal erforderlich, einen eigenen Kernel mit speziellen Parametern zusammenzustellen.  Es ist effektiv, erfordert jedoch ein angemessenes Ma√ü an Geschicklichkeit. </p><br><p>  Es ist schwierig, im Rahmen der Erstellung einer sicheren Schnittstelle eine eindeutige Entscheidung zu treffen.  Die Komplexit√§t der Bereitstellung von Systemen ist ungef√§hr gleich.  Die Kosten f√ºr den Erwerb von Windows-Lizenzen f√ºr eine Reihe von Instrumenten k√∂nnen den Kosten f√ºr die Wartung von Systemen unter Linux entsprechen.  Welches System Sie w√§hlen, entscheiden Sie. </p><br><p>  Verschiedene Mensch-Maschine-Schnittstellen, die auf den beschriebenen Beispielen basieren, wurden vom Autor in elektronische Ger√§te f√ºr eine Vielzahl von Anwendungen eingef√ºhrt und haben ihre Funktionsf√§higkeit in der realen Welt bewiesen. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de434086/">https://habr.com/ru/post/de434086/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de434076/index.html">Warum gibt es in Russland kein Bankgeheimnis?</a></li>
<li><a href="../de434078/index.html">Sie m√ºssen nur nehmen und tun: einen neuen Podcast √ºber redaktionelle Projekte und eine Medienkarriere</a></li>
<li><a href="../de434080/index.html">So beenden Sie das Schreiben von Firmware f√ºr Mikrocontroller. Wir fangen an zu leben ...</a></li>
<li><a href="../de434082/index.html">Ein von russischen Wissenschaftlern entwickeltes neuronales Netzwerk hat gelernt, das Alter anhand von Videos mit hoher Genauigkeit zu bestimmen</a></li>
<li><a href="../de434084/index.html">Kann ein Auto aus dem Film "Men in Black" (1997) √ºber die Tunneldecke fahren?</a></li>
<li><a href="../de434088/index.html">So helfen Sie Remote-Mitarbeitern, Einsamkeit und Burnout zu vermeiden</a></li>
<li><a href="../de434090/index.html">Einf√ºhrung eines Vakuumtransistors: Ein Ger√§t aus der Leere</a></li>
<li><a href="../de434092/index.html">Die Menschen, die 1968 gerettet haben</a></li>
<li><a href="../de434096/index.html">Heisenbug 2018 Moskau: Ein Blick aus der Menge</a></li>
<li><a href="../de434098/index.html">CSS nach und vor der Verarbeitung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>