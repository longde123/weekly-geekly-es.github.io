<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ธ ๐ ๐ด ุงูุฒุงูู: ุชุฑุฌูุฉ ngx. ุชุญุณูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุจุงุณุชุฎุฏุงู Webpack ๐๏ธ ๐ข ๐ช๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููู ุฌูุฏ. 


 ุญุงู ุงูููุช ูุงุฎุชุฑุงู ุงูุญูุงุฉ ngx-translate. ูู ุงูุจุฏุงูุฉ ุ ุฎุทุทุช ูุซูุงุซุฉ ุฃุฌุฒุงุก ุ ูููู ูุฃู ุงูุฌุฒุก ุงูุซุงูู ููุณ ูู ุงููุงูุน ุบูู ุจุงููุนูููุงุช - ูู ูุฐุง ุณุฃุญุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุฒุงูู: ุชุฑุฌูุฉ ngx. ุชุญุณูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุจุงุณุชุฎุฏุงู Webpack</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413787/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ููู ุฌูุฏ. </p><br><p style=";text-align:right;direction:rtl">  ุญุงู ุงูููุช ูุงุฎุชุฑุงู ุงูุญูุงุฉ ngx-translate.  ูู ุงูุจุฏุงูุฉ ุ ุฎุทุทุช ูุซูุงุซุฉ ุฃุฌุฒุงุก ุ ูููู ูุฃู ุงูุฌุฒุก ุงูุซุงูู ููุณ ูู ุงููุงูุน ุบูู ุจุงููุนูููุงุช - ูู ูุฐุง ุณุฃุญุงูู ุชูุฎูุต ุงูุฌุฒุก ุงูุซุงูู ุจุฅูุฌุงุฒ ูุฏุฑ ุงูุฅููุงู. </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฌุฒุก ุงูุฃูู</a> </p><br><p style=";text-align:right;direction:rtl"> ุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ <code>AppTranslateLoader</code> ูุงุณุชุจุฏุงู <code>TranslateHttpLoader</code> .  <code>AppTranslateLoader</code> ุฃููุงู ุงูุชูุงููุง ููุบุฉ ุงููุชุตูุญ ูุณูุญุชูู ุนูู ููุทู ุงุญุชูุงุทู ุ ูุงุณุชูุฑุงุฏ ุชูุทูู MomentJs ุ ูุชุญูููู ุนุจุฑ APP_INITIALIZER.  ุฃูุถูุง ุ ูุชูุฌุฉ ููุฌูุน ุจูู ุฌุฒุฃูู ูู ุนูููุงุช ุงุฎุชุฑุงู ุงูุญูุงุฉ ุ ุนูู ุทูู ุงูุทุฑูู ุณูู ูุชุนูู ูู ุฅูุดุงุก ุจููุฉ ุชุญุชูุฉ ูุฑูุญุฉ ููุฑูุฉ ูู ุงููุดุฑูุน. </p><br><p style=";text-align:right;direction:rtl">  ุงููุฏู ุงูุฑุฆูุณู ููุณ <code>AppTranslateLoader</code> (ูุฃูู ุจุณูุท ููุบุงูุฉ ูููุณ ูู ุงูุตุนุจ ุตูุนู) ุ ูููู ุฅูุดุงุก ุงูุจููุฉ ุงูุชุญุชูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุญุงููุช ุงููุชุงุจุฉ ูุฏุฑ ุงูุฅููุงู ุ ูููู ูุฃู ุงูููุงูุฉ ุชุญุชูู ุนูู ุงููุซูุฑ ูู ุงูุฃุดูุงุก ุงูุชู ูููู ูุตููุง ุจูุฒูุฏ ูู ุงูุชูุตูู - ุณูุณุชุบุฑู ุงูุฃูุฑ ุงููุซูุฑ ูู ุงูููุช ููู ูููู ูุซูุฑูุง ููุงูุชูุงู ูุฃููุฆู ุงูุฐูู ูุนุฑููู ุจุงููุนู ููู).  ูุฐูู ุ ูู ุชูู ุงูููุงูุฉ ูุฏูุฉ ููุบุงูุฉ ูููุจุชุฏุฆูู.  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูู ุงูููุงูุฉ ููุงู ุฑุงุจุท ููุซุงู prodg. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  ูุจู ุงูุจุฏุก ุ ุฃูุฏ ุฃู ุฃุดูุฑ ุฅูู ุฃูู ุจุงูุฅุถุงูุฉ ุฅูู ุชูุฒูู ุงููุบุงุช ุนุจุฑ http ุ ูู ุงููููู ูุชุงุจุฉ ูุญูู ุจุทุฑููุฉ ุชููู ุจุชุญููู ุงููุบุงุช ุงูุถุฑูุฑูุฉ ูู ูุฌููุนุชูุง ูู ูุฑุญูุฉ ุงูุชุฌููุน.  ูุจุงูุชุงูู ุ ูุง ุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ุฃู ููุงุฏุฑ ุนุจุฑ http ุ ูููู ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูุน ูุฐุง ุงูููุฌ ุ ุณุชุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุชุทุจูู ูู ูู ูุฑุฉ ูููู ูููุง ุจุชุบููุฑ ูููุงุชูุง ูุน ุงูุชุนุฑูุจ ุ ูุฃูุถูุง ุ ูููู ุฃู ูุคุฏู ุฐูู ุฅูู ุฒูุงุฏุฉ ูุจูุฑุฉ ูู ุญุฌู ุญุฒูุฉ .js. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">// webpack-translate-loader.ts <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { TranslateLoader } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@ngx-translate/core'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Observable } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs/Observable'</span></span>; export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> WebpackTranslateLoader implements TranslateLoader { getTranslation(lang: string): Observable&lt;<span class="hljs-keyword"><span class="hljs-keyword">any</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.fromPromise(<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(`../assets/i18n/${lang}.json`)); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุฃูุณู IDE ุนูู <code>System</code> ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุฅุถุงูุชู ุฅูู typings.d.ts: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> var <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; interface <span class="hljs-keyword"><span class="hljs-keyword">System</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(request: string): Promise&lt;<span class="hljs-keyword"><span class="hljs-keyword">any</span></span>&gt;; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ูููููุง ุงุณุชุฎุฏุงู <code>WebpackTranslateLoader</code> ูู app.module: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">@NgModule({ bootstrap: [<span class="hljs-type"><span class="hljs-type">AppComponent</span></span>], imports: [ <span class="hljs-type"><span class="hljs-type">TranslateModule.forRoot</span></span>({ <span class="hljs-type"><span class="hljs-type">loader</span></span>: { <span class="hljs-type"><span class="hljs-type">provide</span></span>: <span class="hljs-type"><span class="hljs-type">TranslateLoader</span></span>, <span class="hljs-type"><span class="hljs-type">useClass</span></span>: <span class="hljs-type"><span class="hljs-type">WebpackTranslateLoader</span></span> } }) ] }) export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppModule</span></span></span></span> { }</code> </pre> <cut></cut><br><h4 id="apptranslateloader" style=";text-align:right;direction:rtl">  AppTranslateLoader </h4><br><p style=";text-align:right;direction:rtl">  ูุฐุง ุ ูููุจุฏุฃ ูู ูุชุงุจุฉ <code>AppTranslateLoader</code> .  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุฃุฑูุฏ ุชุญุฏูุฏ ุงูุนุฏูุฏ ูู ุงููุดุงูู ุงูุชู ูุฌุจ ููุงุฌูุชูุง ุจุงุณุชุฎุฏุงู <code>TranslateHttpLoader</code> ุงูููุงุณู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  <strong>ุชุฑุฌูุฉ ุงูุฎููุงู.</strong>  ูุง ูุนุฑู <code>TranslateHttpLoader</code> ููููุฉ ุงูุชูููุฐ ูุฌุฒุก ูู ุนูููุฉ ุชููุฆุฉ ุงูุชุทุจูู ููููููุง ุงูุฏุฎูู ูู ูููู ุนูุฏูุง ูุฑู ุจุนุฏ ุงูุชููุฆุฉ ุฃู ูุฏููุง ููุงู ููุชุณููุงุช ุงูุตุญูุญุฉ ูู ุงูุชุทุจูู - ุงูููุงุชูุญ (MY_BUTTON_KEY ูู ููุงู ุงูุฒุฑ ุงูุฎุงุต ุจู) ุ ูุงูุชู ุชุชุบูุฑ ุจุนุฏ ูุญุธุฉ ุฅูู ุงููุต ุงูุตุญูุญ. </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  <strong>ุงูุชูุงุฑูุฎ</strong>  ุณูููู ูู ุงูุฌููู ุฃู ูููู ูุฏูู ุฎุฏูุฉ ุชุญูู ุชูุทูู ุงูุชูุงุฑูุฎ.  ุนูุฏูุง ูุชุนูู ุงูุฃูุฑ ุจุชุนุฑูุจ ุงููุต ุ ูุนูู ุงูุฃุฑุฌุญ ุณูุชุนูู ุนููู ุงูุงูุชูุงู ุจุชูุทูู ุงูุชูุงุฑูุฎ ูุงูุฃููุงุช ููุง ุฅูู ุฐูู.  ููููู ุงุณุชุฎุฏุงู momentJs ุฃู ุญู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">i18n</a> ุงููุฏูุฌ ูู Angular.  ููุง ุงูุญููู ุฌูุฏุงู ุ ููุฏูููุง ุฃูุงุจูุจ Angular 2+ ููุชูุณูู ูู ุทุฑู ุงูุนุฑุถ. </p><br></li><li style=";text-align:right;direction:rtl">  <strong>ุงูุชุฎุฒูู ุงููุคูุช.</strong>  ุจุงุณุชุฎุฏุงู <code>TranslateHttpLoader</code> ุ ูุฌุจ ุนููู ุชูููู ุฎุงุฏู FE ูุชุฎุฒูู ุญุฒู json ุงูุฎุงุตุฉ ุจู ุจุดูู ุตุญูุญ.  ุฎูุงู ุฐูู ุ ุณูู ูุฑู ุงููุณุชุฎุฏููู ุงูุฅุตุฏุงุฑุงุช ุงููุฏููุฉ ูู ุงูุฃูููุฉ ุ ูุงูุฃุณูุฃ ุฃููู ุณูุฑูู ููุงุชูุญ ุงูุฃูููุฉ (ุฅุฐุง ุชูุช ุฅุถุงูุฉ ููุงุชูุญ ุฌุฏูุฏุฉ ุจุนุฏ ุงูุชุฎุฒูู ุงููุคูุช ูู ูุจู ุงููุณุชุฎุฏู).  ูุง ุฃุฑูุฏ ุฃู ุฃุฒุนุฌ ูู ูู ูุฑุฉ ุฃููู ูููุง ุจุงููุดุฑ ุนูู ุฎุงุฏู ุฌุฏูุฏ ูุญุธุฉ ุฅุนุฏุงุฏ ุงูุชุฎุฒูู ุงููุคูุช.  ูุฐูู ุณูุฌุนู Webpack ููุนู ูู ุดูุก ุจุงููุณุจุฉ ููุง ุจุงูุทุฑููุฉ ุงูุชู ููุนููุง ูุญุฒู .js. </li></ul><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณูุฏุฉ AppTranslateLoader</a> </p><cut></cut><br><h5 id="resheniya-problem" style=";text-align:right;direction:rtl">  ุญููู ูููุดุงูู: </h5><br><h6 id="1-problema-translate-flickering---ispolzovat-apptranslateloaderv-ramkah-app_initializer" style=";text-align:right;direction:rtl">  1. ุชุฑุฌูุฉ ูุดููุฉ ุงูุฎููุงู - ุงุณุชุฎุฏู <code>AppTranslateLoader</code> ูุฌุฒุก ูู <code>APP_INITIALIZER</code> </h6><br><p style=";text-align:right;direction:rtl">  ุดุงุฑู APP_INITIALIZER ุฃูุถูุง ุจูุดุงุท ูู ููุงูุฉ ุญูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑูุฒ ุงููููุฒ ููุชุญุฏูุซ</a> ุ ุฅู ูู ููู ูุฐูุฐูุง ุจุดุฃู ุงูููููุฆ - ุฃูุตุญู ุจูุฑุงุกุฉ ุงูููุงูุฉ ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃููุง ุชุชุนูู ุจุงูุฑูุฒ ุงููููุฒ ููุชุญุฏูุซ.  ูู ุงููุงูุน ุ ูุฑุงุฑ ุงุณุชุฎุฏุงู ุงูููููุฆ ูุงุถุญ ุฌุฏูุง (ูุฃููุฆู ุงูุฐูู ูุฏููู ููููุฆ) ุ ูููู ูุง ุฒูุช ุขูู ุฃู ูููู ููุงู ุฃุดุฎุงุต ูู ูุชูุงูู ุงููุฏ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">//app.module.ts export <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">translationLoader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(loader: AppTranslateLoader)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> () =&gt; loader.loadTranslation(); } @NgModule({ bootstrap: [<span class="hljs-type"><span class="hljs-type">AppComponent</span></span>], providers: [ { <span class="hljs-type"><span class="hljs-type">provide</span></span>: <span class="hljs-type"><span class="hljs-type">APP_INITIALIZER</span></span>, <span class="hljs-type"><span class="hljs-type">useFactory</span></span>: <span class="hljs-type"><span class="hljs-type">translationLoader</span></span>, <span class="hljs-type"><span class="hljs-type">deps</span></span>: [<span class="hljs-type"><span class="hljs-type">AppTranslateLoader</span></span>], <span class="hljs-type"><span class="hljs-type">multi</span></span>: <span class="hljs-type"><span class="hljs-type">true</span></span> } ] }) export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppModule</span></span></span></span> { }</code> </pre> <br><h6 id="2-problema-dat-prosto-budem-pereklyuchat-yazyk-v-momentjs-vmeste-c-ngx-tranlate" style=";text-align:right;direction:rtl">  2. ูุดููุฉ ุงูุชูุฑ.  ุณูููู ููุท ุจุชุบููุฑ ุงููุบุฉ ูู ูุญุธุงุช Js ูุน ngx-tranlate. </h6><br><p style=";text-align:right;direction:rtl">  ูู ุดูุก ุจุณูุท ููุง - ุจุนุฏ ุชุญููู json ูุน ุงูุฃูููุฉ ุ ูููู ููุท ุจุชุญููู ุงูุฃูููุฉ ุฅูู momentJs (ุฃู i18n). </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุฌุฏูุฑ ุจุงูุฐูุฑ ุฃูุถูุง ุฃู MomenceJs ุ ูุซู i18n ุ ูููููุง ุงุณุชูุฑุงุฏ ุงูุชูุทูู ุจุดูู ูููุตู ุ ููููู ุฃูุถูุง ูุญุฒูุฉ MomJs ุงุณุชูุฑุงุฏ ุญุฒูุฉ ุ ูููู ุญุฒูุฉ ุงูุชุฑุฌูุงุช ุจุฃููููุง ุชุณุชุบุฑู ~ 260 ููููุจุงูุช ุ ููุง ุชุญุชุงุฌ ุฅูุง ุฅูู ุงุซูุชูู ูููุง. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูุญุงูุฉ ุ ููููู ุงุณุชูุฑุงุฏ ุงุซููู ูููู ููุท ูุจุงุดุฑุฉ ูู ุงูููู ุญูุซ <code>AppTranslateLoader</code> ุงูุชุตุฑูุญ ุนู <code>AppTranslateLoader</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'moment/locale/en-gb'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'moment/locale/ru'</span></span>;</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุณุชููู en-gb ู ru locations ูู ุญุฒูุฉ ุชุทุจููุงุช js.  ูู <code>AppTranslateLoader</code> ููููู ุฅุถุงูุฉ ูุนุงูุฌ ูุบุฉ <code>AppTranslateLoader</code> ุงูุชุญููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs coffeescript"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> Class AppTranslateLoader { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> .... private onLangLoaded(newLang: string) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang !== newLang) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.translate.resetLang(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang = newLang; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.selectedLang = newLang; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> TODO:       <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     ,       <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  en  ru,  momentJs   en. moment().locale(newLang); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  .  momentJs localStorage.setItem(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.storageKey, newLang); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   ls <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadSubj.complete(); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   -      . }</code> </pre> <br><p style=";text-align:right;direction:rtl">  !!!  ูุฐุง ุงููุนุงูุฌ ูุฏูู ุนูุจ: ุฅุฐุง ุชู ุชูููุฑ ุงูุชุฑุฌูุฉ ุจุงููุบุฉ ุงููุญููุฉ ููุท ูู ูุดุฑูุนูุง ูุชุฑุฌูุฉ ngx ุ ูููู ุนูู ุณุจูู ุงููุซุงู ูุญุธุฉ ุฃู ุชุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ุฅูุง en ุฃู en-gb ุ ูุฌุจ ุชูุณูุน ููุทู ุงููุนุงูุฌ ุ ุฃู ูุฌุจ ุชูููุฑ en-localization ูู en-gb ูู ุบุถูู ุชุฑุฌูุฉ ngx. </p><br><p style=";text-align:right;direction:rtl">  !!!  ูู ุงูููุช ุงูุญุงูู ุจุงุณุชุฎุฏุงู // TODO: ูููููุง ูุชุงุจุฉ ูููู ุฅุถุงูู ูุญุฒูุฉ ุงูููุจ ุ ุณููุธุฑ ูู ุจุนุถ ุงูููููุงุช ุงูุฅุถุงููุฉ ูุงุญููุง ุ ูููู ููุณ ูุฏู ูุฐุง ุญุชู ุงูุขู. </p><br><p style=";text-align:right;direction:rtl">  ุชุณุฃู ุ ููุงุฐุง ูู ุงููุณุชุญูู ุชุญููู ุชูุทูู ุงูุชูุงุฑูุฎ ูุงูููุช ููุฐูู ุชูุทูู ุงููุต ูู ุงููุงุฌูุฉ (ุฏููุงูููููุง ุ ุนุจุฑ HTTP)ุ  ูุฐูู ูุฃู ุชุนุฑูุจ ุงูุชุงุฑูุฎ ูุญุชูู ุนูู ููุทูู ุงูุฎุงุต ุ ูุจุงูุชุงูู ูุชู ุชูุฏููู <a href="">ูููุฏ ุฌุงูุง ุณูุฑูุจุช</a> . </p><br><p style=";text-align:right;direction:rtl">  ูููู ุนูู ุงูุฑุบู ูู ุฐูู ุ ููุงู ุทุฑููุฉ ูุชุญููู ูุซู ูุฐู ุงูุชูุทูู ุนู ุทุฑูู ูุชุงุจุฉ ููุฏ ุตุบูุฑ "ูุฐุฑ".  ูุง ุฃุณุชุฎุฏู ูุฐุง ุงูุฑูุฒ ูู ุงูุฅูุชุงุฌ ุ ููู ุงูุชุฑุฌูุฉ ุงูุซุงููุฉ ุฏุงุฎู ุญุฒูุฉ ุจูุฏู ูุง ุชุฒุนุฌูู.  ูููู ุฅุฐุง ูุงู ูุฏูู ุงูุนุฏูุฏ ูู ุงูุชุฑุฌูุงุช ุ ูุฃูุช ุชุฑูุฏ ุชุญููููุง ุฏููุงูููููุง ูููุณ ุจุดูู ุขูู ููุบุงูุฉ ุ ุถุน ูู ุงุนุชุจุงุฑู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadAngularCulture</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">locale</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> angularLocaleText = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.httpClient.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(`assets/angular-locales/${locale}.js`).toPromise(); <span class="hljs-comment"><span class="hljs-comment">// extracting the part of the js code before the data, // and i didn't need the plural so i just replace plural by null. const startPos = angularLocaleText.indexOf('export default '); angularLocaleText = 'return ' + angularLocaleText.substring(startPos + 15).replace('plural', null); // The trick is here : to read cldr data, i use a function const f = new Function(angularLocaleText); const angularLocale = f(); // console.log(angularLocale); // And now, just registrer the object you just created with the function registerLocaleData(angularLocale); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุขุฎุฑ ูุฑุฉ ููุช ุจุงุฎุชุจุงุฑ ูุฐู ุงูุทุฑููุฉ ูู Angular 4. ุนูู ุงูุฃุฑุฌุญ ุฃููุง ุชุนูู ุงูุขู. </p><br><p style=";text-align:right;direction:rtl">  ูุณูุก ุงูุญุธ ุ ูุฅู ูุฐุง ุงูุงุฎุชุฑุงู ุงููุฐุฑ ูู ูุนูู ูู ุญุงูุฉ c momentJs (ุงูุชูุทูู ุงูุฒุงูู ููุท).  ุนูู ุงูุฃูู ูู ุฃุชููู ูู ุงูุนุซูุฑ ุนูู ุทุฑููุฉ ููููุงู ุจุฐูู ุ ูููู ุฅุฐุง ููุช ูุจุฑูุฌูุง ูููุฑุงุตูุฉ ููุชุญูู ููุบุงูุฉ ุ ูุณุฃููู ุณุนูุฏูุง ูุฑุคูุฉ ุงูุญู ูู ุงูุชุนูููุงุช. </p><br><h6 id="3-keshirovanie-podobno-sborke-js-bandla-mozhno-dobavit-k-imeni-json-bandla-hesh" style=";text-align:right;direction:rtl">  3. ุงูุชุฎุฒูู ุงููุคูุช.  ุนูู ุบุฑุงุฑ ุฅูุดุงุก ุญุฒูุฉ .js ุ ููููู ุฅุถุงูุฉ ุชุฌุฒุฆุฉ ูุงุณู ุญุฒูุฉ json. </h6><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ูุชููู ุนูู ููููุฉ ุฌูุน ูู json'es ูู ููู ูุงุญุฏ ุ ุฑุจูุง ูุฏูู ูู ุดูุก ูู ููู ูุงุญุฏ.  ูู ุงูุฅูุชุฑูุช ุ ููููู ุงูุนุซูุฑ ุนูู ุนุฏุฏ ูู ูุญุฏุงุช npm ุงูุชู ูููููุง ุฌูุน json ุตุบูุฑ ูู ููู ูุงุญุฏ.  ูู ุฃุฌุฏ ูู ูุณุชุทูุน ุฅุฑูุงู ุงูุชุฌุฒุฆุฉ ูุฌูุน ูู ุดูุก ูู ููู ูุงุญุฏ.  ูุง ูููู ูู Webpack ููุณูุง ุฃูุถูุง ุงูุชุนุงูู ูุน json ููุง ูู ูุทููุจ ูู ุชูุงุตูู ุชุฑุฌูุฉ ngx.  ูุฐูู ุ ุณููุชุจ ุงูุจุฑูุงูุฌ ุงููุณุงุนุฏ ูุฏููุง webpack. </p><br><p style=";text-align:right;direction:rtl">  ุจุงุฎุชุตุงุฑ: ูุญุชุงุฌ ุฅูู ุฌูุน ูู json ูู ุงููุดุฑูุน ููููุง ูููุท ูุนูู ุ ุจูููุง ูุญุชุงุฌ ุฅูู ุชุฌููุนูุง ุจุงูุงุณู (en ุ ru ุ de ุ ุฅูุฎ) ูุฃูู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุฃู ูููู en.json ูู ูุฌูุฏุงุช ูุฎุชููุฉ.  ุซู ุ ููู ููู ุชู ุฌูุนู ุ ุชุญุชุงุฌ ุฅูู ุฅุฑูุงู ุชุฌุฒุฆุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุงู ูุดููุฉ ููุง.  ููู ูุชุนุฑู <code>AppTranslateLoader</code> ุฃุณูุงุก ุงููููุงุช ุฅุฐุง ูุงู ููู <code>AppTranslateLoader</code> ุงุณููุง ุงูุฎุงุตุ  ุนูู ุณุจูู ุงููุซุงู ุ ุจูุง ูู ุฐูู ุงูุญุฒูุฉ ูู index.html ุ ูููููุง ุชุถููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">HtmlWebpackPlugin</a> ููุทูุจ ููู ุฅุถุงูุฉ ุนูุงูุฉ ูุตูุฉ ุจุงุณู ุงูุญุฒูุฉ ูู ุชููุงุก ููุณูุง. </p><br><p style=";text-align:right;direction:rtl">  ูุญู ูุฐู ุงููุดููุฉ ูุชุฑุฌูุงุช .json ุ ุณูููู ุงููููู ุงูุฅุถุงูู webpack ุจุฅูุดุงุก config.json ุ ูุงูุฐู ุณูุญุชูู ุนูู ุงูุชุฑุงู ุฑูุฒ ุงููุบุฉ ุจุงุณู ููู ุงูุชุฌุฒุฆุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"en"</span></span>: <span class="hljs-string"><span class="hljs-string">"en.some_hash.json"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ru"</span></span>: <span class="hljs-string"><span class="hljs-string">"ru.some_hash.json"</span></span> }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูุชู ุชุฎุฒูู config.json ุฃูุถูุง ูุคูุชูุง ุจูุงุณุทุฉ ุงููุชุตูุญ ุ ููููู ุณูุณุชุบุฑู ุงููููู ููููููุง ุจุจุณุงุทุฉ ุชุญุฏูุฏ ูุนููุฉ queryString ุนุดูุงุฆูุฉ ุนูุฏ ุฒูุงุฏุฉ ุญุฌู ูุฐุง ุงูููู (ูุจุงูุชุงูู ุชุญูููู ุจุงุณุชูุฑุงุฑ ูุฑุฉ ุฃุฎุฑู).  ุฃู ูู ุจุชุนููู ูุนุฑู ุนุดูุงุฆู ูู config.json (ุณุฃุตู ูุฐู ุงูุทุฑููุฉ ุ ูููู ุงูุนุซูุฑ ุนูู ุงูุฃูู ูู Google). </p><br><p style=";text-align:right;direction:rtl">  ุฃุฑูุฏ ุฃูุถูุง ุชุจุณูุท ุงูุจููุฉ ุงูุชุญุชูุฉ ูุฐุฑูุฉ ุงูุชูุทูู ููููุงู.  ุณูู json ูุน ุงูุชุฑุฌูุฉ ูู ุงููุฌูุฏ ูุน ููููู.  ููุชุฌูุจ ุงูููุงุชูุญ ุงูููุฑุฑุฉ ุ ุณูุชู ุจูุงุก ุจููุฉ ุญุฒูุฉ json ุจูุงุกู ุนูู ุงููุณุงุฑ ุฅูู ููู json ูุญุฏุฏ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฏููุง ุงุซูุงู en.json ุ ุฃุญุฏููุง ูููู ูู ุงููุณุงุฑ <code>src/app/article-component</code> element ุ ูุงูุขุฎุฑ <code>src/app/comment-component</code> .  ุฃุฑูุฏ ุงูุญุตูู ุนูู json ุงูุชุงูู ูู ุงูุฅุฎุฑุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"article-component"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"TITLE"</span></span>: <span class="hljs-string"><span class="hljs-string">"Article title"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"comment-component"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"TITLE"</span></span>: <span class="hljs-string"><span class="hljs-string">"Comment title"</span></span> } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููููุง ุชุฌุงูู ุงูุฌุฒุก ูู ุงููุณุงุฑ ุงูุฐู ูุง ูุญุชุงุฌู ุญุชู ุชููู ุงูููุงุชูุญ ูุตูุฑุฉ ูุฏุฑ ุงูุฅููุงู ูู ุทุฑู ุงูุนุฑุถ. </p><br><p style=";text-align:right;direction:rtl">  !!!  ููุงู ุนูุจ: ุนูุฏ ูุถุน ุงููููู ูู ูุฌูุฏ ุขุฎุฑ ุ ุณูุชุบูุฑ ููุชุงุญ ุงูุชุฑุฌูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ููุช ูุงุญู ุ ุณููุธุฑ ูู ุงุฎุชุฑุงู ุขุฎุฑ ููุญูุงุฉ ูุณูุญ ููุง ุจุงูุฅุดุงุฑุฉ ูู ุงููููู ุฅูู ุงูุญูู ุงูุฑุฆูุณู ุงูุฃุฎูุฑ ููุท ุ ุจุบุถ ุงููุธุฑ ุนู ููุงู ููุฏู ุนูู ูุดุฑูุนูุง ูู ุงููุดุฑูุน ุ ูุจุงูุชุงูู ูููููุง ูููู ููุง ูุญุจ ูุฅุนุงุฏุฉ ุชุณููุชู ููุง ูุฑุบุจ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุฃุณุงุณ ุ ุฃุฑูุฏ ุชุญููู ุงูุชุบููู ูุญุชู ุชูููุญูุง ูุชุนุฏุฏ ุงูุฃุดูุงู ุงูุฎุงุต ุจุชุฑุฌูุฉ ngx-translations.  ูุนุฌุจูู ููููู ุชุบููู ุงูุนุฑูุถ ูู Angular - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Angular View Encapsulation</a> ุ ุฃู ุจุงูุฃุญุฑู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DOM ุงูุธู</a> .  ูุนู ุ ูุฐุง ูุฒูุฏ ูู ุญุฌู ุงูุชุทุจูู ููู ุ ูููู ุณุฃููู ูุณุจููุง ุฃูู ุจุนุฏ ุฃู ุฃุตุจุญ ngx-translate ุฃูุซุฑ ุชุบููููุง ุ ุฃุตุจุญ ุงูุนูู ูุน ูููุงุช ุงูุชูุทูู ุฃูุซุฑ ูุชุนุฉ.  ุจุฏุฃุช ุงูููููุงุช ูู ุงูุงูุชูุงู ููุท ุจุงูุชูุทูู ุงูุฎุงุต ุจูุง ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฃูู ุณูููู ูู ุงููููู ุฅุนุงุฏุฉ ุชุนุฑูู ุงูุชูุทูู ูู ุงููููู ุงููุฑุนู ุงุนุชูุงุฏูุง ุนูู ุงูุชูุทูู ูู ุงููููู ุงูุฑุฆูุณู.  ุฃูุถูุง ุ ููููู ุงูุขู ููู ุงูููููุงุช ูู ูุดุฑูุน ุฅูู ูุดุฑูุน ุ ูุณุชุชู ุชุฑุฌูุชูุง ุจุงููุนู.  ูููู ููุง ูู ุงูุญุงู ูู ุฃู ููุงู ุขุฎุฑ ุ ููุงู ูุฑูู ุฏูููุฉ ูู ุฐูู ูุงุญููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ุฏุนูุง ููุชูู ุฅูู ุงููููู ุงูุฅุถุงูู.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุง ูู ูููู</a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฏูุฌ ุงููุณุงุนุฏ ุงูุชุนุฑูุจ</a> . <br>  ูููู ุงูุนุซูุฑ ุนูู ุฑูุฒ ุงููุตุฏุฑ ุงูุฎุงุต ุจุงููุญูู ูุงููููููู ุงูุฅุถุงูู ูู ุฑุงุจุท ุงููุซุงู ุงูููุฌูุฏ ุฃุณูู ุงูููุงูุฉ (ุงููุฌูุฏ ./build-utils). </p><br><p style=";text-align:right;direction:rtl">  ูุนูู ุงููููู ุงูุฅุถุงูู ูู ูุง ูุชุนูู ุจูุง ูู ููุชูุจ ุฃุนูุงู ุ ูููุจู ุงูุฎูุงุฑุงุช ุงูุชุงููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุญุฐู.  ุงูุฃุณูุงุก ูู ูุณุงุฑ ุงูุชูุทูู ุงูุชู ูุฌุจ ุชุฌุงูููุง (ูุฐู ูู ุงููุญุธุฉ ุงูุชู ุฃุฑูุฏ ูููุง ุฅุฒุงูุฉ ุงูุฃุฌุฒุงุก ุงูุฅุถุงููุฉ ูู ุงููุณุงุฑ ุฅูู ุงูููู) </li><li style=";text-align:right;direction:rtl">  ุฅุฏุฎุงู ุงูููู.  ุนุงุฏู ูุฌูุจ ูููุงุช ุงูุชูุทูู ูู prodge (ูุซู ุงูุงุฎุชุจุงุฑ ูู ุญุฒูุฉ ุงูููุจ) </li><li style=";text-align:right;direction:rtl">  rootDir.  ูู ุฃูู ุชุจุฏุฃ ุงูุจุญุซ ุนู ุงููููุงุช ุจููุท fileInput </li><li style=";text-align:right;direction:rtl">  ุงูุฅุฎุฑุงุฌ  ุญูุซ ุณูุชู ุฅูุดุงุก ููู ุงูุชูููู ูุงูุชุนุฑูุจ ูู ูุฌูุฏ dist </li><li style=";text-align:right;direction:rtl">  configName.  ุชุญุช ุฃู ุงุณู ุณูุชู ุฅูุดุงุก ููู ุงูุชูููู. </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ูุดุฑูุนู ุ ูุชู ุชูุตูู ุงููููู ุงูุฅุถุงูู ุจูุฐู ุงูุทุฑููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// build-utils.js // part of METADATA { // ... translationsOutputDir: 'langs/', translationsFolder: '@translations', translationsConfig: `config.${Math.random().toString(36).substr(2, 9)}.json`, } //webpack.common.js new MergeLocalizationPlugin({ fileInput: [`**/${METADATA.translationsFolder}/*.json`, 'app-translations/**/*.json'], rootDir: 'src', omit: new RegExp(`app-translations|${METADATA.translationsFolder}|^app`, 'g'), outputDir: METADATA.translationsOutputDir, configName: METADATA.translationsConfig }),</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฏุงุฎู ุงูููููุงุช ุงูุชู ุชุญุชุงุฌ ุฅูู ุงูุชุฑุฌูุฉ ููุฌุฏ ูุฌูุฏ <code>@translations</code> ุ ููุญุชูู ุนูู en.json ุ ru ุ ุฅูุฎ. </p><br><p style=";text-align:right;direction:rtl">  ููุชูุฌุฉ ูุฐูู ุ ุนูุฏ ุงูุชูููุจ ุ ุณูุชู ุฌูุน ูู ุดูุก ูู ููู ูุงุญุฏ ุ ูุน ูุฑุงุนุงุฉ ุงููุณุงุฑ ุฅูู ุงููุฌูุฏ <code>@translations</code> .  ุณุชููู ุญุฒูุฉ ุงูุชุฑุฌูุฉ ุจุงููุบุฉ dist / langs / ุ ูุณุชุชู ุชุณููุฉ ุงูุชููุฆุฉ ุจุงุณู config. $ {Some-random} .json. </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ุณูุชุฃูุฏ ูู ุชุญููู ุญุฒูุฉ ุงูุฃูููุฉ ุงููุทููุจุฉ ูู ุงูุชุทุจูู.  ููุงู ููุทุฉ ูุดุฉ - ููุท ุญุฒูุฉ ุงูููุจ ุชุนุฑู ุนู ูุณุงุฑ ุงูุชูุทูู ูุงุณู ููู ุงูุชูููู ุ ุฏุนูุง ูุฃุฎุฐ ูุฐุง ูู ุงูุงุนุชุจุงุฑ ุญุชู ุชุฏุฎู ุฃุญุฏุซ ุงูุจูุงูุงุช ุฅูู AppTranslateLoader ูููุณ ููุงู ุญุงุฌุฉ ูุชุบููุฑ ุงูุฃุณูุงุก ูู ููุงููู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">// some inmports // ... // momentJs import * as moment from <span class="hljs-string"><span class="hljs-string">'moment'</span></span>; import <span class="hljs-string"><span class="hljs-string">'moment/locale/en-gb'</span></span>; import <span class="hljs-string"><span class="hljs-string">'moment/locale/ru'</span></span>; @Injectable() export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppTranslateLoader</span></span></span></span> { //            public additionalStorageKey: string = <span class="hljs-string"><span class="hljs-string">''</span></span>; private translationsDir: string; private translationsConfig: string; private selectedLang: string; private fallbackLang: string; private loadedLang: string; private config: { [<span class="hljs-type"><span class="hljs-type">key</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>]: string; } = null; private loadSubs = new Subscription(); private configSubs = new Subscription(); private loadSubj = new Subject(); private get storageKey(): string { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> this.additionalStorageKey ? `APP_LANG_<span class="hljs-variable"><span class="hljs-variable">$</span></span>{this.additionalStorageKey}` : <span class="hljs-string"><span class="hljs-string">'APP_LANG'</span></span>; } constructor(private http: HttpClient, private translate: TranslateService) { //   webpack       //     . this.translationsDir = `${process.env.TRANSLATE_OUTPUT}`; this.translationsConfig = `${process.env.TRANSLATE_CONFIG}`; this.fallbackLang = <span class="hljs-string"><span class="hljs-string">'en'</span></span>; const storedLang = this.getUsedLanguage(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (storedLang) { this.selectedLang = storedLang; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { this.selectedLang = translate.getBrowserLang() || this.fallbackLang; } } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  <code>process.env.TRANSLATE_OUTPUT</code> ูู ูุนูู ุ ูุญุชุงุฌ ุฅูู ุงูุฅุนูุงู ุนู ูููู ุฅุถุงูู ุขุฎุฑ ูู ุญุฒูุฉ ุงูููุจ (DefinePlugin ุฃู EnvironmentPlugin): </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// METADATA declaration const METADATA = { translationsOutputDir: 'langs/', translationsFolder: '@translations', translationsConfig: `config. ${Math.random().toString(36).substr(2, 9)}.json`, }; // complex webpack config... // webpack plugins... new DefinePlugin({ 'process.env.TRANSLATE_OUTPUT': JSON.stringify(METADATA.translationsOutputDir), 'process.env.TRANSLATE_CONFIG': JSON.stringify(METADATA.translationsConfig), }),</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ูููููุง ุชุบููุฑ ูุณุงุฑ ุงูุชูุทูู ูุงุณู ุงูุชูููู ูู ููุงู ูุงุญุฏ ููุท. <br>  ุจุดูู ุงูุชุฑุงุถู ุ ูู ุงูุจูุน ุงูุฒุงูู ุงูุงูุชุฑุงุถู ุงูุฐู ุชู ุฅูุดุงุคู ูู ุชุฌููุน ุญุฒูุฉ ุงูููุจ ( <code>ng eject</code> ) ุ ูุง ููููู ุชุญุฏูุฏ <code>process.env.someValue</code> ูู ุงูููุฏ (ุญุชู ุฅุฐุง ููุช ุชุณุชุฎุฏู DefinePlugin) ุ ูููู ูููุชุฑุฌู ุฃู ููุณู.  ููู ูุนูู ูุฐุง ุ ุชุญุชุงุฌ ุฅูู ุงุณุชููุงุก ุดุฑูุท 2 ุฃ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู main.ts ุ ุฃุถู ุงูุณุทุฑ ุงูุฃูู <code>/// &lt;reference types="node"/&gt;</code> </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูููู ูุฏู package.json <code>@types/node</code> - <code>npm install --save-dev @types/node</code> . </li></ul><br><p style=";text-align:right;direction:rtl">  ููุชูู ูุจุงุดุฑุฉ ุฅูู ุนูููุฉ ุงูุชูููุฏ. <br>  ุฅุฐุง ููุช ุชููู ุงุณุชุฎุฏุงู APP_INITIALIZER ุ ูุชุฃูุฏ ูู ุฅุฑุฌุงุน Promise ุ ูููุณ ููุญูุธูุง.  ูููุชูุง ูู ูุชุงุจุฉ ุณูุณูุฉ ุงุณุชุนูุงู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญุชุงุฌ ุฃููุงู ุฅูู ุชูุฒูู config.json (ููุท ุฅุฐุง ูู ูุชู ุชุญูููู). </li><li style=";text-align:right;direction:rtl">  ุญุงูู ุชุญููู ุงููุบุฉ ุ ููู ูุบุฉ ูุชุตูุญ ุงููุณุชุฎุฏู </li><li style=";text-align:right;direction:rtl">  ุชูููุฑ ููุทู ุงุญุชูุงุทู ุจูุบุฉ ุงูุชูุฒูู ุงูุงูุชุฑุงุถูุฉ. </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> imports @Injectable() AppTranslateLoader { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> fields ... <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    ,         <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>      ,   <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> Subscription    unsubscribe    <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   private loadSubs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Subscription(); private configSubs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Subscription(); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>       -   <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> Subject       private loadSubj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Subject(); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> constructor ... <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  Promise! public loadTranslation(lang: string = <span class="hljs-string"><span class="hljs-string">''</span></span>): Promise&lt;any&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!lang) { lang = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.selectedLang; } <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lang === <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.config) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.configSubs.unsubscribe(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.configSubs = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.http.get&lt;Response&gt;(`<span class="javascript"><span class="javascript">${</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">.translationsDir}${</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">.translationsConfig}</span></span>`) .subscribe(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(config: any)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.config = config; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadAndUseLang(lang); }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadAndUseLang(lang); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadSubj.asObservable().toPromise(); } private loadAndUseLang(lang: string) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadSubs.unsubscribe(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadSubs = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.http.get&lt;Response&gt;(`<span class="javascript"><span class="javascript">${</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">.translationsDir}${</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">.config[lang] || </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">.config[</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">.fallbackLang]}</span></span>`) .subscribe(res =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.translate.setTranslation(lang, res); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.translate.use(lang).subscribe(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onLangLoaded(lang); }, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> fallback  ngx-translate   (err) =&gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onLoadLangError(lang, err)); }, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> fallback  http   (err) =&gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onLoadLangError(lang, err)); } private onLangLoaded(newLang: string) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang !== newLang) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.translate.resetLang(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang = newLang; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.selectedLang = newLang; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> TODO:       <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     ,       <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  en  ru,  momentJs   en. moment().locale(newLang); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  .  momentJs localStorage.setItem(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.storageKey, newLang); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   ls <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadSubj.complete(); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   -      . } private onLoadLangError(langKey: string, error: any) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   ,      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.translate.use(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang) .subscribe( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onLangLoaded(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedLang), <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err)</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadSubj.error(err)); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (langKey !== <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fallbackLang) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>      fallback  <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadAndUseLang(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fallbackLang); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadSubj.error(error); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชู. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุนูุฏ ุฅูู ูุดููุฉ ููู ุงูููููุงุช ุฅูู ูุฌูุฏุงุช ุฃุฎุฑู ุ ูุงูุชุบููู ูุดุจู ุชุนุฏุฏ ุงูุฃุดูุงู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงูุน ุ ูุฏููุง ุจุงููุนู ููุน ูู ุงูุชุบููู.  ูุชู ุฏูุน ุงูุชุนุฑูุจ ุฅูู ูุฌูุฏุงุช ุจุฌูุงุฑ ุงูููููุงุช ุ ูุฌููุน ุงููุณุงุฑุงุช ุงูุฑุฆูุณูุฉ ูุฑูุฏุฉ ูู ููุนูุง ุ ูููู ูุง ูุฒุงู ุจุฅููุงููุง ุชูุทูู ููุงุชูุญ ุจุนุถ ุงููููู 1 ุฏุงุฎู ุจุนุถ ุงููููู 2 ูุณูููู ูู ุงูุตุนุจ ุชุชุจุน ูู ุดูุก ุ ูุณูู ููุชุดู ุฐูู ูุงุญููุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">&lt;some<span class="hljs-literal"><span class="hljs-literal">-component1</span></span> [<span class="hljs-type"><span class="hljs-type">someLabel</span></span>]=<span class="hljs-string"><span class="hljs-string">"'components.some-component2.some_key' | tanslate"</span></span>&gt;&lt;/some<span class="hljs-literal"><span class="hljs-literal">-component1</span></span>&gt; // components.some<span class="hljs-literal"><span class="hljs-literal">-component2</span></span> -    </code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููุง ูุชุนูู ุจุญุฑูุฉ ุงูููููุงุช: <br>  ุงูุขู ุงูููุชุงุญ ุงูุฐู ุณูุณุชุฎุฏูู ูู ุงูุนุฑุถ ูุฑุชุจุท ุจุดูู ุตุงุฑู ุจุงููุณุงุฑ ุงููุณุจู ูููู ุงูุชูุทูู ููุนุชูุฏ ุนูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุงููุญุฏุฏุฉ ูููุดุฑูุน. </p><br><p style=";text-align:right;direction:rtl">  ุณุฃุนุทู ุญุงูุฉ ุญุฒููุฉ ุฅูู ุญุฏ ูุง ูู ูุฐุง ุงููููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">translate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"+lazy-module.components.article-component.article_title"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููู ูุงุฐุง ูู ููุช ุจุชุบููุฑ ุงุณู ุงููุฌูุฏ ุงููููู ุฅูู ูุง ุจุนุฏ ุงูููููุ <br>  ุณูููู ูู ุงูุตุนุจ ุฌุฏูุง ุฅุฏุฎุงู ูุฐุง ุงูููุชุงุญ ูู ุฌููุน ุงูุฃูุงูู ุงูุถุฑูุฑูุฉ.  ุจุงูุทุจุน ุ ูู ููู ุฃุญุฏ ุจุฅูุบุงุก ูุตู ุงููุณุฎ ูุงูุจุญุซ ูุงูุงุณุชุจุฏุงู ุ ูููู ูุชุงุจุฉ ูุฐุง ุฏูู ูุทุงูุจุงุช IDE ุฃูุฑ ูุฑูู ุฃูุถูุง. </p><br><p style=";text-align:right;direction:rtl">  ูุญู ูุฐู ุงููุดููุงุช ุ ุฏุนูุง ููุชุจู ุฅูู ูุง ุชููู ุจู ุญุฒูุฉ ุงูููุจ ุญูุงู ุฐููุ  ูุญุชูู Webpack ุนูู ุดูุก ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุญูู</a> ุ ูููุงู ุงูุนุฏูุฏ ูู ุงูููุงุฏุฑ ุงููุชุงุญุฉ ุงูุชู ุชุนูู ุนูู ูุณุงุฑุงุช ุงููููุงุช: ุนูู ุณุจูู ุงููุซุงู ุ ูุณุงุฑุงุช ุงูููุงุฑุฏ ูู css - ุจูุถู webpack ูููููุง ุชุญุฏูุฏ ุงููุณุงุฑุงุช ุงููุณุจูุฉ ูุตูุฑุฉ ุงูุฎูููุฉ: url (../ ูุณุจูุง. png) ุ ูููุฐุง ุจููุฉ ูุณุงุฑุงุช ุงูููู ูู ุงููุดุฑูุน ูู ูู ููุงู! </p><br><p style=";text-align:right;direction:rtl">  ูุนุฑู ูู ูุงู ุจุจูุงุก ุญุฒู ุงูููุจ ุงูุฎุงุตุฉ ุจู ุฃู ุงููุญูู ูุชููู ููููุง ุนูุฏ ุงูุฅุฏุฎุงู ูุทุงุจู ููุทูุง ูุนูููุง.  ุชุชูุซู ูููุฉ ุงูููุฏุฑ ููุณู ูู ุชุญููู ููู ุงูุฅุฏุฎุงู ูุฐุง ุจุทุฑููุฉ ูุง ูุฅุนุงุฏุชู ุ ููุฒูุฏ ูู ุงูุชุบููุฑุงุช ุจูุงุณุทุฉ ุงูููุงุฏุฑ ุงูุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ูุญู ุจุญุงุฌุฉ ุฅูู ูุชุงุจุฉ ูุญูู ูุฏููุง.  ุงูุณุคุงู ูู ูุง ููุน ุงููููุงุช ุงูุชู ุณูููู ุจุชุบููุฑูุง: ุทุฑู ุงูุนุฑุถ ุฃู ุงูููููุงุชุ  ูู ุฌูุฉ ุ ูููู ุฃู ุชููู ุงููุดุงูุฏุงุช ูุจุงุดุฑุฉ ูู ุงููููู ูุจุดูู ูููุตู.  ูููู ุฃู ุชููู ุงููุดุงูุฏุงุช ูุจูุฑุฉ ุจูุง ููู ุงูููุงูุฉ ููุตุนุจ ุชุญููููุง ุ ุชุฎูู ูุง ุฅุฐุง ูุงู ูุฏููุง ูุฌูุฉ ูุธุฑ ุญูุซ ุชุชุฑุฌู 100 ุชูุฌูู (ููุณ ูู ุญููุฉ): </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs axapta">&lt;<span class="hljs-keyword"><span class="hljs-keyword">div</span></span> id=<span class="hljs-string"><span class="hljs-string">"1"</span></span>&gt;{{<span class="hljs-string"><span class="hljs-string">'./some_key_1'</span></span> | translate}}&lt;/<span class="hljs-keyword"><span class="hljs-keyword">div</span></span>&gt; ... &lt;<span class="hljs-keyword"><span class="hljs-keyword">div</span></span> id=<span class="hljs-string"><span class="hljs-string">"100"</span></span>&gt;{{<span class="hljs-string"><span class="hljs-string">'../another_key_!'</span></span> | translate}}&lt;/<span class="hljs-keyword"><span class="hljs-keyword">div</span></span>&gt;</code> </pre><br><p style=";text-align:right;direction:rtl">  ูู ุฎูุงู ุงูููุฏุฑ ุ ูููููุง ุงุณุชุจุฏุงู ุงููุณุงุฑ ุงูุฑุฆูุณู ูุชุนุฑูุจ ุงูููููุงุช ุจุงููุฑุจ ูู ูู ุฃูุจูุจ ุฃู ุชูุฌูู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs axapta">&lt;<span class="hljs-keyword"><span class="hljs-keyword">div</span></span> id=<span class="hljs-string"><span class="hljs-string">"1"</span></span>&gt;{{<span class="hljs-string"><span class="hljs-string">'app.some-component.some_key_1'</span></span> | translate}}&lt;/<span class="hljs-keyword"><span class="hljs-keyword">div</span></span>&gt; <span class="hljs-comment"><span class="hljs-comment">// app.some-component. -   loader'</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููููุง ุฅุถุงูุฉ ุญูู ุฅูู ูููู ูููุฑ ุงูุชุฑุฌูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs kotlin"><span class="hljs-meta"><span class="hljs-meta">@Component({ selector: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'app-some'</span></span></span><span class="hljs-meta">, template: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'&lt;div&gt;{{(localization + '</span></span></span><span class="hljs-meta">key</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">') | tanslate}}&lt;/div&gt;'</span></span></span><span class="hljs-meta"> })</span></span> export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeComponent</span></span></span><span class="hljs-class"> </span></span>{ localization = <span class="hljs-string"><span class="hljs-string">'./'</span></span> }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅูู ุฃูุฑ ุณูุฆ ุฃูุถูุง - ุนููู ุฅูุดุงุก ููุชุงุญ ุชุนุฑูุจ ูู ูู ููุงู. </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃู ุฃูุซุฑ ุงูุฎูุงุฑุงุช ูุถูุญูุง ุชุจุฏู ุณูุฆุฉ ุ ูุญุงูู ุงุณุชุฎุฏุงู ูุตูู ูุญูุธ ุจุนุถ ุงูุจูุงูุงุช ุงููุตููุฉ ูู ุงููููุฐุฌ ุงูุฃููู ูููููู (ููุง ุชูุนู Angular). </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/gu/_4/vp/gu_4vpfjn_3ujxoh3tragj7wi2s.png" alt="ุงูุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ</strong> - ุงูุจูุงูุงุช ุงููุตููุฉ ููุฏูููุฑ ุงูุฒุงูู <br>  __app_annotations__ - ุงูุจูุงูุงุช ุงููุตููุฉ ุงูุชู ุณูุฎุฒููุง ูุฃููุณูุง </p><br><p style=";text-align:right;direction:rtl">  ูููู ูุชุงุจุฉ ุงููุณุงุฑ ุฅูู ูุฌูุฏ ุงูุชุฑุฌูุฉ ุจุงููุณุจุฉ ูููููู ุฅูู ุงูุฏูููุฑ ุ ููููู ุชูุณูุน ููุณ ุงูุฏูููุฑ ุจุฎูุงุฑุงุช ุฃุฎุฑู ุจุงุณุชุซูุงุก ุงููุณุงุฑ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">//translate.service.ts const app_annotations_key = <span class="hljs-string"><span class="hljs-string">'__app_annotations__'</span></span>; export <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Localization</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path: string)</span></span></span></span> { // tslint:<span class="hljs-built_in"><span class="hljs-built_in">disable-next</span></span><span class="hljs-literal"><span class="hljs-literal">-line</span></span>:only<span class="hljs-literal"><span class="hljs-literal">-arrow</span></span><span class="hljs-literal"><span class="hljs-literal">-functions</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(target: Function)</span></span></span></span> { const metaKey = app_annotations_key; Object.defineProperty(target, metaKey, { value: { //         path. path, name: <span class="hljs-string"><span class="hljs-string">'Translate'</span></span> } } as PropertyDescriptor); }; } //some.component.ts @Component({...}) @Localization({ path: <span class="hljs-string"><span class="hljs-string">'./'</span></span>, otherOptions: {...} }); export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeComponent</span></span></span></span> { }</code> </pre> <br><p style=";text-align:right;direction:rtl">      webpack,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">loader</a>           ,      -    .          ,     (      styleUrls)      . loader,     npm .    . </p><br><p style=";text-align:right;direction:rtl">        ,   -.       ,          -. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs axapta">&lt;<span class="hljs-keyword"><span class="hljs-keyword">div</span></span>&gt;{{<span class="hljs-string"><span class="hljs-string">'just_key'</span></span> | translate}}&lt;/<span class="hljs-keyword"><span class="hljs-keyword">div</span></span>&gt;</code> </pre> <br><p style=";text-align:right;direction:rtl">          .    ,      ,      ,           .    โ Injector, .   ,       Injector,     ''  ,  translate       .      Injector,       (    ),         'get'. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/jl/vw/0x/jlvw0xsep9o3valmkhc3uxblvdm.png" alt="ุงูุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  ,  parent  ,     ,    Injector'a  ,      ,     ,   ,   ,        . </p><br><p style=";text-align:right;direction:rtl">  ,     API,   forwarRef() (    Angular reactive forms,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">control</a> ).  ,      .         . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">// translate.service.ts export const TRANSLATE_TOKEN = new InjectionToken(<span class="hljs-string"><span class="hljs-string">'MyTranslateToken'</span></span>); // app.component.ts @Component({ selector: <span class="hljs-string"><span class="hljs-string">'app-root'</span></span>, templateUrl: <span class="hljs-string"><span class="hljs-string">'./app.component.html'</span></span>, styleUrls: [<span class="hljs-string"><span class="hljs-string">'./app.component.css'</span></span>], providers: [{<span class="hljs-type"><span class="hljs-type">provide</span></span>: <span class="hljs-type"><span class="hljs-type">TRANSLATE_TOKEN</span></span>, <span class="hljs-type"><span class="hljs-type">useExisting</span></span>: <span class="hljs-type"><span class="hljs-type">forwardRef</span></span>(() =&gt; <span class="hljs-type"><span class="hljs-type">AppComponent</span></span>)}] }) @Localization(<span class="hljs-string"><span class="hljs-string">'./'</span></span>) export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppComponent</span></span></span></span> { title = <span class="hljs-string"><span class="hljs-string">'app'</span></span>; }</code> </pre> <br><p style=";text-align:right;direction:rtl">        , ,         ,   forwardRef(). </p><br><p style=";text-align:right;direction:rtl">  ,     Injector     forwardRef()        ,             .       ,        '' .     ,   ,   . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">// my-translate.directive.ts @Directive({ // tslint:<span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-next-<span class="hljs-type"><span class="hljs-type">line</span></span>:directive-selector selector: <span class="hljs-string"><span class="hljs-string">'[myTranslate]'</span></span> }) export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> MyTranslateDirective extends TranslateDirective { @<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>() <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> myTranslate(e: string) { this.translate = e; } private keyPath: string; constructor(private _translateService: TranslateService, private _element: ElementRef, _chRef: ChangeDetectorRef, //    forwardRef() @Inject(TRANSLATE_TOKEN) @Optional() protected cmp: <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>) { super(_translateService, _element, _chRef); //    const prototype = <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.getPrototypeOf(cmp || {}).constructor; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (prototype[app_annotations_key]) { //      this.keyPath = prototype[app_annotations_key].path; } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> updateValue(key: string, node: <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>, translations: <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (this.keyPath) { //     ,   //   key = `${this.keyPath.replace(/\//, <span class="hljs-string"><span class="hljs-string">'.'</span></span>)}.${key}`; } super.updateValue(key, node, translations); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">      . </p><br><p style=";text-align:right;direction:rtl">  -      : </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs django"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{'just_this_component_key' | myTranslate}}</span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> //  </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">myTranslate</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"just_this_component_key"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">    translate , .      ,       ,          -    : </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">//en.bundle.json { "global_key": "Global key" "app-component": { "just_key": "Just key" } } //<span class="hljs-keyword"><span class="hljs-keyword">some</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.html &lt;div translate="global_key"&gt;&lt;/div&gt;</code> </pre> <br><p style=";text-align:right;direction:rtl"> Research and improve! </p><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">full example</a> </p><br><p style=";text-align:right;direction:rtl">       : </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">     FE     node.js   stacktrace.js. </li><li style=";text-align:right;direction:rtl">  Jest  Angular . </li><li style=";text-align:right;direction:rtl"> Web worker )      , ,  Angular  . </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar413787/">https://habr.com/ru/post/ar413787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar413775/index.html">ูุฌูุงุช ุงูุฎุตููุฉ ุนูู ุงูุขูุงุช ูููู ุฃู ุชุฑู 2018</a></li>
<li><a href="../ar413777/index.html">ูุฑุงุกุฉ ุนุทูุฉ ููุงูุฉ ุงูุฃุณุจูุน: ุงูููุงุฏ ุงูุชูููุฏูุฉ ูู IaaS ูุฃูู ุงููุนูููุงุช ูุงูุฃุญุฏุงุซ ุงูุชูุธูููุฉ ูุชูููุฉ ุงููุนูููุงุช</a></li>
<li><a href="../ar413779/index.html">ุชูููุช ูุชุนุฏุฏ ุงูููุงู ุนูู ุงุฑุฏูููู</a></li>
<li><a href="../ar413781/index.html">ููู ุชุชุจุน ููุงุจ ุงูุฏุนุงูุฉ ุงูุฅุนูุงู ุฏุฑุจู ุนูู ุงูุฅูุชุฑูุช</a></li>
<li><a href="../ar413783/index.html">ููู ุชููุช ุฃูุจุฑ ุงููุฌูู: ุงููุณุชุนุฑ ุงูุฃุนุธู ุฃู ุงููุณุชุนุฑ ุงูุฃุนุธู ุฃู ุงูุงูููุงุฑ ุงููุจุงุดุฑุ</a></li>
<li><a href="../ar413789/index.html">ูู ูููุฑูุฏุง ุ ูู ูุชุญูููุง ูู ูุดุชุฑู ุงูุฃุณูุญุฉ ูู ูุงุนุฏุฉ ููุชุจ ุงูุชุญูููุงุช ุงููุฏุฑุงูู ููุฏุฉ ุนุงู ูุฃููู ูุณููุง ูููุฉ ุงููุฑูุฑ</a></li>
<li><a href="../ar413791/index.html">ูููุงูููุง ุงููู ููุญุณุงุจุงุช ูู ุดุจูุจุฉ</a></li>
<li><a href="../ar413793/index.html">ุฃุดุฑุทุฉ ุงูุตูุช ูู ุซูุงูุฉ ุงูุจูุจ: ููุงุฐุง ูุนุชุจุฑ ุชูุณูู ุงูุชุณุฌูู ุงูุตูุชู ุงููุชูุงุฏู ูู ุงููุฃููู ูุฑุฉ ุฃุฎุฑู</a></li>
<li><a href="../ar413795/index.html">ููุงุฐุง ุชูุชูู ุตูุงุนุฉ ุงูุชุฑููู ุฅูู IaaS: ุฏุฑุงุณุฉ ุญุงูุฉ</a></li>
<li><a href="../ar413797/index.html">ูุฏู EA ุงูุฌุฒุก ุงูุฌุฏูุฏ ูู C&C ูู E3. ุฅู ุงููุธุฑ ุฅูููุง ุฃูุฑ ูุคูู ุฌุณุฏููุง</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>