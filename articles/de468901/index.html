<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñäÔ∏è ü§ûüèø ü§∂üèº React Native - Anwendung und Kritik üïµüèª üçø üö∂üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bei der Auswahl dieser Sprache wird meistens erwartet, dass die Entwicklung einer Anwendung f√ºr zwei Plattformen die H√§lfte der Zeit in Anspruch nimmt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>React Native - Anwendung und Kritik</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468901/"><p>  Bei der Auswahl dieser Sprache wird meistens erwartet, dass die Entwicklung einer Anwendung f√ºr zwei Plattformen die H√§lfte der Zeit in Anspruch nimmt als die Entwicklung von zwei Anwendungen.  Am Ende stellt sich jedoch heraus, dass die Entwicklung aufgrund der Schwierigkeiten, die unter der √§u√üeren Brillanz und dem Marketing verborgen sind, genauso viel, wenn nicht sogar mehr kostet.  Wir werden √ºber einige der √§hnlichen Schwierigkeiten sprechen, auf die wir in den letzten Monaten der Arbeit mit React Native gesto√üen sind. </p><a name="habracut"></a><br><p>  React Native passt Javascript f√ºr die mobile Entwicklung an.  Dies wird durch die Tatsache erreicht, dass er mehrere Kollektoren zum Erstellen von Projekten verwendet - Metro Bundler, der den JS-Code interpretiert und die Ressourcen und den Kollektor des Zielsystems darstellt.  In unserem Fall war es ein Gradle f√ºr Android.  Theoretisch sollte die React Native-Anwendung ganz einfach starten.  Der reaktionsnative Befehl run-android aktiviert den Metro Bundler und erstellt die Anwendung f√ºr alle angeschlossenen Android-Ger√§te und Emulatoren. </p><br><p> In Wirklichkeit stellte sich heraus, dass es bereits in diesem Stadium Schwierigkeiten gibt.  In unserem Projekt wurde st√§ndig der Fehler "JS-Bundle kann nicht heruntergeladen werden" angezeigt, sodass der Bundler den Code nicht in den nativen Code √ºbersetzen konnte.  Wie sich sp√§ter herausstellte, aufgrund der Tatsache, dass es nicht gestartet wurde.  StackOverflow best√§tigte die Vermutung und schlug vor, Bundler in einem separaten Thread mit dem Befehl react-native start auszuf√ºhren.  Auf diese Weise k√∂nnen Sie den Bundler nur neu starten, wenn sich package.json ge√§ndert hat, da die Prozedur die Entwicklung nicht wesentlich verlangsamt. </p><br><p>  <em>Package.json</em> ist eine Datei, die eine Reihe externer Module f√ºr die Anwendung enth√§lt.  Bei npmjs.com gibt es eine gro√üe Anzahl verschiedener Bibliotheken f√ºr React Native, die die Funktionalit√§t erweitern und die Entwicklung vereinfachen.  Viele Bibliotheken (z. B. Firebase) verwenden native Funktionen und m√ºssen daher direkt mit nativem Code verkn√ºpft werden.  Verwenden Sie dazu den Befehl react-native link &lt;Bibliotheksname&gt;, mit dem diese Beziehungen mit nativem Code konfiguriert werden sollen. </p><br><p>  Aufgrund der Tatsache, dass alle Bibliotheken zu unterschiedlichen Zeiten geschrieben werden, verwenden sie unterschiedliche Versionen des SDK und erfordern einen anderen Ansatz.  Manchmal kommt es vor, dass Bibliotheken nicht miteinander kompatibel sind oder die neueste Version der Bibliothek experimentell ist und die Entwickler selbst empfehlen, ein Downgrade auf die vorletzte durchzuf√ºhren.  Sehr oft konfiguriert Link nicht alle erforderlichen Abh√§ngigkeiten.  F√ºr die oben genannte Firebase m√ºssen Sie also viele zus√§tzliche Bibliotheken im nativen Code hinzuf√ºgen, verschiedene externe Repositorys verbinden und mainApplication.java √§ndern (und dies gilt nur f√ºr Android!).  F√ºr Firebase gibt es eine ziemlich verst√§ndliche Anweisung zum Ausf√ºhren dieser Aktionen, f√ºr andere Bibliotheken ist sie jedoch nicht immer vorhanden. </p><br><p>  Nachdem die Verbindungen mit dem nativen Code konfiguriert wurden, k√∂nnen Sie das Projekt in der Hoffnung erstellen, dass die verbundene Bibliothek funktioniert.  Beachten Sie beim Zusammenbau, dass Sie bei einem Fehler sicherstellen sollten, dass er genau aufgrund Ihrer Aktionen und nicht aufgrund eines Kollektorfehlers aufgetreten ist.  Um vollst√§ndige Sicherheit zu gew√§hrleisten, sollten Sie die folgende Abfolge von Aktionen ausf√ºhren: </p><br><pre><code class="plaintext hljs">rmdir node_modules /s /q &amp;&amp; npm cache clean - force &amp;&amp; npm i</code> </pre> <br><p>  Dieser Befehl l√∂scht den Ordner node_modules und l√§dt ihn erneut.  Dies ist eine der l√§ngsten Aufgaben, daher lohnt es sich, sie √§u√üerst selten zu verwenden.  Bei einigen Projekten k√∂nnen node_modules bis zu mehreren Gigabyte auf der Festplatte belegen. Daher dauert die Neuinstallation einige Zeit. </p><br><pre> <code class="plaintext hljs">rmdir android/app/build /s /q</code> </pre> <br><p>  W√§hrend der Entwicklung wurde festgestellt, dass der h√§ufig erfolglose Build eine Folge der Tatsache ist, dass der Collector keinen Ordner aus dem Debug-Verzeichnis erstellen (oder l√∂schen) kann.  Diese Aktion l√∂st das Problem, dass durch Reagieren der Ordner nicht selbst gel√∂scht werden kann.  Gleichzeitig dauert das erneute Generieren von Dateien f√ºr diesen Ordner von Grund auf l√§nger. </p><br><pre> <code class="plaintext hljs">react-native start-reset-cache</code> </pre> <br><p>  Starten Sie den Metro Bundler.  Diese Registerkarte sollte w√§hrend des gesamten Debugging-Vorgangs ge√∂ffnet bleiben.  Wenn ein Fehler auftritt, wird m√∂glicherweise das Fehlerprotokoll hier angezeigt.  Wenn ein Fehler auftritt, wird dieser Prozess h√∂chstwahrscheinlich beendet und muss erneut gestartet werden. </p><br><pre> <code class="plaintext hljs">react-native run-android</code> </pre> <br><p>  Installieren Sie die Anwendung auf einem angeschlossenen Ger√§t oder Emulator.  Die meisten Build-Fehler treten hier auf, und einige von ihnen sind verst√§ndlich, andere sind jedoch ziemlich irrational und werden durch einen Neustart des gesamten Prozesses "geheilt". </p><br><p>  Stellen Sie sich den Erstellungsprozess mit einer Folge von Befehlen f√ºr ein Projekt vor (bereits Realm, Redux, React-Navigation, etwa zehn weitere Bibliotheken), nachdem Sie Firebase verbunden haben. </p><br><pre> <code class="plaintext hljs">react-native start react-native run-android &gt;&gt;    debug react-native run-android &gt;&gt; , metro bundler  react-native start react-native run-android &gt;&gt;    debug react-native run-android &gt;&gt;  !  metro bundler ,   JS-   react-native start &gt;&gt;   restart         - </code> </pre><br><p>  Unn√∂tig zu sagen, es dauert wirklich lange?  Und dies ist kein einmaliger Vorgang: Zum beschriebenen Zeitpunkt war dieser Vorgang nach fast jeder √Ñnderung des Programmcodes erforderlich.  Mit jeder neuen Bibliothek wird das Projekt immer weniger stabil, und dieser Prozess kann sich √§ndern, meistens zum Schlechten.  Das Debuggen einer Anwendung ist eine der wichtigsten Funktionen f√ºr einen Entwickler, und in diesem Fall nimmt die Geschwindigkeit erheblich ab. </p><br><p>  Apropos Debuggen.  Der React Native-Debugger hat nicht nur Probleme beim Start.  Die Korrektur von Fehlern, die als Ergebnis des Tests festgestellt wurden, ist ebenfalls ein ziemlich schmerzhafter Prozess.  In React-Native wird der JS-Code in Native-Code √ºbersetzt, w√§hrend der √úbersetzung jedoch verschleiert.  Wenn Sie also keine Fehler wie "Nullzeigerausnahme in zzz.yyy ()" sehen m√∂chten, m√ºssen Sie den integrierten Debugger verwenden. Sie k√∂nnen nicht nur Ausnahmen in logcat lesen.  Bei einem Fehler zeigt der Debugger einen roten "Bildschirm des Todes" mit seiner Beschreibung an, der mehr oder weniger auf den Korrekturpfad zusteuert.  Aber es gibt Probleme mit diesem Teil. </p><br><p>  Nun, wenn der Fehler so aussieht: </p><br><p><img src="https://habrastorage.org/webt/oh/sr/zo/ohsrzozloajbn7g9y0nczb_6zkq.png"></p><br><p>  Es ist wirklich klar, was hier passiert - anstelle des erwarteten Array-Objekts ist this.state.noteArray.map undefiniert, was den ber√ºchtigten TypeError verursacht.  Sie k√∂nnen das Problem beheben, indem Sie in app.js: 14 den Wert dieser Variablen vor der Verwendung √ºberpr√ºfen. </p><br><p>  Schlimmer noch, wenn der Fehler so aussieht: </p><br><p><img src="https://habrastorage.org/webt/wn/hb/6b/wnhb6bq3akewzc6vidymuhnv9ec.png"></p><br><p>  Also: </p><br><p><img src="https://habrastorage.org/webt/tn/-k/oe/tn-koehm2wzsl7gu-4hqemsvpz4.png"></p><br><p>  Oder so: </p><br><p><img src="https://habrastorage.org/webt/qb/jk/qw/qbjkqwgcbm59ffqwesbfholo6zu.png"></p><br><p>  Bilder wurden aus dem Internet aufgenommen, aber wir haben sie live gesehen.  Und trotz der Tatsache, dass sie zur Laufzeit angezeigt werden, ist dieser Fehler nicht darauf zur√ºckzuf√ºhren, dass in Ihrem Code etwas falsch gemacht wurde.  Dies kann daran liegen, dass Sie die Bibliothek falsch installiert haben oder dass Ihre Importe inkompatible Abh√§ngigkeiten aufweisen oder dass im nativen Code ein Fehler aufgetreten ist und React versucht, den Fehler abzufangen.  Jeder Fehler ist individuell und wird sehr unterschiedlich gel√∂st.  Es ist gut, dass es StackOverflow und zumindest eine Art Debugging-Modus gibt. </p><br><p>  Schlimmer noch, wenn ein Fehler beim Debuggen nicht reproduziert wird.  Diese Situation ist aufgetreten, als wir versucht haben, eine Anwendung mit einer neuen Version von React mit Unterst√ºtzung f√ºr die x64-Architektur f√ºr Android zu erstellen.  Bei der Installation einer Anwendung mit einem Debugger funktioniert alles einwandfrei.  Sobald wir den Tester auf dem Telefon erstellen, funktioniert alles nicht mehr und bricht ab, sobald es um die Interaktion mit der Datenbank geht.  Um das Nicht-Debuggen in Eile zu debuggen, verwenden wir Konsolennachrichten, die in diesem Fall die Komponente "toastAndroid reagieren" waren.  Diese Komponente zeigt beim Erreichen einer bestimmten Codezeile einen kurzen Text an.  Methodisch, vorzugsweise durch Teilen des Codes in zwei H√§lften, lokalisieren wir die Funktion, in der der Fehler auftritt, und stellen fest, dass die Object.assign-Methode ({}, item) in der neuen Version von React nicht funktioniert.  Es war ein Gl√ºck, dass Sie diese Funktion durch ein k√ºrzeres {... Element} ersetzen konnten, w√§hrend die Funktionalit√§t der Anwendung beibehalten wurde. Die Suche nach diesem Fehler kostete jedoch etwa ein Dutzend Arbeitsstunden. </p><br><p>  Nach einer kleinen Studie wurde auf der Suche nach Gr√ºnden durchgef√ºhrt.  Wie sich herausstellte, verwendet React Native verschiedene Javascript-Engines zum Interpretieren von JS-Code in Debug- und Produktionsversionen: zum Debuggen der Chrome JS-Engine und in JavaScriptCore.  Ja, React Native √ºbersetzt JavaScript nicht in nativen Code, sondern interpretiert es w√§hrend der Ausf√ºhrung.  Gleichzeitig arbeitet die Debugging-Engine viel stabiler, und daher schleichen sich zunehmend Fehler in die Produktion ein.  In diesem Artikel wird beispielsweise gezeigt, wie die Datumsformatierung unter verschiedenen Bedingungen funktioniert.  Zur√ºck zum Fehler: Es stellte sich heraus, dass die Web-Engine f√ºr die Produktionsproduktion nach dem Aktualisieren der React Native-Version die Unterst√ºtzung f√ºr Object.assign () verlor.  Die Debugging-Engine blieb jedoch dieselbe. </p><br><p>  Die vielleicht schlechteste Option ist der Fall, wenn die Anwendung an zuf√§lligen Stellen unterbrochen wird, nur in der Produktionsversion und ohne Protokolle von React Native.  Beispiel: Nach der Installation der Release-Version der Anwendung auf dem Telefon funktioniert sie "eine Weile" und wird dann "ohne Fehler oder Warnung in einem zuf√§lligen Moment ausgeschaltet".  Dar√ºber hinaus wird der Fehler nicht auf allen Ger√§ten reproduziert.  Am Ende gelang es uns durch Versuch und Irrtum (und durch die Feststellung, dass die oben genannten Firebase Crashlytics nicht die entsprechenden Fehler senden), die Fallprotokolle abzufangen, die so aussahen: </p><br><p><img src="https://habrastorage.org/webt/oh/sr/zo/ohsrzozloajbn7g9y0nczb_6zkq.png"></p><br><p>  Dieser Text gilt nicht einmal f√ºr unsere Bewerbung, er wurde nicht einmal rot markiert.  Aber nachdem wir es bekommen und in die Foren gegangen waren, stellten wir fest, dass die neue Version von React Native kaputt ist.  Und der vorherige war kaputt.  Auf dem offiziellen Issue Tracker bestand der Fehler "Android st√ºrzt ab: Signal 11 (SIGSEGV)" zwei Monate lang, und zu unserem Gl√ºck zwei Tage bevor wir dorthin gingen (!) Wurde eine experimentelle L√∂sung vorgeschlagen, die den Fehler behebt. </p><br><p>  Es ist ironisch, dass einige Entwickler, die sich mit Android Studio auseinandersetzen mussten, ratlos waren, dass die IDE Optionen wie Build / Clean-Projekt oder Datei / Ung√ºltigmachen von Caches hat.  Dies ist erforderlich, um das abnormale Verhalten von Gradle durch falsche Fehlermeldungen und Warnungen sowie durch Synchronisationsfehler zu beseitigen.  Die Entwickler fragten: "Warum sollten wir die Arbeit f√ºr unsere IDE erledigen? In solchen Situationen sollten diese Befehle automatisch ausgef√ºhrt werden."  Und sie k√∂nnen verstanden werden, aber gleichzeitig erledigen moderne IDEs die schwierige Arbeit hinter den Kulissen.  Und diese Entwickler haben einfach nicht mit React Native gearbeitet. </p><br><p>  Alle oben genannten F√§lle sind Einzelf√§lle, die in den letzten Wochen aufgetreten sind.  Hier beschreiben wir nicht die Komplexit√§t der Ausf√ºhrung von Anwendungen mit Expo, da der Codestil in babel / eslint festgelegt ist. Wir schimpfen nicht mit Javascript f√ºr √ºberm√§√üige Flexibilit√§t. Wir sagen nicht, wie das Debuggen aufgrund der Redux / Realm-Verkn√ºpfung bei einem der Projekte fast vollst√§ndig verloren gegangen ist.  Angesichts der beschriebenen Schwierigkeiten bei Support und Entwicklung und der Tatsache, dass bei zwei Systemen alles mit zwei multipliziert wird, lohnt es sich zu √ºberlegen, ob React Native wirklich rentabel ist.  Nachdem wir unser drittes Projekt in dieser Sprache abgeschlossen hatten, entschieden wir uns nicht.  Was denkst du? </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de468901/">https://habr.com/ru/post/de468901/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de468885/index.html">Lerne keine Muster, lerne Konzepte</a></li>
<li><a href="../de468889/index.html">Skript-R√ºckruffunktionen</a></li>
<li><a href="../de468891/index.html">Antiquit√§ten: Betrachten Sie das Motherboard des 386. Computers</a></li>
<li><a href="../de468897/index.html">SwiftUI f√ºr die letzte Wettbewerbsaufgabe Telegram Charts (M√§rz 2019): Alles ist einfach</a></li>
<li><a href="../de468899/index.html">Welche Projekte sind sinnvoll zu starten und was braucht die Branche derzeit von der IT?</a></li>
<li><a href="../de468903/index.html">Die Zukunft geh√∂rt adaptiven Bildungsplattformen. Flow Interview mit Asger Palm</a></li>
<li><a href="../de468905/index.html">Auf dem Weg zur Zug√§nglichkeit</a></li>
<li><a href="../de468907/index.html">Yandex-Demodulation</a></li>
<li><a href="../de468909/index.html">Dank der Zwei-Faktor-Authentifizierung habe ich mein ganzes Geld und drei Jahre Arbeit verloren</a></li>
<li><a href="../de468911/index.html">Hervorragende Fragen und Antworten zu Quantum Excellence</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>