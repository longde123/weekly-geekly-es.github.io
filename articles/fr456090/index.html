<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíú üîª ü•á Introduction aux tests unitaires dans Unity üßìüèª üöæ ü¶á</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="√ätes-vous curieux de savoir comment les tests unitaires fonctionnent dans Unity? Vous ne savez pas ce que sont les tests unitaires en g√©n√©ral? Si vous...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introduction aux tests unitaires dans Unity</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456090/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b63/9d9/71f/b639d971f3e2a10105d91bb3c94fdbb1.jpg" alt="image"></div><br>  √ätes-vous curieux de savoir comment les tests unitaires fonctionnent dans Unity?  Vous ne savez pas ce que sont les tests unitaires en g√©n√©ral?  Si vous avez r√©pondu positivement √† ces questions, ce tutoriel vous sera utile.  De l√†, vous apprendrez ce qui suit sur les tests unitaires: <br><br><ul><li>  Qu'est ce que c'est </li><li>  Son avantage </li><li>  Avantages et inconv√©nients </li><li>  Fonctionnement dans Unity √† l'aide de Test Runner </li><li>  Comment √©crire et ex√©cuter des tests unitaires qui seront test√©s </li></ul><br><blockquote>  <em>Remarque</em> : ce didacticiel suppose que vous connaissez le langage C # et les bases du d√©veloppement dans Unity.  Si vous d√©butez avec Unity, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">consultez d'abord les autres didacticiels sur ce moteur</a> . </blockquote><h2>  Qu'est-ce qu'un test unitaire? </h2><br>  Avant de plonger dans le code, il est important de bien comprendre ce qu'est le test unitaire.  Autrement dit, les tests unitaires testent ... les unit√©s. <br><br>  <em>Le test unitaire</em> (id√©alement) est con√ßu pour tester une unit√© de code distincte.  La composition d'une ¬´unit√©¬ª peut varier, mais il est important de se rappeler que les tests unitaires doivent tester exactement un ¬´√©l√©ment¬ª √† la fois. <br><a name="habracut"></a><br>  Des tests unitaires doivent √™tre cr√©√©s pour v√©rifier qu'un petit morceau logique de code dans un sc√©nario particulier s'ex√©cute exactement comme pr√©vu.  Cela peut √™tre difficile √† comprendre avant de commencer √† √©crire vos propres tests unitaires, alors regardons un exemple: <br><br>  Vous avez √©crit une m√©thode qui permet √† l'utilisateur d'entrer un nom.  La m√©thode est √©crite de mani√®re √† ce que les nombres ne soient pas autoris√©s dans le nom, et le nom lui-m√™me ne peut contenir que dix caract√®res ou moins.  Votre m√©thode intercepte la frappe de chaque touche et ajoute le caract√®re correspondant au champ de <code>name</code> : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> name = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateNameWithCharacter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">: character</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// 1 if (!Char.IsLetter(char)) { return; } // 2 if (name.Length &gt; 10) { return; } // 3 name += character; }</span></span></code> </pre> <br>  Que se passe-t-il ici: <br><br><ol><li>  Si le caract√®re n'est pas une lettre, le code pr√©-quitte la fonction et n'ajoute pas le caract√®re √† la cha√Æne. </li><li>  Si le nom comporte dix caract√®res ou plus, le code ne permet pas √† l'utilisateur d'ajouter un autre caract√®re. </li><li>  Si ces deux v√©rifications sont r√©ussies, le code ajoute un caract√®re √† la fin du nom. </li></ol><br>  Cette unit√© peut √™tre test√©e, car il s'agit d'un "module" du travail effectu√©.  Les tests unitaires <i>appliquent la</i> logique des m√©thodes. <br><br><h2>  Exemple de test unitaire </h2><br>  Comment √©crire des tests unitaires pour la m√©thode <code>UpdateNameWithCharacter</code> ? <br><br>  Avant de commencer √† impl√©menter ces tests unitaires, nous devons examiner attentivement ce que font ces tests et trouver des noms pour eux. <br><br>  Jetez un ≈ìil aux exemples de nom de test unitaire ci-dessous.  D'apr√®s les noms, il doit √™tre clair qu'ils v√©rifient: <br><br> <code>UpdateNameDoesntAllowCharacterAddingToNameIfNameIsTenOrMoreCharactersInLength</code> <br> <br> <code>UpdateNameAllowsLettersToBeAddedToName</code> <br> <br> <code>UpdateNameDoesntAllowNonLettersToBeAddedToName</code> <br> <br>  √Ä partir de ces noms de m√©thodes de test, nous voyons que nous v√©rifions vraiment si ¬´l'unit√©¬ª de travail est <code>UpdateNameWithCharacter</code> par la m√©thode <code>UpdateNameWithCharacter</code> .  Ces noms de test peuvent sembler trop longs et trop d√©taill√©s, mais c'est bon pour nous. <br><br>  Chaque test unitaire que vous √©crivez fait partie d'une suite de tests.  <em>La suite de tests</em> contient tous les tests unitaires li√©s au groupe logique fonctionnel (par exemple, ¬´tests unitaires de combat¬ª).  Si un test du kit √©choue, la suite de tests enti√®re √©choue. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/20d/1e7/0ed/20d1e70ed7231be0c0cfd5f6f082751c.png"></div><br><h2>  Lancement du jeu </h2><br>  Ouvrez le <em>projet Crashteroids Starter</em> (vous pouvez le t√©l√©charger √† <a href="">partir d'ici</a> ), puis ouvrez la sc√®ne de <em>jeu</em> depuis le dossier <em>Assets / RW / Scenes</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/029/6fd/316/0296fd31696c7e75eeea4ec626709277.jpg"></div><br>  Cliquez sur <em>Play</em> pour lancer Crashteroids, puis cliquez sur le bouton <em>Start Game</em> .  D√©placez le vaisseau spatial avec les fl√®ches <em>gauche</em> et <em>droite</em> du clavier. <br><br>  Pour tirer un faisceau laser, appuyez sur la <em>barre d'espace</em> .  Si le faisceau frappe l'ast√©ro√Øde, alors le score augmentera de un.  Si un ast√©ro√Øde entre en collision avec un navire, le navire explose et le jeu se termine (avec la possibilit√© de recommencer). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c2f/cea/c40/c2fceac408455035e41f3c9c268ff448.jpg"></div><br>  Essayez de jouer un peu et assurez-vous qu'apr√®s la collision de l'ast√©ro√Øde avec le navire appara√Æt l'inscription Game Over. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b5/55f/fa6/0b555ffa69f33fb09fb17204197af889.jpg"></div><br><h2>  Premiers pas avec Unity Test Runner </h2><br>  Maintenant que nous savons comment fonctionne le jeu, il est temps d'√©crire des tests unitaires pour v√©rifier que tout fonctionne comme il se doit.  Ainsi, si vous (ou quelqu'un d'autre) d√©cide de mettre √† jour le jeu, vous serez s√ªr que la mise √† jour ne cassera rien qui ait fonctionn√© auparavant. <br><br>  Pour √©crire des tests, vous devez d'abord vous renseigner sur le lanceur de tests Unity.  <em>Test Runner</em> vous permet d'ex√©cuter des tests et de v√©rifier s'ils r√©ussissent.  Pour ouvrir le Runner de test Unity, s√©lectionnez <em>Fen√™tre ‚ñ∏ G√©n√©ral ‚ñ∏ Runner de test</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f48/f31/aa4/f48f31aa4fc16c486b2161c75ba772af.jpg"></div><br>  Une fois le Test Runner ouvert dans une nouvelle fen√™tre, vous pouvez vous simplifier la vie en cliquant sur la fen√™tre du Test Runner et en le <em>faisant glisser</em> √† l'endroit √† c√¥t√© de la fen√™tre Scene. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e10/25b/408/e1025b408f785453827a962ce33aff67.gif"></div><br><h2>  Pr√©paration de NUnit et des dossiers de test </h2><br>  Test Runner est une fonctionnalit√© de test unitaire fournie par Unity, mais elle utilise le framework <em>NUnit</em> .  Lorsque vous commencez √† travailler avec des tests unitaires plus s√©rieusement, je vous recommande d'√©tudier le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">wiki sur NUnit</a> pour en savoir plus.  Tout ce dont vous avez besoin pour la premi√®re fois sera abord√© dans cet article. <br><br>  Pour ex√©cuter les tests, nous devons d'abord cr√©er un dossier de test dans lequel les classes de test seront stock√©es. <br><br>  Dans la fen√™tre <em>Projet,</em> s√©lectionnez le dossier <em>RW</em> .  Jetez un ≈ìil √† la fen√™tre <em>Test Runner</em> et assurez-vous que <em>PlayMode est</em> s√©lectionn√©. <br><br>  Cliquez sur le bouton intitul√© <em>Cr√©er un dossier d'assemblage de test PlayMode</em> .  Vous verrez un nouveau dossier appara√Ætre dans le dossier RW.  Nous sommes satisfaits du nom standard <em>Tests</em> , vous pouvez donc simplement appuyer sur <em>Entr√©e</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5f5/be4/df3/5f5be4df386c8f262c4a3c257b55319f.gif"></div><br>  Vous vous demandez peut-√™tre quels sont ces deux onglets diff√©rents dans Test Runner. <br><br>  L'onglet <em>PlayMode est</em> utilis√© pour les tests effectu√©s en mode Play (lorsque le jeu s'ex√©cute en temps r√©el).  Les tests de l'onglet <em>EditMode sont</em> ex√©cut√©s en dehors du mode Lecture, ce qui est pratique pour tester des choses comme les comportements personnalis√©s dans l'inspecteur. <br><br>  Dans ce tutoriel, nous couvrirons les tests PlayMode.  Mais lorsque vous vous sentez √† l'aise, vous pouvez essayer d'exp√©rimenter les tests dans EditMode.  <em>Lorsque vous travaillez avec Test Runner dans ce didacticiel, assurez-vous toujours que l'onglet PlayMode est s√©lectionn√©</em> . <br><br><h2>  Que contient la suite de tests? </h2><br>  Comme nous l'avons appris ci-dessus, un test unitaire est une fonction qui teste le comportement d'un petit morceau de code sp√©cifique.  Le test unitaire √©tant une m√©thode, pour l'ex√©cuter, il doit √™tre dans le fichier de classe. <br><br>  Test Runner contourne tous les fichiers de classe de test et effectue des tests unitaires √† partir d'eux.  Un fichier de classe contenant des tests unitaires est appel√© une suite de tests. <br><br>  Dans la suite de tests, nous subdivisons logiquement nos tests.  Nous devons s√©parer le code de test en ensembles logiques distincts (par exemple, un ensemble de tests pour la physique et un ensemble distinct pour la bataille).  Dans ce tutoriel, nous n'avons besoin que d'un seul ensemble de tests, et il est temps d'en cr√©er un. <br><br><h2>  Pr√©paration d'un ensemble de tests et d'une suite de tests </h2><br>  S√©lectionnez le dossier <em>Tests</em> et dans la fen√™tre <em>Test Runner</em> cliquez sur le bouton <em>Cr√©er un script de test dans le dossier actuel</em> .  Nommez le nouveau fichier <em>TestSuite</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c64/0ab/968/c640ab968dfd79a3c72e2a99bc5daa2c.gif"></div><br>  En plus du nouveau fichier C #, le moteur Unity cr√©e √©galement un autre fichier appel√© <em>Tests.asmdef</em> .  Il s'agit du <em>fichier de d√©finition d'assembly</em> , qui est utilis√© pour montrer √† Unity o√π se trouvent les d√©pendances du fichier de test.  Cela est n√©cessaire car le code d'application fini est contenu s√©par√©ment du code de test. <br><br>  Si vous avez une situation o√π Unity ne peut pas trouver de fichiers de test ou de tests, assurez-vous qu'il existe un fichier de d√©finition d'assembly qui inclut votre suite de tests.  L'√©tape suivante consiste √† le configurer. <br><br>  Pour que le code de test ait acc√®s aux classes de jeu, nous allons cr√©er un assemblage du code de classe et d√©finir le lien dans l'assemblage de tests.  Cliquez sur le dossier <em>Scripts</em> pour le s√©lectionner.  Cliquez avec le bouton droit sur ce dossier et s√©lectionnez <em>Cr√©er Definition D√©finition d'assemblage</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5b8/24c/84a/5b824c84ad6686493c41951751030b8d.jpg"></div><br>  Nommez le fichier <em>GameAssembly</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21b/bd6/c96/21bbd6c968426c23ea7839dd9f747355.png"></div><br>  Cliquez sur le dossier <em>Tests</em> , puis sur le fichier de d√©finition de g√©n√©ration de <em>tests</em> .  Dans l' <em>inspecteur,</em> cliquez sur le bouton <em>plus</em> sous l'en-t√™te <em>R√©f√©rences de d√©finition d'assemblage</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4be/fc3/d13/4befc3d13ea67e5ec94b707d04582a3d.png"></div><br>  Vous verrez le champ <em>R√©f√©rence manquante</em> .  Cliquez sur le <em>point √†</em> c√¥t√© de ce champ pour ouvrir la fen√™tre de s√©lection.  S√©lectionnez le fichier <em>GameAssembly</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/727/990/57f/72799057fe5ff62ba5c997d5ec2a7563.jpg"></div><br>  Vous devriez voir le fichier d'assemblage GameAssembly dans la section des liens.  Cliquez sur le bouton <em>Appliquer</em> pour enregistrer ces modifications. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a16/bf5/259/a16bf525984f2f23b819d9b2d0e37a2b.png"></div><br>  Si vous ne suivez pas ces √©tapes, vous ne pourrez pas r√©f√©rencer les fichiers de classe du jeu dans les fichiers de test unitaire.  Apr√®s avoir trait√© cela, vous pouvez passer au code. <br><br><h2>  Nous √©crivons le premier test unitaire </h2><br>  Double-cliquez sur le script <em>TestSuite</em> pour l'ouvrir dans l'√©diteur de code.  Remplacez tout le code par ceci: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine.TestTools; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> NUnit.Framework; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TestSuite</span></span> { }</code> </pre> <br>  Quels tests devons-nous passer?  Honn√™tement, m√™me dans un petit jeu comme Crashteroids, vous pouvez √©crire pas mal de tests pour v√©rifier que tout fonctionne comme il se doit.  Dans ce didacticiel, nous nous limitons √† des domaines cl√©s: la reconnaissance des collisions et les m√©canismes de jeu de base. <br><br><blockquote>  <em>Remarque</em> : lorsqu'il s'agit d'√©crire des tests unitaires d'un produit √† un niveau de production, vous devez payer suffisamment de temps pour prendre en compte tous les cas limites qui doivent √™tre test√©s dans tous les domaines du code. </blockquote><br>  Comme premier test, il est agr√©able de v√©rifier si les ast√©ro√Ødes descendent vraiment.  Il leur sera difficile d'entrer en collision avec le navire s'ils s'en √©loignent!  Ajoutez la m√©thode et la variable priv√©e <em>suivantes au</em> script <em>TestSuite</em> : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Game game; <span class="hljs-comment"><span class="hljs-comment">// 1 [UnityTest] public IEnumerator AsteroidsMoveDown() { // 2 GameObject gameGameObject = MonoBehaviour.Instantiate(Resources.Load&lt;GameObject&gt;("Prefabs/Game")); game = gameGameObject.GetComponent&lt;Game&gt;(); // 3 GameObject asteroid = game.GetSpawner().SpawnAsteroid(); // 4 float initialYPos = asteroid.transform.position.y; // 5 yield return new WaitForSeconds(0.1f); // 6 Assert.Less(asteroid.transform.position.y, initialYPos); // 7 Object.Destroy(game.gameObject); }</span></span></code> </pre> <br>  Il n'y a que quelques lignes de code, mais elles font beaucoup de choses.  Alors arr√™tons-nous et traitons chaque partie: <br><br><ol><li>  Ceci est <em>un attribut</em> .  Les attributs d√©finissent des comportements sp√©cifiques du compilateur.  Cet attribut indique au compilateur Unity que le code est un test unitaire.  Pour cette raison, il appara√Ætra dans le Test Runner lors du d√©marrage des tests. </li><li>  Cr√©ez une instance de Game.  Tout le reste est int√©gr√© dans le jeu, donc lorsque nous le cr√©erons, il contiendra tout ce qui doit √™tre test√©.  Dans un environnement de production, il est fort probable que tous les √©l√©ments ne se trouvent pas dans le m√™me pr√©fabriqu√©.  Par cons√©quent, vous devrez recr√©er tous les objets n√©cessaires dans la sc√®ne. </li><li>  Ici, nous cr√©ons un ast√©ro√Øde afin de pouvoir surveiller s'il bouge.  La m√©thode <code>SpawnAsteroid</code> renvoie une instance de l'ast√©ro√Øde cr√©√©.  Le composant Asteroid a une m√©thode <code>Move</code> (si vous √™tes curieux de savoir comment fonctionne le mouvement, vous pouvez jeter un ≈ìil au script <em>Asteroid</em> dans <em>RW / Scripts</em> ). </li><li>  Le suivi de la position de d√©part est n√©cessaire pour s'assurer que l'ast√©ro√Øde est descendu. </li><li>  Tous les tests unitaires Unity sont des coroutines, vous devez donc ajouter un retour progressif.  Nous ajoutons √©galement un pas de temps de 0,1 seconde pour simuler le passage du temps pendant lequel l'ast√©ro√Øde √©tait cens√© descendre.  Si vous n'avez pas besoin de simuler un pas de temps, vous pouvez retourner null. </li><li>  Il s'agit de l'√©tape d' <em>affirmation</em> , dans laquelle nous affirmons que la position de l'ast√©ro√Øde est inf√©rieure √† la position initiale (c'est-√†-dire qu'elle a baiss√©).  La compr√©hension des assertions est une partie importante des tests unitaires, et NUnit propose diverses m√©thodes d'assertion.  La r√©ussite ou l'√©chec du test est d√©termin√© par cette ligne. </li><li>  Bien s√ªr, personne ne vous r√©primandera pour le g√¢chis qui reste apr√®s la fin des tests, mais d'autres tests peuvent √©chouer √† cause de cela.  Il est toujours important de nettoyer (supprimer ou r√©initialiser) le code apr√®s le test unitaire, de sorte que lorsque vous ex√©cutez le prochain test unitaire, il ne reste aucun artefact susceptible d'affecter ce test.  Il nous suffit de supprimer simplement l'objet du jeu, car pour chaque test, nous cr√©ons une toute nouvelle instance du jeu. </li></ol><br><h2>  R√©ussite des tests </h2><br>  Eh bien, vous avez √©crit votre premier test unitaire, mais comment savoir si cela fonctionne?  Bien s√ªr, avec Test Runner!  Dans la fen√™tre Test Runner, d√©veloppez toutes les lignes avec des fl√®ches.  Vous devriez voir le test <code>AsteroidsMoveDown</code> dans la liste avec des cercles gris: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d4c/5d4/05a/d4c5d405a1aa5aded204806790a07233.jpg"></div><br>  Un cercle gris indique que le test n'est pas encore termin√©.  Si le test a √©t√© d√©marr√© et r√©ussi, une fl√®che verte s'affiche √† c√¥t√©.  Si le test a √©chou√©, un X rouge s'affiche √† c√¥t√© de lui. Ex√©cutez le test en cliquant sur le bouton <em>RunAll</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d45/da5/8c9/d45da58c99e0db679578aabab6e5601b.jpg"></div><br>  Cela cr√©era une sc√®ne temporaire et ex√©cutera le test.  Une fois termin√©, vous devriez voir que le test a r√©ussi. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/640/16b/19e/64016b19e01a68544a1644b61ffb5c57.jpg"></div><br>  Vous avez r√©ussi votre premier test unitaire indiquant que les ast√©ro√Ødes cr√©√©s se d√©placent vers le bas. <br><br><blockquote>  <em>Remarque</em> : avant de commencer √† √©crire vos propres tests unitaires, vous devez comprendre l'impl√©mentation que vous testez.  Si vous √™tes curieux de savoir comment fonctionne la logique que vous testez, √©tudiez le code dans le dossier <em>RW / Scripts</em> . </blockquote><br><h2>  Utilisation de tests d'int√©gration </h2><br>  Avant d'aller plus loin dans le lapin des tests unitaires, il est temps de dire ce que sont les tests d'int√©gration et en quoi ils diff√®rent des tests unitaires. <br><br>  <em>Les tests d'int√©gration</em> sont des tests qui v√©rifient comment les "modules" du code fonctionnent ensemble.  ¬´Module¬ª est un autre terme flou.  Une diff√©rence importante est que les tests d'int√©gration doivent tester le fonctionnement du logiciel en production r√©elle (c'est-√†-dire quand un joueur joue vraiment √† un jeu). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f01/824/6f3/f018246f3658664a77104a1fa1dc045b.png"></div><br>  Disons que vous avez cr√©√© un jeu de bataille o√π un joueur tue des monstres.  Vous pouvez cr√©er un test d'int√©gration pour vous assurer que lorsqu'un joueur tue 100 ennemis, un succ√®s est ouvert (¬´Succ√®s¬ª). <br><br>  Ce test affectera plusieurs modules de code.  Tr√®s probablement, il concernera le moteur physique (reconnaissance des collisions), les r√©partiteurs ennemis (surveillance de la sant√© de l'ennemi et traitement des d√©g√¢ts, ainsi que le passage √† d'autres √©v√©nements connexes) et un tracker d'√©v√©nements qui suit tous les √©v√©nements d√©clench√©s (par exemple, ¬´le monstre est tu√©¬ª).  Puis, quand il est temps de d√©bloquer la r√©ussite, il peut appeler le gestionnaire de r√©ussite. <br><br>  Le test d'int√©gration simulera le joueur tuant 100 monstres et v√©rifiera si le succ√®s est d√©bloqu√©.  Il est tr√®s diff√©rent du test unitaire car il teste de gros composants de code qui fonctionnent ensemble. <br><br>  Dans ce tutoriel, nous n'√©tudierons pas les tests d'int√©gration, mais cela devrait montrer la diff√©rence entre l'unit√© de travail (et pourquoi il est test√© unitairement) et le module du code (et pourquoi il est test√© d'int√©gration). <br><br><h2>  Ajout d'un test √† une suite de tests </h2><br>  Le prochain test testera la fin du jeu lorsque le vaisseau entre en collision avec un ast√©ro√Øde.  Avec <em>TestSuite</em> ouvert dans l' <em>√©diteur de</em> code, ajoutez le test ci-dessous sous le premier test unitaire et enregistrez le fichier: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">UnityTest</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameOverOccursOnAsteroidCollision</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameObject gameGameObject = MonoBehaviour.Instantiate(Resources.Load&lt;GameObject&gt;(<span class="hljs-string"><span class="hljs-string">"Prefabs/Game"</span></span>)); Game game = gameGameObject.GetComponent&lt;Game&gt;(); GameObject asteroid = game.GetSpawner().SpawnAsteroid(); <span class="hljs-comment"><span class="hljs-comment">//1 asteroid.transform.position = game.GetShip().transform.position; //2 yield return new WaitForSeconds(0.1f); //3 Assert.True(game.isGameOver); Object.Destroy(game.gameObject); }</span></span></code> </pre> <br>  Nous avons d√©j√† vu la plupart de ce code dans le test pr√©c√©dent, mais il existe quelques diff√©rences: <br><br><ol><li>  Nous for√ßons l'ast√©ro√Øde et le vaisseau √† entrer en collision, donnant clairement √† l'ast√©ro√Øde la m√™me position que le vaisseau.  Cela cr√©era une collision de leurs hitbox et conduira √† la fin du jeu.  Si vous √™tes curieux de savoir comment ce code fonctionne, jetez un ≈ìil aux fichiers <em>Ship</em> , <em>Game</em> et <em>Asteroid</em> dans le dossier Scripts. </li><li>  Un pas de temps est n√©cessaire pour que l'√©v√©nement Collision du moteur physique se d√©clenche, un d√©lai de 0,1 seconde est donc renvoy√©. </li><li>  Cette d√©claration est vraie et v√©rifie que l'indicateur <code>gameOver</code> du script Game est vrai.  Le drapeau devient vrai pendant le jeu, lorsque le navire est d√©truit, c'est-√†-dire que nous testons pour nous assurer qu'il est r√©gl√© sur vrai apr√®s la destruction du navire. </li></ol><br>  Revenez √† la fen√™tre Test Runner et vous verrez qu'un nouveau test unitaire y est apparu. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4a8/f52/b28/4a8f52b2875ca90a37b74348435e3da5.jpg"></div><br>  Cette fois, nous ex√©cuterons celui-ci au lieu de l'ensemble de la suite de tests.  Cliquez sur <em>GameOverOccursOnAsteroidCollision</em> , puis sur le bouton <em>Ex√©cuter la s√©lection</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7e2/0f5/fbd/7e20f5fbd8b4a8a6ff849fea66c90ed1.jpg"></div><br>  Et voila, nous avons pass√© un autre test. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/966/02f/869/96602f869c59d8218407a7ce2e57df7d.jpg"></div><br><h2>  √âtapes de r√©glage et de destruction </h2><br>  Vous avez peut-√™tre remarqu√© que dans nos deux tests, il y a du code r√©p√©titif: o√π l'objet Game est cr√©√© et o√π un lien vers le script Game est d√©fini: <br><br><pre> <code class="cs hljs">GameObject gameGameObject = MonoBehaviour.Instantiate(Resources.Load&lt;GameObject&gt;(<span class="hljs-string"><span class="hljs-string">"Prefabs/Game"</span></span>)); game = gameGameObject.GetComponent&lt;Game&gt;();</code> </pre> <br>  Vous remarquerez √©galement qu'il y a une r√©p√©tition dans la destruction de l'objet Game: <br><br><pre> <code class="cs hljs">Object.Destroy(game.gameObject);</code> </pre> <br>  Lors des tests, cela se produit tr√®s souvent.  Lorsqu'il s'agit d'ex√©cuter des tests unitaires, il y a en fait deux phases: la phase de <em>configuration</em> et la phase de <em>d√©montage</em> . <br><br>  Tout le code √† l'int√©rieur de la m√©thode de configuration sera ex√©cut√© avant le test unitaire (dans cet ensemble), et tout le code √† l'int√©rieur de la m√©thode Tear Down sera ex√©cut√© apr√®s le test unitaire (dans cet ensemble). <br><br>  Il est temps de simplifier nos vies en d√©pla√ßant le code de configuration et de suppression vers des m√©thodes sp√©ciales.  Ouvrez l'√©diteur de code et ajoutez le code suivant au d√©but du fichier <em>TestSuite</em> , juste avant le premier attribut [UnityTest]: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">SetUp</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Setup</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameObject gameGameObject = MonoBehaviour.Instantiate(Resources.Load&lt;GameObject&gt;(<span class="hljs-string"><span class="hljs-string">"Prefabs/Game"</span></span>)); game = gameGameObject.GetComponent&lt;Game&gt;(); }</code> </pre> <br>  L'attribut <code>SetUp</code> indique que cette m√©thode est appel√©e avant chaque <code>SetUp</code> test. <br><br>  Ajoutez ensuite la m√©thode suivante et enregistrez le fichier: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">TearDown</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Teardown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Object.Destroy(game.gameObject); }</code> </pre> <br>  L'attribut <code>TearDown</code> indique que cette m√©thode est appel√©e apr√®s chaque <code>TearDown</code> test. <br><br>  Apr√®s avoir pr√©par√© le code de configuration et de destruction, supprimez les lignes de code pr√©sentes dans ces m√©thodes et remplacez-les par des appels aux m√©thodes correspondantes.  Apr√®s cela, le code ressemblera √† ceci: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TestSuite</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Game game; [SetUp] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Setup</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameObject gameGameObject = MonoBehaviour.Instantiate(Resources.Load&lt;GameObject&gt;(<span class="hljs-string"><span class="hljs-string">"Prefabs/Game"</span></span>)); game = gameGameObject.GetComponent&lt;Game&gt;(); } [TearDown] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Teardown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Object.Destroy(game.gameObject); } [UnityTest] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AsteroidsMoveDown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameObject asteroid = game.GetSpawner().SpawnAsteroid(); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> initialYPos = asteroid.transform.position.y; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">yield</span></span></span><span class="hljs-function"> return new </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WaitForSeconds</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.1f</span></span></span></span></span><span class="hljs-function">)</span></span>; Assert.Less(asteroid.transform.position.y, initialYPos); } [UnityTest] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameOverOccursOnAsteroidCollision</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameObject asteroid = game.GetSpawner().SpawnAsteroid(); asteroid.transform.position = game.GetShip().transform.position; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">yield</span></span></span><span class="hljs-function"> return new </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WaitForSeconds</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.1f</span></span></span></span></span><span class="hljs-function">)</span></span>; Assert.True(game.isGameOver); } }</code> </pre> <br><h2>  Test du Game Over et du tir laser </h2><br>  Apr√®s avoir pr√©par√© les m√©thodes de r√©glage et de destruction qui simplifient nos vies, nous pouvons commencer √† ajouter de nouveaux tests dans lesquels ils sont utilis√©s.  Le test suivant consiste √† v√©rifier que lorsqu'un joueur clique sur <em>New Game</em> , la valeur de <em>gameOver bool n'est</em> pas vraie.  Ajoutez un tel test √† la fin du fichier et enregistrez-le: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">UnityTest</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewGameRestartsGame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//1 game.isGameOver = true; game.NewGame(); //2 Assert.False(game.isGameOver); yield return null; }</span></span></code> </pre> <br>  Cela devrait d√©j√† vous sembler familier, mais il convient de mentionner ce qui suit: <br><br><ol><li>  Ce morceau de code pr√©pare ce test pour que le drapeau bool√©en <code>gameOver</code> soit vrai.  Lors de l'appel de la m√©thode <code>NewGame</code> , il doit √† nouveau d√©finir l'indicateur sur <code>false</code> . </li><li>  Ici, nous soutenons que bool <code>isGameOver</code> est <code>false</code> , ce qui devrait √™tre vrai lors de l'appel d'un nouveau jeu. </li></ol><br>  Revenez √† Test Runner et vous devriez voir qu'il y a un nouveau test <em>NewGameRestartsGame</em> .  Ex√©cutez ce test, comme nous l'avons fait auparavant, et vous verrez qu'il s'ex√©cute avec succ√®s: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b63/9d9/71f/b639d971f3e2a10105d91bb3c94fdbb1.jpg"></div><br><h2>  D√©claration du faisceau laser </h2><br>  Le prochain test consiste √† ajouter le test selon lequel le faisceau laser tir√© par le navire vole (semblable au premier test unitaire que nous avons √©crit).  Ouvrez le fichier <em>TestSuite</em> dans l'√©diteur.  Ajoutez la m√©thode suivante et enregistrez le fichier: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">UnityTest</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LaserMovesUp</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// 1 GameObject laser = game.GetShip().SpawnLaser(); // 2 float initialYPos = laser.transform.position.y; yield return new WaitForSeconds(0.1f); // 3 Assert.Greater(laser.transform.position.y, initialYPos); }</span></span></code> </pre> <br>  Voici ce que fait ce code: <br><br><ol><li>  Obtient un lien vers le faisceau laser g√©n√©r√© √©mis par le navire. </li><li>  La position de d√©part est enregistr√©e afin que nous puissions v√©rifier qu'elle monte. </li><li>  Cette d√©claration est coh√©rente avec la d√©claration du test unitaire <code>AsteroidsMoveDown</code> , seulement maintenant nous affirmons que la valeur est sup√©rieure (c'est-√†-dire que le laser monte). </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrez le fichier et revenez √† Test Runner. </font><font style="vertical-align: inherit;">Ex√©cutez le test </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LaserMovesUp</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et observez </font><em><font style="vertical-align: inherit;">comment</font></em><font style="vertical-align: inherit;"> il passe:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ce/a15/242/2cea152426f82ea491345ead3f0eaa94.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Maintenant, vous devriez d√©j√† commencer √† comprendre comment tout fonctionne, il est donc temps d'ajouter les deux derniers tests et de terminer le didacticiel. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V√©rifier que le laser d√©truit les ast√©ro√Ødes </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ensuite, nous nous assurerons que lorsqu'il est touch√©, le laser d√©truit l'ast√©ro√Øde. </font><font style="vertical-align: inherit;">Ouvrez l'√©diteur et ajoutez le </font><font style="vertical-align: inherit;">test suivant </font><font style="vertical-align: inherit;">√† la fin de </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TestSuite</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , puis enregistrez le fichier:</font></font><br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">UnityTest</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LaserDestroysAsteroid</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// 1 GameObject asteroid = game.GetSpawner().SpawnAsteroid(); asteroid.transform.position = Vector3.zero; GameObject laser = game.GetShip().SpawnLaser(); laser.transform.position = Vector3.zero; yield return new WaitForSeconds(0.1f); // 2 UnityEngine.Assertions.Assert.IsNull(asteroid); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Voici comment cela fonctionne: </font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nous cr√©ons un ast√©ro√Øde et un faisceau laser, et leur attribuons la m√™me position pour d√©clencher une collision. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'agit d'un test sp√©cial avec une distinction importante. </font><font style="vertical-align: inherit;">Vous voyez que nous utilisons explicitement </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UnityEngine.Assertions</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour ce test </font><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">En effet, Unity a une classe </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Null</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sp√©ciale </font><font style="vertical-align: inherit;">qui est diff√©rente de la classe Null ¬´r√©guli√®re¬ª. </font><font style="vertical-align: inherit;">Une instruction d'infrastructure NUnit </font></font><code>Assert.IsNull()</code> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne fonctionnera pas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans les contr√¥les Unity pour null. </font><font style="vertical-align: inherit;">Lors de la v√©rification de null dans Unity, vous devez utiliser explicitement UnityEngine.Assertions.Assert, et non Assert √† partir de NUnit.</font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Revenez √† Test Runner et ex√©cutez un nouveau test. </font><font style="vertical-align: inherit;">Vous verrez une ic√¥ne verte nous plaire.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/275/80f/1b2/27580f1b206647e0a2fd09c43577ee8f.jpg"></div><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tester ou ne pas tester - telle est la question </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La d√©cision de s'en tenir aux tests unitaires n'est pas une d√©cision facile et ne doit pas √™tre prise √† la l√©g√®re. Cependant, les avantages des tests valent la peine. Il y a m√™me une m√©thodologie de d√©veloppement, appel√© le </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©veloppement pilot√© par les </font><font style="vertical-align: inherit;">tests</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Test Driven Development, TDD). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En travaillant dans le cadre de TDD, vous √©crivez des tests avant d'√©crire la logique d'application elle-m√™me. Tout d'abord, vous cr√©ez des tests, assurez-vous que le programme ne les r√©ussit pas, puis √©crivez uniquement du code con√ßu pour passer les tests. Cela peut √™tre une approche tr√®s diff√©rente du codage, mais cela garantit que vous √©crivez le code d'une mani√®re adapt√©e aux tests. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gardez cela √† l'esprit lorsque vous commencez √† travailler sur votre prochain projet. Mais pour l'instant, il est temps d'√©crire vos propres tests unitaires, pour lesquels vous avez besoin d'un jeu que nous vous avons fourni.</font></font><br><br><blockquote> <em></em> :    ‚Äî    ,    .   ,           .    ¬´¬ª ,   ,      .   ,             .        ,        .       ,     ,            . </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Les tests peuvent √™tre un gros investissement, alors consid√©rez les avantages et les inconv√©nients de l'ajout de tests unitaires √† votre projet: </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Avantages des tests unitaires </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Les tests unitaires pr√©sentent de nombreux avantages importants, notamment: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cela donne confiance que la m√©thode se comporte comme pr√©vu. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sert de documentation pour les nouvelles personnes √©tudiant la base de code (les tests unitaires sont parfaits pour l'enseignement). </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vous fait √©crire du code d'une mani√®re testable. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Permet d'isoler et de corriger les erreurs plus rapidement. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il ne permet pas aux futures mises √† jour d'ajouter de nouveaux bogues √† l'ancien code de travail (ils sont appel√©s erreurs de r√©gression). </font></font></li></ul><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Inconv√©nients des tests unitaires </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, vous pouvez ne pas avoir le temps ni le budget pour les tests unitaires. </font><font style="vertical-align: inherit;">Voici ses inconv√©nients √† consid√©rer:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L'√©criture de tests peut prendre plus de temps que le code lui-m√™me. </font></font></li><li>       . </li><li>      . </li><li> ,        . </li><li>         ,    -. </li><li>     (       ),       . </li><li> -    . </li><li> UI  . </li><li>           . </li><li>              . </li></ul><br><h2>  ,       </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est temps d'√©crire le dernier test. </font><font style="vertical-align: inherit;">Ouvrez l'√©diteur de code, ajoutez le code ci-dessous √† la fin du fichier </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TestSuite</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et enregistrez-le:</font></font><br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">UnityTest</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DestroyedAsteroidRaisesScore</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// 1 GameObject asteroid = game.GetSpawner().SpawnAsteroid(); asteroid.transform.position = Vector3.zero; GameObject laser = game.GetShip().SpawnLaser(); laser.transform.position = Vector3.zero; yield return new WaitForSeconds(0.1f); // 2 Assert.AreEqual(game.score, 1); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'agit d'un test important, qui v√©rifie que lorsqu'un joueur d√©truit un ast√©ro√Øde, le score augmente. </font><font style="vertical-align: inherit;">Voici en quoi il consiste:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous cr√©ons un ast√©ro√Øde et un faisceau laser, et les mettons dans une position. </font><font style="vertical-align: inherit;">Pour cette raison, une collision survient qui d√©clenche une augmentation du score.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La d√©claration selon laquelle game.score est d√©sormais de 1 (et non de 0, comme c'√©tait le cas au d√©but). </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Enregistrez le code et revenez √† Test Runner pour ex√©cuter ce dernier test et voir s'il ex√©cute le jeu: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e5d/d4c/0ee/e5dd4c0ee4ad72e21a180621c65c11ba.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G√©nial! </font><font style="vertical-align: inherit;">Tous les tests ont r√©ussi.</font></font><br><br><h2>  O√π aller ensuite? </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans l'article, nous avons examin√© une grande quantit√© d'informations. </font><font style="vertical-align: inherit;">Si vous souhaitez comparer votre travail avec le projet final, regardez-le dans les </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archives</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dont un lien est √©galement indiqu√© au d√©but de l'article. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans ce didacticiel, vous avez appris ce que sont les tests unitaires et comment les √©crire dans Unity. </font><font style="vertical-align: inherit;">En outre, vous avez √©crit six tests unitaires qui ont r√©ussi le code et vous √™tes familiaris√© avec certains des avantages et des inconv√©nients des tests unitaires. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous vous sentez confiant? </font><font style="vertical-align: inherit;">Ensuite, vous pouvez √©crire de nombreux autres tests. </font><font style="vertical-align: inherit;">Examinez les fichiers de classe du jeu et essayez d'√©crire des tests unitaires pour d'autres parties du code. </font><font style="vertical-align: inherit;">Pensez √† ajouter des tests pour les sc√©narios suivants:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chaque type d'ast√©ro√Øde lorsque vous touchez le vaisseau m√®ne √† la fin de la partie. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Commencer une nouvelle partie r√©initialise le score. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Le mouvement √† gauche et √† droite du navire fonctionne correctement. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous souhaitez approfondir vos connaissances sur les tests unitaires, il vaut la peine d'explorer la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mise en ≈ìuvre de d√©pendances</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cadres pour travailler avec des objets fictifs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Cela peut grandement simplifier la configuration du test. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lisez √©galement la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation NUnit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour en savoir plus sur le cadre NUnit. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et n'h√©sitez pas √† partager vos r√©flexions et vos questions sur les forums. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test r√©ussi!</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr456090/">https://habr.com/ru/post/fr456090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr456078/index.html">Projection de conflit d'entreprise sur la connectivit√© r√©seau</a></li>
<li><a href="../fr456082/index.html">Comment nous d√©veloppons des recommandations de produits personnalis√©es</a></li>
<li><a href="../fr456084/index.html">Kubernetes 1.15: Aper√ßu des faits saillants</a></li>
<li><a href="../fr456086/index.html">Storyboards iOS: analyse des avantages et des inconv√©nients, meilleures pratiques</a></li>
<li><a href="../fr456088/index.html">Probl√®mes d'analyse du Big Data</a></li>
<li><a href="../fr456092/index.html">Sept signes troublants que vous d√©pendez des conditions m√©t√©orologiques, m√™me si vous ne le pensez pas</a></li>
<li><a href="../fr456094/index.html">Nous lisons les fiches techniques 2: SPI sur STM32; Temporisateurs et interruptions PWM sur le STM8</a></li>
<li><a href="../fr456096/index.html">Ce que fait le lecteur de geektimes moyen en planant dans les nuages</a></li>
<li><a href="../fr456100/index.html">Maintenant dans le nouvel emballage - Kingston A400 au format M.2 se pr√©cipite sur le march√©</a></li>
<li><a href="../fr456102/index.html">Rapports faciles en C / C ++</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>