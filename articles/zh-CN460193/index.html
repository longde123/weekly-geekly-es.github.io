<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ›‘ ğŸ–¼ï¸ âš“ï¸ åœ¨Windowsä¸Šçš„NetXMSä¸Šç›‘è§†è¯ä¹¦åˆ°æœŸ ğŸ¤² ğŸ» ğŸ˜„</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ€è¿‘ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ç›‘è§†WindowsæœåŠ¡å™¨ä¸Šè¯ä¹¦çš„æœ‰æ•ˆæœŸã€‚ å¥½å§ï¼Œåœ¨è¯ä¹¦å¤šæ¬¡å˜æˆå—ç“œä¹‹åï¼Œæˆ‘åˆèµ·åºŠäº†ï¼Œè€Œè´Ÿè´£ç»­ç­¾çš„å¤§èƒ¡å­åŒäº‹æ­£åœ¨ä¼‘å‡ã€‚ åœ¨é‚£ä¹‹åï¼Œæˆ‘ä»¬æ€€ç–‘äº†ä»€ä¹ˆå¹¶å†³å®šè€ƒè™‘ä¸€ä¸‹ã€‚ ç”±äºæˆ‘ä»¬æ­£åœ¨æ…¢æ…¢å¼•å…¥NetXMSç›‘è§†ç³»ç»Ÿï¼Œå› æ­¤å®ƒå·²æˆä¸ºè¯¥ä»»åŠ¡çš„ä¸»è¦ä¸”ä»åŸåˆ™ä¸Šè®²æ˜¯å”¯ä¸€çš„å€™é€‰è€…ã€‚ 

 æœ€ç»ˆè·å¾—çš„ç»“æœå¦‚ä¸‹ï¼š...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ¨Windowsä¸Šçš„NetXMSä¸Šç›‘è§†è¯ä¹¦åˆ°æœŸ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460193/">æœ€è¿‘ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ç›‘è§†WindowsæœåŠ¡å™¨ä¸Šè¯ä¹¦çš„æœ‰æ•ˆæœŸã€‚ å¥½å§ï¼Œåœ¨è¯ä¹¦å¤šæ¬¡å˜æˆå—ç“œä¹‹åï¼Œæˆ‘åˆèµ·åºŠäº†ï¼Œè€Œè´Ÿè´£ç»­ç­¾çš„å¤§èƒ¡å­åŒäº‹æ­£åœ¨ä¼‘å‡ã€‚ åœ¨é‚£ä¹‹åï¼Œæˆ‘ä»¬<s>æ€€ç–‘äº†ä»€ä¹ˆå¹¶</s>å†³å®šè€ƒè™‘ä¸€ä¸‹ã€‚ ç”±äºæˆ‘ä»¬æ­£åœ¨æ…¢æ…¢å¼•å…¥NetXMSç›‘è§†ç³»ç»Ÿï¼Œå› æ­¤å®ƒå·²æˆä¸ºè¯¥ä»»åŠ¡çš„ä¸»è¦ä¸”ä»åŸåˆ™ä¸Šè®²æ˜¯å”¯ä¸€çš„å€™é€‰è€…ã€‚ <br><br> æœ€ç»ˆè·å¾—çš„ç»“æœå¦‚ä¸‹ï¼š <br><br><img src="https://habrastorage.org/webt/pf/wa/9q/pfwa9qmxenfj334rth33mcitz80.png"><br><br> è¿™ä¸ªè¿‡ç¨‹æœ¬èº«å°±æ›´è¿›ä¸€æ­¥äº†ã€‚ <br><a name="habracut"></a><br> èµ°å§  NetXMSä¸­æ²¡æœ‰ç”¨äºä½¿è¯ä¹¦åˆ°æœŸçš„å†…ç½®è®¡æ•°å™¨ï¼Œå› æ­¤æ‚¨éœ€è¦åˆ›å»ºè‡ªå·±çš„è®¡æ•°å™¨å¹¶ä½¿ç”¨è„šæœ¬å‘å…¶æä¾›æ•°æ®ã€‚ å½“ç„¶ï¼Œåœ¨Powershellä¸Šæ˜¯Windowsã€‚ è¯¥è„šæœ¬åº”è¯»å–æ“ä½œç³»ç»Ÿä¸­çš„æ‰€æœ‰è¯ä¹¦ï¼Œä»æ­¤å¤„è·å–ä»¥å¤©ä¸ºå•ä½çš„åˆ°æœŸæ—¥æœŸï¼Œå¹¶å°†æ­¤ç¼–å·ä¼ è¾“åˆ°NetXMSã€‚ é€šè¿‡ä»–çš„ç»çºªäººã€‚ è®©æˆ‘ä»¬ä»ä»–å¼€å§‹ã€‚ <br><br>  <b>é€‰é¡¹ä¸€</b> ï¼Œæœ€ç®€å•ã€‚ ä»…è·å–è¯ä¹¦åœ¨æœ€è¿‘çš„æ—¥æœŸä¹‹å‰è¿‡æœŸçš„å¤©æ•°ã€‚ <br><br> ä¸ºäº†ä½¿NetXMSæœåŠ¡å™¨äº†è§£æˆ‘ä»¬çš„è‡ªå®šä¹‰å‚æ•°çš„å­˜åœ¨ï¼Œå®ƒå¿…é¡»ä»ä»£ç†æ¥æ”¶å®ƒã€‚ å¦åˆ™ï¼Œç”±äºç¼ºå°‘æ­¤å‚æ•°ï¼Œå› æ­¤æ— æ³•æ·»åŠ ã€‚ å› æ­¤ï¼Œåœ¨<b>nxagentd.conf</b>ä»£ç†é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªåä¸º<b>HTTPS.CertificateExpireDateSimple</b>çš„å¤–éƒ¨å‚æ•°è¡Œï¼Œåœ¨å…¶ä¸­ç¼–å†™äº†è¦è¿è¡Œçš„è„šæœ¬ï¼š <br><br><pre><code class="plaintext hljs">ExternalParameter = HTTPS.CertificateExpireDateSimple: powershell.exe -File "\\server\share\NetXMS_CertExpireDateSimple.ps1"</code> </pre> <br> é‰´äºè„šæœ¬æ˜¯é€šè¿‡ç½‘ç»œè¿è¡Œçš„ï¼Œæ‚¨ä¸€å®šä¸è¦å¿˜è®°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">æ‰§è¡Œç­–ç•¥</a> ï¼Œä¹Ÿä¸è¦å¿˜è®°å¦ä¸€ä¸ªâ€œ -NoLogo -NoProfile -NonInteractiveâ€ï¼Œä¸ºäº†æ›´å¥½åœ°è¯»å–ä»£ç ï¼Œæˆ‘çœç•¥äº†è¯¥ä»£ç ã€‚ <br><br> ç»“æœï¼Œä»£ç†é…ç½®çœ‹èµ·æ¥åƒè¿™æ ·ï¼š <br><br><pre> <code class="plaintext hljs"># # NetXMS agent configuration file # Created by agent installer at Thu Jun 13 11:24:43 2019 # MasterServers = netxms.corp.testcompany.ru ConfigIncludeDir = C:\NetXMS\etc\nxagentd.conf.d LogFile = {syslog} FileStore = C:\NetXMS\var SubAgent = ecs.nsm SubAgent = filemgr.nsm SubAgent = ping.nsm SubAgent = logwatch.nsm SubAgent = portcheck.nsm SubAgent = winperf.nsm SubAgent = wmi.nsm ExternalParameter = HTTPS.CertificateExpireDateSimple: powershell.exe -File "\\server\share\NetXMS_CertExpireDateSimple.ps1"</code> </pre> <br> ä¹‹åï¼Œæ‚¨éœ€è¦ä¿å­˜é…ç½®å¹¶é‡æ–°å¯åŠ¨ä»£ç†ã€‚ æ‚¨å¯ä»¥ä»NetXMSæ§åˆ¶å°æ‰§è¡Œæ­¤æ“ä½œï¼šæ‰“å¼€é…ç½®ï¼ˆç¼–è¾‘ä»£ç†çš„é…ç½®æ–‡ä»¶ï¼‰ï¼Œç¼–è¾‘ï¼Œæ‰§è¡Œâ€œä¿å­˜å¹¶åº”ç”¨â€ï¼Œç»“æœå°†å‘ç”Ÿå®Œå…¨ç›¸åŒçš„äº‹æƒ…ã€‚ å¦‚æœç»å¯¹æ²¡æœ‰ç­‰å¾…çš„å¼ºåº¦ï¼Œåˆ™é‡æ–°è¯»å–é…ç½®ï¼ˆâ€œè½®è¯¢â€&gt;â€œé…ç½®â€ï¼‰ã€‚ è¿™äº›æ­¥éª¤ä¹‹åï¼Œæ‚¨åº”è¯¥å¯ä»¥æ·»åŠ æˆ‘ä»¬çš„è‡ªå®šä¹‰å‚æ•°ã€‚ <br><br> åœ¨NetXMSæ§åˆ¶å°ä¸­ï¼Œæˆ‘ä»¬è½¬åˆ°å®éªŒæœåŠ¡å™¨çš„â€œ <b>æ•°æ®æ”¶é›†é…ç½®â€</b> ï¼Œæˆ‘ä»¬å°†åœ¨è¯¥æœåŠ¡å™¨ä¸Šç›‘è§†è¯ä¹¦å¹¶åœ¨è¯¥æœåŠ¡å™¨ä¸Šåˆ›å»ºæ–°å‚æ•°ï¼ˆå°†æ¥ï¼Œåœ¨è®¾ç½®ä¹‹åï¼Œæœ‰å¿…è¦å°†å…¶ä¼ è¾“åˆ°æ¨¡æ¿ä¸­ï¼‰ã€‚ æˆ‘ä»¬ä»åˆ—è¡¨ä¸­é€‰æ‹©HTTPS.CertificateExpireDateSimpleï¼Œè¾“å…¥å¸¦æœ‰å‹å¥½åç§°çš„Descriptionï¼Œå°†ç±»å‹è®¾ç½®ä¸ºIntegerå¹¶è®¾ç½®è½®è¯¢é—´éš”ã€‚ ä½¿å…¶å¤ªçŸ­ä»¥è‡³äºä¸ä¼šç”¨ä¸å¿…è¦çš„ä¿¡æ¯é˜»å¡æ•°æ®åº“æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œæ£€æŸ¥æ—¶ç­‰å¾…å¤ªé•¿æ—¶é—´ä¼šå¾ˆä¸æ–¹ä¾¿ã€‚ å¯¹äºè¯ä¹¦ï¼Œæˆ‘é€šå¸¸è®¾ç½®600ç§’ã€‚ åœ¨è°ƒè¯•æ—¶ï¼Œå°†å…¶ç¼©çŸ­ä¸º30ç§’æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä¾‹å¦‚ï¼š <br><br><img src="https://habrastorage.org/webt/q_/r2/gy/q_r2gyru9rrf4rexqombopnjohg.png"><br><br> ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œåªè¦è¶³å¤Ÿã€‚ æ‚¨å¯ä»¥æ£€æŸ¥...ä¸ï¼Œä¸ºæ—¶è¿‡æ—©ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å½“ç„¶ä»€ä¹ˆä¹Ÿå¾—ä¸åˆ°ã€‚ åªæ˜¯å› ä¸ºè„šæœ¬å°šæœªç¼–å†™ã€‚ æˆ‘ä»¬çº æ­£äº†è¿™ä¸€é—æ¼ã€‚ è¯¥è„šæœ¬åªä¼šç»™å‡ºä¸€ä¸ªæ•°å­—ï¼Œå³è¯ä¹¦è¿‡æœŸä¹‹å‰å‰©ä½™çš„å¤©æ•°ã€‚ æ‰€æœ‰å¯ç”¨çš„æœ€å°çš„ã€‚ ç¤ºä¾‹è„šæœ¬ï¼š <br><br><pre> <code class="powershell hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">#       $lmCertificates = @( Get-ChildItem -Recurse -path 'Cert:\LocalMachine\My' -ErrorAction Stop ) #   ,  "10 " if ($lmCertificates.Count -eq 0) { return 3650 } #  Expiration Date   $expirationDates = @( $lmCertificates | ForEach-Object { return $_.NotAfter } ) #    Expiration Date   $minExpirationDate = ($expirationDates | Measure-Object -Minimum -ErrorAction Stop ).Minimum #    Expiration Date          $daysLeft = [Math]::Floor( ($minExpirationDate - [DateTime]::Now).TotalDays ) #   return $daysLeft } catch { return -1 }</span></span></code> </pre> <br> åŸæ¥æ˜¯è¿™æ ·çš„ï¼š <br><br><img src="https://habrastorage.org/webt/gt/wg/r0/gtwgr01zmsst4vl8mw-2h2du1cm.png"><br><br>  723å¤©ï¼Œè¯ä¹¦è¿‡æœŸå°†è¿‘ä¸¤å¹´ã€‚ è¿™æ˜¯åˆä¹é€»è¾‘çš„ï¼Œå› ä¸ºæˆ‘æœ€è¿‘åœ¨Exchangeæµ‹è¯•å¹³å°ä¸Šé‡æ–°ç­¾ç½²äº†è¯ä¹¦ã€‚ <br><br> è¿™æ˜¯ä¸€ä¸ªç®€å•çš„é€‰æ‹©ã€‚ ä¹Ÿè®¸æœ‰äººä¼šå¯¹æ­¤æ„Ÿåˆ°æ»¡æ„ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¦æ›´å¤šã€‚ æˆ‘ä»¬å°†ä»»åŠ¡è®¾ç½®ä¸ºè‡ªå·±ï¼Œä»¥åç§°çš„å½¢å¼è·å–æœåŠ¡å™¨ä¸Šæ‰€æœ‰è¯ä¹¦çš„åˆ—è¡¨ï¼Œå¹¶ä¸ºæ¯ä¸ªè¯ä¹¦æŸ¥çœ‹è¯ä¹¦è¿‡æœŸä¹‹å‰å‰©ä½™çš„å¤©æ•°ã€‚ <br><br>  <b>ç¬¬äºŒç§é€‰æ‹©</b> ï¼Œç¨å¾®å¤æ‚ä¸€ç‚¹ã€‚ <br><br> å†æ¬¡ï¼Œæˆ‘ä»¬ç¼–è¾‘ä»£ç†é…ç½®ï¼Œå¹¶åœ¨å…¶ä¸­ä»£æ›¿å…¶ä»–ä¸ExternalParameterçš„è¡Œä¸€èµ·ç¼–å†™å¦å¤–ä¸¤ä¸ªï¼š <br><br><pre> <code class="plaintext hljs">ExternalList = HTTPS.CertificateNames: powershell.exe -File "\\server\share\netxms_CertExternalNames.ps1" ExternalParameter = HTTPS.CertificateExpireDate(*): powershell.exe -File "\\server\share\netxms_CertExternalParameter.ps1" -CertificateId "$1"</code> </pre> <br> åœ¨<b>ExternalListä¸­ï¼Œ</b>æˆ‘ä»¬ä»…è·å¾—å­—ç¬¦ä¸²åˆ—è¡¨ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ˜¯å¸¦æœ‰è¯ä¹¦åç§°çš„å­—ç¬¦ä¸²åˆ—è¡¨ã€‚ è¿™äº›è¡Œçš„åˆ—è¡¨æˆ‘ä»¬å¯ä»¥è·å–è„šæœ¬ã€‚ åˆ—è¡¨åç§°ä¸º<b>HTTPS.CertificateNames</b> ã€‚ <br><br> è„šæœ¬NetXMS_CertNames.ps1ï¼š <br><br><pre> <code class="powershell hljs"><span class="hljs-comment"><span class="hljs-comment">#    $nameTypeList = @( [System.Security.Cryptography.X509Certificates.X509NameType]::SimpleName, [System.Security.Cryptography.X509Certificates.X509NameType]::DnsName, [System.Security.Cryptography.X509Certificates.X509NameType]::DnsFromAlternativeName, [System.Security.Cryptography.X509Certificates.X509NameType]::UrlName, [System.Security.Cryptography.X509Certificates.X509NameType]::EmailName, [System.Security.Cryptography.X509Certificates.X509NameType]::UpnName ) #  ,    $certList = @( Get-ChildItem -Path 'Cert:\LocalMachine\My' | Where-Object { $_.HasPrivateKey -eq $true } ) #   ,   "  -  - Thumbprint"    foreach ($cert in $certList) { $name = '(unknown name)' try { $thumbprint = $cert.Thumbprint $dateExpire = $cert.NotAfter foreach ($nameType in $nameTypeList) { $name_temp = $cert.GetNameInfo( $nameType, $false) if ($name_temp -ne $null -and $name_temp -ne '') { $name = $name_temp; break; } } Write-Output "$($name) - $($dateExpire.ToString('dd.MM.yyyy')) - [T:$($thumbprint)]" } catch { Write-Error -Message "Error processing certificate list: $($_.Exception.Message)" } }</span></span></code> </pre> <br> åœ¨<b>ExternalParameterä¸­ï¼Œ</b>æˆ‘ä»¬å·²ç»ä»ExternalListåˆ—è¡¨ä¸­è¾“å…¥äº†è¡Œï¼Œå¹¶ä¸”åœ¨è¾“å‡ºä¸­ï¼Œæ¯è¡Œçš„å¤©æ•°ç›¸åŒã€‚ æ ‡è¯†ç¬¦æ˜¯æŒ‡çº¹è¯ä¹¦ã€‚ è¯·æ³¨æ„ï¼Œæ­¤é€‰é¡¹ä¸­çš„HTTPS.CertificateExpireDateåŒ…å«ä¸€ä¸ªæ˜Ÿå·ï¼ˆ*ï¼‰ã€‚ è¿™æ˜¯å¿…é¡»çš„ï¼Œä»¥ä¾¿å®ƒæ¥å—å¤–éƒ¨å˜é‡ï¼Œä»…æ¥å—æˆ‘ä»¬çš„CertificateIdã€‚ <br><br> è„šæœ¬NetXMS_CertExpireDate.ps1ï¼š <br><br><pre> <code class="powershell hljs"><span class="hljs-comment"><span class="hljs-comment">#   $CertificateId param ( [Parameter(Mandatory=$false)] [String]$CertificateId ) #   if ($CertificateId -eq $null) { Write-Error -Message "CertificateID parameter is required!" return } # Thumbprint    $CertificateId      Expiration Date $certId = $CertificateId; try { if ($certId -match '^.*\[T:(?&lt;Thumbprint&gt;[A-Z0-9]+)\]$') { $thumbprint = $Matches['Thumbprint'] $certificatePath = "Cert:\LocalMachine\My\$($thumbprint)" if (Test-Path -PathType Leaf -Path $certificatePath ) { $certificate = Get-Item -Path $certificatePath; $certificateExpirationDate = $certificate.NotAfter $certificateDayToLive = [Math]::Floor( ($certificateExpirationDate - [DateTime]::Now).TotalDays ) Write-Output "$($certificateDayToLive)"; } else { Write-Error -Message "No certificate matching this thumbprint found on this server $($certId)" } } else { Write-Error -Message "CertificateID provided in wrong format. Must be FriendlyName [T:&lt;thumbprint&gt;]" } } catch { Write-Error -Message "Error while executing script: $($_.Exception.Message)" }</span></span></code> </pre> <br> åœ¨â€œæ•°æ®æ”¶é›†æœåŠ¡å™¨é…ç½®â€ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°å‚æ•°ã€‚ åœ¨â€œå‚æ•°â€ä¸­ï¼Œä»åˆ—è¡¨ä¸­é€‰æ‹©æˆ‘ä»¬çš„<b>HTTPS.CertificateExpireDateï¼ˆ*ï¼‰</b> ï¼Œç„¶åï¼ˆæ³¨æ„ï¼ï¼‰å°†æ˜Ÿå·æ›´æ”¹ä¸º<b>{instance}</b> ã€‚ è¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œæ‚¨å¯ä»¥ä¸ºæ¯ä¸ªå®ä¾‹ï¼ˆè¯ä¹¦ï¼‰åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„è®¡æ•°å™¨ã€‚ å…¶ä½™çš„ä¸ä»¥å‰çš„ç‰ˆæœ¬ç›¸åŒï¼š <br><br><img src="https://habrastorage.org/webt/iz/js/yw/izjsywknmc_7lrph5axbulycbx4.png"><br><br> ä¸ºäº†ä½¿è®¡æ•°å™¨æˆä¸ºåˆ›å»ºå¯¹è±¡ï¼Œåœ¨â€œå®ä¾‹å‘ç°â€é€‰é¡¹å¡ä¸Šï¼Œä»åˆ—è¡¨ä¸­é€‰æ‹©â€œä»£ç†åˆ—è¡¨â€ï¼Œç„¶ååœ¨â€œåˆ—è¡¨åç§°â€å­—æ®µä¸­ï¼Œä»è„šæœ¬HTTPS.CertificateNamesè¾“å…¥æˆ‘ä»¬çš„ExternalListçš„åç§°ã€‚ <br><br> å‡ ä¹å‡†å¤‡å°±ç»ªï¼Œè¯·ç¨ç­‰ä¸€ä¸‹ï¼Œå¦‚æœå®Œå…¨æ— æ³•ç­‰å¾…ï¼Œåˆ™å¼ºåˆ¶è½®è¯¢&gt;é…ç½®å’Œè½®è¯¢&gt;å®ä¾‹å‘ç°ã€‚ ç»“æœï¼Œæˆ‘ä»¬è·å¾—äº†æ‰€æœ‰å¸¦æœ‰åˆ°æœŸæ—¥æœŸçš„è¯ä¹¦ï¼š <br><br> <a href="" title="æŸ¥çœ‹åŸå§‹å›¾åƒ" rel="nofollow"><img src="https://habrastorage.org/webt/4i/6g/rb/4i6grbiuzscvt_9jsr7oo8vlr10.png"></a> <br><br> éœ€è¦ä»€ä¹ˆï¼Ÿ å¥½å§ï¼Œæ˜¯çš„ï¼Œåªæœ‰å®Œç¾ä¸»ä¹‰è •è™«ä¼šä»¥æ‚²ä¼¤çš„çœ¼ç¥ä»¥æŸœå°çš„åä¹‰æ³¨è§†ç€è¿™ä¸ªä¸å¿…è¦çš„æ‹‡æŒ‡æŒ‡çº¹ï¼Œå¹¶ä¸”æ— æ³•å®Œæˆæœ¬æ–‡ã€‚ è¦å…»æ´»ä»–ï¼Œè¯·å†æ¬¡æ‰“å¼€è®¡æ•°å™¨å±æ€§ï¼Œç„¶ååœ¨â€œå®ä¾‹å‘ç°è¿‡æ»¤å™¨è„šæœ¬â€å­—æ®µçš„â€œå®ä¾‹å‘ç°â€é€‰é¡¹å¡ä¸Šï¼Œæ·»åŠ ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">NXSL</a> ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">NetXMS</a>å†…éƒ¨è¯­è¨€ï¼‰ç¼–å†™çš„è„šæœ¬ï¼š <br><br><pre> <code class="javascript hljs">instance = $<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (instance ~= <span class="hljs-string"><span class="hljs-string">"^(.*)\s\-\s\[T\:[a-zA-Z0-9]+\]$"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> %(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, instance, $<span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>;</code> </pre> <br> è¿™å°†è¿‡æ»¤æŒ‡çº¹ï¼š <br><br><img src="https://habrastorage.org/webt/79/js/hr/79jshrqquu9hvwmkyxppz1tmr_k.png"><br><br> ä¸ºäº†æ˜¾ç¤ºè¿‡æ»¤æ¡ä»¶ï¼Œè¯·åœ¨â€œæè¿°â€å­—æ®µçš„â€œå¸¸è§„â€é€‰é¡¹å¡ä¸Šï¼Œå°†CertificateExpireDateï¼š{instance}æ›´æ”¹ä¸º<b>CertificateExpireDateï¼š{instance-name}</b> ï¼š <br><br><img src="https://habrastorage.org/webt/lb/wt/t_/lbwtt_qjjy-91-nduegszqkfyze.png"><br><br> ä¸€åˆ‡ï¼Œæœ€å<abbr title="æ³¨æ„å›¾ç‰‡">KDPV</abbr>çš„å®Œæˆï¼š <br><br> <a href="" title="æŸ¥çœ‹åŸå§‹å›¾åƒ" rel="nofollow"><img src="https://habrastorage.org/webt/jy/gw/ce/jygwce-b5rghps1aojzw7piqkhk.png"></a> <br><br> ç¾ä¸½å— <br><br> ä»ç„¶éœ€è¦é…ç½®è­¦æŠ¥ï¼Œä»¥ä¾¿åœ¨è¯ä¹¦åœ¨å…¶é€»è¾‘æœ«æœŸåˆ°æœŸæ—¶é€šè¿‡é‚®ä»¶åˆ°è¾¾è­¦æŠ¥ã€‚ <br><br>  1.é¦–å…ˆï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªäº‹ä»¶æ¨¡æ¿ï¼Œä»¥åœ¨å°†è®¡æ•°å™¨å€¼å‡å°åˆ°æˆ‘ä»¬è®¾ç½®çš„æŸä¸ªé˜ˆå€¼æ—¶å°†å…¶æ¿€æ´»ã€‚ åœ¨â€œ <b>äº‹ä»¶é…ç½®â€ä¸­ï¼Œ</b>åˆ›å»ºä¸¤ä¸ªå…·æœ‰åç§°çš„æ–°æ¨¡æ¿ï¼Œä¾‹å¦‚å¸¦æœ‰è­¦å‘ŠçŠ¶æ€çš„<b>CertificateExpireDate_Threshold_Activate</b> ï¼š <br><br><img src="https://habrastorage.org/webt/rh/nc/se/rhncseix1uuw3agz4ioeyx3d02u.png"><br><br> ä»¥åŠå…·æœ‰æ­£å¸¸çŠ¶æ€çš„ç±»ä¼¼<b>CertificateExpireDate_Threshold_Deactivate</b> ã€‚ <br><br>  2.æ¥ä¸‹æ¥ï¼Œè½¬åˆ°è®¡æ•°å™¨å±æ€§ï¼Œç„¶ååœ¨â€œé˜ˆå€¼â€é€‰é¡¹å¡ä¸Šè®¾ç½®é˜ˆå€¼ï¼š <br><br><img src="https://habrastorage.org/webt/zu/tm/6y/zutm6yv1byvr5kuzbvhbegm7hro.png"><br><br> åœ¨å…¶ä¸­é€‰æ‹©åˆ›å»ºçš„äº‹ä»¶CertificateExpireDate_Threshold_Activateå’ŒCertificateExpireDate_Threshold_Deactivateï¼Œè®¾ç½®æµ‹é‡æ¬¡æ•°ï¼ˆæ ·æœ¬ï¼‰ä¸º1ï¼ˆå…·ä½“æ¥è¯´ï¼Œæ²¡æœ‰è®¾ç½®ç‰¹å®šçš„è®¡æ•°å™¨ï¼‰ï¼Œä¾‹å¦‚ï¼Œè¯¥å€¼ä¸º30ï¼ˆå¤©ï¼‰ï¼Œé‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬è®¾ç½®äº†äº‹ä»¶é‡å¤æ—¶é—´ã€‚ å¯¹äºç”Ÿäº§ä¸­çš„è¯ä¹¦ï¼Œæˆ‘æ¯å¤©è®¾ç½®ä¸€æ¬¡ï¼ˆ86400ç§’ï¼‰ï¼Œå¦åˆ™æ‚¨å¯èƒ½ä¼šæ·¹æ²¡åœ¨è­¦æŠ¥ä¸­ï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè­¦æŠ¥å‘ç”Ÿäº†ä¸€æ¬¡ï¼Œè€Œä¸”å‘¨æœ«é‚®ç®±å·²æ»¡ï¼‰ã€‚ å¯¹äºè°ƒè¯•ï¼Œå¯ä»¥å°†æ—¶é—´è®¾ç½®å¾—æ›´çŸ­ä¸€äº›ï¼Œä¾‹å¦‚60ç§’ã€‚ <br><br>  3.åœ¨<b>â€œæ“ä½œé…ç½®â€ä¸­ï¼Œ</b>åˆ›å»ºè­¦æŠ¥æ¶ˆæ¯æ¨¡æ¿ï¼Œä¾‹å¦‚ï¼š <br><br><img src="https://habrastorage.org/webt/3i/a1/z8/3ia1z8vqbnn260wcs0cqvfx6s0o.png"><br><br> æ‰€æœ‰è¿™äº›ï¼…mï¼Œï¼…Sç­‰  -å°†æ›¿æ¢æˆ‘ä»¬å‚æ•°ä¸­çš„å€¼çš„å®ã€‚ å®ƒä»¬åœ¨NetXMS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">æ‰‹å†Œ</a>ä¸­æœ‰æ›´è¯¦ç»†çš„æè¿°ã€‚ <br><br>  4.æœ€åï¼Œç»“åˆå‰é¢çš„å‡ ç‚¹ï¼Œåœ¨<b>äº‹ä»¶å¤„ç†ç­–ç•¥ä¸­</b>åˆ›å»ºä¸€æ¡è§„åˆ™ï¼Œé€šè¿‡è¯¥è§„åˆ™å°†åˆ›å»ºè­¦æŠ¥å¹¶å‘é€æ¶ˆæ¯ï¼š <br><br> <a href="" title="æŸ¥çœ‹åŸå§‹å›¾åƒ" rel="nofollow"><img src="https://habrastorage.org/webt/dg/yw/3b/dgyw3bg6yk1iqbogvunteln3sek.png"></a> <br><br> æˆ‘ä»¬éµå®ˆæ”¿ç­–ï¼Œä¸€åˆ‡éƒ½å¯ä»¥æµ‹è¯•ã€‚ è®¾ç½®æ›´é«˜çš„é˜ˆå€¼è¿›è¡ŒéªŒè¯ã€‚ æˆ‘æœ€è¿‘çš„è¯ä¹¦åœ¨723å¤©åè¿‡æœŸï¼Œæˆ‘è®¾ç½®äº†724è¿›è¡ŒéªŒè¯ï¼Œç»“æœæ”¶åˆ°ä»¥ä¸‹è­¦æŠ¥ï¼š <br><br><img src="https://habrastorage.org/webt/vu/56/z_/vu56z_zmsfu2g5jz2yqi9l8zf6i.png"><br><br> ä»¥åŠè¿™æ ·çš„é‚®ä»¶è­¦æŠ¥ï¼š <br><br><img src="https://habrastorage.org/webt/zz/vy/a8/zzvya8x9qqdaaqwdjkrzjyuhu1m.png"><br><br> ç°åœ¨å°±è¿™äº›äº†ã€‚ å½“ç„¶ï¼Œæ‚¨å¯ä»¥è®¾ç½®ä»ªè¡¨æ¿ï¼Œæ„å»ºå›¾å½¢ï¼Œä½†æ˜¯å¯¹äºè¯ä¹¦æ¥è¯´ï¼Œè¿™å°†æ˜¯æ¯«æ— æ„ä¹‰ä¸”æ— èŠçš„ç›´çº¿ï¼Œä¾‹å¦‚ï¼Œä¸åŒäºCPUæˆ–å†…å­˜è´Ÿè½½çš„å›¾å½¢ã€‚ ä½†æ˜¯ï¼Œå¦ä¸€å›äº‹ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN460193/">https://habr.com/ru/post/zh-CN460193/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN460181/index.html">é€šè¿‡è§£ææºä»£ç æ¥æé«˜æ‚¨çš„JavaScriptçŸ¥è¯†</a></li>
<li><a href="../zh-CN460185/index.html">åœ¨çº¿æœåŠ¡â€œé€šè¿‡è§†é¢‘å¯¹äº‹æ•…è¿›è¡Œé€Ÿåº¦åˆ†æâ€</a></li>
<li><a href="../zh-CN460187/index.html">æ”¶é›†æ•°æ®ä¹‹å‰ï¼Œè¯·æƒ³è±¡ä¸€ä¸‹æ‚¨çš„æ•°æ®ã€‚</a></li>
<li><a href="../zh-CN460189/index.html">2019å¹´14ç§æœ€ä½³çœ‹æ¿å·¥å…·</a></li>
<li><a href="../zh-CN460191/index.html">åœæ­¢ç”Ÿäº§çº¿æˆ–æ³µé€ç®¡é“ï¼Œå“Ÿ</a></li>
<li><a href="../zh-CN460195/index.html">å°ï¼Œæ˜¯çš„ï¼Œå·²åˆ é™¤ï¼šå¾®å‹çº¿æ€§ç²’å­åŠ é€Ÿå™¨ï¼Œåˆ·æ–°äº†æ–°è®°å½•</a></li>
<li><a href="../zh-CN460197/index.html">ç°ä»£å„¿ç«¥æŠ€æœ¯ä¿±ä¹éƒ¨VSè‹è”SUITs</a></li>
<li><a href="../zh-CN460205/index.html">åŸºäºPKCSï¼ƒ12å®¹å™¨çš„åŠ å¯†å·¥ä½œç«™ã€‚ åˆ›å»ºç”µå­ç­¾åCadES-X Long Type1ã€‚ç¬¬3éƒ¨åˆ†</a></li>
<li><a href="../zh-CN460207/index.html">Linuxç®¡ç†å‘˜å¦‚ä½•åœ¨Ubuntu 16.04ä¸‹ä½¿ç”¨éŸ³ä¹è¯†åˆ«ç³»ç»Ÿç®¡ç†å„¿ç«¥åˆå”±å›¢ã€‚ éº¦å…‹é£å’Œå¼¦</a></li>
<li><a href="../zh-CN460211/index.html">è‹±ç‰¹å°”Pohoikiæµ·æ»©-å…·æœ‰800ä¸‡ä¸ªç¥ç»å…ƒçš„ç¥ç»å½¢æ€ç³»ç»Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>