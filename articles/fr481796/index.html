<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>➕ 💪🏾 🍵 Comment diviser les rôles dans un projet Laravel: un aperçu des packages RBAC 🚞 🎐 ➰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lors du développement d'un projet Web dans lequel il existe des comptes utilisateurs, la question se pose souvent d'organiser un système de rôles et d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment diviser les rôles dans un projet Laravel: un aperçu des packages RBAC</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/481796/">  Lors du développement d'un projet Web dans lequel il existe des comptes utilisateurs, la question se pose souvent d'organiser un système de rôles et de droits pour délimiter l'accès à certaines sections et fonctions du système.  Dans cet article, nous comparons les packages de contrôle d'accès et résumons le tableau. <br><br><img src="https://habrastorage.org/webt/nu/g1/_a/nug1_ao419t1xnbdst80hw0c6re.png"><br><a name="habracut"></a><br><br><h2>  Présentation </h2><br>  Dans la version 5.1, Laravel a introduit Auth Gates, une fonction de cadre intégrée pour le contrôle d'accès.  Jusqu'à cette époque, je devais utiliser divers packages tiers.  Cependant, même maintenant, le programmeur a le choix: tout écrire vous-même ou utiliser un package prêt à l'emploi.  La première option est bien adaptée aux petits projets ou aux projets avec un système simple de droits et de rôles.  Le second (avec le bon choix de package) permet un réglage plus fin. <br><br>  Le but de cet article est de passer en revue les packages existants qui implémentent RBAC (Role Based Access Control) - contrôle d'accès basé sur les rôles.  Nous préciserons tout de suite que cet article ne prétend pas être la vérité ultime: chaque développeur lui-même doit déterminer de quel package il a besoin (le cas échéant).  Remarque: dans cet article, nous considérons RBAC, par conséquent, dans la revue Sentinel, nous ne traitons que cette partie des fonctions disponibles. <br><br><h2>  Description du paquet </h2><br><h3>  Laravel-permission de Spatie </h3><br>  <b>Lien:</b> <a href="https://github.com/spatie/laravel-permission">https://github.com/spatie/laravel-permission</a> <br>  <b>Documentation:</b> <a href="https://docs.spatie.be/laravel-permission/v3">https://docs.spatie.be/laravel-permission/v3</a> <br>  <b>Nombre de téléchargements (au moment de la rédaction):</b> 3,6 M <br>  <b>Version Laravel:</b> de 5.8 pour la version 3 <br>  <b>La présence de l'interface:</b> non (vous pouvez utiliser le <a href="https://github.com/LaravelDaily/laravel-roles-permissions-manager">package</a> ) <br>  <b>Basé sur Laravel Auth:</b> oui <br><br>  <b>CARACTÉRISTIQUES</b> <br><ol><li>  Disponibilité de commandes artisanales pour créer / attribuer des droits. </li><li>  Portée finie par rôles et droits. </li><li>  La possibilité de vérifier les droits des utilisateurs à l'aide d'outils standard en raison du fait que le package utilise Laravel Auth Gates. </li><li>  Possibilité d'utiliser les directives de lame du package: <a href="https://habr.com/ru/users/role/" class="user_link">role</a> (@hasrole), @hasanyrole, @hasallroles, @unlessrole. </li><li>  Synchronisation des droits et des rôles. </li></ol><br>  <b>Remarque:</b> lorsque authorize () est appelé pour la stratégie, si l'autorisation a le même nom que la stratégie, cela fonctionnera, pas la stratégie. <br><br>  <b>Structure DB</b> <br><br><img src="https://habrastorage.org/webt/wk/vj/i2/wkvji2hqhzspjgkoy2mn4ynh5fu.png"><br><br>  <b>Exemples de code</b> <br><br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//    $user-&gt;givePermissionTo('edit articles'); //    $user-&gt;assignRole('writer', 'admin'); //       $user-&gt;assignRole(['writer', 'admin']); //    $role-&gt;givePermissionTo('edit articles');</span></span></code> </pre> <br><br><h3>  Bouncer par joseph silber </h3><br>  <b>Lien:</b> <a href="https://github.com/JosephSilber/bouncer">https://github.com/JosephSilber/bouncer</a> <br>  <b>Documentation:</b> <a href="https://github.com/JosephSilber/bouncer">https://github.com/JosephSilber/bouncer#introduction</a> <br>  <b>Nombre de téléchargements (au moment de la rédaction):</b> 418K <br>  <b>Version Laravel: à</b> partir du 5.1.20 <br>  <b>La présence de l'interface:</b> non (vous pouvez utiliser le <a href="https://github.com/LaravelDaily/laravel-roles-permissions-bouncer">package</a> ) <br>  <b>Basé sur Laravel Auth:</b> oui <br><br>  <b>CARACTÉRISTIQUES</b> <br><ol><li>  Possibilité d'utiliser sans Laravel. </li><li>  Synchronisation des droits et des rôles. </li><li>  La capacité d'imposer des restrictions sur les droits (pour une classe particulière de modèle ou pour une instance spécifique. </li><li>  Délivrance de tous les droits pour «leurs» entités: en utilisant la fonction «toOwn», vous pouvez attribuer tous les droits à une entité qui appartient à l'utilisateur (la comparaison des champs user_id et $ user-&gt; id peut être personnalisée).  Vous pouvez limiter les droits accordés à l'aide de la fonction «à». </li><li>  Prise en charge de la mutualisation (basée sur la fonction scope). </li><li>  La possibilité d'utiliser la fonction «portée» pour séparer les rôles et les droits en fonction des conditions établies (sur la base d'un identifiant unique) - par exemple, les droits dans le panneau d'administration et la partie publique du site. </li><li>  Commande artisan de la console pour nettoyer la base de données des autorisations inutilisées. </li><li>  La possibilité d'interdire rapidement un utilisateur ou de supprimer une interdiction (capacité interdite). </li></ol><br>  <b>Remarque: vous pouvez</b> créer un rôle et des droits pour celui-ci avec une seule ligne. <br><br>  <b>Structure DB</b> <br><br><img src="https://habrastorage.org/webt/8l/-7/4t/8l-74tbyt8ir3y9ilkgbhd-oj1u.png"><br><br>  <b>Exemples de code</b> <br><br>  <b>Restriction du droit par classe ou instance de modèle:</b> <br><pre> <code class="php hljs">Bouncer::allow($user)-&gt;to(<span class="hljs-string"><span class="hljs-string">'edit'</span></span>, Post::class); Bouncer::allow($user)-&gt;to(<span class="hljs-string"><span class="hljs-string">'edit'</span></span>, $post);</code> </pre> <br><br>  <b>Délivrance de droits pour «leurs» entités:</b> <br><pre> <code class="php hljs">Bouncer::allow($user)-&gt;toOwn(Post::class)-&gt;to([<span class="hljs-string"><span class="hljs-string">'view'</span></span>, <span class="hljs-string"><span class="hljs-string">'update'</span></span>]);</code> </pre> <br><br><h3>  Laratrust par santigarcor </h3><br>  <b>Lien:</b> <a href="https://github.com/santigarcor/laratrust">https://github.com/santigarcor/laratrust</a> <br>  <b>Documentation:</b> <a href="https://laratrust.santigarcor.me/">https://laratrust.santigarcor.me/</a> <br>  <b>Nombre de téléchargements (au moment de la rédaction):</b> 601K <br>  <b>Version Laravel:</b> ~ 6.0 <br>  <b>Disponibilité de l'interface:</b> non <br>  <b>Basé sur Laravel Auth:</b> non <br><br>  <b>CARACTÉRISTIQUES</b> <br><ol><li>  Il s'agit d'une <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25BE%25D1%2580%25D0%25BA">fourchette d'</a> ENTRUST ( <a href="https://github.com/Zizaco/entrust">https://github.com/Zizaco/entrust</a> ). </li><li>  Il existe des directives de lame. </li><li>  En raison du remplacement des commandes Laravel standard par les leurs, il est impossible de travailler avec la directive blade <a href="https://habr.com/ru/users/can/" class="user_link">can</a> - vous devrez utiliser $ user-&gt; can ('edit-user') ou la directive <a href="https://habr.com/ru/users/permission/" class="user_link">permission</a> . </li><li>  Synchronisation des rôles / droits. </li><li>  Capacité de disponibilité - vérification simultanée des rôles et des droits. </li><li>  Middleware prêt. </li><li>  La mutualisation basée sur les équipes. </li></ol><br><br>  <b>Structure DB</b> <br><br><img src="https://habrastorage.org/webt/9l/eh/my/9lehmyzoqarmzmhgrasrd4pfpxm.png"><br><br>  <b>Exemples de code</b> <br><pre> <code class="php hljs">   $user-&gt;hasRole([<span class="hljs-string"><span class="hljs-string">'owner'</span></span>, <span class="hljs-string"><span class="hljs-string">'admin'</span></span>]); $user-&gt;can([<span class="hljs-string"><span class="hljs-string">'edit-user'</span></span>, <span class="hljs-string"><span class="hljs-string">'create-post'</span></span>]); $user-&gt;hasRole(<span class="hljs-string"><span class="hljs-string">'owner|admin'</span></span>); $user-&gt;can(<span class="hljs-string"><span class="hljs-string">'edit-user|create-post'</span></span>);   $user-&gt;owns($post) <span class="hljs-comment"><span class="hljs-comment">//   $post-&gt;user_id   $owner = new Role(); $owner-&gt;name = 'owner'; $owner-&gt;display_name = 'Project Owner'; // optional $owner-&gt;description = 'User is the owner of a given project'; // optional $owner-&gt;save();</span></span></code> </pre> <br><br><h3>  Sentinel par Cartalyst </h3><br>  <b>Lien:</b> <a href="https://github.com/cartalyst/sentinel">https://github.com/cartalyst/sentinel</a> <br>  <b>Documentation:</b> <a href="">https://cartalyst.com/manual/sentinel/3.x</a> <br>  <b>Nombre de téléchargements (au moment de la rédaction):</b> 957K <br>  <b>Version Laravel:</b> 6.2 <br>  <b>Disponibilité de l'interface:</b> non <br>  <b>Basé sur Laravel Auth:</b> non <br><br>  <b>CARACTÉRISTIQUES</b> <br><ol><li>  Il comprend non seulement les rôles et les droits, mais également tout ce qui concerne l'enregistrement. </li><li>  Le package est un cadre agnostique, c'est-à-dire  il peut être utilisé non seulement dans Laravel - il vous suffit d'installer les dépendances suivantes à l'aide de composer: illuminate / database, illuminate / events, symfony / http-foundation. </li><li>  À l'aide du module complémentaire Sentinel Expired-Permissions, vous pouvez attribuer des droits sur l'heure. </li><li>  Prend en charge la mutualisation avec le module complémentaire Sentinel Multitenancy. </li></ol><br>  <b>Remarque:</b> lors de l'installation sur pur Laravel 6.2 et PostgreSQL, une erreur apparaît lors de la migration: la table des utilisateurs existe déjà.  Dans ce cas, vous devez modifier la migration standard: <br><br><img src="https://habrastorage.org/webt/oa/ra/nx/oaranx8jzv7cynf6qsyeexafrfu.png"><br><br>  <b>Structure DB</b> <br><br><img src="https://habrastorage.org/webt/gp/io/po/gpiopoubv-q65bd3ivraxjnbun0.png"><br><br>  <b>Exemples de code</b> <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//   $user = Sentinel::findById(1); $role = Sentinel::findRoleByName('Subscribers'); $role-&gt;users()-&gt;attach($user); //   $admin = Sentinel::inRole('admin'); //   $user-&gt;permissions = [ 'user.create' =&gt; true, 'user.delete' =&gt; false, ]; $user-&gt;save(); //   $user-&gt;hasAccess(['user.create', 'user.update']); Sentinel::hasAnyAccess(['user.admin', 'user.update']);</span></span></code> </pre> <br><br><h3>  Laravel-ACL par Kodeine </h3><br>  <b>Lien:</b> <a href="https://github.com/kodeine/laravel-acl">https://github.com/kodeine/laravel-acl</a> <br>  <b>Documentation:</b> <a href="https://github.com/kodeine/laravel-acl/wiki">https://github.com/kodeine/laravel-acl/wiki</a> <br>  <b>Nombre de téléchargements (au moment de la rédaction):</b> 170K <br>  <b>Version Laravel:</b> 5.0 et supérieure <br>  <b>Disponibilité de l'interface:</b> non <br>  <b>Basé sur Laravel Auth:</b> non <br><br>  <b>CARACTÉRISTIQUES</b> <br><ol><li>  Synchronisation des rôles et des droits. </li><li>  Droits de succession. </li><li>  Avoir vos directives de lame: <a href="https://habr.com/ru/users/role/" class="user_link">rôle</a> , <a href="https://habr.com/ru/users/permission/" class="user_link">permission</a> . </li><li>  Disponibilité du middleware fini. </li></ol><br>  <b>Remarque</b>  Quelques problèmes et solutions lors de la migration: <br><br><ul><li>  Dans le fichier config / acl, vous devez ajouter l'option users_table avec le nom de la table utilisateur pour garantir une migration stable. </li><li>  Vous devez installer le package «doctrine / dbal» sur Laravel pur afin de «vous faire des amis» avec les migrations standard, sinon une erreur peut se produire lors de la mise à jour des champs. </li></ul><br>  <b>Structure DB</b> <br><br><img src="https://habrastorage.org/webt/k8/1o/v4/k81ov4logc5mzrpkz2vmqcbw4jc.png"><br><br>  <b>Exemples de code</b> <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//   $permissionInternship = Permission::create([ 'name' =&gt; 'internships', 'slug' =&gt; [ //   'create' =&gt; true, 'view' =&gt; true, 'update' =&gt; true, 'delete' =&gt; true, ], 'description' =&gt; 'manage internships' ]); $permissionStudent = Permission::create([ 'name' =&gt; 'internships.student', 'slug' =&gt; [ //     'create' =&gt; false, ], //   'inherit_id' =&gt; $permissionInternship-&gt;getKey(), 'description' =&gt; 'student internship permissions' ]);</span></span></code> </pre> <br><br><h3>  Laravel-acl par Mateus Junges </h3><br>  <b>Lien:</b> <a href="https://github.com/mateusjunges/laravel-acl">https://github.com/mateusjunges/laravel-acl</a> <br>  <b>Documentation:</b> <a href="https://mateusjunges.github.io/laravel-acl/">https://mateusjunges.github.io/laravel-acl/</a> <br>  <b>Nombre de téléchargements (au moment de la rédaction):</b> 1,8 K <br>  <b>Version Laravel:</b> 5.0 et supérieure <br>  <b>Disponibilité de l'interface:</b> oui (formulaires prêts à l'emploi) <br>  <b>Basé sur Laravel Auth:</b> non <br><br>  <b>CARACTÉRISTIQUES</b> <br><ol><li>  Portée finie. </li><li>  Synchronisation des droits pour les groupes. </li><li>  Avoir vos directives de lame: <a href="https://habr.com/ru/users/group/" class="user_link">groupe</a> , @elsegroup, <a href="https://habr.com/ru/users/permission/" class="user_link">permission</a> , @elsepermission, @ allpermission, @ allgroups, @anypermission, @anygroup </li><li>  La présence de commandes intégrées permettant à l'artisan de créer des groupes / droits et de les afficher, ainsi que d'afficher les droits des utilisateurs. </li><li>  Disponibilité d'intergiciels prêts à l'emploi: PermissionMiddleware, GroupMiddleware, HierarchicalPermissions, PermissionOrGroupMiddleware. </li><li>  Disponibilité de formulaires prédéfinis pour la gestion des rôles. </li></ol><br>  <b>Structure DB</b> <br><br><img src="https://habrastorage.org/webt/qc/ux/ip/qcuxip3a0lzwgtslkqnahpg7bxk.png"><br><br><h2>  Tableau récapitulatif </h2><br><br> <a href=""><img src="https://habrastorage.org/webt/ay/n3/v2/ayn3v2opfwm4lzzjyrabpvyyge4.png" width="800"></a> <br><br><h2>  Conclusion </h2><br>  Chacun de ces packages a son propre champ d'application, il est donc impossible de choisir un seul gagnant.  Selon nos estimations, Laravel-permission et Bouncer conviennent le mieux à un système de rôles complexe, mais en même temps, il existe un Laravel-ACL de Kodeine avec une hiérarchie de rôles.  Laravel-ACL par Mateus Junges est une option «fraîche» et possède suffisamment de fonctionnalités pour créer un ensemble modéré de rôles.  Sentinel est une solution universelle avec un tas de fonctionnalités, en plus de la gestion des rôles.  Laratrust est pour ceux qui aiment Entrust. <br><br>  De plus, on ne peut manquer de mentionner les outils standard de Laravel - Portes et politiques.  Ils facilitent la différenciation de l'accès aux ressources dans les applications qui ne nécessitent pas de paramètres de droits complexes.  Si l'application n'a que quelques rôles ou si la hiérarchie n'est pas nécessaire, vos besoins peuvent être fermés à l'aide de portes et de stratégies. <br><br><h4>  Liens utiles </h4><br><ul><li>  <a href="https://habr.com/ru/post/321678/">habr.com/en/post/321678</a> - pour les "petits" projets </li><li>  <a href="https://laravel-news.com/two-best-roles-permissions-packages">laravel-news.com/two-best-roles-permissions-packages</a> - comparaison de Bouncer et Laravel-permission </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr481796/">https://habr.com/ru/post/fr481796/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr481786/index.html">Google enterre l'extension PHP IMAP</a></li>
<li><a href="../fr481788/index.html">Analyse de la résolution de problèmes réels de l'industrie (sauver des porcelets et autres)</a></li>
<li><a href="../fr481790/index.html">Comment la tricherie change la communauté des speedrunners</a></li>
<li><a href="../fr481792/index.html">Comment PVS-Studio a organisé la seconde moitié des conférences 2019</a></li>
<li><a href="../fr481794/index.html">Beckender - un psychothérapeute: un débogueur pour la psyché</a></li>
<li><a href="../fr481798/index.html">Combinez incompatibles: l'équipe de développement et de support produit est réunie en une seule</a></li>
<li><a href="../fr481800/index.html">VPS économiques avec adaptateurs vidéo: une comparaison des fournisseurs russes</a></li>
<li><a href="../fr481804/index.html">Amélioration de allOf et anyOf dans CompletableFuture</a></li>
<li><a href="../fr481806/index.html">Tests unitaires Python: démarrage rapide</a></li>
<li><a href="../fr481808/index.html">Pourquoi le soutien à l'automatisation nuit aux entreprises</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>