<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🍳 👩‍👧‍👧 🈂️ 个人云 🔮 👨‍💻 👨🏾‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="云存储使您不仅可以存储数据，还可以在NAS中与它们进行协作。 
 可能的解决方案 


 云服务有多个选项：NextCloud，Seafile，Pydio等... 
 其中一些在下面考虑。 
 云服务的实现。  自己的云 


  


 用PHP / Javascript实现。 


 能力： 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>个人云</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430970/"><p><img src="https://habrastorage.org/webt/pp/rh/gv/pprhgvtoydiwu1ks2fpnobjszqm.png"></p><br><p> 云存储使您不仅可以存储数据，还可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在NAS中</a>与它们<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">进行</a>协作。 </p><a name="habracut"></a><br><h2 id="vozmozhnye-resheniya"> 可能的解决方案 </h2><br><p> 云服务有多个选项：NextCloud，Seafile，Pydio等... <br> 其中一些在下面考虑。 </p><br><div class="spoiler">  <b class="spoiler_title">云服务的实现。</b> <div class="spoiler_text"><h3 id="owncloudhttpsowncloudorg">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">自己的云</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/fj/be/gx/fjbegxfckhsx7ww4y9b8_m10jsm.png"></a> </p><br><p> 用PHP / Javascript实现。 </p><br><p> 能力： </p><br><ul><li> 通过从云存储库安装应用程序可以扩展功能。 </li><li> 与Collabora和OnlyOffice的办公室集成在一起。 </li><li> 可以使用现有的存储库，例如FTP，Swift，S3，Dropbox等， <br> 在它们和本地云之间共享数据。 </li><li> 客户端上的加密。 </li><li> 通过电子邮件向外部用户提供文件的能力。 </li><li> 文件操作自动化（例如，自动添加标签）。 </li><li>  LDAP </li><li> 有一个音频播放器，一个音乐收藏，一个PDF阅读器插件库。 </li><li> 与Zimbra集成。 </li><li> 有日历，任务列表，文本编辑器等。 </li><li> 防病毒和防御勒索软件。 </li><li> 两因素身份验证。 </li><li> 冒充其他用户的能力（用于调试目的）。 </li></ul><br><h3 id="nextcloudhttpsnextcloudorg">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">下一朵云</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/62/cb/lo/62cbloe--f5eaxvejke31jqk-r4.png"></a> </p><br><p> 叉OwnCloud。 用PHP / Javascript实现。 </p><br><p> 能力： </p><br><ul><li> 使用常规目录结构或WebDAV进行文件存储。 </li><li> 有NextCloud Talk，通过它可以进行视频通话和视频会议。 </li><li> 运行Windows（Windows XP，Vista，7和8），Mac OS X（10.6和更高版本）或Linux的客户端之间的同步。 </li><li> 与移动设备同步。 </li><li> 日历（也类似于CalDAV）。 </li><li> 任务计划程序。 </li><li> 通讯簿（与CardDAV相同）。 </li><li> 流媒体（由Ampache使用）。 </li><li> 它支持不同的授权提供程序：LDAP，OpenID，Shibboleth。 </li><li> 两因素授权。 </li><li> 在组之间共享内容或使用公共URL。 调整规则。 </li><li> 具有语法突出显示和折叠功能的在线文本编辑器。 宣布支持LibreOffice编辑器的在线版本。 </li><li> 书签 </li><li>  URL缩短机制。 </li><li> 照相馆 </li><li>  PDF查看器（使用PDF.js） </li><li> 与Collabora和OnlyOffice集成。 </li><li> 记录模块。 </li><li> 能够创建自己的网站（在PicoCMS中）。 </li><li> 与Outlook和Thunderbird集成。 </li><li>  Gnome中的客户集成。 </li><li> 能够使用外部存储。 </li><li> 全文搜索。 </li><li> 与防病毒软件集成。 </li></ul><br><h3 id="sparklesharehttpwwwsparkleshareorg">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">闪光分享</a> </h3><br><p> 在C＃中实现。 </p><br><p> 能力： </p><br><ul><li> 版本控制 </li><li> 客户端上的加密。 </li><li> 多个用户之间的透明同步：远程更改将出现在SparkleShare专用的本地目录中。 </li></ul><br><p> 特点： </p><br><ul><li> 使用git作为后端。 </li></ul><br><h3 id="seafilehttpswwwseafilecom">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">海文件</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/gk/rb/op/gkrbopkni_o44lqncmhdeuqe2fa.png"></a> </p><br><p> 用C / Javascript实现。 </p><br><p> 能力： </p><br><ul><li> 可以将文件组织到可以在设备之间同步的库中。 </li><li> 有一个客户端允许您创建映射到云的本地“磁盘”。 </li><li> 内置加密。 所有文件均由客户端加密，并以加密方式存储在云中。 </li><li> 移动设备支持。 </li><li>  HTTS / TLS加密。 </li><li> 有LDAP。 </li><li> 微调权限。 </li><li> 版本控制文件。 </li><li> 能够创建目录快照，然后可以将其返回。 </li><li> 重复数据删除。 </li><li> 支持文件锁定。 </li><li> 在线共同编辑文件。 </li><li> 防病毒软件。 </li><li> 微调权限。 </li><li> 通过rsync定期备份。 </li><li>  WebDAV </li><li>  REST API </li><li> 与Collabora集成的能力。 </li></ul><br><p> 特点： </p><br><ul><li> 快速且不需要资源。 </li><li> 它被认为是可靠的。 </li><li> 仅付费Pro版本支持设置子目录的权限。 </li><li> 与防病毒软件集成-仅在Pro版本中。 </li><li> 审核-仅限于专业版。 </li><li> 全文搜索-仅在Pro版本中。 </li><li> 与S3和Ceph集成-仅在Pro版本中。 </li><li> 在线查看Doc / PPT / Excel-仅在Pro版本中。 </li></ul><br><h3 id="pydiohttpspydiocom">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">皮迪欧</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/v7/7n/he/v77nhe_y1o7wq8lkg7e1dhtp1ms.jpeg"></a> </p><br><p> 用PHP / Javascript实现。 </p><br><p> 能力： </p><br><ul><li> 文件不仅在用户之间共享，而且在Pydio的多个实例之间共享。 </li><li>  SSL / TLS加密。 </li><li>  WebDAV </li><li> 能够创建多个工作区。 </li><li> 与外部用户共享文件，并进行微调共享（例如，直接链接，密码等）。 </li><li> 内置的Collabora办公室。 </li><li> 预览和编辑图像。 </li><li> 有一个内置的音频和视频播放器。 </li></ul><br><h3 id="projectsendhttpswwwprojectsendorg">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">项目结束</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/61/1k/uc/611kuc8ohfjs4ym7kajncgufowo.png"></a> </p><br><p> 用PHP / Javascript实现。 </p><br><p> 能力： </p><br><ul><li> 既可以在特定用户之间，也可以在组之间共享文件。 </li><li> 有关文件操作的完整报告。 </li><li> 外部用户上传文件的能力（出于共享目的，例如，应用错误报告）。 </li></ul><br><h3 id="spideroakhttpsspideroakcom">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">蜘蛛橡木</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/w9/ce/k5/w9cek5imrxva3-chj9iejtwdh04.jpeg"></a> </p><br><p> 能力： </p><br><ul><li> 通过对现有文件进行重复数据删除和更改（而不是覆盖整个文件）来节省存储空间和文件上传时间。 </li><li> 可定制的多平台同步。 <br> 用于同步的DropBox创建一个特殊的文件夹，在其中必须放置所有同步的文件。  SpiderOak可以与任何目录一起使用。 </li><li> 保存所有历史版本的文件和已删除的文件 </li><li> 使用所谓的ShareRooms共享文件夹，该文件夹设置密码。 <br> 在本地计算机上更新的文件将在存储库中自动更新。 通过RSS通知用户更改。 </li><li> 从连接到Internet的任何设备接收文件。 </li><li> 基于“零知识”原理的完全数据加密。 </li><li> 支持无限数量的设备。 </li><li> 客户端数据加密。 </li><li> 两因素身份验证。 </li></ul><br><p> 特点： </p><br><p> 封闭的专有系统。 </p><br><p> 鉴于该软件是付费的且部分关闭，因此不包括其使用。 </p></div></div><br><h2 id="ustanovka-nextcloud"> 安装NextCloud </h2><br><p> 最初，人们希望使用Seafile：服务器部分是用C实现的，它高效且稳定。 但是事实证明，免费版本不具备所有功能。 </p><br><p> 因此，我尝试了Nextcloud并感到满意。 它提供了更多功能，并且完全免费。 </p><br><p> 您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>查看其在演示模式下的工作方式。 </p><br><p> 以下是云存储和系统之间的常用接口： </p><br><ul><li> <code>/tank0/apps/cloud/nextcloud</code>云服务存储。 </li><li>  <code>/tank0/apps/onlyoffice</code>办公室数据。 </li><li>  <code>https://cloud.NAS.cloudns.cc</code> ://cloud.NAS.cloudns.cc-WEB云服务界面。 </li></ul><br><p> 因为  NextCloud配置非常繁琐，由几个文件组成，在此不再列出。 </p><br><p> 您需要的所有内容都可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在Github上</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">存储库中</a>找到。 </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SeaFile</a>的配置也在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">那里</a> 。 </p><br><p> 首先安装并启动NextCloud。 </p><br><p> 为此，将配置复制到<code>/tank0/docker/services/nextcloud</code>并执行： </p><br><pre> <code class="plaintext hljs"># docker-compose up -d</code> </pre> <br><p> 将基于Nextcloud 13.0.7构建新映像。 如果要更改基本映像的版本，请在<code>app/Dockerfile</code> 。 我使用的是版本15，但是值得注意的是，许多插件（例如ocDownloader加载程序和便笺）在其中均无法使用，并且我还没有恢复OnlyOffice的功能。 </p><br><p> 我没有发现任何主要差异或性能上的明显提高。 </p><br><p> 下面我相信您正在使用13+版本。 </p><br><p> 接下来，转到NextCloud并在右上角的菜单中选择“应用程序”，完成必要插件的安装。 </p><br><p> <a href=""><img src="https://habrastorage.org/webt/sd/3y/rv/sd3yrvs5lqfdzig5smsbdasiiw0.png" alt="应用领域"></a> </p><br><p> 必填项： </p><br><ul><li>  <strong>LDAP用户和组后端</strong> -与LDAP配对。 </li><li>  <strong>外部存储支持</strong> -支持外部存储。 为了集成NextCloud和共享文件，以及与外部云存储配对，将进一步需要它。 在另一篇文章中，我将讨论设置外部存储的问题。 </li><li>  <strong>ocDownloader-</strong>文件下载器。 扩展云的功能。  Docker映像经过专门重建，因此可以正常工作。 </li><li>  <strong>ONLYOFFICE-</strong>办公室整合。 没有该应用程序，文档文件将无法在云中打开。 </li><li>  <strong>端到端加密</strong> -客户端上的端到端加密。 如果多个用户使用云，则需要一个插件来方便地确保其文件的安全性。 </li></ul><br><p> 所需的应用程序： </p><br><ul><li>  <strong>暴力设置</strong> -防止选择凭据。  NextCloud正在浏览Internet，因此最好进行安装。 </li><li>  <strong>模拟</strong> -允许管理员与其他用户一起登录。 对于调试和故障排除很有用。 </li><li>  <strong>交谈</strong> -视频聊天。 </li><li>  <strong>日历</strong> -不言而喻，可让您将日历保存在云中。 </li><li>  <strong>文件访问控制</strong> -允许用户基于标签和规则限制对文件和目录的访问。 </li><li>  <strong>校验和</strong> -允许您计算和查看文件的校验和。 </li><li>  <strong>外部站点</strong> -在顶部面板上创建指向任意站点的链接。 </li></ul><br><p> 容器特点： </p><br><ul><li> 已安装Aria2引导程序。 </li><li> 已安装Youtube-DL Bootloader。 </li><li> 安装了inotify工具。 </li><li> 增加了PHP的内存限制。 </li><li> 将Web服务器配置为与LDAP更好地配合使用。 </li></ul><br><p> 我注意到，如果您安装版本13+，但是决定升级到版本15，则可以使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">occ</a>实用程序执行此操作以及执行更多操作。 </p><br><h3 id="ldap">  LDAP </h3><br><p> 配置LDAP并非易事，因为我将告诉您更多信息。 </p><br><p> 转到“设置-&gt;与LDAP / AD集成”。 <br> 添加具有端口389的服务器172.21.0.1。 <br> 登录名： <code>cn=admin,dc=nas,dc=nas</code> 。 <br>  NextCloud可以管理LDAP数据库中的用户，为此需要管理员。 </p><br><p> <a href=""><img src="https://habrastorage.org/webt/9n/tg/h9/9ntgh9xbg3rtfvjrqid6qbj0a5y.png"></a> </p><br><p> 按下“检查DN配置”按钮，如果验证指示灯为绿色，则按下“下一步”按钮。 </p><br><p> 每个用户都有一个<code>inetOrgPerson</code>属性，并且是<code>users_cloud</code>组的成员。 </p><br><p> 过滤器将如下所示： </p><br><pre> <code class="plaintext hljs">(&amp;(|(objectclass=inetOrgPerson))(|(memberof=cn=users_cloud,ou=groups,dc=nas,dc=nas)))</code> </pre> <br><p> 单击“检查设置数据库并重新计数用户”，如果一切正确，则应显示用户数。 单击下一步。 </p><br><p> 在下一页上，将配置一个用户过滤器，NextCloud将通过该过滤器搜索它们。 </p><br><p> 筛选条件： </p><br><pre> <code class="plaintext hljs">￼(&amp;(objectclass=inetOrgPerson)(uid=%uid))</code> </pre> <br><p> 在此页面上，您需要输入用户的登录名，然后单击“检查设置”。 <br> 上次“下一个”。 </p><br><p> 然后单击“高级”，并检查“组树基数”字段是否等于“用户树基数”字段，并具有值<code>dc=nas,dc=nas</code> 。 </p><br><p> 返回到组并选中<code>groupOfUniqueNames</code>旁边的“仅这些<code>groupOfUniqueNames</code>类”框。 </p><br><p> 这里的最终过滤器是这样的： </p><br><pre> <code class="plaintext hljs">(&amp;(|(objectclass=groupOfUniqueNames)))</code> </pre> <br><p> 我没有设置“仅来自这些组”字段，因为 我想在NextCloud界面中看到所有用户，而那些不是<code>users_cloud</code>组<code>users_cloud</code>在上一阶段被筛选器<code>users_cloud</code>掉了。 </p><br><h2 id="onlyoffice">  Onlyoffice </h2><br><p> <a href=""><img src="https://habrastorage.org/webt/fr/rs/9e/frrs9euxco6_ycd8p_4a1y8bxiw.png"></a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">OnlyOffice</a>是一个出色的跨平台办公套件，支持MS Office文档。 它是免费开放的，与<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">LibreOffice一样</a> ，也可以作为服务器工作。 </p><br><p> 但是同时，对原始格式的支持实现得更好，几乎就像MS的原始办公室一样，它更稳定，界面也更周到。 </p><br><p> 它还<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">与NextCloud集成在一起</a> 。 </p><br><p> 顺便说一句，有一个桌面版的OnlyOffice，包括Linux。 总的来说，在沉重而不稳定的Collabora（这是LibreOffice）的折磨下，我选择了OnlyOffice，到目前为止，我对此感到非常满意。 </p><br><p> 扰流板下方的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Github</a>和更低<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">版本提供</a> OnlyOffice配置。 </p><br><p>  Github也有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Collabora</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">配置</a> 。 </p><br><div class="spoiler">  <b class="spoiler_title">/tank0/docker/services/office/onlyoffice/docker-compose.yml</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">version: '2' # https://helpcenter.onlyoffice.com/ru/server/docker/document/docker-installation.aspx networks: onlyoffice: driver: 'bridge' docker0: external: name: docker0 services: onlyoffice-redis: container_name: onlyoffice-redis image: redis restart: always networks: - onlyoffice expose: - '6379' onlyoffice-rabbitmq: container_name: onlyoffice-rabbitmq image: rabbitmq restart: always networks: - onlyoffice expose: - '5672' onlyoffice-postgresql: container_name: onlyoffice-postgresql image: postgres environment: - POSTGRES_DB=onlyoffice - POSTGRES_USER=onlyoffice networks: - onlyoffice restart: always expose: - '5432' volumes: - /tank0/apps/onlyoffice/postgresql_data:/var/lib/postgresql onlyoffice-documentserver-data: container_name: onlyoffice-documentserver-data image: onlyoffice/documentserver:latest environment: - ONLYOFFICE_DATA_CONTAINER=true - POSTGRESQL_SERVER_HOST=onlyoffice-postgresql - POSTGRESQL_SERVER_PORT=5432 - POSTGRESQL_SERVER_DB_NAME=onlyoffice - POSTGRESQL_SERVER_USER=onlyoffice - RABBITMQ_SERVER_URL=amqp://guest:guest@onlyoffice-rabbitmq - REDIS_SERVER_HOST=onlyoffice-redis - REDIS_SERVER_PORT=6379 stdin_open: true restart: always networks: - onlyoffice volumes: - /tank0/apps/onlyoffice/document-server-data/data:/var/www/onlyoffice/Data - /tank0/apps/onlyoffice/document-server-data/logs:/var/log/onlyoffice - /tank0/apps/onlyoffice/document-server-data/cache:/var/lib/onlyoffice/documentserver/App_Data/cache/files - /tank0/apps/onlyoffice/document-server-data/files:/var/www/onlyoffice/documentserver-example/public/files - /usr/share/fonts onlyoffice-documentserver: image: onlyoffice/documentserver:latest depends_on: - onlyoffice-postgresql - onlyoffice-redis - onlyoffice-rabbitmq - onlyoffice-documentserver-data environment: - ONLYOFFICE_DATA_CONTAINER_HOST=onlyoffice-documentserver-data - BALANCE=uri depth 3 - EXCLUDE_PORTS=443 - HTTP_CHECK=GET /healthcheck - EXTRA_SETTINGS=http-check expect string true - JWT_ENABLED=true - JWT_SECRET=&lt;JWT_SECRET_TOKEN&gt; # Uncomment the string below to redirect HTTP request to HTTPS request. #- FORCE_SSL=true - VIRTUAL_HOST=office.* - VIRTUAL_PORT=80 - VIRTUAL_PROTO=http - CERT_NAME=NAS.cloudns.cc stdin_open: true restart: always networks: - onlyoffice - docker0 expose: - '80' volumes: - /tank0/apps/onlyoffice/document-server/logs:/var/log/onlyoffice - /tank0/apps/onlyoffice/document-server/data:/var/www/onlyoffice/Data - /tank0/apps/onlyoffice/document-server/lib:/var/lib/onlyoffice - /tank0/apps/onlyoffice/document-server/db:/var/lib/postgresql volumes_from: - onlyoffice-documentserver-data</code> </pre> </div></div><br><p> 我将解释一些要点： </p><br><ul><li> 您需要将&lt;JWT_SECRET_TOKEN&gt;更改为您自己的名称，并更改DNS区域名称中的NAS。 </li><li> 这里不需要包括HTTPS，因为尽管可以从外部看到办公室，但可以通过反向代理与之交换，反向代理仅通过HTTPS与用户合作。 这就是NAS体系结构的构建方式。 </li></ul><br><p> 现在您需要提高办公室： </p><br><pre> <code class="plaintext hljs">docker-compose up -d</code> </pre> <br><p> 而且，如果一切正常，则以下页面将位于office.NAS.cloudns.cc： </p><br><p> <a href=""><img src="https://habrastorage.org/webt/nt/e6/nq/nte6nqehacnsc__jn_zpqja9hi0.png" alt="OnlyOffice服务器屏幕"></a> </p><br><p> 然后，在NextCloud设置中，您需要选择“管理-&gt; ONLYOFFICE”项，并在前两个字段中输入文档服务器地址： <code>https://office.NAS.cloudns.cc/</code> ：//office.NAS.cloudns.cc/和您的JWT令牌。 </p><br><p> 在第三个字段中，输入云地址。 </p><br><p> 例如，可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在此处</a>生成JWT令牌。 </p><br><p> 如果服务器配置正确，则用于办公室文档的其他项目将出现在用于在云中创建文档的菜单中，并且<code>.docx</code>文件将在办公室中打开。 </p><br><h2 id="vyvody"> 结论 </h2><br><p> 云存储是用户自身与其他服务之间进行交互的中央链接。 </p><br><p>  NextCloud担任此职务非常方便并且具有广泛的功能。 </p><br><p> 在版本之间进行更新的过程中，它具有自己的功能，但通常，建议使用此存储库。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN430970/">https://habr.com/ru/post/zh-CN430970/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN430960/index.html">关于来自桌面展览的gamedev</a></li>
<li><a href="../zh-CN430962/index.html">Visual Studio Code中的Razor支持</a></li>
<li><a href="../zh-CN430964/index.html">陈述式思维</a></li>
<li><a href="../zh-CN430966/index.html">Atlassian Jira Software的常规冲刺</a></li>
<li><a href="../zh-CN430968/index.html">“头脑在线。” 无人机无处不在</a></li>
<li><a href="../zh-CN430972/index.html">node.js服务器端-处理错误。 第一部分</a></li>
<li><a href="../zh-CN430974/index.html">莫斯科云1cloud很棒的照片之旅</a></li>
<li><a href="../zh-CN430976/index.html">＃276移动开发者的有趣材料摘要（11月19日至25日）</a></li>
<li><a href="../zh-CN430978/index.html">您花了多少时间看电影？</a></li>
<li><a href="../zh-CN430980/index.html">“每个人有时都想看猫”：我们在GLPH播客中谈论内容营销</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>