<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ง๐พ ๐ฝ๏ธ ๐ฎ ุงูุญูุงุธ ุนูู ุฑููุฒ ุงูุชูููุถ ุขููุฉ ๐ธ๐ป ๐ ๐ฉ๐ฟโ๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจูุงูช usernameูช. ุจุบุถ ุงููุธุฑ ุนู ููุถูุน ุงูุชูุฑูุฑ ุ ูุชู ุณุคุงูู ุจุงุณุชูุฑุงุฑ ูู ุงููุคุชูุฑุงุช ููุณ ุงูุณุคุงู - "ููููุฉ ุชุฎุฒูู ุงูุฑููุฒ ุงููููุฒุฉ ุจุฃูุงู ุนูู ุฌูุงุฒ ุงููุณุชุฎุฏูุ". ุนุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุญูุงุธ ุนูู ุฑููุฒ ุงูุชูููุถ ุขููุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423753/" style=";text-align:right;direction:rtl">  ูุฑุญุจูุงูช usernameูช.  ุจุบุถ ุงููุธุฑ ุนู ููุถูุน ุงูุชูุฑูุฑ ุ ูุชู ุณุคุงูู ุจุงุณุชูุฑุงุฑ ูู ุงููุคุชูุฑุงุช ููุณ ุงูุณุคุงู - "ููููุฉ ุชุฎุฒูู ุงูุฑููุฒ ุงููููุฒุฉ ุจุฃูุงู ุนูู ุฌูุงุฒ ุงููุณุชุฎุฏูุ".  ุนุงุฏุฉ ุฃุญุงูู ุงูุฅุฌุงุจุฉ ุ ููู ุงูููุช ูุง ูุณูุญ ุจุงููุดู ุงููุงูู ุนู ุงูููุถูุน.  ูุน ูุฐู ุงูููุงูุฉ ุ ุฃุฑูุฏ ุฅุบูุงู ูุฐู ุงููุดููุฉ ุชูุงููุง. <br><a name="habracut"></a><br>  ููุฏ ููุช ุจุชุญููู ุนุดุฑุงุช ุงูุชุทุจููุงุช ููุนุฑูุฉ ููููุฉ ุนูููุง ูุน ุงูุฑููุฒ.  ุฌููุน ุงูุชุทุจููุงุช ุงูุชู ููุช ุจุชุญููููุง ููุจูุงูุงุช ุงููุงูุฉ ุงูุชู ุชู ูุนุงูุฌุชูุง ูุณูุญุช ูู ุจุชุนููู ุฑูุฒ PIN ููุฅุฏุฎุงู ูุญูุงูุฉ ุฅุถุงููุฉ.  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุงูุฃุฎุทุงุก ุงูุฃูุซุฑ ุดููุนูุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุฑุณุงู ุฑูุฒ PIN ุฅูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุน RefreshToken ูุชุฃููุฏ ุงููุตุงุฏูุฉ ูุชููู ุงูุฑููุฒ ุงููููุฒุฉ ุงูุฌุฏูุฏุฉ.  - ุถุนูู ุ ุฅู RefreshToken ุบูุฑ ุขูู ูู ุงูุชุฎุฒูู ุงููุญูู ุ ูุน ุฅููุงููุฉ ุงููุตูู ุงููุนูู ุฅูู ุงูุฌูุงุฒ ุฃู ุงููุณุฎ ุงูุงุญุชูุงุทู ุ ููููู ุงุณุชุฎุฑุงุฌู ุ ููุง ูููู ููุจุฑูุงูุฌ ุงูุถุงุฑ ุงูููุงู ุจุฐูู. </li><li style=";text-align:right;direction:rtl"> ุญูุธ ุฑูุฒ PIN ูู ุงูุฑุณุงูุฉ ุจุงุณุชุฎุฏุงู RefreshToken ุ ุซู ุงูุชุญูู ุงููุญูู ูู ุฑูุฒ PIN ูุฅุฑุณุงู RefreshToken ุฅูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช.  - ุฅู ุงููุงุจูุณ ุ RefreshToken ุบูุฑ ุขูู ูุน ุงูุฏุจูุณ ุ ููุง ูุณูุญ ุจุงุณุชุฎุฑุงุฌู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุธููุฑ ูุงูู ุขุฎุฑ ูุดูุฑ ุฅูู ุชุฌุงูุฒ ุงููุตุงุฏูุฉ ุงููุญููุฉ. </li><li style=";text-align:right;direction:rtl">  ุชุดููุฑ Bad RefreshToken ูุน ุฑูุฒ PIN ุ ูุงูุฐู ูุณูุญ ูู ุจุงุณุชุนุงุฏุฉ ุฑูุฒ PIN ู RefreshToken ูู ูุต ุงูุชุดููุฑ.  - ุญุงูุฉ ุฎุงุตุฉ ูุฎุทุฃ ุณุงุจู ุ ุชู ุงุณุชุบูุงูู ุจุดูู ุฃูุซุฑ ุชุนููุฏูุง.  ููู ูุงุญุธ ุฃู ูุฐุง ูู ุงูุทุฑูู ุงูุตุญูุญ. </li></ul><br>  ุจุนุฏ ุงููุธุฑ ูู ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ ุ ููููู ูุชุงุจุนุฉ ุงูุชูููุฑ ูู ููุทู ุงูุชุฎุฒูู ุงูุขูู ููุฑููุฒ ุงููููุฒุฉ ูู ุชุทุจููู.  ูุฌุฏุฑ ุงูุจุฏุก ุจุงูุฃุตูู ุงูุฃุณุงุณูุฉ ุงููุฑุชุจุทุฉ ุจุงููุตุงุฏูุฉ / ุงูุชูููุถ ุฃุซูุงุก ุชุดุบูู ุงูุชุทุจูู ูุทุฑุญ ุจุนุถ ุงููุชุทูุจุงุช ููุง: <br><br>  <b>ูุชู ุงุณุชุฎุฏุงู ุจูุงูุงุช ุงูุงุนุชูุงุฏ</b> - (ุงุณู ุงููุณุชุฎุฏู + ูููุฉ ุงููุฑูุฑ) ููุตุงุฏูุฉ ุงููุณุชุฎุฏู ูู ุงููุธุงู. <br>  + ูุง ูุชู ุชุฎุฒูู ูููุฉ ุงููุฑูุฑ ูุทูููุง ุนูู ุงูุฌูุงุฒ ููุฌุจ ูุณุญูุง ุนูู ุงูููุฑ ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุจุนุฏ ุฅุฑุณุงููุง ุฅูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช <br>  ูุง ูุชู ุฅุฑุณุงู + ุจูุงุณุทุฉ ุทุฑููุฉ GET ูู ูุนููุงุช ุงูุงุณุชุนูุงู ูุทูุจ HTTP ุ ูุชู ุงุณุชุฎุฏุงู ุทูุจุงุช POST ุจุฏูุงู ูู ุฐูู <br>  + ุชู ุชุนุทูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูููุญุฉ ุงูููุงุชูุญ ูุญููู ูุต ูุนุงูุฌุฉ ูููุฉ ุงููุฑูุฑ <br>  + ูุชู ุชุนุทูู ุงูุญุงูุธุฉ ููุญููู ุงููุตูุฉ ุงูุชู ุชุญุชูู ุนูู ูููุฉ ูุฑูุฑ <br>  + ูุง ูุชู ุงููุดู ุนู ูููุฉ ุงููุฑูุฑ ุนุจุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู (ูุณุชุฎุฏููู ุงูุนูุงูุงุช ุงููุฌููุฉ) ุ ุฃูุถูุง ุ ูุง ุชุฏุฎู ูููุฉ ุงููุฑูุฑ ูู ููุทุงุช ุงูุดุงุดุฉ <br><br>  <b>AccessToken</b> - ูุณุชุฎุฏู ูุชุฃููุฏ ุฅุฐู ุงููุณุชุฎุฏู. <br>  + ูู ูุชู ุชุฎุฒูููุง ูู ุงูุฐุงูุฑุฉ ุทูููุฉ ุงููุฏู ูุชุฎุฒูููุง ุฅูุง ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู <br>  ูุง ูุชู ุฅุฑุณุงู + ุจูุงุณุทุฉ ุทุฑููุฉ GET ูู ูุนููุงุช ุงูุงุณุชุนูุงู ูุทูุจ HTTP ุ ูุชู ุงุณุชุฎุฏุงู ุทูุจุงุช POST ุจุฏูุงู ูู ุฐูู <br><br>  <b>RefreshToken</b> - ูุณุชุฎุฏู ููุญุตูู ุนูู ุญุฒูุฉ AccessToken + RefreshToken ุฌุฏูุฏุฉ. <br>  + ูุง ูุชู ุชุฎุฒููู ุจุฃู ุดูู ูู ุงูุฃุดูุงู ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ููุฌุจ ุฅุฒุงูุชู ููู ููุฑูุง ุจุนุฏ ุงูุงุณุชูุงู ูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุงูุญูุธ ูู ุงูุฐุงูุฑุฉ ุทูููุฉ ุงููุฏู ุฃู ุจุนุฏ ุงูุงุณุชูุงู ูู ุงูุฐุงูุฑุฉ ุทูููุฉ ุงููุฏู ูุงูุงุณุชุฎุฏุงู <br>  + ุงููุฎุฒูุฉ ููุท ูู ุดูู ูุดูุฑ ูู ุงูุฐุงูุฑุฉ ุทูููุฉ ุงููุฏู <br>  + ูุดูุฑุฉ ุจุงุณุชุฎุฏุงู ุฏุจูุณ ุจุงุณุชุฎุฏุงู ููุงุนุฏ ุณุญุฑูุฉ ูุจุนุถ ุงูููุงุนุฏ (ุณูุชู ูุตู ุงูููุงุนุฏ ุฃุฏูุงู) ุ ุฅุฐุง ูู ูุชู ุชุนููู ุงูุฏุจูุณ ุ ููุง ุชูู ุจุญูุธู ุนูู ุงูุฅุทูุงู <br>  ูุง ูุชู ุฅุฑุณุงู + ุจูุงุณุทุฉ ุทุฑููุฉ GET ูู ูุนููุงุช ุงูุงุณุชุนูุงู ูุทูุจ HTTP ุ ูุชู ุงุณุชุฎุฏุงู ุทูุจุงุช POST ุจุฏูุงู ูู ุฐูู <br><br>  <b>PIN</b> - (ุนุงุฏุฉ ูููู ูู 4 ุฃู 6 ุฃุฑูุงู) - ูุณุชุฎุฏู ูุชุดููุฑ / ูู ุชุดููุฑ RefreshToken. <br>  + ูู ูุชู ุชุฎุฒูููุง ูู ุฃู ููุงู ุนูู ุงูุฌูุงุฒ ููุฌุจ ูุณุญูุง ุนูู ุงูููุฑ ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุจุนุฏ ุงูุงุณุชุฎุฏุงู <br>  + ูุง ุชุชุฑู ุญุฏูุฏ ุงูุชุทุจูู ูุทูููุง ุ ููุง ูุชู ููููุง ูู ุฃู ููุงู <br>  + ูุณุชุฎุฏู ููุท ููุชุดููุฑ / ูู ุงูุชุดููุฑ RefreshToken <br><br>  <b>OTP</b> ูู ุฑูุฒ ููุฑุฉ ูุงุญุฏุฉ ูู 2FA. <br>  + ูุง ูุชู ุชุฎุฒูู ูููุฉ ุงููุฑูุฑ ููุฑุฉ ูุงุญุฏุฉ ุนูู ุงูุฌูุงุฒ ูุทูููุง ููุฌุจ ูุณุญูุง ุนูู ุงูููุฑ ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุจุนุฏ ุฅุฑุณุงููุง ุฅูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช <br>  ูุง ูุชู ุฅุฑุณุงู + ุจูุงุณุทุฉ ุทุฑููุฉ GET ูู ูุนููุงุช ุงูุงุณุชุนูุงู ูุทูุจ HTTP ุ ูุชู ุงุณุชุฎุฏุงู ุทูุจุงุช POST ุจุฏูุงู ูู ุฐูู <br>  + ุชุนุทูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูููุญุฉ ุงูููุงุชูุญ ููุนุงูุฌุฉ ุญููู ุงููุต OTP <br>  + ุชู ุชุนุทูู ุงูุญุงูุธุฉ ูุญููู ุงููุต ุงูุชู ุชุญุชูู ุนูู OTP <br>  + ูุง ูุฏุฎู OTP ูู ููุทุงุช ุงูุดุงุดุฉ <br>  + ูุฒูู ุงูุชุทุจูู OTP ูู ุงูุดุงุดุฉ ุนูุฏูุง ููุชูู ุฅูู ุงูุฎูููุฉ <br><br>  ุงูุขู ุฏุนูุง ููุชูู ุฅูู <s>ุณุญุฑ</s> ุงูุชุดููุฑ.  ุงูุดุฑุท ุงูุฑุฆูุณู ูู ุฃูู ูุง ูุฌุจ ุนููู ุชุญุช ุฃู ุธุฑู ูู ุงูุธุฑูู ุงูุณูุงุญ ุจุชูููุฐ ุขููุฉ ุงูุชุดููุฑ RefreshToken ุ ุญูุซ ููููู ุงูุชุญูู ูู ูุชูุฌุฉ ูู ุงูุชุดููุฑ ูุญูููุง.  ุจูุนูู ุฃูู ุฅุฐุง ุงุณุชููู ุงูููุงุฌู ุนูู ุงููุต ุงููุดูุฑ ุ ููู ูุชููู ูู ุงูุชูุงุท ุงูููุชุงุญ.  ูุฌุจ ุฃู ูููู ุงููุฏูู ุงููุญูุฏ ูู API.  ูุฐู ูู ุงูุทุฑููุฉ ุงููุญูุฏุฉ ููุญุฏ ูู ูุญุงููุงุช ุงูุงุฎุชูุงุฑ ุงูุฑุฆูุณูุฉ ูุฅุจุทุงู ุงูุฑููุฒ ุงููููุฒุฉ ูู ุญุงูุฉ ูุฌูู ุงูููุฉ ุงูุบุงุดูุฉ. <br><br>  ุณุฃุนุทู ูุซุงู ุฌูุฏ ุ ูููุชุฑุถ ุฃููุง ูุฑูุฏ ุชุดููุฑ UUID <br><blockquote style=";text-align:right;direction:rtl">  aec27f0f-b8a3-43cb-b076-e075a095abfe </blockquote>  ูุน ูุฐู ุงููุฌููุนุฉ ูู AES / CBC / PKCS5Padding ุ ุจุงุณุชุฎุฏุงู PIN ูููุชุงุญ.  ูุจุฏู ุฃู ุงูุฎูุงุฑุฒููุฉ ุฌูุฏุฉ ุ ูู ุดูุก ูุจูู ุนูู ุงูุฅุฑุดุงุฏุงุช ุ ูููู ููุงู ููุทุฉ ุฑุฆูุณูุฉ - ุงูููุชุงุญ ูุญุชูู ุนูู ุงููููู ุฌุฏูุง ูู ุงูุฅูุชุฑูุจูุง.  ุฏุนููุง ูุฑู ูุง ูุคุฏู ูุฐุง ุฅูู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุญุดู - ูุธุฑูุง ูุฃู ุงูุฑูุฒ ุงููููุฒ ุงูุฎุงุต ุจูุง ูุฃุฎุฐ 36 ุจุงูุช ุ ููุฏู AES ูุถุน ุชุดููุฑ ูุชูุฉ ูุน ูุชูุฉ 128 ุจุช ุ ุซู ุชุญุชุงุฌ ุงูุฎูุงุฑุฒููุฉ ุฅูู ุฅููุงุก ุงูุฑูุฒ ุงููููุฒ ุญุชู 48 ุจุงูุช (ููู ูุถุงุนู 128 ุจุช).  ูู ูุณุฎุชูุง ุ ุณุชุชู ุฅุถุงูุฉ ุงูุฐูู ููููุง ููุนูุงุฑ PKCS5Padding ุ ุฃู  ูููุฉ ูู ุจุงูุช ุงููุถุงูุฉ ุชุณุงูู ุนุฏุฏ ุงูุจุงูุชุงุช ุงููุถุงูุฉ <br><blockquote style=";text-align:right;direction:rtl">  01 <br>  02 02 <br>  03 03 03 <br>  04 04 04 04 <br>  05 05 05 05 05 <br>  06 06 06 06 06 06 <br>  ุงูุฎ. </blockquote>  ุณูู ุชุจุฏู ูุชูุชูุง ุงูุฃุฎูุฑุฉ ุนูู ุงููุญู ุงูุชุงูู: <br><blockquote style=";text-align:right;direction:rtl">  ... |  61 62 66 65 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C | </blockquote>  ูููุงู ูุดููุฉ ุ ุจุงููุธุฑ ุฅูู ูุฐู ุงููุณุงุญุฉ ุงููุชุฑููุฉ ูููููุง ุชุตููุฉ ุงูุจูุงูุงุช (ุจูุงุณุทุฉ ุงููุชูุฉ ุงูุฃุฎูุฑุฉ ุบูุฑ ุงูุตุงูุญุฉ) ุงูุชู ุชู ูู ุชุดููุฑูุง ุจุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุฎุงุทุฆ ุ ูุจุงูุชุงูู ุชุญุฏูุฏ RefreshToken ุงูุตุญูุญ ูู ูููุฉ ุงูุฐุงูุฑุฉ ุงูููุชููุฉ. </li><li style=";text-align:right;direction:rtl">  ุงูุชูุณูู ุงููุชููุน ููุฑูุฒ ุงููููุฒ - ุญุชู ุฅุฐุง ุฌุนููุง ุงูุฑูุฒ ุงููููุฒ ูุฏููุง ูุถุงุนูุงุช 128 ุจุช (ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฒุงูุฉ ุงููุงุตูุงุช) ูุชุฌูุจ ุฅุถุงูุฉ ุงูุญุดู ุ ูุณูู ููุงุฌู ุงููุดููุฉ ุงูุชุงููุฉ.  ุชููู ุงููุดููุฉ ูู ุฃู ูู ููุณ ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ ุงูููุชููุฉ ูููููุง ุฌูุน ุงูุฎุทูุท ูุชุญุฏูุฏ ุงูุฎุท ุงูุฐู ููุน ุถูู ุชูุณูู UUID.  ูุชููู UUID ูู ุดููู ุงููุตู ุงูููุจูู ูู 32 ุฑูููุง ุจุชูุณูู ุณุฏุงุณู ุนุดุฑู ููุตููุฉ ุจูุงุตูุฉ ุฅูู 5 ูุฌููุนุงุช 8-4-4-4-12 <br>  xxxxxxxx-xxxx-Mxxx-Nxxx-xxxxxxxxxxxx <br>  ุญูุซ M ูู ุงูุฅุตุฏุงุฑ ู N ูู ุงูุฎูุงุฑ.  ูู ูุฐุง ูููู ูุชุตููุฉ ุงูุฑููุฒ ุงููููุฒุฉ ุงูุชู ุชู ูู ุชุดููุฑูุง ุจุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุฎุทุฃ ุ ุชุงุฑููุง ุชูุณูู UUID RefreshToken ููุงุณุจูุง. </li></ol><br>  ุจุงููุธุฑ ุฅูู ูู ูุง ุณุจู ุ ููููู ุงููุชุงุจุนุฉ ุฅูู ุงูุชูููุฐ ุ ููุฏ ุงุฎุชุฑุช ุฎูุงุฑูุง ุจุณูุทูุง ูุฅูุดุงุก 64 ุจุงูุช ุนุดูุงุฆู ููููุง ูู base64: <br><br><pre style=";text-align:right;direction:rtl"><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createRefreshToken</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] refreshToken = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">64</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> SecureRandom secureRandom = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SecureRandom(); secureRandom.nextBytes(refreshToken); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Base64.getUrlEncoder().withoutPadding() .encodeToString(refreshToken); }</code> </pre>  ูููุง ููู ูุซุงู ููุซู ูุฐุง ุงูุฑูุฒ ุงููููุฒ: <br><blockquote style=";text-align:right;direction:rtl">  YmI8rF9pwB1KjJAZKY9JzqsCu3kFz4xt4GkRCzXS9-FS_kbN3-CF9RGiRuuGqwqMo-VxFDhgQNmgjlQFD2GvbA </blockquote>  ุงูุขู ุฏุนููุง ูุฑู ููู ุชุจุฏู ุฎูุงุฑุฒููุฉ (ุนูู Android ู iOS ุณุชููู ุงูุฎูุงุฑุฒููุฉ ููุณูุง): <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String ALGORITHM = <span class="hljs-string"><span class="hljs-string">"AES"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String CIPHER_SUITE = <span class="hljs-string"><span class="hljs-string">"AES/CBC/NoPadding"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> AES_KEY_SIZE = <span class="hljs-number"><span class="hljs-number">16</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> AES_BLOCK_SIZE = <span class="hljs-number"><span class="hljs-number">16</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">encryptToken</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String token, String pin)</span></span></span><span class="hljs-function"> </span></span>{ decodedToken = decodeToken(token); <span class="hljs-comment"><span class="hljs-comment">//   rawPin = pin.getBytes(); byte[] iv = generate(AES_BLOCK_SIZE); //      CBC byte[] salt = generate(AES_KEY_SIZE); //       byte[] key = kdf.deriveKey(rawPin, salt, AES_KEY_SIZE); //  -    Cipher cipher = Cipher.getInstance(CIPHER_SUITE); //    cipher.init(Cipher.ENCRYPT_MODE, new SecretKeySpec(key, ALGORITHM), new IvParameterSpec(iv)); return cipher.doFinal(token); } public byte[] decodeToken(String token) { byte[] rawToken = token.getBytes(); return Base64.getUrlDecoder().decode(rawToken); } public final byte[] generate(int size) { byte[] random = new byte[size]; (new SecureRandom()).nextBytes(random); return random; }</span></span></code> </pre><br>  ูุง ูู ุงูุฎุทูุท ุงูุชู ุชุณุชุญู ุงูุงูุชุจุงู ุฅูููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String CIPHER_SUITE = <span class="hljs-string"><span class="hljs-string">"AES/CBC/NoPadding"</span></span>;</code> </pre><br>  ูุง ุญุดูุฉ ุ ุชุฐูุฑูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">decodedToken = decodeToken(token); <span class="hljs-comment"><span class="hljs-comment">//  </span></span></code> </pre><br>  ูุง ููููู ููุท ุฃุฎุฐ ูุชุดููุฑ ุฑูุฒ ูููุฒ ูู ุชูุซูู base64 ุ ูุฃู ูุฐุง ุงูุชูุซูู ูู ุชูุณูู ูุนูู (ุญุณููุง ุ ุชุฐูุฑ). <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] key = kdf.deriveKey(rawPin, salt, AES_KEY_SIZE); <span class="hljs-comment"><span class="hljs-comment">//  -   </span></span></code> </pre><br>  ุนูุฏ ุงูุฅุฎุฑุงุฌ ุ ูุญุตู ุนูู ููุชุงุญ ุจุญุฌู AES_KEY_SIZE ุ ููุงุณุจ ูุฎูุงุฑุฒููุฉ AES.  ูููู ุงุณุชุฎุฏุงู ุฃู ูุธููุฉ ุงุดุชูุงู ุฑุฆูุณูุฉ ุฃูุตุช ุจูุง Argon2 ุ SHA-3 ุ Scrypt ูู kdf ูู ุญุงูุฉ ุงูุญูุงุฉ ุงูุณูุฆุฉ pbkdf2 (ููู ูุชูุงุฒูุฉ ุจุดูู ุฌูุฏ ุฌุฏูุง ูุน FPGA). <br><br>  ูููู ุชุฎุฒูู ุงูุฑูุฒ ุงููููุฒ ุงููุดูุฑ ุงูููุงุฆู ุจุฃูุงู ุนูู ุงูุฌูุงุฒ ููุง ุชููู ูู ุฃู ุฃู ุดุฎุต ููููู ุณุฑูุชู ุ ุณูุงุก ูุงู ุจุฑูุงูุฌูุง ุถุงุฑูุง ุฃู ููุงููุง ูุง ุชุซูู ูุงููู ุงููุจุงุฏุฆ ุงูุฃุฎูุงููุฉ. <br><br>  ุงููุฒูุฏ ูู ุงูุชูุตูุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณุชุจุนุงุฏ ุงูุฑููุฒ ุงููููุฒุฉ ูู ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ. </li><li style=";text-align:right;direction:rtl">  ุนูู iOS ุ ูู ุจุชุฎุฒูู ุงูุฑูุฒ ุงููููุฒ ูู keychain ุจุงุณุชุฎุฏุงู ุงูุณูุฉ kSecAttrAccessibleWhenPasscodeSetThisDeviceOnly. </li><li style=";text-align:right;direction:rtl">  ูุง ุชุจุนุซุฑ ุงูุฃุตูู ุงูุชู ุชูุช ููุงูุดุชูุง ูู ูุฐู ุงูููุงูุฉ (ุงูููุชุงุญ ุ ุงูุฑูู ุงูุณุฑู ุ ูููุฉ ุงููุฑูุฑ ุ ุฅูุฎ) ูู ุฌููุน ุฃูุญุงุก ุงูุชุทุจูู. </li><li style=";text-align:right;direction:rtl">  ุงุณุชุจุฏู ุงูุฃุตูู ุจูุฌุฑุฏ ุฃู ุชุตุจุญ ุบูุฑ ุถุฑูุฑูุฉ ุ ูุง ุชุญุชูุธ ุจูุง ูู ุฐุงูุฑุชู ููุชุฑุฉ ุฃุทูู ูู ุงููุงุฒู. </li><li style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏู SecureRandom ุนูู Android ู SecRandomCopyBytes ุนูู iOS ูุฅูุดุงุก ูุญุฏุงุช ุจุงูุช ุนุดูุงุฆูุฉ ูู ุณูุงู ุชุดููุฑ. </li></ul><br>  ูููุง ุจูุญุต ุนุฏุฏ ูุนูู ูู ุงููุฒุงูู ุนูุฏ ุชุฎุฒูู ุงูุฑููุฒ ุงููููุฒุฉ ุ ูุงูุชู ุ ูู ุฑุฃูู ุ ูุฌุจ ุฃู ุชููู ูุนุฑููุฉ ููู ุดุฎุต ูููู ุจุชุทููุฑ ุชุทุจููุงุช ุชุนูู ูุน ุงูุจูุงูุงุช ุงููุงูุฉ.  ูุฐุง ุงูููุถูุน ุ ุญูุซ ููููู ุงูุฎูุท ูู ุฃู ุฎุทูุฉ ุ ุฅุฐุง ูุงู ูุฏูู ุฃุณุฆูุฉ ุ ุงุทุฑุญูุง ูู ุงูุชุนูููุงุช.  ุงูุชุนูููุงุช ุนูู ุงููุต ูุฑุญุจ ุจูุง ุงูุถุง <br><br>  ุงููุฑุงุฌุน: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CWE-311: ููุฏุงู ุชุดููุฑ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CWE-327: ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ ุชุดููุฑ ููุณูุฑุฉ ุฃู ูุญูููุฉ ุจุงููุฎุงุทุฑ</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CWE-327: CWE-338: ุงุณุชุฎุฏุงู ูููุฏ ุงูุฃุฑูุงู ุงูุนุดูุงุฆูุฉ ุงูุถุนููุฉ ุงููุดูุฑ (PRNG)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CWE-598: ุงูุชุนุฑุถ ูููุนูููุงุช ูู ุฎูุงู ุณูุงุณู ุงูุงุณุชุนูุงู ูู ุทูุจ GET</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar423753/">https://habr.com/ru/post/ar423753/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar423743/index.html">ุชุญุช ุงูุชุญูู: ุฃุฏุงุฉ ูุฑุงูุจุฉ ูุฑุต ุฎุงุฏู VDS</a></li>
<li><a href="../ar423745/index.html">ุงุณุชุฎุฏุงู Python ูุชุญููู ุงูููุงุฑุงุช ุงููุทููุจุฉ ุฐุงุช ุงูุตูุฉ ุจูู ุงููุทูุฑูู</a></li>
<li><a href="../ar423747/index.html">ุฃุฏูุงุช ุชุทููุฑ ุฌุฏูุฏุฉ ูุน LEGO Education - ูู Microsoft ู MIT ูุงููุฒูุฏ</a></li>
<li><a href="../ar423749/index.html">8 ุฎุทูุงุช ุณููุฉ ููุดู ูุฏูุฑ ุชุทููุฑ ูุจุชุฏุฆ</a></li>
<li><a href="../ar423751/index.html">ุฌุงูุง ููุจูุงู ุณุชูุดู 2 - ูู ูู ุงูููููุ</a></li>
<li><a href="../ar423759/index.html">Fintech-digest: ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ ูููุงุทูู ุงูุงุชุญุงุฏ ุงูุฑูุณู ุ ูุณูู ุงูุจูู ุงููุฑูุฒู ุ ุฎุฏูุฉ ุฌุฏูุฏุฉ ูู CloudFlare</a></li>
<li><a href="../ar423763/index.html">ูุง ูุนููู Uber Cash ุงููุจุฏุนูู</a></li>
<li><a href="../ar423765/index.html">ูุญู ููุชุจ ุทูุจูุง ููุชุญูู ุนู ุจูุนุฏ ูู ูุดุบู MPV ูู RetroOrangePi</a></li>
<li><a href="../ar423767/index.html">ูุงุฌู ูุฑุงุตูุฉ ุดุฑูุฉ ุงูุฎุทูุท ุงูุฌููุฉ ุงูุจุฑูุทุงููุฉ: ุณุฑูุช 380ุ000 ุจุทุงูุฉ ูุตุฑููุฉ ููุนููุงุก</a></li>
<li><a href="../ar423769/index.html">ุชูุตูู OpenSSL ุจู Mono</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>