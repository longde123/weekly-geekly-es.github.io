<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§˜ğŸ½ ğŸ’„ ğŸ—ï¸ Preloading dalam PHP 7.4 ğŸ‘ ğŸŒœ ğŸ†š</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Terjemahan artikel ini disiapkan khusus untuk siswa kursus Pengembang PHP Backend . 



 PHP 7.4 menambahkan preloading, fitur yang dapat secara signi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Preloading dalam PHP 7.4</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/463117/">  <i>Terjemahan artikel ini disiapkan khusus untuk siswa kursus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengembang PHP Backend</a> .</i> <br><br><img src="https://habrastorage.org/webt/xa/ye/vs/xayevs76f7sr7gyuummrtetx4ym.png"><br><br>  PHP 7.4 menambahkan preloading, fitur yang dapat secara signifikan meningkatkan kinerja kode. <br><br>  Singkatnya, singkatnya. <br><br><ul><li>  Untuk memuat file Anda harus menulis skrip PHP terpisah. </li><li>  Script ini dijalankan sekali pada permulaan server. </li><li>  Semua file yang dimuat sebelumnya tersedia dalam memori untuk semua permintaan. </li><li>  Perubahan yang dilakukan pada file sumber tidak akan berfungsi sampai Anda me-restart server. </li></ul><br><h4>  Mari kita bicara tentang fitur baru secara lebih rinci. </h4><a name="habracut"></a><br><h3>  Lebih dari Opcache </h3><br>  Ya, preloading didasarkan pada opcache, tapi itu tidak persis sama.  Opcache mengambil file sumber PHP, mengkompilasinya menjadi opcodes, dan kemudian menyimpan file yang dikompilasi ke disk. <br><br>  Opcodes dapat dianggap sebagai representasi tingkat rendah dari kode Anda yang mudah ditafsirkan saat runtime.  Dengan demikian, opcache memungkinkan Anda untuk melewati tahap menerjemahkan file sumber ke dalam apa yang sebenarnya dibutuhkan oleh penerjemah PHP pada saat dijalankan.  Penghematan yang nyata! <br><br>  Namun, Anda dapat menyimpan lebih banyak lagi.  Dikompilasi dengan file <code>opcash</code> tidak tahu apa-apa tentang file lain.  Jika Anda memiliki kelas A, yang merupakan perluasan dari kelas B, mereka masih perlu dihubungkan pada saat runtime.  Selain itu, opcache memeriksa untuk melihat apakah file sumber telah berubah, dan saat mendeteksi perubahan akan membuat cache mereka tidak valid. <br><br>  Dan di sini preload datang untuk menyelamatkan: itu tidak hanya mengkompilasi file sumber menjadi opcodes, tetapi juga menghubungkan kelas, sifat, dan antarmuka yang tergantung.  Ini menyimpan fragmen "dikompilasi" seperti kode dieksekusi (yaitu, kode yang dapat digunakan penerjemah PHP) dalam memori. <br><br>  Ketika permintaan tiba di server, ia dapat menggunakan bagian-bagian dari basis kode yang telah dimuat ke dalam memori, tanpa waktu tambahan. <br><br><h4>  Apa "bagian dari basis kode" yang sedang kita bicarakan? </h4><br><h3>  Lakukan preloading </h3><br>  Untuk preloading yang benar, pengembang harus memberi tahu server file mana yang harus diunduh.  Ini dilakukan menggunakan skrip PHP sederhana, jadi tidak ada yang perlu ditakutkan. <br><br>  Tidak ada yang rumit. <br><br><ul><li>  Anda memberikan skrip preload dan menautkannya ke file php.ini menggunakan <code>opcache.preload</code> . </li><li>  Setiap file PHP yang Anda ingin preload harus dilewatkan ke <code>opcache_compile_file()</code> dari skrip preload. </li></ul><br>  Katakanlah Anda ingin memuat semacam kerangka kerja.  Biarkan itu menjadi Laravel.  Dalam hal ini, skrip Anda harus melihat semua file PHP di <code>vendor/laravel</code> dan menambahkannya satu per satu. <br><br>  Berikut ini cara Anda dapat memasukkan skrip ini dalam php.ini: <br><br><pre> <code class="php hljs">opcache.preload=/path/to/project/preload.php</code> </pre> <br><br>  Dan berikut ini adalah contoh implementasi: <br><br><pre> <code class="php hljs">$files = <span class="hljs-comment"><span class="hljs-comment">/*  ,      */</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($files <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $file) { opcache_compile_file($file); }</code> </pre> <br>  Alih-alih <code>opcache_compile_file</code> Anda dapat menggunakan <code>include</code> .  Namun, tampaknya ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bug di sini</a> , karena pada saat penulisan opsi kedua tidak berfungsi. <br><br><h4>  Peringatan bahwa Anda tidak dapat melakukan pramuat kelas yang tidak terkait </h4><br>  Ada peringatan <i>Tidak bisakah memuat sebelumnya kelas yang tidak ditautkan</i> ?  Faktanya adalah bahwa sebelum preloading file, Anda juga perlu melakukan preload objek dependen mereka - antarmuka, sifat, dan kelas induk. <br><br>  Jika Anda mengalami masalah dengan dependensi kelas, Anda akan diperingatkan tentang ini ketika memulai server: <br><br><pre> <code class="php hljs">Can<span class="hljs-string"><span class="hljs-string">'t preload unlinked class Illuminate\Database\Query\JoinClause: Unknown parent Illuminate\Database\Query\Builder</span></span></code> </pre> <br>  Perhatikan bahwa <code>opcache_compile_file()</code> hanya <code>opcache_compile_file()</code> - <code>opcache_compile_file()</code> file, tetapi tidak akan menjalankannya.  Ini berarti bahwa jika suatu kelas memiliki dependensi yang belum dimuat sebelumnya, maka kelas itu sendiri tidak dapat dimuat sebelumnya. <br><br>  Ini tidak penting: server akan berfungsi seperti biasa, tetapi Anda tidak akan memiliki semua file yang ingin Anda muat sebelumnya. <br><br>  Itu sebabnya Anda harus hati-hati memilih file untuk dimuat sebelum untuk menghindari masalah ketergantungan.  Melakukannya secara manual adalah tugas yang tidak berterima kasih dan menghabiskan waktu, sehingga pengembang sudah bekerja pada solusi otomatis. <br><br><h3>  Dukungan komposer </h3><br>  Solusi otomatis paling menjanjikan sedang disiapkan oleh pengembang komposer, yang sudah digunakan di sebagian besar proyek PHP modern. <br><br>  Sekarang orang-orang bekerja pada kemampuan untuk mengkonfigurasi preload di <code>composer.json</code> , yang pada gilirannya akan menghasilkan file preload, bukan Anda.  Seperti preloading itu sendiri, fitur ini masih dalam pengembangan.  Anda dapat mengikuti perkembangan acara di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br>  Untungnya, Anda tidak perlu mengkonfigurasi file preload secara manual jika Anda tidak menginginkannya - komposer dapat melakukannya untuk Anda. <br><br><h3>  Persyaratan server </h3><br>  Ada dua poin penting lain yang harus diingat pengembang saat menggunakan preload. <br><br>  Anda sudah tahu bahwa Anda perlu membuat entri di <code>php.ini</code> agar preload berfungsi.  Ini berarti bahwa jika Anda menggunakan hosting bersama, Anda tidak akan dapat mengkonfigurasi PHP sesuka Anda. <br><br>  Dalam praktiknya, Anda akan memerlukan server khusus (virtual) untuk mengoptimalkan file yang dimuat sebelumnya untuk satu proyek.  Ingatlah ini. <br><br>  Ingat juga bahwa Anda harus me-restart server (jika Anda menggunakan <code>php-fpm</code> , ini sudah cukup) setiap kali Anda ingin memuat ulang file dalam memori.  Bagi sebagian besar, ini jelas, tetapi tidak akan berlebihan untuk mengingat. <br><br><h3>  Performa </h3><br>  Sekarang untuk pertanyaan yang paling penting: apakah preloading benar-benar meningkatkan kinerja? <br><br>  Tentu saja!  Ben Morel membagikan hasil pengujian komparatif, yang dapat ditemukan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">topik yang</a> sama <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tentang komposer</a> , yang kami sebutkan di atas. <br><br>  Dan juga, itu menarik.  Jika mau, Anda hanya dapat memuat sebelumnya yang disebut <code>hot classes</code> - kelas yang sering digunakan dalam basis kode Anda.  Tes Ben Morel menunjukkan bahwa memuat hanya sekitar 100 dari kelas-kelas ini memberikan peningkatan kinerja yang lebih tinggi daripada preloading semuanya sekaligus.  Dalam kasus pertama, produktivitas meningkat sebesar 17%, dalam kasus kedua - sebesar 13%. <br><br>  Tentu saja, pilihan kelas untuk preloading tergantung pada proyek spesifik.  Adalah bijaksana untuk memulai dengan hanya melakukan preloading sebanyak mungkin.  Jika beberapa persen perbedaan dalam kinerja ini sangat penting bagi Anda, Anda harus mengontrol kode saat runtime. <br><br>  Semua operasi ini, tentu saja, dapat diotomatisasi, dan ini kemungkinan akan dilakukan di masa depan. <br><br>  Sekarang penting bahwa dukungan pra-muat ditambahkan ke <code>composer</code> , yang menghilangkan kebutuhan untuk membuat file sendiri.  Fitur ini sangat mudah dikonfigurasi di server, asalkan itu sesuai keinginan Anda. <br><br><hr><br>  Apakah Anda akan menggunakan preloading dalam versi baru PHP 7.4?  Ada pemikiran atau komentar?  Email saya di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Twitter</a> atau <a href="">Email</a> . <br><br>  Secara tradisional, kami menunggu komentar dan keuntungan Anda jika Anda menemukan artikel yang menarik :-) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id463117/">https://habr.com/ru/post/id463117/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id463101/index.html">Mengelola ratusan server untuk pengujian beban: autoscaling, pemantauan khusus, budaya DevOps</a></li>
<li><a href="../id463105/index.html">Hari keempat saya dengan Haiku: masalah instalasi dan boot</a></li>
<li><a href="../id463107/index.html">ShIoTiny: otomatisasi kecil, Internet, atau "enam bulan sebelum liburan"</a></li>
<li><a href="../id463113/index.html">Kontrol Data dan Model Versi dalam pertemuan Visi Komputer</a></li>
<li><a href="../id463115/index.html">Masalah pintu dalam desain penembak</a></li>
<li><a href="../id463121/index.html">Kami makan gajah di beberapa bagian. Contoh Aplikasi Strategi Pemantauan Kesehatan</a></li>
<li><a href="../id463123/index.html">Perpustakaan generator kode assembler untuk mikrokontroler AVR. Bagian 3</a></li>
<li><a href="../id463125/index.html">OOP dalam gambar</a></li>
<li><a href="../id463127/index.html">Pemantauan UPS. Bagian Dua - Analisis Otomatis</a></li>
<li><a href="../id463135/index.html">Di negara mana yang menguntungkan untuk mendaftarkan perusahaan IT pada 2019?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>