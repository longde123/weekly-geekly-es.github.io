<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóø üõ°Ô∏è üë©üèΩ‚Äçüíº Esquemas angulares, ou como eu escrevi meu modelo para cli angular üë®üèΩ‚Äçüî¨ üóùÔ∏è üë©üèº‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√°, meu nome √© Maxim. H√° v√°rios anos, estou desenvolvendo front-end. Muitas vezes tenho que lidar com o layout de v√°rios modelos de html. No meu trab...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Esquemas angulares, ou como eu escrevi meu modelo para cli angular</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/469509/"><p>  Ol√°, meu nome √© Maxim.  H√° v√°rios anos, estou desenvolvendo front-end.  Muitas vezes tenho que lidar com o layout de v√°rios modelos de html.  No meu trabalho di√°rio, geralmente uso o construtor webpack com um mecanismo de modelo de pug personalizado e tamb√©m uso a metodologia BEM.  Para facilitar minha vida, uso um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pacote maravilhoso</a> . </p><br><p>  Recentemente, precisei fazer um pequeno projeto no Angular e, como estava acostumado a trabalhar com minhas ferramentas favoritas, n√£o queria voltar ao html vazio.  Nesse contexto, surgiu o problema de como fazer amigos confusos com um angular, e n√£o apenas fazer amigos, mas tamb√©m gerar componentes do cli com a estrutura de que eu precisava. </p><br><p>  Quem se importa como eu fiz tudo, bem-vindo ao gato. </p><a name="habracut"></a><br><p>  Para come√ßar, crie um projeto de teste no qual testaremos nosso modelo. </p><br><p>  Executamos na linha de comando: </p><br><p> <code>ng g test-project</code> . </p><br><p>  Nas configura√ß√µes, escolhi o pr√©-processador scss, pois √© mais conveniente trabalhar com ele. </p><br><p>  O projeto foi criado, mas os modelos de componentes padr√£o em nosso html agora o corrigem.  Primeiro de tudo, voc√™ precisa fazer amigos angulares do cli com o mecanismo de modelo de pug, para isso usei o pacote ng-cli-pug-loader </p><br><p>  Instale o pacote, para isso, v√° para a pasta do projeto e execute: </p><br><p>  <code>ng add ng-cli-pug-loader</code> . </p><br><p>  Agora voc√™ pode usar arquivos de modelo de pug.  Em seguida, reescrevemos o decorador raiz do componente AppComponent para: </p><br><pre> <code class="javascript hljs"> @Component({ <span class="hljs-attr"><span class="hljs-attr">selector</span></span>: <span class="hljs-string"><span class="hljs-string">'app-root'</span></span>, <span class="hljs-attr"><span class="hljs-attr">templateUrl</span></span>: <span class="hljs-string"><span class="hljs-string">'./app.component.pug'</span></span>, <span class="hljs-attr"><span class="hljs-attr">styleUrls</span></span>: [<span class="hljs-string"><span class="hljs-string">'./app.component.scss'</span></span>] })</code> </pre> <br><p>  Assim, alteramos a extens√£o do arquivo app.component.html para app.component.pug, e o conte√∫do √© gravado na sintaxe do modelo.  Neste arquivo, eu apaguei tudo, exceto o roteador. </p><br><p>  Finalmente, vamos come√ßar a criar nosso gerador de componentes! </p><br><p>  Para gerar modelos, precisamos criar nosso pr√≥prio esquema.  Estou usando o pacote schematics-cli do @ angular-devkit.  Instale o pacote globalmente com o comando: </p><br><p>  <code>npm install -g @angular-devkit/schematics-cli</code> . </p><br><p>  Eu criei o esquema em um diret√≥rio separado fora do projeto com o comando: </p><br><p>  <code>schematics blank --name=bempug-component</code> . </p><br><p>  Entramos no esquema criado, agora estamos interessados ‚Äã‚Äãno arquivo src / collection.json.  √â assim: </p><br><pre> <code class="json hljs"> <span class="hljs-string"><span class="hljs-string">"$schema"</span></span>: <span class="hljs-string"><span class="hljs-string">"../node_modules/@angular-devkit/schematics/collection-schema.json"</span></span>, <span class="hljs-string"><span class="hljs-string">"schematics"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"bempug-component"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"A blank schematic."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"factory"</span></span>: <span class="hljs-string"><span class="hljs-string">"./bempug-component/index#bempugComponent"</span></span> } } }</code> </pre> <br><p>  Este √© um arquivo de descri√ß√£o do nosso esquema, onde o par√¢metro √© "factory": "./bempug-component/index#bempugComponent": esta √© a descri√ß√£o da fun√ß√£o principal da "f√°brica" ‚Äã‚Äãdo nosso gerador. </p><br><p>  Inicialmente, parece algo como isto: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Rule, SchematicContext, Tree } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular-devkit/schematics'</span></span>; <span class="hljs-comment"><span class="hljs-comment">// You don't have to export the function as default. You can also have more than one rule factory // per file. export function bempugComponent(options: any): Rule { return (tree: Tree, _context: SchematicContext) =&gt; { return tree; }; }</span></span></code> </pre> <br><p>  Voc√™ pode exportar a fun√ß√£o por padr√£o, e o par√¢metro "factory" pode ser reescrito como "./bempug-component/index". </p><br><p>  Em seguida, no diret√≥rio do nosso esquema, crie o arquivo schema.json, ele descrever√° todos os par√¢metros do nosso esquema. </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"$schema"</span></span>: <span class="hljs-string"><span class="hljs-string">"http://json-schema.org/schema"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"SchemanticsForMenu"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Bempug Schema"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"object"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"properties"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"$default"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$source"</span></span>: <span class="hljs-string"><span class="hljs-string">"argv"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"index"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"path"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"path"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The path to create the component."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"visible"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"project"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The name of the project."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"$default"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$source"</span></span>: <span class="hljs-string"><span class="hljs-string">"projectName"</span></span> } } } }</code> </pre> <br><p>  Os par√¢metros est√£o em propriedades, a saber: </p><br><ul><li>  nome nome da entidade (no nosso caso, ser√° um componente); </li><li>  Caminho √© o caminho pelo qual o gerador criar√° os arquivos do componente; </li><li>  Projeto √© o pr√≥prio projeto, no qual o componente ser√° gerado; </li></ul><br><p>  Adicione mais alguns par√¢metros ao arquivo que ser√£o necess√°rios no futuro. </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"module"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The declaring module."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"m"</span></span> }, <span class="hljs-string"><span class="hljs-string">"componentModule"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"boolean"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Patern module per Component"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"mc"</span></span> }, <span class="hljs-string"><span class="hljs-string">"export"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"boolean"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Export component from module?"</span></span> }</code> </pre> <br><ul><li>  O m√≥dulo aqui ser√° armazenado em um link para o m√≥dulo no qual o componente ser√° inclu√≠do, ou melhor, o m√≥dulo do componente; </li><li>  componentModule existe um sinalizador para criar para o componente seu pr√≥prio m√≥dulo (ent√£o cheguei √† conclus√£o de que ele sempre ser√° criado e configurado como true); </li><li>  exportar: este √© o sinalizador para exportar do m√≥dulo para o qual estamos importando nosso m√≥dulo componente; </li></ul><br><p>  Em seguida, criamos uma interface com os par√¢metros do nosso componente, o arquivo schema.d.ts. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface BemPugOptions { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: string; project?: string; path?: string; <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>?: string; componentModule?: boolean; <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>?: string; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span>?: boolean; bemPugMixinPath?: string; }</code> </pre> <br><p>  Nele, as propriedades duplicam propriedades de schema.json.  Em seguida, prepare nossa f√°brica, v√° para o arquivo index.ts.  Nele, criamos duas fun√ß√µes filterTemplates, que ser√£o respons√°veis ‚Äã‚Äãpor criar um m√≥dulo para um componente, dependendo do valor de componentModule, e setupOptions, que define os par√¢metros necess√°rios para a f√°brica. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">filterTemplates</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options: BemPugOptions</span></span></span><span class="hljs-function">): </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Rule</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!options.componentModule) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">path</span></span></span><span class="hljs-function"> =&gt;</span></span> !path.match(<span class="hljs-regexp"><span class="hljs-regexp">/\.module\.ts$/</span></span>) &amp;&amp; !path.match(<span class="hljs-regexp"><span class="hljs-regexp">/-item\.ts$/</span></span>) &amp;&amp; !path.match(<span class="hljs-regexp"><span class="hljs-regexp">/\.bak$/</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">path</span></span></span><span class="hljs-function"> =&gt;</span></span> !path.match(<span class="hljs-regexp"><span class="hljs-regexp">/\.bak$/</span></span>)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupOptions</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options: BemPugOptions, host: Tree</span></span></span><span class="hljs-function">): </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> workspace = getWorkspace(host); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!options.project) { options.project = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(workspace.projects)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> project = workspace.projects[options.project]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (options.path === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> projectDirName = project.projectType === <span class="hljs-string"><span class="hljs-string">'application'</span></span> ? <span class="hljs-string"><span class="hljs-string">'app'</span></span> : <span class="hljs-string"><span class="hljs-string">'lib'</span></span>; options.path = <span class="hljs-string"><span class="hljs-string">`/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${project.root}</span></span></span><span class="hljs-string">/src/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${projectDirName}</span></span></span><span class="hljs-string">`</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> parsedPath = parseName(options.path, options.name); options.name = parsedPath.name; options.path = parsedPath.path; }</code> </pre><br><p>  Em seguida, escrevemos na fun√ß√£o principal: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bempugComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options: BemPugOptions</span></span></span><span class="hljs-function">): </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Rule</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">host: Tree, context: SchematicContext</span></span></span><span class="hljs-function">) =&gt;</span></span> { setupOptions(options, host); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> templateSource = apply(url(<span class="hljs-string"><span class="hljs-string">'./files'</span></span>), [ filterTemplates(options), template({ ...strings, ...options }), move(options.path || <span class="hljs-string"><span class="hljs-string">''</span></span>) ]); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> rule = chain([ branchAndMerge(chain([ mergeWith(templateSource), ])) ]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rule(host, context); } }</code> </pre><br><p>  A f√°brica est√° pronta e j√° pode gerar arquivos de componentes processando modelos da pasta de arquivos, que ainda n√£o est√° dispon√≠vel.  N√£o importa, criamos uma pasta de arquivos do componente bempug em nossa pasta de esquema no meu caso.  Na pasta de arquivos, crie a pasta <code>__name@dasherize__</code> , durante a gera√ß√£o, a f√°brica substituir√° <code>__name@dasherize__</code> pelo nome do componente. </p><br><p>  Em seguida, dentro da <code>__name@dasherize__</code> crie arquivos </p><br><ul><li>  <code>__name@dasherize__</code> modelo de componente de pug </li><li>  <code>__name@dasherize__</code> arquivo de teste de unidade para o componente </li><li>  <code>__name@dasherize__</code> do pr√≥prio componente </li><li>  <code>__name@dasherize__</code> componente <code>__name@dasherize__</code> -component.module.ts </li><li>  <code>__name@dasherize__</code> -component.scss folha de estilo do componente </li></ul><br><p>  Agora adicionaremos suporte para atualizar os m√≥dulos em nossa f√°brica, para isso criamos o arquivo add-to-module-context.ts para armazenar os par√¢metros que a f√°brica precisar√° para trabalhar com o m√≥dulo. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ts <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'typescript'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddToModuleContext</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// source of the module file source: ts.SourceFile; // the relative path that points from // the module file to the component file relativePath: string; // name of the component class classifiedName: string; }</span></span></code> </pre> <br><p>  Adicione suporte ao m√≥dulo √† f√°brica. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> stringUtils = { dasherize, classify }; <span class="hljs-comment"><span class="hljs-comment">// You don't have to export the function as default. You can also have more than one rule factory // per file. function filterTemplates(options: BemPugOptions): Rule { if (!options.componentModule) { return filter(path =&gt; !path.match(/\.module\.ts$/) &amp;&amp; !path.match(/-item\.ts$/) &amp;&amp; !path.match(/\.bak$/)); } return filter(path =&gt; !path.match(/\.bak$/)); } function setupOptions(options: BemPugOptions, host: Tree): void { const workspace = getWorkspace(host); if (!options.project) { options.project = Object.keys(workspace.projects)[0]; } const project = workspace.projects[options.project]; if (options.path === undefined) { const projectDirName = project.projectType === 'application' ? 'app' : 'lib'; options.path = `/${project.root}/src/${projectDirName}`; } const parsedPath = parseName(options.path, options.name); options.name = parsedPath.name; options.path = parsedPath.path; options.module = options.module || findModuleFromOptions(host, options) || ''; } export function createAddToModuleContext(host: Tree, options: ModuleOptions, componentPath: string): AddToModuleContext { const result = new AddToModuleContext(); if (!options.module) { throw new SchematicsException(`Module not found.`); } // Reading the module file const text = host.read(options.module); if (text === null) { throw new SchematicsException(`File ${options.module} does not exist.`); } const sourceText = text.toString('utf-8'); result.source = ts.createSourceFile(options.module, sourceText, ts.ScriptTarget.Latest, true); result.relativePath = buildRelativePath(options.module, componentPath); result.classifiedName = stringUtils.classify(`${options.name}ComponentModule`); return result; } function addDeclaration(host: Tree, options: ModuleOptions, componentPath: string) { const context = createAddToModuleContext(host, options, componentPath); const modulePath = options.module || ''; const declarationChanges = addImportToModule( context.source, modulePath, context.classifiedName, context.relativePath); const declarationRecorder = host.beginUpdate(modulePath); for (const change of declarationChanges) { if (change instanceof InsertChange) { declarationRecorder.insertLeft(change.pos, change.toAdd); } } host.commitUpdate(declarationRecorder); }; function addExport(host: Tree, options: ModuleOptions, componentPath: string) { const context = createAddToModuleContext(host, options, componentPath); const modulePath = options.module || ''; const exportChanges = addExportToModule( context.source, modulePath, context.classifiedName, context.relativePath); const exportRecorder = host.beginUpdate(modulePath); for (const change of exportChanges) { if (change instanceof InsertChange) { exportRecorder.insertLeft(change.pos, change.toAdd); } } host.commitUpdate(exportRecorder); }; export function addDeclarationToNgModule(options: ModuleOptions, exports: boolean, componentPath: string): Rule { return (host: Tree) =&gt; { addDeclaration(host, options, componentPath); if (exports) { addExport(host, options, componentPath); } return host; }; } export function bempugComponent(options: BemPugOptions): Rule { return (host: Tree, context: SchematicContext) =&gt; { setupOptions(options, host); deleteCommon(host); const templateSource = apply(url('./files'), [ filterTemplates(options), template({ ...strings, ...options }), move(options.path || '') ]); const rule = chain([ branchAndMerge(chain([ mergeWith(templateSource), addDeclarationToNgModule(options, !!options.export, `${options.path}/${options.name}/${options.name}-component.module` || '') ])) ]); return rule(host, context); } }</span></span></code> </pre><br><p>  Agora, ao adicionar o par√¢metro -m &lt;module reference&gt; ao comando cli, nosso m√≥dulo componente adicionar√° importa√ß√£o ao m√≥dulo especificado e adicionar√° a exporta√ß√£o ao adicionar o sinalizador ‚Äìexport.  Em seguida, adicionamos suporte ao BEM.  Para fazer isso, peguei as fontes do pacote npm bempug e criei o c√≥digo em um arquivo bempugMixin.pug, que coloquei na pasta comum e dentro de outra pasta comum para que o mixin seja copiado para a pasta comum no projeto no angular. </p><br><p>  Nossa tarefa √© que esse mixin esteja conectado em cada um de nossos arquivos de modelo, e n√£o seja duplicado ao gerar novos componentes. Para isso, adicionaremos essa funcionalidade √† nossa f√°brica. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Rule, SchematicContext, Tree, filter, apply, template, move, chain, branchAndMerge, mergeWith, url, SchematicsException } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular-devkit/schematics'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {BemPugOptions} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./schema"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {getWorkspace} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"@schematics/angular/utility/config"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {parseName} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"@schematics/angular/utility/parse-name"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {normalize, strings} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"@angular-devkit/core"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { AddToModuleContext } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./add-to-module-context'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ts <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'typescript'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {classify, dasherize} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"@angular-devkit/core/src/utils/strings"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {buildRelativePath, findModuleFromOptions, ModuleOptions} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"@schematics/angular/utility/find-module"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {addExportToModule, addImportToModule} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"@schematics/angular/utility/ast-utils"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {InsertChange} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"@schematics/angular/utility/change"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> stringUtils = { dasherize, classify }; <span class="hljs-comment"><span class="hljs-comment">// You don't have to export the function as default. You can also have more than one rule factory // per file. function filterTemplates(options: BemPugOptions): Rule { if (!options.componentModule) { return filter(path =&gt; !path.match(/\.module\.ts$/) &amp;&amp; !path.match(/-item\.ts$/) &amp;&amp; !path.match(/\.bak$/)); } return filter(path =&gt; !path.match(/\.bak$/)); } function setupOptions(options: BemPugOptions, host: Tree): void { const workspace = getWorkspace(host); if (!options.project) { options.project = Object.keys(workspace.projects)[0]; } const project = workspace.projects[options.project]; if (options.path === undefined) { const projectDirName = project.projectType === 'application' ? 'app' : 'lib'; options.path = `/${project.root}/src/${projectDirName}`; } const parsedPath = parseName(options.path, options.name); options.name = parsedPath.name; options.path = parsedPath.path; options.module = options.module || findModuleFromOptions(host, options) || ''; options.bemPugMixinPath = buildRelativePath(`${options.path}/${options.name}/${options.name}.component.ts`, `/src/app/common/bempugMixin.pug`); } export function createAddToModuleContext(host: Tree, options: ModuleOptions, componentPath: string): AddToModuleContext { const result = new AddToModuleContext(); if (!options.module) { throw new SchematicsException(`Module not found.`); } // Reading the module file const text = host.read(options.module); if (text === null) { throw new SchematicsException(`File ${options.module} does not exist.`); } const sourceText = text.toString('utf-8'); result.source = ts.createSourceFile(options.module, sourceText, ts.ScriptTarget.Latest, true); result.relativePath = buildRelativePath(options.module, componentPath); result.classifiedName = stringUtils.classify(`${options.name}ComponentModule`); return result; } function addDeclaration(host: Tree, options: ModuleOptions, componentPath: string) { const context = createAddToModuleContext(host, options, componentPath); const modulePath = options.module || ''; const declarationChanges = addImportToModule( context.source, modulePath, context.classifiedName, context.relativePath); const declarationRecorder = host.beginUpdate(modulePath); for (const change of declarationChanges) { if (change instanceof InsertChange) { declarationRecorder.insertLeft(change.pos, change.toAdd); } } host.commitUpdate(declarationRecorder); }; function addExport(host: Tree, options: ModuleOptions, componentPath: string) { const context = createAddToModuleContext(host, options, componentPath); const modulePath = options.module || ''; const exportChanges = addExportToModule( context.source, modulePath, context.classifiedName, context.relativePath); const exportRecorder = host.beginUpdate(modulePath); for (const change of exportChanges) { if (change instanceof InsertChange) { exportRecorder.insertLeft(change.pos, change.toAdd); } } host.commitUpdate(exportRecorder); }; export function addDeclarationToNgModule(options: ModuleOptions, exports: boolean, componentPath: string): Rule { return (host: Tree) =&gt; { addDeclaration(host, options, componentPath); if (exports) { addExport(host, options, componentPath); } return host; }; } function deleteCommon(host: Tree) { const path = `/src/app/common/bempugMixin.pug`; if(host.exists(path)) { host.delete(`/src/app/common/bempugMixin.pug`); } } export function bempugComponent(options: BemPugOptions): Rule { return (host: Tree, context: SchematicContext) =&gt; { setupOptions(options, host); deleteCommon(host); const templateSource = apply(url('./files'), [ filterTemplates(options), template({ ...strings, ...options }), move(options.path || '') ]); const mixinSource = apply(url('./common'), [ template({ ...strings, ...options }), move('/src/app/' || '') ]); const rule = chain([ branchAndMerge(chain([ mergeWith(templateSource), mergeWith(mixinSource), addDeclarationToNgModule(options, !!options.export, `${options.path}/${options.name}/${options.name}-component.module` || '') ]), 14) ]); return rule(host, context); } }</span></span></code> </pre><br><p>  √â hora de come√ßar a preencher nossos arquivos de modelo. </p><br><p>  <code>__name@dasherize__.component.pug</code> : </p><br><pre> <code class="javascript hljs">include &lt;%= bemPugMixinPath %&gt; +b(<span class="hljs-string"><span class="hljs-string">'&lt;%= name %&gt;'</span></span>) +e(<span class="hljs-string"><span class="hljs-string">'item'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">m</span></span>:<span class="hljs-string"><span class="hljs-string">'test'</span></span>}) | <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag"> %&gt;</span></span></span><span class="xml"> works</span></span></code> </pre> <br><p>  O que √© especificado em &lt;% =%&gt; durante a gera√ß√£o ser√° substitu√≠do pelo nome do componente. </p><br><p> <code>__name@dasherize__.component.spec.ts:</code> </p> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>, ComponentFixture, TestBed } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular/core/testing'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {NO_ERRORS_SCHEMA} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular/core'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { &lt;%= classify(name) %&gt;ComponentModule } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./&lt;%= name %&gt;-component.module'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { &lt;%= classify(name) %&gt;Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./&lt;%= name %&gt;.component'</span></span>; describe(<span class="hljs-string"><span class="hljs-string">'&lt;%= classify(name) %&gt;Component'</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> component: <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">classify</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">) %&gt;</span></span></span><span class="xml">Component; let fixture: ComponentFixture</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;&lt;%= </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">classify(name)</span></span></span></span><span class="xml"><span class="hljs-tag"> %&gt;</span></span></span><span class="xml">Component&gt;; beforeEach(async(() =&gt; { TestBed.configureTestingModule({ imports: [</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">classify</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">) %&gt;</span></span></span><span class="xml">ComponentModule], declarations: [], schemas: [ NO_ERRORS_SCHEMA ] }) .compileComponents(); })); beforeEach(() =&gt; { fixture = TestBed.createComponent(</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">classify</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">) %&gt;</span></span></span><span class="xml">Component); component = fixture.componentInstance; fixture.detectChanges(); }); it('should create', () =&gt; { expect(component).toBeTruthy(); }); });</span></span></code> </pre> <br><p>  Nesse caso, &lt;% = classify (name)%&gt; √© usado para converter o nome no CamelCase. </p><br><p> <code>__name@dasherize__.component.ts:</code> </p> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Component, OnInit, ViewEncapsulation} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular/core'</span></span>; @Component({ <span class="hljs-attr"><span class="hljs-attr">selector</span></span>: <span class="hljs-string"><span class="hljs-string">'app-&lt;%=dasherize(name)%&gt;-component'</span></span>, <span class="hljs-attr"><span class="hljs-attr">templateUrl</span></span>: <span class="hljs-string"><span class="hljs-string">'&lt;%=dasherize(name)%&gt;.component.pug'</span></span>, <span class="hljs-attr"><span class="hljs-attr">styleUrls</span></span>: [<span class="hljs-string"><span class="hljs-string">'./&lt;%=dasherize(name)%&gt;-component.scss'</span></span>], <span class="hljs-attr"><span class="hljs-attr">encapsulation</span></span>: ViewEncapsulation.None }) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> &lt;%</span></span>= classify(name) %&gt;Component implements OnInit { <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() {} ngOnInit(): <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> { } }</code> </pre><br><p> <code>__name@dasherize__-component.module.ts:</code> </p> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { NgModule } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular/core'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { CommonModule } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular/common'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {&lt;%= classify(name) %&gt;Component} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./&lt;%= name %&gt;.component'</span></span>; @NgModule({ <span class="hljs-attr"><span class="hljs-attr">declarations</span></span>: [ <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">classify</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">) %&gt;</span></span></span><span class="xml">Component, ], imports: [ CommonModule ], exports: [ </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">classify</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">) %&gt;</span></span></span><span class="xml">Component, ] }) export class </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">classify</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">) %&gt;</span></span></span><span class="xml">ComponentModule { }</span></span></code> </pre> <br><p> <code>__name@dasherize__-component.scss:</code> </p> <br><pre> <code class="css hljs">.&lt;%= <span class="hljs-selector-tag"><span class="hljs-selector-tag">name</span></span> %&gt;{ }</code> </pre> <br><p>  Fazemos a constru√ß√£o do nosso esquema com o comando `` npm run build``. </p><br><p>  Tudo est√° pronto para gerar componentes no projeto! </p><br><p>  Para verificar, volte ao nosso projeto Angular e crie um m√≥dulo. <br> <code>ng gm test-schema</code> <br>  Em seguida, fazemos `` npm link &lt;caminho absoluto para a pasta do projeto com nosso esquema&gt; '', para adicionar nosso esquema aos node_modules do projeto. </p><br><p>  E tentamos o circuito com o <code>ng g bempug-component:bempug-component test -m /src/app/test-schema/test-schema.module.ts ‚Äìexport</code> . <br>  Nosso esquema criar√° um componente e o adicionar√° ao m√≥dulo especificado com exporta√ß√£o. <br>  O esquema est√° pronto, voc√™ pode come√ßar a fazer o aplicativo em tecnologias familiares. </p><br><p>  Voc√™ pode ver a vers√£o final <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> , e tamb√©m o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pacote est√° dispon√≠vel no npm</a> . </p><br><p>  Ao criar o esquema, usei artigos sobre esse t√≥pico, expresso minha gratid√£o aos autores. </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://blog.angular.io/schematics-an-introduction-dc1dfbc2a2b2</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://medium.com/@tomastrajan/total-guide-to-custom-angular-schematics-5c50cf90cdb4</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://developer.okta.com/blog/2019/02/13/angular-schematics</a> ; </li></ul><br><p>  Obrigado por sua aten√ß√£o, todos que l√™em at√© o fim, voc√™ √© o melhor! <br>  E outro projeto emocionante me espera.  At√© breve! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt469509/">https://habr.com/ru/post/pt469509/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt469497/index.html">Crie n√≠veis 2D isom√©tricos com o sistema Tilemap</a></li>
<li><a href="../pt469499/index.html">Como n√≥s da Parallels Conquistamos entre com a Apple</a></li>
<li><a href="../pt469503/index.html">Seguran√ßa cibern√©tica: protegemos os dados dos assinantes contra vazamentos em 2019</a></li>
<li><a href="../pt469505/index.html">3 maneiras pr√°ticas de levar neg√≥cios para mercados estrangeiros: abordagens e t√©cnicas de empresas reais</a></li>
<li><a href="../pt469507/index.html">Terceira vulnerabilidade do Steam Windows Client, mas n√£o 0 dia</a></li>
<li><a href="../pt469515/index.html">Preparando o Aplicativo para Istio</a></li>
<li><a href="../pt469521/index.html">Comprei uma moto para andar, para n√£o cair</a></li>
<li><a href="../pt469523/index.html">Depend√™ncia do desempenho do c√≥digo no contexto da declara√ß√£o de vari√°veis ‚Äã‚Äãem JavaScript</a></li>
<li><a href="../pt469525/index.html">Sistema de controle automatizado para uma escavadeira de minera√ß√£o</a></li>
<li><a href="../pt469527/index.html">O interfone √© um ouvido espi√£o?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>