<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💅🏻 ☠️ 🖖🏽 Cómo hacer un teclado - Matrix 💼 🆙 🚜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Publicado por : Komar, alias Michał Trybus; Traducción inglés-ruso : firerock 
 Original : blog.komar.be/how-to-make-a-keyboard-the-matrix
 
 Esta es ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cómo hacer un teclado - Matrix</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/394585/"><sub><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Publicado por</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komar,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> alias Michał Trybus; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Traducción inglés-ruso</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :   </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">firerock </font></font></a></sub><br>
<sup><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Original</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blog.komar.be/how-to-make-a-keyboard-the-matrix</font></font></a></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Esta es la primera publicación de una serie sobre teclados; </font><font style="vertical-align: inherit;">Espero que no sea el último. </font><font style="vertical-align: inherit;">Me gustaría terminar con un curso de fabricación de teclados desde cero. </font><font style="vertical-align: inherit;">Hoy hablaré sobre la entrada-salida digital y las matrices de teclado. </font><font style="vertical-align: inherit;">Ármate con los conocimientos básicos de la escuela en el campo de la electrónica, y vámonos.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Por qué una matriz?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¿Y cómo vamos a hacer la matriz? Y lo más importante: ¿por qué es necesario? Bueno, esto se debe principalmente a las limitaciones físicas de los microcontroladores en los que están construidos los teclados. El hecho es que con un aumento en el número de salidas para microcontroladores y circuitos lógicos programables, su tamaño también crece, lo que, a su vez, implica un aumento en el consumo de energía, las capacidades, pero lo más importante, los precios. Como resultado, puede elegir un chip barato con un rendimiento pequeño (que le convenga), pero con una pequeña cantidad de entradas y salidas, o un chip más potente, cuyo rendimiento, sin embargo, excede en gran medida sus requisitos. Pero solo este potente chip tendrá suficientes salidas para conectar cada botón en el teclado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante décadas, la práctica se ha desarrollado en electrónica con la ayuda de varios trucos para expandir artificialmente las capacidades de comunicación incorporadas de procesadores y controladores. </font><font style="vertical-align: inherit;">Uno de esos métodos, que es muy adecuado para contactos mecánicos (botones), es la creación de una matriz. </font><font style="vertical-align: inherit;">Para entender cómo funciona, se requieren algunos conocimientos básicos. </font><font style="vertical-align: inherit;">Antes de continuar, actualice la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ley de Ohm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poco de teoría</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para comprender cómo funciona la electrónica digital, debe aprender dos principios básicos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El principio uno</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dice que el proceso de comunicación dentro de un circuito no se trata de transmitir o recibir algo allí. Para garantizar la comunicación entre los dos dispositivos, simplemente conecte sus hallazgos entre sí con material eléctricamente conductor. Después de esto, se supone que el estado del material (voltaje y corriente) en ambos extremos será el mismo. En realidad, por supuesto, esto no es así, pero para comunicaciones lentas y conductores cortos, nuestra suposición funciona bien. Resulta que enviar y recibir información es en realidad su intercambio.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde el lado del transmisor, simplemente cambia el estado eléctrico del conductor (inyectando corriente continua en él, cambiando su potencial), con la esperanza de que el receptor pueda detectar este cambio y comprenderlo correctamente. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De este principio también se deduce que no existe una relación entre la dirección de la comunicación y la dirección de la corriente eléctrica.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Muchas personas asumen erróneamente lo contrario, y esto les impide comprender cómo funciona la electrónica.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si desea enviar un nivel lógico de "0", generalmente para esto el voltaje en la salida del transmisor se reduce a 0 V, y la corriente comienza a fluir desde el receptor al transmisor para que el receptor pueda determinar que el nivel lógico corresponde a "0". (Mientras que la dirección inversa de la corriente significaría que en algún lugar del circuito hay un potencial negativo, y esto, por regla general, no ocurre en la electrónica digital). Por otro lado, se aplica un voltaje igual al voltaje de alimentación para transmitir el nivel lógico "1", y dado que este es el voltaje más alto en el circuito, no quedará nada más para que la corriente eléctrica fluya del transmisor al receptor. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Principio número dos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">radica en el hecho de que es imposible determinar el estado del conductor sin cambiar este estado. </font><font style="vertical-align: inherit;">No importa si va a medir voltaje o corriente; en cualquier caso, para esto es necesario que los electrones fluyan a través de su dispositivo de medición. </font><font style="vertical-align: inherit;">El flujo de electrones: esta es la corriente eléctrica, y dado que fluye, significa que en el nodo al que está conectado para la medición, las corrientes y el voltaje ya han cambiado (consulte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">las leyes de Kirchhoff</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Se deduce que si necesita "transmitir" información cambiando el estado de la salida conectada eléctricamente a otra salida, entonces debe mantener este estado, lo que significa que debe cumplir con todos los requisitos impuestos por el receptor.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Botón</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un botón mecánico (y en este contexto la palabra "mecánico" no está conectada con la frase "teclado mecánico") es solo un par de contactos metálicos que, en contacto, conectan eléctricamente los dos terminales. Por supuesto, hay otros tipos de interruptores que son estructuralmente más complejos y tienen más salidas, pero no nos interesan porque no se usan en teclados. </font></font><br>
<br>
<img src="https://habrastorage.org/files/910/b1e/9b7/910b1e9b776543e0a3cf502aca657473.jpg"><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Botón Cherry MX. Fuente de la imagen: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiki Deskthority</font></font></a></sub><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bueno, ¿y cómo conectaremos el botón a la entrada del microcontrolador? Básicamente, cualquier entrada puede operar con dos niveles lógicos posibles: "0" y "1". Es una práctica común aceptar voltajes cercanos a 0 V como un cero lógico, y voltajes cercanos a un voltaje de suministro (típicamente 5 V o 3,3 V) como una unidad lógica. Pero el problema es que el botón mecánico por sí solo no puede controlar el voltaje. Controla la corriente, es decir, si conectamos dos nodos con un potencial eléctrico diferente a través del botón, entonces la corriente entre estos nodos fluirá si y solo cuando se presiona el botón. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero si agregamos una resistencia, entonces podemos convertir fácilmente la corriente en voltaje. </font></font><br>
<br>
<img src="https://habrastorage.org/files/2df/7ff/d4e/2df7ffd4e1584d38a170b8028fd06021.png"><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Botón de resistencia pull-up</font></font></sub><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Echa un vistazo a este diagrama. Cuando no se presiona el botón (el circuito está roto), la corriente no fluye a través de él, por lo que el voltaje en el nodo "A" estará cerca del voltaje de suministro VCC (de hecho, menor que VCC por el valor de la caída de voltaje a través de la resistencia igual a R • I). Cuando se presiona el botón (circuito cerrado), la corriente fluye a través de la resistencia a tierra. Dado que la resistencia del botón cerrado es muy pequeña (del orden de cientos de miliom), el voltaje en el nodo "A" estará cerca de "0". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En esta configuración, la resistencia se llama pull-up porque "eleva el voltaje" al nivel de VCC. Y sin conectarse a la fuente de alimentación a través de la resistencia, no habría voltaje en absoluto en el nodo "A" (en este caso, la salida del microcircuito se llama "colgando en el aire" o en un estado de alta impedancia).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cabe señalar que dentro de la mayoría de los microcontroladores modernos ya hay resistencias pull-up que se pueden conectar o desconectar rápidamente usando el programa. </font><font style="vertical-align: inherit;">Entonces, la forma principal de conectar el botón al microcontrolador es la siguiente: un pin del botón está en la entrada del microcontrolador, el otro pin del botón está en el suelo. </font><font style="vertical-align: inherit;">En este caso, si no se presiona el botón, se envía "1" al microcontrolador, y si se presiona, entonces "0". </font><font style="vertical-align: inherit;">Quizás esto contradiga la intuición, pero este método de conexión es el más popular.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenga en cuenta que si dejamos colgando en el aire uno de los pines del botón, es decir, si no lo conectamos a ningún lado, este botón no funcionará en absoluto: si no lo presiona, no afectará el estado eléctrico de la salida del microcontrolador. </font><font style="vertical-align: inherit;">Todavía usaremos esta propiedad cuando creemos la matriz.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Principio de la matriz</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El principio básico de la matriz del teclado es la capacidad de conectar más de un botón a una entrada del microcontrolador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usando transistores o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salidas de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> microcontrolador </font><font style="vertical-align: inherit;">configuradas correctamente </font><b><font style="vertical-align: inherit;">,</font></b><font style="vertical-align: inherit;"> podemos hacer que los botones se conecten a la tierra uno a la vez, mientras que el resto colgará en el aire. </font><font style="vertical-align: inherit;">Las conclusiones restantes de cada uno de los botones se combinan en un nodo y se conectan a la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entrada.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">microcontrolador Bajé la resistencia pull-up, ya que sabemos que ya está presente dentro del microcontrolador, en su etapa de entrada. Nos turnamos para "encender" cada botón, conectando su número de salida 1 a tierra a través de la salida correspondiente del microcontrolador, después de lo cual podemos leer el estado del botón en la entrada eliminando el voltaje de su número de salida 2. Otros botones conectados a la misma entrada no afectan en su condición, porque sus conclusiones número 1 están actualmente suspendidas en el aire. El siguiente diagrama ilustra esta idea. </font></font><br>
<br>
<img src="https://habrastorage.org/files/e7e/2db/cca/e7e2dbccac834fef95bb30b1bdb134d3.png"><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muchos botones, una entrada (nodo "A")</font></font></sub><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"A" es la única entrada del microcontrolador, y "C1" ... "Cn" son sus salidas. En una de las salidas se establece un "0" lógico, es decir, dentro del microcircuito este contacto está de alguna manera conectado a tierra, por lo tanto, la corriente siempre fluirá a este contacto (de acuerdo con el primer principio básico). Ahora, cuando se presiona el botón conectado a esta salida, a través de él la entrada "A" se "presionará" inmediatamente en el suelo, y se ajustará a "0". Al presionar los otros botones no cambiará nada, porque sus salidas de tierra no están conectadas a ningún lado en este momento. Cuando necesitamos sondear el siguiente botón, eliminamos el "0" lógico de la salida actual y establecemos este nivel en la siguiente salida, de modo que en cualquier momento solo se active una de las salidas del microcontrolador.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dicha configuración (cuando la salida está conectada a tierra o está deshabilitada) se denomina salida de drenaje abierto (OS) (históricamente, con un colector abierto (OK)). Aquí hice una simplificación: de hecho, un contacto no se puede desconectar completamente del circuito a menos que esté físicamente desconectado. Pero para E / S digitales simples, esta simplificación es bastante adecuada. La mayoría de los microcontroladores ofrecen la capacidad de configurar mediante programación sus contactos de salida para que funcionen en modo OS. Pero, ¿y si no tenemos esa oportunidad? Hay otra configuración: modo push-pull; Hoy esta opción es una de las más populares. Esta configuración funciona un poco diferente. En el estado "0", la salida todavía se empuja hacia el suelo, pero cuando ocurre el estado "1", se tira a la tensión de alimentación de VCC,para que la salida en el aire ya no se cuelgue, ahora puede convertirse en una fuente de corriente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¿Qué cambios conllevará esto en el diseño de la matriz? </font><font style="vertical-align: inherit;">Si no vamos a presionar varios botones al mismo tiempo, entonces ninguno. </font><font style="vertical-align: inherit;">Pero si vamos a hacerlo, eche un vistazo al dibujo e imagine por un segundo lo que sucederá entonces. </font><font style="vertical-align: inherit;">Al hacer clic en los dos botones, conectamos las dos salidas inferiores en un bucle cerrado. </font><font style="vertical-align: inherit;">Si al mismo tiempo uno de ellos está en el estado "0" y el otro está en el estado "1", entonces fluirá una corriente eléctrica desde la salida establecida a "1" a la salida establecida a "0". </font><font style="vertical-align: inherit;">Y dado que esta corriente no está limitada por nada (no hay resistencias), el circuito no solo se volverá inestable, sino que también puede salir volando del chip. </font><font style="vertical-align: inherit;">Bueno, por supuesto, es poco probable que sea posible considerar normalmente un estado lógico.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agregar filas</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede considerar el ejemplo anterior como una matriz que consta de una fila. Ahora increméntelo agregando líneas adicionales. De hecho, si podemos colgar una fila completa en una entrada, ¿por qué no podemos colgar una columna completa de botones en una salida? Es cierto que hay un requisito previo: cada botón de la columna debe estar conectado a una entrada separada del microcontrolador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si organizamos los botones en forma de matriz regular, esta condición se cumplirá automáticamente. Y la siguiente figura muestra cómo se verá la matriz de botones que consta de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> columnas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ym</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> filas ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no preste atención a las figuras verdes todavía</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<img src="https://habrastorage.org/files/8f8/989/832/8f89898324d64a3ead1d3b63fa8ecaa1.png"><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matriz de teclado simple</font></font></sub><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leer esta matriz es muy simple. Encuestamos una columna a la vez. La columna de lectura se selecciona conectando una de las salidas "C1". "Cn" a tierra (la salida en modo OS se traduce a "0"). Ahora, sondeando alternativamente las filas "R1" ... "Rm", podemos determinar el estado de cada botón de la columna seleccionada. Los botones de otras columnas no afectan nada, incluso si se presionan, porque en este momento sus cables a tierra están suspendidos en el aire (o, como dicen en electrónica, están en estado Hi-Z).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Después de sondear toda la columna, pasamos a la siguiente, dejando ir la salida actual y empujando la siguiente a cero. El escaneo matricial se considera completo cuando se sondean todas las columnas. Si todo se hace con la suficiente rapidez, el tipógrafo más rápido no notará los intervalos entre las encuestas de columna. Incluso con un microcontrolador de 16 MHz, podemos escanear fácilmente toda la matriz miles de veces por segundo, mientras que la máquina de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escribir</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> más rápida en la prueba en </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">hi-games.net</font></a><font style="vertical-align: inherit;"> alcanzó una velocidad de 203 palabras por minuto (ppm), es decir, un poco menos de 17 clics en segundo</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al diseñar un teclado usando una matriz, reducimos el número de pines necesarios para conectar todas las teclas. Pero para reducir el número de conclusiones al mínimo posible, necesitamos componer una matriz para que el número de columnas sea lo más cercano posible al número de filas. En una situación ideal, si el número de botones es </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n²</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , entonces lo mejor que podemos lograr con la matriz es </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ocupado microcontrolador pines. Sin embargo, hoy, cuando compilamos matrices, rara vez alguien busca minimizar el número de patas involucradas, porque los microcontroladores modernos, como regla, tienen un número suficiente de conclusiones libres. Además, la optimización máxima de la matriz puede ocasionar inconvenientes: el cableado de la placa o la distribución de cables en el dispositivo final será notablemente más complicado. Por lo tanto, vale la pena ir de la manera más conveniente: al compilar la matriz, intente seguir la disposición física de los botones. En este caso, para un teclado de computadora estándar, la matriz más simple tendrá solo 6 filas y un cierto número de columnas, dependiendo del diseño deseado. Por supuesto, desde el punto de vista del número de conclusiones involucradas, esta solución no es la más óptima, pero en el futuro, al menos, el cableado se simplificará.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero, ¿qué pasa si no tenemos salidas de drenaje abiertas?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede preguntar: ¿qué debemos hacer si todavía no hay modo OS en el microcontrolador seleccionado? </font><font style="vertical-align: inherit;">Bueno, ya hemos descubierto qué tipo de problema puede suceder, y que extraer las salidas al VCC (es decir, "conectarlas" a la fuente de alimentación) no es una buena idea. </font><font style="vertical-align: inherit;">Hay muchas formas de resolver este problema; </font><font style="vertical-align: inherit;">Entre ellos no solo hay buffers de salida especiales del sistema operativo, sino incluso registros de desplazamiento con salidas del sistema operativo, para minimizar aún más el número de tramos involucrados. </font><font style="vertical-align: inherit;">Pero hay otra técnica muy popular, que a menudo se usa en el diseño de teclados de computadora (de hecho, se usaba ampliamente en los viejos tiempos).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El problema de las columnas conectadas a las salidas push-pull aparece en el momento en que dos botones ubicados en la misma línea se presionan juntos, y al mismo tiempo, presionar el botón sondeará la columna en la que se encuentra uno de los botones. </font></font><br>
<br>
<img src="https://habrastorage.org/files/46e/3a8/4b1/46e3a84b1b774e1097d07503e3911c65.png"><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El problema de las salidas push-pull</font></font></sub><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Desde la salida, que se tira a "1" (y no se cuelga en el estado Hi-Z), comienza a fluir una corriente. Pasa a través del botón cerrado más cercano, luego a través del botón cerrado en la columna interrogada y finalmente fluye directamente al conjunto de salida a "0". Esto puede llevar a cualquier cosa, desde la imposibilidad de una lectura confiable del estado del teclado hasta la falla del microcontrolador.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero como nos vemos obligados a lidiar de alguna manera con este problema, podemos aplicar un gran truco: convertir una salida push-pull en una especie de salida de drenaje abierto. A menudo me encontré con esta solución en los diseños de teclados antiguos. Dado que la corriente solo debería fluir hacia las salidas (conectadas a las columnas), pero nunca fluir fuera de ellas, podemos limitar la dirección de la corriente usando diodos. Un diodo es un dispositivo simple que permite que la corriente fluya en una sola dirección. En la imagen del diodo en el circuito eléctrico, el triángulo simboliza la flecha que indica esta dirección. Si colocamos un diodo entre cada salida del microcontrolador y el conductor de la columna correspondiente de la matriz, entonces lograremos nuestro objetivo: ahora la corriente solo puede fluir hacia las salidas, porque estos conductores alcanzan cada botón de su columna. Resultaque desde la salida configurada a "1", la corriente no fluirá a ningún lado, y esto casi la convierte en una salida de drenaje abierto. Por supuesto, no alcanza el sistema operativo real, pero resuelve nuestro problema de un circuito de corriente cerrado en la matriz del teclado. Regrese a la penúltima imagen de la matriz, pero esta vez</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">considera los diodos verdes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para entender cómo funciona este truco. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, tiene sentido minimizar la cantidad de diodos. </font><font style="vertical-align: inherit;">Para hacer esto, puede reducir el número de columnas aumentando el número de filas. </font><font style="vertical-align: inherit;">Y si el resultado resultante no se ajusta bien al diseño real del teclado, puede "rotar" la matriz 90 ° (intercambiar filas con columnas). </font><font style="vertical-align: inherit;">Las posibilidades son infinitas. </font><font style="vertical-align: inherit;">Pero hoy en día, ha aparecido una gran cantidad de microcontroladores que son fáciles de usar y convenientes para los pasatiempos, por lo que hoy en día la técnica descrita prácticamente no se usa en proyectos de teclado de cosecha propia. </font><font style="vertical-align: inherit;">Afortunadamente</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clics fantasma (efecto fantasma)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si está interesado en clavs, entonces ya debe haber cumplido este término. Desafortunadamente, en el mundo de los teclados a menudo se interpreta incorrectamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ya estamos familiarizados con la situación cuando la presión simultánea de varios botones ubicados en la misma línea puede interferir con la lectura normal de la matriz. Y este problema, podemos decir, ha sido resuelto por nosotros. Ahora veamos qué sucede si hace clic en varios botones que están simultáneamente en la misma fila y en la misma columna. </font></font><br>
<br>
<img src="https://habrastorage.org/files/c1c/830/afd/c1c830afdd614656a91cd6c3ba061cf5.png"><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ejemplo de presión fantasma</font></font></sub><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En la figura, se presionan tres botones al mismo tiempo. Dos de ellos están en la columna "C2", y dos en la fila "Rm". Esto significa que uno de los botones presionados comparte la fila con el otro botón presionado, y la columna con el tercer botón presionado. Es en esta situación donde se produce la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">presión fantasma.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Imagine que actualmente estamos interrogando a la columna "C1" (es decir, está presionada contra el suelo, está en el estado "0"). Este acorde característico de los botones presionados conduce a lo siguiente: aunque el botón superior izquierdo no está presionado, la fila "R2" está en el estado "0", porque la columna "C1" (ubicada en "0") la presiona hasta el suelo tres botones presionados. Como resultado, el controlador del teclado lee el botón superior izquierdo como "presionado", independientemente de si se presiona o no. La situación descrita se llama </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">presión fantasma</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">efecto fantasma</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), porque algunas combinaciones de botones presionados simultáneamente causan respuestas fantasmas de otros botones (teclas fantasma), aunque físicamente estos otros botones no se presionan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, hay formas de proteger a los maquinistas y jugadores de las respuestas fantasmas, y estos métodos se usan ampliamente en los teclados de computadora modernos. Puede captar el momento en que se produce la presión fantasma y bloquearlo. Una persona común no puede presionar o soltar simultáneamente dos teclas con una precisión perfecta. Por lo tanto, al escanear la matriz lo suficientemente rápido, podemos suponer que entre dos pasadas a través de la matriz no más de un botón puede cambiar su estado. En este caso, el controlador acepta presiones individuales y monitorea la ocurrencia de situaciones cuando se presionan dos o más botones entre pasadas de matriz. Dado que el escaneo de la matriz ocurre a una velocidad a la cual la ocurrencia regular de tales situaciones es extremadamente improbable, podemos concluir que uno de los botones que se presiona es un fantasma.Por lo tanto, el controlador debe ignorar todos estos clics. Además, es más seguro no informar inmediatamente a la computadora sobre los cambios de estado del teclado; al principio, tiene sentido esperar hasta que desaparezcan todas estas operaciones.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay otro enfoque. Puede identificar la situación cuando se activa el "tercer" botón y bloquear tanto esta pulsación como todas las posteriores. No suelte el bloqueo hasta que desaparezca la respuesta fantasma y la situación vuelva a ser normal. Para implementar este enfoque, el programa debe recordar qué botones están presionados actualmente (y generalmente lo recuerda de esta manera) para rechazar las operaciones de botones posteriores, en las filas y columnas de las cuales ya se han registrado clics simultáneos. Si escribe el programa sabiamente, solo se bloquearán las respuestas problemáticas, y todas las posteriores se aceptarán como de costumbre, excepto aquellas que violen las reglas nuevamente. Una vez que el controlador rechaza presionar cada botón que ya tiene operaciones simultáneas en su fila y columna, resulta que dependiendo del estado de algunos botones,otros pueden no estar registrados en absoluto. Esta situación se conoce comúnmente como</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bloqueo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bloqueo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Es decir, los botones que impiden el funcionamiento simultáneo de otros botones, resulta que "bloquea" parte del teclado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde el punto de vista del usuario, es posible presionar simultáneamente todos los botones de una columna (sin presionar los botones de otra), pero simultáneamente presionar todos los botones de una fila solo si cada uno de los botones no tiene más de una operación en la columna. Lo mismo se aplica al presionar botones desde una sola columna: los disparadores adicionales se registran solo si los botones están en filas que "no están ocupadas". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las personas a menudo confunden " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">activación fantasma</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " y " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">activación de bloqueo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " (" </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">efecto fantasma</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " y "</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jamming</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "), lo cual es un misterio para mí personalmente, en mi opinión, estos términos son bastante intuitivos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En los teclados que utilizan las matrices que acabamos de examinar, no se pueden evitar las respuestas fantasmas ni el bloqueo. </font><font style="vertical-align: inherit;">Dado que las respuestas fantasmas en el trabajo diario son inaceptables, para combatirlas, casi todos los fabricantes de teclados de cúpula de goma usan varios trucos, y el bloqueo entra en juego. </font><font style="vertical-align: inherit;">Pregunta: ¿cómo componer una matriz de tal manera que el bloqueo ocurra tan raramente como sea posible y no sea causado por combinaciones de teclado comunes? </font><font style="vertical-align: inherit;">De hecho, este es un buen tema para todo el libro; </font><font style="vertical-align: inherit;">Es por eso que las matrices de teclados de bienes de consumo son tan confusas y siempre bloquean el buen humor (como un juego de palabras).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diodos para todos los botones: una solución cardinal</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vuelve a mirar la imagen sobre los clics fantasmas, puede notar que el culpable es el botón inferior derecho. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero este botón es el único a través del cual la corriente en esta situación fluye "hacia arriba". Entonces, si no queremos que las corrientes "ascendentes" actuales nos impidan leer la matriz normalmente, entonces introduzcamos diodos para que la corriente pueda fluir a través de las columnas estrictamente de arriba hacia abajo, fluyendo hacia las salidas del microcontrolador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desafortunadamente, el ahorro no es posible aquí: debe colocar un diodo en cada botón. Si hablamos de polaridad, entonces debería haber descubierto que en este caso particular, los diodos deben pasar la corriente "de arriba a abajo", es decir, sus cátodos ("puntas de flecha") deben mirar las salidas del microcontrolador (columnas), mientras que los ánodos deben ser dirigido a las entradas (líneas). </font></font><br>
<br>
<img src="https://habrastorage.org/files/5b6/8bf/f0f/5b68bff0fcf043eaac33246af5320dd1.png"><br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matriz de resumen</font></font></sub><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No importa en qué lado del botón se encuentre el diodo; Lo principal es observar la polaridad correcta. Solo recuerde que en este caso, la corriente siempre fluirá de entradas a salidas. Por cierto, si las entradas se activan y las salidas están en modo OS, esto siempre sucederá.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con este enfoque, resulta que la corriente siempre fluirá "hacia abajo", y esto elimina la aparición de bucles de corriente cerrados cuando se presionan simultáneamente varios botones. </font><font style="vertical-align: inherit;">Además, este diseño es el único que puede proporcionar al teclado NKRO completo. </font><font style="vertical-align: inherit;">Además, vale la pena mencionar (aunque esto parece obvio) que el problema de las salidas del microcontrolador que no tienen modo OS ahora se resuelve automáticamente. </font><font style="vertical-align: inherit;">Los diodos instalados secuencialmente con cada botón guardan las salidas de un circuito no peor que la opción considerada anteriormente, donde se suponía que también debía poner un diodo en cada columna.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rollover</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sí, sé que el texto ya es demasiado largo. </font><font style="vertical-align: inherit;">Pero aún agrego este último capítulo, porque, en mi opinión, sin él el artículo estaría incompleto. </font><font style="vertical-align: inherit;">Entonces, el rollover es la capacidad del teclado de tomar varios toques al mismo tiempo.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xKRO</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
KRO es </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de vuelco clave</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un vuelco clave</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), y por lo general esta abreviatura se titula por algún número. Por ejemplo, 2KRO significa un rollover de dos teclas. Un teclado tiene un </font><font style="vertical-align: inherit;">rollover de tecla </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si y solo si es capaz de registrar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pulsaciones de teclas simultáneas, además, independientemente de qué botones y secuencia se usaron. La mayoría de los teclados modernos de cúpula de goma tienen 2KRO. Sin embargo, de esto no se deduce que el número permitido de pulsaciones de teclas en estos teclados siempre estará limitado a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En realidad, esto significa que la compatibilidad con </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> click </font><font style="vertical-align: inherit;">está </font><font style="vertical-align: inherit;">garantizada exactamente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dependiendo del diseño de la matriz y del tipo de controlador, dos teclados 2KRO de diferentes fabricantes pueden comportarse de manera muy diferente. </font><font style="vertical-align: inherit;">Uno siempre puede aceptar dos clics simultáneos, y el otro puede digerir fácilmente aún más. </font><font style="vertical-align: inherit;">Parece que el último teclado fue anunciado por 2KRO porque algunas combinaciones de teclas (lo más probable es que sea poco probable) seguirán bloqueando la presión de otros botones. </font><font style="vertical-align: inherit;">Y dado que esto significa que cuando se trabaja con este teclado, ciertas combinaciones de tres teclas y más no funcionarán, la compañía lo anunció 2KRO.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nkro</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El término NKRO significa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rollover de teclas N</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y se usa para designar teclados que admiten, a pesar de todo, cualquier combinación de teclas presionadas simultáneamente. </font><font style="vertical-align: inherit;">Pero tenga en cuenta que las matrices NKRO y los teclados NKRO son dos grandes diferencias. </font><font style="vertical-align: inherit;">Por ejemplo, si la implementación final de la matriz, que examinamos en el artículo, es compatible con NKRO (teniendo en cuenta el firmware correctamente escrito), entonces esto no significa que el teclado que utiliza esta matriz también sea compatible con NKRO. </font><font style="vertical-align: inherit;">Esto puede deberse a restricciones impuestas por los puertos de comunicación a los que está conectado el teclado; </font><font style="vertical-align: inherit;">Otra razón podría ser la frugalidad de los fabricantes, siempre ahorrando aquí y allá. </font><font style="vertical-align: inherit;">Intentaré explicar el problema de NKRO al conectarme a PS / 2 y USB en las siguientes partes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resumen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, la hoja salió bastante bien, pero el concepto no es tan simple, especialmente para el lector, que no es ingeniero electrónico. </font><font style="vertical-align: inherit;">Espero haber logrado explicar todo; </font><font style="vertical-align: inherit;">Sea como fuere, traté de escribir con la mayor claridad posible. </font><font style="vertical-align: inherit;">Por lo tanto, para algunos de ustedes, el artículo puede parecer bastante aburrido. </font><font style="vertical-align: inherit;">Bueno, si te equivocas en electrónica, lo más probable es que no deberías haberlo leído en absoluto;) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cualquier caso, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avísame</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si el artículo te resultó útil y si vale la pena escribir una secuela. </font><font style="vertical-align: inherit;">Si es así, me sentaré para la próxima "serie". </font></font><br>
<br>
<sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Michał Trybus </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2 de septiembre de 2013</font></font></sub></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es394585/">https://habr.com/ru/post/es394585/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es394573/index.html">Se abre la primera oficina impresa en 3D en Dubai</a></li>
<li><a href="../es394575/index.html">El equipo de Itseez vuelve a trabajar en Intel</a></li>
<li><a href="../es394577/index.html">Proyecto Kronos y un equipo ruso poco conocido del campus académico de Novosibirsk Kronos Research Group (KRG)</a></li>
<li><a href="../es394579/index.html">Manos biónicas: historia, futuro y realidad.</a></li>
<li><a href="../es394583/index.html">Cómo logramos ahorros de energía en iluminación y generamos más energía con un medidor de luz</a></li>
<li><a href="../es394589/index.html">Crowdfunding para los más pequeños (Parte 1)</a></li>
<li><a href="../es394591/index.html">Guía de inicio rápido de navegación basada en fragmentos</a></li>
<li><a href="../es394595/index.html">Cómo se hincharon los astronautas en el módulo ISS BEAM: video de lapso de tiempo</a></li>
<li><a href="../es394599/index.html">Versión estable de Krita 3.0 con soporte de animación</a></li>
<li><a href="../es394601/index.html">Los trenes Hyperloop harán vibranium</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>