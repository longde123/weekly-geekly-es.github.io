<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßìüèΩ ü§úüèæ ‚è≤Ô∏è Caza de amenazas, o c√≥mo defenderse contra amenazas del 5% üßôüèæ üõÖ üë®üèª‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El 95% de las amenazas a la seguridad de la informaci√≥n son conocidas, y usted puede protegerse de ellas por medios tradicionales como antivirus, cort...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Caza de amenazas, o c√≥mo defenderse contra amenazas del 5%</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/447580/"> El 95% de las amenazas a la seguridad de la informaci√≥n son conocidas, y usted puede protegerse de ellas por medios tradicionales como antivirus, cortafuegos, IDS, WAF.  El 5% restante de las amenazas son desconocidas y las m√°s peligrosas.  Representan el 70% del riesgo para la empresa debido al hecho de que es muy dif√≠cil detectarlos y a√∫n m√°s para protegerse de ellos.  Ejemplos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">‚Äúcisnes negros‚Äù</a> son las epidemias de ransomware WannaCry, NotPetya / ExPetr, cryptominers, armas cibern√©ticas Stuxnet (que golpearon las instalaciones nucleares de Ir√°n) y muchos (¬øqui√©n m√°s recuerda Kido / Conficker?) Otros ataques que no son muy buenos para defenderse contra los cl√°sicos Medios de protecci√≥n.  Queremos hablar sobre c√≥mo contrarrestar este 5% de las amenazas utilizando la tecnolog√≠a Threat Hunting. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6f0/6a1/19e/6f06a119e1279e1bbbe9f3774f831f53.png"></div><a name="habracut"></a><br>  El desarrollo continuo de los ciberataques requiere una detecci√≥n y una lucha constantes, lo que finalmente nos lleva a la idea de una carrera armamentista interminable entre atacantes y defensores.  Los sistemas de protecci√≥n cl√°sicos ya no pueden proporcionar un nivel de seguridad aceptable en el que el nivel de riesgo no afecte a los indicadores clave de la empresa (econ√≥mico, pol√≠tico, de reputaci√≥n) sin finalizarlos para una infraestructura espec√≠fica, pero en general cubren algunos de los riesgos.  Ya en el proceso de implementaci√≥n y configuraci√≥n, los sistemas de protecci√≥n modernos se encuentran en el papel de ponerse al d√≠a y deben responder a los desaf√≠os de los tiempos modernos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a8f/a31/386/a8fa31386ee92fe03e60d4bb004c2ce0.png"></div>  <a href="">Fuente</a> <br><br>  Una de las respuestas a los desaf√≠os de nuestro tiempo para un especialista en seguridad de la informaci√≥n puede ser la tecnolog√≠a Threat Hunting.  El t√©rmino Caza de amenazas (en lo sucesivo denominado TH) apareci√≥ hace varios a√±os.  La tecnolog√≠a en s√≠ es bastante interesante, pero todav√≠a no tiene normas y reglas generalmente aceptadas.  La heterogeneidad de las fuentes de informaci√≥n y el peque√±o n√∫mero de fuentes de informaci√≥n en ruso sobre este tema tambi√©n complican el asunto.  En este sentido, nosotros en LANIT-Integration decidimos escribir una revisi√≥n de esta tecnolog√≠a. <br><br><h2>  Relevancia </h2><br>  La tecnolog√≠a TH se basa en procesos de monitoreo de infraestructura.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Hay dos escenarios principales de monitoreo interno: alerta y caza</a> .  La alerta (por tipo de servicio MSSP) es un m√©todo tradicional, que busca firmas y signos de ataques desarrollados anteriormente y reacciona a ellos.  Las caracter√≠sticas de seguridad de firma tradicionales completan con √©xito este escenario.  La caza (un servicio del tipo MDR) es un m√©todo de monitoreo que responde a la pregunta "¬øDe d√≥nde vienen las firmas y las reglas?".  Este es el proceso de crear reglas de correlaci√≥n analizando indicadores ocultos o previamente desconocidos y signos de un ataque.  Es a este tipo de monitoreo al que pertenece Threat Hunting. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df0/6ba/ffb/df06baffb0742e44018b15b5ae804de5.png"></div><br>  Solo combinando ambos tipos de monitoreo, obtenemos una protecci√≥n cercana al ideal, pero siempre queda alg√∫n nivel de riesgo residual. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6c6/820/fd3/6c6820fd3eca0e338e9f530bfb43ccc4.png"></div>  <i>Protecci√≥n usando dos tipos de monitoreo</i> <br><br>  Y aqu√≠ est√° el por qu√© TH (¬°y toda la caza!) Ser√° cada vez m√°s relevante: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ba/a47/d96/6baa47d96a13bafd8b10d2c11b4e1f79.png"></div>  <i>Amenazas, remedios, riesgos.</i>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Fuente</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El 95% de todas las amenazas ya se comprenden bien</a> .  Estos incluyen especies como spam, DDoS, virus, rootkits y otro malware cl√°sico.  Puedes protegerte de estas amenazas con las mismas defensas cl√°sicas. <br><br>  Durante la ejecuci√≥n de cualquier proyecto, el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">80% del trabajo lleva el 20% del tiempo</a> , y el 20% restante del trabajo lleva el 80% del tiempo.  Del mismo modo, entre todo el panorama de amenazas, el 5% del nuevo tipo de amenaza constituir√° el 70% del riesgo para la empresa.  En una empresa donde se organizan procesos de gesti√≥n de seguridad de la informaci√≥n, podemos gestionar el 30% del riesgo de amenazas conocidas de una forma u otra evitando (abandonando las redes inal√°mbricas en principio), aceptando (introduciendo las medidas de seguridad necesarias) o cambiando (por ejemplo, sobre los hombros de un integrador) esto riesgo  Protegerse de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">vulnerabilidades de d√≠a cero</a> , ataques APT, phishing, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ataques a trav√©s de la cadena de suministro</a> , ciber spyware y operaciones nacionales, as√≠ como de una gran cantidad de otros ataques, ya es mucho m√°s dif√≠cil.  Las consecuencias de estas amenazas del 5% ser√°n mucho m√°s graves (la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cantidad promedio de p√©rdidas del banco del grupo buhtrap es de 143 millones</a> ) que las consecuencias del spam o los virus de los que rescata el software antivirus. <br><br>  Casi todos tienen que lidiar con el 5% de las amenazas.  Recientemente, tuvimos que instalar una soluci√≥n de c√≥digo abierto que utiliza una aplicaci√≥n del repositorio PEAR (PHP Extension and Application Repository).  Fall√≥ un intento de instalar esta aplicaci√≥n a trav√©s de la instalaci√≥n de Pear, porque el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sitio</a> no estaba disponible (ahora hay un trozo), tuve que instalarlo desde GitHub.  Y recientemente se hizo evidente que PEAR fue v√≠ctima de un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ataque a trav√©s de la cadena de suministro</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gv/kp/ja/gvkpjav5nqtvhmubvsavkm6n1vg.png"></div><br><br>  Tambi√©n puede recordar el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ataque utilizando CCleaner</a> , una epidemia del ransomware NePetya a trav√©s del m√≥dulo de actualizaci√≥n del programa para la declaraci√≥n de impuestos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MEDoc</a> .  Las amenazas son cada vez m√°s sofisticadas, y surge la pregunta l√≥gica: "¬øC√≥mo puede resistir este 5% de las amenazas?" <br><br><h2>  Definici√≥n de caza de amenazas </h2><br>  Por lo tanto, Threat Hunting es un proceso de b√∫squeda y detecci√≥n proactiva e iterativa de amenazas avanzadas que no pueden detectarse por medios tradicionales de protecci√≥n.  Las amenazas avanzadas incluyen, por ejemplo, ataques como APT, ataques a vulnerabilidades de 0 d√≠as, Vivir fuera de la tierra, etc. <br><br>  Tambi√©n se puede reformular que TH es un proceso de prueba de hip√≥tesis.  Se trata principalmente de un proceso manual con elementos de automatizaci√≥n, en el que el analista, bas√°ndose en su conocimiento y calificaciones, examina grandes cantidades de informaci√≥n en busca de signos de compromiso que correspondan a la hip√≥tesis inicialmente definida sobre la presencia de una determinada amenaza.  Una caracter√≠stica distintiva es la variedad de fuentes de informaci√≥n. <br><br>  Cabe se√±alar que Threat Hunting no es un tipo de producto de software o hardware.  Estas no son alertas que se pueden ver en cualquier soluci√≥n.  Este no es un proceso para encontrar IOC (identificadores de compromiso).  Y este no es un tipo de actividad pasiva que se realiza sin la participaci√≥n de analistas de seguridad de la informaci√≥n.  La caza de amenazas es, ante todo, un proceso. <br><br><h2>  Componentes de caza de amenazas </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/528/6af/453/5286af453a0cac4b426159d8e123f8c4.png"></div><br>  Tres componentes principales de Threat Hunting: datos, tecnolog√≠a, personas. <br><br>  <b>Datos (¬øqu√©?)</b> , Incluyendo Big Data.  Todo tipo de flujos de tr√°fico, informaci√≥n sobre APT realizadas anteriormente, an√°lisis, datos de actividad del usuario, datos de red, informaci√≥n de empleados, informaci√≥n en la darknet y mucho m√°s. <br><br>  <b>Tecnolog√≠as (¬øc√≥mo?) Para</b> procesar estos datos, hay todas las formas posibles de procesar estos datos, incluido el aprendizaje autom√°tico. <br><br>  <b>Personas (¬øqui√©n?) Son</b> aquellos que tienen una amplia experiencia en el an√°lisis de una variedad de ataques, intuici√≥n desarrollada y la capacidad de detectar un ataque.  Por lo general, estos son analistas de seguridad de la informaci√≥n que deben tener la capacidad de generar hip√≥tesis y encontrar evidencia para ellas.  Son el enlace principal en el proceso. <br><br><h2>  Modelo paris </h2><br>  Adam Bateman <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">describe</a> el modelo PARIS para el proceso TH ideal.  El nombre, ya que alude al famoso monumento de Francia.  Este modelo se puede considerar en dos direcciones: arriba y abajo. <br><br>  En el proceso de b√∫squeda de amenazas, siguiendo el modelo, trataremos con muchas pruebas de actividad maliciosa.  Cada evidencia tiene una medida de confianza, una caracter√≠stica que refleja el peso de esta evidencia.  Hay evidencia directa de actividad maliciosa "de hierro", por la cual podemos llegar inmediatamente a la cima de la pir√°mide y crear una notificaci√≥n real de una infecci√≥n conocida.  Y hay evidencia indirecta, cuya suma tambi√©n puede llevarnos a la cima de la pir√°mide.  Como siempre, hay mucha m√°s evidencia indirecta que evidencia directa, lo que significa que deben clasificarse y analizarse, se debe realizar una investigaci√≥n adicional, y es recomendable automatizar esto. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/40c/e5d/f57/40ce5df5731f6024e785dd678c251d48.png"></div>  <i>Modelo paris.</i>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Fuente</a> <br><br>  La parte superior del modelo (1 y 2) se basa en tecnolog√≠as de automatizaci√≥n y an√°lisis diversos, y la parte inferior (3 y 4) se basa en personas con ciertas calificaciones que controlan el proceso.  Puede considerar el modelo, movi√©ndose de arriba a abajo, donde en la parte superior de azul tenemos notificaciones de medios tradicionales de protecci√≥n (antivirus, EDR, firewall, firmas) con un alto grado de confianza, y debajo hay indicadores (COI, URL, MD5 y otros), que tienen menos confianza y requieren m√°s estudio.  Y el nivel m√°s bajo y m√°s grueso (4) es la generaci√≥n de hip√≥tesis, la creaci√≥n de nuevos escenarios del trabajo de los remedios tradicionales.  Este nivel no se limita a las fuentes indicadas de hip√≥tesis.  Cuanto m√°s bajo sea el nivel, m√°s requisitos se imponen a las calificaciones del analista. <br><br>  Es muy importante que los analistas no solo prueben un conjunto finito de hip√≥tesis predefinidas, sino que trabajen constantemente para generar nuevas hip√≥tesis y opciones para probarlas. <br><br><h2>  TH utiliza el modelo de madurez </h2><br>  En un mundo ideal, TH es un proceso continuo.  Pero, dado que no existe un mundo ideal, analizaremos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el modelo</a> y los m√©todos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">madurez</a> en el contexto de las personas, los procesos y las tecnolog√≠as utilizadas.  Considere un modelo de TH esf√©rico ideal.  Hay 5 niveles de uso de esta tecnolog√≠a.  Consid√©relos en el ejemplo de la evoluci√≥n de un solo equipo de analistas. <br><table><tbody><tr><td width="170">  <b>Niveles de madurez</b> </td><td>  <b>Personas</b> </td><td>  <b>Los procesos</b> </td><td>  <b>Tecnolog√≠a</b> </td></tr><tr><td>  <b>Nivel 0</b> </td><td>  Analistas de COS </td><td>  24/7 </td><td>  Instrumentos tradicionales: </td></tr><tr><td>  Tradicional </td><td>  Conjunto de alertas </td><td>  Monitoreo pasivo </td><td>  IDS, AV, Sandboxing, </td></tr><tr><td>  <i>Sin TH</i> </td><td>  Trabaja con alertas </td><td></td><td>  herramientas de an√°lisis de firmas, datos de inteligencia de amenazas. </td></tr><tr><td>  <b>Nivel 1</b> </td><td>  Analistas de COS </td><td>  TH de una sola vez </td><td>  EDR </td></tr><tr><td>  Experimental </td><td>  Conocimientos b√°sicos de forense </td><td>  B√∫squeda del COI </td><td>  Cobertura parcial de datos de dispositivos de red. </td></tr><tr><td>  <i>Experimentos con TH</i> </td><td>  Buen conocimiento de redes y aplicaciones. </td><td></td><td>  Aplicaci√≥n parcial </td></tr><tr><td>  <b>Nivel 2</b> </td><td>  Ocupaci√≥n temporal </td><td>  Sprints </td><td>  EDR </td></tr><tr><td>  Peri√≥dica </td><td>  El conocimiento promedio de forense </td><td>  Semana por mes </td><td>  Aplicaci√≥n completa </td></tr><tr><td>  <i>TH temporal</i> </td><td>  Excelente conocimiento de redes y aplicaciones. </td><td>  Th regular </td><td>  Automatizaci√≥n total del uso de datos EDR </td></tr><tr><td></td><td></td><td></td><td>  Uso parcial de funciones avanzadas de EDR </td></tr><tr><td>  <b>Nivel 3</b> </td><td>  Equipo TH dedicado </td><td>  24/7 </td><td>  Capacidad parcial para probar hip√≥tesis TH </td></tr><tr><td>  Proactiva </td><td>  Excelente conocimiento de forense y malware </td><td>  TH proactivo </td><td>  Uso completo de las funciones avanzadas de EDR </td></tr><tr><td>  <i>Casos especiales TH</i> </td><td>  Excelente conocimiento del atacante. </td><td>  Casos especiales TH </td><td>  Cobertura total de datos de dispositivos de red. </td></tr><tr><td></td><td></td><td></td><td>  Configuraci√≥n personalizada </td></tr><tr><td>  <b>Nivel 4</b> </td><td>  Equipo TH dedicado </td><td>  24/7 </td><td>  Capacidad total para probar hip√≥tesis TH </td></tr><tr><td>  L√≠der </td><td>  Excelente conocimiento de forense y malware </td><td>  TH proactivo </td><td>  Nivel 3, m√°s: </td></tr><tr><td>  <i>Usando TH</i> </td><td>  Excelente conocimiento del atacante. </td><td>  Prueba, automatizaci√≥n y verificaci√≥n de hip√≥tesis de TH </td><td>  estrecha integraci√≥n de las fuentes de datos; </td></tr><tr><td></td><td>  Capacidad de investigaci√≥n </td><td></td><td>  Desarrollo personalizado y uso de API personalizado. </td></tr></tbody></table>  <i>Niveles de madurez de TH por personas, procesos y tecnolog√≠a</i> <br><br>  <b>Nivel 0:</b> tradicional, sin usar TH.  Los analistas convencionales trabajan con un conjunto est√°ndar de alertas en modo de monitoreo pasivo utilizando herramientas y tecnolog√≠as est√°ndar: IDS, AV, sandboxes, herramientas de an√°lisis de firmas. <br><br>  <b>Nivel 1:</b> experimental utilizando TH.  Los mismos analistas con conocimientos b√°sicos de medicina forense y buenos conocimientos de redes y la aplicaci√≥n pueden implementar la caza de amenazas de una sola vez buscando indicadores de compromiso.  Las EDR con cobertura parcial de datos de dispositivos de red se agregan a las herramientas.  Las herramientas se aplican parcialmente. <br><br>  <b>Nivel 2:</b> intermitente, TH temporal.  Los mismos analistas que ya han aumentado sus conocimientos de medicina forense, redes y la parte de la aplicaci√≥n tienen la obligaci√≥n de participar regularmente en la caza de amenazas (sprint), por ejemplo, una semana al mes.  Las herramientas se complementan con un estudio completo de los datos de los dispositivos de red, la automatizaci√≥n del an√°lisis de datos de EDR y el uso parcial de las funciones avanzadas de EDR. <br><br>  <b>Nivel 3:</b> preventivo, casos frecuentes de TH.  Nuestros analistas organizados en un equipo dedicado, comenzaron a tener un excelente conocimiento de an√°lisis forense y malware, as√≠ como conocimiento de los m√©todos y t√°cticas del lado atacante.  El proceso ya est√° en curso 24/7.  El equipo puede probar parcialmente las hip√≥tesis TH, haciendo pleno uso de las capacidades avanzadas de EDR con una cobertura total de datos de dispositivos de red.  Adem√°s, los analistas pueden configurar herramientas para satisfacer sus necesidades. <br><br>  <b>Nivel 4:</b> gama alta, utilizando TH.  El mismo equipo adquiri√≥ la capacidad de investigar, la capacidad de generar y automatizar el proceso de probar hip√≥tesis TH.  Ahora, se ha agregado a las herramientas una estrecha integraci√≥n de las fuentes de datos, el desarrollo de software para las necesidades y el uso no est√°ndar de las API. <br><br><h2>  T√©cnicas de caza de amenazas </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/394/fbc/cf6/394fbccf6628d64624578ec61db29dda.png"></div>  <i>T√©cnicas b√°sicas de caza de amenazas</i> <br><br>  Las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">t√©cnicas de</a> TH en orden de madurez de la tecnolog√≠a utilizada incluyen: b√∫squeda b√°sica, an√°lisis estad√≠stico, t√©cnicas de visualizaci√≥n, agregaciones simples, aprendizaje autom√°tico y m√©todos bayesianos. <br><br>  El m√©todo m√°s simple es una b√∫squeda b√°sica, que se utiliza para reducir el alcance de la investigaci√≥n mediante consultas espec√≠ficas.  El an√°lisis estad√≠stico se utiliza, por ejemplo, para construir una actividad t√≠pica de usuario o red en forma de modelo estad√≠stico.  Las t√©cnicas de visualizaci√≥n se utilizan para visualizar y simplificar el an√°lisis de datos en forma de gr√°ficos y tablas, lo que facilita mucho la captura de patrones en la muestra.  La t√©cnica de agregaci√≥n simple para campos clave se utiliza para optimizar la b√∫squeda y el an√°lisis.  Cuanto mayor sea el nivel de madurez en una organizaci√≥n mediante el proceso TH, m√°s relevante es el uso de algoritmos de aprendizaje autom√°tico.  Tambi√©n se usan ampliamente, incluso para filtrar spam, detectar tr√°fico malicioso y detectar actividades fraudulentas.  Un tipo m√°s avanzado de algoritmos de aprendizaje autom√°tico son los m√©todos bayesianos que permiten la clasificaci√≥n, la reducci√≥n del tama√±o de la muestra y el modelado tem√°tico. <br><br><h2>  Modelo Diamante y Estrategia TH </h2><br>  Sergio Caltagiron, Andrew Pendegast y Christopher Betz en su trabajo " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El modelo del diamante del an√°lisis de intrusiones</a> " mostr√≥ los principales componentes clave de cualquier actividad maliciosa y la conexi√≥n b√°sica entre ellos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/304/cde/02b/304cde02ba7997ff249797d93d2423f3.png"></div>  <i>Modelo de diamante para actividad maliciosa</i> <br><br>  De acuerdo con este modelo, existen 4 estrategias de caza de amenazas que se basan en componentes clave relevantes. <br><br>  1. Una estrategia orientada a la v√≠ctima.  Asumimos que la v√≠ctima tiene oponentes, y que entregar√°n "oportunidades" por correo electr√≥nico.  Estamos buscando datos enemigos en el correo.  Busque enlaces, archivos adjuntos, etc.  Estamos buscando la confirmaci√≥n de esta hip√≥tesis para un cierto per√≠odo (mes, dos semanas), si no se encuentra, entonces la hip√≥tesis no jug√≥. <br><br>  2. Estrategia orientada a la infraestructura.  Hay varias formas de usar esta estrategia.  Dependiendo del acceso y la visibilidad, algunos son m√°s f√°ciles que otros.  Por ejemplo, monitoreamos servidores de nombres de dominio conocidos por alojar dominios maliciosos.  O estamos llevando a cabo un proceso de seguimiento de todos los nuevos registros de nombres de dominio para un patr√≥n conocido utilizado por el adversario. <br><br>  3. Estrategia orientada a la oportunidad.  Adem√°s de la estrategia orientada a las v√≠ctimas utilizada por la mayor√≠a de los defensores de la red, existe una estrategia orientada a las oportunidades.  Es el segundo m√°s popular y se enfoca en detectar oportunidades del adversario, a saber, "malware" y la capacidad del adversario de usar herramientas leg√≠timas como psexec, powershell, certutil y otras. <br><br>  4. Estrategia orientada al oponente.  El enfoque orientado al enemigo se centra en el enemigo.  Esto incluye el uso de informaci√≥n abierta de fuentes p√∫blicas (OSINT), recopilaci√≥n de datos sobre el enemigo, sus t√©cnicas y m√©todos (TTP), an√°lisis de incidentes pasados, datos de inteligencia de amenazas, etc. <br><br><h2>  Fuentes de informaci√≥n e hip√≥tesis en TH </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/001/c47/173/001c47173ac8a4e5affead0e47869f1e.png"></div>  <i>Algunas fuentes de informaci√≥n para la caza de amenazas</i> <br><br>  Puede haber muchas fuentes de informaci√≥n.  El analista ideal deber√≠a poder extraer informaci√≥n de todo lo que est√° alrededor.  Las fuentes t√≠picas en casi cualquier infraestructura ser√°n datos de caracter√≠sticas de seguridad: DLP, SIEM, IDS / IPS, WAF / FW, EDR.  Adem√°s, los indicadores t√≠picos de informaci√≥n ser√°n todo tipo de indicadores de compromiso, servicios de inteligencia de amenazas, datos CERT y OSINT.  Adem√°s, puede usar informaci√≥n de la red oscura (por ejemplo, de repente hay una orden para hackear el buz√≥n del jefe de la organizaci√≥n, o el candidato para el puesto de ingeniero de red ha aparecido en su actividad), informaci√≥n recibida de Recursos Humanos (comentarios sobre el candidato de su trabajo anterior), informaci√≥n del servicio de seguridad ( por ejemplo, resultados de verificaci√≥n de contraparte). <br><br>  Pero antes de usar todas las fuentes disponibles, debe tener al menos una hip√≥tesis. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aea/d70/c0d/aead70c0d9eee2ac44caa2b1cc12f4e0.png"></div>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Fuente</a> <br><br>  Para probar las hip√≥tesis, primero deben presentarse.  Y para presentar muchas hip√≥tesis cualitativas, es necesario aplicar un enfoque sistem√°tico.  El proceso de generaci√≥n de hip√≥tesis se describe con m√°s detalle en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> ; es muy conveniente tomar este esquema como base para el proceso de hip√≥tesis. <br><br>  La principal fuente de hip√≥tesis ser√° la <b>matriz ATT &amp; CK</b> (T√°cticas adversas, t√©cnicas y conocimiento com√∫n).  De hecho, es una base de conocimiento y un modelo para evaluar el comportamiento de los atacantes que realizan sus actividades en los √∫ltimos pasos de un ataque, generalmente descritos utilizando el concepto de Cadena de asesinatos.  Es decir, en las etapas posteriores a que el intruso penetra en la red interna de la empresa o en un dispositivo m√≥vil.  Inicialmente, la base de conocimiento inclu√≠a una descripci√≥n de 121 t√°cticas y t√©cnicas utilizadas en el ataque, cada una de las cuales se describe en detalle en el formato Wiki.  Una variedad de an√°lisis de inteligencia de amenazas es muy adecuada como fuente para generar hip√≥tesis.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Destacan los resultados del an√°lisis de infraestructura y las pruebas de penetraci√≥n: estos son los datos m√°s valiosos que las hip√≥tesis de hierro nos pueden dar porque dependen de una infraestructura espec√≠fica con sus deficiencias espec√≠ficas. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Proceso de prueba de hip√≥tesis </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sergey Soldatov dio un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buen diagrama</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con una descripci√≥n detallada del proceso; ilustra el proceso de probar las hip√≥tesis TH en un solo sistema. </font><font style="vertical-align: inherit;">Indicar√© las etapas principales con una breve descripci√≥n.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/431/46f/6a3/43146f6a3d7066bfc614fea87086e95b.png"></div>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Fuente</a> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etapa 1: Granja TI</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En esta etapa, debe seleccionar </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objetos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (analiz√°ndolos junto con todos los datos de amenazas) y asignarles etiquetas de sus caracter√≠sticas. Este es un archivo, URL, MD5, proceso, utilidad, evento. Pasarlos por los sistemas de Inteligencia de amenazas debe ser etiquetado. Es decir, este sitio fue visto en CNC en tal y tal a√±o, este MD5 se asoci√≥ con tal y tal malware, este MD5 se descarg√≥ del sitio web que distribu√≠a los malvares. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etapa 2: Casos</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En la segunda etapa, observamos la interacci√≥n entre estos objetos e identificamos las relaciones entre todos estos objetos. Obtenemos sistemas etiquetados que hacen algo malo. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etapa 3: analista</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En la tercera etapa, el caso se transfiere a un analista experimentado que tiene una vasta experiencia en an√°lisis, y √©l dicta un veredicto. Analiza en bytes qu√©, d√≥nde, c√≥mo, por qu√© y por qu√© lo hace este c√≥digo. Este cuerpo era un malware, esta computadora estaba infectada. Revela conexiones entre objetos, verifica los resultados de una ejecuci√≥n a trav√©s del sandbox. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los resultados del trabajo del analista se transmiten. Digital Forensics examina las im√°genes, Malware Analysis examina los "cuerpos" encontrados, y el equipo de Respuesta a Incidentes puede ir al sitio y explorar algo que ya est√° all√≠. El resultado del trabajo ser√° una hip√≥tesis confirmada, un ataque identificado y formas de contrarrestarlo.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5d1/dd8/c93/5d1dd8c937bacb4805a67795317a0b49.png"></div>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Fuente</a> <br><br><h2>  Resumen </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Threat Hunting es una tecnolog√≠a bastante joven capaz de resistir eficazmente las amenazas personalizadas, nuevas y no est√°ndar, que tiene grandes perspectivas dado el creciente n√∫mero de tales amenazas y la complejidad de la infraestructura corporativa. Necesita tres componentes: datos, herramientas y an√°lisis. Los beneficios de Threat Hunting no se limitan a la implementaci√≥n proactiva de amenazas. No olvide que en el proceso de b√∫squeda nos sumergimos en nuestra infraestructura y sus debilidades a trav√©s de los ojos de un analista de seguridad y podemos fortalecer a√∫n m√°s estos lugares. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los primeros pasos que, en nuestra opini√≥n, deben tomarse para iniciar el proceso de TH en su organizaci√≥n.</font></font><br><br><ol><li>        .    (NetFlow)   (firewall, IDS, IPS, DLP)     .          . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MITRE ATT&amp;CK</a> . </li><li>        ,   ,         . </li><li>   Threat Intelligence     (, MISP, Yeti)       . </li><li>      (IRP): R-Vision IRP, The Hive,      (FortiSandbox, Cuckoo). </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatizar procesos rutinarios. </font><font style="vertical-align: inherit;">El an√°lisis de registros, la gesti√≥n de incidentes, la informaci√≥n del personal es un campo enorme para la automatizaci√≥n.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aprenda c√≥mo interactuar efectivamente con ingenieros, desarrolladores, soporte t√©cnico para colaborar en incidentes. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Documente todo el proceso, puntos clave, resultados logrados, para volver a ellos m√°s tarde o compartir estos datos con colegas; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Recuerde el aspecto social: tenga en cuenta lo que est√° sucediendo con sus empleados, a quienes contrata y que dan acceso a los recursos de informaci√≥n de la organizaci√≥n. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mant√©ngase al tanto de las tendencias en el campo de las nuevas amenazas y m√©todos de protecci√≥n, aumente su nivel de conocimiento t√©cnico (incluido el trabajo de los servicios y subsistemas de TI), asista a conferencias y comun√≠quese con colegas. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Listo para discutir la organizaci√≥n del proceso TH en los comentarios. </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O ven a nosotros a trabajar!</font></font></b> <div class="spoiler_text"><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consultor de seguridad l√≠der</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arquitecto de Sistemas de Seguridad de la Informaci√≥n</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ingeniero principal de seguridad de redes</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ingeniero principal de seguridad de la informaci√≥n (SIEM)</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arquitecto IS (Aplicado)</font></font></a> </li></ul></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fuentes y materiales para estudio.</font></font></b> <div class="spoiler_text"><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amenazahunter.guru</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ataque.mitre.org</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">digital-forensics.sans.org</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resources.infosecinstitute.com</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.redcanary.com</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.cybereason.com</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.anti-malware.ru</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.anti-malware.ru</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">responder a todos.blogspot.com</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lukatsky.blogspot.com</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">whitepapers.theregister.co.uk</font></font></a> </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/447580/">https://habr.com/ru/post/447580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447570/index.html">GoLand 2019.1: an√°lisis de rendimiento de c√≥digo, Smart Step Into, refactorizaci√≥n de interfaz de extracci√≥n, analizador de nilness y m√°s</a></li>
<li><a href="../447572/index.html">Energ√≠a, calor y agua: segunda parte</a></li>
<li><a href="../447574/index.html">Notas de Freelancer: Desarrollo de la primera aplicaci√≥n nativa de React</a></li>
<li><a href="../447576/index.html">Desarrollo responsable de JavaScript, parte 1</a></li>
<li><a href="../447578/index.html">Acelerar JavaScript usando Establecer tipo de datos</a></li>
<li><a href="../447582/index.html">Rusatom: impresi√≥n de metales en 3D en Rusia</a></li>
<li><a href="../447584/index.html">Anatom√≠a del "Centro de datos espaciales". Servidor alto: mira bajo el cap√≥</a></li>
<li><a href="../447586/index.html">Interpolaci√≥n avanzada de cadenas en Swift 5.0</a></li>
<li><a href="../447588/index.html">C√≥mo hacer que la aplicaci√≥n sea m√°s estable con 2 tipos de pruebas unitarias</a></li>
<li><a href="../447592/index.html">WhatsApp en la palma de tu mano: ¬ød√≥nde y c√≥mo puedes detectar artefactos forenses?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>