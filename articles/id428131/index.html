<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏴󠁧󠁢󠁥󠁮󠁧󠁿 🥂 🔜 Seluruh kebenaran tentang RTOS. Artikel # 17. Grup Bendera Acara: Pengantar dan Layanan Dasar 👨🏿 🛕 🖨️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kelompok bendera acara sudah disebutkan sebelumnya di salah satu artikel sebelumnya (# 5). Dalam Nucleus SE, mereka mirip dengan sinyal, tetapi lebih ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Seluruh kebenaran tentang RTOS. Artikel # 17. Grup Bendera Acara: Pengantar dan Layanan Dasar</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428131/"><img src="https://habrastorage.org/webt/y6/hx/yw/y6hxyww0r_cp5m_lr0uspctzgqk.jpeg"><br><br>  Kelompok bendera acara sudah disebutkan sebelumnya di salah satu artikel sebelumnya (# 5).  Dalam Nucleus SE, mereka mirip dengan sinyal, tetapi lebih fleksibel.  Mereka menyediakan cara yang murah dan fleksibel untuk mentransfer pesan sederhana antar tugas. <br><a name="habracut"></a><br><br>  Artikel sebelumnya dalam seri: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 16.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sinyal</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 15.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Partisi Memori: Layanan dan Struktur Data</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 14.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian memori: pengantar dan layanan dasar</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 13.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Struktur data tugas dan panggilan API yang tidak didukung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 12.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Layanan untuk bekerja dengan tugas</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 11.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tugas: konfigurasi dan pengantar API</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 10.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Penjadwal: fitur canggih dan pelestarian konteks</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 9.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Penjadwal: implementasi</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 8.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Nucleus SE: Desain dan Penyebaran Internal</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 7.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Nucleus SE: Pendahuluan</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 6.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Layanan RTOS lainnya</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 5.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Interaksi tugas dan sinkronisasi</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tugas, pengalihan konteks, dan interupsi</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tugas dan Perencanaan</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RTOS: Struktur dan mode waktu-nyata</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel # 1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RTOS: pengantar.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><br></a> <br><br><h2>  Menggunakan Bendera Acara </h2><br>  Dalam Nucleus SE, flag event didefinisikan selama fase build.  Jumlah maksimum grup bendera acara dalam aplikasi adalah 16. Jika grup bendera acara tidak ditentukan, maka kode yang terkait dengan struktur data dan panggilan layanan grup bendera acara tidak akan dimasukkan dalam aplikasi. <br><br>  Kelompok bendera acara - satu set bendera delapan bit, akses yang diatur sehingga beberapa tugas dapat menggunakan satu bendera dengan aman.  Satu tugas dapat mengatur atau menghapus kombinasi flag acara.  Tugas lain adalah membaca sekelompok bendera kapan saja, dan itu juga dapat menunggu urutan bendera tertentu (dengan polling atau dengan jeda). <br><br><h2>  Mengkonfigurasi grup bendera acara </h2><br><h3>  Jumlah grup bendera acara </h3><br>  Seperti kebanyakan objek Nucleus SE, konfigurasi grup flag event ditentukan oleh arahan <b>#define</b> di <b>nuse_config.h</b> .  Parameter utama adalah <b>NUSE_EVENT_GROUP_NUMBER</b> , yang menentukan berapa banyak kelompok bendera acara yang akan ditentukan dalam aplikasi.  Secara default, parameter ini diatur ke 0 (yaitu, grup acara bendera tidak digunakan) dan dapat memiliki nilai apa pun hingga 16. Nilai yang salah akan menyebabkan kesalahan kompilasi, yang akan dihasilkan dengan memeriksa <b>nuse_config_check.h</b> (diaktifkan oleh <b>nuse_config.c</b> , yang artinya dikompilasi dengan modul ini), sebagai hasilnya, arahan <b>#error</b> akan berfungsi.  Memilih nilai bukan nol berfungsi sebagai penggerak utama grup bendera acara.  Parameter ini digunakan ketika mendefinisikan struktur data dan ukurannya tergantung pada nilainya (lebih lanjut tentang ini dalam artikel berikut).  Selain itu, nilai bukan nol mengaktifkan pengaturan API. <br><br><h3>  Aktifkan Panggilan API </h3><br>  Setiap fungsi API (panggilan utilitas) di Nucleus SE diaktifkan oleh arahan <b>#define</b> di <b>nuse_config.h</b> .  Untuk grup bendera acara, ini termasuk: <br> <code>NUSE_EVENT_GROUP_SET <br> NUSE_EVENT_GROUP_RETRIEVE <br> NUSE_EVENT_GROUP_INFORMATION <br> NUSE_EVENT_GROUP_COUNT <br></code> <br>  Secara default, mereka diatur ke <b>FALSE</b> , sehingga menonaktifkan setiap panggilan layanan dan memblokir masuknya kode yang mengimplementasikannya.  Untuk mengonfigurasi grup bendera acara, Anda harus memilih panggilan API yang diperlukan dan mengatur arahan terkait ke <b>TRUE</b> . <br><br>  Berikut ini adalah kutipan dari file nuse_config.h default. <br><br><pre> <code class="hljs cpp"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NUSE_EVENT_GROUP_NUMBER 0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* Number of event groups in the system - 0-16 */</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NUSE_EVENT_GROUP_SET FALSE </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* Service call enabler */</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NUSE_EVENT_GROUP_RETRIEVE FALSE </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* Service call enabler */</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NUSE_EVENT_GROUP_INFORMATION FALSE </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* Service call enabler */</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NUSE_EVENT_GROUP_COUNT FALSE </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* Service call enabler */</span></span></span></span></code> </pre><br>  Fungsi API yang diaktifkan jika tidak ada grup bendera acara dalam aplikasi akan menyebabkan kesalahan kompilasi (kecuali untuk <b>NUSE_Event_Group_Count ()</b> , yang selalu diaktifkan).  Jika kode Anda menggunakan panggilan API yang belum diaktifkan, kesalahan tata letak akan terjadi karena kode implementasi tidak termasuk dalam aplikasi. <br><br><h2>  Panggilan Utilitas Panggilan Acara </h2><br>  Nucleus RTOS mendukung tujuh panggilan utilitas yang menyediakan fungsionalitas berikut: <br><br><ul><li>  Tetapkan bendera acara.  Nucleus SE diimplementasikan dalam fungsi <b>NUSE_Event_Group_Set ()</b> . </li><li>  Membaca bendera acara.  Di Nucleus SE, diterapkan di <b>NUSE_Event_Group_Retrieve ()</b> . </li><li>  Memberikan informasi tentang kelompok bendera acara tertentu.  Di Nucleus SE, diterapkan di <b>NUSE_Event_Group_Information ()</b> . </li><li>  Mengembalikan jumlah grup bendera acara yang saat ini dikonfigurasi dalam aplikasi.  Di Nucleus SE, diterapkan di <b>NUSE_Event_Group_Count ()</b> . </li><li>  Menambahkan grup baru bendera acara ke aplikasi.  Nucleus SE tidak diimplementasikan. </li><li>  Menghapus sekelompok bendera acara dari aplikasi.  Nucleus SE tidak diimplementasikan. </li><li>  Mengembalikan pointer ke semua grup bendera acara dalam aplikasi.  Nucleus SE tidak diimplementasikan. </li></ul><br>  Implementasi dari masing-masing panggilan overhead ini dibahas secara rinci di bawah ini. <br><br>  Perlu dicatat bahwa tidak ada fungsi reset di Nucleus RTOS atau Nucleus SE.  Ini dilakukan dengan sengaja.  Fungsi reset menyiratkan prevalensi status khusus dari bendera.  Untuk grup bendera acara, satu-satunya negara "khusus" adalah mengatur ulang semua bendera, yang dapat dilakukan menggunakan <b>NUSE_Event_Group_Set ()</b> . <br><br><h2>  Panggilan layanan untuk pengaturan dan membaca grup bendera acara </h2><br>  Operasi mendasar yang dapat dilakukan pada sekelompok bendera acara adalah menetapkan nilai satu atau lebih bendera, serta membaca nilai bendera saat ini.  Nucleus RTOS dan Nucleus SE menyediakan empat panggilan API dasar untuk operasi ini. <br><br>  Karena flag event adalah bit, mereka lebih baik divisualisasikan sebagai angka biner.  Karena standar C secara historis tidak mendukung representasi konstanta biner (hanya oktal dan heksadesimal), Nucleus SE memiliki file header yang bermanfaat <b>nuse_binary.h</b> yang berisi karakter <b>#define</b> seperti <b>b01010101</b> untuk semua 256 nilai 8-bit. <br><br><h3>  Tetapkan Bendera Acara </h3><br>  Panggilan utilitas Nucleus RTOS API untuk menandai sangat fleksibel dan memungkinkan Anda untuk mengatur dan menghapus nilai bendera menggunakan operasi <b>AND</b> dan <b>OR</b> .  Nucleus SE menyediakan fungsionalitas yang serupa, tetapi tugas jeda adalah opsional. <br><br>  <b><i>Panggilan untuk mengatur bendera di Nucleus RTOS</i></b> <br>  Prototipe panggilan layanan: <br><br>  <b>STATUS NU_Set_Events (NU_EVENT_GROUP * grup, event_flags TIDAK DITANDATANGANI, operasi OPTION);</b> <br><br>  Parameter: <br><br>  <b>grup</b> - pointer ke blok kontrol yang disediakan pengguna untuk sekelompok bendera acara; <br>  <b>event_flags</b> - nilai topeng bit dari grup bendera; <br>  <b>operasi</b> - <b>operasi yang</b> akan dilakukan, <b>NU_OR</b> (untuk mengatur bendera) atau <b>NU_AND</b> (untuk membersihkan bendera). <br><br>  Nilai pengembalian: <br><br>  <b>NU_SUCCESS</b> - panggilan berhasil diselesaikan; <br>  <b>NU_INVALID_GROUP</b> - penunjuk yang tidak valid ke sekelompok bendera acara; <br>  <b>NU_INVALID_OPERATION</b> - Operasi yang ditentukan berbeda dari <b>NU_OR</b> dan <b>NU_AND</b> . <br><br>  <b><i>Panggilan untuk mengatur bendera di Nucleus SE</i></b> <br>  Panggilan API ini mendukung fungsionalitas inti API Nucleus RTOS. <br><br>  Prototipe panggilan layanan: <br><br>  <b>STATUS NUSE_Event_Group_Set (NUSE_EVENT_GROUP grup, U8 event_flags, operasi OPTION);</b> <br><br>  Parameter: <br><br>  <b>grup</b> - indeks (ID) dari grup acara yang benderanya ditetapkan / dihapus; <br>  <b>event_flags</b> - nilai bit maxi dari sekelompok bendera; <br>  <b>operasi</b> - <b>operasi yang</b> akan dilakukan, <b>NUSE_OR</b> (untuk mengatur flags) atau <b>NUSE_AND</b> (untuk membersihkan flags). <br><br>  Nilai pengembalian: <br><br>  <b>NUSE_SUCCESS</b> - panggilan berhasil diselesaikan; <br>  <b>NUSE_INVALID_GROUP</b> - indeks sekelompok bendera acara tidak valid; <br>  <b>NUSE_INVALID_OPERATION</b> - Operasi yang ditentukan berbeda dari <b>NUSE_OR</b> dan <b>NUSE_AND</b> . <br><br>  <b><i>Melaksanakan pemasangan bendera acara di Nucleus SE</i></b> <br>  Kode awal fungsi API <b>NUSE_Event_Group_Set ()</b> bersifat umum (setelah memeriksa parameter), terlepas dari apakah API mendukung panggilan pemblokiran (menangguhkan tugas) atau tidak.  Logikanya cukup sederhana: <br><br><pre> <code class="hljs powershell">NUSE_CS_Enter(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation == NUSE_OR) { NUSE_Event_Group_Data[<span class="hljs-type"><span class="hljs-type">group</span></span>] |= event_flags; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> /* NUSE_AND */ { NUSE_Event_Group_Data[<span class="hljs-type"><span class="hljs-type">group</span></span>] &amp;= event_flags; }</code> </pre> <br>  <b>Bitmask event_flags</b> ditumpangkan (menggunakan operasi <b>AND</b> atau <b>OR</b> ) pada nilai grup flag acara yang dipilih. <br><br>  Kode yang tersisa diaktifkan hanya ketika penguncian tugas diaktifkan: <br><br><pre> <code class="hljs mel">#<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> NUSE_BLOCKING_ENABLE <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (NUSE_Event_Group_Blocking_Count[<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>] != <span class="hljs-number"><span class="hljs-number">0</span></span>) { U8 index; <span class="hljs-comment"><span class="hljs-comment">/* check whether any tasks are blocked */</span></span> <span class="hljs-comment"><span class="hljs-comment">/* on this event group */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (index=<span class="hljs-number"><span class="hljs-number">0</span></span>; index&lt;NUSE_TASK_NUMBER; index++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((LONIB(NUSE_Task_Status[index]) == NUSE_EVENT_SUSPEND) &amp;&amp; (HINIB(NUSE_Task_Status[index]) == <span class="hljs-keyword"><span class="hljs-keyword">group</span></span>)) { NUSE_Task_Blocking_Return[index] = NUSE_SUCCESS; NUSE_Task_Status[index] = NUSE_READY; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } NUSE_Event_Group_Blocking_Count[<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>]--; } #<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> NUSE_SCHEDULER_TYPE == NUSE_PRIORITY_SCHEDULER NUSE_Reschedule(NUSE_NO_TASK); #endif #endif NUSE_CS_Exit(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> NUSE_SUCCESS;</code> </pre> <br>  Jika ada tugas yang dijeda (untuk dibaca) dari kelompok bendera ini, mereka melanjutkan.  Ketika mereka memiliki kesempatan untuk melanjutkan eksekusi (itu tergantung pada penjadwal), mereka dapat menentukan apakah kondisi untuk dimulainya kembali mereka puas atau tidak (lihat membaca bendera acara). <br><br><h3>  Membaca bendera acara </h3><br>  Panggilan utilitas Nucleus RTOS API untuk membaca sangat fleksibel dan memungkinkan Anda untuk menjeda tugas tanpa batas waktu atau dengan batas waktu tertentu jika operasi tidak dapat segera dilakukan (misalnya, jika Anda mencoba membaca urutan tertentu dari peristiwa bendera yang tidak mewakili keadaan saat ini).  Nucleus SE menyediakan fitur yang sama, hanya jeda tugas yang opsional, dan batas waktu tidak diterapkan. <br><br>  <b><i>Bendera Tantangan di RTOS Inti</i></b> <br>  Prototipe panggilan layanan: <br><br>  <b>STATUS NU_Retrieve_Events (NU_EVENT_GROUP * grup, UNSIGNED asked_events, operasi OPTION, UNSIGNED * recoverved_events, suspend UNSIGNED);</b> <br><br>  Parameter: <br><br>  <b>grup</b> - pointer ke blok kontrol yang disediakan pengguna untuk sekelompok bendera acara; <br>  <b>asked_events</b> - topeng bit yang mendefinisikan flag untuk dibaca; <br>  <b>operasi</b> - empat <b>operasi</b> tersedia: <b>NU_AND</b> , <b>NU_AND_CONSUME</b> , <b>NU_OR</b> dan <b>NU_OR_CONSUME</b> .  Operasi <b>NU_AND</b> dan <b>NU_AND_CONSUME</b> menunjukkan bahwa semua bendera yang diminta diperlukan.  Operasi <b>NU_OR</b> dan <b>NU_OR_CONSUME</b> menunjukkan bahwa satu atau beberapa flag yang diminta sudah cukup.  Parameter <b>CONSUME</b> secara otomatis menghapus flag yang ada setelah permintaan berhasil; <br>  <b>recoverved_events</b> - pointer penyimpanan untuk nilai-nilai flag acara baca; <br>  <b>menangguhkan</b> - spesifikasi untuk menjeda tugas;  dapat mengambil nilai <b>NU_NO_SUSPEND</b> atau <b>NU_SUSPEND</b> , atau nilai batas waktu dalam clock <b>ticks</b> (dari 1 hingga 4.294.967.293). <br><br>  Nilai pengembalian: <br><br>  <b>NU_SUCCESS</b> - panggilan berhasil diselesaikan; <br>  <b>NU_NOT_PRESENT</b> - operasi yang ditentukan tidak mengembalikan peristiwa (bukan peristiwa tunggal dalam kasus NU_OR dan tidak semua peristiwa dalam kasus NU_AND); <br>  <b>NU_INVALID_GROUP</b> - penunjuk yang tidak valid ke sekelompok bendera acara; <br>  <b>NU_INVALID_OPERATION</b> - operasi yang ditentukan salah; <br>  <b>NU_INVALID_POINTER</b> - null pointer ke penyimpanan flag acara (NULL); <br>  <b>NU_INVALID_SUSPEND</b> - upaya untuk menjeda dari utas yang tidak terkait tugas; <br>  <b>NU_TIMEOUT</b> - kombinasi flag acara yang diperlukan tidak disetel bahkan setelah batas waktu yang ditentukan; <br>  <b>NU_GROUP_DELETED</b> - grup bendera acara dihapus saat tugas ditangguhkan. <br><br>  <b><i>Bendera Tantangan di Nucleus SE</i></b> <br>  Panggilan API ini mendukung fungsionalitas inti API Nucleus RTOS. <br><br>  Prototipe panggilan layanan: <br><br>  <b>STATUS NUSE_Event_Group_Retrieve (grup NUSE_EVENT_GROUP, U8 Request_events, operasi OPTION, U8 * recoverved_events, U8 menangguhkan);</b> <br><br>  Parameter: <br><br>  <b>grup</b> - indeks (ID) dari grup yang dibaca dari bendera acara; <br>  <b>asked_events</b> - topeng bit yang mendefinisikan flag untuk dibaca; <br>  <b>operasi</b> - spesifikasi yang menunjukkan jumlah bendera yang diperlukan: <b>NUSE OR</b> (beberapa flag) atau <b>NUSE AND</b> (semua flag); <br>  <b>recoverved_events</b> - pointer ke store untuk nilai aktual dari flag event baca (dengan operasi <b>NUSE_AND,</b> ini akan sama seperti yang dilewatkan dalam parameter yang <b>diminta_events</b> ); <br>  <b>menangguhkan</b> - spesifikasi untuk menjeda tugas, dapat mengambil nilai <b>NUSE_NO_SUSPEND</b> atau <b>NUSE_SUSPEND</b> . <br><br>  Nilai pengembalian: <br><br>  <b>NUSE_SUCCESS</b> - panggilan berhasil diselesaikan; <br>  <b>NUSE_NOT_PRESENT</b> - operasi yang ditentukan tidak mengembalikan peristiwa (tidak satu peristiwa dalam kasus <b>NUSE_OR</b> dan tidak semua peristiwa dalam kasus <b>NUSE_AND</b> ); <br>  <b>NUSE_INVALID_GROUP</b> - indeks sekelompok bendera acara tidak valid; <br>  <b>NUSE_INVALID_OPERATION</b> - operasi yang ditentukan berbeda dari <b>NUSE_OR</b> atau <b>NUSE_AND</b> ; <br>  <b>NUSE_INVALID_POINTER</b> - pointer nol ke penyimpanan flag acara baca ( <b>NULL</b> ); <br>  <b>NUSE_INVALID_SUSPEND</b> - upaya untuk menjeda dari aliran non-tugas atau ketika dukungan untuk memblokir panggilan API dinonaktifkan. <br><br>  <b><i>Menerapkan pembacaan bendera acara di Nucleus SE</i></b> <br>  Versi kode fungsi API <b>NUSE_Event_Group_Retrieve ()</b> (setelah memeriksa parameter) dipilih selama kompilasi bersyarat tergantung pada apakah dukungan untuk panggilan API untuk memblokir (menangguhkan) tugas diaktifkan atau tidak.  Mari kita pertimbangkan dua opsi ini secara terpisah. <br><br>  Jika kunci dinonaktifkan, kode lengkap untuk panggilan API ini akan terlihat seperti ini: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">temp_events</span></span> = NUSE_Event_Group_Data[group] &amp; requested_events; <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (operation == NUSE_OR) { <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (temp_events != <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">return_value</span></span> = NUSE_SUCCESS; } <span class="hljs-section"><span class="hljs-section">else</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">return_value</span></span> = NUSE_NOT_PRESENT; } } <span class="hljs-attribute"><span class="hljs-attribute">else</span></span> /* operation == NUSE_AND */ { <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (temp_events == requested_events) { <span class="hljs-attribute"><span class="hljs-attribute">return_value</span></span> = NUSE_SUCCESS; } <span class="hljs-section"><span class="hljs-section">else</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">return_value</span></span> = NUSE_NOT_PRESENT; } }</code> </pre><br>  Bendera acara yang diperlukan dipilih dari grup bendera acara yang ditentukan.  Nilai tersebut dibandingkan dengan peristiwa yang diperlukan, dengan mempertimbangkan operasi <b>AND / OR</b> , serta hasil yang dikembalikan dan nilai langsung dari bendera yang diminta. <br><br>  Jika penguncian tugas diaktifkan, kode menjadi lebih kompleks: <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { temp_events = NUSE_Event_Group_Data[group] &amp; requested_events; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (operation == NUSE_OR) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp_events != <span class="hljs-number"><span class="hljs-number">0</span></span>) { return_value = NUSE_SUCCESS; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { return_value = NUSE_NOT_PRESENT; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-comment"><span class="hljs-comment">/* operation == NUSE_AND */</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp_events == requested_events) { return_value = NUSE_SUCCESS; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { return_value = NUSE_NOT_PRESENT; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (return_value == NUSE_SUCCESS) { <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> = NUSE_NO_SUSPEND; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> == NUSE_SUSPEND) <span class="hljs-comment"><span class="hljs-comment">/* block task */</span></span> { NUSE_Event_Group_Blocking_Count[group]++; NUSE_Suspend_Task(NUSE_Task_Active, (group &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) | NUSE_EVENT_SUSPEND); return_value = NUSE_Task_Blocking_Return[NUSE_Task_Active]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (return_value != NUSE_SUCCESS) { <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> = NUSE_NO_SUSPEND; } } } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> == NUSE_SUSPEND);</code> </pre><br>  Kode ditempatkan dalam <b>loop do ... while</b> , yang berfungsi saat parameter <b>menangguhkan</b> adalah <b>NUSE_SUSPEND</b> . <br><br>  Bendera acara yang diminta dibaca seolah-olah dipanggil tanpa diblokir.  Jika pembacaan tidak <b>berhasil</b> dan parameter <b>penangguhan</b> adalah <b>NUSE_NO_SUSPEND</b> , panggilan API diatur ke <b>NUSE_NOT_PRESENT</b> .  Jika parameter <b>penangguhan</b> ditetapkan ke <b>NUSE_SUSPEND</b> , tugas akan dijeda.  Saat kembali (ketika tugas dilanjutkan), jika nilai kembali adalah <b>NUSE_SUCCESS</b> , yang menunjukkan bahwa tugas dilanjutkan karena bendera acara dalam grup ini disetel atau dihapus, siklus dimulai dari awal, bendera dibaca dan diperiksa.  Karena tidak ada fungsi API untuk mengatur ulang grup bendera acara, ini adalah satu-satunya alasan tugas dilanjutkan, tetapi proses <b>pemeriksaan NUSE_Task_Blocking_Return []</b> telah ditinggalkan pada sistem untuk kompatibilitas kontrol penguncian dengan jenis objek lainnya. <br><br>  Artikel berikut akan menjelaskan panggilan API tambahan yang terkait dengan grup bendera acara, serta struktur datanya. <br><br>  <b>Tentang Pengarang:</b> Colin Walls telah bekerja di industri elektronik selama lebih dari tiga puluh tahun, mencurahkan sebagian besar waktunya untuk firmware.  Dia sekarang seorang insinyur firmware di Mentor Embedded (sebuah divisi dari Mentor Graphics).  Colin Walls sering berbicara di konferensi dan seminar, penulis berbagai artikel teknis dan dua buku tentang firmware.  Tinggal di Inggris.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Blog</a> profesional <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Colin</a> , email: colin_walls@mentor.com. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id428131/">https://habr.com/ru/post/id428131/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id428121/index.html">Stan Drapkin. Perangkap Kriptografi Tingkat Tinggi di .NET</a></li>
<li><a href="../id428123/index.html">Minggu Keamanan 41: Kabar Baik</a></li>
<li><a href="../id428125/index.html">Siapa analitik produk dan mengapa mereka diperlukan dalam sebuah tim?</a></li>
<li><a href="../id428127/index.html">Cache nginx: semuanya baru - lama terlupakan</a></li>
<li><a href="../id428129/index.html">Logika fuzzy sederhana saling menempel “dari apa dulu” untuk mesin turbin gas</a></li>
<li><a href="../id428133/index.html">Hasura. GraphQL Kinerja Tinggi untuk Arsitektur SQL Server</a></li>
<li><a href="../id428135/index.html">Cara mengkonfigurasi atau menonaktifkan linting di editor kode bawaan</a></li>
<li><a href="../id428137/index.html">Olimpiade, kontes ide, ceramah tentang manajemen proyek TI dan pemutaran film: 10 acara mendatang di ITMO University</a></li>
<li><a href="../id428141/index.html">Backend untuk frontend, atau How Yandex.Market membuat API tanpa kruk</a></li>
<li><a href="../id428143/index.html">Pendekatan Implementasi ReactJS RBAC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>