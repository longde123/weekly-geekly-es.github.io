<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🎨 👨🏿‍🤝‍👨🏾 🧖🏿 DEFCON-Konferenz 27. Profitieren Sie von Hacker-Produkten für macOS. Teil 2 👂 🚣 👨🏼‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="DEFCON-Konferenz 27. Von Hacker-Produkten für macOS profitieren. Teil 1 

 Nachdem der Exploit eine Datei mit schädlichem Code von einem Remote-Hacker...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DEFCON-Konferenz 27. Profitieren Sie von Hacker-Produkten für macOS. Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/474590/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DEFCON-Konferenz 27. Von Hacker-Produkten für macOS profitieren.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> <br><br>  Nachdem der Exploit eine Datei mit schädlichem Code von einem Remote-Hacker-C &amp; C-Server erhalten hat, wird er ausgeführt.  Es wird dieselbe SDF-Methode verwendet, wenn das Malware-Archiv mit dem integrierten Befehl ditto entpackt und dann über die NS-API ausgeführt wird.  Daher verwendet Windtall einen integrierten Standard-Bootloader. <br><br><img src="https://habrastorage.org/webt/s5/ah/23/s5ah23zhuchevz5cvkvhqsnpqcs.jpeg"><br><br>  Darüber hinaus ist die Backdoor mit einer Selbstliquidationslogik ausgestattet. Bei jedem Start der Malware wird der Hacker-Server kontaktiert und gefragt, ob sie deinstalliert werden soll.  Wenn der C &amp; C-Server mit dem Code „1“ antwortet, löscht sich das Programm selbst und stoppt dadurch die Spyware-Aktivität. <a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/hb/b0/nv/hbb0nv9sjwt182m_llrlfnucgxm.jpeg"><br><br>  Dies ist eine sehr nützliche Funktion, mit der ein Angreifer ein Ziel aus der Ferne "desinfizieren" kann, ohne Spuren seiner Intervention zu hinterlassen.  Jetzt werde ich zeigen, wie wir diesen Virus für unsere eigenen Bedürfnisse umgestalten. <br><br><img src="https://habrastorage.org/webt/yr/zs/vb/yrzsvbpwib8b9jenyer3zks92ki.jpeg"><br><br>  Lassen Sie uns zunächst über das Tadeln eines Exploits sprechen.  Das Erstellen einer Hacker-Webseite, die automatisch eine ZIP-Datei mit einer schädlichen Anwendung herunterlädt, ist ganz einfach.  Wie bereits erwähnt, entpackt Safari ZIP-Archive standardmäßig automatisch. Wenn wir also eine schädliche Anwendung in diesem Archiv ablegen, die einige URL-Handler implementiert, registriert Mac OS diese automatisch, bevor der Benutzer die Anwendung startet. <br><br>  Eine böswillige Webseite kann dann diese bereits registrierte Benutzer-URL anfordern, was zum Start der Anwendung führt.  Normalerweise wird ein Warnfenster angezeigt, aber der Benutzer klickt auf die Schaltfläche, ohne darauf zu achten. <br><br>  Sie sehen also eine Demonstration des neu gestalteten Exploits und ein Warnfenster, dass „Final_Presentation“ eine aus dem Internet heruntergeladene Anwendung ist, in der Sie gefragt werden, ob der Benutzer sicher ist, dass er sie auf dem Computer öffnen möchte. <br><br>  Das Klicken auf die Schaltfläche „Öffnen“ ist die zweite Anforderung, die ein Popup-Fenster verursacht. Wenn der Benutzer auf das darin angezeigte Anwendungssymbol klickt, wird festgestellt, dass die Malware automatisch auf dem System installiert wurde. <br><br><img src="https://habrastorage.org/webt/da/cz/w0/daczw0yu3d4vlyaa2ma79fx5tq8.jpeg"><br><br>  Es gibt einen logischen Fehler in Apple, bei dem Sie das Betriebssystem nicht patchen müssen, um das System zu infizieren, und dies funktioniert immer noch in der neuesten Version von macOS.  Nachdem wir den Exploit neu erstellt haben, sprechen wir über das Remake von Malware. <br><br><img src="https://habrastorage.org/webt/k8/q2/wh/k8q2whc8srob_t065-xvvldbgy4.jpeg"><br><br>  Unser erster Schritt besteht darin, die integrierte Adresse des C &amp; C-Servers zu ersetzen, damit der Exploit unseren Server kontaktiert und die konvertierte Malware von diesem herunterlädt.  Leider wurde die Adresse verschlüsselt, was uns aber nicht störte.  Wir haben uns dafür entschieden, dass Malware immer die dynamische Bibliothek lädt.  Sobald unsere Bibliothek im Adressraum des Schadprozesses gestartet wurde, konnten wir die Malware im Prinzip so ändern, dass sie die entschlüsselten Adressen des C &amp; C-Servers während des Betriebs abfängt, noch bevor dieser Server für die Verbindung verwendet wird.  Schauen wir uns diesen Prozess genauer an. <br><br>  Ich möchte Sie noch einmal daran erinnern. Unser Ziel war es, Malware neu zu profilieren, indem Sie unseren eigenen C &amp; C-Server angeben, damit die Malware wieder eine Verbindung zu unserer Infrastruktur herstellen kann. <br><br><img src="https://habrastorage.org/webt/3h/qj/33/3hqj33qe_pjauk4ynkd_bgpy8q0.jpeg"><br><br>  Daher wurde die dynamische Bibliothek in den Malware-Adressraum geladen, und wir haben das Entschlüsselungsverfahren ersetzt oder Swizzle angewendet.  Diese effiziente und leistungsstarke API-Ersetzungsmethode heißt Yoop. <br><br>  Die Folie zeigt, dass wir die Entschlüsselungsfunktion so ersetzt haben, dass sie immer dann, wenn die Malware sie aufruft, unsere Entschlüsselungsmethode in unserer Bibliothek aufruft.  Ich habe keine Ahnung, was der Entschlüsselungsalgorithmus ist und wie er funktioniert, und ehrlich gesagt ist mir das egal, aber nach der Ersetzung kann ich das Ergebnis dieser Verschlüsselung sehen.  Wenn die ursprüngliche Verschlüsselungsmethode die entschlüsselten C &amp; C-Serveradressen an mich zurückgibt, kann ich einfach meinen eigenen C &amp; C-Server in die Malware-Logik einbetten.  Dadurch können wir den entschlüsselten C &amp; C-Server transparent durch unseren Server ersetzen. <br><br>  Jetzt füge ich der Bibliothek einige Debugging-Meldungen hinzu, damit wir beim Ausführen der konvertierten Malware sehen können, wie die C &amp; C-Serveradressen während der Ausführung ersetzt werden.  Im Befehlszeilenterminalfenster können Sie sehen, wie unsere Bibliothek, die die ursprüngliche Entschlüsselungsmethode durchläuft, erkennt, dass diese Antwort vom C &amp; C-Server stammt, dessen Adresse jetzt entschlüsselt ist. <br><br><img src="https://habrastorage.org/webt/jy/vq/pp/jyvqppeptj5tsynsrub5ao7qzb8.jpeg"><br><br>  Da unser Programm nicht auf die Logik der ursprünglichen Malware verweisen soll, verwerfen wir diese Funktion einfach und kehren zu unserem eigenen Programm zurück.  Natürlich müssen wir immer sicher sein, dass die Backdoor auf unseren C &amp; C-Server zugreift und nicht auf den Server der ursprünglichen APT-Gruppe. <br><br>  Wir mussten unseren C &amp; C-Server schreiben, da jetzt Malware eine Verbindung zu ihm herstellt und wir eine „Konversation“ mit dem Protokoll bereitstellen müssen, um Malware korrekt zu verwirren. <br><br><img src="https://habrastorage.org/webt/9a/dg/uj/9adgujslps8-egi02h548dxeplo.jpeg"><br><br>  Die Hauptfunktion der Windtall-Backdoor ist das Sammeln und Extrahieren von Benutzerdateien. Daher mussten wir diese Funktion zunächst unserem C &amp; C-Server hinzufügen.  Dateien werden über eine POST-Anfrage abgerufen, daher haben wir nur ein paar Zeilen Python-Code geschrieben, damit wir die vom infizierten Host abgerufenen und an uns gesendeten Dateien speichern können. <br><br>  Sie sehen auf dem Bildschirm, wie unser C &amp; C-Server Dateien empfängt, die vom angegriffenen Computer extrahiert wurden. <br><br><img src="https://habrastorage.org/webt/5z/tu/ey/5ztueycxug4uq7-8_mvofucvowe.jpeg"><br><br>  Links sehen Sie, wie Netzwerkanforderungen eingehen und rechts, wie unser Server sie in das Dateisystem schreibt.  Dies bedeutet, dass wir jetzt die Fähigkeit von Malware unterstützen, Dateien aller Art von einem infizierten Host zu extrahieren. <br><br>  Wir haben unseren C &amp; C-Server auch angepasst, um die Download- und Ausführungsfunktionen von Windtall zu unterstützen.  Wir haben festgestellt, dass für diese Malware 2 Anfragen ausgeführt werden. <br><br><img src="https://habrastorage.org/webt/ap/y3/6h/apy36hocalariebs3edovjvgfas.jpeg"><br><br>  Die erste Anforderung betrifft das Abrufen des Dateinamens zum Herunterladen, und die zweite Anforderung muss mit bestimmten Bytes der Datei beantwortet werden, die heruntergeladen werden soll.  Malware speichert all dies in der von uns angegebenen Datei, entpackt sie dann und führt sie aus.  Ich wiederhole es noch einmal - es hat nur ein paar Zeilen in Python gekostet, es ist einfach, da es viele eingebaute Bibliotheken verwendet. <br><br>  Sobald wir dies getan hatten, hatten wir die Gelegenheit, das Implantat zu "rätseln".  Schauen wir es uns in Aktion an.  Wir sehen, wie Malware eine Verbindung zu unserem C &amp; C-Server herstellt, da wir die Adresse des ursprünglichen Servers erfolgreich geändert haben und die ihm übertragene Aufgabe ausführen - die Rechneranwendung wird heruntergeladen. <br><br><img src="https://habrastorage.org/webt/gg/au/3d/ggau3dqd27ai3u5dk115bylndnw.jpeg"><br><br>  Durch das Remote-Herunterladen und Ausführen von Anwendungen können wir andere Tools oder andere Malware-Beispiele auf dem Computer des Benutzers installieren.  Dies erweitert das Potenzial für die Verwendung von wiederverwendeter Hacker-Software unendlich. <br><br>  Lassen Sie uns abschließend unserem Server die Möglichkeit geben, Malware aus der Ferne zu entfernen.  Die Selbstzerstörungsfunktion ist sehr nützlich, wenn die Leute vom FBI in Ihre Tür einbrechen.  Ein Klick auf den Schlüssel - und der Virus selbst entfernt sich von allen infizierten Systemen. <br><br><img src="https://habrastorage.org/webt/yp/ru/dy/yprudyqitu1zcbxqi3ahyfvsixs.jpeg"><br><br>  Spyware kontaktiert uns regelmäßig mit einer Anfrage, ob es notwendig ist, sich selbst zu löschen, und falls erforderlich, antworten wir einfach mit dem Code "1", wonach es vollständig vom System deinstalliert wird. <br><br>  Eine weitere Demo wird dies in Aktion zeigen.  Sie können sehen, dass unsere Malware ein eigenes orangefarbenes Logo hat, das ein Power Point-Dokument imitiert. In Wirklichkeit handelt es sich jedoch um ein verstecktes Systemverzeichnis. <br><br><img src="https://habrastorage.org/webt/ar/pd/ak/arpdakjxkom1af3v9jxmttspha0.jpeg"><br><br>  Nachdem es erneut eine Zerstörungsanforderung an den C &amp; C-Server gesendet hatte und wir in einem geantwortet hatten, verschwand das orangefarbene Symbol aus dem Programmverzeichnis, und die Anwendung selbst hörte auf, mit uns zu „sprechen“, weil sie Selbstzerstörung durchführte. <br><br><img src="https://habrastorage.org/webt/p5/6u/ln/p56ulnb7cf18kh9qd_hmudrhuse.jpeg"><br><br>  Wir haben also gezeigt, wie einige Malware-Beispiele für macOS neu abgelegt werden, und wollen nun erläutern, wie Sie unerkannt bleiben.  Da wir bekannte Schadprogramme, die durch den integrierten Schutz von macOS und Antivirensoftware von Drittanbietern erkannt und blockiert werden, erneut ausführen, müssen wir dieses Problem irgendwie lösen. <br><br><h3>  Wie man nicht erkannt wird </h3><br>  Lassen Sie uns zunächst über in macOS integrierte Virenerkennungs- und -steuerungsprogramme wie XProtect, das Tool zum Entfernen von MRT-Viren und die Überprüfung des Zertifikatsperrens sprechen. <br><br><img src="https://habrastorage.org/webt/ky/_a/di/ky_adibiddjzdqx6zhbhmlfxnb4.jpeg"><br><br>  Auf den ersten Blick sieht dies problematisch aus, da diese Programme unsere konvertierte Spyware auf jedem Mac blockieren können.  Daher müssen Sie darüber nachdenken, wie Sie den Schutz umgehen können. Wenn wir von unserer sorgfältig überarbeiteten Malware überrascht werden und Apple sie blockiert, ist dies ein vollständiger Fehler. <br><br>  Schauen wir uns zuerst XProtect an.  Dies ist ein einfacher Antivirenscanner, der auf Virensignaturdatenbanken basiert und in die neuesten Versionen von macOS integriert ist. <br><br><img src="https://habrastorage.org/webt/io/_h/gy/io_hgyg0wdmy6rt34vr_gdlui1a.jpeg"><br><br>  Es scannt die Dateien, die der Benutzer vor dem ersten Start auf den Computer heruntergeladen hat, und richtet sich dabei nach den Regeln der Virenerkennung.  Auf dem Bildschirm sehen wir einen Scan der Signatur des Virus OSX.KeRanger.A, dessen Reprofilierung wir gerade untersucht haben. <br><br>  Wir haben ein einfaches Dienstprogramm namens UXProtect geschrieben, mit dem Sie diese Signaturen über die Benutzeroberfläche der Benutzeroberfläche untersuchen und Dateien jederzeit auf Virensignaturen scannen können.  Da XProtect nur die Signaturerkennungs-Engine verwendet, ist es extrem einfach, sich fortzubewegen.  Schauen wir uns die Signatur des KeRanger-Virus genauer an. <br><br><img src="https://habrastorage.org/webt/sw/5h/mw/sw5hmwzwllc0p3bkn3pyd6r1dsy.jpeg"><br><br>  Wir sehen einen Hinweis auf eine Gruppe von Malware-Signaturen, die Sie nur neu anordnen oder ändern müssen, um diese Anweisungen zu umgehen.  Wenn Sie einige Bytes eines Befehls ändern, stimmt die Signatur nicht mehr mit den Erkennungsparametern überein.  Zum Beispiel haben wir die Anzahl der aus dem Puffer zu lesenden Bytes von 0x400 auf 0x300 geändert.  Dies hatte keine Auswirkungen auf die Funktionalität des Virus. Sobald wir jedoch die Anzahl der Bytes geändert haben, die der Scanner auf Übereinstimmung mit der Signatur überprüft, haben wir die Möglichkeit, dass XProtect auf diese Bedrohung reagiert, vollständig ausgeschlossen. <br><br>  Es ist Zeit für eine weitere Demonstration, bei der Sie zwei Beispiele für KeRanger sehen.  Wir verwenden wieder den infizierten BitTorrent-Client.  Links auf dem Bildschirm befindet sich die Original-Hackerkopie des Virus, und rechts die umfunktionierte Version, die zur Erlangung des Verschlüsselungsschlüssels mit unserem C &amp; C-Server kommuniziert.  Darüber hinaus wurde es geändert, um den XProtect-Schutz zu umgehen. <br><br><img src="https://habrastorage.org/webt/ag/mw/gs/agmwgscqk2ajoq1ef2shu2lm9yq.jpeg"><br><br>  Sie sehen, dass eine Instanz des ursprünglichen Virus vom System blockiert wird, ohne dass die Möglichkeit zum Starten besteht, und der einzige damit zulässige Vorgang ist das Löschen. <br><br><img src="https://habrastorage.org/webt/kv/mb/y4/kvmby4yeqnevt_msi9viidiyhxg.jpeg"><br><br>  Wenn wir eine überarbeitete KeRanger-Version starten, meldet das System einfach, dass sie aus dem Internet heruntergeladen wurde, und fragt, ob wir sie wirklich starten möchten. <br><br><img src="https://habrastorage.org/webt/va/wn/4j/vawn4ja6artoxgxuure3xnzutt8.jpeg"><br><br>  Wenn wir auf "Öffnen" klicken, wird die Ransomware leise im System installiert und beginnt sofort mit der Verschlüsselung aller Benutzerdateien. <br><br><img src="https://habrastorage.org/webt/oo/uj/ex/ooujexbhzffuj8wg6klvihde_gg.jpeg"><br><br>  Die nächste Möglichkeit, Ihren Mac zu schützen, besteht darin, die Zertifikatsignaturen zu überprüfen.  Die meisten signierten macOS-Binärdateien werden von der GateKeeper-Sicherheitsfunktion nicht blockiert. Daher stellen Hacker Signaturen für die meisten modernen Mac-Malware-Programme bereit.  Wenn ein signierter Virus erkannt wird, widerruft Apple das Signaturzertifikat.  Dies bedeutet, dass diese Malware auf keinem Mac ausgeführt werden kann. <br><br>  Zum Beispiel haben wir eine Windtall-Virus-Binärdatei, deren Signaturzertifikat von Apple widerrufen wurde.  Dies bedeutet, dass wir selbst dann nicht starten können, wenn wir das neue System neu profilieren und auf es anwenden.  Aus diesem Grund versuchen wir lediglich, das Zertifikatssperrverfahren zu umgehen, indem wir das Signaturzertifikat selbst löschen. <br><br><img src="https://habrastorage.org/webt/0f/9g/dy/0f9gdymdaskct9prhp2exlstml4.jpeg"><br><br>  Dann verwenden wir eine nicht signierte Kopie der konvertierten Malware oder stellen ihr ein anderes Zertifikat für die rechtliche Signatur zur Verfügung, das recht einfach zu erhalten ist. <br><br>  Um das Zertifikat tatsächlich zu entfernen, bietet Apple selbst ein Dienstprogramm namens Code Sign an, das das undokumentierte Flag zum Entfernen der Signatur oder "Signatur entfernen" enthält.  Wenn Sie diesen Vorgang mit Ihrer Malware ausführen, beachtet Apple das widerrufene Signaturzertifikat einfach nicht. <br><br>  Wir können unsere Anwendung auch mit demselben Dienstprogramm mithilfe des Codesigns -s "Developer ID Applikation:" erneut signieren.  Dadurch wird das neu signierte Windtall nicht mehr von macOS blockiert. <br><br>  Schließlich gehen wir zu MRT über, dem integrierten Tool zum Entfernen von Viren, das in den neuesten Versionen des Mac-Betriebssystems verfügbar ist.  Es ähnelt XProtect, scannt jedoch bereits auf dem System installierte Malware und erkennt sie bei Erkennung automatisch.  Im Gegensatz zu XProtect sind seine Signaturen in eine eigene Binärdatei eingebettet.  Apple verwendet dieses Tool häufig, um legitime Anwendungen zu entfernen, die für Ihren Computer als unsicher eingestuft werden.  Dies sind normalerweise Anwendungen mit bekannten Schwachstellen. <br><br><img src="https://habrastorage.org/webt/tq/za/iu/tqzaiuk9rktufxpfwcf8ozwwoae.jpeg"><br><br>  Da MRT wie XProtect mit Signaturen arbeitet, kann es auch umgangen werden.  Wir haben wieder den MRT-Speicherauszug verwendet, da die Signaturen in die Binärdatei selbst integriert sind und sie alle anzeigen konnten, einschließlich der Signatur des Fruitfly-Virus.  Wir fragten uns, ob MRT unsere konvertierte Kopie dieser Malware erkennen könnte. <br><br><img src="https://habrastorage.org/webt/eg/wa/te/egwatesmsl0ez1ccvzlhw_s0-2y.jpeg"><br><br>  Wir begannen mit der Untersuchung der in Fruitfly integrierten Signatur und stellten fest, dass die Erkennung auf zwei Dingen basiert: dem Installationspfad des Virus und der heruntergeladenen .plist-Datei.  Dies bedeutet, dass MRT den Pfad oder Namen von Malware nicht erkennen kann, wenn wir ihn ändern.  Wie ich bereits sagte, erwies es sich als recht einfach, diesen Schutz zu umgehen. <br><br>  Wir haben festgestellt, dass es auch nicht schwierig ist, sich mit Antivirensoftware von Drittanbietern zu befassen, da Sie einen konvertierten Virus auch auf einem System ausführen können, auf dem der Benutzer bereits Antivirenprogramme installiert hat. <br><br><img src="https://habrastorage.org/webt/bm/8o/k0/bm8ok05gky6s453v91lxix-mh2s.jpeg"><br><br>  Es wurde viel über dieses Thema gesprochen, ich möchte nicht auf Details eingehen, aber im Allgemeinen basieren herkömmliche Antivirenprodukte auf der Signaturüberprüfung, wie z. B. Apple Antivirensoftware, was bedeutet, dass sie mit denselben Methoden umgangen werden können. <br><br>  Als Beispiel habe ich die gleiche Fruitfly genommen, daran erinnert, dass es sich auch um ein Perl-Skript handelt, und es durch das kostenlose Online-Hilfsprogramm Perl Obfuscator geleitet, mit dem das Perl-Skript schwer lesbar gemacht und die Erkennungswahrscheinlichkeit auf Null reduziert wurde.  Natürlich hat es funktioniert.  Sie können jedoch genialer vorgehen, insbesondere wenn Sie binärbasierte Malware verwenden.  Sie können es in ein Archiv packen, einen Verschlüsseler oder sogar eine speicherinterne Ausführung verwenden, dh dateifreien Download und Virenausführung im RAM. <br><br>  Vor einigen Jahren wurden diese Technologien auf der BlackHat-Konferenz diskutiert und es wurde der Schluss gezogen, dass ein Mac-Benutzer, selbst wenn er Antivirensoftware von Drittanbietern auf dem System installiert hat, neu programmierte Malware immer noch nicht erkennen konnte.  Dies ist eine schlechte Nachricht für MacOS-Benutzer, da wir wissen, dass erfahrene Hacker konvertierte Malware verwenden.  Oft kommt es darauf an, ein paar Bytes Code oder Befehlszeilenargumente zu ändern, und dies ermöglicht es, die Kontrolle über einen Computer zu übernehmen, um ihn für eigene Zwecke zu verwenden.  Darüber hinaus können die meisten in macOS integrierten Antiviren-Tools und Antivirensoftware von Drittanbietern konvertierte Bedrohungen nicht erkennen. <br><br>  Da es sich bei dieser umfunktionierten Software nur um eine geringfügig überarbeitete, bekannte Original-Spyware handelt, setze ich einen "weißen Hut" auf und sage Ihnen, wie Sie sie noch finden können. <br><br><h3>  Erkennung der Neukonfigurationssoftware </h3><br>  Es ist bekannt, dass signaturbasierte Antivirensoftware nicht mit konvertierter Malware zurechtkommt.  Daher sollten wir auf das ungewöhnliche, abnormale, böswillige Verhalten solcher Malware achten. <br><br>  Wir müssen versuchen, es zu erkennen, nicht dank der bekannten Virensignatur, sondern indem wir seine Aktionen im System beobachten.  Wir haben dafür gesorgt, dass die Grundfunktionen und der Zweck von bekannten Spyware-Programmen unverändert bleiben, wenn Sie sie erneut erstellen. <br><br>  Wenn wir den Ransomware-Ransomware-Trojaner neu erstellen, werden Ihre Dateien weiterhin verschlüsselt, und die neu gestaltete Hintertür sammelt weiterhin Dateien und sendet sie an den Spionageserver. <br>  Auf der obigen Folie habe ich die Funktionen oder Fähigkeiten des Systems angezeigt, die überwacht und auf ihre Aktivität hin überwacht werden sollten.  Dazu gehören die „Persistenz“ von Anwendungen, ungewöhnliche Mikrofon- oder Kameraaktivitäten, das Herunterladen oder Übertragen von Dateien, nicht autorisierte Bildschirmaufnahmen, Symptome beim Abfangen der Tastatur, synthetische Klicker und Dateiverschlüsselung.  Dadurch wird auch wiederverwendete Malware erkannt. <br><br>  Reden wir über Ausdauer.  Wenn ich "Beharrlichkeit" sage, meine ich, dass die Spyware nach dem Neustart des Systems jedes Mal automatisch gestartet wird, sobald sie auf dem Computer installiert ist.  Dies ist eine Funktion von Malware für MacOS oder Windows, die sich bemüht, ein bösartiges Ziel zu erreichen. <br><br>  Wir können das Dateisystem einfach steuern, indem wir das Verhalten der „beständigen“ Anwendung beobachten. Wenn sich etwas daran ändert, benachrichtigen Sie den Benutzer oder Systemadministrator darüber. <br><br>  Jetzt möchte ich zeigen, wie Sie die Aktivität des ursprünglichen oder umgebauten Windtall-Virus erkennen können, der sich in einem nicht autorisierten Zugriff auf ein Mikrofon oder einen Webcam-Mac äußert. <br><br><img src="https://habrastorage.org/webt/9g/lg/rb/9glgrbybold1rwxqx_xhklasvn4.jpeg"><br><br>  Viele Mac-Malware greifen auf eine Webcam oder ein Mikrofon zu, um einen Benutzer eines infizierten Systems auszuspionieren.  Um diese Virusaktivität zu erkennen, können wir jede Umdrehung der Kamera und des Mikrofons im macOS-System registrieren, sodass der Benutzer automatisch eine Benachrichtigung über dieses Ereignis erhält.        ,    FruitFly,   ,  Zoom,           . <br><br>    .       ,         . <br><br><img src="https://habrastorage.org/webt/l8/1s/p3/l81sp3q6f1-3x6pjtwr6z0cehpk.jpeg"><br><br>        macOS –      Event Taps.            ,      .        . <br><br>     FruitFly,      ,           ,        – «» . <br><br><img src="https://habrastorage.org/webt/bi/ce/d4/biced48qutbyjlpsfiywsgwvk0m.jpeg"><br><br>     ,       macOS,    .          .       ,  macOS  ,      .     ,     . <br><br>        Objective-See,    -  macOS.       ,              .      ,     ,        . <br><br><img src="https://habrastorage.org/webt/fg/lz/ea/fglzeamo6vlyrjgnj1sa6hp5vvw.jpeg"><br><br>     ,     –    ,     ,        «  ». <br><br><img src="https://habrastorage.org/webt/bk/c6/po/bkc6poi2uugp2kmcff2q77h0v98.jpeg"><br><br> ,      Digita Security,        .      :           .               Apple,        ,             . <br><br>        ,     .    ,  ,         ,       ,    macOS. <br><br>   ,          . ,    Windtall,   ,  Safari ,     . <br><br><img src="https://habrastorage.org/webt/ek/iq/wo/ekiqwo4mwk-hqxnyijkrxd9n3l4.jpeg"><br><br>     ,      URL     ,     -    URL.            Windtall,       ,      . <br><br>    FruitFly        ,      ,     -   . ,  ,    ,   Apple,      -  . <br><br>  ,  FruitFly      ,            .      ,     .                template       . ,       . <br><br>  ,          ,      .     ,       ,    macOS. <br><br>    ,        Mac,     2020   ,       . <br><br><img src="https://habrastorage.org/webt/bv/ix/tg/bvixtgp1tqcst1xbg6jbdvrlq4k.jpeg"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/InL3YA_6P6s" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Ein bisschen Werbung :) </h3><br>  Vielen Dank für Ihren Aufenthalt bei uns.  Mögen Sie unsere Artikel?  Möchten Sie weitere interessante Materialien sehen?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unterstützen Sie uns, indem Sie eine Bestellung aufgeben oder Ihren Freunden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud VPS für Entwickler ab 4,99 USD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> empfehlen. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Dies</font></a><font style="vertical-align: inherit;"> ist ein </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30% iger Rabatt für Habr-Benutzer auf ein einzigartiges Analogon von Einstiegsservern, das wir für Sie erfunden haben: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die ganze Wahrheit über VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s ab 20 US-Dollar oder wie kann man einen Server gemeinsam nutzen?</font></font></a>  (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verfügbar). <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xd 2 mal günstiger?</font></font></b>  Nur wir haben <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2 x Intel TetraDeca-Core Xeon 2 x E5-2697v3 2,6 GHz 14C 64 GB DDR4 4 x 960 GB SSD 1 Gbit / s 100 TV ab 199 US-Dollar</a> in den Niederlanden!</b>  <b><b>Dell R420 - 2x E5-2430 2,2 GHz 6C 128 GB DDR3 2x960 GB SSD 1 Gbit / s 100 TB - ab 99 US-Dollar!</b></b>  Lesen Sie mehr über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das Erstellen von Infrastruktur-Bldg.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse mit Dell R730xd E5-2650 v4 Servern für 9.000 Euro für einen Cent?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de474590/">https://habr.com/ru/post/de474590/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de474578/index.html">Warum E-Mail-Marketing-Service tatsächlich gegen Spam kämpft und wie es funktioniert</a></li>
<li><a href="../de474580/index.html">Zugriff auf die Anwendung mithilfe der ax Availability Testing Library</a></li>
<li><a href="../de474582/index.html">(Ohne) gefährliches Online-Banking: Eine Studie über die Webressourcen von Banken in Russland und der Welt</a></li>
<li><a href="../de474584/index.html">Installieren Sie Kali Linux mit einer grafischen Oberfläche auf einem virtuellen Server</a></li>
<li><a href="../de474588/index.html">Die 9 besten Open Source-Fundstücke für Oktober 2019</a></li>
<li><a href="../de474592/index.html">Wie man außerhalb des Büros arbeitet und nicht verrückt wird</a></li>
<li><a href="../de474594/index.html">Wie man ein Unternehmen zwischen Gründern aufteilt - die Meinung eines Anwalts</a></li>
<li><a href="../de474596/index.html">Anwendung auf TSD und Kommunikation mit 1C: Enterprise 8.3 über HTTP-Service. Teil 5 (Menü, Begleitobjekt)</a></li>
<li><a href="../de474598/index.html">So erhalten Sie ein Interview mit einem QS-Ingenieur ohne Berufserfahrung</a></li>
<li><a href="../de474602/index.html">Lösen Sie die Gleichung der einfachen linearen Regression</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>