<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§Ωüèº üç• üîÜ Durchf√ºhren √∂ffentlicher und privater Transaktionen in der JPMorgan Quorum-Blockchain mit Web3 ü§ôüèº üîè üêøÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quorum ist eine Ethereum-basierte Blockchain, die von JPMorgan entwickelt wurde und zuletzt die erste verteilte Registrierungsplattform ist, die Micro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Durchf√ºhren √∂ffentlicher und privater Transaktionen in der JPMorgan Quorum-Blockchain mit Web3</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456368/"><p><img src="https://habrastorage.org/webt/dn/2r/f3/dn2rf3fmls1j424_o0ejhkjcxxe.jpeg"><br></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quorum</a> ist eine Ethereum-basierte Blockchain, die von JPMorgan entwickelt wurde und zuletzt die erste verteilte Registrierungsplattform ist, die Microsoft Azure anbietet. </p><br><p>  Das Quorum unterst√ºtzt private und √∂ffentliche Transaktionen und hat viele kommerzielle Anwendungsf√§lle. </p><br><p>  In diesem Artikel analysieren wir eines dieser Szenarien - die Bereitstellung eines verteilten Registrierungsnetzwerks zwischen einem Supermarkt und einem Lagerbesitzer, um relevante Informationen √ºber die Temperatur eines Lagers bereitzustellen. </p><br><p>  Der in diesem Handbuch verwendete Code befindet sich im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Repository auf GitHub</a> . </p><br><p>  Der Artikel behandelt: </p><br><ul><li>  Erstellen eines intelligenten Vertrags; </li><li>  Bereitstellen des Quorum-Netzwerks mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Chainstack</a> </li><li>  Quorum √∂ffentliche Transaktionen </li><li>  Quorum private Transaktionen. </li></ul><br><p>  Um dies zu veranschaulichen, verwenden wir das Skript zur √úberwachung der Temperatur in den Lagerr√§umen der Mitglieder des Quorum-Netzwerks als Teil des Internet der Dinge (IoT). </p><a name="habracut"></a><br><h2 id="kontekst">  Kontext </h2><br><p>  Eine Gruppe von Lagerunternehmen ist in einem Konsortium f√ºr die gemeinsame Speicherung von Informationen und die Automatisierung von Prozessen in der Blockchain zusammengefasst.  Daf√ºr haben sich die Unternehmen f√ºr Quorum entschieden.  In diesem Artikel werden zwei Szenarien behandelt: √∂ffentliche Transaktionen und private Transaktionen. </p><br><p>  Transaktionen werden von verschiedenen Teilnehmern erstellt, um mit dem Konsortium zu interagieren, zu dem sie geh√∂ren.  Jede Transaktion stellt entweder einen Vertrag bereit oder ruft eine Funktion in einem Vertrag auf, um Daten in das Netzwerk hochzuladen.  Diese Aktionen werden auf alle Knoten im Netzwerk repliziert. </p><br><p>  √ñffentliche Transaktionen k√∂nnen von allen Mitgliedern des Konsortiums eingesehen werden.  Private Transaktionen bieten eine zus√§tzliche Vertraulichkeitsebene und stehen nur den Teilnehmern zur Verf√ºgung, die Rechte daran haben. </p><br><p>  F√ºr beide Szenarien verwenden wir aus Gr√ºnden der √úbersichtlichkeit denselben Vertrag. </p><br><h2 id="smart-kontrakt">  Intelligenter Vertrag </h2><br><p> Im Folgenden finden Sie einen einfachen Smart-Vertrag, der f√ºr unser Szenario erstellt wurde.  Es hat eine √∂ffentliche variable <code>temperature</code> , die mit der <code>set</code> Methode ge√§ndert und mit der <code>get</code> Methode abgerufen werden kann. </p><br><pre> <code class="javascript hljs">pragma solidity ^<span class="hljs-number"><span class="hljs-number">0.4</span></span><span class="hljs-number"><span class="hljs-number">.25</span></span>; contract TemperatureMonitor { int8 public temperature; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">int8 temp</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span></span>{ temperature = temp; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">view</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">returns</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">int8</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> temperature; } }</code> </pre> <br><p>  Damit der Vertrag mit <a href="">web3.js funktioniert</a> , muss er in das ABI-Format und den Bytecode konvertiert werden.  Mit der <code>formatContract</code> Funktion <code>formatContract</code> wird der Vertrag mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">solc-js kompiliert</a> . </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">formatContract</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> path = <span class="hljs-string"><span class="hljs-string">'./contracts/temperatureMonitor.sol'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> source = fs.readFileSync(path,<span class="hljs-string"><span class="hljs-string">'UTF8'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> solc.compile(source, <span class="hljs-number"><span class="hljs-number">1</span></span>).contracts[<span class="hljs-string"><span class="hljs-string">':TemperatureMonitor'</span></span>]; }</code> </pre> <br><p>  Der abgeschlossene Vertrag lautet wie folgt: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// interface [ { constant: true, inputs: [], name: 'get', outputs: [Array], payable: false, stateMutability: 'view', type: 'function' }, { constant: true, inputs: [], name: 'temperature', outputs: [Array], payable: false, stateMutability: 'view', type: 'function' }, { constant: false, inputs: [Array], name: 'set', outputs: [], payable: false, stateMutability: 'nonpayable', type: 'function' } ]</span></span></code> </pre> <br><pre> <code class="plaintext hljs">// bytecode</code> </pre><br><p>  Nachdem der Vertrag fertig ist, werden wir das Netzwerk und den Vertrag bereitstellen. </p><br><h2 id="razvertyvanie-nod">  Knotenbereitstellung </h2><br><p><img src="https://habrastorage.org/getpro/habr/post_images/4e5/8d2/0d2/4e58d20d27bfa4aa8b4da4bbf990ac53.jpg" alt="Bild"></p><br><p>  Das Bereitstellen eines Knotens kann sehr zeitaufw√§ndig sein und dieser Prozess kann mithilfe des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Chainstack-</a> Dienstes ersetzt werden. </p><br><p>  Das Folgende ist ein Quorum-Netzwerkbereitstellungsprozess mit einem Raft-Konsens und drei Knoten. </p><br><p>  Beginnen wir mit einem Projekt und nennen es das Quorum-Projekt: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/193/316/b8e/193316b8ef875ed68e491804b5a7ff7d.gif" alt="Bild"></p><br><p>  Erstellen Sie ein Quorum-Netzwerk mit Raft-Konsens auf der Google Cloud-Plattform: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2f3/650/f1e/2f3650f1e98174694c46f6cd31040d4c.gif" alt="Bild"></p><br><p>  F√ºgen Sie dem bereits erstellten Standardknoten zwei weitere Knoten hinzu: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/cb5/77b/5f7/cb577b5f7516664e64951f6404711eaa.gif" alt="Bild"></p><br><p>  Drei laufende Knoten: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/243/c4d/056/243c4d0569c5d6b3accb3d1166e2b2f6.png" alt="Bild"></p><br><p>  Auf der Seite mit den Knotendetails werden der RPC-Endpunkt, der √∂ffentliche Schl√ºssel usw. angezeigt. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a35/61a/29a/a3561a29a5f38d410ed92c99a645b2c1.png" alt="Bild"></p><br><p>  Das Netzwerk wird bereitgestellt.  Jetzt werden wir intelligente Vertr√§ge bereitstellen und Transaktionen mit <a href="">web3.js</a> ausf√ºhren. </p><br><h2 id="publichnye-tranzakcii">  √ñffentliche Transaktionen </h2><br><h3 id="kontekst-1">  Kontext </h3><br><p>  Die Temperatur des Lagers ist von gro√üer Bedeutung, um die Kosten zu senken, insbesondere f√ºr Produkte, die zur Lagerung bei Temperaturen unter Null bestimmt sind. </p><br><p>  Durch die M√∂glichkeit f√ºr Unternehmen, Echtzeitwerte der Au√üentemperatur ihres geografischen Standorts zu teilen und in einem unver√§nderlichen Register aufzuzeichnen, reduzieren Netzwerkmitglieder Kosten und Zeit. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/03e/028/5ca/03e0285ca0b59b6b96351d5b99d95408.png" alt="Bild"></p><br><p>  Wir werden die drei in der Abbildung dargestellten Aufgaben ausf√ºhren: </p><br><ol><li><p>  Wir werden den Vertrag √ºber <b>Knoten 1</b> k√ºndigen: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> contractAddress = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> deployContract(raft1Node); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Contract address after deployment: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${contractAddress}</span></span></span><span class="hljs-string">`</span></span>);</code> </pre> <br></li><li><p>  Stellen Sie die Temperatur √ºber <b>Knoten 2</b> bis 3 Grad ein: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> status = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> setTemperature(raft2Node, contractAddress, <span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Transaction status: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${status}</span></span></span><span class="hljs-string">`</span></span>);</code> </pre> <br></li><li><p>  <b>Knoten 3</b> erh√§lt Informationen aus dem Smart-Vertrag.  Der Vertrag gibt einen Wert von 3 Grad zur√ºck: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> temp = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> getTemperature(raft3Node, contractAddress); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Retrieved contract Temperature'</span></span>, temp);</code> </pre> <br><p>  Als N√§chstes sehen wir uns an, wie eine √∂ffentliche Transaktion im Quorum-Netzwerk mit <a href="">web3.js ausgef√ºhrt wird.</a> </p><br></li></ol><br><p>  Wir initiieren eine Instanz √ºber RPC f√ºr drei Knoten: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> raft1Node = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Web3( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Web3.providers.HttpProvider(process.env.RPC1), <span class="hljs-literal"><span class="hljs-literal">null</span></span>, { <span class="hljs-attr"><span class="hljs-attr">transactionConfirmationBlocks</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> raft2Node = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Web3( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Web3.providers.HttpProvider(process.env.RPC2), <span class="hljs-literal"><span class="hljs-literal">null</span></span>, { <span class="hljs-attr"><span class="hljs-attr">transactionConfirmationBlocks</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> raft3Node = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Web3( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Web3.providers.HttpProvider(process.env.RPC3), <span class="hljs-literal"><span class="hljs-literal">null</span></span>, { <span class="hljs-attr"><span class="hljs-attr">transactionConfirmationBlocks</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, );</code> </pre> <br><p>  Zerst√∂ren Sie den intelligenten Vertrag: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// returns the default account from the Web3 instance initiated previously function getAddress(web3) { return web3.eth.getAccounts().then(accounts =&gt; accounts[0]); } // Deploys the contract using contract's interface and node's default address async function deployContract(web3) { const address = await getAddress(web3); // initiate contract with contract's interface const contract = new web3.eth.Contract( temperatureMonitor.interface ); return contract.deploy({ // deploy contract with contract's bytecode data: temperatureMonitor.bytecode, }) .send({ from: address, gas: '0x2CD29C0', }) .on('error', console.error) .then((newContractInstance) =&gt; { // returns deployed contract address return newContractInstance.options.address; }); }</span></span></code> </pre> <br><p>  <a href="">web3.js</a> bietet zwei Methoden f√ºr die Interaktion mit einem Vertrag: <code>call</code> und <code>send</code> . </p><br><p>  Aktualisieren Sie die Temperatur des Vertrags, indem Sie <code>set</code> mit der web3-Sendemethode ausf√ºhren. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// get contract deployed previously async function getContract(web3, contractAddress) { const address = await getAddress(web3); return web3.eth.Contract( temperatureMonitor.interface, contractAddress, { defaultAccount: address, } ); } // calls contract set method to update contract's temperature async function setTemperature(web3, contractAddress, temp) { const myContract = await getContract(web3, contractAddress); return myContract.methods.set(temp).send({}).then((receipt) =&gt; { return receipt.status; }); }</span></span></code> </pre> <br><p>  Als n√§chstes verwenden wir die web3-Aufrufmethode, um die Temperatur des Vertrags zu ermitteln.  Bitte beachten Sie, dass die Aufrufmethode auf dem lokalen Knoten ausgef√ºhrt wird und die Transaktion nicht in der Blockchain erstellt wird. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// calls contract get method to retrieve contract's temperature async function getTemperature(web3, contractAddress) { const myContract = await getContract(web3, contractAddress); return myContract.methods.get().call().then(result =&gt; result); }</span></span></code> </pre> <br><p>  Jetzt k√∂nnen Sie <a href="">public.js ausf√ºhren</a> , um das folgende Ergebnis zu erhalten: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Execute public script node public.js Contract address after deployment: 0xf46141Ac7D6D6E986eFb2321756b5d1e8a25008F Transaction status: true Retrieved contract Temperature 3</span></span></code> </pre> <br><p>  Als n√§chstes sehen wir die Eintr√§ge im Quorum Explorer im Chainstack-Bedienfeld, wie unten gezeigt. </p><br><p>  Alle drei Knoten interagierten und Transaktionen wurden aktualisiert: </p><br><ol><li>  Die erste Transaktion hat einen Vertrag gesichert. </li><li>  Bei der zweiten Transaktion wurde die Vertragstemperatur auf 3 Grad festgelegt. </li><li>  Die Temperatur wird √ºber den lokalen Knoten ermittelt, sodass die Transaktion nicht erstellt wurde. </li></ol><br><p><img src="https://habrastorage.org/getpro/habr/post_images/6fb/104/097/6fb10409705859a6672a53d76356a55c.png" alt="Bild"></p><br><h2 id="privatnye-tranzakcii">  Private Transaktionen </h2><br><h3 id="kontekst-2">  Kontext </h3><br><p>  Eine h√§ufige Anforderung von Organisationen ist der Datenschutz.  Stellen Sie sich als Beispiel ein Szenario vor, in dem ein <i>Supermarkt</i> ein Lager f√ºr die Lagerung von Meeresfr√ºchten von einem separaten <i>Anbieter</i> mietet: </p><br><ul><li>  <i>Der Anbieter</i> liest mit Hilfe von IoT-Sensoren alle 30 Sekunden Temperaturwerte und leitet sie an den <i>Supermarkt weiter</i> . </li><li>  Diese Werte sollten nur dem <i>Verk√§ufer</i> und dem <i>Supermarkt</i> , einem vernetzten Konsortium, zur Verf√ºgung stehen. </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/deb/3b1/a51/deb3b1a51e681fe664bc49b2d6eb8307.png" alt="Bild"></p><br><p>  Wir werden die vier in der obigen Abbildung dargestellten Aufgaben ausf√ºhren. </p><br><ul><li>  Wir verwenden dieselben drei Knoten aus dem vorherigen Szenario, um private Transaktionen zu demonstrieren: </li><li>  <i>Der Supermarkt setzt</i> einen intelligenten Vertrag ein, der f√ºr den <i>Supermarkt</i> und den <i>Verk√§ufer</i> privat ist. </li><li>  <i>Ein Dritter</i> hat keinen Zugriff auf den Smart-Vertrag. </li></ul><br><p>  Wir werden die <code>get</code> und <code>set</code> Methoden im Auftrag des <i>Supermarkts</i> und des <i>Anbieters</i> aufrufen, um die private Quorum-Transaktion zu demonstrieren. </p><br><ol><li><p>  Wir werden den privaten Vertrag f√ºr die Teilnehmer des <i>Supermarkts</i> und des <i>Verk√§ufers</i> √ºber den Teilnehmer des <i>Supermarkts</i> k√ºndigen: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> contractAddress = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> deployContract( raft1Node, process.env.PK2, ); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Contract address after deployment: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${contractAddress}</span></span></span><span class="hljs-string">`</span></span>);</code> </pre> <br></li><li><p>  Stellen Sie die Temperatur vom <i>Drittanbieter</i> (√§u√üerer Knoten) ein und erhalten Sie den Temperaturwert: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Attempts to set Contract temperature to 10, this will not mutate contract's temperature await setTemperature( raft3Node, contractAddress, process.env.PK1, 10, ); // This returns null const temp = await getTemperature(raft3Node, contractAddress); console.log(`[Node3] temp retrieved after updating contract from external nodes: ${temp}`);</span></span></code> </pre> <br></li><li><p>  Stellen Sie die Temperatur vom <i>Lieferanten</i> (innerer Knoten) ein und erhalten Sie den Temperaturwert: </p><br><p>  Die Temperatur in diesem Szenario sollte vom Smart-Vertrag auf 12 zur√ºckkehren. Bitte beachten Sie, dass der <i>Anbieter</i> hier den Zugriff auf den Smart-Vertrag zugelassen hat. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Updated Contract temperature to 12 degrees await setTemperature( raft2Node, contractAddress, process.env.PK1, 12, ); // This returns 12 const temp2 = await getTemperature(raft2Node, contractAddress); console.log(`[Node2] temp retrieved after updating contract from internal nodes: ${temp2}`);</span></span></code> </pre> <br></li><li><p>  Holen Sie sich die Temperatur vom <i>Drittanbieter</i> (√§u√üerer Knoten): </p><br><p>  In Schritt 3 wurde die Temperatur auf 12 eingestellt, aber der <i>Dritte</i> hat keinen Zugriff auf den Smart-Vertrag.  Daher muss der R√ºckgabewert null sein. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// This returns null const temp3 = await getTemperature(raft3Node, contractAddress); console.log(`[Node3] temp retrieved from external nodes after update ${temp}`);</span></span></code> </pre> <br><p>  Als n√§chstes werden wir die Ausf√ºhrung privater Transaktionen im Quorum-Netzwerk mit <a href="">web3.js genauer betrachten.</a>  Da der gr√∂√üte Teil des Codes mit √∂ffentlichen Transaktionen √ºbereinstimmt, w√§hlen wir nur die Teile aus, die sich f√ºr private Transaktionen unterscheiden. </p><br></li></ol><br><p>  Bitte beachten Sie, dass der in das Netzwerk hochgeladene Vertrag unver√§nderlich ist. Daher muss den entsprechenden Knoten der Zugriff mit Erlaubnis gew√§hrt werden, indem der √∂ffentliche Vertrag zum Zeitpunkt der Bereitstellung des Vertrags und nicht danach einbezogen wird. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deployContract</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">web3, publicKey</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> address = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> getAddress(web3); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> contract = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> web3.eth.Contract( temperatureMonitor.interface, ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> contract.deploy({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: temperatureMonitor.bytecode, }) .send({ <span class="hljs-attr"><span class="hljs-attr">from</span></span>: address, <span class="hljs-attr"><span class="hljs-attr">gas</span></span>: <span class="hljs-string"><span class="hljs-string">'0x2CD29C0'</span></span>, <span class="hljs-comment"><span class="hljs-comment">// Grant Permission to Contract by including nodes public keys privateFor: [publicKey], }) .then((contract) =&gt; { return contract.options.address; }); }</span></span></code> </pre> <br><p>  Private Transaktionen werden auf die gleiche Weise ausgef√ºhrt - unter Einbeziehung des √∂ffentlichen Schl√ºssels der Teilnehmer zum Zeitpunkt der Ausf√ºhrung. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setTemperature</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">web3, contractAddress, publicKey, temp</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> address = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> getAddress(web3); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> myContract = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> getContract(web3, contractAddress); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> myContract.methods.set(temp).send({ <span class="hljs-attr"><span class="hljs-attr">from</span></span>: address, <span class="hljs-comment"><span class="hljs-comment">// Grant Permission by including nodes public keys privateFor: [publicKey], }).then((receipt) =&gt; { return receipt.status; }); }</span></span></code> </pre> <br><p>  Jetzt k√∂nnen wir <a href="">private.js</a> mit den folgenden Ergebnissen <a href="">ausf√ºhren</a> : </p><br><pre> <code class="bash hljs">node private.js Contract address after deployment: 0x85dBF88B4dfa47e73608b33454E4e3BA2812B21D [Node3] temp retrieved after updating contract from external nodes: null [Node2] temp retrieved after updating contract from internal nodes: 12 [Node3] temp retrieved from external nodes after update null</code> </pre> <br><p>  Der Quorum Explorer bei Chainstack zeigt Folgendes: </p><br><ul><li>  Bereitstellung eines Vertrags von einem <i>Supermarktteilnehmer</i> </li><li>  Durchf√ºhren von <code>SetTemperature</code> von einem <i>Dritten</i> ; </li><li>  F√ºhren Sie eine <code>SetTemperature</code> von einem <i>Herstellerteilnehmer aus</i> . </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/e14/6d2/660/e146d2660771f328fda7087facaec1e7.png" alt="Bild"></p><br><p>  Wie Sie sehen, sind beide Transaktionen abgeschlossen, aber nur die Transaktion des teilnehmenden <i>Anbieters</i> hat die Temperatur im Vertrag aktualisiert.  Private Transaktionen bieten somit Unver√§nderlichkeit, geben aber gleichzeitig keine Daten an Dritte weiter. </p><br><h2 id="zaklyuchenie">  Fazit </h2><br><p>  Wir haben das kommerzielle Szenario f√ºr die Verwendung von Quorum untersucht, um aktuelle Temperaturinformationen in einem Lager bereitzustellen, indem wir ein Netzwerk zwischen zwei Parteien - einem Supermarkt und dem Lagerbesitzer - bereitgestellt haben. </p><br><p>  Wir haben gezeigt, wie aktuelle Temperaturinformationen sowohl durch √∂ffentliche als auch durch private Transaktionen aufrechterhalten werden k√∂nnen. </p><br><p>  Es kann viele Anwendungsszenarien geben, und wie Sie sehen, ist dies √ºberhaupt nicht schwierig. </p><br><p>  Experimentieren Sie und versuchen Sie, Ihr Skript bereitzustellen.  Dar√ºber hinaus kann die Blockchain-Technologieindustrie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bis 2024 fast zehnmal wachsen</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456368/">https://habr.com/ru/post/de456368/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456352/index.html">Drahtloses Objektkommunikationsmodul WISE-4000</a></li>
<li><a href="../de456354/index.html">Wie sammeln wir TV-Boxen?</a></li>
<li><a href="../de456358/index.html">Die 13 ber√ºchtigtsten Artikel des vergangenen Jahres</a></li>
<li><a href="../de456362/index.html">Level 6 Designer: Wie wir Designer motivieren und entwickeln</a></li>
<li><a href="../de456366/index.html">Wie ich die LED HEART Box entworfen habe</a></li>
<li><a href="../de456370/index.html">Implementieren Sie QoS in Qsan Storage</a></li>
<li><a href="../de456372/index.html">SimbirSoft l√§dt IT-Experten zum Intensivsommer 2019 ein</a></li>
<li><a href="../de456374/index.html">Plasma Cash Blockchain State Datenstrukturen</a></li>
<li><a href="../de456376/index.html">Not One Spring Boot: Ein √úberblick √ºber Alternativen</a></li>
<li><a href="../de456380/index.html">Tag der offenen T√ºr der Fakult√§t f√ºr Programmierung in der Netologie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>