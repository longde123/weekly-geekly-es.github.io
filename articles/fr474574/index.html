<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ó üë©üèø‚Äçüåæ ü•© Nous identifions l'attaque du virus de chiffrement, acc√©dons au contr√¥leur de domaine et essayons de r√©sister √† ces attaques. üöø üêæ üë®‚Äç‚úàÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="WannaCry, NotPetya, BadRabbit et d'autres sont des virus ran√ßongiciels qui ont secou√© le monde entier il y a environ un an ou deux. Aujourd'hui, les a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous identifions l'attaque du virus de chiffrement, acc√©dons au contr√¥leur de domaine et essayons de r√©sister √† ces attaques.</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/galssoftware/blog/474574/"><img src="https://habrastorage.org/webt/ol/w0/dw/olw0dwca4jcb1xs3dod5nhtwfdo.gif"><br><br>  WannaCry, NotPetya, BadRabbit et d'autres sont des virus ran√ßongiciels qui ont secou√© le monde entier il y a environ un an ou deux.  Aujourd'hui, les attaques de ces types de virus font moins de bruit, mais des histoires d'attaques se produisent toujours.  Dans cet article, je vais vous montrer un des outils pour stopper l'attaque d'un tel virus: d√©tecter rapidement une intrusion et localiser le probl√®me.  Tout cela √† l'aide d'un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">outil d'</a> analyse de journal et de protection contre les intrusions <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Quest InTrust</a> .  Sous le chat se trouvent des captures d'√©cran et un lien vers les d√©p√¥ts de scripts malveillants.  C'est parti! <br><a name="habracut"></a><br>  Quest InTrust est une solution int√©gr√©e qui comprend la collecte de diff√©rents types de journaux, de donn√©es Syslog et d'analyseurs pr√™ts √† l'emploi pour diff√©rents types d'√©quipements.  Il existe des r√®gles pr√©d√©finies pour prendre des mesures pour emp√™cher les attaques.  Nous allons maintenant examiner de plus pr√®s tout cela avec des exemples d'analyse d'une attaque de virus de chiffrement et d'acc√®s √† un contr√¥leur de domaine <br><br><h1>  Attaque de ransomware </h1><br>  Le principe de l'attaque est de cr√©er de nouveaux fichiers ou dossiers crypt√©s et de supprimer les originaux.  Eh bien, alors une demande de ran√ßon en bitcoins ou d'une autre mani√®re.  La d√©finition de ce type d'attaque est bas√©e sur la d√©tection de la suppression massive et la cr√©ation de fichiers.  Surtout si cela se produit apr√®s les heures de classe. <br><br><div class="spoiler">  <b class="spoiler_title">Quelques r√©f√©rentiels avec des exemples de scripts de chiffrement</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Powershell-Ransomware</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ansomware-encryptor-decryptor</a> <br></div></div><br>  Pour collecter les √©v√©nements de changement, nous utilisons l'int√©gration avec la solution d'audit Quest Change Auditor (elle √©tait d√©j√† d√©crite <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans l'article pr√©c√©dent</a> et m√™me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">compar√©e √† un produit d'un concurrent</a> ).  Pour les √©v√©nements de cette source, InTrust a des r√®gles pr√©d√©finies pour d√©tecter les anomalies.  Bien s√ªr, vous pouvez ajouter ici toute logique de traitement des √©v√©nements.  Dans mon exemple, il est d√©termin√© que lors de la cr√©ation de fichiers en vrac (plus de 5 pi√®ces en 1 minute), le compte d'utilisateur sera bloqu√© et l'acc√®s aux r√©pertoires partag√©s sera refus√©. <br><br><img src="https://habrastorage.org/webt/t3/s3/17/t3s317ynfhnygdue6ehjvy5gadi.png"><br><br>  Les param√®tres de strat√©gie indiquent le r√©pertoire auquel la r√®gle s'applique et la liste des notifications.  Si le DA dispose d'informations sur la subordination des employ√©s, vous pouvez envoyer une lettre √† son superviseur.  Un cas utile est l'identification des tentatives d'acc√®s aux fichiers qui, semble-t-il, ne sont pas n√©cessaires √† l'exercice des fonctions de cet employ√© en particulier.  Cela peut √™tre particuli√®rement pertinent avant le licenciement, lorsque vous souhaitez emporter avec vous des d√©veloppements tout faits. <br><br><img src="https://habrastorage.org/webt/a5/xy/wy/a5xywya_veqwkqljbbrtzqsfyla.png"><br><br>  Apr√®s avoir v√©rifi√© tous les param√®tres, passons au chiffreur de script pr√©-pr√©par√©.  Et lancez-le. <br><br><img src="https://habrastorage.org/webt/qd/f5/h-/qdf5h-zk24kdq47biltyggzgavg.png"><br><br>  Dans les param√®tres de d√©tection d'attaque, ¬´plus de 5 fichiers¬ª √©taient indiqu√©s, comme vous pouvez le voir, apr√®s 7 fichiers, le virus a √©t√© arr√™t√© (l'utilisateur a √©t√© bloqu√© et l'acc√®s au r√©pertoire a √©t√© d√©sactiv√©).  Facile √† descendre.  Dans le m√™me temps, les employ√©s responsables ont re√ßu des notifications. <br><br><h1>  Attaque sur un contr√¥leur de domaine </h1><br>  Vous trouverez ci-dessous le sc√©nario d'attaque, qui vous permet d'acc√©der au compte administratif et, par cons√©quent, au contr√¥leur de domaine.  La d√©tection de l'ex√©cution des applets <s>de</s> commande <s>malveillantes</s> sp√©cialis√©es (par exemple, le d√©chargement des comptes de domaine) est √©galement incluse dans la liste des r√®gles Quest InTrust pr√©d√©finies (la premi√®re ligne de la s√©lection dans l'image ci-dessous).  De plus, dans mon exemple, les utilisateurs de la ¬´feuille blanche¬ª sont indiqu√©s auxquels les r√®gles ne s'appliquent pas (la deuxi√®me ligne de la s√©lection dans l'image ci-dessous). <br><br><img src="https://habrastorage.org/webt/bk/6j/eg/bk6jegg3lxxw_avksd2etqkhttg.png"><br><br>  √Ä l'aide du script <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">invoke-mimikatz</a> , la cr√©ation d'un vidage des d√©tails du compte est activ√©e.  En m√™me temps, aucun fichier n'est cr√©√© sur le syst√®me de fichiers.  Tout d'abord, v√©rifiez le nom du compte sous lequel vous √™tes connect√©.  Comme vous pouvez le voir, cet utilisateur fait partie de la "liste blanche", qui peut librement ex√©cuter n'importe quelle applet de commande. <br><br><img src="https://habrastorage.org/webt/mz/ge/wu/mzgewuwguxg1kc8vssgbddrgfxy.png"><br><br>  Ensuite, nous ex√©cutons le script pr√©-pr√©par√©.  √Ä la sortie, nous obtenons une conclusion dans laquelle nous trouvons les d√©tails de notre utilisateur de test. <br><br><img src="https://habrastorage.org/webt/b4/l6/oi/b4l6oioub43m6dnl1b2dhs9one0.png"><br><br>  Dans l'√©tape suivante, nous d√©couvrons √† quels groupes cet utilisateur appartient.  Des groupes d'administrateurs sont pr√©sents. <br><br><img src="https://habrastorage.org/webt/-j/vy/92/-jvy928mvqdn7kjtgoquyhdvwqo.png"><br><br>  Nous apprenons maintenant les noms des contr√¥leurs de domaine.  Dans mon exemple, il est seul. <br><br><img src="https://habrastorage.org/webt/k2/v2/4z/k2v24z02-4bpvkudt703fpke5jc.png"><br><br>  L'√©tape suivante d'une attaque potentielle consiste √† se connecter √† un contr√¥leur de domaine.  Reste √† saisir le mot de passe qui a d√©j√† √©t√© mis en surbrillance. <br><br><img src="https://habrastorage.org/webt/ip/8u/d5/ip8ud53rjhhvejbjyf98u-4hbqo.png"><br><br>  Et acc√©dez √† l'ex√©cution de toutes les commandes sur le contr√¥leur de domaine. <br><br><img src="https://habrastorage.org/webt/w7/uo/cu/w7uocu-xypu2qh9nd0ycdlxn2du.png"><br><br>  Essayons maintenant de faire le m√™me algorithme d'actions, mais au nom d'un utilisateur qui n'a pas √©t√© ajout√© √† la ¬´liste blanche¬ª dans InTrust.  Pour la puret√© de l'exp√©rience, nous v√©rifions le nom d'utilisateur.  Ensuite, nous ex√©cutons le script invoke-mimikatz. <br><br><img src="https://habrastorage.org/webt/x-/8h/yp/x-8hypkn4uu8e4q8jhouok6rlvu.png"><br><br>  Parmi les actions mentionn√©es dans InTrust figuraient la fin de la session d'acc√®s au terminal et le blocage de l'utilisateur.  C'est ce qui s'est pass√©. <br><br><img src="https://habrastorage.org/webt/fo/iu/sx/foiusxs7rjzlxzjomeows2ambus.png"><br><br>  V√©rifiez √† nouveau ce compte. <br><br><img src="https://habrastorage.org/webt/-h/fo/vj/-hfovjzipni1-kbpno0qlmmxxyc.png"><br><br>  L'attaque est emp√™ch√©e, l'utilisateur est bloqu√©, le monde est sauv√©. <br><br>  Si vous avez vos propres strat√©gies pour lutter contre diff√©rents types d'intrus, vous pouvez √©galement les sp√©cifier dans InTrust.  Avec d'autres produits Quest ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Change Auditor</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Enterprise Reporter</a> ) bas√©s sur InTrust, vous pouvez cr√©er un syst√®me SIEM √† part enti√®re pour identifier et pr√©venir les cons√©quences graves des attaques num√©riques sur les entreprises. <br><br>  InTrust et d'autres produits Quest peuvent √™tre essay√©s dans votre environnement dans le cadre d'un projet pilote.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Laissez une demande</a> pour en savoir plus. <br><br>  Nos autres articles sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">logiciel</a> tag <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gals</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr474574/">https://habr.com/ru/post/fr474574/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr474562/index.html">LEGO MINDSTORMS Education EV3 + MicroPython: nous programmons un constructeur pour enfants dans une langue adulte</a></li>
<li><a href="../fr474564/index.html">√âchantillonneur automatique - La vie apr√®s la vie</a></li>
<li><a href="../fr474566/index.html">Cette ville a besoin d'un nouveau h√©ros: une revue des sacs √† dos anti-vol de Bobby Hero</a></li>
<li><a href="../fr474568/index.html">Le lait des dents: un changement de profession pour les cellules</a></li>
<li><a href="../fr474572/index.html">Est-ce normal du tout? Le probl√®me de la norme en psychologie</a></li>
<li><a href="../fr474576/index.html">Vision sonore Vision VOCIQUE. Regarde hors de l'obscurit√©</a></li>
<li><a href="../fr474578/index.html">Pourquoi le service de marketing par e-mail combat r√©ellement le spam et comment il fonctionne</a></li>
<li><a href="../fr474580/index.html">Rendre l'application accessible √† l'aide de la biblioth√®que de tests de disponibilit√© de ax</a></li>
<li><a href="../fr474582/index.html">Services bancaires en ligne (sans) dangereux: une √©tude des ressources Web des banques en Russie et dans le monde</a></li>
<li><a href="../fr474584/index.html">Installer Kali Linux avec une interface graphique sur un serveur virtuel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>