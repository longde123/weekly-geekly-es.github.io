<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“º ğŸ§“ğŸ¿ ğŸ›€ğŸ» Linux: suppression du pool de verrous / dev / random ğŸš£ğŸ½ ğŸ‘¨ğŸ¿â€ğŸ³ ğŸ“¬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comme vous le savez, / dev / random, un gÃ©nÃ©rateur de nombres pseudo alÃ©atoires (CSPRNG) cryptographiquement puissant, a un problÃ¨me dÃ©sagrÃ©able - le ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Linux: suppression du pool de verrous / dev / random</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/484736/">  Comme vous le savez, / dev / random, un gÃ©nÃ©rateur de nombres pseudo alÃ©atoires (CSPRNG) cryptographiquement puissant, a un problÃ¨me dÃ©sagrÃ©able - le blocage.  Cet article dÃ©crit comment le rÃ©soudre. <br><br>  Au cours des derniers mois, les moyens de gÃ©nÃ©rer des nombres alÃ©atoires dans le noyau ont Ã©tÃ© lÃ©gÃ¨rement retravaillÃ©s, mais les problÃ¨mes de ce sous-systÃ¨me ont Ã©tÃ© rÃ©solus sur une <a href="https://lwn.net/Kernel/Index/">pÃ©riode</a> plus large.  Les <a href="https://lwn.net/Articles/802360/">modifications les</a> plus <a href="https://lwn.net/Articles/802360/">rÃ©centes ont</a> Ã©tÃ© apportÃ©es pour empÃªcher l'appel systÃ¨me getrandom () d'Ãªtre bloquÃ© pendant une longue pÃ©riode lors du dÃ©marrage du systÃ¨me, mais la raison derriÃ¨re cela Ã©tait le comportement du pool alÃ©atoire de blocage.  Un correctif rÃ©cent supprimerait ce pool, et il Ã©tait Ã  prÃ©voir qu'il irait au noyau principal. <br><br>  Andy Lutomirski a publiÃ© la troisiÃ¨me version du patch fin dÃ©cembre.  Il apporte <i>"deux modifications sÃ©mantiques de base aux API Linux alÃ©atoires"</i> .  Le correctif ajoute le nouvel indicateur GRND_INSECURE Ã  l'appel systÃ¨me getrandom () (bien que Lutomirsky l'appelle getentropy (), qui est implÃ©mentÃ© dans la glibc en utilisant getrandom () avec des indicateurs fixes);  ce drapeau oblige l'appel Ã  toujours renvoyer la quantitÃ© de donnÃ©es demandÃ©es, mais sans garantir que les donnÃ©es sont alÃ©atoires.  Le noyau fera simplement de son mieux pour fournir les meilleures donnÃ©es alÃ©atoires qu'il possÃ¨de Ã  un moment donnÃ©.  <i>"Probablement la meilleure chose que vous puissiez faire est de l'appeler" INSECURE "</i> (dangereux) pour l'empÃªcher d'Ãªtre utilisÃ© pour des choses qui ont besoin de sÃ©curitÃ©." <a name="habracut"></a><br><br>  Les correctifs suppriment Ã©galement le pool de blocage.  Actuellement, le noyau prend en charge deux pools de donnÃ©es alÃ©atoires, dont l'un correspond Ã  / dev / random et l'autre Ã  / dev / urandom, comme dÃ©crit dans cet <a href="https://lwn.net/Articles/658497/">article de</a> 2015.  Un pool de blocage est un pool pour / dev / random;  la lecture de cet appareil sera bloquÃ©e (c'est-Ã -dire son nom) jusqu'Ã  ce que l'entropie Â«suffisanteÂ» soit collectÃ©e du systÃ¨me pour satisfaire la demande.  Les lectures ultÃ©rieures de ce fichier sont Ã©galement bloquÃ©es s'il n'y a pas assez d'entropie dans le pool. <br><br>  La suppression du pool de verrous signifie que la lecture Ã  partir de / dev / random se comporte comme getrandom () avec la valeur des indicateurs dÃ©finie sur zÃ©ro (et transforme l'indicateur GRND_RANDOM en noop).  AprÃ¨s avoir initialisÃ© le gÃ©nÃ©rateur de nombres alÃ©atoires cryptographiques (CRNG), la lecture Ã  partir de / dev / random et l'appel Ã  getrandom (..., 0) ne bloqueront pas et retourneront la quantitÃ© demandÃ©e de donnÃ©es alÃ©atoires. <br><br>  Lutomirsky dÃ©clare: <i>Â«Je pense que le pool de blocage Linux est devenu obsolÃ¨te.</i>  <i>CRNG Linux gÃ©nÃ¨re une sortie suffisamment bonne pour Ãªtre utilisÃ©e mÃªme pour la gÃ©nÃ©ration de clÃ©s.</i>  <i>Le pool de blocage n'est pas plus solide dans un sens matÃ©riel, et il nÃ©cessite beaucoup d'infrastructure de valeur douteuse pour le maintenir. "</i> <br><br>  Les modifications ont Ã©tÃ© apportÃ©es dans le but de garantir que les programmes existants ne souffrent pas vraiment, et en fait, les problÃ¨mes avec la longue attente pour des choses telles que la gÃ©nÃ©ration de clÃ©s GnuPG deviendront plus petits. <br><br>  <i>Â«Ces sÃ©ries ne doivent violer aucun programme existant.</i>  <i>/ dev / urandom reste inchangÃ©.</i>  <i>/ dev / random bloque toujours immÃ©diatement aprÃ¨s le chargement, mais il bloque moins qu'auparavant.</i>  <i>getentropy () avec les drapeaux existants retournera un rÃ©sultat qui sera tout aussi pratique pour le but qu'auparavant. Â»</i> <br><br>  Lutomirsky a notÃ© que la question reste ouverte de savoir si le noyau devrait fournir les soi-disant Â«vrais nombres alÃ©atoiresÂ», ce qui aurait dÃ» dans une certaine mesure Ãªtre effectuÃ© par le noyau bloquant.  Il ne voit qu'une seule raison Ã  cela: Â«le respect des normes Ã©tatiquesÂ».  Lutomirsky a suggÃ©rÃ© que si le noyau devait fournir cela, alors cela devrait Ãªtre fait via une interface complÃ¨tement diffÃ©rente ou transfÃ©rÃ© vers l'espace utilisateur, lui permettant de rÃ©cupÃ©rer des modÃ¨les d'Ã©vÃ©nements non traitÃ©s qui pourraient Ãªtre utilisÃ©s pour crÃ©er un tel pool de verrous. <br><br>  Stephan MÃ¼ller a suggÃ©rÃ© que son ensemble de <a href="https://lwn.net/ml/linux-kernel/2722222.P16TYeLAVu%40positron.chronox.de/">correctifs</a> pour le gÃ©nÃ©rateur de nombres alÃ©atoires Linux (LRNG) (la version 26 est actuellement publiÃ©e) pourrait Ãªtre un moyen de fournir de vrais nombres alÃ©atoires pour les applications qui en ont besoin.  LRNG "rÃ©pond pleinement aux exigences des" Recommandations sur les sources d'entropie utilisÃ©es pour gÃ©nÃ©rer des bits alÃ©atoires "SP800-90B", ce qui en fait une solution au problÃ¨me des normes Ã©tatiques. <br>  Matthew Garrett s'est opposÃ© Ã  l'expression Â«vraies donnÃ©es alÃ©atoiresÂ», notant que les dispositifs sÃ©lectionnables peuvent, en principe, Ãªtre modÃ©lisÃ©s avec suffisamment de prÃ©cision pour les rendre prÃ©visibles: Â«nous ne prenons pas ici d'Ã©vÃ©nements quantiquesÂ». <br><br>  Muller a rÃ©pondu que le terme vient de la norme allemande AIS 31 pour dÃ©crire un gÃ©nÃ©rateur de nombres alÃ©atoires qui produit uniquement le rÃ©sultat "Ã  la mÃªme vitesse que la source de bruit sous-jacente produit l'entropie". <br><br>  Outre les malentendus de la terminologie, la prÃ©sence d'un pool de verrous, comme le suggÃ¨rent les correctifs LRNG, entraÃ®nera simplement divers problÃ¨mes, du moins s'il est disponible sans privilÃ¨ges. <br><br>  Comme l'a dit Lutomirsky: <i>Â«Cela ne rÃ©sout pas le problÃ¨me.</i>  <i>Si deux utilisateurs diffÃ©rents exÃ©cutent des programmes stupides tels que gnupg, ils s'Ã©puisent simplement l'un l'autre.</i>  <i>Je vois qu'il y a actuellement deux problÃ¨mes principaux avec / dev / random: il est sensible au DoS (c'est-Ã -dire l'Ã©puisement des ressources, les influences nuisibles ou quelque chose de similaire), et comme il ne nÃ©cessite aucun privilÃ¨ge pour l'utiliser, il a Ã©galement soumis Ã  des abus.</i>  <i>Gnupg a tort, c'est un effondrement complet.</i>  <i>Si nous ajoutons une nouvelle interface non privilÃ©giÃ©e que gnupg et des programmes similaires utiliseront, nous perdrons Ã  nouveau. Â»</i> <br><br>  Muller a notÃ© que l'ajout de getrandom () permettra dÃ©sormais Ã  GnuPG d'utiliser cette interface, car cela fournira la garantie nÃ©cessaire que le pool a Ã©tÃ© initialisÃ©.  D'aprÃ¨s des discussions avec le dÃ©veloppeur de GnuPG Werner Koch, Muller pense que la garantie est la seule raison pour laquelle GnuPG lit actuellement directement depuis / dev / random.  Mais s'il existe une interface non privilÃ©giÃ©e qui fait l'objet d'un dÃ©ni de service (Ã  partir d'aujourd'hui / dev / random), alors selon Lutomirsky, elle sera mal utilisÃ©e par certaines applications. <br><br>  Theodore Yue Tak Ts'o, le dÃ©veloppeur du sous-systÃ¨me de nombres alÃ©atoires Linux, semble avoir changÃ© d'avis quant Ã  la nÃ©cessitÃ© d'un pool de blocage.  Il a dit que la suppression de ce pool se dÃ©barrasserait effectivement de l'idÃ©e que Linux a un vÃ©ritable gÃ©nÃ©rateur de nombres alÃ©atoires (TRNG): <i>"ce n'est pas un non-sens, car c'est exactement ce que * BSD a toujours fait."</i> <br><br>  Il craint Ã©galement que la fourniture du mÃ©canisme TRNG serve simplement de leurre aux dÃ©veloppeurs d'applications et estime qu'en rÃ©alitÃ©, compte tenu des diffÃ©rents types de matÃ©riel pris en charge par Linux, il n'est pas possible de garantir TRNG dans le noyau.  MÃªme la possibilitÃ© de travailler avec un Ã©quipement basÃ© sur les privilÃ¨ges root ne rÃ©soudra pas le problÃ¨me: <i>"Les dÃ©veloppeurs d'applications spÃ©cifient que leur application doit Ãªtre installÃ©e en tant que root pour des raisons de sÃ©curitÃ©, car c'est la seule faÃ§on d'accÃ©der Ã  de" trÃ¨s bons "nombres alÃ©atoires."</i> <br><br>  Muller a demandÃ© si Cao avait refusÃ© de mettre en Å“uvre le pool de blocage, qu'il avait lui-mÃªme proposÃ© depuis longtemps.  Cao a rÃ©pondu qu'il prÃ©voyait de prendre les correctifs Lutomirsky et s'est activement opposÃ© Ã  l'ajout d'une interface de blocage au noyau. <br><br>  <i>Â«Le noyau ne peut donner aucune garantie quant Ã  la bonne caractÃ©risation de la source de bruit.</i>  <i>La seule chose qu'un dÃ©veloppeur GPG ou OpenSSL peut obtenir est le vague sentiment que TRUERANDOM est Â«meilleurÂ» et comme ils veulent plus de sÃ©curitÃ©, ils essaieront sans aucun doute de l'utiliser.</i>  <i>Ã€ un moment donnÃ©, il sera bloquÃ©, et lorsqu'un autre utilisateur intelligent (peut-Ãªtre un spÃ©cialiste de la distribution) l'insÃ©rera dans le script init et que les systÃ¨mes cesseront de fonctionner, les utilisateurs n'auront qu'Ã  se plaindre de Linus Torvalds lui-mÃªme. Â»</i> <br><br>  Cao prÃ©conise Ã©galement de fournir aux cryptographes et Ã  ceux qui ont vraiment besoin de TRNG un moyen de collecter leur propre entropie dans l'espace utilisateur afin qu'ils puissent l'utiliser comme bon leur semble.  Il dit que la collecte d'entropie n'est pas un processus qui peut Ãªtre effectuÃ© par le noyau sur tous les types de matÃ©riel pris en charge par lui, en outre, le noyau lui-mÃªme ne peut pas estimer la quantitÃ© d'entropie fournie par diverses sources. <br><br>  <i>"Le noyau ne doit pas mÃ©langer diffÃ©rentes sources de bruit ensemble, et bien sÃ»r, il ne doit pas essayer de prÃ©tendre qu'il sait combien de bits d'entropie il reÃ§oit quand il essaie de jouer une sorte de" jeu saccadÃ© d'entropie "sur une architecture CPU simple pour l'utilisateur laid "Cas IOT / Embedded, lorsque tout n'est pas synchronisÃ© avec un seul gÃ©nÃ©rateur maÃ®tre, quand il n'y a aucune instruction CPU pour rÃ©organiser ou renommer le registre, etc."</i> <i><br><br></i>  <i>Â«Nous pouvons parler de fournir des outils qui essaient de faire ces calculs, mais de telles choses devraient Ãªtre effectuÃ©es sur l'Ã©quipement de chaque utilisateur, ce qui pour la plupart des utilisateurs du kit de distribution est tout simplement impossible.</i>  <i>Si cela n'est destinÃ© qu'aux cryptographes, laissez-le se faire dans leur espace utilisateur.</i>  <i>Et ne simplifions pas GPG, OpenSSL, etc., pour que tout le monde dise: "nous voulons un" vrai hasard "et nous ne sommes pas d'accord sur quoi que ce soit de moins."</i>  <i>Nous pouvons parler de la faÃ§on dont nous fournissons des interfaces aux cryptographes afin qu'ils puissent obtenir les informations nÃ©cessaires en accÃ©dant aux sources de bruit primaires, sÃ©parÃ©es et nommÃ©es, et, Ã©ventuellement, d'une maniÃ¨re ou d'une autre, la source de bruit peut s'authentifier dans une bibliothÃ¨que ou une application d'espace utilisateur. Â»</i> <br><br>  Il y a eu une petite discussion sur l'apparence d'une telle interface, car, par exemple, pour certains Ã©vÃ©nements, il peut y avoir des implications pour la sÃ©curitÃ©.  Cao a notÃ© que les codes de numÃ©risation du clavier (c'est-Ã -dire les frappes de touches) sont mÃ©langÃ©s dans le pool dans le cadre de la collecte d'entropie: "TransfÃ©rer cela dans l'espace utilisateur, mÃªme via un appel systÃ¨me privilÃ©giÃ©, serait au moins dÃ©raisonnable."  Il est possible que d'autres temporisations d'Ã©vÃ©nement puissent crÃ©er une sorte de fuite d'informations via des canaux latÃ©raux. <br><br>  Ainsi, on a le sentiment qu'un problÃ¨me de sous-systÃ¨me de nombre alÃ©atoire Linux de longue date est en passe de trouver une solution.  Les changements que le sous-systÃ¨me de nombres alÃ©atoires a subis rÃ©cemment, en fait, n'ont conduit qu'Ã  des problÃ¨mes de DoS dans le processus de son utilisation.  Il existe maintenant des moyens efficaces d'obtenir les meilleurs nombres alÃ©atoires que le noyau peut fournir.  Si TRNG est toujours souhaitable pour Linux, alors cette lacune devra Ãªtre corrigÃ©e Ã  l'avenir, mais trÃ¨s probablement elle ne sera pas effectuÃ©e Ã  l'intÃ©rieur du noyau lui-mÃªme. <br><br><h3>  Un peu de publicitÃ© :) </h3><br>  Merci de rester avec nous.  Aimez-vous nos articles?  Vous voulez voir des matÃ©riaux plus intÃ©ressants?  Soutenez-nous en passant une commande ou en recommandant Ã  vos amis <a href="https://ua-hosting.company/cloudvps/nl">des VPS basÃ©s sur le cloud pour les dÃ©veloppeurs Ã  partir de 4,99 $</a> , un <b>analogue unique de serveurs d'entrÃ©e de gamme que nous avons inventÃ©s pour vous:</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">Toute la vÃ©ritÃ© sur les VPS (KVM) E5-2697 v3 (6 cÅ“urs) 10 Go DDR4 480 Go SSD 1 Gbit / s Ã  partir de 19 $ ou comment diviser le serveur?</a>  (les options sont disponibles avec RAID1 et RAID10, jusqu'Ã  24 cÅ“urs et jusqu'Ã  40 Go de DDR4). <br><br>  <b>Dell R730xd 2 fois moins cher au centre de donnÃ©es Equinix Tier IV Ã  Amsterdam?</b>  Nous avons seulement <b><a href="https://ua-hosting.company/serversnl">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV Ã  partir de 199 $</a> aux Pays-Bas!</b>  <b><b>Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - Ã  partir de 99 $!</b></b>  Pour en savoir plus sur la <a href="https://habr.com/company/ua-hosting/blog/329618/">crÃ©ation d'un bÃ¢timent d'infrastructure.</a>  <a href="https://habr.com/company/ua-hosting/blog/329618/">classe utilisant des serveurs Dell R730xd E5-2650 v4 coÃ»tant 9 000 euros pour un sou?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr484736/">https://habr.com/ru/post/fr484736/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr484724/index.html">Nouvelles du monde d'OpenStreetMap n Â° 494 (12.31.2019-06.01.2020)</a></li>
<li><a href="../fr484728/index.html">Client mystÃ¨re de CityMobile</a></li>
<li><a href="../fr484730/index.html">Dell Inspiron 7490: un ordinateur portable lÃ©ger en mÃ©tal pour tous les jours avec une excellente autonomie</a></li>
<li><a href="../fr484732/index.html">Qu'est-ce que VMware et pourquoi sa compatibilitÃ© avec les SSD est-elle importante?</a></li>
<li><a href="../fr484734/index.html">Ce qui aurait pu Ãªtre prÃ©sentÃ© au CES aux XIXe et XXe siÃ¨cles</a></li>
<li><a href="../fr484738/index.html">ProcÃ©dure d'intÃ©gration continue pour Laravel 6 sur Google Cloud Run</a></li>
<li><a href="../fr484740/index.html">Semaine de la sÃ©curitÃ© 04: problÃ¨mes de cryptographie dans Windows 10</a></li>
<li><a href="../fr484744/index.html">Comment j'ai fait des ombres 2D dans Unity</a></li>
<li><a href="../fr484750/index.html">SchizophrÃ©nie: un regard aprÃ¨s</a></li>
<li><a href="../fr484752/index.html">Ã‰crire un pilote d'ordinateur portable pour le plaisir et le profit, ou comment s'engager dans le noyau mÃªme si vous n'Ãªtes pas si intelligent</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>